wac_wP.prototype.AHa=wac_b(467,function(){if(!this.af){var a=this;wac_sP(this.po).CWo(function(){wac_sP(a.po).Ob().AHa()},11)}});wac_LL.prototype.wG=wac_b(344,function(){return this.ML});wac_RF.prototype.M5b=wac_b(220,function(){});wac_mP.prototype.M5b=wac_b(219,function(a){this.ua.nd("OR",a)});wac_RF.prototype.x3b=wac_b(218,function(){});wac_mP.prototype.x3b=wac_b(217,function(a){this.ua.hb("OR",a)});wac_Iy.prototype.gFb=wac_b(192,function(){return!1});
wac_8R.prototype.gFb=wac_b(191,function(a,b,c){var d;return d=wac_Rrb(a,c,{val:void 0}),d});wac_Qy.prototype.MJb=wac_b(186,function(){});
wac_NR.prototype.MJb=wac_b(185,function(a){var b=wac_D(this.ya,"PresenceRenderIpSlowDurationMilliseconds",3E3);if(!this.o2b.kb(a)){this.o2b.W(a,!1);var c=this;this.gb.zc(new wac_uh(3,1,b,function(){var d,e;e=c.o2b.qc(a,d={val:d});d=d.val;e;d||(wac_Bi().recordQosError("PresenceRenderFailed",["PresenceExperienceDegraded"],!0,!0,!0,!1,null),wac_(51683551,302,15,"Presence didn't render for the selected person from people well. Veto Set At:{0}",b));c.o2b.Db(a)},0,null,!1))}});
function wac_ayb(a,b,c){if(!b)return null;if(!a.G1)return wac_(50870151,304,10,"Tried to acquire a lock for wet change before the coauthManager is ready. This will fail."),null;var d=b.oa(Number,wac_1r,0),e=null;b=b.oa(Number,wac_7u,0);var f=a.vAa.kb(d)?a.vAa.B(d):0;b&&(e=wac_JA(a,b));!e&&f&&(e=wac_JA(a,f));if(e)return a.vAa.W(d,e.LockId),e;e=new wac_lLa;e.LockId=wac_2sb(a);e.ParagraphIds=[d];e.Type=4;if(!c)return wac_(17866973,304,10,"An attempt to acquire a Lock was made  with an empty clientId. The lockOwner cannot be empty."),
null;f=wac_0p(a.G1.qC,c);f||(f=new wac_ec,f.Id=c,f.Name=CommonUIStrings.l_AnonymousUserName,a.VHa.kb(c)||a.VHa.U(c,new (wac_h.$$(Number))(null)),a.VHa.B(c).U(e.LockId));if(!f)return wac_(7440404,304,10,"Unable to get a wetchange lock on node {0} as client {1} is not in editorstable",b,c),null;e.LockOwner=f;wac_3sb(a,e,e.LockId);a.vAa.W(d,e.LockId);return e}
function wac_byb(a,b){if(wac_ER.isInstanceOfType(b)){var c=b.Ja(Number,wac_1r);if(a.vAa.kb(c)){var d=a.vAa.B(c);if(d){var e=wac_JA(a,d);e&&4!==e.Type||(delete a.MW[d.toString()],a.vAa.Db(c),b.la(wac_7u,0),a.ua.Ya("WLR",new wac__sb(d),a))}}}else wac_(18227549,304,10,"An attempt to remove a Wet Change lock on a node that is not a paragraph node was made.")}function wac_cyb(a){return a.OH?a.rZa:a.oa(Number,wac_nt,0)}
function wac_dyb(a,b,c,d,e){var f=wac_9Wa(a,b,c,0);if(f&&d){var g=b.aa;d=wac_nE(g.qa,b.ta);d||(wac_PG(a,wac_4A(g,b.ta+1)),wac_PG(a,wac_4A(g,b.ta)),d=wac_nE(g.qa,b.ta));d.ab||wac_JG(d,new wac_SG(d,wac_x(),null));1===c.length?((c=wac_nE(g.qa,b.ta+1))?c.ab||wac_JG(c,new wac_SG(c,wac_x(),null)):wac_PG(a,wac_4A(g,b.ta+1)),c=new wac_RI(d,null,22,"",!1),wac_RG(d,c)):2===c.length&&""!==e&&a.d8a.Z0(d.ab,e)}f&&wac_$Wa(a,b.aa,!1)}
function wac_CT(a){if(!a.ei.ja()){a.uHd||(wac_fa(42316242,302,50,"No users available at PeopleInfoProvider.GetAllUsers call"),a.uHd=!0);if(a.Vk){var b=a.Vk.Nia();wac_0xa(a,b)}if(a.oma)for(var b=wac_1xa(a.oma),c=b.length,d=0;d<c;++d){var e=b[d];e.Id&&(e=wac_2xa(a,e.Id),wac_3xa(a,new wac__p(0),e))}}b=[];for(a=a.ei.GetEnumerator();a.$$mn();)c=a.$$cu(),Array.add(b,c.pa());return b}function wac_eyb(a,b){var c;a=a.ei.qc(b,c={val:c});c=c.val;a;return c}
var wac_fyb=null,wac_gyb=null,wac_hyb=null,wac_iyb=null;
function wac_jyb(a){var b,c,d;a=(d=wac_7xb(a,c={val:b}),b=c.val,d);if(!a)return!1;switch(b){case 0:case 1:return"number"!==typeof a.CP||null!=a.FB&&"number"!==typeof a.FB||null!=a.FE&&"number"!==typeof a.FE||null!=a.HB&&"number"!==typeof a.HB||null!=a.HE&&"number"!==typeof a.HE||null!=a.CB&&"number"!==typeof a.CB||null!=a.CE&&"number"!==typeof a.CE||null!=a.R&&"number"!==typeof a.R||null!=a.E&&"number"!==typeof a.E||null!=a.TW&&"number"!==typeof a.TW||null!=a.PB&&"number"!==typeof a.PB||null!=a.SYM&&
"number"!==typeof a.SYM||null!=a.IE&&"number"!==typeof a.IE||null!=a.OO&&"number"!==typeof a.OO||null!=a.AX&&"number"!==typeof a.AX||null!=a.CCI&&"number"!==typeof a.CCI?!1:!0;default:return!1}}
function wac_kyb(a){if("number"!==typeof a.RK||"number"!==typeof a.DK)return!1;var b,c=!1,d=!1,e=!1;switch(a.RK){case 0:d=b=!0;break;case 1:e=c=d=b=!0;break;case 2:if(null!=a.PE&&"number"!==typeof a.PE)return!1;b=!0;break;case 4:b=!0;break;case 3:d=b=!0;break;case 5:c=b=!0;break;default:return!1}return b&&("number"!==typeof a.PS||"number"!==typeof a.TS)||d&&("object"!==typeof a.OS||!a.OS||!wac_jyb(a.OS))||c&&("number"!==typeof a.PE||"number"!==typeof a.TE)||e&&("object"!==typeof a.OE||!a.OE||!wac_jyb(a.OE))?
!1:!0}function wac_lyb(a){return wac_cyb(a)}function wac_myb(a){return a&&a.style?wac_$l(a,"transform")?a.style.transform:wac_$l(a,"msTransform")?a.style.msTransform:wac_$l(a,"MozTransform")?a.style.MozTransform:wac_$l(a,"webkitTransform")?a.style.webkitTransform:null:null}
function wac_nyb(a){for(var b=new (wac_e.$$(Number)),c=a.$$lge();c.$$mn();)if(a=c.$$cu())a=window.parseFloat(a),!window.isNaN(a)&&window.isFinite(a)&&b.U(a);c={};c.C=b.ja();if(0<b.ja()){for(var d=0,e=b.$$lge();e.$$mn();)a=e.$$cu(),d+=a;d/=b.ja();c.M=d.toFixed(2);for(var e=0,f=b.$$lge();f.$$mn();)a=f.$$cu(),e+=(a-d)*(a-d);e/=b.ja();b=Math.sqrt(e);c.SD=b.toFixed(2)}return wac_Ui(c)}
function wac_oyb(a){var b=0;for(a=a.$$lge();a.$$mn();){var c=a.$$cu();c&&(c=window.parseInt(c),!window.isNaN(c)&&window.isFinite(c)&&(b+=c))}return wac_Ui(b)}Type.registerNamespace("Common.App.CoauthTelemetry");wac_g=window.Common||{};wac_g.wa=wac_g.wa||{};wac_g.wa.oab=wac_g.wa.oab||{};function wac_pyb(a){this.DXd=Function.createDelegate(this,this.xwe);this.Aga=Function.createDelegate(this,this.Jua);this.GRb={};this.HZb={};this.hMa=a}
wac_pyb.prototype={ED:null,hMa:null,Vnb:null,THb:function(a){var b=new (wac_$a.$$(Number)),c=this;this.ob().CW(function(){a in c.GRb?wac_ab(b,c.GRb[a]):c.HZb[a]=b});return b.yc},ob:function(){if(this.Vnb)return this.Vnb.yc;this.Vnb=new (wac_$a.$$(Object));var a=this;this.hMa.CW(function(){a.ED=a.hMa.Ob();a.ED.ua.hb("UU",a.Aga);wac_qyb(a);a.Vnb.Ie(null)});return this.Vnb.yc},Jua:function(){wac_qyb(this)},xwe:function(a,b){return a.Q4>b.Q4?1:a.Q4<b.Q4?-1:0}};
function wac_qyb(a){var b=wac_CT(a.ED);b.sort(a.DXd);a.GRb={};for(var c=0;c<b.length&&b[c]&&b[c].Q4;c++){var d=a,e=b[c].Jf(),f=c;a.GRb[e]=f;e in d.HZb&&(wac_ab(d.HZb[e],f),delete d.HZb[e])}}
function wac_ryb(a,b,c,d,e,f,g,h,k){this.B7b=Function.createDelegate(this,this.Woc);this.L1c=Function.createDelegate(this,this.XVe);this.u1=a;this.R3a=new (wac_$a.$$(wac_g.MFb));this.ya=c;this.JRb=b;this.Cy=d;this.Kh=e;this.IZb=f;this.hMa=g;this.Krd=h;this.mFc=this.lFc=!1;this.ivb=0;this.gAc=1;this.Kca=k;this.I4a=wac_s(this.ya,"PeoplesWellExtraButtonInfoIsEnabled")}
wac_ryb.prototype={u1:null,R3a:null,JRb:null,ya:null,Cy:null,Kh:null,IZb:null,hMa:null,Krd:null,I4a:!1,ED:null,Otd:null,zJd:null,gAc:0,mFc:!1,lFc:!1,ivb:0,Kca:null,ob:function(){var a=this;wac_Wa.WAA.call(null,this.hMa,this.JRb,this.IZb).CW(function(){a.ED=a.hMa.Ob();a.Otd=a.JRb.Ob();a.zJd=a.IZb.Ob();wac_Wa.WAA.call(null,a.JRb.Ob().kNa.yc,a.IZb.Ob().X1b.yc).CW(function(){a.gAc=a.Otd.kNa.yc.Ob();a.ivb=a.zJd.X1b.yc.Ob();a.ED.ua.hb("UU",a.L1c);wac_CT(a.ED).length&&a.Jua()})})},XVe:function(){this.Jua()},
Jua:function(){this.Krd(wac_CT(this.ED))?(this.ED.ua.nd("UU",this.L1c),wac_syb(this,this.lFc)):wac_ab(this.R3a,1);this.lFc=!0},Woc:function(){var a=wac_vl(this.Kh,"AppInitStatus_"+wac_g.wa.Bsa.toString(4));wac_c(42259235,325,!!this.ivb,null);var b=this.ivb-a,c={};c.InteractiveTime=a;c.ReactRenderComplete=this.ivb;c.HadTabSwitch=this.Kca();c.IsModernGallery=this.I4a;wac_(594883104,325,50,wac_on(c));this.I4a?(wac_(42062997,325,15,b.toString()),a=this.R3a,c=wac_D(this.ya,"CoauthorGalleryTimeToRenderDurationMs",
1E4),c=b>c,this.Kca()?(wac_(50455714,325,50,c.toString()),b=!1):(c&&(wac_(42062998,325,15,b.toString()),wac_Bi().recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null)),b=c),wac_ab(a,b?3:2)):wac_(594883103,325,15,b.toString())}};function wac_tyb(a,b){b?a.Cy.Nn(4,a.B7b,3):wac_ab(a.R3a,1)}
function wac_syb(a,b){a.mFc?a.R3a.yc.CW(function(){wac_(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",wac_g.MFb.toString(a.R3a.yc.Ob()))}):(a.mFc=!0,wac_tyb(a,!a.gAc&&!b))}function wac_uyb(a,b){this.Aga=Function.createDelegate(this,this.Jua);this.SMc=a;this.JJd=b}function wac_vyb(a){for(var b,c=null,d=a.length,e=0;e<d;++e)if(b=a[e])if(b=b.Ru||!b.eq?b.Jf():b.eq.toUpperCase(),!c)c=b;else if(c!==b)return!0;return!1}
wac_uyb.prototype={cZ:null,JJd:null,SMc:null,ob:function(){var a=this;this.SMc.CW(function(){a.cZ=a.SMc.Ob();a.cZ.ua.hb("UU",a.Aga)})},Jua:function(){wac_vyb(wac_CT(this.cZ))&&(this.cZ.ua.nd("UU",this.Aga),this.JJd.IsRealCoauthSession=!0)},nff:function(){return this.cZ?wac_vyb(wac_CT(this.cZ)):!1}};function wac_wyb(){}
wac_wyb.prototype={Qb:function(){return"Common.App.CoauthTelemetry"},Sb:function(a){wac_n(wac_o(wac_p(a.ma(wac_uyb),wac_jo)),function(){return new wac_uyb(wac_Db(wac_sc,wac_m(a,wac_sc)),wac_q.qm)});wac_n(wac_o(wac_p(a.ma(wac_ryb),wac_cca)),function(){return new wac_ryb(wac_y(),wac_Db(wac_7b,wac_m(a,wac_7b)),wac_q.Z,window.Common.App.AppLifecycleManager.get_instance(),wac_Ud(),wac_Db(wac_tc,wac_m(a,wac_tc)),wac_Db(wac_sc,wac_m(a,wac_sc)),wac_vyb,function(){return wac_xyb()})});wac_n(wac_o(wac_p(a.ma(wac_yyb),
wac_ko)),function(){return new wac_yyb(wac_Db(wac_7b,wac_m(a,wac_7b)),window.Common.App.AppLifecycleManager.get_instance(),a.K(wac_io),wac_Ud(),function(){return wac_xyb()},wac_q.Z,null,wac_Bi())});wac_n(wac_o(wac_p(a.ma(wac_pyb),wac_io)),function(){return new wac_pyb(wac_Db(wac_sc,wac_m(a,wac_sc)))})},ob:function(){wac_oi(wac_q.Z,function(){wac_k().K(wac_uyb).ob();wac_s(wac_q.Z,"CoauthorGalleryTelemetryIsEnabled")&&wac_k().K(wac_cca).ob();wac_s(wac_q.Z,"CashTelemetryIsEnabled")&&(wac_k().K(wac_ko),
wac_k().K(wac_io))})},ka:function(){}};function wac_xyb(){return wac_Vd()&&wac_dpa(wac_Ud(),"UserActions")?0<wac_vl(wac_Ud(),"UserActions").VisiToggled:!1}function wac_yyb(a,b,c,d,e,f,g,h){this.oKd={};this.Q4a=new (wac_d.$$(Number))(function(){return wac_Lh(f,"PresenceBootLatencyThreshold",1E4)});this.YYa=new (wac_d.$$(Number))(function(){return wac_Lh(f,"PresenceBootLatencyCutoffThreshold",6E4)});this.Cy=b;this.LJd=c;this.hAc=a;this.Kh=d;this.Aqb=g;this.Kca=e;this.ee=h;this.ob()}
wac_yyb.prototype={hAc:null,Aqb:null,Wnb:null,Cy:null,LJd:null,zjb:null,Kh:null,COd:0,DOd:0,Q4a:null,YYa:null,Kca:null,ee:null,ubb:function(a,b,c,d){c&&(wac_c(42274970,302,!this.Aqb||this.Aqb===c,"_myClientId is already set and you are trying to update it to something different"),this.Aqb=c);var e=new (wac_$a.$$(Boolean)),f=this;this.ob().CW(function(){var c=b?b.getTime():(new Date).getTime();if(a in f.oKd)e.nX();else{var h;new (wac_$a.$$(Number));h=1===f.COd?wac__a(Number,f.DOd):wac_zyb(f);c=new wac_Ayb(a,
h,c,f.THb(f.Aqb||"{"+wac_q.Pf+"}"),f.THb(a),f.Q4a,f.YYa,d,f.Kca);f.oKd[a]=c;wac_Byb(c,e)}});return e.yc},ob:function(){if(this.Wnb)return this.Wnb.yc;this.Wnb=new (wac_$a.$$(Object));this.Kca()&&wac_(50951700,302,15,"TabSwitched Session");var a=this;this.hAc.CW(function(){var b=a.hAc.Ob(),c=b.kNa.yc,d=b.EOd.yc;d.CW(function(){c.CW(function(){a.ee&&a.ee.addQosPillar(window.Common.QosPillarName.toString(6));a.$uc(c.Ob(),d.Ob());a.Wnb.Ie(null)})})});return this.Wnb.yc},$uc:function(a,b){this.COd=a;this.DOd=
b?b:(new Date).getTime()},THb:function(a){return this.LJd.THb(a)}};function wac_zyb(a){if(a.zjb)return a.zjb.yc;a.zjb=new (wac_$a.$$(Number));a.Cy.Nn(4,function(){var b=wac_vl(a.Kh,"AppInitStatus_"+wac_g.wa.Bsa.toString(4));wac_ab(a.zjb,b)},3);return a.zjb.yc}function wac_Ayb(a,b,c,d,e,f,g,h,k){this._id=a;this.KQc=b;this.pr=c;this.oYb=d;this.S1b=e;this.Q4a=f;this.YYa=g;this.ckb=h;this.Kca=k}wac_Ayb.prototype={Bh:0,KQc:null,Q4a:null,YYa:null,fNd:!1,pr:0,oYb:null,S1b:null,ckb:0,_id:null,Kca:null};
function wac_Cyb(a){switch(a){case 2:return"NonWac";case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}}
function wac_Byb(a,b){wac_Wa.WAA(a.KQc,a.oYb,a.S1b).CW(function(){if(a.oYb.Ob()<=a.S1b.Ob())wac_ab(b,!1);else{a.Bh=a.KQc.Ob();var c=a.pr-a.Bh,d=new window.Common.App.CoauthTelemetry.PL;d.id=a._id;d.et=a.pr;d.st=a.Bh;d.d=a.pr-a.Bh;d.mp=a.oYb.Ob();d.tp=a.S1b.Ob();d.ct=wac_Cyb(a.ckb);d.vc=a.Kca();var e=wac_Ui(d);wac_(42078597,302,15,e);if(c>a.Q4a.pa()&&!a.fNd&&!d.vc&&c<a.YYa.pa()){a.fNd=!0;wac_ab(b,!0);var f,d=(f=new wac_Gn,f.extendedProperties=new window.Map,f);d.extendedProperties.set("data",e);wac_Bi().recordQosError("PresenceRenderDurationIsTooLong",
["PresenceExperienceDegraded"],!1,!0,!1,!1,d);wac_(42078598,302,15,"{d:"+c+",vt:"+a.Q4a.pa()+",ct:"+a.YYa.pa()+"}")}b.yc.Aq()||wac_ab(b,!1)}})}window.Common.App.CoauthTelemetry.PL=wac_g.wa.oab.HWe=function(){};wac_g.wa.oab.HWe.prototype={id:null,et:0,st:0,mp:0,tp:0,d:0,ct:null,vc:!1};wac_pyb.registerClass("Common.App.CoauthTelemetry.CoauthorPositionFinder",null,wac_io);wac_ryb.registerClass("Common.App.CoauthTelemetry.CoauthorGalleryTelemetry",null,wac_cca);
wac_uyb.registerClass("Common.App.CoauthTelemetry.CoauthTelemetry",null,wac_jo);wac_wyb.registerClass("Common.App.CoauthTelemetry.CoauthTelemetryPackage",null,wac_I,wac_j);wac_yyb.registerClass("Common.App.CoauthTelemetry.PresenceBootTelemetry",null,wac_ko);wac_Ayb.registerClass("Common.App.CoauthTelemetry.PresenceLatencyActivityLogger");window.Common.App.CoauthTelemetry.PL.registerClass("Common.App.CoauthTelemetry.PL");wac_J(wac_C(),new wac_wyb,0,!1);Type.registerNamespace("Common.App.CollabControls");
wac_g=window.Common||{};wac_g.wa=wac_g.wa||{};wac_g.wa.Usa=wac_g.wa.Usa||{};function wac_Dyb(){}wac_Dyb.registerInterface("Common.App.CollabControls.IPresenceTooltipControl");function wac_Eyb(){}wac_Eyb.registerInterface("Common.App.CollabControls.IPresenceTooltipFactory");wac_g.wa.Usa.XVa=function(){};
wac_g.wa.Usa.XVa.prototype={multipleBrowsersImageClassName:0,peopleImageClassName:1,peopleImageClusterPath:4,multipleBrowserImageClusterPath:5,imageDimension:6,rtl:8,pointerInputManager:9,clickInputManager:10,vertical:11,zIndex:12,contextMenuInputManager:13,imageDomElement:14,useIdleTooltip:15,viewportBoundsCallback:16,flipHorizontalDirection:17,fixRemoveFadeOutElementCrash:18};wac_g.wa.Usa.XVa.registerEnum("Common.App.CollabControls.PresenceTooltipSettingKeys",!1);
function wac_DT(a){this.IR=Function.createDelegate(this,this.H5e);this.dispose=this.ka;wac_DT.initializeBase(this);this.mb=a}wac_DT.prototype={mb:null,Fm:function(){return"visible"===this.mb.style.visibility},sn:function(a){this.mb.style.visibility=a?"visible":"hidden";return a},ka:function(){this.mb&&this.mb.parentNode&&this.mb.parentNode.removeChild(this.mb);this.mb=null;wac_cf.prototype.ka.call(this)},al:function(a){return this.mb.ownerDocument.createElement(a)},H5e:function(){return!0}};
function wac_ET(a,b){a.mb.style.zIndex=b}function wac_Fyb(a,b){a.mb.dir=b?"rtl":"ltr"}function wac_FT(a,b){wac_FT.initializeBase(this);this.fc=a;this.L$b=b}wac_FT.prototype={fc:0,L$b:null};
function wac_GT(a,b,c){this.wBa=Function.createDelegate(this,this.BVa);this.SPa=Function.createDelegate(this,this.zRe);this.ei=[];this.dispose=this.ka;wac_GT.initializeBase(this,[a]);this.F_a={};this.Vc=c;this.Hg=c.hk(Boolean,8);this.yFc=c.hk(Boolean,15);this.I$=c.hk(Number,12);this.Mga=c.hk(Number,6);this.L3a=b;this.lTc=c.hk(Function,16);this.Hmb=c.hk(Boolean,17);this.qpb=0;this.MJd=new wac_Gyb(this.Hg,this.Hmb);this.vXa=this.Hg?3:4;this.bza=!1;this.MHa=[];this.I_a=[];this.mb.id=String.format("{0}-{1}",
"presencetooltip",wac_Hyb++);this.mb.className="prControl"+(this.Hg?"Rtl":"");this.I$&&wac_ET(this,this.I$);wac_Fyb(this,this.Hg);this.Vtc(b);this.$H=this.al("div");this.$H.className="prFlyoutContainer";this.mb.appendChild(this.$H);this.Qu=[];this.Qma=new wac_Iyb(this.Qu,this.mb,this.Mga,4,6,32,this.Hg);this.Ii=c.hk(wac_5c,9);this.Ii.Na("msospPointerDown",this.Qma.mb,this.SPa);this.Ii.Na("msospPointerOver",this.Qma.mb,this.SPa);this.Ii.Na("msospPointerOut",this.Qma.mb,this.SPa)}
wac_GT.prototype={Hg:!1,Axa:!1,KAd:!1,eea:!1,L3a:0,qpb:0,V2a:!1,yFc:!1,Hmb:!1,bza:!1,F_a:null,$H:null,Qma:null,MHa:null,I_a:null,MJd:null,vXa:0,Ii:null,Vc:null,lTc:null,B4b:function(){return wac_Ae(this.ei)},Qu:null,I$:0,Mga:0,zb:function(){return this.mb},ka:function(){if(3!==wac_HT(this)||this.Axa){if(this.Qu)for(var a=this.Qu,b=a.length,c=0;c<b;++c){var d=a[c];d.K5b(this.wBa);wac_Yb(d)}this.Qu=null;this.Ii.yb("msospPointerDown",this.Qma.mb,this.SPa);this.Ii.yb("msospPointerOver",this.Qma.mb,this.SPa);
this.Ii.yb("msospPointerOut",this.Qma.mb,this.SPa);wac_DT.prototype.ka.call(this)}else this.bza=!0},dHa:function(){wac_IT(this,!1);this.sn(!0)},jhb:function(){this.sn(!0);wac_Jyb(this);this.Axa=!0},mOb:function(){this.jhb()},Zd:function(){wac_Kyb(this,5);this.nja();this.Qma.su(wac_HT(this),this.V2a)},uS:function(a){var b=wac_HT(this),c=this.Axa;a.$j||(a.$j=(wac_Hyb++).toString());var d;if(a.$j in this.F_a&&(d=this.sEa(a.$j),0<=d)){d=this.ei[d];if(d.ps===a.ps&&d.ap===a.ap)return;this.jka(a.$j)}this.Zd();
d=new wac_Lyb(this.al("div"),this.Vc);d.rwb(this.wBa);this.$H.insertBefore(d.mb,this.$H.firstChild);this.F_a[a.$j]=d;Array.add(this.ei,a);Array.add(this.Qu,d);wac_Myb(this,b,c);this.sn(!0)},jka:function(a){if(3!==wac_HT(this)||this.Axa){var b=wac_HT(this),c=this.Axa;this.Zd();this.jgb(a);wac_Myb(this,b,c)}else Array.add(this.I_a,a)},Khc:function(a){a=a.$a.rawEvent.relatedTarget;if(this.$H!==a&&wac_qd(this.$H,a))return!0;for(var b=this.Qu,c=b.length,d=0;d<c;++d)if(wac_qd(b[d].mb,a))return!0;return!1},
nja:function(){var a=0,b=0;this.V2a&&(a=this.vXa,b=-6);for(var c=0;c<this.Qu.length;c++)this.Qu[c].Zd(this.ei[c],b,a);wac_ET(this,this.I$);this.Axa=!1;this.sn(!1);this.bza&&this.ka()},BVa:function(a,b){a=wac_HT(this);if(2===b.fc||4===b.fc&&3!==a)this.eea&&(this.eea=!1),3!==a&&(wac_Jyb(this),3===b.L$b.Pe&&wac_Nyb(this,2E3));else if(4===b.fc&&3===a)this.eea&&(this.eea=!1),wac_Nyb(this,0);else if(3===b.fc&&3===a&&!this.Axa)if(1<this.Qu.length){this.eea=!0;var c=this;wac_Ya(250).CW(function(){wac_IT(c,
!0);c.eea=!1})}else wac_Nyb(this,0);this.Ya("InteractivityChanged",b,null)},zRe:function(a){3===a.Pe?this.BVa(this,new wac_FT(4,a)):"msospPointerOver"===a.wn?this.BVa(this,new wac_FT(2,a)):"msospPointerOut"===a.wn&&this.BVa(this,new wac_FT(3,a));return!1},Vtc:function(a){this.mb.style.width=a+"px";this.mb.style.height=this.Mga+"px"},jgb:function(a){if(-1===this.sEa(a))wac_(41706452,302,50,"Cannot remove active editor because client id is invalid");else if(Array.contains(this.MHa,a)){Array.remove(this.MHa,
a);if(this.ei[0].$j===a&&0<this.MHa.length){var b=this.MHa[this.MHa.length-1];if(b in this.F_a){var c=this.sEa(b);if(c){var d=this.ei[c],b=this.F_a[b];Array.removeAt(this.ei,c);Array.insert(this.ei,0,d);Array.removeAt(this.Qu,c);Array.insert(this.Qu,0,b);this.$H.removeChild(b.mb);this.$H.appendChild(b.mb);wac_IT(this,!1)}}}this.ei[0].$j===a&&1===wac_HT(this)&&wac_IT(this,!1)}a=this.sEa(a);0>a||(c=this.ei[a],Array.removeAt(this.ei,a),delete this.F_a[c.$j],c=this.Qu[a],this.$H.removeChild(c.mb),this.Vc.hk(Boolean,
18)&&c.K5b(this.wBa),Array.removeAt(this.Qu,a),c.ka())},sEa:function(a){for(var b=0;b<this.ei.length;b++)if(this.ei[b].$j===a)return b;return-1},ktc:function(a){for(var b=0;b<this.Qu.length;b++)this.Qu[b].ktc(a)}};function wac_Oyb(a,b){b?Sys.UI.DomElement.addCssClass(a.$H,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(a.$H,"prBackgroundSelection")}
function wac_Kyb(a,b){if(a.I_a.length){a.Fm()&&a.nja();for(var c=0;c<a.I_a.length;c++)a.jgb(a.I_a[c]);Array.clear(a.I_a);0>=a.ei.length||5===b?a.Zd():b||a.dHa()}}function wac_Nyb(a,b){b?(a.eea=!0,wac_Ya(b).CW(function(){a.yFc?a.eea&&a.Zd():wac_IT(a,!0);a.eea=!1})):a.yFc?a.Zd():wac_IT(a,!1)}
function wac_Jyb(a){a.KAd&&wac_Oyb(a,!1);wac_ET(a,a.I$+1);var b,c,d,e=c={val:c},f=b={val:b},g=d={val:d};e.val=0;f.val=0;g.val=a.vXa;if(a.lTc){var h=a.lTc(a);if(h){var k=4===wac_HT(a),l;l=a.MJd;var m=a.Qu.length,n=k?6:a.Mga,p=a.Mga,q=a.mb,r=h.y,t=h.height,u=wac_Xk(q).y,v=u+n,w=m*p+2*(m-1),p=null;1===m||u+w<=r+t?m=new wac_JT(0,0,2,4):(m=l.jic(v,w,r,t),m.uVa-=u);l.Hmb?p=new wac_JT(0,0,2,l.Hg?4:3):(l.Hg?(u=h.width,q=wac_Xk(q),q=u-(q.x+q.width)):q=wac_Xk(q).x,u=Math.max(0,h.x),h=h.width,n=q+n,q+150<=u+
h?p=new wac_JT(0,0,2,l.Hg?3:4):150<=n-u&&(p=new wac_JT(0,0,2,l.Hg?4:3)),p||(h-n>=q-u?l=4:(n=q,l=3),p=new wac_JT(0,n,2,l)));l=new wac_JT(m.uVa,p.cjd,m.Lwc,p.Ekc);f.val=l.uVa;1===l.Lwc?f=a.Qu.length-1:(f=Math.abs(l.uVa),f=0<f?f/(a.Mga+2):0);a.qpb=f;g.val=l.Ekc;g.val!==a.vXa&&(a.ktc(g.val),a.mb.dir=3===g.val?"rtl":"ltr",a.vXa=g.val);g.val!==(a.Hg?3:4)?(e.val=k?-6:-a.Mga,a.V2a=!0):a.V2a=!1}}c=c.val;b=b.val;d=d.val;for(e=0;e<a.Qu.length;e++)a.Qu[e].Hh(a.ei[e],c,b+(a.Mga+2)*e+20,3,e!==a.qpb,d)}
function wac_IT(a,b){if(!b||a.eea){a.KAd&&wac_Oyb(a,!0);var c=Math.min(3,a.Qu.length)-1;b=0;var d=1,e=0;a.V2a&&(b=a.vXa,d=-1,e=-a.Mga);for(var f=a.Qu.length-1;f>c;f--)a.Qu[f].Hh(a.ei[f],-4*c*d+e,20,2,!0,b);for(f=c;0<=f;f--)c=Array.contains(a.MHa,a.ei[f].$j),a.Qu[f].Hh(a.ei[f],-4*f*d+e,20,0<f?2:c?1:0,f!==a.qpb,b);a.qpb=0;a.Qma.su(0,a.V2a);wac_ET(a,a.I$);a.Axa=!1;wac_Kyb(a,0);a.bza&&a.ka()}}function wac_Myb(a,b,c){0>=a.ei.length?a.Zd():3===b&&c?a.jhb():a.dHa()}
function wac_HT(a){return a.Qu&&0<a.Qu.length?a.Qu[0].rk:5}function wac_Pyb(a){var b=wac_Qyb/a,c=2*b,d=wac_Ryb/2;a=(a-12-8)*b/2;var e=document.createElementNS(wac_Syb,"g");e.setAttribute("class",wac_Tyb);for(var f=1;3>=f;f++)e.appendChild(wac_Uyb(f,c,a+(6*f-2)*b,d));return e}
function wac_Uyb(a,b,c,d){var e=document.createElementNS(wac_Syb,"circle");e.setAttribute("class",String.format("{0}-{1}",wac_Vyb,a));e.setAttribute("cx",String.format("{0}",c));e.setAttribute("cy",String.format("{0}",d));e.setAttribute("r",String.format("{0}",b));return e}function wac_Wyb(a){this.Vc=a;wac_KT(this.Vc,10,wac_Gg());wac_KT(this.Vc,9,wac_Ig());wac_KT(this.Vc,6,20);wac_KT(this.Vc,13,wac_Tg());wac_KT(this.Vc,17,!1)}
wac_Wyb.prototype={Vc:null,Ufc:function(a,b){wac_KT(this.Vc,15,b);return new wac_GT(a,20,this.Vc)}};
function wac_Lyb(a,b){this.b_=Function.createDelegate(this,this.Wja);this.DG=Function.createDelegate(this,this.P6);this.CG=Function.createDelegate(this,this.vJ);this.pk=Function.createDelegate(this,this.Gp);wac_Lyb.initializeBase(this,[a]);this.nZ=b.hk(Boolean,8);this.rda=b.hk(Number,6);this.$Qd=b.hk(Boolean,15);this.Vc=b;this.xDc=0;this.mb=a;this.mb.className=wac_Xyb;this.FK=document.createElement("span");this.mb.appendChild(this.FK);a=b.hk(Number,6);var c=document.createElementNS(wac_Syb,"svg");
c.setAttribute("viewBox",String.format(wac_Yyb,wac_Qyb,wac_Ryb));c.appendChild(wac_Pyb(a));this.ywd=c;this.jF(b);this.rk=5}
wac_Lyb.prototype={Jc:null,Ii:null,Tw:null,Vc:null,FK:null,$ma:null,ywd:null,rda:0,nZ:!1,$Qd:!1,Uzc:null,xDc:0,sxa:null,rwb:function(a){this.hb("InteractivityChanged",a)},K5b:function(a){this.nd("InteractivityChanged",a)},MA:null,rk:0,ka:function(){this.mb&&(this.Jc.yb("click",this.mb,this.pk),this.Jc.yb("dblclick",this.mb,this.IR),this.Ii.yb("msospPointerDown",this.mb,this.CG),this.Ii.yb("msospPointerOut",this.mb,this.DG),this.Ii.yb("msospPointerOver",this.mb,this.b_),this.Tw.yb(this.mb,this.IR));
wac_DT.prototype.ka.call(this)},jF:function(a){this.Jc=a.hk(wac_3c,10);this.Jc.Na("click",this.mb,this.pk);this.Jc.Na("dblclick",this.mb,this.IR);this.Ii=a.hk(wac_5c,9);this.Ii.Na("msospPointerOver",this.mb,this.b_);this.Ii.Na("msospPointerOut",this.mb,this.DG);this.Ii.Na("msospPointerDown",this.mb,this.CG);this.Tw=a.hk(wac_nk,13);this.Tw.Na(this.mb,this.IR)},Zd:function(a,b,c){this.$Qd&&a?this.Hh(a,b,15,4,!1,c):(3===this.rk&&wac_Zyb(this),this.sn(!1),this.rk=5)},Hh:function(a,b,c,d,e,f){var g;if((g=
a)&&!(g=d!==this.rk)){g=wac_bm(this.mb.style.left);var h=wac_bm(this.mb.style.top);g=!(g===b&&h===c)}if(g){if(!wac__yb(this.rk)||!wac__yb(d))switch(Sys.UI.DomElement.removeCssClass(this.mb,this.Uzc),this.rk){case 4:3===d?this.$ha(wac_0yb,wac_1yb):wac__yb(d)&&this.$ha(wac_2yb,wac_1yb);break;case 3:4===d?this.$ha(wac_3yb,wac_4yb):wac__yb(d)&&(e&&wac_Zyb(this),this.$ha(wac_2yb,wac_4yb,e?wac_5yb:""));break;case 0:case 1:case 2:4===d?this.$ha(wac_3yb,wac_6yb):3===d&&(e&&wac_7yb(this),this.$ha(wac_0yb,
wac_6yb,e?wac_8yb:"",3===f?wac_9yb:wac_$yb));break;default:4===d?this.$ha(wac_3yb):3===d?this.$ha(wac_0yb):wac__yb(d)&&this.$ha(wac_2yb)}this.uS(a,d,f);this.rk=d;4===f||!f&&!this.nZ?this.mb.style.left=b+"px":this.mb.style.right=b+"px";this.mb.style.top=c+"px";this.sn(!0)}},uS:function(a,b,c){this.MA=a;wac_pd(this.FK);this.FK.removeAttribute("style");this.FK.id="fly_"+a.$j;this.FK.style.backgroundColor=a.ps;4!==b?(this.FK.style.height=this.rda+"px",this.FK.style.lineHeight=this.rda+"px",wac_9l(this.FK,
"border-radius",this.rda+"px")):4===c||!c&&!this.nZ?this.FK.style.left="0px":this.FK.style.right="0px";if(2!==b)if(4===b)wac_rd(this.FK,"");else if(1===b)this.FK.appendChild(this.ywd);else{var d=a.ap;d?(c=d.replace(wac_gyb||(wac_gyb=/\([^)]*\)|[\0-\u001F\!-/:-@\[-`\{-\u00BF\u0250-\u036F\uD800-\uFFFF]/g),""),c=c.replace(wac_fyb||(wac_fyb=/\s+/g)," "),d=c.trim(),(wac_hyb||(wac_hyb=/[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7AF\uD7B0-\uD7FF\u3040-\u309F\u30A0-\u30FF\u3400-\u4DBF\u4E00-\u9FFF\uF900-\uFAFF]|[\uD840-\uD869][\uDC00-\uDED6]/)).test(d)||
(wac_iyb||(wac_iyb=/^\d+[\d\s]*(:?ext|x|)\s*\d+$/i)).test(d)?c="":(c="",d=d.split(" "),2===d.length?(c+=d[0].charAt(0),c+=d[1].charAt(0)):3===d.length?(c+=d[0].charAt(0),c+=d[2].charAt(0)):0<d.length&&(c+=d[0].charAt(0)),c=c.toUpperCase())):c="";!a.Ru&&c||b?(a=a.ap,b||(a=c,wac_9l(this.FK,"text-align","center")),wac_rd(this.FK,a),this.FK.setAttribute("dir","auto")):(this.$ma||(b=document.createElement("img"),b.setAttribute("src",wac_2e("doughperson_white_glyph.svg")),b.setAttribute("Unselectable",
"on"),b.setAttribute("role","presentation"),this.$ma=wac_2ja(this.rda,this.rda,null,null,wac_azb,"",!1,"",this.mb.ownerDocument,b)),this.FK.appendChild(this.$ma))}},Gp:function(a){if(!this.rk)return this.Ya("InteractivityChanged",new wac_FT(1,a),null),!0;3===this.rk&&wac_(50436114,302,50,"User clicked on presence pill.");return!1},P6:function(a){3===this.rk&&this.Ya("InteractivityChanged",new wac_FT(3,a),null);return!1},Wja:function(a){3!==a.Pe&&this.Ya("InteractivityChanged",new wac_FT(2,a),null);
return!1},vJ:function(a){if(3!==a.Pe)return!0;this.Ya("InteractivityChanged",new wac_FT(4,a),null);return!1},$ha:function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];this.Uzc=a.join(" ");Sys.UI.DomElement.addCssClass(this.mb,this.Uzc)},ktc:function(a){3===a&&wac_$l(this.mb,"left")?(a=wac_bm(this.mb.style.left),wac_9l(this.mb,"left",""),this.mb.style.right=-1*a+"px"):4===a&&wac_$l(this.mb,"right")&&(a=wac_bm(this.mb.style.right),wac_9l(this.mb,"right",""),this.mb.style.left=-1*a+"px")}};
function wac__yb(a){return!a||1===a||2===a}function wac_Zyb(a){window.clearTimeout(a.xDc);a.sxa&&(Sys.UI.DomElement.removeCssClass(a.sxa,wac_6yb+" "+wac_8yb),Sys.UI.DomElement.addCssClass(a.sxa,wac_bzb),wac_Ya(300).CW(function(){a.mb.parentNode===a.sxa.parentNode&&a.mb.parentNode.removeChild(a.sxa)}),wac_9l(a.mb,"z-index",""))}function wac_7yb(a){a.xDc=window.setTimeout(function(){a.mb&&(a.sxa=a.mb.cloneNode(!0),a.mb.parentNode.appendChild(a.sxa),a.mb.style.zIndex=2,a.sxa.style.zIndex=1)},300)}
function wac_Gyb(a,b){this.Hg=a;this.Hmb=b}wac_Gyb.prototype={Hg:!1,Hmb:!1,jic:function(a,b,c,d){var e=1,f=Math.max(c,a-b);b>a-c&&(e=2,f=b<d?d-b:c);return new wac_JT(f,0,e,4)}};function wac_JT(a,b,c,d){this.uVa=a;this.cjd=b;this.Lwc=c;this.Ekc=d}wac_JT.prototype={uVa:0,cjd:0,Lwc:0,Ekc:0};function wac_Iyb(a,b,c,d,e,f,g){this.mY=a;this._parent=b;this.iAc=c;this.Rtd=d;this.yAd=e;this.xNa=f;this.nZ=g;this.mb=document.createElement("div");this.mb.className="prTouchTarget"}
wac_Iyb.prototype={mY:null,_parent:null,nZ:!1,iAc:0,Rtd:0,yAd:0,xNa:0,mb:null,su:function(a,b){if(3!==a)if(5!==a&&this.mY&&this.mY.length){var c,d;if(4===a)c=this.yAd,d=(this.xNa-c)/2,this.mb.style.height=this.xNa+"px",this.mb.style.width=this.xNa+"px",a=wac_bm(this.mY[0].mb.style.top),b=wac_bm(this.nZ?this.mY[0].mb.style.right:this.mY[0].mb.style.left);else{c=this.iAc;d=(this.xNa-c)/2;this.mb.style.height=this.xNa+"px";this.mb.style.width=(this.mY&&this.mY.length?this.iAc+Math.min(this.mY.length-
1,2)*this.Rtd:0)+2*d+"px";a=wac_bm(this.mY[this.mY.length-1].mb.style.top);var e=this.mY[this.mY.length-1].mb,f=c;b=this.nZ&&!b?wac_bm(e.style.right):this.nZ||b?this.nZ&&b?-wac_bm(e.style.left)-f:-wac_bm(e.style.right)-f:wac_bm(e.style.left)}wac_9l(this.mb,"border-radius",this.xNa+"px");this.mb.style.top=a-d-c+"px";this.nZ?this.mb.style.right=b-d+"px":this.mb.style.left=b-d+"px";this.mb.parentNode||this._parent.insertBefore(this.mb,this._parent.firstChild)}else this.mb.parentNode&&this.mb.parentNode.removeChild(this.mb)}};
function wac_czb(a,b,c){this.wBa=Function.createDelegate(this,this.BVa);this.ei=[];this.Xx=[];this.dispose=this.ka;wac_czb.initializeBase(this,[a]);this.Dnb={};this.Vc=c;this.Hg=c.hk(Boolean,8);this.pN=c.hk(Boolean,11);a=c.hk(Number,12);this.K4=c.hk(Number,6);this.L3a=b;this.mb.id=String.format("{0}-{1}","presencetooltip",wac_dzb++);this.mb.className="prControl"+(this.Hg?"Rtl":"");a&&wac_ET(this,a);wac_Fyb(this,this.Hg);this.Vtc(b);this.j2=this.al("div");this.j2.className=this.pN?"prContainerV":"prContainerHr";
this.mb.appendChild(this.j2);this.$I=Array(this.yea);for(b=0;b<this.yea;b++)this.$I[b]=new wac_ezb(this.al("div"),this.Vc),this.$I[b].rwb(this.wBa),this.mb.appendChild(this.$I[b].mb)}
wac_czb.prototype={j2:null,yea:0,Hg:!1,b_a:!1,pN:!1,fub:!1,L3a:0,Vc:null,Dnb:null,B4b:function(){return wac_Ae(this.ei)},$I:null,k9b:null,K4:0,kO:function(){return this.pN?this.K4+2:this.L3a},zb:function(){return this.mb},ka:function(){if(this.$I)for(var a=this.$I,b=a.length,c=0;c<b;++c){var d=a[c];d.K5b(this.wBa);wac_Yb(d)}wac_1ba(this.Xx);this.Xx=this.$I=null;wac_DT.prototype.ka.call(this)},dHa:function(){this.nja();wac_fzb(this);this.sn(!0);this.b_a=!1},jhb:function(){!this.Xx||1>this.Xx.length||
(this.nja(),this.sn(!0),wac_fzb(this),wac_gzb(this,this.Xx[this.Xx.length-1],0),this.b_a=!0)},mOb:function(){if(this.Xx&&!(1>this.Xx.length)){this.sn(!0);wac_fzb(this);for(var a=0,b=this.Xx,c=b.length,d=0;d<c;++d)wac_gzb(this,b[d],a++);this.b_a=!1;this.fub=!0}},Zd:function(){this.sn(!1);this.nja();for(var a=0;a<this.Xx.length;a++)this.Xx[a].Zd();this.b_a=!1},uS:function(a){if(!(0>=this.yea)){a.$j||(a.$j=(wac_dzb++).toString());if(a.$j in this.Dnb){var b=this.sEa(a.$j);if(0<=b){b=this.ei[b];if(b.ps===
a.ps&&b.ap===a.ap)return;this.jka(a.$j)}}var b=wac_hzb(this),c,d=0;this.ei.length<this.yea?(c=new wac_izb(this.al("div"),this.Vc,a),c.rwb(this.wBa),this.Hg&&!this.pN&&0<this.ei.length?this.j2.insertBefore(c.mb,this.j2.firstChild):(this.j2.appendChild(c.mb),d=this.Xx.length),Array.add(this.Xx,c)):(this.Hg&&!this.pN?c=this.Xx[0]:(d=this.Xx.length-1,c=this.Xx[d]),c.uS(a));c.Hh();this.Dnb[a.$j]=c;Array.add(this.ei,a);this.pca(c,d);b&&this.mOb()}},jka:function(a){var b=wac_hzb(this);b&&this.nja();this.jgb(a);
this.ei.length>=this.yea&&this.Xx.length<this.yea&&wac_jzb(this);0>=this.ei.length?this.Zd():b&&this.mOb()},jgb:function(a){var b=this.sEa(a);0>b||(a=this.ei[b],Array.removeAt(this.ei,b),b=this.Dnb[a.$j],delete this.Dnb[a.$j],b.jka(a.$j),this.pca(b,0),0>=wac_LT(b)&&(this.j2.removeChild(b.mb),Array.remove(this.Xx,b),b.ka()))},sEa:function(a){for(var b=0;b<this.ei.length;b++)if(this.ei[b].$j===a)return b;return-1},nja:function(){for(var a=0;a<this.yea;a++)this.$I[a].Zd();this.fub=!1},BVa:function(a,
b){var c=window.$$as(wac_izb,a),c=c?wac_kzb(this,c):-1;if(2===b.fc||1===b.fc&&-1!==c&&!this.$I[c].Fm())wac_gzb(this,a,0);else if(1===b.fc)this.nja(),this.b_a=!1;else if(3===b.fc){if(this.Khc(b.L$b))return;this.b_a||this.nja()}this.Ya("InteractivityChanged",b,null)},Khc:function(a){a=a.$a.rawEvent;a=a.relatedTarget||a.toElement;for(var b=!1,c=this.$I,d=c.length,e=0;e<d;++e)if(wac_qd(c[e].mb,a)){b=!0;break}return this.j2!==a&&wac_qd(this.j2,a)||b},pca:function(a,b){var c;c=wac_kzb(this,a);(c=!!this.k9b&&
a===this.k9b&&-1!==c&&this.$I[c].Fm())&&0>=wac_LT(a)?this.$I[b].Zd():c?wac_gzb(this,a,0):this.$I[b].Zd()},Vtc:function(a){this.yea=a===this.K4?1:Math.floor(a/(this.K4+2));this.pN?(this.mb.style.height=a+"px",this.mb.style.width=this.K4+"px"):(this.mb.style.width=a+"px",this.mb.style.height=this.K4+"px")}};function wac_kzb(a,b){var c=0;a=a.Xx;for(var d=a.length,e=0;e<d;++e){if(b===a[e])return c;c++}return-1}
function wac_gzb(a,b,c){if(b)if(a.k9b=b,a.pN){var d=a.K4;if(1<b.ei.length)a.$I[c].Hh(b.ei,d,(a.pN?a.L3a:a.K4+2)-a.K4);else for(var e=a.j2.children.length,f=0;f<a.j2.children.length;f++)b.mb===a.j2.children[f]&&a.$I[c].Hh(b.ei,d,(a.pN?a.L3a:a.K4+2)-(e-f)*(a.K4+2)+2)}else a.$I[c].Hh(b.ei,a.kO(),0)}function wac_fzb(a){for(var b=0;b<a.Xx.length;b++)a.Xx[b].Hh()}
function wac_jzb(a){var b=a.Hg&&!a.pN?a.Xx[0]:a.Xx[a.Xx.length-1];!b||1>=b.ei.length||(b=Array.clone(a.ei),Array.forEach(b,function(b){a.jgb(b.$j)}),Array.forEach(b,function(b){a.uS(b)}))}function wac_hzb(a){if(!a.fub)return!1;for(var b=0,c=a.$I,d=c.length,e=0;e<d;++e)c[e].Fm()&&b++;a.fub=0<b&&(a.ei.length<=a.yea?b===a.ei.length:b===a.yea);return a.fub}function wac_lzb(a){this.Vc=a;wac_KT(this.Vc,10,wac_Gg());wac_KT(this.Vc,9,wac_Ig());wac_KT(this.Vc,6,16);wac_KT(this.Vc,13,wac_Tg())}
wac_lzb.prototype={Vc:null,Ufc:function(a){return new wac_czb(a,16,this.Vc)}};
function wac_ezb(a,b){this.DG=Function.createDelegate(this,this.P6);this.pk=Function.createDelegate(this,this.Gp);wac_ezb.initializeBase(this,[a]);this.nZ=b.hk(Boolean,8);this.rda=b.hk(Number,6);this.mb=a;this.mb.className=wac_mzb;this.w2b=this.al("ul");this.mb.appendChild(this.w2b);this.Jc=b.hk(wac_3c,10);this.Jc.Na("click",this.mb,this.pk);this.Ii=b.hk(wac_5c,9);this.Ii.Na("msospPointerOut",this.mb,this.DG);this.Ii.Na("msospPointerDown",this.mb,this.IR);this.Tw=b.hk(wac_nk,13);this.Tw.Na(this.mb,
this.IR)}
wac_ezb.prototype={Jc:null,Ii:null,Tw:null,w2b:null,rda:0,nZ:!1,rwb:function(a){this.hb("InteractivityChanged",a)},K5b:function(a){this.nd("InteractivityChanged",a)},lse:null,ka:function(){this.mb&&(this.Jc.yb("click",this.mb,this.pk),this.Ii.yb("msospPointerDown",this.mb,this.IR),this.Ii.yb("msospPointerOut",this.mb,this.DG),this.Tw.yb(this.mb,this.IR));wac_DT.prototype.ka.call(this)},Zd:function(){this.sn(!1)},Hh:function(a,b,c){this.Zd();if(a&&!(0>=a.length)){this.nZ?this.mb.style.right=b+"px":
this.mb.style.left=b+"px";this.mb.style.top=c+"px";this.lse=a;wac_pd(this.w2b);for(b=a.length-1;0<=b;b--)this.uS(a[b]);this.sn(!0)}},uS:function(a){var b=document.createElement("li");b.style.backgroundColor=a.ps;b.style.height=this.rda+"px";b.id="fly_"+a.$j;b.style.lineHeight=this.rda+"px";wac_rd(b,a.ap);b.setAttribute("dir","auto");this.w2b.appendChild(b)},Gp:function(){this.Zd();return!1},P6:function(a){this.Ya("InteractivityChanged",new wac_FT(3,a),null);return!1}};
function wac_izb(a,b,c){this.pk=Function.createDelegate(this,this.Gp);this.DG=Function.createDelegate(this,this.P6);this.b_=Function.createDelegate(this,this.Wja);this.ei=[];wac_izb.initializeBase(this,[a]);this.mb.className="prGlyph";this.Vc=b;this.iMa=this.Vc.hk(wac_5c,9);this.Qk=this.Vc.hk(wac_3c,10);this.Tw=this.Vc.hk(wac_nk,13);this.mb&&(this.iMa.Na("msospPointerDown",this.mb,this.IR),this.iMa.Na("msospPointerOver",this.mb,this.b_),this.iMa.Na("msospPointerOut",this.mb,this.DG),this.Qk.Na("dblclick",
this.mb,this.IR),this.Qk.Na("click",this.mb,this.pk),this.Tw.Na(this.mb,this.IR));this.uS(c);this.hWb=!1}
wac_izb.prototype={$ma:null,Vc:null,hWb:!0,Qk:null,iMa:null,Tw:null,rwb:function(a){this.hb("InteractivityChanged",a)},ka:function(){this.mb&&(this.iMa.yb("msospPointerDown",this.mb,this.IR),this.iMa.yb("msospPointerOver",this.mb,this.b_),this.iMa.yb("msospPointerOut",this.mb,this.DG),this.Qk.yb("dblclick",this.mb,this.IR),this.Qk.yb("click",this.mb,this.pk),this.Tw.yb(this.mb,this.IR));wac_DT.prototype.ka.call(this)},uS:function(a){Array.add(this.ei,a);2===wac_LT(this)?this.BT(!0):1===wac_LT(this)?
this.BT(!1):this.BT(this.hWb)},jka:function(a){var b;a:{for(b=0;b<wac_LT(this);b++)if(this.ei[b].$j===a){a=this.ei[b];Array.removeAt(this.ei,b);b=a;break a}b=null}b&&(1<wac_LT(this)&&this.BT(!0),1===wac_LT(this)?this.BT(!1):1>wac_LT(this)&&this.Zd())},Hh:function(){this.BT(2<=wac_LT(this));this.sn(!0)},Zd:function(){this.sn(!1)},BT:function(a){this.hWb!==a&&(this.$ma&&this.mb.removeChild(this.$ma),this.$ma=a?wac_nzb(this,0,5):wac_nzb(this,1,4),this.mb.appendChild(this.$ma),this.hWb=a);this.$ma.childNodes[0].style.backgroundColor=
this.ei[this.ei.length-1].ps},Wja:function(a){3!==a.Pe&&this.Ya("InteractivityChanged",new wac_FT(2,a),null);return!1},Gp:function(a){this.Ya("InteractivityChanged",new wac_FT(1,a),null);return!0},P6:function(a){3!==a.Pe&&this.Ya("InteractivityChanged",new wac_FT(3,a),null);return!1}};function wac_nzb(a,b,c){var d=a.Vc.hk(Number,6),e=a.Vc.hk(Object,14);return wac_2ja(d,d,a.Vc.hk(String,b),a.Vc.hk(String,c),"cui-img-cont-float cui-img-16by16","",!1,"",a.mb.ownerDocument,e?e.cloneNode(!0):null)}
function wac_LT(a){return a.ei.length}function wac_ozb(){this.eU={}}wac_ozb.prototype={hk:function(a,b){b=wac_g.wa.Usa.XVa.toString(b);return a===Number?(a=this.eU[b])?Number.parseInvariant(a.toString()):0:this.eU[b]},U:function(a,b,c){this.eU[wac_g.wa.Usa.XVa.toString(b)]=c}};function wac_KT(a,b,c){wac_g.wa.Usa.XVa.toString(b)in a.eU||(a.eU[wac_g.wa.Usa.XVa.toString(b)]=c)}wac_DT.registerClass("Common.App.CollabControls.BasePresenceControl",wac_cf,Sys.IDisposable);
wac_FT.registerClass("Common.App.CollabControls.InteractivityChangedEventArgs",Sys.EventArgs);wac_GT.registerClass("Common.App.CollabControls.ModernPresenceTooltipControl",wac_DT,wac_Dyb,Sys.IDisposable);(function(){}).registerClass("Common.App.CollabControls.ModernPresenceTooltipDancingDots");wac_Wyb.registerClass("Common.App.CollabControls.ModernPresenceTooltipFactory",null,wac_Eyb);wac_Lyb.registerClass("Common.App.CollabControls.ModernPresenceTooltipFlyoutControl",wac_DT);wac_Gyb.registerClass("Common.App.CollabControls.ModernPresenceTooltipPositioner");
wac_JT.registerClass("Common.App.CollabControls.FlyoutsPositioningInfo");wac_Iyb.registerClass("Common.App.CollabControls.ModernPresenceTooltipTarget");wac_czb.registerClass("Common.App.CollabControls.PresenceTooltipControl",wac_DT,wac_Dyb,Sys.IDisposable);wac_lzb.registerClass("Common.App.CollabControls.PresenceTooltipFactory",null,wac_Eyb);wac_ezb.registerClass("Common.App.CollabControls.PresenceTooltipFlyoutControl",wac_DT);
wac_izb.registerClass("Common.App.CollabControls.PresenceTooltipGlyph",wac_DT);wac_ozb.registerClass("Common.App.CollabControls.PresenceTooltipSettings");
var wac_Hyb=0,wac_Syb="http://www.w3.org/2000/svg",wac_Tyb="prDancingDots",wac_Vyb="prAnimateCircle",wac_Yyb="0 0 {0} {1}",wac_Ryb=40,wac_Qyb=120,wac_Xyb="prModernFlyout UIFont",wac_3yb="flyoutIdle",wac_0yb="flyoutExpanded",wac_2yb="flyoutCollapsed",wac_1yb="flyoutFromIdle",wac_4yb="flyoutFromExpanded",wac_6yb="flyoutFromCollapsed",wac_8yb="flyoutStacked",wac_5yb="flyoutFromStacked",wac_bzb="flyoutFadeOut",wac_azb="cui-img-cont-float cui-img-20by20",wac_$yb="flyoutLtrDir",wac_9yb="flyoutRtlDir",wac_dzb=
0,wac_mzb="prFlyout UIFont";Type.registerNamespace("RealtimePresenceUI");function wac_pzb(){}wac_pzb.registerInterface("RealtimePresenceUI.IUserTracker");
function wac_qzb(a,b,c,d){this.d$d=Function.createDelegate(this,this.tPe);this.Aga=Function.createDelegate(this,this.Jua);this.X1b=new (wac_$a.$$(Number));this.dispose=this.ka;this.an=a;this.UVa=b;if(c){var e=this;c.CW(function(){e.ED=c.Ob();e.ED.ua.hb("UU",e.Aga);wac_rzb(e)})}if(d){var f=this;d.CW(function(){f.oIa=d.Ob();f.oIa.cdf(f.Aga);wac_rzb(f)})}this.K$e=new wac_ym(this.an.$j,"Anonymous user","#cccccc",new wac_zm(7),null,null,null,null,!1,!1,!1,0,null,0);this.eCb=this.HWb=!0;this.TUb=this.TMc=
!1;this.sX=wac_szb(this.an.$j,this.an.IQa,a.x5c)}function wac_tzb(a,b){return a.Xq.xW(1)&&b.Xq.xW(1)||!a.Xq.xW(1)&&!b.Xq.xW(1)?a.ap.localeCompare(b.ap)-wac_1f:a.Xq.xW(1)?-1:1}
wac_qzb.prototype={K$e:null,HWb:!1,TMc:!1,TUb:!1,an:null,sX:null,UVa:null,ED:null,oIa:null,eCb:!1,dJb:function(){return 0<this.sX.s1.ja()},Dwc:function(a){wac_(4482395,325,50,"PeoplesWell: Received user button click");a=a.MenuItemId;if(!a)return!1;var b=this.an.FBb(a);if(!wac_uzb(this,a,b,!0))return!1;wac_vzb(this,b);return!0},Jua:function(){if(!this.TUb){var a=this;window.setTimeout(function(){wac_rzb(a);a.TUb=!1},3E3);this.TUb=!0}},tPe:function(a,b,c,d,e){wac_ab(this.X1b,e.RenderTime);return 32},
ka:function(){this.ED&&(this.ED.ua.nd("UU",this.Aga),this.ED=null);this.oIa&&(this.oIa.Hif(this.Aga),this.oIa=null)}};
function wac_rzb(a){a.TMc||(wac_ab(a.X1b,(new Date).getTime()),wac_(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"));var b;b=(a.ED?wac_CT(a.ED):[])||[];for(var c=b.length,d=0;d<c;++d){var e=b[d];if(!e.Jf()){var f=wac_Xd().toString();e.$j=f}e.ap||wac_Lqa(e,"Anonymous user");e.Xq||(e.Xq=new wac_zm(0));e.aO()||e.T5b("#cccccc");e.Q4||(e.Q4=0)}c=a.sX;c.s1=new (wac_La.$$(Array));d=b.length;for(e=0;e<d;++e)if(f=b[e],f.Jf()===c.XG){c.zgc=f;break}d=
b.length;for(e=0;e<d;++e)f=b[e],f.Jf()!==c.XG&&c.Gad(f);a.eCb&&1<=a.sX.s1.ja()&&(wac_(6092429,325,50,"PeoplesWell: User is no longer forever alone."),a.eCb=!1);a.HWb=!0;a.eLd(a.an.ha())}
function wac_wzb(){var a=wac_xzb;wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_s(wac_q.Z,"CoauthorGalleryTelemetryIsEnabled")&&wac_y().ra(691867605,2147483648,a.d$d);a.fa.ra(a.an.Vc.c9b,1,a.d7d);wac_B(a.fa,a.an.Vc.g9b,1,a.Qie,96);wac_B(a.fa,a.an.Vc.e9b,1,a.wXd,96);wac_B(a.fa,a.an.Vc.d9b,1,a.vXd,96);wac_B(a.fa,a.an.Vc.f9b,1,a.qge,96);a.fa.ra(a.an.Vc.h9b,1,a.Ppe);wac_B(a.fa,a.an.Vc.N3c,1,a.gge,96);a.TMc=!0;wac_rzb(a)}
function wac_yzb(){return wac_q.Z&&wac_s(wac_q.Z,"ColorPresenceHashIsEnabled")?"Initials":"Menu32"}function wac_zzb(){var a;return a=new wac_Xf,a.Id="BasicChat",a.Command="2288458806",a.LabelText=CommonUIStrings.l_StartGroupChat,a.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",a}
function wac_Azb(a,b){if(!b.Xq.xW(1))return b.ft?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;var c=b.ft,d=a.an.IQa(b.Jf());b=a.an.FBb(b.Jf());if(!d)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(d.Oc){case 1:var e;if(b){if(c)a=CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline;else{var f,g;a=((g=wac_Bzb(a,b,f={val:e}),e=f.val,g)&&e.rh()&&e.rh().h5&&"0"!==e.rh().h5?String.format(WordEditorIntl.WordEditorStrings.l_PresenceStatusOnPage,
e.rh().h5):CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown)||CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}e=a}else e=CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;return e;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}
function wac_uzb(a,b,c,d){if(!c)return d&&wac_(4482393,325,50,"User does not have any presence data"),!1;if(wac_Czb(a,c)){var e,f,g;(g=wac_Bzb(a,c,f={val:e}),e=f.val,g)&&a.Ysd(e.ml().gC(),e.ml().SG.Se())?c=!0:(wac_(41236613,325,50,"Cannot jump to user location because paragraph has not been loaded yet"),c=!1)}else wac_(41236612,325,50,"Cannot jump to user location because presence is not valid"),c=!1;return c?(a=a.an.IQa(b))&&2===a.Oc?!1:!0:(d&&wac_(4482394,325,50,"User has presence data but app can't use it"),
!1)}function wac_Dzb(a,b,c,d,e){this.Vc=a;this.$j=b;this.x5c=e;this.FBb=c||function(){return null};this.IQa=d||function(){return null}}function wac_Ezb(a,b,c,d){var e=wac_s(wac_q.Z,"WordEditorPresenceDedupeMultipleCoauthorInstances");return new wac_Dzb(a,b,c,d,e)}wac_Dzb.prototype={Vc:null,ha:function(){return this.Vc.Yb},MVc:function(){return this.Vc.ADb},K4b:function(){return this.Vc.M9c},uVc:function(){return this.Vc.W7c},$j:null,FBb:null,IQa:null,x5c:!1};
function wac_Fzb(a){this.s1=new (wac_La.$$(Array));this.XG=a}wac_Fzb.prototype={XG:null,zgc:null};function wac_Gzb(a,b,c){b=b.toUpperCase();var d,e,f;(f=a.s1.qc(b,e={val:d}),d=e.val,f)||(d=[],a.s1.W(b,d));Array.add(d,c)}function wac_Hzb(a){for(var b=[],c=a.s1.Yk().$$ge();c.$$mn();){var d=c.$$cu(),d=a.Qmd(d);Array.add(b,d)}return b}function wac_szb(a,b,c){return c?new wac_Izb(a,b):new wac_Jzb(a)}function wac_Izb(a,b){wac_Izb.initializeBase(this,[a]);this.hzd=b}
wac_Izb.prototype={hzd:null,Gad:function(a){a.Ru||!a.eq?wac_Gzb(this,a.Jf(),a):this.zgc&&wac_qa().za(this.zgc.eq,a.eq)||wac_Gzb(this,a.eq,a)},Qmd:function(a){for(var b=new Date(0),c=0<a.length?a[0]:null,d=a.length,e=0;e<d;++e){var f=a[e],g=this.hzd(f.$j);g&&b.getTime()<g.xFa.getTime()&&(b=g.xFa,c=f)}return c}};function wac_Jzb(a){wac_Jzb.initializeBase(this,[a])}wac_Jzb.prototype={Gad:function(a){wac_Gzb(this,a.Jf(),a)},Qmd:function(a){return a[0]}};
wac_qzb.registerClass("RealtimePresenceUI.APeoplesWell",null,wac_tc,Sys.IDisposable);wac_Dzb.registerClass("RealtimePresenceUI.PeoplesWellSettings");wac_Fzb.registerClass("RealtimePresenceUI.UserTracker",null,wac_pzb);(function(){}).registerClass("RealtimePresenceUI.UserTrackerFactory");wac_Izb.registerClass("RealtimePresenceUI.UniqueUserTracker",wac_Fzb);wac_Jzb.registerClass("RealtimePresenceUI.UserInstanceTracker",wac_Fzb);Type.registerNamespace("AppRealtimeChannel");
wac_Nn=window.AppRealtimeChannel||{};function wac_Kzb(){}wac_Kzb.registerInterface("AppRealtimeChannel.IConnectedUsageKpiLogger");window.AppRealtimeChannel.ApiType=wac_Nn.z$a=function(){};wac_Nn.z$a.prototype={SendNotification:0,SendPersistentState:1,Last:2};window.AppRealtimeChannel.ApiType.registerEnum("AppRealtimeChannel.ApiType",!1);window.AppRealtimeChannel.EventCountType=wac_Nn.RDe=function(){};
wac_Nn.RDe.prototype={AttemptCount:0,SuccessCount:1,DropCount:2,FailedCount:3,LatencyOverThresholdCount:4,LatencyUnderThresholdCount:5,ThrottledCount:6,Last:7};window.AppRealtimeChannel.EventCountType.registerEnum("AppRealtimeChannel.EventCountType",!1);function wac_Lzb(){}wac_Lzb.registerInterface("AppRealtimeChannel.IFrequentLoggingMetrics");function wac_Mzb(){}wac_Mzb.registerInterface("AppRealtimeChannel.IAssignRtcMachineStrategy");function wac_Nzb(){}wac_Nzb.registerInterface("AppRealtimeChannel.IRealtimeChannel");
function wac_Ozb(){}wac_Ozb.registerInterface("AppRealtimeChannel.IRealtimeChannelMetrics");function wac_Pzb(){}wac_Pzb.registerInterface("AppRealtimeChannel.IRealtimeChannelClientProxy");function wac_Qzb(){}wac_Qzb.registerInterface("AppRealtimeChannel.IRealtimeChannelServerProxy");function wac_Rzb(){}wac_Rzb.registerInterface("AppRealtimeChannel.IRealtimeChannelEventHub");function wac_Szb(){}wac_Szb.registerInterface("AppRealtimeChannel.IRealtimeChannelSettings");function wac_Tzb(){}wac_Tzb.registerInterface("AppRealtimeChannel.IMessageStatus");
function wac_Uzb(){}wac_Uzb.registerInterface("AppRealtimeChannel.IMessageHandler");function wac_Vzb(){}wac_Vzb.registerInterface("AppRealtimeChannel.IThrottle");function wac_Wzb(){}wac_Wzb.registerInterface("AppRealtimeChannel.IThrottleMaxRate");function wac_Xzb(){}wac_Xzb.registerInterface("AppRealtimeChannel.IMaxOutstandingThrottler");function wac_Yzb(){}wac_Yzb.registerInterface("AppRealtimeChannel.IThrottlerFactory");function wac_Zzb(){}wac_Zzb.registerInterface("AppRealtimeChannel.IThrottlerManager");
function wac__zb(a){this.Zce=Function.createDelegate(this,this.KTe);this.Xee=Function.createDelegate(this,this.EVe);this.k6d=Function.createDelegate(this,this.xJe);this.Mqa=Function.createDelegate(this,this.fP);this.ds=a;this.ds.Hfa(this.Mqa)}wac__zb.prototype={ds:null,l4a:null,kaa:0,CQa:!1,fP:function(a,b){this.kaa=b.BL},EVe:function(){wac_(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");wac_0zb(this.ds)},xJe:function(a){this.l4a.ob(a)}};
function wac_1zb(a){this.R7d=Function.createDelegate(this,this.pMe);this.WCa=wac_2zb;this.MBa=wac_3zb;this.C7c=this.R7d;this.Cn=a}function wac_2zb(a,b){return window.setTimeout(a,b)}function wac_3zb(a){window.clearTimeout(a)}wac_1zb.prototype={WU:!1,FNa:0,zAc:!1,Cn:null,WCa:null,MBa:null,C7c:null,pMe:function(){wac_(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Cn)},fW:function(){this.WU&&this.MBa(this.FNa);this.FNa=0;this.WU=!1}};
function wac_4zb(a){a.fW();a.zAc||(a.zAc=!0,a.C7c())}function wac_5zb(a){a.WU||(a.FNa=a.WCa(function(){a.WU=!1;wac_4zb(a)},8E3),a.WU=!0,a.zAc=!1)}function wac_6zb(){}wac_6zb.prototype={N7c:0,M7c:0,L7c:0,g6c:0,jCb:!1,J$b:null,a$b:null,Vra:null,ZI:null,l_:null};
function wac_7zb(a,b,c,d,e,f,g,h,k,l,m,n){function p(){var c=m?m():wac_q.Ik,c=String.format("{0}={1}","qs",wac_eg(c)),c=String.format("{0}&{1}={2}",c,"ClientId",wac_eg(g)),c=String.format("{0}&{1}={2}",c,"usid",wac_eg(a)),c=String.format("{0}&{1}={2}",c,"UserApp",wac_eg(f.toString())),c=String.format("{0}&{1}={2}",c,"UserType",wac_eg((1).toString())),c=String.format("{0}&{1}={2}",c,"UserVersion",wac_eg(e)),c=String.format("{0}&{1}={2}",c,"clientProtocol",wac_eg("1.0")),d;(d=4===f?String.format("{0}={1}",
"NoAuth","1"):b?wac_Fla():null)&&(c=String.format("{0}&{1}",c,d));return c}this.pje=Function.createDelegate(this,this.Dld);this.Mqa=Function.createDelegate(this,this.fP);this.tke=Function.createDelegate(this,this.U0e);this.DEd=(new Date(0)).getTime();this.Ubf="enabled errorMessage url connectionString queryString throttling_globalMaxNumberOfOutstandingMessages throttling_maxNumberOfOutstandingMessages throttling_timeToWaitForResponse throttling_messageDelay".split(" ");this.Tbf=["enabled","errorMessage"];
this.hc=d;this.Gd=b;this.Cmb=c;this.KDc=p();this.Cn=h;this.ds=k;this.SZa=n;this.LDc=!1;this.$Ba=9E4;if(l){var q=this;l.ub(function(a){a.y3b(function(){wac_(40768456,500,50,"Connection parameters refresh requested for client [{0}]",q.Cn);q.KDc=p();q.Dld()})})}}function wac_8zb(a,b,c,d,e,f,g,h,k,l){a=a||wac_Xd().toString();a=new wac_7zb(a,b,c,d,e,1,f,g,h,k,null,l);a.ob();return a}
wac_7zb.prototype={KDc:null,Cmb:null,Gd:null,lGd:0,NXb:!1,Hob:!1,hc:null,ds:null,Cn:null,aNd:null,PYa:1E3,SZa:null,LDc:!1,OCa:null,kaa:0,g5c:null,F7c:null,y5a:function(){return this.F7c},ZI:null,$Ba:0,ob:function(){this.ds.ua.hb("RMID",this.tke);this.ds.Hfa(this.Mqa)},fP:function(a,b){this.kaa=b.BL},Dld:function(){this.NXb=!1;var a=this,b=this;this.AHb(function(b){var d=a.g5c!==b.Vra,e=a.ZI!==b.ZI;wac_9zb(a,b);a.kaa&&(e?(wac_(17956955,500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",
a.ZI||"null",b.ZI),wac_0zb(a.ds)):(a.ds.ua.Ya("SPC",new wac_$zb(d,e),null),wac_aAb(a)))},function(){wac_aAb(b)},!0)},U0e:function(){this.PYa=1E3},AHb:function(a,b,c){var d=this.Cmb+"?"+this.KDc,e=null;wac_(4317445,500,50,"Getting MachineId from server for [{0}]",this.Cn);var f={};f["X-CorrelationId"]=wac_Xd().toString();var g={};g.IsNetworkOfflineBeforeSendRequest=this.Gd.R$;g.HasAvailableConnectionsBeforeSendRequest=wac_wla(this.Gd);g.MaxConnectionsAllowed=this.Gd.rRa;g.IsRefreshMachineId=c;this.SZa&&
!this.LDc?(wac_bAb(this,wac_cAb(this,null,g,a,b,c),wac_dAb(this,null,g,b,c)),this.LDc=!0):(this.hc&&(e=this.hc.Me("WebServiceCall","GetMachineIdFromTheServer")),wac_Rj(this.Gd,d,1,null,f,["RtcErrorCode","RtcGracefulShutdownInProgress"],1,wac_cAb(this,e,g,a,b,c),wac_dAb(this,e,g,b,c),null,this.$Ba,"3",!1,null,null))}};function wac_eAb(a,b,c){b||(b={});b.ConnectionState=wac_g.nFb.toString(a.kaa);c||a.ds.ua.Ya("RCF",new wac_fAb(1,b),null)}
function wac_gAb(a,b,c,d){d||(d={});d.IsNetworkOfflineAfterRequestComplete=a.Gd.R$;d.IsRequestSucceeded=c;b&&(d.EnqueueTime=b.k0,d.InvokedTime=b.aB,d.CompletedTime=b.HO,b.zl&&"X-CorrelationId"in b.zl&&(d.CorrelationId=b.zl["X-CorrelationId"]));wac_(38633565,500,c?50:15,wac_MT(d))}
function wac_dAb(a,b,c,d,e){return function(f){b&&b.kd();a.Hob=!1;wac_gAb(a,f.Oa,!1,c);var g=null,h="unknown",k="unknown";if(f.Oa){if(h=f.Oa.zl)"RtcErrorCode"in h&&(g=h.RtcErrorCode.toString()),"RtcGracefulShutdownInProgress"in h&&(a.Hob=!0);h=wac_g.lka.toString(f.Oa.Oc);k=f.Oa.mj.toString()}c.FindSessionFailureReason="FindSessionRequestFailed";c.HttpErrorCode=k;c.HttpErrorStatus=h;c.RtcErrorCode=g;c.RtcGracefulShutdownInProgress=a.Hob.toString();wac_(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}', RtcGracefulShutdownInProgress='{4}'",
h,k,a.Cn,g,a.Hob);wac_eAb(a,c,e);d(g)}}
function wac_cAb(a,b,c,d,e,f){return function(g){b&&b.kd();wac_gAb(a,g.Oa,!0,c);if(g=wac_hAb(g.Oa.re,"FindSession",null,!0)){var h;if(Object.getType(g)!==Object)h=null;else{for(var k in g);b:if("enabled"in g){for(var l=(k=g.enabled)?a.Ubf:a.Tbf,m=l.length,n=0;n<m;++n)if(!(l[n]in g)){h=null;break b}l=(h=new wac_6zb,h.jCb=g.enabled,h.J$b=g.errorMessage,h.l_=wac_Xd().toString(),h);k&&(l.a$b=g.url,l.Vra=g.queryString,l.ZI=g.connectionString,l.g6c=g.throttling_globalMaxNumberOfOutstandingMessages,l.L7c=
g.throttling_maxNumberOfOutstandingMessages,l.M7c=g.throttling_timeToWaitForResponse,l.N7c=g.throttling_messageDelay);h=l}else h=null}if(h){if(h.jCb&&h.Vra&&h.ZI){wac_(4317446,500,50,"Successfully retrieved MachineId from server for [{0}]",a.Cn);d(h);return}c.FindSessionFailureReason="FindSessionInvalidResponse";c.IsRtcEnabled=h.jCb;c.IsQueryStringEmpty=!h.Vra;c.IsConnectionStringEmpty=!h.ZI;wac_(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",
a.Cn,h.jCb,!h.Vra,!h.ZI)}else c.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",wac_(8745097,500,15,"Could not translate server response to findSession response for [{0}]",a.Cn)}else c.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",wac_(7372827,500,10,"Could not deserialize response data for [{0}]",a.Cn);wac_eAb(a,c,f);e(null)}}
function wac_bAb(a,b,c){wac_(50448152,500,50,"Using FindSessionUtils find session response");a.SZa.gUb.yc.CW(function(){a.SZa.gUb.yc.Ob()?(wac_(50448153,500,50,"FindSessionUtils find Session resulted in success"),b(a.SZa.zBb)):(wac_(50448154,500,15,"FindSessionUtils find Session resulted in error"),c(a.SZa.zBb))})}function wac_iAb(a){a.NXb&&(window.clearTimeout(a.lGd),a.NXb=!1)}function wac_aAb(a){wac_iAb(a);a.NXb=!0;a.lGd=window.setTimeout(a.pje,24E4)}
function wac_9zb(a,b){try{a.OCa=b,a.F7c=b.a$b+"?"+b.Vra,a.ZI=b.ZI,a.g5c=b.Vra,a.aNd=b.a$b}catch(c){wac_(17956953,500,10,"FindSession response contains invalid fields. Exception {0}, is thrown",c.toString())}}function wac_jAb(a){var b=(new Date).getTime();a=a.DEd+a.PYa-b;0>a&&(a=0);return a}
function wac_kAb(a,b,c,d,e){wac_(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}] OrderlyShutdownInprogress is [{1}]",a.ZI,a.Hob);if(a.ZI)b();else{var f=wac_jAb(a);window.setTimeout(function(){d(e,"RequestMachineId")&&(a.DEd=(new Date).getTime(),a.AHb(function(c){wac_9zb(a,c);wac_aAb(a);b()},function(b){a.ZI=null;wac_iAb(a);c(b)},!1))},f)}}
function wac_lAb(a,b,c,d,e,f){wac_kAb(a,function(){e(f,"GetMachineIdSuccess")&&(wac_(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",a.ZI,a.Cn),b(a.aNd),d(new wac_mAb(a.OCa.N7c,a.OCa.M7c,a.OCa.L7c,a.OCa.g6c)))},function(b){e(f,"GetMachineIdFailure")&&(wac_(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",a.Cn),c(b))},e,f)}function wac_nAb(a,b){b.val=a.OCa.l_;return String.format("{0}&{1}={2}",a.OCa.Vra,"corrid",wac_eg(b.val))}
function wac_oAb(a){this.Q7d=Function.createDelegate(this,this.oMe);this.Gd=a;this.vq=Array(2);for(a=0;2>a;a++){this.vq[a]=Array(7);for(var b=0;7>b;b++)this.vq[a][b]=0}this.vBb=this.RDc=this.gYb=!1}
wac_oAb.prototype={vBb:!1,vq:null,Gd:null,gYb:!1,RDc:!1,IJc:0,iGd:0,oMe:function(){if(this.gYb){if((new Date).getTime()-this.IJc<5E3+this.iGd){for(var a={},b=0;2>b;b++)for(var c=0;7>c;c++){var d=window.AppRealtimeChannel.ApiType.toString(b)+window.AppRealtimeChannel.EventCountType.toString(c);a[d]=this.vq[b][c]}a=wac_on(a);wac_(50644352,500,15,a)}this.IJc=(new Date).getTime();for(a=0;2>a;a++)for(b=0;7>b;b++)this.vq[a][b]=0;this.gYb=!1}}};
function wac_NT(a,b,c){a.RDc&&!a.vBb&&window.navigator.onLine&&!a.Gd.R$&&(a.vq[b][c]++,a.gYb=!0)}function wac_pAb(a,b){a.iGd=b;window.setInterval(a.Q7d,b);a.IJc=(new Date).getTime()}
function wac_qAb(a,b,c,d,e,f,g,h,k,l,m,n){this.bXd=Function.createDelegate(this,this.Fve);this.w3c=Function.createDelegate(this,this.cqd);this.iae=Function.createDelegate(this,this.tjd);this.MXd=Function.createDelegate(this,this.Hwe);this.Xde=Function.createDelegate(this,this.SUe);this.Wde=Function.createDelegate(this,this.RUe);this.aee=Function.createDelegate(this,this.WUe);this.epe=Function.createDelegate(this,this.T7e);this.gfe=Function.createDelegate(this,this.QVe);this.hfe=Function.createDelegate(this,
this.RVe);this.K1d=Function.createDelegate(this,this.GGb);this.uK=new (wac_La.$$(wac_Ha.$$(wac_Nn.Jfb,wac_rAb)));this.GIc=(new Date(0)).getTime();this._clientId=a;this.Avb=b;this.XM=0;this.hc=d;this.RRb=h;this.JMa=g;this.mx=k;this.iud=e;this.YHa=f;this.Cn=c;this.vq=l;this.Vc=m;this.Gd=n}function wac_sAb(a,b,c,d,e,f,g,h){return wac_tAb(a,b,c,d,e,f,g,h)}
wac_qAb.prototype={_clientId:null,OX:null,XM:0,Vc:null,y5a:function(){return this.YHa.y5a()},iud:null,wkb:1,ZT:null,Avb:null,hc:null,RRb:null,YHa:null,JMa:null,Cn:null,vq:null,Gd:null,mx:null,ob:function(){this.mx.ua.hb("RC",this.K1d);this.mx.ua.hb("UPSR",this.hfe);this.mx.ua.hb("UPSC",this.gfe);wac_Pj(this.Gd,this.vq);var a=this;wac_Bh(function(){a.vq.sld()});wac_uAb(this);wac_vAb();this.mx.ua.hb("SPC",this.epe)},cqd:function(a,b){return a!==this.wkb?(wac_(4309017,500,15,"ConnectionToken verification failed for {0}",
b),!1):!0},VFb:function(){2!==this.XM&&1!==this.XM&&(wac_(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Cn),wac_5zb(this.RRb),this.fP(1,this.XM),wac_wAb(this),wac_OT&&(wac_OT.vBb=!1))},tjd:function(a){this.vq.mld();var b=null;!a||"documentsessiondeleted"!==(b=a.toLowerCase())&&"documentsessionexpired"!==b?this.GGb():(wac_(41788292,500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Cn,a),this.pTa())},
GGb:function(){wac_(4309018,500,50,"Disconnecting the connection [{0}]",this.OX);var a=2===this.XM||1===this.XM;(a=a&&!this.JMa.CQa)&&this.fP(1,this.XM);++this.wkb;this.JMa.qX();wac_xAb(this);var b=this.YHa;b.ZI=null;wac_iAb(b);b.PYa+=3E3;b.PYa=Math.min(b.PYa,3E5);wac_uAb(this);a&&wac_wAb(this)},T7e:function(){var a=null,b,c,d=(c=wac_nAb(this.YHa,b={val:a}),a=b.val,c);this.ZT.qs=d;wac_(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Cn,a)},Hwe:function(a){this.GIc=
(new Date).getTime();var b=null,c,d;this.ZT.qs=(d=wac_nAb(this.YHa,c={val:b}),b=c.val,d);this.Vc.o9b&&(this.ZT.url=a,wac_(51655757,500,50,"Using [{0}] url for SignalR connection",wac_ti(a)));var e=null;this.hc&&(e=this.hc.Me("WebServiceCall","ConnectToServer"));wac_(3290048,500,50,"Connecting to server for client [{0}]",this.Cn);a={};this.Avb&&(a.transport=1===this.Avb.length?this.Avb[0]:this.Avb);var f=this,g=this;this.ZT.start(a,null).done(function(a){f.vq.nld();wac_(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",
a.id,b)}).fail(function(a){wac_(3457858,500,15,"Failed to connect to server : connection string: {0}, machine connection string: {1}, CorrelationId:{2}, callback parameter:{3} for [{4}]",g.YHa.ZI,g.y5a(),b,wac_MT(a),g.Cn);g.tjd(null);g.vq.lld(a);a={CorrelationId:b,ErrorDetails:a,ConnectionState:wac_g.nFb.toString(g.XM)};g.mx.ua.Ya("RCF",new wac_fAb(0,a),null)}).always(function(){e&&e.kd()})},pTa:function(){this.XM?(this.vq.old(),wac_OT&&(wac_OT.vBb=!0),wac_(36545633,500,50,"Starting explicit disconnect for [{0}]",
this.Cn),this.JMa.CQa=!0,this.RRb.fW(),this.fP(0,this.XM),this.GGb(),this.JMa.CQa=!1):wac_(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Cn)},CZ:function(){return this.XM},Hfa:function(a){this.mx.Hfa(a)},Syb:function(a){this.mx.Syb(a)},$md:function(a){return this.QGa(0,a)},QGa:function(a,b){var c=new (wac_$a.$$(Object));this.mx.ua.Ya("SP",new wac_yAb(a,b,c),null);return c.yc},fOa:function(a){this.mx.fOa(a)},Ifa:function(a){this.mx.Ifa(a)},qPa:function(a){this.mx.qPa(a)},
c5a:function(a){this.mx.c5a(a)},O5b:function(a){this.mx.O5b(a)},z3b:function(a){this.mx.z3b(a)},N5b:function(a){this.mx.N5b(a)},BHe:function(a){return this.uK.kb(a)&&this.uK.B(a).kb(0)?this.uK.B(a).B(0).VBa:null},Nia:function(){return this.xta(0)},xta:function(a){for(var b={},c=this.uK.GetEnumerator();c.$$mn();){var d=c.$$cu();d.pa().kb(a)&&(b[d.Ke()]=d.pa().B(a).VBa)}return b},RVe:function(a,b){for(a=b.G$c.GetEnumerator();a.$$mn();){var c=a.$$cu();this.uK.kb(c.Ke())||this.uK.W(c.Ke(),new (wac_Ha.$$(wac_Nn.Jfb,
wac_rAb)));var d=c.pa();this.uK.B(c.Ke()).W(b.fc,new wac_rAb(d.Presence,new Date(d.TimeStamp)));c.Ke()!==this._clientId||b.fc||this.mx.psc(d.Presence)}},QVe:function(a,b){a=b.oQa;b=a.length;for(var c=0;c<b;++c)this.uK.Db(a[c])},sM:function(a,b,c){var d=new (wac_$a.$$(Object));this.mx.ua.Ya("SUN",new wac_zAb(a,b,c,d),null);return d.yc},C3:function(a){this.mx.C3(a)},Tyb:function(a){this.mx.Tyb(a)},vfd:function(a){var b,c,d,e,f,g;(e=this.uK.qc(a,d={val:b}),b=d.val,e)&&(g=b.qc(0,f={val:c}),c=f.val,g)?
(a=(a=c)&&a.RDb?(new Date).getTime()-a.RDb.getTime()>(this.Vc.F9b?6E4:this.Vc.E9b)?2:1:1,c=new wac_Sja(a,c.RDb)):c=null;return c},$bb:function(){for(var a={},b=this.uK.GetEnumerator();b.$$mn();){var c=b.$$cu(),d,e,f;if(f=c.pa().qc(0,e={val:d}),d=e.val,f)a[c.Ke()]=this.vfd(c.Ke())}return a},Jf:function(){return this._clientId},fP:function(a,b){if((1!==this.XM||b||1!==a)&&this.XM!==b){var c=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.XM,
b,a]));wac_(3290053,500,10,c)}if(this.XM!==a){switch(a){case 2:wac_OT&&(wac_OT.RDc=!0);this.OX=this.ZT.id;wac_(3249539,500,50,"Established connection [{0}] for client [{1}]",this.OX,this.Cn);if((c=this.ZT)&&c.transport&&c.transport.name){var c=c.transport.name,d=c.toLowerCase();"websockets"===d?wac_(4290723,500,50,"Transport name - {0} for [{1}]",c,this.Cn):"serversentevents"===d?wac_(4290752,500,50,"Transport name - {0} for [{1}]",c,this.Cn):"foreverframe"===d?wac_(4290753,500,50,"Transport name - {0} for [{1}]",
c,this.Cn):"longpolling"===d?wac_(4290754,500,50,"Transport name - {0} for [{1}]",c,this.Cn):"mocktransport"!==d&&wac_(4290755,500,15,"Unknown transport protocol encountered - '{0}'",c)}else wac_(4290722,500,10,"Transport protocol name is missing");wac_(4298369,500,50,"Retrieving complete session state");c=null;this.hc&&(c=this.hc.Me("WebServiceCall","Receive First Presence"));var d=this.mx,e=this.w3c,f=this.wkb,g=this.RRb,h=this.bXd;var k=new (wac_Ha.$$(wac_Nn.Jfb,Object));if(this.uK.kb(this._clientId))for(var l=
this.uK.B(this._clientId).$$ge();l.$$mn();){var m=l.$$cu();k.W(m.Ke(),m.pa().VBa)}d.ua.Ya("RPS",new wac_AAb(e,f,g,h,k,c),null);break;case 1:2===b&&wac_(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.OX);break;case 0:if(this.JMa.CQa)wac_(3249543,500,50,"Connection [{0}] has been explicitly closed",this.OX);else{1===b&&(wac_(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",
this.OX),this.vq.pld());2===b&&wac_(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",this.OX);this.GGb();return}}this.XM=a;this.mx.ua.Ya("CSC",new wac_Pja(a,b),null)}},WUe:function(){wac_(3249544,500,50,"Detected that the connection [{0}] is slow",this.OX)},RUe:function(a){wac_(3249545,600,10,"SignalR ERROR for connection [{0}]: {1}",this.OX,wac_MT(a)||"<empty>")},SUe:function(){},Fve:function(){var a,
b=[],c,d;(d=this.uK.qc(this._clientId,c={val:a}),a=c.val,d)&&this.uK.Db(this._clientId);for(d=this.uK.Wg().$$ge();d.$$mn();)c=d.$$cu(),Array.add(b,c);d=b.length;for(var e=0;e<d;++e)c=b[e],this.uK.Db(c);a&&this.uK.W(this._clientId,a);this.mx.ua.Ya("IPSC",new wac_Mi(b),null)}};function wac_BAb(a){switch(a){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",a,"Unknown SignalR state");}}
function wac_CAb(a){var b=0;a.ZT.state||(b=a.GIc+15E3-(new Date).getTime(),0>b&&(b=0));return b}function wac_xAb(a){function b(){d.stop(!0,!0)}var c=wac_CAb(a),d=a.ZT;a=a.OX;0<c?(wac_(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",a,c),window.setTimeout(b,c)):(wac_(36804372,500,50,"Stopping connection [{0}].",a),b())}function wac_wAb(a){var b=a.wkb;a.vq.kld();wac_lAb(a.YHa,a.MXd,a.iae,a.JMa.k6d,a.w3c,b)}
function wac_uAb(a){var b=++a.wkb;a.GIc=(new Date(0)).getTime();a.ZT=a.iud();a.mx.ua.Ya("RP",new wac_DAb(a.ZT),null);a.ZT.stateChanged(function(c){a.cqd(b,"StateChangedSignalR")&&a.fP(wac_BAb(c.newState),wac_BAb(c.oldState))});a.ZT.connectionSlow(a.aee);a.ZT.error(a.Wde);a.ZT.log=a.Xde}function wac_EAb(){return function(){return!1}}
function wac_vAb(){try{var a=$.signalR;if(!a)throw Error.invalidOperation("Failed to retrieve Signalr object");var b=a.version;if(!b)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===b){var c=a.transports;if(!c)throw Error.invalidOperation("Failed to retrieve transports object");var d=c.longPolling;if(!d)throw Error.invalidOperation("Failed to retrieve longPolling object");if(!d.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");
d.supportsKeepAlive=wac_EAb()}}catch(e){wac_(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",e.message)}}function wac_rAb(a,b){this.VBa=a;this.RDb=b}wac_rAb.prototype={VBa:null,RDb:null};
function wac_tAb(a,b,c,d,e,f,g,h){var k=null,l=null,m=wac_FAb(),n=wac_q.Br?wac_q.Br:"1.0",p=wac_GAb(a,b),q=m.Y9b?wac_HAb(p):new wac_IAb,r;wac_OT||(wac_OT=new wac_oAb(d));r=wac_OT;m.p9c&&wac_pAb(r,m.o9c);var t="",t=g&&""!==g?g:"/rtc2/";wac_(51655758,500,50,"Using [{0}] url for findSession and initial hubConnection",wac_ti(t));var u=t+"signalr";g=t+"findsession";t=new wac_JAb;l=l||wac_KAb||(wac_KAb=new wac_LAb);r=new wac_MAb(m,new wac_NAb(t),a,p,function(a){return new wac_OAb(a.createHubProxy("realtimeChannelHub"))},
f,l,q,r);k||(k=wac_8zb(b,d,g,f,n,a,p,l,e,h));k.$Ba=m.$Ba;b=new wac_1zb(p);c=c?c.split(","):null;a=new wac_qAb(a,c,p,f,function(){return window.$.hubConnection(u)},k,r,b,l,q,m,d);a.ob();return a}function wac_GAb(a,b){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",a,wac_PAb(wac_Nn.Atc.toString(1)),wac_PAb(wac_Nn.Btc.toString(1)),b)}function wac_PAb(a){return a?a.charAt(0).toLocaleUpperCase()+a.substring(1,a.length):a}function wac_QAb(){}
function wac_HAb(a){wac_RAb||(wac_RAb=new wac_QAb,wac_(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",a));return wac_RAb}
wac_QAb.prototype={$Kc:0,Vqb:0,OHd:0,MHd:0,NHd:0,RHd:0,QHd:0,PHd:0,UZa:null,hUb:null,EIc:null,J0a:null,jpb:null,kya:null,FIc:null,PIc:null,OIc:null,upb:null,ZIc:null,kUb:null,wtd:0,YMd:0,Zpb:0,TJc:0,kld:function(){this.$Kc++;this.EIc=new Date;this.UZa||(this.UZa=new Date)},nld:function(){this.Vqb++;this.kya=new Date;this.hUb||(this.hUb=this.kya);this.upb=this.kya;this.UZa&&1===this.Vqb&&(this.Zpb=Math.max(this.Zpb,this.kya.getTime()-this.UZa.getTime()));this.J0a&&1<this.Vqb&&(this.Zpb=Math.max(this.Zpb,
this.kya.getTime()-this.J0a.getTime()));this.jpb&&1<this.Vqb&&(this.TJc=Math.max(this.TJc,this.kya.getTime()-this.jpb.getTime()))},mld:function(){this.OHd++;this.FIc=new Date},pld:function(){this.MHd++;this.J0a=new Date},old:function(){this.NHd++;this.jpb=new Date},wsc:function(){this.PIc=new Date;this.RHd++},agb:function(){this.kUb||(this.kUb=new Date);this.QHd++},vGa:function(){this.OIc=new Date;this.PHd++},LGd:!1,sld:function(){!this.LGd&&this.$Kc&&(wac_(39321871,500,15,wac_on({numberOfConnectionAttempts:this.$Kc,
numberOfSuccessfulConnections:this.Vqb,numberOfFailedConnections:this.OHd,numberOfDisconnectedConnections:this.MHd,numberOfExplicitDisconnectedConnections:this.NHd,numberOfSentMessages:this.RHd,numberOfReceivedMessages:this.QHd,numberOfLostMessages:this.PHd,firstConnectionAttempt:this.UZa?this.UZa:null,firstMessageReceived:this.kUb?this.kUb:null,firstConnectionSuccess:this.hUb?this.hUb:null,lastConnectionAttempt:this.EIc?this.EIc:null,lastConnectionSuccess:this.kya?this.kya:null,lastConnectionFailure:this.FIc?
this.FIc:null,lastMessageSent:this.PIc?this.PIc:null,lastMessageLost:this.OIc?this.OIc:null,lastDisconnect:this.J0a?this.J0a:null,lastExplicitDisconnect:this.jpb?this.jpb:null,lastTimeOnline:this.upb?this.upb:null,lastTimeOffline:this.ZIc?this.ZIc:null,maxDisconnectedTimeMs:this.Zpb,maxExplicitDisconnectedTimeMs:this.TJc,clientConnectionErrors:this.wtd,serverConnectionErrors:this.YMd})),this.LGd=!0)},lld:function(a){var b,c,d,e=b={val:b},f=c={val:c},g=d={val:d};e.val=0;f.val=null;g.val=null;if(a)try{var h=
a.source;h&&Object.getType(h)===String&&(g.val=h);var k=a.context;k&&(a=k,e.val=a.status?a.status:0,f.val=a.statusText?a.statusText:null)}catch(l){}b=b.val;c=c.val;d=d.val;b&&200!==b&&(wac_(40157596,500,15,wac_on({HttpErrorCode:b,HttpErrorStatus:c,Exception:d})),400<=b&&499>=b&&this.wtd++,500<=b&&599>=b&&this.YMd++)},JFa:function(){this.ZIc=new Date},KFa:function(){this.J0a=this.upb=new Date}};function wac_IAb(){}
wac_IAb.prototype={kld:function(){},nld:function(){},mld:function(){},pld:function(){},old:function(){},wsc:function(){},agb:function(){},vGa:function(){},sld:function(){},lld:function(){},JFa:function(){},KFa:function(){}};function wac_OAb(a){this.rp=a}wac_OAb.prototype={rp:null,sM:function(a,b){return this.rp.invoke("SendUpdateNotification",a,b)}};function wac_SAb(){}
function wac_FAb(){var a=wac_q.Z;if(!a){var b;return b=new wac_SAb,b.q4c=!1,b.F9b=!1,b.E9b=9E5,b.o9b=!1,b.T8c=5E3,b.dbc=!0,b.Acc=!1,b.Y9b=!1,b.$Ba=9E4,b}var c;return c=new wac_SAb,c.q4c=wac_s(a,"AwayStatusManagerIsEnabled"),c.F9b=wac_s(a,"AwayStatusOneMinuteTimeoutIsEnabled"),c.E9b=wac_D(a,"AwayCoauthorThresholdMs",9E5),c.o9b=wac_s(a,"RtcAllowCrossDomainAccessEnabled"),c.T8c=wac_D(a,"RTCReconnectionSlowDurationMilliseconds",5E3),c.dbc=wac_s(a,"RTCLogUpdateNotificationHintOnDeserializationFailure"),
c.Acc=wac_s(a,"ShouldLogOnContentNotification"),c.Y9b=wac_s(a,"RtcClientMetricsEnabled"),c.$Ba=wac_D(a,"RtcFindSessionRequestTimeoutInMS",6E4),c.p9c=wac_s(a,"RtcJsClientFrequentlyLogsMetrics"),c.rcc=wac_D(a,"RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),c.o9c=wac_D(a,"RtcJsClientFrequentMetricsLogIntervalInMS",3E5),c}wac_SAb.prototype={q4c:!1,F9b:!1,E9b:0,o9b:!1,T8c:0,dbc:!1,Acc:!1,Y9b:!1,$Ba:0,p9c:!1,rcc:0,o9c:0};function wac_LAb(){this.ua=new wac_cf}
wac_LAb.prototype={ua:null,psc:function(a){this.ua.Ya("MPU",new wac_Qja(a),null)},Hfa:function(a){this.ua.hb("CSC",a)},Syb:function(a){this.ua.nd("CSC",a)},Ifa:function(a){this.ua.hb("PU",a)},qPa:function(a){this.ua.nd("PU",a)},fOa:function(a){this.ua.hb("MPU",a)},C3:function(a){this.ua.hb("UNR",a)},Tyb:function(a){this.ua.nd("UNR",a)},c5a:function(a){this.ua.hb("PSU",a)},O5b:function(a){this.ua.nd("PSU",a)},z3b:function(a){this.ua.hb("PSC",a)},N5b:function(a){this.ua.nd("PSC",a)}};
function wac_0zb(a){a.ua.Ya("RC",null,null)}function wac_yAb(a,b,c){wac_yAb.initializeBase(this);this.fc=a;this.oC=b;this.O9a=c}wac_yAb.prototype={fc:0,oC:null,O9a:null};function wac_zAb(a,b,c,d){wac_zAb.initializeBase(this);this.fc=a;this.F$c=b;this.v5c=c;this.O9a=d}wac_zAb.prototype={fc:0,F$c:null,v5c:!1,O9a:null};function wac_DAb(a){wac_DAb.initializeBase(this);this.x6c=a}wac_DAb.prototype={x6c:null};
function wac_AAb(a,b,c,d,e,f){wac_AAb.initializeBase(this);this.sdc=a;this.WAb=b;this.f5c=c;this.M$b=e;this.W4c=d;this.YCa=f}wac_AAb.prototype={YCa:null,M$b:null,W4c:null,f5c:null,WAb:0,sdc:null};function wac_TAb(a,b){wac_TAb.initializeBase(this);this.fc=a;this.G$c=b}wac_TAb.prototype={fc:0,G$c:null};function wac_UAb(a){wac_UAb.initializeBase(this);this.oQa=a}wac_UAb.prototype={oQa:null};function wac_$zb(a,b){wac_$zb.initializeBase(this);this.Iqe=a;this.xre=b}wac_$zb.prototype={Iqe:!1,xre:!1};
function wac_fAb(a,b){wac_fAb.initializeBase(this);this.Uqe=a;this.J$b=b}wac_fAb.prototype={Uqe:0,J$b:null};function wac_VAb(a){wac_VAb.initializeBase(this);this.Nre=a}wac_VAb.prototype={Nre:null};
function wac_MAb(a,b,c,d,e,f,g,h,k){this.zga=Function.createDelegate(this,this.Iua);this.O6a=Function.createDelegate(this,this.GLb);this.yga=Function.createDelegate(this,this.Vja);this.NI=Function.createDelegate(this,this.iP);this.vle=Function.createDelegate(this,this.QGa);this.qbe=Function.createDelegate(this,this.QRe);this.rbe=Function.createDelegate(this,this.RRe);this.tbe=Function.createDelegate(this,this.TRe);this.sbe=Function.createDelegate(this,this.SRe);this.I8b=Function.createDelegate(this,
this.sM);this.Wce=Function.createDelegate(this,this.ITe);this.PMc=new (wac_Ha.$$(wac_Nn.kib,Object));wac_MAb.initializeBase(this,[g]);this.Vc=a;this.ZKc=this.XKc=0;this.l4a=b;this.l4a.A3b(this.Xee);this._clientId=c;this.IKd=e;this.ds.ua.hb("RP",this.Zce);this.ds.ua.hb("RPS",this.Wce);this.ds.ua.hb("SUN",this.I8b);this.ds.ua.hb("IPU",this.sbe);this.ds.ua.hb("IUNR",this.tbe);this.ds.ua.hb("IPSU",this.rbe);this.ds.ua.hb("IPSC",this.qbe);this.ds.ua.hb("SP",this.vle);this.hc=f;this.Cn=d;this.vq=h;this.aK=
k}
wac_MAb.prototype={Vc:null,rp:null,XKc:0,ZKc:0,dGd:!1,_clientId:null,IKd:null,hc:null,fYb:0,Cn:null,vq:null,aK:null,KTe:function(a,b){this.rp=this.IKd(b.x6c);this.l4a.Pc();this.rp.rp.on("presenceUpdated",this.NI);this.rp.rp.on("persistentStateUpdated",this.yga);this.rp.rp.on("persistentStateCleared",this.O6a);this.rp.rp.on("updateNotification",this.zga)},fP:function(a,b){this.kaa=b.BL;if(2===b.BL){for(a=this.PMc.$$ge();a.$$mn();)b=a.$$cu(),this.sM(null,new wac_zAb(b.Ke(),b.pa(),!1,new (wac_$a.$$(Object))));this.PMc=
new (wac_Ha.$$(wac_Nn.kib,Object))}},ITe:function(a,b){b.W4c();for(a=0;2>a;++a)wac_WAb(this,a,b)},QGa:function(a,b){a=b.oC;var c=wac_XAb(a),d=b.O9a,e=new (wac_La.$$(window.Common.PresenceDataEntryForClients)),f;e.W(this._clientId,(f=new window.Common.PresenceDataEntryForClients,f.Presence=a,f.TimeStamp=(new Date).getTime(),f));this.ds.ua.Ya("UPSR",new wac_TAb(b.fc,e),null);wac_NT(this.aK,1,0);if(2!==this.kaa)this.vq.vGa(),wac_NT(this.aK,1,2),d.Ie(null);else{var g=this.fYb.toString();++this.fYb;var h=
this;f=new wac_YAb(function(){return wac_ZAb(h,b.fc,c,g)},g);f=wac__Ab(this.l4a,"0,"+b.fc).U(f);var k=this;wac_0Ab(f,function(a){2===a&&wac_NT(k.aK,1,6);d.Ie(null)});wac_1Ab(f,function(){})}},sM:function(a,b){var c=b.fc;a=b.F$c;var d=b.v5c,e=b.O9a,f=wac_XAb(a);wac_NT(this.aK,0,0);if(2!==this.kaa)d?this.PMc.W(c,a):(this.vq.vGa(),wac_NT(this.aK,0,2)),e.Ie(null);else{var g=this.fYb.toString();++this.fYb;var h=this;b=new wac_YAb(function(){return wac_2Ab(h,c,f,g)},g);b=wac__Ab(this.l4a,"1,"+c).U(b);var k=
this;wac_0Ab(b,function(a){2===a&&wac_NT(k.aK,0,6);e.Ie(null)});wac_1Ab(b,function(){})}},qX:function(){this.rp.rp.off("presenceUpdated",this.NI);this.rp.rp.off("persistentStateUpdated",this.yga);this.rp.rp.off("persistentStateCleared",this.O6a);this.rp.rp.off("updateNotification",this.zga)},SRe:function(a,b){this.iP(b.mS,b.U7a)},iP:function(a){this.vq.agb();this.Vja(0,a)},RRe:function(a,b){this.Vja(b.fc,b.mS)},Vja:function(a,b){this.vq.agb();wac_3Ab(this,a,b,null)},QRe:function(a,b){this.GLb(b.oQa)},
GLb:function(a){this.vq.agb();if(wac_ha.d1(500,100))for(var b=0;b<a.length;++b);a.length&&(this.ds.ua.Ya("UPSC",new wac_UAb(a),null),this.ds.ua.Ya("PSC",new wac_Mi(a),null),this.ds.ua.Ya("PU",new wac_Ji({},a,null),null))},TRe:function(a,b){this.Iua(b.sg,b.qpa)},Iua:function(a,b){this.Vc.Acc&&!a&&wac_(40128990,500,100,"Received ContentUpdate notification from the server");this.vq.agb();5===a?(wac_(18637071,500,50,"Received client reconnection request from the server - rebooting the client connection"),
wac_0zb(this.ds)):(b=wac_hAb(b,String.format("UpdateNotification-{0}",wac_Nn.kib.toString(a)),null,this.Vc.dbc),this.ds.ua.Ya("UNR",new wac_Rja(a,b),null))}};
function wac_3Ab(a,b,c,d){if(wac_ha.d1(500,100))for(var e in c);delete c[a._clientId];if(!wac_Rf(c)){for(var f in c){e={key:f,value:c[f]};var g=e.key;c[g]=wac_hAb(e.value,"Presence",g,!1)}f=new (wac_La.$$(window.Common.PresenceDataEntryForClients));var h=(new Date).getTime(),k;for(k in c){e={key:k,value:c[k]};var g=e.key,l;if(d)l=d[g],l.Presence=e.value;else{var m;l=(m=new window.Common.PresenceDataEntryForClients,m.Presence=e.value,m.TimeStamp=h,m)}f.W(g,l)}a.ds.ua.Ya("UPSR",new wac_TAb(b,f),null);
b?a.ds.ua.Ya("PSU",new wac_Li(b,c),null):(a.dGd||(wac_(4539734,500,50,"Raising first presence update notification for [{0}]",a.Cn),a.dGd=!0,wac_q.qm&&(wac_q.qm.IsCoauthSession=!0)),a.ds.ua.Ya("PU",new wac_Ji(c,[],null),null))}}
function wac_2Ab(a,b,c,d){var e=null,f=new wac_4Ab,g=new wac_PT;wac_(3249505,500,50,"Sending update notification for [{0}]",a.Cn);if(2!==a.kaa)return a.vq.vGa(),wac_NT(a.aK,0,2),wac_(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",a.Cn),wac_5Ab(g),g;a.hc&&3===b&&20>a.ZKc&&(e=a.hc.Me("WebServiceCall","Send WetContent Update"),a.ZKc++);f.Yd();wac_QT(g.mLa,1);a.rp.sM(b,c).done(function(){a.vq.wsc();wac_NT(a.aK,0,1);wac_(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",
d,a.Cn);wac_QT(g.Ena,1);f&&(f.kd(),f.Vg()>a.Vc.rcc?wac_NT(a.aK,0,4):wac_NT(a.aK,0,5))}).fail(function(b){a.CQa||(a.vq.vGa(),wac_NT(a.aK,0,3),wac_(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",d,wac_MT(b),a.Cn));wac_QT(g.Ena,2)}).always(function(){e&&e.kd()});return g}
function wac_ZAb(a,b,c,d){var e=null,f=new wac_4Ab,g=new wac_PT;wac_(3249501,500,50,"Sending presence update for [{0}]",a.Cn);if(2!==a.kaa)return a.vq.vGa(),wac_NT(a.aK,1,2),wac_(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",a.Cn),wac_5Ab(g),g;a.hc&&20>a.XKc&&(e=a.hc.Me("WebServiceCall","Send Presence Message"),a.XKc++);f.Yd();wac_QT(g.mLa,1);a.rp.rp.invoke("UpdatePersistentState",b,c).done(function(){a.vq.wsc();wac_NT(a.aK,1,1);wac_(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",
d,a.Cn);wac_QT(g.Ena,1);f&&(f.kd(),f.Vg()>a.Vc.rcc?wac_NT(a.aK,1,4):wac_NT(a.aK,1,5))}).fail(function(b){a.CQa||(a.vq.vGa(),wac_NT(a.aK,1,3),wac_(3249503,500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",d,wac_MT(b),a.Cn));wac_QT(g.Ena,2)}).always(function(){e&&e.kd()});return g}
function wac_WAb(a,b,c){try{a.rp.rp.invoke("GetCompletePersistentStateWithMetadata",b).done(function(d){if(c.sdc(c.WAb,"GetCompletePresenceSuccess")){wac_4zb(c.f5c);wac_(3249540,500,50,"Successfully retrieved complete session state for [{0}]",a.Cn);a.ds.ua.Ya("RMID",null,null);var e={},f;for(f in d){var g={key:f,value:d[f]};e[g.key]=g.value.Presence}wac_3Ab(a,b,e,d);a.ds.ua.Ya("CPSWM",new wac_VAb(d),null);c.M$b.kb(b)&&(d=c.M$b.B(b),e=new (wac_$a.$$(Object)),a.ds.ua.Ya("SP",new wac_yAb(b,d,e),null))}}).fail(function(b){c.sdc(c.WAb,
"GetCompletePresenceFail")&&(wac_(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}]",wac_MT(b),a.Cn),wac_0zb(a.ds))}).always(function(){c.YCa&&c.YCa.kd()})}catch(d){wac_(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",c.WAb,d.message)}}
function wac_XAb(a){var b;try{b=wac_Ui(a)}catch(c){throw a=String.format("Failed to JSON-serialize payload : {0}",c),wac_(18637072,500,10,a),Error.argument("payload",a);}if(8E3<b.length)throw a=String.format("Payload exceeds maximum length: {0} > {1} : {2}",b.length,8E3,b),wac_(18637074,500,10,a),Error.argument("payload",a);return b}
function wac_hAb(a,b,c,d){if(!a)return null;if(Object.getType(a)!==String){var e;if(d)try{e=wac_XAb(a)}catch(f){e=String.format("Failed to JSON serialize the object with exception [{0}]",f)}else e="not allowed to log the object";a=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}]. Object: [{3}].",b,Object.getType(a).getName(),c,e);wac_(18637075,500,10,a);return null}e=null;try{e=wac_Ci(a)}catch(f){a=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}]. Object: [{3}]",
b,f,c,d?a:"not allowed to log the object"),wac_(18637077,500,10,a)}return e}function wac_MT(a){if(!a)return"";if(String.isInstanceOfType(a))return a.toString();try{return wac_Ui(a)}catch(b){return a.toString()}}function wac_4Ab(){}wac_4Ab.prototype={Bh:null,RQc:null,Vg:function(){return this.Bh?this.RQc?this.RQc.getTime()-this.Bh.getTime():(new Date).getTime()-this.Bh.getTime():0},Yd:function(){this.Bh=new Date},kd:function(){this.RQc=new Date}};
function wac_PT(){this.mLa=new (wac_RT.$$(wac_g.dnc));this.Ena=new (wac_RT.$$(wac_g.bnc))}wac_PT.prototype={mLa:null,Ena:null};function wac_5Ab(a){wac_QT(a.mLa,2);wac_QT(a.Ena,2)}function wac_1Ab(a,b){a.Ena.Rja(b)}function wac_0Ab(a,b){a.mLa.Rja(b)}function wac_RT(){this.fud=this.Mb["AppRealtimeChannel.CompletionTask$1"].T===Number||Type.isEnum(this.Mb["AppRealtimeChannel.CompletionTask$1"].T)?0:this.Mb["AppRealtimeChannel.CompletionTask$1"].T===Boolean?!1:null}
wac_RT.$$=function(a){var b=wac_Nn.__tc=wac_Nn.__tc||{},c="CompletionTask$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_RT.apply(this,a)};d.registerClass("AppRealtimeChannel.__tc."+c);d.prototype.Mb={"AppRealtimeChannel.CompletionTask$1":{T:a},ctor:wac_RT};a=wac_RT.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};
wac_RT.prototype={Rja:function(a){this.$qa=a;wac_6Ab(this)},sAc:!1,Ssd:!1,$qa:null};function wac_6Ab(a){a.sAc&&a.$qa&&!a.Ssd&&(a.Ssd=!0,a.$qa(a.fud))}function wac_QT(a,b){a.sAc||(a.sAc=!0,a.fud=b,wac_6Ab(a))}function wac_YAb(a,b){this.MMd=a;this.zre=b}wac_YAb.prototype={eX:function(){return this.MMd()},zre:null,MMd:null};function wac_7Ab(a,b){this.wPc=a;this.Zcc=b;this.WCa=wac_8Ab;this.cAa=this.gvb=this.Plb=0}function wac_8Ab(a,b){return window.setTimeout(a,b)}
wac_7Ab.prototype={cAa:0,gvb:0,Plb:0,wPc:null,aya:!1,V1b:null,k4a:null,A0a:!1,Zcc:null,WCa:null};function wac_9Ab(a,b){a.aya=!1;a.k4a&&b&&(a.Plb++,wac_5Ab(a.k4a));a.V1b=null;a.k4a=null}function wac_$Ab(a,b,c){a.gvb++;wac_9Ab(a,!0);a.aya=!0;a.V1b=b;a.k4a=c}
function wac_aBb(a){0<a.cAa&&0<a.Plb&&wac_(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",a.Zcc,a.Plb,a.cAa);0<a.cAa&&0<a.gvb&&wac_(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",a.Zcc,a.gvb,a.cAa)}function wac_bBb(a,b){this.yle=Function.createDelegate(this,this.G2e);wac_bBb.initializeBase(this,[a,b]);this.Q0a=(new Date(0)).getTime();this.u$b=function(){return(new Date).getTime()}}
wac_bBb.prototype={qbc:0,Q0a:0,u$b:null,ob:function(a){this.A0a||(this.qbc=a,this.A0a=!0)},U:function(a){this.A0a||this.ob(200);this.cAa++;var b=this.u$b(),c=new wac_PT;this.Q0a>b&&(this.Q0a=b);this.aya?(wac_9Ab(this,!0),wac_$Ab(this,a,c)):this.Q0a+this.qbc<=b?this.Ggb(a,c):(wac_$Ab(this,a,c),this.WCa(this.yle,this.Q0a+this.qbc-b));return c},G2e:function(){if(this.aya){var a=this.V1b,b=this.k4a;wac_9Ab(this,!1);this.Ggb(a,b)}},Ggb:function(a,b){this.Q0a=this.u$b();a=this.wPc(a);wac_0Ab(a,function(a){wac_QT(b.mLa,
a)});wac_1Ab(a,function(a){wac_QT(b.Ena,a)})}};function wac_cBb(a,b){this.zle=Function.createDelegate(this,this.H2e);this.Ybe=Function.createDelegate(this,this.vSe);this.ua=new wac_cf;wac_cBb.initializeBase(this,[a,b]);this.Uqb=0;this.lvb=[];this.MBa=wac_dBb}function wac_dBb(a){window.clearTimeout(a)}
wac_cBb.prototype={Yod:0,lbc:0,MBa:null,Uqb:0,lvb:null,z0a:!1,MRc:0,SRb:0,kSb:0,U:function(a){this.A0a||this.ob(15E3,5);this.cAa++;var b=new wac_PT;this.aya?wac_$Ab(this,a,b):this.Uqb<this.lbc?this.Ggb(a,b):(wac_$Ab(this,a,b),this.z0a=!1);return b},Ggb:function(a,b){a=this.wPc(a);var c=this.WCa(this.Ybe,this.Yod);++this.Uqb;Array.add(this.lvb,c);var d=this.SRb;wac_0Ab(a,function(a){wac_QT(b.mLa,a)});var e=this;wac_1Ab(a,function(a){e.SRb===d&&(e.SRb===d&&(--e.Uqb,e.MBa(c),Array.remove(e.lvb,c),e.aya&&
e.aya&&!e.z0a&&(e.MRc=e.WCa(e.zle,0),e.z0a=!0)),wac_QT(b.Ena,a))})},H2e:function(){this.z0a=!1;if(this.aya){var a=this.V1b,b=this.k4a;wac_9Ab(this,!1);this.Ggb(a,b)}},vSe:function(){++this.kSb;var a=Math.floor(this.lbc/2);this.kSb>a&&(this.kSb=-1E9,this.ua.Ya("TMUDM",null,null))},A3b:function(a){this.ua.hb("TMUDM",a)},Pc:function(){this.cAa=this.gvb=this.Plb=this.kSb=0;++this.SRb;for(var a=this.lvb,b=a.length,c=0;c<b;++c)this.MBa(a[c]);this.Uqb=0;this.lvb=[];wac_9Ab(this,!0);this.z0a&&(this.MBa(this.MRc),
this.MRc=0,this.z0a=!1)},ob:function(a,b){this.A0a||(this.Yod=a,this.lbc=b,this.A0a=!0)}};function wac_JAb(){}wac_JAb.prototype={};function wac_eBb(a,b){return new wac_bBb(a,b)}function wac_fBb(a,b){return new wac_cBb(a,b)}function wac_NAb(a){this.ua=new wac_cf;this.YXb=new (wac_La.$$(wac_Wzb));this.VXb=new (wac_La.$$(wac_Xzb));this.Fcf=a;this.q_a=wac_fBb(function(a){return a.eX()},"GlobalMaxOustandingThrottler");var b=this;this.q_a.A3b(function(){b.ua.Ya("TMUDM",null,null)})}
wac_NAb.prototype={Fcf:null,YXb:null,VXb:null,q_a:null,Vc:null,Yw:!1,ob:function(a){this.Yw||(this.Vc=a,this.q_a.ob(this.Vc.$cc,this.Vc.f6c),this.Yw=!0)},Pc:function(){for(var a=this.YXb.GetEnumerator();a.$$mn();){var b=a.$$cu();wac_aBb(b.pa())}for(a=this.VXb.GetEnumerator();a.$$mn();)b=a.$$cu(),wac_aBb(b.pa()),b.pa().Pc();wac_aBb(this.q_a);this.q_a.Pc()},A3b:function(a){this.ua.hb("TMUDM",a)}};
function wac__Ab(a,b){a.Yw||a.ob(new wac_mAb(200,15E3,5,1E3));var c,d,e;if(e=a.YXb.qc(b,d={val:c}),c=d.val,!e){var f,g,h;(h=a.VXb.qc(b,g={val:f}),f=g.val,h)||(f="MaxOutstandingThrottler-"+b,c=a.q_a,f=wac_fBb(c.h6b||(c.h6b=Function.createDelegate(c,c.U)),f),f.ob(a.Vc.$cc,a.Vc.K7c),f.A3b(function(){a.ua.Ya("TMUDM",null,null)}),a.VXb.U(b,f));c="MaxRateThrottler-"+b;c=wac_eBb(f.h6b||(f.h6b=Function.createDelegate(f,f.U)),c);c.ob(a.Vc.S7c);a.YXb.U(b,c)}return c}
function wac_mAb(a,b,c,d){this.S7c=a;this.$cc=b;this.K7c=c;this.f6c=d}wac_mAb.prototype={S7c:0,$cc:0,K7c:0,f6c:0};wac__zb.registerClass("AppRealtimeChannel.ARtcMessageHandler");wac_1zb.registerClass("AppRealtimeChannel.ConnectedUsageKpiLogger",null,wac_Kzb);wac_6zb.registerClass("AppRealtimeChannel.FindSessionResponse");wac_7zb.registerClass("AppRealtimeChannel.FindSessionStrategy",null,wac_Mzb);wac_oAb.registerClass("AppRealtimeChannel.FrequentLoggingMetrics",null,wac_Lzb);
wac_qAb.registerClass("AppRealtimeChannel.RealtimeChannel",null,wac_Nzb,wac_uc);wac_rAb.registerClass("AppRealtimeChannel.RealtimeChannel.PresenceData");(function(){}).registerClass("AppRealtimeChannel.RealtimeChannel.RealtimeChannelFactory");wac_QAb.registerClass("AppRealtimeChannel.RealtimeChannelMetrics",null,wac_Ozb,wac_Pc);wac_IAb.registerClass("AppRealtimeChannel.NoopRealtimeChannelMetrics",null,wac_Ozb,wac_Pc);wac_OAb.registerClass("AppRealtimeChannel.RealtimeChannelProxy",null,wac_Pzb,wac_Qzb);
wac_SAb.registerClass("AppRealtimeChannel.RealtimeChannelSettings",null,wac_Szb);wac_LAb.registerClass("AppRealtimeChannel.RtcEventHub",null,wac_Rzb);wac_yAb.registerClass("AppRealtimeChannel.SendPersistentStateEventArgs",Sys.EventArgs);wac_zAb.registerClass("AppRealtimeChannel.SendUpdateNotificationEventArgs",Sys.EventArgs);wac_DAb.registerClass("AppRealtimeChannel.RefreshProxyEventArgs",Sys.EventArgs);wac_AAb.registerClass("AppRealtimeChannel.RefreshAllPersistentStateEventArgs",Sys.EventArgs);
wac_TAb.registerClass("AppRealtimeChannel.UpdatePersistentStateRequestEventArgs",Sys.EventArgs);wac_UAb.registerClass("AppRealtimeChannel.UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs);wac_$zb.registerClass("AppRealtimeChannel.SessionPropertiesChangedEventArgs",Sys.EventArgs);wac_fAb.registerClass("AppRealtimeChannel.RtcConnectFailedEventArgs",Sys.EventArgs);wac_VAb.registerClass("AppRealtimeChannel.GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs);
wac_MAb.registerClass("AppRealtimeChannel.RtcMessageHandler",wac__zb);(function(){}).registerClass("AppRealtimeChannel.RtcUtils");wac_4Ab.registerClass("AppRealtimeChannel.SimpleStopwatch");wac_PT.registerClass("AppRealtimeChannel.MessageStatus",null,wac_Tzb);wac_YAb.registerClass("AppRealtimeChannel.MessageHandler",null,wac_Uzb);wac_7Ab.registerClass("AppRealtimeChannel.ThrottlerBase");wac_bBb.registerClass("AppRealtimeChannel.MaxRateThrottler",wac_7Ab,wac_Wzb,wac_Vzb);
wac_cBb.registerClass("AppRealtimeChannel.MaxOutstandingThrottler",wac_7Ab,wac_Xzb,wac_Vzb);wac_JAb.registerClass("AppRealtimeChannel.ThrottlerFactory",null,wac_Yzb);wac_NAb.registerClass("AppRealtimeChannel.ThrottlerManager",null,wac_Zzb);wac_mAb.registerClass("AppRealtimeChannel.ThrottlerManagerSettings");var wac_OT=null,wac_RAb=null,wac_KAb=null;Type.registerNamespace("RealtimePresenceUI");
function wac_gBb(a,b,c,d){this.gge=Function.createDelegate(this,this.sXe);this.Ppe=Function.createDelegate(this,this.G8e);this.qge=Function.createDelegate(this,this.EXe);this.vXd=Function.createDelegate(this,this.iwe);this.wXd=Function.createDelegate(this,this.jwe);this.Qie=Function.createDelegate(this,this.n_e);this.d7d=Function.createDelegate(this,this.yKe);this.Qpe=Function.createDelegate(this,this.H8e);this.rge=Function.createDelegate(this,this.FXe);this.Rie=Function.createDelegate(this,this.o_e);
wac_gBb.initializeBase(this,[a,c,d,null]);this.xda=function(){return!0};this.fa=b}
wac_gBb.prototype={xda:null,fa:null,o_e:function(a){if(this.HWb){this.eCb||(a[wac_ST.Visible]=!0);var b,c,d,e,f,g=b={val:b},h=c={val:c},k=d={val:d},l=e={val:e},m=f={val:f},n,p,q,r;2<=this.sX.s1.ja()?r=[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,this.sX.s1.ja())]:1===this.sX.s1.ja()?(n=wac_Hzb(this.sX)[0],r=(p=this.an.IQa(n.Jf()))&&2===p.Oc?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,n.ap]:[n.ft?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,
n.ap]):r=[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself];this.sX.s1.ja()?1===this.sX.s1.ja()?(n=!0,p=this.an.MVc().H7a,q=wac_Hzb(this.sX)[0].aO()):(n=!0,p=this.an.uVc().H7a,q=""):(n=!1,q=p="");g.val=r[0];h.val=r.slice(1);k.val=n;l.val=p;m.val=q;b=b.val;c=c.val;d=d.val;e=e.val;f=f.val;a[wac_ST.LabelText]=b;c&&c.length&&(a[wac_ST.LabelTextUserGeneratedPlaceholderReplacements]=c);a.ImageIsVisible=d;a[wac_ST.Image16by16Class]=e;a.ImageBackColor=f;this.HWb=!1}return!0},FXe:function(a){if(0>=this.sX.s1.ja())a=
!1;else{var b=wac_Hzb(this.sX),c=[];Array.addRange(c,b);c.sort(wac_tzb);for(var b=[],d=c.length,e=0;e<d;++e){var f=c[e],g=String.format("buttonPeoplesWellUser-{0}",f.Jf()),h=f.Jf(),k=wac_Azb(this,f),l=f.ap,m=f.aO(),n=void 0,g=(n=new wac_0m,n.Id=g,n.Command=this.an.Vc.h9b.toString(),n.LabelText="{0}",n.Image32by32=this.an.K4b().Z9b,n.Image32by32Class=this.an.K4b().H7a,n.MenuItemId=h,n.CommandValueId=h,n.Alt=l,n.DisplayMode=wac_yzb(),n.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",
n.Description=k,n.ImageBackColor=m,n.IsAnonymous=f.Ru,n.LabelTextUserGeneratedPlaceholderReplacements=wac_hBb([l]),n.Upn=f.eq,n);wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")&&this.UVa&&(n=this.UVa.pGb(f.eq,"O365",wac_q.Ik,0),h=this.an.IQa(f.Jf()),h=!h||h&&1===h.Oc?!0:!1,g.ImageUrl=n,g.ActiveStatus=h,g.JoinTimeInMS=f.Q4,h=wac_uzb(this,f.Jf(),this.an.FBb(f.Jf()),!1),f=this.oIa?this.oIa.ded(f.Jf()):f.Xq.xW(4),g.CanJump=h,g.ChatCapable=f,""===n&&wac_(40969413,302,50,"ImageURL collection failed"));
Array.add(b,g)}var p,c=(p=new wac_Jf,p.Id="menuCoauthors",p.MaxWidth="220px",p.MenuSectionList=[],p),q;p=(q=new wac_Mf,q.Id="msCoauthors",q.ControlsId="msCoauthorsControls",q.DisplayMode=wac_yzb(),q.ControlList=b,q);wac_s(wac_q.Z,"WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.UVa&&(p.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,p.TitleId="menuCoauthorsTitle",p.Theme="Light");Array.add(c.MenuSectionList,p);if(wac_s(wac_q.Z,"DocChatIsEnabled")&&wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")&&
wac_t()&&wac_0g().vd()){q=[];Array.add(q,wac_zzb());var r;q=(r=new wac_Mf,r.Id="msGroupChat",r.ControlsId="msGroupChatControl",r.ControlList=q,r);Array.add(c.MenuSectionList,q)}wac_t()&&wac_0g().vd()?a.MenuItems=c:a.PopulationXML=wac_en(c);a=!0}return a},H8e:function(a){return this.Dwc(a)},lja:function(a,b,c,d,e,f,g){a=!1;switch(c){case 1:a=f(e);break;case 2:a=g(e)}return a?32:8},yKe:function(a,b,c,d,e){var f=this;return this.lja(a,b,c,d,e,function(){return f.dJb()},this.xda)},n_e:function(a,b,c,
d,e){return this.lja(a,b,c,d,e,this.Rie,this.xda)},EXe:function(a,b,c,d,e){return this.lja(a,b,c,d,e,this.xda,this.rge)},jwe:function(a,b,c,d,e){return this.lja(a,b,c,d,e,this.xda,this.xda)},iwe:function(a,b,c,d,e){return this.lja(a,b,c,d,e,this.xda,this.xda)},G8e:function(a,b,c,d,e){return this.lja(a,b,c,d,e,this.xda,this.Qpe)},sXe:function(a,b,c,d,e){var f=this;return this.lja(a,b,c,d,e,this.xda,function(){wac_rzb(f);return!0})},ka:function(){wac_qzb.prototype.ka.call(this)}};
wac_gBb.registerClass("RealtimePresenceUI.ABox4PeoplesWell",wac_qzb);Type.registerNamespace("BPr");function wac_iBb(){}wac_iBb.registerInterface("BPr.IMyPresenceUser");window.BPr.SerializablePresenceData=function(a,b){this.ip=a;this.user=b};window.BPr.SerializablePresenceIpData=function(a,b,c,d){this.paragraphId=a;this.cp=b;this.length=c;this.shapeId=d};
function wac_jBb(a,b,c,d,e,f,g,h){this.mee=Function.createDelegate(this,this.dVe);this.Wke=Function.createDelegate(this,this.H1e);this.n9c=a;this.IUb=b;this.Mtd=c;this.TPd=e;this.Cwd=f;this.hGc=g;this.I8=d;this.zod=h;this.n9c.C3(this.Wke)}
wac_jBb.prototype={n9c:null,zod:null,IUb:null,Mtd:null,TPd:!1,Cwd:0,hGc:null,I8:null,H1e:function(a,b){b.sg||(this.hGc.ye("CU"),a=this.Mtd,a=(a.qC?a.qC.Oe:0)>=this.Cwd,this.TPd&&a?(a=this.IUb())?(a.KAc=!0,b=a.xK.haa,wac_BVa(a.xK,a.pLd),b&&this.hGc.ye("PI")):wac_(19682513,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt."):this.lu())},lu:function(){var a=this.IUb();if(!a)wac_(19682514,500,15,"ActivePage ContentReplicator was null, we are abandoning the inbound attempt.");
else if(!this.I8()&&!a.I2.JV){var b=-1;wac_RF.isInstanceOfType(a)&&(b=a.Ve.qgb());var c=this.zod.Me("Task","ShoulderTapInboundReplicationTimer");a.lu(this.mee,null,new wac_kBb(b,c,a.tq))}},dVe:function(a){var b=window.$$as(wac_kBb,a);if(b){a=b.sgd.Vg().toString();var c=this.IUb(),d=c.tq,e="";if(d!==b.omc)if(wac_(19964236,500,50,"Time saved due to force inbound on update notification message = {0} ms",b.Gmd.toString()),b=b.omc,e=new Sys.StringBuilder,c=wac_Pv(wac_qv(c.Wf().fd()),d)){for(e.append(c.ha().zz);d!==
b;){e.append(", ");e.append(d.zz);c=c.Zj;if(!c)break;d=c.ha()}e=e.toString()}else wac_(19964238,500,10,"The revision we got from the last replicator revisionId was null - {0}",{lastRevisionId:d}),e="";wac_(19964237,500,50,"Revisions: {0}, InboundDuration: {1}",e,a)}else wac_(19964235,500,10,"The callback data was null")}};function wac_TT(){wac_TT.initializeBase(this)}wac_TT.prototype={bbc:null,HRa:null};
function wac_lBb(a){var b=wac_q.Pw,c=wac_q.Z.Ua.UserPrincipalName,d=a.bbc?a.bbc.HA:null,e=wac_q.Lva||wac_q.LW,f;a.HRa?(f=a.HRa,f=f.gD.Aq()&&f.gD.Ob()?f.gD.Ob().V3b().toString():"0"):f=null;return new wac_UT(a.$j,b,a.ps,a.Xq,d,a.rL,c,a.NBa,a.yV,e,a.vra,a.ft,f)}function wac_mBb(a,b,c,d){this.j4=Function.createDelegate(this,this.Q6);this.W0c=Function.createDelegate(this,this.vTe);this.dispose=this.ka;this.Vk=d;this.sa=b;this.GSb=a;this.fj=c;wac_nBb(this.Vk,this)}
wac_mBb.prototype={sa:null,GSb:null,VYa:null,bHc:!1,fj:null,Vk:null,_started:!1,TNa:null,Yd:function(){this._started||(this._started=!0,this.TNa={},this.GSb.hb("PPC",this.W0c),wac_KB(this.sa,this.j4),wac_oBb(this,this.sa.pb()))},kd:function(){this._started&&(this._started=!1,this.TNa=null,this.GSb.nd("PPC",this.W0c),wac_CF(this.sa,this.j4))},Q6:function(a,b){if(!wac_q.Lg&&(a=wac_oBb(this,b.ql),this.VYa&&a)){a=wac_pBb(this.GSb,this.VYa.toString(),-1,-1,!0);for(b=0;b<a.length;b++)this.TNa[a[b].rh().Jf()]=
a[b];if(!(0>=a.length)){if(1===a.length)a=String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphSingle,a[0].rh().ap);else{b=[];for(var c=a.length,d=0;d<c;d++)Array.add(b,a[d].rh().ap);a=String.format(Box4Intl.Box4Strings.l_OtherUsersEditingParagraphMany,b.join(Box4Intl.Box4Strings.l_DisplayNameSeparator))}this.fj.Dz(a,!0)}}},vTe:function(a,b){this.sa.pb()&&!wac_q.Lg&&this.bHc&&this.VYa&&this.VYa.za(b.dJ)&&(a=null,!b.TBb||b.oC.rh().Jf()in this.TNa?b.TBb||(a=String.format(Box4Intl.Box4Strings.l_UserLeavingParagraph,
b.oC.rh().ap),delete this.TNa[b.oC.rh().Jf()]):(a=String.format(Box4Intl.Box4Strings.l_UserJoiningParagraph,b.oC.rh().ap),this.TNa[b.oC.rh().Jf()]=b.oC),a&&this.fj.Dz(a,!0))},ka:function(){wac_qBb(this.Vk,this);this.kd()}};function wac_oBb(a,b){if(!b)return!1;b=b.rb();if(!b)return!1;b=b.Ca();if(!b)return!1;a.bHc=wac_YB(b);b=b.aa.ha();if(b.za(a.VYa)||!a.bHc)return!1;a.VYa=b;a.TNa={};return!0}function wac_rBb(a,b){wac_rBb.initializeBase(this);this.dJ=a;this.v7c=b}wac_rBb.prototype={dJ:null,v7c:!1};
function wac_VT(a,b,c,d,e,f,g){wac_VT.resolveInheritance();this.dispose=this.ka;wac_VT.initializeBase(this,[null]);this.$k=a;this.INa=b;this.Ii=c;this.xg=d;this.$P=e;wac_WT=0;this.TTc=new (wac_La.$$(Boolean));this.EXc=new (wac_La.$$(Boolean));this.Hn=f;this.ya=g;this.nQ=wac_D(this.ya,"PresenceIpRenderedFloodgateTimeLapseSec",30);this.hR=wac_D(this.ya,"PresenceIpRenderedFloodgateTriggerThreshold",3);this.cda=0}
function wac_sBb(){wac_tBb||(wac_tBb=!0,wac_(4006594,302,50,"First presence ip rendered on the page"))}wac_VT.prototype={INa:null,Ii:null,xg:null,$h:null,HFc:null,$P:null,Uud:0,ya:null,nQ:0,hR:0,Hn:null,cda:0,F8a:!1,$k:null,TTc:null,EXc:null,lS:0};function wac_uBb(a){!a.Hn||a.cda>=a.hR||a.Hn.CW(function(){a.Hn.Ob().gr("PresenceIpRendered","PresenceIpRenderedFloodgateEnabled",a.nQ)&&a.cda++})}
function wac_vBb(a){if(wac_GT.isInstanceOfType(a.$h)){var b=window.$$as(wac_GT,a.$h);wac_WT=0<wac_WT?wac_WT+1:b.I$+1;wac_ET(b,wac_WT);a.mb.style.zIndex=wac_WT}}function wac_wBb(a){a.Ya("CR",new wac_rBb(a.$k.ml().gC(),a.F8a),null)}function wac_XT(){return wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")}function wac_xBb(a,b,c,d,e,f){this.SYa={};this.RYa={};this.ytd={};this.INa=a;this.Ii=b;this.Lh=c;this.$P=d;this.Hn=e;this.ya=f}wac_xBb.prototype={INa:null,Ii:null,Lh:null,$P:null,Hn:null,ya:null};
function wac_YT(a,b,c){wac_YT.initializeBase(this);this.dJ=a;this.oC=b;this.TBb=c}wac_YT.prototype={dJ:null,oC:null,TBb:!1};function wac_ZT(){this.Orb={};this.Hla={};wac_ZT.initializeBase(this)}
wac_ZT.prototype={Pxd:!1,bUa:function(a){return a.ml().gC().toString()},Qdc:function(a,b){this.Pxd||(this.Pxd=!0,wac_(4289312,302,50,"First presence added to data manager"));var c,d;c=d={val:!1};var e=this.Hla[a.rh().Jf()],f=!e||0>=e.length?null:e[e.length-1],e=!!f&&this.bUa(f)===this.bUa(a);c.val=e&&f.ml().SG.za(a.ml().SG)&&f.rh().za(a.rh());wac_yBb()&&c.val&&f.ml().Lv&&a.ml().Lv&&f.ml().Lv!==a.ml().Lv&&(c.val=!1);d=(c=d.val,e);c&&!b?(d=this.Hla[a.rh().Jf()])&&0<=d.length&&d[d.length-1].ml().$Ud(a.ml().bS):
(d||wac_zBb(this,a.rh().Jf()),wac_yBb()&&d&&(b=this.Hla[a.rh().Jf()],!(b=!b||0>=b.length?null:b[b.length-1])||!b.ml().Lv||a.ml().Lv&&a.ml().Lv===b.ml().Lv||(c=b.ml().gC(),this.Ya("PPC",new wac_YT(c,b,!1),null))),b=this.bUa(a),c=a.rh().Jf(),e=this.Orb[b]||[],f=this.Hla[c]||[],f.length>=wac_ABb&&(f=f.splice(-wac_BBb,wac_ABb)),d||Array.add(e,c),Array.add(f,a),this.Orb[b]=e,this.Hla[c]=f,a.ml().gC().za(wac_x())||(d=a.ml().gC(),this.Ya("PPC",new wac_YT(d,a,!0),null)))},Vic:function(a){return this.Orb[a]},
$Fe:function(a){if(!a||!a.Ca()||!a.Ca().aa)return null;a=a.Ca().aa;a=wac_pBb(this,a.ha().toString(),0,0,!0);a=wac_CBb(a);a.sort(function(a,c){return a.ap.localeCompare(c.ap)-wac_1f});return a}};function wac_CBb(a){if(!a||!a.length)return[];for(var b=[],c=new (wac_Ca.$$(String))(wac_qa()),d=0;d<a.length;d++){var e=a[d].rh();e.Ru&&c.Ib(e.Jf())||!e.Ru&&e.eq&&c.Ib(e.eq)||(b.push(e),c.U(e.Ru?e.Jf():e.eq))}return b}
function wac_pBb(a,b,c,d,e){var f=[],g=a.Vic(b);if(!g)return f;for(var h=0;h<g.length;h++){for(var k=g[h],l=a.Hla[k],m=!1,n=l.length-1;0<=n;n--){var p=l[n];if(e){if(p.T$&&p.ml().gC().za(wac_Ul(b))){m=!0;Array.add(f,p);break}}else if(wac__T.isInstanceOfType(p)?p.ml().bS===c:p.ml().bS===d){m=!0;p.XUd(!0);Array.add(f,p);a.Hla[k]=l.splice(n,l.length);break}}!m&&0<l.length&&l[0].SSd()&&l[0].ml().gC().za(wac_Ul(b))&&Array.add(f,l[0])}return f}
function wac_zBb(a,b){var c=a.Hla[b];if(c&&0<c.length){var d=c[0].ml().gC(),e=a.bUa(c[0]);delete a.Hla[b];Array.remove(a.Orb[e],b);d.za(wac_x())||a.Ya("PPC",new wac_YT(d,c[0],!1),null)}}function wac_yBb(){return!!wac_q.Z&&wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_s(wac_q.Z,"ObjectPresenceIsEnabled")}function wac__T(a,b){this.G8=b;this.Mea=a}
wac__T.prototype={Mea:null,G8:null,ml:function(){return this.G8},BCb:!1,SSd:function(){return this.BCb},XUd:function(a){return this.BCb=a},T$:!1,bzb:function(a){return this.T$=a},Pha:!1,$5b:function(a){return this.Pha=a},rh:function(){return this.Mea},bVd:function(a){return this.Mea=a},Pjc:function(){return new window.BPr.SerializablePresenceData(this.G8?this.G8.Jw():null,this.Mea.Jw())},kcb:function(){return this.Mea.Jf()+(this.G8?this.G8.gC().toString():wac_x().toString())},tj:function(){var a=
!!this.Mea&&this.Mea.tj(),b=!this.G8||this.G8.tj();return a&&b},Ac:function(){var a=new wac__T;a.Mea=this.Mea?this.Mea.Ac():null;a.G8=this.G8?this.G8.Ac():null;a.T$=this.T$;a.BCb=this.BCb;a.Pha=this.Pha;return a}};function wac_DBb(a){this.Fa=a}wac_DBb.prototype={Fa:0,Se:function(){return this.Fa},za:function(a){return a?this.Fa===a.Fa:!1},Ac:function(){return new wac_DBb(this.Fa)}};function wac_0T(a,b,c,d){a&&(this.dJ=wac_Ul(a));this.SG=new wac_DBb(b);this.bS=c;this.Lv=d}
wac_0T.prototype={dJ:null,gC:function(){return this.dJ},SG:null,bS:0,$Ud:function(a){return this.bS=a},Lv:0,tj:function(){return 0<=this.SG.Se()&&!!this.dJ&&!this.dJ.za(wac_x())},Jw:function(){return new window.BPr.SerializablePresenceIpData(this.dJ.toString(),this.SG.Se(),this.bS,this.Lv)},Ac:function(){var a=new wac_0T;a.dJ=this.dJ;a.SG=this.SG?this.SG.Ac():null;a.bS=this.bS;a.Lv=this.Lv;return a}};
function wac_EBb(a,b,c,d,e,f,g){this.hAb=Function.createDelegate(this,this.gqc);this.DG=Function.createDelegate(this,this.P6);this.b_=Function.createDelegate(this,this.Wja);wac_EBb.initializeBase(this,[a,b,c,d,e,f,g])}
wac_EBb.prototype={nJd:null,jka:function(a){this.$h&&this.$h.jka(a)},CYc:function(a){if(this.mb&&this.mb.parentNode){var b=wac_FBb(this,a);if(b){var c,d,e,f,g=Sys.UI.DomElement.getBounds(this.mb.parentNode),h=this.mb.parentNode,k=this.xg.Ea(),l=c={val:c},m=d={val:d},n=e={val:e},p=f={val:f};m.val=b.y;l.val=b.x;n.val=b.height;p.val=b.width;(1<Math.abs(g.width-h.offsetWidth)||1<Math.abs(g.height-h.offsetHeight))&&k&&(m.val=Math.round(m.val/k.Xg),l.val=Math.round(l.val/k.Xg),n.val=Math.round(n.val/k.Xg),
p.val=Math.round(p.val/k.Xg));c=c.val;d=d.val;e=e.val;f=f.val;this.mb.style.top=d+"px";this.mb.style.left=c+"px";this.mb.style.height=e+"px";this.mb.style.width=f+"px";b=wac_GBb(this,a);wac_sl(this.mb,b);a=wac_HBb(this,a,this.$k.ml().Lv);wac_IBb(this,b,f,this.iT(a));this.eHa()}}},wt:function(a){a&&this.mb&&a===this.nJd&&(wac_nd(this.mb),this.$h.jka(this.$k.rh().Jf()),wac_wBb(this))},ycd:function(a,b,c,d){var e=new wac_JBb;if(!c||!b)return e;var f=wac_FBb(this,a);if(!f)return e;b=f.y;c=f.x;var g=f.height,
f=f.width;a=this.mb&&this.mb.parentNode&&wac_KBb(wac_myb(this.mb.parentNode))?wac_KBb(wac_myb(this.mb)):wac_GBb(this,a);var h=this.xg.Ea();d&&h&&(d=h.Xg,b=Math.round(b/d),c=Math.round(c/d),g=Math.round(g/d),f=Math.round(f/d));e.xva=b;e.iua=c;e.sm=g;e.hn=f;e.nNb=a;e.dhb=!0;return e},Wld:function(a,b,c,d){wac_sBb();this.HFc=a;if(d){var e=wac_HBb(this,a,this.$k.ml().Lv);if(!e)return;var f=!this.mb;f&&this.Vfc(b.ownerDocument);f||!this.mb.parentNode?e.appendChild(this.mb):this.mb.parentNode!==e&&(this.mb.parentNode.removeChild(this.mb),
e.appendChild(this.mb));this.$h.uS(this.$k.rh());this.nJd=b;this.Uud=a.Fc();this.mb.style.borderColor=this.$k.rh().aO();this.mb.id="ipId_"+this.$k.kcb();c.dhb&&(this.mb.style.height=c.sm+"px",this.mb.style.top=c.xva+"px",this.mb.style.left=c.iua+"px",this.mb.style.width=c.hn+"px",wac_sl(this.mb,c.nNb),wac_sl(this.$h.zb(),-1*c.nNb),wac_IBb(this,c.nNb,c.hn,this.iT(e)),this.eHa())}this.F8a=!d;wac_wBb(this)},lVd:function(a){this.mb.style.borderColor=this.$k.rh().aO();this.mb.id="ipId_"+this.$k.kcb();
this.CYc(a)},Vfc:function(a){this.mb=a.createElement("div");this.mb.className="WACImgPresenceHighlight";this.mb.dir=wac_gh?"rtl":"ltr";this.$h=this.INa.Ufc(this.al("div"),!0);this.$h.uS(this.$k.rh());this.$h.Zd();this.Ii.Na("msospPointerOver",this.$h.zb(),this.b_);this.Ii.Na("msospPointerOut",this.$h.zb(),this.DG);this.Ii.Na("msospPointerDown",this.$h.zb(),this.hAb);Sys.UI.DomElement.addCssClass(this.$h.zb(),"WacPresence");this.mb.appendChild(this.$h.zb())},iT:function(a){return Sys.UI.DomElement.containsCssClass(a,
"Selected")},n6:function(a,b){var c=this.CHb(a,b);return c?c.Gg:(a=wac_LBb(a,b))?a.Ia():null},CHb:function(a,b){a=wac_0K(a.Wa(),5);for(var c=a.length,d=0;d<c;++d){var e=a[d];if(e.Gg.Ja(Number,wac_NFa)===b)return e}return null},Wja:function(){this.$h&&this.$h.mOb();return!1},P6:function(){this.$h&&(this.$h.dHa(),this.lS=1);return!1},gqc:function(a){this.$h&&3===a.Pe&&(2!==this.lS?(wac_vBb(this),this.eHa()):this.$h&&(this.$h.dHa(),this.lS=1));return!1},eHa:function(){for(var a=this.$h.B4b(),b=a.length,
c=0;c<b;++c){var d=a[c];if(d.$j===this.$k.rh().Jf()&&!d.za(this.$k.rh())){this.$h.uS(this.$k.rh());break}}if(this.$k.Pha||2===this.lS)this.$h.jhb(),this.$k.$5b(!1),this.$k.bzb(!0),this.lS=2;this.$k.T$&&1!==this.lS||(this.$h.dHa(),this.$k.bzb(!0),this.lS=1)}};
function wac_FBb(a,b){var c=a.$k.ml();if(!c||!c.Lv)return null;var d=a.n6(b,c.Lv);a=wac_HBb(a,b,c.Lv);if(!d||!a)return null;var e,f;b=e={val:e};c=f={val:f};b.val=wac_7e(wac_rN(d),0,!0);c.val=wac_7e(wac_sN(d),1,!0);e=e.val;f=f.val;c=b=1;d.Da(wac_Cs)?(d=d.Ja(Array,wac_Cs),b+=wac_7e(d[0],0,!0),c+=wac_7e(d[2],1,!0)):(b+=0<a.offsetWidth?(a.offsetWidth-e)/2:2,c+=0<a.offsetHeight?(a.offsetHeight-f)/2:2);return new Sys.UI.Bounds(Math.round(b),Math.round(c),Math.round(e),Math.round(f))}
function wac_GBb(a,b){a=a.n6(b,a.$k.ml().Lv);return wac_JD.u0(a)}function wac_LBb(a,b){a=wac_P(a.Wa());for(var c=a.fb(6);c;){var d=c.Ia().Ja(Number,wac_NFa);if(wac_tC(c)&&d===b)return c;c=a.qe(6)}return null}function wac_HBb(a,b,c){if(a=a.CHb(b,c))if(a=a.aja(b.Xb))return a.zb();return(c=wac_LBb(b,c))?wac_eB(window.$$as(wac_$J,c),b.Fc()).Hc():null}
function wac_IBb(a,b,c,d){var e=wac_gh;a.$h.zb().style.left="auto";a.$h.zb().style.top="auto";a.$h.zb().style.right="auto";a.$h.zb().style.bottom="auto";d=d?Math.round(10)+6:0;0<=b&&90>b||360===b?(a.$h.zb().style.top=-10-d+"px",e?a.$h.zb().style.right=c-10+"px":a.$h.zb().style.left=c-10+"px"):90<=b&&180>b?(a.$h.zb().style.left=-10-d+"px",e?a.$h.zb().style.bottom="-10px":a.$h.zb().style.top="-10px"):180<=b&&270>b?(a.$h.zb().style.bottom=-10-d+"px",e?a.$h.zb().style.left=c-10+"px":a.$h.zb().style.right=
c-10+"px"):(a.$h.zb().style.right=-10-d+"px",e?a.$h.zb().style.top="-10px":a.$h.zb().style.bottom="-10px")}function wac_KBb(a){return a&&-1<a.indexOf("deg")&&(a=window.parseInt(a.substring(a.indexOf("(")+1,a.indexOf("deg"))),!window.isNaN(a))?a:0}function wac_JBb(){}wac_JBb.prototype={iua:0,xva:0,hn:0,sm:0,nNb:0,dhb:!1};
function wac_MBb(a,b,c,d,e,f,g){this.hAb=Function.createDelegate(this,this.gqc);this.DG=Function.createDelegate(this,this.P6);this.b_=Function.createDelegate(this,this.Wja);wac_MBb.initializeBase(this,[a,b,c,d,e,f,g])}
wac_MBb.prototype={I3a:null,kna:null,iub:null,Vfc:function(a){this.mb=a.createElement("div");this.mb.className="PresenceIpPaddingDiv";this.mb.dir=wac_gh?"rtl":"ltr";this.Ii.Na("msospPointerOver",this.mb,this.b_);wac_XT()&&(this.Ii.Na("msospPointerOut",this.mb,this.DG),this.Ii.Na("msospPointerDown",this.mb,this.hAb));this.kna=this.al("div");this.kna.className="presenceIp";wac_XT()||(this.iub=this.al("div"),this.iub.className="PresenceSmallBox",this.kna.appendChild(this.iub));this.$h=this.INa.Ufc(this.al("div"),
wac_XT());this.$h.uS(this.$k.rh());this.$h.Zd();Sys.UI.DomElement.addCssClass(this.$h.zb(),wac_XT()?"WacPresence":"WacPawn");this.kna.appendChild(this.$h.zb());this.mb.appendChild(this.kna)},Wja:function(a){!this.$h||wac_XT()&&!this.$h.Khc(a)||(wac_vBb(this),wac_NBb(this,a));this.lVd(this.HFc);return!1},P6:function(){this.$h&&this.zW();return!1},gqc:function(a){this.$h&&3===a.Pe&&(2!==this.lS?(wac_vBb(this),wac_NBb(this,a)):this.zW());return!1},eHa:function(a){for(var b=this.$h.B4b(),c=b.length,d=
0;d<c;++d){var e=b[d];if(e.$j===this.$k.rh().Jf()&&!e.za(this.$k.rh())){this.$h.uS(this.$k.rh());break}}b=!1;"0xcccccc"===this.$k.rh().aO()?(c=this.TTc.qc(this.$k.rh().Jf(),b={val:b}),b=b.val,c,b||(this.TTc.W(this.$k.rh().Jf(),!0),wac_(17954772,302,50,'{ "ClientID" : "'+this.$k.rh().Jf()+'" , "Event" : "RenderGrayPawn"}'))):(c=this.EXc.qc(this.$k.rh().Jf(),b={val:b}),b=b.val,c,b||(this.EXc.W(this.$k.rh().Jf(),!0),wac_(17954773,302,50,'{ "ClientID" : "'+this.$k.rh().Jf()+'" , "Event" : "RenderColoredPawn"}')));
return a||this.$k.Pha||2===this.lS?(wac_uBb(this),this.$h.jhb(),this.$k.$5b(!1),this.$k.bzb(!0),this.lS=2,2E3):this.$k.T$&&1!==this.lS?0:(wac_uBb(this),this.$h.dHa(),this.$k.bzb(!0),this.lS=1,7E3)},zW:function(){if(this.$h&&this.lS){if(wac_GT.isInstanceOfType(this.$h)){var a=window.$$as(wac_GT,this.$h);wac_WT=a.I$;wac_ET(a,a.I$);this.mb.style.zIndex=a.I$}this.$h.Zd();this.lS=0}return!1},CYc:function(a){if(this.mb&&this.mb.parentNode){var b=wac_OBb(this,a);if(b){a=Sys.UI.DomElement.getBounds(this.mb.parentNode);
var c,d,e,b=new Sys.UI.Bounds(b.x-a.x,b.y-a.y,2,b.height),f=this.mb.parentNode,g=this.xg.Ea(),h=c={val:c},k=d={val:d},l=e={val:e};k.val=b.y;h.val=b.x;l.val=b.height;(1<Math.abs(a.width-f.offsetWidth)||1<Math.abs(a.height-f.offsetHeight))&&g&&(k.val=Math.round(k.val/g.Xg),h.val=Math.round(h.val/g.Xg),l.val=Math.round(l.val/g.Xg));c=c.val;d=d.val;e=e.val;this.mb.style.height=10+e+"px";this.mb.style.top=d-5+"px";this.mb.style.left=c-5+"px";this.kna.style.height=Math.max(10,e)+"px";wac_NBb(this,null)}}},
wt:function(a){a&&this.mb&&a===this.mb.parentNode&&(wac_nd(this.mb),wac_wBb(this))},ycd:function(a,b,c,d){var e=new wac_PBb;if(!c||!b)return e;a=wac_OBb(this,a);if(!a)return e;c=new Sys.UI.Bounds(a.x-b.x,a.y-b.y,2,a.height);b=c.y;a=c.x;c=c.height;var f=this.xg.Ea();d&&f&&(d=f.Xg,b=Math.round(b/d),a=Math.round(a/d),c=Math.round(c/d));e.xva=b-5;e.iua=a-5;e.sm=10+c;e.Igd=Math.max(10,c);e.dhb=!0;return e},Wld:function(a,b,c,d){wac_sBb();this.HFc=a;if(d){var e=!this.mb;e&&this.Vfc(b.ownerDocument);e||
!this.mb.parentNode?b.appendChild(this.mb):this.mb.parentNode!==b&&(this.mb.parentNode.removeChild(this.mb),b.appendChild(this.mb));this.Uud=a.Fc();a=this.$k.rh().aO();this.kna.style.borderColor=a;wac_XT()||(this.iub.style.borderColor=a);this.mb.id="ipId_"+this.$k.kcb();c.dhb&&(this.mb.style.height=c.sm+"px",this.mb.style.top=c.xva+"px",this.mb.style.left=c.iua+"px",this.kna.style.height=c.Igd+"px",wac_NBb(this,null))}this.F8a=!d;wac_wBb(this)},ka:function(){this.mb&&(this.wt(this.mb.parentNode),
this.Ii.yb("msospPointerOver",this.mb,this.b_),wac_XT()&&(this.Ii.yb("msospPointerOut",this.mb,this.DG),this.Ii.yb("msospPointerDown",this.mb,this.hAb)),wac_Yb(this.$h),this.mb=this.$h=null)},lVd:function(a){var b=this.$k.rh().aO();this.kna.style.borderColor=b;wac_XT()||(this.iub.style.borderColor=b);this.mb.id="ipId_"+this.$k.kcb();this.CYc(a)}};
function wac_OBb(a,b){a=a.$k.ml();if(!a)return null;var c;try{var d=a.SG.Se();c=wac_ndb(d,b,0<d,!1,!1,!1)}catch(e){wac_(4301318,302,50,"Could not determine the bounds of IP: isYielding={0} message={1} stack={2}",wac_r().yr(),e.message,e.stack),c=null}return c}function wac_QBb(a,b){a.I3a=new wac_uh(2,1,b,function(){a.I3a=null;a.zW()},56,null,!1);wac_r().zc(a.I3a)}function wac_NBb(a,b){a.I3a&&(wac_r().qf(a.I3a),a.I3a=null);var c=a.eHa(!!b);wac_XT()&&b&&"msospPointerOver"===b.wn||wac_QBb(a,c)}
function wac_PBb(){}wac_PBb.prototype={Igd:0,iua:0,xva:0,sm:0,dhb:!1};
function wac_RBb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,u,v,w,x,y,z,A,C){this.h0c=Function.createDelegate(this,this.oRe);this.D$=Function.createDelegate(this,this.dGa);this.P7b=Function.createDelegate(this,this.wTe);this.Ufe=Function.createDelegate(this,this.VWe);this.NI=Function.createDelegate(this,this.iP);this.$1c=Function.createDelegate(this,this.bYe);this.ufa=Array(5);this.pKd=new (wac_Ca.$$(String))(wac_qa());this.Xrb={};this.dispose=this.ka;this.rp=a;this.sa=d;this.ED=e;this.jza=f;this.Jrb=h;this.HCc=
k;this.joa=l;this.Ks=c;this.QEc=m;this.FUb=n;this.GUb=p;this.Dqd=g;this.iI=q;this.Rh=r;this.vb=t;this.gb=u;this.fvb=y;this.BMa=A;this.bLd=C;this.YZb=w;this.ya=x;this.zrb=b;this.zB=v;wac_SBb=new (wac_La.$$(Boolean));for(a=0;a<this.zrb.length;a++)b=this.zrb[a],b.Rx.Db(this),b.Rx.U(this);this.jza.hb("PPC",this.$1c);this.rp.Ifa(this.NI);z&&this.Jrb.B3(this.Ufe);wac_nBb(this.rp,this)}function wac_TBb(a){return a?a?1===a?1:2===a?2:0:2:0}
wac_RBb.prototype={rp:null,ED:null,sa:null,jza:null,zrb:null,Ks:null,Dqd:null,joa:null,HCc:0,xPc:!1,FUb:null,GUb:null,QEc:null,_started:!1,iI:null,Rh:null,vb:null,gb:null,fvb:!1,Jrb:null,HSc:!1,BMa:null,YZb:null,fNc:null,ya:null,zB:null,yWb:!1,jOc:!1,bLd:!1,VWe:function(){if(!this.HSc){var a=this,b=new wac_uh(0,1,20,function(){var b=new (wac_e.$$(wac_H)),d=a.joa.SYa,e;for(e in d){var f={key:e,value:d[e]},f=f.value;f.F8a&&b.U(f.$k.ml().gC())}if(wac_UBb(a)){var d=a.joa.RYa,g;for(g in d)f={key:g,value:d[g]},
e=f.value,e.F8a&&!b.Ib(e.$k.ml().gC())&&b.U(e.$k.ml().gC())}wac_VBb(a,b,!0);a.HSc=!1},72,null,!1);this.gb.zc(b);this.HSc=!0}},oRe:function(){this.xPc&&(this.Fgb(),this.xPc=!1)},Fgb:function(){if(this.sa.pb()){var a=this.sa.pb().rb();wac_WBb(this,a,!0)}},dGa:function(a,b){a=b.ql.rb();wac_WBb(this,a,!1)},Nec:function(a){var b=a.Ca().ta,c=a.Ca().aa.ha();a=this.FUb(a.Ca().aa);return new wac_0T(c.toString(),b,a,0)},iP:function(a,b){a=Date.now();var c=b.mS,d;for(d in c){var e=c[d];wac_s(this.ya,"CashTelemetryIsEnabled")&&
this.ubb(e,new Date,null);e.ml()?wac_XBb(this,e):this.kgb(e.rh().Jf())}d=b.U7a;for(c=0;c<d.length;++c){e=d[c];this.kgb(e);var f=this.joa.SYa[e];f&&(f.nd("CR",this.P7b),f.ka());wac_UBb(this)&&(f=this.joa,e=f.RYa[f.ytd[e]],e=!e||e.$h&&e.$h.B4b().length?null:e)&&(e.nd("CR",this.P7b),e.ka())}this.fvb||wac_YBb(this);wac_Ki(b,"PresenceManager",Date.now()-a)},ubb:function(a,b,c){if(this.YZb)if(a&&a.rh()&&a.rh().Jf()){var d=a.rh().Jf();if(!this.pKd.Ib(d))if(this.fNc)this.fNc.ubb(d,b,null,wac_TBb(c||a.rh().NBa)),
this.pKd.U(d);else{var e=this;this.YZb.CW(function(){e.fNc=e.YZb.Ob();e.ubb(a,b,c)})}}else wac_(42262876,302,15,"invalid presence")},kgb:function(a){wac_zBb(this.jza,a)},OHb:function(a){if(12!==a.get_type())return new (wac_e.$$(wac_Cx));a=wac_pBb(this.jza,a.ha().toString(),this.FUb(a),this.GUb(a),!1);if(0>=a.length)a=new (wac_e.$$(wac_Cx));else{for(var b=new (wac_e.$$(wac_Cx)),c=0;c<a.length;c++)b.U(wac_ZBb(this,a[c]));a=b}return a},wTe:function(a,b){if(b.dJ){a=b.dJ.toString();var c=b.v7c;b=this.Xrb;
var d=this.yWb,e=this.jOc;c&&e||(c?this.BMa.ye("RendersSaved-OutOfView"):(this.BMa.ye("Renders"),e&&this.BMa.ye("RendersDueToScroll"),(c=a in b)&&delete b[a],d&&c&&this.BMa.ye("RendersSaved-ContentUpdate")))}else wac_c(8758481,302,!1,"null paraid")},ka:function(){this.kd();this.jza.nd("PPC",this.$1c);this.rp.qPa(this.NI);wac_qBb(this.rp,this);for(var a=0;a<this.zrb.length;a++)this.zrb[a].Rx.Db(this);wac_1ba([this.Dqd,this.rp]);var b=this.joa,c=b.SYa,d;for(d in c)a={key:d,value:c[d]},a.value.dispose();
d=b.RYa;for(var e in d)a={key:e,value:d[e]},a.value.dispose()},bYe:function(a,b){b.dJ&&(a=this.Ks.Kb(b.dJ))&&((wac__T.isInstanceOfType(b.oC)?this.FUb(a):this.GUb(a))===b.oC.ml().bS?wac__Bb(this,b.dJ):this.BMa.ye("RendersSaved-VersionCheck"),wac_UBb(this)&&b.oC.ml().Lv&&!b.TBb&&(a=b.oC.ml().Lv.toString(),(a=this.joa.RYa[a])&&a.jka(b.oC.rh().Jf())))},kd:function(){this._started&&(this._started=!1,wac_CF(this.sa,this.D$),this.QEc.M5b(this.h0c))},Yd:function(){if(!this._started){this._started=!0;wac_KB(this.sa,
this.D$);this.QEc.x3b(this.h0c);var a=this.rp.Nia();delete a[this.iI.Jf()];this.iP(null,new wac_Ji(a,[],null));this.Fgb()}}};function wac__Bb(a,b){b.toString()in a.Xrb&&a.BMa.ye("RendersSavedByAlreadyPending");a.Xrb[b.toString()]=null;a.fvb&&!a.yWb&&(b=new wac_uh(0,1,200,function(){a.yWb=!1;wac_YBb(a)},70,null,!1),a.gb.zc(b),a.yWb=!0)}
function wac_VBb(a,b,c){if(b.ja()){var d=new (wac_e.$$(wac_ZE));for(b=b.$$lge();b.$$mn();){var e=b.$$cu(),f=wac_0Bb(a,e);f?d.U(f):wac_1Bb(a,e)}if(d.ja()){b=a.vb.Xc(2,0);try{b.Set(a.Rh);for(var g=d.$$lge();g.$$mn();)f=g.$$cu(),d=a,e=f,e.$A(d.Jrb.Fc(),32,!0),e.$A(d.HCc,32,!0);c&&(a.jOc=!0)}finally{b&&b.dispose()}c&&(a.jOc=!1)}}}
function wac_1Bb(a,b){b=wac_pBb(a.jza,b.toString(),-1,-1,!0);if(!wac_gn(b)){for(var c=[],d=b.length,e=0;e<d;++e){var f=a.joa.SYa[b[e].rh().Jf()];f&&Array.add(c,f)}c.length&&a.zB.pa().J0(function(){for(var a=c.length,b=0;b<a;++b){var d=c[b];d.mb&&d.wt(d.mb.parentNode)}})}}
function wac_0Bb(a,b){b=a.Ks.Kb(b);if(!b)return a.ufa[0]||(wac_(4281420,302,50,"Could not find the node in object space"),a.ufa[0]=!0),null;if(!wac_U(b))return a.ufa[1]||(wac_(4281421,302,50,"Not a paragraph node"),a.ufa[1]=!0),null;if(!wac_eB(b,a.Jrb.Fc()))return a.ufa[2]||(wac_(4281422,302,50,"No ViewElement found for this node"),a.ufa[2]=!0),null;if(!b.wb)return a.ufa[3]||(wac_(4281423,302,50,"node is not anchored"),a.ufa[3]=!0),null;a.ufa[4]||(wac_(4564931,302,50,"Valid paragraph node found for rendering ip"),
a.ufa[4]=!0);return b}
function wac_ZBb(a,b){var c,d,e=a.joa,f=c={val:!1},g=!!e.ya&&wac_s(e.ya,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_s(e.ya,"ObjectPresenceIsEnabled");if(b.ml().Lv&&g){g=b.ml().Lv.toString();e.ytd[b.rh().Jf()]=g;var h=e.RYa[g];h?(h.$k=b,f.val=!0,b=h):(f.val=!1,b=e.RYa[g]=new wac_EBb(b,e.INa,e.Ii,e.Lh,e.$P,e.Hn,e.ya))}else g=b.rh().Jf(),(h=e.SYa[g])&&h.$k.rh().za(b.rh())?(h.$k=b,f.val=!0,b=h):(f.val=!1,b=e.SYa[g]=new wac_MBb(b,e.INa,e.Ii,e.Lh,e.$P,e.Hn,e.ya));b=(d=b,c=c.val,d);c||b.hb("CR",a.P7b);return b}
function wac_XBb(a,b){var c=null;b&&b.rh()&&(c=b.rh().NBa);b=b.Ac();b.bVd(wac_eyb(a.ED,b.rh().Jf())||b.rh());wac_s(a.ya,"CashTelemetryIsEnabled")&&a.ubb(b,new Date,c);if(b.tj()&&!b.rh().FW()){var c=b.rh().Jf(),d,e;e=wac_SBb.qc(c,d={val:!1});d=d.val;e;d||(wac_SBb.W(c,!0),wac_(17954774,302,50,'{ "ClientID" : "'+c+'" , "Event" : "CreateAnonymousGrayPawn"}'));wac_Lqa(b.rh(),CommonUIStrings.l_AnonymousUserName)}a.jza.Qdc(b,!1)}
function wac_WBb(a,b,c){if(!a.bLd)if(wac_Iv(a.Ks.ah)||c)if(b){a:{if(wac_UBb(a)&&wac_MD(b))c=b;else if(c=wac_1A(b,!0,!1,!0),!wac_xB(c)){c=null;break a}c=a.Nec(c)}c?wac_2Bb(a.rp,c):(wac_2Bb(a.rp,null),wac_(4281418,302,50,"Not supported selection context {0}",b.Ca().Ba))}else wac_2Bb(a.rp,null);else a.xPc=!0}function wac_YBb(a){var b=new (wac_e.$$(wac_H)),c=a.Xrb,d;for(d in c)b.U(wac_Ul(d));wac_VBb(a,b,!1);a.Xrb={}}
function wac_UBb(a){return!!a.ya&&wac_s(a.ya,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_s(a.ya,"ObjectPresenceIsEnabled")}function wac_UT(a,b,c,d,e,f,g,h,k,l,m,n,p){wac_UT.initializeBase(this,[a,b,c,d,f,g,h,k,l,m,n,0,null,0]);this.HA=e;this.h5=p}
wac_UT.prototype={HA:null,Jw:function(){return new window.Box4.Presence.SerializablePresenceUserData(this.$j,this.HA,this.rL,this.yV,this.vra,this.Xq.Xq,this.eq,this.ft,this.ap,this.Ru,this.h5)},gUa:function(a){return(a=a.value)?a.rh():null},Ac:function(){return new wac_UT(this.$j,this.ap,this.ps,this.Xq.Ac(),this.HA,this.rL,this.eq,this.NBa,this.yV,this.Ru,this.vra,this.ft,this.h5)}};
function wac_3Bb(a,b,c,d,e,f,g,h){this.zga=Function.createDelegate(this,this.Iua);this.O6a=Function.createDelegate(this,this.GLb);this.yga=Function.createDelegate(this,this.Vja);this.NI=Function.createDelegate(this,this.iP);this.Mqa=Function.createDelegate(this,this.fP);this.m_c=Function.createDelegate(this,this.rOe);this.ua=new wac_cf;this.dispose=this.ka;this.iI=f;this.iI.$j=a.Jf();this.rg=a;this.WM=b;this.u2=d;this.iyd=e;this.gb=c;this.ama=new (wac_h.$$(wac_fv))(null);this.B1=g;this.mr=h;if(this.WM){var k=
this;this.WM.CW(function(){wac_2a(k.WM)||wac_1a(k.WM)||wac_4Pa(k.WM.Ob(),k.m_c)})}}
wac_3Bb.prototype={ama:null,iyd:null,u2:null,cGd:!1,gb:null,oIc:!1,iI:null,B1:null,VDd:!1,Aob:!1,mr:null,WM:null,J2b:0,JSc:0,E4a:null,rg:null,CZ:function(){return this.rg.CZ()},Ifa:function(a){this.ua.hb("PU",a)},qPa:function(a){this.ua.nd("PU",a)},Hfa:function(a){this.ua.hb("CSC",a)},Syb:function(a){this.ua.nd("CSC",a)},c5a:function(a){this.ua.hb("PSU",a)},O5b:function(a){this.ua.nd("PSU",a)},z3b:function(a){this.ua.hb("PSC",a)},N5b:function(a){this.ua.nd("PSC",a)},$md:function(){return null},fOa:function(a){this.rg.fOa(a)},
Jf:function(){return this.rg.Jf()},C3:function(a){this.ua.hb("UN",a)},Tyb:function(a){this.ua.nd("UN",a)},ob:function(){this.rg.Hfa(this.Mqa);this.rg.Ifa(this.NI);this.rg.c5a(this.yga);this.rg.z3b(this.O6a);this.rg.C3(this.zga);wac_4Bb(this);wac_5Bb(this)},VFb:function(){this.oIc||this.rg.VFb()},pTa:function(){this.rg.pTa()},mdd:function(a){var b;a?(b=a.user,b=b.clientId?new wac_UT(b.clientId,b.userName,null,new wac_zm(wac_xb(b.capabilities)?0:b.capabilities),b.localColbaltSessionId,b.SkypeChatThreadId,
b.email,null,b.chatThreadDiscoveryUri,b.isAnonymous,b.inChat,b.isReadOnly,b.presenceStatus):null,a.ip?(a=a.ip,a=!a.paragraphId||wac_i(a.cp)||wac_i(a.length)?null:new wac_0T(a.paragraphId,a.cp,a.length,0)):a=null,b=new wac__T(b,a)):b=null;return b},Ptc:function(a,b){return(new wac__T(a,b)).Pjc()},QGa:function(a,b){return this.rg.QGa(a,b)},xta:function(a){return this.rg.xta(a)},$bb:function(){return this.rg.$bb()},sM:function(a,b,c){return this.rg.sM(a,b,c)},Nia:function(){return wac_6Bb(this,this.rg.Nia())},
y5a:function(){return this.rg.y5a()},fP:function(a,b){2===b.BL&&this.ama.Rd(function(a){a.Yd();return!0});b.BL||wac_s(this.B1,"SendRTCMessagesWhileDisconnectedIsEnabled")&&!this.oIc||this.ama.Rd(function(a){a.kd();return!0});this.ua.Ya("CSC",b,null)},iP:function(a,b){if(!this.u2()){a=wac_6Bb(this,b.mS);b=wac_7Bb(b.U7a);var c=new wac_Ji(a,b,this.mr),d=this;b=new wac_uh(0,1,0,function(){d.ua.Ya("PU",c,null)},57,null,!1);this.gb.zc(b)}},Vja:function(a,b){if(!this.u2()){var c={};a=b.mS;for(var d in a){var e=
{key:d,value:a[d]};c[e.key.toLowerCase()]=e.value}var f=this;d=new wac_uh(0,1,0,function(){f.ua.Ya("PSU",new wac_Li(b.fc,c),null)},80,null,!1);this.gb.zc(d)}},GLb:function(a,b){if(!this.u2()){a=wac_7Bb(b.oQa);var c=new wac_Mi(a),d=this;a=new wac_uh(0,1,0,function(){d.ua.Ya("PSC",c,null)},81,null,!1);this.gb.zc(a)}},Iua:function(a,b){wac_Hh("Microsoft.Office.Web.SessionSettings.IWacWordUpdateNotificationTaskExperimentSettings");if(this.VDd)wac_8Bb(this,b);else{var c=this;a=new wac_uh(0,1,0,function(){wac_8Bb(c,
b)},58,null,!1);this.gb.zc(a)}},ka:function(){this.ama=new (wac_h.$$(wac_fv))(null);this.rg.Syb(this.Mqa);this.rg.qPa(this.NI);this.rg.O5b(this.yga);this.rg.N5b(this.O6a);this.rg.Tyb(this.zga);if(this.WM){var a=this;this.WM.CW(function(){wac_2a(a.WM)||wac_1a(a.WM)||a.WM.Ob().ua.nd("AmIAloneChanged",a.m_c)})}this.rg.pTa();wac_(4564935,302,50,"Disposing of rtcProxyCompleted")},rOe:function(){wac_4Bb(this)},abb:function(){this.oIc=!0;this.pTa();wac_(4564938,302,50,"DisconnectForever")}};
function wac_4Bb(a){var b=!1;a.WM?a.WM.CW(function(){wac_2a(a.WM)||wac_1a(a.WM)||(b=!a.WM.Ob().oo);a.rg.CZ()||!b&&!a.iyd()?2!==a.rg.CZ()||b||(a.pTa(),wac_(4564937,302,50,"Disconnecting because there are no other users in the doc")):(a.VFb(),wac_(4564936,302,15,"Connecting because there are other authors in the doc"));!a.cGd&&b&&(wac_(4203466,302,50,"There are other real-time authors in this session"),a.cGd=!0)}):(a.VFb(),wac_(50931285,302,15,"Connecting to rtc on boot"))}
function wac_8Bb(a,b){var c=Date.now();a.ua.Ya("UN",b,null);c=Date.now()-c;500<=c&&(a.J2b++,wac_(42563487,302,15,"Update Notification Heuristics: UpdateNotification Type {0} took {1} ms",b.sg,c),0>b.sg||13<=b.sg?wac_(42541602,302,15,"Update Notification Heuristics: UpdateNotification Type out of range {0}",b.sg):a.E4a[b.sg]++);a.JSc++}function wac_7Bb(a){for(var b=Array(a.length),c=0;c<a.length;c++)b[c]=a[c].toLowerCase();return b}
function wac_6Bb(a,b){var c={},d;for(d in b){var e={key:d,value:b[d]},f=a.mdd(e.value);f&&f.tj()?c[e.key.toLowerCase()]=f:wac_(4564932,302,50,"No Valid User {0}",wac_Ui(e.value))}return c}function wac_2Bb(a,b){b&&b.tj()&&!a.u2()?a.rg.$md(a.Ptc(wac_lBb(a.iI),b)):wac__a(Object,null)}function wac_qBb(a,b){for(var c=0;c<a.ama.ia();c++)if(a.ama.B(c)===b){wac_vb(a.ama,c);break}}function wac_nBb(a,b){a.ama.Ib(b,function(a,b){return a===b})||(a.ama.U(b),2===a.CZ()&&b.Yd())}
function wac_5Bb(a){a.E4a=Array(12);for(var b=0;12>b;b++)a.E4a[b]=0;a.VDd=a.B1?wac_s(a.B1,"UpdateNotificationTaskExperimentIsEnabled"):!1;wac_Bh(function(){if(!a.Aob){var b={};b.TC=a.JSc;b.HRC=a.J2b;a.E4a&&0<a.J2b&&(b.TBC=a.E4a);a.JSc=0;a.J2b=0;a.E4a=null;wac_(42541603,302,50,"UpdateNotificationHeuristics: {0}",b);a.Aob=!0}})}function wac_kBb(a,b,c){this.Gmd=a;this.sgd=b;this.omc=c}wac_kBb.prototype={Gmd:0,sgd:null,omc:null};window.BPr.SerializablePresenceData.registerClass("BPr.SerializablePresenceData");
window.BPr.SerializablePresenceIpData.registerClass("BPr.SerializablePresenceIpData");wac_jBb.registerClass("BPr.ContentNotificationManager");wac_UT.registerClass("BPr.PresenceUser",wac_ym,wac_Dc,wac_6Ga,wac_Fc);wac_UT.prototype.toString=wac_ym.prototype.toString;wac_TT.registerClass("BPr.MyPresenceUser",wac_UT,wac_iBb,wac_Fc);wac_TT.prototype.toString=wac_ym.prototype.toString;wac_mBb.registerClass("BPr.PresenceAccessibilityManager",null,Sys.IDisposable,wac_fv);
wac_rBb.registerClass("BPr.PresenceControlRenderedEventArgs",Sys.EventArgs);wac_VT.registerClass("BPr.APresenceControl",wac_DT,wac_Cx,Sys.IDisposable);wac_xBb.registerClass("BPr.PresenceControlProvider");wac_YT.registerClass("BPr.ParagraphChangedEventArg",Sys.EventArgs);wac_ZT.registerClass("BPr.PresenceDataManager",wac_cf,wac_jKa);wac__T.registerClass("BPr.PresenceInfo",null,wac_bv,wac_6b.$$(wac_bv));wac_DBb.registerClass("BPr.PresenceCp",null,wac_cv,wac_6b.$$(wac_cv));
wac_0T.registerClass("BPr.PresenceIp",null,wac_dv,wac_6b.$$(wac_dv));wac_EBb.registerClass("BPr.PresenceImageControl",wac_VT);wac_JBb.registerClass("BPr.PresenceImageControl.PresenceImageControlStyle",null,wac_BLa);wac_MBb.registerClass("BPr.PresenceIpControl",wac_VT);wac_PBb.registerClass("BPr.PresenceIpControl.PresenceIpControlStyle",null,wac_BLa);wac_RBb.registerClass("BPr.PresenceManager",null,wac_CLa,Sys.IDisposable,wac_fv,wac_Ec,wac_zca);
wac_3Bb.registerClass("BPr.RtcProxy",null,wac_5Ga,Sys.IDisposable,wac_uc,wac_24a);wac_kBb.registerClass("BPr.SuccessfulInboundReplicationCallbackData");var wac_tBb=!1,wac_WT=0,wac_ABb=10,wac_BBb=2,wac_SBb=null;Type.registerNamespace("Box4.Presence");wac_K=window.Box4||{};wac_K.Qua=wac_K.Qua||{};function wac_1T(a,b){wac_1T.initializeBase(this);this.BD=a;this.qb=b}
wac_1T.prototype={cId:!1,qb:null,BD:null,hNc:!1,Qdc:function(a,b){this.qb.xb(142)&&this.qb.xb(121)&&wac__T.isInstanceOfType(a)?this.cId||(this.cId=!0,wac_(7866380,302,15,"Presence packet received in old format")):(wac__T.isInstanceOfType(a)&&(this.hNc=!0),wac_ZT.prototype.Qdc.call(this,a,b))},bUa:function(a){return this.hNc?wac_ZT.prototype.bUa.call(this,a):a.ml().Ws().toString()},Vic:function(a){if(this.hNc)return wac_ZT.prototype.Vic.call(this,a);a=this.BD.Kb(wac_Ul(a));if(!a)return null;a=a.oa(Number,
wac_1r,0);return this.Orb[a.toString()]}};Type.registerNamespace("WordEditor.Presence");wac_L=window.WordEditor||{};wac_L.Qua=wac_L.Qua||{};function wac_9Bb(a,b,c,d,e,f,g,h,k){this.LocalCobaltSessionId=a;this.SkypeChatThreadId=b;this.ChatThreadDiscoveryUri=c;this.InChat=d;this.Capabilities=e;this.Email=f;this.UserName=g;this.IsAnonymous=h;this.PresenceStatus=k}function wac_$Bb(){}wac_$Bb.registerInterface("WordEditor.Presence.IWordPresenceIp");function wac_aCb(){}wac_aCb.registerInterface("WordEditor.Presence.IWordPresenceCp");
function wac_bCb(){}wac_bCb.registerInterface("WordEditor.Presence.IPacketIdGenerator");function wac_cCb(){}function wac_dCb(a,b,c){null!=a&&(this.TFA=a);null!=b&&(this.PN=b);null!=c&&(this.TN=c)}function wac_eCb(a,b){null!=a&&(this.PM=a);null!=b&&(this.TM=b)}function wac_fCb(a,b,c,d){null!=a&&(this.PA=a);null!=b&&(this.TA=b);null!=c&&(this.PB=c);null!=d&&(this.TBS=d)}function wac_gCb(a,b){a&&(this.SF=a);null!=b&&(this.SL=b)}function wac_hCb(){}wac_hCb.registerInterface("WordEditor.Presence.ISequentialIdGenerator");
function wac_2T(){}wac_2T.registerInterface("WordEditor.Presence.IWordPresenceCpFactory");function wac_3T(a,b,c,d,e,f,g,h,k,l,m,n,p,q){this.R0=a;this.hab=c;this.yba=d;this.XG=b.toLowerCase();this.tE=e;this.Mva=p;f&&(this.tX=f);null!=g&&(this.sHa=g);wac_i(h)||(this.Text=h);k&&(this.rSa=k);l&&(this.lKb=l);m&&(this.kHa=m);n&&(this.Ehb=n);this.i1=q}wac_3T.prototype={R0:0,Mva:0,hab:0,yba:0,XG:null,tE:null,tX:null,rSa:null,lKb:null,kHa:null,sHa:null,Text:null,Ehb:null,i1:null};
function wac_iCb(a,b,c){null!=a&&(this.wvc=a);null!=b&&(this.Lqc=b);null!=c&&(this.VWa=c)}wac_iCb.prototype={wvc:null,Lqc:null,VWa:null};function wac_jCb(a,b){null!=a&&(this.fkd=a);null!=b&&(this.UWa=b)}wac_jCb.prototype={fkd:null,UWa:null};function wac_kCb(a,b,c,d){null!=a&&(this.Jqc=a);null!=b&&(this.uvc=b);null!=c&&(this.Kqc=c);null!=d&&(this.vvc=d)}wac_kCb.prototype={Jqc:null,uvc:null,Kqc:null,vvc:null};function wac_lCb(a,b){a&&(this.lvc=a);null!=b&&(this.mvc=b)}wac_lCb.prototype={lvc:null,mvc:null};
function wac_mCb(){}function wac_nCb(){}wac_nCb.prototype={V:0};function wac_oCb(){this.Hea=0}wac_oCb.prototype={Hea:0};function wac_pCb(a){a.Hea++;4294967295===a.Hea&&(a.Hea=1);return a.Hea}
function wac_qCb(a,b){b.val="";if("number"!==typeof a.I)return b.val="Invalid PacketId Type",!1;if("number"!==typeof a.O)return b.val="Invalid Operation Type",!1;if("string"!==typeof a.A)return b.val="Invalid ClientId Type",!1;if("object"!==typeof a.AN)return b.val="Invalid Anchor Object Type",!1;if(!a.AN)return b.val="Null AnchorObject",!1;if(!wac_kyb(a.AN)){var c;try{c=wac_Ui(a.AN)}catch(d){c=String.format("Failed to JSON-serialize payload : {0}",d)}8E3<c.length&&(c=String.format("Payload exceeds maximum length: {0} > {1}, not logging",
c.length,8E3));b.val="Invalid AnchorObject: "+c+", Client: "+a.C;return!1}return!a.O&&a.AN.RK?(b.val="Invalid RangeKind:"+a.AN.RK+" for Caret",!1):2===a.O&&("number"!==typeof a.TF||"undefined"!==typeof a.TX&&"string"!==typeof a.TX||1!==a.AN.RK&&a.AN.RK)?(b.val="Invalid TypingData",!1):3!==a.O||"object"===typeof a.AP&&a.AP&&"number"===typeof a.AP.TFA&&"number"===typeof a.AP.PN&&"number"===typeof a.AP.TN&&2===a.AN.RK?6!==a.O||"object"===typeof a.MP&&a.MP&&"number"===typeof a.MP.PM&&"number"===typeof a.MP.TM&&
5===a.AN.RK?4!==a.O||"object"===typeof a.SP&&a.SP&&"number"===typeof a.SP.PA&&"number"===typeof a.SP.TA&&"number"===typeof a.SP.PB&&"number"===typeof a.SP.TBS&&3===a.AN.RK&&(a.AN.PS===a.SP.PA||a.AN.PS===a.SP.PB)?7!==a.O||"object"===typeof a.SPS&&a.SPS&&"string"===typeof a.SPS.SF&&"boolean"===typeof a.SPS.SL?null!=a.ISS&&"number"!==typeof a.ISS?(b.val="invalid StrictlySequentialId",!1):!0:(b.val="Invalid SymbolData",!1):(b.val="Invalid SplitParaData",!1):(b.val="Invalid RemoveParaData",!1):(b.val=
"Invalid AddParaData",!1)}function wac_rCb(a){var b=a;if("number"===typeof b.V){if(1===b.V)return wac_sCb(a);wac_(9188758,302,15,"Unsupported Version");return null}for(var c=0,d=null,e=0;e<a.length;e++){var b=a[e],f;a:{for(f=0;f<wac_mCb.Fod.length;f++)if(b.V===wac_mCb.Fod[f]){f=!0;break a}f=!1}f&&b.V>c&&(c=b.V,d=a[e])}return 1===c?wac_sCb(d):null}
function wac_tCb(a){if(a){var b=new wac_cCb;b.I=a.R0;b.V=1;b.A=a.XG;b.C=a.hab;b.O=a.yba;b.AN=wac_4xb(a.tE);a.tX&&(b.WD=a.tX);null!=a.sHa&&(b.TF=a.sHa);!wac_i(a.Text)&&0<a.Text.length&&(b.TX=a.Text);a.rSa&&(b.AP=new wac_dCb(a.rSa.wvc,a.rSa.Lqc,a.rSa.VWa));a.lKb&&(b.MP=new wac_eCb(a.lKb.fkd,a.lKb.UWa));a.kHa&&(b.SP=new wac_fCb(a.kHa.Jqc,a.kHa.uvc,a.kHa.Kqc,a.kHa.vvc));a.Ehb&&(b.SPS=new wac_gCb(a.Ehb.lvc,a.Ehb.mvc));b.ISS=a.i1;a=b}else a=null;return a}
function wac_sCb(a){var b,c,d;if(d=wac_qCb(a,c={val:b}),b=c.val,!d)return wac_(9188759,302,15,"Failed to parse RTT packet, InvalidFieldInfo {0}",b),null;var e=d=c=b=null,f=null,g=null,h=null,k=null;a.WD&&(b=a.WD);null!=a.TF&&(c=a.TF);wac_i(a.TX)||(d=a.TX);a.AP&&(e=new wac_iCb(a.AP.TFA,a.AP.PN,a.AP.TN));a.MP&&(f=new wac_jCb(a.MP.PM,a.MP.TM));a.SP&&(g=new wac_kCb(a.SP.PA,a.SP.TA,a.SP.PB,a.SP.TBS));a.SPS&&(h=new wac_lCb(a.SPS.SF,a.SPS.SL));null!=a.ISS&&(k=a.ISS);return new wac_3T(a.I,a.A,a.C,a.O,wac_2xb(a.AN),
b,c,d,e,f,g,h,1,k)}function wac_uCb(){this.mub=this.lub=0}wac_uCb.prototype={mub:0,lub:0};function wac_vCb(a,b,c,d,e,f,g,h){wac_vCb.initializeBase(this,[a,b,c,d,e,f,g,h])}function wac_wCb(){if(window.Box4.App.va()){var a=window.Box4.App.va().Ka;a&&(a.A3(wac_xCb),(a=a.xc())&&(wac_yCb=a.Be)&&window.Box4.App.bga().CW(wac_zCb))}}function wac_zCb(){(wac_ACb=window.Box4.App.bga().Ob())&&wac_ACb.Dk()&&(wac_BCb||(wac_BCb=wac_k().K(wac_ev))).jH().CW(wac_CCb)}
function wac_CCb(){if(wac_DCb=(wac_BCb||(wac_BCb=wac_k().K(wac_ev))).jH().Ob()){var a=wac_q.Z,b=wac_s(a,"Box4ThrottleInboundRequests"),a=wac_D(a,"Box4ThrottleInboundsAtUserCount",20),c=new wac_Zo(11,1);wac_yCb.anb=function(){return wac_DCb.y5a()};wac_ECb=wac_ECb||new wac_vCb(wac_DCb,function(){return wac_yCb},wac_ACb,function(){return wac_q.Lg},b,a,c,wac_3g(window.Box4.App.va()));wac_ECb.lu()}}function wac_xCb(a){wac_ECb||(a.h6a(wac_xCb),wac_wCb())}
function wac_FCb(a,b,c){this.Hea=a;this.z_=c;this.MA=b}
function wac_GCb(a,b,c,d,e){if(!a||!wac_l(wac_k(),wac_iy).xb(142)||!b)return null;if(a.yba)return wac_(7685324,302,15,"Presence packet is of unexpected operationType {0}",a.yba),null;var f;if(wac_i(a.tX)){var g=a.XG;f=g?new wac_UT(g,null,null,new wac_zm(0),null,null,null,a.hab,null,!1,!1,!1,null):null}else g=a.XG,f=a.tX.Capabilities,f=g?new wac_UT(g,a.tX.UserName,null,new wac_zm(wac_xb(f)?0:f),a.tX.LocalCobaltSessionId,a.tX.SkypeChatThreadId,a.tX.Email,a.hab,a.tX.ChatThreadDiscoveryUri,a.tX.IsAnonymous,
a.tX.InChat,!1,a.tX.PresenceStatus):null;g=a.R0;a=a.tE;if(b){var h=window.parseInt(a.aka);b=new wac_4T(b,h,a.uva,a.xua,c,d,e,a.muc)}else b=null;return new wac_FCb(g,f,b)}
wac_FCb.prototype={Hea:0,Wpb:!1,z_:null,ml:function(){return this.z_},SSd:function(){return this.Wpb},XUd:function(a){(this.Wpb=a)&&this.z_.Epc();return a},T$:!1,bzb:function(a){return this.T$=a},Pha:!1,$5b:function(a){return this.Pha=a},MA:null,rh:function(){return this.MA},bVd:function(a){return this.MA=a},Pjc:function(){var a;a=wac_HCb;4294967295===a.lub&&(a.lub=0);a.lub++;a=a.lub;return new wac_3T(this.Hea,this.MA.Jf(),1,0,this.z_?this.z_.Jw():null,new wac_9Bb(this.MA.HA,this.MA.rL,this.MA.yV,
this.MA.vra,this.MA.Xq.Xq,this.MA.eq,this.MA.ap,this.MA.Ru,this.MA.h5),null,null,null,null,null,null,0,a)},kcb:function(){return this.MA.Jf()+(this.z_?this.z_.gC().toString():wac_x().toString())},tj:function(){var a=!!this.MA&&this.MA.tj(),b=!this.z_||this.z_.tj();return a&&b},Ac:function(){var a=new wac_FCb;a.Hea=this.Hea;a.Wpb=this.Wpb;a.MA=this.MA?this.MA.Ac():null;a.z_=this.z_?this.z_.Ac():null;a.T$=this.T$;a.Pha=this.Pha;return a}};
function wac_ICb(a,b,c,d,e,f){this.jNc=a;this.Od=c;this.KQ=d;this.Is=e;this.Ah=f;this.osa=b}
wac_ICb.prototype={jNc:null,Fa:null,Od:null,KQ:null,Is:null,Ah:null,Ac:function(){return new wac_ICb(this.jNc,this.osa.Ac(),this.Od,this.KQ,this.Is,this.Ah)},osa:null,Se:function(){if(null!=this.Fa)return this.Fa;var a=this.jNc.gC();if(a.za(wac_x()))return 0;var b=this.KQ();if(!b)return 0;a=b.Kb(a);if(!a)return wac_(7685326,302,15,"Paragraph Node is null so returning a CP with value 0"),0;b=wac_zT(wac_BT(a.Jb,a.qa),this.osa);if(this.Is&&this.Ah&&wac_uD(a)){var c=wac_4A(a,b);c.Vb=wac_YUa(this.Ah,a,
b,this.osa.t4);b=wac_0A(0,c,!0)}return b},Epc:function(){null==this.Fa&&(this.Fa=this.Se())},za:function(a){return a?this.osa.Tv(a.osa,!1):!1}};function wac_JCb(a,b){this.Is=a;this.Ah=b}wac_JCb.prototype={Is:null,Ah:null,Ha:function(a,b,c,d){return new wac_ICb(a,b,c,d,this.Is,this.Ah)}};function wac_4T(a,b,c,d,e,f,g,h){this.Kt=a;this.KQ=f;this.Od=e;this.P9=g;this.hg=b;this.Lv=h;this.bS=c;this.SG=g.Ha(this,d,e,f)}
wac_4T.prototype={KQ:null,Kt:null,tZb:null,Od:null,P9:null,Ac:function(){return new wac_4T(this.Kt,this.hg,this.bS,this.SG.osa,this.Od,this.KQ,this.P9,this.Lv)},hg:0,Ws:function(){return this.hg},gC:function(){return this.tZb?this.tZb:wac_aS(this.Kt,this.hg)},Lv:0,Epc:function(){this.tZb||(this.tZb=this.gC(),this.SG.Epc())},SG:null,bS:0,$Ud:function(a){return this.bS=a},tj:function(){return 0<=this.SG.Se()},Jw:function(){var a=this.SG.osa;return a?new wac_AT(0,this.hg,this.bS,a,null,null,null,0,this.Lv):
null}};function wac_5T(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,u,v,w,x,y,z,A,C,B,D,E,G,F){wac_5T.initializeBase(this,[a,b,c,d,e,f,g,h,k,l,n,p,q,r,v,w,x,y,z,A,C,B,D,F]);wac_B(m,1177859183,1,wac_KCb,64);wac_B(m,3460066539,1,wac_LCb,64);wac_B(m,477883041,1,wac_MCb,96);wac_B(m,761503246,1,wac_NCb,64);this.Kt=t;this.Od=u;this.P9=E;this.iI.HRa=G;this.iI.HRa.ua.hb("X",wac_OCb);wac_(4006600,302,50,"WordPresenceManager Initialized")}function wac_PCb(){return wac_QCb||(wac_QCb=wac_k().K(wac_ev))}
function wac_RCb(){wac_SCb||(wac_SCb=new (wac_$a.$$(wac_Ec)));wac_TCb&&(wac_(4256585,302,50,"WordPresenceManager Init"),wac_TCb=!1);if(window.Box4.App.va()){var a=window.Box4.App.va().Ka;a?(a.A3(wac_UCb),(wac_6T=a.rd)&&wac_6T.Ti()?(wac_VCb=a.xc().Be)?(wac_WCb=a.xc().fd())?wac_PCb().jH().CW(wac_XCb):wac_(4006599,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to content ObjectSpace of the app"):wac_(4252228,302,15,"Can't initialize the WordPresenceManager because we can't get a reference to the GraphSpaceReplicator object"):
wac_(4006598,302,50,"PageView doesn't seem to have been initialized yet. Will try again once we know it's initialized")):wac_(4006597,302,15,"Can't initialize the WordPresenceManager because workspace is not initialized")}else wac_(4006596,302,15,"Can't initialize the WordPresenceManager because active AppFrame is not initialized")}
function wac_XCb(){if(wac_YCb=wac_PCb().jH().Ob()){var a=[];Array.add(a,wac_6T.Fbc);Array.add(a,wac_6T.le().zVc());var b=wac_Jy(),c=wac_k().K(wac_1T),d=new wac_mBb(c,b,wac_k().K(wac_zb),wac_YCb),e=wac_Bb(wac_k(),wac_Fob),f=wac_k().K(wac_DS),g=new wac_Zo(8,5),h=wac_k().K(wac_sc);wac_7T=new wac_5T(wac_YCb,a,wac_WCb,b,h,c,d,wac_6T,wac_6T.le().Fc(),wac_k().K(wac_xBb),wac_y(),wac_VCb,wac_T,wac_lyb,wac_k().K(wac_TT),e,f,window.Box4.App.aj.pm,new wac_2y,wac_r(),wac_2j(),wac_Db(wac_ko,wac_m(wac_k(),wac_ko)),
wac_q.Z,wac_s(wac_q.Z,"Box4ThrottleAndBatchPresenceRendering"),wac_s(wac_q.Z,"Box4DoNotRenderPresenceOutOfView"),g,wac_k().K(wac_2T),wac_k().K(wac_Aca),!window.Box4.App.ks()&&!window.Box4.App.Hm);wac_(23196878,302,50,"WordPresenceManager instance created");wac_SCb.Ie(wac_7T);wac_8T.Ie(wac_7T);wac_ZCb.Ie(wac_7T);a=wac_k();wac_n(wac_o(wac_p(wac_p(a.ma(wac_5T),wac_zca),wac_Ec)),function(){return wac_7T});a.K(wac_5T)}else wac_(4203468,302,15,"Can't initialize the WordPresenceManager because can't get a handle to RtcProxy")}
function wac_UCb(a){wac_7T||(wac_(4006601,302,50,"WordPresenceManager.OnAppIsInteractive: Trying to initialize again"),(a=window.$$as(wac_Ew,a))&&a.h6a(wac_UCb),wac_RCb())}function wac_OCb(){wac_7T.Fgb()}function wac_KCb(a,b,c,d,e){c=e.split(",");if(!c||3!==c.length)return 8;a=c[0].trim();b=c[1].trim();c=Number.parseInvariant(c[2].trim());a=new wac__T(new wac_UT(a),new wac_0T(b,c,-1,0));if(!wac_8T.yc.Aq())return 8;b=wac_8T.yc.Ob();wac_XBb(b,a);b.fvb||wac_YBb(b);return 32}
function wac_LCb(a,b,c,d,e){if(!wac_8T.yc.Aq())return 8;a=wac_8T.yc.Ob();a.kgb(e);a.fvb||wac_YBb(a);return 32}
function wac_NCb(a,b,c,d,e){if(!wac_8T.yc.Aq())return 8;a=wac_8T.yc.Ob();if(!a)return 8;if(e&&e.tj()&&e.ml()){b=wac_pBb(a.jza,e.ml().gC().toString(),-1,-1,!1);c=!1;d=null;for(var f=0;f<b.length;f++)if(d=b[f],d.rh().Jf()===e.rh().Jf()){d.$5b(!0);c=!0;break}if(c)if(b=d.ml().gC(),e=wac_0Bb(a,b)){b=a.vb.Xc(2,0);try{wac_Q(b,e),e.$A(a.Jrb.Fc(),32,!0),e.$A(a.HCc,32,!0)}finally{b&&b.dispose()}}else wac_1Bb(a,b)}return 32}
function wac_MCb(a,b,c,d,e){if(1===c)return 32;if(!wac_PCb().jH().Aq())return 8;a=wac_PCb().jH().Ob();if(!a)return wac_(4301136,302,10,"rtcProxy is null when trying to display RTC connection status"),8;e.Value=2===a.CZ()?WordEditorIntl.WordEditorStrings.L_RtcConnected:1===a.CZ()?WordEditorIntl.WordEditorStrings.L_RtcConnecting:"";return 32}
wac_5T.prototype={uf:function(){return wac_k().K(wac_iy)},P9:null,Kt:null,Od:null,Djc:function(a){if(!a||!a.wb)return null;for(a=a.wb.Ul;a;a=a.$q)if(wac_5M(a))return a.om.Qc;return null},Nec:function(a){var b=null,b=wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_s(wac_q.Z,"ObjectPresenceIsEnabled");if(this.uf().xb(142)&&this.uf().xb(121)){var c=a.Ca().ta,d=a.Ca().aa;b&&wac_tC(d)&&(d=this.Djc(d));if(!d)return wac_(51242309,302,15,"selectedNode is null"),null;var d=this.GUb(d),e=a.Ca().aa.oa(Number,
wac_1r,0);if(!this.Kt)return wac_(35997152,302,15,"paragraphWordIdMapping is null"),null;var f=wac_aS(this.Kt.pa(),e),g=wac_WCb.Kb(f);if(!g)return wac_(16791249,302,15,"Can't find pid "+f),null;c=wac_xT(wac_BT(g.Jb,g.qa),c);c.t4=-1===wac_aD(a.Ca())?0:wac_aD(a.Ca());f=0;b&&wac_MD(a)&&(f=wac__Cb(a));b=new wac_4T(this.Kt.pa(),e,d,c,this.Od,function(){return wac_WCb},this.P9,f)}else b=wac_RBb.prototype.Nec.call(this,a);return b}};
function wac__Cb(a){var b=wac_RH(a.Ca());return b?b.Gg.oa(Number,wac_NFa,0):a.Ca().aa.Ia().oa(Number,wac_NFa,0)}function wac_0Cb(){}function wac_1Cb(){!wac_2Cb&&window.Box4.App.va()&&window.Box4.App.va().fu&&(wac_2Cb=window.WordEditor.App.Hj().fu.getElementsByClassName("OutlineContainerDisplayWrapper")[0]);return wac_2Cb}function wac_3Cb(){return wac_1Cb()?wac_Xk(wac_1Cb()):null}
wac_0Cb.prototype={ea:null,af:!1,Qb:function(){return"WordEditor.Presence"},ob:function(){wac_(50995799,302,15,"PresencePackage Init");window.Box4.App.dxc&&(this.ea.K(wac_9T).jH(),wac_RCb(),this.ea.K(wac_4Cb));window.Box4.App.Jfc&&wac_wCb();this.ea.K(wac_Xp);this.ea.K(wac_sc)},ka:function(){if(!this.af){this.af=!0;wac_8T.yc.CW(function(){wac_Yb(wac_8T.yc.Ob())});var a=this.ea.K(wac_TT);a&&a.HRa&&a.HRa.ua.nd("X",wac_OCb)}},Sb:function(a){this.ea=a;wac_n(wac_o(wac_p(wac_p(wac_p(this.ea.ma(wac_TT),wac_iBb),
wac_Fc),wac_Dc)),function(){return new wac_TT});wac_n(wac_o(a.ma(wac_2T)),function(){return new wac_JCb(a.K(wac_YE),a.K(wac_4x))});wac_n(wac_o(a.ma(wac_4Cb)),function(){return new wac_4Cb(new (wac_d.$$(wac_lw))(function(){return window.Box4.App.jc}),wac_SA(),a.K(wac_9T).wcb(),a.K(wac_iBb))});wac_n(wac_p(wac_p(wac_o(a.ma(wac_9T)),wac_ev),wac_bo),function(){return new wac_9T(wac_q.Br,wac_3g(window.Box4.App.va()),wac_r(),function(){return wac_q.Lg},wac_k().K(wac_iBb),wac_l(wac_k(),wac_0F),wac_k().K(wac_DS),
function(){return wac_t()&&window.Box4.App.va().Ka&&window.Box4.App.va().Ka.xc()?window.Box4.App.va().Ka.xc().fd():null},wac_5Cb,function(){return wac_l(wac_k(),wac_AR)},wac_m(wac_k(),wac_vc),wac_k().K(wac_2T),wac_q.Z)});wac_n(wac_o(a.ma(wac_xBb)),function(){var a;a=wac_s(wac_q.Z,"PeoplesWellExtraButtonInfoIsEnabled");var c=new wac_ozb;c.U(String,0,wac_Ri(wac_Pi,"MoreUsersGlyph16"));c.U(String,5,wac_Qi);c.U(String,1,wac_Ri(wac_Pi,a?"DoughboyWhiteGlyph_20x20x32":"SingleCollabUserGlyph16"));c.U(String,
4,wac_Qi);c.U(Number,12,1);c.U(Boolean,8,wac_gh);c.U(Function,16,wac_3Cb);a=a?new wac_Wyb(c):new wac_lzb(c);return new wac_xBb(a,wac_Ig(),wac_m(wac_k(),wac_Cc),wac_k().K(wac_Qw),wac_Db(wac_Ac,wac_m(wac_k(),wac_Ac)),wac_q.Z)});wac_n(wac_o(a.ma(wac_Xp)),function(){return new wac_Xp(wac_k().K(wac_Fc),wac_k().K(wac_9T).wcb(),wac_ZCb.yc,wac_k().K(wac_Dc),wac_r(),wac_s(wac_q.Z,"AwayStatusOneMinuteTimeoutIsEnabled")?6E4:wac_D(wac_q.Z,"AwayCoauthorThresholdMs",9E5),wac_y().Oge,window.Box4.App.va().Su,wac_s(wac_q.Z,
"PeoplesWellExtraButtonInfoIsEnabled"))});wac_n(wac_p(wac_o(a.ma(wac_6Cb)),wac_Aca),function(){return new wac_6Cb(wac_Db(wac_bc,wac_m(wac_k(),wac_bc)))});wac_n(wac_p(wac_o(a.ma(wac_Zxa)),wac_sc),function(){return new wac_Zxa(a.K(wac_9T).wcb(),window.Box4.App.bga().CWR(wac_fca,function(){return window.Box4.App.bga().Ob().qC}),a.K(wac_eb),a.K(wac_Dc),wac_Db(wac_Xp,wac_m(a,wac_Xp)))});wac_n(wac_p(wac_o(a.ma(wac_1T)),wac_jKa),function(){return new wac_1T(window.Box4.App.va().Ka.xc().fd(),wac_k().K(wac_iy))})}};
function wac_6Cb(a){this.ua=new wac_cf;this.gD=a;var b=this;this.gD.CWR(Function,function(){return b.gD.Ob().ddf(function(){b.ua.Ya("X",null,null)})})}wac_6Cb.prototype={gD:null};function wac_4Cb(a,b,c,d){this.NI=Function.createDelegate(this,this.iP);this.vde=Function.createDelegate(this,this.rUe);this.Ze=a;this.$z=b;this.tr=c;c.CW(this.vde);this.cHd=d;this.cHd.bbc=this.$z}
wac_4Cb.prototype={$z:null,tr:null,Vk:null,cHd:null,GJc:!1,SDc:!1,Ze:null,Yqe:!1,rUe:function(){this.tr.Aq()&&this.tr.Ob()?(this.Vk=this.tr.Ob(),this.Vk.Ifa(this.NI),wac_(5604372,302,50,"Presence Update Monitor is ready.")):wac_(5604373,302,15,"RtcTask did not complete successfully. No monitoring")},iP:function(a,b){a=Date.now();var c=b.mS,d;for(d in c){var e=c[d];if(!this.SDc&&this.Ze&&this.Ze.pa()){var f=e.rh().NBa;f&&1===f||(this.Yqe=!0)}if(!this.GJc&&e.rh().HA&&e.rh().HA!==this.$z.HA){wac_(5604375,
302,15,"Presence received from different local cobalt session Mine:{0} Theirs:{1}",this.$z.HA,e.rh().HA);this.GJc=!0;break}}this.GJc&&this.Vk.qPa(this.NI);this.SDc||(wac_(5604374,302,50,"First presence received"),this.SDc=!0);wac_Ki(b,"WordPresenceUpdateMonitor",Date.now()-a)}};function wac_7Cb(a,b,c,d,e,f,g,h,k,l,m,n,p,q){wac_7Cb.initializeBase(this,[a,b,c,d,e,f,p,q]);this.Kt=g;this.Od=h;this.KQ=k;this.Crb=l;this.Bub=m;this.P9=n}
wac_7Cb.prototype={Zy:null,Kt:null,Od:null,KQ:null,Crb:null,Bub:null,P9:null,jO:function(){return this.Zy||(this.Zy=this.Bub())},fP:function(a,b){2===b.BL&&wac_(4315102,302,50,"RTC Connected");this.jO()&&this.jO().T6("RtcConnectionStatusLabel");wac_3Bb.prototype.fP.call(this,a,b)},mdd:function(a){return wac_GCb(wac_rCb(a),this.Kt,this.Od,this.KQ,this.P9)},Ptc:function(a,b){return wac_4T.isInstanceOfType(b)?(a=new wac_FCb(wac_pCb(this.Crb),a,b),wac_tCb(a.Pjc())):wac_3Bb.prototype.Ptc.call(this,a,b)}};
function wac_9T(a,b,c,d,e,f,g,h,k,l,m,n,p){this.Th=new (wac_$a.$$(wac_5Ga));this.XQb=a;this.hc=b;this.gb=c;this.u2=d;this.iI=e;this.Kt=f;this.Bpa=g;this.KQ=h;this.Crb=k;this.Bub=l;this.WMa=m;this.P9=n;this.ya=p}function wac_8Cb(){return!1}wac_9T.prototype={XQb:null,hc:null,gb:null,u2:null,iI:null,Kt:null,Bpa:null,KQ:null,Crb:null,Bub:null,WMa:null,P9:null,ya:null,ZNd:!0,jH:function(){wac_9Cb(this);return this.Th.yc},wcb:function(){return new wac_$T(this)}};
function wac_9Cb(a){if(a.ZNd)if(a.ZNd=!1,window.Box4.App.Zlc()&&window.Box4.App.Olc()){var b=wac_q.Ae;if(b){var b=wac_sAb("{"+wac_q.Pf+"}",wac_q.Pf,wac_q.wmd,b,a.WMa,a.hc,a.ya.Ua.RtcEndpointUrl,wac_s(a.ya,"FindSessionOnBootIsEnabled")?wac_k().K(wac_8c):null),c=new wac_7Cb(b,wac_s(a.ya,"StartRTCOnBootIsEnabled")?null:window.Box4.App.bga(),a.gb,a.u2,wac_8Cb,a.iI,a.Kt,a.Bpa,a.KQ,a.Crb,a.Bub,a.P9,wac_q.Z,wac_jd.$$(Number).lJ(22,1,new (wac__o.$$(Number))(null),!0));window.Box4.App.q3e(c);c.ob();window.WordEditor.App.pka=
c;a.WMa.ub(function(a){a.b5a(function(){c.abb()})});a.Th.Ie(c)}else wac_(8206365,302,15,"Can't initialize the RtcProxy because ClientRequestManager is null")}else wac_(8206362,302,10,"Can't initialize the RtcProxy because dependent scripts are not loaded")}function wac_$T(a){this.m4=Function.createDelegate(this,this.moveNext);this.dispose=this.ka;this.pj=a;wac_$T.initializeBase(this);this.Am=this.NA;this.moveNext()}
wac_$T.prototype={pj:null,had:null,zt:null,Am:null,_state:0,NA:function(){this.zt=this.pj.jH().G();this.zt.Aq()||(this._state=2,this.zt.Rja(this.m4));return this.Xha},Xha:function(){this.had=this.zt.nJ();wac_9a(this,this.had);this.ka();this._state=3;this.ir(!0)},ka:function(){}};wac_$T.prototype.moveNext=function(){try{for(this._state=1;1===this._state;)this.Am=this.Am()}catch(a){this.ka(),wac_3a(this,a),this._state=3}};wac_$T.prototype.moveNext=wac_$T.prototype.moveNext;
wac_1T.registerClass("Box4.Presence.WordPresenceDataManager",wac_ZT);wac_9Bb.registerClass("WordEditor.Presence.SerializableWacData");wac_cCb.registerClass("WordEditor.Presence.SerializableRTTDataV1");wac_dCb.registerClass("WordEditor.Presence.SerializableAddParaDataV1");wac_eCb.registerClass("WordEditor.Presence.SerializableMergeRemoveParaDataV1");wac_fCb.registerClass("WordEditor.Presence.SerializableSplitParaDataV1");wac_gCb.registerClass("WordEditor.Presence.SerializableSymbolDataV1");wac_3T.registerClass("WordEditor.Presence.RTTData");
wac_iCb.registerClass("WordEditor.Presence.AddParaData");wac_jCb.registerClass("WordEditor.Presence.MergeRemoveParaData");wac_kCb.registerClass("WordEditor.Presence.SplitParaData");wac_lCb.registerClass("WordEditor.Presence.SymbolData");wac_mCb.registerClass("WordEditor.Presence.RTTDataVersion");wac_nCb.registerClass("WordEditor.Presence.SerializableObjectWithVersion");(function(){}).registerClass("WordEditor.Presence.Program");wac_oCb.registerClass("WordEditor.Presence.PacketIdGenerator",null,wac_bCb);
(function(){}).registerClass("WordEditor.Presence.RTTDataHelper");(function(){}).registerClass("WordEditor.Presence.RTTDataMethods");(function(){}).registerClass("WordEditor.Presence.SerializableRTTDataV1Methods");wac_uCb.registerClass("WordEditor.Presence.StrictlySequentialIdGenerator",null,wac_hCb);wac_vCb.registerClass("WordEditor.Presence.WordContentNotificationManager",wac_jBb);wac_FCb.registerClass("WordEditor.Presence.WordPresenceInfo",null,wac_bv,wac_6b.$$(wac_bv));
wac_ICb.registerClass("WordEditor.Presence.WordPresenceCp",null,wac_cv,wac_6b.$$(wac_cv),wac_aCb);wac_JCb.registerClass("WordEditor.Presence.WordPresenceCp.Factory",null,wac_2T);wac_4T.registerClass("WordEditor.Presence.WordPresenceIp",null,wac_dv,wac_6b.$$(wac_dv),wac_$Bb);wac_5T.registerClass("WordEditor.Presence.WordPresenceManager",wac_RBb);wac_0Cb.registerClass("WordEditor.Presence.WordPresencePackage",null,wac_I,wac_j);
wac_6Cb.registerClass("WordEditor.Presence.WordPresenceStatusProvider",null,wac_Aca);wac_4Cb.registerClass("WordEditor.Presence.WordPresenceUpdateMonitor");wac_7Cb.registerClass("WordEditor.Presence.WordRtcProxy",wac_3Bb);wac_9T.registerClass("WordEditor.Presence.WordRtcProxyProvider",null,wac_ev,wac_bo);wac_$T.registerClass("WordEditor.Presence.WordRtcProxyProvider.$$sm_WordEditor$Presence$WordRtcProxyProvider$GetInstanceAsRealtimeChannelBasicAsync",wac_8a.$$(wac_uc),Sys.IDisposable);
wac_mCb.Fod=[1];var wac_5Cb=new wac_oCb,wac_HCb=new wac_uCb,wac_ECb=null,wac_BCb=null,wac_DCb=null,wac_yCb=null,wac_ACb=null,wac_7T=null,wac_TCb=!0,wac_SCb=new (wac_$a.$$(wac_Ec)),wac_8T=new (wac_$a.$$(wac_5T)),wac_ZCb=new (wac_$a.$$(wac_zca)),wac_WCb=null,wac_6T=null,wac_VCb=null,wac_YCb=null,wac_QCb=null,wac_2Cb=null;wac_J(wac_C(),new wac_0Cb,0,!1);Type.registerNamespace("WERTT");function wac_aU(){}wac_aU.registerInterface("WERTT.IParagraphAnchoredOp");function wac_$Cb(){}wac_$Cb.registerInterface("WERTT.IRttDataStore");
function wac_aDb(){}wac_aDb.registerInterface("WERTT.IRttEditor");function wac_bDb(){}wac_bDb.prototype={unknown:0,replaceTextRangeOp:1,addParagraphOp:2,deleteParagraphOp:3,splitParagraphOp:4,mergeParagraphOp:5,replaceSymbolRangeOp:6};wac_bDb.registerEnum("WERTT.RttOpType",!1);function wac_bU(){}wac_bU.registerInterface("WERTT.IRttOp");function wac_cU(){}wac_cU.registerInterface("WERTT.IRttAppliedOp");function wac_cDb(){}wac_cDb.registerInterface("WERTT.IRttAppliedOpTracker");
function wac_dDb(){}wac_dDb.registerInterface("WERTT.IRttOpValidator");function wac_eDb(){}wac_eDb.registerInterface("WERTT.IRttSendDataStore");function wac_fDb(a,b){this.i0c=Function.createDelegate(this,this.pRe);this.g0c=Function.createDelegate(this,this.efb);this.f0c=Function.createDelegate(this,this.Foc);this.dispose=this.ka;this.jm=a;if(this.En=b)a=wac_dC(this.En,12),wac_fN(a,this.f0c),wac_kC(a,this.g0c),wac_hN(a,this.i0c)}
wac_fDb.prototype={jm:null,En:null,ka:function(){if(this.En){var a=wac_dC(this.En,12);wac_eN(a,this.f0c);wac_pC(a,this.g0c);wac_gN(a,this.i0c)}},Foc:function(a,b){4===this.jm.cE()?wac_c(9204866,355,12===b.Qc.get_type()||11===b.Qc.get_type(),"Unexpected graph modification detected during RTT edit"):wac_c(9204867,355,!1,"Unexpected graph modification detected during RTT edit")},efb:function(){wac_c(9204868,355,!1,"Unexpected graph modification detected during RTT edit")},pRe:function(){wac_c(9204869,
355,!1,"Unexpected graph modification detected during RTT edit")}};function wac_dU(a,b){this.Abc=a;this.ix=b}wac_dU.prototype={Abc:0,cE:function(){return this.Abc},ix:null,HAb:null,zAa:function(){return this.HAb},lSa:null,wV:null,Vjc:function(){return""},xH:function(){return null}};function wac_gDb(a,b){a.wV=b}function wac_hDb(){this.s4d=Function.createDelegate(this,this.IGe)}
wac_hDb.prototype={ea:null,Qb:function(){return"WordEditor.RealTimeTyping"},IGe:function(){return window.Box4.App.jc&&window.Box4.App.jc.Gk?window.Box4.App.jc.Gk:(wac_(7866377,304,15,"Unable to get the lock manager"),null)},Sb:function(a){var b=wac_Db(wac_3w,wac_m(a,wac_3w)),c=wac_Db(wac_iy,wac_m(a,wac_iy)),d=wac_Db(wac_Mc,wac_m(a,wac_Mc)),e=wac_Db(wac_DS,wac_m(a,wac_DS));this.ea=a;var f=new wac_2y,g=this;wac_Wa.WAA.call(null,b,c,d,e).CW(function(){wac_n(wac_o(a.ma(wac_aDb)),function(){return new wac_iDb(a.K(wac_ex),
a.K(wac_3w),f,a.K(wac_DS))});wac_n(wac_o(wac_p(a.ma(wac_jDb),wac_Kpb)),function(){return new wac_jDb(a.K(wac_aDb),new wac_kDb(wac_E()),new (wac_d.$$(wac_SPa))(g.s4d),new (wac_d.$$(wac_$w))(function(){return window.Box4.App.CJ}),a.K(wac_iy),a.K(wac_0F),a.K(wac_ev).jH(),new (wac_d.$$(wac_rv))(function(){return window.Box4.App.va().Ka.xc().fd()}),wac_r(),function(){return Date.now()},a.K(wac_DS),wac_E(),wac_m(a,wac_Mc),wac_8T.yc,f,wac_s(wac_q.Z,"WordEditorThrottleAndBatchRTTRendering"),new wac_lDb,wac_m(a,
wac_2T))});wac_n(wac_o(a.ma(wac_mDb)),function(){return new wac_mDb(a.K(wac_ev).jH(),new wac_nDb,new (wac_d.$$(wac_lw))(function(){return window.Box4.App.jc}),window.Box4.App.va().Ka,a.K(wac_DS),a.K(wac_iy))});g.Ukc()})},Ukc:function(){this.ea.K(wac_jDb).ob();this.ea.K(wac_mDb).ob()},ob:function(){},ka:function(){}};function wac_oDb(){this.Pib=new (wac_e.$$(wac_eU))}
wac_oDb.prototype={Pib:null,U:function(a){this.Pib.U(a);return!0},NHb:function(a){for(var b=new (wac_e.$$(wac_eU)),c=this.Pib.$$lge();c.$$mn();){var d=c.$$cu();a(d)&&b.U(d)}return b},Osc:function(a){wac_pDb(a.HAb,wac_qDb.toString(1));this.Pib.Db(a)},Psc:function(a){wac_pDb(a.HAb,wac_qDb.toString(0));this.Pib.Db(a)}};function wac_eU(a,b,c,d,e,f,g,h){wac_eU.initializeBase(this,[2,h]);this.Ova=a;this.Rod=b;this.VWa=c;this.TPb=d;this.yKb=e;this.xKb=f;this.JE=g}
wac_eU.prototype={Ova:0,Rod:0,VWa:0,TPb:null,yKb:0,xKb:0,JE:0,xH:function(){return new wac_3T(this.ix.R0,this.ix.XG,1,3,new wac_AT(2,this.Ova,this.Rod,null,this.TPb,null,null,this.JE,0),null,null,null,new wac_iCb(this.VWa,this.yKb,this.xKb),null,null,null,0,this.ix.i1)}};function wac_rDb(a,b){this.amd=a;this.mM=b}wac_rDb.prototype={cE:function(){return 1},E5a:function(){return this.amd},amd:null,mM:null};function wac_sDb(a,b){this.$ld=a;this.mM=b}
wac_sDb.prototype={cE:function(){return 6},E5a:function(){return this.$ld},$ld:null,mM:null};function wac_fU(a,b,c){this.Tuc=a;this.qhb=b;this.gTa=c}wac_fU.prototype={cE:function(){return 4},E5a:function(){return this.Tuc},Tuc:null,qhb:null,gTa:null};function wac_tDb(a,b){this.nEb=a;this.mM=b}wac_tDb.prototype={cE:function(){return 2},E5a:function(){return this.nEb},nEb:null,mM:null};function wac_lDb(){this.rla=new (wac_La.$$(wac_e.$$(wac_cU)))}
wac_lDb.prototype={rla:null,efb:function(a){var b=a.toString();if(!this.rla.kb(b))return new (wac_e.$$(wac_cU));a=this.rla.B(b);this.rla.Db(b);for(b=a.$$lge();b.$$mn();){var c=b.$$cu();c.E5a()&&wac_gDb(c.E5a(),null)}return a}};function wac_uDb(a,b){for(a=a.rla.Yk().$$ge();a.$$mn();){var c=a.$$cu();if(c.ja()&&2===c.B(0).cE()&&(c=c.B(0),c.nEb.yKb===b))return c}return null}function wac_vDb(a,b){return a.efb(b)}
function wac_wDb(a,b){switch(b.cE()){case 1:var c=window.$$as(wac_rDb,b);wac_xDb(a,c.mM,b);break;case 6:c=window.$$as(wac_sDb,b);wac_xDb(a,c.mM,b);break;case 4:c=window.$$as(wac_fU,b);wac_xDb(a,c.qhb,b);wac_xDb(a,c.gTa,b);break;case 2:c=window.$$as(wac_tDb,b),wac_xDb(a,c.mM,b)}}function wac_xDb(a,b,c){b=b.toString();a.rla.kb(b)||a.rla.W(b,new (wac_e.$$(wac_cU)));a.rla.B(b).U(c)}function wac_kDb(a){this._changes=new (wac_Ea.$$(wac_Ea.$$(wac_aU)));this.Gb=a}
wac_kDb.prototype={_changes:null,Gb:null,NHb:function(a){for(var b=new (wac_e.$$(wac_aU)),c=this._changes.Wg().$$ge();c.$$mn();)for(var d=c.$$cu(),d=this._changes.B(d),e=d.Wg().$$ge();e.$$mn();){var f=e.$$cu(),f=d.B(f);a(f)&&b.U(f)}return b},Osc:function(a){wac_yDb(this,a,1)},Psc:function(a){wac_yDb(this,a,0)}};
function wac_yDb(a,b,c){var d=null,e,f;(f=a._changes.qc(b.Ws(),e={val:d}),d=e.val,f)?(wac_pDb(b.zAa(),wac_qDb.toString(c)),d.Db(b.wG()),d.ja()||a._changes.Db(b.Ws())):wac_(50938848,355,15,"Cannot remove an op that not exist in _changes. WordId: {0}; Reason: {1}",b.Ws(),c)}function wac_zDb(a,b,c){if(!a._changes.kb(b))return null;a=a._changes.B(b);return a.kb(c)?a.B(c):null}function wac_qDb(){}wac_qDb.prototype={expired:0,dried:1};wac_qDb.registerEnum("WERTT.RttDataStore.RemoveChangeReason",!1);
function wac_ADb(a,b,c,d){wac_ADb.initializeBase(this,[3,d]);this.hg=a;this.ML=b;this.JE=c}wac_ADb.prototype={hg:0,Ws:function(){return this.hg},ML:0,wG:function(){return this.ML},Q5a:function(){return 0},JE:0,xH:function(){return new wac_3T(this.ix.R0,this.ix.XG,1,5,new wac_AT(4,this.hg,this.ML,null,null,null,null,this.JE,0),null,null,null,null,null,null,null,0,this.ix.i1)}};function wac_iDb(a,b,c,d){this.XP=a;this.hLc=b;this.Ima=c;this.R1b=d}
wac_iDb.prototype={XP:null,hLc:null,Ima:null,R1b:null,xJb:function(a){var b=new wac_R;b.ec(a);wac_QA(b,11);return wac_KC(b)?(wac_(16868566,355,50,"Blocked RTT para operation: in a list"),!0):!1}};
function wac_BDb(a){var b=a.aa.qa,c=a.ta;a=a.Ma;for(var d=0;d<b.ia();d++){var e=b.B(d);if(e.Fa>=a)break;if(e.Fa>=c){if(e.Ld)return wac_(8242647,355,15,"Rejected unsafe wet change: range contains comment"),!1;if(e.gd)return wac_(8242648,355,15,"Rejected unsafe wet change: range contains blob"),!1;if(e.Qf||e.Kj&32||e.Kj&64)return wac_(8242649,355,15,"Rejected unsafe wet change: range contains field"),!1}}return!0}
function wac_CDb(a,b,c,d){for(var e=c.ja()-1;0<=e;e--){var f=c.B(e);switch(f.cE()){case 4:f=window.$$as(wac_fU,f);if(!b.ha().za(f.qhb)){wac_c(9204885,355,b.ha().za(f.gTa),null);continue}f=d.Kb(f.gTa);if(!f)break;if(!f||!wac_U(f)){wac_c(9204886,355,!1,null);break}if(!f.wb)continue;var g,h,k,f=(k=wac_DDb(f,h={val:g}),g=h.val,k);wac_c(9204887,355,f,null);f&&wac_EDb(a,g);break;case 2:if(f=window.$$as(wac_tDb,f),!b.ha().za(f.mM))wac_c(16820001,355,!1,null);else if(b.wb){var l,m,f=(m=wac_DDb(b,l={val:g}),
g=l.val,m);wac_c(16820002,355,f,null);f&&wac_EDb(a,g)}}}}function wac_FDb(a,b){if(b.wb){var c,d,e;if(e=wac_DDb(b,d={val:c}),c=d.val,e)wac_EDb(a,c);else{c=wac_Uz(b).ah;a=a.Ima.Xc(3,0);try{wac_Q(a,b),b.ji(c.Kb(b.ha())),wac_AC(b.wb,4)}finally{a&&a.dispose()}}}}function wac_EDb(a,b){var c=new wac_R;c.ec(b);wac_W(c);a=a.Ima.Xc(3,0);try{wac_Q(a,c.ga()),wac_6z(b)}finally{a&&a.dispose()}}function wac_DDb(a,b){b.val=wac_P(a);wac_S(b.val,23);wac_W(b.val);return 89===b.val.Oj()}
function wac_GDb(a,b,c){return b===c?wac_4A(a,b):wac_V(a,b,c)}function wac_HDb(a,b,c,d){var e=wac_aS(c,b.Ova);if(e.za(wac_x()))return null;e=d.Kb(e);if(!e||!wac_U(e)||!e.wb)return null;var f=wac_P(e);if(!wac_S(f,23))return null;if(b.TPb){b=wac_aS(c,b.TPb);if(b.za(wac_x()))return null;d=d.Kb(b);if(!d||!wac_U(d)||!d.wb)return null;d=wac_P(d);if(!wac_S(d,23))return null;wac_QA(d,11);wac_VI(d);wac_Sz(d);if(d.ga()!==e)return null}return a.xJb(f)?null:f}
function wac_jDb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,u,v){this.zga=Function.createDelegate(this,this.Iua);this.X7b=Function.createDelegate(this,this.Mpc);this.S2d=Function.createDelegate(this,this.cEe);this.yza=a;this.Twa=b;this.j1a=c;this.Bna=d;this.qb=e;this.Kt=f;this.tr=g;this.Ef=h;this.gb=k;this.lw=l;this.R1b=m;this.Gb=n;this.koa=q;this.vb=r;this.LRc=t;this.dwa=u;this.iwb=v;this.q2a=new (wac_Ca.$$(String))(wac_qa());this.AXa=new wac_oDb;p.ub(wac_IDb)}
function wac_IDb(a){for(var b=[3959281607,1157520733],c=b.length,d=0;d<c;++d){var e=b[d];a.tM(e,"WetChangeCount",wac_Bj);a.tM(e,"NoChangesToApply",wac_Bj);a.tM(e,"NodeNotConnected",wac_Bj);a.tM(e,"CouldNotGetLock",wac_Bj);a.tM(e,"WetChangeBlocked",wac_Bj);a.tM(e,"ParagraphAlreadyDirty",wac_Bj);a.tM(e,"UnsafeWetChange",wac_Bj)}a.tM(1839802051,"FailedToFindInitialParaID",wac_oyb);a.tM(1839802051,"FailedToFindInitialTextID",wac_oyb);a.tM(1839802051,"MsecUntilApplied",wac_nyb);a.tM(1839802051,"RemovedBecause",
wac_Bj);a.tM(1839802051,"PacketVersions",wac_Bj);a.tM(1839802051,"OperationType",wac_Bj)}
wac_jDb.prototype={yza:null,Twa:null,AXa:null,j1a:null,Bna:null,qb:null,Kt:null,tr:null,rg:null,Ef:null,lw:null,gb:null,DRd:!1,R1b:null,Gb:null,koa:null,vb:null,dwa:null,iwb:null,q2a:null,MHc:!1,LRc:!1,ob:function(){return this.tr?this.tr.CW(this.X7b):wac__a(Boolean,!1)},Mpc:function(){wac_(7685328,355,50,"All prerequisite ready for RttManager");this.rg=this.tr.Ob();wac_(7685330,355,50,"Subscribing to presence updates");this.rg.C3(this.zga)},Iua:function(a,b){if(3===b.sg&&wac_JDb(this))if(this.Bna.pa()&&
this.Bna.pa().ak&4)wac_(8454939,355,15,"RTT channel did not get disconnected on lock release");else if(b.qpa){if(this.TMd||(wac_(8704354,355,50,"Received a wet change"),this.TMd=!0),(a=wac_KDb(this,b.qpa))&&1!==a.ix.icd)switch(this.RMd||(wac_(8185606,355,50,"Received a wet change that we could deserialize"),this.RMd=!0),this.DRd||(b=new wac_uh(3,2,6E4,this.S2d,0,null,!1),this.gb.zc(b),this.DRd=!0),a.cE()){case 1:case 6:case 4:var c,d,e;if(e=wac_LDb(this,a,d={val:c}),c=d.val,!e)break;this.LRc?wac_MDb(this,
c):wac_NDb(this,c);break;case 2:this.AXa.U(a),wac_ODb(this,a),this.LRc?wac_MDb(this,wac_x()):wac_PDb(this,a)}}else wac_(7685331,355,15,"RTT packet was empty")},cEe:function(){var a=this.Ef.pa();if(a){var b=this.lw()-18E4,c=this.Twa.NHb(function(a){return a.ix.Dvc<b});0<c.ja()&&!this.APc&&!this.SMd&&(wac_(8185608,355,15,"Failed to apply any wet changes so far"),this.SMd=!0);for(var d=new wac_Na,e=c.$$lge();e.$$mn();)if(c=e.$$cu(),this.Twa.Psc(c),c.wV)switch(c.wV.cE()){case 1:d.U(c.wV.mM.toString());
break;case 6:d.U(c.wV.mM.toString());break;case 4:d.U(c.wV.qhb.toString()),d.U(c.wV.gTa.toString())}for(e=this.AXa.NHb(function(a){return a.ix.Dvc<b}).$$lge();e.$$mn();)c=e.$$cu(),this.AXa.Psc(c),c.wV&&d.U(c.wV.mM.toString());for(d=d.GetEnumerator();d.$$mn();)c=d.$$cu(),(c=a.Kb(wac_Ul(c)))?c.OH?(wac_FDb(this.yza,c),c.OH||(wac_byb(this.j1a.pa(),c),c.oa(Number,wac_7u,0))):wac_(8765829,355,15,"Expiring wet change from paragraph with no applied changes"):wac_(8765828,355,15,"Expiring wet change with invalid object ID")}else!this.Ef.P4a&&
wac_(7685332,355,10,"Failed to find the IObjectSpace! Wet changes will never expire")},Yad:function(a,b){wac_QDb(this,a,b)},aNb:function(a){if(wac_JDb(this)&&a.Da(wac_1r)&&a.Da(wac_nt)){var b=a.Ja(Number,wac_1r),c=a.oa(Number,wac_nt,0),d=this.Gb.vj(1157520733,-1),e=wac_vDb(this.dwa,a.ha());0<e.ja()&&(wac_CDb(this.yza,a,e,this.Ef.pa()),wac_RDb(this,a,e,c));var f=wac_uDb(this.dwa,b);if(f&&!a.ha().za(f.mM)){var g=this.Ef.pa(),h=this;wac_SDb(this,function(){var a=h.dwa.efb(f.mM),b=g.Kb(f.mM);wac_c(16820032,
355,!!b,"Could not find added graph node");b&&(wac_CDb(h.yza,b,a,g),h.AXa.Osc(f.nEb))})}wac_zDb(this.Twa,b,c)||wac_byb(this.j1a.pa(),a);this.Yad(a,d);d.xd()}},vpc:function(a){var b=this.dwa.efb(a.ha());0<b.ja()&&(2===b.B(0).cE()&&b.Td(0),wac_CDb(this.yza,a,b,this.Ef.pa()))},FWa:function(a){for(var b=a.ha(),c,d,e,b=((e=this.dwa.rla.qc(b.toString(),d={val:c}),c=d.val,e)?c:new (wac_e.$$(wac_cU))).$$lge();b.$$mn();)if(c=b.$$cu(),4===c.cE()&&(c=window.$$as(wac_fU,c),a.ha().za(wac_gU(c.Tuc)?c.gTa:c.qhb)))return!0;
return!1},TMd:!1,RMd:!1,VMd:!1,APc:!1,SMd:!1};function wac_TDb(a){a.APc||(wac_(8185607,355,50,"Successfully applied a wet change"),a.APc=!0)}function wac_UDb(a){a.VMd||(wac_(17147533,355,50,"Received a usable wet change"),a.VMd=!0)}
function wac_RDb(a,b,c,d){for(var e=!1,f=c.ja()-1;0<=f;f--){var g=c.B(f);switch(g.cE()){case 1:case 6:case 4:g=window.$$as(wac_aU,g.E5a());break;default:continue}if(g.Q5a()===d){var e=!0,h;if(h=g.lSa){h=g.lSa;var k=b,l=h.Yb===k.ha();l&&(l=h.O4c.replace("\u00a0"," "),h=k.Jb.substr(h.nz,h.Yo-h.nz).replace("\u00a0"," "),l=l===h);h=!l}h&&wac_(8765831,355,15,"Validating wet change location failed. Type {0} OffsetInfo {1} NodeId {2} ValidatorNodeId {3} ValidatorNodeCpBegin {4} ValidatorNodeCpEnd {5}",g.cE(),
g.Vjc(),b.ha(),g.lSa.ha(),g.lSa.nz,g.lSa.Yo)}e&&a.Twa.Osc(g)}e&&wac_TDb(a)}
function wac_QDb(a,b,c){if(!b)return null;if(!b.wb)return c&&c.Ia().W("NodeNotConnected","1"),null;if(!b.Da(wac_1r))return wac_(7619922,355,15,"Paragraph is missing the WordId property"),null;if(!b.Da(wac_nt))return wac_(8197722,355,15,"Paragraph is missing the TextId property"),null;if(b.Da(wac_NDa)&&b.Ja(Boolean,wac_NDa))return wac_(16815506,355,50,"RTT edit disabled in paragraph"),null;var d=b.Ja(Number,wac_1r),e=wac_cyb(b);c&&(c.Ia().W("NodeTextId",e.toString()),c.Ia().W("NodeWordId",d.toString()));
e=wac_zDb(a.Twa,d,e);if(!e)return c&&c.Ia().W("NoChangesToApply","1"),null;if(!wac_VDb(a,b,e))return c&&c.Ia().W("CouldNotGetLock","1"),null;for(var f=0,g=null;e;){var h;a:{var k=a.yza,l=e,m=b,n=a.dwa,p=c;if(m.GZ())p&&p.Ia().W("ParagraphAlreadyDirty","1"),h=!1;else{var q=new wac_fDb(l,m.Ei());try{if(1===l.cE()||6===l.cE()){var r=window.$$as(wac_hU,l),t,u=r,v=m,w=wac_BT(v.Jb,v.qa),x=wac_zT(w,u.Mra),y=wac_zT(w,u.ARa);t=x===y?wac_4A(v,x):wac_V(v,x,y);var z,A=t.aa.Jb,C=10<=t.ta?t.ta-10:0,B=t.Ma+10<=A.length?
t.Ma+10:A.length,D=A.substr(C,t.ta-C),E=A.substr(t.Ma,B-t.Ma),B=B+r.Sha.length-(t.Ma-t.ta),G=D+r.Sha+E;z=new wac_WDb(t.aa.ha(),C,B,G);var F=6===r.Abc,H="";F&&(H=r.W5c);var O;var u=t,K=r.Sha,v=F,J=u.aa;if(u.ta===u.Ma||wac_BDb(u)){var M=k.Ima.Xc(3,0);try{wac_Q(M,J);var L=wac_oI(J);try{J.OH=!0,wac_dyb(k.XP,u,K,v,H)}finally{L&&L.dispose()}M.ZU=-1}finally{M&&M.dispose()}O=!0}else p&&p.Ia().W("UnsafeWetChange","1"),O=!1;if(!O){h=!1;break a}p=void 0;p=1===l.cE()?new wac_rDb(r,m.ha()):new wac_sDb(r,m.ha());
m.rZa=l.Q5a();r.lSa=z;wac_gDb(l,p);wac_wDb(n,p)}else{var N;if(4===l.cE()){var p=k,Q=window.$$as(wac_iU,l),R=wac_zT(wac_BT(m.Jb,m.qa),Q.Kw);if(wac_BDb(wac_V(m,0,wac_T(m)))){var P=wac_P(m);wac_S(P,10);if(p.xJb(P))N=!1;else{var k=void 0,S=p.Ima.Xc(3,0);try{wac_Q(S,m);var aa=wac_oI(m);try{var V=wac_P(m);wac_S(V,10);wac_QA(V,11);var X=V.ga();wac_gU(Q)&&(V.Uv(-1)?X=null:(wac_VI(V),X=V.ga()));wac_W(V);var U=p.hLc.cTa();V.yx(U,X,89);V.ig(U);var k=m.Ac(),I=wac_oI(k);try{k.la(wac_1r,wac_gU(Q)?Q.UPb:Q.Aib);
k.la(wac_nt,wac_gU(Q)?Q.Jhb:Q.Khb);k.fy(!1);V.Xd(k,2);V.ig(k);u=m;v=k;v.x6=!0;wac_7G(v,u.Jb);v.rZa=wac_cyb(u);v.qa.xe();for(H=0;H<u.qa.ia();H++){var T=wac_ZI(u.qa.B(H),v,null);v.qa.U(T)}v.ej();if(v.ud.ia())for(H=0;H<v.qa.ia();H++){var Z=v.qa.B(H).ab;if(Z&&-1!==Z.yk)for(;v.ud.ia()<=Z.yk;)wac_LG(v.ud,v.ud.ia()-1,256,1)}else wac_(9204881,355,15,"Cannot update WordRunProperties after splitting paragraph");v.x6=!1;var qa=wac_gU(Q)?k:m,ra=wac_gU(Q)?m:k;qa.OH=!0;ra.OH=!0;wac_dyb(p.XP,wac_GDb(qa,R,wac_T(qa)),
"",!1,"");wac_dyb(p.XP,wac_GDb(ra,0,R),"",!1,"");m.rZa=Q.saa;k.rZa=wac_gU(Q)?Q.Jhb:Q.Khb}finally{I&&I.dispose()}}finally{aa&&aa.dispose()}S.ZU=-1}finally{S&&S.dispose()}var ba=new wac_fU(Q,m.ha(),k.ha());wac_gDb(l,ba);wac_wDb(n,ba);N=!0}}else N=!1}else N=!1;h=N;break a}}finally{q&&q.dispose()}h=!0}}if(!h){c&&c.Ia().W("WetChangeBlocked","1");break}f++;g=e.zAa();q=a.lw();g.SC&&(g.SC.Ia().kb("MsecUntilApplied")||g.SC.Ia().W("MsecUntilApplied",(q-g.SC.lV()).toString()));g=e;e=wac_cyb(b);e=wac_zDb(a.Twa,
d,e)}0<f&&wac_TDb(a);c&&c.Ia().U("WetChangeCount",f.toString());return g}function wac_VDb(a,b,c){if(!a.j1a.pa())return wac_c(7866378,355,!!a.j1a.pa(),"Unable to apply wet changes as LockManager unavailable"),!1;var d;a=a.j1a.pa();c=wac_ayb(a,b,c.ix.XG);var e=b.oa(Number,wac_7u,0);e&&a.ua.Ya("WLA",new wac__sb(e),a);c&&c.LockId!==e&&wac_0Pa(c,b);return(d=!!c,d)?!0:(wac_(7866379,355,15,"Unable to apply a wet change lock"),!1)}
function wac_XDb(a,b){var c=b.xH();if(2!==c.yba||c.tE.Cba&&c.tE.aka!==c.tE.Cba)return null;var d=b.Mra.Ac();0<b.Sha.length&&(wac_upb(d),d.gg+=b.Sha.length);c.yba=0;c.Text=null;c.tE.$fb=0;c.tE.xua=d;c.tE.uva=c.sHa;c.tE.Cba=null;c.tE.Lhb=null;c.tE.tVa=null;c.sHa=null;return wac_GCb(c,a.Kt,a.R1b,function(){return a.Ef.pa()},a.iwb.Ea())}function wac_YDb(a,b){a.koa.CW(function(){if(1===b.cE()){var c=wac_XDb(a,b);c&&(wac_XBb(a.koa.Ob(),c),c=a.koa.Ob(),wac_YBb(c))}})}
function wac_PDb(a,b){var c=wac_HDb(a.yza,b,a.Kt,a.Ef.pa());if(c){wac_UDb(a);var d=a.yza,e=a.dwa,f=wac_k().K(wac_lx),g=c.ga(),h=d.Ima.Xc(3,0);try{wac_Q(h,g);wac_QA(c,11);var k=c.ga();wac_W(c);var l=d.hLc.cTa();c.yx(l,k,89);c.ig(l);var m=wac_gv.Rf.fo(393230),n=wac_oI(m);try{m.la(wac_yq,""),m.x6=!0,f.jWa(m),d=[0],m.la(wac_0r,d),m.la(wac_Hs,d),m.x6=!1,m.la(wac_1r,b.yKb),m.la(wac_nt,b.xKb),m.fy(!1),c.Xd(m,2),m.OH=!0,m.rZa=b.xKb}finally{n&&n.dispose()}h.ZU=-1;b.wV=new wac_tDb(b,m.ha());wac_wDb(e,b.wV)}finally{h&&
h.dispose()}c=b.wV.mM;c=a.Ef.pa().Kb(c);wac_VDb(a,c,b)}}function wac_NDb(a,b){b=a.Ef.pa().Kb(b);var c,d=a.vb.Xc(3,0);try{wac_Q(d,b);c=a.Gb.vj(3959281607,-1);var e=wac_QDb(a,b,c);c.xd();e&&wac_YDb(a,e)}finally{d&&d.dispose()}}
function wac_ZDb(a){for(var b=a.AXa.NHb(function(a){return!a.wV}).$$lge();b.$$mn();){var c=b.$$cu();wac_PDb(a,c)}if(a.q2a.ja()){b=null;for(c=a.q2a.GetEnumerator();c.$$mn();){var d=c.$$cu(),b=wac_Ul(d),b=a.Ef.pa().Kb(b);break}c=a.vb.Xc(3,0);try{wac_Q(c,b);for(var e=a.q2a.GetEnumerator();e.$$mn();)d=e.$$cu(),wac_NDb(a,wac_Ul(d))}finally{c&&c.dispose()}a.q2a.xe()}}
function wac_ODb(a,b){(a=a.Gb)?(a=a.vj(1839802051,48E4),a=new wac__Db(a)):a=null;b.HAb=a;a=b.zAa();a.SC&&a.SC.Ia().W("PacketVersions",b.ix.dkd.toString());a=b.zAa();b=wac_bDb.toString(b.cE());a.SC&&a.SC.Ia().W("OperationType",b)}function wac_SDb(a,b){b=new wac_uh(0,1,0,b,71,null,!1);a.gb.zc(b)}function wac_MDb(a,b){b.za(wac_x())||a.q2a.U(b.toString());a.MHc||(b=new wac_uh(0,1,200,function(){wac_ZDb(a);a.MHc=!1},71,null,!1),a.gb.zc(b),a.MHc=!0)}
function wac_LDb(a,b,c){c.val=wac_x();var d;d=a.Twa;if(b){var e=b.Ws(),f=b.wG();d._changes.kb(e)||d._changes.U(e,new (wac_Ea.$$(wac_aU)));d._changes.B(e).W(f,b);var g;b:{if(d._changes.kb(e)&&(g=d._changes.B(e),g.kb(f)))for(var h=g.B(f);h;){h=h.Q5a();if(h===f){g=!0;break b}if(!g.kb(h))break;h=g.B(h)}g=!1}g?(wac_(7619921,355,15,"Detected an infinite loop in paragraph {0}, dropping the last packet!",e),d._changes.B(e).Db(f),d=!1):d=!0}else wac_(7685333,355,15,"Cannot add a null change to RTTStore"),
d=!1;if(!d)return!1;wac_ODb(a,b);if(!a.Kt)return!1;d=wac_aS(a.Kt,b.Ws());if(d.za(wac_x())||!a.Ef.pa().Kb(d))return wac_0Db(b.zAa()),!1;wac_UDb(a);c.val=d;return!0}
function wac_KDb(a,b){b=wac_rCb(b);if(!b)return null;switch(b.yba){case 2:var c,d,e,f,g,h,k,l,m;(m=wac_1Db(b,g={val:c},h={val:d},k={val:e},l={val:f}),c=g.val,d=h.val,e=k.val,f=l.val,m)?(a="",b.Text&&(a=b.Text),g=wac_2Db(b),b=new wac_3Db(e,f,c,d,b.sHa,a,b.tE.JE,g)):b=null;return b;case 7:return wac_4Db(b);case 4:return wac_5Db(a)?(c=b.tE,d=b.kHa,b=new wac_iU(c.aka,c.uva,c.xua,c.JE,d.Jqc,d.uvc,d.Kqc,d.vvc,wac_2Db(b))):b=null,b;case 3:return wac_5Db(a)?(c=b.tE,d=b.rSa,e=null,null!=b.tE.Cba&&(e=b.tE.Cba),
b=new wac_eU(c.aka,c.uva,d.wvc,e,d.Lqc,d.VWa,c.JE,wac_2Db(b))):b=null,b;default:return wac_(8459668,355,50,"RTT packet is of unexpected operationType {0}",b.yba),null}}function wac_5Db(a){return wac_JDb(a)&&a.qb.xb(108)}function wac_JDb(a){return a.qb.xb(142)&&a.qb.xb(112)}function wac_6Db(a,b,c,d,e,f,g,h){wac_6Db.initializeBase(this,[5,h]);this.SPb=a;this.tvc=b;this.nqd=c;this.Sod=d;this.JE=e;this.exc=f;this.UWa=g}
wac_6Db.prototype={SPb:0,tvc:0,nqd:0,Sod:0,JE:0,exc:0,UWa:0,Ws:function(){return this.SPb},wG:function(){return this.tvc},Q5a:function(){return this.SPb===this.exc?this.UWa:0},xH:function(){return new wac_3T(this.ix.R0,this.ix.XG,1,6,new wac_AT(5,this.SPb,this.tvc,null,this.nqd,this.Sod,null,this.JE,0),null,null,null,null,new wac_jCb(this.exc,this.UWa),null,null,0,this.ix.i1)}};function wac__Db(a){this.SC=a}wac__Db.prototype={SC:null};
function wac_pDb(a,b){a.SC&&(a.SC.Ia().W("RemovedBecause",b),a.SC.xd())}function wac_0Db(a){a.SC&&a.SC.Ia().W("FailedToFindInitialParaID","1")}function wac_WDb(a,b,c,d){this.Yb=a;this.nz=b;this.Yo=c;this.O4c=d}wac_WDb.prototype={Yb:null,ha:function(){return this.Yb},nz:0,Yo:0,O4c:null};function wac_7Db(a,b,c,d,e,f){this.R0=a;this.XG=b;this.icd=c;this.Dvc=d;this.dkd=e;this.i1=f}function wac_2Db(a){var b=null;null!=a.i1&&(b=a.i1);return new wac_7Db(a.R0,a.XG,a.hab,Date.now(),a.Mva,b)}
wac_7Db.prototype={R0:0,XG:null,icd:0,Dvc:0,dkd:0,i1:null};function wac_3Db(a,b,c,d,e,f,g,h){wac_3Db.initializeBase(this,[a,b,c,d,e,f,g,h,1])}wac_3Db.prototype={Vjc:function(){return"OffsetStart: "+this.Mra+"OffsetEnd: "+this.ARa+"TextAddedLength: "+this.Sha.length},xH:function(){var a=wac_8Db(this);return new wac_3T(this.ix.R0,this.ix.XG,1,2,a,null,this.saa,this.Sha,null,null,null,null,0,this.ix.i1)}};
function wac_9Db(a,b,c,d,e,f,g,h,k,l,m){wac_9Db.initializeBase(this,[d,e,f,g,h,k,l,m,6]);this.W5c=a;this.vre=b;this.Zre=c}
function wac_4Db(a){var b,c,d,e,f,g,h,k,l;if(l=wac_1Db(a,f={val:b},g={val:c},h={val:d},k={val:e}),b=f.val,c=g.val,d=h.val,e=k.val,!l)return null;if(1===a.Text.length)f=!1,g="\ufffc";else if(2===a.Text.length)if(f=a.Text,55296<=f.charCodeAt(0)&&56319>=f.charCodeAt(0)&&wac_hg(a.Text,1))f=!0,g=a.Text;else return wac_(8914772,355,15,"RTT symbol packet has text length 2 but is not a valid surrogate pair",a.yba),null;else return wac_(8914773,355,15,"RTT symbol packet text is of unsupported length (length must be 1 or 2)",
a.yba),null;h=a.Ehb;k=wac_2Db(a);return new wac_9Db(h.lvc,h.mvc,f,d,e,b,c,a.sHa,g,a.tE.JE,k)}wac_9Db.prototype={W5c:null,vre:!1,Zre:!1,Vjc:function(){return"OffsetStart: "+this.Mra+"OffsetEnd: "+this.ARa},xH:function(){var a=wac_8Db(this);return new wac_3T(this.ix.R0,this.ix.XG,1,7,a,null,this.saa,this.Sha,null,null,null,null,0,this.ix.i1)}};function wac_hU(a,b,c,d,e,f,g,h,k){wac_hU.initializeBase(this,[k,h]);this.hg=a;this.ML=b;this.Mra=c;this.ARa=d;this.saa=e;this.Sha=f;this.B4=g}
function wac_1Db(a,b,c,d,e){a=a.tE;if(1===a.$fb&&(a.aka!==a.Cba||a.uva!==a.Lhb))return wac_(8914769,355,15,"We received a ReplaceRange operation spanning multiple paragraphs"),b.val=c.val=null,d.val=e.val=-1,!1;if(a.JE)return b.val=c.val=null,d.val=e.val=-1,!1;b.val=a.xua;c.val=b.val;1===a.$fb&&(c.val=a.tVa);d.val=a.aka;e.val=a.uva;return!0}wac_hU.prototype={hg:0,Ws:function(){return this.hg},ML:0,wG:function(){return this.ML},Mra:null,ARa:null,saa:0,Q5a:function(){return this.saa},Sha:null,B4:0};
function wac_8Db(a){return a.Mra.Tv(a.ARa,!0)?new wac_AT(0,a.hg,a.ML,a.Mra,null,null,null,a.B4,0):new wac_AT(1,a.hg,a.ML,a.Mra,a.hg,a.ML,a.ARa,a.B4,0)}function wac_nDb(){this.g3a=new (wac_jU.$$(wac_zLa))}wac_nDb.prototype={g3a:null};function wac_$Db(a){return a.g3a.Vm()?null:a.g3a.mTa()}function wac_mDb(a,b,c,d,e,f){this.U0c=Function.createDelegate(this,this.rTe);this.X7b=Function.createDelegate(this,this.Mpc);this.tr=a;this.bPc=b;this.sN=c;this.Vo=d;this.Bpa=e;this.qb=f}
wac_mDb.prototype={tr:null,Vk:null,bPc:null,sN:null,Vo:null,Bpa:null,qb:null,Qtb:null,XHc:!1,kQd:0,eSc:0,XQd:!1,r1b:!1,aPc:0,Mfa:function(){return this.sN.pa()},ob:function(){return this.tr?this.tr.CW(this.X7b):wac__a(Boolean,!1)},Mpc:function(){wac_(8245954,355,50,"All prerequisites ready for RttSendManager");this.Vk=this.tr.Ob();wac_nBb(this.Vk,this)},Yd:function(){this.XHc||(wac_aEb(this)&&this.Vo.xc().rs.ua.hb("PTC",this.U0c),this.XHc=!0)},kd:function(){this.XHc=!1;wac_aEb(this)&&this.Vo.xc().rs.ua.nd("PTC",
this.U0c)},rTe:function(a,b){if(this.Vk&&2===this.Vk.CZ()&&(a=b.rs,a.length))if(b.w4c)100>this.eSc&&(this.eSc++,wac_(8270467,355,50,"Blocking send. Reason: {0} OverallSends: {1} OverallBlocked: {2}",b.x4c,this.kQd,this.eSc));else{for(b=0;b<a.length;b++){var c=a[b],d=c;if(!d||-1===d.B4||d.tg()&&(!wac_aEb(this)||!this.qb.xb(109)||3!==d.tg()&&1!==d.tg()))return}for(b=0;b<a.length;b++){var c=a[b],e=!c.tg()&&!b,d=this.bPc;d.g3a.jbd()&&e&&d.g3a.jbd().GDa(c)||d.g3a.Qaa(c)}this.Qtb||wac_bEb(this,this.Qtb,
this.Vk)}}};
function wac_cEb(a,b){if(!b)return null;if(!a.Mfa())return wac_(8245957,355,15,"GetParagraphAnchoredOpFromGraphTransactionOperation: CoAuth manager is null"),null;var c=wac_pCb(wac_5Cb);a=a.Mfa().NG;var d=wac_HCb;4294967295===d.mub&&(d.mub=0);d.mub++;c=new wac_7Db(c,a,1,0,0,d.mub);a=null;switch(b.tg()){case 0:b.tg()?a=null:(a=wac_BT(b.mE.ls(),b.mE.R9b),a=new wac_3Db(b.mE.Ws(),b.mE.wG(),wac_xT(a,b.nz),wac_xT(a,b.Yo),b.AL.wG(),b.E_,b.B4,c));break;case 4:a=4!==b.tg()?null:new wac_ADb(b.YBa.Ws(),b.YBa.wG(),
b.B4,c);break;case 3:a=3!==b.tg()?null:new wac_eU(b.F_.Ws(),b.F_.wG(),b.Y7c.wG(),b.Cha?b.Cha.Ws():null,b.AL.Ws(),b.AL.wG(),b.B4,c);break;case 2:a=2!==b.tg()?null:new wac_6Db(b.F_.Ws(),b.F_.wG(),b.Cha.Ws(),b.Cha.wG(),b.B4,b.O8a.Ws(),b.O8a.wG(),c);break;case 1:a=1!==b.tg()?null:new wac_iU(b.mE.Ws(),b.mE.wG(),wac_xT(wac_BT(b.mE.ls(),b.mE.R9b),b.Lcc),b.B4,b.Dga.Ws(),b.Dga.wG(),b.JBa.Ws(),b.JBa.wG(),c)}return a}
function wac_bEb(a,b,c){wac_dEb(a);b&&(wac_1a(b)||wac_2a(b))&&wac_(8245956,355,15,"Task is faulted or cancelled with exception {0}",b.Bk);(b=wac_cEb(a,wac_$Db(a.bPc)))?(a.kQd++,a.Qtb=c.sM(3,wac_tCb(b.xH()),!1),wac_eEb(a),a.Qtb.CW(function(b){wac_bEb(a,b,c)})):a.Qtb=null}function wac_eEb(a){!a.r1b&&5>=a.aPc&&(wac_(8270469,355,50,"Sent Rtt Message"),a.r1b=!0)}function wac_dEb(a){a.r1b||(a.XQd||(wac_(8270468,355,50,"Preparing to send RTT change"),a.XQd=!0),!a.r1b&&5>=a.aPc&&a.aPc++)}
function wac_aEb(a){return a.qb.xb(142)&&a.qb.xb(120)}function wac_iU(a,b,c,d,e,f,g,h,k){wac_iU.initializeBase(this,[4,k]);this.hg=a;this.ML=b;this.Kw=c;this.JE=d;this.UPb=e;this.Jhb=f;this.Aib=g;this.Khb=h;this.UPb===this.hg?this.saa=this.Jhb:this.Aib===this.hg?this.saa=this.Khb:(wac_(8397766,355,10,"Bad data passed to RttSplitParagraphOp"),this.saa=0)}
wac_iU.prototype={hg:0,Ws:function(){return this.hg},ML:0,wG:function(){return this.ML},saa:0,Q5a:function(){return this.saa},Kw:null,JE:0,UPb:0,Jhb:0,Aib:0,Khb:0,xH:function(){return new wac_3T(this.ix.R0,this.ix.XG,1,4,new wac_AT(3,this.hg,this.ML,this.Kw,null,null,null,this.JE,0),null,null,null,null,null,new wac_kCb(this.UPb,this.Jhb,this.Aib,this.Khb),null,0,this.ix.i1)}};function wac_gU(a){return a.hg===a.Aib}wac_fDb.registerClass("WERTT.GraphChangeValidator",null,Sys.IDisposable);
wac_dU.registerClass("WERTT.RttOp",null,wac_bU);wac_hDb.registerClass("WERTT.WordEditorRealTimeTypingPackage",null,wac_I,wac_j);wac_oDb.registerClass("WERTT.RttAddParagraphDataStore");wac_eU.registerClass("WERTT.RttAddParagraphOp",wac_dU);wac_rDb.registerClass("WERTT.RttAppliedReplaceTextRangeOp",null,wac_cU);wac_sDb.registerClass("WERTT.RttAppliedReplaceSymbolRangeOp",null,wac_cU);wac_fU.registerClass("WERTT.RttAppliedSplitParagraphOp",null,wac_cU);
wac_tDb.registerClass("WERTT.RttAppliedAddParagraphOp",null,wac_cU);wac_lDb.registerClass("WERTT.RttAppliedOpTracker",null,wac_cDb);wac_kDb.registerClass("WERTT.RttDataStore",null,wac_$Cb);wac_ADb.registerClass("WERTT.RttDeleteParagraphOp",wac_dU,wac_aU,wac_bU);wac_iDb.registerClass("WERTT.RttEditor",null,wac_aDb);wac_jDb.registerClass("WERTT.RttManager",null,wac_Kpb);wac_6Db.registerClass("WERTT.RttMergeParagraphOp",wac_dU,wac_aU,wac_bU);wac__Db.registerClass("WERTT.RttOpActivity");
wac_WDb.registerClass("WERTT.RttOpValidator",null,wac_dDb);(function(){}).registerClass("WERTT.RttOpValidatorFactory");wac_7Db.registerClass("WERTT.RttOpMetadata");wac_hU.registerClass("WERTT.RttReplaceRangeOp",wac_dU);wac_3Db.registerClass("WERTT.RttReplaceTextRangeOp",wac_hU,wac_aU,wac_bU);wac_9Db.registerClass("WERTT.RttReplaceSymbolRangeOp",wac_hU,wac_aU,wac_bU);wac_nDb.registerClass("WERTT.RttSendDataStore",null,wac_eDb);wac_mDb.registerClass("WERTT.RttSendManager",null,wac_fv);
wac_iU.registerClass("WERTT.RttSplitParagraphOp",wac_dU,wac_aU,wac_bU);wac_J(wac_C(),new wac_hDb,0,!1);Type.registerNamespace("RealtimePresenceUI");function wac_fEb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r){wac_fEb.initializeBase(this,[a,f,r,b]);this.Ysd=c;this.pMd=d;this.eLd=e;this.sa=g;wac_gEb=h;this.Kt=k;this.Od=l;this.KQ=m;this.iwb=n;this.$P=q}
function wac_hEb(a,b,c,d,e){var f=wac_m(wac_kU,wac_2T),g=wac_kU.K(wac_0c).If,h=wac_kU.K(wac_fb),k=window.Box4.App.va().Ka,l=wac_y(),m=wac_Jy(),n=wac_k().K(wac_Qw);return new wac_fEb(a,b,function(a,b){return k.rd.Ti()?k.rd.gFb(a,b,!0):!1},function(a,b){k.rd.Ti()&&k.rd.vNb(a,b,!0,!0)},function(a){wac_t()&&wac_t().nb.vd()?wac_Hy().AHa():(g.Yu(a),wac_Pfb())},l,m,k,c,d,e,f,0,n,h)}
function wac_iEb(a){var b=wac_gEb.xc().fd().Kb(a.ml().gC());if(wac_i(b))return wac_(20764576,325,15,"The node could not be obtained"),null;if(!wac_U(b))return wac_(20764577,325,15,"The obtained node is not a paragraph node"),null;a=wac_4A(b,a.ml().SG.Se());return new wac_FC([a],!0,null)}wac_fEb.prototype={Ysd:null,pMd:null,eLd:null,sa:null,Kt:null,Od:null,KQ:null,iwb:null,$P:null,Dwc:function(a){this.$P.MJb(a.CommandValueId);return wac_qzb.prototype.Dwc.call(this,a)},ka:function(){wac_gBb.prototype.ka.call(this)}};
function wac_Bzb(a,b,c){c.val=wac_Czb(a,b);return!!c.val}function wac_Czb(a,b){return b?(a=wac_GCb(wac_rCb(b),a.Kt,a.Od,a.KQ,a.iwb.Ea()))&&a.tj()&&a.ml()?a:null:null}
function wac_vzb(a,b){var c,d,e;if(e=wac_Bzb(a,b,d={val:c}),c=d.val,e)a.pMd(c.ml().gC(),c.ml().SG.Se()),wac_s(wac_q.Z,"WordEditorMoveIpToUserLocationIsEnabled")&&(b=wac_iEb(c),wac_i(b)?wac_(20764575,325,50,"IP will not be moved since the selection is either null or undefined"):(wac_(20764574,325,50,"Attempting to move IP to the editing location of the selected user"),a.sa.tc(b,null,!1,!1,0),wac_vi()&&wac_Nk(wac_z(),"document"))),b=new wac_uh(2,1,0,function(){a.fa.nc(761503246,2,c,null)},0,null,!1),
wac_r().zc(b)}Type.registerNamespace("WordEditor.PeoplesWellControl");wac_L=window.WordEditor||{};wac_L.rXe=wac_L.rXe||{};function wac_jEb(){this.Y7b=Function.createDelegate(this,this.Npc);this.Ys=Function.createDelegate(this,this.rt)}
wac_jEb.prototype={Qb:function(){return"WordEditor.PeoplesWellControl"},Sb:function(a){wac_kU=a},ob:function(){wac_oi(wac_q.Z,this.Ys)},rt:function(){wac_q.$qc?(wac_kEb||(wac_kEb=wac_k().K(wac_ev))).jH().CW(this.Y7b):wac_(23196872,325,50,"PeoplesWell control is explicitly disabled. Skipping initialization attempt")},Npc:function(){if(wac_lEb=(wac_kEb||(wac_kEb=wac_k().K(wac_ev))).jH().Ob()){var a=function(){var a=window.Box4.App.va().Ka;return a?a.xc()?a.xc().fd():(wac_(23196876,325,15,"ActivePage is null"),
null):(wac_(23196875,325,15,"Workspace is null"),null)};window.Box4.App.bga().CW(function(){var b=window.Box4.App.bga().Ob().NG,c=wac_lEb.rg,d=wac_lEb.rg,e=wac_Ezb(wac_mEb("we_SingleCollabUserGlyph16","we_SingleCollabUserGlyph32","we_MoreUsersGlyph16",wac_Qi,"we_CommentComment_24x24x32"),b,c.a5d||(c.a5d=Function.createDelegate(c,c.BHe)),d.c5d||(d.c5d=Function.createDelegate(d,d.vfd)));wac_n(wac_o(wac_p(wac_k().ma(wac_fEb),wac_tc)),function(){return wac_hEb(e,wac_Db(wac_sc,wac_m(wac_kU,wac_sc)),wac_l(wac_kU,
wac_0F),wac_l(wac_kU,wac_DS),a)});wac_xzb=wac_k().K(wac_tc);wac_wzb();wac_(23196877,325,50,"PeoplesWellControl is fully initialized")})}else wac_(23196873,325,15,"Can't initialize the PeoplesWell control because can't get a handle to RtcProxy")},ka:function(){wac_xzb&&(wac_xzb.dispose(),wac_xzb=null)}};wac_fEb.registerClass("RealtimePresenceUI.WordEditorPeoplesWell",wac_gBb);wac_jEb.registerClass("WordEditor.PeoplesWellControl.WordEditorPeoplesWellControlPackage",null,wac_I,wac_j);(function(){}).registerClass("WordEditor.PeoplesWellControl.Program");
var wac_gEb=null,wac_xzb=null,wac_kU=null,wac_lEb=null,wac_kEb=null;wac_J(wac_C(),new wac_jEb,0,!1);
