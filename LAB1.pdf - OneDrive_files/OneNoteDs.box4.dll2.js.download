(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[2],{27:function(e,t,n){"use strict";n.d(t,{h:function(){return r}});var r,i=n(2185);!function(e){e[e.chrome=0]="chrome",e[e.edge=1]="edge",e[e.firefox=2]="firefox",e[e.IE=3]="IE",e[e.safari=4]="safari",e[e.others=5]="others",e[e.unknown=6]="unknown",e[e.electron=7]="electron"}(r||(r={})),(0,i.h)("BrowserCode",r)},362:function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var r=n(5309),i=n(1210),o=n(2185),a=function(){function e(){this.elmContainer=null,this._isVisible=!0}return e.prototype.get_elmContainer=function(){return this.elmContainer},e.prototype.set_elmContainer=function(e){return this.elmContainer=e,e},e.prototype.get_containerBounds=function(){return i.g.getElementBounds(this.get_elmContainer())},e.prototype.get_isVisible=function(){return this._isVisible},e.prototype.dispose=function(){},e}();(0,o.l)(a,"ViewerChromeItemContainer",null,[r.m])},519:function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var r=(0,n(2185).y)("ISemanticEventAcceptor")},520:function(e,t,n){"use strict";n.r(t),n.d(t,{ReactOICErrorDialogWithTrial:function(){return l}});var r=n(4548),i=n(2185),o=n(963),a=n(8058),s=n(6500),l=function(e){function t(t,n,r,o,l,c){var u=e.call(this,t,n,r,o,l,c)||this,g={errorMessage:u.get_errorMessageNoOffice(),offerString:u.get_offerString()},p=new s.o(!1,!1,!0);if(u.get_showHelpLink()){p.set_buttonsOption(1);g.helpLink={type:"AppLinkProps",id:"helpLink",text:u.get_helpLinkText(),handler:function(e){a.Redirect.showHelp(u.get_helpLinkContentId())}}}else p.set_buttonsOption(4),p.setButtonText(2,u.get_iHaveOfficeButtonText());p.setButtonText(1,u.get_actionButtonText()),p.set_dialogId(u.get_id());var d={id:u.get_id(),dialogIcon:u.get_icon(),bodyControls:g};return p.initializeAndShow(u.get_dialogTitle(),i.i(u,u.reactOICErrorDialogWithTrialHandler,"reactOICErrorDialogWithTrialHandler"),d),u}return(0,r.t)(t,e),t}(o.p);(0,i.l)(l,"ReactOICErrorDialogWithTrial",o.p,[])},566:function(e,t,n){"use strict";n.r(t),n.d(t,{OICErrorDialogWithTrial:function(){return s}});var r=n(4548),i=n(2185),o=n(963),a=n(4609),s=function(e){function t(t,n,r,o,s,l){var c=e.call(this,t,n,r,o,s,l)||this,u=document.createElement("span");u.innerText=c.get_errorMessageNoOffice(),u.appendChild(document.createElement("br")),u.appendChild(document.createElement("br"));var g=document.createElement("span");g.innerText=c.get_offerString(),u.appendChild(g);var p=new a.StandardDialog;return c.get_showHelpLink()?(p.set_buttonsOption(1),p.addHelpLink(c.get_helpLinkText(),c.get_helpLinkContentId())):(p.set_buttonsOption(4),p.setButtonText(2,c.get_iHaveOfficeButtonText())),p.setButtonText(1,c.get_actionButtonText()),p.set_dialogId(c.get_id()),p.messageBox(c.get_dialogTitle(),null,c.get_icon(),i.i(c,c.legacyOICErrorDialogWithTrialHandler,"legacyOICErrorDialogWithTrialHandler"),u),c}return(0,r.t)(t,e),t}(o.p);(0,i.l)(s,"OICErrorDialogWithTrial",o.p,[])},963:function(e,t,n){"use strict";n.d(t,{p:function(){return c}});var r=n(5626),i=n(6983),o=n(6049),a=n(5396),s=n(6342),l=n(2185),c=function(){function e(e,t,n,r,i,o){this._onDialogDismissed=null,this._onLaunchDownload=null,this._callbackData=null,this._iHaveOfficeHandler=null,this._application=0,this._dialogCause=0,this._onDialogDismissed=e,this._onLaunchDownload=t,this._iHaveOfficeHandler=n,this._callbackData=r,this._dialogCause=i,this._application=o}return e.prototype.get_showHelpLink=function(){return!this._onLaunchDownload&&!this._iHaveOfficeHandler},e.prototype.get_offerString=function(){return 2===this._application?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer},e.prototype.get_id=function(){return"OICErrorDialogWithTrial"},e.prototype.get_errorMessageNoOffice=function(){return CommonUIStrings.l_OICErrorMessageNoOffice},e.prototype.get_iHaveOfficeButtonText=function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton},e.prototype.get_helpLinkText=function(){return CommonUIStrings.l_OICErrorHelpLink},e.prototype.get_helpLinkContentId=function(){return"OICFailure"},e.prototype.get_icon=function(){return 3},e.prototype.get_actionButtonText=function(){return 2===this._application?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton},e.prototype.get_dialogTitle=function(){return CommonUIStrings.l_DefaultDialogTitle},e.prototype.reactOICErrorDialogWithTrialHandler=function(e,t){this.oicErrorDialogWithTrialHandler(e)},e.prototype.legacyOICErrorDialogWithTrialHandler=function(e,t){this.oicErrorDialogWithTrialHandler(e)},e.prototype.oicErrorDialogWithTrialHandler=function(e){var t=10;1===e?(s.w.get_instance().resolve(r.v).launchOffer(this._application),t=3):2===e&&(this._iHaveOfficeHandler&&!this._iHaveOfficeHandler(this._callbackData)||this._onLaunchDownload&&i.p.get_instance().createOICErrorDialogWithDownload(this._onLaunchDownload,this._onDialogDismissed,this._callbackData),t=5);e&&1!==e||this._onDialogDismissed&&this._onDialogDismissed(this._callbackData),o.AFrameworkApplication.reportErrorWithCauseAndResolution(a.p.openInClientWithC2RFailed,this._dialogCause,t),this.dispose()},e.prototype.dispose=function(){this._onDialogDismissed=null,this._onLaunchDownload=null,this._callbackData=null},e}();(0,l.l)(c,"AOICErrorDialogWithTrial",null,[Sys.IDisposable])},1489:function(e,t,n){"use strict";var r=n(20),i=n(6327),o=n(2127),a=n(5609),s=n(5460),l=n(2314),c=n(2145),u=n(4706),g=n(1778),p=n(2185),d=(0,p.y)("IBox4PasteSteward"),h=n(519),_=n(7732),m=n(5279),f=n(8244),y=n(2224),C=n(398),S=n(4548),v=(0,p.y)("IFormattingSteward$0"),b=n(9407),T=n(7904),A=function(){function e(e,t){void 0===t&&(t=null),this.nextSteward=null,this.usageData=null,this.nextSteward=e,this.usageData=t||y.z.getFormattingStewardUsageDataInstance(T.y.get_browserCodeForLogging(),"")}return e.prototype.get_nextSteward=function(){return this.nextSteward},e.prototype.get_usageData=function(){return this.usageData},e.prototype.setLang=function(e){return this.get_usageData().d++,this.get_nextSteward().setLang(e)},e.prototype.setTextDir=function(e){return this.get_usageData().e++,this.get_nextSteward().setTextDir(e)},e.prototype.setBold=function(e){return this.get_usageData().f++,this.get_nextSteward().setBold(e)},e.prototype.setItalics=function(e){return this.get_usageData().h++,this.get_nextSteward().setItalics(e)},e.prototype.setUnderline=function(e){return this.get_usageData().i++,this.get_nextSteward().setUnderline(e)},e.prototype.setStrikethrough=function(e){return this.get_usageData().j++,this.get_nextSteward().setStrikethrough(e)},e.prototype.setSubscript=function(e){return this.get_usageData().k++,this.get_nextSteward().setSubscript(e)},e.prototype.setSuperscript=function(e){return this.get_usageData().l++,this.get_nextSteward().setSuperscript(e)},e.prototype.setFontsize=function(e){return this.get_usageData().m++,this.get_nextSteward().setFontsize(e)},e.prototype.setFontface=function(e,t){return void 0===t&&(t=!1),this.get_usageData().n++,this.get_nextSteward().setFontface(e,t)},e.prototype.growFontsize=function(){return this.get_usageData().o++,this.get_nextSteward().growFontsize()},e.prototype.shrinkFontsize=function(){return this.get_usageData().p++,this.get_nextSteward().shrinkFontsize()},e.prototype.setFontColor=function(e){return this.get_usageData().q++,this.get_nextSteward().setFontColor(e)},e.prototype.setFontHighlight=function(e){return this.get_usageData().r++,this.get_nextSteward().setFontHighlight(e)},e.prototype.setMath=function(e){return this.get_usageData().g++,this.get_nextSteward().setMath(e)},e.prototype.setTextCapsType=function(e){return this.get_nextSteward().setTextCapsType(e)},e.prototype.setParagraphStyleType=function(e){return this.get_usageData().s++,this.get_nextSteward().setParagraphStyleType(e)},e.prototype.setParagraphStyle=function(e){return this.get_usageData().s++,this.get_nextSteward().setParagraphStyle(e)},e.prototype.setCharacterStyle=function(e){return this.get_usageData().s++,this.get_nextSteward().setCharacterStyle(e)},e.prototype.setParagraphHeadingStyle=function(e){return this.get_usageData().s++,this.get_nextSteward().setParagraphHeadingStyle(e)},e.prototype.setTextAlign=function(e){return this.get_usageData().t++,this.get_nextSteward().setTextAlign(e)},e.prototype.setTextIndent=function(e){return this.get_usageData().u++,this.get_nextSteward().setTextIndent(e)},e.prototype.setMarginLeft=function(e){return this.get_usageData().v++,this.get_nextSteward().setMarginLeft(e)},e.prototype.setParagraphProperties=function(e){return this.get_nextSteward().setParagraphProperties(e)},e.prototype.setCellShadingColor=function(e){return this.get_usageData().z++,this.get_nextSteward().setCellShadingColor(e)},e.prototype.resetJustification=function(){return this.get_nextSteward().resetJustification()},e.prototype.setParagraphSpacing=function(e,t){return this.get_usageData().w++,this.get_usageData().x++,this.get_nextSteward().setParagraphSpacing(e,t)},e.prototype.setLineSpacing=function(e){return this.get_usageData().y++,this.get_nextSteward().setLineSpacing(e)},e.prototype.clearFormatting=function(){return this.get_nextSteward().clearFormatting()},e.prototype.clone=function(){return new e(this.get_nextSteward().clone(),this.get_usageData())},e}();(0,p.l)(A,"FormattingStewardUsageCollector$0",null,[b.q]);var I=function(e){function t(t,n){return void 0===n&&(n=null),e.call(this,t,n)||this}return(0,S.t)(t,e),t.prototype.get_nextBox4Steward=function(){return this.get_nextSteward()},t.prototype.get_justification=function(){return this.get_nextBox4Steward().get_justification()},t.prototype.set_justification=function(e){return this.get_nextBox4Steward().set_justification(e),e},t.prototype.get_textIndent=function(){return this.get_nextBox4Steward().get_textIndent()},t.prototype.get_marginLeft=function(){return this.get_nextBox4Steward().get_marginLeft()},t.prototype.get_paragraphSpacing=function(){return this.get_nextBox4Steward().get_paragraphSpacing()},t.prototype.get_lineSpacing=function(){return this.get_nextBox4Steward().get_lineSpacing()},t.prototype.get_specialIndent=function(){return this.get_nextBox4Steward().get_specialIndent()},t.prototype.get_leftIndent=function(){return this.get_nextBox4Steward().get_leftIndent()},t.prototype.get_paragraphProperties=function(){return this.get_nextBox4Steward().get_paragraphProperties()},t.prototype.get_paragraph=function(){return this.get_nextBox4Steward().get_paragraph()},t.prototype.set_paragraph=function(e){return this.get_nextBox4Steward().set_paragraph(e),e},t.prototype.get_formattingObject=function(){return this.get_nextBox4Steward().get_formattingObject()},t.prototype.get_tableFormattingProperties=function(){return this.get_nextBox4Steward().get_tableFormattingProperties()},t.prototype.tryApplyParagraphStyle=function(e){return this.get_nextBox4Steward().tryApplyParagraphStyle(e)},t.prototype.tryApplyCharacterStyle=function(e){return this.get_nextBox4Steward().tryApplyCharacterStyle(e)},t.prototype.clone=function(){return new t(this.get_nextSteward().clone(),this.get_usageData())},t}(A);(0,p.l)(I,"FormattingStewardUsageCollector",A,[v,b.q]);var w=n(397),x=n(1458),F=n(2933),E=n(1996),P=n(2759),k=n(9017),D=n(3803),M=n(8370),R=n(7015),L=n(1522),N=n(3350),B=n(8654),O=n(8158),U=n(2591),H=n(9054),G=function(){function e(){}return e.yellow="FFFF00",e.lime="00FF00",e.aqua="00FFFF",e.fuchsia="FF00FF",e.blue="0000FF",e.red="FF0000",e.navy="000080",e.teal="008080",e.green="008000",e.purple="800080",e.maroon="800000",e.olive="808000",e.gray="808080",e.sliver="C0C0C0",e.black="000000",e}();(0,p.l)(G,"FontHighlightColorEnum",null,[]);var V=n(8121),W=n(3286),z=n(6524),K=n(1958),q=n(2919),j=n(2028),$=n(8234),Q=n(4125),J=n(4404),X=n(613),Y=n(6129),Z=n(2014),ee=n(5866),te=.25,ne=function(){function e(t,n,r,i,o,a,s,l,c,u,g){if(void 0===u&&(u=null),void 0===g&&(g=!1),this._paragraph=null,this._containerChp=null,this._paragraphStyleType=0,this._paragraphStyle=null,this._characterStyle=null,this._justification=0,this._textIndent=null,this._marginLeft=null,this._paragraphSpacing=null,this._lineSpacing=null,this._specialIndent=null,this._leftIndent=null,this._tableFormattingProperties=null,this._fontService=null,this._customFontService=null,this._embeddedFontService=null,this.paragraphProperties=null,this._formattingEditor=null,this._styleEditor=null,this._formattingReader=null,this._formattingStewardBridge=null,this._followDestinationFormattingPasteIsEnabled=!1,this.defaultParagraphSpacingInPoints=B.Font.defaultSize*te,this.set_paragraph(t),this._formattingEditor=n,this._styleEditor=r,this._formattingReader=i,this._formattingStewardBridge=o,this._fontService=a,this._customFontService=s,this._embeddedFontService=l,this._followDestinationFormattingPasteIsEnabled=c,u)f.x(4223818,307,!!u._containerChp),this._containerChp=u._containerChp.cloneUnderDifferentParagraph(this.get_paragraph()),this._paragraphStyleType=u._paragraphStyleType,this._paragraphStyle=u._paragraphStyle,u._paragraphSpacing&&(this._paragraphSpacing=new z.v,this._paragraphSpacing.afterSpacing.value=u._paragraphSpacing.afterSpacing.value,this._paragraphSpacing.beforeSpacing.value=u._paragraphSpacing.beforeSpacing.value),u._lineSpacing&&(this._lineSpacing=u._lineSpacing.clone()),this._justification=u._justification,this._tableFormattingProperties=u._tableFormattingProperties.clone(),this._textIndent=u._textIndent,this._marginLeft=u._marginLeft,this._specialIndent=u._specialIndent,this._leftIndent=u._leftIndent,u.get_paragraphProperties()&&(this.paragraphProperties=u.get_paragraphProperties());else{this._containerChp=new H.j(this.get_paragraph(),0),this._containerChp.set_formatting(new V.a(this._containerChp,Q.h.get_nil()));var p=W.y.createIpContextAtEndOfParagraph(t),d=this._formattingReader.getFormattingObject(p);this.setDefaultLanguage(d),e.shouldUseExistingFormatting(t)?(this._formattingStewardBridge.setFormattingsWithExistingFormatting(this._containerChp.get_formatting(),d,g),t.hasProperty(q.b.layoutAlignmentInParent)?this._justification=t.getValue(Number,q.b.layoutAlignmentInParent):this._justification=0):this._justification=-1,this._paragraphStyleType=0,this._paragraphStyle=null,this._paragraphSpacing=this.getDefaultParagraphSpacing(),this._followDestinationFormattingPasteIsEnabled&&(this._paragraphSpacing=this._formattingStewardBridge.getParagraphSpacing(t),this._lineSpacing=this._formattingStewardBridge.getLineSpacing(t),this._specialIndent=this._formattingStewardBridge.getSpecialIndent(t),this._leftIndent=this._formattingStewardBridge.getLeftIndent(t)),this._tableFormattingProperties=new X.DictionaryPropertySet,this._formattingStewardBridge.setDefaultFormattings(this._containerChp.get_formatting(),t,g)}}return e.prototype.get_paragraph=function(){return this._paragraph},e.prototype.set_paragraph=function(e){return f.x(4223816,307,!!e&&w.ParagraphReader.isParagraphNode(e)),this._paragraph=e,e},e.prototype.get_formattingObject=function(){return this._containerChp.get_formatting()},e.prototype.get_paragraphStyleTypeValue=function(){return this._paragraphStyleType},e.prototype.get_paragraphStyleValue=function(){return this._paragraphStyle},e.prototype.get_characterStyle=function(){return this._characterStyle},e.prototype.get_justification=function(){return this._justification},e.prototype.set_justification=function(e){return f.x(4223817,307,1===e||2===e||3===e||O.n.get_instance().get_item(54)&&6===e),this._justification=e,e},e.prototype.get_textIndent=function(){return this._textIndent},e.prototype.get_marginLeft=function(){return this._marginLeft},e.prototype.get_paragraphSpacing=function(){return this._paragraphSpacing},e.prototype.set_paragraphSpacing=function(e){return this._paragraphSpacing=e,e},e.prototype.get_lineSpacing=function(){return this._lineSpacing},e.prototype.set_lineSpacing=function(e){return this._lineSpacing=e,e},e.prototype.get_specialIndent=function(){return this._specialIndent},e.prototype.set_specialIndent=function(e){return this._specialIndent=e,e},e.prototype.get_leftIndent=function(){return this._leftIndent},e.prototype.set_leftIndent=function(e){return this._leftIndent=e,e},e.prototype.get_tableFormattingProperties=function(){return this._tableFormattingProperties},e.prototype.get_paragraphProperties=function(){return this.paragraphProperties},e.prototype.setDefaultLanguage=function(e){var t=this._formattingReader.language(e);t&&this._formattingEditor.setLanguageOnRange(this._containerChp.get_formatting(),t,0,e.get_cache().get_isNoProof(),!1)},e.prototype.getDefaultParagraphSpacing=function(){if(O.n.get_instance().get_item(54))return null;var e=new z.v;return e.afterSpacing.value=this.defaultParagraphSpacingInPoints,e.beforeSpacing.value=this.defaultParagraphSpacingInPoints,e},e.prototype.setLang=function(e){var t=J.i.getCultureInfo(e);return t&&this._formattingEditor.setLanguageOnParagraph(this._containerChp.get_formatting(),t.get_LCID()),!0},e.prototype.setTextDir=function(e){return!1},e.prototype.setBold=function(e){return this._formattingEditor.setBold(this._containerChp.get_formatting(),e),!0},e.prototype.setItalics=function(e){return this._formattingEditor.setItalic(this._containerChp.get_formatting(),e),!0},e.prototype.setUnderline=function(e){return this._formattingEditor.setUnderline(this._containerChp.get_formatting(),e),!0},e.prototype.setStrikethrough=function(e){return this._formattingEditor.setStrikethrough(this._containerChp.get_formatting(),e),!0},e.prototype.setSubscript=function(e){return this._formattingEditor.setSubscript(this._containerChp.get_formatting(),e),!0},e.prototype.setSuperscript=function(e){return this._formattingEditor.setSuperscript(this._containerChp.get_formatting(),e),!0},e.prototype.setFontsize=function(e){return!(e<=0)&&(this._formattingEditor.setFontSize(this._containerChp.get_formatting(),e),!0)},e.prototype.setFontface=function(e,t){if(!e||""===e)return!1;var n;if(Z.v.trySupportDocumentFont(e,(0,R.m)((function(){return n}),(function(e){return n=e}))))return this._formattingEditor.setFontFace(this._containerChp.get_formatting(),n.get_fontName()),!0;var r=!1,i=Z.v.normalizedFontName(e);return t&&this.isSupportedFont(i,this._fontService)&&(this._fontService.createFontUrl(e),r=!0),(this.isSupportedFont(i,this._customFontService)||this.isSupportedFont(i,this._embeddedFontService))&&(r=!0),r&&this._formattingEditor.setFontFace(this._containerChp.get_formatting(),i),r},e.prototype.isSupportedFont=function(e,t){return!!t&&t.get_isEnabled()&&t.isSupportedFont(e)},e.prototype.growFontsize=function(){return this._formattingEditor.growFontSizeAndSet(this._containerChp.get_formatting()),!0},e.prototype.shrinkFontsize=function(){return this._formattingEditor.shrinkFontSizeAndSet(this._containerChp.get_formatting()),!0},e.prototype.setFontColor=function(e){if(!this._formattingEditor.isSchemeColor(e)){if(null===e||""===e)return!1;e=n(6776).Box4PasteSteward.convertRgbToBgr(e)}var t=null;return this.get_paragraphProperties()&&this.get_paragraphProperties().hasOwnProperty($.j.listLevel.id.toString())&&(t=this.get_paragraphProperties()[$.j.listLevel.id.toString()]),this._formattingEditor.setFontColor(this._containerChp.get_formatting(),e,t),!0},e.prototype.setFontHighlight=function(t){if(!t||""===t)return!1;var r=t;return!(O.n.get_instance().get_item(49)&&!e.get_wordSupportHighlightColorSet().contains(t))&&(!this._formattingStewardBridge.shouldSkipHightlightAfterPaste(this._containerChp.get_formatting())&&(this._formattingEditor.setFontHighlight(this._containerChp.get_formatting(),n(6776).Box4PasteSteward.convertRgbToBgr(r)),!0))},e.prototype.setMath=function(e){return this._formattingEditor.setMath(this._containerChp.get_formatting(),e),!0},e.prototype.setTextCapsType=function(e){var t=0;switch(ee.l.toLower(e)){case"small-caps":t=1;break;case"uppercase":t=2}return this._formattingEditor.setTextProperty(this._containerChp.get_formatting(),j.o.capitalization,t),!0},e.prototype.setCellShadingColor=function(e){return!(!e||""===e)&&(this._tableFormattingProperties.setValue(q.b.cellShadingColor,parseInt(n(6776).Box4PasteSteward.convertRgbToBgr(e),16)),!0)},e.prototype.setParagraphHeadingStyle=function(e){return!(e<=0)&&this.setParagraphStyle(U.StyleReader.getStyleHeading(e))},e.prototype.setParagraphStyleType=function(e){return this.clearFormatting(),this._paragraphStyleType=e,!0},e.prototype.setParagraphStyle=function(e){return!!(e&&e.length>0&&n(6776).Box4PasteSteward.get_supportedStyleSet()&&n(6776).Box4PasteSteward.get_supportedStyleSet().getStyleById(e))&&(this._paragraphStyle=e,!0)},e.prototype.setCharacterStyle=function(e){return!!(e&&e.length>0&&n(6776).Box4PasteSteward.get_supportedStyleSet()&&n(6776).Box4PasteSteward.get_supportedStyleSet().getStyleById(e))&&(this._characterStyle=e,!0)},e.prototype.tryApplyCharacterStyle=function(e){if(this.get_characterStyle()){var t=n(6776).Box4PasteSteward.get_supportedStyleSet()||U.StyleReader.getStyleSetFromParagraphNode(e);if(!t)return f.x(41968715,307,!1),!1;var r=t.getStyleById(this.get_characterStyle());return r&&this._formattingEditor.setCharacterStyle(this._containerChp.get_formatting(),r),!0}return!1},e.prototype.setParagraphSpacing=function(e,t){return!O.n.get_instance().get_item(54)&&(f.x(5297416,307,e>=0&&t>=0),e>=0&&(this._paragraphSpacing.beforeSpacing.value=e),t>=0&&(this._paragraphSpacing.afterSpacing.value=t),e>=0||t>=0)},e.prototype.setLineSpacing=function(e){if(!O.n.get_instance().get_item(54)||!e)return!1;var t=parseFloat(ee.l.substring(e,0,ee.l.toLower(e).indexOf("px")));if(!isNaN(t))return this._lineSpacing=new K.o(3,Y.o(t,1)),!0;var n=parseFloat(ee.l.substring(e,0,ee.l.toLower(e).indexOf("%")));return!isNaN(n)&&(this._lineSpacing=new K.o(2,n/100),!0)},e.prototype.setTextAlign=function(e){var t=0;if(!e||""===e)return!1;switch(e){case"left":t=1;break;case"center":t=2;break;case"right":t=3;break;case"justify":O.n.get_instance().get_item(54)&&(t=6)}return!!t&&(this.set_justification(t),!0)},e.prototype.setTextIndent=function(e){return this._textIndent=e,!0},e.prototype.setMarginLeft=function(e){return this._marginLeft=e,!0},e.prototype.setParagraphProperties=function(e){return this.paragraphProperties=JSON.parse(e),!!this.get_paragraphProperties()},e.prototype.clearFormatting=function(){return this._containerChp.set_formatting(new V.a(this._containerChp,Q.h.get_nil())),!0},e.prototype.resetJustification=function(){return this._justification=0,!0},e.prototype.tryApplyParagraphStyle=function(e){if(!O.n.get_instance().get_item(71))return!1;if(this.get_paragraphStyleTypeValue()>0&&n(6776).Box4PasteSteward.paragraphStyleStrings[this.get_paragraphStyleTypeValue()]){if(f.x(4223819,307,1<=this.get_paragraphStyleTypeValue()),f.x(4223820,307,this.get_paragraphStyleTypeValue()<=7),!(r=U.StyleReader.getStyleSetFromParagraphNode(e)))return f.x(4223821,307,!1),!1;var t=r.getStyleById(n(6776).Box4PasteSteward.paragraphStyleStrings[this.get_paragraphStyleTypeValue()]);return this._styleEditor.setStyleOnParagraphNode(t,e,!1),!0}if(this.get_paragraphStyleValue()){var r;if(!(r=n(6776).Box4PasteSteward.get_supportedStyleSet()||U.StyleReader.getStyleSetFromParagraphNode(e)))return f.x(41968716,307,!1),!1;t=r.getStyleById(this.get_paragraphStyleValue());return this._styleEditor.setStyleOnParagraphNode(t,e,!1),!0}return!1},e.prototype.clone=function(){return new e(this.get_paragraph(),this._formattingEditor,this._styleEditor,this._formattingReader,this._formattingStewardBridge,this._fontService,this._customFontService,this._embeddedFontService,this._followDestinationFormattingPasteIsEnabled,this)},e.get_wordSupportHighlightColorSet=function(){return e._wordSupportHighlightColorSet||(e._wordSupportHighlightColorSet=new L.e(String,N.b.get_ordinalIgnoreCase()),e._wordSupportHighlightColorSet.add(G.yellow),e._wordSupportHighlightColorSet.add(G.lime),e._wordSupportHighlightColorSet.add(G.aqua),e._wordSupportHighlightColorSet.add(G.fuchsia),e._wordSupportHighlightColorSet.add(G.blue),e._wordSupportHighlightColorSet.add(G.red),e._wordSupportHighlightColorSet.add(G.navy),e._wordSupportHighlightColorSet.add(G.teal),e._wordSupportHighlightColorSet.add(G.green),e._wordSupportHighlightColorSet.add(G.purple),e._wordSupportHighlightColorSet.add(G.maroon),e._wordSupportHighlightColorSet.add(G.olive),e._wordSupportHighlightColorSet.add(G.gray),e._wordSupportHighlightColorSet.add(G.sliver),e._wordSupportHighlightColorSet.add(G.black)),e._wordSupportHighlightColorSet},e.shouldUseExistingFormatting=function(e){if(!O.n.get_instance().get_item(71))return!0;var t=U.StyleReader.getStyleId(U.StyleReader.getStyleFromParagraphNode(e));return t===U.StyleReader.get_wordStyleIdDefaultParagraphFont()||t===U.StyleReader.get_wordStyleIdNormal()||t===U.StyleReader.get_wordStyleIdNoSpacing()||t===U.StyleReader.styleIdNormal},e._wordSupportHighlightColorSet=null,e}();(0,p.l)(ne,"FormattingSteward",null,[v,b.q]);var re=n(4901),ie=function(){function e(){}return e.prototype.tryHandlePageBreak=function(e,t,n){return!1},e.prototype.handleParagraphEnd=function(e,t){return e},e.prototype.handleTabCharacter=function(e,t){},e.prototype.setParagraphProperties=function(e,t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null)},e.prototype.setListInfo=function(e,t,n){},e.prototype.isFormatless=function(e){return!1},e.prototype.get_isPasteBrAsNewParagraphEnabled=function(){return!1},e.prototype.setLineSpacing=function(e,t){},e.prototype.setParagraphSpacing=function(e,t){},e.prototype.setSpecialIndent=function(e,t){},e.prototype.setLeftIndent=function(e,t){},e.prototype.get_shouldSkipSettingIndentation=function(){return!1},e.prototype.processExternalHyperlink=function(e,t){},e}();(0,p.l)(ie,"NoOpPasteStewardBridge",null,[re.n]);var oe=n(7093),ae=function(){function e(e,t){this.noteTagName=null,this.noteTagStatus=null,this.noteTagName=e,this.noteTagStatus=t||"Normal"}return e.prototype.get_noteTagName=function(){return this.noteTagName},e.prototype.get_noteTagStatus=function(){return this.noteTagStatus},e}();(0,p.l)(ae,"NoteTagInfoBox4",null,[]);var se=function(e){for(var t=new oe.c(ae),n=e.$$lge();n.$$mn();){var r=n.$$cu(),i=new ae(r.get_noteTagName(),r.get_noteTagStatus());t.add(i)}return t},le=n(6049),ce=n(6342);n.d(t,{a:function(){return ue}});var ue=function(){function e(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=null),this._lcid=null,this._iterator=null,this._box4PasteStewardBridge=null,this.usageData=null,this._fontService=null,this._customFontService=null,this._embeddedFontService=null,this.$$pf_PendingIndentationLevel=0,this.followDestinationFormattingPasteIsEnabled=le.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FollowDestinationFormattingPasteIsEnabled"),this._iterator=e,this._lcid=t,this._box4PasteStewardBridge=r||new ie,this.usageData=n||y.z.getFormattingStewardUsageDataInstance(T.y.get_browserCodeForLogging(),"")}return e.prototype.get_usageData=function(){return this.usageData},e.prototype.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=ce.w.get_instance().resolve(i.x))},e.prototype.get_fontService=function(){return this._fontService||(this._fontService=ce.w.get_instance().tryResolve(r.h))},e.prototype.get_customFontService=function(){return this._customFontService||(this._customFontService=ce.w.get_instance().tryResolve(C.o))},e.prototype.get_embeddedFontService=function(){return this._embeddedFontService||(this._embeddedFontService=ce.w.get_instance().tryResolve(o.x))},e.prototype.reset=function(){},e.prototype.get_defaultFormatting=function(){return this.getDefaultFormatting(!1)},e.prototype.getDefaultFormatting=function(t){f.x(4223770,307,M.OutlineElementReader.isOutlineElement(this._iterator));var n=P.OutlineElementNavigator.moveToContent(this._iterator);P.OutlineElementNavigator.returnToOutlineElement(this._iterator),f.x(4223771,307,!!n&&w.ParagraphReader.isParagraphNode(n));var r=new ne(n,e.get_formattingEditor(),e.get_styleEditor(),e.get_formattingReader(),e.get_formattingStewardBridge(),this.get_fontService(),this.get_customFontService(),this.get_embeddedFontService(),this.followDestinationFormattingPasteIsEnabled,void 0,t);return new I(r,this.get_usageData())},e.prototype.onText=function(e,t){},e.prototype.onLineBreak=function(e){},e.prototype.onTab=function(e){},e.prototype.onImage=function(e){},e.prototype.onFile=function(e){},e.prototype.onFormattingChange=function(e){},e.prototype.onAnchorStart=function(e,t){},e.prototype.onAnchorEnd=function(){},e.prototype.onParagraphStart=function(e){},e.prototype.onParagraphEnd=function(){},e.prototype.onPreFormattedTextStart=function(){},e.prototype.onPreFormattedTextEnd=function(){},e.prototype.onMathStart=function(e,t){},e.prototype.onMathEnd=function(){},e.prototype.onListStart=function(e){},e.prototype.onListEnd=function(){},e.prototype.onListItemStart=function(e){},e.prototype.onListItemEnd=function(){},e.prototype.onRenderAugmentation=function(e){},e.prototype.onSpanStart=function(){},e.prototype.onSpanEnd=function(){},e.prototype.moveToNextOutlineElementForHtmlImport=function(t){M.OutlineElementReader.isOutlineElement(this._iterator)?(e.get_outlineElementEditor().insertOutlineElementBelow(this._iterator,!0),P.OutlineElementNavigator.moveToNextOutlineElement(this._iterator,!1,!1)):D.isOutline(this._iterator)?k.moveToFirstOutlineElement(this._iterator)?t?(this._iterator.disconnectNodeAndReturnToParent(),e.get_outlineEditor().appendOutlineElement(this._iterator,!1)):e.get_outlineElementEditor().removeContent(this._iterator):e.get_outlineEditor().appendOutlineElement(this._iterator,!1):f.x(8128524,307,!1,"Unexpected node type {0} encountered",this._iterator.get_currentNodeType())},e.prototype.getNewOutlineElementInfo=function(e){var t=null;if(e&&e.get_ownerHtmlElementInfo()&&e.get_cultureName())try{t=(0,m.m)(new E.d,{languageId:J.i.getCultureInfo(e.get_cultureName()).get_LCID()})}catch(t){f.x(8128526,307,!1,"Setting up culture {0} encountered {1}",e.get_cultureName(),t)}return t||null==this._lcid||(t=(0,m.m)(new E.d,{languageId:this._lcid})),t},e.prototype.get_pendingIndentationLevel=function(){return this.$$pf_PendingIndentationLevel},e.prototype.set_pendingIndentationLevel=function(e){return this.$$pf_PendingIndentationLevel=e,e},e.prototype.applyPendingListAndIndentationInfo=function(e,t){},e.prototype.trackTableToDelist=function(e){},e.prototype.clearPendingIndentation=function(){},e.prototype.get_continuingExistingList=function(){return!1},e.prototype.get_currentlyUnderPastedList=function(){return!1},e.prototype.listInfoFromListSemanticArgs=function(e){var t,n=1;if(e.get_isListNumbered())switch(t=0,e.get_listStyleType()){case 1:n=0;break;case 7:n=1;break;case 8:n=2;break;case 9:n=3;break;case 10:n=4;break;case 11:n=5}else switch(t=1,e.get_listStyleType()){case 1:n=0;break;case 3:n=1;break;case 4:n=2;break;case 5:n=3}var r,i;return i=(r=x.ListReader.get_externalPasteImprovementsEnabled())?F.j.createFromScratch(t,n,se(e.ownerNoteTagInfo),e.get_listId(),e.get_listLevel(),e.get_levelText(),e.get_font()):F.j.createFromScratch(t,n,se(e.ownerNoteTagInfo)),e.get_isListNumbered()&&!e.get_isAutoNumber()&&(r&&e.get_listId()>0&&e.get_listLevel()>=0&&!e.get_pasteFromRichClient()?i.set_restartAt(e.get_startNumber()):i.set_restartAt(e.get_currentNumber())),this._box4PasteStewardBridge.setListInfo(this._iterator,i,e),i},e.prototype.onTableStart=function(e){},e.prototype.onTableEnd=function(){},e.prototype.onTableRowStart=function(e){},e.prototype.onTableRowEnd=function(){},e.prototype.onTableCellStart=function(e){},e.prototype.onTableCellEnd=function(){},e.prototype.onTablePartStart=function(e){},e.prototype.onTablePartEnd=function(){},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=ce.w.get_instance().resolve(a.p))},e.get_outlineEditor=function(){return e._outlineEditor||(e._outlineEditor=ce.w.get_instance().resolve(s.a))},e.get_formattingEditor=function(){return e._formattingEditor||(e._formattingEditor=ce.w.get_instance().resolve(l.z))},e.get_styleEditor=function(){return e._styleEditor||(e._styleEditor=ce.w.get_instance().resolve(c.e))},e.get_formattingReader=function(){return e._formattingReader||(e._formattingReader=ce.w.get_instance().resolve(u.d))},e.get_formattingStewardBridge=function(){return e._formattingStewardBridge||(e._formattingStewardBridge=ce.w.get_instance().resolve(g.u))},e._outlineElementEditor=null,e._outlineEditor=null,e._characterPropertiesEditor=null,e._formattingEditor=null,e._styleEditor=null,e._formattingReader=null,e._formattingStewardBridge=null,e}();(0,p.l)(ue,"Box4PasteStewardBase",null,[d,h.m,_.p])},1501:function(e,t,n){"use strict";n.r(t),n.d(t,{DocumentTitleContainer:function(){return u}});var r=n(4548),i=n(6410),o=n(8075),a=n(4126),s=n(6049),l=n(4248),c=n(2185),u=function(e){function t(){var t=e.call(this)||this;if(t.set_elmContainer(a.k.createUnselectableElement("span")),t.get_elmContainer().id="viewerChrome-documentTitleContainer",t.get_elmContainer().className="cui-herobar-documentTitleContainer",s.AFrameworkApplication.isMobileMode){var n=l.createClusteredImage(32,32,s.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppIcon"),"AppHeaderIconFloat",!0,"");t.get_elmContainer().appendChild(n)}return s.AFrameworkApplication.docPropertiesProvider.get_breadcrumbDocName()&&(t._elementToTruncate=o.CuiHelper.createDocumentTitleElementInternal(t.get_elmContainer(),!1)),t}return(0,r.t)(t,e),t.prototype.dispose=function(){o.CuiHelper.disposeTitleElement()},t}(i.m);(0,c.l)(u,"DocumentTitleContainer",i.m,[])},1681:function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var r=(0,n(2185).y)("IMacOfficeOffer")},1778:function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var r=(0,n(2185).y)("IFormattingStewardBridge")},2021:function(e,t,n){"use strict";n.r(t),n.d(t,{BreadcrumbContainer:function(){return u}});var r=n(4548),i=n(6410),o=n(8075),a=n(4126),s=n(6049),l=n(6387),c=n(2185),u=function(e){function t(){var t=e.call(this)||this;return t._breadcrumbItems=null,t.set_elmContainer(a.k.createUnselectableElement("span")),t.get_elmContainer().className="cui-herobar-breadcrumbContainer",t.get_elmContainer().id="viewerChrome-breadcrumbContainer",s.AFrameworkApplication.hideHeader&&(o.CuiHelper.createAppBrandElement(t.get_elmContainer()),(s.AFrameworkApplication.breadcrumbBrandName||s.AFrameworkApplication.breadcrumbFolderName)&&o.CuiHelper.createAppBrandSeparatorElement(t.get_elmContainer())),t._breadcrumbItems=o.CuiHelper.createHostBrandAndFolderElements(t.get_elmContainer(),o.CuiHelper.breadcrumbAlternateSeparatorImageName),t}return(0,r.t)(t,e),t.prototype.getBreadcrumbItem=function(e){if(!this._breadcrumbItems)return null;for(var t=0;t<this._breadcrumbItems.length;t++)if(this._breadcrumbItems[t].id===e)return this._breadcrumbItems[t];return null},t.prototype.truncateWidth=function(n){if(this._elementToTruncate=this.getBreadcrumbItem(o.CuiHelper.breadcrumbFolderId),this._elementToTruncate){var r=t.calculateBreadcrumbFolderNameMaxWidth(this.get_elmContainer().offsetWidth,this._elementToTruncate.offsetWidth,n);r>0&&e.prototype.truncateWidth.call(this,r)}},t.prototype.dispose=function(){l.EventHandlerManager.get_instance().unregisterAllHandlersForDOMArray(this._breadcrumbItems)},t.calculateBreadcrumbFolderNameMaxWidth=function(e,t,n){return t-(e-n)},t}(i.m);(0,c.l)(u,"BreadcrumbContainer",i.m,[])},2145:function(e,t,n){"use strict";n.d(t,{e:function(){return r}});var r=(0,n(2185).y)("IStyleEditor")},2224:function(e,t,n){"use strict";var r=n(5793),i=function(e,t){var n={},r=function(e,t){null!=t&&(n[e]=t)},i=null;switch(e){case 0:var o=t;i="HtmlProcessor",r("SessionID",o.a),r("Elements",o.b.toString()),r("PrunedElements",o.c.toString()),r("TransparentElements",o.d.toString()),r("VoidElements",o.e.toString()),r("UnknownElements",o.f.toString());break;case 1:var a=t;i="WordConverter",r("SessionID",a.a),r("BulletsConverted",a.b.toString()),r("NumberedConverted",a.c.toString());break;case 2:var s=t;i="FormattingSteward",r("SourceApp",s.a),r("Browser",s.b),r("OperationId",s.c),r("Lang",s.d.toString()),r("TextDir",s.e.toString()),r("Bold",s.f.toString()),r("Math",s.g.toString()),r("Italics",s.h.toString()),r("Underline",s.i.toString()),r("Strikethrough",s.j.toString()),r("Subscript",s.k.toString()),r("Superscript",s.l.toString()),r("Fontsize",s.m.toString()),r("Fontface",s.n.toString()),r("GrowFontsize",s.o.toString()),r("ShrinkFontsize",s.p.toString()),r("FontColor",s.q.toString()),r("FontHighlight",s.r.toString()),r("ParagraphStyle",s.s.toString()),r("TextAlign",s.t.toString()),r("TextIndent",s.u.toString()),r("MarginLeft",s.v.toString()),r("ParagraphSpaceBefore",s.w.toString()),r("ParagraphSpaceAfter",s.x.toString()),r("LineSpace",s.y.toString()),r("CellShadingColor",s.z.toString());break;case 3:var l=t;i="SemanticEvents",r("SessionID",l.a),r("Text",l.b.toString()),r("LineBreak",l.c.toString()),r("Image",l.d.toString()),r("File",l.e.toString()),r("FormattingChange",l.f.toString()),r("Anchor",l.g.toString()),r("Paragraph",l.h.toString()),r("Math",l.i.toString()),r("List",l.j.toString()),r("ListItem",l.k.toString()),r("RenderAugmentation",l.l.toString()),r("Span",l.m.toString());break;case 4:var c=t;i="SemanticTableEvents",r("SessionID",c.a),r("Tables",c.b.toString()),r("TableRow",c.c.toString()),r("TableCell",c.d.toString()),r("TablePart",c.e.toString());break;case 5:var u=t;i="HtmlEvents",r("OperationId",u.a),r("SourceApp",u.b),r("Browser",u.c),r("Text",null==u.d?null:u.d.toString()),r("A",null==u.e?null:u.e.toString()),r("Abbr",null==u.f?null:u.f.toString()),r("Acronym",null==u.g?null:u.g.toString()),r("Address",null==u.h?null:u.h.toString()),r("Applet",null==u.i?null:u.i.toString()),r("Area",null==u.j?null:u.j.toString()),r("B",null==u.k?null:u.k.toString()),r("Base",null==u.l?null:u.l.toString()),r("Basefont",null==u.m?null:u.m.toString()),r("Bdo",null==u.n?null:u.n.toString()),r("Big",null==u.o?null:u.o.toString()),r("Blockquote",null==u.p?null:u.p.toString()),r("Body",null==u.q?null:u.q.toString()),r("Br",null==u.r?null:u.r.toString()),r("Button",null==u.s?null:u.s.toString()),r("Caption",null==u.t?null:u.t.toString()),r("Center",null==u.u?null:u.u.toString()),r("Cite",null==u.v?null:u.v.toString()),r("Code",null==u.w?null:u.w.toString()),r("Col",null==u.x?null:u.x.toString()),r("Colgroup",null==u.y?null:u.y.toString()),r("Dd",null==u.z?null:u.z.toString()),r("Del",null==u.ba?null:u.ba.toString()),r("Dfn",null==u.bb?null:u.bb.toString()),r("Dir",null==u.bc?null:u.bc.toString()),r("Div",null==u.bd?null:u.bd.toString()),r("Dl",null==u.be?null:u.be.toString()),r("Dt",null==u.bf?null:u.bf.toString()),r("Em",null==u.bg?null:u.bg.toString()),r("Fieldset",null==u.bh?null:u.bh.toString()),r("Font",null==u.bi?null:u.bi.toString()),r("Form",null==u.bj?null:u.bj.toString()),r("Frame",null==u.bk?null:u.bk.toString()),r("Frameset",null==u.bl?null:u.bl.toString()),r("H",null==u.bm?null:u.bm.toString()),r("Head",null==u.bn?null:u.bn.toString()),r("Hr",null==u.bo?null:u.bo.toString()),r("Html",null==u.bp?null:u.bp.toString()),r("I",null==u.bq?null:u.bq.toString()),r("Iframe",null==u.br?null:u.br.toString()),r("Img",null==u.bs?null:u.bs.toString()),r("Input",null==u.bt?null:u.bt.toString()),r("Ins",null==u.bu?null:u.bu.toString()),r("Isindex",null==u.bv?null:u.bv.toString()),r("Kbd",null==u.bw?null:u.bw.toString()),r("Label",null==u.bx?null:u.bx.toString()),r("Legend",null==u.by?null:u.by.toString()),r("Li",null==u.bz?null:u.bz.toString()),r("Link",null==u.ca?null:u.ca.toString()),r("Map",null==u.cb?null:u.cb.toString()),r("Math",null==u.cc?null:u.cc.toString()),r("Menu",null==u.cd?null:u.cd.toString()),r("Meta",null==u.ce?null:u.ce.toString()),r("Noframes",null==u.cf?null:u.cf.toString()),r("Noscript",null==u.cg?null:u.cg.toString()),r("Object",null==u.ch?null:u.ch.toString()),r("Ol",null==u.ci?null:u.ci.toString()),r("Optgroup",null==u.cj?null:u.cj.toString()),r("Option",null==u.ck?null:u.ck.toString()),r("P",null==u.cl?null:u.cl.toString()),r("Param",null==u.cm?null:u.cm.toString()),r("Pre",null==u.cn?null:u.cn.toString()),r("Q",null==u.co?null:u.co.toString()),r("S",null==u.cp?null:u.cp.toString()),r("Samp",null==u.cq?null:u.cq.toString()),r("Script",null==u.cr?null:u.cr.toString()),r("Select",null==u.cs?null:u.cs.toString()),r("Small",null==u.ct?null:u.ct.toString()),r("Span",null==u.cu?null:u.cu.toString()),r("Strike",null==u.cv?null:u.cv.toString()),r("Strong",null==u.cw?null:u.cw.toString()),r("Style",null==u.cx?null:u.cx.toString()),r("Sub",null==u.cy?null:u.cy.toString()),r("Sup",null==u.cz?null:u.cz.toString()),r("Tables",null==u.da?null:u.da.toString()),r("Tbody",null==u.db?null:u.db.toString()),r("Td",null==u.dc?null:u.dc.toString()),r("Textarea",null==u.dd?null:u.dd.toString()),r("Tfoot",null==u.de?null:u.de.toString()),r("Th",null==u.df?null:u.df.toString()),r("Thead",null==u.dg?null:u.dg.toString()),r("Title",null==u.dh?null:u.dh.toString()),r("Tr",null==u.di?null:u.di.toString()),r("Tt",null==u.dj?null:u.dj.toString()),r("U",null==u.dk?null:u.dk.toString()),r("Ul",null==u.dl?null:u.dl.toString()),r("Var",null==u.dm?null:u.dm.toString()),r("Unknown",null==u.dn?null:u.dn.toString());break;case 6:var g=t;i="List",r("SessionID",g.a),r("MaxListLevel",g.b.toString())}return n.Table=i,Sys.Serialization.JavaScriptSerializer.serialize(n)},o=n(6049),a=n(27),s=n(2185);n.d(t,{z:function(){return l}});var l=function(){function e(){}return e.get_isLoggingDisabled=function(){return null==e._isLoggingDisabled&&(e._isLoggingDisabled=!!o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UsageEditorLoggingIsDisabled")),e._isLoggingDisabled},e.get_isLoggingEnabledWord=function(){return null==e._isLoggingEnabledWord&&(e._isLoggingEnabledWord=!!o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordUsageEditorLoggingIsEnabled")),e._isLoggingEnabledWord},e.logUsageData=function(e){r.ULS.sendTraceTag(5822145,307,50,e)},e.getHtmlProcessorUsageDataInstance=function(e){var t={};return t.a=e,t.b=0,t.c=0,t.d=0,t.e=0,t.f=0,t},e.logHtmlProcessorUsageData=function(t){e.get_isLoggingDisabled()||e.logUsageData(i(0,t))},e.getWordConverterUsageDataInstance=function(e){var t={};return t.a=e,t.b=0,t.c=0,t},e.logWordConverterUsageData=function(t){e.get_isLoggingDisabled()||e.logUsageData(i(1,t))},e.getHtmlEventUsageDataInstance=function(e,t){var n={};return n.c=a.h[e],n.a=t,n},e.logHtmlEventsUsageData=function(t,n){e.get_isLoggingEnabledWord()&&t&&(t.b=n,e.logUsageData(i(5,t)))},e.getSemanticEventsUsageDataInstance=function(e){var t={};return t.a=e,t.b=0,t.c=0,t.d=0,t.e=0,t.f=0,t.g=0,t.h=0,t.i=0,t.j=0,t.k=0,t.l=0,t.m=0,t},e.logSemanticEventsUsageData=function(t){e.get_isLoggingDisabled()||e.logUsageData(i(3,t))},e.getSemanticTableEventsUsageDataInstance=function(e){var t={};return t.a=e,t.b=0,t.c=0,t.d=0,t.e=0,t},e.logSemanticTableEventsUsageData=function(t){e.get_isLoggingDisabled()||e.logUsageData(i(4,t))},e.getFormattingStewardUsageDataInstance=function(e,t){var n={};return n.b=a.h[e],n.c=t,n.d=0,n.e=0,n.f=0,n.g=0,n.h=0,n.i=0,n.j=0,n.k=0,n.l=0,n.m=0,n.n=0,n.o=0,n.p=0,n.q=0,n.r=0,n.s=0,n.t=0,n.w=0,n.x=0,n.y=0,n.z=0,n.u=0,n.v=0,n},e.logFormattingStewardUsageData=function(t,n){e.get_isLoggingEnabledWord()&&t&&(t.a=n,e.logUsageData(i(2,t)))},e.getListUsageDataInstance=function(e){var t={};return t.a=e,t.b=-1,t},e.logListUsageData=function(t){!e.get_isLoggingDisabled()&&t&&t.b>=0&&e.logUsageData(i(6,t))},e._isLoggingDisabled=null,e._isLoggingEnabledWord=null,e}();(0,s.l)(l,"UsageEditor$0",null,[])},2852:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var r=n(2185),i=function(){function e(){}return e.Value="Value",e.MaxValue="MaxValue",e.Text="Text",e}();(0,r.l)(i,"SliderCommandProperties",null,[])},3745:function(e,t,n){"use strict";n.d(t,{h:function(){return l}});var r=n(2185),i=n(5793),o=n(1085),a=n(6049),s=n(4609),l=function(){function e(e){this._audioStream=null,this._recorder=null,this._context=null,this._audioFileUploader=null,this._blob=null,this._audioFileUploader=e}return e.prototype.startRecording=function(e,t){(navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia).bind(navigator)({audio:!0},function(n){this._audioStream=n;var r=window.AudioContext||window.webkitAudioContext;this._context=this._context||new r;var i=this._context.createMediaStreamSource(n);this._recorder=new Recorder(i,{workerPath:window.URL.createObjectURL(new Blob([t],{type:"application/javascript"})),numChannels:1}),this._recorder.record(),e(!0,null)}.bind(this),function(t){e(!1,t)}.bind(this))},e.prototype.getSupportedMaxDuration=function(){if(!this._audioStream||!this._recorder||!this._context)return 0;var e=this._context.sampleRate;return(1024*a.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteInsertFileMaxSize",0)-44)/(2*e*1)},e.prototype.stopRecording=function(){if(this._audioStream&&this._recorder){this._audioStream.getAudioTracks()[0].stop(),this._recorder.stop();var e=r.i(this,this.exportWav,"exportWav");this._recorder.exportWAV(e),this.clearRecording()}},e.prototype.clearRecording=function(){this._recorder&&this._recorder.clear()},e.prototype.exportWav=function(e){this._blob=e,this.uploadBlob()},e.prototype.uploadBlob=function(){this._audioFileUploader.get_uploadState()?2===this._audioFileUploader.get_uploadState()?(i.ULS.sendTraceTag(9213718,339,50,"AudioRecording:Stop:Upload:Start"),this._audioFileUploader.upload(this._blob)):window.setTimeout(r.i(this,this.uploadBlob,"uploadBlob"),1e3):i.ULS.sendTraceTag(9213717,339,50,"AudioRecording:Stop:Upload:Cancelled")},e.showRecordingFailedUploadError=function(){var e=new s.StandardDialog;e.set_buttonsOption(0),e.showError(o.o.recordingFailedUpload,OneNoteIntl.OneNoteStrings.L_RecordingFailedUploadTitle,OneNoteIntl.OneNoteStrings.L_RecordingFailedUpload,null,!0)},e}();(0,r.l)(l,"AudioRecorder",null,[])},3846:function(e,t,n){"use strict";n.r(t);var r=n(9002),i=n(1840),o=n(2185),a=(0,o.y)("IActivityAggregationSchemes"),s=n(1770),l=n(9388),c=n(4010),u=n(7185),g=n(1515),p=n(7015),d=n(302),h=function(){function e(){this._aggregationMethods=null,this._aggregationMethods=new d.w(Function)}return e.prototype.setAggregationMethod=function(e,t){this._aggregationMethods.set_item(e,t)},e.prototype.getAggregationMethod=function(e){var t;return this._aggregationMethods.tryGetValue(e,(0,p.m)((function(){return t}),(function(e){return t=e}))),t},e}();(0,o.l)(h,"AggregationMethodsForActivityName",null,[]);var _=function(){function e(){this._primaryPropertiesForActivity=new g.w(u.j),this._aggregationMethods=new g.w(h)}return e.prototype.setAggregationMethod=function(e,t,n){this._aggregationMethods.containsKey(e)&&this._aggregationMethods.get_item(e)||this._aggregationMethods.set_item(e,new h),this._aggregationMethods.get_item(e).setAggregationMethod(t,n)},e.prototype.getAggregationMethod=function(e,t){return this._aggregationMethods.containsKey(e)&&this._aggregationMethods.get_item(e)?this._aggregationMethods.get_item(e).getAggregationMethod(t):null},e.prototype.getPrimaryProperties=function(e){return this._primaryPropertiesForActivity.containsKey(e)&&this._primaryPropertiesForActivity.get_item(e)||this._primaryPropertiesForActivity.set_item(e,new u.j),this._primaryPropertiesForActivity.get_item(e)},e.prototype.declarePrimaryProperty=function(e,t){this.getPrimaryProperties(e).add(t)},e}();(0,o.l)(_,"ActivityAggregationInfo",null,[i.s]);var m=n(8562),f=n(9965),y=n(7093),C=n(5793),S=n(4548),v=n(8116),b=n(5757),T=function(e){function t(t,n){var r=e.call(this,t)||this;return r.activityCollection=null,r.activityCollection=n,r.set_uniqueID(n?n.getFirstUniqueID():b.b.generateUniqueID()),r}return(0,S.t)(t,e),t.prototype.get_activityCollection=function(){return this.activityCollection},t.prototype.get_activityName=function(){return this.get_activityCollection().get_name()},t.prototype.get_startTime=function(){return this.get_activityCollection().get_startTime()},t.prototype.get_endTime=function(){return this.get_activityCollection().get_endTime()},t.prototype.end=function(){},t.prototype.cancel=function(){},t.prototype.forceEnd=function(){},t.prototype.updateFrameworkProperties=function(){this.frameworkProperties.set_item("AM",this.get_activityCollection().get_mode().toString()),this.frameworkProperties.set_item("C",this.get_activityCollection().get_count().toString()),this.frameworkProperties.set_item("DA",this.get_activityCollection().get_durationAverage().toFixed(2)),this.frameworkProperties.set_item("DV",this.get_activityCollection().get_durationVariance().toFixed(2))},t.prototype.getPropertyValues=function(e){return this.get_activityCollection().getPropertyValues(e)},t.prototype.getSecondaryProperties=function(){return this.get_activityCollection().getSecondaryProperties()},t.prototype.addToCompletedActivities=function(){for(var e=this.get_activityCollection().get_activityList().$$lge();e.$$mn();){e.$$cu().addToCompletedActivities()}},t}(v.c);(0,o.l)(T,"AggregatedActivity",v.c,[]);var A=function(){function e(e,t){this._activityName=0,this._activityAggregationInfo=null,this._aggregationMode=0,this._activityName=e,this._activityAggregationInfo=t}return e.prototype.aggregateProperties=function(e,t){this._aggregationMode=t;for(var n=0;n<e.get_count();n++){var r=e.get_item(n);this.aggregatePropertiesForActivity(r)}},e.prototype.aggregatePropertiesForActivity=function(e){var t=(0,f.e)(T,e);if(t)if(1===this._aggregationMode)this.aggregatePrimaryProperties(t);else if(2===this._aggregationMode){this.aggregateSecondaryProperties(t);for(var n=this._activityAggregationInfo.getPrimaryProperties(this._activityName).getEnumerator();n.$$mn();){var r=n.$$cu(),i=t.get_activityCollection().get_activityList().get_item(0);i.get_properties().containsKey(r)&&e.get_properties().set_item(r,i.get_properties().get_item(r))}}},e.prototype.aggregatePrimaryProperties=function(e){for(var t=this._activityAggregationInfo.getPrimaryProperties(this._activityName).getEnumerator();t.$$mn();){var n=t.$$cu();this.runAggregationMethod(e,n)}},e.prototype.aggregateSecondaryProperties=function(e){for(var t=e.getSecondaryProperties().getEnumerator();t.$$mn();){var n=t.$$cu();this.runAggregationMethod(e,n)}},e.prototype.runAggregationMethod=function(e,t){var n=this._activityAggregationInfo.getAggregationMethod(this._activityName,t);if(n){var r=e.getPropertyValues(t);e.get_properties().set_item(t,n(r))}},e}();(0,o.l)(A,"PropertyAggregationHelper",null,[]);var I=n(3062),w=n(5966),x=function(){function e(e,t,n,r,i){this._activityAggregationInfo=null,this._aggregationParams=null,this._lazyActivityAggregationSchemes=null,this._completedActivitiesHelper=null,this._activityThrottler=null,this._aggregationParams=e,this._activityAggregationInfo=t,this._completedActivitiesHelper=i,this._activityThrottler=r,this._lazyActivityAggregationSchemes=n}return e.prototype.get_activityAggregationSchemes=function(){return this._lazyActivityAggregationSchemes.get_value()},e.prototype.completeActivity=function(e){if(o.r(I.p,e))e.completeActivity();else if(o.r(T,e)){if(!this._activityThrottler.canLogActivity(e.get_activityName().toString()))return;var t=(0,f.e)(T,e);t.updateFrameworkProperties();var n=t.makeSerializable(),r=[];Array.add(r,n);var i=w.w(r);C.ULS.sendTraceTag(6907266,213,50,i)}},e.prototype.aggregate=function(e,t){var n=(new Date).getTime(),r=this._completedActivitiesHelper.get_list().get_item(e),i=null,o=this.getAggregationMode(r,(0,p.m)((function(){return i}),(function(e){return i=e})));(this._completedActivitiesHelper.get_list().set_item(e,new y.c(m.n)),t&&(i=this.correctForGraceWindow(i,n,this._aggregationParams.graceWindow)),i.get_count()>0)&&new A(e,this._activityAggregationInfo).aggregateProperties(i,o);return i},e.prototype.correctForGraceWindow=function(e,t,n){for(var r=new y.c(m.n),i=0;i<e.get_count();i++){var o=e.get_item(i);o.get_startTime()>t-n?o.addToCompletedActivities():r.add(o)}return r},e.prototype.getAggregationMode=function(e,t){var n=this.get_activityAggregationSchemes().timeRangeAggregationOverPrimaryProperties(e),r=this.get_activityAggregationSchemes().timeRangeAggregationOverSecondaryProperties(e),i=this.aggregationMode(n,r);return t.val=1===i?n:r,i},e.prototype.aggregationMode=function(e,t){return e.get_count()*this._aggregationParams.modeFactor<t.get_count()?1:2},e.prototype.flushCompletedActivities=function(){},e.prototype.get_enabled=function(){return this._aggregationParams.enabled},e.prototype.addToCompletedActivities=function(e){},e}();(0,o.l)(x,"ActivityAggregationManager",null,[r.e]);var F=function(){function e(e){this.enabled=!1,this.maxInterval=500,this.minChain=2,this.modeFactor=5,this.taskInterval=6e4,this.graceWindow=3e4,this.extractSettings(e.get_appSettings())}return e.prototype.extractSettings=function(t){this.enabled=Boolean.parse(t[e.enabledKey]||"false"),this.maxInterval=parseInt(t[e.maxIntervalKey]||"500"),this.minChain=parseInt(t[e.minChainKey]||"2"),this.taskInterval=parseInt(t[e.taskIntervalKey]||"60000"),this.modeFactor=parseInt(t[e.modeFactorKey]||"5"),this.graceWindow=parseInt(t[e.graceWindowKey]||"30000")},e.enabledKey="ActivityAggregationEnabled",e.maxIntervalKey="ActivityAggregationMaxInterval",e.minChainKey="ActivityAggregationMinChain",e.taskIntervalKey="ActivityAggregationTaskInterval",e.modeFactorKey="ActivityAggregationModeFactor",e.graceWindowKey="ActivityAggregationGraceWindow",e}();(0,o.l)(F,"ActivityAggregationParams",null,[]);var E=n(8471),P=function(){function e(e,t){this._activityAggregationInfo=null,this._activityCollectionFactory=null,this._activityAggregationInfo=e,this._activityCollectionFactory=t}return e.prototype.timeRangeAggregationOverPrimaryProperties=function(e,t){if(void 0===t&&(t=1),!e||!e.get_count())return e;for(var n=new y.c(m.n),r=null,i=0;i<e.get_count();i++){var o=e.get_item(i);if(o){var a=o.get_activityName();if(r)if(r.isWithinTimeRange(o))r.add(o);else{var s=r.process();n.addRange(s),(r=this._activityCollectionFactory(a,t)).add(o)}else(r=this._activityCollectionFactory(a,t)).add(o)}}if(r){s=r.process();n.addRange(s)}return n},e.prototype.timeRangeAggregationOverSecondaryProperties=function(e){if(!e||!e.get_count())return e;for(var t={},n=null,r=0;r<e.get_count();r++){var i=e.get_item(r);if(i){if(!n){n=new y.c(String);for(var o=i.get_activityName(),a=this._activityAggregationInfo.getPrimaryProperties(o).getEnumerator();a.$$mn();){var s=a.$$cu();n.add(s)}}var l=this.getPropertyValueString(i,n);null!==l&&(l in t&&t[l]||(t[l]=new y.c(m.n)),t[l].add(i))}}for(var c=new y.c(m.n),u=0,g=E.f(t);u<g.length;u++){var p=g[u],d=this.timeRangeAggregationOverPrimaryProperties(t[p],2);c.addRange(d)}return c},e.prototype.getPropertyValueString=function(e,t){for(var n="",r=t.$$ge();r.$$mn();){var i=r.$$cu();n+=i,e.get_properties().containsKey(i)&&void 0!==e.get_properties().get_item(i)&&null!==e.get_properties().get_item(i)?n+=e.get_properties().get_item(i):n+="null"}return n},e}();(0,o.l)(P,"ActivityAggregationSchemes",null,[a]);var k=(0,o.y)("IActivityCollection"),D=function(){function e(e,t,n,r,i){this._activityFactory=null,this._activityAggregationInfo=null,this._aggregationParams=null,this.$$pf_ActivityList=null,this.mode=0,this.$$pf_Name=0,this.startTime=0,this.endTime=0,this._aggregationParams=n,this._activityFactory=r,this._activityAggregationInfo=i,this.set_name(e),this.mode=t,this.set_activityList(new y.c(m.n))}return e.prototype.get_activityList=function(){return this.$$pf_ActivityList},e.prototype.set_activityList=function(e){return this.$$pf_ActivityList=e,e},e.prototype.get_mode=function(){return this.mode},e.prototype.get_count=function(){return this.get_activityList().get_count()},e.prototype.get_name=function(){return this.$$pf_Name},e.prototype.set_name=function(e){return this.$$pf_Name=e,e},e.prototype.get_startTime=function(){return this.startTime},e.prototype.get_endTime=function(){return this.endTime},e.prototype.get_durationAverage=function(){if(!this.get_count())return 0;for(var e=0,t=this.get_activityList().$$lge();t.$$mn();){var n=t.$$cu();e+=n.get_endTime()-n.get_startTime()}return e/this.get_count()},e.prototype.get_durationVariance=function(){if(!this.get_count())return 0;for(var e=0,t=this.get_durationAverage(),n=this.get_activityList().$$lge();n.$$mn();){var r=n.$$cu(),i=r.get_endTime()-r.get_startTime();e+=(i-t)*(i-t)}return e/this.get_count()},e.prototype.add=function(e){this.get_count()?this.endTime=e.get_endTime()>this.get_endTime()?e.get_endTime():this.get_endTime():(this.startTime=e.get_startTime(),this.endTime=e.get_endTime()),this.get_activityList().add(e)},e.prototype.isWithinTimeRange=function(e){return!(this.get_count()<=0)&&e.get_startTime()-this.get_endTime()<=this._aggregationParams.maxInterval},e.prototype.process=function(){if(this.get_count()>=this._aggregationParams.minChain){var e=new y.c(m.n),t=this._activityFactory(this);return e.add(t),e}return this.get_activityList()},e.prototype.getPropertyValues=function(e){for(var t=new y.c(String),n=this.get_activityList().$$lge();n.$$mn();){var r=n.$$cu();if(r.get_properties().containsKey(e)){var i=r.get_properties().get_item(e);t.add(i)}else t.add(null)}return t},e.prototype.getSecondaryProperties=function(){for(var e=this._activityAggregationInfo.getPrimaryProperties(this.get_name()),t=new u.j,n=this.getAllProperties().getEnumerator();n.$$mn();){var r=n.$$cu();e.contains(r)||t.add(r)}return t},e.prototype.getAllProperties=function(){var e=new u.j;if(!this.get_activityList())return e;for(var t=this.get_activityList().$$lge();t.$$mn();)for(var n=t.$$cu().get_properties().get_keys().$$ge();n.$$mn();){var r=n.$$cu();e.add(r)}return e},e.prototype.getFirstUniqueID=function(){return this.get_activityList().get_item(0).get_uniqueID()},e}();(0,o.l)(D,"ActivityCollection",null,[k]);var M=(0,o.y)("ICompletedActivitiesHelper"),R=function(){function e(){this._completedActivityList=new g.w(y.c.$$(m.n))}return e.prototype.get_list=function(){return this._completedActivityList},e.prototype.add=function(e){var t=e.get_activityName();if(this._completedActivityList.containsKey(t)&&this._completedActivityList.get_item(t)){var n=this.getIndexForInsertion(this._completedActivityList.get_item(t),e);this._completedActivityList.get_item(t).insert(n,e)}else this._completedActivityList.set_item(t,new y.c(m.n)),this._completedActivityList.get_item(t).add(e)},e.prototype.getIndexForInsertion=function(e,t){for(var n=e.get_count()-1;n>=0;n--)if(t.get_startTime()>e.get_item(n).get_startTime())return n+1;return 0},e}();(0,o.l)(R,"CompletedActivitiesHelper",null,[M]);var L=n(6049),N=n(8590),B=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.ActivityAggregator"},e.prototype.init=function(){var e=this;L.AFrameworkApplication.subscribeToBeforeAppShutDown((function(t,n){e._container.resolve(x).flushCompletedActivities()}))},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e;var t=function(t){return new T((function(){return e.tryResolve(r.e)}),t)},n=function(n,r){return new D(n,r,e.resolve(F),t,e.resolve(i.s))};e.register(x).as(r.e).singleInstance().usingFactory((function(){return new x(e.resolve(F),e.resolve(i.s),e.resolveLazy(a),e.resolve(s.l),e.resolve(R))})),e.register(F).singleInstance().usingFactory((function(){return new F(L.AFrameworkApplication.appSettingsManager)})),e.register(_).as(i.s).singleInstance().usingFactory((function(){return new _})),e.register(P).as(a).singleInstance().usingFactory((function(){return new P(e.resolve(i.s),n)})),e.register(R).singleInstance().usingFactory((function(){return new R}))},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(B,"ActivityAggregatorPackage",null,[l.u,c.s]);var O=n(5279),U=function(){return function(){this.ScreenWidth=0,this.ScreenHeight=0,this.WinInnerWidth=0,this.WinInnerHeight=0,this.WinOuterHeight=0,this.WinOuterWidth=0,this.WinDevicePixelRatio=0,this.CalculatedDevicePixelRatio=0,this.ScreenDeviceXdpi=0,this.ScreenDeviceYdpi=0,this.ScreenLogicalXdpi=0,this.ScreenLogicalYdpi=0,this.ScreenAvailHeight=0,this.ScreenAvailWidth=0,this.DocElemOffsetWidth=0,this.DocElemOffsetHeight=0,this.DocElemClientWidth=0,this.DocElemClientHeight=0,this.WinOrientation=0,this.SupportsTouch=!1,this.NavPlugins=null,this.NavUserAgent=null,this.NavPlatform=null,this.NavAppName=null,this.NavAppVersion=null,this.NavLanguage=null,this.Error=null}}();(0,o.l)(U,"BrowserInfo",null,[]);var H=function(){return function(){this.Name=null,this.Version=null}}();(0,o.l)(H,"PluginInfo",null,[]);var G=n(7904),V=function(){var e=window.navigator.plugins;if(!e||!e.length)return null;for(var t=new Array(0),n=0;n<e.length;n++){var r=e[n].name,i=e[n].version;Array.add(t,(0,O.m)(new H,{Name:r,Version:i}))}return t},W=function(){var e=new U,t=new Sys.StringBuilder;return K(Number,(function(t){e.DocElemClientHeight=t}),(function(){return document.documentElement.clientHeight}),t),K(Number,(function(t){e.DocElemClientWidth=t}),(function(){return document.documentElement.clientWidth}),t),K(Number,(function(t){e.DocElemOffsetHeight=t}),(function(){return document.documentElement.offsetHeight}),t),K(Number,(function(t){e.DocElemOffsetWidth=t}),(function(){return document.documentElement.offsetWidth}),t),K(Number,(function(t){e.ScreenAvailHeight=t}),(function(){return window.screen.availHeight}),t),K(Number,(function(t){e.ScreenAvailWidth=t}),(function(){return window.screen.availWidth}),t),K(Number,(function(t){e.ScreenWidth=t}),(function(){return window.screen.width}),t),K(Number,(function(t){e.ScreenHeight=t}),(function(){return window.screen.height}),t),K(Number,(function(t){e.ScreenLogicalXdpi=t}),(function(){return window.screen.logicalXDPI}),t),K(Number,(function(t){e.ScreenLogicalYdpi=t}),(function(){return window.screen.logicalYDPI}),t),K(Number,(function(t){e.ScreenDeviceXdpi=t}),(function(){return window.screen.deviceXDPI}),t),K(Number,(function(t){e.ScreenDeviceYdpi=t}),(function(){return window.screen.deviceYDPI}),t),K(Number,(function(t){e.WinInnerHeight=t}),(function(){return window.self.innerHeight}),t),K(Number,(function(t){e.WinInnerWidth=t}),(function(){return window.self.innerWidth}),t),K(Number,(function(t){e.WinOuterHeight=t}),(function(){return window.self.outerHeight}),t),K(Number,(function(t){e.WinOuterWidth=t}),(function(){return window.self.outerWidth}),t),K(Number,(function(t){e.WinOrientation=t}),(function(){return window.self.orientation}),t),K(Number,(function(t){e.WinDevicePixelRatio=t}),(function(){return window.self.devicePixelRatio}),t),K(Boolean,(function(t){e.SupportsTouch=t}),(function(){return G.y.get_supportsTouch()}),t),K(String,(function(t){e.NavAppName=t}),(function(){return window.navigator.appName}),t),K(String,(function(t){e.NavAppVersion=t}),(function(){return window.navigator.appVersion}),t),K(String,(function(t){e.NavLanguage=t}),(function(){return window.navigator.browserLanguage||window.navigator.language}),t),K(String,(function(t){e.NavUserAgent=t}),(function(){return window.navigator.userAgent}),t),K(String,(function(t){e.NavPlatform=t}),(function(){return window.navigator.platform}),t),K(Array,(function(t){e.NavPlugins=t}),V,t),K(Number,(function(t){e.CalculatedDevicePixelRatio=t}),(function(){return z()}),t),e.Error=t.toString(),e},z=function(){var e=window.devicePixelRatio;return isNaN(e)?window.screen.deviceXDPI/window.screen.logicalXDPI:e},K=function(e,t,n,r){try{t(n())}catch(e){r.isEmpty()||r.append(" | "),r.append(e.message||"null")}},q=function(){function e(){}return e.prototype.get_name=function(){return"Common.App.BrowserInfoLogger"},e.prototype.configure=function(e){},e.prototype.init=function(){!function(){if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LogBrowserInfoIsEnabled")){var e=W();try{var t=JSON.stringify(e);C.ULS.sendTraceTag(6903563,102,50,t)}catch(e){C.ULS.sendTraceTag(6903564,102,15,e.message)}}else C.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")}()},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(q,"BrowserInfoLoggerPackage",null,[l.u,c.s]);var j,$=n(1205),Q=n(5936),J=n(2066),X=n(2785),Y=n(6192),Z=n(1522),ee=n(3350),te=n(1524);!function(e){e[e.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler",e[e.cloudPolicySettings=1]="cloudPolicySettings"}(j||(j={})),(0,o.h)("ApplicationFeatureHelperRequestType",j);var ne=function(){return function(){this.message=null,this.httpStatusCode=0}}();(0,o.l)(ne,"HttpRequstToPromiseRejectData",null,[]);var re=n(2721),ie=function(){function e(e,t){this._appSettingsManager=null,this._clientRequestManager=null,this._appSettingsManager=e,this._clientRequestManager=t}return e.prototype.createHttpResponsePromise=function(e,t,n,r,i,o,a,s,l){var c=this;void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=null),void 0===l&&(l=null);var u=j[i];return new Promise((function(g,p){if(t){C.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",u);var d=null!=s?s:c._appSettingsManager.getIntAppSetting("ApplicationFeatureHelperRequestQueueTimeout",5e3),h=null!=l?l:c._appSettingsManager.getIntAppSetting("ApplicationFeatureHelperRequestSentTimeout",5e3);c._clientRequestManager.addRequestWithHeaderForwarding(n,1,null,c.getHeaders(i),a,!1,1,(function(e){C.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",u);try{if(null==e||void 0===e.get_data()||null===e.get_data()||void 0===e.get_data().responseData||null===e.get_data().responseData){var t=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",u);return void p(c.getRejectData(t,e))}if(e.get_data().httpStatus!==re.eN){t=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",e.get_data().httpStatus,u);return void p(c.getRejectData(t,e))}null!=o&&void 0!==e.get_data().responseHeaders&&null!==e.get_data().responseHeaders&&o(e.get_data().responseHeaders);var n=r(e.get_data().responseData);if(!n){t=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",u);return void p(c.getRejectData(t,e))}C.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",u),g(n)}catch(n){t=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",n,u);p(c.getRejectData(t,e))}}),(function(e){C.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",u);var t="";if(!e.get_data())return t=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",u),void p(c.getRejectData(t,e));t=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",e.get_data().httpStatus,e.get_data().responseData||"No Data",u),p(c.getRejectData(t,e))}),null,void 0,void 0,d,h)}else g(new e)}))},e.prototype.getRejectData=function(e,t){var n=new ne;return n.message=e,t&&t.get_data()?n.httpStatusCode=t.get_data().httpStatus:n.httpStatusCode=-1,n},e.prototype.getHeaders=function(e){var t={};return t["x-UserDataSignature"]=this._appSettingsManager.getStringAppSetting("UserDataSignature"),t["x-LicensingIsEnabled"]=this._appSettingsManager.getBooleanAppSetting("LicensingIsEnabled").toString(),t["x-CacheIsEnabled"]=this._appSettingsManager.getBooleanAppSetting("LicensingRedisIsEnabled").toString(),t["x-OcpsIsEnabled"]=this._appSettingsManager.getBooleanAppSetting("OcpsIsEnabled").toString(),t["x-LicensingAADIdIsEnabled"]=this._appSettingsManager.getBooleanAppSetting("LicensingAadIdIsEnabled").toString(),t},e}();(0,o.l)(ie,"HttpRequestToPromiseUtility",null,[]);var oe=n(5007),ae=n(6890),se=n(6342),le=n(1271),ce=3004,ue="/afhs/ApplicationFeatureHelperHandler.ashx",ge="AFHSLicensingSuccessfulHTTPResponse",pe=function(){function e(e,t,n,r,i){void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),this._httpRequestToPromise=null,this._appSettingsManager=null,this._actionManager=null,this._cloudPolicySettingsHelper=null,this._userPrivacySettingsHelper=null,this._licensingMaxRetryAttempts=0,this._licensingIsEnabled=!1,this._ocpsIsEnabled=!1,this._userPrivacySettingsEnabled=!1,this._isO365ConsumerHost=!1,this._isO365CommercialHost=!1,this._isFreemiumUpsellSettingEnabled=!1,this._isAnonymousUser=!1,this._licensedControlledFeatureSet=null,this.falseBooleanPromise=null,this.trueBooleanPromise=null,this.featuresPromise=null,this.featureStateChangeCallbacks=null,this._httpRequestToPromise=new ie(e,t),this._appSettingsManager=e,this._licensingMaxRetryAttempts=e.getIntAppSetting("LicensingMaxRetryAttempts",0),this._isO365ConsumerHost=e.getBooleanAppSetting("IsO365ConsumerHost"),this._isO365CommercialHost=e.getBooleanAppSetting("IsO365CommercialHost"),this._isFreemiumUpsellSettingEnabled=e.getBooleanAppSetting("FreemiumUpsellHeaderUIIsEnabled"),this._cloudPolicySettingsHelper=n,this._userPrivacySettingsHelper=r,this._actionManager=i,this._licensingIsEnabled=e.getBooleanAppSetting("LicensingIsEnabled"),this._ocpsIsEnabled=e.getBooleanAppSetting("OcpsIsEnabled")&&this._isO365CommercialHost,this._userPrivacySettingsEnabled=e.getBooleanAppSetting("ShowPrivacyDialog")&&!!r,this._isAnonymousUser=e.getBooleanAppSetting("IsAnonymousUser"),this.falseBooleanPromise=new Promise((function(e,t){e(!1)})),this.trueBooleanPromise=new Promise((function(e,t){e(!0)})),this.featureStateChangeCallbacks=new Y.d(String,Y.d.$$(String,Function),ee.b.get_ordinalIgnoreCase()),this._licensedControlledFeatureSet=this.getLicensedControlledFeatures(),this.isO365Host()&&!this._isAnonymousUser?(oe.Health.get_instance().recordKpiUsageForAlertableKpi(ge,"stbrown",null),this.featuresPromise=this.tryInitializeLicensing(this._licensingIsEnabled,this.getEndpointUrl(ue),o.i(this,this.parseApplicationFeatureHelperResponse,"parseApplicationFeatureHelperResponse"))):this.featuresPromise=new Promise((function(e){e({})})),this.featuresPromise.catch((function(e){C.ULS.sendTraceTag(42513088,ce,10,JSON.stringify(e))}))}return e.prototype.getLicensedControlledFeatures=function(){for(var e=this._appSettingsManager.containsAppSetting("AllLicensedFeatures")?this._appSettingsManager.getListAppSetting("AllLicensedFeatures"):new Array(0),t=new Z.e(String,ee.b.get_ordinal()),n=0;n<e.length;n++)t.add(e[n]);return t},e.prototype.isO365Host=function(){return this._isO365CommercialHost||this._isO365ConsumerHost},e.prototype.tryInitializeLicensing=function(e,t,n,r){var i=this;return void 0===r&&(r=0),C.ULS.sendTraceTag(51185368,ce,50,"ApplicationFeatureHelper_TryInitializeLicensing"),this._httpRequestToPromise.createHttpResponsePromise(Object,e,t,n,0).then((function(e){return e}),(function(o){var a=(0,f.e)(ne,o);if(!a)return C.ULS.sendTraceTag(51491471,ce,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),new Promise((function(e,t){t(o)}));if(408===a.httpStatusCode&&++r<=i._licensingMaxRetryAttempts)return i.tryInitializeLicensing(e,t,n,r);var s=(0,O.m)(new le.e,{extendedProperties:new Map});return s.extendedProperties.set("status",a.httpStatusCode.toString()),oe.Health.get_instance().recordKpiFailure(ge,"RequestFailed",!1,!0,s),new Promise((function(e,t){t(a)}))}))},e.prototype.parseApplicationFeatureHelperResponse=function(e){var t=w.d(e);return t?(C.ULS.sendTraceTag(50436170,ce,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),C.ULS.sendTraceTag(50938594,ce,50,"{0}",t)):C.ULS.sendTraceTag(50436171,ce,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set. Response was {0}",e),t.Features},e.prototype.getEndpointUrl=function(e){return String.format("{0}{1}",this._appSettingsManager.getStringAppSetting("WebServiceBase"),e)},e.prototype.isFeatureEnabled=function(e,t){var n=this;if(!this._ocpsIsEnabled&&!this._userPrivacySettingsEnabled&&!this._licensingIsEnabled)return this.trueBooleanPromise;if(C.ULS.sendTraceTag(42513091,ce,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",e),"ConnectedServices"===e){var r=this._ocpsIsEnabled?this._cloudPolicySettingsHelper.getBooleanPolicySetting("ControllerConnectedServicesEnabled"):this.trueBooleanPromise,i=this._userPrivacySettingsEnabled?this._userPrivacySettingsHelper.getSettings().then((function(e){return 2!==e.controllerServicesStateRoaming}),(function(e){return t})):this.trueBooleanPromise;return r.then((function(e){return e?i:n.falseBooleanPromise}))}var o=null;o=this._ocpsIsEnabled?this._cloudPolicySettingsHelper.isFeatureEnabled(e):this.trueBooleanPromise;var a=null;a=this._licensingIsEnabled?this.isFeatureAllowedByUserLicense(e,t):this.trueBooleanPromise;var s=null;return s=this._userPrivacySettingsEnabled?this._userPrivacySettingsHelper.isFeatureEnabled(e):this.trueBooleanPromise,o.then((function(e){return e?s.then((function(e){return e?a:n.falseBooleanPromise})):n.falseBooleanPromise})).then((function(e){return e}),(function(e){return t}))},e.prototype.getFeatureTier=function(e,t){var n=this;return this._licensingIsEnabled?(C.ULS.sendTraceTag(42804871,ce,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",e),this.featuresPromise.then((function(r){return e in r?n.parseTierName(r[e],t):t}),(function(e){return t}))):new Promise((function(e,t){e(2)}))},e.prototype.isFreemiumUpsellEnabled=function(){return this._isFreemiumUpsellSettingEnabled&&this._isO365ConsumerHost},e.prototype.launchUpsellExperience=function(e){C.ULS.sendTraceTag(594564814,ce,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",e));var t=se.w.get_instance().tryResolve(X.i);if(t){var n=o.i(this,this.handleDimeTaskComplete,"handleDimeTaskComplete");t.launchDimeExperience(e,n)}else C.ULS.sendTraceTag(594367561,340,15,"InProductMessaging was not initialized"),this._actionManager.processActionWithData(te.Mg,2,{experience:e})},e.prototype.registerFeatureStateChangeCallback=function(e,t){if(!this._licensingIsEnabled)return null;if(!e||!t)return C.ULS.sendTraceTag(594564813,ce,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;var n=ae.l.create().toString();return this.featureStateChangeCallbacks.containsKey(e)?this.featureStateChangeCallbacks.get_item(e).add(n,t):(this.featureStateChangeCallbacks.set_item(e,new Y.d(String,Function,ee.b.get_ordinalIgnoreCase())),this.featureStateChangeCallbacks.get_item(e).add(n,t)),C.ULS.sendTraceTag(594564812,ce,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",n,e)),n},e.prototype.removeFeatureStateChangeCallback=function(e,t){return!!this._licensingIsEnabled&&(e&&this.featureStateChangeCallbacks.containsKey(e)?t&&ae.l.isValid(t)?this.featureStateChangeCallbacks.get_item(e).containsKey(t)?(C.ULS.sendTraceTag(594564808,ce,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",t,e)),this.featureStateChangeCallbacks.get_item(e).remove(t)):(C.ULS.sendTraceTag(594564809,ce,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",t,e)),!1):(C.ULS.sendTraceTag(594564810,ce,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",t,e)),!1):(C.ULS.sendTraceTag(594564811,ce,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",e)),!1))},e.prototype.parseTierName=function(e,t){switch(e.toLowerCase()){case"unknown":return 0;case"basic":return 1;case"premium":return 2;default:return t}},e.prototype.handleDimeTaskComplete=function(){C.ULS.sendTraceTag(594367560,ce,50,"ApplicationFeatureHelper_HandleDimeTaskComplete"),L.AFrameworkApplication.get_activeFrame().refreshDocument(null)},e.prototype.isFeatureAllowedByUserLicense=function(e,t){return this._licensingIsEnabled&&this._licensedControlledFeatureSet.contains(e)?this.featuresPromise.then((function(t){return e in t}),(function(e){return t})):this.trueBooleanPromise},e}();(0,o.l)(pe,"ApplicationFeatureHelper",null,[J.a]);var de=function(){return function(e,t){this.PolicySettings=null,this.ExpirationTime=0,this.PolicySettings=e.PolicySettings;var n=new Date;n.setMinutes(n.getMinutes()+t),this.ExpirationTime=n.getTime()}}();(0,o.l)(de,"CloudPolicySettingsCacheData",null,[]);var he=n(8377),_e=function(){return function(){this.PolicySettings=null,this.ControllerConnectedServicesFeatureNames=null}}();(0,o.l)(_e,"CloudPolicySettingsData",null,[]);var me=3004,fe="/afhs/CloudPolicySettings.ashx",ye="CloudPolicySettingsRequestSuccess",Ce=function(){function e(e,t){this._httpRequestToPromise=null,this._appSettingsManager=null,this._controllerConnectedServicesSet=null,this._ocpsIsEnabled=!1,this._localStorageCacheKey=null,this._checkInInterval=0,this.cloudPolicySettingsPromise=null,this._ocpsPolicyDefaults={},this._httpRequestToPromise=new ie(e,t),this._appSettingsManager=e;var n=e.getStringAppSetting("HostAuthType");this._ocpsIsEnabled=e.getBooleanAppSetting("OcpsIsEnabled")&&e.getBooleanAppSetting("IsO365CommercialHost")&&!(null==n)&&"aad"===n.toLowerCase(),this._ocpsPolicyDefaults=w.b(e.getStringAppSetting("OcpsDefaultSettings")||"{}"),this._localStorageCacheKey=this.getLocalStorageCacheKey();var r=this._appSettingsManager.containsAppSetting("ServicesControlsMicrosoftControllerServicesList")&&this._appSettingsManager.getListAppSetting("ServicesControlsMicrosoftControllerServicesList")||new Array(0);this._controllerConnectedServicesSet=new Z.e(String,ee.b.get_ordinal());for(var i=0;i<r.length;i++)this._controllerConnectedServicesSet.add(r[i]);this.cloudPolicySettingsPromise=this.tryInitialize(this._ocpsIsEnabled,this.getEndpointUrl(fe),o.i(this,this.parseCloudPolicySettingsResponse,"parseCloudPolicySettingsResponse")),oe.Health.get_instance().recordKpiUsage(ye,1,"shtiwari",null),this.cloudPolicySettingsPromise.then((function(e){return oe.Health.get_instance().recordKpiSuccess(ye,null),null})).catch((function(e){C.ULS.sendTraceTag(50622685,me,10,JSON.stringify(e))}))}return e.prototype.getBooleanPolicySetting=function(e,t){var n=this;if(void 0===t&&(t=!0),!this._ocpsIsEnabled)return new Promise((function(t,r){t(n.getOcpsBooleanPolicyDefault(e))}));var r=this.cloudPolicySettingsPromise.then((function(r){try{var i=r.PolicySettings.unknown;if(e in i&&void 0!==i[e]&&null!==i[e])return new Promise((function(t,n){t("0"!==i[e])}));var o=e.toLowerCase();return o in i&&void 0!==i[o]&&null!==i[o]?new Promise((function(e,t){e("0"!==i[o])})):(C.ULS.sendTraceTag(51512667,me,15,"Policy"+e+" not found, using default"),new Promise((function(t,r){t(n.getOcpsBooleanPolicyDefault(e))})))}catch(r){return C.ULS.sendTraceTag(50622686,me,10,"Failed to get "+e+" policy value. Error Message: {0}",r.message),n.handleError(r.toString(),t,n.getOcpsBooleanPolicyDefault(e))}}),(function(r){return n.handleError(r,t,n.getOcpsBooleanPolicyDefault(e))}));return r.then((function(t){return C.ULS.sendTraceTag(50651667,me,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",e,t),null})),r},e.prototype.isFeatureEnabled=function(e,t){void 0===t&&(t=!0);var n=new Promise((function(e,t){e(!0)})),r="";return this._controllerConnectedServicesSet.contains(e)&&(r="ControllerConnectedServicesEnabled",n=this.getBooleanPolicySetting(r,t)),n.then((function(t){return C.ULS.sendTraceTag(50651668,me,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",e,t,r),null})),n},e.prototype.handleError=function(e,t,n){return t?new Promise((function(e,t){e(n)})):new Promise((function(t,n){n(e)}))},e.prototype.tryInitialize=function(e,t,n){var r=this;if(e&&void 0!==this._localStorageCacheKey&&null!==this._localStorageCacheKey&&this._localStorageCacheKey.length>0){var i=this.tryGetCloudPolicySettingsDataFromCache();return null!=i?(C.ULS.sendTraceTag(51662932,me,50,"Retrieved CloudPolicySettingsData from browser cache"),new Promise((function(e,t){e(i)}))):this._httpRequestToPromise.createHttpResponsePromise(_e,e,t,n,1,o.i(this,this.processCloudPolicySettingsResponseHeaders,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],this._appSettingsManager.getIntAppSetting("CloudPolicySettingsRequestQueueTimeout",15e3),this._appSettingsManager.getIntAppSetting("CloudPolicySettingsRequestSentTimeout",3e4)).then((function(e){return C.ULS.sendTraceTag(51662933,me,50,"Retrieved CloudPolicySettingsData from OCPS"),r.trySetCloudPolicySettingsDataIntoCache(e),e}))}return this._httpRequestToPromise.createHttpResponsePromise(_e,e,t,n,1)},e.prototype.getEndpointUrl=function(e){return String.format("{0}{1}",this._appSettingsManager.getStringAppSetting("WebServiceBase"),e)},e.prototype.parseCloudPolicySettingsResponse=function(e){var t=null;return w.t(_e,e,(0,p.m)((function(){return t}),(function(e){return t=e}))),C.ULS.sendTraceTag(50622687,me,t?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",e),t},e.prototype.processCloudPolicySettingsResponseHeaders=function(e){try{if(null==e)return;if("CheckIn-Interval"in e){var t=parseInt(e["CheckIn-Interval"]);null!=t&&t>0&&(this._checkInInterval=t)}}catch(e){C.ULS.sendTraceTag(51662934,me,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",e)}},e.prototype.getOcpsBooleanPolicyDefault=function(e){return!(e in this._ocpsPolicyDefaults)||"0"!==this._ocpsPolicyDefaults[e]},e.prototype.tryGetCloudPolicySettingsDataFromCache=function(){try{var e=he.e.get_instance().getItem(this._localStorageCacheKey);if(null==e)return C.ULS.sendTraceTag(51662936,me,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;C.ULS.sendTraceTag(51662937,me,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",e);var t=JSON.parse(e);if(null==t)return C.ULS.sendTraceTag(51662938,me,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),null;if(void 0===t.ExpirationTime||null===t.ExpirationTime)return C.ULS.sendTraceTag(51662939,me,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if(new Date(t.ExpirationTime).getTime()<Date.now())return C.ULS.sendTraceTag(51662940,me,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var n=new _e;n.PolicySettings=t.PolicySettings,n.ControllerConnectedServicesFeatureNames=new y.c(String);this._appSettingsManager.containsAppSetting("ServicesControlsMicrosoftControllerServicesList")?this._appSettingsManager.getListAppSetting("ServicesControlsMicrosoftControllerServicesList"):new Array(0);for(var r=this._controllerConnectedServicesSet.getEnumerator();r.$$mn();){var i=r.$$cu();n.ControllerConnectedServicesFeatureNames.add(i)}return C.ULS.sendTraceTag(51662941,me,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved"),n}catch(e){return C.ULS.sendTraceTag(51662942,me,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",e.toString()),null}},e.prototype.trySetCloudPolicySettingsDataIntoCache=function(e){try{if(null==e||void 0===e.PolicySettings||null===e.PolicySettings)C.ULS.sendTraceTag(51662944,me,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(this._checkInInterval<=0)C.ULS.sendTraceTag(51662945,me,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var t=new de(e,this._checkInInterval),n=JSON.stringify(t);C.ULS.sendTraceTag(51662946,me,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",n),he.e.get_instance().setItem(this._localStorageCacheKey,n),C.ULS.sendTraceTag(51662947,me,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(e){C.ULS.sendTraceTag(51662976,me,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",e.toString())}},e.prototype.getLocalStorageCacheKey=function(){try{if(this._ocpsIsEnabled&&G.y.get_supportsWindowAtob()){var e=this._appSettingsManager.getStringAppSetting("UserDataSignature").split(".");if(e.length>1){var t=window.self.atob(e[1]),n=JSON.parse(t).LocalStorageKey;if(null!=n&&n.length>0)return n}}}catch(e){C.ULS.sendTraceTag(51662977,me,10,"GetLocalStorageCacheKey exception {0}",e.toString())}return null},e}();(0,o.l)(Ce,"CloudPolicySettingsHelper",null,[$.c]);var Se=function(){function e(){this.controllerServicesStateRoaming=0,this.userContentStateRoaming=0,this.downloadContentStateRoaming=0,this.controllerServicesTimeRoaming=null,this.userContentTimeRoaming=null,this.downloadContentTimeRoaming=null,this.userPrivacySettingsRoamedNoticeShown=0,this._source=0,this.controllerServicesStateRoaming=0,this.userContentStateRoaming=0,this.downloadContentStateRoaming=0,this.controllerServicesTimeRoaming="",this.userContentTimeRoaming="",this.downloadContentTimeRoaming="",this.userPrivacySettingsRoamedNoticeShown=2,this._source=2}return e.prototype.clone=function(){var t=new e;return t.controllerServicesStateRoaming=this.controllerServicesStateRoaming,t.userContentStateRoaming=this.userContentStateRoaming,t.downloadContentStateRoaming=this.downloadContentStateRoaming,t.controllerServicesTimeRoaming=this.controllerServicesTimeRoaming,t.userContentTimeRoaming=this.userContentTimeRoaming,t.downloadContentTimeRoaming=this.downloadContentTimeRoaming,t.userPrivacySettingsRoamedNoticeShown=this.userPrivacySettingsRoamedNoticeShown,t._source=this._source,t},e.prototype.get_src=function(){return this._source},e.prototype.set_src=function(e){return this._source=e,e},e.prototype.serialize=function(t){void 0===t&&(t=null);var n={};return t&&!t.contains(e.officePrivacyControllerConnectedServicesKey)||(n[e.officePrivacyControllerConnectedServicesKey]=this.controllerServicesStateRoaming),t&&!t.contains(e.officePrivacyControllerConnectedServicesTimeKey)||(n[e.officePrivacyControllerConnectedServicesTimeKey]=this.controllerServicesTimeRoaming),t&&!t.contains(e.officePrivacyRoamedNoticeShownKey)||(n[e.officePrivacyRoamedNoticeShownKey]=this.userPrivacySettingsRoamedNoticeShown),JSON.stringify(n)},e.create=function(t,n){void 0===n&&(n=null);var r=new e;return r._source=t,null!=n&&(e.officePrivacyControllerConnectedServicesKey in n&&(r.controllerServicesStateRoaming=n[e.officePrivacyControllerConnectedServicesKey]),e.officePrivacyControllerConnectedServicesTimeKey in n&&(r.controllerServicesTimeRoaming=n[e.officePrivacyControllerConnectedServicesTimeKey]),e.officePrivacyRoamedNoticeShownKey in n&&(r.userPrivacySettingsRoamedNoticeShown=n[e.officePrivacyRoamedNoticeShownKey])),r},e.deserialize=function(t,n){try{var r=JSON.parse(t);if(null!=r)return e.create(n,r);throw C.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",t),Error.argument("settingsData")}catch(e){throw C.ULS.sendTraceTag(50860947,306,10,"UserPrivacySettings Deserialize Exception = {0}",e.toString()),e}},e.officePrivacyControllerConnectedServicesKey="CCS",e.officePrivacyControllerConnectedServicesTimeKey="CCSTime",e.officePrivacyRoamedNoticeShownKey="OfficePrivacyRoamedNoticeShown",e}();(0,o.l)(Se,"UserPrivacySettings",null,[]);var ve=n(3131),be=function(){function e(e,t){if(this._settings=null,this._settingsPromise=null,this._appSettingsManager=null,this._clientRequestManager=null,null==e||null==t)throw Error.argumentNull("appSettingsManager/clientRequestManager");this._appSettingsManager=e,this._clientRequestManager=t,this._settings=null,this._settingsPromise=null}return e.prototype.getEndpointUrl=function(e){var t=this._appSettingsManager.get_appSettings().RoamingServiceHandlerWebServiceBase||"",n=String.format("{0}RoamingServiceHandler.ashx?action=",t),r=new Sys.StringBuilder(n);return r.append(e),r.append("&"),r.append(L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion),r.toString()},e.prototype.executeRequest=function(e,t,n,r){return void 0===r&&(r=null),this._clientRequestManager.addRequestWithTaskAndStopWatch(e,t,r,null,!1,2,null,n,"33",!1,null,6e4)},e.prototype.saveSettings=function(e){var t=this;return new Promise((function(n,r){try{if(void 0===t._settings||null===t._settings||null==e)return C.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),void r("Can't determine setting changes to save");var i=t._settings.controllerServicesStateRoaming!==e.controllerServicesStateRoaming;if(2===t._settings.get_src()&&i)return t.saveSettingsToQueryParam(e),void n(!0);var o=t.serializeSettingUpdates(e);if(null==o||!o.length)return C.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),void r("No changes to save");if(1===t._settings.get_src())return void n(t.trySaveSettingsToCookie(o));if(!t._settings.get_src()){C.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",o);var a=t.executeRequest(t.getEndpointUrl("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",o);a.CW((function(e){if(a.get_isCanceled()||a.get_isFaulted())return C.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),void n(!1);var t=a.get_result();void 0!==t.get_args()&&null!==t.get_args()&&void 0!==t.get_args().get_data()&&null!==t.get_args().get_data()&&t.get_args().get_data().httpStatus===re.eN?(C.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),n(!0)):(C.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),n(!1))}))}}catch(e){C.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",e.toString()),n(!1)}}))},e.prototype.serializeSettingUpdates=function(e){if(void 0===this._settings||null===this._settings||null==e)throw Error.invalidOperation("User Privacy settings have not been initialized");var t=new y.c(String);return e.get_src()?1===e.get_src()&&this._settings.controllerServicesStateRoaming!==e.controllerServicesStateRoaming&&t.add(Se.officePrivacyControllerConnectedServicesKey):(this._settings.controllerServicesStateRoaming!==e.controllerServicesStateRoaming&&(t.add(Se.officePrivacyControllerConnectedServicesKey),t.add(Se.officePrivacyControllerConnectedServicesTimeKey)),this._settings.userPrivacySettingsRoamedNoticeShown!==e.userPrivacySettingsRoamedNoticeShown&&t.add(Se.officePrivacyRoamedNoticeShownKey)),t.get_count()?e.serialize(t):(C.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)},e.prototype.getSettings=function(){var e=this;return this._settingsPromise||(this._settingsPromise=new Promise((function(t,n){try{if(e._settings)return void t(e._settings.clone());e.tryGetSettingsFromRoaming().then((function(n){return e._settings=n,t(e._settings.clone()),null}),(function(n){return e.tryGetSettingsFromCookie().then((function(n){return e._settings=n,t(e._settings.clone()),null}),(function(n){return e.tryGetSettingsFromQueryParams().then((function(n){return e._settings=n,t(e._settings.clone()),null}),(function(n){return C.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)"),e._settings=new Se,t(e._settings.clone()),null})),null})),null}))}catch(n){C.ULS.sendTraceTag(50860932,3004,10,"UserPrivacySettings GetSettings: Exception = {0}",n.toString()),e._settings=new Se,t(e._settings.clone())}}))),this._settingsPromise},e.prototype.tryGetSettingsFromRoaming=function(){var t=this;return new Promise((function(n,r){try{var i=-1!==window.location.href.indexOf("&wd_pn=2");if(!t._appSettingsManager.getBooleanAppSetting("PrivacyDialogShouldCheckRoaming")&&!i)return C.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),void r("Roaming should not be used");var o=t.executeRequest(t.getEndpointUrl("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");o.CW((function(t){try{if(!o.get_isCanceled()&&!o.get_isFaulted()){var i=o.get_result();if(i&&i.get_args()&&i.get_args().get_data())if(i.get_args().get_data().httpStatus!==re.eN)C.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",i.get_args().get_data().httpStatus);else{if(i.get_args().get_data().responseData)return n(e.parse(i.get_args().get_data().responseData,0)),void C.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",i.get_args().get_data().responseData);C.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else C.ULS.sendTraceTag(50860935,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");return void r("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}C.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure")}catch(e){return C.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",e.toString()),void r("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}}))}catch(e){return C.ULS.sendTraceTag(50860939,3004,10,"TryGetSettingsFromRoaming Exception = {0}",e.toString()),void r("UserPrivacySettings TryGetSettingsFromRoaming Exception")}}))},e.prototype.tryGetSettingsFromCookie=function(){var t=this;return new Promise((function(n,r){try{var i=ve.g("WacUPToggleState"),o=null;if(null!=i&&i.length>0&&(o=decodeURIComponent(i)),null!=o&&o.length>0){var a=e.parse(o,1);return C.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",a.toString()),void n(a)}var s=Se.create(1),l=new y.c(String);l.add(Se.officePrivacyControllerConnectedServicesKey);var c=s.serialize(l);return t.trySaveSettingsToCookie(c)?(C.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",s.toString()),void n(s)):(C.ULS.sendTraceTag(51258450,3004,10,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",s.toString()),void r("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}catch(e){C.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",e.toString()),r("UserPrivacySettings TryGetSettingsFromCookie Eception")}}))},e.prototype.tryGetSettingsFromQueryParams=function(){return new Promise((function(e,t){try{var n=-1!==window.location.href.indexOf("&wdccsoff=1"),r=Se.create(2);return n?(r.controllerServicesStateRoaming=2,L.AFrameworkApplication.disableControllerServicesViaQueryParam(),C.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",r.toString())):(r.controllerServicesStateRoaming=1,C.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",r.toString())),void e(r)}catch(t){C.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",t.toString()),(r=Se.create(2)).controllerServicesStateRoaming=1,e(r)}}))},e.prototype.saveSettingsToQueryParam=function(e){return C.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam"),2===e.controllerServicesStateRoaming?L.AFrameworkApplication.disableControllerServicesViaQueryParam():L.AFrameworkApplication.enableControllerServicesViaQueryParam(),C.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",e),!0},e.prototype.trySaveSettingsToCookie=function(e){try{C.ULS.sendTraceTag(51258455,3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",e);var t=this._appSettingsManager.getStringAppSetting("PrivacyCookieDomain")||"";if(!t||!t.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");return C.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",e),ve.z("WacUPToggleState",e,ve.i,"/",t)}catch(e){return C.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",e.toString()),!1}},e.prototype.isFeatureEnabled=function(e){var t=this;return this.getSettings().then((function(n){for(var r=t._appSettingsManager.containsAppSetting("ServicesControlsMicrosoftControllerServicesList")?t._appSettingsManager.getListAppSetting("ServicesControlsMicrosoftControllerServicesList"):new Array(0),i=new Z.e(String,ee.b.get_ordinal()),o=0;o<r.length;o++)i.add(r[o]);return!i.contains(e)||2!==n.controllerServicesStateRoaming}),(function(t){return C.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",e),!0}))},e.parse=function(e,t){try{return C.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",e,t),Se.deserialize(e,t)}catch(e){throw C.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",e.toString()),e}},e}();(0,o.l)(be,"UserPrivacySettingsHelper",null,[Q.l]);var Te=n(366),Ae=n(7573),Ie=function(){function e(){}return e.testGetAuthToken=function(t){return new Promise((function(n,r){e.sideCarIsAvailable().then((function(e){return e?n(sidecar.oAuth.getAuthToken(t)):r(""),null}))}))},e.sideCarIsAvailable=function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SideCarIsEnabled")?e.scriptResourceWithAction&&e.scriptResourceWithAction.get_isDownloaded()?new Promise((function(e){e(!0)})):new Promise((function(t,n){e.scriptResourceWithAction=Ae.v.create(L.AFrameworkApplication.appSettingsManager.getStringAppSetting("SideCarUrl")),Te.z.enqueueResourceWithoutEnabling(e.scriptResourceWithAction),e.scriptResourceWithAction.add_loadFinished((function(e,r){r.get_succeeded()?t(r.get_succeeded()):n(r.get_succeeded())}))})):new Promise((function(e){e(!1)}))},e.scriptResourceWithAction=null,e}();(0,o.l)(Ie,"SideCarLoader",null,[]);var we=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register($.c).singleInstance().usingFactory((function(){return new Ce(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.theClientRequestManager)})),this._container.register(Q.l).singleInstance().usingFactory((function(){return new be(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.theClientRequestManager)})),this._container.register(J.a).singleInstance().usingFactory((function(){return new pe(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.theClientRequestManager,t._container.resolve($.c),t._container.resolve(Q.l),L.AFrameworkApplication.get_theActionManager())}))},e.prototype.init=function(){var e=this;L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){var t=e._container.resolve(J.a);L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LicensingIsEnabled")&&(t.isFeatureEnabled("LicensingTestFeature",!1).then((function(e){return C.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",e,L.AFrameworkApplication.appSettingsManager.getStringAppSetting("IsAnonymousUser")),null})),t.getFeatureTier("LicensingTestFeature",0).then((function(e){return C.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",e,L.AFrameworkApplication.appSettingsManager.getStringAppSetting("IsAnonymousUser")),null}))),e.temporarySideCarVerifier()}))},e.prototype.dispose=function(){},e.prototype.temporarySideCarVerifier=function(){try{if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SideCarIsEnabled"))Ie.testGetAuthToken("FakeName").then((function(e){return e}))}catch(e){return}},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(we,"ApplicationFeatureHelperPackage",null,[l.u,c.s]);var xe=(0,o.y)("IUserActivityHostNotificationManager"),Fe=n(7978),Ee=n(3837),Pe=n(6035),ke=n(5464),De=n(5097),Me=n(2172),Re=function(){function e(e,t,n,r,i,a,s){void 0===s&&(s=0),this._editHappenedInTimeWindow=!1,this._hostPostmessengerTask=null,this._notificationTask=null,this._taskManager=null,this._notificationIntervalInMs=0,this._editNotificationEventSource=null,this._userActivityHostNotificationManager=null,this._editNotificationPostMessageIsEnabled=!1,this._editDocumentTelemetryReportingTask=null,this._editDocumentUserActionReportingIntervalInMs=0,this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport=!1,this.userEverEdited=!1,this._taskManager=t,this._notificationIntervalInMs=e,this._hostPostmessengerTask=n,this._editNotificationEventSource=r,this._userActivityHostNotificationManager=i,this._editNotificationPostMessageIsEnabled=a,this._editDocumentUserActionReportingIntervalInMs=0,this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport=!1;try{s>0&&(this._editDocumentUserActionReportingIntervalInMs=s,this._editDocumentUserActionReportingIntervalInMs<3e5&&(this._editDocumentUserActionReportingIntervalInMs=3e5),this._taskManager&&!this._editDocumentTelemetryReportingTask&&(this._editDocumentTelemetryReportingTask=new De.c(3,2,this._editDocumentUserActionReportingIntervalInMs,o.i(this,this.reportEditDocumentUserActionTelemetryIfNecessary,"reportEditDocumentUserActionTelemetryIfNecessary")),this._taskManager.addTask(this._editDocumentTelemetryReportingTask)))}catch(e){C.ULS.sendTraceTag(51246176,383,50,"Hit an exception while trying to queue up the EditDocument user action reporting interval: "+e)}}return e.prototype.get_userEverEdited=function(){return this.userEverEdited},e.prototype.editHappened=function(){this.get_userEverEdited()?this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport=!0:(this.userEverEdited=!0,oe.Health.get_instance().addQosPillar("Save"),oe.Health.get_instance().addQosPillar("Authoring"),ke.b(te.kY)),this._editHappenedInTimeWindow=!0,this._userActivityHostNotificationManager&&this._userActivityHostNotificationManager.activityHappened(),this._editNotificationEventSource&&this._editNotificationEventSource.raiseEditHappenedEvent(),L.AFrameworkApplication.dataPlumber&&L.AFrameworkApplication.dataPlumber.markAsRealEditSession(),this._editNotificationPostMessageIsEnabled&&(this._notificationTask||(this.sendPostMessageIfNecessary(null),this._notificationTask=new De.c(3,2,this._notificationIntervalInMs,o.i(this,this.sendPostMessageIfNecessary,"sendPostMessageIfNecessary"),113),this._taskManager.addTask(this._notificationTask)))},e.prototype.sendPostMessageIfNecessary=function(e){var t=this;this._editHappenedInTimeWindow&&(this._hostPostmessengerTask.CWR(Boolean,(function(e){return t._hostPostmessengerTask.get_result().sendMessage(Me.a.editNotification,null)})),C.ULS.sendTraceTag(38086292,209,50,"EditNotificationManager: sending post message to the host."),this._editHappenedInTimeWindow=!1)},e.prototype.reportEditDocumentUserActionTelemetryIfNecessary=function(e){try{this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport&&(ke.b(te.kY),this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport=!1)}catch(e){this._hasAnotherEditBeenMadeSinceLastEditDocumentTelemetryReport=!1,C.ULS.sendTraceTag(51246177,383,50,"Hit an exception while trying to send the EditDocument user action: "+e)}},e}();(0,o.l)(Re,"EditNotificationManager",null,[Ee.w]);var Le=n(8975),Ne=function(){function e(e,t,n,r,i){this._hostPostmessengerTask=null,this._mouseInputManager=null,this._notificationTask=null,this._handlerTask=null,this._taskManager=null,this._notificationIntervalInMs=0,this._activityHappenedInTimeWindow=!1,this.userWasEverActive=!1,this._handlerRegistered=!1,this._onBeforeShutdownSubscriber=null,this._taskManager=t,this._notificationIntervalInMs=e,this._hostPostmessengerTask=n,this._mouseInputManager=r,this._onBeforeShutdownSubscriber=i,this.registerHandlerTask(null)}return e.prototype.get_userWasEverActive=function(){return this.userWasEverActive},e.prototype.registerHandlerTask=function(e){var t=this,n=document.getElementById(L.AFrameworkApplication.applicationOuterContainerId);!this._handlerRegistered&&this._mouseInputManager&&n&&(this._mouseInputManager.registerHandler(Le.d.mouseOver,n,o.i(this,this.mouseActivityHandler,"mouseActivityHandler"),null),this._handlerRegistered=!0),this._onBeforeShutdownSubscriber((function(e,n){t.dispose()}))},e.prototype.mouseActivityHandler=function(e){return this._handlerRegistered&&(this._mouseInputManager.unregisterHandler(Le.d.mouseOver,document.getElementById(L.AFrameworkApplication.applicationOuterContainerId),o.i(this,this.mouseActivityHandler,"mouseActivityHandler")),this._handlerRegistered=!1),this.activityHappened(),!1},e.prototype.activityHappened=function(){this.userWasEverActive=!0,this._activityHappenedInTimeWindow=!0,this._handlerTask||(this._handlerTask=new De.c(3,2,this._notificationIntervalInMs,o.i(this,this.registerHandlerTask,"registerHandlerTask"),112),this._taskManager.addTask(this._handlerTask)),this._notificationTask||(this.sendPostMessageIfNecessary(null),this._notificationTask=new De.c(3,2,this._notificationIntervalInMs,o.i(this,this.sendPostMessageIfNecessary,"sendPostMessageIfNecessary"),111),this._taskManager.addTask(this._notificationTask))},e.prototype.sendPostMessageIfNecessary=function(e){var t=this;this._activityHappenedInTimeWindow&&(this._hostPostmessengerTask.CWR(Boolean,(function(e){return t._hostPostmessengerTask.get_result().sendMessage(Me.a.userActivity,null)})),C.ULS.sendTraceTag(38405446,209,50,"UserActivityHostNotificationManager: sending post message to the host."),this._activityHappenedInTimeWindow=!1)},e.prototype.dispose=function(){this._handlerRegistered&&(this._mouseInputManager.unregisterHandler(Le.d.mouseOver,document.getElementById(L.AFrameworkApplication.applicationOuterContainerId),o.i(this,this.mouseActivityHandler,"mouseActivityHandler")),this._handlerRegistered=!1)},e}();(0,o.l)(Ne,"UserActivityHostNotificationManager",null,[xe,Sys.IDisposable]);var Be=n(9679),Oe=n(6794),Ue=n(3489),He=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.EditNotification"},e.prototype.init=function(){L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady(o.i(this,this.onFullAppSettingsReady,"onFullAppSettingsReady"))},e.prototype.onFullAppSettingsReady=function(){var t=this;e.get_editNotificationIsEnabled()&&e.get_editNotificationInterval()>0&&(this._container.register(Pe.n).singleInstance(),this._container.register(Ne).as(xe).singleInstance().usingFactory((function(){return new Ne(6e4,Oe.y.get_instance(),Ue.k(Fe.i,t._container.resolveFuture(Fe.i)),Be.p.get_instance(),L.AFrameworkApplication.subscribeToBeforeAppShutDown)})),this._container.register(Re).as(Ee.w).singleInstance().usingFactory((function(){return new Re(e.get_editNotificationInterval(),Oe.y.get_instance(),Ue.k(Fe.i,t._container.resolveFuture(Fe.i)),t._container.resolve(Pe.n),t._container.tryResolve(xe),e.get_editNotificationPostMessageIsEnabled(),e.get_editDocumentUserActionTelemetryReportingIntervalInMilliseconds())})),this._container.resolve(Ee.w),C.ULS.shipAssertTag(38086291,209,e.get_editNotificationInterval()>0,"EditNotification Interval is less than or equal to 0."))},e.prototype.configure=function(e){this._container=e},e.prototype.dispose=function(){},e.get_editNotificationInterval=function(){return L.AFrameworkApplication.appSettingsManager?parseInt(L.AFrameworkApplication.appSettingsManager.get_appSettings().EditNotificationTimeIntervalMs||"300000"):3e5},e.get_editDocumentUserActionTelemetryReportingIntervalInMilliseconds=function(){return L.AFrameworkApplication.appSettingsManager?parseInt(L.AFrameworkApplication.appSettingsManager.get_appSettings().EditDocumentUserActionTelemetryReportingIntervalInMilliseconds||"0"):0},e.get_editNotificationIsEnabled=function(){return!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EditNotificationIsEnabled")},e.get_editNotificationPostMessageIsEnabled=function(){return!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EditNotificationPostMessageIsEnabled")},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(He,"CommonHostNotificationPackage",null,[l.u,c.s]);var Ge=(0,o.y)("IUpsellActor"),Ve=(0,o.y)("IChatManager"),We=(0,o.y)("IReactSharedHeaderFocusManager"),ze=n(4837),Ke=function(){function e(){}return e.meControlFlexPaneFocusId="ReactSharedHeaderMeControlFlexPane",e.headerUiFocusId="headerui",e.chatFocusId="chat_wrapper_pane",e}();(0,o.l)(Ke,"ReactSharedHeaderConstants",null,[]);var qe=function(){function e(e){this._reactSharedHeaderFocusManager=null,this._previousNumberOfChats=0,this._chatContainerId=null,this._reactSharedHeaderFocusManager=e}return e.prototype.get_chat=function(){return window.swc},e.prototype.get_isInitialized=function(){return!!this.get_chat()},e.prototype.get_sharedHeaderFocusManager=function(){return this._reactSharedHeaderFocusManager.get_value()},e.prototype.registerActions=function(){this.get_isInitialized()?this.registerActionsInternal():this.registerOnChatReady(o.i(this,this.registerActionsInternal,"registerActionsInternal"))},e.prototype.registerActionsInternal=function(){var e=this;C.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.get_isInitialized()&&(this.get_chat().getContainerProvider().then((function(t){t.getChatsContainer(o.i(e,e.onChatContainerReady,"onChatContainerReady"))})).catch((function(e){C.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",e)})),this.get_chat().getChatsCounter().then((function(t){t.onChatsCountChange(o.i(e,e.chatCountChanged,"chatCountChanged"))})).catch((function(e){C.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",e)})),this.get_chat().getKeyboard().then((function(t){t.onKeyDown(o.i(e,e.onChatKeyPress,"onChatKeyPress"))})).catch((function(e){C.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",e)})))}catch(e){C.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",e)}},e.prototype.chatCountChanged=function(e){if(C.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",e),e){if(1===e&&!this._previousNumberOfChats){var t=document.getElementById(this._chatContainerId?this._chatContainerId:Ke.chatFocusId);t?this.get_sharedHeaderFocusManager().onChatOpen(t,o.i(this,this.transferFocusToChat,"transferFocusToChat")):C.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}}else this.get_sharedHeaderFocusManager().onChatClose();this._previousNumberOfChats=e},e.prototype.onChatContainerReady=function(e){this._chatContainerId=e},e.prototype.onChatKeyPress=function(e){e.ctrlKey&&"f6"===e.key.toLowerCase()&&this.transferFocusFromChat(e.shiftKey)},e.prototype.registerOnChatReady=function(e){ze.z.get_instance().registerHandler(Le.d.swcReady,window.self,(function(t){return e(),!0}))},e.prototype.transferFocusToChat=function(){C.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.get_isInitialized()&&this.get_chat().getFocuser().then((function(e){e.focusConversationInput()})).catch((function(e){C.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",e)}))}catch(e){C.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",e)}},e.prototype.transferFocusFromChat=function(e){C.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat"),this.get_sharedHeaderFocusManager().onChatCtrlF6(e)},e}();(0,o.l)(qe,"ChatManager",null,[Ve]);var je=n(8061),$e=n(7258),Qe=n(2446),Je=n(9575),Xe=n(5067),Ye=function(){function e(e,t,n,r,i){this._focusManager=null,this._f6Manager=null,this._mouseInputManager=null,this._touchInputManager=null,this._actionManager=null,this._transferFocusToChat=null,this._focusManager=e,this._f6Manager=t,this._mouseInputManager=n,this._touchInputManager=r,this._actionManager=i}return e.prototype.registerF6=function(e,t,n,r){void 0===r&&(r=null);var i=this._focusManager.getScope(t);i.parent=n,i.set_keyDownHandledExternally(!0),r&&i.addOnFocus(r),this._mouseInputManager.addControlFocus(t,e,!1),this._touchInputManager.addControlFocus(t,e,!1);var o=new Qe.DOMFocusListing((function(){return e}));o.addValidTag(2),o.addValidTag(1),o.addValidTag(8),o.addValidTag(5),o.addValidTag(3),o.addValidTag(6),this._focusManager.buildRegionWithDelegate((function(){return e}),i,o).looped=!0;var a=Xe.KeyInputManager.hashKey(Je.v.vK_Tab,0),s=Xe.KeyInputManager.hashKey(Je.v.vK_Tab,4);i.unBindAction(a),i.unBindAction(s)},e.prototype.onFlexPaneOpen=function(e){this.registerF6(e,Ke.meControlFlexPaneFocusId,Ke.headerUiFocusId),this._focusManager.setScope(Ke.meControlFlexPaneFocusId),this._f6Manager.addF6(Ke.meControlFlexPaneFocusId)},e.prototype.onFlexPaneClose=function(e){this._f6Manager.deactivateFocus(Ke.meControlFlexPaneFocusId),this._focusManager.setScope(Ke.headerUiFocusId)},e.prototype.onChatOpen=function(e,t){this._transferFocusToChat||(this._transferFocusToChat=t,this.registerF6(e,Ke.chatFocusId,$e.AFrame.appFocusId,o.i(this,this.onChatFocus,"onChatFocus"))),this._focusManager.setScope(Ke.chatFocusId),this._f6Manager.addF6(Ke.chatFocusId)},e.prototype.onChatFocus=function(e,t){this._transferFocusToChat&&this._transferFocusToChat()},e.prototype.onChatClose=function(){this._f6Manager.deactivateFocus(Ke.chatFocusId),this._focusManager.forceScopeChange($e.AFrame.documentFocusID)},e.prototype.onChatCtrlF6=function(e){this._actionManager.processAction(e?te.Rh:te.UT,2)},e}();(0,o.l)(Ye,"ReactSharedHeaderFocusManager",null,[We]);var Ze=n(12),et=n(1198),tt=n(3409),nt=n(7078),rt=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.registerActions=function(){this._actionManager.addAction(te.Mg,nt.a,o.i(this,this.navigateToUpsellPage,"navigateToUpsellPage")),this._actionManager.addAction(te.Nk,nt.a,o.i(this,this.launchUpsellExperience,"launchUpsellExperience")),this._actionManager.addAction(te.KD,nt.a,Ze.ActionManager.doNothingButReportHandler),this._actionManager.addAction(te.J,nt.a,Ze.ActionManager.doNothingButReportHandler)},e.prototype.navigateToUpsellPage=function(e,t,n,r,i){if(1===n)return 32;var o=8;if(2===n){var a=this.getCommandArgument(i,"experience","gopremiumribbon"),s=tt.n.getFwLinkUrl("2116536");s=tt.n.addParameterValue(s,"ocid",et.x(a)),window.open(s,"_blank"),o=32,this._actionManager.processAction(te.J,2),C.ULS.sendTraceTag(38929747,340,50,"User directed to POC")}return o},e.prototype.launchUpsellExperience=function(e,t,n,r,i){if(1===n)return 32;var o=8;if(2===n){var a=se.w.get_instance().tryResolve(J.a);if(a){var s=this.getCommandArgument(i,"experience","gopremium");a.launchUpsellExperience(s),o=32}else C.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),o=this.navigateToUpsellPage(e,t,n,r,i)}return o},e.prototype.getCommandArgument=function(e,t,n){var r=n,i=e;return i&&i[t]&&(r=(0,f.e)(String,i[t])),r},e}();(0,o.l)(rt,"UpsellActor",null,[Ge]);var it=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.Header"},e.prototype.init=function(){se.w.get_instance().resolve(Ge).registerActions(),se.w.get_instance().resolve(Ve).registerActions()},e.prototype.dispose=function(){},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(je.p).singleInstance(),this._container.register(rt).as(Ge).singleInstance().usingFactory((function(){return new rt(L.AFrameworkApplication.get_theActionManager())})),this._container.register(Ye).as(We).singleInstance().usingFactory((function(){return new Ye(L.AFrameworkApplication.get_activeFrame().get_theFocusManager(),L.AFrameworkApplication.get_activeFrame().get_theF6Manager(),L.AFrameworkApplication.get_activeFrame().get_theMouseInputManager(),L.AFrameworkApplication.get_activeFrame().get_theTouchInputManager(),L.AFrameworkApplication.get_theActionManager())})),this._container.register(qe).as(Ve).singleInstance().usingFactory((function(){return new qe(t._container.resolveLazy(We))}))},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(it,"CommonAppHeaderPackage",null,[l.u,c.s]);var ot=n(9704),at=n(5354),st=(0,o.y)("IBasicChatActor"),lt=(0,o.y)("ISkypeWebExperienceController"),ct=n(9219),ut=(0,o.y)("IFlexPaneFactory"),gt=n(415),pt=n(7951),dt=n(5291),ht=n(3232),_t=n(5648),mt=(0,o.y)("IChatNotificationHandler"),ft=(0,o.y)("IChatToastFactory"),yt=n(3311),Ct=n(8075),St=function(){function e(e,t,n,r,i,o){this._actionManager=null,this._chatClient=null,this._chatClientFactory=null,this._headerEventSourceTask=null,this._headerEventSource=null,this._perfManager=null,this._onBeforeShutdownSubscriber=null,this._appSettingsManager=null,this._disposed=!1,this._unreadConversations=0,this._skypeButton=null,this._secondSkypeButton=null,this._actionManager=e,this._chatClientFactory=t,this._headerEventSourceTask=n,this._perfManager=r,this._onBeforeShutdownSubscriber=i,this._appSettingsManager=o}return e.prototype.initialize=function(){var e=this;this.registerActions(),this.initializeChatClient(),this._onBeforeShutdownSubscriber((function(t,n){e.dispose()}))},e.prototype.onInitializeComplete=function(e){var t=this;e&&this._headerEventSourceTask.CW((function(e){t.chatClientAndHeaderReady()}))},e.prototype.chatClientAndHeaderReady=function(){this._headerEventSource=this._headerEventSourceTask.get_result(),this._headerEventSource.get_topRowControlsCreated()&&this.onTopRowControlsCreatedEventHandler(null,null),this._headerEventSource.add_onTopRowControlsCreated(o.i(this,this.onTopRowControlsCreatedEventHandler,"onTopRowControlsCreatedEventHandler")),this._headerEventSource.add_onTopRowControlsDisposing(o.i(this,this.onTopRowControlsDisposingEventHandler,"onTopRowControlsDisposingEventHandler"))},e.prototype.onTopRowControlsCreatedEventHandler=function(e,t){this.tryEnableSkypeButtonOrButtons(this._headerEventSource.get_standaloneRootControlManager())&&this._chatClient.disable(!1)},e.prototype.onTopRowControlsDisposingEventHandler=function(e,t){this._skypeButton=null,this._secondSkypeButton=null,this._chatClient.disable(!0)},e.prototype.tryEnableSkypeButtonOrButtons=function(e){return!!e&&(this._skypeButton=this.tryEnableButton(e,Ct.CuiHelper.skypeButtonId),this._secondSkypeButton=this.tryEnableButton(e,Ct.CuiHelper.secondSkypeButtonId),this._perfManager.get_userExperienceLoadStopwatch()&&this._perfManager.get_userExperienceLoadStopwatch().stop(),!!this._skypeButton||!!this._secondSkypeButton)},e.prototype.tryEnableButton=function(e,t){var n=null;if(t){try{n=e.getDOMElementForControlDisplayMode(t,Ct.CuiHelper.skypeButtonDisplayMode)}catch(e){C.ULS.sendTraceTag(18465952,333,10,"Couldn't find the button. Basic Chat will be disabled, message: {0} Callstack: {1}.",e.message,e.stack)}n&&(e.pollForControlState(t),n.style.display="",this.updatedUnreadConversationsCount(n,this._unreadConversations))}return n},e.prototype.registerActions=function(){this._actionManager.addAction(te.wg,nt.a,o.i(this,this.toggleChatPane,"toggleChatPane"))},e.prototype.initializeChatClient=function(){var e=this;this._chatClient=this._chatClientFactory.create(null),this._chatClient.add_paneStateChanged(o.i(this,this.onPaneStateChanged,"onPaneStateChanged"));var t=this._chatClient.init();t.CW((function(n){e.onInitializeComplete(t.get_result())})),this._chatClient.add_unreadConversationsChanged(o.i(this,this.onUnreadConversationsChanged,"onUnreadConversationsChanged"))},e.prototype.onPaneStateChanged=function(e,t){this.tryToggleSkypeButton(this._skypeButton),this.tryToggleSkypeButton(this._secondSkypeButton)},e.prototype.onUnreadConversationsChanged=function(e,t){var n=t.unreadConversations;n!==this._unreadConversations&&(this.updatedUnreadConversationsCount(this._skypeButton,n),this.updatedUnreadConversationsCount(this._secondSkypeButton,n),this._unreadConversations=n)},e.prototype.toggleChatPane=function(e,t,n,r,i){return this._disposed?32:2!==n?32:(this._chatClient.get_chatPaneVisible()?this.hideChatPane():this.showChatPane(),32)},e.prototype.showChatPane=function(){this._chatClient.showChatPane()},e.prototype.hideChatPane=function(){this._chatClient.hideChatPane()},e.prototype.tryToggleSkypeButton=function(e){if(e){var t=e.querySelector("img");if(!t)return;var n=void 0,r="";t.getAttribute("class")&&((n=t.getAttribute("class").toString()).indexOf(Ct.CuiHelper.skypeConsumerButtonBlack)>0?r=n.replace(Ct.CuiHelper.skypeConsumerButtonBlack,Ct.CuiHelper.skypeConsumerButtonWhite):n.indexOf(Ct.CuiHelper.skypeConsumerButtonWhite)>0?r=n.replace(Ct.CuiHelper.skypeConsumerButtonWhite,Ct.CuiHelper.skypeConsumerButtonBlack):n.indexOf(Ct.CuiHelper.skypeBusinessButtonBlack)>0?r=n.replace(Ct.CuiHelper.skypeBusinessButtonBlack,Ct.CuiHelper.skypeBusinessButtonWhite):n.indexOf(Ct.CuiHelper.skypeBusinessButtonWhite)>0&&(r=n.replace(Ct.CuiHelper.skypeBusinessButtonWhite,Ct.CuiHelper.skypeBusinessButtonBlack)),r.length&&(t.className=r),this._appSettingsManager.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")||(Sys.UI.DomElement.containsCssClass(e,"activated")?Sys.UI.DomElement.removeCssClass(e,"activated"):Sys.UI.DomElement.addCssClass(e,"activated")))}},e.prototype.updatedUnreadConversationsCount=function(e,t){if(e){t+=0;var n=e.querySelector("."+Ct.CuiHelper.skypeUnreadConversationsBubbleClass);if(n)if(t<=0)n.style.display="none",n.innerText="";else{var r=t>99,i=t.toString();r?(i="99+",Sys.UI.DomElement.containsCssClass(n,"SkypeUCBWide")||Sys.UI.DomElement.addCssClass(n,"SkypeUCBWide")):Sys.UI.DomElement.containsCssClass(n,"SkypeUCBWide")&&Sys.UI.DomElement.removeCssClass(n,"SkypeUCBWide"),n.innerText=i,n.style.display=""}}},e.prototype.dispose=function(){this._disposed||(this._headerEventSource&&(this._headerEventSource.remove_onTopRowControlsCreated(o.i(this,this.onTopRowControlsCreatedEventHandler,"onTopRowControlsCreatedEventHandler")),this._headerEventSource.remove_onTopRowControlsDisposing(o.i(this,this.onTopRowControlsDisposingEventHandler,"onTopRowControlsDisposingEventHandler")),this._headerEventSource=null),this._chatClient&&(this._chatClient.dispose(),this._chatClient=null),this._skypeButton=null,this._secondSkypeButton=null,this._actionManager=null,this._disposed=!0)},e}();(0,o.l)(St,"BasicChatActor",null,[st,Sys.IDisposable]);var vt=function(){function e(e){this._stopwatchBuilder=null,this._chatClientAuthStopwatch=null,this._chatClientLoadStopwatch=null,this._chattableStopwatch=null,this._userExperienceLoadStopwatch=null,this._stopwatchBuilder=e}return e.prototype.get_chatClientAuthStopwatch=function(){return this._chatClientAuthStopwatch||(this._chatClientAuthStopwatch=this._stopwatchBuilder.makeStopwatch("WebServiceCall","SkypeBasicChatClientAuth"))},e.prototype.get_chatClientLoadStopwatch=function(){return this._chatClientLoadStopwatch||(this._chatClientLoadStopwatch=this._stopwatchBuilder.makeStopwatch("LoadResource","SkypeBasicChatClientLoad"))},e.prototype.get_chattableStopwatch=function(){return this._chattableStopwatch||(this._chattableStopwatch=this._stopwatchBuilder.makeStopwatch("CommandTask","SkypeBasicChatTimeToChattable"))},e.prototype.get_userExperienceLoadStopwatch=function(){return this._userExperienceLoadStopwatch||(this._userExperienceLoadStopwatch=this._stopwatchBuilder.makeStopwatch("CommandTask","SkypeUserExperienceLoad"))},e}();(0,o.l)(vt,"BasicChatPerformanceManager",null,[]);var bt=n(4948),Tt=function(){function e(e,t,n,r){this._chatClientMockFactory=null,this._skypeClientFactory=null,this._appSettingsManager=null,this._lastKnownAvailability=null,this._taskManager=null,this._eventSource=new bt.f,this._chatClientMockFactory=t,this._skypeClientFactory=n,this._appSettingsManager=e,this._taskManager=r}return e.prototype.add_availabilityChanged=function(e){this._eventSource.addHandler("ACEK",e)},e.prototype.remove_availabilityChanged=function(e){this._eventSource.removeHandler("ACEK",e)},e.prototype.create=function(t){var n=this;return t&&e._clientInstance?(this._lastKnownAvailability&&this._taskManager.addTask(new De.c(0,1,0,(function(e){t(n._eventSource,n._lastKnownAvailability)}),115)),this.add_availabilityChanged(t),e._clientInstance):(e._clientInstance=this._chatClientMockFactory(),e._clientInstance||(e._clientInstance=this._skypeClientFactory()),e._clientInstance.add_availabilityChanged(o.i(this,this.onAvailabilityChanged,"onAvailabilityChanged")),t&&this.add_availabilityChanged(t),e._clientInstance)},e.prototype.onAvailabilityChanged=function(e,t){this._lastKnownAvailability=t,this._eventSource.raiseEvent("ACEK",t)},e._clientInstance=null,e}();(0,o.l)(Tt,"ChatClientFactory",null,[at.n]);var At=(0,o.y)("IChatClient"),It=n(6372),wt=n(2607),xt=function(){function e(){}return e.prototype.createDomElementAppendToParent=function(e,t){var n=document.createElement(t);return e.appendChild(n),n},e.skypeToastManagerClass="SkypeToastManagerContainer",e.skypeToastDivClass="SkypeToastDiv",e.skypePresenceAreaClass="SkypePresenceArea",e.skypePresenceClass="SkypePresenceIndicator",e.skypePresenceClass_Unknown="skPresenceUnknown",e.skypePresenceClass_Available="skPresenceAvailable",e.skypePresenceClass_Away="skPresenceAway",e.skypePresenceClass_Busy="skPresenceBusy",e.skypePresenceImageClass="SkypePresenceImage",e.skypeNotificationAreaClass="SkypeNotificationArea",e.skypeNotificationTopBar="SkypeNotificationTopBar",e.skypeNotificationTextClass="SkypeNotificationText",e.skypeNotificationSenderClass="SkypeNotificationSender",e.skypeNotificationTitleClass="SkypeNotificationTitle",e.skypeNotificationMessageClass="SkypeNotificationMessage",e.skypeNotificationTypeClass="SkypeNotificationType",e.skypeNotificationActionAreaClass="SkypeNotificationActionArea",e.skypeNotificationButtonClass="SkypeNotificationButton",e}();(0,o.l)(xt,"SkypeToastDomObjectBase",null,[]);var Ft=function(e){function t(t,n){var r=e.call(this)||this;return r._toastContainerLazy=null,r._lastToast=null,r._getAppContainer=null,r._toastFactory=null,r._chatNotificationsTemporarilyDisabled=!1,r._getAppContainer=t,r._toastContainerLazy=new yt.q(Object,o.i(r,r.renderToastContainer,"renderToastContainer")),r._toastFactory=n,r}return(0,S.t)(t,e),t.prototype.renderToastContainer=function(){var e=this._getAppContainer(),t=this.createDomElementAppendToParent(e,"div");return Sys.UI.DomElement.addCssClass(t,xt.skypeToastManagerClass),t},t.prototype.handleNotification=function(e,t){var n=e;if(C.ULS.shipAssertTag(17114644,333,!!n),this.canHandleNotification(n,t))if(this.shouldShowToast(n,t)){var r=this._toastFactory.create(t);r.add_onDismiss(o.i(this,this.onToastDismiss,"onToastDismiss")),this.addNewToast(r)}else this.shouldPlaySound(t)&&t.playSound&&t.playSound()},t.prototype.disable=function(e){this._chatNotificationsTemporarilyDisabled=e},t.prototype.addNewToast=function(e){this.dismissLastToast(),this.toggleToastContainerDisplay(!0),this._toastContainerLazy.get_value().appendChild(e.get_element()),this._lastToast=e},t.prototype.dismissLastToast=function(){this._lastToast&&(C.ULS.sendTraceTag(17114645,333,100,"About to show new toast over existing one..."),this._lastToast.dismiss())},t.prototype.canHandleNotification=function(e,t){return!this._chatNotificationsTemporarilyDisabled&&(3!==e.get_chatClientState()&&(!!t.type&&(!this.get_currentlyShowingStickyToast()||(C.ULS.sendTraceTag(17114646,333,100,"Ignoring new [{0}] notification while last A/V toast is still up...",t.type),!1))))},t.prototype.shouldPlaySound=function(e){return!0},t.prototype.shouldShowToast=function(e,t){var n;switch(t.level){case 0:n=!1;break;case 1:n=!e.get_chatPaneVisible();break;case 2:n=!0;break;default:n=!1}return C.ULS.sendTraceTag(17118549,333,100,"{0}toast for notification level {1}. Chat Pane was visible: {2}.",n?"SHOW ":"SKIP ",t.level,e.get_chatPaneVisible()),n},t.prototype.get_currentlyShowingStickyToast=function(){return!!this._lastToast&&this._lastToast.get_sticky()},t.prototype.toggleToastContainerDisplay=function(e){this._toastContainerLazy.get_value().style.display=e?"block":"none"},t.prototype.onToastDismiss=function(e,t){this._lastToast&&(this._toastContainerLazy.get_value().removeChild(this._lastToast.get_element()),this._lastToast.dispose(),this._lastToast=null),this.toggleToastContainerDisplay(!1)},t.prototype.dispose=function(){this.dismissLastToast()},t.parseNotificationType=function(e){switch(e.toLowerCase()){case"unreadmessage":return 1;case"chat":return 2;case"audio":return 3;case"contactrequest":return 4;default:return 0}},t}(xt);(0,o.l)(Ft,"SkypeToastManager",xt,[mt,Sys.IDisposable]);var Et=function(e){function t(t){var n=e.call(this)||this;return n.clientState=0,n.clientState=t,n}return(0,S.t)(t,e),t.prototype.get_clientState=function(){return this.clientState},t}(Sys.EventArgs);(0,o.l)(Et,"AvailabilityChangedEventArgs",Sys.EventArgs,[]);var Pt=function(e){function t(){var t=e.call(this)||this;return t.type=0,t.avatar=null,t.displayName=null,t.presence=null,t.title=null,t.description=null,t.accept=null,t.acceptWithModality=null,t.open=null,t.decline=null,t.playSound=null,t.stopSound=null,t.subscribeToActiveStateChanged=null,t.level=0,t}return(0,S.t)(t,e),t}(Sys.EventArgs);(0,o.l)(Pt,"ChatNotificationEventArgs",Sys.EventArgs,[]);var kt=function(e){function t(t){var n=e.call(this)||this;return n.paneState=0,n.paneState=t,n}return(0,S.t)(t,e),t.prototype.get_paneState=function(){return this.paneState},t}(Sys.EventArgs);(0,o.l)(kt,"PaneStateChangedEventArgs",Sys.EventArgs,[]);var Dt=n(4125),Mt=function(){function e(e,t){this._flexPaneFactory=null,this._chatNotificationHandler=null,this._flexPane=null,this._textBox=null,this._chatClientState=0,this._chatClientStateBeforeDisabled=0,this._btnSendNotification1=null,this._btnSendNotification2=null,this.chatPane=null,this._eventSource=new bt.f,this._initializeTcs=new wt.z(Boolean),this._flexPaneFactory=e,this._chatNotificationHandler=t,this.set_chatClientState(0)}return e.prototype.get_idAsync=function(){return It.Task.fromResult(String,L.AFrameworkApplication.userSessionId)},e.prototype.get_chatPane=function(){return this.chatPane},e.prototype.get_chatClientState=function(){return this._chatClientState},e.prototype.set_chatClientState=function(e){return this._chatClientState!==e&&(this._chatClientState=e,this._eventSource.raiseEvent("cam",new Et(this.get_chatClientState()))),e},e.prototype.get_chatPaneVisible=function(){return!!this._flexPane&&this._flexPane.get_visible()},e.prototype.set_chatPaneVisible=function(e){return this._flexPane?this._flexPane.get_visible()!==e&&(this._flexPane.set_visible(e),this._eventSource.raiseEvent("PSCH",new kt(e?1:0))):e&&C.ULS.sendTraceTag(8782405,333,15,"Trying to set visible while flexpane is null"),e},e.prototype.add_availabilityChanged=function(e){this._eventSource.addHandler("cam",e)},e.prototype.remove_availabilityChanged=function(e){this._eventSource.removeHandler("cam",e)},e.prototype.add_paneStateChanged=function(e){this._eventSource.addHandler("PSCH",e)},e.prototype.remove_paneStateChanged=function(e){this._eventSource.removeHandler("PSCH",e)},e.prototype.add_unreadConversationsChanged=function(e){this._eventSource.addHandler("unreadConvEventKey",e)},e.prototype.remove_unreadConversationsChanged=function(e){this._eventSource.removeHandler("unreadConvEventKey",e)},e.prototype.get_id=function(){return It.Task.fromResult(String,Dt.h.create().toString())},e.prototype.init=function(){return this.ensureSkypePane(),this.set_chatClientState(2),this._eventSource.raiseEvent("cam",new Et(2)),this._initializeTcs.setResult(!0),this._initializeTcs.get_task()},e.prototype.showChatPane=function(){this.set_chatPaneVisible(!0),this.get_chatPaneVisible()||this.set_chatPaneVisible(!0)},e.prototype.ensureSkypePane=function(){this._flexPane||(this._flexPane=this._flexPaneFactory.create("Mock Chat Pane",null,null,te.wg),this.ensureMockDom())},e.prototype.ensureMockDom=function(){var e=document.createElement("div");e.innerText="Notification types: unreadmessage | chat | contactrequest | audio\n\n",e.innerText+="Type in the mock notif type:\n",this._flexPane.get_element().appendChild(e),this._textBox=document.createElement("input"),this._textBox.style.width="100px",this._textBox.style.display="block",this._flexPane.get_element().appendChild(this._textBox);var t=document.createElement("div");t.innerText="\n",this._flexPane.get_element().appendChild(t),this._btnSendNotification1=document.createElement("button"),this._btnSendNotification1.id="chatNotif",this._btnSendNotification1.innerText="Send Chat Notification",this._flexPane.get_element().appendChild(this._btnSendNotification1),$addHandler(this._btnSendNotification1,"mousedown",o.i(this,this.fireMockNotification,"fireMockNotification")),this._flexPane.get_element().appendChild(t),this._btnSendNotification2=document.createElement("input"),this._btnSendNotification2.id="hideThenChatNotif",this._btnSendNotification2.type="button",this._btnSendNotification2.value="Dismiss then Send Chat Notif",this._flexPane.get_element().appendChild(this._btnSendNotification2),$addHandler(this._btnSendNotification2,"mousedown",o.i(this,this.hideThenFireMockNotification,"hideThenFireMockNotification"))},e.prototype.hideThenFireMockNotification=function(e){var t=this;this.hideChatPane(),window.setTimeout((function(){t.fireMockNotification(null)}),0),e.stopPropagation()},e.prototype.fireMockNotification=function(e){var t=this;e.stopPropagation();var n=Ft.parseNotificationType(this._textBox.value),r=(0,O.m)(new Pt,{type:n,avatar:null,displayName:"mock name",presence:null,title:"mock title",description:"mock description",accept:function(){t.showChatPane(),t.logString("notification accepted")},acceptWithModality:function(e){t.showChatPane(),t.logString("notification accepted with "+e)},open:function(){t.showChatPane(),t.logString("notification opened")},decline:function(){t.logString("notification declined")},playSound:function(){t.logString("notification sound played")},stopSound:function(){t.logString("notification sound stopped")},subscribeToActiveStateChanged:function(e){},level:1===n?0:2});this._chatNotificationHandler.handleNotification(this,r)},e.prototype.hideChatPane=function(){this.set_chatPaneVisible(!1)},e.prototype.joinConversation=function(e,t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null),this.logString(String.format("Trying to join conversation {0}",e)),"mockChatThread"===e&&t()},e.prototype.disable=function(e){e?(this._chatClientStateBeforeDisabled=this.get_chatClientState(),this.set_chatClientState(3),this.hideChatPane()):3===this.get_chatClientState()&&this.set_chatClientState(this._chatClientStateBeforeDisabled)},e.prototype.logString=function(e){if(this._flexPane&&this._flexPane.get_element()){var t=document.createElement("div");t.innerText=e+"\n",this._flexPane.get_element().appendChild(t)}else alert(String.format("Mock Chat Client: {0}",e))},e.prototype.dispose=function(){this._flexPane&&(this.hideChatPane(),$removeHandler(this._btnSendNotification1,"mousedown",o.i(this,this.fireMockNotification,"fireMockNotification")),$removeHandler(this._btnSendNotification2,"mousedown",o.i(this,this.hideThenFireMockNotification,"hideThenFireMockNotification")),this._flexPane=null),this._chatNotificationHandler&&(this._chatNotificationHandler.dispose(),this._chatNotificationHandler=null)},e.getAnInstance=function(t,n,r){return 3===t.getIntAppSetting("SkypeExperience",0)?new e(n,r):null},e}();(0,o.l)(Mt,"ChatClientMock",null,[At,Sys.IDisposable]);var Rt=(0,o.y)("IFlexPane"),Lt=n(4248),Nt=n(4917),Bt=n(1210),Ot=n(8805),Ut=function(){function e(e,t,n,r,i,o,a,s,l,c,u){this._flexPaneFocusScope=null,this._focusManager=null,this._f6Manager=null,this._mouseInputManager=null,this._touchInputManager=null,this._clickInputManager=null,this._keyInputManager=null,this._appFrame=null,this._container=null,this._appFramePane=null,this._onFocus=null,this._onBlur=null,this._escapeActionId=0,this._visible=!1,this._escapeKeyHash=null,this._closeButtonEnabled=!1,this._closeIcon=null,this._closeButton=null,this._anchorClose=null,this._topBar=null,this._pane=null,this._closeTitle=null,this.element=null,this._focusManager=e,this._f6Manager=t,this._mouseInputManager=n,this._touchInputManager=r,this._clickInputManager=i,this._keyInputManager=o,this._appFrame=a,this._container=a.get_element().parentNode,this._appFramePane=a.get_element(),this._onFocus=l,this._onBlur=c,this._escapeActionId=u,this._escapeKeyHash=Xe.KeyInputManager.hashKey(Je.v.vK_Escape,0),this._closeButtonEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")&&!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled(),this.ensureDom(s)}return e.prototype.get_visible=function(){return this._visible},e.prototype.set_visible=function(e){return e===this._visible?e:(this.toggle(e),this._visible=e,e)},e.prototype.get_element=function(){return this.element},e.prototype.ensureGroupChatButton=function(){this._closeButtonEnabled&&(this._closeTitle=document.createElement("span"),this._closeTitle.className="cui-taskPaneTitle",this._closeTitle.innerText=CommonUIStrings.l_ChatTooltip,this._anchorClose=document.createElement("a"),this._anchorClose.tabIndex=0,this._anchorClose.className="cui-taskPaneClose cui-ctl",this._anchorClose.title=CommonUIStrings.l_DialogClose,this._anchorClose.style.position="absolute",this._anchorClose.style.right="0px",this._anchorClose.setAttribute(Ot.t.ariaRoleAttribute,Ot.t.ariaButtonRole),this._clickInputManager.registerHandler(Le.d.click,this._anchorClose,o.i(this,this.hide,"hide")),this._keyInputManager.registerHandler(Le.d.keyUp,this._anchorClose,o.i(this,this.onKeyHide,"onKeyHide")),this._closeButton=document.createElement("span"),this._closeButton.className="cui-taskPaneCloseButton cui-ctl-iconContainer",this._closeIcon=Lt.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","",!0,""),this._closeButton.appendChild(this._closeIcon),this._anchorClose.appendChild(this._closeButton),this._topBar=document.createElement("div"),this._topBar.className="cui-flexPaneTitle",this._topBar.appendChild(this._closeTitle),this._topBar.appendChild(this._anchorClose),this._pane.appendChild(this._topBar))},e.prototype.ensureDom=function(t){if(!this.get_element()){var n=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled();this._closeButtonEnabled&&(this._pane=document.createElement("div"),this._pane.className="cui-flexpane"),this.element=document.createElement("div"),this.get_element().id=e.flexPaneId,this.get_element().className=e.flexPaneClassName+(n?" FlexBoxLayout":""),this.get_element().style.display="none",this.get_element().tabIndex=0,Ot.t.setAriaAttribute(this.get_element(),Ot.t.ariaRoleAttribute,Ot.t.ariaRegionRole),Ot.t.setAriaAttribute(this.get_element(),Ot.t.ariaLabelAttribute,t),this.ensureGroupChatButton(),n?this._closeButtonEnabled?(this.get_element().style.height="100%",this._pane.appendChild(this.get_element()),this._appFramePane.parentNode.appendChild(this._pane)):this._appFramePane.parentNode.appendChild(this.get_element()):this._container.insertBefore(this.get_element(),this._appFramePane),this.ensureFocusScope()}},e.prototype.onKeyHide=function(e){var t=e.innerEvent.keyCode;return(t===Sys.UI.Key.enter||t===Sys.UI.Key.space)&&(this.set_visible(!1),!0)},e.prototype.hide=function(e){return C.ULS.sendTraceTag(40969411,333,50,"Chat pane closed with X"),this.set_visible(!1),!0},e.prototype.toggle=function(t){t?(this.get_element().style.display="block",this._closeButtonEnabled&&(this._pane.style.display="flex"),Sys.UI.DomElement.addCssClass(this._appFramePane,e.flexPaneUpClassName),this._f6Manager.activateFocus(e.flexPaneFocusId),this._focusManager.pushScope(e.flexPaneFocusId,!0)):(this.get_element().style.display="none",this._closeButtonEnabled&&(this._pane.style.display="none"),Sys.UI.DomElement.removeCssClass(this._appFramePane,e.flexPaneUpClassName),this._f6Manager.deactivateFocus(e.flexPaneFocusId),this._focusManager.popScope(e.flexPaneFocusId)),this._appFrame.notifyResize(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&this.fireWindowResizeEvent()},e.prototype.fireWindowResizeEvent=function(){if(window.document.dispatchEvent){var e=null;window.document.createEvent&&(e=window.document.createEvent("UIEvents")).initUIEvent("resize",!0,!0,Bt.g.getParentWindow(window.document),0),e&&window.document.dispatchEvent(e)}},e.prototype.ensureFocusScope=function(){var t=this;this._flexPaneFocusScope||(this._flexPaneFocusScope=this._focusManager.getScope(e.flexPaneFocusId),this._flexPaneFocusScope.parent=$e.AFrame.mainAppFocusId,this._flexPaneFocusScope.addOnFocus((function(e,n){Nt.FocusManager.tryFocus(t.get_element()),t._onFocus&&t._onFocus()})),this._onBlur&&this._flexPaneFocusScope.addOnBlur((function(e,n){t._onBlur()})),this._flexPaneFocusScope.bindAction(this._escapeKeyHash,this._escapeActionId),this._mouseInputManager.addControlFocus(e.flexPaneFocusId,this.get_element(),!1,!0),this._touchInputManager.addControlFocus(e.flexPaneFocusId,this.get_element(),!1,!0),this._f6Manager.addF6(e.flexPaneFocusId))},e.prototype.dispose=function(){this._container.removeChild(this.get_element()),this.element=null,this._appFrame=null,this._flexPaneFocusScope.unBindAction(this._escapeKeyHash),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PeoplesWellExtraButtonInfoIsEnabled")&&(this._clickInputManager.unregisterHandler(Le.d.click,this._anchorClose,o.i(this,this.hide,"hide")),this._keyInputManager.unregisterHandler(Le.d.keyUp,this._anchorClose,o.i(this,this.onKeyHide,"onKeyHide")))},e.flexPaneClassName="FlexPane",e.flexPaneUpClassName="FlexPaneUp",e.flexPaneFocusId="FlexPane",e.flexPaneId="FlexPane",e}();(0,o.l)(Ut,"FlexPane",null,[Rt,Sys.IDisposable]);var Ht=function(){function e(e,t,n,r,i,o,a){this._appFrameLazy=null,this._focusManagerLazy=null,this._f6ManagerLazy=null,this._mouseInputManagerLazy=null,this._touchInputManagerLazy=null,this._clickInputManagerLazy=null,this._keyInputManagerLazy=null,this._focusManagerLazy=e,this._f6ManagerLazy=t,this._mouseInputManagerLazy=n,this._touchInputManagerLazy=r,this._clickInputManagerLazy=i,this._keyInputManagerLazy=o,this._appFrameLazy=a}return e.prototype.create=function(e,t,n,r){return new Ut(this._focusManagerLazy.get_value(),this._f6ManagerLazy.get_value(),this._mouseInputManagerLazy.get_value(),this._touchInputManagerLazy.get_value(),this._clickInputManagerLazy.get_value(),this._keyInputManagerLazy.get_value(),this._appFrameLazy.get_value(),e,t,n,r)},e}();(0,o.l)(Ht,"Factory$6",null,[ut]);var Gt=function(){return function(e,t,n,r){this.displayName=null,this.conferenceUri=null,this.discoverUri=null,this.discoveryUri=null,this.useInternalAnonFlow=!1,this.displayName=e,this.conferenceUri=t,this.discoverUri=n,this.discoveryUri=n,this.useInternalAnonFlow=r}}();(0,o.l)(Gt,"SkypeAnonymousJoinOptions",null,[]);var Vt=function(){return function(e,t,n,r,i,o){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.type=null,this.username=null,this.password=null,this.token=null,this.product=null,this.options=null,this.type=e,this.username=t,this.password=n,this.token=r,this.product=i,this.options=o}}();(0,o.l)(Vt,"SkypeAuth",null,[]);var Wt=function(){function e(e,t,n,r){this.experience=0,this.culture=null,this.workload=null,this.userid=null,this.sessionid=null,this.tabid=null,this.experience=e,this.culture=t,this.workload=n,this.sessionid=r}return e.prototype.get_experience=function(){return this.experience},e.prototype.get_culture=function(){return this.culture},e}();(0,o.l)(Wt,"SkypeSettings",null,[]);var zt=function(e){function t(t){var n=e.call(this)||this;return n.unreadConversations=0,n.unreadConversations=t,n}return(0,S.t)(t,e),t}(Sys.EventArgs);(0,o.l)(zt,"UnreadConversationsChangedEventArgs",Sys.EventArgs,[]);var Kt=n(4404),qt=function(){function e(e,t,n,r,i,o,a){this._chatClientState=0,this._chatClientStateOverridenWhileDisabled=0,this._skypeApi=null,this._eventSource=null,this._loader=null,this._flexPaneFactory=null,this._flexPane=null,this._initialized=!1,this._uxController=null,this._basicChatCapabilities=null,this._perfManager=null,this._chatNotificationHandler=null,this._waitingForAnonymousSignInConfirmation=!1,this._applicationInstance=null,this._appSettingsManager=null,this._initializeTcs=new wt.z(Boolean),this._userIdTcs=new wt.z(String),this._applicationInstance=e,this._appSettingsManager=t,this._loader=r,this._eventSource=new bt.f,this._flexPaneFactory=n,this._uxController=i,this._perfManager=o,this._chatNotificationHandler=a,this._chatClientState=0}return e.prototype.get_idAsync=function(){return this._userIdTcs.get_task()},e.prototype.get_chatPaneVisible=function(){return!!this._flexPane&&this._flexPane.get_visible()},e.prototype.set_chatPaneVisible=function(e){return this._flexPane?this._flexPane.get_visible()!==e&&(this._flexPane.set_visible(e),this._eventSource.raiseEvent("PSCH",new kt(e?1:0))):e&&C.ULS.sendTraceTag(8728835,333,10,"Trying to set visible while flexpane is null"),e},e.prototype.add_paneStateChanged=function(e){this._eventSource.addHandler("PSCH",e)},e.prototype.remove_paneStateChanged=function(e){this._eventSource.removeHandler("PSCH",e)},e.prototype.add_unreadConversationsChanged=function(e){this._eventSource.addHandler("unreadConvEventKey",e)},e.prototype.remove_unreadConversationsChanged=function(e){this._eventSource.removeHandler("unreadConvEventKey",e)},e.prototype.showChatPane=function(){this._skypeApi?(this.ensureSkypePaneInternal(),this.set_chatPaneVisible(!0)):C.ULS.sendTraceTag(8696157,333,10,"SkypeApi is null so will not render content.")},e.prototype.ensureSkypePaneInternal=function(){var e=this;if(!this._flexPane){this._flexPane=this._flexPaneFactory.create(CommonUIStrings.l_SkypeTooltip,(function(){e._skypeApi.setFocus(!0)}),(function(){e._skypeApi.setFocus(!1)}),te.wg),C.ULS.sendTraceTag(8696156,333,15,"Setting Chat pane to visible and attempting to create the divs."),this.createContentAndTimelineDiv();try{this._skypeApi.renderContent("#SkypePaneContent"),this._skypeApi.renderSidebar("#SkypePaneTimeline")}catch(e){C.ULS.sendTraceTag(8728836,333,10,"Failure to render the skype api. Message: {0}, Callstack: {1}",e.message,e.stack)}}},e.prototype.hideChatPane=function(){this.set_chatPaneVisible(!1)},e.prototype.init=function(){var e=this;if(this._initialized)return this._initializeTcs.get_task();this._initialized=!0,this._basicChatCapabilities=this._uxController.get_capabilitiesAsync().get_result();var t=this._uxController.get_experience();1===t&&(C.ULS.sendTraceTag(8757720,333,50,"Starting skype experience for Consumers users."),window.setTimeout((function(){C.ULS.sendTraceTag(18655443,333,50,"Starting skype experience for Consumer users with longer sessions.")}),15e3)),2===t&&(C.ULS.sendTraceTag(8757721,333,50,"Starting skype experience for Enterprise users."),window.setTimeout((function(){C.ULS.sendTraceTag(18655444,333,50,"Starting skype experience for Enterprise users with longer sessions.")}),15e3));var n=this._appSettingsManager.get_appSettings().SkypeBootstrapUrl.toString(),r=this._appSettingsManager.get_appSettings().SkypeApiKey.toString(),i=this.buildSkypeSettings(t);this._perfManager.get_chatClientLoadStopwatch().start();var o=this._loader.load(n,r,!1,i);return o.CW((function(t){e.onLoadFinished(o.get_result())})),this._initializeTcs.get_task()},e.prototype.buildSkypeSettings=function(e){var t=Kt.i.getCultureInfo(this._appSettingsManager.getIntAppSetting("Lcid",1033)),n=t?t.get_name():null,r=this.buildWorkloadString(),i=this._appSettingsManager.get_appSettings().SessionId;return new Wt(e,n,r,i)},e.prototype.buildWorkloadString=function(){var e;switch(this._applicationInstance.get_officeAppType()){case 3:e="Word";break;case 4:e="OneNote";break;case 1:e="Excel";break;case 2:e="PowerPoint";break;default:e="UnknownWAC"}switch(this._applicationInstance.get_officeAppMode()){case 1:e+=" Edit";break;case 2:e+=" View"}return e},e.prototype.onLoadFinished=function(e){if(e){if(this._perfManager.get_chatClientLoadStopwatch()&&this._perfManager.get_chatClientLoadStopwatch().stop(),this._skypeApi=e,C.ULS.sendTraceTag(8696158,333,50,"The Skype api version we are using is: {0}.",this._skypeApi.getVersion()),!this._skypeApi.isAvailable())return C.ULS.sendTraceTag(17440902,333,50,"The Skype api is not available for this browser."),this.updateChatClientState(1),void this._initializeTcs.setResult(!0);this._basicChatCapabilities.get_fullExperienceIsEnabled()?this.authenticateUser():this._basicChatCapabilities.get_anonymousExperienceSupport()&&this.updateChatClientState(4),this.subscribeToNotifications(),this._initializeTcs.setResult(!0)}else C.ULS.sendTraceTag(8947682,333,10,"Skype client unavailable. Failed to initialize SWX api."),this.updateChatClientState(0),this._initializeTcs.setResult(!1)},e.prototype.authenticateUser=function(){this.updateChatClientState(1),this.trackUserId(),this.trackAuthenticationState();try{C.ULS.sendTraceTag(8947683,333,50,"Calling Skype Api auth provider for implicit auth."),this._perfManager.get_chatClientAuthStopwatch().start(),this._skypeApi.setAuthProvider(new Vt("implicitOAuth"),o.i(this,this.onAuthSuccess,"onAuthSuccess"),o.i(this,this.onAuthFailure,"onAuthFailure"))}catch(e){C.ULS.sendTraceTag(8947712,333,10,"Error setting auth provider {0}. Callstack: {1}.",e.message,e.stack)}},e.prototype.trackAuthenticationState=function(){var e=this;this._skypeApi.get_me().authenticated.subscribe((function(t){t?(e.updateChatClientState(2),C.ULS.sendTraceTag(8947713,333,50,"Authenticated and setting signed in.")):(e.updateChatClientState(1),C.ULS.sendTraceTag(8947714,333,10,"Skype authentication error, authentication failed or disconnected from SWX."))}))},e.prototype.trackUserId=function(){var e=this;this._skypeApi.get_me().uri.subscribe((function(t){t?(C.ULS.sendTraceTag(8947716,333,50,"Successfully got an user identifier from Skype client."),e._userIdTcs.setResult(t)):C.ULS.sendTraceTag(8947715,333,10,"Skype client lost the user URI!")}))},e.prototype.onAuthSuccess=function(){this.updateChatClientState(2),C.ULS.sendTraceTag(8947717,333,50,"Authentication is successful."),this.endPerfMeasurement()},e.prototype.onAuthFailure=function(e){this.updateChatClientState(1),this.logAuthenticationFailure(e)},e.prototype.logAuthenticationFailure=function(e){this._uxController.get_isAuthFailureUnexpected()?G.y.get_isInternetExplorerOrEdge()?C.ULS.sendTraceTag(17126927,333,10,"Skype authentication failing for Internet Explorer. Error: {0}",e):C.ULS.sendTraceTag(8947718,333,10,"Skype authentication failing. Error: {0}",e):C.ULS.sendTraceTag(16831619,333,15,"MSIT user failed to authenticate with Skype. Error: {0}",e)},e.prototype.authenticateAnonymous=function(e,t,n,r,i){var o=this;r?i?(e||C.ULS.sendTraceTag(17846557,333,15,"Attempting to sign in  anonymously without a user friendly name..."),this.trackAnonymousSignInState(),this._perfManager.get_chatClientAuthStopwatch().start(),C.ULS.sendTraceTag(18200788,333,15,"Start anonymous sign in."),this._waitingForAnonymousSignInConfirmation=!0,this._skypeApi.setAuthProvider(new Vt("anonymous",void 0,void 0,void 0,void 0,new Gt(e,i,r,!0)),(function(){o._waitingForAnonymousSignInConfirmation=!1,o.onAnonymousAuthSuccess(),t()}),(function(e){o._waitingForAnonymousSignInConfirmation=!1,o.onAnonymousAuthFailure(e),n()}))):C.ULS.sendTraceTag(17846556,333,10,"Cannot attempt to sign in  anonymously with conversation uri being null or empty."):C.ULS.sendTraceTag(17846555,333,10,"Cannot attempt to sign in anonymously with conversation discovery uri being null or empty.")},e.prototype.trackAnonymousSignInState=function(){var e=this;this._skypeApi.get_me().authenticated.subscribe((function(t){t?(e.updateChatClientState(5),C.ULS.sendTraceTag(18121751,333,50,"Successfully authenticated as ANONYMOUS and setting state to AnonymousChatConnected.")):(e.updateChatClientState(4),C.ULS.sendTraceTag(18121752,333,10,"Skype authentication error, ANONYMOUS authentication failed or got disconnected."))}))},e.prototype.onAnonymousAuthSuccess=function(){this.updateChatClientState(5),C.ULS.sendTraceTag(17846558,333,50,"Skype anonymous authentication was successful."),this.endPerfMeasurement()},e.prototype.onAnonymousAuthFailure=function(e){this.updateChatClientState(4),C.ULS.sendTraceTag(17846559,333,10,"Skype anonymous authentication failed. Error: {0}",e)},e.prototype.add_availabilityChanged=function(e){this._eventSource.addHandler("availEventKey",e)},e.prototype.remove_availabilityChanged=function(e){this._eventSource.removeHandler("availEventKey",e)},e.prototype.get_chatClientState=function(){return this._chatClientState},e.prototype.updateChatClientState=function(e,t){void 0===t&&(t=!1),t||3!==this._chatClientState?this._chatClientState!==e&&(this._chatClientState=e,this._eventSource.raiseEvent("availEventKey",new Et(this.get_chatClientState())),C.ULS.sendTraceTag(17052561,333,50,"client state {0}",e)):this._chatClientStateOverridenWhileDisabled=e},e.prototype.joinConversation=function(e,t,n,r,i){var o=this;if(void 0===r&&(r=null),void 0===i&&(i=null),!e)return C.ULS.sendTraceTag(16832196,333,50,"Not performing join operation as convUri is null"),void n();2===this.get_chatClientState()||5===this.get_chatClientState()?this.joinConversationInternal(e,t,n):4===this.get_chatClientState()?this._waitingForAnonymousSignInConfirmation||this.authenticateAnonymous(r,(function(){o.joinConversationInternal(e,t,n)}),n,i,e):(C.ULS.sendTraceTag(18900673,333,50,"Cannot perform join operation when client is not signed in!"),n())},e.prototype.joinConversationInternal=function(e,t,n){1===this._uxController.get_experience()?C.ULS.sendTraceTag(18699104,333,15,"Joining Conversation for Consumer"):C.ULS.sendTraceTag(18699105,333,15,"Joining Conversation for Business");var r=1===this._uxController.get_experience()?String.format("19:{0}",e):e;this._skypeApi.joinConversation(r,t,n)},e.prototype.disable=function(e){e?(this._chatClientStateOverridenWhileDisabled=this.get_chatClientState(),this.updateChatClientState(3,!0),this.hideChatPane()):3===this.get_chatClientState()&&this.updateChatClientState(this._chatClientStateOverridenWhileDisabled,!0)},e.prototype.createContentAndTimelineDiv=function(){if(this._flexPane.get_element()){var e=document.createElement("div");Sys.UI.DomElement.addCssClass(e,"ChatPane"),Sys.UI.DomElement.addCssClass(e,"skypeWX"),Sys.UI.DomElement.addCssClass(e,"Selectable"),!this._basicChatCapabilities.get_fullExperienceIsEnabled()&&this._basicChatCapabilities.get_anonymousExperienceSupport()&&Sys.UI.DomElement.addCssClass(e,"DocChatOnly"),this._flexPane.get_element().appendChild(e),this.createContentElement(e),this.createTimelineElement(e)}else C.ULS.sendTraceTag(8696159,333,10,"Failed to get chatpane Element so not creating content and timeline divs.")},e.prototype.subscribeToNotifications=function(){this._skypeApi.get_activity().unreadConversations.subscribe(o.i(this,this.onUnreadConversationsChanged,"onUnreadConversationsChanged")),this._skypeApi.setNotificationHandler(o.i(this,this.onSkypeNativeNotification,"onSkypeNativeNotification"))},e.prototype.onUnreadConversationsChanged=function(e){3!==this.get_chatClientState()&&this._eventSource.raiseEvent("unreadConvEventKey",new zt(e))},e.prototype.onSkypeNativeNotification=function(t){var n=this;if(3!==this.get_chatClientState()){var r=Ft.parseNotificationType(t.type),i=(0,O.m)(new Pt,{type:r,avatar:t.sender.avatar(),displayName:t.sender.displayName(),presence:t.sender.status(),title:t.title(),description:t.description(),accept:function(){n.showChatPane(),t.accept()},acceptWithModality:function(e){n.showChatPane(),t.accept(e)},open:function(){n.showChatPane(),t.open()},decline:function(){t.decline()},playSound:function(){t.sound.play()},stopSound:function(){t.sound.stop()},subscribeToActiveStateChanged:function(e){t.active.subscribe(e)},level:e.getChatNotificationLevel(r,this._uxController.get_experience())});this._chatNotificationHandler.handleNotification(this,i)}},e.prototype.createContentElement=function(e){var t=document.createElement("div");return t.className="ChatContent",t.id="SkypePaneContent",e.appendChild(t),t},e.prototype.createTimelineElement=function(e){var t=document.createElement("div");return t.id="SkypePaneTimeline",t.className="ChatTimeline",e.appendChild(t),t},e.prototype.endPerfMeasurement=function(){this._perfManager.get_chatClientAuthStopwatch()&&this._perfManager.get_chatClientAuthStopwatch().stop(),this._perfManager.get_chattableStopwatch()&&this._perfManager.get_chattableStopwatch().stop()},e.prototype.dispose=function(){this.hideChatPane(),this._chatNotificationHandler&&(this._chatNotificationHandler.dispose(),this._chatNotificationHandler=null),this._skypeApi=null,this._flexPane=null},e.getChatNotificationLevel=function(e,t){var n;switch(e){case 2:case 4:case 3:n=2;break;default:n=1}return n},e}();(0,o.l)(qt,"SkypeChatClient",null,[At,Sys.IDisposable]);var jt=function(){function e(e){this.me=null,this.activity=null,this.skypeNativeApi=null,this.skypeNativeApi=e,this.me=this.skypeNativeApi.me,this.activity=this.skypeNativeApi.activity}return e.prototype.get_me=function(){return this.me||C.ULS.sendTraceTag(17105566,333,10,"Skype Native Contact ME is null."),this.me},e.prototype.get_activity=function(){return this.activity||C.ULS.sendTraceTag(17105567,333,10,"Skype Native Contact activity is null"),this.activity},e.prototype.getVersion=function(){try{return this.skypeNativeApi.getVersion()}catch(e){return C.ULS.sendTraceTag(8947681,333,10,"Skype GetVersion error. Message: {0}, Callstack: {1}",e.message,e.stack),""}},e.prototype.isAvailable=function(){try{return this.skypeNativeApi.isAvailable()}catch(e){return C.ULS.sendTraceTag(17440901,333,10,"Skype IsAvailable error. Message: {0}, Callstack: {1}",e.message,e.stack),!1}},e.prototype.renderContent=function(e){try{this.skypeNativeApi.renderContent(e)}catch(e){C.ULS.sendTraceTag(8757717,333,10,"Skype render content error. Message: {0}, Callstack {1}",e.message,e.stack)}},e.prototype.joinConversation=function(t,n,r){try{C.ULS.sendTraceTag(9209431,333,50,"Joining Conversation"),this.skypeNativeApi.joinConversation(t,[e.skypeModalityChat],n,(function(e){C.ULS.sendTraceTag(9209432,333,10,"JoinConversation Failed. Error: {0}",e),r()}))}catch(e){C.ULS.sendTraceTag(8913495,333,10,"Skype join request error. Message: {0}, Callstack: {1}",e.message,e.stack),r()}},e.prototype.renderSidebar=function(e){try{this.skypeNativeApi.renderSidebar(e)}catch(e){C.ULS.sendTraceTag(8757718,333,10,"Skype render sidebar error. Message: {0}, Callstack: {1}",e.message,e.stack)}},e.prototype.setAuthProvider=function(e,t,n){try{this.skypeNativeApi.setAuthProvider(e,t,n)}catch(e){C.ULS.sendTraceTag(8757719,333,10,"Skype SetAuthProvider error. Message: {0}, Callstack: {1}",e.message,e.stack)}},e.prototype.setNotificationHandler=function(e){try{this.skypeNativeApi.setNotificationHandler(e)}catch(e){C.ULS.sendTraceTag(8979149,333,10,"Skype SetNotificationHandler error. Message: {0}, Callstack: {1}",e.message,e.stack)}},e.prototype.setFocus=function(e){try{this.skypeNativeApi.setFocus(e)}catch(e){C.ULS.sendTraceTag(16799060,333,10,"Skype SetFocus error. Message: {0}, Callstack: {1}",e.message,e.stack)}},e.tryGetInstance=function(t,n){try{return n.val=new e(t),!0}catch(e){return C.ULS.sendTraceTag(8757716,333,10,"SkypeApi initialization error. Message: {0}, Callstack: {1}",e.message,e.stack),n.val=null,!1}},e.skypeModalityChat="Chat",e.skypeModalityAudio="Audio",e.skypeModalityVideo="Video",e}();(0,o.l)(jt,"SkypeApi",null,[]);var $t=function(){return function(e,t,n,r,i){this.correlationIds=null,this.apiKey=null,this.locale=null,this.jsonp=!1,this.business=!1,this.apiKey=e,this.locale=t,this.correlationIds=r,this.jsonp=n,this.business=i}}();(0,o.l)($t,"SkypeNativeInitParams",null,[]);var Qt,Jt=function(){return function(){this.hostProperty=null,this.userId=null,this.sessionId=null,this.userAppId=null,this.experienceId=null}}();(0,o.l)(Jt,"SkypeNativeInitParamsCorrelationIds",null,[]),function(e){e[e.unknown=0]="unknown",e[e.consumer=1]="consumer",e[e.enterprise=2]="enterprise",e[e.test=3]="test"}(Qt||(Qt={})),(0,o.h)("ChatExperience",Qt);var Xt=function(){function e(){this._correlationIds=null,this._apiKey=null,this._uiCulture=null,this._jsonp=!1,this._business=!1,this._tcs=new wt.z(jt)}return e.prototype.load=function(t,n,r,i){var a=t;if(!a)return C.ULS.sendTraceTag(19726497,333,10,"Cannot initialize Skype. Invalid setting for Skypebootstrap url."),this._tcs.setResult(null),this._tcs.get_task();this._apiKey=n,this._uiCulture=i.get_culture(),this._jsonp=r,this._correlationIds=new Jt,this._correlationIds.userAppId=i.tabid,this._correlationIds.hostProperty=i.workload,this._correlationIds.userId=i.userid,this._correlationIds.sessionId=i.sessionid,this._correlationIds.experienceId=Qt[i.get_experience()],this._business=2===i.get_experience();try{e.downloadSwxBootStrapper(a,o.i(this,this.onLoaded,"onLoaded"))}catch(e){C.ULS.sendTraceTag(8245794,333,10,"Exception loading the api Message: {0} Callstack: {1}.",e.message,e.stack)}return this._tcs.get_task()},e.prototype.onLoaded=function(e,t){if(t.get_succeeded()){C.ULS.sendTraceTag(8210202,333,50,"Calling the Skype initialized method.");try{Skype.initialize(new $t(this._apiKey,this._uiCulture,this._jsonp,this._correlationIds,this._business),o.i(this,this.onSkypeInitSuccess,"onSkypeInitSuccess"),o.i(this,this.onSkypeInitError,"onSkypeInitError"))}catch(e){C.ULS.sendTraceTag(8245795,333,10,"Exception in initializing the Skype SWX api Message: {0} Callstack: {1}.",e.message,e.stack),this._tcs.setResult(null)}}else C.ULS.sendTraceTag(8210203,333,10,"Failed to download the SkypBootstrapper."),this._tcs.setResult(null)},e.prototype.onSkypeInitSuccess=function(e){return e?jt.tryGetInstance(e,(0,p.m)((function(){return t}),(function(e){return t=e})))?(C.ULS.sendTraceTag(8245825,333,50,"Initializing succeeded and about to create the api instance."),void this._tcs.setResult(t)):(this.onSkypeInitError("This is not real success. Invalid native api object."),void this._tcs.setResult(null)):(this.onSkypeInitError("This is not real success. Null native api object."),void this._tcs.setResult(null));var t},e.prototype.onSkypeInitError=function(e){C.ULS.sendTraceTag(8210207,333,10,"Skype Api error: {0}",e),this._tcs.setResult(null)},e.downloadSwxBootStrapper=function(e,t){var n=e?Ae.v.create(e,null,null,null,!1):null;n&&n.add_loadFinished(t);try{Te.z.enqueueResourceWithoutEnabling(n)}catch(e){C.ULS.sendTraceTag(8757722,333,10,"Failure downloading the skype api bootstrapper: Message: {0}, Callstack: {1}",e.message,e.stack)}C.ULS.sendTraceTag(8254435,333,100,"Downloading SWX bootstrapper from: {0}",e)},e}();(0,o.l)(Xt,"SkypeLoader",null,[]);var Yt=function(){function e(e,t){this.fullExperienceIsEnabled=!1,this.anonymousExperienceSupport=!1,this.fullExperienceIsEnabled=e,this.anonymousExperienceSupport=t}return e.prototype.get_fullExperienceIsEnabled=function(){return this.fullExperienceIsEnabled},e.prototype.get_anonymousExperienceSupport=function(){return this.anonymousExperienceSupport},e.prototype.get_supportsAnonymousChatOnly=function(){return!this.get_fullExperienceIsEnabled()&&this.get_anonymousExperienceSupport()},e}();(0,o.l)(Yt,"BasicChatCapabilities",null,[]);var Zt=function(){function e(e){this._capabilitiesTcs=null,this._appHasFlexPaneUISupport=!1,this._experience=0,this.settingsManager=null,this.basicChatBrsIsEnabled=!1,this.chatIsEnabledTcs=null,this.settingsManager=e,this._appHasFlexPaneUISupport=!this.settingsManager.getBooleanAppSetting("HeaderInsideRibbonIsEnabled"),this.basicChatBrsIsEnabled=this.settingsManager.getBooleanAppSetting("SkypeAutomationModeIsEnabled")||this.settingsManager.getBooleanAppSetting("BasicChatIsEnabled")&&!this.settingsManager.getBooleanAppSetting("ReactSharedHeaderIsEnabled"),this._experience=this.settingsManager.getIntAppSetting("SkypeExperience",0)}return e.prototype.get_capabilitiesAsync=function(){return this.initCapabilitiesCheck(),this._capabilitiesTcs.get_task()},e.prototype.get_hasAnonymousChatSupport=function(){return this._appHasFlexPaneUISupport&&this.get_customChecksForAnonymousSupport()},e.prototype.initCapabilitiesCheck=function(){var e=this;this._capabilitiesTcs||(this._capabilitiesTcs=new wt.z(Yt),this.initFullExperienceCheck(),this.chatIsEnabledTcs.get_task().CW((function(t){var n=e.chatIsEnabledTcs.get_task().get_result(),r=!n&&e.get_hasAnonymousChatSupport();e._capabilitiesTcs.setResult(new Yt(n,r))})))},e.prototype.initFullExperienceCheck=function(){this.chatIsEnabledTcs||(this.chatIsEnabledTcs=new wt.z(Boolean),this._appHasFlexPaneUISupport&&this.basicChatBrsIsEnabled?this.customChecksForFullExperienceSupport():this.chatIsEnabledTcs.setResult(!1))},e.prototype.get_experience=function(){return this._experience},e}();(0,o.l)(Zt,"BasicChatUserExperienceController",null,[ot.l]);var en=function(e){function t(t,n){var r=e.call(this,t)||this;return r._shellActorAsync=null,r._shellActor=null,r._shellInfoAsync=null,r._isBrowserSupportedLazy=null,r._isAuthFailureUnexpected=!1,r._shellActorAsync=n,r._isAuthFailureUnexpected=!0,r._isBrowserSupportedLazy=new yt.q(Boolean,o.i(r,r.isBrowserSupportedForSkypeExperience,"isBrowserSupportedForSkypeExperience")),r}return(0,S.t)(t,e),t.prototype.get_customChecksForAnonymousSupport=function(){if(!this._isBrowserSupportedLazy.get_value())return!1;var e=this.settingsManager.getBooleanAppSetting("DocChatIsEnabled");return!this.basicChatBrsIsEnabled&&e&&(2===this.get_experience()||3===this.get_experience())},t.prototype.customChecksForFullExperienceSupport=function(){this.checkIfSkypeExperienceIsEnabled()},t.prototype.checkIfSkypeExperienceIsEnabled=function(){var e=this;this._isBrowserSupportedLazy.get_value()?2===this.get_experience()?this._shellActorAsync.execute((function(t){e._shellActor=t,t.get_shellServiceDataAsync().CW((function(t){e.checkIfSkypeForBusinessIsEnabled()}))})):1===this.get_experience()||3===this.get_experience()?this.chatIsEnabledTcs.setResult(!0):this.chatIsEnabledTcs.setResult(!1):this.chatIsEnabledTcs.setResult(!1)},t.prototype.get_isAuthFailureUnexpected=function(){return this._isAuthFailureUnexpected},t.prototype.checkIfSkypeForBusinessIsEnabled=function(){if(this._shellInfoAsync=this._shellActor.get_shellServiceDataAsync(),this._shellInfoAsync.get_isCanceled()||!this._shellInfoAsync.get_isCompleted())return C.ULS.sendTraceTag(17949148,333,15,"Shell info task was canceled or was not completed"),void this.chatIsEnabledTcs.setResult(!1);var e=this._shellActor.get_shellServiceDataAsync().get_result(),t=!1;try{var n;if(w.t(Object,e.ClientData.toString(),(0,p.m)((function(){return n}),(function(e){return n=e}))))if(this.settingsManager.getBooleanAppSetting("BasicChatIsForced"))t=!0,this._isAuthFailureUnexpected=!1;else{var r=n.IsTenantDirSyncEnabled,i=n.HasSkypeLicense;t=!r&&i,C.ULS.sendTraceTag(17949149,333,50,"Suite UX Skype check resulted in Enabled:{0}, from: Tenant Hybrid:{1}; License:{2}",t,r,i)}}catch(e){C.ULS.sendTraceTag(17949150,333,15,"object format is incorrect. Error {0}",e.message)}this.chatIsEnabledTcs.setResult(t)},t.prototype.isBrowserSupportedForSkypeExperience=function(){return!G.y.get_isMobile()&&(!(G.y.get_isInternetExplorer()&&!G.y.get_isInternetExplorer10Up())&&(!(G.y.get_isWebKit()&&!G.y.get_isChrome()&&!G.y.isSafariAtLeast(8))&&!G.y.get_isOpera()))},t}(Zt);(0,o.l)(en,"SkypeWebExperienceController",Zt,[lt,ot.l]);var tn=(0,o.y)("IChatToast"),nn=function(e){function t(t,n){var r=e.call(this)||this;return r._actionAreaElement=null,r._answerButton=null,r._ignoreButton=null,r._answerWithIMButton=null,r._ignoreButtonAction=null,r._answerWithIMButtonAction=null,r._clickInputManager=null,r._actionAreaElement=t,Sys.UI.DomElement.addCssClass(r._actionAreaElement,xt.skypeNotificationActionAreaClass),r._clickInputManager=n,r.createButtonsDom(),r}return(0,S.t)(t,e),t.prototype.createButtonsDom=function(){this._answerButton=this.createDomElementAppendToParent(this._actionAreaElement,"div"),Sys.UI.DomElement.addCssClass(this._answerButton,xt.skypeNotificationButtonClass),this._ignoreButton=this.createDomElementAppendToParent(this._actionAreaElement,"div"),Sys.UI.DomElement.addCssClass(this._ignoreButton,xt.skypeNotificationButtonClass),this._clickInputManager.registerHandler(Le.d.click,this._ignoreButton,o.i(this,this.onIgnoreButtonClick,"onIgnoreButtonClick")),this._answerWithIMButton=this.createDomElementAppendToParent(this._actionAreaElement,"div"),Sys.UI.DomElement.addCssClass(this._answerWithIMButton,xt.skypeNotificationButtonClass),this._answerWithIMButton.style.display="none",this._clickInputManager.registerHandler(Le.d.click,this._answerWithIMButton,o.i(this,this.onAnswerWithIMButtonClick,"onAnswerWithIMButtonClick"))},t.prototype.onIgnoreButtonClick=function(e){return this._ignoreButtonAction&&this._ignoreButtonAction(),!0},t.prototype.onAnswerWithIMButtonClick=function(e){return this._answerWithIMButtonAction&&this._answerWithIMButtonAction(),!0},t.prototype.setButtons=function(e,t,n){var r=CommonUIStrings.l_NotificationRespond,i=CommonUIStrings.l_NotificationIgnore,o=CommonUIStrings.l_NotificationAnswerWithIM;switch(e){case 3:r=CommonUIStrings.l_NotificationAnswer,this._answerWithIMButton.style.display="",this._answerWithIMButton.style.maxWidth="120px",this._answerButton.style.maxWidth=this._ignoreButton.style.maxWidth="65px";break;default:this._answerWithIMButton.style.display="none",this._answerButton.style.maxWidth=this._ignoreButton.style.maxWidth=""}this._answerButton.innerText=r,this._ignoreButton.innerText=i,this._answerWithIMButton.innerText=o,this._ignoreButtonAction=t,this._answerWithIMButtonAction=n},t.prototype.dispose=function(){this._clickInputManager.unregisterHandler(Le.d.click,this._ignoreButton,o.i(this,this.onIgnoreButtonClick,"onIgnoreButtonClick")),this._clickInputManager.unregisterHandler(Le.d.click,this._answerWithIMButton,o.i(this,this.onAnswerWithIMButtonClick,"onAnswerWithIMButtonClick"))},t}(xt);(0,o.l)(nn,"SkypeToastNotificationButtons",xt,[Sys.IDisposable]);var rn,on=function(e){function t(t){var n=e.call(this)||this;return n._textAreaElement=null,n._senderElement=null,n._senderTitleElement=null,n._messageElement=null,n._textAreaElement=t,Sys.UI.DomElement.addCssClass(n._textAreaElement,xt.skypeNotificationTextClass),n.createTextAreaDom(),n}return(0,S.t)(t,e),t.prototype.createTextAreaDom=function(){this._senderElement=this.createDomElementAppendToParent(this._textAreaElement,"span"),Sys.UI.DomElement.addCssClass(this._senderElement,xt.skypeNotificationSenderClass),this._senderTitleElement=this.createDomElementAppendToParent(this._textAreaElement,"span"),Sys.UI.DomElement.addCssClass(this._senderTitleElement,xt.skypeNotificationTitleClass),this._messageElement=this.createDomElementAppendToParent(this._textAreaElement,"span"),Sys.UI.DomElement.addCssClass(this._messageElement,xt.skypeNotificationMessageClass)},t.prototype.setNotificationText=function(e,t,n,r){var i=n;switch(r){case 3:i=CommonUIStrings.l_NotificationIncomingCall}this._senderElement.innerText=e,this._senderTitleElement.innerText=t,this._messageElement.innerText=i},t}(xt);(0,o.l)(on,"SkypeToastNotificationText",xt,[]),function(e){e[e.unknown=0]="unknown",e[e.unreadMessage=1]="unreadMessage",e[e.chatRequest=2]="chatRequest",e[e.voiceCall=3]="voiceCall",e[e.contactRequest=4]="contactRequest"}(rn||(rn={})),(0,o.h)("ChatNotificationType",rn);var an="WACSkypeChatRequest_40x40x32",sn="WACSkypeVoiceRequest_40x40x32",ln=function(e){function t(t){var n=e.call(this)||this;n._notificationTypeElement=null,n._notificationIcon=null,n._imageDictionary={},n._notificationTypeElement=t,Sys.UI.DomElement.addCssClass(n._notificationTypeElement,xt.skypeNotificationTypeClass),n.createTypeDom();var r=L.AFrameworkApplication.get_imageClusterName(),i=Lt.getImageClassWithCluster(r,an);return n._imageDictionary.unknown=i,n._imageDictionary.unreadMessage=i,n._imageDictionary.chatRequest=i,n._imageDictionary.contactRequest=i,n._imageDictionary.voiceCall=Lt.getImageClassWithCluster(r,sn),n}return(0,S.t)(t,e),t.prototype.createTypeDom=function(){this._notificationIcon=this.createDomElementAppendToParent(this._notificationTypeElement,"span")},t.prototype.setToastTypeButton=function(e){var t=Lt.createClusteredImageFromClusterWithImageClass(40,40,this._imageDictionary[rn[e]],L.AFrameworkApplication.get_imageClusterPath(),"cui-img-cont-float","",!1,"",this._notificationTypeElement.ownerDocument);this._notificationIcon&&this._notificationTypeElement.removeChild(this._notificationIcon),this._notificationTypeElement.appendChild(t),this._notificationIcon=t},t}(xt);(0,o.l)(ln,"SkypeToastNotificationType",xt,[]);var cn=function(e){function t(t,n){var r=e.call(this)||this;return r._notificationAreaElement=null,r._notificationTopBar=null,r._notificationText=null,r._notificationType=null,r._notificationButtons=null,r._clickInputManager=null,r._notificationAreaElement=t,Sys.UI.DomElement.addCssClass(r._notificationAreaElement,xt.skypeNotificationAreaClass),r._clickInputManager=n,r.constructNotificationAreaDom(),r}return(0,S.t)(t,e),t.prototype.constructNotificationAreaDom=function(){this._notificationTopBar=this.createDomElementAppendToParent(this._notificationAreaElement,"div"),Sys.UI.DomElement.addCssClass(this._notificationTopBar,xt.skypeNotificationTopBar);var e=this.createDomElementAppendToParent(this._notificationTopBar,"div");this._notificationText=new on(e);var t=this.createDomElementAppendToParent(this._notificationTopBar,"div");this._notificationType=new ln(t);var n=this.createDomElementAppendToParent(this._notificationAreaElement,"div");this._notificationButtons=new nn(n,this._clickInputManager)},t.prototype.setNotificationArea=function(e,t,n,r,i,o){this._notificationText.setNotificationText(e,t,n,r),this._notificationType.setToastTypeButton(r),this._notificationButtons.setButtons(r,i,o)},t.prototype.dispose=function(){this._notificationButtons&&(this._notificationButtons.dispose(),this._notificationButtons=null)},t}(xt);(0,o.l)(cn,"SkypeToastNotificationArea",xt,[Sys.IDisposable]);var un=function(e){function t(t){var n=e.call(this)||this;return n._imageAreaElement=null,n._imageElement=null,n._imageAreaElement=t,Sys.UI.DomElement.addCssClass(n._imageAreaElement,xt.skypePresenceImageClass),n._imageElement=n.createDomElementAppendToParent(n._imageAreaElement,"img"),Sys.UI.DomElement.addCssClass(n._imageElement,xt.skypePresenceImageClass),n}return(0,S.t)(t,e),t.prototype.setImage=function(e){this._imageElement.src=e},t}(xt);(0,o.l)(un,"SkypeToastPresenceImage",xt,[]);var gn=function(e){function t(t){var n=e.call(this)||this;return n._presenceAreaElement=null,n._presenceElement=null,n._presenceImage=null,n._currentPresenceClass=null,n._presenceAreaElement=t,Sys.UI.DomElement.addCssClass(n._presenceAreaElement,xt.skypePresenceAreaClass),n.constructPresenceAreaDom(),n}return(0,S.t)(t,e),t.prototype.constructPresenceAreaDom=function(){this._presenceElement=this.createDomElementAppendToParent(this._presenceAreaElement,"div"),Sys.UI.DomElement.addCssClass(this._presenceElement,xt.skypePresenceClass);var e=this.createDomElementAppendToParent(this._presenceAreaElement,"div");this._presenceImage=new un(e)},t.prototype.setPresenceArea=function(e,t){this.switchPresence(t),this._presenceImage.setImage(e)},t.prototype.switchPresence=function(e){var t;switch(e){case 1:t=xt.skypePresenceClass_Available;break;case 2:t=xt.skypePresenceClass_Away;break;case 3:t=xt.skypePresenceClass_Busy;break;default:t=xt.skypePresenceClass_Unknown}this._currentPresenceClass&&Sys.UI.DomElement.removeCssClass(this._presenceElement,this._currentPresenceClass),Sys.UI.DomElement.addCssClass(this._presenceElement,t),this._currentPresenceClass=t},t}(xt);(0,o.l)(gn,"SkypeToastPresenceArea",xt,[]);var pn=function(e){function t(t,n){var r=e.call(this)||this;return r._toastElement=null,r._presenceArea=null,r._notificationArea=null,r._mainRespondAction=null,r._notification=null,r._hideToastTaskIsPending=!1,r._hideToastTask=null,r._eventSource=null,r._clickInputManager=null,r._disposed=!1,r._dismissed=!1,r._clickInputManager=t,r._eventSource=new bt.f,r.createToastDom(),r._hideToastTaskIsPending=!1,r.bind(n),r}return(0,S.t)(t,e),t.prototype.get_element=function(){return this._toastElement},t.prototype.createToastDom=function(){this._toastElement=document.createElement("div"),this.createPresenceDom(),this.createNotificationAreaDom(),Sys.UI.DomElement.addCssClass(this._toastElement,xt.skypeToastDivClass)},t.prototype.createPresenceDom=function(){var e=this.createDomElementAppendToParent(this._toastElement,"div");this._presenceArea=new gn(e)},t.prototype.createNotificationAreaDom=function(){var e=this.createDomElementAppendToParent(this._toastElement,"div");this._notificationArea=new cn(e,this._clickInputManager)},t.prototype.bind=function(e){var n=this;this._notification=e,C.ULS.sendTraceTag(17114639,333,100,"Building toast type: <{0}>.",this._notification.type);var r=this.parseSkypePresence(e.presence);this._presenceArea.setPresenceArea(e.avatar,r),this._mainRespondAction=this.executeActionAndHide(t.getMainRespondAction(e));var i=t.tryGetSecondaryRespondAction(e);this._notificationArea.setNotificationArea(e.displayName,e.title,e.description,e.type,this.executeActionAndHide(e.decline),i?this.executeActionAndHide(i):null),e.playSound&&e.playSound(),this.scheduleHideToastTask(e.type),this._notification.subscribeToActiveStateChanged((function(e){e||(C.ULS.sendTraceTag(17114640,333,100,"Notification inactive triggered..."),n.dismiss())})),this._clickInputManager.registerHandler(Le.d.click,this._toastElement,o.i(this,this.onToastClick,"onToastClick"))},t.prototype.scheduleHideToastTask=function(e){var n=this;this.cancelPendingHideToastTask(),this._hideToastTask=new De.c(2,1,t.toastDisplayTimeInMilliseconds(e),(function(e){n._hideToastTaskIsPending=!1,C.ULS.sendTraceTag(17114641,333,100,"Auto-hide toast task executing..."),n.dismiss()}),73),Oe.y.get_instance().addTask(this._hideToastTask),this._hideToastTaskIsPending=!0},t.prototype.cancelPendingHideToastTask=function(){this._hideToastTaskIsPending&&(Oe.y.get_instance().deleteTask(this._hideToastTask),this._hideToastTaskIsPending=!1)},t.prototype.dismiss=function(){this._dismissed||(C.ULS.sendTraceTag(17114642,333,100,"Dismissing toast type: <{0}>.",this._notification.type),this._dismissed=!0,this.cancelPendingHideToastTask(),this._notification.stopSound&&this._notification.stopSound(),this._eventSource.raiseEvent(t.toastOnDismissEventKey))},t.prototype.get_sticky=function(){return 3===this._notification.type},t.prototype.add_onDismiss=function(e){this._eventSource.addHandler(t.toastOnDismissEventKey,e)},t.prototype.remove_onDismiss=function(e){this._eventSource.removeHandler(t.toastOnDismissEventKey,e)},t.prototype.parseSkypePresence=function(e){return 0},t.prototype.onToastClick=function(e){return this._mainRespondAction&&this._mainRespondAction(),!0},t.prototype.executeActionAndHide=function(e){var t=this;return function(){e&&e(),C.ULS.sendTraceTag(17114643,333,100,"Toast action taken..."),t.dismiss()}},t.prototype.dispose=function(){this._disposed||(this._disposed=!0,this._clickInputManager.unregisterHandler(Le.d.click,this._toastElement,o.i(this,this.onToastClick,"onToastClick")),this._notificationArea.dispose(),this._notificationArea=null,this._presenceArea=null,this._toastElement=null)},t.getMainRespondAction=function(e){switch(e.type){case 2:return e.accept;case 1:case 4:return e.open;case 3:return function(){e.acceptWithModality(jt.skypeModalityAudio)};default:return Function.emptyFunction}},t.tryGetSecondaryRespondAction=function(e){switch(e.type){case 3:return function(){e.acceptWithModality(jt.skypeModalityChat)};default:return null}},t.toastDisplayTimeInMilliseconds=function(e){switch(e){case 2:return 25e3;case 1:case 4:return 7e3;case 3:return 6e4;default:return 7e3}},t.toastOnDismissEventKey="toastDismissedEventKey",t}(xt);(0,o.l)(pn,"SkypeToast",xt,[tn,Sys.IDisposable]);var dn=function(){function e(e){this._clickInputManager=null,this._clickInputManager=e}return e.prototype.create=function(e){return new pn(this._clickInputManager,e)},e}();(0,o.l)(dn,"Factory$7",null,[ft]);var hn=n(7077),_n=n(4431),mn=n(1896),fn=function(){function e(){this._container=null,this._perfManager=null}return e.prototype.get_name=function(){return"Common.App.BasicChat"},e.prototype.init=function(){var e=this;mn.m.get_instance().get_appIsInteractiveTask().CW((function(t){L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){e.initializeBasicChatPackage()}))}))},e.prototype.initializeBasicChatPackage=function(){var e=this;this._perfManager=this._container.resolve(vt),this._perfManager.get_userExperienceLoadStopwatch().start(),this._perfManager.get_chattableStopwatch().start();var t=this._container.resolve(ot.l).get_capabilitiesAsync();t.CW((function(n){var r=t.get_result();r.get_fullExperienceIsEnabled()?(e._container.resolve(at.n),e._container.resolve(st).initialize()):r.get_anonymousExperienceSupport()&&e._container.resolve(at.n)}))},e.prototype.dispose=function(){},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(en).singleInstance().as(lt).as(ot.l).usingFactory((function(){return new en(L.AFrameworkApplication.appSettingsManager,t._container.resolveFuture(ct.u))})),this._container.register(vt).singleInstance().usingFactory((function(){return new vt(L.AFrameworkApplication.get_activeFrame().get_theStopwatchBuilder())})),this._container.register(Ht).as(ut).singleInstance().usingFactory((function(){return new Ht(new yt.q(gt.k,(function(){return Nt.FocusManager.instance()})),new yt.q(pt.k,(function(){return L.AFrameworkApplication.get_activeFrame().get_theF6Manager()})),new yt.q(Be.p,(function(){return Be.p.get_instance()})),new yt.q(_n.v,(function(){return _n.v.get_instance()})),new yt.q(dt.p,(function(){return hn.s.get_instance()})),new yt.q(ht.i,(function(){return Xe.KeyInputManager.get_instance()})),new yt.q(_t.l,(function(){return L.AFrameworkApplication.get_activeFrame()})))})),this._container.register(Xt).singleInstance(),this._container.register(qt).singleInstance().usingFactory((function(){return new qt(L.AFrameworkApplication.get_activeFrame().get_applicationInstance(),L.AFrameworkApplication.appSettingsManager,t._container.resolve(ut),t._container.resolve(Xt),t._container.resolve(lt),t._container.resolve(vt),t._container.resolve(mt))})),this._container.register(Mt).singleInstance().usingFactory((function(){return Mt.getAnInstance(L.AFrameworkApplication.appSettingsManager,t._container.resolve(ut),t._container.resolve(mt))})),this._container.register(at.n).singleInstance().usingFactory((function(){return new Tt(L.AFrameworkApplication.appSettingsManager,(function(){return t._container.resolve(Mt)}),(function(){return t._container.resolve(qt)}),Oe.y.get_instance())})),this._container.register(st).singleInstance().usingFactory((function(){return new St(L.AFrameworkApplication.get_theActionManager(),t._container.resolve(at.n),Ue.k(je.p,t._container.resolveFuture(je.p)),t._container.resolve(vt),L.AFrameworkApplication.subscribeToBeforeAppShutDown,L.AFrameworkApplication.appSettingsManager)})),this._container.register(ft).singleInstance().usingFactory((function(){return new dn(hn.s.get_instance())})),this._container.register(mt).singleInstance().usingFactory((function(){return new Ft((function(){return L.AFrameworkApplication.get_activeFrame().get_element().parentNode}),t._container.resolve(ft))}))},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(fn,"CommonBasicChatPackage",null,[l.u,c.s]);var yn=n(4169),Cn=(0,o.y)("IUsageLogger"),Sn=function(e,t){var n={},r=function(e,t){null!=t&&(n[e]=t)},i=null;switch(e){case 0:var o=t;i="ResourceTiming",r("Url",o.a),r("InitiatorType",o.b),r("RedirectStart",null==o.c?null:o.c.toString()),r("RedirectEnd",null==o.d?null:o.d.toString()),r("FetchStart",null==o.e?null:o.e.toString()),r("DomainLookupStart",null==o.f?null:o.f.toString()),r("DomainLookupEnd",null==o.g?null:o.g.toString()),r("ConnectStart",null==o.h?null:o.h.toString()),r("ConnectEnd",null==o.i?null:o.i.toString()),r("SecureConnectionStart",null==o.j?null:o.j.toString()),r("RequestStart",null==o.k?null:o.k.toString()),r("ResponseStart",null==o.l?null:o.l.toString()),r("ResponseEnd",null==o.m?null:o.m.toString()),r("CustomText",o.n),r("DecodedBodySize",null==o.o?null:o.o.toString()),r("EncodedBodySize",null==o.p?null:o.p.toString()),r("TransferSize",null==o.q?null:o.q.toString());break;case 1:var a=t;i="PerformanceTiming",r("Url",a.a),r("NavigationStart",null==a.b?null:a.b.toString()),r("UnloadEventStart",null==a.c?null:a.c.toString()),r("UnloadEventEnd",null==a.d?null:a.d.toString()),r("RedirectStart",null==a.e?null:a.e.toString()),r("RedirectEnd",null==a.f?null:a.f.toString()),r("FetchStart",null==a.g?null:a.g.toString()),r("DomainLookupStart",null==a.h?null:a.h.toString()),r("DomainLookupEnd",null==a.i?null:a.i.toString()),r("ConnectStart",null==a.j?null:a.j.toString()),r("ConnectEnd",null==a.k?null:a.k.toString()),r("SecureConnectionStart",null==a.l?null:a.l.toString()),r("RequestStart",null==a.m?null:a.m.toString()),r("ResponseStart",null==a.n?null:a.n.toString()),r("ResponseEnd",null==a.o?null:a.o.toString()),r("DomLoading",null==a.p?null:a.p.toString()),r("DomInteractive",null==a.q?null:a.q.toString()),r("DomContentLoadedEventStart",null==a.r?null:a.r.toString()),r("DomContentLoadedEventEnd",null==a.s?null:a.s.toString()),r("DomComplete",null==a.t?null:a.t.toString()),r("LoadEventStart",null==a.u?null:a.u.toString()),r("LoadEventEnd",null==a.v?null:a.v.toString()),r("CustomText",a.w)}return n.Table=i,Sys.Serialization.JavaScriptSerializer.serialize(n)},vn=function(){function e(e){this._allowedDomainEndings=null,this._allowedDomainEndings=e}return e.prototype.isDomainAllowed=function(e){if(!this._allowedDomainEndings)return!0;var t=tt.n.getHost(e);if(!t)return!1;t=t.toLowerCase();for(var n=0;n<this._allowedDomainEndings.length;n++)if(t.endsWith(this._allowedDomainEndings[n]))return!0;return!1},e}();(0,o.l)(vn,"DomainAllowListManager",null,[]);var bn=function(){function e(e,t){this.url=null,this.timings=null,this.customText=null,this.timings=e,this.url=t}return e.prototype.get_usageReadyUrl=function(){return tt.n.removeAllUrlParameters(this.url)},e.prototype.get_timings=function(){return this.timings},e.prototype.toUsageData=function(){var e={},t=this.get_timings();return e.a=this.get_usageReadyUrl(),e.b=this.round(t.navigationStart),e.c=this.round(t.unloadEventStart),e.d=this.round(t.unloadEventEnd),e.e=this.round(t.redirectStart),e.f=this.round(t.redirectEnd),e.g=this.round(t.fetchStart),e.h=this.round(t.domainLookupStart),e.i=this.round(t.domainLookupEnd),e.j=this.round(t.connectStart),e.k=this.round(t.connectEnd),e.l=void 0!==t.secureConnectionStart&&null!==t.secureConnectionStart?this.round(t.secureConnectionStart):0,e.m=this.round(t.requestStart),e.n=this.round(t.responseStart),e.o=this.round(t.responseEnd),e.q=this.round(t.domInteractive),e.r=this.round(t.domContentLoadedEventStart),e.s=this.round(t.domContentLoadedEventEnd),e.t=this.round(t.domComplete),e.u=this.round(t.loadEventStart),e.v=this.round(t.loadEventEnd),e.w=this.customText,e},e.prototype.round=function(e){return Math.round(1e3*e)/1e3},e}();(0,o.l)(bn,"PerformanceTimingEntry",null,[]);var Tn=n(5488),An=n(6910),In=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._pageLoadPerfRecorder=null,this._getCurrentUrlDelegate=null,this._domainAllowListManager=null,this.usageLogger=null,this._pageLoadPerfRecorder=e,this.usageLogger=this,this._getCurrentUrlDelegate=t||function(){return window.location.href},this._domainAllowListManager=new vn(n)}return e.prototype.run=function(){if(e.get_browserSupportsPerformanceTiming())try{var t=this._getCurrentUrlDelegate();if(!e._transportRegEx.exec(t))return;if(!this._domainAllowListManager.isDomainAllowed(t))return;var n=new bn(window.performance.timing,t);mn.m.get_instance().recordBrowserFetchStart(n.get_timings().fetchStart),mn.m.get_instance().recordBrowserNavigationStart(n.get_timings().navigationStart),mn.m.get_instance().measureMarks(Tn.c.frameConnect,"connectStart","requestStart"),mn.m.get_instance().measureMarks(Tn.c.frameRequest,"requestStart","responseStart"),mn.m.get_instance().measureMarks(Tn.c.frameResponse,"responseStart","responseEnd"),this.usageLogger.logData(1,n.toUsageData()),this._pageLoadPerfRecorder.addMetric(Tn.c.frameFetchStart,n.get_timings().fetchStart),this._pageLoadPerfRecorder.addMetric(Tn.c.frameDomainLookupStart,n.get_timings().domainLookupStart),this._pageLoadPerfRecorder.addMetric(Tn.c.frameDomainLookupEnd,n.get_timings().domainLookupEnd),this._pageLoadPerfRecorder.addMetric(Tn.c.frameConnectStart,n.get_timings().connectStart),this._pageLoadPerfRecorder.addMetric(Tn.c.frameSecureConnectionStart,n.get_timings().secureConnectionStart),this._pageLoadPerfRecorder.addMetric(Tn.c.frameConnectEnd,n.get_timings().connectEnd),this._pageLoadPerfRecorder.addMetric(Tn.c.frameRequestStart,n.get_timings().requestStart),this._pageLoadPerfRecorder.addMetric(Tn.c.frameResponseStart,n.get_timings().responseStart),this._pageLoadPerfRecorder.addMetric(Tn.c.frameDownloadDuration,n.get_timings().responseEnd-n.get_timings().responseStart),this._pageLoadPerfRecorder.addMetric(Tn.c.frameRequestStartToFirstByteDuration,n.get_timings().responseStart-n.get_timings().requestStart);var r=0,i=0,o=0;this.tryNavigationSize(t,(0,p.m)((function(){return r}),(function(e){return r=e})),(0,p.m)((function(){return i}),(function(e){return i=e})),(0,p.m)((function(){return o}),(function(e){return o=e})))&&(this._pageLoadPerfRecorder.addMetric(Tn.c.frameTransferSize,r),this._pageLoadPerfRecorder.addMetric(Tn.c.frameDecodedSize,o),this._pageLoadPerfRecorder.addMetric(Tn.c.frameEncodedSize,i)),this._pageLoadPerfRecorder.addMetric(Tn.c.frameNavigationStart,n.get_timings().navigationStart)}catch(e){C.ULS.sendTraceTag(4551814,306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",e)}},e.prototype.tryNavigationSize=function(e,t,n,r){if(t.val=-1,n.val=-1,r.val=-1,void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return!1;var i=window.performance.getEntriesByName(e,"navigation");if(null==i||1!==i.length)return!1;var o=i[0],a=o.transferSize;void 0!==t.val&&null!==t.val&&(t.val=a);var s=o.decodedBodySize;null!=s&&(r.val=s);var l=o.encodedBodySize;return null!=l&&(n.val=l),!0},e.prototype.logData=function(e,t,n){void 0===n&&(n=!1),C.ULS.sendTraceTag(4551815,306,50,Sn(e,t))},e.get_instance=function(){return e._instance||(e._instance=new e(An.e.get_instance(),null,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PerfTimingLoggerFilterDomainsIsEnabled")?L.AFrameworkApplication.appSettingsManager.getListAppSetting("ResourceLoggerDomainAllowList"):null))},e.get_browserSupportsPerformanceTiming=function(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.timing||null===window.performance.timing)},e._instance=null,e._transportRegEx=new RegExp("^https?://.*","i"),e}();(0,o.l)(In,"PerformanceTimingLogger",null,[Cn]);var wn=(0,o.y)("IResourceTimingEntry"),xn=function(){function e(e,t){this.$$pf_Url=null,this.timings=null,this.$$pf_Behavior=0,this.$$pf_CustomText=null,this.timings=e,this.set_behavior(t),this.set_url(this.get_timings().name)}return e.prototype.get_url=function(){return this.$$pf_Url},e.prototype.set_url=function(e){return this.$$pf_Url=e,e},e.prototype.get_usageReadyUrl=function(){return 2===this.get_behavior()?this.get_url():tt.n.removeAllUrlParameters(this.get_url())},e.prototype.get_timings=function(){return this.timings},e.prototype.get_behavior=function(){return this.$$pf_Behavior},e.prototype.set_behavior=function(e){return this.$$pf_Behavior=e,e},e.prototype.get_customText=function(){return this.$$pf_CustomText},e.prototype.set_customText=function(e){return this.$$pf_CustomText=e,e},e.prototype.toUsageData=function(){var t={},n=this.get_timings();return t.a=this.get_usageReadyUrl(),t.b=n.initiatorType,t.c=this.round(n.redirectStart),t.d=this.round(n.redirectEnd),t.e=this.round(n.fetchStart),t.f=this.round(n.domainLookupStart),t.g=this.round(n.domainLookupEnd),t.h=this.round(n.connectStart),t.i=this.round(n.connectEnd),t.j=void 0!==n.secureConnectionStart&&null!==n.secureConnectionStart?this.round(n.secureConnectionStart):0,t.k=this.round(n.requestStart),t.l=this.round(n.responseStart),t.m=this.round(n.responseEnd),t.o=this.round(e.getRawField(n,"decodedBodySize")),t.p=this.round(e.getRawField(n,"encodedBodySize")),t.q=this.round(e.getRawField(n,"transferSize")),t.n=this.get_customText(),t},e.prototype.round=function(e){return Math.round(1e3*e)/1e3},e.getRawField=function(e,t){return e[t]},e}();(0,o.l)(xn,"ResourceTimingEntry",null,[wn]);var Fn=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=100),this._appMonitoredStaticResources=null,this._staticResourceHostAllowList=null,this._aggregatedStaticResourceMetrics=null,this._cacheThresholdInMs=0,this._appMonitoredStaticResources=e,this._staticResourceHostAllowList=t,this._aggregatedStaticResourceMetrics={},this._cacheThresholdInMs=n}return e.prototype.tryAggregateResourceTiming=function(e){var t=e.name.toLowerCase(),n=tt.n.getPageName(t);if(this.resourceTimingShouldBeAggregated(n,t)){if(n in this._aggregatedStaticResourceMetrics)return C.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",n),!1;var r={};return r.fetchstart=e.fetchStart,r.responseend=e.responseEnd,r.iscached=this.isTimingCached(e),r.encodedsize=xn.getRawField(e,"encodedBodySize"),r.decodedsize=xn.getRawField(e,"decodedBodySize"),this._aggregatedStaticResourceMetrics[n]=r,!0}return!1},e.prototype.resourceTimingShouldBeAggregated=function(e,t){if(this._appMonitoredStaticResources)return Array.contains(this._appMonitoredStaticResources,e);if(this._staticResourceHostAllowList)for(var n=tt.n.getHostname(t),r=0;r<this._staticResourceHostAllowList.length;r++)if(this._staticResourceHostAllowList[r]&&n.endsWith(this._staticResourceHostAllowList[r]))return!0;return!1},e.prototype.isTimingCached=function(e){try{var t=xn.getRawField(e,"transferSize");return t?!t:(C.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration"),e.responseEnd-e.fetchStart<this._cacheThresholdInMs)}catch(e){C.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",e.message)}return!1},e.prototype.getAggregatedResourceMetrics=function(){return this._aggregatedStaticResourceMetrics},e}();(0,o.l)(Fn,"AppStaticResourceManager",null,[]);var En=function(e){function t(t){var n=e.call(this)||this;return n.entries=null,n.entries=t,n}return(0,S.t)(t,e),t.prototype.get_entries=function(){return this.entries},t}(Sys.EventArgs);(0,o.l)(En,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var Pn=function(){function e(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=100),this._taskManager=null,this._isTaskSet=!1,this._task=null,this._currentEntryIndex=0,this._domainAllowListManager=null,this._appStaticResourceManager=null,this.defaultBehavior=0,this.isActive=!1,this.timerInterval=0,this.usageLogger=null,this._eventSource=new bt.f,this._taskManager=e,this.defaultBehavior=0,this.usageLogger=this,this._domainAllowListManager=new vn(t),n&&(this._appStaticResourceManager=new Fn(null,n,r))}return e.prototype.get_defaultBehavior=function(){return this.defaultBehavior},e.prototype.get_isActive=function(){return this.isActive},e.prototype.get_timerInterval=function(){return this.timerInterval},e.prototype.add_entriesAvailable=function(t){this._eventSource.addHandler(e.entriesAvailableEventKey,t)},e.prototype.remove_entriesAvailable=function(t){this._eventSource.removeHandler(e.entriesAvailableEventKey,t)},e.prototype.configure=function(e,t){var n=this.get_timerInterval()!==e;this.timerInterval=e,this.get_isActive()&&this._taskManager&&n&&(this.deleteTask(),this.addTask()),this.defaultBehavior=t},e.prototype.activate=function(){this.get_isActive()||e.get_browserSupportsPerformanceTimeline()&&(this.addTask(),this.isActive=!0)},e.prototype.deactivate=function(e){this.get_isActive()&&(this.deleteTask(),e&&this.flush(),this.isActive=!1)},e.prototype.flush=function(){if(this.get_isActive()&&e.get_browserSupportsPerformanceTimeline())try{var t=window.performance.getEntriesByType("resource");t.length-this._currentEntryIndex>0&&C.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",t.length-this._currentEntryIndex);var n=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);n&&(window.performance.clearResourceTimings(),this._currentEntryIndex=0);for(var r=[],i=this._currentEntryIndex;i<t.length;i++)this._domainAllowListManager.isDomainAllowed(t[i].name)&&(this._appStaticResourceManager&&this._appStaticResourceManager.tryAggregateResourceTiming(t[i]),r.push(new xn(t[i],this.get_defaultBehavior())));n||(this._currentEntryIndex=t.length),this._eventSource.raiseEvent(e.entriesAvailableEventKey,new En(r));for(i=0;i<r.length;i++)r[i].get_behavior()&&2!==r[i].get_behavior()||this.usageLogger.logData(0,r[i].toUsageData());r.length>0&&C.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",r.length)}catch(e){C.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",e)}},e.prototype.logData=function(e,t,n){void 0===n&&(n=!1),C.ULS.sendTraceTag(4310804,306,50,Sn(e,t))},e.prototype.getAppResourceTimingMetrics=function(){return this._appStaticResourceManager.getAggregatedResourceMetrics()},e.prototype.addTask=function(){var e=this;this._taskManager&&this.get_timerInterval()>0&&(this._task=new De.c(3,2,1e3*this.get_timerInterval(),(function(){e.flush()}),5),this._taskManager.addTask(this._task),this._isTaskSet=!0)},e.prototype.deleteTask=function(){this._isTaskSet&&(this._taskManager.deleteTask(this._task),this._task=null,this._isTaskSet=!1)},e.get_browserSupportsPerformanceTimeline=function(){try{return!(void 0===window.performance||null===window.performance||void 0===window.performance.getEntriesByType||null===window.performance.getEntriesByType)}catch(e){return C.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",e),!1}},e.entriesAvailableEventKey="EntriesAvailable",e}();(0,o.l)(Pn,"ResourceTimingLogger",null,[yn.t,Cn]);var kn=n(6276),Dn=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.ResourceTiming"},e.prototype.init=function(){this._container.resolve(yn.t),In.get_instance().run()},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e;var t=null;if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ResourceLoggerFilterDomainsIsEnabled"))try{t=L.AFrameworkApplication.appSettingsManager.getListAppSetting("ResourceLoggerDomainAllowList")}catch(e){C.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}var n=[];n.push(tt.n.getHostname(kn.h.staticContentHost).toLowerCase()),n.push(tt.n.getHostname(kn.h.sharedStaticContentHost).toLowerCase());var r=L.AFrameworkApplication.appSettingsManager.getIntAppSetting("AppStaticResourceMonitorCacheThresholdInMs",100);e.register(yn.t).singleInstance().usingFactory((function(){return new Pn(L.AFrameworkApplication.get_theTaskManager(),t,n,r)}))},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Dn,"ResourceTimingPackage",null,[l.u,c.s]);var Mn,Rn=(0,o.y)("INewAndOpenCommonHelpers"),Ln=n(6354),Nn=(0,o.y)("IMruResult"),Bn=n(2408),On=function(){function e(t){o.m(this,e.$$(t)),this._activeEventReceivers={}}return e.prototype.activateEventReceiver=function(e){this._activeEventReceivers[e.get_id().toString()]=e},e.prototype.notifyAndDeactivateActiveEventReceivers=function(e){var t=this._activeEventReceivers;for(var n in t){({key:n,value:t[n]}).value.notify(e,!1)}this._activeEventReceivers={}},e.prototype.queryForResult=function(e,t){return t&&this.activateEventReceiver(t),this.onResultRequested(e,t)},e.prototype.emitDeferredResultToWaitingReceivers=function(e){this.notifyAndDeactivateActiveEventReceivers(e)},e.prototype.emitAvailableResultToReceiver=function(e,t){e.notify(t,!0)},e.$$=function(t){var n="AEventEmitter$1$"+t.getName(),r=o.x(n);return r||o.u(n,"Common.App.NewAndOpen.Core.AEventEmitter$1",e,[{T:t}],null,[Bn.o.$$(t)])},e}(),Un=(0,o.y)("IEventResult");!function(e){e[e.notStarted=0]="notStarted",e[e.waiting=1]="waiting",e[e.shouldRetry=2]="shouldRetry",e[e.complete=3]="complete"}(Mn||(Mn={})),(0,o.h)("EventResultState",Mn);var Hn=function(){function e(){this._state=0}return e.prototype.get_state=function(){return this._state},e.prototype.set_state=function(e){return C.ULS.sendTraceTag(5849616,202,50,"Changing event result state. {0}",{OldState:Mn[this._state],NewState:Mn[e]},"ResultType",this.getResultLogString()),this._state=e,e},e}();(0,o.l)(Hn,"AEventResult",null,[Un]);var Gn=function(e){function t(){var t=e.call(this)||this;return t.$$pf_PersonalFileStorageUrl=null,t.$$pf_StorageServiceDisplayName=null,t.$$pf_InstantiatingPersonalStorage=!1,t.$$pf_InvalidResponse=!1,t.set_state(0),t.set_instantiatingPersonalStorage(!1),t.set_invalidResponse(!1),t}return(0,S.t)(t,e),t.prototype.get_personalFileStorageUrl=function(){return this.$$pf_PersonalFileStorageUrl},t.prototype.set_personalFileStorageUrl=function(e){return this.$$pf_PersonalFileStorageUrl=e,e},t.prototype.get_storageServiceDisplayName=function(){return this.$$pf_StorageServiceDisplayName},t.prototype.set_storageServiceDisplayName=function(e){return this.$$pf_StorageServiceDisplayName=e,e},t.prototype.get_instantiatingPersonalStorage=function(){return this.$$pf_InstantiatingPersonalStorage},t.prototype.set_instantiatingPersonalStorage=function(e){return this.$$pf_InstantiatingPersonalStorage=e,e},t.prototype.get_invalidResponse=function(){return this.$$pf_InvalidResponse},t.prototype.set_invalidResponse=function(e){return this.$$pf_InvalidResponse=e,e},t.prototype.getResultLogString=function(){return"GetMoreInfo Result"},t}(Hn);(0,o.l)(Gn,"GetMoreInfoResult",Hn,[Ln.c,Un]);var Vn=n(1496),Wn=n(8367),zn=n(6379),Kn=n(2271),qn=n(3323),jn=n(8371),$n=function(){function e(e,t,n,r,i,o,a,s){this._actionManager=null,this._clientRequestManager=null,this._appFrame=null,this._appType=null,this._taskManager=null,this._getCurrentTime=null,this._handlerUrlPrefix=null,this._supportsGetMoreInfoForPersonalStorage=null,this._actionManager=e,this._clientRequestManager=t,this._appFrame=n,this._appType=r,this._taskManager=i,this._getCurrentTime=o,this._handlerUrlPrefix=a,this._supportsGetMoreInfoForPersonalStorage=s}return e.prototype.registerCommonActions=function(){this.get_newAndOpenActionManager().addAction(te.MR,nt.a,o.i(this,this.openUrlInNewTab,"openUrlInNewTab")),this.get_newAndOpenActionManager().addAction(te.bW,nt.a,o.i(this,this.navigateUrlInNewTab,"navigateUrlInNewTab")),L.AFrameworkApplication.get_documentLoadedTime()?this.logNewAndOpenPerfStats():this.get_newAndOpenActionManager().addActionWithFlags(te.uU,nt.a,o.i(this,this.documentLoaded,"documentLoaded"),96)},e.prototype.openUrlInNewTab=function(e,t,n,r,i){var o=i;if(i&&o.MenuItemId){C.ULS.sendTraceTag(5849678,202,50,"Opening new tab {0}",{Id:o.SourceControlId,AppType:jn.k[this.get_newAndOpenOfficeAppType()]});var a=o.MenuItemId.toString(),s=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacInTabOpenMRUIsEnabledForUiHost"),l=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UiHostSupportsDocRebootFeatures");if(C.ULS.sendTraceTag(51517595,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",s,l),s&&l){var c={};c[qn.t.rebootMode]="1",c[qn.t.documentUrl]=a,C.ULS.sendTraceTag(51247010,202,50,"Send PostMessage to the Ui host to reboot a document"),L.AFrameworkApplication.get_hostPostmessengerFuture().execute((function(e){e.sendMessage(Me.a.documentRefresh,c)}))}else window.open(a,"_blank")}return 32},e.prototype.navigateUrlInNewTab=function(e,t,n,r,i){var o=i;if(i&&o.MenuItemId){C.ULS.sendTraceTag(0,202,50,"Opening new tab {0}",{Id:o.SourceControlId,AppType:jn.k[this.get_newAndOpenOfficeAppType()]});var a=o.MenuItemId.toString();window.open(a,"_blank")}return 32},e.prototype.documentLoaded=function(e,t,n,r,i){return this.logNewAndOpenPerfStats(),32},e.prototype.logRequest=function(e,t,n){if(void 0===n&&(n=""),t&&t.invokedTime){var r=Kn.e[t.status],i=t.invokedTime.getTime(),o=this.get_getCurrentTime()()-i;C.ULS.sendTraceTag(5849679,202,50,"Making request to the WAC server {0}",{Caller:e,RequestStatus:r,ElapsedMs:o,StartTime:i,Notes:n})}else C.ULS.sendTraceTag(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{Caller:e})},e.prototype.logNewAndOpenPerfStats=function(){var e=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("QPGVCI"),t=tt.n.getParameterValue(document.URL,"wdNewAndOpenCt",e);if(t){var n=parseInt(t),r=tt.n.getParameterValue(document.URL,"wdPreviousSession",e),i=tt.n.getParameterValue(document.URL,"wdPreviousCorrelation",e),o=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NAOPLP");if(L.AFrameworkApplication.get_documentLoadedTime()){var a=L.AFrameworkApplication.get_documentLoadedTime().getTime();!n||n>a?C.ULS.sendTraceTag(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{ClickTimestamp:n,DocumentLoadedTime:a,SessionId:r,Correlation:i}):C.ULS.sendTraceTag(5849683,202,o?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",{ClickToLoadTime:a-n,ClickTimestamp:n,SessionId:r,Correlation:i})}else C.ULS.sendTraceTag(5849681,202,o?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{ClickTimestamp:n,SessionId:r,Correlation:i})}},e.prototype.get_newAndOpenActionManager=function(){return this._actionManager.get_value()},e.prototype.get_newAndOpenClientRequestManager=function(){return this._clientRequestManager.get_value()},e.prototype.get_newAndOpenAppFrame=function(){return this._appFrame.get_value()},e.prototype.get_newAndOpenOfficeAppType=function(){return this._appType.get_value()},e.prototype.get_newAndOpenTaskManager=function(){return this._taskManager.get_value()},e.prototype.get_getCurrentTime=function(){return this._getCurrentTime},e.prototype.get_newAndOpenHandlerUrlPrefix=function(){return this._handlerUrlPrefix.get_value()},e.prototype.get_supportsGetMoreInfoForPersonalStorage=function(){return this._supportsGetMoreInfoForPersonalStorage.get_value()},e.get_instance=function(){return e._instance||(e._instance=e.getAnInstanceWithResolvedDependencies())},e.getAnInstanceWithResolvedDependencies=function(){return new e(new yt.q(Vn.v,(function(){return L.AFrameworkApplication.get_theActionManager()})),new yt.q(Wn.u,(function(){return L.AFrameworkApplication.theClientRequestManager})),new yt.q(_t.l,(function(){return L.AFrameworkApplication.get_activeFrame()})),new yt.q(jn.k,(function(){return L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()})),new yt.q(zn.h,(function(){return L.AFrameworkApplication.get_theTaskManager()})),(function(){return(new Date).getTime()}),new yt.q(String,(function(){return L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_newAndOpenHandlerUrlPrefix()})),new yt.q(Boolean,(function(){return L.AFrameworkApplication.get_supportsGetMoreInfoForPersonalStorage()})))},e._instance=null,e}();(0,o.l)($n,"NewAndOpenCommonHelpers",null,[Rn]);var Qn=function(){function e(e,t,n){this._task=null,this._serverRetryIntervalsInMsString=null,this._serverRetryIntervalsInMsIntList=null,this._descriptionString="",this._taskManager=null,this.retryIndex=0,this._serverRetryIntervalsInMsString=e,this._taskManager=t,this._descriptionString=n}return e.prototype.advanceRetryIndex=function(){this.retryIndex=this.get_retryIndex()+1},e.prototype.resetRetryState=function(e){this._task&&(this._taskManager.deleteTask(this._task),this._task=null),e&&(this.retryIndex=0)},e.prototype.startNextRetryTask=function(e){var t=this.get_timeUntilNextRetryInMs(),n=t>=0;return n?(this.advanceRetryIndex(),this.resetRetryState(!1),this._task=new De.c(4,1,t,e,107),this._taskManager.addTask(this._task)):(this.resetRetryState(!0),C.ULS.sendTraceTag(5849676,202,50,"Retries exhausted {0}",{Action:this._descriptionString})),n},e.prototype.get_retryIndex=function(){return this.retryIndex},e.prototype.get_timeUntilNextRetryInMs=function(){return this.get_retryIndex()>=this.get_serverRetryIntervalsInMsIntList().length?-1:this.get_serverRetryIntervalsInMsIntList()[this.get_retryIndex()]},e.prototype.get_serverRetryIntervalsInMsIntList=function(){if(!this._serverRetryIntervalsInMsIntList){var e=(this._serverRetryIntervalsInMsString.get_value()||"0").split(",");this._serverRetryIntervalsInMsIntList=[];for(var t=0;t<e.length;t++){var n=parseInt(e[t]);isNaN(n)?C.ULS.sendTraceTag(5849677,202,15,"Retry interval list contains non-number element {0}",{Action:this._descriptionString,Entry:e[t]}):Array.add(this._serverRetryIntervalsInMsIntList,n)}}return this._serverRetryIntervalsInMsIntList},e}();(0,o.l)(Qn,"RetryHelper",null,[]);var Jn=n(5866),Xn=function(e){function t(t,n){var r=e.call(this,Ln.c)||this;return r._newAndOpenCommonHelpers=null,r._retryHelper=null,r._result=null,r._newAndOpenCommonHelpers=t,r._retryHelper=new Qn(n,r.get_moreInfoNewAndOpenCommonHelpers().get_newAndOpenTaskManager(),"GetMoreInfo"),r._result=new Gn,r}return(0,S.t)(t,e),t.prototype.makeGetMoreInfoRequestOpenDocumentTrigger=function(){this.makeGetMoreInfoRequestInternal("Document opened")},t.prototype.createMakeGetMoreInfoRequestRetryTask=function(e){var t=this;return function(n){t.makeGetMoreInfoRequestInternal(e,!0)}},t.prototype.onResultRequested=function(e,t){return void 0===t&&(t=null),C.ULS.sendTraceTag(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{Trigger:e}),3===this._result.get_state()?(t&&this.emitAvailableResultToReceiver(t,this._result),C.ULS.sendTraceTag(5849619,202,50,"GetMoreInfo already populated. {0}",{Trigger:e})):this.makeGetMoreInfoRequestInternal(e),this._result},t.prototype.makeGetMoreInfoRequestInternal=function(e,n){if(void 0===n&&(n=!1),this._retryHelper.resetRetryState(!n),1!==this._result.get_state()){C.ULS.sendTraceTag(5849621,202,50,"Making GetMoreInfo request {0}",{Trigger:e,RetryIndex:this._retryHelper.get_retryIndex()}),this._result.set_state(1);var r=String.format("{0}GetMoreInfoHandler.ashx?{1}",this.get_moreInfoNewAndOpenCommonHelpers().get_newAndOpenHandlerUrlPrefix(),L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion);this.get_moreInfoNewAndOpenCommonHelpers().get_newAndOpenClientRequestManager().addRequestWithHeaderForwarding(r,1,null,null,[t._personalFileStorageUrlHeaderName,t._storageServiceDisplayNameHeaderName],!1,4,this.createGetMoreInfoFromServerSuccessCallback(e),this.createGetMoreInfoFromServerFailureCallback(e),null)}else C.ULS.sendTraceTag(5849620,202,50,"Not starting new request, because one is already in progress {0}",{Trigger:e,RetryIndex:this._retryHelper.get_retryIndex()})},t.prototype.createGetMoreInfoFromServerSuccessCallback=function(e){var n=this;return function(e){var r=!1,i=!1,o=!1,a=null;if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("GetMoreInfoDataFromResponseBody"))if(e.get_data().responseData)if(w.t(Object,e.get_data().responseData,(0,p.m)((function(){return a}),(function(e){return a=e})))){var s=a;s?(o=!0,n._result.set_storageServiceDisplayName(s.StorageServiceDisplayName),n._result.set_personalFileStorageUrl(t.isValidStorageHostUrl(s.PersonalFileStorageUrl)?s.PersonalFileStorageUrl:"")):C.ULS.sendTraceTag(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers")}else C.ULS.sendTraceTag(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers");else C.ULS.sendTraceTag(25298083,202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");if(!o){var l=e.get_data().responseHeaders;if(l){n._result.set_storageServiceDisplayName((l[t._storageServiceDisplayNameHeaderName]||"").toString());var c=(l[t._personalFileStorageUrlHeaderName]||"").toString();n._result.set_personalFileStorageUrl(t.isValidStorageHostUrl(c)?c:""),r=""===c&&""!==n._result.get_storageServiceDisplayName()}else C.ULS.sendTraceTag(5849622,202,50,"Null response headers received."),i=!0}var u=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",n._retryHelper.get_retryIndex(),i,r,o);n.get_moreInfoNewAndOpenCommonHelpers().logRequest("GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",e.get_data(),u),n.setAndEmitResultState(3,r,i)}},t.prototype.createGetMoreInfoFromServerFailureCallback=function(e){var t=this;return function(n){t.get_moreInfoNewAndOpenCommonHelpers().logRequest("GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",n.get_data(),"Failure"),t.setAndEmitResultState(2),t._retryHelper.startNextRetryTask(t.createMakeGetMoreInfoRequestRetryTask(e))}},t.prototype.setAndEmitResultState=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=!1),this._result.set_state(e),this._result.set_instantiatingPersonalStorage(t),this._result.set_invalidResponse(n),this.emitDeferredResultToWaitingReceivers(this._result)},t.prototype.get_moreInfoNewAndOpenCommonHelpers=function(){return this._newAndOpenCommonHelpers.get_value()},t.get_instance=function(){return t._instance||(t._instance=t.getAnInstanceWithResolvedDependencies())},t.getAnInstanceWithResolvedDependencies=function(){return new t(new yt.q(Rn,(function(){return $n.get_instance()})),new yt.q(String,(function(){return L.AFrameworkApplication.get_getMoreInfoRetryIntervalsInMs()})))},t.isValidStorageHostUrl=function(e){return e?!!Jn.l.toLower(e).startsWith("https://")||(C.ULS.sendTraceTag(5849625,202,10,"StorageUrl has invalid scheme."),!1):(C.ULS.sendTraceTag(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1)},t._personalFileStorageUrlHeaderName="PersonalFileStorageUrl",t._storageServiceDisplayNameHeaderName="StorageServiceDisplayName",t._instance=null,t}(On);(0,o.l)(Xn,"GetMoreInfoActor",On.$$(Ln.c),[]);var Yn=function(){function e(e,t,n,r,i){this._lastActivityTime=0,this._taskManager=null,this._getLatestActivityTime=null,this._getCurrentTime=null,this._timeUntilInactiveInMs=null,this._eventSource=null,this.inactiveActionId="inactive",this.activeActionId="active",this._isActive=!0,this._inactivityCheckInterval=6e4,this._taskManager=e,this._getLatestActivityTime=t,this._getCurrentTime=n,this._timeUntilInactiveInMs=r,this._eventSource=new bt.f,i&&this.startInactiveLoop(),this._lastActivityTime=this.get_getLatestActivityTime()()}return e.prototype.addBackFromInactiveAction=function(e){this._eventSource.addHandler(this.activeActionId,e)},e.prototype.addOnInactiveAction=function(e){this._eventSource.addHandler(this.inactiveActionId,e)},e.prototype.startInactiveLoop=function(){var e=new De.c(4,2,this._inactivityCheckInterval,o.i(this,this.inactiveLoop,"inactiveLoop"),108);this.get_inactivityTaskManager().addTask(e)},e.prototype.inactiveLoop=function(e){var t=this.get_getLatestActivityTime()(),n=this.get_getCurrentTime()()-t;n>this.get_timeUntilInactiveInMs()&&this._isActive&&(C.ULS.sendTraceTag(5849626,202,50,"User went inactive {0}",{TimeSinceLastActive:n}),this._isActive=!1,this._eventSource.raiseEvent(this.inactiveActionId)),t-this._lastActivityTime>this.get_timeUntilInactiveInMs()&&(this._isActive=!0,this._eventSource.raiseEvent(this.activeActionId)),this._lastActivityTime=t},e.prototype.get_inactivityTaskManager=function(){return this._taskManager.get_value()},e.prototype.get_getLatestActivityTime=function(){return this._getLatestActivityTime},e.prototype.get_getCurrentTime=function(){return this._getCurrentTime},e.prototype.get_timeUntilInactiveInMs=function(){return this._timeUntilInactiveInMs.get_value()},e.get_instance=function(){return e._instance||(e._instance=e.getAnInstanceWithResolvedDependencies())},e.getAnInstanceWithResolvedDependencies=function(){return new e(new yt.q(zn.h,(function(){return Oe.y.get_instance()})),(function(){return L.AFrameworkApplication.get_latestActivityTime().getTime()}),(function(){return(new Date).getTime()}),new yt.q(Number,(function(){return L.AFrameworkApplication.get_timeUntilInactiveInMs()})),!0)},e._instance=null,e}();(0,o.l)(Yn,"InactivityManager",null,[]);var Zn=function(e){function t(){var t=e.call(this)||this;return t.$$pf_MruEntries=null,t.$$pf_TimestampOfLastUpdate=0,t.$$pf_InvalidResponse=!1,t.set_state(0),t.set_invalidResponse(!1),t}return(0,S.t)(t,e),t.prototype.get_mruEntries=function(){return this.$$pf_MruEntries},t.prototype.set_mruEntries=function(e){return this.$$pf_MruEntries=e,e},t.prototype.get_timestampOfLastUpdate=function(){return this.$$pf_TimestampOfLastUpdate},t.prototype.set_timestampOfLastUpdate=function(e){return this.$$pf_TimestampOfLastUpdate=e,e},t.prototype.get_invalidResponse=function(){return this.$$pf_InvalidResponse},t.prototype.set_invalidResponse=function(e){return this.$$pf_InvalidResponse=e,e},t.prototype.getResultLogString=function(){return"MruActor Result"},t}(Hn);(0,o.l)(Zn,"MruResult",Hn,[Nn,Un]);var er=n(5288),tr=function(e){function t(t,n,r,i,o){var a=e.call(this,Nn)||this;return a._newAndOpenCommonHelpers=null,a._localeName=null,a._writeFileIdInHeader=!1,a._mruResult=null,a._readRetryHelper=null,a._writeRetryHelper=null,a.writeHeaders=null,a.renameMruEntryAction="RenameMruEntry",a.updateMruEntryAction="UpdateMruEntry",a._newAndOpenCommonHelpers=t,a._localeName=n,a._readRetryHelper=new Qn(r,a.get_openMenuNewAndOpenCommonHelpers().get_newAndOpenTaskManager(),"Read"),a._writeRetryHelper=new Qn(i,a.get_openMenuNewAndOpenCommonHelpers().get_newAndOpenTaskManager(),"Write"),a._writeFileIdInHeader=o,a.writeHeaders={},a._mruResult=new Zn,a}return(0,S.t)(t,e),t.prototype.get_writeHeaders=function(){return this.writeHeaders},t.prototype.registerWriteMruActions=function(){this.get_openMenuNewAndOpenCommonHelpers().get_newAndOpenActionManager().addAction(te.rN,nt.a,o.i(this,this.renameMruEntry,"renameMruEntry"))},t.prototype.renameMruEntry=function(e,n,r,i,o){var a=o;return a?a.newDocumentDAVUrl?a.newFileName?a.currentDocumentDAVUrl?(this.get_writeHeaders()[t.currentDocumentDAVUrlHeaderName]=this.get_writeHeaders()[t.currentDocumentDAVUrlHeaderName]||Jn.l.urlKeyValueEncode(a.currentDocumentDAVUrl),this.get_writeHeaders()[t.newDocumentDAVUrlHeaderName]=Jn.l.urlKeyValueEncode(a.newDocumentDAVUrl),this.get_writeHeaders()[t.newFileNameHeaderName]=Jn.l.urlKeyValueEncode(a.newFileName),C.ULS.sendTraceTag(5849669,202,50,"Starting rename of MRU entry {0}",{Trigger:"Rename"}),this.writeToMruInternal("Rename",this.renameMruEntryAction)):(C.ULS.sendTraceTag(5849668,202,15,"Failure to rename MRU entry {0}",{Error:"Null CurrentDocumentDAVUrl"}),8):(C.ULS.sendTraceTag(5849667,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewFileName"}),8):(C.ULS.sendTraceTag(5849666,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewDocumentDAVUrl"}),8):32},t.prototype.makeUpdateMruRequestOpenTrigger=function(){this.makeUpdateMruRequestInternal("File Opened")},t.prototype.makeUpdateMruRequestInactivityTrigger=function(){this.makeUpdateMruRequestInternal("Inactivity")},t.prototype.makeUpdateMruRequestBackFromInactivityTrigger=function(){this.makeUpdateMruRequestInternal("Back from Inactivity")},t.prototype.makeUpdateMruRequestInternal=function(e){C.ULS.sendTraceTag(5849670,202,50,"Starting update of MRU entry {0}",{Trigger:e}),this.writeToMruInternal(e,this.updateMruEntryAction)},t.prototype.writeToMruInternal=function(e,n,r){if(void 0===r&&(r=!1),4===this.get_openMenuNewAndOpenCommonHelpers().get_newAndOpenOfficeAppType()&&!L.AFrameworkApplication.get_documentIsFolder())return 2;var i;this.get_writeHeaders()[t.newDocumentDAVUrlHeaderName]&&this.get_writeHeaders()[t.currentDocumentDAVUrlHeaderName]!==this.get_writeHeaders()[t.newDocumentDAVUrlHeaderName]?i=this.renameMruEntryAction:(i=this.updateMruEntryAction,delete this.get_writeHeaders()[t.newDocumentDAVUrlHeaderName]),C.ULS.sendTraceTag(5849673,202,50,"Writing to MRU {0}",{Trigger:e,IntendedActionType:n,ActualActionType:i}),this._writeRetryHelper.resetRetryState(!r);var a=String.format(this.get_openMenuNewAndOpenCommonHelpers().get_newAndOpenHandlerUrlPrefix()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}",i,this.get_openMenuNewAndOpenCommonHelpers().get_newAndOpenOfficeAppType(),this.get_localeName());return this._writeFileIdInHeader?this.get_writeHeaders()["X-FileId"]=L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion:a+=String.format("&{0}",L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion),this.get_openMenuNewAndOpenCommonHelpers().get_newAndOpenClientRequestManager().addRequest(a,2,null,this.get_writeHeaders(),!0,4,o.i(this,this.writeMruEntryOnServerSuccessCallback,"writeMruEntryOnServerSuccessCallback"),this.createWriteMruEntryOnServerFailureCallback(n),null,void 0,void 0,void 0,void 0,"4")},t.prototype.writeMruEntryOnServerSuccessCallback=function(e){this.get_openMenuNewAndOpenCommonHelpers().logRequest("MruActor.WriteMruEntryOnServerSuccessCallback",e.get_data(),"Success"),this._writeRetryHelper.resetRetryState(!0);var n=(e.get_data().request.get_headers()[t.newDocumentDAVUrlHeaderName]||"").toString();""!==n&&(this.get_writeHeaders()[t.currentDocumentDAVUrlHeaderName]=n)},t.prototype.createWriteMruEntryOnServerFailureCallback=function(e){var t=this;return function(n){t.get_openMenuNewAndOpenCommonHelpers().logRequest("MruActor.WriteMruEntryOnServerFailureCallback",n.get_data(),"Failure"),n.get_data().httpStatus!==re.Fc&&t._writeRetryHelper.startNextRetryTask(t.createWriteRetryTask(e))}},t.prototype.createWriteRetryTask=function(e){var t=this;return function(n){t.writeToMruInternal("Retry",e,!0)}},t.prototype.getMruFromServerTask=function(e){this.makeGetMruRequestInternal("Polling")},t.prototype.getMruFromServerRetryTask=function(e){this.makeGetMruRequestInternal("Retry",!0)},t.prototype.makeGetMruRequestOpenTrigger=function(){this.makeGetMruRequestInternal("Open")},t.prototype.makeGetMruRequestActivityTrigger=function(){this.makeGetMruRequestInternal("Activity")},t.prototype.makeGetMruRequestInternal=function(e,t){void 0===t&&(t=!1),C.ULS.sendTraceTag(5849674,202,50,"Making GetMru request {0}",{Trigger:e}),this._readRetryHelper.resetRetryState(!t),this.createGetMruServerRequest(o.i(this,this.getMruFromServerSuccessCallback,"getMruFromServerSuccessCallback"),o.i(this,this.getMruFromServerFailureCallback,"getMruFromServerFailureCallback"),"getmru")},t.prototype.getMruFromServerSuccessCallback=function(e){var t=e.get_data().responseData;L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactFileMenuUxEnabled()&&er.appChromeAlreadyLoaded()&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(t)),this._readRetryHelper.resetRetryState(!0);var n=null;t&&(n=this.tryDeserializeJson(t)),n?(this.updateMruResultState(3,n),this.get_openMenuNewAndOpenCommonHelpers().logRequest("MruActor.GetMruFromServerSuccessCallback",e.get_data(),"Success")):(this.get_openMenuNewAndOpenCommonHelpers().logRequest("MruActor.GetMruFromServerSuccessCallback",e.get_data(),"Failure: Invalid JSON"),this.updateMruResultState(3,null,!0)),this.emitDeferredResultToWaitingReceivers(this._mruResult)},t.prototype.getMruFromServerFailureCallback=function(e){this.get_openMenuNewAndOpenCommonHelpers().logRequest("MruActor.GetMruFromServerFailureCallback",e.get_data(),"Failure"),this.updateMruResultState(2),this._readRetryHelper.startNextRetryTask(o.i(this,this.getMruFromServerRetryTask,"getMruFromServerRetryTask"))||this._readRetryHelper.resetRetryState(!0),this.emitDeferredResultToWaitingReceivers(this._mruResult)},t.prototype.updateMruResultState=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1),3===this._mruResult.get_state()&&3!==e||(this._mruResult.set_mruEntries(t),this._mruResult.set_state(e),this._mruResult.set_invalidResponse(n),this._mruResult.set_timestampOfLastUpdate(this.get_openMenuNewAndOpenCommonHelpers().get_getCurrentTime()()))},t.prototype.onResultRequested=function(e,t){return C.ULS.sendTraceTag(6029918,202,50,"MRU result requested {0}",{Trigger:e,ResultState:this._mruResult.get_state()}),t&&3===this._mruResult.get_state()&&this.emitAvailableResultToReceiver(t,this._mruResult),this._mruResult},t.prototype.createGetMruServerRequest=function(e,t,n){this.updateMruResultState(1);var r=String.format(this.get_openMenuNewAndOpenCommonHelpers().get_newAndOpenHandlerUrlPrefix()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}",n,this.get_openMenuNewAndOpenCommonHelpers().get_newAndOpenOfficeAppType(),this.get_localeName()),i=null;this._writeFileIdInHeader?(i={})["X-FileId"]=L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion:r+=String.format("&{0}",L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion),this.get_openMenuNewAndOpenCommonHelpers().get_newAndOpenClientRequestManager().addRequest(r,1,null,i,!0,4,e,t,null)},t.prototype.tryDeserializeJson=function(e){var t;try{t=w.b(e)}catch(e){t=null,C.ULS.sendTraceTag(5849675,202,10,"MruActor.TryDeserializeJson: Exception thrown from JsonSerializer.SecureDeserialize Exception: {0}",e)}return t},t.prototype.get_openMenuNewAndOpenCommonHelpers=function(){return this._newAndOpenCommonHelpers.get_value()},t.prototype.get_localeName=function(){return this._localeName.get_value()},t.get_instance=function(){return t._instance||(t._instance=t.getAnInstanceWithResolvedDependencies())},t.getAnInstanceWithResolvedDependencies=function(){return new t(new yt.q(Rn,(function(){return $n.get_instance()})),new yt.q(String,(function(){return Kt.i.getCultureInfo(L.AFrameworkApplication.lcid).get_name()})),new yt.q(String,(function(){return L.AFrameworkApplication.appSettingsManager.getStringAppSetting("MruServerReadRetryIntervalsInMs")})),new yt.q(String,(function(){return L.AFrameworkApplication.appSettingsManager.getStringAppSetting("MruServerWriteRetryIntervalsInMs")})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MruWriteFileIdInHeader"))},t.currentDocumentDAVUrlHeaderName="CurrentDocumentDAVUrl",t.newDocumentDAVUrlHeaderName="NewDocumentDAVUrl",t.newFileNameHeaderName="NewFileName",t._instance=null,t}(On);(0,o.l)(tr,"MruActor",On.$$(Nn),[]);var nr=function(){function e(){this._container=null,this._readFromMruTask=null}return e.prototype.get_name=function(){return"Common.App.NewAndOpen.Core"},e.prototype.configure=function(e){this._container=e,e.register(Rn).singleInstance().usingFactory((function(){return $n.get_instance()})),e.register(Bn.o.$$(Ln.c)).singleInstance().usingFactory((function(){return Xn.get_instance()})),e.register(Bn.o.$$(Nn)).singleInstance().usingFactory((function(){return tr.get_instance()}))},e.prototype.init=function(){var e=this;L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){e.initOnFullAppSettingsReady()}))},e.prototype.initOnFullAppSettingsReady=function(){this._container.resolve(Rn),this._container.resolve(Bn.o.$$(Ln.c)),this._container.resolve(Bn.o.$$(Nn));var e=!1;if($n.get_instance().registerCommonActions(),L.AFrameworkApplication.get_newDocumentDestinationHost()&&(e=!0),L.AFrameworkApplication.get_readFromMruIsEnabled()&&(tr.get_instance().makeGetMruRequestOpenTrigger(),L.AFrameworkApplication.get_mruPollingIntervalInMs()>0&&this.addGetMruFromServerTask(),this.setupReadFromMruInactivityActions(),e=!0),L.AFrameworkApplication.get_supportsGetMoreInfoForPersonalStorage()&&e&&Xn.get_instance().makeGetMoreInfoRequestOpenDocumentTrigger(),L.AFrameworkApplication.get_updateMruIsEnabled()){var t=tr.get_instance();t.registerWriteMruActions(),t.makeUpdateMruRequestOpenTrigger(),this.setupWriteToMruInactivityActions()}},e.prototype.setupReadFromMruInactivityActions=function(){Yn.get_instance().addBackFromInactiveAction(o.i(tr.get_instance(),tr.get_instance().makeGetMruRequestActivityTrigger,"makeGetMruRequestActivityTrigger")),Yn.get_instance().addBackFromInactiveAction(o.i(this,this.addGetMruFromServerTask,"addGetMruFromServerTask")),Yn.get_instance().addOnInactiveAction(o.i(this,this.deleteGetMruFromServerTask,"deleteGetMruFromServerTask"))},e.prototype.setupWriteToMruInactivityActions=function(){Yn.get_instance().addOnInactiveAction(o.i(tr.get_instance(),tr.get_instance().makeUpdateMruRequestInactivityTrigger,"makeUpdateMruRequestInactivityTrigger")),Yn.get_instance().addBackFromInactiveAction(o.i(tr.get_instance(),tr.get_instance().makeUpdateMruRequestBackFromInactivityTrigger,"makeUpdateMruRequestBackFromInactivityTrigger"))},e.prototype.deleteGetMruFromServerTask=function(){Oe.y.get_instance().deleteTask(this.get_mruReadTask())},e.prototype.addGetMruFromServerTask=function(){Oe.y.get_instance().addTask(this.get_mruReadTask())},e.prototype.get_mruReadTask=function(){return this._readFromMruTask||(this._readFromMruTask=new De.c(4,2,L.AFrameworkApplication.get_mruPollingIntervalInMs(),o.i(tr.get_instance(),tr.get_instance().getMruFromServerTask,"getMruFromServerTask"),109))},e.prototype.dispose=function(){},e}();(0,o.l)(nr,"CorePackageManager",null,[l.u,c.s,Sys.IDisposable]);var rr=n(4121),ir=(0,o.y)("IOneDriveApiEndpointHelper"),or=(0,o.y)("IErrorDialog"),ar=n(4609),sr=function(e){function t(){var t=e.call(this)||this;return t.set_buttonsOption(0),t.setButtonText(1,CommonUIStrings.l_DialogClose),t}return(0,S.t)(t,e),t.prototype.displayError=function(e){this.showError(e,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)},t.prototype.displayWarning=function(e){this.showError(e,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)},t}(ar.StandardDialog);(0,o.l)(sr,"ErrorDialog",ar.StandardDialog,[or]);var lr=function(){function e(){}return e.prototype.getApiEndpoint=function(){C.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var e=new wt.z(String);return e.setResult("api.onedrive.com"),e.get_task()},e}();(0,o.l)(lr,"OneDriveConsumerEndpointHelper",null,[ir]);var cr=n(7299),ur=function(e){function t(t,n,r,i,o,a){var s=e.call(this,n,r,i,a)||this;return s._signOutResponse=null,s._showRequireSignInDialog=null,s._options=null,s._signOutResponse=t,s._showRequireSignInDialog=o,s}return(0,S.t)(t,e),t.prototype.get_oneDriveApiUrl=function(){return this.get_appSettingsManager().getStringAppSetting("OneDriveApiUrl")},t.prototype.start=function(e,t){this._options=e,this.startPicker(t)},t.prototype.initializeApi=function(){var e=1===this.get_appEnvironment()||2===this.get_appEnvironment()?{client_id:this.get_appSettingsManager().get_appSettings().UploadToSkyDriveClientId}:{client_id:this.get_appSettingsManager().get_appSettings().UploadToSkyDriveClientId,env:"INT"};WL.init(e)},t.prototype.startPicker=function(e){this.onFilePickerClosedCallback=e,!this._limitedEdit&&this._signOutResponse.get_isAuthenticated()?(C.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(o.i(this,this.onApiReady,"onApiReady"))):(C.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this._showRequireSignInDialog())},t.prototype.launchFilePicker=function(){try{C.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this._options).then(o.i(this,this.onSuccess,"onSuccess"),o.i(this,this.onFailure,"onFailure"))}catch(e){C.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",e,e.stack),this.showErrorDialog()}},t.prototype.onFailure=function(e){var t=e;if(e&&t.error){if("user_canceled"===t.error.code)return void C.ULS.sendTraceTag(17909058,352,50,"User canceled.");C.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",t.error.code,t.error.message)}else C.ULS.sendTraceTag(17909060,352,50,"File Dialog returned with no response");this.onFilePickerClosedCallback&&this.onFilePickerClosedCallback(!1,e),this.showErrorDialog()},t}(cr.f);(0,o.l)(ur,"OneDriveFilePickerApiManagerV5",cr.f,[]);var gr=n(4583),pr=function(e){function t(t,n,r,i,a){var s=e.call(this,t,n,r,i)||this;return s._endpointHelper=null,s._oneDriveApiEndpoint=null,s._hostDivElement=null,s.options=null,s._endpointHelper=a,s.options={},s.options.clientId=s.get_appSettingsManager().getStringAppSetting("OneDriveApiV7ClientId"),s.options.cancel=o.i(s,s.toggleHostDivVisibility,"toggleHostDivVisibility"),s}return(0,S.t)(t,e),t.prototype.get_oneDriveApiUrl=function(){return this.get_appSettingsManager().getStringAppSetting("OneDriveApiV72Url")},t.prototype.start=function(e,t){var n=this;this._hostDivElement=t;var r=this._endpointHelper.getApiEndpoint();r.CWo((function(t){C.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker"),n._oneDriveApiEndpoint=r.get_result(),n.startPicker((function(t,r){n.toggleHostDivVisibility(),e(t,r)}))}),gr.d.onlyOnRanToCompletion),r.CWo((function(e){C.ULS.sendTraceTag(24134242,352,15,r.get_exception().message),n.toggleHostDivVisibility()}),gr.d.onlyOnFaulted)},t.prototype.initializeApi=function(){var e=this;this.options.success=function(t){var n={};n.data=t,e.onSuccess(n)},this.options.error=function(t){var n={};n.error=t,e.onFailure(n)},this.options.advanced={},this.options.advanced.linkType="share",this.options.advanced.endpointHint=this._oneDriveApiEndpoint,this.options.advanced.iframeParentDiv=this._hostDivElement},t.prototype.launchFilePicker=function(){try{C.ULS.sendTraceTag(22090007,352,50,"Launching OneDrive file picker dialog"),this.toggleHostDivVisibility(),OneDrive.open(this.options)}catch(e){C.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",e.message),this.showErrorDialog()}},t.prototype.onFailure=function(e){this.onFilePickerClosedCallback&&this.onFilePickerClosedCallback(!1,e),this.showErrorDialog()},t.prototype.toggleHostDivVisibility=function(){this._hostDivElement.style.visibility="hidden"===this._hostDivElement.style.visibility?"":"hidden"},t}(cr.f);(0,o.l)(pr,"OneDriveFilePickerApiManagerV7",cr.f,[]);var dr=n(8195),hr="folder,photo",_r="none",mr=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r,i)||this;return o.options.advanced.filter=t.getStringAppSetting("OneDriveApiV72Filter")||hr,o.options.advanced.linkType="download",o.options.multiSelect=L.AFrameworkApplication.appSupportsMultiInsertOnlinePictureFromHost,t.getBooleanAppSetting("OneDriveApiV72CommandModeEnabled")&&(o.options.commandMode=t.getStringAppSetting("OneDriveApiV72CommandMode")||_r),o}return(0,S.t)(t,e),t.prototype.get_oneDriveApiUrl=function(){return this.get_appSettingsManager().getStringAppSetting("OneDriveApiV72Url")},t.prototype.launchFilePicker=function(){try{C.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}",this.options.advanced.filter,this.options.commandMode),OneDrive.open(this.options)}catch(e){C.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",e.message,e.stack),this.showErrorDialog()}},t}(dr.f);(0,o.l)(mr,"OneDriveFilePickerApiOpenManagerV72",dr.f,[]);var fr=function(){function e(e){this._tcs=null,this._clientRequestManager=null,this._retriesRemaining=0,this._clientRequestManager=e,this._retriesRemaining=3}return e.prototype.getApiEndpoint=function(){return this._tcs=new wt.z(String),C.ULS.sendTraceTag(24134235,352,50,"Sending initial request for OneDrive for Business Endpoint"),this.sendGetMoreInfoRequest(),this._tcs.get_task()},e.prototype.sendGetMoreInfoRequest=function(e){void 0===e&&(e=null);var t=String.format("GetMoreInfoHandler.ashx?{0}",L.AFrameworkApplication.currentFileBaseDocQuerySignatureWithoutVersion);this._clientRequestManager.addRequestWithHeaderForwarding(t,1,null,e,["PersonalFileStorageUrl","X-NewKey"],!1,2,o.i(this,this.getMoreInfoSucceeded,"getMoreInfoSucceeded"),o.i(this,this.getMoreInfoFailed,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")},e.prototype.getMoreInfoFailed=function(e){if(e.get_data().httpStatus===re.Vu&&"X-NewKey"in e.get_data().responseHeaders){C.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var t={};t["X-Key"]=e.get_data().responseHeaders["X-NewKey"],this.sendGetMoreInfoRequest(t)}else this._retriesRemaining>0?(C.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this._retriesRemaining),this._retriesRemaining--,this.sendGetMoreInfoRequest()):(C.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this._tcs.SX(Error.create("GetMoreInfo request failed and no more retries remain")))},e.prototype.getMoreInfoSucceeded=function(e){"PersonalFileStorageUrl"in e.get_data().responseHeaders&&""!==e.get_data().responseHeaders.PersonalFileStorageUrl?(C.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this._tcs.setResult(e.get_data().responseHeaders.PersonalFileStorageUrl)):(C.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this._tcs.SX(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))},e}();(0,o.l)(fr,"OneDriveForBusinessEndpointHelper",null,[ir]);var yr=n(9060),Cr=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.OneDriveFilePickerApi"},e.prototype.init=function(){},e.prototype.dispose=function(){},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(ur).as(rr.v).singleInstance().usingFactory((function(){return new ur(yr.t.get_instance(),L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.get_environment(),L.AFrameworkApplication.limitedEdit,L.AFrameworkApplication.showRequiresSignInDialog,(function(){return new sr}))})),L.AFrameworkApplication.get_isSkyDrive()?this._container.register(ir).singleInstance().usingFactory((function(){return new lr})):this._container.register(ir).singleInstance().usingFactory((function(){return new fr(L.AFrameworkApplication.theClientRequestManager)})),this._container.register(pr).singleInstance().usingFactory((function(){return new pr(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.get_environment(),L.AFrameworkApplication.limitedEdit,(function(){return new sr}),t._container.resolve(ir))})),this._container.register(dr.f).singleInstance().usingFactory((function(){return new dr.f(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.get_environment(),L.AFrameworkApplication.limitedEdit,(function(){return new sr}))})),this._container.register(mr).singleInstance().usingFactory((function(){return new mr(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.get_environment(),L.AFrameworkApplication.limitedEdit,(function(){return new sr}))}))},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Cr,"PackageManager",null,[l.u,c.s]);var Sr=n(6314),vr=function(){return function(e,t,n,r,i){this.IsSafeLinksEnabled=null,this.WebAffinitizedUrl=null,this.PolicyCookie=null,this.PolicyCookieTTL=0,this.WasServiceDown=!1,this.IsSafeLinksEnabled=e,this.WebAffinitizedUrl=t,this.PolicyCookie=n,this.PolicyCookieTTL=r,this.WasServiceDown=i}}();(0,o.l)(vr,"SafeLinksData",null,[]);var br,Tr=function(){function e(){this._localStorageNotWorking=!1}return e.prototype.getItem=function(e){var t=this.getLocalStorage();if(!t)return null;try{return t.getItem(e)}catch(e){return null}},e.prototype.setItem=function(e,t){var n=this.getLocalStorage();if(n)try{n.setItem(e,t)}catch(e){}},e.prototype.removeItem=function(e){var t=this.getLocalStorage();if(t)try{t.removeItem(e)}catch(e){}},e.prototype.getLocalStorage=function(){var e=null;if(!this._localStorageNotWorking)try{localStorage&&(e=localStorage)}catch(e){this._localStorageNotWorking=!0}return e},e.get_instance=function(){return e._instance||(e._instance=new e),e._instance},e._instance=null,e}();(0,o.l)(Tr,"SafeLinksLocalStorage",null,[]),function(e){e[e.enabledByPolicy=0]="enabledByPolicy",e[e.disabledByPolicy=1]="disabledByPolicy",e[e.disabled_GetPolicyFailure=2]="disabled_GetPolicyFailure",e[e.disabled_PendingGetPolicyRequest=3]="disabled_PendingGetPolicyRequest"}(br||(br={})),(0,o.h)("SafeLinksNavigationState",br);var Ar=n(4090),Ir="MsoUrlreputation",wr=function(){function e(t,n,r,i,o,a){var s=this;if(void 0===i&&(i=!1),void 0===o&&(o=null),void 0===a&&(a=null),this._appSettingsManager=null,this._clientRequestManager=null,this.workloadId=null,this._webServiceBaseUrl=null,this._userId=null,this._appName=null,this._maxGetPolicyBootRetries=0,this._maxGetPolicyOnLinkClickRetries=0,this._getPolicyOnBootRetries=0,this._getPolicyOnLinkClickRetries=0,this._getPolicyRequestPending=!1,this.isGetPolicyBootRequest=!1,this._pendingUrlToFollow=null,this._isUserLicensedForSafeLinks=!0,this._isEnabledForUser=!1,this._isEnabledForBrowser=!1,this._sessionCacheSafeLinksData=null,C.ULS.sendTraceTag(26019598,378,100,"Initializing SafeLinksManager."),this._appSettingsManager=t,this._clientRequestManager=n,this._appName=r,e._stopwatchBuilder=a,this._webServiceBaseUrl=i?this._appSettingsManager.getStringAppSetting("SafeLinksHandlerWebServiceBase"):this._appSettingsManager.getStringAppSetting("WebServiceBase"),this._userId=this._appSettingsManager.getStringAppSetting("SafeLinksHashedUserId"),this.workloadId=this._appSettingsManager.getStringAppSetting("SafeLinksWorkloadIdHeaderValue"),this._maxGetPolicyBootRetries=this._appSettingsManager.getIntAppSetting("SafeLinksMaxGetPolicyBootRetries",2),this._maxGetPolicyOnLinkClickRetries=this._appSettingsManager.getIntAppSetting("SafeLinksMaxGetPolicyOnLinkClickRetries",1),this._isEnabledForUser=this.isSafeLinksEnabledForUser(),this._isEnabledForBrowser=this.isSafeLinksEnabledForBrowser(),C.ULS.sendTraceTag(26019599,378,50,"SafeLinksManager _isEnabledForUser={0}, _isEnabledForBrowser={1}",this._isEnabledForUser,this._isEnabledForBrowser),this._isEnabledForUser&&this._isEnabledForBrowser){var l=this.getCachedData(),c=l?l.IsSafeLinksEnabled.toLowerCase():"",u=this.isPolicyCookieExpired();C.ULS.sendTraceTag(36231312,378,50,"Cached values for IsSafeLinksEnabled: {0}, IsPolicyCookieExpired: {1}.",c,u);var g=!l||"unknown"===c||l.WasServiceDown||u,p=new Map;p.set("shouldGetSafeLinksDataFromServer",g.toString()),p.set("isSafeLinksEnabledCacheValue",c.toString()),oe.Health.get_instance().recordKpiUsage("SafeLinksGetPolicy",0,"jpittsdirects",p),g&&this.getSafeLinksDataFromServerAsync(!0),!!this._appSettingsManager.containsAppSetting("LicensingForSafeLinksIsEnabled")&&this._appSettingsManager.getBooleanAppSetting("LicensingForSafeLinksIsEnabled")&&o&&o.execute((function(e){e.isFeatureEnabled(Ir,!0).then((function(e){return s._isUserLicensedForSafeLinks=e,null}))}))}}return e.prototype.get_appName=function(){return this._appName},e.prototype.get_webServiceBaseUrl=function(){return this._webServiceBaseUrl},e.prototype.get_userId=function(){return this._userId},e.prototype.get_getPolicyHandlerUrl=function(){var e=this.get_webServiceBaseUrl()?this.get_webServiceBaseUrl()+"/":"",t=new Ar.QueryStringBuilder("SafeLinksHandler.ashx");return t.addParam("app",this.get_appName()),this._appSettingsManager.getBooleanAppSetting("SafeLinksUseDebugHeader")&&t.addParam("action","debug"),String.format("{0}{1}&{2}",e,t.toString(),L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion)},e.prototype.tryNavigate=function(e){var t=this.isHyperLinkTypeSupportedBySafeLinks(e);if(C.ULS.sendTraceTag(594830615,378,50,"SafeLinksManager.TryNavigate: isSupportedHyperLinkType={0},_isEnabledForUser={1},_isEnabledForBrowser={2},_isUserLicensedForSafeLinks={3}",t,this._isEnabledForUser,this._isEnabledForBrowser,this._isUserLicensedForSafeLinks),!(t&&this._isEnabledForUser&&this._isEnabledForBrowser&&this._isUserLicensedForSafeLinks))return!1;oe.Health.get_instance().recordKpiUsage("SafeLinksNavigations",0,"jpittsdirects",null);var n=0,r=this.shouldTryUsingSafeLinksService((0,p.m)((function(){return n}),(function(e){return n=e})));return C.ULS.sendTraceTag(595079385,378,50,"ShouldTryUsingSafeLinksService returned NavigationState={0}",br[n]),r?(C.ULS.sendTraceTag(26019601,378,50,"Using safelinks to navigate hyperlink"),this.isPolicyCookieExpired()?(this._pendingUrlToFollow=e,C.ULS.sendTraceTag(24462627,378,50,"Refreshing the cache as policy cookie expired."),this.isGetPolicyBootRequest=!1,this.getSafeLinksDataFromServerAsync(),!0):(this.tryNavigateInternal(e),!0)):(oe.Health.get_instance().recordKpiFailure("SafeLinksNavigations",br[n],1===n,!0,null),!1)},e.prototype.isHyperLinkTypeSupportedBySafeLinks=function(e){e=e.toLowerCase();var t=this._appSettingsManager.getListAppSetting("SafeLinksUnsupportedProtocols");if(t)for(var n=0;n<t.length;n++)if(e.startsWith(t[n]))return!1;return!0},e.prototype.getSafeLinksDataFromServerAsync=function(e){void 0===e&&(e=!1);var t=new Map;t.set("isOnBootRequest",e.toString()),oe.Health.get_instance().recordKpiUsage("SafeLinksGetPolicySuccessfulRequest",1,"jpittsdirects",t),oe.Health.get_instance().recordKpiUsage("SafeLinksGetPolicyFailedRequest",0,"jpittsdirects",t);var n=this.createAndStartStopwatch("SafeLinksGetPolicy");this._clientRequestManager.addRequest(this.get_getPolicyHandlerUrl(),1,null,null,!0,2,o.i(this,this.getSafeLinksDataFromServer_OnSuccessCallback,"getSafeLinksDataFromServer_OnSuccessCallback"),o.i(this,this.getSafeLinksDataFromServer_OnFailureCallback,"getSafeLinksDataFromServer_OnFailureCallback"),n,void 0,void 0,void 0,7e3,"23"),this.isGetPolicyBootRequest=e,this._getPolicyRequestPending=!0,e?this._getPolicyOnBootRetries++:this._getPolicyOnLinkClickRetries++},e.prototype.getSafeLinksDataFromServer_OnSuccessCallback=function(t){var n=re.dH,r="";try{this.isGetPolicyBootRequest=!1,this._getPolicyRequestPending=!1;var i=t.get_data().state,o=this.stopAndGetDurationInMsFromStopwatch((0,p.m)((function(){return i}),(function(e){return i=e}))),a=(0,O.m)(new le.e,{durationMs:o});if(oe.Health.get_instance().recordKpiSuccess("SafeLinksGetPolicySuccessfulRequest",a),C.ULS.sendTraceTag(594830614,378,50,"GetSafeLinksDataFromServer_OnSuccessCallback: HttpStatus {0}, data length {1}, Duration {2}",t.get_data().httpStatus,t.get_data().responseData.length,o),t.get_data().httpStatus!==re.eN)return void(r="Unexpected httpStatus: "+t.get_data().httpStatus.toString());var s=null;try{s=w.b(t.get_data().responseData)}catch(e){return void(r="Exception:"+e.toString()+" deserializing response: "+t.get_data().responseData)}if(!s)return void(r="Error when serializing response into SafeLinksData. SafeLinksData is null.");var l=s.IsSafeLinksEnabled;if(null==l||l.length<=0)return void(r="Invalid isSafeLinksEnabledString");C.ULS.sendTraceTag(594830613,378,50,"Retrieved isSafeLinksEnabledString {0}",l);var c=e.parseSafeLinksEnabledForUser(l);if(c){if(void 0===s.WebAffinitizedUrl||null===s.WebAffinitizedUrl||s.WebAffinitizedUrl.length<=0)return void(r="Invalid WebAffinitizedUrl");if(void 0===s.PolicyCookie||null===s.PolicyCookie||s.PolicyCookie.length<=0)return void(r="Invalid PolicyCookie")}var u=c?s.WebAffinitizedUrl:null,g=c?s.PolicyCookie:null,d=new Date;if(c){var h=s.PolicyCookieTTL>5?s.PolicyCookieTTL-5:0;d.setMinutes(d.getMinutes()+h)}var _=d.getTime(),m=new vr(l,u,g,_,!1);this.setCachedData(m),n=t.get_data().httpStatus,this._pendingUrlToFollow&&(c?(this.tryNavigateInternal(this._pendingUrlToFollow),this._getPolicyOnBootRetries=0,this._getPolicyOnLinkClickRetries=0):(C.ULS.sendTraceTag(26019602,378,50,"SafeLinks is disabled by admin; Navigating without SafeLinks"),oe.Health.get_instance().recordKpiFailure("SafeLinksNavigations","disabledByPolicy",!0,!0,null),Bt.g.followHyperlinkWithNoReferrer(this._pendingUrlToFollow)),this._pendingUrlToFollow=null)}catch(e){r="GetSafeLinksDataFromServer_OnSuccessCallback: Exception:  "+e.toString()}finally{n!==re.eN&&this.handleGetPolicyRequestError(n,r)}},e.prototype.getSafeLinksDataFromServer_OnFailureCallback=function(e){this._getPolicyRequestPending=!1;var t=500,n="";try{var r=e.get_data().state,i=this.stopAndGetDurationInMsFromStopwatch((0,p.m)((function(){return r}),(function(e){return r=e}))),o=(0,O.m)(new le.e,{durationMs:i});t=e.get_data().httpStatus,oe.Health.get_instance().recordKpiFailure("SafeLinksGetPolicyFailedRequest","HttpStatusCode_"+t.toString(),!1,!0,o),n="Request Failed, Status="+Kn.e[e.get_data().status]+" Duration: "+i,void 0!==e.get_data().responseData&&null!==e.get_data().responseData&&(n+=" ResponseData=",n+=e.get_data().responseData.substring(0,Math.min(e.get_data().responseData.length,100)))}catch(e){n="GetSafeLinksDataFromServer_OnFailureCallback Exception: "+e.toString()}finally{this.handleGetPolicyRequestError(t,n)}},e.prototype.handleGetPolicyRequestError=function(e,t){void 0===t&&(t="");try{if(C.ULS.sendTraceTag(594830612,378,10,"HandleGetPolicyRequestError: HttpStatus {0}, Error {1}",e,t),this._getPolicyOnBootRetries<this._maxGetPolicyBootRetries&&this._getPolicyOnLinkClickRetries<this._maxGetPolicyOnLinkClickRetries)this.getSafeLinksDataFromServerAsync(this.isGetPolicyBootRequest);else{this.isGetPolicyBootRequest=!1,C.ULS.sendTraceTag(24462656,378,10,"Exhausted all retries for SafeLinks GetPolicy call. OnBootRetries: {0}, OnClickRetries: {1}, HttpStatus: {2}, Error: {3}",this._getPolicyOnBootRetries,this._getPolicyOnLinkClickRetries,e,t);var n=(0,O.m)(new le.e,{extendedProperties:new Map});n.extendedProperties.set("HttpStatus",e.toString()),n.extendedProperties.set("ErrorMessage",t),oe.Health.get_instance().recordKpiFailure("SafeLinksGetPolicy","GetPolicyRequestError",!1,!0,n);var r=new vr("false","","",0,!0);this.setCachedData(r),this._pendingUrlToFollow&&(C.ULS.sendTraceTag(26019603,378,50,"Error occured during at-click GetPolicy call, NavigationState = {0}","disabled_GetPolicyFailure"),oe.Health.get_instance().recordKpiFailure("SafeLinksNavigations","disabled_GetPolicyFailure",!1,!0,null),Bt.g.followHyperlinkWithNoReferrer(this._pendingUrlToFollow),this._pendingUrlToFollow=null)}}catch(e){C.ULS.sendTraceTag(594830611,378,10,"HandleGetPolicyRequestError: Exception {0}",e.toString())}},e.prototype.tryNavigateInternal=function(e){var t=this.getPolicyCookieFromCache(),n=this.getWebAffinitizedUrlFromCache(),r={};r.Url=e,r.SafeLinksCookie=t,r.CorrelationId=ae.l.create().toString(),r.WorkloadId=this.workloadId,r.UserAgentInfo=G.y.get_browserNameForlogging()+"|"+this.get_appName(),C.ULS.sendTraceTag(23900187,378,50,"Validating hyperlink with request correlation: {0}",r.CorrelationId),Bt.g.postToWindow(Bt.g.windowTargetToString(4),n,r)},e.prototype.isSafeLinksEnabledForUser=function(){var t=this._appSettingsManager.getStringAppSetting("IsSafeLinksEnabledForUser");return!!t&&e.parseSafeLinksEnabledForUser(t)},e.prototype.isSafeLinksEnabledForBrowser=function(){var e=this._appSettingsManager.getListAppSetting("SafeLinksDisabledBrowsers");return!(e&&G.y.get_isElectron()&&Array.contains(e,"Electron"))},e.prototype.shouldTryUsingSafeLinksService=function(t){t.val=0;var n=this.getCachedData(),r=n?n.IsSafeLinksEnabled:"";if(""!==r)return n.WasServiceDown?(C.ULS.sendTraceTag(51663971,378,50,"Failed to retrieve policy data"),t.val=2,!1):"false"===r.toLowerCase()?(C.ULS.sendTraceTag(51664e3,378,50,"SafeLinks disabled for the user"),t.val=1,!1):e.parseSafeLinksEnabledForUser(r);if(this._getPolicyRequestPending)return t.val=3,C.ULS.sendTraceTag(595079384,378,50,"Currently getting SafeLinks policy"),!1;if(this._getPolicyOnBootRetries>=this._maxGetPolicyBootRetries||this._getPolicyOnLinkClickRetries>=this._maxGetPolicyOnLinkClickRetries)return t.val=2,C.ULS.sendTraceTag(51664001,378,50,"Exhausted all retries- Failure in GetPolicy for SafeLinks ({0}/{1} boot, {2}/{3} onClick)",this._getPolicyOnBootRetries,this._maxGetPolicyBootRetries,this._getPolicyOnLinkClickRetries,this._maxGetPolicyOnLinkClickRetries),!1;var i=this._getPolicyOnBootRetries+this._getPolicyOnLinkClickRetries;return C.ULS.sendTraceTag(23900182,378,10,"Inconsistent SafeLinks state: SafeLinks cache data is null with no on boot request pending, and {0} retries left over. Perhaps LocalStorage is inaccessable.",this._maxGetPolicyBootRetries+this._maxGetPolicyOnLinkClickRetries-i),!0},e.prototype.getPolicyCookieFromCache=function(){var e=this.getCachedData();return e?e.PolicyCookie:""},e.prototype.getWebAffinitizedUrlFromCache=function(){var e=this.getCachedData();return e?e.WebAffinitizedUrl:""},e.prototype.getExpirationTimeFromCache=function(){var e=new Date;try{var t=this.getCachedData(),n=t?t.PolicyCookieTTL:0;e.setTime(n)}catch(e){C.ULS.sendTraceTag(24462658,378,10,"Exception occured while fetching expiration time from cache: {0}",e)}return e},e.prototype.isPolicyCookieExpired=function(){var e=this.getExpirationTimeFromCache();return!!e&&e.getTime()<Date.now()},e.prototype.getCachedData=function(){if(!this._sessionCacheSafeLinksData){var e=Tr.get_instance().getItem(this.get_userId());if(!e||""===e)return null;this._sessionCacheSafeLinksData=JSON.parse(e)}return this._sessionCacheSafeLinksData},e.prototype.setCachedData=function(e){if(null==e)throw Error.argumentNull("safeLinksData");if(void 0===e.IsSafeLinksEnabled||null===e.IsSafeLinksEnabled||e.IsSafeLinksEnabled.length<=0)throw Error.argumentNull("safeLinksData.IsSafeLinksEnabled");this._sessionCacheSafeLinksData=e,e.WasServiceDown||this.writeValuesToLocalStorage(e)},e.prototype.writeValuesToLocalStorage=function(e){var t=JSON.stringify(e);Tr.get_instance().setItem(this.get_userId(),t)},e.prototype.createAndStartStopwatch=function(t){return void 0!==e._stopwatchBuilder&&null!==e._stopwatchBuilder?e._stopwatchBuilder.makeAndStartStopwatch("WebServiceCall",t):null},e.prototype.stopAndGetDurationInMsFromStopwatch=function(e){if(void 0!==e.val&&null!==e.val){var t=e.val.get_ageInMilliseconds();return e.val.stop(),e.val=null,t}return null},e.parseSafeLinksEnabledForUser=function(e){return"false"!==e.toLowerCase()},e._stopwatchBuilder=null,e}();(0,o.l)(wr,"SafeLinksManager",null,[Sr.o]);var xr=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.SafeLinks"},e.prototype.configure=function(e){var t=this;this._container=e,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WACSafeLinksIsEnabled")&&e.register(wr).as(Sr.o).singleInstance().usingFactory((function(){return new wr(L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.theClientRequestManager,String.format("{0}-{1}",function(e){switch(e){case 3:return"Word";case 1:return"Excel";case 2:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return"Unknown"}}(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()),function(e){switch(e){case 1:return"Edit";case 2:return"View";case 3:return"InstantView";default:return"Unknown"}}(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppMode())),!1,t._container.resolveFuture(J.a),L.AFrameworkApplication.get_activeFrame().get_theStopwatchBuilder())}))},e.prototype.init=function(){mn.m.get_instance().get_appIsInteractiveTask().CWR(Sr.o,(function(e){if(3===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()||4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()){var t="Microsoft.Office.Web.SessionSettings.IWacWoncaWACSafeLinksSettings";2!==L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppMode()&&3!==L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppMode()||(t="Microsoft.Office.Web.WordViewer.IWacWordViewerWACSafeLinksSettings"),L.AFrameworkApplication.logUniqueFlightedSettingUsage(t)}return se.w.get_instance().tryResolve(Sr.o)}))},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(xr,"SafeLinksPackage",null,[l.u,c.s]);var Fr=n(2110),Er=(0,o.y)("IBusinessBarEntryFactory"),Pr=n(1735),kr=5e3,Dr=function(){function e(e,t,n,r){var i=this;this._signoutResponse=null,this._businessBarEntry=null,this._dialog=null,this._task=null,this._showCloseButton=!1,this._businessBar=null,this._businessBarEntryFactory=null,this._signoutResponse=e,this._showCloseButton=r,this._signoutResponse.get_isAuthenticated()&&(this._task=new De.c(3,2,kr,o.i(this,this.authenticationCheckTask,"authenticationCheckTask"),2),L.AFrameworkApplication.get_theTaskManager().addTask(this._task),this.registerActions(t,n)),this._signoutResponse.add_authenticationLost((function(e,t){i.onAuthenticationLost()})),this._signoutResponse.add_authenticationRestored((function(e,t){i.onAuthenticationRestored()}))}return e.prototype.get_businessBar=function(){return this._businessBar||(this._businessBar=se.w.get_instance().tryResolve(Fr.c))},e.prototype.get_businessBarEntryFactory=function(){return this._businessBarEntryFactory||(this._businessBarEntryFactory=se.w.get_instance().tryResolve(Er))},e.prototype.verifyAuthentication=function(){this._signoutResponse.get_isAuthenticated()||this.onAuthenticationLost()},e.prototype.registerActions=function(e,t){var n=L.AFrameworkApplication.get_theActionManager();n.addActionWithFlags(te.QJ,nt.a,e,96),n.addActionWithFlags(te.CS,nt.a,t,96),n.addAction(te.OY,nt.a,Ze.ActionManager.doNothingHandler),n.addAction(te.AO,nt.a,Ze.ActionManager.doNothingHandler),n.addAction(te.mu,nt.a,Ze.ActionManager.doNothingHandler)},e.prototype.onAuthenticationLost=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage),L.AFrameworkApplication.get_theActionManager().processAction(te.QJ,2)},e.prototype.onAuthenticationRestored=function(){this.teardownUI(),L.AFrameworkApplication.get_theActionManager().processAction(te.CS,2)},e.prototype.authenticationCheckTask=function(e){this._signoutResponse.authenticationCheck()},e.prototype.teardownUI=function(){this._dialog&&(this._dialog.hide(),this._dialog.dispose(),this._dialog=null),this._businessBarEntry&&this.get_businessBar()&&(L.AFrameworkApplication.isShuttingDown||this.get_businessBar().removeEntry(this._businessBarEntry),this._businessBarEntry.dispose(),this._businessBarEntry=null)},e.prototype.showDialog=function(e){Pr.b(this._dialog),this._dialog=new ar.StandardDialog,this._showCloseButton||(this._dialog.set_hasCloseGlyph(!1),this._dialog.set_buttonsOption(0)),this._dialog.setButtonText(1,CommonUIStrings.l_SignIn),this._dialog.showWarning(CommonUIStrings.l_DefaultDialogTitle,e,o.i(this,this.dialogHandler,"dialogHandler"))},e.prototype.dialogHandler=function(e,t){1===e?(yr.t.performSignIn(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),L.AFrameworkApplication.get_theActionManager().processAction(te.mu,2)):(this.showBusinessBar(),L.AFrameworkApplication.get_theActionManager().processAction(te.AO,2))},e.prototype.showBusinessBar=function(){this.get_businessBar()&&this.get_businessBarEntryFactory()&&(this._businessBarEntry=this.get_businessBarEntryFactory().create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this._businessBarEntry.set_closeable(!0),this._businessBarEntry.addButton(CommonUIStrings.l_SignIn,e.businessBarButtonHandler,""),this._businessBarEntry.set_closeHandler(o.i(this,this.businessBarEntryCloseHandler,"businessBarEntryCloseHandler")),this.get_businessBar().addEntry(this._businessBarEntry,!1))},e.prototype.businessBarEntryCloseHandler=function(e){this.disableTask(),L.AFrameworkApplication.get_theActionManager().processAction(te.OY,2)},e.prototype.disableTask=function(){this._task&&(L.AFrameworkApplication.get_theTaskManager().deleteTask(this._task),this._task=null)},e.prototype.dispose=function(){this._businessBarEntry=null,this._dialog=null,this._task=null},e.businessBarButtonHandler=function(e){yr.t.performSignIn(),L.AFrameworkApplication.get_theActionManager().processAction(te.mu,2)},e}();(0,o.l)(Dr,"SignOutResponseUI",null,[Sys.IDisposable]);var Mr=function(){function e(){}return e.prototype.get_name=function(){return"Common.App.UI"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){Pr.b(e._signOutResponse),e._signOutResponse=null},e.main=function(){N.o.get_instance().registerPackage(new e)},e.initSignOutResponseUI=function(t,n,r,i){e.shouldUseSignoutResponseUI(t)&&(e._signOutResponse=new Dr(yr.t.get_instance(),n,r,i))},e.shouldUseSignoutResponseUI=function(e){return L.AFrameworkApplication.needsSignOutChecking&&!L.AFrameworkApplication.get_isEmbedded()},e._signOutResponse=null,e}();(0,o.l)(Mr,"CommonAppUIPackage",null,[l.u,c.s]);var Rr=n(4226),Lr=n(418),Nr=n(8237),Br=n(8261),Or=n(911),Ur=n(1759),Hr=n(1814),Gr=function(){function e(e,t,n,r){this._editingDomManager=null,this._caretPositionManager=null,this._backspaceDeleteEventSource=null,this._interactiveViewManager=null,this._keyInputManager=null,this._inputCallback=null,this._keyDownCallback=null,this._resetCallback=null,this._isListening=!1,this._inCharGatheringMode=!1,this._inputRegistered=!1,this._keyEventsRegistered=!1,this._mostRecentlyTypedKeyCode=0,this._editingDomManager=e,this._caretPositionManager=t,this._backspaceDeleteEventSource=n,this._interactiveViewManager=r,this.reset()}return e.prototype.beginListening=function(e,t){var n=this;this._isListening||(this._isListening=!0,e.get_isAppInteractive()?this.beginListeningInternal(e,t):e.add_appIsInteractive((function(r,i){n._isListening||n.beginListeningInternal(e,t)})))},e.prototype.dispose=function(){this._inputRegistered&&(Br.App.get_activeAppFrame().get_theTextInputEventManager().unregisterHandler(Le.d.input,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.textInputHandler,"textInputHandler")),this._inputRegistered=!1);this._keyEventsRegistered&&(this._keyInputManager.unregisterHandler(Le.d.beforeKeyDown,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.beforeKeyDownHandler,"beforeKeyDownHandler")),this._keyInputManager.unregisterHandler(Le.d.keyUp,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.keyUpHandler,"keyUpHandler"))),Br.App.get_activeAppFrame().remove_onResize(o.i(this,this.onWindowResize,"onWindowResize")),this.stopCharGatheringMode()},e.prototype.onWindowResize=function(){this.reset()},e.prototype.registerInputCallback=function(e){this._inputCallback=e},e.prototype.registerResetCallback=function(e){this._resetCallback=e},e.prototype.registerKeyDownCallback=function(e){this._keyDownCallback=e},e.prototype.beginCharGatheringMode=function(){this._inCharGatheringMode=!0},e.prototype.stopCharGatheringMode=function(){this._inCharGatheringMode=!1},e.prototype.beginListeningInternal=function(e,t){if(this._keyInputManager=t,this._interactiveViewManager.get_selectionView().get_isPageView()){if(Br.App.box4TypingTaskTriggeredByInput&&G.y.get_supportsInputEvent()||G.y.get_isInternetExplorerEdge())Br.App.get_activeAppFrame().get_theTextInputEventManager().registerHandler(Le.d.input,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.textInputHandler,"textInputHandler"),null),this._inputRegistered=!0;this._keyInputManager&&(this._keyInputManager.registerHandler(Le.d.beforeKeyDown,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.beforeKeyDownHandler,"beforeKeyDownHandler")),this._keyInputManager.registerHandler(Le.d.keyUp,this._interactiveViewManager.get_editingView().get_editingElement(),o.i(this,this.keyUpHandler,"keyUpHandler")),this._keyEventsRegistered=!0),this._backspaceDeleteEventSource.add_onBackspaceDelete(o.i(this,this.backspaceDeleteHandler,"backspaceDeleteHandler")),Br.App.get_activeAppFrame().add_onResize(o.i(this,this.onWindowResize,"onWindowResize"))}},e.prototype.beforeKeyDownHandler=function(e){if(this._mostRecentlyTypedKeyCode=e.innerEvent.keyCode,!this._inCharGatheringMode||!this._keyDownCallback)return!1;if(e.innerEvent.keyCode===Je.v.vK_Escape||e.innerEvent.keyCode===Je.v.vK_Enter||e.innerEvent.keyCode===Je.v.vK_Tab){var t=!1;return e.innerEvent.keyCode===Je.v.vK_Escape?(C.ULS.sendTraceTag(41178049,324,50,"@ mention People Picker dismissed via escape"),t=!0):e.innerEvent.keyCode===Je.v.vK_Enter?C.ULS.sendTraceTag(41178050,324,50,"@ mention People Picker enter pressed while picker is up"):e.innerEvent.keyCode===Je.v.vK_Tab&&C.ULS.sendTraceTag(51451662,324,50,"@ mention People Picker tab pressed while picker is up"),this._keyDownCallback(e),t&&this.reset(),!0}return(e.innerEvent.keyCode===Je.v.vK_DownArrow||e.innerEvent.keyCode===Je.v.vK_UpArrow||e.innerEvent.keyCode===Je.v.vK_PageDown||e.innerEvent.keyCode===Je.v.vK_PageUp)&&(this._keyDownCallback(e),!0)},e.prototype.textInputHandler=function(e){if(L.AFrameworkApplication.appSettingsManager&&"OneNote"===L.AFrameworkApplication.appSettingsManager.getStringAppSetting("Application")){var t=this._interactiveViewManager.get_editingView().get_targetNode();if(Hr.n(t))return!1}var n=this.getParagraphOfCurrentCursorLocation(),r=this.getCursorPosition(e.innerEvent.target),i=e.innerEvent.rawEvent.inputType;return(null!=i||this._mostRecentlyTypedKeyCode!==Je.v.vK_Backspace&&this._mostRecentlyTypedKeyCode!==Je.v.vK_Delete)&&("deleteContentBackward"!==i&&"deleteContentForward"!==i&&this.handleTextInput(n,r,e.innerEvent.target))},e.prototype.handleTextInput=function(t,n,r){if(n<1)return!1;L.AFrameworkApplication.appSettingsManager&&"OneNote"===L.AFrameworkApplication.appSettingsManager.getStringAppSetting("Application")&&t.indexOf(e.newLine)>-1&&(t=t.replace(new RegExp(e.newLine,"g"),""));var i=t.charAt(n-1);return this._inCharGatheringMode&&i!==e.at?this.handleKeyword(t,n,r):this._inCharGatheringMode||i!==e.at?this._inCharGatheringMode&&i===e.at&&C.ULS.sendTraceTag(41178052,324,50,"Tried to type @ while already in at mention mode"):this._inputCallback&&(this.reset(),this.previousCharacterIsValidForAtMentionMode(n,t)&&(this.beginCharGatheringMode(),this.handleKeyword(t,n,r),C.ULS.sendTraceTag(41178051,324,50,"@ typed.  Beginning of paragraph?: {0}",1===n?"true":"false"))),this._inCharGatheringMode},e.prototype.keyUpHandler=function(e){if(!this._inCharGatheringMode)return!1;var t=this.getParagraphOfCurrentCursorLocation(),n=this.getCursorPosition(e.innerEvent.target);return e.innerEvent.keyCode!==Je.v.vK_Backspace&&e.innerEvent.keyCode!==Je.v.vK_Delete||this.handleKeyword(t,n,e.innerEvent.target),!1},e.prototype.reset=function(){this._isListening=!1,this.stopCharGatheringMode(),this._resetCallback&&this._resetCallback()},e.prototype.getCursorPosition=function(e){return this._caretPositionManager.getCaretPosition(2,e)},e.prototype.getParagraphOfCurrentCursorLocation=function(){return this._editingDomManager.getEditingElement().innerText},e.prototype.previousCharacterIsValidForAtMentionMode=function(e,t){if(e-2<0)return!0;var n=t.charAt(e-2);return!!this.characterIsValidToBeBeforeAt(n)},e.prototype.characterIsValidToBeBeforeAt=function(e){return this.characterIsEqualToSpace(e)||"("===e},e.prototype.characterIsEqualToSpace=function(e){return"\xa0"===e||" "===e},e.prototype.handleKeyword=function(e,t,n){if(!e||""===e||t<0)this.reset();else{var r=this.keywordFromCurrentSelection(e,t);this._inputCallback(r,n)}},e.prototype.keywordFromCurrentSelection=function(t,n){for(var r=-1,i=n;i>=0&&n-i<=63;i--)if(t.charAt(i)===e.at){r=i;break}return r>=0&&n<=t.length?t.substring(r,n):(this.reset(),"")},e.prototype.handleBackspaceKeydown=function(t){var n=this.getCursorPosition(t.innerEvent.target),r=this.getParagraphOfCurrentCursorLocation().charAt(n-1);this._inCharGatheringMode&&r===e.at&&this.reset()},e.prototype.handleDeleteKeydown=function(t){var n=this.getCursorPosition(t.innerEvent.target),r=this.getParagraphOfCurrentCursorLocation().charAt(n);this._inCharGatheringMode&&r===e.at&&this.reset()},e.prototype.backspaceDeleteHandler=function(e,t){this._mostRecentlyTypedKeyCode=t.get_isBackspace()?Je.v.vK_Backspace:t.get_isDelete()?Je.v.vK_Delete:this._mostRecentlyTypedKeyCode,this._inCharGatheringMode&&(t.get_isBackspace()?this.handleBackspaceKeydown(t.get_keyEvent()):t.get_isDelete()&&this.handleDeleteKeydown(t.get_keyEvent()))},e.at="@",e.newLine="\n",e}();(0,o.l)(Gr,"AtMentionsListener",null,[Rr.w]);var Vr=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.AtMentions"},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(Rr.w).singleInstance().usingFactory((function(){return new Gr(t._container.resolve(Lr.q),t._container.resolve(Nr.t),t._container.resolve(Or.t),Ur.InteractiveViewManager.get_instance())}))},e.prototype.init=function(){var e=this;L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CanvasAtMentionDetectionIsEnabled")&&L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){e._container.resolve(Rr.w).beginListening(Br.App.get_activeAppFrame().workspace,Xe.KeyInputManager.get_instance())}))},e.prototype.dispose=function(){this._container.resolve(Rr.w).dispose()},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Vr,"Box4AtMentionsPackage",null,[l.u,c.s]);var Wr=n(9670),zr=n(6627),Kr=n(2367),qr=n(2248),jr=n(7079),$r=n(7406),Qr=function(){function e(e,t,n,r,i,a,s){this._forceOutboundMinIntervalInMs=0,this._forceOutboundMaxIntervalInMs=0,this._intervalIncreaseStepInMs=0,this._intervalDecreaseFactor=0,this._forceOutboundIntervalInMs=0,this.taskManager=null,this.taskItem=null,this.workspace=null,this.lastForceOutbound=null,this.pendingOutbound=!1,this.workspace=t,this.lastForceOutbound=new Date(0),this.pendingOutbound=!1,this._forceOutboundMinIntervalInMs=r,this._forceOutboundMaxIntervalInMs=i,this._forceOutboundIntervalInMs=this._forceOutboundMinIntervalInMs,this._intervalIncreaseStepInMs=a,this._intervalDecreaseFactor=s,this.taskManager=e,this.taskItem=new De.c(2,2,n,o.i(this,this.monitorChanges,"monitorChanges")),this.taskManager.addTask(this.taskItem)}return e.prototype.monitorChanges=function(e){var t=new Date;!this.pendingOutbound&&+t-+this.lastForceOutbound>=this._forceOutboundIntervalInMs&&this.forceFasterOutboundIfNecessary(t)},e.prototype.forceFasterOutboundIfNecessary=function(t){var n,r,i=!0,a=-1,s=this.workspace.get_activePage();if(r=this.getReplicatorForFasterOutbound(s,(0,p.m)((function(){return n}),(function(e){return n=e})),(0,p.m)((function(){return i}),(function(e){return i=e})))){a=n;var l=r.getDependency(),c=e.getCheckedReplicator(l);c&&(a=(n=r.replicationTimer.requestIntervalRemaining())>a?n:a,c.forceOutbound(null,null,null))}else if((r=this.getReplicatorForFasterOutbound(this.workspace.get_activeSection(),(0,p.m)((function(){return n}),(function(e){return n=e})),(0,p.m)((function(){return i}),(function(e){return i=e}))))||(r=this.getReplicatorForFasterOutbound((0,f.e)(Kr.n,this.workspace.get_activeFolder()),(0,p.m)((function(){return n}),(function(e){return n=e})),(0,p.m)((function(){return i}),(function(e){return i=e})))))a=n;else if(s){var u=zr.PageNavigator.get_instance().getVersionHistoryNode(s),g=!0;(r=this.getReplicatorForFasterOutbound(u,(0,p.m)((function(){return n}),(function(e){return n=e})),(0,p.m)((function(){return g}),(function(e){return g=e}))))&&(a=n)}return r?(r.forceOutbound(o.i(this,this.forceOutboundSuccessfulCallback,"forceOutboundSuccessfulCallback"),o.i(this,this.forceOutboundFailedCallback,"forceOutboundFailedCallback"),null),this.pendingOutbound=!0,this.lastForceOutbound=t,this._forceOutboundIntervalInMs=Math.min(this._forceOutboundIntervalInMs+this._intervalIncreaseStepInMs,this._forceOutboundMaxIntervalInMs),C.ULS.sendTraceTag(18961026,339,50,"Faster outbound saved {0}ms.",a),!0):(i&&this._forceOutboundIntervalInMs>this._forceOutboundMinIntervalInMs+5&&(this._forceOutboundIntervalInMs=this._forceOutboundIntervalInMs-e.calculateDecrease(this._forceOutboundIntervalInMs,this._forceOutboundMinIntervalInMs,this._intervalDecreaseFactor),this._forceOutboundIntervalInMs=Math.max(this._forceOutboundMinIntervalInMs,this._forceOutboundIntervalInMs)),!1)},e.prototype.getReplicatorForFasterOutbound=function(t,n,r){n.val=-1;var i=e.getCheckedReplicator(t);return!i||i.get_isUsingOneNoteContentSync()||1!==i.get_state()||e.isReplicationHappeningSoon(i,this._forceOutboundIntervalInMs,n)?(r.val=!1,null):e.hasChangesMiniCheck(t)?(r.val=!1,i):null},e.prototype.forceOutboundSuccessfulCallback=function(e){this.pendingOutbound=!1,this.logForceOutboundSpentTime(0)},e.prototype.forceOutboundFailedCallback=function(e,t){this.pendingOutbound=!1,this.logForceOutboundSpentTime(t)},e.prototype.logForceOutboundSpentTime=function(e){var t=new Date;C.ULS.sendTraceTag(19244304,339,50,"Faster outbound finished in {0}ms, status code: {1}",+t-+this.lastForceOutbound,$r.r[e])},e.prototype.dispose=function(){this.taskManager&&this.taskManager.deleteTask(this.taskItem)},e.getCheckedReplicator=function(t){var n=t?t.get_contentReplicator():null;return e.isLastReplicationSuccessful(n)?n:null},e.isLastReplicationSuccessful=function(e){return!!e&&(e.get_lastReplicationSuccessful()||e.get_lastReplicated().equals(Dt.h.get_nil()))},e.isReplicationHappeningSoon=function(e,t,n){return n.val=e.replicationTimer.requestIntervalRemaining(),n.val<t},e.hasChangesMiniCheck=function(e){var t=new jr.LoadedCoreGraphIterator;t.set(e);var n=qr.k(t),r=e.get_contentObjectSpace();return!(!n||!r)&&(!!(t.get_isCoreChannelOpen()&&2&t.get_invalidSubGraphCoreState()||e.get_cachedMetadata()&&e.get_cachedMetadata().get_isDirty())||!(!r.get_currentRevision()||r.get_currentRevision().get_id().equals(e.get_contentReplicator().get_lastReplicated())))},e.calculateDecrease=function(e,t,n){return 1e3*Math.log((e-t+1e3)/1e3)/Math.log(n)},e}();(0,o.l)(Qr,"FasterOutbound",null,[Sys.IDisposable]);var Jr=function(){function e(){this._FasterOutbound=null}return e.prototype.configure=function(e){},e.prototype.get_name=function(){return"OneNote.FasterOutbound"},e.prototype.init=function(){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteFasterOutboundIsEnabled")&&(this._FasterOutbound=new Qr(L.AFrameworkApplication.get_theTaskManager(),Wr.App.get_activeOneNoteFrame().workspace,L.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteFasterOutboundCheckIntervalInMs",400),L.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteFasterOutboundMinForceIntervalInMs",2e3),L.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteFasterOutboundMaxForceIntervalInMs",5e3),L.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteFasterOutboundForceIntervalIncreaseStepInMs",1500),L.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteFasterOutboundForceDecreaseFactor",100)))},e.prototype.dispose=function(){this._FasterOutbound&&Pr.b(this._FasterOutbound)},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Jr,"OneNoteFasterOutboundPackage",null,[l.u,c.s]);var Xr=n(5003),Yr=(0,o.y)("ISessionExpirationManagerWithDialog"),Zr=n(5396),ei=n(8050),ti=function(){function e(){this._sessionExpiredDialogAlreadyDisplayed=!1,this._sessionExpiringDialogAlreadyDisplayed=!1,this.accessTokenTtl=0;var e=L.AFrameworkApplication.get_accessTokenTtl();if(!(e<=0)){this.accessTokenTtl=e;var t=new Date;C.ULS.sendTraceTag(17581890,217,50,"Initializing SessionExpirationManager. {0}",{AccessTokenTtl:this.accessTokenTtl,NowGetTime:t.getTime(),BootTime:L.AFrameworkApplication.bootTime}),ei.c.get_instance().add_sessionExpiredDetected(o.i(this,this.onSessionExpiredDetected,"onSessionExpiredDetected")),ei.c.get_instance().add_sessionAboutToExpireDetected(o.i(this,this.onSessionExpiringDetected,"onSessionExpiringDetected"))}}return e.prototype.onSessionExpiredDetected=function(e,t){ei.c.get_instance().remove_sessionExpiredDetected(o.i(this,this.onSessionExpiredDetected,"onSessionExpiredDetected")),C.ULS.sendTraceTag(19247381,217,50,"SessionExpiredDetected"),this.handleSessionExpired()},e.prototype.onSessionExpiringDetected=function(e,t){ei.c.get_instance().remove_sessionAboutToExpireDetected(o.i(this,this.onSessionExpiringDetected,"onSessionExpiringDetected")),this._sessionExpiringDialogAlreadyDisplayed||this._sessionExpiredDialogAlreadyDisplayed||(C.ULS.sendTraceTag(20492680,217,50,"SessionExpiringDetected - Showing expiring dialog."),this._sessionExpiringDialogAlreadyDisplayed=!0,this.showSessionExpiringDialog())},e.prototype.handleSessionExpired=function(){this._sessionExpiredDialogAlreadyDisplayed||(L.AFrameworkApplication.reportError(Zr.p.sessionAccessTokenExpired),this._sessionExpiredDialogAlreadyDisplayed=!0,this.showSessionExpiredDialog())},e}();(0,o.l)(ti,"ASessionExpirationManager",null,[]);var ni=n(8095),ri=n(6500),ii=n(7138),oi=function(){function e(){}return e.sessionExpirationDialogHtmlForceToRefresh="<div class='WACDialogRow' id='SessionExpirationBlock'> <label id='WACSessionExpirationText' class='WACDialogLabel' >Session Expiration</label> </div>",e.sessionExpirationSaveDataInstructionDialogHtml="<div class='WACDialogRow' id='SessionExpirationParagraph1'> <label id='OneNoteSessionExpirationActionRequired' class='WACDialogLabel' >L_SessionExpiredActionRequiredText</label> </div> <div class='WACDialogRow' id='SessionExpirationParagraph2'> <label id='OneNoteSessionExpirationSaveWorkInstruction' class='WACDialogLabel' >L_SessionExpiredSaveWorkInstructionText</label> </div> <div class='WACDialogRow' id='SessionExpirationParagraph3'> <label id='OneNoteSessionExpirationHighlightedText' class='WACDialogLabel UnsavedChangesExample' >L_SessionExpiredUnsavedWork</label> </div>",e}();(0,o.l)(oi,"OneNoteSessionExpirationDialogHtml",null,[]);var ai=n(2135),si=function(e){function t(t,n,r,i){var o=e.call(this,!0)||this;if(o._isExpiredDialog=!1,o._accessTokenTtl=0,o._sessionRefreshCallback=null,o._sessionDisposeCallback=null,o._businessBarControllerFuture=null,n){C.ULS.sendTraceTag(20201729,217,50,"User session has expired");var a=Br.App.get_activeAppFrame().workspace.get_activePage();if(a)if(a.get_contentReplicator().hasChangesToOutbound())return C.ULS.sendTraceTag(20201730,217,50,"User session has expired with unsaved changes"),o.setupSaveDataInstructionDialog(t,r,i),o}return o.setupForceToRefreshDialog(t,n,r,i),o}return(0,S.t)(t,e),t.prototype.get_businessBarControllerFuture=function(){return this._businessBarControllerFuture||(this._businessBarControllerFuture=se.w.get_instance().resolveFuture(ni.d))},t.prototype.setupSaveDataInstructionDialog=function(e,t,n){this.set_dialogHtml(oi.sessionExpirationSaveDataInstructionDialogHtml),this._sessionRefreshCallback=t,this._sessionDisposeCallback=n;var r={};this.set_buttonsOption(0),this.setButtonText(1,OneNoteIntl.OneNoteStrings.l_SessionExpiredDialogButtonContinue),r.OneNoteSessionExpirationActionRequired=OneNoteIntl.OneNoteStrings.l_SessionExpiredActionRequiredText,r.OneNoteSessionExpirationSaveWorkInstruction=OneNoteIntl.OneNoteStrings.l_SessionExpiredSaveWorkInstructionText,r.OneNoteSessionExpirationHighlightedText=OneNoteIntl.OneNoteStrings.l_SessionExpiredUnsavedWork,this.initializeAndShow(OneNoteIntl.OneNoteStrings.l_SessionExpiredDialogTitle,o.i(this,this.sessionExpirationSaveDataInstructionDialogHandler,"sessionExpirationSaveDataInstructionDialogHandler"),r),this.setDescribedByForDialog(this.myId("OneNoteSessionExpirationActionRequired"))},t.prototype.setupForceToRefreshDialog=function(e,t,n,r){this.set_dialogHtml(oi.sessionExpirationDialogHtmlForceToRefresh),this._accessTokenTtl=e,this._sessionRefreshCallback=n,this._sessionDisposeCallback=r,this._isExpiredDialog=t;var i={};L.AFrameworkApplication.get_canExecuteCloseAction()?(this.set_buttonsOption(1),this.setButtonText(0,CommonUIStrings.l_DialogClose)):(this.set_buttonsOption(0),this.set_hasCloseGlyph(!1)),this.setButtonText(1,this._isExpiredDialog||1===L.AFrameworkApplication.get_activeFrame().get_mode()?CommonUIStrings.l_SessionExpirationRefreshButton:CommonUIStrings.l_SessionExpiringSaveAndRefreshButton);var a=new Date(this._accessTokenTtl).format(L.AFrameworkApplication.shortTimeFormat);i.WACSessionExpirationText=this._isExpiredDialog?String.format(CommonUIStrings.l_SessionExpiredMessage):String.format(CommonUIStrings.l_SessionExpiringMessage,a),this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,o.i(this,this.sessionExpirationForceToRefreshDialogHandler,"sessionExpirationForceToRefreshDialogHandler"),i),this.setDescribedByForDialog(this.myId("WACSessionExpirationText"))},t.prototype.sessionExpirationForceToRefreshDialogHandler=function(e,t){1===e?this._sessionRefreshCallback&&this._sessionRefreshCallback(this._isExpiredDialog):e||L.AFrameworkApplication.get_theActionManager().processActionWithData(te.bT,2,ai.f)},t.prototype.sessionExpirationSaveDataInstructionDialogHandler=function(e,t){this.get_businessBarControllerFuture().execute((function(e){e.checkSessionExpirationBusinessBar(Br.App.get_activeAppFrame().get_mode(),!0)})),L.AFrameworkApplication.get_theActionManager().processAction(ii.Tg,2)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._sessionDisposeCallback&&this._sessionDisposeCallback()},t}(ri.o);(0,o.l)(si,"OneNoteSessionExpirationDialog",ri.o,[]);var li=n(7621),ci=function(e){function t(t){var n=e.call(this)||this;return n._appFrame=null,n._showDialogOnKickout=!0,n._showDialogOnExpiring=!0,n._sessionExpirationDialog=null,n._eventSource=new bt.f,n._appFrame=t,n}return(0,S.t)(t,e),t.prototype.add_onSessionExpired=function(e){this._eventSource.addHandler(t.sessionExpiredEventKey,e)},t.prototype.remove_onSessionExpired=function(e){this._eventSource.removeHandler(t.sessionExpiredEventKey,e)},t.prototype.add_onSessionExpiring=function(e){this._eventSource.addHandler(t.sessionExpiringEventKey,e)},t.prototype.remove_onSessionExpiring=function(e){this._eventSource.removeHandler(t.sessionExpiringEventKey,e)},t.prototype.add_onTokenRefreshed=function(e){this._eventSource.addHandler(t.tokenRefreshedEventKey,e)},t.prototype.remove_onTokenRefreshed=function(e){this._eventSource.removeHandler(t.tokenRefreshedEventKey,e)},t.prototype.showDialogOnKickout=function(e){this._showDialogOnKickout=e},t.prototype.showDialogOnExpiring=function(e){this._showDialogOnExpiring=e},t.prototype.showSessionExpiringDialog=function(){if(!this._sessionExpirationDialog&&!li.h.get_currentDialog()){var e=o.i(this,this.disposeCallback,"disposeCallback");this._sessionExpirationDialog=new si(this.accessTokenTtl,!1,o.i(this,this.sessionExpirationHandler,"sessionExpirationHandler"),e)}},t.prototype.showSessionExpiredDialog=function(){if(this._sessionExpirationDialog&&(this._sessionExpirationDialog.get_isShowing()&&this._sessionExpirationDialog.hide(),this._sessionExpirationDialog=null),this._showDialogOnKickout){var e=o.i(this,this.disposeCallback,"disposeCallback");this._sessionExpirationDialog=new si(this.accessTokenTtl,!0,o.i(this,this.sessionExpirationHandler,"sessionExpirationHandler"),e)}this._eventSource.raiseEvent(t.sessionExpiredEventKey)},t.prototype.disposeCallback=function(){this._sessionExpirationDialog=null},t.prototype.sessionExpirationHandler=function(e){(e||this._appFrame.beforeRefreshDocument())&&this._appFrame.refreshDocument(null)},t.sessionExpiredEventKey="SE",t.sessionExpiringEventKey="SEP",t.tokenRefreshedEventKey="SER",t}(ti);(0,o.l)(ci,"OneNoteSessionExpirationManager",ti,[Yr,Xr.k]);var ui=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.SessionExpiration"},e.prototype.init=function(){var e=this;L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){e.initOnFullAppSettingsReady()}))},e.prototype.initOnFullAppSettingsReady=function(){this._container.resolve(ci)},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,e.register(ci).as(Xr.k).as(Yr).singleInstance().usingFactory((function(){return new ci(L.AFrameworkApplication.get_activeFrame())}))},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(ui,"OneNoteSessionExpirationPackage",null,[l.u,c.s]);var gi=n(8082),pi=function(){function e(e){this._editNotificationEventSource=null,this._savedStatusText=null,this._savingStatusText=null,this._readOnlyStatusText=null,this._reviewModeStatusText=null,this._appPermissionMode=0,this._isContentSaved=!1,this._isHidden=!1,this._isInitialized=!1,this._lastHidden=!1,this._lastStatusText=null,this._requestIdleCallbackHandler=null,this._lastPermissionMode=0,this._editNotificationEventSource=e,this._appPermissionMode=3,this._isContentSaved=!0}return e.prototype.initialize=function(e,t){var n=this;return this._savedStatusText=this.getSavedStatusText(e,t),this._savingStatusText=CommonUIStrings.l_SavingStatus,this._readOnlyStatusText=CommonUIStrings.l_ReadOnlyStatus,this._reviewModeStatusText=CommonUIStrings.l_ReviewModeStatus,this._editNotificationEventSource&&this._editNotificationEventSource.execute((function(e){e.add_onEditHappened(o.i(n,n.updateToSavingStatus,"updateToSavingStatus"))})),this._isInitialized=!0,!0},e.prototype.updateSaveStatusDisplay=function(e,t){this._isHidden=e,this._appPermissionMode=t,this.updateSaveStatusText(this._isContentSaved)},e.prototype.updateSaveStatusText=function(e){this._isContentSaved=e;var t=null;3===this._appPermissionMode&&(t=this._isContentSaved?this._savedStatusText:this._savingStatusText),this.dispatchSaveStatusAction(t)},e.prototype.updateToFailStatus=function(e){this._isContentSaved=!1,this.dispatchSaveStatusAction(e)},e.prototype.updateStatusText=function(e){this.dispatchSaveStatusAction(e)},e.prototype.getSavedStatusText=function(e,t){return e?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):t&&t.length?String.format(CommonUIStrings.l_SavedToStatus,t):CommonUIStrings.l_SavedStatus},e.prototype.updateToSavingStatus=function(e,t){this.updateSaveStatusText(!1)},e.prototype.getModeText=function(){switch(this._appPermissionMode){case 1:return this._readOnlyStatusText;case 2:return this._reviewModeStatusText;default:return null}},e.prototype.isDispatched=function(e){return this._lastHidden===this._isHidden&&this._lastPermissionMode===this._appPermissionMode&&this._lastStatusText===e},e.prototype.dispatchAppChromeAction=function(e){var t=this,n=window.performance.now();er.apiExtensionExists("getHeaderApi")?appChrome.getHeaderApi().then((function(r){return r.updateDocumentTitleStatus(t._isHidden,e,t.getModeText()),C.ULS.sendTraceTag(51709962,340,50,"Call UpdateDocumentTitleStatus time:"+(window.performance.now()-n).toString()+" ms"),null})):(appChrome.api.dispatch(appChrome.actions.updateDocumentTitleStatus(this._isHidden,e,this.getModeText())),C.ULS.sendTraceTag(51709962,340,50,"Dispatch  UpdateDocumentTitleStatus time:"+(window.performance.now()-n).toString()+" ms")),this._requestIdleCallbackHandler=null},e.prototype.dispatchSaveStatusAction=function(e){var t=this;this._isInitialized&&er.appChromeAlreadyLoaded()&&!this.isDispatched(e)&&(Bt.g.requestIdleCallbackExists()?(this._requestIdleCallbackHandler&&C.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this._requestIdleCallbackHandler=window.requestIdleCallback((function(n){t.dispatchAppChromeAction(e)}))):window.requestAnimationFrame((function(n){t.dispatchAppChromeAction(e)})),this._lastHidden=this._isHidden,this._lastStatusText=e,this._lastPermissionMode=this._appPermissionMode)},e}();(0,o.l)(pi,"ReactSaveStatusUIHandler",null,[gi.i]);var di=function(){function e(e,t){this.hostPostmessenger=null,this._hostPostmessengerFuture=null,this._editNotificationEventSource=null,this._saveStatus=!1,this._appPermissionMode=0,this._savedStatusText=CommonUIStrings.l_SavedStatus,this._savingStatusText=CommonUIStrings.l_SavingStatus,this._readOnlyStatusText=CommonUIStrings.l_ReadOnlyStatus,this._reviewModeStatusText=CommonUIStrings.l_ReviewModeStatus,this._hostPostmessengerFuture=t,this._editNotificationEventSource=e,this._appPermissionMode=3,this._saveStatus=!0}return e.prototype.registerHandlers=function(){var e=this;this._editNotificationEventSource&&this._editNotificationEventSource.execute((function(t){t.add_onEditHappened(o.i(e,e.updateToSavingStatus,"updateToSavingStatus"))})),this._hostPostmessengerFuture.execute((function(t){e.hostPostmessenger=t}))},e.prototype.updateSaveStatusDisplay=function(e,t){this._appPermissionMode=t,3===t?this.updateSaveStatusText(this._saveStatus):2===t?this.trySendPostMessageToHost(this._reviewModeStatusText):this.trySendPostMessageToHost(this._readOnlyStatusText)},e.prototype.updateToSavingStatus=function(e,t){this.updateSaveStatusText(!1)},e.prototype.updateSaveStatusText=function(e){this._saveStatus=e;var t=this._saveStatus?this._savedStatusText:this._savingStatusText;this.trySendPostMessageToHost(t)},e.prototype.updateToFailStatus=function(e){this._saveStatus=!1,this.trySendPostMessageToHost(e)},e.prototype.updateStatusText=function(e){this.trySendPostMessageToHost(e)},e.prototype.trySendPostMessageToHost=function(e){this.hostPostmessenger&&this.hostPostmessenger.sendMessage(Me.a.uI_SaveStatus,this.constructPostMessageData(e))},e.prototype.constructPostMessageData=function(e){var t={};return t.StatusText=e,t},e}();(0,o.l)(di,"SaveStatusPostMessageHandler",null,[gi.i]);var hi=n(7498),_i=n(3721),mi=function(){function e(e,t,n,r){this._eventHandlerManager=null,this._headerEventSource=null,this._editNotificationEventSource=null,this._savedStatusText=null,this._savingStatusText=null,this._readOnlyStatusText=null,this._reviewModeStatusText=null,this._isFirstTextUpdate=!1,this._isRtl=!1,this._isHidden=!1,this._appPermissionMode=0,this._saveStatus=!1,this._maxElementWidth=0,this._titleElement=null,this._appModeDashElement=null,this._appModeStatusElement=null,this._saveStatusDashElement=null,this._saveStatusElement=null,this._eventHandlerManager=e,this._headerEventSource=t,this._editNotificationEventSource=n,this._isRtl=r,this._isFirstTextUpdate=!0,this._isHidden=!1,this._appPermissionMode=3,this._saveStatus=!0}return e.prototype.initialize=function(e,t){return!!this._eventHandlerManager&&(this._savedStatusText=this.getSavedStatusText(e,t),this._savingStatusText=CommonUIStrings.l_SavingStatus,this._readOnlyStatusText=CommonUIStrings.l_ReadOnlyStatus,this._reviewModeStatusText=CommonUIStrings.l_ReviewModeStatus,this.registerHandlers(),!0)},e.prototype.getSavedStatusText=function(e,t){return e?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):t&&t.length?String.format(CommonUIStrings.l_SavedToStatus,t):CommonUIStrings.l_SavedStatus},e.prototype.registerHandlers=function(){var e=this;this._headerEventSource&&this._headerEventSource.execute((function(t){t.add_onTopRowControlsCreated(o.i(e,e.createStatusAndModeElements,"createStatusAndModeElements")),t.add_onRenameTextboxStatusChanged(o.i(e,e.showHideSaveStatusElement,"showHideSaveStatusElement")),t.get_topRowControlsCreated()&&e.createStatusAndModeElements(null,null)})),this._editNotificationEventSource&&this._editNotificationEventSource.execute((function(t){t.add_onEditHappened(o.i(e,e.updateToSavingStatus,"updateToSavingStatus"))}))},e.prototype.unregisterHandlers=function(){this._saveStatusElement&&this._eventHandlerManager&&this._eventHandlerManager.unregisterAllHandlers(this._saveStatusElement)},e.prototype.showHideSaveStatusElement=function(e,t){this.updateSaveStatusDisplay("true"===t,this._appPermissionMode)},e.prototype.updateSaveStatusDisplay=function(e,t){this._isHidden=e,this._appPermissionMode=t,this._appModeDashElement&&(this._appModeDashElement.style.display=this._isHidden||3===this._appPermissionMode||!this._titleElement?"none":""),this._appModeStatusElement&&(this._appModeStatusElement.style.display=this._isHidden||3===this._appPermissionMode?"none":"",this._appModeStatusElement.innerText=1===this._appPermissionMode?this._readOnlyStatusText:this._reviewModeStatusText,this._appModeStatusElement.title=1===this._appPermissionMode?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip),this._saveStatusDashElement&&(this._saveStatusDashElement.style.display=this._isHidden||1===this._appPermissionMode||!this._titleElement&&!this._appModeStatusElement?"none":""),this._saveStatusElement&&(this._saveStatusElement.style.display=this._isHidden||1===this._appPermissionMode?"none":"",this.updateSaveStatusText(this._saveStatus),this._saveStatusElement.title=CommonUIStrings.l_SaveStatusTooltip)},e.prototype.createStatusAndModeElements=function(e,t){var n=document.getElementById(Ct.CuiHelper.headerDocumentTitleSpanId);!(!!t&&t.withoutSaveStatus)&&n&&""!==this._savedStatusText&&""!==this._savingStatusText&&""!==this._readOnlyStatusText&&""!==this._reviewModeStatusText&&(this._titleElement=document.getElementById(Ct.CuiHelper.breadcrumbTitleId),this._appModeDashElement=Ct.CuiHelper.createBreadcrumbItem(n,"BreadcrumbAppModeDash","-",null,!1),this._appModeStatusElement=Ct.CuiHelper.createBreadcrumbItem(n,"BreadcrumbAppModeStatus",1===this._appPermissionMode?this._readOnlyStatusText:this._reviewModeStatusText,null,!1),this.updateElementStyle(this._appModeStatusElement),this._saveStatusDashElement=Ct.CuiHelper.createBreadcrumbItem(n,"BreadcrumbSaveStatusDash","-",null,!1),this._saveStatusElement=Ct.CuiHelper.createBreadcrumbItem(n,"BreadcrumbSaveStatus",this._savedStatusText,null,!1),this.updateElementStyle(this._saveStatusElement),this.updateSaveStatusDisplay(this._isHidden,this._appPermissionMode))},e.prototype.updateToSavingStatus=function(e,t){this.updateSaveStatusText(!1)},e.prototype.updateSaveStatusText=function(e){this._saveStatus=e,this.updateSaveElementText(this._saveStatus?this._savedStatusText:this._savingStatusText)},e.prototype.updateToFailStatus=function(e){this._saveStatus=!1,this.updateAndAdjustStatusElementWidth(e)},e.prototype.updateStatusText=function(e){this.updateAndAdjustStatusElementWidth(e)},e.prototype.updateSaveElementText=function(e){!this._saveStatusElement||3!==this._appPermissionMode&&2!==this._appPermissionMode||(this._isFirstTextUpdate&&!this._saveStatus?(this._maxElementWidth=this._saveStatusElement.offsetWidth<this._maxElementWidth?this._maxElementWidth:this._saveStatusElement.offsetWidth,this.updateAndAdjustStatusElementWidth(this._savingStatusText),this._isFirstTextUpdate=!1):this._saveStatusElement.innerText=e)},e.prototype.updateElementStyle=function(e){e.style.direction=this._isRtl?"rtl":"ltr",e.style.width="auto",e.style.textAlign=this._isRtl?"right":"left",e.style.display=this._isHidden?"none":"",e.setAttribute("Unselectable","on")},e.prototype.updateAndAdjustStatusElementWidth=function(e){if(this._saveStatusElement){this._saveStatusElement.style.width="",this._saveStatusElement.innerText=e,this._maxElementWidth=this._saveStatusElement.offsetWidth<this._maxElementWidth?this._maxElementWidth:this._saveStatusElement.offsetWidth;var t=hi.o.getCurrentStyle(this._saveStatusElement);this._saveStatusElement.style.width=this._maxElementWidth-_i.s.parseCssSize(t.paddingLeft)-_i.s.parseCssSize(t.paddingRight)+1+"px"}},e}();(0,o.l)(mi,"SaveStatusUIHandler",null,[gi.i]);var fi=n(6387),yi=function(){function e(){this._container=null,this._saveStatusUIHandler=null,this._reactSaveStatusUIHandler=null,this._saveStatusPostMessageHandler=null}return e.prototype.get_name=function(){return"Common.App.SaveStatus"},e.prototype.configure=function(e){var t=this;this._container=e,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PostMessageEmbedded")&&L.AFrameworkApplication.hideHeaderEmbedded?this._container.register(di).as(gi.i).singleInstance().usingFactory((function(){return new di(t._container.resolveFuture(Pe.n),t._container.resolveFuture(Fe.i))})):L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSyncUxFeatureEnabled()||(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()?this._container.register(pi).as(gi.i).singleInstance().usingFactory((function(){return new pi(t._container.resolveFuture(Pe.n))})):this._container.register(mi).as(gi.i).singleInstance().usingFactory((function(){return new mi(fi.EventHandlerManager.get_instance(),t._container.resolveFuture(je.p),t._container.resolveFuture(Pe.n),L.AFrameworkApplication.get_isRtl())})))},e.prototype.init=function(){L.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady(o.i(this,this.onFullAppSettingsReady,"onFullAppSettingsReady"))},e.prototype.onFullAppSettingsReady=function(){var e=L.AFrameworkApplication.appSettingsManager,t=!!L.AFrameworkApplication.get_activeFrame().get_applicationInstance()&&4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType();(e.getBooleanAppSetting("WordEditorAutoSaveImprovementIsEnabled")||e.getBooleanAppSetting("PptEditorSaveStatusInHeaderEnabled")||t&&e.getBooleanAppSetting("SimplifiedReactRibbonUxIsEnabled")||e.getBooleanAppSetting("ExcelSaveStatusInHeaderEnabled")||e.getBooleanAppSetting("VisioSaveStatusInHeaderEnabled"))&&(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PostMessageEmbedded")&&L.AFrameworkApplication.hideHeaderEmbedded?(this._saveStatusPostMessageHandler=this._container.resolve(di),this._saveStatusPostMessageHandler&&this._saveStatusPostMessageHandler.registerHandlers()):L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSyncUxFeatureEnabled()||(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()?(this._reactSaveStatusUIHandler=this._container.resolve(pi),this._reactSaveStatusUIHandler&&this._reactSaveStatusUIHandler.initialize(e.getBooleanAppSetting("IsSkyDrive"),e.getStringAppSetting("HostNameToIncludeInSavedStatus"))):(this._saveStatusUIHandler=this._container.resolve(mi),this._saveStatusUIHandler&&this._saveStatusUIHandler.initialize(e.getBooleanAppSetting("IsSkyDrive"),e.getStringAppSetting("HostNameToIncludeInSavedStatus")))))},e.prototype.dispose=function(){this._saveStatusUIHandler&&this._saveStatusUIHandler.unregisterHandlers()},e}();(0,o.l)(yi,"PackageManager$0",null,[l.u,c.s]);var Ci=n(1126),Si=function(){function e(){}return e.prototype.get_name=function(){return"Common.App.EventsCachePackage"},e.prototype.configure=function(e){},e.prototype.init=function(){Ci.a.get_instance().init()},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Si,"EventsCachePackage",null,[l.u,c.s]);var vi=n(5725),bi=n(741),Ti=n(7073),Ai=(0,o.y)("IPresenceContextMenuSectionBuilder"),Ii=n(3049),wi=n(5388),xi=n(1673),Fi=(0,o.y)("IControlBehaviorFactory"),Ei=(0,o.y)("IControlBehavior"),Pi=n(2804),ki=n(7712),Di=n(5837),Mi=n(5294),Ri=n(5764),Li=n(9717),Ni=n(9001),Bi=n(103),Oi=function(){function e(e){this.control=null,this._isCommitChangeFixEnabled=!1,this._activeElement=null,this._activeElementBounds=null,this._activeElementHovered=!1,this.control=e}return e.prototype.get_control=function(){return this.control},e.prototype.get_stateProperties=function(){return this.get_control().get_stateProperties()},e.prototype.get_root=function(){return this.get_control().get_root()},e.prototype.get_parentMenu=function(){return this.get_control().get_parentMenu()},e.prototype.get_activatesOnPress=function(){return this.get_control().get_activatesOnPress()},e.prototype.get_displayedComponent=function(){return this.get_control().get_displayedComponent()},e.prototype.get_controlComponentDomCache=function(){return this.get_control().get_controlComponentDomCache()},e.prototype.attachEvents=function(e){},e.prototype.initialize=function(){},e.prototype.doDefaultAction=function(e,t,n){this.get_control().doDefaultActionPublic(e,t,n)},e.prototype.pollForStateAndUpdate=function(){Li.x(this.get_control().get_controlProperties().Command)||this.pollForStateAndUpdateInternal(this.get_control().get_controlProperties().Command,null,null)},e.prototype.pollForStateAndUpdateInternal=function(e,t,n){var r=0;return this.get_root()&&(r=this.get_root().pollForCommandState(e,t,n)),this.get_control().set_enabled((1&r)>0),r},e.prototype.updateVisibility=function(){var e=this.get_control().get_visible();return this.get_root().get_supportsInvisibleControls()&&(e=this.get_stateProperties()[Ni.b.visible])!==this.get_control().get_visible()&&(this.get_control().set_visible(e),this.get_root().needRefresh=!0),e},e.prototype.updateLabelText=function(){var e=Bi.n.validateStringProperty(this.get_stateProperties()[Ni.b.labelText],this.get_control().get_controlProperties().LabelText);this.setLabelText(e)},e.prototype.setLabelText=function(e){this.get_control().labelText!==e&&(this.get_controlComponentDomCache().forEach((function(t){t.setLabelText(e)})),this.get_control().labelText=e,this.get_root().needScaling=!0)},e.prototype.updateTooltip=function(){var e=Bi.n.validateStringProperty(this.get_stateProperties()[Ni.b.alt],this.get_control().get_controlProperties().Alt);this.setTooltip(e)},e.prototype.setTooltip=function(e){this.get_control().tooltip!==e&&(this.get_controlComponentDomCache().forEach((function(t){t.setTooltip(e)})),this.get_control().tooltip=e)},e.prototype.updateImage=function(){var e=Bi.n.validateStringProperty(this.get_stateProperties()[ki.f.Image16by16Class],this.get_control().get_controlProperties().Image16by16Class),t=Bi.n.validateStringProperty(this.get_stateProperties()[ki.f.Image32by32Class],this.get_control().get_controlProperties().Image32by32Class),n=Bi.n.validateStringProperty(this.get_stateProperties()[ki.f.Image48by48Class],this.get_control().get_controlProperties().Image48by48Class),r=Li.t(n)?t:n;this.applyImageCssClass(this.get_controlComponentDomCache().get_small(),e),this.applyImageCssClass(this.get_controlComponentDomCache().get_medium(),e),this.applyImageCssClass(this.get_controlComponentDomCache().get_large(),t),this.applyImageCssClass(this.get_controlComponentDomCache().get_smallMenu(),e),this.applyImageCssClass(this.get_controlComponentDomCache().get_largeMenu(),r)},e.prototype.applyImageCssClass=function(e,t){e&&(Li.x(e.elmImage)||Li.x(t)||e.elmImage.className===t||(e.elmImage.className=t))},e.prototype.updateDisplayMode=function(e){if(!Li.t(e)&&this.get_root().get_supportsDynamicDisplayMode()){for(var t=0,n=this.get_control().get_components();t<n.length;t++){var r=n[t],i=r.get_displayMode()===e;i&&(!0,this.get_control().set_activeComponentWhenVisible(r)),this.get_control().get_visible()&&r.set_visibleInDOM(i)}this.get_control().get_visible()&&(this.get_root().needScaling=!0)}},e.prototype.adjustLayoutForLargeMenu=function(){if(this.get_controlComponentDomCache().get_largeMenu()&&this.get_controlComponentDomCache().get_largeMenu().elmLabel&&this.get_controlComponentDomCache().get_largeMenu().elmDescription){var e=this.get_controlComponentDomCache().get_largeMenu().elmLabel,t=Bi.n.validateStringProperty(this.get_stateProperties()[Di.e.Description],this.get_control().get_controlProperties().Description);Li.t(t)&&(e.style.position="relative",e.style.top=(e.parentNode.offsetHeight-e.offsetHeight)/2+"px",e.style.padding="0px")}},e.prototype.onFocus=function(e){var t=this.get_displayedComponent();return o.r(Mi.m,t)?this.get_parentMenu().updateFocusedIndex(t):this.get_root().set_controlWithFocus(this.get_control()),!1},e.prototype.onBlur=function(e){var t=this.get_displayedComponent();return this.get_control().isStandardMenuItem()&&Bi.n.removeCSSClassFromElement(t.get_elementInternal(),"cui-ctl-menu-hovered-without-focus"),this.get_root().set_controlWithFocus(null),!1},e.prototype.onPointerOver=function(e){if(this.get_control().isStandardMenuItem()){var t=this.get_parentMenu().get_stackIndex(),n=t===this.get_root().get_menuStackDepth()-1,r=n?null:this.get_root().get_menuLauncherStack()[t+1];this.closeChildMenus(!1),n||this.get_control()===r||Bi.n.removeCSSClassFromElement(r.get_launcher(),Ri.MenuLauncher.menuDroppedClassName),this.get_control().get_enabled()&&this.get_control().get_focusableElement()?n?this.get_control().setFocusOnControl():(Bi.n.ensureCSSClassOnElement(this.get_displayedComponent().get_elementInternal(),"cui-ctl-menu-hovered-without-focus"),r.set_elmHadFocus(this.get_control().get_focusableElement())):n?this.get_parentMenu().setFocus(e.get_inputSource()):(r.set_elmHadFocus(this.get_parentMenu().get_elementInternal()),this.get_parentMenu().resetFocusedIndex())}return!1},e.prototype.onPointerOut=function(e){return this.get_control().isStandardMenuItem()&&Bi.n.removeCSSClassFromElement(this.get_displayedComponent().get_elementInternal(),"cui-ctl-menu-hovered-without-focus"),!1},e.prototype.onKeyDown=function(e){var t=!1;if(!Li.x(e.innerEvent)&&!Li.x(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,r=e.innerEvent.keyCode,i=n.shiftKey;if(r===Sys.UI.Key.enter&&(t=!0),o.r(Mi.m,this.get_displayedComponent())){var a=this.get_parentMenu();if(!Li.x(a)){var s=a.get_stackIndex(),l=!this.get_root().get_textDirection(),c=!Li.x(this.get_control().get_parentGrid());if(r!==Sys.UI.Key.tab&&r!==Sys.UI.Key.left&&r!==Sys.UI.Key.right&&r!==Sys.UI.Key.up&&r!==Sys.UI.Key.down&&r!==Sys.UI.Key.esc)return t;Bt.g.clearSelectionIfNecessary(),r!==Sys.UI.Key.tab||i?r===Sys.UI.Key.tab&&i?(a.focusNext(1),t=!0):r===Sys.UI.Key.left&&l||r===Sys.UI.Key.right&&!l?(c?a.focusNext(2):s>0&&this.get_root().closeMenuStackAtIndex(s,!0,!1),t=!0):r===Sys.UI.Key.right&&l||r===Sys.UI.Key.left&&!l?(c&&a.focusNext(4),t=!0):r===Sys.UI.Key.up?(a.focusNext(5),t=!0):r===Sys.UI.Key.down?(a.focusNext(6),t=!0):r===Sys.UI.Key.esc&&(this.get_root().closeMenuStackAtIndex(s,!0,!1),t=!0):(a.focusNext(0),t=!0)}}}return t},e.prototype.onKeyUp=function(e){var t=!1;if(!Li.x(e.innerEvent)&&!Li.x(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,r=e.innerEvent.keyCode;n.shiftKey;Xe.KeyInputManager.hasKeyModifiers(e)||r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||(t=this.handleDefaultActionWithKeytips(e))||(this.doDefaultAction(e.get_sourceElement(),1,e.innerEvent),t=!0)}return t},e.prototype.onPointerDown=function(e){if(this.commitRootPendingChanges(),this.get_activatesOnPress()){var t=!0;2===e.get_inputSource()&&(t=!e.get_mouseButton()),t&&this.get_displayedComponent()&&this.activateElement(this.get_displayedComponent().get_elementInternal())}return(e.innerEvent.type.toLowerCase()!==Le.d.touchStart||this.get_activatesOnPress())&&e.innerEvent.preventDefault(),!1},e.prototype.get_isCommitChangeFixEnabled=function(){return this._isCommitChangeFixEnabled},e.prototype.enableCommitChangeFix=function(){this._isCommitChangeFixEnabled=!0},e.prototype.commitRootPendingChanges=function(){this.get_isCommitChangeFixEnabled()&&this.get_control().get_root().commitAnyPendingChange()},e.prototype.onPointerUp=function(e){var t=!1;return!o.r(Mi.m,this.get_displayedComponent())||this.get_activatesOnPress()||2!==e.get_inputSource()||e.get_mouseButton()?t=this.get_control().deactivateElement(e):(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0),t},e.prototype.onClick=function(e){var t=!1;return o.r(Mi.m,this.get_displayedComponent())&&!this.get_activatesOnPress()&&3===e.get_inputSource()&&(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0),!G.y.get_isIPad()&&t},e.prototype.onTouchMove=function(e){return this.onActivePointerMove(e)},e.prototype.onTouchEnd=function(e){return this.deactivateElement(e),!1},e.prototype.onActivePointerMove=function(e){if(!Li.x(this._activeElement)){var t=Bt.g.isPointInBounds(this.get_activeElementBounds(),e.get_clientPoint());return this.setActiveElementHovered(t),!0}return!1},e.prototype.onModalBodyPointerDown=function(e){var t=!1;return this.deactivateElement(e)&&(t=!0),3!==e.get_inputSource()&&(this.get_root().closeAllMenus(),t=!0),t},e.prototype.onModalBodyPointerUp=function(e){return this.deactivateElement(e)},e.prototype.onModalBodyPointerMove=function(e){return this.onActivePointerMove(e)},e.prototype.onModalBodyPointerOut=function(e){return this.deactivateElement(e)},e.prototype.onModalBodyClick=function(e){return 3===e.get_inputSource()&&(this.get_root().closeAllMenus(),!0)},e.prototype.onModalBodyMouseWheel=function(e){return!1},e.prototype.get_activeElementBounds=function(){return!Li.x(this._activeElement)&&Li.x(this._activeElementBounds)&&(this._activeElementBounds=Bt.g.getElementBounds(this._activeElement)),this._activeElementBounds},e.prototype.setActiveElementHovered=function(e){this._activeElementHovered!==e&&(this._activeElementHovered=e,this.activeElementStateChanged(this._activeElementHovered))},e.prototype.activeElementStateChanged=function(e){Li.x(this._activeElement)||Bi.n.toggleCSSClassOnElement(this._activeElement,Pi.Control.activeClassName,e)},e.prototype.activateElement=function(e){this.get_control().get_enabled()&&(this._activeElement=e,this.get_root().set_activeControl(this.get_control()),this.setActiveElementHovered(!0),this.get_root().beginModal(this.get_control(),!1))},e.prototype.deactivateElement=function(e){if(!Li.x(this._activeElement)){if(this.setActiveElementHovered(!1),this.get_root()&&this.get_root().endModal(this.get_control(),!1),!Li.x(e)){var t=e.get_clientPoint();Bt.g.isPointInBounds(this.get_activeElementBounds(),t)&&this.doDefaultAction(this._activeElement,e.get_inputSource(),e.innerEvent)}return this.get_root()&&this.get_root().set_activeControl(null),this._activeElement=null,this._activeElementBounds=null,!0}return!1},e.prototype.focusNext=function(e){var t=this.get_displayedComponent();return!(!o.r(Mi.m,t)||2===e||4===e||Bt.g.isActiveElement(this.get_control().get_focusableElement()))&&this.setFocusOnControl()},e.prototype.setFocusOnControl=function(){try{if(this.get_control().get_visible()){var e=this.get_control().get_focusableElement();if(!Li.x(e))return e.focus(),!0}}catch(e){}return!1},e.prototype.closeChildMenus=function(e){var t=this.get_parentMenu();Li.x(t)||this.get_root().closeMenuStackAtIndex(t.get_stackIndex()+1,e)},e.prototype.onMenuClosed=function(){},e.prototype.handleDefaultActionWithKeytips=function(e){return!1},e.prototype.getTelemetryData=function(t){var n=null;return t&&t.rawEvent&&((n={})[e.triggerTime]=t.rawEvent.timeStamp),n},e.triggerTime="TriggerTime",e}();(0,o.l)(Oi,"ControlBehavior",null,[Ei]);var Ui=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.get_button=function(){return this.get_control()},t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.attachEvents=function(e){var t=e.elmControl,n=e.get_displayMode();Li.x(t)||(ze.z.get_instance().registerHandler(Le.d.focus,t,o.i(this,this.onFocus,"onFocus")),ze.z.get_instance().registerHandler(Le.d.blur,t,o.i(this,this.onBlur,"onBlur")),xi.z.get_instance().registerHandler(Le.d.pointerOver,t,o.i(this,this.onPointerOver,"onPointerOver")),xi.z.get_instance().registerHandler(Le.d.pointerOut,t,o.i(this,this.onPointerOut,"onPointerOut")),Xe.KeyInputManager.get_instance().registerHandlerWithData(Le.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown"),n),Xe.KeyInputManager.get_instance().registerHandlerWithData(Le.d.keyPress,t,o.i(this,this.onKeyPress,"onKeyPress"),n),Xe.KeyInputManager.get_instance().registerHandlerWithData(Le.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp"),n),xi.z.get_instance().registerHandler(Le.d.pointerDown,t,o.i(this,this.onPointerDown,"onPointerDown")),xi.z.get_instance().registerHandler(Le.d.pointerUp,t,o.i(this,this.onPointerUp,"onPointerUp")),hn.s.get_instance().registerHandler(Le.d.click,t,o.i(this,this.onClick,"onClick")),_n.v.get_instance().registerHandler(Le.d.touchMove,t,o.i(this,this.onTouchMove,"onTouchMove")),_n.v.get_instance().registerHandler(Le.d.touchEnd,t,o.i(this,this.onTouchEnd,"onTouchEnd")))},t.prototype.doDefaultAction=function(e,t,n){if(this.get_control().get_enabled()){var r=null;if(this.get_displayedComponent()&&this.get_displayedComponent().isMenuItem()&&this.get_parentMenu()){var i=this.get_parentMenu().get_stackIndex();(r=this.get_root().get_menuLauncherStack()[i])&&!this.get_isCommitChangeFixEnabled()&&(r.selectDropdownItem(this.get_button()),r=null)}this.executeCommand(this.get_control().get_controlProperties().Command,t,!0,n),r&&r.selectDropdownItem(this.get_button())}},t.prototype.executeCommand=function(e,t,n,r){if(!Li.x(e)){var i=this.get_stateProperties();i.CommandValueId=this.get_button().getCommandValueId(),i.MenuItemId=this.get_button().getMenuItemId(),i.SourceControlId=this.get_control().get_id(),this.get_root().executeCommand(e,i,this.get_displayedComponent(),t,n,null,this.getTelemetryData(r))}},t.prototype.pollForStateAndUpdate=function(){Li.x(this.get_control().get_controlProperties().Command)||(2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties()))>0&&this.updateVisibility()&&this.updateHtml()},t.prototype.updateHtml=function(){this.updateLabelText(),this.updateTooltip(),this.updateImage()},t.prototype.onFocus=function(t){return e.prototype.onFocus.call(this,t),this.startLivePreview(),!1},t.prototype.onBlur=function(t){return e.prototype.onBlur.call(this,t),this.endLivePreview(),!1},t.prototype.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!Li.x(t.innerEvent)){var r=t.userData,i=t.innerEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(r,i)&&(n=!1)}return n},t.prototype.onKeyPress=function(e){var t=!1;if(!Li.x(e.innerEvent)&&!Li.x(e.innerEvent.rawEvent)){var n=e.userData,r=e.innerEvent.rawEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(n,r)?(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0):e.innerEvent.preventDefault()}return t},t.prototype.shouldDoDefaultActionOnKeyPress=function(e,t){if(G.y.get_isInternetExplorerNonEdge()&&t===Sys.UI.Key.enter)switch(e){case"MenuMru":case"MenuTemplate":case"MenuHeader":case"MenuFooter":return!0}return!1},t.prototype.onKeyUp=function(t){var n=!1;if(!Li.x(t.innerEvent)){var r=t.userData,i=t.innerEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(r,i)||(n=e.prototype.onKeyUp.call(this,t))}return n},t.prototype.startLivePreview=function(){this.get_control().get_enabled()&&this.executeCommand(this.get_properties().CommandPreview,0,!1,null)},t.prototype.endLivePreview=function(){this.get_control().get_enabled()&&this.executeCommand(this.get_properties().CommandRevert,0,!1,null)},t}(Oi);(0,o.l)(Ui,"ButtonBehavior",Oi,[]);var Hi=n(5787),Gi=function(){function e(){}return e.Color="Color",e.IndexColorSelected="ColorSelected",e}();(0,o.l)(Gi,"ColorPickerCommandProperties",null,[]);var Vi=function(e){function t(t){var n=e.call(this,t)||this;return n._focusedIndex=-1,n._selectedIndex=-1,n}return(0,S.t)(t,e),t.prototype.get_colorPicker=function(){return this.get_control()},t.prototype.get_colorCells=function(){return this.get_colorPicker().get_colorPickerDom().colorCells},t.prototype.get_properties=function(){return this.get_colorPicker().get_controlProperties()},t.prototype.doDefaultAction=function(e,n,r){if(this.get_control().get_enabled()){var i=t.getNearestContainingParentElementOfType(e,"td"),o=this.get_stateProperties();o.Color=i[Hi.ColorPicker.colorInformation];var a=null;if(Bi.n.isTrue(this.get_properties().Stateful)&&this.get_displayedComponent()&&this.get_displayedComponent().isMenuItem()&&this.get_parentMenu()){var s=this.get_parentMenu().get_stackIndex();a=this.get_root().get_menuLauncherStack()[s]}this.get_root().executeCommand(this.get_properties().Command,o,this.get_displayedComponent(),n,!0,null,this.getTelemetryData(r)),a&&a.selectDropdownItem(this.get_colorPicker())}},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties();if(e.SourceControlId=this.get_properties().Id,(2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,e))>0){var t=-1;if(Gi.IndexColorSelected in this.get_stateProperties()&&(t=this.get_stateProperties()[Gi.IndexColorSelected]),t!==this._selectedIndex){var n=this.get_colorCells();0<=t&&t<n.length&&this.updateCellSelection(n[t],!0),0<=this._selectedIndex&&this._selectedIndex<n.length&&this.updateCellSelection(n[this._selectedIndex],!1),this._selectedIndex=t}}},t.prototype.updateCellSelection=function(e,t){t?Bi.n.ensureCSSClassOnElement(e,"cui-colorpicker-selected"):Bi.n.removeCSSClassFromElement(e,"cui-colorpicker-selected")},t.prototype.attachEvents=function(e){for(var t=e,n=0;n<t.aTags.length;++n){var r=t.aTags[n];ze.z.get_instance().registerHandler(Le.d.focus,r,o.i(this,this.onCellFocus,"onCellFocus")),ze.z.get_instance().registerHandler(Le.d.blur,r,o.i(this,this.onCellBlur,"onCellBlur")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyDown,r,o.i(this,this.onKeyDown,"onKeyDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyUp,r,o.i(this,this.onKeyUp,"onKeyUp")),hn.s.get_instance().registerHandler(Le.d.click,r,o.i(this,this.onCellClick,"onCellClick")),xi.z.get_instance().registerHandler(Le.d.pointerUp,r,o.i(this,this.onCellPointerUp,"onCellPointerUp")),xi.z.get_instance().registerHandler(Le.d.pointerOver,r,o.i(this,this.onCellPointerOver,"onCellPointerOver")),xi.z.get_instance().registerHandler(Le.d.pointerDown,r,o.i(this,this.onCellPointerDown,"onCellPointerDown"))}},t.prototype.onCellFocus=function(e){var n=t.getNearestContainingParentElementOfType(e.get_sourceElement(),"td");return this.get_parentMenu().updateFocusedIndex(this.get_displayedComponent()),this.updateCellFocus(n,!0),!0},t.prototype.onCellBlur=function(e){var n=t.getNearestContainingParentElementOfType(e.get_sourceElement(),"td");return this.updateCellFocus(n,!1),!0},t.prototype.updateCellFocus=function(e,t){t?(this._focusedIndex=parseInt(e.getAttribute("arrayPosition")),Bi.n.ensureCSSClassOnElement(e,"cui-colorpicker-hoveredOver"),this.startLivePreview(e)):(this._focusedIndex=-1,this.endLivePreview(e),Bi.n.removeCSSClassFromElement(e,"cui-colorpicker-hoveredOver"))},t.prototype.onCellClick=function(e){return 3===e.get_inputSource()&&this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),!0},t.prototype.onCellPointerUp=function(e){return 3!==e.get_inputSource()&&this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),!0},t.prototype.onCellPointerOver=function(e){this.closeChildMenus(!1);var n=t.getNearestContainingParentElementOfType(e.get_sourceElement(),"td"),r=parseInt(n.getAttribute("arrayPosition"));return this.setFocusOnCell(r),!0},t.prototype.onCellPointerDown=function(e){return!1},t.prototype.startLivePreview=function(e){if(this.get_control().get_enabled()){var t=this.get_properties().CommandPreview;if(!Li.t(t)){var n=this.get_stateProperties();n.Color=e[Hi.ColorPicker.colorInformation],this.get_root().executeCommand(t,n,this.get_displayedComponent(),0,!1)}}},t.prototype.endLivePreview=function(e){if(this.get_control().get_enabled()){var t=this.get_properties().CommandRevert;if(!Li.t(t)){var n=this.get_stateProperties();n.Color=e[Hi.ColorPicker.colorInformation],this.get_root().executeCommand(t,n,this.get_displayedComponent(),0,!1)}}},t.prototype.focusNext=function(e){var t=Pi.Control.focusNextIndexInGrid(this._focusedIndex,this.get_colorPicker().get_width(),this.get_colorCells().length,e);return!(t===this._focusedIndex||!this.setFocusOnCell(t))||(this.updateCellFocus(this.get_colorCells()[this._focusedIndex],!1),!1)},t.prototype.setFocusOnControl=function(){return this.setFocusOnCell(0)},t.prototype.setFocusOnCell=function(e){if(this.get_colorCells()&&this.get_colorCells().length>e){var t=this.get_colorCells()[e];if(t.firstChild)return t.firstChild.focus(),!0}return!1},t.prototype.onMenuClosed=function(){-1!==this._focusedIndex&&this.updateCellFocus(this.get_colorCells()[this._focusedIndex],!1)},t.getNearestContainingParentElementOfType=function(e,n){return t.getNearestContainingParentElementOfTypes(e,[n])},t.getNearestContainingParentElementOfTypes=function(e,t){var n=t.length;if(!e)return null;for(var r=0;r<n;r++)if(e.tagName.toLowerCase()===t[r].toLowerCase())return e;for(var i=e.parentNode;i;){for(r=0;r<n;r++)if(i.tagName.toLowerCase()===t[r].toLowerCase())return i;i=i.parentNode}return null},t}(Oi);(0,o.l)(Vi,"ColorPickerBehavior",Oi,[]);var Wi=n(1252),zi=n(5912),Ki=n(1152),qi=(0,o.y)("IMenuLauncherBehavior"),ji=n(876),$i=n(7692),Qi=n(8355),Ji=n(6489),Xi=n(3301),Yi=n(717),Zi=n(5171),eo=n(2170),to=function(){function e(e,t){this._textDirectionLtr=!1,this._isAppDivSyndicated=!1,this._textDirectionLtr=e,this._isAppDivSyndicated=t}return e.prototype.setFlyoutCoordinates=function(t,n,r,i){if(Li.x(t)||Li.x(n))return null;var o,a,s=new eo.w,l=i.x,c=i.y,u=i.width,g=i.height,d=e.dictToInt(n,"flyoutWidth"),h=e.dictToInt(n,"flyoutRealHeight"),_=e.dictToInt(n,"viewportWidth"),m=e.dictToInt(n,"viewportHeight"),f=e.dictToInt(n,"viewableLeft"),y=e.dictToInt(n,"viewableTop"),C=this._textDirectionLtr,S=!1,v=!1,b=1===r,T=4===r,A=this._isAppDivSyndicated;if(t.style.maxHeight="none",t.style.top="0px",t.style.overflowY="visible",t.style.width="auto",d=this.measureWidth(t),s.viewPortHeight=m,s.viewPortWidth=_,b)C?o=l+u:(o=l-d,s.launchedLeft=!0),a=c;else{var I="";u>d&&(I=((d=u)-2*Zi.Menu.menuBorderPx).toString()),C?o=l:(o=l+u-d,s.launchedLeft=!0),a=c+g,""!==I&&(t.style.minWidth=I+"px")}A&&(a+=y,o+=f),t.style.top=a+"px",t.style.left=o+"px";var w=!1,x=!1;d<=_?o+d>f+_?(b&&C&&l-d>f||T&&l-d>f?(o=l-d,A&&(o+=f),s.launchedLeft=!0,x=!0):(o=f+_-d,S=!0),w=!0):o<f&&(b&&!C&&l+u+d<f+_?(o=l+u,A&&(o+=f),s.launchedLeft=!1,x=!0):(o=f,v=!0,s.launchedLeft=!0),w=!0):C?(o=f,w=!0,s.launchedLeft=!0):(o=f+_-d,w=!0,s.launchedLeft=!1),w&&(t.style.left=o+"px");var F,E,P,k,D=a+h<=y+m;(s.flyoutTop=a,D&&3!==r)||(s.launchedUp=!0,this.fitFlyoutVertically(r,a,h,c,y,m,(0,p.m)((function(){return F}),(function(e){return F=e})),(0,p.m)((function(){return E}),(function(e){return E=e})),(0,p.m)((function(){return P}),(function(e){return P=e})),(0,p.m)((function(){return k}),(function(e){return k=e}))),a!==F&&(t.style.top=F+"px",s.flyoutTop=F),E>-1&&(t.style.maxHeight=E+"px"),P&&(t.style.bottom="0px",t.style.height="auto"),k&&this.makeFlyoutScrollable(t,C,b,x,v,S,_,l,u));return s.flyoutLeft=o,s.flyoutWidth=d,s.flyoutHeight=h,s},e.prototype.fitFlyoutVertically=function(e,t,n,r,i,o,a,s,l,c){a.val=t,s.val=-1,l.val=!1,c.val=!1;var u=t,g=i+o-t;t=r-n;var p=this._isAppDivSyndicated,d=!1;t<0&&(t=i);var h=r;(p||(h-=i),n<=h&&1!==e)||(4===e||1===e?n<o?(t=o-n,l.val=!0):(t=i,l.val=!0,c.val=!0,d=!0):(h<g&&3!==e?(t=u,l.val=!0):s.val=h,c.val=!0));p&&(l.val=!1,d?s.val=o:t+=i),a.val=t},e.prototype.makeFlyoutScrollable=function(e,t,n,r,i,o,a,s,l){if(e.style.overflowY="scroll",e.style.width="auto",t){if(o||r){var c=o?0:a-s;e.style.left="",e.style.right=c+"px"}}else if(!i&&!r){c=n?a-s:a-s-l;e.style.left="",e.style.right=c+"px"}},e.prototype.getDimensionsForMenu=function(e){var t={};if(Li.x(e))return t;t.viewportWidth=_i.s.getViewPortWidth(),t.viewportHeight=_i.s.getViewPortHeight(),Li.x(t.viewportWidth)&&(t.viewportWidth=document.documentElement.clientWidth,t.viewportHeight=document.documentElement.clientHeight),Li.x(t.viewportWidth)&&(t.viewportWidth=document.body.clientWidth,t.viewportHeight=document.body.clientHeight),t.viewableTop=window.pageYOffset,t.viewableLeft=window.pageXOffset,Li.x(t.viewableTop)&&(t.viewableTop=document.documentElement.scrollTop,t.viewableLeft=document.documentElement.scrollLeft),Li.x(t.viewableTop)&&(t.viewableTop=document.body.scrollTop,t.viewableLeft=document.body.scrollLeft),e.scrollHeight!==e.offsetHeight?t.flyoutRealHeight=e.scrollHeight+2*Zi.Menu.menuBorderPx:t.flyoutRealHeight=e.scrollHeight;var n=e.style.overflowY;return e.style.overflowY="visible",t.flyoutWidth=this.measureWidth(e),e.style.overflowY=n,t},e.prototype.measureWidth=function(e){return e.offsetWidth},e.dictToInt=function(e,t){return Li.x(e)?0:e[t]},e}();(0,o.l)(to,"MenuPositioner",null,[]);var no=n(7370),ro=n(3526),io=n(3694),oo=n(6696),ao=n(9318),so=n(7980),lo=n(6985),co=n(4304),uo=n(3209),go=function(e){function t(t){var n=e.call(this,t)||this;return n.menuPositioner=null,n._menuInvocationMethod=0,n._lastDynamicPopulationXml=null,n._elmBackFrame=null,n._hasAsyncCallbackBeenSentToHandler=!1,n.polledOnce=!1,n._pendingBackFrameTimeoutId=-1,n.menuPositioner=new to(!n.get_root().get_textDirection(),Bi.n.isTrue(n.get_root().get_properties().DivSyndicated)),n}return(0,S.t)(t,e),t.prototype.get_menuPositioner=function(){return this.menuPositioner},t.prototype.get_menuLauncher=function(){return this.get_control()},t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.get_menu=function(){return this.get_menuLauncher().get_menu()},t.prototype.set_menu=function(e){return this.get_menuLauncher().set_menu(e),e},t.prototype.get_menuLaunched=function(){return this.get_menuLauncher().menuLaunched},t.prototype.set_menuLaunched=function(e){return this.get_menuLauncher().menuLaunched=e,e},t.prototype.get_backFrame=function(){return Li.x(this._elmBackFrame)&&(this._elmBackFrame=t.createHiddenIframeElement()),this._elmBackFrame},t.prototype.get_shouldRestoreFocusToApp=function(){var e=!this.get_root().get_inModalMode();return o.r(Ki.u,this.get_root())&&1===this.get_root().get_menuStackDepth()&&(e=!0),e},t.prototype.doDefaultAction=function(e,t,n){o.r(Ki.u,this.get_root())&&this.get_root().ensureContextMenuDismissed(),this.get_menuLauncher().launchMenu(t)},t.prototype.launchMenu=function(e){if(this.get_menuLauncher().get_enabled()&&!this.get_menuLaunched()){var t=ji.y.get_instance().startActivity(te.wQ);t.get_properties().add("Id",this.get_menuLauncher().get_controlProperties().Id),t.get_properties().add("InputMethod",Qi.s[e]),t.end(),Xi.t.mark(10326),Bt.g.measureTimeToNextFrame(this.get_menuLauncher().get_controlProperties().Id,"MenuOpen"),this.get_menuLauncher().get_focusableElement()&&this.get_menuLauncher().set_elmHadFocus(Bt.g.getActiveElement(this.get_menuLauncher().get_focusableElement().ownerDocument)),this._menuInvocationMethod=e,this.populateAndPositionMenu(e),this.sendNotifyAsyncMenuTrigger(),this.get_menuLauncher().updateAriaMenuLauncherAttributes(this.get_menuLauncher().get_focusableElement(),!0)}},t.prototype.sendNotifyAsyncMenuTrigger=function(){Li.x(this.get_properties().PopulateAsyncTriggerCommand)||this._hasAsyncCallbackBeenSentToHandler||(this.notifyAsyncMenuTrigger(),this._hasAsyncCallbackBeenSentToHandler=!0)},t.prototype.notifyAsyncMenuTrigger=function(){var e={};e[Ji.o.Callback]=o.i(this,this.refreshMenuCallback,"refreshMenuCallback"),this.get_root().executeCommand(this.get_properties().PopulateAsyncTriggerCommand,e,this.get_displayedComponent(),0,!1)},t.prototype.refreshMenuCallback=function(){this.get_menuLauncher().refreshMenu()},t.prototype.refreshMenu=function(){this.get_menuLaunched()&&this.populateAndPositionMenu(this._menuInvocationMethod,!0)},t.prototype.populateAndPositionMenu=function(e,t){void 0===t&&(t=!1);var n=!0;if(Bi.n.isTrue(this.get_properties().PopulateDynamically)){var r=!1,i=this.pollForDynamicMenu(e);i!==this._lastDynamicPopulationXml&&(r=this.populateMenuFromXml(i,t)),n=r||!this.get_menuLaunched()}if(n){var o=L.AFrameworkApplication.get_activeFrame().get_theStopwatchBuilder(),a=null;o&&(a=o.makeAndStartStopwatch("LoadResource","Menu Initialization")),this.initializeMenu(e),a&&a.stop(),this.onMenuChanged()}},t.prototype.initializeMenu=function(e){if(Li.x(this.get_menu()))Xi.t.mark(10327);else{if(this.get_menuLauncher().parentKeytipsIds){var t=this.get_menuLauncher().get_displayedComponent();if(t&&t.get_keytip()){var n=t.get_keytip().get_key().toLocaleLowerCase();this.get_menu().setParentKeytipsIdsForMenuItems(String.format("{0} {1}",this.get_menuLauncher().parentKeytipsIds,t.get_keytip().get_elementId()),this.get_menuLauncher().parentKeytipsKeys&&""!==this.get_menuLauncher().parentKeytipsKeys?String.format("{0}-{1}",this.get_menuLauncher().parentKeytipsKeys,n):n)}}this.get_menu().ensureRefreshed(),Bi.n.ensureCSSClassOnElement(this.get_menu().get_elementInternal(),this.get_menuLauncher().get_additionalMenuCssClass());var r=3===e||this.get_root().get_touchModeForcedOn();if(Bi.n.toggleCSSClassOnElement(this.get_menu().get_elementInternal(),"cui-touch",r),this.get_menu().hasItems()){this.get_menu().attachEvents();var i=this.get_displayedComponent();i.ensureChildren(),i.set_ignoreDirtyingEvents(!0),i.addChild(this.get_menu()),i.set_ignoreDirtyingEvents(!1),this.get_menu().pollIfRootPolledSinceLastPoll();var a=o.r(uo.b,this.get_root()),s=null,l=!1;a&&(l=(s=this.get_root()).shouldHandleElementResize,s.shouldHandleElementResize=!1);var c=this.get_menu().get_elementInternal();c.style.visibility="hidden",c.style.position="absolute",c.style.top="0px",c.style.left="0px",G.y.get_isInternetExplorerNonEdge()&&!G.y.get_isInternetExplorer9Up()&&(c.style.maxHeight="100px",c.style.overflowY="scroll"),document.body.appendChild(c),this.adjustMenuLayout(),this.positionMenu(c),Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.addAndPositionBackFrame(),Bi.n.ensureCSSClassOnElement(this.get_menuLauncher().get_launcher(),Ri.MenuLauncher.menuDroppedClassName);var u=this.get_root().get_menuStackDepth();this.get_shouldGoModal()&&this.get_root().beginModal(this.get_control(),!0),c.style.zIndex=String(L.AFrameworkApplication.get_activeFrame().get_activeModalUIZIndex()),this.get_root().addMenuLauncherToStack(this.get_menuLauncher()),this.get_menu().set_stackIndex(u),c.style.visibility="visible";var g=this.getChildElementsToAnimate();if(o.r(so.m,this.get_menu())){c.style.position="fixed";var p=this.get_root().get_menuLauncherStack()[0];p&&p.get_menu()&&p.get_menu().get_elementInternal()?100!==Bt.g.getOpacity(this.get_root().get_menuLauncherStack()[0].get_menu().get_elementInternal())&&$i.o(c,g,o.i(this,this.afterShowMenu,"afterShowMenu")):$i.o(c,g,o.i(this,this.afterShowMenu,"afterShowMenu"))}else $i.o(c,g,o.i(this,this.afterShowMenu,"afterShowMenu"));this.set_menuLaunched(!0),this.get_menu().set_launched(!0),!G.y.get_isIPad()&&this.get_menuLauncher().get_sendFocusToMenuDrop()&&this.get_menu().setFocus(e),a&&(s.shouldHandleElementResize=l);var d=this.get_properties().CommandMenuOpen;Li.t(d)||this.get_root().executeCommand(d,null,i,e,!1),Xi.t.mark(10327)}else Xi.t.mark(10327)}},t.prototype.onMenuChanged=function(){},t.prototype.addAndPositionBackFrame=function(){var e=this;Bi.n.cancelPendingTimeout((0,p.m)((function(){return e._pendingBackFrameTimeoutId}),(function(t){return e._pendingBackFrameTimeoutId=t}))),this._pendingBackFrameTimeoutId=window.setTimeout(o.i(this,this.addAndPositionBackFrameInternal,"addAndPositionBackFrameInternal"),50)},t.prototype.addAndPositionBackFrameInternal=function(){this.get_menu()&&this.get_menu().get_elementInternal()&&(document.body.appendChild(this.get_backFrame()),this.positionBackFrame())},t.prototype.positionBackFrame=function(){var e=this.get_backFrame(),t=this.get_menu().get_elementInternal();e.style.position="absolute",e.style.visibility="hidden",e.style.left=t.style.left,e.style.right=t.style.right,e.style.top=t.style.top,e.style.bottom=t.style.bottom;var n=t.offsetWidth,r=t.offsetHeight;G.y.get_isInternetExplorer9Up()&&(n-=4,r-=4),e.style.width=n.toString()+"px",e.style.height=r.toString()+"px",e.style.visibility="visible"},t.prototype.get_shouldGoModal=function(){return!this.get_root().get_menuStackDepth()},t.prototype.afterShowMenu=function(e){e.get_element()&&(e.get_element().style.filter="",e.get_element().style.opacity="",this.get_menu()&&this.get_menu().get_elementInternal()===e.get_element()&&o.r(ao.y,this.get_menu())&&$i.l(this.get_menu().get_elementInternal(),this.getChildElementsToAnimate()))},t.prototype.getChildElementsToAnimate=function(){var e=this.get_menu().get_children(),t=[];if(o.r(ao.y,this.get_menu()))for(var n=0;n<e.get_count();n++){var r=e.get_item(n);Array.add(t,r.get_separator());for(var i=0;i<r.get_children().get_count();i++){var a=r.get_children().get_item(i);Array.add(t,a.get_elementInternal())}}return t},t.prototype.adjustMenuLayout=function(){for(var e=this.get_menu().get_children(),t=0;t<e.get_count();t++)for(var n=e.get_item(t).get_children(),r=0;r<n.get_count();r++){var i=n.get_item(r);if(o.r(Mi.m,i)){var a=i;if("Menu32"===a.get_displayMode()||"Menu48"===a.get_displayMode()){var s=i.get_control();s.behavior&&(o.r(ro.d,s)||o.r(oo.g,s))&&s.behavior.adjustLayoutForLargeMenu()}}}if(e.get_count()>0){var l=e.get_item(0);Li.x(l.get_separator())||(l.get_separator().style.display="none"),Li.x(l.get_titleElement())||Bi.n.ensureCSSClassOnElement(l.get_titleElement(),"cui-menusection-titleAtTop")}},t.prototype.positionMenu=function(e){if(!Li.x(e)){e.style.top="0px",e.style.left="0px",e.style.bottom="",e.style.right="",e.style.width="",e.style.minWidth="";var t=Yi.k.create();try{var n=this.get_menuPositioner().getDimensionsForMenu(e),r=this.getLauncherBounds(),i=this.get_root().setFlyoutCoordinates(e,n,this.get_menuLauncher().get_menuDirection(),r);i||(i=this.get_menuPositioner().setFlyoutCoordinates(e,n,this.get_menuLauncher().get_menuDirection(),r)),this.get_root().menuPositioningInfo=i}finally{t&&t.dispose()}}},t.prototype.getLauncherBounds=function(){var e=Bt.g.getElementBounds(this.get_menuLauncher().get_launcher()),t=this.get_parentMenu();if(!Li.x(t)&&!Li.x(t.get_elementInternal())){var n=Bt.g.getElementBounds(t.get_elementInternal());e.x=n.x+Zi.Menu.menuBorderPx,e.width=n.width-2*Zi.Menu.menuBorderPx}return o.r(co.l,this.get_menuLauncher().get_launcherComponent())&&(e.height=0),e},t.prototype.closeMenu=function(){if(this.get_menuLauncher().menuLaunched){C.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{Id:this.get_menuLauncher().get_controlProperties().Id}),this.get_menu().onMenuClosed(),this.removeMenuFromHierarchy(),this.set_menuLaunched(!1),this.get_menu().set_launched(!1),this.get_root().endModal(this.get_control(),!0),this.get_shouldRestoreFocusToApp()?L.AFrameworkApplication.get_activeFrame().restoreFocusAfterDismissingPopup(this.get_menuLauncher().get_elmHadFocus(),this._menuInvocationMethod):this.restoreFocusToElmHadFocus(),this.get_menuLauncher().set_elmHadFocus(null);var e=this.get_menuLauncher().get_launcher();Bi.n.removeCSSClassFromElement(e,Ri.MenuLauncher.menuDroppedClassName),this.get_menuLauncher().updateAriaMenuLauncherAttributes(this.get_menuLauncher().get_focusableElement(),!1),Bi.n.removeCSSClassFromElement(e,"cui-ctl-menu-hovered-without-focus"),this.get_menu().resetFocusedIndex();var t=this.get_properties().CommandMenuClose;Li.t(t)||this.get_root().executeCommand(this.get_properties().CommandMenuClose,null,this.get_displayedComponent(),0,!1),this.removeMenuFromDom()}},t.prototype.restoreFocusToElmHadFocus=function(){var e=this.get_menuLauncher().get_elmHadFocus();if(e)try{e.focus()}catch(e){}else;},t.prototype.removeMenuFromDom=function(){_i.s.removeElement(this.get_menu().get_elementInternal()),_i.s.removeElement(this._elmBackFrame),Bi.n.unregisterAllHandlers(this.get_menu().get_elementInternal())},t.prototype.pollForDynamicMenu=function(e){if(this.polledOnce&&Bi.n.isTrue(this.get_properties().PopulateOnlyOnce))return null;if(Li.x(this.get_properties().PopulateQueryCommand))return null;null==e&&(e=0);var t=this.get_menuLauncher().getCommandPopulateProperties();return(1&this.get_root().pollForCommandState(this.get_properties().PopulateQueryCommand,this.get_properties().PopulateQueryCommand,t,e))>0?t.PopulationXML:null},t.prototype.populateMenuFromXml=function(e,t){if(void 0===t&&(t=!1),this.polledOnce&&Bi.n.isTrue(this.get_properties().PopulateOnlyOnce))return!0;var n=null;if(this._lastDynamicPopulationXml=e,Li.x(e)||(n=this.createMenuFromXml(e)),Li.x(n)||(this.polledOnce=!0),t){if(this.get_root().clearMenuStack(this.get_menuLauncher()),Li.x(n)||!n.hasItems())return this.closeMenu(),!1;this.removeMenuFromHierarchy(),this.removeMenuFromDom()}return this.setMenu(n),!0},t.prototype.onDynamicMenuPopulated=function(){},t.prototype.createMenuFromXml=function(e){var t=no.Builder.convertXMLStringToJSON(e);if(!Li.x(t)){var n=new lo.g;n.cloneControlsForMenu=!0,n.parentId=this.get_control().get_id();var r;return r=o.r(io.y,this.get_control()),this.get_root().get_builder().buildMenu(t,n,r)}return null},t.prototype.setMenu=function(e){Li.x(e)||(Li.x(this.get_menu())||this.get_menu().dispose(),this.set_menu(e),this.onDynamicMenuPopulated())},t.prototype.removeMenuFromHierarchy=function(){var e=this.get_menu().get_parent();e.set_ignoreDirtyingEvents(!0),e.removeChild(this.get_menu().get_id()),e.set_ignoreDirtyingEvents(!1)},t.prototype.onKeyDown=function(t){var n=!1;Li.x(t.innerEvent)||Li.x(t.innerEvent.rawEvent)||(o.r(Mi.m,this.get_displayedComponent())||t.innerEvent.rawEvent.altKey&&t.innerEvent.keyCode===Sys.UI.Key.down&&(this.doDefaultAction(t.get_sourceElement(),1,t.innerEvent),n=!0));return n||(n=e.prototype.onKeyDown.call(this,t)),n},t.prototype.onPointerDown=function(e){return this.commitRootPendingChanges(),2===e.get_inputSource()&&e.get_mouseButton()||this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),e.innerEvent.preventDefault(),!1},t.prototype.handleDefaultActionWithKeytips=function(e){return!!(this.get_parentMenu()&&this.get_parentMenu().get_inKeytipMode()&&this.get_menuLauncher().onMenuLaunchCallback)&&(this.get_menuLauncher().onMenuLaunchCallback(this.get_displayedComponent(),e),!0)},t.createHiddenIframeElement=function(){var e=Bi.n.createElement("iframe");return e.style.position="absolute",e.style.visibility="hidden",e.style.borderWidth="0px",e},t}(Oi);(0,o.l)(go,"MenuLauncherBehavior",Oi,[qi,Ei]);var po=n(8553),ho=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.get_properties$2=function(){return this.get_dropDown().get_properties()},t.prototype.get_dropDown=function(){return this.get_control()},t.prototype.get_dropDownDom=function(){return this.get_dropDown().get_dropDownDom()},t.prototype.attachEvents=function(e){xi.z.get_instance().registerHandler(Le.d.pointerDown,this.get_dropDownDom().elmControl,o.i(this,this.onPointerDown,"onPointerDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyDown,this.get_dropDownDom().elmControl,o.i(this,this.onKeyDown,"onKeyDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyUp,this.get_dropDownDom().elmControl,o.i(this,this.onKeyUp,"onKeyUp"))},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[po.v.SelectedItemId];if((2&this.pollForStateAndUpdateInternal(this.get_properties$2().Command,this.get_properties$2().QueryCommand,this.get_stateProperties()))>0){var t=this.get_stateProperties()[po.v.SelectedItemId];Li.x(t)||e===t||this.get_dropDown().selectDropdownItemById(t)||(this.get_stateProperties()[po.v.SelectedItemId]=null)}},t}(go);(0,o.l)(ho,"DropDownBehavior",go,[]);var _o=n(7444),mo=n(4703),fo=function(e){function t(t){var n=e.call(this,t)||this;return n._elmHadFocus=null,n._mouseupOnTextboxSinceFocus=!1,n._inputFocused=!1,n._needMenuContentsForAutocomplete=!1,n._pendingDropdownItemId=null,n._pendingAutoCompleteTimeoutId=-1,n}return(0,S.t)(t,e),t.prototype.get_comboBox=function(){return this.get_control()},t.prototype.get_comboBoxDom=function(){return this.get_comboBox().get_comboBoxDom()},t.prototype.get_cbProperties=function(){return this.get_comboBox().get_cbProperties()},t.prototype.get_isFreeForm=function(){return this.get_stateProperties()[_o.g.IsFreeForm]},t.prototype.set_isFreeForm=function(e){return this.get_stateProperties()[_o.g.IsFreeForm]=e,e},t.prototype.attachEvents=function(e){var t=e;xi.z.get_instance().registerHandler(Le.d.pointerDown,t.elmControl,o.i(this,this.onPointerDown,"onPointerDown"));var n=t.elmInput;ze.z.get_instance().registerHandler(Le.d.focus,n,o.i(this,this.onInputFocus,"onInputFocus")),ze.z.get_instance().registerHandler(Le.d.blur,n,o.i(this,this.onInputBlur,"onInputBlur")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyDown,n,o.i(this,this.onInputKeyDown,"onInputKeyDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyPress,n,o.i(this,this.onInputKeyPress,"onInputKeyPress")),Be.p.get_instance().registerHandler(Le.d.mouseUp,n,o.i(this,this.onInputMouseUp,"onInputMouseUp")),xi.z.get_instance().registerHandler(Le.d.pointerDown,n,o.i(this,this.onInputPointerDown,"onInputPointerDown")),xi.z.get_instance().registerHandler(Le.d.pointerDown,t.elmBtnA,o.i(this,this.onMenuButtonPointerDown,"onMenuButtonPointerDown"))},t.prototype.pollForStateAndUpdate=function(){(2&this.pollForStateAndUpdateInternal(this.get_cbProperties().Command,this.get_cbProperties().QueryCommand,this.get_stateProperties()))>0&&(this._inputFocused||this.updateValueAndSelectedControl(),this.updateFontStyle())},t.prototype.onDynamicMenuPopulated=function(){this.get_comboBox().set_menuItems(null);var e=null,t=null,n=null;if(!Li.x(this.get_menu())){this.setAriaOwnsAttributeWithMenuId();for(var r=this.get_menu().get_children().getEnumerator();r.moveNext();)for(var i=r.get_current().get_children().getEnumerator();i.moveNext();){var a=i.get_current();o.r(Mi.m,a)&&(e=a.get_control(),o.r(Wi.a,e)&&(t=e.getMenuItemId()),o.r(zi.x,e)&&(n=e.getTextValue()),Li.x(t)||Li.x(n)||(this.get_comboBox().get_menuItems()[n]=t,n=null,t=null))}}},t.prototype.onInputPointerDown=function(e){return o.r(Ki.u,this.get_root())&&2===e.get_inputSource()&&(this._elmHadFocus=Bt.g.getActiveElement(this.get_control().get_focusableElement().ownerDocument),this.get_control().get_focusableElement().focus()),!1},t.prototype.onPointerDown=function(t){this.commitRootPendingChanges();var n=!1;return 3===t.get_inputSource()&&(n=e.prototype.onPointerDown.call(this,t),this.setAriaOwnsAttributeWithMenuId()),n&&t.innerEvent.preventDefault(),!1},t.prototype.onMenuButtonPointerDown=function(e){var t=!1;return 2===e.get_inputSource()&&e.get_mouseButton()||(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),this.setAriaOwnsAttributeWithMenuId(),t=!0),t&&e.innerEvent.preventDefault(),!1},t.prototype.onInputKeyDown=function(e){var t=!1;if(!Li.x(e.innerEvent)&&!Li.x(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,r=e.innerEvent.keyCode,i=n.shiftKey;n.altKey,Bi.n.isTrue(this.get_cbProperties().AutoComplete);if(r===Sys.UI.Key.enter)this.commitPendingChange(),this.restoreFocusFromFloatie(),o.r(mo.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0;else if(r===Sys.UI.Key.tab){if(this.commitPendingChange(),this.restoreFocusFromFloatie(),o.r(mo.Ribbon,this.get_root())&&(t=this.get_root().wrapKeyboardFocus(this.get_displayedComponent().get_elementInternal(),!i)),o.r(Ki.u,this.get_root()))return!0}else r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?this.get_control().get_enabled()?(this.cancelPendingAutoComplete(),this._pendingDropdownItemId=null):t=!0:r===Sys.UI.Key.esc?(this.restoreToKnownValue(),this.restoreFocusFromFloatie(),o.r(mo.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0):r===Sys.UI.Key.down&&(this.launchMenu(1),this.setAriaOwnsAttributeWithMenuId(),t=!0)}return t},t.prototype.onInputKeyPress=function(e){return!this.get_control().get_enabled()||(!Li.x(e.innerEvent)&&e.innerEvent.charCode&&this.delayAutoComplete(),!1)},t.prototype.onInputMouseUp=function(e){return!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0)},t.prototype.executeAutoComplete=function(){this._pendingAutoCompleteTimeoutId=-1;var e=this.get_comboBoxDom().elmInput,t=e.value,n=this.getFirstMenuItemThatBeginsWith(t);if(n){if(e.value=n.key,e.setSelectionRange)e.setSelectionRange(t.length,e.value.length);else if(e.createTextRange){var r=e.createTextRange();r.moveStart("character",t.length),r.moveEnd("character",e.value.length),r.select()}this._pendingDropdownItemId=n.value}else this._pendingDropdownItemId=null},t.prototype.getFirstMenuItemThatBeginsWith=function(e){var t=this.get_comboBox().get_menuItems();for(var n in t){var r={key:n,value:t[n]};if(r.key.toLowerCase().startsWith(e.toLowerCase()))return r}return null},t.prototype.delayAutoComplete=function(){Bi.n.isTrue(this.get_cbProperties().AutoComplete)&&-1===this._pendingAutoCompleteTimeoutId&&(this._needMenuContentsForAutocomplete&&(this.pollForDynamicMenu(0),this._needMenuContentsForAutocomplete=!1),this._pendingAutoCompleteTimeoutId=window.setTimeout(o.i(this,this.executeAutoComplete,"executeAutoComplete"),this.get_comboBox().get_autoCompleteDelay()))},t.prototype.cancelPendingAutoComplete=function(){var e=this;Bi.n.isTrue(this.get_cbProperties().AutoComplete)&&Bi.n.cancelPendingTimeout((0,p.m)((function(){return e._pendingAutoCompleteTimeoutId}),(function(t){return e._pendingAutoCompleteTimeoutId=t})))},t.prototype.onInputFocus=function(t){return this.get_menuLaunched()?(this.get_menu().setFocus(0),!0):(o.r(Ki.u,this.get_root())&&(Nt.FocusManager.instance().scopeChanged("ribbon"),this.get_root().set_hasShynessBehavior(!1)),e.prototype.onFocus.call(this,t),this._inputFocused=!0,Bi.n.ensureCSSClassOnElement(this.get_comboBoxDom().elmControl,"cui-cb-focus"),Bi.n.isTrue(this.get_cbProperties().PopulateDynamically)&&(this._needMenuContentsForAutocomplete=!0),Bt.g.selectAllTextInInput(this.get_comboBoxDom().elmInput),Li.x(this.get_menu())||this.get_menu().refreshInternal(),this._mouseupOnTextboxSinceFocus=!1,!1)},t.prototype.onInputBlur=function(e){return this._inputFocused=!1,this.commitPendingChange(),Bi.n.removeCSSClassFromElement(this.get_comboBoxDom().elmControl,"cui-cb-focus"),!1},t.prototype.restoreFocusFromFloatie=function(){o.r(Ki.u,this.get_root())&&(void 0!==this._elmHadFocus&&null!==this._elmHadFocus&&L.AFrameworkApplication.get_activeFrame().restoreFocusAfterDismissingPopup(this._elmHadFocus,2),this._elmHadFocus=null)},t.prototype.commitPendingChange=function(){if(this.get_control().get_enabled()){this.cancelPendingAutoComplete();var e=this.get_comboBoxDom().elmInput;if(void 0!==this.get_stateProperties()[_o.g.Value]&&null!==this.get_stateProperties()[_o.g.Value]&&e.value===this.get_stateProperties()[_o.g.Value].toString())return;if(this.get_comboBox().selectDropdownItemById(this._pendingDropdownItemId)){this.set_isFreeForm(!1),this.get_stateProperties()[_o.g.Value]=e.value;n={IsFreeForm:!1,CommandValueId:this.get_comboBox().get_selectedControl().getCommandValueId(),MenuItemId:this.get_comboBox().get_selectedControl().getMenuItemId()};this.get_root().executeCommand(this.get_cbProperties().Command,n,this.get_displayedComponent(),0,!1)}else{if(!Bi.n.isTrue(this.get_cbProperties().AutoComplete)){var t=this.get_comboBox().get_menuItems()[e.value];if(!Li.t(t)&&this.get_comboBox().selectDropdownItemById(t)){this.set_isFreeForm(!1),this.get_stateProperties()[_o.g.Value]=e.value;var n={IsFreeForm:!1,CommandValueId:this.get_comboBox().get_selectedControl().getCommandValueId(),MenuItemId:t};return void this.get_root().executeCommand(this.get_cbProperties().Command,n,this.get_displayedComponent(),0,!1)}}var r=!Li.t(e.value)&&""!==Jn.l.removeAllWhitespace(e.value);if(!this.get_comboBox().get_allowFreeForm()||!r)return void this.restoreToKnownValue();this.set_isFreeForm(!0),this.get_stateProperties()[_o.g.Value]=e.value;var n={IsFreeForm:!0,Value:e.value};this.get_root().executeCommand(this.get_cbProperties().Command,n,this.get_displayedComponent(),0,!1)}}else this.restoreToKnownValue()},t.prototype.restoreToKnownValue=function(){this.cancelPendingAutoComplete(),this._pendingDropdownItemId=null,this.updateValueAndSelectedControl()},t.prototype.updateValueAndSelectedControl=function(){var e=this.get_stateProperties()[_o.g.Value]||"";e!==this.get_comboBoxDom().elmInput.value&&(this.get_comboBoxDom().elmInput.value=e),this.get_comboBox().selectDropdownItemById(this.get_comboBox().get_menuItems()[e])},t.prototype.updateFontStyle=function(){var e=this.get_stateProperties()[_o.g.FontStyle]||"normal";e!==this.get_comboBoxDom().elmInput.style.fontStyle&&(this.get_comboBoxDom().elmInput.style.fontStyle=e)},t.prototype.setAriaOwnsAttributeWithMenuId=function(){this.get_control().get_focusableElement()&&this.get_menu()&&this.get_control().get_focusableElement().setAttribute(Ot.t.ariaOwnsAttribute,this.get_menu().get_id())},t}(ho);(0,o.l)(fo,"ComboBoxBehavior",ho,[]);var yo=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.get_contextMenuLauncher=function(){return this.get_control()},t.prototype.getLauncherBounds=function(){var e=0;return this.get_menu()&&this.get_menu().get_elementInternal()&&2===this.get_menu().get_horizontalAlignment()&&(e=this.get_menu().get_elementInternal().clientWidth),new Sys.UI.Bounds(this.get_contextMenuLauncher().get_x()-e,this.get_contextMenuLauncher().get_y(),this.get_contextMenuLauncher().get_launcherWidth(),this.get_contextMenuLauncher().get_launcherHeight())},t}(go);(0,o.l)(yo,"ContextMenuLauncherBehavior",go,[]);var Co=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.get_dialogMenuLauncher=function(){return this.get_control()},t.prototype.getLauncherBounds=function(){return new Sys.UI.Bounds(this.get_dialogMenuLauncher().get_x(),this.get_dialogMenuLauncher().get_y(),this.get_dialogMenuLauncher().get_launcherWidth(),this.get_dialogMenuLauncher().get_launcherHeight())},t}(go);(0,o.l)(Co,"DialogMenuLauncherBehavior",go,[]);var So=n(7908),vo=function(e){function t(t){var n=e.call(this,t)||this;return n._shouldRefreshWhenDropped=!1,n._needToRefreshAfterMenuClose=!1,n._shouldRefreshWhenDropped=!Bi.n.isFalse(n.get_properties$2().ShouldRefreshWhenDropped),n}return(0,S.t)(t,e),t.prototype.get_flyoutAnchor=function(){return this.get_control()},t.prototype.get_properties$2=function(){return this.get_control().get_controlProperties()},t.prototype.attachEvents=function(e){var t=e.elmControl;Li.x(t)||(ze.z.get_instance().registerHandler(Le.d.focus,t,o.i(this,this.onFocus,"onFocus")),ze.z.get_instance().registerHandler(Le.d.blur,t,o.i(this,this.onBlur,"onBlur")),xi.z.get_instance().registerHandler(Le.d.pointerOver,t,o.i(this,this.onPointerOver,"onPointerOver")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp")),xi.z.get_instance().registerHandler(Le.d.pointerDown,t,o.i(this,this.onPointerDown,"onPointerDown")))},t.prototype.pollForStateAndUpdate=function(){if(!Li.x(this.get_control().get_controlProperties().Command))if(!this.get_flyoutAnchor().menuLaunched||this._shouldRefreshWhenDropped){if((2&this.pollForStateAndUpdateInternal(this.get_properties$2().Command,this.get_properties$2().QueryCommand,this.get_stateProperties()))>0)this.updateVisibility()&&this.updateHtml();Bi.n.isTrue(this.get_properties$2().RefreshableMenu)&&this.get_menuLaunched()&&this.get_menu().pollMenuState()}else this._needToRefreshAfterMenuClose=!0},t.prototype.updateHtml=function(){this.updateFlyoutLabelText(),this.updateImage(),this.updateImageBackgroundColor(),this.get_flyoutAnchor().set_imageIsVisible(this.get_stateProperties()[So.g.ImageIsVisible])},t.prototype.updateFlyoutLabelText=function(){var e=Bi.n.validateStringProperty(this.get_stateProperties()[So.g.LabelText],this.get_properties$2().LabelText),t=this.get_stateProperties()[So.g.LabelTextUserGeneratedPlaceholderReplacements];this.get_control().labelText===e&&this.get_properties$2().LabelTextUserGeneratedPlaceholderReplacements===t||(this.get_controlComponentDomCache().get_medium()&&this.updateFlyoutLabelTextDom(this.get_controlComponentDomCache().get_medium().elmLabel,e,t),this.get_controlComponentDomCache().get_large(),this.get_root().needScaling=!0,this.get_control().labelText=e,this.get_properties$2().LabelTextUserGeneratedPlaceholderReplacements=t)},t.prototype.updateFlyoutLabelTextDom=function(e,t,n){var r=e.lastChild;Bi.n.setControlText(e,t+" ",n);var i=Li.x(r);C.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",i?"":r.nodeType.toString()),i||e.appendChild(r)},t.prototype.updateImageBackgroundColor=function(){var e=this.get_stateProperties()[So.g.ImageBackColor];this.get_controlComponentDomCache().forEach((function(n){t.applyColorToImage(n.elmImage,e)}))},t.prototype.launchMenu=function(t){"faPrint"===this.get_control().get_id()&&"jewelWordEditor"===this.get_control().get_root().get_id()&&(L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),L.AFrameworkApplication.get_theActionManager().processAction(te.Zq,2)),"faRemix"!==this.get_control().get_id()&&"faTransform"!==this.get_control().get_id()&&"faPublish"!==this.get_control().get_id()||"jewelWordEditor"!==this.get_control().get_root().get_id()||L.AFrameworkApplication.get_theActionManager().processAction(te.Zq,2),o.r(Mi.m,this.get_displayedComponent())&&(this.get_menuLaunched()||this.closeChildMenus(!0),this.get_control().get_enabled()&&this.setFocusOnControl()),e.prototype.launchMenu.call(this,t)},t.prototype.closeMenu=function(){e.prototype.closeMenu.call(this),this._needToRefreshAfterMenuClose&&(this._needToRefreshAfterMenuClose=!1,this.pollForStateAndUpdate())},t.prototype.onPointerOver=function(t){return this.get_control().isStandardMenuItem()?(this.get_flyoutAnchor().menuLaunched?(this.get_root().cancelPendingCloseMenuStack(),Bi.n.ensureCSSClassOnElement(this.get_flyoutAnchor().get_launcher(),Ri.MenuLauncher.menuDroppedClassName),this.get_flyoutAnchor().set_elmHadFocus(this.get_control().get_focusableElement())):(e.prototype.onPointerOver.call(this,t),this.doDefaultAction(t.get_sourceElement(),t.get_inputSource(),t.innerEvent)),!1):e.prototype.onPointerOver.call(this,t)},t.prototype.onKeyDown=function(t){var n=!1;if(!Li.x(t.innerEvent)&&!Li.x(t.innerEvent.rawEvent)){if(o.r(Mi.m,this.get_displayedComponent())){var r=t.innerEvent.rawEvent,i=t.innerEvent.keyCode,a=!this.get_root().get_textDirection();r.shiftKey||r.ctrlKey||!(i===Sys.UI.Key.right&&a||i===Sys.UI.Key.left&&!a)||(n=this.handleDefaultActionWithKeytips(t))||(this.doDefaultAction(t.get_sourceElement(),1,t.innerEvent),n=!0)}n||(n=e.prototype.onKeyDown.call(this,t))}return n},t.applyColorToImage=function(e,t){Li.x(e)||Li.x(t)||e.style.backgroundColor===t||(e.style.backgroundColor=t)},t}(go);(0,o.l)(vo,"FlyoutAnchorBehavior",go,[]);var bo=n(4889),To=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.get_galleryButton=function(){return this.get_control()},t.prototype.get_properties=function(){return this.get_galleryButton().get_properties()},t.prototype.get_componentDom=function(){return this.get_galleryButton().componentDom},t.prototype.attachEvents=function(e){var t=e.elmA;ze.z.get_instance().registerHandler(Le.d.focus,t,o.i(this,this.onFocus,"onFocus")),ze.z.get_instance().registerHandler(Le.d.blur,t,o.i(this,this.onBlur,"onBlur")),xi.z.get_instance().registerHandler(Le.d.pointerOver,t,o.i(this,this.onPointerOver,"onPointerOver")),xi.z.get_instance().registerHandler(Le.d.pointerOut,t,o.i(this,this.onPointerOut,"onPointerOut")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp")),xi.z.get_instance().registerHandler(Le.d.pointerDown,t,o.i(this,this.onPointerDown,"onPointerDown")),xi.z.get_instance().registerHandler(Le.d.pointerUp,t,o.i(this,this.onPointerUp,"onPointerUp")),_n.v.get_instance().registerHandler(Le.d.touchMove,t,o.i(this,this.onTouchMove,"onTouchMove")),_n.v.get_instance().registerHandler(Le.d.touchEnd,t,o.i(this,this.onTouchEnd,"onTouchEnd"))},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[bo.u.On],t=this.get_stateProperties()[bo.u.IsRtl];if(this.updateStateProperties(),(2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties()))>0){var n=!Li.x(this.get_stateProperties()[bo.u.InnerHTML])||!Li.x(this.get_properties().InnerHTML),r=!Li.x(this.get_properties().Image);n||r||this.get_control().set_enabled(!1);var i=this.get_componentDom().elmA;if(!Li.x(i)){if(n){var o=Bi.n.validateStringProperty(this.get_stateProperties()[bo.u.InnerHTML],this.get_properties().InnerHTML);null!==i.innerHTML&&null!==o&&Jn.l.toLower(i.innerHTML)===Jn.l.toLower(o)||(i.innerHTML=o),""===o&&this.get_control().set_enabled(!1)}var a=i.title,s=Bi.n.validateStringProperty(this.get_stateProperties()[bo.u.Alt],this.get_properties().Alt);s===a||this.get_control().get_shouldIgnoreTitle()||(i.title=s)}var l=this.get_stateProperties()[bo.u.On],c=this.get_stateProperties()[bo.u.IsRtl];e===l&&t===c||this.get_control().onStateChanged()}},t.prototype.updateStateProperties=function(){var e=this.get_stateProperties();e[bo.u.CommandValueId]=this.get_control().getCommandValueId(),e.MenuItemId=this.get_control().getMenuItemId(),e.SourceControlId=this.get_properties().Id},t.prototype.doDefaultAction=function(e,t,n){var r=this.get_displayedComponent();if(r&&this.get_control().get_enabled()){var i=this.get_root();if(L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelBorderMenuCompactionEnabled")&&r.isMenuItem()&&this.get_parentMenu()){var o=this.get_parentMenu().get_stackIndex(),a=i.get_menuLauncherStack()[o];a?a.selectDropdownItem(this.get_galleryButton()):C.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.updateStateProperties(),this.get_stateProperties()[bo.u.On]||(this.get_stateProperties()[bo.u.On]=!0,this.get_control().onStateChanged()),"Menu"===r.get_displayMode()&&Bi.n.removeCSSClassFromElement(this.get_componentDom().elmControl,"cui-gallerybutton-focused"),i.executeCommand(this.get_properties().Command,this.get_stateProperties(),r,t,!0,null,this.getTelemetryData(n))}},t.prototype.onFocus=function(t){return e.prototype.onFocus.call(this,t),Bi.n.ensureCSSClassOnElement(this.get_componentDom().elmControl,"cui-gallerybutton-focused"),!1},t.prototype.onBlur=function(t){return e.prototype.onBlur.call(this,t),Bi.n.removeCSSClassFromElement(this.get_componentDom().elmControl,"cui-gallerybutton-focused"),!1},t}(Oi);(0,o.l)(To,"GalleryButtonBehavior",Oi,[]);var Ao=n(552),Io=function(){function e(){}return e.Rows="Rows",e.Columns="Columns",e}();(0,o.l)(Io,"InsertTableCommandProperties",null,[]);var wo=n(3678),xo=function(e){function t(t){var n=e.call(this,t)||this;return n._oldIdx=-1,n}return(0,S.t)(t,e),t.prototype.get_insertTableControl=function(){return this.get_control()},t.prototype.get_properties=function(){return this.get_insertTableControl().get_controlProperties()},t.prototype.get_commandProperties=function(){return this.get_insertTableControl().get_commandProperties()},t.prototype.get_hostMenuSection=function(){var e=null;if(this.get_displayedComponent()){var t=this.get_displayedComponent().get_parent();if(!o.r(wo.z,t))throw Error.create("InsertTable must live inside of a MenuSection.");e=t}return e},t.prototype.get_innerDivs=function(){return this.get_insertTableControl().get_insertTableDom().innerDivs},t.prototype.get_outerDivs=function(){return this.get_insertTableControl().get_insertTableDom().outerDivs},t.prototype.doDefaultAction=function(e,t,n){if(this.get_control().get_enabled()){var r=this.getIndexFromElement(this.getCellOuterDiv(e)),i=this.getColFromIndex(r),o=this.getRowFromIndex(r);this.get_commandProperties()[Io.Rows]=o+1,this.get_commandProperties()[Io.Columns]=i+1,this.get_root().executeCommand(this.get_properties().Command,this.get_commandProperties(),this.get_displayedComponent(),t,!0,null,this.getTelemetryData(n))}},t.prototype.attachEvents=function(e){var t=e,n=t.elmControl,r=t.cellATags,i=t.cells;xi.z.get_instance().registerHandler(Le.d.pointerOut,n,o.i(this,this.onControlPointerOut,"onControlPointerOut")),_n.v.get_instance().registerHandler(Le.d.touchMove,n,o.i(this,this.onControlTouchMove,"onControlTouchMove")),_n.v.get_instance().registerHandler(Le.d.touchEnd,n,o.i(this,this.onControlTouchEnd,"onControlTouchEnd"));for(var a=0;a<i.length;++a)this.attachCellEvents(r[a],i[a])},t.prototype.attachCellEvents=function(e,t){ze.z.get_instance().registerHandler(Le.d.focus,e,o.i(this,this.onCellFocus,"onCellFocus")),xi.z.get_instance().registerHandler(Le.d.pointerOver,t,o.i(this,this.onCellPointerOver,"onCellPointerOver")),xi.z.get_instance().registerHandler(Le.d.pointerUp,t,o.i(this,this.onCellPointerUp,"onCellPointerUp")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp")),_n.v.get_instance().registerHandler(Le.d.touchStart,t,o.i(this,this.onCellTouchStart,"onCellTouchStart"))},t.prototype.getIndexFromElement=function(e){return parseInt(e.id.substr(this.get_insertTableControl().get_id().length+1))},t.prototype.handleHighlightingTitle=function(e){this.handleHighlightingAndTitleForIndex(this.getIndexFromElement(e))},t.prototype.getRowFromIndex=function(e){return Math.floor(e/Ao.o.numCols)},t.prototype.getColFromIndex=function(e){return e%Ao.o.numCols},t.prototype.handleHighlightingAndTitleForIndex=function(e){if(e!==this._oldIdx){var t=this.getColFromIndex(e),n=this.getRowFromIndex(e),r=-1,i=-1;for(-1!==this._oldIdx&&(r=this.getRowFromIndex(this._oldIdx),i=this.getColFromIndex(this._oldIdx));r!==n||i!==t;)r<n?this.setRowHighlighting(++r,i,!0):r>n?(this.setRowHighlighting(r,i,!1),r--):i<t?this.setColHighlighting(++i,r,!0):i>t&&(this.setColHighlighting(i,r,!1),i--);if(this.get_hostMenuSection())this.get_hostMenuSection().setTitleImmediate(this.getCellTitle(n+1,t+1));else{var o=this.get_control().get_components(),a=o&&o.length>0?o[0]:null,s=this.get_displayedComponent();C.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",{CtrlComps:!!o,FirstComp:!!a,FirstCompPar:!!a&&!!a.get_parent(),DispComp:!!s,DispCompPar:!!s&&!!s.get_parent()})}this._oldIdx=e}},t.prototype.setRowHighlighting=function(e,t,n){for(var r=0;r<=t;r++)this.setCellHighlighting(e,r,n)},t.prototype.setColHighlighting=function(e,t,n){for(var r=0;r<=t;r++)this.setCellHighlighting(r,e,n)},t.prototype.setCellHighlighting=function(e,t,n){var r=e*Ao.o.numCols+t,i=this.get_innerDivs()[r],o=this.get_outerDivs()[r];n?(i.className="cui-it-activeCell",o.className="cui-it-activeCellOuter"):(i.className="cui-it-inactiveCell",o.className="cui-it-inactiveCellOuter")},t.prototype.onCellPointerUp=function(e){return this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),!0},t.prototype.getCellOuterDiv=function(e){for(;e.hasChildNodes();)e=e.childNodes[0];return Li.x(e.tagName)||"a"!==e.tagName.toLowerCase()?null:e.parentNode.parentNode},t.prototype.setTitleOnAnchor=function(e){var t=e.childNodes[0].childNodes[0],n=this.getIndexFromElement(e);t.title=this.getCellTitle(this.getRowFromIndex(n)+1,this.getColFromIndex(n)+1)},t.prototype.getCellTitle=function(e,t){var n=this.get_properties().Alt;return Li.x(n)&&(n=this.get_properties().MenuSectionTitle),n=String.format(n,t.toString(),e.toString())},t.prototype.resetAll=function(){if(this.get_displayedComponent()){for(var e=0;e<Ao.o.numCells;e++)this.get_innerDivs()[e].className="cui-it-inactiveCell",this.get_outerDivs()[e].className="cui-it-inactiveCellOuter";this._oldIdx=-1;var t=this.get_properties().MenuSectionInitialTitle;Li.x(t)&&(t=""),this.get_hostMenuSection().setTitleImmediate(t)}},t.prototype.onCellPointerOver=function(e){if(this.get_control().get_enabled()){var t=this.getCellOuterDiv(e.get_sourceElement());this.setFocusOnCell(t),this.doCellHover(t)}return!1},t.prototype.doCellHover=function(e){this.setTitleOnAnchor(e),this.handleHighlightingTitle(e)},t.prototype.onCellFocus=function(e){if(!this.get_control().get_enabled())return!1;var t=this.getCellOuterDiv(e.get_sourceElement());return this.setTitleOnAnchor(t),this.handleHighlightingTitle(t),!1},t.prototype.onControlPointerOut=function(e){return Bt.g.isPointInElement(this.get_insertTableControl().get_insertTableDom().elmControl,e.get_clientPoint())||this.resetAll(),!1},t.prototype.onCellTouchStart=function(e){if(!this.get_control().get_enabled())return!1;var t=this.getCellOuterDiv(e.get_sourceElement());return this.doCellHover(t),!0},t.prototype.onControlTouchMove=function(e){if(!this.get_control().get_enabled())return!1;var t=e.get_clientPoint(),n=Bt.g.getElementAtPoint(t);if(!n||"table"===n.tagName.toLowerCase())return!1;var r=this.getCellOuterDiv(n);return r?this.doCellHover(r):this.resetAll(),!0},t.prototype.onControlTouchEnd=function(e){if(!this.get_control().get_enabled())return!1;var t=e.get_clientPoint(),n=Bt.g.getElementAtPoint(t);if(!n||"table"===n.tagName.toLowerCase())return this.resetAll(),!0;var r=this.getCellOuterDiv(n);return r?this.doDefaultAction(r,3,e.innerEvent):this.resetAll(),!0},t.prototype.focusNext=function(e){var t=Pi.Control.focusNextIndexInGrid(this._oldIdx,Ao.o.numCols,Ao.o.numCells,e);return t!==this._oldIdx?(this.get_innerDivs()[t].firstChild.focus(),this.handleHighlightingAndTitleForIndex(t),!0):(this.resetAll(),this._oldIdx=-1,!1)},t.prototype.setFocusOnControl=function(){var e=this.get_innerDivs()[0];return!Li.x(e)&&(e.firstChild.focus(),!0)},t.prototype.setFocusOnCell=function(e){return!Li.x(e)&&(e.firstChild.firstChild.focus(),!0)},t.prototype.onMenuClosed=function(){this.resetAll()},t}(Oi);(0,o.l)(xo,"InsertTableBehavior",Oi,[]);var Fo=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.pollForStateAndUpdate=function(){this.get_control().set_enabled(!!this.get_menu())},t.prototype.doDefaultAction=function(e,t,n){L.AFrameworkApplication.get_theActionManager().processActionWithData(te.hA,2,t,this.getTelemetryData(n))},t}(go);(0,o.l)(Fo,"JewelMenuLauncherBehavior",go,[]);var Eo=n(7055),Po=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.pollForStateAndUpdate=function(){(2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties()))>0&&(this.updateVisibility()&&this.updateHtml())},t.prototype.updateHtml=function(){this.updateTextForLabelControl(),this.updateImage(),this.updateTooltip()},t.prototype.updateTextForLabelControl=function(){var e=this.get_control().labelText,t=this.get_stateProperties()[Eo.i.Value];Li.x(t)&&(t=this.get_properties().LabelText,Li.x(t)&&(t="")),t!==e&&this.setLabelText(t)},t.prototype.attachEvents=function(e){var t=e.elmControl;Li.x(t)||(xi.z.get_instance().registerHandler(Le.d.pointerDown,t,o.i(this,this.onPointerDown,"onPointerDown")),xi.z.get_instance().registerHandler(Le.d.pointerOver,t,o.i(this,this.onPointerOver,"onPointerOver")),xi.z.get_instance().registerHandler(Le.d.pointerOut,t,o.i(this,this.onPointerOut,"onPointerOut")))},t}(Oi);(0,o.l)(Po,"LabelBehavior",Oi,[]);var ko=(0,o.y)("ISearchBoxBehavior"),Do=n(1450),Mo=n(3755),Ro=n(2266),Lo=function(e){function t(t){var n=e.call(this,t)||this;return n._closingMenu=!1,n._inActiveInteraction=!1,n._isRedesignFlightEnabled=!1,n._activeIconClass=null,n._inactiveIconClass=null,n._isRedesignFlightEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMeRedesignIsEnabled"),n._isRedesignFlightEnabled&&(n._activeIconClass=n.get_searchBox().get_sbProperties().LightImage16by16Class,n._inactiveIconClass=n.get_searchBox().get_sbProperties().DarkImage16by16Class),n}return(0,S.t)(t,e),t.prototype.get_searchBox=function(){return this.get_control()},t.prototype.notifyCommandExecuted=function(e,t,n,r){if(t&&(this.get_searchBox().set_elmHadFocus(n),L.AFrameworkApplication.get_activeFrame().setFocusOnDocument()),o.r(Mo.r,e)&&r){var i=new Do.f;i.CommandLocation=this.get_root().get_rootType(),i.InvocationMethod=0;var a={},s=e.get_control();if(s&&s.get_controlProperties()){if(a.CommandId=s.get_controlProperties().Command,a.ControlId=s.get_controlProperties().Id,a.CloseAllMenus=t,s.get_parentMenu()&&s.get_parentMenu().get_parent()&&s.get_parentMenu().get_parent().get_id()){var l=s.get_parentMenu().get_parent().get_id();a.ParentControlId=l.split("-")[0]}this.get_root().get_rootUser()&&this.get_root().get_rootUser().executeRootCommand(r,a,i)}}},t.prototype.closeMenu=function(){this.get_searchBox().get_elmHadFocus()||this.get_searchBox().set_elmHadFocus(this.get_searchBox().get_inputField()),this.get_searchBox().get_mouseIsOver()||this._isRedesignFlightEnabled&&(Bi.n.removeCSSClassFromElement(this.get_searchBox().get_inputField(),"cui-sb-focus"),Bi.n.removeCSSClassFromElement(this.get_searchBox().get_topLevelElement(),"cui-sb-focus"),Bi.n.removeCSSClassFromElement(this.get_searchBox().searchIcon,this._activeIconClass),Bi.n.ensureCSSClassOnElement(this.get_searchBox().searchIcon,this._inactiveIconClass)),this._closingMenu=!0,e.prototype.closeMenu.call(this),this._closingMenu=!1,this.raiseInteractionEnd()},t.prototype.get_shouldRestoreFocusToApp=function(){return!this.get_searchBox().get_processingKeystroke()},t.prototype.onMenuChanged=function(){this.get_searchBox().onMenuChanged()},t.prototype.raiseInteractionBegin=function(){this._inActiveInteraction||this._closingMenu||(this._inActiveInteraction=!0,this.get_searchBox().raiseEvent(Ro.t.interactionBegin,null))},t.prototype.raiseInteractionEnd=function(){this.get_menuLaunched()||this.get_searchBox().get_inputHasFocus()||(this._inActiveInteraction=!1,this.get_searchBox().raiseEvent(Ro.t.interactionEnd,null))},t.prototype.onInputBoxBlur=function(e){return Bi.n.removeCSSClassFromElement(this.get_searchBox().get_inputField(),"cui-sb-focus"),Bi.n.removeCSSClassFromElement(this.get_searchBox().get_topLevelElement(),"cui-sb-focus"),this._isRedesignFlightEnabled&&!this.get_searchBox().menuLaunched&&(Bi.n.removeCSSClassFromElement(this.get_searchBox().searchIcon,this._activeIconClass),Bi.n.ensureCSSClassOnElement(this.get_searchBox().searchIcon,this._inactiveIconClass)),this.get_searchBox().raiseEvent(Ro.t.blur,e),this.raiseInteractionEnd(),this.get_searchBox().set_elmHadFocus(this.get_searchBox().get_inputField()),!1},t.prototype.onInputBoxFocus=function(e){return Bi.n.ensureCSSClassOnElement(this.get_searchBox().get_inputField(),"cui-sb-focus"),Bi.n.ensureCSSClassOnElement(this.get_searchBox().get_topLevelElement(),"cui-sb-focus"),this._isRedesignFlightEnabled&&(Bi.n.removeCSSClassFromElement(this.get_searchBox().searchIcon,this._inactiveIconClass),Bi.n.ensureCSSClassOnElement(this.get_searchBox().searchIcon,this._activeIconClass)),this.get_searchBox().raiseEvent(Ro.t.focus,e),this.raiseInteractionBegin(),!1},t.prototype.onSearchContainerMouseOver=function(e){return this._isRedesignFlightEnabled&&(Bi.n.ensureCSSClassOnElement(this.get_searchBox().get_topLevelElement(),"cui-sb-hover"),Bi.n.ensureCSSClassOnElement(this.get_searchBox().get_inputField(),"cui-sb-hover"),Bi.n.removeCSSClassFromElement(this.get_searchBox().searchIcon,this._inactiveIconClass),Bi.n.ensureCSSClassOnElement(this.get_searchBox().searchIcon,this._activeIconClass)),!1},t.prototype.onSearchContainerMouseOut=function(e){return this._isRedesignFlightEnabled&&(Bi.n.removeCSSClassFromElement(this.get_searchBox().get_topLevelElement(),"cui-sb-hover"),Bi.n.removeCSSClassFromElement(this.get_searchBox().get_inputField(),"cui-sb-hover"),this.get_searchBox().menuLaunched||this.get_searchBox().get_inputHasFocus()||(Bi.n.removeCSSClassFromElement(this.get_searchBox().searchIcon,this._activeIconClass),Bi.n.ensureCSSClassOnElement(this.get_searchBox().searchIcon,this._inactiveIconClass))),!1},t}(go);(0,o.l)(Lo,"SearchBoxBehavior",go,[ko,Ei]);var No=n(2852),Bo=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.get_slider=function(){return this.get_control()},t.prototype.get_sliderDom=function(){return this.get_slider().get_sliderDom()},t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.initialize=function(){},t.prototype.doDefaultAction=function(e,t,n){},t.prototype.attachEvents=function(e){var t=e.elmInput;ze.z.get_instance().registerHandler(Le.d.focus,t,o.i(this,this.onFocus,"onFocus")),ze.z.get_instance().registerHandler(Le.d.blur,t,o.i(this,this.onBlur,"onBlur")),ze.z.get_instance().registerHandler(Le.d.change,t,o.i(this,this.onChange,"onChange")),ze.z.get_instance().registerHandler(Le.d.input,t,o.i(this,this.onChange,"onChange"))},t.prototype.onFocus=function(t){return this.get_sliderDom().elmControl&&Sys.UI.DomElement.addCssClass(this.get_sliderDom().elmControl,"cui-sldr-onfocus"),e.prototype.onFocus.call(this,t)},t.prototype.onBlur=function(t){return this.get_sliderDom().elmControl&&Sys.UI.DomElement.removeCssClass(this.get_sliderDom().elmControl,"cui-sldr-onfocus"),e.prototype.onBlur.call(this,t)},t.prototype.onChange=function(e){return this.commitValue(this.get_sliderDom().elmInput.value),!0},t.prototype.commitValue=function(e){this.get_stateProperties()[No.u.Value]=parseFloat(e),this.get_root().executeCommand(this.get_properties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1)},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[No.u.Value],t=this.get_stateProperties()[No.u.MaxValue],n=this.get_stateProperties()[No.u.Text],r=this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties());if(this.get_sliderDom()&&this.get_sliderDom().elmInput&&(this.get_sliderDom().elmInput.disabled=!this.get_control().get_enabled()),(2&r)>0){var i=this.get_stateProperties()[No.u.Value],o=this.get_stateProperties()[No.u.MaxValue],a=this.get_stateProperties()[No.u.Text];o===t&&i===e&&n===a||this.get_sliderDom()&&this.get_sliderDom().elmInput&&(this.get_sliderDom().elmInput.setAttribute(Ot.t.ariaValueMaxAttribute,String.format("{0}",o)),this.get_sliderDom().elmInput.setAttribute("max",String.format("{0}",o)),this.get_sliderDom().elmInput.value=i,this.get_sliderDom().elmLabel.innerText=this.get_stateProperties()[No.u.Text])}},t}(Oi);(0,o.l)(Bo,"SliderBehavior",Oi,[]);var Oo,Uo=(0,o.y)("ISpinnerBehavior");!function(e){e[e.none=0]="none",e[e.centimeter=1]="centimeter",e[e.character=2]="character",e[e.inch=3]="inch",e[e.line=4]="line",e[e.point=5]="point",e[e.percent=6]="percent",e[e.pixels=7]="pixels",e[e.timespan=8]="timespan",e[e.degree=9]="degree"}(Oo||(Oo={})),(0,o.h)("UnitType",Oo);var Ho=function(){function e(){}return e.Alt="Alt",e.Number="Number",e.UnitType="UnitType",e.Text="Text",e.MaxValue="MaxValue",e}();(0,o.l)(Ho,"SpinnerCommandProperties",null,[]);var Go=function(e){function t(t){var n=e.call(this,t)||this;return n._numericalValue=0,n._unit=null,n._isSpecialText=!1,n._validUnitTypes=null,n._spinningUp=!1,n._mouseupOnTextboxSinceFocus=!1,n._pendingDelaySpinTimeoutId=-1,n._repeatSpinIntervalId=-1,n}return(0,S.t)(t,e),t.prototype.get_spinner=function(){return this.get_control()},t.prototype.get_spinnerDom=function(){return this.get_spinner().get_spinnerDom()},t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.initialize=function(){var e=this.get_spinner().get_validUnits();this._validUnitTypes=this.unitTypeArrayFromUnitArray(e),this._numericalValue=e[0].get_min(),this._unit=e[0],this._isSpecialText=!1},t.prototype.doDefaultAction=function(e,t,n){},t.prototype.attachEvents=function(e){var t=e,n=t.elmInput,r=t.elmUpArrow,i=t.elmDownArrow;ze.z.get_instance().registerHandler(Le.d.focus,n,o.i(this,this.onFocus,"onFocus")),ze.z.get_instance().registerHandler(Le.d.blur,n,o.i(this,this.onBlur,"onBlur")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyDown,n,o.i(this,this.onKeyDown,"onKeyDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyPress,n,o.i(this,this.onKeyPress,"onKeyPress")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyUp,n,o.i(this,this.onKeyUp,"onKeyUp")),ze.z.get_instance().registerHandler(Le.d.change,n,o.i(this,this.onChange,"onChange")),Be.p.get_instance().registerHandler(Le.d.mouseUp,n,o.i(this,this.onInputMouseUp,"onInputMouseUp")),xi.z.get_instance().registerHandler(Le.d.pointerDown,r,o.i(this,this.onArrowPointerDown,"onArrowPointerDown")),xi.z.get_instance().registerHandler(Le.d.pointerDown,i,o.i(this,this.onArrowPointerDown,"onArrowPointerDown")),xi.z.get_instance().registerHandler(Le.d.pointerUp,r,o.i(this,this.onArrowPointerUp,"onArrowPointerUp")),xi.z.get_instance().registerHandler(Le.d.pointerUp,i,o.i(this,this.onArrowPointerUp,"onArrowPointerUp")),_n.v.get_instance().registerHandler(Le.d.touchMove,r,o.i(this,this.onArrowTouchMove,"onArrowTouchMove")),_n.v.get_instance().registerHandler(Le.d.touchMove,i,o.i(this,this.onArrowTouchMove,"onArrowTouchMove")),_n.v.get_instance().registerHandler(Le.d.touchEnd,r,o.i(this,this.onArrowTouchEnd,"onArrowTouchEnd")),_n.v.get_instance().registerHandler(Le.d.touchEnd,i,o.i(this,this.onArrowTouchEnd,"onArrowTouchEnd"))},t.prototype.onFocus=function(t){return e.prototype.onFocus.call(this,t),Bi.n.ensureCSSClassOnElement(this.get_spinnerDom().elmControl,"cui-spn-focus"),this.get_control().get_enabled()&&Bt.g.selectAllTextInInput(this.get_spinnerDom().elmInput),this._mouseupOnTextboxSinceFocus=!1,!1},t.prototype.onBlur=function(t){return e.prototype.onBlur.call(this,t),Bi.n.removeCSSClassFromElement(this.get_spinnerDom().elmControl,"cui-spn-focus"),!1},t.prototype.onKeyDown=function(e){var t=!1;if(!Li.x(e.innerEvent)&&!Li.x(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,r=e.innerEvent.keyCode,i=n.shiftKey;r===Sys.UI.Key.up||r===Sys.UI.Key.down?(this.get_root().isCurrentModalController(this.get_control())||this.startSpin(r===Sys.UI.Key.up,e.get_inputSource()),t=!0):r===Sys.UI.Key.enter?(this.commitPendingChange(),o.r(mo.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0):r===Sys.UI.Key.tab?(this.commitPendingChange(),o.r(mo.Ribbon,this.get_root())&&(t=this.get_root().wrapKeyboardFocus(this.get_displayedComponent().get_elementInternal(),!i))):r===Sys.UI.Key.esc?(this.resetInputToPreviousValue(),o.r(mo.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0):r!==Sys.UI.Key.backspace&&r!==Sys.UI.Key.del||(t=!this.get_control().get_enabled())}return t},t.prototype.onKeyPress=function(e){return!this.get_control().get_enabled()},t.prototype.onKeyUp=function(e){return this.deactivateElementFromKeyboard(),!1},t.prototype.onChange=function(e){return this.commitPendingChange(),!1},t.prototype.onInputMouseUp=function(e){return!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0)},t.prototype.onArrowPointerDown=function(e){var t=!1,n=!0;if(2===e.get_inputSource()&&(n=!e.get_mouseButton()),n){var r=e.get_sourceElement(),i=r===this.get_spinnerDom().elmUpArrow||r===this.get_spinnerDom().elmUpArrowImageContainer||r===this.get_spinnerDom().elmUpArrowImage;this.startSpin(i,e.get_inputSource()),t=!0}return t},t.prototype.onArrowPointerUp=function(e){return this.deactivateElement(e)},t.prototype.onArrowTouchMove=function(e){return this.onActivePointerMove(e)},t.prototype.onArrowTouchEnd=function(e){return this.deactivateElement(e)},t.prototype.incDecValue=function(e){if(this.get_control().get_enabled()){var t=!1;if(!this._isSpecialText){var n=this.getIncDecStartingValue(e),r=e?n+this._unit.get_step():n-this._unit.get_step();r=Math.min(r,this._unit.get_max()),(r=Math.max(r,this._unit.get_min()))!==this._numericalValue&&(this.commitNumericalValue(r,this._unit),this.get_root().executeCommand(this.get_properties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1),t=!0)}if(!t){var i=this.get_properties().SpinCommand,o=this.get_stateProperties();o.Increment=e,Li.x(i)||this.get_root().executeCommand(i,o,this.get_displayedComponent(),0,!1)}}},t.prototype.getIncDecStartingValue=function(e){var t=Math.pow(10,L.AFrameworkApplication.get_numberFormat().numberDecimalDigits),n=Math.round(this._numericalValue*t),r=Math.round(this._unit.get_step()*t),i=n/r;return(i=e?Math.floor(i):Math.ceil(i))*r/t},t.prototype.startSpin=function(e,t){if(this.get_control().get_enabled()){this.commitPendingChange();var n=e?this.get_spinnerDom().elmUpArrow:this.get_spinnerDom().elmDownArrow;switch(t){case 2:case 3:this._spinningUp=e,this.activateElement(n);break;case 1:this._spinningUp=e,this.activateElementFromKeyboard(n)}}},t.prototype.stopSpin=function(){this.cancelPendingDelaySpin(),this.cancelRepeatSpin()},t.prototype.delaySpin=function(){-1===this._pendingDelaySpinTimeoutId&&(this._pendingDelaySpinTimeoutId=window.setTimeout(o.i(this,this.repeatSpin,"repeatSpin"),500))},t.prototype.cancelPendingDelaySpin=function(){var e=this;Bi.n.cancelPendingTimeout((0,p.m)((function(){return e._pendingDelaySpinTimeoutId}),(function(t){return e._pendingDelaySpinTimeoutId=t})))},t.prototype.repeatSpin=function(){this.cancelPendingDelaySpin(),-1===this._repeatSpinIntervalId&&(this.spin(),this._repeatSpinIntervalId=window.setInterval(o.i(this,this.spin,"spin"),50))},t.prototype.cancelRepeatSpin=function(){var e=this;Bi.n.cancelInterval((0,p.m)((function(){return e._repeatSpinIntervalId}),(function(t){return e._repeatSpinIntervalId=t})))},t.prototype.spin=function(){this.incDecValue(this._spinningUp)},t.prototype.activateElementFromKeyboard=function(e){this.get_root().beginModal(this.get_control(),!1),Bi.n.ensureCSSClassOnElement(e,Pi.Control.activeClassName),this.spin(),this.delaySpin()},t.prototype.deactivateElementFromKeyboard=function(){this.get_root().endModal(this.get_control(),!1),this.stopSpin(),Bi.n.removeCSSClassFromElement(this.get_spinnerDom().elmUpArrow,Pi.Control.activeClassName),Bi.n.removeCSSClassFromElement(this.get_spinnerDom().elmDownArrow,Pi.Control.activeClassName)},t.prototype.setInputValue=function(e){this.get_spinnerDom().elmInput.value!==e&&(this.get_spinnerDom().elmInput.value=e)},t.prototype.resetInputToPreviousValue=function(){this.setInputValue(this.get_stateProperties()[Ho.Text])},t.prototype.setCurrentValueToSpecialText=function(e){this.setInputValue(e),this.get_stateProperties()[Ho.Text]=e,this._isSpecialText=!0},t.prototype.setCurrentValueToNumber=function(e,t,n){this.setInputValue(n),this.get_stateProperties()[Ho.Text]=n,this.get_stateProperties()[Ho.Number]=e,this.get_stateProperties()[Ho.UnitType]=t.get_type(),this._numericalValue=e,this._unit=t,this.get_spinnerDom().elmInput.setAttribute(Ot.t.ariaValueNowAttribute,n),this.get_spinnerDom().elmInput.setAttribute(Ot.t.ariaValueMinAttribute,String.format("{0}",t.get_min())),this.get_spinnerDom().elmInput.setAttribute(Ot.t.ariaValueMaxAttribute,String.format("{0}",t.get_max())),this._isSpecialText=!1},t.prototype.commitTextValue=function(e){var t;if(this.isSpecialText(e,(0,p.m)((function(){return t}),(function(e){return t=e}))))this.setCurrentValueToSpecialText(t);else{var n=0,r=0;Jn.l.parseNumberAndUnitsFromString(e,this._validUnitTypes,L.AFrameworkApplication.get_numberFormat(),(0,p.m)((function(){return n}),(function(e){return n=e})),(0,p.m)((function(){return r}),(function(e){return r=e})));var i=this.unitFromUnitType(r);!r&&Li.x(i)&&(i=this.unitFromUnitType(this.get_stateProperties()[Ho.UnitType])),this.commitNumericalValue(n,i)}},t.prototype.commitNumericalValue=function(e,t){if(e=this.normalizeNumber(e,t),isNaN(e)||Li.x(t))this.resetInputToPreviousValue();else{var n=L.AFrameworkApplication.get_numberFormat(),r="";Jn.l.formatNumberToString(e,t.get_type(),n,(0,p.m)((function(){return r}),(function(e){return r=e})));var i=6===t.get_type()?n.numberGroupSeparator:n.percentGroupSeparator;r=r.replace(i,""),this.setCurrentValueToNumber(e,t,r)}},t.prototype.isSpecialText=function(e,t){var n=!1;t.val="",e=e.trim();var r=this.get_spinner().get_validSpecialStrings();if(!Li.x(r))for(var i=0;i<r.length;i++)if(r[i].toLowerCase()===e.toLowerCase()){t.val=r[i],n=!0;break}return n},t.prototype.normalizeNumber=function(e,t){return isNaN(e)||Li.x(t)?Number.NaN:t.normalizeNumber(e)},t.prototype.unitFromUnitType=function(e){for(var t=null,n=this.get_spinner().get_validUnits(),r=0;r<n.length;r++)if(n[r].get_type()===e){t=n[r];break}return t},t.prototype.unitTypeArrayFromUnitArray=function(e){for(var t=e.length,n=new Array(t),r=0;r<t;r++)n[r]=e[r].get_type();return n},t.prototype.commitPendingChange=function(){if(this.get_control().get_enabled()){var e=this.get_stateProperties()[Ho.Text],t=this.get_spinnerDom().elmInput.value;if(t!==e)this.commitTextValue(t),this.get_stateProperties()[Ho.Text]!==e&&this.get_root().executeCommand(this.get_properties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1)}else this.resetInputToPreviousValue()},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[Ho.Text],t=this.get_stateProperties()[Ho.Number],n=this.get_stateProperties()[Ho.UnitType],r=this.get_stateProperties()[Ho.MaxValue];if((2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties()))>0){var i=this.get_stateProperties()[Ho.Text],o=this.get_stateProperties()[Ho.Number],a=this.get_stateProperties()[Ho.UnitType],s=this.get_stateProperties()[Ho.MaxValue];s!==r&&(this.unitFromUnitType(a).set_max(s),this.get_spinnerDom().elmInput.setAttribute(Ot.t.ariaValueMaxAttribute,String.format("{0}",s))),i!==e?""===i?this.setCurrentValueToSpecialText(i):this.commitTextValue(i):isNaN(o)||o===t&&a===n||this.commitNumericalValue(o,this.unitFromUnitType(a));var l=this.get_spinnerDom().elmControl.title,c=Bi.n.validateStringProperty(this.get_stateProperties()[Ho.Alt],this.get_properties().Alt);c!==l&&(this.get_spinnerDom().elmInput.title=c,this.get_spinnerDom().elmUpArrow.title=c,this.get_spinnerDom().elmDownArrow.title=c)}},t.prototype.activeElementStateChanged=function(t){e.prototype.activeElementStateChanged.call(this,t),t?(this.spin(),this.delaySpin()):this.stopSpin()},t}(Oi);(0,o.l)(Go,"SpinnerBehavior",Oi,[Uo,Ei]);var Vo=n(9446),Wo=n(7407),zo=function(e){function t(t){var n=e.call(this,t)||this;return n._menuButtonEnabled=!0,n._buttonEnabled=!1,n}return(0,S.t)(t,e),t.prototype.get_splitButton=function(){return this.get_control()},t.prototype.get_properties$2=function(){return this.get_splitButton().get_properties()},t.prototype.attachEvents=function(e){var t=e,n=t.elmControl,r=t.elmButtonPart,i=t.elmMenuLauncherPart;ze.z.get_instance().registerHandler(Le.d.focus,n,o.i(this,this.onFocus,"onFocus")),ze.z.get_instance().registerHandler(Le.d.blur,n,o.i(this,this.onBlur,"onBlur")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyDown,n,o.i(this,this.onKeyDown,"onKeyDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyUp,n,o.i(this,this.onKeyUp,"onKeyUp")),G.y.get_isInternetExplorerEdge()&&this.getEdgeMajorVersion()<16&&(xi.z.get_instance().registerHandler(Le.d.pointerDown,n,o.i(this,this.onSplitbuttonPointerDownPointerUp,"onSplitbuttonPointerDownPointerUp")),xi.z.get_instance().registerHandler(Le.d.pointerUp,n,o.i(this,this.onSplitbuttonPointerDownPointerUp,"onSplitbuttonPointerDownPointerUp"))),xi.z.get_instance().registerHandler(Le.d.pointerOver,r,o.i(this,this.onButtonPointerOver,"onButtonPointerOver")),xi.z.get_instance().registerHandler(Le.d.pointerOut,r,o.i(this,this.onButtonPointerOut,"onButtonPointerOut")),xi.z.get_instance().registerHandler(Le.d.pointerDown,r,o.i(this,this.onButtonPointerDown,"onButtonPointerDown")),xi.z.get_instance().registerHandler(Le.d.pointerUp,r,o.i(this,this.onButtonPointerUp,"onButtonPointerUp")),_n.v.get_instance().registerHandler(Le.d.touchMove,r,o.i(this,this.onButtonTouchMove,"onButtonTouchMove")),_n.v.get_instance().registerHandler(Le.d.touchEnd,r,o.i(this,this.onButtonTouchEnd,"onButtonTouchEnd")),xi.z.get_instance().registerHandler(Le.d.pointerDown,i,o.i(this,this.onMenuButtonPointerDown,"onMenuButtonPointerDown")),xi.z.get_instance().registerHandler(Le.d.pointerOver,i,o.i(this,this.onMenuButtonPointerOver,"onMenuButtonPointerOver")),xi.z.get_instance().registerHandler(Le.d.pointerOut,i,o.i(this,this.onMenuButtonPointerOut,"onMenuButtonPointerOut"))},t.prototype.doDefaultAction=function(t,n,r){if(Sys.UI.DomElement.containsCssClass(t,"cui-ctl-a1")){if(this._buttonEnabled){this.get_splitButton().set_on(!this.get_splitButton().get_on());var i=this.get_stateProperties();i.CommandValueId=this.get_control().getCommandValueId(),this.get_root().executeCommand(this.get_properties$2().Command,i,this.get_displayedComponent(),n,!0,null,this.getTelemetryData(r))}}else this._menuButtonEnabled&&e.prototype.doDefaultAction.call(this,t,n,r)},t.prototype.onKeyUp=function(t){var n=t.innerEvent.keyCode;if(n===Sys.UI.Key.enter||n===Sys.UI.Key.space){var r=this.get_stateProperties();return r.CommandValueId=this.get_control().getCommandValueId(),this.get_root().executeCommand(this.get_properties$2().Command,r,this.get_displayedComponent(),1,!0),!0}return e.prototype.onKeyUp.call(this,t)},t.prototype.pollForStateAndUpdate=function(){var e=this.get_root().pollForCommandState(this.get_properties$2().Command,this.get_properties$2().QueryCommand,this.get_stateProperties()),t=(1&e)>0,n=!0;Li.x(this.get_properties$2().CommandMenuOpen)?n=t:n=(1&this.get_root().pollForCommandState(this.get_properties$2().CommandMenuOpen,null,null))>0;if(n===this._menuButtonEnabled&&t===this._buttonEnabled&&(n||t)===this.get_control().get_enabled()||(this.get_control().set_enabled(n||t),t!==this._buttonEnabled&&this.onEnabledChangedForButton(t),n!==this._menuButtonEnabled&&this.onEnabledChangedForMenu(n),this._menuButtonEnabled=n,this._buttonEnabled=t),(2&e)>0){this.updateImage();var r=Bi.n.validateStringProperty(this.get_stateProperties()[Wo.z.LabelText],this.get_properties$2().LabelText);if(this.get_stateProperties()[Wo.z.ApplyLabelTextToControlOnly]?this.get_splitButton().forEachSplitButtonComponentDom((function(e){e.elmControl.title=r,e.elmButtonPart.removeAttribute("title"),e.elmMenuLauncherPart.removeAttribute("title")})):this.get_splitButton().forEachSplitButtonComponentDom((function(e){e.elmButtonPart.title=r})),this.get_stateProperties()[Wo.z.EnsureControlRoleIsButton]&&this.get_splitButton().forEachSplitButtonComponentDom((function(e){Ot.t.setAriaAttribute(e.elmControl,Ot.t.ariaRoleAttribute,Ot.t.ariaButtonRole)})),!Li.x(this.get_stateProperties()[Wo.z.Visible]))this.updateVisibility()&&this.updateHtml()}this.get_splitButton().setState(this.get_splitButton().get_on()&&t)},t.prototype.updateHtml=function(){this.updateLabelText(),this.updateTooltip(),this.updateImage()},t.prototype.onEnabledChangedForMenu=function(e){this.get_splitButton().forEachSplitButtonComponentDom((function(t){Bi.n.setEnabledOnElement(t.elmMenuLauncherPart,e)})),this.removeControlHighlight(),this._menuButtonEnabled=e},t.prototype.onEnabledChangedForButton=function(e){this.get_splitButton().forEachSplitButtonComponentDom((function(t){Bi.n.setEnabledOnElement(t.elmButtonPart,e)})),this.removeControlHighlight(),this._buttonEnabled=e},t.prototype.removeControlHighlight=function(){var e=this.get_splitButton().getDisplayedComponentElement();Li.x(e)||(Bi.n.removeCSSClassFromElement(e.childNodes[0],"cui-ctl-split-hovered-primary"),Bi.n.removeCSSClassFromElement(e.childNodes[0],"cui-ctl-split-hovered-secondary"),Bi.n.removeCSSClassFromElement(e.childNodes[1],"cui-ctl-split-hovered-primary"),Bi.n.removeCSSClassFromElement(e.childNodes[1],"cui-ctl-split-hovered-secondary"))},t.prototype.onSplitbuttonPointerDownPointerUp=function(e){if(Vo.l(e.innerEvent))return!1;var t=!1;return e.eventName===Le.d.pointerDown?t=this.onButtonPointerDown(e):e.eventName===Le.d.pointerUp&&(t=this.onButtonPointerUp(e)),t},t.prototype.onButtonPointerDown=function(e){var t=!1,n=e.get_inputSource();switch(n){case 3:this.shouldUseFlyoutBehaviorOnTouch()?(this.doDefaultAction(this.get_displayedComponent().get_elementInternal(),n,e.innerEvent),t=!0):(this.activateElement(this.get_splitButton().get_displayedButtonElement()),t=!0);break;case 2:e.get_mouseButton()||(this.activateElement(this.get_splitButton().get_displayedButtonElement()),t=!0)}return t&&e.innerEvent.preventDefault(),!1},t.prototype.shouldUseFlyoutBehaviorOnTouch=function(){var e=this.get_displayedComponent().get_displayMode();return"Small"===e||"Medium"===e||"Menu16"===e||"MenuTellMe"===e},t.prototype.onButtonPointerUp=function(e){return this.deactivateElement(e)},t.prototype.onButtonTouchMove=function(e){return this.onActivePointerMove(e)},t.prototype.onButtonTouchEnd=function(e){return this.deactivateElement(e)},t.prototype.onFocus=function(t){return e.prototype.onFocus.call(this,t),this.highlightControl(!0,!0),!1},t.prototype.onBlur=function(t){return e.prototype.onFocus.call(this,t),this.removeControlHighlight(),!1},t.prototype.onButtonPointerOver=function(e){return this.get_control().get_enabled()&&this._buttonEnabled&&this.highlightControl(!0,this.get_splitButton().get_on()),!1},t.prototype.onButtonPointerOut=function(e){return this.get_control().get_enabled()&&this._buttonEnabled&&this.removeControlHighlight(),!1},t.prototype.onMenuButtonPointerDown=function(e){var t=!1;return 2===e.get_inputSource()&&e.get_mouseButton()||(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0),t&&e.innerEvent.preventDefault(),!1},t.prototype.onMenuButtonPointerOver=function(e){return this.get_control().get_enabled()&&this._menuButtonEnabled&&this.highlightControl(this.get_splitButton().get_on(),!0),!1},t.prototype.onMenuButtonPointerOut=function(e){return this.removeControlHighlight(),!1},t.prototype.highlightControl=function(e,t){var n=this.get_control().getDisplayedComponentElement();Li.x(n)||(Bi.n.ensureCSSClassOnElement(n.childNodes[0],e?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),Bi.n.ensureCSSClassOnElement(n.childNodes[1],t?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))},t.prototype.getEdgeMajorVersion=function(){var e=G.y.get_edgeVersion();if(e){var t=e.split(".");if(2===t.length)return parseInt(t[0])}return 0},t}(go);(0,o.l)(zo,"SplitButtonBehavior",go,[]);var Ko=(0,o.y)("ITextBoxBehavior"),qo=n(7979),jo=function(){function e(){}return e.Text="Text",e}();(0,o.l)(jo,"TextBoxCommandProperties",null,[]);var $o=function(e){function t(t){var n=e.call(this,t)||this;return n._mouseupOnTextboxSinceFocus=!1,n._inputFocused=!1,n._excelTableRenameEnabled=!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelTableRenameEnabled"),n}return(0,S.t)(t,e),t.prototype.get_textBox=function(){return this.get_control()},t.prototype.get_textBoxDom=function(){return this.get_textBox().get_textBoxDom()},t.prototype.get_tbProperties=function(){return this.get_textBox().get_controlProperties()},t.prototype.attachEvents=function(e){var t=e.elmInput;ze.z.get_instance().registerHandler(Le.d.focus,t,o.i(this,this.onFocus,"onFocus")),ze.z.get_instance().registerHandler(Le.d.blur,t,o.i(this,this.onBlur,"onBlur")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyPress,t,o.i(this,this.onKeyPress,"onKeyPress")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp")),ze.z.get_instance().registerHandler(Le.d.change,t,o.i(this,this.onChange,"onChange")),Be.p.get_instance().registerHandler(Le.d.mouseUp,t,o.i(this,this.onMouseUp,"onMouseUp"))},t.prototype.onFocus=function(t){return e.prototype.onFocus.call(this,t),this._inputFocused=!0,Bi.n.ensureCSSClassOnElement(this.get_textBoxDom().elmControl,"cui-tb-focus"),this.get_control().get_enabled()&&Bt.g.selectAllTextInInput(this.get_textBoxDom().elmInput),this._mouseupOnTextboxSinceFocus=!1,!1},t.prototype.onBlur=function(t){return this._inputFocused=!1,e.prototype.onBlur.call(this,t),Bi.n.removeCSSClassFromElement(this.get_textBoxDom().elmControl,"cui-tb-focus"),!1},t.prototype.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!Li.x(t.innerEvent)&&!Li.x(t.innerEvent.rawEvent)){var r=t.innerEvent.rawEvent,i=t.innerEvent.keyCode,a=r.shiftKey;i===Sys.UI.Key.tab?(this.commitPendingChange(),o.r(mo.Ribbon,this.get_root())&&(n=this.get_root().wrapKeyboardFocus(this.get_displayedComponent().get_elementInternal(),!a))):i===Sys.UI.Key.enter?this._excelTableRenameEnabled&&(this.commitPendingChange(),o.r(mo.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),n=!0):i===Sys.UI.Key.esc?(this.resetInputToPreviousValue(),o.r(mo.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),n=!0):i===Sys.UI.Key.backspace||i===Sys.UI.Key.del?n=!this.get_control().get_enabled():t.get_commandKey()&&(qo.n.cancelEventNoPreventDefault(t.innerEvent),n=!1)}return n},t.prototype.onKeyPress=function(e){return!this.get_control().get_enabled()},t.prototype.onKeyUp=function(e){return!1},t.prototype.onChange=function(e){return this.commitPendingChange(),!1},t.prototype.onMouseUp=function(e){return this.get_textBoxDom().isEditable?!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0):(Bt.g.selectAllTextInInput(this.get_textBoxDom().elmInput),!0)},t.prototype.setInputValue=function(e){this.get_textBoxDom().elmInput.value!==e&&(this.get_textBoxDom().elmInput.value=e)},t.prototype.resetInputToPreviousValue=function(){this.setInputValue(this.get_stateProperties()[jo.Text])},t.prototype.commitPendingChange=function(){if(this.get_control().get_enabled()&&this.get_textBoxDom().isEditable){var e=this.get_stateProperties()[jo.Text],t=this.get_textBoxDom().elmInput.value;t!==e&&(this.get_stateProperties()[jo.Text]=t,this.get_root().executeCommand(this.get_tbProperties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1))}else this.resetInputToPreviousValue()},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[jo.Text];if((2&this.pollForStateAndUpdateInternal(this.get_tbProperties().Command,this.get_tbProperties().QueryCommand,this.get_stateProperties()))>0&&!this._inputFocused){var t=this.get_stateProperties()[jo.Text];t!==e&&this.setInputValue(t)}},t}(Oi);(0,o.l)($o,"TextBoxBehavior",Oi,[Ko,Ei]);var Qo=n(8776),Jo=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.get_toggleButton=function(){return this.get_control()},t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.doDefaultAction=function(e,t,n){var r=this;this.get_control().get_enabled()&&(Bi.n.isFalse(this.get_properties().TogglesWhenExecuted)||this.toggle(),this.get_stateProperties().CommandValueId=this.get_toggleButton().getCommandValueId(),this.get_stateProperties().MenuItemId=this.get_toggleButton().getMenuItemId(),this.get_stateProperties().SourceControlId=this.get_control().get_id(),this.get_root().executeCommand(this.get_properties().Command,this.get_stateProperties(),this.get_displayedComponent(),t,!Bi.n.isFalse(this.get_properties().CloseMenuWhenExecuted),(function(e){Bi.n.isTrue(r.get_properties().UpdateHtmlPostToggle)&&(32===e?r.toggleUx():r.toggleState())}),this.getTelemetryData(n)))},t.prototype.toggleState=function(){var e=!this.get_stateProperties()[Di.e.On];this.get_stateProperties()[Di.e.On]=e},t.prototype.toggleUx=function(){var e=this.get_stateProperties()[Di.e.On];this.get_toggleButton().setState(e),(this.get_toggleButton().get_useCheckMark()&&this.get_toggleButton().get_useUncheckedImage()||Bi.n.isTrue(this.get_properties().UpdateHtmlPostToggle))&&this.updateHtml()},t.prototype.toggle=function(){this.toggleState(),Bi.n.isTrue(this.get_properties().UpdateHtmlPostToggle)||this.toggleUx()},t.prototype.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!n&&!Li.x(t.innerEvent)&&this.get_parentMenu()){var r=t.innerEvent.keyCode;r!==Sys.UI.Key.enter&&r!==Sys.UI.Key.space||t.innerEvent.preventDefault()}return n},t.prototype.pollForStateAndUpdate=function(){(Li.x(this.get_properties().MenuItemId)||(this.get_stateProperties().MenuItemId=this.get_properties().MenuItemId),(2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties()))>0)&&(this.updateVisibility()&&this.updateHtml())},t.prototype.updateHtml=function(){this.get_toggleButton().setState(this.get_stateProperties()[Di.e.On]),this.updateDisplayMode(Bi.n.validateStringProperty(this.get_stateProperties()[Di.e.DisplayMode],"")),this.updateLabelText(),this.updateImage(),this.updateLargeMenu(),Di.e.Alt in this.get_stateProperties()&&this.updateTooltip()},t.prototype.updateLargeMenu=function(){var e=this.get_controlComponentDomCache().get_largeMenu();if(e&&e.elmDescription){var t=Bi.n.validateStringProperty(this.get_stateProperties()[Di.e.Description],this.get_properties().Description);if(t!==e.elmDescription.innerText&&(e.elmDescription.innerText=t,e.elmLabel&&!o.r(Qo.Jewel,this.get_root()))){var n=!Li.t(t);Bi.n.toggleCSSClassOnElement(e.elmLabel,"UIFontBold",n),Bi.n.toggleCSSClassOnElement(e.elmLabel,"cui-ctl-mediumlabel-nodescription",!n)}}},t.prototype.attachEvents=function(e){var t=e.elmControl;ze.z.get_instance().registerHandler(Le.d.focus,t,o.i(this,this.onFocus,"onFocus")),ze.z.get_instance().registerHandler(Le.d.blur,t,o.i(this,this.onBlur,"onBlur")),xi.z.get_instance().registerHandler(Le.d.pointerOver,t,o.i(this,this.onPointerOver,"onPointerOver")),xi.z.get_instance().registerHandler(Le.d.pointerOut,t,o.i(this,this.onPointerOut,"onPointerOut")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyDown,t,o.i(this,this.onKeyDown,"onKeyDown")),Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyUp,t,o.i(this,this.onKeyUp,"onKeyUp")),xi.z.get_instance().registerHandler(Le.d.pointerDown,t,o.i(this,this.onPointerDown,"onPointerDown")),xi.z.get_instance().registerHandler(Le.d.pointerUp,t,o.i(this,this.onPointerUp,"onPointerUp")),hn.s.get_instance().registerHandler(Le.d.click,t,o.i(this,this.onClick,"onClick")),_n.v.get_instance().registerHandler(Le.d.touchMove,t,o.i(this,this.onTouchMove,"onTouchMove")),_n.v.get_instance().registerHandler(Le.d.touchEnd,t,o.i(this,this.onTouchEnd,"onTouchEnd"))},t}(Oi);(0,o.l)(Jo,"ToggleButtonBehavior",Oi,[]);var Xo=function(){function e(e){this._factoryMethods=null,this._commitChangeFixEnabled=!1,this._commitChangeFixEnabled=e,this._factoryMethods={Button:function(e){return new Ui(e)},FileMenuButton:function(e){return new Ui(e)},ColorPicker:function(e){return new Vi(e)},ComboBox:function(e){return new fo(e)},ContextMenuControl:function(e){return new yo(e)},ContextMenuLauncher:function(e){return new yo(e)},DialogMenuLauncher:function(e){return new Co(e)},DropDown:function(e){return new ho(e)},FlyoutAnchor:function(e){return new vo(e)},GalleryButton:function(e){return new To(e)},StatefulColorFlyoutAnchor:function(e){return new vo(e)},JewelMenuLauncher:function(e){return new Fo(e)},Label:function(e){return new Po(e)},Placeholder:function(e){return new Oi(e)},SearchBox:function(e){return new Lo(e)},Separator:function(e){return new Oi(e)},SplitButton:function(e){return new zo(e)},StatefulColorSplitButton:function(e){return new zo(e)},StatefulImageSplitButton:function(e){return new zo(e)},TextBox:function(e){return new $o(e)},ToggleButton:function(e){return new Jo(e)}}}return e.prototype.enableInsertTable=function(){this._factoryMethods[Pi.Control.insertTableControlType]=function(e){return new xo(e)}},e.prototype.enableSlider=function(){this._factoryMethods[Pi.Control.sliderControlType]=function(e){return new Bo(e)}},e.prototype.enableSpinner=function(){this._factoryMethods[Pi.Control.spinnerControlType]=function(e){return new Go(e)}},e.prototype.getBehaviorForControl=function(e){var t=this._factoryMethods[e.get_controlType()],n=t?t(e):null;return n&&this._commitChangeFixEnabled&&n.enableCommitChangeFix(),n},e.get_instance=function(){return e._instance||(e._instance=new e(!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CUICommitChangeFixIsEnabled")))},e._instance=null,e}();(0,o.l)(Xo,"ControlBehaviorFactory",null,[Fi]);var Yo=(0,o.y)("IRootUser"),Zo=n(8707),ea=n(4797),ta=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r,i)||this;return o._launcherElement=null,o.x=0,o.y=0,o.launcherHeight=0,o.launcherWidth=0,o._rootUser=null,o.launcherHeight=0,o.launcherWidth=0,o.addDisplayMode("Menu"),o.set_enabled(!0),o}return(0,S.t)(t,e),t.prototype.get_x=function(){return this.x},t.prototype.get_y=function(){return this.y},t.prototype.get_launcherHeight=function(){return this.launcherHeight},t.prototype.get_launcherWidth=function(){return this.launcherWidth},t.prototype.get_rootUser=function(){return this._rootUser},t.prototype.set_rootUser=function(e){return this._rootUser=e,e},t.prototype.get_controlType=function(){return"DialogMenuLauncher"},t.prototype.setInitialAriaMenuLauncherAttributes=function(e){},t.prototype.updateAriaMenuLauncherAttributes=function(e,t){},t.prototype.getCommandPopulateProperties=function(){var e={};return e.MenuId=this.get_id(),e.DialogMoveCommand=this.get_properties$2().DialogMoveCommand,e.DialogCloseCommand=this.get_properties$2().DialogCloseCommand,e},t.prototype.launchDialogMenuAtLauncher=function(e,t){this.x=e.x,this.y=e.y,this.launcherHeight=e.height,this.launcherWidth=e.width,this.launchMenu(t)},t.prototype.createComponentDomForDisplayMode=function(e){return this._launcherElement=Bi.n.createElement("span"),new ea.d(e,this._launcherElement)},t.prototype.get_properties$2=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedMenuLauncher=function(e,n,r){return new t(e,this.get_id(),n,r)},t}(Ri.MenuLauncher);(0,o.l)(ta,"DialogMenuLauncher",Ri.MenuLauncher,[]);var na=n(5910),ra=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r._activeMenu=null,r}return(0,S.t)(t,e),t.prototype.get_activeMenu=function(){return this._activeMenu},t.prototype.get_dialogMenuRootProperties=function(){return this.get_properties()},t.prototype.get_rootType=function(){return 20},t.prototype.refreshInternal=function(){e.prototype.refreshInternal.call(this),Li.x(this.get_elementInternal())&&this.ensureDOMElement(),this.set_elementInternal(Bi.n.removeChildNodes(this.get_elementInternal())),this.appendChildrenToElement(this.get_elementInternal()),this.set_dirty(!1)},t.prototype.ensureCorrectChildType=function(e){if(!o.r(na.z,e))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot")},t.prototype.createDialogMenu=function(e,t,n,r){var i=new Zi.Menu(this,t,n,r,null);e||(e={}),e.CommandMenuOpen=this.get_dialogMenuRootProperties().CommandMenuOpen,e.CommandMenuClose=this.get_dialogMenuRootProperties().CommandMenuClose;var o=new ta(this,t,e,i);this.get_createdControls()[t]=o;var a=new na.z(this,"dock"+t);a.addChild(o.createComponentForDisplayMode("Menu")),this.addChild(a),this.refresh()},t.prototype.showDialogMenuAt=function(e,t,n,r){var i=this.get_createdControls()[e];if(Li.x(i))throw Error.create('The dialog menu "'+e+'" does not exist');i.launchDialogMenuAtLauncher(new Sys.UI.Bounds(t,n,0,0),r),this._activeMenu=i.get_menu()},t.prototype.closeDialogMenu=function(e){var t=this.get_createdControls()[e];Li.x(t)||(t.closeMenu(),this._activeMenu=null)},t.prototype.onMenuStackCleared=function(){this._activeMenu=null},t.prototype.dispose=function(){var t=this.get_createdControls();for(var n in t){({key:n,value:t[n]}).value.dispose()}e.prototype.dispose.call(this)},t}(Zo.w);(0,o.l)(ra,"DialogMenuRoot",Zo.w,[]);var ia=function(){return function(){this.DivSyndicated=null,this.ImageDownArrow=null,this.ImageDownArrowClass=null,this.ImageDownArrow8by8=null,this.ImageDownArrow8by8Class=null,this.ImageSideArrow=null,this.ImageSideArrowClass=null,this.ImageUpArrow=null,this.ImageUpArrowClass=null,this.ImageUpArrow8by8=null,this.ImageUpArrow8by8Class=null,this.ImageCheckMark=null,this.ImageCheckMarkClass=null,this.ImageUncheckMark=null,this.ImageUncheckMarkClass=null,this.ImageCollapsedArrow=null,this.ImageCollapsedArrowClass=null,this.ImageExpandedArrow=null,this.ImageExpandedArrowClass=null,this.ImageSpinner=null,this.TextDirection=null,this.LabelText=null}}();(0,o.l)(ia,"RootProperties",null,[]);var oa=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t}(ia);(0,o.l)(oa,"StandaloneRootProperties",ia,[]);var aa=function(e){function t(){var t=e.call(this)||this;return t.CommandMenuOpen=null,t.CommandMenuClose=null,t}return(0,S.t)(t,e),t}(oa);(0,o.l)(aa,"DialogMenuRootProperties",oa,[]);var sa="DialogMenuRootId",la=function(){function e(){this._root=null;var e=new aa;e.ImageSideArrow=L.AFrameworkApplication.get_imageClusterPath(),e.ImageSideArrowClass=Lt.getImageClass("SubmenuFlyoutArrow_13x13x32"),e.TextDirection=L.AFrameworkApplication.get_isRtl()?"rtl":"ltr",this._root=new ra(sa,e),this._root.set_rootUser(this),this._root.refresh(),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(te.SV,nt.a,o.i(this,this.populateDialogMenu,"populateDialogMenu"),96)}return e.prototype.get_theRoot=function(){return this._root},e.prototype.executeRootCommand=function(e,t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null);var o=parseInt(e),a=L.AFrameworkApplication.get_theActionManager();n&&(a.set_commandLocation(n.CommandLocation),a.set_invocationMethod(n.InvocationMethod));var s=t,l=a.processActionWithData(o,2,s,i);return this._root.refresh(),32===l},e.prototype.isRootCommandEnabled=function(e){if(!e)return!0;var t=parseInt(e);return 32===L.AFrameworkApplication.get_theActionManager().processAction(t,1)},e.prototype.pollForStateAndUpdateInternal=function(){this.get_theRoot().get_root().pollForStateAndUpdate()},e.prototype.createDialogMenu=function(e,t,n){var r={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};r.DialogMoveCommand=t,r.DialogCloseCommand=n,this.get_theRoot().createDialogMenu(r,e,"","")},e.prototype.showDialogMenuAt=function(e,t,n,r){this.get_theRoot().showDialogMenuAt(e,t,n,r)},e.prototype.closeDialogMenu=function(e){this.get_theRoot().closeDialogMenu(e)},e.prototype.populateDialogMenu=function(e,t,n,r,i){if(1===n)return 32;var o=i,a=new Sys.StringBuilder;a.append('<Menu Id="dialogMenu">'),a.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');var s=o.DialogMoveCommand;a.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',s,CommonUIStrings.l_DialogMove));var l=o.DialogCloseCommand;return a.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',l,CommonUIStrings.l_DialogClose)),a.append("</Controls></MenuSection>"),a.append("</Menu>"),o.PopulationXML=a.toString(),32},e.prototype.dispose=function(){this._root&&(this._root.dispose(),this._root=null)},e}();(0,o.l)(la,"DialogMenuRootUser",null,[Yo,Sys.IDisposable,vi.x]);var ca=function(){function e(e,t,n){this._target=null,this._moveIcon=null,this._startingPosition=null,this._currentPosition=null,this._inMoveMode=!1,this._shouldExit=!1,this._isRTL=!1,this._frameElement=null,this._keyInputManager=null,this._pointerInputManager=null,this._frameElement=e,this._keyInputManager=t,this._pointerInputManager=n,this._isRTL=L.AFrameworkApplication.get_isRtl()}return e.prototype.get_inMoveMode=function(){return this._inMoveMode},e.prototype.enterMoveMode=function(e){e?(this._target=e,this._inMoveMode=!0,this._shouldExit=!1,this._keyInputManager.capture(o.i(this,this.keyEventHandler,"keyEventHandler"),null),this._pointerInputManager.registerHandler(Le.d.pointerDown,this._frameElement,o.i(this,this.pointerDownHandler,"pointerDownHandler")),this._moveIcon||this.createMoveIcon(),this._target.appendChild(this._moveIcon),this.initializeCurrentPosition()):C.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")},e.prototype.exitMoveMode=function(){this._inMoveMode=!1,this._currentPosition=null,this._startingPosition=null,this.removeMoveIcon(),this.releaseHandlers(),this._target=null},e.prototype.releaseHandlers=function(){this._keyInputManager.releaseCapture(),this._pointerInputManager.unregisterHandler(Le.d.pointerDown,this._frameElement,o.i(this,this.pointerDownHandler,"pointerDownHandler"))},e.prototype.initializeCurrentPosition=function(){if(this._target.style.left.endsWith("px")&&this._target.style.right.endsWith("px"))this._currentPosition=new Sys.UI.Point(hi.o.parseIntDefaultZero(this._isRTL?this._target.style.right:this._target.style.left),hi.o.parseIntDefaultZero(this._target.style.top));else{var e=this._isRTL?this._frameElement.offsetWidth-(this._target.offsetLeft+this._target.offsetWidth+hi.o.parseIntDefaultZero(this._target.style.marginRight)):this._target.offsetLeft-hi.o.parseIntDefaultZero(this._target.style.marginLeft),t=this._target.offsetTop-hi.o.parseIntDefaultZero(this._target.style.marginTop);this.setStylePosition(e,t),this._currentPosition=new Sys.UI.Point(e,t)}this._startingPosition=this._currentPosition},e.prototype.createMoveIcon=function(){this._moveIcon=Lt.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")},e.prototype.removeMoveIcon=function(){this._moveIcon.parentNode===this._target&&this._target.removeChild(this._moveIcon)},e.prototype.keyEventHandler=function(e){if(!this.get_inMoveMode())return!1;if(e.innerEvent.preventDefault(),e.eventName===Le.d.keyDown){var t=e.innerEvent.ctrlKey?1:10,n=void 0;switch(e.innerEvent.keyCode){case Je.v.vK_UpArrow:this.moveElement(0,-1*t);break;case Je.v.vK_DownArrow:this.moveElement(0,1*t);break;case Je.v.vK_LeftArrow:n=this._isRTL?1:-1,this.moveElement(n*t,0);break;case Je.v.vK_RightArrow:n=this._isRTL?-1:1,this.moveElement(n*t,0);break;case Je.v.vK_Esc:this.moveElementTo(this._startingPosition.x,this._startingPosition.y),this._shouldExit=!0;break;case Je.v.vK_Enter:this._shouldExit=!0}}return e.eventName===Le.d.keyUp&&this._shouldExit&&this.exitMoveMode(),!0},e.prototype.pointerDownHandler=function(e){return!!this.get_inMoveMode()&&(e.innerEvent.preventDefault(),this.exitMoveMode(),!0)},e.prototype.moveElement=function(e,t){var n=this._currentPosition.x+e,r=this._currentPosition.y+t;this.moveElementTo(n,r)},e.prototype.moveElementTo=function(e,t){var n=this.adjustPositionForAppFrameBounds(e,t);this.setStylePosition(n.x,n.y),this._currentPosition=n},e.prototype.setStylePosition=function(e,t){this._isRTL?this._target.style.right=e+"px":this._target.style.left=e+"px",this._target.style.top=t+"px"},e.prototype.adjustPositionForAppFrameBounds=function(e,t){var n=this._isRTL?hi.o.parseIntDefaultZero(this._target.style.marginRight):hi.o.parseIntDefaultZero(this._target.style.marginLeft),r=this._frameElement.offsetWidth-this._target.offsetWidth-n,i=Math.min(Math.max(-n,e),r),o=hi.o.parseIntDefaultZero(this._target.style.marginTop),a=this._frameElement.offsetHeight-this._target.offsetHeight-o,s=Math.min(Math.max(-o,t),a);return new Sys.UI.Point(i,s)},e}();(0,o.l)(ca,"KeyMoveAdapter",null,[bi.o]);var ua=n(4765),ga=n(8411),pa=n(9776),da=n(2581),ha=function(e){function t(){var t=e.call(this)||this;return t.DisplayName=null,t.PersonaId=null,t.IsAnonymous=!1,t}return(0,S.t)(t,e),t.prototype.get_ControlType=function(){return 4},t}(da.k);(0,o.l)(ha,"PersonaButtonProps",da.k,[]);var _a=function(){function e(){}return e.prototype.createProps=function(e,t){if(e&&!(e.length<1)&&t){var n=(0,O.m)(new pa.x,{ExternalId:"msPresenceOuter",ControlList:[]});this.createFlyoutAnchorProps(e,n.ControlList),t.push(n)}},e.prototype.createFlyoutAnchorProps=function(e,t){var n=(0,O.m)(new ua.b,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:(0,O.m)(new ga.b,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(t,n);var r=(0,O.m)(new pa.x,{Title:"",ControlList:[]});Array.add(n.Menu.MenuSectionList,r),this.createPersonaButtonProps(e,r.ControlList)},e.prototype.createPersonaButtonProps=function(e,t){for(var n=0;n<e.length;n++){var r=(0,O.m)(new ha,{ExternalId:String.format("CoauthorPersona_{0}",n),Command:"336231556",DisplayName:e[n].get_userName(),LabelText:e[n].get_userName(),ImageBackColor:e[n].get_color(),PersonaId:e[n].get_email(),IsAnonymous:e[n].get_isAnonymous()});Array.add(t,r)}},e}();(0,o.l)(_a,"PresenceContextMenuSectionBuilder",null,[Ai]);var ma=n(8176),fa=n(8512),ya=function(){function e(){}return e.prototype.get_name=function(){return"CUI.Behavior"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AccessibleMovingDialogsEnabled")&&(e.register(vi.x).singleInstance().usingFactory((function(){return new la})),e.register(bi.o).singleInstance().usingFactory((function(){return new ca(L.AFrameworkApplication.get_activeFrame().getDOMElement(),Xe.KeyInputManager.get_instance(),xi.z.get_instance())}))),e.register(fa.f).as(Ti.b).singleInstance().usingFactory((function(){return fa.f.get_instance()})),e.register(Ai).singleInstance().usingFactory((function(){return new _a}))},e.prototype.init=function(){ma.b.set_controlBehaviorFactory(Xo.get_instance());for(var e=fa.f.get_instance().get_roots(),t=0;t<e.length;++t){var n=(0,f.e)(Ii.s,e[t]);n&&n.ensureBehaviorAttached()}wi.r.get_instance().setAppInitializationStatus(6)},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e,5)},e}();(0,o.l)(ya,"CuiBehaviorPackage",null,[l.u,c.s]);var Ca,Sa,va=n(8965),ba=(0,o.y)("IEditingViewOnAfterValidateEventsConsolidator"),Ta=n(499),Aa=n(5601),Ia=n(7464),wa=(0,o.y)("IStructuralContentDetailsProvider"),xa=n(2187),Fa=n(6375),Ea=function(){function e(){this.$$pf_ProviderKey=null,this.$$pf_ContentObject=null,this.contentId=null,this.description=null}return e.prototype.get_providerKey=function(){return this.$$pf_ProviderKey},e.prototype.set_providerKey=function(e){return this.$$pf_ProviderKey=e,e},e.prototype.get_contentObject=function(){return this.$$pf_ContentObject},e.prototype.set_contentObject=function(e){return this.$$pf_ContentObject=e,e},e}();(0,o.l)(Ea,"StructuralContentDetails",null,[Fa.s]),function(e){e[e.entering=0]="entering",e[e.leaving=1]="leaving"}(Ca||(Ca={})),(0,o.h)("ContextTransition",Ca),function(e){e[e.cp=0]="cp",e[e.word=1]="word",e[e.line=2]="line",e[e.paragraph=3]="paragraph"}(Sa||(Sa={})),(0,o.h)("ContextTransitionLevel",Sa);var Pa=n(6371),ka=n(7545),Da=n(4257),Ma=n(5387),Ra=n(3650),La=n(3786),Na=function(){function e(e,t,n){this._editingViewOnAfterValidateEventsConsolidator=null,this._selectionManager=null,this._ariaNotifier=null,this._lastSelectionContext=null,this._registeredCpContentDetailsProviders=null,this._oldCpContentPerProvider=null,this._registeredStructuralContentDetailsProviders=null,this._oldStructuralContentPath=null,this._ariaNotifier=e,this._editingViewOnAfterValidateEventsConsolidator=t,this._selectionManager=n,this.init()}return e.prototype.init=function(){this._editingViewOnAfterValidateEventsConsolidator.registerHandler(o.i(this,this.handleEditingViewUpdatesSafe,"handleEditingViewUpdatesSafe")),this._registeredCpContentDetailsProviders=new Ma.e(String,Ia.q),this._oldCpContentPerProvider=new Ma.e(String,xa.e),this._registeredStructuralContentDetailsProviders=new Ma.e(String,wa),this._oldStructuralContentPath=new Ra.o(Ea)},e.prototype.registerCpContentDetailsProvider=function(e){this._registeredCpContentDetailsProviders.add(e.get_key(),e)},e.prototype.registerStructuralContentDetailsProvider=function(e){this._registeredStructuralContentDetailsProviders.add(e.get_key(),e)},e.prototype.handleEditingViewUpdatesSafe=function(e,t){try{this.handleEditingViewUpdates(e,t)}catch(e){var n=String.format("Accessibility Manager failed to handle the EditingView event. Message: {0}. Stack: {1}",e.message,e.stack);C.ULS.sendTraceTag(5285580,334,10,n)}},e.prototype.handleEditingViewUpdates=function(t,n){var r;if(e.tryGetValidSelectionContext(this._selectionManager.get_selectionCollection().get_currentSelection(),(0,p.m)((function(){return r}),(function(e){return r=e})))){var i=e.getContextTransitionLevels(t,this._lastSelectionContext,r);this.processContextChanged(i,r),this._lastSelectionContext=r}},e.prototype.processContextChanged=function(t,n){var r,i=this.getAllAccessibleContextChanges(t,n);e.tryGetNewNotification(i,(0,p.m)((function(){return r}),(function(e){return r=e})))&&this._ariaNotifier.sendNotification(r,!1)},e.prototype.getAllAccessibleContextChanges=function(e,t){var n=this,r=new Ma.e(Ca,La.u.$$(String));return r.set_item(1,new Ra.o(String)),r.set_item(0,new Ra.o(String)),e.forEach((function(e){return 3===e?(ka.ImageReader.isImageNode(t.get_node())||n.resetAllContentDetailsProviders(t),n.getParagraphLevelContextChanges(r,t)):e||n.getCpLevelContextChanges(r,t),!0})),r},e.prototype.resetAllContentDetailsProviders=function(e){this._registeredCpContentDetailsProviders.forEach((function(t,n){return n.reset(e),!0}))},e.prototype.getCpLevelContextChanges=function(t,n){var r=new Ma.e(String,xa.e);ka.ImageReader.isImageNode(n.get_node())||(r=this.getCpContentDetails(n.get_cpBegin())),this.getCpContentDetailsDiff(t,this._oldCpContentPerProvider,r,e.selectionContextChanged(this._lastSelectionContext,n)),this._oldCpContentPerProvider=r},e.prototype.getCpContentDetails=function(e){var t=new Ma.e(String,xa.e);return this._registeredCpContentDetailsProviders.forEach((function(n,r){var i=null;return r.tryGetCpContext(e,(0,p.m)((function(){return i}),(function(e){return i=e})))&&t.set_item(r.get_key(),i),!0})),t},e.prototype.getCpContentDetailsDiff=function(e,t,n,r){var i=this,o=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat;t.forEach((function(t,a){var s,l=i._registeredCpContentDetailsProviders.get_item(t).get_contentTitle()||a.title;if(n.tryGetValue(t,(0,p.m)((function(){return s}),(function(e){return s=e})))){if(r&&s.get_contentObject()!==a.get_contentObject()){l&&e.get_item(1).add(l);var c=i._registeredCpContentDetailsProviders.get_item(t).get_contentTitle(),u=String.format(o,s.title,c);s.description&&(u+=", "+s.description),e.get_item(0).add(u)}}else l&&e.get_item(1).add(l);return!0})),n.forEach((function(n,r){if(!t.containsKey(n)){var a=i._registeredCpContentDetailsProviders.get_item(n).get_contentTitle(),s=String.format(o,r.title,a);r.description&&(s+=", "+r.description),e.get_item(0).add(s)}return!0}))},e.prototype.getParagraphLevelContextChanges=function(e,t){var n=this.getStructuralContentDetails(t.get_node());n=this.collapseNestedContent(n),this.getStructuralContentDetailsDiff(e,this._oldStructuralContentPath,n),this._oldStructuralContentPath=n},e.prototype.getStructuralContentDetails=function(e){var t=new Da.GraphIterator;if(t.set(e),!t.tryToRootAtAncestorOfType(1))return null;for(var n=new Ra.o(Ea);1!==t.get_currentNodeType();)this._registeredStructuralContentDetailsProviders.forEach((function(e,r){var i;return r.tryGetDocumentStructureDetails(t,(0,p.m)((function(){return i}),(function(e){return i=e})))&&n.add(i),!0})),t.returnToParent();return n.reverse(),n},e.prototype.collapseNestedContent=function(e){for(var t=e.toArray(),n=0,r=function(){var e,r=t[n],o=t[n+1];if(r.get_providerKey()===o.get_providerKey()&&i._registeredStructuralContentDetailsProviders.get_item(r.get_providerKey()).tryCollapseNestedContent(r,o,(0,p.m)((function(){return e}),(function(t){return e=t}))))return t.splice(n,2,e),"continue";n++},i=this;n<t.length-1;)r();return new Ra.o(Ea,t)},e.prototype.getStructuralContentDetailsDiff=function(e,t,n){var r;for(r=0;r<Math.min(n.get_length(),t.get_length())&&n.get_item(r).contentId.equals(t.get_item(r).contentId);r++){(o=this._registeredStructuralContentDetailsProviders.get_item(n.get_item(r).get_providerKey()).getContentIncrementalDetails(n.get_item(r),t.get_item(r)))&&(n.get_item(r).description&&(o+=", "+n.get_item(r).description),e.get_item(0).add(o))}for(var i=r;i<n.get_length();i++){(o=this._registeredStructuralContentDetailsProviders.get_item(n.get_item(i).get_providerKey()).getContentIncrementalDetails(n.get_item(i),null))&&(n.get_item(i).description&&(o+=", "+n.get_item(i).description),e.get_item(0).add(o))}for(i=r;i<t.get_length();i++){var o;(o=this._registeredStructuralContentDetailsProviders.get_item(t.get_item(i).get_providerKey()).get_contentTitle())&&e.get_item(1).add(o)}},e.getContextTransitionLevels=function(t,n,r){var i=new Ra.o(Sa);(t=t||e.selectionParagraphChanged(n,r))?(i.add(3),i.add(0)):e.selectionContextChanged(n,r)&&i.add(0);return i},e.selectionParagraphChanged=function(e,t){return!e||!e.get_node().get_id().equals(t.get_node().get_id())},e.selectionContextChanged=function(e,t){return!e||!e.equals(t)},e.tryGetValidSelectionContext=function(e,t){return t.val=null,!!e&&(!!(Pa.SelectionEditor.isInsertionPointSelection(e)||(e=Pa.SelectionEditor.collapseToIp(e,!0,!1),Pa.SelectionEditor.isInsertionPointSelection(e)||e.get_firstContext()&&ka.ImageReader.isImageNode(e.get_firstContext().get_node())))&&(t.val=e.get_firstContext(),!!t.val))},e.tryGetNewNotification=function(e,t){var n=new Ra.o(String);return e.get_item(1).forEach((function(e){var t=String.format(Box4Intl.Box4Strings.l_ContentTypeLeavingNotificationFormat,e);return n.add(t),!0})),e.get_item(0).forEach((function(e){var t=String.format(Box4Intl.Box4Strings.l_ContentTypeEnteringNotificationFormat,e);return n.add(t),!0})),t.val=n.toArray().join(" "),n.get_length()>0},e}();(0,o.l)(Na,"AccessibilityContextManager",null,[va.t]);var Ba=function(){function e(e,t){this._taskManager=null,this._contentEditableViewEventSource=null,this._isRegisteredWithTheEditingView=!1,this._scheduledHandlingTask=null,this._updatedView=!1,this._selectionChanged=!1,this._editingViewUpdatesHandler=null,this._taskManager=e,this._contentEditableViewEventSource=t}return e.prototype.get_hasScheduledHandlingTask=function(){return!!this._scheduledHandlingTask},e.prototype.registerHandler=function(e){this._isRegisteredWithTheEditingView||(this._contentEditableViewEventSource.add_onAfterValidated(o.i(this,this.afterEditingViewValidateEventHandler,"afterEditingViewValidateEventHandler")),this._isRegisteredWithTheEditingView=!0),this._editingViewUpdatesHandler=e},e.prototype.afterEditingViewValidateEventHandler=function(e,t){(t.get_updatedView()||t.get_selectionChanged())&&this.notifyEditingViewUpdates(t.get_updatedView(),t.get_selectionChanged())},e.prototype.notifyEditingViewUpdates=function(t,n){var r=this;this.get_hasScheduledHandlingTask()&&this._taskManager.deleteTask(this._scheduledHandlingTask),this._updatedView=this._updatedView||t,this._selectionChanged=this._selectionChanged||n,this._scheduledHandlingTask=new De.c(4,1,e.eventsConsolidationInterval,(function(e){r._editingViewUpdatesHandler(r._updatedView,r._selectionChanged),r.reset()}),126),this._taskManager.addTask(this._scheduledHandlingTask)},e.prototype.reset=function(){this._scheduledHandlingTask=null,this._updatedView=!1,this._selectionChanged=!1},e.eventsConsolidationInterval=100,e}();(0,o.l)(Ba,"EditingViewOnAfterValidateEventsConsolidator",null,[ba]);var Oa=n(4342),Ua=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.Accessibility"},e.prototype.init=function(){Br.App.ariaNotificationsIsEnabled&&this._container.resolve(va.t)},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,e.register(Ba).as(ba).singleInstance().usingFactory((function(){return new Ba(L.AFrameworkApplication.get_theTaskManager(),e.resolve(Aa.a))})),e.register(Na).as(va.t).singleInstance().usingFactory((function(){return new Na(e.resolve(Ta.u),e.resolve(ba),Oa.SelectionManager.get_instance())}))},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Ua,"Box4AccessibilityPackage",null,[l.u,c.s]);var Ha=n(2601),Ga=n(4627),Va=n(6327),Wa=(0,o.y)("IAutoCorrectOptionsInfo"),za=n(9350),Ka=n(1478),qa=n(3236),ja=n(906),$a=n(8504),Qa=function(){function e(e,t){this._roamingServiceManager=null,this._replaceQuoteWithSmartQuoteIsEnabled=!1,this.replaceTextAsYouType=!1,this.capitalizeFirstLetterOfSentences=!1,this.replaceOrdianalsWithSuperscript=!1,this.replaceHyphensWithDash=!1,this.replaceFractionsWithFractionCharacter=!1,this.replaceQuoteWithSmartQuote=!1,this._roamingServiceManager=e,this._replaceQuoteWithSmartQuoteIsEnabled=t,this.replaceTextAsYouType=!0,this.capitalizeFirstLetterOfSentences=!0,this.replaceOrdianalsWithSuperscript=!0,this.replaceHyphensWithDash=!0,this.replaceFractionsWithFractionCharacter=!0,this.replaceQuoteWithSmartQuote=!0}return e.prototype.get_replaceTextAsYouType=function(){return this.replaceTextAsYouType},e.prototype.get_capitalizeFirstLetterOfSentences=function(){return this.capitalizeFirstLetterOfSentences},e.prototype.get_replaceOrdianalsWithSuperscript=function(){return this.replaceOrdianalsWithSuperscript},e.prototype.get_replaceHyphensWithDash=function(){return this.replaceHyphensWithDash},e.prototype.get_replaceFractionsWithFractionCharacter=function(){return this.replaceFractionsWithFractionCharacter},e.prototype.get_replaceQuoteWithSmartQuote=function(){return this.replaceQuoteWithSmartQuote},e.prototype.cacheAutoCorrectOptions=function(e){if(e)for(var t in e){var n={key:t,value:e[t]},r=Boolean.parse(n.value.toString()||"false");switch(n.key){case"ReplaceTextAsYouType":this.replaceTextAsYouType=r;break;case"CapitalizeFirstLetterOfSentences":this.capitalizeFirstLetterOfSentences=r;break;case"ReplaceOrdianalsWithSuperscript":this.replaceOrdianalsWithSuperscript=r;break;case"ReplaceHyphensWithDash":this.replaceHyphensWithDash=r;break;case"ReplaceFractionsWithFractionCharacter":this.replaceFractionsWithFractionCharacter=r;break;case"ReplaceQuoteWithSmartQuote":this.replaceQuoteWithSmartQuote=this._replaceQuoteWithSmartQuoteIsEnabled&&r}}},e.prototype.getAutoCorrectOptions=function(){var e=["ReplaceTextAsYouType","CapitalizeFirstLetterOfSentences","ReplaceOrdianalsWithSuperscript","ReplaceHyphensWithDash","ReplaceFractionsWithFractionCharacter","ReplaceQuoteWithSmartQuote"];this._roamingServiceManager.getUserSettings("getAutoCorrectOptionsSettings",e).CWo(o.i(this,this.onGetRequestFinished,"onGetRequestFinished"),gr.d.executeSynchronously),C.ULS.sendTraceTag(24523491,324,50,"Load to get autocorrect options from Roaming Service.")},e.prototype.saveAutoCorrectOptions=function(e){this._roamingServiceManager.setUserSettings("saveAutoCorrectOptionsSettings",e),C.ULS.sendTraceTag(24523520,324,50,"Try to save autocorrect options to Roaming Service."),this.cacheAutoCorrectOptions(e)},e.prototype.onGetRequestFinished=function(e){if(e.get_isFaulted())C.ULS.sendTraceTag(24523522,324,15,"Fail to get autocorrect options from Roaming Service.");else{var t=e.get_result();t&&this.cacheAutoCorrectOptions(t),C.ULS.sendTraceTag(24523521,324,50,"Load to get autocorrect options from Roaming Service successfully, isUserSettingsEmpty: {0}",!t||!E.k(t))}},e}();(0,o.l)(Qa,"AutoCorrectOptionsInfo",null,[Wa]);var Ja=n(9513),Xa=n(1392),Ya=n(4994),Za=n(3388),es=function(){function e(){}return e.get_autoCorrectListFallbackTable=function(){return e._autoCorrectListFallbackTable||(e._autoCorrectListFallbackTable=[],e.mapCultureLanguageIdToCultureLcid(Kt.i.getCultureInfo("ar-sa")),e.mapCultureLanguageIdToCultureLcid(Kt.i.getCultureInfo("de-de")),e.mapCultureLanguageIdToCultureLcid(Kt.i.getCultureInfo("es-es")),e.mapCultures(Kt.i.getCultureInfo("en-029"),Kt.i.getCultureInfo("en-us")),e.mapCultures(Kt.i.getCultureInfo("en-au"),Kt.i.getCultureInfo("en-us")),e.mapCultures(Kt.i.getCultureInfo("en-bz"),Kt.i.getCultureInfo("en-us")),e.mapCultures(Kt.i.getCultureInfo("en-ca"),Kt.i.getCultureInfo("en-us")),e.mapCultures(Kt.i.getCultureInfo("en-gb"),Kt.i.getCultureInfo("en-us")),e.mapCultures(Kt.i.getCultureInfo("en-id"),Kt.i.getCultureInfo("en-us")),e.mapCultures(Kt.i.getCultureInfo("en-my"),Kt.i.getCultureInfo("en-us")),e.mapCultures(Kt.i.getCultureInfo("en-ph"),Kt.i.getCultureInfo("en-us")),e.mapCultures(Kt.i.getCultureInfo("zh-tw"),Kt.i.getCultureInfo("en-us")),e.mapCultureLanguageIdToCultureLcid(Kt.i.getCultureInfo("fr-fr")),e.mapCultures(Kt.i.getCultureInfo("hr-ba"),Kt.i.getCultureInfo("hr-hr")),e.mapCultures(Kt.i.getCultureInfo("it-ch"),Kt.i.getCultureInfo("it-it")),e.mapCultures(Kt.i.getCultureInfo("nb-no"),Kt.i.getCultureInfo("nn-no")),e.mapCultureLanguageIdToCultureLcid(Kt.i.getCultureInfo("nl-nl")),e.mapCultures(Kt.i.getCultureInfo("ro-md"),Kt.i.getCultureInfo("ro-ro")),e.mapCultures(Kt.i.getCultureInfo("ru-md"),Kt.i.getCultureInfo("ru-ru")),e.mapCultures(Kt.i.getCultureInfo("sr-latn-ba"),Kt.i.getCultureInfo("sr-latn-cs")),e.mapCultures(Kt.i.getCultureInfo("sr-latn-me"),Kt.i.getCultureInfo("sr-latn-cs")),e.mapCultures(Kt.i.getCultureInfo("sr-latn-rs"),Kt.i.getCultureInfo("sr-latn-cs")),e.mapCultureLanguageIdToCultureLcid(Kt.i.getCultureInfo("sr-cyrl-cs")),e.mapCultures(Kt.i.getCultureInfo("sv-fi"),Kt.i.getCultureInfo("sv-se"))),e._autoCorrectListFallbackTable},e.mapCultureLanguageIdToCultureLcid=function(t){e._autoCorrectListFallbackTable[t.get_languageId()]=t.get_LCID()},e.unmapCulture=function(t){e._autoCorrectListFallbackTable[t.get_LCID()]=t.get_LCID()},e.mapCultures=function(t,n){e._autoCorrectListFallbackTable[t.get_LCID()]=n.get_LCID()},e.getFallbackLcid=function(t){var n=Kt.i.getCultureInfo(t);if(!n)return 0;var r=e.get_autoCorrectListFallbackTable()[n.get_LCID()]||e.get_autoCorrectListFallbackTable()[n.get_languageId()]||0;return r===t?0:r},e._autoCorrectListFallbackTable=null,e}();(0,o.l)(es,"AutoCorrectListFallback",null,[]);var ts=n(3819),ns=(0,o.y)("IListCommands"),rs=n(4360),is=n(4854),os=n(1633),as=n(1253),ss=n(4612),ls=n(7717),cs=n(397),us=n(8158),gs=function(){function e(e,t,n,r,i){this._isFired=!1,this._htmlTarget=null,this._graphTarget=null,this._matchStartIndex=0,this._matchEndIndex=0,this._originalString=null,this._lengthChange=0,this._graphSelection=null,this._selectionSet=!1,this._needToCheckOriginalString=!0,this._characterPropertiesEditor=null,this._lastValidateResultIsValid=!0,this._invalidReason=null,this._lastValidateResultIsMatchTextSame=!0,this._htmlTarget=e,this._graphTarget=t,this._matchStartIndex=n,this._matchEndIndex=r,this._characterPropertiesEditor=i,this._originalString=e?e.innerText:cs.ParagraphReader.text(t)}return e.prototype.get_isGraphOnlyOperation=function(){throw Error.notImplemented("The inherit class should have the default value.")},e.prototype.set_isGraphOnlyOperation=function(e){return e},e.prototype.get_lengthChange=function(){return this._lengthChange},e.prototype.set_lengthChange=function(e){return this._lengthChange=e,e},e.prototype.get_currentSelection=function(){return this._graphSelection},e.prototype.set_currentSelection=function(e){return this._graphSelection=e,e},e.prototype.get_htmlTarget=function(){return this._htmlTarget},e.prototype.get_graphTarget=function(){return this._graphTarget},e.prototype.get_matchStartIndex=function(){return this._matchStartIndex},e.prototype.get_matchEndIndex=function(){return this._matchEndIndex},e.prototype.get_needToCheckOriginalString=function(){return this._needToCheckOriginalString},e.prototype.set_needToCheckOriginalString=function(e){return this._needToCheckOriginalString=e,e},e.prototype.get_isFired=function(){return this._isFired},e.prototype.get_isUndoableByBackspace=function(){return!1},e.prototype.get_originalString=function(){return this._originalString},e.prototype.setNewSelection=function(e){this._selectionSet=!0,this._graphSelection=e},e.prototype.invoke=function(){if(this._isFired=!0,this._htmlTarget&&this._htmlTarget.parentNode&&!this.get_isGraphOnlyOperation()){var t=this._htmlTarget.innerText;return this.get_needToCheckOriginalString()&&Jn.l.substring(this._originalString,this._matchStartIndex,this._matchEndIndex)!==Jn.l.substring(t,this._matchStartIndex,this._matchEndIndex)?0:(this.doHtmlCorrection(this._htmlTarget),this.set_lengthChange(this._htmlTarget.innerText.length-t.length),1)}if(this._lastValidateResultIsMatchTextSame||ji.y.get_instance().recordEvent("MatchTextIsNotTheSame",{Reason:"MatchTextIsNotTheSame"}),!this._lastValidateResultIsValid)return ji.y.get_instance().recordEvent("AbortedAction",{Reason:this._invalidReason}),0;var n=(t=cs.ParagraphReader.text(this._graphTarget)).length,r=this._originalString.length,i=Jn.l.substring(this._originalString,this._matchStartIndex,this._matchEndIndex).trimEnd(),o=Jn.l.substring(t,this._matchStartIndex,this._matchEndIndex).trimEnd();if(i===o&&this._matchEndIndex>r&&(this._matchEndIndex=r),this.get_needToCheckOriginalString()&&i!==o){var a=i.replace(new RegExp('"',"g"),"");if(a!==Jn.l.substr(o,0,a.length))return 0;this._matchEndIndex-=2}if(us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()&&os.CoauthLockEditor.getInstance().shouldLockBlockEditing(e.get_lockedRangeEditor().getCoauthLockForParagraphOrImage(this._graphTarget)))return 0;var s=new as.GraphTransaction(15);if(s.setFromNode(this._graphTarget),s.set_undoActionId(this.get_commandId()),this.doGraphCorrection(this._graphTarget),this.set_lengthChange(cs.ParagraphReader.textLength(this._graphTarget)-n),this._graphSelection&&!this._selectionSet&&Pa.SelectionEditor.isInsertionPointSelection(this._graphSelection)){var l=this._graphSelection.get_firstContext(),c=l.get_cpBegin(),u=l.get_cpEnd(),g=l.get_node();g===this._graphTarget&&this.get_lengthChange()&&(c>=this._matchEndIndex&&(c+=this.get_lengthChange()),u>=this._matchEndIndex&&(u+=this.get_lengthChange()),this._graphSelection=ss.SelectionFactory.createTextRangeOrIpSelection(g,c,u))}return s.dispose(),2},e.prototype.validateAction=function(){return this._lastValidateResultIsMatchTextSame=this.checkMatchTextIsTheSame(),!0},e.prototype.doHtmlCorrection=function(e){},e.prototype.checkMatchTextIsTheSame=function(){var e=cs.ParagraphReader.text(this._graphTarget);return Jn.l.substring(this._originalString,this._matchStartIndex,this._matchEndIndex).trimEnd()===Jn.l.substring(e,this._matchStartIndex,this._matchEndIndex).trimEnd()},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e}();(0,o.l)(gs,"AutoCorrectAction",null,[is.c]);var ps=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n,r,i,a)||this;return s._listCommands=null,s._characterPropertiesEditor$1=null,s.matchResults=null,s.matchResults=o,s._characterPropertiesEditor$1=a,s}return(0,S.t)(t,e),t.prototype.get_listCommands=function(){return this._listCommands||(this._listCommands=se.w.get_instance().tryResolve(ns))},t.prototype.get_listEditor=function(){return t._listEditor||(t._listEditor=se.w.get_instance().resolve(rs.v))},t.prototype.get_isGraphOnlyOperation=function(){return!0},t.prototype.get_commandId=function(){return ii.wI},t._listEditor=null,t}(gs);(0,o.l)(ps,"RegexCorrectAction",gs,[]);var ds=n(2933),hs=n(2759),_s=n(3286),ms=n(6231),fs=function(e){function t(n,r,i,o,a,s){var l=e.call(this,n,r,i,o,a,s)||this;return t._characterPropertiesEditor$2=s,l}return(0,S.t)(t,e),t.prototype.get_commandId=function(){return ii.dq},t.prototype.doGraphCorrection=function(e){if(this.get_listCommands()){var n=Da.GraphIterator.createFromNode(e);if(n.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(n),this.get_listEditor().shouldAutocorrectList(n)){var r=null,i=t.get_listReader().getListInfo(n),o=this.matchResults[0];switch(Jn.l.charAt(o,0)){case"*":(r=ds.j.createFromScratch(1,1)).set_autoTriggerString("*");break;default:r=ds.j.createFromScratch(1,0)}if(!i||!r.hasMatchingListFormat(i)){var a=new as.GraphTransaction(15);a.setFromIterator(n),t._characterPropertiesEditor$2.replaceTextRange(_s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()+1),"",!0,!1),this.get_listEditor().setListBaseStyleIfNecessary(r),this.get_listCommands().bullets(r.get_listType(),r.get_listStyle()),a.dispose()}}}},t.get_characterPropertiesEditor=function(){return t._characterPropertiesEditor$2||(t._characterPropertiesEditor$2=se.w.get_instance().resolve(Va.x))},t.get_listReader=function(){return t._listReader||(t._listReader=se.w.get_instance().resolve(ts.c))},t.createGraphCorrectionAction=function(e,n,r,i,o,a){return new t(null,e,n,r,i,o)},t.createHtmlCorrectionAction=function(e,n,r,i,o,a){return new t(e,ms.y(e).get_sourceNode(),n,r,i,o)},t._characterPropertiesEditor$2=null,t._listReader=null,t}(ps);(0,o.l)(fs,"BulletListAction",ps,[]);var ys=function(e){function t(n,r,i,o,a,s){var l=e.call(this,n,r,i,o,a,s)||this;return l._characterPropertiesEditor$2=null,l.$$pf_IsGraphOnlyOperation=!1,l.set_isGraphOnlyOperation(!n),l._characterPropertiesEditor$2=s,t._replacements=new d.w(String),l}return(0,S.t)(t,e),t.prototype.onAfterGraphCorrection=function(e,t){},t.prototype.get_isGraphOnlyOperation=function(){return this.$$pf_IsGraphOnlyOperation},t.prototype.set_isGraphOnlyOperation=function(e){return this.$$pf_IsGraphOnlyOperation=e,e},t.prototype.doHtmlCorrection=function(e){this.checkMatchAndCommit(e.innerText,(function(t,n,r){e.innerText=Jn.l.substring(e.innerText,0,t)+r+Jn.l.right(e.innerText,n)}))},t.prototype.doGraphCorrection=function(e){var t=this,n=this.get_matchEndIndex();this.checkMatchAndCommit(cs.ParagraphReader.text(e).substring(this.get_matchStartIndex(),this.get_matchEndIndex()),(function(r,i,o){t._characterPropertiesEditor$2.replaceTextRange(_s.y.createTextRange(e,t.get_matchStartIndex()+r,t.get_matchStartIndex()+i),o,!0,!1),n-=i-r-o.length})),this.onAfterGraphCorrection(e,n)},t.prototype.checkMatchAndCommit=function(e,n){if(!(this.matchResults.length<2)&&this.matchResults[1]){var r=this.matchResults[1];if(t._replacements.get_count()||this.populateReplacementDictionary(),t._replacements.containsKey(r)){var i=e.lastIndexOf(r);-1!==i&&n(i,i+r.length,t._replacements.get_item(r))}}},t._replacements=null,t}(ps);(0,o.l)(ys,"DictionarySequenceReplacerAction",ps,[]);var Cs=function(e){function t(t,n,r,i,o,a){return e.call(this,t,n,r,i,o,a)||this}return(0,S.t)(t,e),t.prototype.get_commandId=function(){return ii.sE},t.prototype.populateReplacementDictionary=function(){ys._replacements.set_item("--","\u2014"),ys._replacements.set_item(" -- "," \u2013 "),ys._replacements.set_item(" - "," \u2013 "),ys._replacements.set_item("-- ","\u2014"),ys._replacements.set_item(" --"," \u2013"),ys._replacements.set_item(" -"," \u2013")},t.createGraphCorrectionAction=function(e,n,r,i,o,a){return new t(null,e,n,r,i,o)},t.createHtmlCorrectionAction=function(e,n,r,i,o,a){return new t(e,ms.y(e).get_sourceNode(),n,r,i,o)},t}(ys);(0,o.l)(Cs,"DashAction",ys,[]);var Ss=function(e){function t(t,n,r,i,o,a,s){var l=e.call(this,t,n,r,i,o,a)||this;return l._actionManager=null,l._actionManager=s,l}return(0,S.t)(t,e),t.prototype.get_commandId=function(){return ii.RG},t.prototype.populateReplacementDictionary=function(){ys._replacements.set_item(":)","\ud83d\ude0a"),ys._replacements.set_item(":-)","\ud83d\ude0a"),ys._replacements.set_item(":|","\ud83d\ude10"),ys._replacements.set_item(":-|","\ud83d\ude10"),ys._replacements.set_item(":(","\ud83d\ude41"),ys._replacements.set_item(":-(","\ud83d\ude41"),ys._replacements.set_item(";)","\ud83d\ude09"),ys._replacements.set_item(";-)","\ud83d\ude09"),ys._replacements.set_item(":D","\ud83d\ude00"),ys._replacements.set_item(":-D","\ud83d\ude00"),ys._replacements.set_item(":')","\ud83d\ude02"),ys._replacements.set_item("=D","\ud83d\ude03"),ys._replacements.set_item(":>","\ud83d\ude06"),ys._replacements.set_item(":->","\ud83d\ude06"),ys._replacements.set_item(":3","\ud83d\ude0a"),ys._replacements.set_item(":-3","\ud83d\ude0a"),ys._replacements.set_item("B-)","\ud83d\ude0e"),ys._replacements.set_item("*-*","\ud83d\ude0d"),ys._replacements.set_item(":*","\ud83d\ude19"),ys._replacements.set_item(":-*","\ud83d\ude19"),ys._replacements.set_item(":X","\ud83d\ude36"),ys._replacements.set_item(":-X","\ud83d\ude36"),ys._replacements.set_item(":O","\ud83d\ude2e"),ys._replacements.set_item(":-O","\ud83d\ude2e"),ys._replacements.set_item(":#","\ud83e\udd10"),ys._replacements.set_item(":-#","\ud83e\udd10"),ys._replacements.set_item(":P","\ud83d\ude1b"),ys._replacements.set_item(":-P","\ud83d\ude1b"),ys._replacements.set_item(";P","\ud83d\ude1c"),ys._replacements.set_item(";-P","\ud83d\ude1c"),ys._replacements.set_item(":-/","\ud83d\ude15"),ys._replacements.set_item("$-$","\ud83e\udd11"),ys._replacements.set_item(":S","\ud83d\ude16"),ys._replacements.set_item(":-S","\ud83d\ude16"),ys._replacements.set_item(":[","\ud83d\ude1f"),ys._replacements.set_item(":-[","\ud83d\ude1f"),ys._replacements.set_item(":\u2019(","\ud83d\ude22"),ys._replacements.set_item(":'(","\ud83d\ude22"),ys._replacements.set_item("@-@","\ud83d\ude31")},t.prototype.doGraphCorrection=function(e){var t=this;this.checkMatchAndCommit(cs.ParagraphReader.text(e).substring(this.get_matchStartIndex(),this.get_matchEndIndex()),(function(n,r,i){var o=_s.y.createTextRange(e,t.get_matchStartIndex()+n,t.get_matchStartIndex()+r),a={};a.MenuItemId=i,t._actionManager.processActionAgainstContext(o,ii.Ef,2,!1,null,a,null)}))},t.createGraphCorrectionAction=function(e,n,r,i,o,a){return new t(null,e,n,r,i,o,a)},t.createHtmlCorrectionAction=function(e,n,r,i,o,a){return new t(e,ms.y(e).get_sourceNode(),n,r,i,o,a)},t}(ys);(0,o.l)(Ss,"EmojiAction",ys,[]);var vs=function(){function e(e,t,n,r){this._contentStr=null,this._triggerKey=null,this._languageId=0,this._originalWord=null,this._contentStr=e,this._triggerKey=t,this._languageId=r,this._originalWord=n}return e.prototype.isParagraphBegin=function(){return!!this._originalWord&&(this._contentStr=this._contentStr.trimStart(),this._contentStr===this._originalWord)},e.prototype.isWordAfterTwoCharWithDotBetweenEach=function(){if(!this._contentStr)return!1;var e=this._contentStr.lastIndexOf(" ");return-1!==e&&"."===this._contentStr.charAt(e-1)&&"."===this._contentStr.charAt(e-3)},e.prototype.isWordAfterOneCharWithDot=function(){if(!this._contentStr)return!1;var e=this._contentStr.lastIndexOf(" ");if(-1!==e){var t=this._contentStr.substring(0,e-1).lastIndexOf(" ");if("."===this._contentStr.charAt(t+2))return!0}return!1},e.prototype.isOneLetterAfterWithDotAtParagraphHead=function(){return!(!this.isParagraphBegin()||(1!==this._originalWord.length||"."!==this._triggerKey)&&"."!==this._contentStr.charAt(1))},e.prototype.isOneLetterAfterwithSlash=function(){if(!this._originalWord)return!1;return"\\/".indexOf(this._triggerKey)>=0||3===this._originalWord.length&&"\\/".indexOf(this._originalWord.charAt(1))>=0},e.prototype.isMailAddress=function(){return!!this._originalWord&&this._originalWord.indexOf("@")>=0},e.prototype.isLink=function(){if(!this._originalWord)return!1;for(var t=0,n=e.get_linkableProtocolList();t<n.length;t++){var r=n[t];if(Jn.l.startsWith(this._originalWord+this._triggerKey,r))return!0}return!1},e.prototype.isLetterIWithQuote=function(){return!!this._originalWord&&("i"===this._originalWord&&e.quotes.indexOf(this._triggerKey)>=0)},e.prototype.isDaishorNorwegian=function(){return 1030===this._languageId||2068===this._languageId},e.prototype.isGreekSenteceEnd=function(){return!1},e.prototype.isCommonSentenceEndMark=function(){if(!this._contentStr)return!1;var t=Jn.l.lastIndexOfWhiteSpace(this._contentStr,this._contentStr.length-1);if(-1!==t&&this._contentStr.substring(t+1,this._contentStr.length)===this._originalWord){var n=this._contentStr.charAt(t-1);if(e.sentenceDelimiters.indexOf(n)>=0)return!0;if(e.quotes.indexOf(n)>=0){var r=this._contentStr.charAt(t-2);if(e.sentenceDelimiters.indexOf(r)>=0)return!0}}return!1},e.prototype.checkCurrentWordWithAutoCorrectConditions=function(){return!!this._contentStr&&(!(this.isWordAfterTwoCharWithDotBetweenEach()||this.isOneLetterAfterWithDotAtParagraphHead()||this.isOneLetterAfterwithSlash()||this.isWordAfterOneCharWithDot())&&(!this.isMailAddress()&&!this.isLink()&&(!!this.isParagraphBegin()||(!!this.isLetterIWithQuote()||!!this.isCommonSentenceEndMark()))))},e.get_linkableProtocolList=function(){return e._linkableProtocolListAutoCorrectDisabled||(e._linkableProtocolListAutoCorrectDisabled=["http:","https:","ftp://","mailto:","\\\\","www."])},e.sentenceDelimiters=".!?",e.quotes="'\"",e._linkableProtocolListAutoCorrectDisabled=null,e}();(0,o.l)(vs,"FirstLetterUpperCaseRules",null,[]);var bs=function(){function e(e){this._originalWord=null,this._originalWord=e}return e.prototype.fractionsAutoFormatedData=function(){if(!this._originalWord)return null;for(var t=0;t<e.get_fractionsList().length;t++)if(this._originalWord===e.get_fractionsList()[t])return e.get_fractionsAutoFormatedList()[t];return null},e.get_fractionsList=function(){return e._fractionsList||(e._fractionsList=["1/2","1/4","3/4"])},e.get_fractionsAutoFormatedList=function(){return e._fractionsAutoFormatedList||(e._fractionsAutoFormatedList=["\xbd","\xbc","\xbe"])},e._fractionsList=null,e._fractionsAutoFormatedList=null,e}();(0,o.l)(bs,"FractionsCollection",null,[]);var Ts=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n,r,i,a)||this;return s._characterPropertiesEditor$1=null,s._correctWord=null,s._correctWord=o,s._characterPropertiesEditor$1=a,s}return(0,S.t)(t,e),t.prototype.get_isGraphOnlyOperation=function(){return!0},t.prototype.get_commandId=function(){return ii.OO},t.prototype.get_correctWord=function(){return this._correctWord},t.prototype.doHtmlCorrection=function(e){e.innerText=Jn.l.substring(e.innerText,0,this.get_matchStartIndex())+this._correctWord+Jn.l.right(e.innerText,this.get_matchEndIndex())},t.prototype.doGraphCorrection=function(e){this._characterPropertiesEditor$1.replaceTextRange(_s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()),this._correctWord,!0,!1)},t.createGraphCorrectionAction=function(e,n,r,i,o){return new t(null,e,n,r,i,o)},t}(gs);(0,o.l)(Ts,"FractionsReplaceCorrectAction",gs,[]);var As=function(e){function t(t,n,r,i,o,a){return e.call(this,t,n,r,i,o,a)||this}return(0,S.t)(t,e),t.prototype.get_commandId=function(){return ii.WI},t.prototype.doGraphCorrection=function(e){if(this.get_listCommands()){var n=Da.GraphIterator.createFromNode(e);if(n.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(n),this.get_listEditor().shouldAutocorrectList(n)){var r=this.matchResults[0],i=Jn.l.isUpperCase(r.charAt(0)),o=t.numberFromLetterString(r),a=i?4:2,s=_s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()+1);this.get_listEditor().autocorrectNumberList(e,n,a,o,s,r,this.get_listCommands())}}},t.createGraphCorrectionAction=function(e,n,r,i,o,a){return new t(null,e,n,r,i,o)},t.createHtmlCorrectionAction=function(e,n,r,i,o,a){return new t(e,ms.y(e).get_sourceNode(),n,r,i,o)},t.numberFromLetterString=function(e){if(!e)return 0;var t=Jn.l.toLower(e);t.charAt(0);if(!Jn.l.isAlpha(t.charAt(0)))return 0;var n,r=t.charCodeAt(0)-"a".charCodeAt(0)+1;for(n=1;n<t.length&&t.charAt(n)===t.charAt(0);n++);return 26*(n-1)+r},t}(ps);(0,o.l)(As,"LetterListAction",ps,[]);var Is=n(2225),ws=function(e){function t(t,n,r,i,o,a){return e.call(this,t,n,r,i,o,a)||this}return(0,S.t)(t,e),t.prototype.get_commandId=function(){return ii.Wv},t.prototype.doGraphCorrection=function(e){if(this.get_listCommands()){var t=Da.GraphIterator.createFromNode(e);if(t.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(t),this.get_listEditor().shouldAutocorrectList(t)){var n=this.matchResults[0],r=parseInt(n);if(!(r>=99999999)){var i=_s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()+1);Is.o.isWordPredictionEnabled_Active()&&Is.o.handleAutoCorrection(),this.get_listEditor().autocorrectNumberList(e,t,1,r,i,n,this.get_listCommands())}}}},t.createGraphCorrectionAction=function(e,n,r,i,o,a){return new t(null,e,n,r,i,o)},t.createHtmlCorrectionAction=function(e,n,r,i,o,a){return new t(e,ms.y(e).get_sourceNode(),n,r,i,o)},t}(ps);(0,o.l)(ws,"NumberListAction",ps,[]);var xs=n(2314),Fs=function(e){function t(n,r,i,o,a){var s=e.call(this,n,r,i,o,a)||this;return t._characterPropertiesEditor$1=a,s}return(0,S.t)(t,e),t.prototype.get_isGraphOnlyOperation=function(){return!0},t.prototype.get_commandId=function(){return ii.Jv},t.prototype.doHtmlCorrection=function(e){},t.prototype.doGraphCorrection=function(e){var n=_s.y.createTextRange(e,this.get_matchEndIndex()-2,this.get_matchEndIndex()),r=new as.GraphTransaction(15);r.setFromNode(e);for(var i=!1,o=null,a=0;a<e.get_characterProperties().get_length();){var s=!!(c=e.get_characterProperties().get_item(a)).get_fieldRangeStart()||c.get_isStartOfOutermostField(),l=!!c.get_fieldRangeEnd()||c.get_isEndOfOutermostField();if(c.get_cp()>=n.get_cpBegin()){c.get_cp()>n.get_cpBegin()||!c.get_formatting()?o=i?c.get_formatting():t._characterPropertiesEditor$1.splitFormattingAtChpIndexAndUpdateWordRunProperties(e,a,n.get_cpBegin(),o):(o=c.get_formatting(),l&&(i=!1),s&&(i=!0)),a++;break}c.get_formatting()&&(o=c.get_formatting()),l&&(i=!1),s&&(i=!0),a++}for(;a<e.get_characterProperties().get_length();){var c;if((c=e.get_characterProperties().get_item(a)).get_cp()>=n.get_cpEnd()){(c.get_cp()>n.get_cpEnd()||!c.get_formatting()&&!c.get_isEndOfParagraph())&&(i||t._characterPropertiesEditor$1.splitFormattingAtChpIndexAndUpdateWordRunProperties(e,a,n.get_cpEnd(),o)),i||t.get_formattingEditor().setSuperscript(o,!0);break}c.get_formatting()&&(i||t.get_formattingEditor().setSuperscript(o,!0),o=c.get_formatting());s=!!c.get_fieldRangeStart()||c.get_isStartOfOutermostField(),l=!!c.get_fieldRangeEnd()||c.get_isEndOfOutermostField();s&&(i=!0),!s&&l&&(i=!1),a++}r.dispose()},t.get_formattingEditor=function(){return t._formattingEditor||(t._formattingEditor=se.w.get_instance().resolve(xs.z))},t.createGraphCorrectionAction=function(e,n,r,i){return new t(null,e,n,r,i)},t._characterPropertiesEditor$1=null,t._formattingEditor=null,t}(gs);(0,o.l)(Fs,"OrdinalsReplaceCorrectAction",gs,[]);var Es=n(5609),Ps=n(9489),ks=n(8234),Ds=function(e){function t(n,r,i,o,a,s){var l=e.call(this,n,r,i,o,a,s)||this;return l._characterPropertiesEditor$2=null,t._randSentence||t.staticConstructor(),l._characterPropertiesEditor$2=s,l}return(0,S.t)(t,e),t.prototype.get_commandId=function(){return ii.YL},t.prototype.doGraphCorrection=function(e){if(!e.get_hasContentControl()){var n=this._graphSelection.get_firstContext().get_node()===e,r=-1,i=3;if(this.matchResults[2]&&(r=parseInt(this.matchResults[2])),this.matchResults[1]&&(i=parseInt(this.matchResults[1])),!(r>20||i>100)){e.getGraphSpace().get_graphTransactionOperations().blockRttSend(7);var o=Da.GraphIterator.createFromNode(e);o.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(o),t.get_outlineElementEditor().insertOutlineElementAsSibling(o,!1,!1),t.get_outlineElementEditor().createParagraph(o);for(var a=0;a<i;++a){for(var s=[],l=a%t._randSentence.length,c=r>0?r:t._randSentence[l].length,u=0;u<c;++u)Array.add(s,t._randSentence[l][u%t._randSentence[l].length]);var g=_s.y.createIpContext(o.get_currentNode(),0),p=Ps.FormattingReader.getFormattingObject(g);2!==Br.App.get_mode()?t.get_formattingEditor().setLanguageOnParagraph(p,1142):t.get_formattingEditor().setTextProperty(p,ks.j.noProof,!0),this._characterPropertiesEditor$2.replaceTextRange(g,s.join(" "),!0,!1),a<i-1&&(hs.OutlineElementNavigator.returnToOutlineElement(o),t.get_outlineElementEditor().insertOutlineElementAsSibling(o,!1,!1),t.get_outlineElementEditor().createParagraph(o))}var d=o.get_currentNode();(o=Da.GraphIterator.createFromNode(e)).tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(o),o.disconnectNodeAndReturnToParent(),n&&(this._graphSelection=ss.SelectionFactory.createIpSelection(d,cs.ParagraphReader.textLength(d)))}}},t.get_outlineElementEditor=function(){return t._outlineElementEditor||(t._outlineElementEditor=se.w.get_instance().resolve(Es.p))},t.get_formattingEditor=function(){return t._formattingEditor||(t._formattingEditor=se.w.get_instance().resolve(xs.z))},t.staticConstructor=function(){t._randSentence=[["Lorem ipsum dolor sit amet, consectetuer adipiscing elit.","Maecenas porttitor congue massa.","Fusce posuere, magna sed pulvinar ultricies, purus lectus malesuada libero, sit amet commodo magna eros quis urna."],["Nunc viverra imperdiet enim.","Fusce est.","Vivamus a tellus."],["Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas.","Proin pharetra nonummy pede.","Mauris et orci."]]},t.createGraphCorrectionAction=function(e,n,r,i,o,a){return new t(null,e,n,r,i,o)},t.createHtmlCorrectionAction=function(e,n,r,i,o,a){return new t(e,ms.y(e).get_sourceNode(),n,r,i,o)},t._randSentence=null,t._outlineElementEditor=null,t._formattingEditor=null,t}(ps);(0,o.l)(Ds,"RandAction",ps,[]);var Ms=function(){return function(e,t,n,r){this.pattern=null,this.htmlFactoryMethod=null,this.graphFactoryMethod=null,this.flags=0,this.pattern=8&r?new RegExp(e,"i"):new RegExp(e),this.htmlFactoryMethod=t,this.graphFactoryMethod=n,this.flags=r}}();(0,o.l)(Ms,"RegexAutoCorrectEntry",null,[]);var Rs=function(e){function t(t,n,r,i,o,a){return e.call(this,t,n,r,i,o,a)||this}return(0,S.t)(t,e),t.prototype.get_commandId=function(){return ii.Iv},t.prototype.doGraphCorrection=function(e){if(this.get_listCommands()){var n=Da.GraphIterator.createFromNode(e);if(n.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(n),this.get_listEditor().shouldAutocorrectList(n)){var r=this.matchResults[0],i=Jn.l.substring(r,0,r.indexOf(".")),o=t.numberFromRomanString(i);if(!(o<=0)){var a=Jn.l.isUpperCase(r.charAt(0))?5:3,s=_s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()+1);this.get_listEditor().autocorrectNumberList(e,n,a,o,s,r,this.get_listCommands())}}}},t.createGraphCorrectionAction=function(e,n,r,i,o,a){return new t(null,e,n,r,i,o)},t.createHtmlCorrectionAction=function(e,n,r,i,o,a){return new t(e,ms.y(e).get_sourceNode(),n,r,i,o)},t.ensureRomanValues=function(){t._romanValues||(t._romanValues={},t._romanValues.M=1e3,t._romanValues.D=500,t._romanValues.C=100,t._romanValues.L=50,t._romanValues.X=10,t._romanValues.V=5,t._romanValues.I=1)},t.numberFromRomanString=function(e){if(!e)return 0;t.ensureRomanValues();for(var n=Jn.l.toUpper(e),r=0,i=0,o=n.length-1;o>=0;o--){var a=t._romanValues[Jn.l.charAt(n,o).toString()];i=a<r?i-a:i+a,r=a}return i},t._romanValues=null,t}(ps);(0,o.l)(Rs,"RomanListAction",ps,[]);var Ls=n(8370),Ns=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n,r,r+1,a)||this;return s._characterPropertiesEditor$1=null,s._typedChar=null,s._correctedQuote=null,s._characterPropertiesEditor$1=a,s._typedChar=i,s._correctedQuote=o,s.set_needToCheckOriginalString(!1),s}return(0,S.t)(t,e),t.prototype.get_isGraphOnlyOperation=function(){return!1},t.prototype.get_commandId=function(){return ii.lt},t.prototype.doHtmlCorrection=function(e){e.innerText=Jn.l.substring(e.innerText,0,this.get_matchStartIndex())+this._correctedQuote+Jn.l.right(e.innerText,this.get_matchEndIndex())},t.prototype.doGraphCorrection=function(e){this._characterPropertiesEditor$1.replaceTextRange(_s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()),this._typedChar,!0,!1),this._characterPropertiesEditor$1.replaceTextRange(_s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchStartIndex()+1),this._correctedQuote,!0,!1)},t.createGraphCorrectionAction=function(e,n,r,i,o,a){if("'"!==r&&'"'!==r)return null;var s=Da.GraphIterator.createFromNode(e);if(s.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(s),Ls.OutlineElementReader.isRtlForView(s.get_currentNode()))return null;var l="'"===r;return new t(a,e,n,r+"",!n||Jn.l.isWhitespaceUnicode(i)||-1!==Array.indexOf(t.openBrackets,i)?l?"\u2018":"\u201c":l?"\u2019":"\u201d",o)},t.openBrackets=["[","{","("],t}(gs);(0,o.l)(Ns,"SmartQuoteCorrectAction",gs,[]);var Bs=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n,r,i,a)||this;return s._characterPropertiesEditor$1=null,s._correctWord=null,s._correctWord=o,s._characterPropertiesEditor$1=a,s}return(0,S.t)(t,e),t.prototype.get_isGraphOnlyOperation=function(){return t._isGraphOnlyOperation},t.prototype.set_isGraphOnlyOperation=function(e){return t._isGraphOnlyOperation=e,e},t.prototype.get_commandId=function(){return ii.Es},t.prototype.validateAction=function(){return this._lastValidateResultIsMatchTextSame=this.checkMatchTextIsTheSame(),this._lastValidateResultIsMatchTextSame||(this._lastValidateResultIsValid=!1,this._invalidReason="MatchTextIsNotTheSame"),this._lastValidateResultIsValid},t.prototype.doHtmlCorrection=function(e){e.innerText=Jn.l.substring(e.innerText,0,this.get_matchStartIndex())+this._correctWord+Jn.l.right(e.innerText,this.get_matchEndIndex())},t.prototype.doGraphCorrection=function(e){this._characterPropertiesEditor$1.replaceTextRange(_s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchEndIndex()),this._correctWord,!0,!1)},t.createHtmlCorrectionAction=function(e,n,r,i,o){var a=ms.y(e);return new t(e,a?a.get_sourceNode():null,n,r,i,o)},t.createGraphCorrectionAction=function(e,n,r,i,o){return new t(null,e,n,r,i,o)},t._isGraphOnlyOperation=!1,t}(gs);(0,o.l)(Bs,"StringReplaceCorrectAction",gs,[]);var Os=function(e){function t(t,n,r,i,o,a,s,l){var c=e.call(this,t,n,r,i,o)||this;return c._characterPropertiesEditor$1=null,c._lockedRangeEditor=null,c._isLockedRangesEnabled=!1,c._trackChangeReader=null,c._characterPropertiesEditor$1=o,c._lockedRangeEditor=a,c._isLockedRangesEnabled=s,c._trackChangeReader=l,c}return(0,S.t)(t,e),t.prototype.get_isGraphOnlyOperation=function(){return!0},t.prototype.get_commandId=function(){return ii.sY},t.prototype.doHtmlCorrection=function(e){var t=Jn.l.substring(e.innerText,this.get_matchStartIndex(),this.get_matchEndIndex());t.charAt(0)!==t.charAt(0).toUpperCase()&&(t=t.charAt(0).toUpperCase()+t.substring(1,t.length)),e.innerText=Jn.l.substring(e.innerText,0,this.get_matchStartIndex())+t+Jn.l.right(e.innerText,this.get_matchEndIndex())},t.prototype.doGraphCorrection=function(e){var t=this.get_matchStartIndex(),n=this.get_matchStartIndex()+1,r=e.get_characterData().substring(t,n).charAt(0);if(!Jn.l.isUpperCase(r)){var i=_s.y.createTextRange(e,t,n);this.isContextInLockedRange(i)||this._trackChangeReader&&this._trackChangeReader.isTextRangeInsideDeletionChange(e,t,n)||this._characterPropertiesEditor$1.replaceTextRange(i,r.toUpperCase().toString(),!0,!1)}},t.prototype.isContextInLockedRange=function(e){return!!this._isLockedRangesEnabled&&(!!this._lockedRangeEditor&&this._lockedRangeEditor.isIpOrTextRangeContextInLockedRange(e))},t.createHtmlCorrectionAction=function(e,n,r,i){var o=ms.y(e);return new t(e,o?o.get_sourceNode():null,n,r,i,null,!1,null)},t.createGraphCorrectionAction=function(e,n,r,i,o,a,s){return new t(null,e,n,r,i,o,a,s)},t}(gs);(0,o.l)(Os,"UpperFirstLetterAutoCorrect",gs,[]);var Us=function(){function e(e,t){this._languageId=0,this._originalWord=null,this._languageId=t,this._originalWord=e}return e.prototype.validateDataInOriginalWord=function(){var e=Number.parseInvariant(this._originalWord.substring(0,this._originalWord.length-2));switch(Number.parseInvariant(this._originalWord.charAt(this._originalWord.length-3).toString())){case 1:return 11===e?"th":"st";case 2:return 12===e?"th":"nd";case 3:return 13===e?"th":"rd";case 4:case 5:case 6:case 7:case 8:case 9:case 0:return"th";default:return""}},e.prototype.isOrdinalNumber=function(){var t=Kt.i.getCultureInfo(this._languageId);if(!t||!t.get_name().toLowerCase().startsWith("en"))return!1;if(!this._originalWord)return!1;if(this._originalWord.length<=2)return!1;for(var n=0;n<e.get_ordinalNumberSuffixList().length;n++)if(this._originalWord.toLowerCase().endsWith(e.get_ordinalNumberSuffixList()[n])){var r=this._originalWord.substr(0,this._originalWord.length-2);if(new RegExp("^\\d+$").test(r)){var i=this.validateDataInOriginalWord();if(this._originalWord.toLowerCase().endsWith(e.get_ordinalNumberSuffixList()[n])&&i===e.get_ordinalNumberSuffixList()[n])return!0}break}return!1},e.get_ordinalNumberSuffixList=function(){return e._ordinalNumberSuffix||(e._ordinalNumberSuffix=["st","nd","rd","th"])},e._ordinalNumberSuffix=null,e}();(0,o.l)(Us,"ValidateOrdinalsRule",null,[]);var Hs=n(7384),Gs=function(){function e(e,t,n,r,i,o,a){this._hyperlinkActionFactory=null,this._characterPropertiesEditor=null,this._lockedRangeEditor=null,this._actionManager=null,this._emoticonAutoCorrectIsEnabled=!1,this._replaceQuoteWithSmartQuoteIsEnabled=!1,this._hyperlinkUrlValidationIsEnabled=!1,this._autoCorrectOptionsInfo=null,this._trackChangeReader=null,this._regexEntries=[],this._autoCorrectLists=[],this._autoCorrectExceptions=[],this._autoCorrectListLoaded=[],this._incomingListLcid=-1,this._hyperlinkActionFactory=e,this._characterPropertiesEditor=t,this._lockedRangeEditor=n,this._actionManager=r,this._autoCorrectOptionsInfo=o,this._trackChangeReader=a,i?(this._emoticonAutoCorrectIsEnabled=i.getBooleanAppSetting("WordEditorEmoticonAutoCorrectIsEnabled")||i.getBooleanAppSetting("OneNoteInsertEmojiIsEnabled"),this._replaceQuoteWithSmartQuoteIsEnabled=i.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled"),this._hyperlinkUrlValidationIsEnabled=i.getBooleanAppSetting("HyperlinkUrlValidationIsEnabled"),C.ULS.sendTraceTag(23418953,324,50,"{0}",{WordEditorEmoticonAutoCorrectIsEnabled:this._emoticonAutoCorrectIsEnabled,ReplaceQuoteWithSmartQuoteIsEnabled:this._replaceQuoteWithSmartQuoteIsEnabled})):(C.ULS.sendTraceTag(23418954,324,50,"appSettingsManager is null.  Auto correct is disabled for: emoticons and smart quotes."),this._emoticonAutoCorrectIsEnabled=!1,this._replaceQuoteWithSmartQuoteIsEnabled=!1)}return e.prototype.isDelimiter=function(t){return e.autoCorrectDelimiters.indexOf(t)>=0},e.prototype.isTrigger=function(t){return e.autoCorrectTiggers.indexOf(t)>=0},e.prototype.isLowerCase=function(e){return e.toLowerCase()===e},e.prototype.isUpperCase=function(e){return e.toUpperCase()===e},e.prototype.isAlpha=function(e){return e.toLowerCase()!==e.toUpperCase()},e.prototype.isFirstLetterNeedUpper=function(e,t,n,r){return new vs(e,t,n,r).checkCurrentWordWithAutoCorrectConditions()},e.prototype.getCultureOfElement=function(e){do{if(e.getAttribute("xml:lang"))return Kt.i.getCultureInfo(e.getAttribute("xml:lang"))||Kt.i.get_invariantCulture();if(e.getAttribute("lang"))return Kt.i.getCultureInfo(e.getAttribute("lang"))||Kt.i.get_invariantCulture();e=e.parentNode}while(e&&e.nodeType===Ya.o.element);return Kt.i.get_invariantCulture()},e.prototype.getCultureOfContext=function(e){return Kt.i.getCultureInfo(Ps.FormattingReader.language(Ps.FormattingReader.getFormattingObject(e)))||Kt.i.get_invariantCulture()},e.prototype.findLastIndexOfDelimiter=function(t,n){n<0&&(n=0);for(var r=-1,i=e.autoCorrectDelimiters.length,o=0;o<i;++o){var a=t.lastIndexOf(Jn.l.charAt(e.autoCorrectDelimiters,o),n);a>r&&(r=a)}var s=Jn.l.lastIndexOfWhiteSpace(t,n);return s>r&&(r=s),r},e.prototype.findFirstAlphaChar=function(e){for(var t=0;t<e.length;++t)if(this.isAlpha(Jn.l.charAt(e,t)))return t;return-1},e.prototype.findWordStartIndexAtCp=function(e,t){if(!e||t<0)return-1;var n=t;return n=(n=n?this.findLastIndexOfDelimiter(e,n-1):-1)>Jn.l.lastIndexOfWhiteSpace(e,t-1)?n:Jn.l.lastIndexOfWhiteSpace(e,t-1),++n},e.prototype.findStringMatch=function(e,t,n){if(!us.n.get_instance().get_item(70))return null;if(this.ensureAutoCorrectListLoaded(t),!this._autoCorrectLists[t]){var r=es.getFallbackLcid(t);if(!(r>0))return null;if(this.ensureAutoCorrectListLoaded(r),!this._autoCorrectLists[r])return null;t=r}if(n){var i=e;if(i+=n,this._autoCorrectExceptions[t]&&Array.contains(this._autoCorrectExceptions[t],i))return null}var o=this._autoCorrectLists[t][Jn.l.toLower(e)];if("string"!=typeof o)return null;var a=o;if(a===e)return null;if(a){var s=this.findFirstAlphaChar(e);if(s<0)return a;var l=Jn.l.charAt(e,s);if(this.isLowerCase(l))return a;for(var c=!0,u=s+1;u<e.length;++u){var g=Jn.l.charAt(e,u);c&&!this.isUpperCase(g)&&(c=!1)}return c?Jn.l.toUpper(a):Jn.l.toUpper(Jn.l.substring(a,0,1))+Jn.l.right(a,1)}return null},e.prototype.findHtmlAutoCorrectMatch=function(t,n,r,i){Xi.t.mark(4666);var o=this.getCultureOfElement(n).get_LCID(),a=0,s=t,l=n.innerText,c=l.lastIndexOf(" ",t);if(this.isExemption(l.substring(c+1,t)))return Xi.t.mark(4667),null;var u=null,g=!1;do{if(-1===(s=s?this.findLastIndexOfDelimiter(l,s-1):-1)&&!r){var p=n,d=null;if(!this.isDelimiter(l.charAt(0))){do{for(;p&&!p.previousSibling;)p=p.parentNode;p&&(d=(p=p.previousSibling).innerText)}while(p&&!d);if(p&&d&&!this.isDelimiter(Jn.l.charAt(d,d.length-1)))return Xi.t.mark(4667),null}g=!0}var h=Jn.l.substring(l,s+1,t);++a;var _=this.findStringMatch(h,o,i.toString());if(_)u=Bs.createHtmlCorrectionAction(n,s+1,t,_,this._characterPropertiesEditor);else for(var m=0;m<this._regexEntries.length;++m){var f=this._regexEntries[m];if((!(1&f.flags)||r&&s<1)&&!(4&f.flags)&&(!(2&f.flags)||" "===i)){var y=f.pattern.exec(h);if(y){u=f.htmlFactoryMethod(n,s+1,t,y,this._characterPropertiesEditor,this._actionManager);break}}}}while(!g&&!u&&a<e.maxAutoCorrectEntryDelimiterCount&&s>=0);return Xi.t.mark(4667),u},e.prototype.findGraphFirstWordToUpper=function(e,t,n,r){var i=e.get_node(),o=cs.ParagraphReader.text(i);t<0&&(t=e.get_cpBegin());var a=this.getCultureOfContext(e).get_LCID();if(n&&!this.isDelimiter(Jn.l.charAt(o,t)))return null;var s=Jn.l.lastIndexOfWhiteSpace(o,t);if(this.isExemption(o.substring(s+1,t)))return null;for(var l=-1,c=Hs.HyperlinkReader.getHyperlinksInParagraph(i),u=0;u<c.length;u++){if(!(t>c[u].cpEnd)){if(t>c[u].cpBegin)return null;break}l=c[u].cpEnd}var g=null,p=t;(p=p?this.findLastIndexOfDelimiter(o,p-1):-1)<l&&(p=l-1);var d=Jn.l.substring(o,p+1,t);if(d=d.trimStart(),p<1)for(u=0;u<this._regexEntries.length;++u){var h=o;if(" "!==r&&(h=o+r),this._regexEntries[u].pattern.exec(h))return null}return o=o.substring(0,t),this.isFirstLetterNeedUpper(o,r.toString(),d,a)?(d.charAt(0).toUpperCase()!==d.charAt(0)&&(g=Os.createGraphCorrectionAction(i,p+1,t,this._characterPropertiesEditor,this._lockedRangeEditor,us.n.get_instance().get_item(14),this._trackChangeReader)),g):null},e.prototype.findGraphFirstLetterUpperAtEnd=function(e,t,n){var r=ss.SelectionFactory.createCollapsedSelection(e,!1);if(!r)return null;var i=r.get_lastContext();return Pa.SelectionEditor.isInsertionPointContext(i)?this.findGraphFirstWordToUpper(i,t,!1,n):null},e.prototype.isExemption=function(e){return Jn.l.isLinkable(e)},e.prototype.findGraphAutoCorrectMatch=function(t,n,r,i){Xi.t.mark(4666);var o=t.get_node(),a=this.getCultureOfContext(t).get_LCID(),s=cs.ParagraphReader.text(o);if(n<0&&(n=t.get_cpBegin()),r&&!this.isDelimiter(Jn.l.charAt(s,n)))return Xi.t.mark(4667),null;var l=Jn.l.lastIndexOfWhiteSpace(s,n);if(this.isExemption(s.substring(l+1,n)))return Xi.t.mark(4667),null;for(var c=-1,u=Hs.HyperlinkReader.getHyperlinksInParagraph(o),g=0;g<u.length;g++){if(!(n>u[g].cpEnd)){if(n>u[g].cpBegin)return null;break}c=u[g].cpEnd}var p=0,d=n,h=null;do{(d=d?this.findLastIndexOfDelimiter(s,d-1):-1)<c&&(d=c-1);var _=Jn.l.substring(s,d+1,n);++p;var m=this.findStringMatch(_,a,null);if(m)this._autoCorrectOptionsInfo.get_replaceTextAsYouType()&&(h=Bs.createGraphCorrectionAction(o,d+1,n,m,this._characterPropertiesEditor));else for(g=0;g<this._regexEntries.length;++g){var f=this._regexEntries[g];if(!(1&f.flags&&!(d<1)||4&f.flags&&i!==Je.v.vK_Enter||2&f.flags&&i!==Je.v.vK_Space)){var y=f.pattern.exec(_);if(y){((h=f.graphFactoryMethod(o,d+1,n,y,this._characterPropertiesEditor,this._actionManager)).get_commandId()!==ii.sE&&!this._autoCorrectOptionsInfo.get_replaceTextAsYouType()||h.get_commandId()===ii.sE&&!this._autoCorrectOptionsInfo.get_replaceHyphensWithDash())&&(h=null);break}}}}while(d>=0&&d>=c&&!h&&p<e.maxAutoCorrectEntryDelimiterCount);return Xi.t.mark(4667),h},e.prototype.findGraphAutoCorrectMatchAtEnd=function(e,t,n){var r=ss.SelectionFactory.createCollapsedSelection(e,!1);if(!r)return null;var i=r.get_lastContext();return Pa.SelectionEditor.isInsertionPointContext(i)?this.findGraphAutoCorrectMatch(i,t,!1,n):null},e.prototype.findLinkAutoCorrectMatchAtIdx=function(t,n){var r=ss.SelectionFactory.createCollapsedSelection(t,!1);if(!r)return null;var i=r.get_lastContext();if(!Pa.SelectionEditor.isInsertionPointContext(i))return null;if(Hs.HyperlinkReader.isIpInHyperlink(i,!1))return null;var o=cs.ParagraphReader.text(i.get_node()),a=n>0?Jn.l.lastIndexOfWhiteSpace(o,n-1)+1:Jn.l.lastIndexOfWhiteSpace(o,o.length-1)+1,s=n>0?n:o.length,l=Jn.l.substring(o,a,s);return l?this._hyperlinkUrlValidationIsEnabled&&!Hs.HyperlinkReader.isValidUrl(l)?null:(Jn.l.isLinkable(l)||Jn.l.isEmail(l))&&e.get_hyperlinkEditor().removeOverlappingHyperlink(i,a,s)?this._hyperlinkActionFactory.createHyperlinkAction(null,i.get_node(),a,s):null:null},e.prototype.findOrdinalNumberAutoCorrectAction=function(t,n){var r=ss.SelectionFactory.createCollapsedSelection(t,!1);if(!r)return null;var i=r.get_lastContext();if(!Pa.SelectionEditor.isInsertionPointContext(i))return null;n<0&&(n=i.get_cpBegin());for(var o=cs.ParagraphReader.text(i.get_node()),a=this.findWordStartIndexAtCp(o,n),s=e.autoCorrectTiggers.length,l=0;l<s;++l){var c=o.lastIndexOf(Jn.l.charAt(e.autoCorrectTiggers,l),n-1);c>a&&(a=c+1)}var u=Jn.l.substring(o,a,n);if(!u)return null;var g=this.getCultureOfContext(i).get_LCID();return new Us(u,g).isOrdinalNumber()?Fs.createGraphCorrectionAction(t,a,n,this._characterPropertiesEditor):null},e.prototype.findFractionsAutoCorrectAction=function(e,t){var n=ss.SelectionFactory.createCollapsedSelection(e,!1);if(!n)return null;var r=n.get_lastContext();if(!Pa.SelectionEditor.isInsertionPointContext(r))return null;t<0&&(t=r.get_cpBegin());var i=cs.ParagraphReader.text(r.get_node()),o=this.findWordStartIndexAtCp(i,t),a=Jn.l.substring(i,o,t);if(!a)return null;var s=new bs(a).fractionsAutoFormatedData();return s?Ts.createGraphCorrectionAction(e,o,t,s,this._characterPropertiesEditor):null},e.prototype.findSmartQuoteAutoCorrectAction=function(e,t,n,r,i){var o=ss.SelectionFactory.createCollapsedSelection(e,!1);if(!o)return null;var a=o.get_lastContext();if(n>t)return null;if(!Pa.SelectionEditor.isInsertionPointContext(a))return null;if(t<0&&(t=a.get_cpBegin()),t<0)return null;var s=cs.ParagraphReader.text(a.get_node()),l=i,c=t?s.charAt(t-1):"\0";return Ns.createGraphCorrectionAction(e,n,l,c,this._characterPropertiesEditor,r)},e.prototype.addRegexPatternEntry=function(e,t,n,r){Array.add(this._regexEntries,new Ms("^"+e+"$",t,n,r))},e.prototype.mergeAutoCorrectLists=function(e){if(this._autoCorrectLists[this._incomingListLcid]){var t=this._autoCorrectLists[this._incomingListLcid];for(var n in e){var r={key:n,value:e[n]};t[r.key]=r.value}}else this._autoCorrectLists[this._incomingListLcid]=e},e.prototype.mergeExceptions=function(e){this._autoCorrectExceptions[this._incomingListLcid]?Array.addRange(this._autoCorrectExceptions[this._incomingListLcid],e):this._autoCorrectExceptions[this._incomingListLcid]=e},e.prototype.loadAutoCorrectList=function(e,t){var n=this;this._autoCorrectListLoaded[t]||(this._autoCorrectListLoaded[t]=!0,L.AFrameworkApplication.theClientRequestManager.addRequest(e,1,null,null,!1,3,(function(e){n._incomingListLcid=t;try{(0,Xa.v)(e.get_data().responseData)}catch(t){C.ULS.sendTraceTag(5898336,324,50,"Failed to parse autocorrect: {0}",{ResponseData:e.get_data()?e.get_data().responseData:""})}n._incomingListLcid=-1}),(function(){n.ensureFallbackAutoCorrectListLoaded(t)}),null,void 0,void 0,void 0,void 0,"27"))},e.prototype.ensureFallbackAutoCorrectListLoaded=function(e){var t=es.getFallbackLcid(e);t>0&&this.ensureAutoCorrectListLoaded(t)},e.prototype.loadDefaultAutoCorrectList=function(){us.n.get_instance().get_item(70)&&(this.ensureAutoCorrectListLoaded(1033),this.addRegexPatternEntry("=rand\\((?:(\\d+)(?:, ?(\\d+))?)?\\)",Ds.createHtmlCorrectionAction,Ds.createGraphCorrectionAction,5),this.addRegexPatternEntry("(\\d+)\\.",ws.createHtmlCorrectionAction,ws.createGraphCorrectionAction,3),this.addRegexPatternEntry("(L|l|C|c|D|d|M|m){1}\\.",As.createHtmlCorrectionAction,As.createGraphCorrectionAction,3),this.addRegexPatternEntry("^M{0,4}(CM|CD|D?C{0,3})(XC|XL|L?X{0,3})(IX|IV|V?I{0,3})\\.",Rs.createHtmlCorrectionAction,Rs.createGraphCorrectionAction,11),this.addRegexPatternEntry("([A-Za-z]){1}\\.",As.createHtmlCorrectionAction,As.createGraphCorrectionAction,3),this.addRegexPatternEntry("[\\*|-]",fs.createHtmlCorrectionAction,fs.createGraphCorrectionAction,3),this.addRegexPatternEntry("[\\w\\d]+( ?\\-{1,2} ?)[\\w\\d]+",Cs.createHtmlCorrectionAction,Cs.createGraphCorrectionAction,0),this._emoticonAutoCorrectIsEnabled&&(this.addRegexPatternEntry("(?:.*)([\\:\\;\\=][\\'\\-]??[DOPSX3>\\(\\)\\*#\\|\\[\\/])",Ss.createHtmlCorrectionAction,Ss.createGraphCorrectionAction,0),this.addRegexPatternEntry("(?:.*)([\\@\\*\\$][\\-][\\@\\*\\$])",Ss.createHtmlCorrectionAction,Ss.createGraphCorrectionAction,0)))},e.prototype.ensureAutoCorrectListLoaded=function(e){this._autoCorrectListLoaded[e]||this.loadAutoCorrectList(Za.f.box4Script(String.format("Acl/Acl{0}.js",e)),e)},e.get_hyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=se.w.get_instance().resolve(Ja.o))},e.autoCorrectDelimiters=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\xa9\xae\u2122\ufffc\uc2a0\u2013\u2014",e.autoCorrectTiggers=" ,;:()[]{}<>\"'-~`@#$%^&*_+=|\xa9\xae\u2122\ufffc\uc2a0\u2013\u2014/\\.!?\"'",e.sentenceDelimiters=".!?",e.maxAutoCorrectEntryDelimiterCount=5,e._hyperlinkEditor=null,e}();(0,o.l)(Gs,"AutoCorrectRules",null,[Ha.r]);var Vs=(0,o.y)("IAutoCorrectMatchActionRegistration"),Ws=n(373),zs=n(704),Ks=function(){function e(e,t,n,r,i,a){this._autoCorrectRules=null,this._pendingAutoCorrectActions=null,this._selectionManager=null,this._autoCorrectForFirstLetterEnabled=!1,this._activityManager=null,this._autoFormatOrdinalNumberAndFractionsEnabled=!1,this._replaceQuoteWithSmartQuoteIsEnabled=!1,this._optionsInfo=null,this._allowAutoCorrectUndoByBackspace=!1,this._undoManager=null,this._registeredMatchActions=null,this._nextTokenForRegisteringMatch=0,this._lastUndoableActionCommandId=null,this._autoCorrectRules=e,this._selectionManager=t,this._activityManager=n,this._autoCorrectForFirstLetterEnabled=r.getBooleanAppSetting("AutoCorrectFirstLetterUpperCaseEnabled"),this._autoFormatOrdinalNumberAndFractionsEnabled=r.getBooleanAppSetting("AutoFormatOrdinalNumberAndFractionsEnabled"),this._replaceQuoteWithSmartQuoteIsEnabled=r.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled"),this._optionsInfo=i,this._allowAutoCorrectUndoByBackspace=!!a,this._undoManager=a,this._registeredMatchActions=new Ws.u(Vs),this._allowAutoCorrectUndoByBackspace&&this._selectionManager.add_processSetSelectionFinished(o.i(this,this.onSetSelectionFinished,"onSetSelectionFinished"))}return e.prototype.tryToAutocorrectAtTextBreak=function(e,t,n){if(void 0===n&&(n=-1),this._optionsInfo.get_replaceTextAsYouType()||this._optionsInfo.get_replaceHyphensWithDash()){var r=this._autoCorrectRules.findLinkAutoCorrectMatchAtIdx(e,n)||this._autoCorrectRules.findGraphAutoCorrectMatchAtEnd(e,n,t);r&&(this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new zs.r),this._pendingAutoCorrectActions.addAction(r))}if(this._autoCorrectForFirstLetterEnabled&&this._optionsInfo.get_capitalizeFirstLetterOfSentences()){var i=this._autoCorrectRules.findGraphFirstLetterUpperAtEnd(e,n," ");i&&(this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new zs.r),this._pendingAutoCorrectActions.get_listLength()>0&&(this._pendingAutoCorrectActions.getAction(0).set_isGraphOnlyOperation(!0),i.set_needToCheckOriginalString(!1)),this._pendingAutoCorrectActions.addAction(i))}if(this._autoFormatOrdinalNumberAndFractionsEnabled){if(this._optionsInfo.get_replaceOrdianalsWithSuperscript()&&4!==Br.App.get_mode()){var o=this._autoCorrectRules.findOrdinalNumberAutoCorrectAction(e,n);o&&(this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new zs.r),this._pendingAutoCorrectActions.addAction(o),C.ULS.sendTraceTag(8271383,324,50,"Ordinal number autoformat action is created."))}if(this._optionsInfo.get_replaceFractionsWithFractionCharacter()){var a=this._autoCorrectRules.findFractionsAutoCorrectAction(e,n);a&&(this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new zs.r),this._pendingAutoCorrectActions.addAction(a),C.ULS.sendTraceTag(8271384,324,50,"Fractions autoformat action is created."))}}},e.prototype.createAutoCorrectMatchActions=function(e,t,n,r,i,o){var a=new zs.r;if(t>0){if(!this._autoCorrectForFirstLetterEnabled&&this._optionsInfo.get_replaceTextAsYouType()){var s=this._autoCorrectRules.findHtmlAutoCorrectMatch(n,r,i,o);s&&a.addAction(s)}else{if(this._optionsInfo.get_replaceTextAsYouType()||this._optionsInfo.get_replaceHyphensWithDash()){var l=0;" "===o&&(l=Je.v.vK_Space);var c=null;(c=this._autoCorrectRules.findGraphAutoCorrectMatchAtEnd(e,t,l))&&(c.set_isGraphOnlyOperation(!0),a.addAction(c))}if(this._optionsInfo.get_capitalizeFirstLetterOfSentences()){var u=null;(u=this._autoCorrectRules.findGraphFirstLetterUpperAtEnd(e,t,o))&&(a.get_listLength()>0&&u.set_needToCheckOriginalString(!1),a.addAction(u))}}if(this._autoFormatOrdinalNumberAndFractionsEnabled){if(this._optionsInfo.get_replaceOrdianalsWithSuperscript()&&4!==Br.App.get_mode()){var g=this._autoCorrectRules.findOrdinalNumberAutoCorrectAction(e,t);g&&(a.addAction(g),C.ULS.sendTraceTag(8704786,324,50,"Ordinal number autoformat action is created."))}if(this._optionsInfo.get_replaceFractionsWithFractionCharacter()){var p=this._autoCorrectRules.findFractionsAutoCorrectAction(e,t);p&&(a.addAction(p),C.ULS.sendTraceTag(8271385,324,50,"Fractions autoformat action is created."))}}}if(t>=0&&("'"===o||'"'===o)&&this._replaceQuoteWithSmartQuoteIsEnabled&&this._optionsInfo.get_replaceQuoteWithSmartQuote()){var d=this._autoCorrectRules.findSmartQuoteAutoCorrectAction(e,t,n,r,o);d&&(a.addAction(d),C.ULS.sendTraceTag(37363807,324,50,"Smart quote action is created."))}for(var h=this._registeredMatchActions.get_values().$$ge();h.$$mn();){var _=h.$$cu().createAutoCorrectMatchActions(e,t,n,r,i,o);if(_&&!_.isEmpty())for(var m=0;m<_.get_listLength();m++)a.addAction(_.getAction(m))}return a},e.prototype.registerAutoCorrectMatchAction=function(e){return this._nextTokenForRegisteringMatch++,this._registeredMatchActions.set_item(this._nextTokenForRegisteringMatch,e),this._nextTokenForRegisteringMatch},e.prototype.unregisterAutoCorrectMatchAction=function(e){this._registeredMatchActions.remove(e)},e.prototype.makeItALink=function(e,t){return this._autoCorrectRules.findLinkAutoCorrectMatchAtIdx(e,t)},e.prototype.tryMakeItALink=function(e,t){var n=this.makeItALink(e,t);return!!n&&(this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new zs.r),this._pendingAutoCorrectActions.addAction(n),!0)},e.prototype.scheduleAction=function(e){this._pendingAutoCorrectActions||(this._pendingAutoCorrectActions=new zs.r),this._pendingAutoCorrectActions.addAction(e)},e.prototype.invokePendingAction=function(e){if(this._pendingAutoCorrectActions){for(var t=!1,n=0;n<this._pendingAutoCorrectActions.get_listLength();n++){if(!(a=this._pendingAutoCorrectActions.getAction(n)))return;if(!a.get_isFired()){t=!0;break}}if(t){this._lastUndoableActionCommandId=null;var r=null,i=new as.GraphTransaction(15);i.set_undoActionId(e);var o=!1;for(n=0;n<this._pendingAutoCorrectActions.get_listLength();n++){var a;if(!(a=this._pendingAutoCorrectActions.getAction(n)))return;if(!a.get_isFired()){this._allowAutoCorrectUndoByBackspace&&a.get_isGraphOnlyOperation()&&a.get_isUndoableByBackspace()&&(r=a),o||(o=!0,i.setFromNode(a.get_graphTarget())),a.set_currentSelection(this._selectionManager.get_selectionCollection().get_currentSelection());var s=this._activityManager.startActivity(a.get_commandId());a.invoke(),s.end(),this._selectionManager.setSelection(a.get_currentSelection())}}this._pendingAutoCorrectActions=null,this._lastUndoableActionCommandId=r?r.get_commandId():null,o&&i.dispose()}}},e.prototype.invokePendingActionWithGraphUpdate=function(e){this._lastUndoableActionCommandId=null;var t=e,n=new as.GraphTransaction(15);n.setFromNode(t.get_graphTarget()),n.set_undoActionId(t.get_commandId()),t.set_currentSelection(this._selectionManager.get_selectionCollection().get_currentSelection());var r=this._activityManager.startActivity(t.get_commandId());t.invoke(),r.end(),this._selectionManager.setSelection(t.get_currentSelection()),this._allowAutoCorrectUndoByBackspace&&t.get_isGraphOnlyOperation()&&t.get_isUndoableByBackspace()&&(this._lastUndoableActionCommandId=t.get_commandId()),n.dispose()},e.prototype.invokePendingActionWithHtmlUpdate=function(e){var t=e;return this._lastUndoableActionCommandId=null,t.invoke()},e.prototype.hasUndoableAutoCorrectAction=function(){return this._allowAutoCorrectUndoByBackspace&&!!this._lastUndoableActionCommandId},e.prototype.onBeforeKeyDown=function(e){if(!this._allowAutoCorrectUndoByBackspace||!this._lastUndoableActionCommandId)return!1;var t=this._lastUndoableActionCommandId;return this._lastUndoableActionCommandId=null,!(!e||!this._undoManager.get_hasUndoEntries()||this._undoManager.get_currentUndoActionId()!==t)&&(this._undoManager.undo(),!0)},e.prototype.onSetSelectionFinished=function(e,t){this._lastUndoableActionCommandId=null},e.prototype.get_autoCorrectActions=function(){return this._pendingAutoCorrectActions},e}();(0,o.l)(Ks,"AutoCorrectScheduler",null,[qa.g]);var qs=n(7513),js=(0,o.y)("IPostHyperlinkAutoCorrectStrategy"),$s=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n,r,i,o)||this;return s._characterPropertiesEditor$1=null,s._trackChangeManager=null,s._internalLinkManager=null,s._postHyperlinkAutoCorrectStrategy=null,s._characterPropertiesEditor$1=o,s._trackChangeManager=a,s}return(0,S.t)(t,e),t.prototype.get_internalLinkManager=function(){return this._internalLinkManager||(this._internalLinkManager=se.w.get_instance().tryResolve(qs.v))},t.prototype.get_postHyperlinkAutoCorrectStrategy=function(){return this._postHyperlinkAutoCorrectStrategy||(this._postHyperlinkAutoCorrectStrategy=se.w.get_instance().tryResolve(js))},t.prototype.get_isGraphOnlyOperation=function(){return!0},t.prototype.get_commandId=function(){return ii.xM},t.prototype.doGraphCorrection=function(e){Xi.t.mark(7012);var n=new as.GraphTransaction(15);n.setFromNode(e);var r,i=this.get_matchStartIndex(),o=this.get_matchEndIndex(),a=cs.ParagraphReader.text(e),s=a.substring(i,o),l=Jn.l.stripIgnoredLinkChars(s,(0,p.m)((function(){return r}),(function(e){return r=e})));s!==l&&(o=(i+=r)+l.length);var c=_s.y.createTextRange(e,i,o),u=a.substring(i,o);if(t.isInsideDoubleQuotes(a,i,o)){this._characterPropertiesEditor$1.replaceTextRange(_s.y.createTextRange(e,i-1,o+1),u,!0,!1),--i,--o,c=_s.y.createTextRange(e,i,o);var g=ss.SelectionFactory.createIpSelection(e,o);Oa.SelectionManager.get_instance().setSelection(g)}var d=Hs.HyperlinkReader.getSanitizedUrl(u);t.get_hyperlinkEditor().createHyperlink(c,d,!1);var h="",_="",m=!1;if(this.get_internalLinkManager()&&this.get_internalLinkManager().tryConvertToRelativeLink(d,(0,p.m)((function(){return h}),(function(e){return h=e})),!0,(0,p.m)((function(){return _}),(function(e){return _=e})))){d=h,m=!0;var f=Hs.HyperlinkReader.getHyperlinksInRange(c,!1);if(t.get_hyperlinkEditor().removeHyperlink(f[0].paragraph,f[0].hyperlink),""!==_){this._characterPropertiesEditor$1.replaceTextRange(c,_,!0,!1),c=_s.y.createTextRange(e,this.get_matchStartIndex(),this.get_matchStartIndex()+_.length);g=ss.SelectionFactory.createIpSelection(e,this.get_matchStartIndex()+this.get_matchStartIndex()+_.length);Oa.SelectionManager.get_instance().setSelection(g)}t.get_hyperlinkEditor().createHyperlink(c,d,!1)}n.dispose(),!m&&this.get_postHyperlinkAutoCorrectStrategy()&&this.get_postHyperlinkAutoCorrectStrategy().postProcessHyperlink(c,d),Xi.t.mark(7013)},t.get_hyperlinkEditor=function(){return t._hyperlinkEditor||(t._hyperlinkEditor=se.w.get_instance().resolve(Ja.o))},t.isInsideDoubleQuotes=function(e,t,n){var r=!!t&&('"'===e.charAt(t-1)||"\u201c"===e.charAt(t-1)),i=n!==e.length&&('"'===e.charAt(n)||"\u201d"===e.charAt(n));return r&&i},t._hyperlinkEditor=null,t}(gs);(0,o.l)($s,"HyperlinkAction",gs,[]);var Qs=function(){function e(e,t){this._characterPropertiesEditor=null,this._trackChangeManager=null,this._characterPropertiesEditor=e,this._trackChangeManager=t}return e.prototype.createHyperlinkAction=function(e,t,n,r){return new $s(e,t,n,r,this._characterPropertiesEditor,this._trackChangeManager)},e}();(0,o.l)(Qs,"Factory$0",null,[Ga.s]);var Js=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.AutoCorrect"},e.prototype.configure=function(e){this._container=e,e.register(Gs).as(Ha.r).singleInstance().usingFactory((function(){return new Gs(e.resolve(Ga.s),e.resolve(Va.x),ls.k.get_instance(),L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager,e.resolve(Wa),e.resolve(za.p).get_instance())})),e.register(Qa).as(Wa).singleInstance().usingFactory((function(){return new Qa(e.resolve(Ka.t),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled"))})),e.register(Ks).as(qa.g).singleInstance().usingFactory((function(){return new Ks(e.resolve(Ha.r),Oa.SelectionManager.get_instance(),ji.y.get_instance(),L.AFrameworkApplication.appSettingsManager,e.resolve(Wa),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AutoCorrectUndoByBackspaceIsEnabled")?e.resolve(ja.n):null)})),e.register(Qs).as(Ga.s).singleInstance().usingFactory((function(){return new Qs(e.resolve(Va.x),e.resolve($a.b).get_instance())}))},e.prototype.init=function(){this._container.resolve(Ha.r).loadDefaultAutoCorrectList();var e=L.AFrameworkApplication.appSettingsManager;e.getBooleanAppSetting("AutoCorrectOptionSettingIsEnabledForWordOnline")&&e.getBooleanAppSetting("IsRoamingServiceEnabled")&&this._container.resolve(Wa).getAutoCorrectOptions()},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Js,"Box4AutoCorrectPackage",null,[l.u,c.s]);var Xs=function(){function e(){}return e.prototype.get_name=function(){return"Box4.Clipboard"},e.prototype.init=function(){},e.prototype.dispose=function(){},e.prototype.configure=function(e){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Xs,"Box4ClipboardPackage",null,[l.u,c.s]);var Ys=function(){function e(){}return e.prototype.get_name=function(){return"Box4.ImageEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Ys,"Box4ImageEditorsPackage",null,[l.u,c.s]);var Zs=function(){function e(){}return e.prototype.get_name=function(){return"Box4.ListEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Zs,"Box4ListEditorsPackage",null,[l.u,c.s]);var el=(0,o.y)("IInsertMediaFromHostOneDriveHostFrame"),tl=(0,o.y)("IOneDriveFilePickerHelper"),nl=(0,o.y)("IInsertMediaCrossDocumentMessengerFactory"),rl=n(5608),il=(0,o.y)("IInsertMediaDialogFactory"),ol=(0,o.y)("IInsertMediaFromHostManagerFactory"),al=n(1946),sl=n(1085),ll=n(2639),cl=n(2133),ul=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g,p,d,h,_){this._actionManager=null,this._appSettingsManager=null,this._insertMediaSettingsManager=null,this._imageEditor=null,this._insertMediaDialogFactory=null,this._insertMediaFromHostManagerFactory=null,this._insertMediaHelper=null,this._insertOnlineImageHelper=null,this._insertOneDriveFileLinkHelper=null,this._hostName=null,this._isLimitedEdit=!1,this._isOneDrive=!1,this._corelationId=null,this._insertOnlinePictureUrl=null,this._insertPictureTelemetryEndpoint=null,this._oneDriveHostFrame=null,this._oneDriveFilePickerHelper=null,this.isFakeHostFrameListening=!1,this._oneDriveFilePickerHelper=r,this._oneDriveHostFrame=i,this._insertMediaDialogFactory=a,this._insertMediaFromHostManagerFactory=s,this._insertMediaHelper=l,this._actionManager=e,this._appSettingsManager=t,this._imageEditor=o,this._isOneDrive=g,this._isLimitedEdit=p,this._hostName=d,this._insertMediaSettingsManager=n,this._insertOnlineImageHelper=c,this._insertOneDriveFileLinkHelper=u,this._insertOnlinePictureUrl=h,this._insertPictureTelemetryEndpoint=_}return e.prototype.registerActions=function(){(this._insertMediaSettingsManager.isInsertOnlinePictureFromHostEnabled||this._insertMediaSettingsManager.isInsertOneDriveFileLinkEnabled)&&this._insertMediaSettingsManager.isInsertOnlinePictureFromEmulatedOneDriveHostEnabled&&this.prepareOneDriveHostFrame(),this.registerInsertOnlinePictureActions(),this._actionManager.addActionWithFlags(ii.vn,cl.n,o.i(this,this.showInsertPictureFromHostDialog,"showInsertPictureFromHostDialog"),1284),this._actionManager.addActionWithFlags(ii.hM,cl.n,o.i(this,this.updateEntryPoints,"updateEntryPoints"),1124),this._actionManager.addActionWithFlags(ii.qx,cl.n,o.i(this,this.showInsertOneDriveFileDialog,"showInsertOneDriveFileDialog"),1284)},e.prototype.registerInsertOnlinePictureActions=function(){this._actionManager.addActionWithFlags(ii.FS,cl.n,o.i(this,this.showInsertPictureFromSearchDialog,"showInsertPictureFromSearchDialog"),1284),this._actionManager.removeActionIfFeatureIsDisabled("word_insertOnlinePictures",!0,ii.FS,cl.n,o.i(this,this.showInsertPictureFromSearchDialog,"showInsertPictureFromSearchDialog"),(function(e){Br.App.get_activeAppFrame().updateRibbonControlUsingAction(e,o.i(new ll.x,(new ll.x).getCommandById,"getCommandById"))}))},e.prototype.prepareOneDriveHostFrame=function(){L.AFrameworkApplication.get_activeFrame().get_element().appendChild(this._oneDriveHostFrame.get_fakedOneDriveHostFrame()),qo.n.addHandler(this._oneDriveHostFrame.get_fakedOneDriveHostFrame().contentWindow,"message",o.i(this,this.showOneDriveFilePickerDialog,"showOneDriveFilePickerDialog")),this.isFakeHostFrameListening=!0},e.prototype.showOneDriveFilePickerDialog=function(e){if(e.rawEvent){var t=e.rawEvent.data;if(t)try{var n=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0),r=n.MessageId?n.MessageId.toString():null;if(n&&r&&(r===Me.a.insertImage||r===Me.a.insertFileLink)){var i=r===Me.a.insertImage?this._insertOnlineImageHelper:this._insertOneDriveFileLinkHelper;this._oneDriveFilePickerHelper.start(i)}}catch(e){}}},e.prototype.showInsertPictureFromHostDialogOnSignedIn=function(e){this.showInsertPictureDialog(this._insertMediaFromHostManagerFactory.getInstance(),CommonUIStrings.L_PictureInsertTitle,e)},e.prototype.updateEntryPoints=function(e,t,n,r,i){if(1===n)return 32;var o,a=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled();return this._isOneDrive?o=a?CommonUIStrings.l_OneDriveName:String.format(CommonUIStrings.L_OnlinePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this._hostName?o=a?this._hostName:String.format(CommonUIStrings.L_OnlinePictureFromHost,this._hostName):(o=a?CommonUIStrings.l_HostGeneric:CommonUIStrings.l_OnlinePictureFromHostGeneric,C.ULS.sendTraceTag(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead.")),i[ki.f.LabelText]=o,32},e.prototype.showInsertPictureFromSearchDialog=function(e,t,n,r,i){var o=this._imageEditor.canInsertPictureInContext(t);if(1===n)return o&&this._insertMediaSettingsManager.isInsertOnlinePictureEnabled?32:8;if(2!==n||!o)return 8;this._corelationId=ae.l.create(),C.ULS.sendTraceTag(7165725,352,50,"InsertMediaActor::ShowInsertPictureFromSearchDialog : Show dialog.");var a=0;L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance()&&(4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()?a=8:5===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()&&(a=12));var s,l=Kt.i.getCultureInfo(L.AFrameworkApplication.lcid),c=String.format(this._insertOnlinePictureUrl,L.AFrameworkApplication.lcid,l?l.get_name():"en-us",L.AFrameworkApplication.buildVersion,this._corelationId,a,L.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserId")),u=new RegExp("insertmedia.bing.office.net","gi");return this._insertOnlinePictureUrl.search(u)>0&&(c=this._insertMediaHelper.buildInsertPictureServiceRequestUrl(Br.App.get_mode(),L.AFrameworkApplication.appSettingsManager.get_appSettings().InsertPictureServiceEndpoint)),(s=this._insertMediaDialogFactory.getInstanceWithUrl(c)).set_correlationId(this._corelationId),s.set_insertPictureTelemetryEndpoint(this._insertPictureTelemetryEndpoint),this.showInsertPictureDialog(s,CommonUIStrings.L_PictureInsertTitle,this._insertOnlineImageHelper)},e.prototype.showInsertOneDriveFileDialog=function(e,t,n,r,i){var o=32===this._actionManager.processActionAgainstContext(t,ii.jg,1,!1,null,null);return 1===n?o&&this._insertMediaSettingsManager.isInsertOneDriveFileLinkEnabled?32:8:2===n&&o?(C.ULS.sendTraceTag(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog."),this.showInsertPictureDialog(this._insertMediaFromHostManagerFactory.getInstance(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this._insertOneDriveFileLinkHelper)):8},e.prototype.showInsertPictureFromHostDialog=function(e,t,n,r,i){var o=this._imageEditor.canInsertPictureInContext(t);return 1===n?o&&this._insertMediaSettingsManager.isInsertOnlinePictureFromHostEnabled?32:8:2===n&&o?(C.ULS.sendTraceTag(17838539,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : ShowInsertMediaDialog dialog."),this.showInsertPictureDialog(this._insertMediaFromHostManagerFactory.getInstance(),CommonUIStrings.L_PictureInsertTitle,this._insertOnlineImageHelper)):8},e.prototype.showInsertPictureDialog=function(e,t,n){try{return e.showInsertMediaDialog(t,n),C.ULS.sendTraceTag(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(e){return C.ULS.sendTraceTag(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",e.toString()),this.showErrorDialog(sl.o.noPictureSpecified,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}},e.prototype.showErrorDialog=function(e,t,n){var r=new ar.StandardDialog(!0);r.set_hasCloseGlyph(L.AFrameworkApplication.isCloseable),r.set_buttonsOption(0),r.setButtonText(1,CommonUIStrings.l_DialogClose),r.showError(e,t,n,(function(e,t){}))},e.prototype.dispose=function(){this.isFakeHostFrameListening&&this._oneDriveHostFrame.get_fakedOneDriveHostFrame().contentWindow&&(qo.n.removeHandler(this._oneDriveHostFrame.get_fakedOneDriveHostFrame().contentWindow,"message",o.i(this,this.showOneDriveFilePickerDialog,"showOneDriveFilePickerDialog")),this.isFakeHostFrameListening=!1)},e}();(0,o.l)(ul,"InsertMediaActor",null,[Sys.IDisposable]);var gl=(0,o.y)("IInsertMediaCrossDocumentMessenger"),pl=n(4485),dl=n(9241),hl=function(e){function t(t,n){return e.call(this,t,tt.n.getOrigin(n))||this}return(0,S.t)(t,e),t.prototype.registerPostMessageHandler=function(e,t){if(this.isEnabled()&&this.addAllowedOrigin(this.get_targetOrigin())){this.addAllowedReceivingMessage(e);this.registerCallback(e,t)}},t.prototype.sendMessage=function(e,t,n){void 0===n&&(n=""),this.send((0,O.m)(new dl.f,{MessageId:e,SendTime:Date.now(),CorrelationId:n,Values:t}))},t}(pl.a);(0,o.l)(hl,"InsertMediaCrossDocumentMessenger",pl.a,[gl,Sys.IDisposable]);var _l=function(){function e(){}return e.prototype.getInstance=function(e,t){return new hl(e,t)},e}();(0,o.l)(_l,"InsertMediaCrossDocumentMessengerFactory",null,[nl]);var ml,fl,yl=(0,o.y)("IInsertMediaDialog");!function(e){e[e.OK=0]="OK",e[e.cancel=1]="cancel",e[e.error=2]="error",e[e.open=3]="open"}(ml||(ml={})),(0,o.h)("HubbleAction",ml),function(e){e[e.unknown=0]="unknown",e[e.bing=1]="bing",e[e.m365=2]="m365",e[e.icons=3]="icons",e[e.oneDrive=4]="oneDrive"}(fl||(fl={})),(0,o.h)("InsertMediaProviders",fl);var Cl=function(){function e(){}return e.dialogHtml="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>",e}();(0,o.l)(Cl,"InsertMediaDialogHtml",null,[]);var Sl=n(7595),vl=n(869),bl=n(394),Tl=n(403),Al="InsertMediaDialog",Il=function(e){function t(t,n,r,i){void 0===i&&(i=null);var o=e.call(this)||this;if(o._searchResults=null,o._dialogTitle=null,o._postMessenger=null,o._postMessengerFactory=null,o._insertMediaHelper=null,o._insertMediaServiceEndpoint=null,o._fInsertMessageReceived=!1,o.m_insertMediaIframe=null,o.m_iframeLoadedHandler=null,o.c_keepFocusDiv="KeepFocusDiv",o.c_keepFocusStartDiv="KeepFocusStartDiv",o.$$pf_CorrelationId=null,o.$$pf_MediaProvider=0,o.$$pf_InsertPictureTelemetryEndpoint=null,o.insertOnlineMediaHelper=null,!t)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");return o._insertMediaServiceEndpoint=t,o._dialogTitle="",o._insertMediaHelper=r,o._searchResults=[],o._postMessengerFactory=n,o.set_dialogHtml(i||Cl.dialogHtml),o.set_dialogId(Al),o}return(0,S.t)(t,e),t.prototype.get_correlationId=function(){return this.$$pf_CorrelationId},t.prototype.set_correlationId=function(e){return this.$$pf_CorrelationId=e,e},t.prototype.get_mediaProvider=function(){return this.$$pf_MediaProvider},t.prototype.set_mediaProvider=function(e){return this.$$pf_MediaProvider=e,e},t.prototype.get_insertPictureTelemetryEndpoint=function(){return this.$$pf_InsertPictureTelemetryEndpoint},t.prototype.set_insertPictureTelemetryEndpoint=function(e){return this.$$pf_InsertPictureTelemetryEndpoint=e,e},t.prototype.get_focusManager=function(){return Nt.FocusManager.instance()},t.prototype.showInsertMediaDialog=function(e,t){var n=this;if(this._dialogTitle=e,this._fInsertMessageReceived=!1,this.showDialog(this._dialogTitle,null),this.m_insertMediaIframe=this.getDialogElementById(this.myId("insertmediaframe")),!this.m_insertMediaIframe)throw this.executeDismissButton(this.get_btnAction()),Error.invalidOperation("Couldn't get InsertMediaIframe.");var r=document.createElement("div");r.setAttribute("Id",this.c_keepFocusStartDiv),r.setAttribute("tabindex","0"),r.setAttribute("position","absolute"),r.setAttribute("width","-1000px"),r.setAttribute("top","-1000px"),this.m_insertMediaIframe.parentNode.insertBefore(r,this.m_insertMediaIframe.parentNode.firstChild);var i=document.createElement("div");(i.setAttribute("Id",this.c_keepFocusDiv),i.setAttribute("tabindex","0"),this.m_insertMediaIframe.parentNode.appendChild(i),i.setAttribute("position","absolute"),i.setAttribute("width","-1000px"),i.setAttribute("top","10000px"),$addHandler(this.get_dialogElement(),"keydown",o.i(this,this.keyDownHandler,"keyDownHandler")),this.m_insertMediaIframe.setAttribute("src",this._insertMediaServiceEndpoint),this.m_insertMediaIframe.setAttribute("width","100%"),this.m_insertMediaIframe.setAttribute("height","100%"),this.m_insertMediaIframe.setAttribute("frameborder","0"),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ShowInsertMediaIframeWhenIframeIsReady")&&G.y.get_isFirefox()?(this.m_insertMediaIframe.style.visibility="hidden",this.m_iframeLoadedHandler=o.i(this,this.onInsertMediaIframeLoaded,"onInsertMediaIframeLoaded"),qo.n.addHandler(this.m_insertMediaIframe,"load",this.m_iframeLoadedHandler)):this.m_insertMediaIframe.style.visibility="visible",this.getDialogElementById(this.myId("WACDialogButtonPanel")).style.display="none",this.getDialogElementById(this.myId("WACDialogTitleText")).style.display="none",2===this.get_mediaProvider())&&(this.getDialogElementById(this.myId("WACDialogTitlePanel")).style.display="none",this.getDialogElementById(this.myId("WACDialogBodyPanel")).style.padding="0");Nt.FocusManager.instance().getCurrentRegion().scope.set_keyDownHandledExternally(!0),this._postMessenger=this._postMessengerFactory.getInstance(this.m_insertMediaIframe.contentWindow,this._insertMediaServiceEndpoint),this._postMessenger.registerPostMessageHandler(Me.a.addItem,(function(e){n.onAddItem(e,o.i(t,t.insertMediaCallback,"insertMediaCallback"))})),this._postMessenger.registerPostMessageHandler(Me.a.insert,(function(e){n.onInsert(e,o.i(t,t.insertMediaCallback,"insertMediaCallback"))})),this._postMessenger.registerPostMessageHandler(Me.a.addOtelEvent,(function(e){n.onOtelEvent(e)})),this._postMessenger.registerPostMessageHandler(Me.a.getCustomHeaders,o.i(this,this.onGetCustomHeaders,"onGetCustomHeaders")),this._postMessenger.registerPostMessageHandler(Me.a.getSessionId,o.i(this,this.onGetSessionId,"onGetSessionId")),this._postMessenger.registerPostMessageHandler(Me.a.getCID,o.i(this,this.onGetCID,"onGetCID")),this._postMessenger.registerPostMessageHandler(Me.a.cancelDialog,o.i(this,this.onCancelDialog,"onCancelDialog")),this.sendTelemetry(3)},t.prototype.onInsertMediaIframeLoaded=function(e){var t=this;this.m_insertMediaIframe&&(this.m_insertMediaIframe.style.visibility="visible",window.setTimeout((function(){if(t._document){var e=t._document.getElementById(t.c_keepFocusStartDiv);e&&e.focus()}}),0))},t.prototype.keyDownHandler=function(e){if(e.keyCode===Sys.UI.Key.tab)if(e.target.id!==this.c_keepFocusDiv||e.shiftKey){if(e.target.id===this.c_keepFocusStartDiv&&e.shiftKey){e.preventDefault(),this._document.getElementById(this.c_keepFocusDiv).focus()}}else e.preventDefault(),this._document.getElementById(this.c_keepFocusStartDiv).focus()},t.prototype.dispose=function(){this._postMessenger&&(this._postMessenger.dispose(),this._postMessenger=null),this.m_iframeLoadedHandler&&(qo.n.removeHandler(this.m_insertMediaIframe,"load",this.m_iframeLoadedHandler),this.m_iframeLoadedHandler=null),e.prototype.dispose.call(this)},t.prototype.onAddItem=function(e,t){C.ULS.sendTraceTag(7135752,352,100,"OnAddItem : Got message.");var n=this._insertMediaHelper.parseOnlineMediaSearchResult(e);n&&(this._searchResults.length>50?C.ULS.sendTraceTag(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(this._searchResults,n),this._fInsertMessageReceived&&(t(this._searchResults),this._fInsertMessageReceived=!1)))},t.prototype.onCancelDialog=function(e){C.ULS.sendTraceTag(17662422,352,100,"OnCancelDialog : Got message."),this.executeDismissButton(this.get_btnAction()),this.sendTelemetry(1)},t.prototype.sendTelemetry=function(e){var t=new RegExp("hubble","gi");if(this.get_insertPictureTelemetryEndpoint()&&this.get_insertPictureTelemetryEndpoint().search(t)>0&&this.get_correlationId()){var n=L.AFrameworkApplication.sessionStartInfoSettings,r={};r.InsertedFiles=this._searchResults.length,r.MediaDetails=this._searchResults,r.DialogResult=ml[e],r.DialogMode=this.getMediaType(),r.CorrelationId="{"+this.get_correlationId().toString()+"}",r.Platform="Wac",r.Provider=fl[this.get_mediaProvider()]||"Unknown",r.AudienceGroup=n&&"AudienceGroup"in n?n.AudienceGroup.toString():"Unknown",r.Ring=n&&"Ring"in n?n.Ring.toString():"Unknown",r.AppId=Br.App.get_mode(),r.Build=L.AFrameworkApplication.buildVersion,r.Locale=Kt.i.getCultureInfo(L.AFrameworkApplication.lcid).get_name(),this.prepareRequest().send(JSON.stringify(r))}if(2===this.get_mediaProvider()){var i=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("InsertMediaDialogAriaTenantNameSpace");if(!i||""===i)return;var o=new Array(0);Array.add(o,(0,O.m)(new vl.b,{name:"InsertedFiles",int64:this._searchResults.length})),Array.add(o,(0,O.m)(new vl.b,{name:"MediaDetails",string:JSON.stringify(this._searchResults)})),Array.add(o,(0,O.m)(new vl.b,{name:"DialogResult",string:ml[e]})),Array.add(o,(0,O.m)(new vl.b,{name:"DialogMode",string:this.getMediaType()})),Array.add(o,(0,O.m)(new vl.b,{name:"CorrelationId",string:this.get_correlationId().toString()})),Array.add(o,(0,O.m)(new vl.b,{name:"Provider",string:fl[this.get_mediaProvider()]||"Unknown"})),Sl.k.sendTelemetryEvent((0,O.m)(new Tl.y,{name:String.format("{0}.{1}",i,"InsertM365Images"),dataFields:o}))}},t.prototype.getMediaType=function(){return 3===this.get_mediaProvider()?"Icons":"Images"},t.prototype.getDialogElementById=function(e){var t=document.getElementById(e);if(!t)throw Error.invalidOperation(String.format("Couldn't get {0}.",e));return t},t.prototype.prepareRequest=function(){var e=new XMLHttpRequest;return e.open("POST",this.get_insertPictureTelemetryEndpoint(),!0),e.setRequestHeader("Content-Type",""),e},t.prototype.onInsert=function(e,t){C.ULS.sendTraceTag(7135754,352,100,"OnInsert : Got message."),this.executeDismissButton(this.get_btnAction()),t?this._searchResults&&this._searchResults.length>0?(t(this._searchResults),this.sendTelemetry(0)):(C.ULS.sendTraceTag(23078422,352,15,"Empty search result."),this._fInsertMessageReceived=!0,t(this._searchResults),this.sendTelemetry(2)):this.sendTelemetry(2)},t.prototype.onGetCustomHeaders=function(e){this._postMessenger&&(C.ULS.sendTraceTag(7135755,352,100,"OnGetCustomHeaders : Got message."),this._postMessenger.sendMessage(Me.a.setCustomHeaders,{CustomHeaders:""}))},t.prototype.onGetSessionId=function(e){this._postMessenger&&(C.ULS.sendTraceTag(7135756,352,100,"OnGetSessionId : Got message."),this._postMessenger.sendMessage(Me.a.setSessionId,{SessionId:L.AFrameworkApplication.userSessionId||"00000000-0000-0000-0000-000000000000"}))},t.prototype.onGetCID=function(e){this._postMessenger&&(C.ULS.sendTraceTag(7135757,352,100,"OnGetCID : Got message."),this._postMessenger.sendMessage(Me.a.setCID,{CID:""}))},t.prototype.onOtelEvent=function(e){var t;if(e&&e.Values){var n=e.Values;delete n.m_Origin,delete n.m_Source,delete n.m_ReceivedTime,C.ULS.sendTraceTag(51652562,352,50,"Received OTel event: "+n.eventName||!1),t=n,Sl.k.sendOtelEvent((0,O.m)(new bl.e,{otelEvent:t}))}},t}(ri.o);(0,o.l)(Il,"InsertMediaDialog",ri.o,[yl,Sys.IDisposable]);var wl=function(){function e(e,t){this._insertMediaCrossDocumentFactory=null,this._insertMediaHelper=null,this._insertMediaCrossDocumentFactory=e,this._insertMediaHelper=t}return e.prototype.getInstanceWithUrl=function(e){return new Il(e,this._insertMediaCrossDocumentFactory,this._insertMediaHelper,Cl.dialogHtml)},e.prototype.getInstance=function(){throw Error.notImplemented()},e}();(0,o.l)(wl,"InsertMediaDialogFactory",null,[il]);var xl=";",Fl=function(){function e(e,t,n){this._hostPostMessengerLazy=null,this._unsupportedFileTypes=null,this._hostOrigin=null,this._supportedImageExtensions=null,this.isCallbackRegistered=!1,this.$$pf_CorrelationId=null,this.$$pf_MediaProvider=0,this.$$pf_InsertPictureTelemetryEndpoint=null,this._hostPostMessengerLazy=e,this._unsupportedFileTypes=[],this._hostOrigin=t,this._supportedImageExtensions=n.split(xl)}return e.prototype.get_correlationId=function(){return this.$$pf_CorrelationId},e.prototype.set_correlationId=function(e){return this.$$pf_CorrelationId=e,e},e.prototype.get_mediaProvider=function(){return this.$$pf_MediaProvider},e.prototype.set_mediaProvider=function(e){return this.$$pf_MediaProvider=e,e},e.prototype.get_insertPictureTelemetryEndpoint=function(){return this.$$pf_InsertPictureTelemetryEndpoint},e.prototype.set_insertPictureTelemetryEndpoint=function(e){return this.$$pf_InsertPictureTelemetryEndpoint=e,e},e.prototype.showInsertMediaDialog=function(e,t){var n=this;Array.clear(this._unsupportedFileTypes);var r=this._hostPostMessengerLazy.get_value();r.addAllowedOrigin(this._hostOrigin),r.addAllowedReceivingMessage(t.get_hostCrossDocumentInsertMessageId()),this.isCallbackRegistered||(r.registerCallback(t.get_hostCrossDocumentInsertMessageId(),(function(e){n.onInsert(e,t)})),this.isCallbackRegistered=!0),C.ULS.sendTraceTag(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");var i={FileExtensionFilterList:this._supportedImageExtensions};r.sendMessage(t.get_crossDocumentInsertMessageId(),i)},e.prototype.addUnsupportedFileType=function(e){Array.contains(this._unsupportedFileTypes,e)||Array.add(this._unsupportedFileTypes,e)},e.prototype.onInsert=function(e,t){C.ULS.sendTraceTag(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");for(var n=t.parseMessage(e),r=[],i=0;i<n.length;i++){var o=n[i];t.isFileTypeAllowed(o,this._supportedImageExtensions)?Array.add(r,o):this.addUnsupportedFileType(t.getResultFileType(o))}if(r&&r.length?t.insertMediaCallback(r):C.ULS.sendTraceTag(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty"),this._unsupportedFileTypes.length>0){var a=this._unsupportedFileTypes.join(", ");C.ULS.sendTraceTag(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",a),this.showUnsupportedFileTypeDialog(a)}},e.prototype.showUnsupportedFileTypeDialog=function(e){var t=new ar.StandardDialog;t.set_buttonsOption(0),t.showWarning(CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,e),null)},e.prototype.dispose=function(){},e}();(0,o.l)(Fl,"InsertMediaFromHostManager",null,[yl,Sys.IDisposable]);var El=function(){function e(e){this._insertMediaFromHostManager=null,this._insertMediaFromHostManager=e}return e.prototype.getInstanceWithUrl=function(e){throw Error.notImplemented()},e.prototype.getInstance=function(){return this._insertMediaFromHostManager},e}();(0,o.l)(El,"InsertMediaFromHostManagerFactory",null,[ol,il]);var Pl="about:blank",kl=function(){function e(){this._fakeIframe=null,this._fakeIframe=document.createElement("iframe"),this._fakeIframe.src=Pl,this._fakeIframe.style.visibility="hidden",this._fakeIframe.style.position="absolute",this._fakeIframe.style.zIndex="-100"}return e.prototype.get_fakedOneDriveHostFrame=function(){return this._fakeIframe},e}();(0,o.l)(kl,"InsertMediaFromHostOneDriveHostFrame",null,[el]);var Dl=n(9103),Ml="*",Rl=function(e){function t(t,n){var r=e.call(this,t,n===Ml?n:tt.n.getOrigin(n))||this;return e.prototype.addAllowedFreeSendingMessage.call(r,Me.a.insertImage),e.prototype.addAllowedFreeSendingMessage.call(r,Me.a.insertFileLink),r}return(0,S.t)(t,e),t.prototype.sendMessage=function(e,t,n){return void 0===n&&(n=""),this.send((0,O.m)(new dl.f,{MessageId:e,SendTime:Date.now(),CorrelationId:n,Values:t}))},t.prototype.sendMessageWithRetry=function(e,t,n,r){return void 0===n&&(n=""),void 0===r&&(r=0),!1},t.prototype.reportDocumentLoadedTime=function(e){},t.prototype.get_isHostReadyToAcceptPostMessage=function(){return!0},t.prototype.add_hostReadyToAcceptPostMessageReceived=function(e){},t.prototype.remove_hostReadyToAcceptPostMessageReceived=function(e){},t}(pl.a);(0,o.l)(Rl,"InsertMediaFromOneDriveCrossDocumentMessenger",pl.a,[Fe.i,Dl.d,Sys.IDisposable]);var Ll=(0,o.y)("IInsertMediaHelper"),Nl=function(){return function(){}}();(0,o.l)(Nl,"OnlineMediaSearchResult",null,[]);var Bl=function(){function e(){}return e.prototype.appModeToId=function(e){var t;switch(e){case 1:t=8;break;case 4:t=3;break;case 2:default:t=0}return t},e.prototype.buildInsertPictureServiceRequestUrl=function(e,t){return String.format(t,this.appModeToId(e))},e.prototype.buildInsertM365PictureRequestUrl=function(e,t,n,r){var i=this.appModeToId(e),o=Kt.i.getCultureInfo(L.AFrameworkApplication.lcid).get_name(),a=L.AFrameworkApplication.buildVersion;return String.format(t,L.AFrameworkApplication.lcid,o,a,n,i,r,1,1)},e.prototype.buildInsertVideoServiceRequestUrl=function(e,t){var n=this.appModeToId(e),r=L.AFrameworkApplication.buildVersion,i=r.indexOf(".")>0?r.substring(0,r.indexOf(".")):"16";return String.format(t,L.AFrameworkApplication.lcid,L.AFrameworkApplication.lcid,L.AFrameworkApplication.lcid,n,i,r,"Video",0,0)},e.prototype.parseOnlineMediaSearchResult=function(e){if(!e||!e.Values)return null;var t=e.Values;if(!t)return null;var n="";return"sourceProvider"in t&&(n=t.sourceProvider||""),(0,O.m)(new Nl,{Action:t.action||"",Caption:t.caption||"",ContentType:t.contentType||"",Type:t.extension||"",PageUrl:t.pageUrl||"",OriginalUrl:t.sourceUrl||"",ContentProvider:n,ThumbnailUrl:t.thumbnailUrl||"",LicenseUrl:t.licenseUrl||"",LicenseDisplayName:t.licenseDisplayName||"",Height:t.height||0,Width:t.width||0,SvgContent:t.svgContent||""})},e.prototype.parseOnlineMediaSearchResultList=function(e){var t=[];if(!e||!e.Values||!e.Values.Items)return t;for(var n=e.Values.Items,r=0;r<n.length;r++){var i=n[r];if(i){var o=(0,O.m)(new Nl,{Type:i.Extension||"",OriginalUrl:i.SourceUrl||"",Caption:i.caption,Height:i.Height||0,Width:i.Width||0});Array.add(t,o)}}return t},e.prototype.parseResponse=function(e){for(var t=[],n=0;n<e.data.files.length;n++){var r=e.data.files[n];if(r){var i=(0,O.m)(new Nl,{ContentType:r.itemType||"",Type:r.extension||"",OriginalUrl:r.urls&&r.urls.open?r.urls.open:"",Height:r.photo?r.photo.height:0,Width:r.photo?r.photo.width:0});Array.add(t,i)}}return t},e.prototype.isFileTypeAllowed=function(e,t){if(!e)return!1;for(var n=0;n<t.length;n++)if(e.toLowerCase().indexOf(t[n])>=0)return!0;return!1},e.prototype.prepareHTMLForPictures=function(e){var t="";if(e)for(var n=0;n<e.length;n++){var r=e[n];r&&(t+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',r.OriginalUrl,r.Width,r.Height))}return t},e.prototype.getVideoUrlString=function(t){var n=e.s_EmbeddedStringRegExp.exec(t);return n&&n.length>2?n[2].trim():""},e.s_EmbeddedStringRegExp=new RegExp("<iframe\\s(.*\\s)*src=[\\\"|'](.*?)[\\\"|'].*/(iframe)?>","im"),e}();(0,o.l)(Bl,"InsertMediaHelper",null,[Ll]);var Ol=function(){return function(e,t,n,r){this.isInsertOnlinePictureEnabled=!1,this.isInsertOnlinePictureFromHostEnabled=!1,this.isInsertOneDriveFileLinkEnabled=!1,this.isInsertOnlinePictureFromEmulatedOneDriveHostEnabled=!1,this.isInsertOnlinePictureEnabled=e,this.isInsertOnlinePictureFromHostEnabled=t,this.isInsertOneDriveFileLinkEnabled=n,this.isInsertOnlinePictureFromEmulatedOneDriveHostEnabled=r}}();(0,o.l)(Ol,"InsertMediaSettingsManager",null,[]);var Ul=(0,o.y)("IInsertOnlineMediaHelper"),Hl=(0,o.y)("IInsertOnlineMediaHandler"),Gl=function(){function e(e){this._actionManager=null,this._insertMediaCommand=ii.jg,this._actionManager=e}return e.prototype.get_insertMediaCommand=function(){return this._insertMediaCommand},e.prototype.set_insertMediaCommand=function(e){return this._insertMediaCommand=e,e},e.prototype.insertMediaCallback=function(e){try{C.ULS.sendTraceTag(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",e.length);for(var t=0;t<e.length;t++)this._actionManager.processActionWithData(this.get_insertMediaCommand(),2,e[t]);C.ULS.sendTraceTag(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",e.length)}catch(e){C.ULS.sendTraceTag(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",e.toString())}},e}();(0,o.l)(Gl,"InsertOneDriveFileHandler",null,[Hl]);var Vl=n(8244),Wl=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.get_crossDocumentInsertMessageId=function(){return Me.a.insertFileLink},t.prototype.get_hostCrossDocumentInsertMessageId=function(){return Me.a.insertFileLinkHost},t.prototype.parseMessage=function(e){return e&&e.Values&&"Items"in e.Values?e.Values.Items:null},t.prototype.getResultFileType=function(e){return Vl.x(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files"),""},t.prototype.isFileTypeAllowed=function(e,t){return!0},t.prototype.processOneDriveFilePickerResponse=function(e,t,n){var r=n(e);if(r.length){var i={};i.Items=r,t.sendMessage(this.get_hostCrossDocumentInsertMessageId(),i)}},t.prototype.parseOneDriveV7Response=function(e){for(var t=e,n=[],r=0;r<t.data.value.length;r++){var i=t.data.value[r];if(i){var o={};o.DisplayText=i.name,o.Url=i.urls.download,o.sourceUrl=i.urls.download,o.caption=i.name,Array.add(n,o)}}return n},t.prototype.parseOneDriveV5Response=function(e){for(var t=e,n=[],r=0;r<t.data.files.length;r++){var i=t.data.files[r];if(i){var o={};o.DisplayText=String.format("{0}{1}",i.name,i.extension),o.Url=this.firstValidUrl([i.urls.viewInBrowser,i.urls.open,i.urls.download]),Array.add(n,o)}}return n},t.prototype.firstValidUrl=function(e){for(var t=0;t<e.length;t++)if(e[t]&&""!==e[t])return e[t];return C.ULS.sendTraceTag(21764229,352,10,"None of the URLs we received are valid"),""},t}(Gl);(0,o.l)(Wl,"InsertOneDriveFileHelper",Gl,[Ul,Hl]);var zl=n(9836),Kl=n(613),ql=function(){function e(e,t,n){this._actionManager=null,this._insertMediaHelper=null,this._telemetry=null,this._ariaNotifier=null,this._insertMediaCommand=ii.VS,this._actionManager=e,this._insertMediaHelper=t,this._telemetry=n}return e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.get_ariaNotifier=function(){return this._ariaNotifier||(this._ariaNotifier=se.w.get_instance().resolve(Ta.u))},e.prototype.get_insertMediaCommand=function(){return this._insertMediaCommand},e.prototype.set_insertMediaCommand=function(e){return this._insertMediaCommand=e,e},e.prototype.insertMediaCallback=function(e){try{C.ULS.sendTraceTag(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",e.length);var t=this._insertMediaHelper.prepareHTMLForPictures(e),n=2;if(t&&t.length>0){var r=new Kl.DictionaryPropertySet;if(r.setValue(zl.k.pastedHtmlContent,t),r.setValue(zl.k.isImageInsertion,!0),this._telemetry){var i=this._telemetry.startMeasurement("ClipboardOperation");i.appendOperationFlag("insertOnlineImage"),r.setValue(zl.k.clipboardTelemetry,i)}L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.get_ariaNotifier().sendNotification(Box4Intl.Box4Strings.l_ImageUploading,!0),n=this._actionManager.processActionWithData(this.get_insertMediaCommand(),2,r)}C.ULS.sendTraceTag(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",e.length,32===n,""===t)}catch(e){C.ULS.sendTraceTag(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",e.toString())}},e}();(0,o.l)(ql,"InsertOnlineImageHandler",null,[Hl]);var jl=function(e){function t(t,n,r){return void 0===r&&(r=null),e.call(this,t,n,r)||this}return(0,S.t)(t,e),t.prototype.get_crossDocumentInsertMessageId=function(){return Me.a.insertImage},t.prototype.get_hostCrossDocumentInsertMessageId=function(){return Me.a.insertImageHost},t.prototype.parseMessage=function(e){return this._insertMediaHelper.parseOnlineMediaSearchResultList(e)},t.prototype.getResultFileType=function(e){return e.Type},t.prototype.isFileTypeAllowed=function(e,t){return this._insertMediaHelper.isFileTypeAllowed(e.Type,t)},t.prototype.parseOneDriveV7Response=function(e){var t=e,n=[];if(t&&t.data&&t.data.value&&t.data.value.length>0)for(var r=0;r<t.data.value.length;r++)if(t.data.value[r]&&t.data.value[r].urls&&t.data.value[r].urls.download){var i=t.data.value[r],o=(0,O.m)(new Nl,{OriginalUrl:i.urls.download,Type:i.extension||"",Caption:i.name,ContentType:"",Height:i.driveItem||i.driveItem.image?i.driveItem.image.height:0,Width:i.driveItem||i.driveItem.image?i.driveItem.image.width:0});Array.add(n,o)}return n.length||C.ULS.sendTraceTag(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found"),n},t.prototype.parseOneDriveV5Response=function(e){return this._insertMediaHelper.parseResponse(e)},t.prototype.processOneDriveFilePickerResponse=function(e,t,n){var r=n(e);if(r.length){for(var i=[],o=0;o<r.length;o++){var a=r[o],s={};s.Extension=a.Type,s.SourceUrl=a.OriginalUrl,s.caption=a.Type,s.SourceUrl=a.OriginalUrl,s.Width=a.Width,s.Height=a.Height,Array.add(i,s)}var l={};l.Items=i,t.sendMessage(this.get_hostCrossDocumentInsertMessageId(),l)}},t}(ql);(0,o.l)(jl,"InsertOnlineImageHelper",ql,[Ul,Hl]);var $l=function(){function e(e,t){this._filePickerApiManager=null,this._postMessengerFactory=null,this._filePickerApiManager=e,this._postMessengerFactory=t}return e.prototype.start=function(e){var t=this,n={mode:"open",select:"multi",lightbox:"white"};this._filePickerApiManager.start(n,(function(n,r){t.processResponse(n,r,e)}))},e.prototype.processResponse=function(e,t,n){var r=t;if(C.ULS.sendTraceTag(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",e),e&&r&&r.data&&r.data.files&&r.data.files.length>0){var i=this._postMessengerFactory.getInstance(window.frames[0].parent,window.document.URL);n.processOneDriveFilePickerResponse(r,i,o.i(n,n.parseOneDriveV5Response,"parseOneDriveV5Response"))}else C.ULS.sendTraceTag(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")},e}();(0,o.l)($l,"OneDriveFilePickerHelperV5",null,[tl]);var Ql=(0,o.y)("IImageFilePickerHelper"),Jl=(0,o.y)("IPickerDialog"),Xl=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.showPickerDialg=function(){this._customCssClass="FilePickerDialog",this.set_dialogHtml("<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>"),this.set_dialogId("PickerDialog-Livebooks"),this.showDialog("",null)},t.prototype.getPickerContainer=function(){return document.getElementById("OpenFilePickerDiv")},t.prototype.sizeAndPositionDialog=function(){},t.prototype.reSizeDialog=function(){},t}(ri.o);(0,o.l)(Xl,"PickerDialog",ri.o,[Jl]);var Yl=n(3615),Zl=n(8149),ec=function(){function e(e,t,n){var r=this;this._filePickerApiManager=null,this._postMessengerFactory=null,this._oneDriveForBusinessUrl=null,this._cachedGetMoreInfoResult=null,this._getMoreInfoEventReceiver=null,this._filePickerApiManager=e,this._postMessengerFactory=n,this._getMoreInfoEventReceiver=new yt.q(Zl.k.$$(Ln.c),(function(){return new Yl.u(Ln.c,t.get_value(),o.i(r,r.getMoreInfoEventReceived,"getMoreInfoEventReceived"))}))}return e.prototype.get_oneDriveForBusinessUrl=function(){return this._oneDriveForBusinessUrl||(this._getMoreInfoEventReceiver.get_value().getResult("InsertFromOneDrive",!0),this._cachedGetMoreInfoResult&&this._cachedGetMoreInfoResult.get_personalFileStorageUrl()&&this._cachedGetMoreInfoResult.get_personalFileStorageUrl().length&&(this._oneDriveForBusinessUrl=this.getOneDriveForBussinessPageUrl(this._cachedGetMoreInfoResult.get_personalFileStorageUrl()))),this._oneDriveForBusinessUrl},e.prototype.getOneDriveForBussinessPageUrl=function(e){(e=e.toLowerCase()).endsWith("/")||(e+="/");var t=e.indexOf("/documents/");return-1!==t?e.substring(0,t+1)+"_layouts/15/onedrive.aspx":""},e.prototype.getMoreInfoEventReceived=function(e,t){this._cachedGetMoreInfoResult||3!==e.get_state()||(this._cachedGetMoreInfoResult=e)},e.prototype.start=function(e){var t=this;if(!this.get_oneDriveForBusinessUrl()){if(!L.AFrameworkApplication.breadcrumbFolderUrl||!L.AFrameworkApplication.breadcrumbFolderUrl.length)return void C.ULS.sendTraceTag(26071185,352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this._cachedGetMoreInfoResult);this._oneDriveForBusinessUrl=L.AFrameworkApplication.breadcrumbFolderUrl}var n=new Xl;n.showPickerDialg();var r=n.getPickerContainer();r?this._filePickerApiManager.start((function(r,i){n.hide(),t.processResponse(r,i,e)}),(function(){t.onCancel(n)}),r,this._oneDriveForBusinessUrl):C.ULS.sendTraceTag(26071186,352,10,"Picker container is null, will not show picker.")},e.prototype.onCancel=function(e){e.hide(),C.ULS.sendTraceTag(26071187,352,50,"User cancelled to insert picture from onedrive.")},e.prototype.processResponse=function(e,t,n){var r=t;if(C.ULS.sendTraceTag(26071188,352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",e),e&&r&&r.data&&r.data.value&&r.data.value.length>0){var i=this._postMessengerFactory.getInstance(window.frames[0].parent,window.document.URL);n.processOneDriveFilePickerResponse(r,i,o.i(n,n.parseOneDriveV7Response,"parseOneDriveV7Response"))}else C.ULS.sendTraceTag(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")},e}();(0,o.l)(ec,"OneDriveFilePickerHelperV7",null,[Ql,tl]);var tc=function(){function e(){this._container=null,this._insertMediaActor=null}return e.prototype.get_name=function(){return"Box4.Media"},e.prototype.configure=function(e){if(this._container=e,us.n.get_instance().get_item(99)){e.register(kl).as(el).singleInstance().usingFactory((function(){return new kl}));var t=new Ol(Boolean.parse(L.AFrameworkApplication.appSettingsManager.get_appSettings().InsertOnlinePictureEnabled||"false"),L.AFrameworkApplication.isInsertOnlinePictureFromHostSupported(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInsertOneDriveFileIsEnabled"),L.AFrameworkApplication.shouldUseEmulatedOneDriveHostForInsertOnlinePicture());if(Boolean.parse(L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteInsertOneDriveFileIsEnabled||"false")){var n=Ue.k(Bn.o.$$(Ln.c),e.resolveFuture(Bn.o.$$(Ln.c)));e.register(ec).as(tl).singleInstance().usingFactory((function(){return new ec(e.resolve(mr),new yt.q(Bn.o.$$(Ln.c),(function(){return n.get_result()})),e.resolve(nl))}))}else e.register($l).as(tl).singleInstance().usingFactory((function(){return new $l(e.resolve(ur),e.resolve(nl))}));e.register(ul).singleInstance().usingFactory((function(){return new ul(L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager,t,e.resolve(tl),e.resolve(kl),e.resolve(rl.w),e.resolve(il),e.resolve(ol),e.resolve(Bl),e.resolve(jl),e.resolve(Wl),L.AFrameworkApplication.get_isSkyDrive(),L.AFrameworkApplication.limitedEdit,L.AFrameworkApplication.get_hostNameToIncludeInSavedStatus(),L.AFrameworkApplication.appSettingsManager.get_appSettings().InsertPictureServiceEndpoint,L.AFrameworkApplication.appSettingsManager.get_appSettings().InsertPictureTelemetryEndpoint)})),e.register(wl).as(il).singleInstance().usingFactory((function(){return new wl(e.resolve(nl),e.resolve(Bl))})),e.register(El).as(ol).singleInstance().usingFactory((function(){return new El(e.resolve(Fl))})),e.register(Fl).singleInstance().usingFactory((function(){return new Fl(new yt.q(Fe.i,(function(){var e;if(L.AFrameworkApplication.shouldUseEmulatedOneDriveHostForInsertOnlinePicture()){var t=se.w.get_instance().resolve(el).get_fakedOneDriveHostFrame();e=new Rl(t.contentWindow,"*")}else e=L.AFrameworkApplication.hostPostmessenger;return e})),L.AFrameworkApplication.shouldUseEmulatedOneDriveHostForInsertOnlinePicture()?tt.n.getOrigin(window.document.URL):tt.n.getOrigin(L.AFrameworkApplication.postMessageOrigin),L.AFrameworkApplication.appSettingsManager.get_appSettings().ImageFetcherSupportedExtensions)})),e.register(_l).as(nl).singleInstance(),e.register(Bl).singleInstance(),e.register(jl).singleInstance().usingFactory((function(){return new jl(L.AFrameworkApplication.get_theActionManager(),e.resolve(Bl),e.resolve(al.s))})),e.register(Wl).singleInstance().usingFactory((function(){return new Wl(L.AFrameworkApplication.get_theActionManager())}))}},e.prototype.init=function(){us.n.get_instance().get_item(99)&&(this._insertMediaActor=this._container.resolve(ul),this._insertMediaActor.registerActions())},e.prototype.dispose=function(){this._insertMediaActor&&this._insertMediaActor.dispose()},e}();(0,o.l)(tc,"MediaPackage",null,[l.u,c.s]);var nc=function(){function e(){}return e.prototype.get_name=function(){return"Box4.NotebookLevelEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(nc,"Box4NotebookLevelEditorsPackage",null,[l.u,c.s]);var rc=n(5460),ic=n(1331),oc=(0,o.y)("ICreateParagraphStrategy"),ac=n(5027),sc=n(6918),lc=n(4092),cc=n(6569),uc=n(2145),gc=n(6158),pc=n(289),dc=n(9211),hc=n(8025),_c=n(2330),mc=n(1458),fc=n(722),yc=n(2560),Cc=n(1800),Sc=n(9017),vc=n(3803),bc=function(){return function(e){this.nodeToInsertAfter=null,this.nodeToInsertAfter=e}}();(0,o.l)(bc,"ValidParentData",null,[]);var Tc=n(2591),Ac=n(661),Ic=n(823),wc=n(1732),xc=n(3472),Fc=n(2106),Ec=n(2904),Pc=n(6152),kc=n(5133),Dc=function(){return function(){this.depthNew=0,this.depthNew=0}}();(0,o.l)(Dc,"BelowOutlineElementData",null,[]);var Mc=n(7849),Rc=n(8842),Lc=n(8076),Nc=function(e){function t(t,n,r,i){var o=e.call(this,4,i)||this;return o.deletedParaState=null,o.aboveParaState=null,o.belowParaState=null,o.deletedParaState=t,o.aboveParaState=n,o.belowParaState=r,o}return(0,S.t)(t,e),t.prototype.get_deletedParaState=function(){return this.deletedParaState},t.prototype.get_aboveParaState=function(){return this.aboveParaState},t.prototype.get_belowParaState=function(){return this.belowParaState},t.prototype.getUpdateHintsForOperation=function(){var e=this.get_deletedParaState();if(!e)return C.ULS.shipAssertTag(16819992,300,!1,"IParagraphStateWithChps not provided for DeletePara GetUpdateHintsForOperation"),null;var t=[],n=new Rc.a(this.get_deletedParaState().get_id(),this.get_deletedParaState().get_wordId(),this.get_aboveParaState()?this.get_aboveParaState().get_id():null);if(""!==e.get_characterData()&&e.get_characterData()){var r=new Lc.DeleteTextUpdateHint(this.get_deletedParaState().get_id(),0,e.get_characterData());Array.add(t,r)}return Array.add(t,n),t},t}(Mc.s);(0,o.l)(Nc,"DeleteParagraphOperation",Mc.s,[]);var Bc=n(659),Oc=n(7358),Uc=function(e){function t(t,n,r,i,o){var a=e.call(this,3,o)||this;return a.oldAboveParaState=null,a.oldBelowParaState=null,a.newAboveParaState=null,a.newParaState=null,a.oldAboveParaState=t,a.oldBelowParaState=n,a.newAboveParaState=r,a.newParaState=i,a}return(0,S.t)(t,e),t.prototype.get_oldAboveParaState=function(){return this.oldAboveParaState},t.prototype.get_oldBelowParaState=function(){return this.oldBelowParaState},t.prototype.get_newAboveParaState=function(){return this.newAboveParaState},t.prototype.get_newParaState=function(){return this.newParaState},t.prototype.getUpdateHintsForOperation=function(){var e=[],t=new Bc.AddParagraphUpdateHint(this.get_newParaState().get_id(),this.get_newParaState().get_wordId(),this.get_oldAboveParaState()?this.get_oldAboveParaState().get_id():null);if(Array.add(e,t),""!==this.get_newParaState().get_characterData()&&this.get_newParaState().get_characterData()){var n=new Oc.s(this.get_newParaState().get_id(),0,this.get_newParaState().get_characterData());Array.add(e,n)}return e},t}(Mc.s);(0,o.l)(Uc,"InsertNewParagraphOperation",Mc.s,[]);var Hc=n(9599),Gc=function(e){function t(t,n,r,i){var o=e.call(this,2,i)||this;return o.oldAboveParaState=null,o.oldBelowParaState=null,o.mergedParaState=null,o.oldAboveParaState=t,o.oldBelowParaState=n,o.mergedParaState=r,o}return(0,S.t)(t,e),t.prototype.get_oldAboveParaState=function(){return this.oldAboveParaState},t.prototype.get_oldBelowParaState=function(){return this.oldBelowParaState},t.prototype.get_mergedParaState=function(){return this.mergedParaState},t.prototype.getUpdateHintsForOperation=function(){var e=[],t=new Hc.MergeParagraphUpdateHint(this.get_oldAboveParaState().get_id(),this.get_oldAboveParaState().get_wordId(),this.get_oldAboveParaState().get_characterData().length,this.get_oldBelowParaState().get_id(),this.get_oldBelowParaState().get_wordId(),this.get_mergedParaState().get_id(),this.get_mergedParaState().get_wordId());return Array.add(e,t),e},t}(Mc.s);(0,o.l)(Gc,"MergeParagraphOperation",Mc.s,[]);var Vc=n(5306),Wc=function(e){function t(t,n,r,i,o){var a=e.call(this,1,o)||this;return a.oldParaState=null,a.aboveParaState=null,a.belowParaState=null,a.splitAtCp=0,a.oldParaState=t,a.splitAtCp=n,a.aboveParaState=r,a.belowParaState=i,a}return(0,S.t)(t,e),t.prototype.get_oldParaState=function(){return this.oldParaState},t.prototype.get_aboveParaState=function(){return this.aboveParaState},t.prototype.get_belowParaState=function(){return this.belowParaState},t.prototype.get_splitAtCp=function(){return this.splitAtCp},t.prototype.getUpdateHintsForOperation=function(){var e=[],t=new Vc.s(this.get_oldParaState().get_id(),this.get_oldParaState().get_wordId(),this.get_splitAtCp(),this.get_aboveParaState().get_id(),this.get_aboveParaState().get_wordId(),this.get_belowParaState().get_id(),this.get_belowParaState().get_wordId());return Array.add(e,t),e},t}(Mc.s);(0,o.l)(Wc,"SplitParagraphOperation",Mc.s,[]);var zc=n(2354),Kc=n(2919),qc=n(2028),jc=n(1611),$c=function(){function e(e,t,n,r,i,o){void 0===o&&(o=null),this._trackChangeManager=null,this._trackChangeEditor=null,this._listEditor=null,this._listReader=null,this._outlineEditor=null,this._createParagraphStrategy=null,this._formattingPropertyTransitStrategy=null,this._mergeListEditorInOutlineElementStrategy=null,this._contentControlConverter=null,this._outlineEditor=e,this._listEditor=t,this._listReader=n,this._createParagraphStrategy=r,this._mergeListEditorInOutlineElementStrategy=i,this._formattingPropertyTransitStrategy=o}return e.prototype.acquireAndApplyWordCoauthLockIfNeeded=function(e){us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager()&&Br.App.get_theCoauthManager().get_isCoauthorable()&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(e)},e.prototype.setIndentLeft=function(t,n,r,i){if(void 0===i&&(i=!1),hs.OutlineElementNavigator.moveToContent(t),cs.ParagraphReader.isParagraph(t))e.get_paragraphEditor().getIndentationEditor().setIndentLeft(t,n,r);else if(dc.TableReader.isTable(t)&&14===t.get_currentNodeType()){var o=new wc.e(1,r).get_valueAsTwips(),a=(0,f.e)(Ac.f,t.get_currentNode());this.setTableIndentLeftForNode(a,o,i)}hs.OutlineElementNavigator.returnToOutlineElement(t)},e.prototype.setTableIndentLeftForNode=function(e,t,n){void 0===n&&(n=!1),e&&o.r(Ac.f,e)&&(n?t?e.setValue(ks.j.paraIndentLeft,t):e.removeProperty(ks.j.paraIndentLeft):e.set_paraIndentLeft(t))},e.prototype.get_indentationEditor=function(){return yc.z.get_getOutlineElementIndentationEditor()},e.prototype.get_trackChangeManager=function(){return this._trackChangeManager||(this._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},e.prototype.get_trackChangeEditor=function(){return this._trackChangeEditor||(this._trackChangeEditor=se.w.get_instance().resolve(cc.x).get_instance())},e.prototype.get_listEditor=function(){return this._listEditor.get_value()},e.prototype.get_listReader=function(){return this._listReader.get_value()},e.prototype.get_outlineEditor=function(){return this._outlineEditor.get_value()},e.prototype.get_createParagraphStrategy=function(){return this._createParagraphStrategy},e.prototype.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.prototype.get_formattingPropertyTransitStrategy=function(){return this._formattingPropertyTransitStrategy},e.prototype.get_contentControlConverter=function(){return this._contentControlConverter||(this._contentControlConverter=se.w.get_instance().tryResolve(lc.t))},e.prototype.createOutlineElementNode=function(){var e=fc.i.get_instance().createInstance(393229);return e.setValue(Kc.b.outlineElementChildLevel,Cc.k.first),e.setValue(Kc.b.creationTimeStamp,new Date),e.updateLastModifiedTime(),e},e.prototype.createOutlineGroupNode=function(){var e=new pc.m;return e.setValue(Kc.b.outlineElementChildLevel,Cc.k.first),e},e.prototype.setAuthor=function(t,n,r){var i=t.get_containingObjectSpace();if(i){i.get_id().equals(e._cachedAuthorContainersSpace)||(e._cachedAuthorContainersSpace=i.get_id(),e._cachedAuthorContainers={});var o=e._cachedAuthorContainers[n];if(!(n in e._cachedAuthorContainers&&i.hasObject(o.get_id())&&i.get_currentRevision()&&i.get_currentRevision().isObjectReferenced(o.get_id()))){var a=new kc.t;a.setValue(Kc.b.author,n),o=i.registerSharedObject(a)}t.get_properties().setValue(r,o.get_id()),e._cachedAuthorContainers[n]=o}},e.prototype.setLastModifiedTime=function(e,t){e.get_properties().setValue(Kc.b.lastModifiedTime,t)},e.prototype.updateAuthorAndTimeStamp=function(e,t){void 0===t&&(t=null);var n=new as.GraphTransaction(7);n.setFromNode(e),t||(t=new Date),this.setLastModifiedTime(e,t),this.setAuthor(e,this.getUserName(),Kc.b.authorMostRecent),""===Ls.OutlineElementReader.getAuthor(e,Kc.b.authorOriginal)&&this.setAuthor(e,this.getUserName(),Kc.b.authorOriginal),n.dispose()},e.prototype.getUserName=function(){return Br.App.theUser.get_name()},e.prototype.duplicateRtl=function(e,t,n){if(void 0===n&&(n=!1),us.n.get_instance().get_item(56))if(Ls.OutlineElementReader.isRtlSet(e)){var r=Ls.OutlineElementReader.isRtl(e);n?this.setRtlSimple(t,r):this.setRtl(t,r)}else this.removeRtl(t);else if(us.n.get_instance().get_item(26)||us.n.get_instance().get_item(89)){r=Ls.OutlineElementReader.isRtl(e);n?this.setRtlSimple(t,r):this.setRtl(t,r)}},e.prototype.setTextDir=function(e,t){var n=new Da.GraphIterator;n.set(e),n.tryToRootAtAncestorOfType(11);var r=n.returnToAncestorOfType(11);if(Ls.OutlineElementReader.isRtlForView(r)!==t)if(this.setRtl(r,t),us.n.get_instance().get_item(54))e.get_anchor().invalidateViewChannelForAllViews(4);else{var i=1;t&&(i=3),e.setValue(Kc.b.layoutAlignmentInParent,i),e.setValue(Kc.b.layoutAlignmentSelf,i)}},e.prototype.setRtl=function(t,n){var r=new as.GraphTransaction(7);if(r.setFromNode(t),this.setRtlSimple(t,n),us.n.get_instance().get_item(26)){var i=new Da.GraphIterator;if(i.set(t),i.goToFirstChildByRole(2)&&cs.ParagraphReader.isParagraph(i)){var o=i.get_currentNode();n?(o.setProperty_Unchecked(qc.o.readingOrderRTL,!0),e.get_paragraphEditor().setJustification(o,3)):(o.removeProperty(qc.o.readingOrderRTL),e.get_paragraphEditor().setJustification(o,1))}}var a=new Da.GraphIterator;if(a.set(t),zc.q.get_instance().invalidateChildParagraphView(a),a.tryToRootAtAncestorOfType(10)){var s=a.returnToAncestorOfType(10);a.goToFirstChildByRole(1)===t&&this.get_outlineEditor().setRtl(s,n)}r.dispose()},e.prototype.setRtlSimple=function(e,t){var n=null,r=null;if(this.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_isConnected()){n=cs.ParagraphReader.getParagraphsUnderNode(e,!0,!0),r=new y.c(Pc.b);for(var i=0;i<n.get_count();i++)12===n.get_item(i).get_type()&&r.add(n.get_item(i).getCurrentFormatProperties())}if(t?e.get_properties().setValue(Kc.b.outlineElementRTL,!0):us.n.get_instance().get_item(56)?e.get_properties().setValue(Kc.b.outlineElementRTL,!1):(us.n.get_instance().get_item(26)||us.n.get_instance().get_item(89))&&e.get_properties().removeProperty(Kc.b.outlineElementRTL),this.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&n&&r)if(n.get_count()!==r.get_count())C.ULS.shipAssertTag(35973010,376,!1,"Paragraph count [{0}] doesn't match PreviousFormatProp count [{1}]",n.get_count(),r.get_count());else for(i=0;i<n.get_count();i++)this.get_trackChangeEditor().setParagraphFormatChange(n.get_item(i),r.get_item(i),this.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled())},e.prototype.removeRtl=function(e){e.get_properties().removeProperty(Kc.b.outlineElementRTL)},e.prototype.setIsBoilerText=function(e,t){e.get_properties().setValue(Kc.b.isBoilerText,t)},e.prototype.createParagraph=function(t,n,r){void 0===n&&(n=null),void 0===r&&(r=!1);var i=null,o=null;if(!Ls.OutlineElementReader.isOutlineElement(t))return C.ULS.sendTraceTag(40502923,307,15,"GraphIterator does not point to an outline element."),null;var a=null,s=null,l=0;n&&(a=n.formatting,s=n.style,l=n.languageId),r||this.getAboveAndBelowParagraphState(t,(0,p.m)((function(){return i}),(function(e){return i=e})),(0,p.m)((function(){return o}),(function(e){return o=e})));var c=_c.u.get_instance().createInstance(393230);if(c.setValue(Kc.b.richEditTextUnicode,""),t.addChild(c,2),t.goToChild(c),e.get_paragraphEditor().removeContent(c),e.get_paragraphEditor().makeDefaultParagraph(c),e.get_paragraphEditor().updateTextId(c),this.acquireAndApplyWordCoauthLockIfNeeded(c),a&&c.get_characterProperties().get_first().get_formatting().set_formattingId(a),l||(l=L.AFrameworkApplication.lcid),t.get_currentNode().setProperty_Unchecked(Kc.b.richTextLanguageId,t.get_currentNode().getValueWithDefault(Number,Kc.b.richTextLanguageId,l)),us.n.get_instance().get_item(54)&&t.get_currentNode().setValue(ks.j.paraTabCountInTheBeginning,0),us.n.get_instance().get_item(71)&&!us.n.get_instance().get_item(61)&&!s){var u=Tc.StyleReader.getStyleSetFromParagraphNode(c);u&&(s=u.getStyleById(Tc.StyleReader.styleIdNormal))}if(this._createParagraphStrategy.extendGraphNode(t),s&&e.get_styleEditor().setStyleOnParagraphNode(s,c,!0),!r&&i){var g=new Uc(i,o,i,new Fc.q(c),c.get_documentKindType());t.get_currentNode().getGraphSpace().get_graphTransactionOperations().addOperation(g)}return c},e.prototype.getAboveAndBelowParagraphState=function(e,t,n){var r=new Da.GraphIterator;r.setFrom(e),t.val=null,r.get_isFirstSibling()?r.get_currentNode().getGraphSpace().get_graphTransactionOperations().blockRttSend(6):(hs.OutlineElementNavigator.moveToPreviousOutlineElement(r,!0,!1),t.val=this.getGraphNodeStateFromIterator(r)),r.setFrom(e),n.val=this.getBelowParagraphState(r)},e.prototype.getBelowParagraphState=function(e){var t=new Da.GraphIterator;t.setFrom(e);var n=null;return t.get_isLastSibling()||(hs.OutlineElementNavigator.moveToNextOutlineElement(t,!0,!1),n=this.getGraphNodeStateFromIterator(t)),n},e.prototype.getGraphNodeStateFromIterator=function(e,t){void 0===t&&(t=!1);var n=hs.OutlineElementNavigator.moveToContent(e,!0);return n?this.getGraphNodeState(n,t):(C.ULS.sendTraceTag(8451733,355,15,"No paragraph node below OutlineElement"),null)},e.prototype.getGraphNodeState=function(e,t){return void 0===t&&(t=!1),12===e.get_type()?t?new Fc.q(e):new xc.k(e):(e.getGraphSpace().get_graphTransactionOperations().blockRttSend(5),new Ic.m(e))},e.prototype.createImage=function(e){this.removeContent(e);var t=fc.i.get_instance().createInstance(393233);return e.addChild(t,2),t},e.prototype.createEmbeddedFile=function(e){this.removeContent(e);var t=fc.i.get_instance().createInstance(393269);return e.addChild(t,2),t},e.prototype.cloneEmptyParagraphElement=function(e,t){var n=t.get_currentNode().clone();e.insertChild(n,null,1),e.goToChild(n),n.clonedFrom=t.get_currentNode(),hs.OutlineElementNavigator.moveToContent(t),1&t.get_invalidSubGraphCoreState()&&t.get_currentNode().validateProperties(null);var r=t.get_currentNode().clone();return r.styleCache=t.get_currentNode().styleCache,e.insertChild(r,null,2),e.goToChild(r),e.invalidateCoreChannel(1),r.clonedFrom=t.get_currentNode(),us.n.get_instance().get_item(55)&&r.setValue(ks.j.wordId,jc.K()),t.returnToNodeOfType(11),n},e.prototype.removeContent=function(e){e.goToFirstChildByRole(2)&&e.disconnectNodeAndReturnToParent()},e.prototype.replaceContentWithContentOfOutline=function(e,t){var n=e.get_currentNode();hs.OutlineElementNavigator.moveToContent(e);var r=e.get_currentNode();hs.OutlineElementNavigator.returnToOutlineElement(e),t.goToLastChildByRole(1),hs.OutlineElementNavigator.moveToContent(t),e.addChild(t.get_currentNode(),2),t.disconnectNodeAndReturnToParent();var i=new Da.GraphIterator;if(i.setFrom(t),i.goToFirstChildByRole(1)){var o=new Da.GraphIterator;o.setFrom(e);var a=new bc(null);if(!this.getValidParent(o,1,i.get_currentNode(),a))return;Ec.i(o,null,1,1,i,-1)}t.disconnectNodeAndReturnToParent();var s=null;for(e.goToPreviousSiblingByRole(1)&&(s=e.get_currentNode()),e.returnToParent();Sc.moveToFirstOutlineElement(t);)e.insertChild(t.get_currentNode(),s,1),s=t.get_currentNode(),t.disconnectNodeAndReturnToParent();e.goToChild(n),e.goToChild(r),e.disconnectNodeAndReturnToParent()},e.prototype.splitAtIp=function(t,n,r,i,o,a,s){void 0===s&&(s=!1);var l=Ls.OutlineElementReader.isOutlineElement(t),c=Ls.OutlineElementReader.isOutlineElement(n),u=r.get_isValid()&&r.get_contextId()===cl.V;l&&c&&u||C.ULS.sendTraceTag(594642515,307,15,"sourceOutlineElementIsValid:{0}; destinationOutlineElementIsValid:{1}; ipContextIsValid:{2}",l,c,u),this.removeContent(n);var g,p=n.get_currentNodeType(),d=t.get_currentNode(),h=null,_=null,m=null,y=!1;hs.OutlineElementNavigator.moveToContent(t);var S=t.get_currentNodeType();if(cs.ParagraphReader.isParagraph(t)){g=t.get_currentNode();var v=(0,f.e)(hc.AParagraphNode,g);v?v.get_characterProperties()&&v.get_characterProperties().get_length()||C.ULS.sendTraceTag(38925760,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",v):C.ULS.sendTraceTag(38925731,307,15,"srcParaNode is null"),_=new Fc.q(v),(y=r.get_cpBegin()===cs.ParagraphReader.textLength(g))&&(m=this.getBelowParagraphState(n));var b=n.get_currentNode();if(h=this.createParagraph(n,void 0,!0),e.get_paragraphEditor().splitParagraphAtIp(t,n,r,o,a,s),us.n.get_instance().get_item(71))if(i){var T=Tc.StyleReader.getStyleFromParagraphNode(g);T&&e.get_styleEditor().setStyleOnParagraphNode(T,h,!0)}else if(y){var A=Tc.StyleReader.getStyleFromParagraphNode(g);if(A){var I=A.getValueWithDefault(String,qc.o.nextStyle,null);if(I){var w=Tc.StyleReader.getStyleSetFromParagraphNode(h).getStyleById(I);e.get_styleEditor().setStyleOnParagraphNode(w,h,!1)}else e.get_styleEditor().setStyleOnParagraphNode(A,h,!0)}}this.duplicateRtl(d,b),this.get_listEditor().duplicateListLevelIfNecessary(d,b)}hs.OutlineElementNavigator.returnToOutlineElement(t),hs.OutlineElementNavigator.returnToOutlineElement(n);var x=Ls.OutlineElementReader.isEmpty(t,!0),F=Ls.OutlineElementReader.isEmpty(n,!0);if(us.n.get_instance().get_item(27)&&x&&!F){if(1&n.get_invalidSubGraphCoreState()){var E=new jr.LoadedCoreGraphIterator;E.setFrom(n),n.get_currentNode().validateProperties(E)}this.setAuthor(n.get_currentNode(),Ls.OutlineElementReader.getAuthor(t.get_currentNode(),Kc.b.authorMostRecent),Kc.b.authorMostRecent),this.setAuthor(n.get_currentNode(),Ls.OutlineElementReader.getAuthor(t.get_currentNode(),Kc.b.authorOriginal),Kc.b.authorOriginal),this.setLastModifiedTime(n.get_currentNode(),Ls.OutlineElementReader.getLastModifiedTime(t.get_currentNode()))}hs.OutlineElementNavigator.moveToContent(t);var P=(0,f.e)(hc.AParagraphNode,t.get_currentNode());P?P.get_characterProperties()&&P.get_characterProperties().get_length()||C.ULS.sendTraceTag(38925762,307,15,"srcParaNode: {0}. srcParaNode has no characterProperties",P):C.ULS.sendTraceTag(38925761,307,15,"srcPara is null");var k=new Fc.q(P);hs.OutlineElementNavigator.returnToOutlineElement(t);var D=h;if(D?D.get_characterProperties()&&D.get_characterProperties().get_length()||C.ULS.sendTraceTag(38925764,307,15,"paragraphNode: {0}. paragraphNode has no characterProperties.",D):(C.ULS.sendTraceTag(38925763,307,15,"paragraphNode is null"),C.ULS.sendTraceTag(40425482,307,50,"SplitAtIp state. {0}",{splittingAtEnd:y,moveText:a,overrideParagraphStyle:i,sourceOutlineElementContentNodeType:S,destinationOutlineElementNodeType:p,alwaysMoveEopToDestinationPara:s})),y){var M=new Uc(_,m,k,new Fc.q(D),D.get_documentKindType());n.get_currentNode().getGraphSpace().get_graphTransactionOperations().addOperation(M)}else{var R=void 0;R=a?new Wc(_,r.get_cpBegin(),k,new Fc.q(D),D.get_documentKindType()):new Wc(_,r.get_cpBegin(),new Fc.q(D),k,D.get_documentKindType()),n.get_currentNode().getGraphSpace().get_graphTransactionOperations().addOperation(R)}},e.prototype.canBeMerged=function(e,t){hs.OutlineElementNavigator.moveToContent(e);var n=cs.ParagraphReader.canContainIpOrTextRange(e.get_currentNode()),r=e.get_currentNode();return us.n.get_instance().get_item(14)&&(n=t?n&&!this.get_lockedRangeEditor().paragraphStartsInLockedRange(r):n&&!this.get_lockedRangeEditor().paragraphEndsInLockedRange(r)),hs.OutlineElementNavigator.returnToOutlineElement(e),n},e.prototype.merge=function(t,n,r,i,o,a,s,l){if(void 0===o&&(o=null),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===l&&(l=!1),t.get_currentNode().get_id()===n.get_currentNode().get_id())return!1;n.get_currentNode(),t.get_currentNode();var c,u,g=new Da.GraphIterator;if(g.setFrom(n),c=this.getGraphNodeStateFromIterator(g),g.setFrom(t),u=this.getGraphNodeStateFromIterator(g,!0),!this.canBeMerged(n,!0)||!this.canBeMerged(t,!1))return!1;if(this.get_lockedRangeEditor().get_isContentControlEditingEnabled()){hs.OutlineElementNavigator.moveToContent(t),hs.OutlineElementNavigator.moveToContent(n);var p=cs.ParagraphReader.isParagraph(t)?t.get_currentNode():null,d=cs.ParagraphReader.isParagraph(n)?n.get_currentNode():null;if(hs.OutlineElementNavigator.returnToOutlineElement(t),hs.OutlineElementNavigator.returnToOutlineElement(n),p&&d&&!this.get_lockedRangeEditor().canBeMergedWithContentControlBoundary(p,d,!1)){if(!this.get_contentControlConverter()||!this.get_lockedRangeEditor().canBeMergedWithContentControlBoundary(p,d,!0))return!1;this.get_contentControlConverter()&&(this.get_contentControlConverter().tryToConvertBlockContentControlToInlineBasedOnParagraph(p,!1),this.get_contentControlConverter().tryToConvertBlockContentControlToInlineBasedOnParagraph(d,!0))}}var h=!1;if(this.get_listReader().get_qoEListInternalCCPImprovementIsEnabled()){var _=(0,f.e)(hc.AParagraphNode,t.get_currentNode());h=(r||!_||!_.get_characterData().length)&&!mc.ListReader.isListOutlineElement(t)}else h=this._mergeListEditorInOutlineElementStrategy.useSourceListWithNonlistDestination(r,t);l||this.get_listEditor().merge(t,n,h,o),hs.OutlineElementNavigator.moveToContent(t);var m=t.get_currentNode().get_documentKindType();if(hs.OutlineElementNavigator.moveToContent(n),cs.ParagraphReader.isParagraph(n)){if(us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()){d=n.get_currentNode(),p=t.get_currentNode();var y=os.CoauthLockEditor.getInstance();if(y.shouldLockBlockEditing(this.get_lockedRangeEditor().getCoauthLockForParagraphOrImage(d))||y.shouldLockBlockEditing(this.get_lockedRangeEditor().getCoauthLockForParagraphOrImage(p)))return n.returnToParent(),t.returnToParent(),!1}var C=!1;if(mc.ListReader.get_isListMarkerEnabled()){var S=t.get_parentNode();S&&Ls.OutlineElementReader.isOutlineElementNode(S)&&(C=mc.ListReader.isListOutlineElementNode(S))}if(us.n.get_instance().get_item(71)){var v=cs.ParagraphReader.isEmpty(t)||r;if(v=v&&!C){var b=Tc.StyleReader.getStyleFromParagraph(n);b&&e.get_styleEditor().setStyleOnParagraphNode(b,t.get_currentNode(),!0)}}r&&this._formattingPropertyTransitStrategy.mergeParagraphProperties(n.get_currentNode(),t.get_currentNode(),C,s);var T=e.get_paragraphEditor().merge(t,n,r,i,a),A=g.get_currentNode(),I=t.get_currentNode();t.returnToParent(),T&&Ls.OutlineElementReader.isEmpty(n,!0)&&this.disconnectOutlineElement(n);var w=new Gc(u,c,new xc.k(A),m);return I.getGraphSpace().get_graphTransactionOperations().addOperation(w),!0}return n.returnToParent(),t.returnToParent(),!1},e.prototype.insertOutlineElementAt=function(e,t){void 0===t&&(t=!1);var n=new Da.GraphIterator;n.set(e.get_node()),n.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(n);var r=this.insertOutlineElementBelow(n),i=this.insertOutlineElementBelow(n);return this.splitAtIp(n,r,e,!1,!0,!0),Ls.OutlineElementReader.isEmpty(n,!1)&&(this.get_listEditor().removeList(n),n.disconnectNodeAndReturnToParent()),!Ls.OutlineElementReader.isEmpty(r,!1)||t&&Ls.OutlineElementReader.isLastOutlineElementInOutline(r)||(this.get_listEditor().removeList(r),r.disconnectNodeAndReturnToParent()),i},e.prototype.insertOutlineElementAsSibling=function(e,t,n,r,i,o){if(void 0===r&&(r=null),void 0===i&&(i=!1),void 0===o&&(o=!0),!this.canInsertOutlineElementAsSibling(e))return null;var a,s=e.get_currentNode(),l=!1;if(o){var c=mc.ListReader.isListOutlineElement(e),u=t||i||!Ls.OutlineElementReader.isEmpty(e,!1);l=this.get_listEditor().shouldTransferListInfo(c,u)}a=t?e.goToPreviousSiblingByRole(1):e.get_currentNode(),e.returnToParent();var g=this.get_outlineEditor().insertOutlineElementAsChild(e,a,n,r);return g?(this.duplicateRtl(s,g),o&&(this.get_listEditor().duplicateListLevelIfNecessary(s,g),l&&this.get_listEditor().transferListInfo(e,t,s,g)),g):null},e.prototype.canInsertOutlineElementAsSibling=function(e){if(Ls.OutlineElementReader.isOutlineElement(e)){var t=e.get_parentNode();if(vc.isOutlineOrTableCellNode(t)||Ls.OutlineElementReader.isOutlineElementNode(t)||Ls.OutlineElementReader.isOutlineGroupNode(t))return!0}return!1},e.prototype.removeContainingOutlineElement=function(e){var t=new Da.GraphIterator;t.set(e),t.tryToRootAtOutlineAncestor(),t.returnToNodeOfType(11);var n=null,r=null;this.getAboveAndBelowParagraphState(t,(0,p.m)((function(){return n}),(function(e){return n=e})),(0,p.m)((function(){return r}),(function(e){return r=e})));var i=-1;12===e.get_type()&&(i=e.get_documentKindType()),t.get_currentNode().getGraphSpace().get_graphTransactionOperations().addOperation(new Nc(this.getGraphNodeState(e,!0),n,r,i)),this.disconnectOutlineElement(t)},e.prototype.disconnectOutlineElement=function(e){if(e.hasChildrenOfRole(1)){var t=new Dc,n=new Da.GraphIterator;n.setFrom(e),this.getBelowOutlineElement(n,!1,!1,null,t)&&this.get_indentationEditor().demote(e,-t.depthNew,0)}e.disconnectNodeAndReturnToParent(),dc.TableReader.isInTable(e)&&this.postOutlineElementMove(e)},e.prototype.insertOutlineGroup=function(e,t,n){if(!vc.isOutline(e)&&!Ls.OutlineElementReader.isOutlineElement(e))return null;var r=this.createOutlineGroupNode();return n>0&&n<Cc.k.last&&r.setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,n)),e.insertChild(r,t,1),r},e.prototype.insertOutlineGroupAsSibling=function(e,t,n){if(!Ls.OutlineElementReader.isOutlineElement(e)&&!Ls.OutlineElementReader.isOutlineGroup(e)||!vc.isOutlineNode(e.get_parentNode())&&!Ls.OutlineElementReader.isOutlineElementNode(e.get_parentNode()))return null;var r,i=e.get_currentNode();r=n?e.goToPreviousSiblingByRole(1):e.get_currentNode(),e.returnToParent();var o=this.insertOutlineGroup(e,r,t);return e.goToChild(i),o},e.prototype.postOutlineElementMove=function(e){Ls.OutlineElementReader.isOutlineGroup(e)&&(e.hasChildrenOfRole(1)||e.disconnectNodeAndReturnToParent()),this.fixOutlineElementGroups(e,!1),this.adjustOEChildren(e)},e.prototype.fixOutlineElementGroups=function(e,t){var n,r=null;for(n=e.goToFirstChildByRole(1);n;){var i=!1;Ls.OutlineElementReader.isOutlineGroupNode(n)&&!e.hasChildrenOfRole(1)&&(i=!0);var o=n;if(n=e.goToNextSiblingByRoleOrReturnToParent(1),i){var a=new Da.GraphIterator;a.set(o),a.tryToRootAtOutlineAncestor(),a.disconnectNodeAndReturnToParent()}else if(Ls.OutlineElementReader.isOutlineGroupNode(o)){if(r){var s=new Da.GraphIterator;s.set(r);var l=new Da.GraphIterator;l.set(o),l.tryToRootAtOutlineAncestor(),s.addChild(l.get_currentNode(),1),l.disconnectNodeAndReturnToParent();var c=Ls.OutlineElementReader.getChildLevel(o);c===Cc.k.nil&&(c=1);var u=Ls.OutlineElementReader.getChildLevel(o),g=Math.max(0,u-c);g?o.setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,g)):(s.goToChild(o),e.goToFirstChildByRole(1),Ec.l(s),s.returnToParent()),t&&this.fixOutlineElementGroups(s,!0)}}else r=o}var p=null,d=Cc.k.last+1;for(n=e.goToFirstChildByRole(1);n;n=e.goToNextSiblingByRoleOrReturnToParent(1)){if(!Ls.OutlineElementReader.isOutlineGroup(e))return void e.returnToParent();d>(h=Ls.OutlineElementReader.getChildLevel(n))&&(d=h,p=n)}if(p){for(n=e.goToFirstChildByRole(1);n;n=e.goToNextSiblingByRoleOrReturnToParent(1))if(n!==p){var h=Ls.OutlineElementReader.getChildLevel(n);e.get_currentNode().setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,h-d))}d+=Ls.OutlineElementReader.getChildLevel(e.get_currentNode()),e.get_currentNode().setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,d));var _=new Da.GraphIterator;_.setFrom(e),_.goToChild(p),_.goToFirstChildByRole(1),Ec.l(_)}},e.prototype.getValidParent=function(e,t,n,r){e.get_currentNode();var i=Ls.OutlineElementReader.getChildLevel(e.get_currentNode());if(i===t)return!0;if(Ls.OutlineElementReader.isOutlineGroup(e))return!1;if(!e.getChildCountByRole(1)||this.isOnlyOutlineElement(e,n))return e.get_currentNode().setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,t)),!0;if(r.nodeToInsertAfter&&e.goToChild(r.nodeToInsertAfter)){if(Ls.OutlineElementReader.isOutlineGroup(e)&&i+Ls.OutlineElementReader.getChildLevel(e.get_currentNode())===t)return r.nodeToInsertAfter=e.goToLastChildByRole(1),e.returnToParent(),!0;e.returnToParent()}if(r.nodeToInsertAfter&&e.goToChild(r.nodeToInsertAfter)||!r.nodeToInsertAfter&&e.goToFirstChildByRole(1)){if(e.get_currentNode()!==n&&e.goToNextSiblingByRole(1)&&Ls.OutlineElementReader.isOutlineGroup(e)&&i+Ls.OutlineElementReader.getChildLevel(e.get_currentNode())===t)return r.nodeToInsertAfter=null,!0;e.returnToParent()}if(e.hasChild(n)&&this.isOnlyNonGroupChild(e,n)){for(var o=e.goToFirstChildByRole(1);o;o=e.goToNextSiblingByRoleOrReturnToParent(1))if(o!==n){var a=Ls.OutlineElementReader.getChildLevel(o);o.setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,a+(i-t)))}return e.get_currentNode().setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,t)),!0}if(i<t){var s=this.insertOutlineGroup(e,r.nodeToInsertAfter,t-i);return e.goToChild(s),r.nodeToInsertAfter=null,!0}if(i>t){e.get_currentNode().setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,t));var l=null;for(o=e.goToFirstChildByRole(1);o;)if(Ls.OutlineElementReader.isOutlineGroup(e))o.setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,i-t+Ls.OutlineElementReader.getChildLevel(o))),o=e.goToNextSiblingByRoleOrReturnToParent(1);else{l||(l=this.insertOutlineGroupAsSibling(e,i-t,!1));var c=o;(o=Ec.w(e,l,1))===l&&(o=e.goToNextSiblingByRoleOrReturnToParent(1)),r.nodeToInsertAfter===c&&(r.nodeToInsertAfter=l,l=null)}return!0}return!1},e.prototype.isOnlyOutlineElement=function(e,t){return Da.GraphIterator.executeWithDebugAssertRestored(e,(function(){if(1===e.getChildCountByRole(1)){var n=e.goToFirstChildByRole(1);if(e.returnToParent(),n===t)return!0}return!1}))},e.prototype.isOnlyNonGroupChild=function(e,t){return Da.GraphIterator.executeWithDebugAssertRestored(e,(function(){var n;for(n=e.goToFirstChildByRole(1);n;n=e.goToNextSiblingByRoleOrReturnToParent(1))if(n!==t&&!Ls.OutlineElementReader.isOutlineGroup(e))return e.returnToParent(),!1;return!0}))},e.prototype.getBelowOutlineElement=function(e,t,n,r,i){i.depthNew=0;do{var o=e.get_currentNode();if(!t&&e.goToFirstChildByRole(1))i.depthNew-=Ls.OutlineElementReader.getChildLevel(o);else{if(vc.isOutline(e))return!1;if(e.get_currentNode()===r)return!1;if(3===e.get_role()&&e.goToFirstSiblingByRole(1));else for(;!e.goToNextSiblingByRoleOrReturnToParent(1);)if(i.depthNew+=Ls.OutlineElementReader.getChildLevel(e.get_currentNode()),vc.isOutline(e)||e.get_currentNode()===r)return!1}}while(!n&&Ls.OutlineElementReader.isOutlineGroup(e));return!0},e.prototype.insertOutlineElementBelow=function(e,t){return void 0===t&&(t=!1),this.insertOutlineElement(e,!1,t)},e.prototype.insertOutlineElementAbove=function(e,t){return void 0===t&&(t=!1),this.insertOutlineElement(e,!0,t)},e.prototype.insertOutlineElement=function(e,t,n){void 0===n&&(n=!1);var r=new Da.GraphIterator;r.setFrom(e);var i=new Da.GraphIterator;return i.setFrom(r),this.insertOutlineElementAsSibling(i,t,!1,null,n),i.get_currentNode().setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,Ls.OutlineElementReader.getChildLevel(r.get_currentNode()))),r.goToFirstChildByRole(1)&&Ec.i(i,null,1,1,r,-1),i},e.prototype.adjustOEChildren=function(e){e.get_currentNode();if(Ls.OutlineElementReader.requiresStrictOutlineStructure(e)){1!==Ls.OutlineElementReader.getChildLevel(e.get_currentNode())&&e.get_currentNode().setValue(Kc.b.outlineElementChildLevel,Cc.k.first);for(var t=e.goToFirstChildByRole(1);t;)if(Ls.OutlineElementReader.isOutlineGroup(e)){var n=new Da.GraphIterator;n.setFrom(e),n.returnToParent();var r=new Da.GraphIterator;r.setFrom(e),r.goToFirstChildByRole(1),Ec.i(n,e.get_currentNode(),1,1,r,-1),t=e.disconnectNodeAndGoToNextSiblingByRoleOrReturnToParent(1)}else this.adjustOEChildren(e),t=e.goToNextSiblingByRoleOrReturnToParent(1)}},e.get_styleEditor=function(){return e._styleEditor||(e._styleEditor=se.w.get_instance().resolve(uc.e))},e.set_styleEditor=function(t){return e._styleEditor=t,t},e.get_paragraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=se.w.get_instance().resolve(gc.g))},e.set_paragraphEditor=function(t){return e._paragraphEditor=t,t},e._styleEditor=null,e._paragraphEditor=null,e._cachedAuthorContainersSpace=null,e._cachedAuthorContainers=null,e}();(0,o.l)($c,"OutlineElementEditor",null,[Es.p]);var Qc=n(5210),Jc=n(2182),Xc=n(1082),Yc=n(9905),Zc=n(7362),eu=function(){function e(e){this._outlineElementNodeIdFactory=null,this._outlineElementNodeIdFactory=e}return e.prototype.createOutlineNode=function(e){void 0===e&&(e=!1);var t=_c.u.get_instance().createInstance(393228);return t.setValue(Kc.b.outlineElementChildLevel,Cc.k.first),t.setValue(Kc.b.bodyTextAlignment,0),e||t.setValue(Kc.b.layoutMaxWidth,vc.defaultOutlineWidth),new Xc.OutlineIndentInfo(!0).saveToProperty(t),t},e.prototype.appendOutlineElement=function(t,n,r){void 0===r&&(r=null);var i=t.get_currentNode();return t.goToLastChildByRole(1)?(Ls.OutlineElementReader.isOutlineGroup(t)&&hs.OutlineElementNavigator.moveToOutlineElement(t,!0),Ls.OutlineElementReader.isOutlineElement(t)?e.get_outlineElementEditor().insertOutlineElementAsSibling(t,!1,n,r):(t.returnToNode(i),null)):this.insertOutlineElementAsChild(t,null,n,r)},e.prototype.canInsertOutlineElementAsChild=function(e){return vc.isOutlineViewLevelNode(e.get_currentNode())||Ls.OutlineElementReader.isOutlineElement(e)||Ls.OutlineElementReader.isOutlineGroup(e)||Zc.isTableCell(e)},e.prototype.insertOutlineElementAsChild=function(t,n,r,i){if(void 0===n&&(n=null),void 0===r&&(r=!1),void 0===i&&(i=null),!this.canInsertOutlineElementAsChild(t))return null;var o=e.get_outlineElementEditor().createOutlineElementNode();return this.setRtlForOutlineElementNode(o,t),t.insertChildUsingId(o,n,1,this._outlineElementNodeIdFactory.generateOutlineElementNodeId()),t.goToChild(o),r&&(e.get_outlineElementEditor().createParagraph(t,i),hs.OutlineElementNavigator.returnToOutlineElement(t)),us.n.get_instance().get_item(25)&&e.get_outlineElementEditor().updateAuthorAndTimeStamp(t.get_currentNode()),o},e.prototype.setRtlForOutlineElementNode=function(t,n){var r=this.getRtlStorageNodeForAnyOutlineElementParent(n);if(r)switch(r.get_type()){case 11:e.get_outlineElementEditor().duplicateRtl(r,t,!0);break;case 8:var i=e.get_pageReader().isRtl(r);e.get_outlineElementEditor().setRtlSimple(t,i)}},e.prototype.getRtlStorageNodeForAnyOutlineElementParent=function(e){return this._outlineElementNodeIdFactory.getRtlStorageNodeForOutlineElementParent(e)},e.prototype.getDefaultOutlinePosition=function(t,n,r){var i=e.get_pageReader().getMarginOrigin(t),o=vc.defaultHorizontalOffset*(n?-1:1);return new Jc.i(i.get_x()+o,i.get_y()+vc.defaultVerticalOffset)},e.prototype.setOutlineToDefaultPosition=function(e,t){if(us.n.get_instance().get_item(17)){var n=new Da.GraphIterator;n.set(e),n.tryToRootAtPageContent();var r=this.getDefaultOutlinePosition(n.get_origin(),vc.isRtlForView(e),t);Yc.m(e,r.get_x(),r.get_y())}},e.prototype.setRtl=function(e,t){if(!us.n.get_instance().get_item(43)||!Hr.n(e)){var n=t?11:9;e.setValue(Kc.b.layoutAlignmentSelf,n)}},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=se.w.get_instance().resolve(Es.p))},e.set_outlineElementEditor=function(t){return e._outlineElementEditor=t,t},e.get_formatEditor=function(){return e._formattingEditor||(e._formattingEditor=se.w.get_instance().resolve(xs.z))},e.set_formatEditor=function(t){return e._formattingEditor=t,t},e._outlineElementEditor=null,e._formattingEditor=null,e}();(0,o.l)(eu,"OutlineEditor",null,[rc.a]);var tu=function(){function e(){}return e.prototype.get_name=function(){return"Box4.OutlineLevelEditors"},e.prototype.configure=function(e){!function(e){e.register(eu).as(rc.a).singleInstance().usingFactory((function(){return new eu(e.resolve(ic.z))})),e.register($c).as(Es.p).singleInstance().usingFactory((function(){return new $c(e.resolveLazy(rc.a),e.resolveLazy(rs.v),e.resolveLazy(ts.c),e.resolve(oc),e.resolve(ac.j),e.resolve(sc.x))}))}(e)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(tu,"Box4OutlineLevelEditorsPackage",null,[l.u,c.s]);var nu=function(){function e(){}return e.prototype.get_name=function(){return"Box4.TableEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(nu,"Box4TableEditorsPackage",null,[l.u,c.s]);var ru=function(){function e(){}return e.prototype.get_name=function(){return"Box4.TextLevelEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(ru,"Box4TextLevelEditorsPackage",null,[l.u,c.s]);var iu=n(4343),ou=n(5512),au=(0,o.y)("IReactContextualUILauncher"),su=n(1078),lu=n(6701),cu=n(5326),uu=(0,o.y)("ILanguageEditor"),gu=n(4599),pu=n(8775),du=(0,o.y)("IAutoCorrectOptionsDialog"),hu=(0,o.y)("ILanguageListHelper"),_u=(0,o.y)("IProofingRepeatedWordSectionBuilder"),mu=(0,o.y)("IProofingContextMenuSectionFactory"),fu=n(6678),yu=n(3220),Cu=n(2121),Su=function(e){function t(){var t=e.call(this)||this;return t.CommandMenuOpen=null,t.CommandMenuClose=null,t}return(0,S.t)(t,e),t}(oa);(0,o.l)(Su,"ContextMenuRootProperties",oa,[]);var vu="ContextMenuRootName",bu=function(){function e(e){var t=this;this._root=null;var n=new Su;n.ImageSideArrow=L.AFrameworkApplication.get_imageClusterPath(),n.ImageSideArrowClass=Lt.getImageClass("SubmenuFlyoutArrow_13x13x32"),n.TextDirection=Box4Intl.Box4Strings.L_RibbonOptionTextDirection,n.CommandMenuOpen="3133826319",this._root=new Cu.ContextMenuRoot(vu,n),e.execute((function(e){t._root.set_rootUser(e)})),this._root.refresh(),L.AFrameworkApplication.get_theActionManager().addAction(te.Vj,nt.a,Ze.ActionManager.doNothingButReportHandler),L.AFrameworkApplication.get_theActionManager().addAction(te.Fj,nt.a,Ze.ActionManager.doNothingButReportHandler)}return e.prototype.get_theRoot=function(){return this._root},e.prototype.dispose=function(){this._root&&(this._root.dispose(),this._root=null)},e.prototype.showContextMenu=function(e,t){this.showContextMenuAt(e,t.get_clientPoint(),t.get_inputSource())},e.prototype.createContextMenu=function(e,t,n,r,i){this.get_theRoot().createContextMenu(e,t,n,r,i)},e.prototype.showContextMenuAtLauncher=function(e,t,n,r){void 0===r&&(r=null),Bt.g.measureTimeToNextFrame(this.get_theRoot().get_activeFloatie()?"ShowLegacyContextMenuAndFloatie":"ShowLegacyContextMenu",""),Br.App.get_activeAppFrame().forceUpdateCommandUI(),this.pollForStateAndUpdateInternal(),this.get_theRoot().showContextMenuAtLauncher(e,t,n),this.get_theRoot().get_activeFloatie()?L.AFrameworkApplication.get_theActionManager().processAction(te.Fj,2):L.AFrameworkApplication.get_theActionManager().processAction(te.Vj,2)},e.prototype.showContextMenuAt=function(e,t,n){this.showContextMenuAtLauncher(e,new Sys.UI.Bounds(t.x,t.y,0,0),n)},e.prototype.pollForStateAndUpdateInternal=function(){this.get_theRoot().get_root().pollForStateAndUpdate()},e.prototype.dismissAllTransientUI=function(){return this.get_theRoot().dismissAllTransientUI()},e.prototype.showContextMenuWithFloatie=function(e,t,n,r){var i=this.get_theRoot(),o=!1,a=(0,f.e)(Ki.u,n);return i.set_activeFloatie(a),r.showContextMenuForSelection(e,t),i.get_activeMenu()?a&&(a.positionFloatieWithContextMenu(i,t),o=!0):(C.ULS.sendTraceTag(4801985,324,15,"Failed to launch the context menu!  Menu type:  {0}.",r.currentSelectionType()),i.set_activeFloatie(null)),o},e}();(0,o.l)(bu,"AContextMenuController",null,[iu.k,Sys.IDisposable]);var Tu=n(2113),Au=function(){function e(e){this._repeatedWordSectionBuilder=null,this._repeatedWordSectionBuilder=e}return e.prototype.create=function(e,t){var n=new Sys.StringBuilder;return this.createSpellingErrorSection(n,e,t),this.createIgnoreSpellingErrorSection(n,e),n.toString()},e.prototype.createMenuSectionProps=function(e,t){var n=new Array(0);return this.createSpellingErrorSectionProps(n,e,t),this.createIgnoreSpellingErrorSectionProps(n,e),n},e.prototype.createSpellingErrorSection=function(e,t,n){switch(t.get_errorType()){case 0:e.append(this._repeatedWordSectionBuilder.build());break;case 1:case 2:e.append(this.buildContextMenuXml(t,n))}},e.prototype.createSpellingErrorSectionProps=function(e,t,n){switch(t.get_errorType()){case 0:e.push(this._repeatedWordSectionBuilder.buildSectionProps());break;case 1:case 2:e.push(this.buildContextMenuSectionProps(t,n))}},e.prototype.createIgnoreSpellingErrorSection=function(e,t){us.n.get_instance().get_item(92)||(e.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),e.append(Tu.yL("btnIgrnoreSpellingError",(2===t.get_errorType()?ii.Xq:ii.Rv).toString(),Box4Intl.Box4Strings.l_IgnoreSpellingError,null)),e.append("</Controls></MenuSection>"))},e.prototype.createIgnoreSpellingErrorSectionProps=function(e,t){if(!us.n.get_instance().get_item(92)){var n=(0,O.m)(new pa.x,{ControlList:[]}),r=2===t.get_errorType()?"UnknownSpellingError":"IgnoreSpellingError";Array.add(n.ControlList,(0,O.m)(new da.k,{ExternalId:r})),e.push(n)}},e.prototype.buildContextMenuXml=function(e,t){var n=this.generateSuggestionsMenuXml(e.get_suggestions(),t);return n.length>0?Tu.OU("msUnknownWord",Tu.IV(null,n),"Menu16"):Tu.OU("msUnknownWord",Tu.IV(null,[Tu.yL("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)]),"Menu16")},e.prototype.generateSuggestionsMenuXml=function(e,t){var n=[];if(e)for(var r=Math.min(t.length,e.length),i=0;i<r;++i)e[i]&&n.push(Tu.yL("btnCorrectWord"+i,t[i].toString(),e[i]));return n},e.prototype.buildContextMenuSectionProps=function(e,t){var n=(0,O.m)(new pa.x,{Id:"Suggestions",ControlList:[]});if(this.generateSuggestionsButtons(e.get_suggestions(),t,n.ControlList),n.ControlList.length<=0){var r=(0,O.m)(new da.k,{ExternalId:"NoSuggestions"});Array.add(n.ControlList,r)}return n},e.prototype.generateSuggestionsButtons=function(e,t,n){if(e)for(var r=Math.min(t.length,e.length),i=0;i<r;++i)if(e[i]){var o=(0,O.m)(new da.k,{ExternalId:"btnCorrectWord"+i,Command:t[i].toString(),LabelText:e[i]});Array.add(n,o)}},e}();(0,o.l)(Au,"DefaultProofingContextMenuCreator",null,[]);var Iu=n(8323),wu=n(9235),xu=function(){function e(){}return e.proofingSection="faProofing",e}();(0,o.l)(xu,"ContextMenuControlId",null,[]);var Fu=n(6312),Eu=function(){return function(){this.Text=null,this.Level=0,this.Source=null,this.Action=0,this.BucketId=0,this.Description=null,this.NumberOfInstances=0}}();(0,o.l)(Eu,"Suggestion",null,[]);var Pu=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.get_ControlType=function(){return 3},t}(da.k);(0,o.l)(Pu,"CompoundButtonProps",da.k,[]);var ku=n(4625),Du=function(){function e(e,t,n,r,i,o,a){this._repeatedWordSectionBuilder=null,this._isDisplaySuggestionDescriptionsEnabled=!1,this._isProofingSecondaryContextualMenuEnabled=!1,this._isIgnoreAllEnabled=!1,this._iconImage=null,this._imageClusterName=null,this._imageClusterPath=null,this._proofingFeatureConfiguration=null,this._ignoreAllKeywords=null,this._formattingReader=null,this._proofingFeatureConfiguration=t,this._repeatedWordSectionBuilder=e,this._isDisplaySuggestionDescriptionsEnabled=t.get_isDisplaySuggestionDescriptionsEnabled(),this._isProofingSecondaryContextualMenuEnabled=t.get_isProofingSecondaryContextualMenuEnabled(),this._isIgnoreAllEnabled=o,this._imageClusterName=r,this._imageClusterPath=i,this._ignoreAllKeywords=n,this._formattingReader=a,this._iconImage=new Iu.n(Fu.t,String),this._iconImage.set_item(1,"SpellingIssue_16x16x32"),this._iconImage.set_item(2,"GrammarIssue_16x16x32"),this._iconImage.set_item(3,"WritingIssue_16x16x32"),this._iconImage.set_item(4,null),this._iconImage.set_item(0,null)}return e.prototype.create=function(e,t,n){var r=(0,f.e)(wu.v,t);if(!r)return C.ULS.sendTraceTag(25007833,375,15,"Expect EditorServiceErrorDetails."),"";var i=new Sys.StringBuilder,o=this.getLanguageFromSelection(e);return this.createSpellingErrorSection(i,r,n,o),this.createIgnoreSpellingErrorSection(i,r),this.createProofingErrorSection(i,r,o),i.toString()},e.prototype.createMenuSectionProps=function(e,t,n){var r=(0,f.e)(wu.v,t);if(!r)return C.ULS.sendTraceTag(39188232,375,15,"Expect EditorServiceErrorDetails."),new Array(0);var i=new Array(0),o=this.getLanguageFromSelection(e);return this.createSpellingErrorSectionProps(i,r,n,o),this.createIgnoreSpellingErrorSectionProps(i,r),this.createProofingErrorSectionMenu(i,r,o),i},e.prototype.createSpellingErrorSection=function(e,t,n,r){void 0===r&&(r=null),t.get_errorType()?1===t.get_errorType()&&(this.errorIsIgnored(t)||e.append(this.buildContextMenuXml(t,n,r))):e.append(this._repeatedWordSectionBuilder.build())},e.prototype.createSpellingErrorSectionProps=function(e,t,n,r){void 0===r&&(r=null),t.get_errorType()?1===t.get_errorType()&&(this.errorIsIgnored(t)||e.push(this.buildContextMenuSection(t,n,r))):e.push(this._repeatedWordSectionBuilder.buildSectionProps())},e.prototype.createIgnoreSpellingErrorSection=function(e,t){if(!us.n.get_instance().get_item(92)){var n=new Sys.StringBuilder;this.showProofingIgnoreAll(t)?n.append(Tu.yL("btnIgnoreAllSpellingError",(2===t.get_errorType()?ii.Xq:ii.bN).toString(),Box4Intl.Box4Strings.l_IgnoreAllSpellingErrors,null)):this.errorIsIgnored(t)||n.append(Tu.yL("btnIgrnoreSpellingError",this.getIgnoreOnceCommand(t.get_errorType()).toString(),Box4Intl.Box4Strings.l_IgnoreOnceSpellingError,null)),this.showSettings(t)&&(this._proofingFeatureConfiguration.get_isDoNotCheckThisIssueEnabled()&&n.append(Tu.yL("btnDoNotCheckForThisIssue","2157977488",Box4Intl.Box4Strings.l_DoNotCheckForThisIssue,null)),n.append(Tu.yL("btnGrammarOptions","3380187414",Jn.l.xmlEncode(Box4Intl.Box4Strings.l_GrammarOptions),null))),n.isEmpty()||(e.append('<MenuSection Id="msIgnoreSpellingError" DisplayMode="Menu16"><Controls>'),e.append(n.toString()),e.append("</Controls></MenuSection>"))}},e.prototype.createIgnoreSpellingErrorSectionProps=function(e,t){if(!us.n.get_instance().get_item(92)){var n=(0,O.m)(new pa.x,{ControlList:[]});if(this.showProofingIgnoreAll(t)){var r=(0,O.m)(new da.k,{ExternalId:2===t.get_errorType()?"UnknownAllSpellingError":"IgnoreAllSpellingError"});Array.add(n.ControlList,r)}else if(!this.errorIsIgnored(t)){var i=(0,O.m)(new da.k,{ExternalId:"btnIgrnoreSpellingError",Command:this.getIgnoreOnceCommand(t.get_errorType()).toString(),LabelText:Box4Intl.Box4Strings.l_IgnoreOnceSpellingError});Array.add(n.ControlList,i)}if(this.showSettings(t)){if(this._proofingFeatureConfiguration.get_isDoNotCheckThisIssueEnabled()){var o=(0,O.m)(new da.k,{ExternalId:"DoNotCheckForThisIssue"});Array.add(n.ControlList,o)}var a=(0,O.m)(new da.k,{ExternalId:"GrammerSettingsContext"});Array.add(n.ControlList,a)}e.push(n)}},e.prototype.getLanguageFromSelection=function(e){if(!this._formattingReader)return null;var t=this._formattingReader.language(this._formattingReader.getFormattingObject(e.get_firstContext()));return Kt.i.getCultureInfo(t).get_name()},e.prototype.getIgnoreOnceCommand=function(e){return 2===e?ii.Xq:this._proofingFeatureConfiguration.get_isIgnoreProofingCommandEnabled()?ii.ct:ii.Rv},e.prototype.createProofingErrorSection=function(e,t,n){if(void 0===n&&(n=null),this.shouldCreateSecondaryContextMenu(t)){var r=Jn.l.xmlEncode(t.get_critiqueObject().CategoryTitle),i=Tu.Tj(xu.proofingSection,te.Hx,this._iconImage.get_item(t.get_proofingType()),""!==r?r:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,[e.toString()],this._imageClusterName,this._imageClusterPath),o=Tu.IV("cgProofingOuter",[i]);e.clear(),e.append(Tu.OU("msProofingOuter",o,"Menu16",void 0,void 0,n,"ariaLabelledById")),C.ULS.sendTraceTag(36508632,375,50,"Show 2-level context menu of type {0}, critique id {1}",t.get_proofingType(),t.get_typeId())}},e.prototype.createProofingErrorSectionMenu=function(e,t,n){if(void 0===n&&(n=null),this.shouldCreateSecondaryContextMenu(t)){var r=Jn.l.xmlEncode(t.get_critiqueObject().CategoryTitle),i=(0,O.m)(new ua.b,{ExternalId:String.format("{0}_{1}",xu.proofingSection,t.get_proofingType()),Command:"798637440",Image16by16Class:this._iconImage.get_item(t.get_proofingType()),LabelText:""!==r?r:Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle,Lang:n,Menu:(0,O.m)(new ga.b,{ExternalId:"ProofingSubMenu",UpdateDynamically:!0,ShouldAutoOpen:!0,AriaLabel:this.getAriaLabelForMenu(t),AriaRoleDescription:Box4Intl.Box4Strings.l_SuggestionsMenuAriaRoleDescription,MenuSectionList:[]})});Array.addRange(i.Menu.MenuSectionList,e),Array.clear(e);var o=(0,O.m)(new pa.x,{ControlList:[]});Array.add(o.ControlList,i),e.push(o),C.ULS.sendTraceTag(39188234,375,50,"Show 2-level context menu of type {0}, critique id {1}",t.get_proofingType(),t.get_typeId())}},e.prototype.buildContextMenuXml=function(e,t,n){void 0===n&&(n=null);var r=this.getEncodedMenuSectionTitle(e),i=[],o=!1,a=e.get_critiqueObject().Suggestions;if(a)if(a=a.slice(0,Math.min(3,a.length)),this._isDisplaySuggestionDescriptionsEnabled&&(o=!ku.s(Eu,a,(function(e){return!e||!e.Description}))),1!==a.length||a[0].Action){var s=0,l=null;o&&(l="font-weight: bold;");for(var c=0,u=a;c<u.length;c++){var g=u[c];if(g){var p=null,d="";_=Jn.l.xmlEncode(g.Text);o&&(p=this.getButtonDescription(g.Description),d=this.getButtonAriaDescription(g.Description)),i.push(Tu.yL("btnCorrectWord"+s,t[s].toString(),_,null,null,null,null,null,l,null,p,null,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormatForSuggestionDescriptions,r,_),"ariaLabelledById",String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,e.get_token(),this.convertStringToCommaDelimitedString(e.get_token())),"ariaDescribedById",d)),s++}}}else{var h=a[0],_=Jn.l.xmlEncode(h.Text);i.push(Tu.yL("btnCorrectWord0","3587447601",_,null,null,null,null,null,null,null,void 0,void 0,void 0,void 0,String.format(Box4Intl.Box4Strings.l_SuggestionsAriaLabelFormat,r,_)))}var m,f="Menu16";return i.length>0?(m=i,o&&(f="Menu16DescriptionEnabled")):m=[Tu.yL("btnNoSuggestions","3587447601",Box4Intl.Box4Strings.l_NoSuggestions,null)],Tu.OU("msUnknownWord",Tu.IV(null,m),f,r,this.getMenuSectionImage(e),n,"ariaLabelledById")},e.prototype.buildContextMenuSection=function(e,t,n){void 0===n&&(n=null);var r=1!==e.get_proofingType()&&0!==e.get_proofingType()?e.get_critiqueObject().ExplanationTitle:"",i=(0,O.m)(new pa.x,{Title:r,Lang:n,ControlList:[]}),o=!1,a=e.get_critiqueObject().Suggestions;if(a)if(a=a.slice(0,Math.min(3,a.length)),this._isDisplaySuggestionDescriptionsEnabled&&(o=!ku.s(Eu,a,(function(e){return!e||!e.Description}))),1!==a.length||a[0].Action)for(var s=0,l=0,c=a;l<c.length;l++){if(h=c[l]){var u=null,g="";if(o&&(u=this.getButtonDescription(h.Description),g=this.getButtonAriaDescription(h.Description)),s>=t.length)break;if(u){p=(0,O.m)(new Pu,{ExternalId:String.format("{0}{1}_{2}_compoundButton","btnCorrectWord",s,e.get_proofingType()),Command:t[s].toString(),LabelText:h.Text,Description:u,Lang:n,AriaDescription:g});Array.add(i.ControlList,p)}else{var p=(0,O.m)(new da.k,{ExternalId:String.format("{0}{1}_{2}_button","btnCorrectWord",s,e.get_proofingType()),Command:t[s].toString(),LabelText:h.Text,Lang:n,RoleInMenu:"menuitem"});Array.add(i.ControlList,p)}s++}}else{var d=a[0],h=(0,O.m)(new da.k,{ExternalId:"NoSuggestion",Command:"3587447601",LabelText:d.Text});Array.add(i.ControlList,h)}return i.ControlList.length<=0&&Array.add(i.ControlList,(0,O.m)(new da.k,{ExternalId:"btnNoSuggestions",Command:"3587447601",LabelText:Box4Intl.Box4Strings.l_NoSuggestions})),i},e.prototype.getEncodedMenuSectionTitle=function(e){var t=1!==e.get_proofingType()&&0!==e.get_proofingType()?e.get_critiqueObject().ExplanationTitle:"";return Jn.l.xmlEncode(t)},e.prototype.getMenuSectionImage=function(e){return this.shouldCreateSecondaryContextMenu(e)?null:this._iconImage.get_item(e.get_proofingType())},e.prototype.shouldCreateSecondaryContextMenu=function(e){return this._isProofingSecondaryContextualMenuEnabled&&2!==e.get_errorType()&&(1!==e.get_errorType()||!this.errorIsIgnored(e))},e.prototype.showProofingIgnoreAll=function(e){return this._isIgnoreAllEnabled&&!!e.get_errorType()&&1===e.get_proofingType()&&!this.errorIsIgnored(e)},e.prototype.getAriaLabelForMenu=function(e){return 1===e.get_proofingType()?String.format(Box4Intl.Box4Strings.l_SuggestionsNotInDictionaryAriaLabelFormat,e.get_token(),this.convertStringToCommaDelimitedString(e.get_token())):""},e.prototype.showSettings=function(e){return this._proofingFeatureConfiguration.get_isProofingSettingEnabled()&&this._isProofingSecondaryContextualMenuEnabled&&1===e.get_errorType()&&(2===e.get_proofingType()||3===e.get_proofingType())},e.prototype.errorIsIgnored=function(e){return!!e.get_errorType()&&!!this._ignoreAllKeywords&&this._ignoreAllKeywords.contains(e.get_token(),e.get_lcid())},e.prototype.getButtonDescription=function(e){return""===e?String.format(Box4Intl.Box4Strings.l_NoReferenceInformation):e},e.prototype.getButtonAriaDescription=function(e){return""!==e?String.format(Box4Intl.Box4Strings.l_SuggestionDescriptionAriaDescribedByFormat,e):""},e.prototype.convertStringToCommaDelimitedString=function(e){var t="";if(e){var n=0;for(n=0;n<e.length-1;n++)t=t+e.charAt(n)+",";t+=e.charAt(n)}return t},e}();(0,o.l)(Du,"EditorServiceProofingContextMenuCreator",null,[]);var Mu=function(){function e(e,t){this._defaultCreator=null,this._editorServiceCreator=null,this._suggestionCommands=null,this._defaultCreator=e,this._editorServiceCreator=t,this._suggestionCommands=[ii.fd,ii.kL,ii.hY,ii.sS,ii.hE]}return e.prototype.create=function(e,t){return t?o.r(wu.v,t)?this._editorServiceCreator.create(e,t,this._suggestionCommands):this._defaultCreator.create(t,this._suggestionCommands):""},e.prototype.createProps=function(e,t){return t?o.r(wu.v,t)?this._editorServiceCreator.createMenuSectionProps(e,t,this._suggestionCommands):this._defaultCreator.createMenuSectionProps(t,this._suggestionCommands):null},e}();(0,o.l)(Mu,"ProofingContextMenuSectionFactory",null,[mu]);var Ru=function(){function e(){}return e.prototype.build=function(){var e=[Tu.yL("btnDeleteRepeatedWord","2023591105",Box4Intl.Box4Strings.l_DeleteRepeatedWord,null)];return Tu.OU("msRepeatedWord",Tu.IV(null,e),"Menu16")},e.prototype.buildSectionProps=function(){var e=(0,O.m)(new pa.x,{ControlList:[]}),t=(0,O.m)(new da.k,{ExternalId:"DeleteRepeatedWord"});return Array.add(e.ControlList,t),e},e}();(0,o.l)(Ru,"ProofingRepeatedWordSectionBuilder",null,[_u]);var Lu=n(1557),Nu=n(589),Bu=function(){function e(e,t){this._isVisible=!1,this._contextualUILauncher=null,this._externalUICommandDefinitionMapping=null,this._hasShynessBehavior=!0,this.$$pf_PreventDismissOnMouseMove=!1,this.$$pf_PreventDismissOnClick=!1,this._contextualUILauncher=e,this._externalUICommandDefinitionMapping=t}return e.prototype.get_preventDismissOnMouseMove=function(){return this.$$pf_PreventDismissOnMouseMove},e.prototype.set_preventDismissOnMouseMove=function(e){return this.$$pf_PreventDismissOnMouseMove=e,e},e.prototype.get_preventDismissOnClick=function(){return this.$$pf_PreventDismissOnClick},e.prototype.set_preventDismissOnClick=function(e){return this.$$pf_PreventDismissOnClick=e,e},e.prototype.get_isVisible=function(){return this._isVisible},e.prototype.get_controls=function(){return null},e.prototype.get_hasShynessBehavior=function(){return this._hasShynessBehavior},e.prototype.set_hasShynessBehavior=function(e){return this._hasShynessBehavior=e,e},e.prototype.positionFloatieWithContextMenu=function(e,t){},e.prototype.dismissFloatie=function(e){return void 0===e&&(e=null),this._contextualUILauncher.dismissFloatie(),!0},e.prototype.ensureContextMenuDismissed=function(){},e.prototype.showFloatieAt=function(e,t,n,r){void 0===r&&(r=!1),this._contextualUILauncher.showFloatie((0,O.m)(new Lu.s,{x:e.x,y:e.y}),this.getActiveFloatieGroups(n),n)},e.prototype.getFloatieBounds=function(){return new Sys.UI.Bounds(0,0,0,0)},e.prototype.disposeRoot=function(){},e.prototype.dismissAllTransientUI=function(){return this.dismissFloatie()},e.prototype.getActiveFloatieGroups=function(e){return new Array(0)},e}();(0,o.l)(Bu,"ReactFloatie",null,[Ki.u,Nu.q]);var Ou=function(){function e(e){this._currentFloatie=null,this._contextualUILauncher=null,this._contextualUILauncher=e}return e.prototype.dispose=function(){},e.prototype.dismissAllTransientUI=function(){return this._contextualUILauncher.dismissContextualUI(),!0},e.prototype.showContextMenu=function(e,t){this.showContextMenuAt(e,t.get_clientPoint(),t.get_inputSource())},e.prototype.showContextMenuAt=function(e,t,n){this.showContextMenuAtLauncher(e,new Sys.UI.Bounds(t.x,t.y,0,0),n),C.ULS.sendTraceTag(39195875,207,50,"React ContextMenu launched for Id: {0}",e)},e.prototype.showContextMenuAtLauncher=function(e,t,n,r){void 0===r&&(r=null),this._currentFloatie?this._contextualUILauncher.showContextMenuAndFloatie((0,O.m)(new Lu.s,{x:t.x,y:t.y}),this._currentFloatie.getActiveFloatieGroups(n),n):this._contextualUILauncher.showContextMenu((0,O.m)(new Lu.s,{x:t.x,y:t.y}),n,void 0,r),this._currentFloatie=null},e.prototype.showContextMenuWithFloatie=function(e,t,n,r){return this._currentFloatie=(0,f.e)(Bu,n),r.showContextMenuForSelection(e,t),!0},e.prototype.createContextMenu=function(e,t,n,r,i){},e}();(0,o.l)(Ou,"ReactContextMenuController",null,[iu.k,Sys.IDisposable]);var Uu=n(5463),Hu=n(8654),Gu=function(){return function(){this.originalActionId=0,this.actionToRun=0,this.actionData=null,this.mustRecurse=!1,this.earlyReturnBool=null}}();(0,o.l)(Gu,"CuiEnabledInfo",null,[]);var Vu=function(){return function(){this.originalActionId=0,this.actionToRun=0,this.actionData=null,this.haveCachedValue=!1,this.executeAsync=!1,this.isQueryCommand=!1,this.isQuerySpinnerCommand=!1,this.isQueryCommandRunAsExecute=!1,this.mustRecurse=!1,this.earlyReturnBool=null}}();(0,o.l)(Vu,"CuiExecuteInfo",null,[]);var Wu=function(){return function(){this.styleProperties=null,this.isHighlightedStyleDiffFromSelection=!1,this.styleProperties=new kc.t,this.isHighlightedStyleDiffFromSelection=!1}}();(0,o.l)(Wu,"TextRangeStyleData",null,[]);var zu=function(){return function(){this.tableNode=null,this.rows=0,this.columns=0,this.isRichApi=!1}}();(0,o.l)(zu,"TableActionData",null,[]);var Ku=function(){return function(){this.bold=0,this.boldNone=!1,this.italic=0,this.italicNone=!1,this.underline=0,this.underlineNone=!1,this.underlineType=0,this.underlineTypeNone=!1,this.superscript=0,this.superscriptNone=!1,this.subscript=0,this.subscriptNone=!1,this.strikethrough=0,this.strikethroughNone=!1,this.doubleStrikethrough=0,this.doubleStrikethroughNone=!1,this.fontName=null,this.fontNameNone=!1,this.fontSize=0,this.fontSizeNone=!1,this.themeFontIndex=0,this.themeFontIndexNone=!1,this.fontColor=0,this.fontColorNone=!1,this.highlight=0,this.highlightNone=!1,this.bold=this.italic=this.underline=this.strikethrough=this.doubleStrikethrough=this.superscript=this.subscript=2,this.fontSize=-1,this.fontColor=this.highlight=-1,this.underlineType=Hu.Font.get_invalidUnderlineType(),this.themeFontIndex=-1,this.boldNone=this.italicNone=this.underlineNone=this.underlineTypeNone=this.superscriptNone=this.subscriptNone=this.strikethroughNone=this.doubleStrikethroughNone=this.fontNameNone=this.fontSizeNone=this.themeFontIndexNone=this.fontColorNone=this.highlightNone=!1}}();(0,o.l)(Ku,"FormattingData",null,[]);var qu=n(8740),ju=n(7620),$u=n(4940),Qu=n(7567),Ju=n(9918),Xu=n(2014),Yu=function(){function e(){this._hasCachedParagraphFormatting=!1,this._hasCachedTextFormatting=!1,this.executeFunctions=new Ma.e(Number,Function),this.enabledFunctions=new Ma.e(Number,Function),this._formattingProperties=new Ku,this._paragraphFormattingProperties=new qu.n}return e.prototype.initialize=function(){e.symbolDictionary=e.createSymbolDictionary(),this.executeFunctions.set_item(ii.sb,e.inputMethodExecuteBridge),this.executeFunctions.set_item(ii.vf,e.inputMethodExecuteBridge),this.executeFunctions.set_item(ii.WE,e.inputMethodExecuteBridge),this.executeFunctions.set_item(ii.dN,e.touchExecuteBridge),this.executeFunctions.set_item(ii.AM,e.openInClientExecuteBridge),this.executeFunctions.set_item(te.bT,e.closeExecuteBridge),this.executeFunctions.set_item(ii.Dx,e.dictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(ii.NS,e.fontExecuteBridge),this.executeFunctions.set_item(ii.Us,o.i(this,this.genericFontSizeExecuteBridge,"genericFontSizeExecuteBridge")),this.executeFunctions.set_item(ii.aH,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(ii.Vt,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(ii.yL,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(ii.NZ,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(ii.CT,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(ii.Pt,e.formattingAsyncExecuteBridge),this.executeFunctions.set_item(ii.Xu,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(ii.Bh,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(ii.fg,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(ii.DP,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(ii.Zj,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(ii.dI,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(ii.PA,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(ii.be,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(ii.wr,o.i(this,this.queryFormattingExecuteBridge,"queryFormattingExecuteBridge")),this.executeFunctions.set_item(ii.xo,o.i(this,this.queryFormatPainterExecuteBridge,"queryFormatPainterExecuteBridge")),this.executeFunctions.set_item(ii.g,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.gb,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.Qu,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.VW,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.Hm,e.executeBridgeWithNoData),this.executeFunctions.set_item(ii.lN,e.executeBridgeWithNoData),this.executeFunctions.set_item(te.gD,e.queryBridgeWithExistingData),this.executeFunctions.set_item(ii.Rc,e.inputMethodExecuteBridge),this.enabledFunctions.set_item(ii.BE,e.dictionaryPropertySetEnabledBridge),this.enabledFunctions.set_item(ii.Tb,e.dictionaryPropertySetEnabledBridge),this.enabledFunctions.set_item(ii.lo,e.dictionaryPropertySetEnabledBridge),this.enabledFunctions.set_item(ii.Xu,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(ii.Bh,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(ii.fg,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(ii.DP,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(ii.Zj,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(ii.dI,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(ii.PA,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(ii.be,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(ii.wr,e.remapToQueryFormattingEnabledBridge),this.enabledFunctions.set_item(ii.g,e.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.Qu,e.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.gb,e.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.VW,e.remapToQueryParagraphFormattingEnabledBridge),this.executeFunctions.set_item(ii.fI,o.i(this,this.insertHyperLinkBridge,"insertHyperLinkBridge")),this.executeFunctions.set_item(ii.Sw,o.i(this,this.commandingInputMethodExecuteBridge,"commandingInputMethodExecuteBridge")),this.executeFunctions.set_item(ii.Et,o.i(this,this.commandingInputMethodExecuteBridge,"commandingInputMethodExecuteBridge")),this.executeFunctions.set_item(ii.eR,o.i(this,this.insertOnLinePictureExecuteBridge,"insertOnLinePictureExecuteBridge")),this.executeFunctions.set_item(ii.MF,o.i(this,this.insertSymbolBridge,"insertSymbolBridge")),this.executeFunctions.set_item(ii.Ll,o.i(this,this.commandingInsertTableExecuteBridge,"commandingInsertTableExecuteBridge")),this.executeFunctions.set_item(ii.oO,o.i(this,this.navToPageExecuteBridge,"navToPageExecuteBridge")),this.executeFunctions.set_item(ii.ZN,e.commandingColorExecuteBridge),this.executeFunctions.set_item(ii.BG,e.commandingColorExecuteBridge)},e.prototype.clearCache=function(){this._formattingProperties=new Ku,this._paragraphFormattingProperties=new qu.n,this._hasCachedParagraphFormatting=!1,this._hasCachedTextFormatting=!1},e.prototype.getExecuteInfo=function(t,n,r){var i=null,o=this.executeFunctions.get_item(t);return o?i=o(t,n,r):(i=new Vu).actionData=n,i.originalActionId=t,i.actionToRun||(i.actionToRun=e.mapActionId(t)),i},e.prototype.getEnabledInfo=function(e){var t=null,n=this.enabledFunctions.get_item(e);return(t=n?n(e):new Gu).originalActionId=e,t.actionToRun||(t.actionToRun=e),t},e.prototype.queryFormattingExecuteBridge=function(e,t,n){var r=new Vu;return r.haveCachedValue=this._hasCachedTextFormatting,this._hasCachedTextFormatting=!0,r.actionToRun=ii.zG,r.actionData=this._formattingProperties,r.isQueryCommand=!0,r},e.prototype.queryParaFormattingExecuteBridge=function(e,t,n){var r=new Vu;return r.haveCachedValue=this._hasCachedParagraphFormatting,this._hasCachedParagraphFormatting=!0,r.actionToRun=ii.RP,r.actionData=this._paragraphFormattingProperties,r.isQueryCommandRunAsExecute=!0,r.isQueryCommand=!0,r},e.prototype.genericFontSizeExecuteBridge=function(t,n,r){var i=new Vu;i.executeAsync=!0;var o,a=n.CommandValueId||n.Value,s=0;return Jn.l.parseNumberAndUnitsFromString(a,[0],L.AFrameworkApplication.get_numberFormat(),(0,p.m)((function(){return s}),(function(e){return s=e})),(0,p.m)((function(){return o}),(function(e){return o=e}))),isNaN(s)?(Br.App.get_activeAppFrame().updateCommandUI(),i.earlyReturnBool=!1,i):(s*=2,i.actionData=e.createActionDataContainer(Math.floor(s),n),i)},e.prototype.commandingInputMethodExecuteBridge=function(e,t,n){var r={Visible:!0};e===ii.Sw?(r.LabelText="Undo",r.SourceControlId="btnUndo"):(r.LabelText="Redo",r.SourceControlId="btnRedo");var i=new Qu.p(r,2),o=new Vu;return o.actionData=i,o},e.prototype.insertOnLinePictureExecuteBridge=function(e,t,n){var r=new Vu,i=new Kl.DictionaryPropertySet,o=t.Value?t.Value:null;if(!o||""===o)return null;var a=String.format("<img src={0}>",o);return i.setValue(zl.k.pastedHtmlContent,a),r.actionData=i,r},e.prototype.insertHyperLinkBridge=function(e,t,n){var r=new Vu;return t.Source="CommandingInterface",r.actionData=t,r},e.prototype.commandingInsertTableExecuteBridge=function(e,t,n){var r=new Vu;r.executeAsync=!0;var i=new zu;return i.rows=t.Row,i.columns=t.Col,r.actionData=i,r},e.prototype.insertSymbolBridge=function(e,t,n){var r=new Vu;r.executeAsync=!0;var i=t.Value;r.actionData=new Kl.DictionaryPropertySet;var o=this.getSymbolByIndex(i),a={};return a.SourceControlId="symbol_"+i+"_"+o,a.InnerHtml=String.format('<div class="SymbolButtonInnerHTML" aria-hidden="true" style="color: black">{0}</div>',o),r.actionData=a,r},e.prototype.navToPageExecuteBridge=function(e,t,n){var r=new Vu,i=t.Value?t.Value:"";return r.actionData=i,r},e.prototype.queryFormatPainterExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=se.w.get_instance().tryResolve(Uu.w),r.isQueryCommand=!0,r},e.prototype.getSymbolByIndex=function(t){return e.symbolDictionary[t.toString()]},e.createSymbolDictionary=function(){var e={0:"\u2022",1:"\u20ac",2:"\xa3",3:"\xa5",4:"\xa9",5:"\xae",6:"\u2122",7:"\xb1",8:"\u2260",9:"\u2264",10:"\u2265",11:"\xf7",12:"\xd7",13:"\u221e",14:"\xb5",15:"\u03b1",16:"\u03b2",17:"\u03c0",18:"\u03a9",19:"\u03a3",20:"\xb0",21:"\u0394",22:"\u263a",23:"\u2665",24:"\u20b9"};return e},e.applyQueryResult=function(e,t){var n=(0,f.e)(Ku,e.actionData),r=(0,f.e)(qu.n,e.actionData),i=!0;switch(e.originalActionId){default:i=!1;break;case ii.cx:t[Di.e.On]=!0;break;case ii.Xu:t[Di.e.On]=1===n.bold;break;case ii.Bh:t[Di.e.On]=1===n.italic;break;case ii.fg:t[Di.e.On]=1===n.underline;break;case ii.dI:t[Wo.z.On]=1===n.subscript;break;case ii.Zj:t[Di.e.On]=1===n.subscript;break;case ii.PA:t[Di.e.On]=1===n.superscript;break;case ii.DP:t[Di.e.On]=1===n.strikethrough||1===n.doubleStrikethrough;break;case ii.be:t[_o.g.IsFreeForm]=!0,void 0!==n.fontName&&null!==n.fontName?t[_o.g.Value]=Ps.FormattingReader.getDisplayFontNameWithTheme(n.fontName,n.themeFontIndex):t[_o.g.Value]="";break;case ii.wr:var o="";-1!==n.fontSize&&Jn.l.formatNumberToString(n.fontSize/2,0,L.AFrameworkApplication.get_numberFormat(),(0,p.m)((function(){return o}),(function(e){return o=e}))),t[_o.g.IsFreeForm]=!0,t[_o.g.Value]=o;break;case ii.g:t[Di.e.On]=1===r.layoutAlignmentInParent;break;case ii.Qu:t[Di.e.On]=2===r.layoutAlignmentInParent;break;case ii.gb:t[Di.e.On]=3===r.layoutAlignmentInParent;break;case ii.VW:t[Di.e.On]=6===r.layoutAlignmentInParent;break;case ii.xo:var a=(0,f.e)(Uu.w,e.actionData);a&&(t[Di.e.On]=a.get_isBrushActive());break;case te.gD:}return i},e.executeBridgeWithNoData=function(e,t,n){return new Vu},e.queryBridgeWithExistingData=function(e,t,n){var r=new Vu;return r.actionData=t,r.isQueryCommand=!0,r},e.inputMethodExecuteBridge=function(e,t,n){var r=new Qu.p(t,n.InvocationMethod),i=new Vu;return i.actionData=r,i},e.touchExecuteBridge=function(e,t,n){var r=new Qu.p(t,3),i=new Vu;return i.actionData=r,i},e.openInClientExecuteBridge=function(e,t,n){var r,i=new Vu;return 2!==(r=n.CommandLocation)&&14!==r&&15!==r&&26!==n.CommandLocation&&(i.actionData=!1),i},e.queryDictionaryPropertySetExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new Kl.DictionaryPropertySet,r.isQueryCommand=!0,r},e.queryTextRangeStyleDataExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new Wu,r.isQueryCommand=!0,r},e.dictionaryPropertySetExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new Kl.DictionaryPropertySet,r},e.closeExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=ai.l,r},e.dictionaryPropertySetEnabledBridge=function(e){var t=new Gu;return t.actionData=new Kl.DictionaryPropertySet,t},e.formattingAsyncExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new ju.b(2),r.executeAsync=!0,r},e.remapToQueryParagraphFormattingEnabledBridge=function(e){var t=new Gu;return t.actionToRun=ii.RP,t},e.remapToQueryFormattingEnabledBridge=function(e){var t=new Gu;return t.actionToRun=ii.zG,t},e.fontExecuteBridge=function(t,n,r){var i,o=new Vu;if(o.executeAsync=!0,i=n.CommandValueId?n.CommandValueId:n.Value,o.actionData=i,us.n.get_instance().get_item(53)){var a=new Ku,s=n.MenuItemId;a.themeFontIndex=Hu.Font.getThemeFontIndexFromFontId(s),a.fontName=i,o.actionData=a}return e.logFontUsageData(n,i),o.actionData=e.createActionDataContainer(o.actionData,n),Xu.v.addMruFont(i),o},e.logFontUsageData=function(e,t){var n=Jn.l.calcHashCode(t);void 0!==e[_o.g.IsFreeForm]&&null!==e[_o.g.IsFreeForm]&&e[_o.g.IsFreeForm]?C.ULS.sendTraceTag(51390360,324,50,String.format("{0} font applied is not a valid menu item",n.toString())):void 0!==e.MenuItemId&&null!==e.MenuItemId&&C.ULS.sendTraceTag(51390361,324,50,String.format("Font applied is {0}, MenuItemID:{1}",n.toString(),e.MenuItemId))},e.commandingColorExecuteBridge=function(t,n,r){var i=new Vu,o=n.Color?n.Color:null;return o&&6===o.length?(i.actionData=e.convertRgbToBgr(o),i.executeAsync=!0,i):null},e.convertRgbToBgr=function(e){return 6!==e.length?null:e.substring(4,6)+e.substring(2,4)+e.substring(0,2)},e.mapActionId=function(e){switch(e){case ii.Sw:return ii.sb;case ii.Et:return ii.vf;case ii.Ll:return ii.gH;case ii.eR:return ii.VS;case ii.MF:return ii.Pf;case ii.fI:return ii.jg;case ii.ZN:return ii.EN;case ii.BG:return ii.iX;default:return e}},e.createActionDataContainer=function(e,t){var n=new $u.y(e);return L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?new $u.y(e,t[Ju.z.shouldCanvasTakeFocus]):n},e.symbolDictionary={},e}();(0,o.l)(Yu,"CuiActionBridge$0",null,[]);var Zu=function(){function e(){}return e.registerActions=function(){L.AFrameworkApplication.get_theActionManager()},e.attachCommandHandlers=function(t,n,r){e._controlCommandHandlers[t.toString()]=n,e._controlQueryCommandHandlers[t.toString()]=r},e.detachCommandHandlers=function(t){e._controlCommandHandlers[t.toString()]=null,e._controlQueryCommandHandlers[t.toString()]=null},e.queryDialogControl=function(t,n,r,i,o){if(1===r)return 32;var a=o;return e.queryControlValue(t,a)?32:8},e.handleDialogControl=function(t,n,r,i,o){if(1===r)return 32;var a=o;return e.notifyControlValueChanged(t,a)?32:8},e.notifyControlValueChanged=function(t,n){var r=e._controlCommandHandlers[t.toString()];return null!=r&&(r(t,n),!0)},e.queryControlValue=function(t,n){var r=e._controlQueryCommandHandlers[t.toString()];return null!=r&&(r(t,n),!0)},e._controlCommandHandlers={},e._controlQueryCommandHandlers={},e}();(0,o.l)(Zu,"DialogCuiControlActor",null,[]);var eg=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter)},e.dialogHtmlFormat="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> </table> </div>",e}();(0,o.l)(eg,"AutoCorrectOptionsDialogHTML",null,[]);var tg=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,Box4Intl.Box4Strings.l_AutoCorrectCorrectAndCapitalize,Box4Intl.Box4Strings.l_ReplaceTextAsYouType,Box4Intl.Box4Strings.l_ReplaceTextAsYouTypeTooltip,Box4Intl.Box4Strings.l_CapitalizeFirstLetterOfSentences,Box4Intl.Box4Strings.l_AutoCorrectFormat,Box4Intl.Box4Strings.l_ReplaceOrdianalsWithSuperscript,Box4Intl.Box4Strings.l_ReplaceHyphensWithDash,Box4Intl.Box4Strings.l_ReplaceFractionsWithFractionCharacter,Box4Intl.Box4Strings.l_ReplaceQuoteWithSmartQuote)},e.dialogHtmlFormat="<div class='WACDialogRow' id='AutoCorrectCorrectAndCapitalizeDiv'> <div class='WACDialogSectionTitle UIFontBold'>{0}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectOptionsDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceTextAsYouType' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceTextAsYouType' >{1}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='CapitalizeFirstLetterOfSentences' class='WACDialogCheckBox' title='{3}'></input> <label id='\"\"' class='WACDialogLabel' for='CapitalizeFirstLetterOfSentences' >{3}</label> </td> </tr> </table> </div> <div class='WACDialogRow' id='AutoCorrectFormatTitleDiv'> <div class='WACDialogSectionTitle UIFontBold'>{4}</div> </div> <div class='WACDialogGroupBox' id='AutoCorrectFormatDiv'> <table cellpadding=5 cellspacing=5 role='autocorrectoptions'> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceOrdianalsWithSuperscript' class='WACDialogCheckBox' title='{5}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceOrdianalsWithSuperscript' >{5}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceHyphensWithDash' class='WACDialogCheckBox' title='{6}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceHyphensWithDash' >{6}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceFractionsWithFractionCharacter' class='WACDialogCheckBox' title='{7}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceFractionsWithFractionCharacter' >{7}</label> </td> </tr> <tr role='autocorrectoptions'> <td> <input type='checkbox' id='ReplaceQuoteWithSmartQuote' class='WACDialogCheckBox' title='{8}'></input> <label id='\"\"' class='WACDialogLabel' for='ReplaceQuoteWithSmartQuote' >{8}</label> </td> </tr> </table> </div>",e}();(0,o.l)(tg,"AutoCorrectOptionsDialogHTML2",null,[]);var ng="AutoCorrectOptionsDialog",rg=function(e){function t(t,n){var r=e.call(this)||this;return r._autoCorrectOptionsInfo=null,r._replaceQuoteWithSmartQuoteIsEnabled=!1,r._autoCorrectOptionsInfo=t,r._replaceQuoteWithSmartQuoteIsEnabled=n,r.set_dialogId(ng),r}return(0,S.t)(t,e),t.prototype.showLanguageDialog=function(){C.ULS.sendTraceTag(24417873,324,50,"Autocorrect options dialog opens."),this.set_dialogHtml(this._replaceQuoteWithSmartQuoteIsEnabled?tg.get_dialogHtml():eg.get_dialogHtml());var e={};e.ReplaceTextAsYouType=this._autoCorrectOptionsInfo.get_replaceTextAsYouType(),e.CapitalizeFirstLetterOfSentences=this._autoCorrectOptionsInfo.get_capitalizeFirstLetterOfSentences(),e.ReplaceOrdianalsWithSuperscript=this._autoCorrectOptionsInfo.get_replaceOrdianalsWithSuperscript(),e.ReplaceHyphensWithDash=this._autoCorrectOptionsInfo.get_replaceHyphensWithDash(),e.ReplaceFractionsWithFractionCharacter=this._autoCorrectOptionsInfo.get_replaceFractionsWithFractionCharacter(),this._replaceQuoteWithSmartQuoteIsEnabled&&(e.ReplaceQuoteWithSmartQuote=this._autoCorrectOptionsInfo.get_replaceQuoteWithSmartQuote()),this.initializeAndShow(Box4Intl.Box4Strings.l_AutoCorrectOptions,o.i(this,this.setAutoCorrectOptionsHandler,"setAutoCorrectOptionsHandler"),e)},t.prototype.setAutoCorrectOptionsHandler=function(e,t){if(us.n.get_instance().get_item(70))if(1===e)if(t.ReplaceTextAsYouType!==this._autoCorrectOptionsInfo.get_replaceTextAsYouType()||t.CapitalizeFirstLetterOfSentences!==this._autoCorrectOptionsInfo.get_capitalizeFirstLetterOfSentences()||t.ReplaceOrdianalsWithSuperscript!==this._autoCorrectOptionsInfo.get_replaceOrdianalsWithSuperscript()||t.ReplaceHyphensWithDash!==this._autoCorrectOptionsInfo.get_replaceHyphensWithDash()||t.ReplaceFractionsWithFractionCharacter!==this._autoCorrectOptionsInfo.get_replaceFractionsWithFractionCharacter()||this._replaceQuoteWithSmartQuoteIsEnabled&&t.ReplaceQuoteWithSmartQuote!==this._autoCorrectOptionsInfo.get_replaceQuoteWithSmartQuote()){var n={};n.ReplaceTextAsYouType=t.ReplaceTextAsYouType,n.CapitalizeFirstLetterOfSentences=t.CapitalizeFirstLetterOfSentences,n.ReplaceOrdianalsWithSuperscript=t.ReplaceOrdianalsWithSuperscript,n.ReplaceHyphensWithDash=t.ReplaceHyphensWithDash,n.ReplaceFractionsWithFractionCharacter=t.ReplaceFractionsWithFractionCharacter,this._replaceQuoteWithSmartQuoteIsEnabled&&(n.ReplaceQuoteWithSmartQuote=t.ReplaceQuoteWithSmartQuote),this._autoCorrectOptionsInfo.saveAutoCorrectOptions(n),C.ULS.sendTraceTag(24523524,324,50,"User close the option dialog and trigger to save the setting: {0}"+{ReplaceTextAsYouType:t.ReplaceTextAsYouType,CapitalizeFirstLetterOfSentences:t.CapitalizeFirstLetterOfSentences,ReplaceOrdianalsWithSuperscript:t.ReplaceOrdianalsWithSuperscript,ReplaceHyphensWithDash:t.ReplaceHyphensWithDash,ReplaceFractionsWithFractionCharacter:t.ReplaceFractionsWithFractionCharacter,ReplaceQuoteWIthSmartQuoteIsEnabled:this._replaceQuoteWithSmartQuoteIsEnabled,ReplaceQuoteWithSmartQuote:this._replaceQuoteWithSmartQuoteIsEnabled&&t.ReplaceQuoteWithSmartQuote}),Br.App.get_activeAppFrame().updateCommandUI(!0)}else C.ULS.sendTraceTag(24523523,324,50,"User close the option dialog or cancle it without do any changes.");else C.ULS.sendTraceTag(24417874,324,50,"User close the option dialog or cancle it without save any changes.")},t}(ri.o);(0,o.l)(rg,"AutoCorrectOptionsDialog",ri.o,[du]);var ig=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,CommonUIStrings.l_AlternativeTextTitleCaption,CommonUIStrings.l_AlternativeTextDescriptionCaption)},e.dialogHtmlFormat="<div class='WACDialogRow' id='block3'> <label id='label3' class='WACDialogLabel' for='titleText' aria-hidden='true' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='65536' aria-labelledby='label3' role='textbox' aria-multiline='false' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block4'> <label id='label4' class='WACDialogLabel' for='descriptionText' aria-hidden='true' >{1}</label> </div> <div class='WACDialogRow' id='block5'> <textarea id='descriptionText' class='WACAltTextTextArea' maxlength='65536' aria-labelledby='label4' role='textbox' aria-multiline='true' autocomplete=\"off\"></textarea> </div>",e}();(0,o.l)(ig,"AltTextDialogWithDescriptionHtml",null,[]);var og="BaseAltTextDialogWithDescription",ag=function(e){function t(){var t=e.call(this)||this;return t.set_dialogHtml(ig.get_dialogHtml()),t.set_dialogId(og),t}return(0,S.t)(t,e),t.prototype.createAndShow=function(e){var n={};n[t.altTitleKey]=this.getAltText(e),n[t.altDescriptionKey]=this.getDescriptionText(e)||"",this.initializeAndShow(CommonUIStrings.l_AlternativeTextDialogTitle,o.i(this,this.altTextDialogHandler,"altTextDialogHandler"),n);var r=document.getElementById(t.altTitleKey);r.focus(),r.select()},t.prototype.dialogDefaultEnterKeyHandler=function(n){return n.get_sourceElement().id!==t.altDescriptionKey&&e.prototype.dialogDefaultEnterKeyHandler.call(this,n)},t.altTitleKey="titleText",t.altDescriptionKey="descriptionText",t}(ri.o);(0,o.l)(ag,"BaseAltTextDialogWithDescription",ri.o,[]);var sg=function(e){function t(t,n,r,i,o){var a=e.call(this)||this;return a._tableEditor=null,a._coauthManager=null,a._graphTransactionFactory=null,a._trackChangeManager=null,a._containingNode=null,a._tableProperties=null,a._tableEditor=n,a._coauthManager=r,a._graphTransactionFactory=i,a._trackChangeManager=o,a.createAndShow(t),a}return(0,S.t)(t,e),t.prototype.getDescriptionText=function(e){return this._containingNode=e.get_node(),this._tableProperties=dc.TableReader.getTablePropertySet(e),dc.TableReader.getTableAltTextDescription(this._tableProperties)},t.prototype.getAltText=function(e){return this._containingNode=e.get_node(),this._tableProperties=dc.TableReader.getTablePropertySet(e),dc.TableReader.getTableAltTextTitle(this._tableProperties)},t.prototype.altTextDialogHandler=function(e,t){if(1===e){var n=dc.TableReader.getTableAltTextTitle(this._tableProperties),r=dc.TableReader.getTableAltTextDescription(this._tableProperties),i=t[ag.altTitleKey],o=t[ag.altDescriptionKey];this.hide();var a=this._graphTransactionFactory.getTransaction(15);try{a.setFromNode(this._containingNode),this._tableEditor.setTableAltTextTitle(this._tableProperties,i),this._tableEditor.setTableAltTextDescription(this._tableProperties,o)}finally{a&&a.dispose()}i===n&&o===r||this._trackChangeManager.alertUntrackedChange(13)}us.n.get_instance().get_item(50)&&this._coauthManager.get_isCoauthorable()&&this._coauthManager.get_theLockManager().acquireAndApplyLock(this._containingNode)},t}(ag);(0,o.l)(sg,"TableAltTextDialog",ag,[]);var lg=function(){function e(e,t,n){this._tableEditor=null,this._graphTransactionFactory=null,this._trackChangeManager=null,this._tableEditor=e,this._graphTransactionFactory=t,this._trackChangeManager=n}return e.prototype.create=function(e){return new sg(e,this._tableEditor,Br.App.get_theCoauthManager(),this._graphTransactionFactory,this._trackChangeManager)},e}();(0,o.l)(lg,"TableAltTextDialogFactory",null,[]);var cg=n(7582),ug=n(780),gg=n(3746),pg=function(e){function t(t,n,r){var i=e.call(this,n,r)||this;return i._appFrame=null,i._appFrame=t,i}return(0,S.t)(t,e),t.prototype.initializeFloatie=function(e,t,n){var r=this;void 0===n&&(n=null),us.n.get_instance().get_item(73)||C.ULS.sendTraceTag(8151366,307,15,"Cannot find Floatie feature in the AppFeatures settings"),this._appFrame.bindFloatieBaseFactory((function(){return r.constructFloatie(e,t,n)}))},t.prototype.constructFloatie=function(t,n,r){return this.set_floatie(e.prototype.constructFloatie.call(this,t,n,r)),this._appFrame.add_onCommandUiUpdate(o.i(this,this.pollForStateAndUpdateFloatie,"pollForStateAndUpdateFloatie")),this.get_floatie()},t.prototype.onFloatieDismissed=function(e){this.get_floatie()&&Ur.InteractiveViewManager.get_instance().get_selectionView()&&Ur.InteractiveViewManager.get_instance().get_selectionView().onFloatieDismissed(e,this.get_floatie().get_touchMode()),this.get_floatie().set_preventDismissOnMouseMove(t.testHook),this._appFrame.set_isFloatieActive(!1)},t.prototype.pollForStateAndUpdateFloatie=function(){this._appFrame.get_isFloatieActive()&&this.get_floatie().pollForStateAndUpdate()},t.prototype.getHiddenFloatieGroups=function(e){var n=Oa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection(),r=[],i=!!this.get_commandUiBridge()&&!this.get_commandUiBridge().isRibbonCommandEnabled("3523575366"),o=!!this.get_commandUiBridge()&&!this.get_commandUiBridge().isRibbonCommandEnabled("1898844988"),a=!t.get_editSurfaceContextMenu().hasContent(n,e);return(!i||!t.get_selectionContextMenuProvider().menuForSelectionHasAssociatedFloatie())&&(Array.add(r,"TextFormattingGroup"),Array.add(r,"StylesGroup")),i&&Array.add(r,"PictureToolsGroup"),o&&Array.add(r,"TableToolsGroup"),a&&Array.add(r,"ContextMenuGroup"),r},t.get_editSurfaceContextMenu=function(){return t._editSurfaceContextMenu||(t._editSurfaceContextMenu=se.w.get_instance().resolve(gg.n))},t.get_selectionContextMenuProvider=function(){return t._selectionContextMenuProvider||(t._selectionContextMenuProvider=se.w.get_instance().resolve(cg.f))},t.testHook=!1,t._editSurfaceContextMenu=null,t._selectionContextMenuProvider=null,t}(ug.l);(0,o.l)(pg,"SelectionFloatieInitializer",ug.l,[]);var dg=function(e,t,n,r,i){return Br.App.allowUnsafeAppClose=!0,32},hg=function(e,t,n,r,i){return 1===n?32:mg(i,(0,p.m)((function(){return o}),(function(e){return o=e})),(0,p.m)((function(){return a}),(function(e){return a=e})))?(Br.App.get_activeAppFrame().showContextMenuAndFloatie(o,a),32):16;var o,a},_g=function(e,t,n,r,i){return 1===n?32:mg(i,(0,p.m)((function(){return o}),(function(e){return o=e})),(0,p.m)((function(){return a}),(function(e){return a=e})))?(pg.testHook=!0,Br.App.get_activeAppFrame().showFloatieForSelection(o,a),32):16;var o,a},mg=function(e,t,n){if(t.val=null,n.val=0,!e)return!1;var r=e.split(",");return!(r.length<3)&&(t.val=new Sys.UI.Point(parseInt(r[0]),parseInt(r[1])),n.val=parseInt(r[2]),!0)},fg=n(6669),yg=n(6641),Cg=function(){function e(e,t){this._hooks=null,this._cuiActionBridge=null,this._actionMan=null,this._hooks=e.getCuiUserHooks(),this._cuiActionBridge=e,this._actionMan=t}return e.prototype.executeRootCommand=function(t,n,r,i,o){void 0===i&&(i=null),void 0===o&&(o=null),r&&(this._actionMan.set_commandLocation(r.CommandLocation),this._actionMan.set_invocationMethod(r.InvocationMethod),this._actionMan.set_commandTabName(r.CommandTabName));var a,s=parseInt(t),l=this._cuiActionBridge.getExecuteInfo(s,n,r);if(l.mustRecurse&&(l=this._cuiActionBridge.getExecuteInfo(l.actionToRun,n,r)),void 0!==l.earlyReturnBool&&null!==l.earlyReturnBool)return l.earlyReturnBool;if(l.haveCachedValue)a=32;else{var c=null;if(this._hooks&&this._hooks.preExecCommand&&(c=this._hooks.preExecCommand(l,o)),l.isQueryCommand||l.isQuerySpinnerCommand)l.executeAsync?a=16:2===(a=this._actionMan.processActionWithData(l.actionToRun,l.isQueryCommandRunAsExecute?2:1,l.actionData,o))&&(a=32);else if(l.executeAsync){a=this._actionMan.processActionWithDataAsync(null,l.actionToRun,2,l.actionData,(function(t,n){e.asyncActionCallback(t,n),i&&i(t.get_response())}),null,o)}else a=this._actionMan.processActionWithData(l.actionToRun,2,l.actionData,o),i&&i(a);if(this._hooks&&this._hooks.postExecCommand&&this._hooks.postExecCommand(l,a,c),n&&r&&-1!==r.InvocationMethod&&r.InvocationMethod){var u=n.LegacyId;null==u&&(u="");var g=n.ParentMenuId;null==g&&n.MenuId&&(g=n.MenuId);var p=n.SqmControlId;null==p&&n.SourceControlId&&(p=n.SourceControlId),null==p&&null==g||fg.z.raiseSQMEvent(new yg.e(p,u,g,t,Date.now(),r))}}return l.isQueryCommand&&32===a&&this._hooks&&this._hooks.applyQueryResult&&this._hooks.applyQueryResult(l,n),l.isQuerySpinnerCommand&&32===a&&this._hooks&&this._hooks.applySpinnerQueryResult&&this._hooks.applySpinnerQueryResult(l,n),32===a||1===a},e.prototype.isRootCommandEnabled=function(e){if(L.AFrameworkApplication.isShuttingDown||Oe.y.get_instance().get_isYielding())return!1;var t=parseInt(e);if(!e||t===Ze.ActionManager.emptyActionId)return!0;var n=this._cuiActionBridge.getEnabledInfo(t);return n.mustRecurse&&(n=this._cuiActionBridge.getEnabledInfo(n.actionToRun)),void 0!==n.earlyReturnBool&&null!==n.earlyReturnBool?n.earlyReturnBool:32===this._actionMan.processActionWithData(n.actionToRun,1,n.actionData)},e.prototype.clearCache=function(){this._cuiActionBridge.clearCache()},e.asyncActionCallback=function(e,t){},e}();(0,o.l)(Cg,"GeneralCuiUser",null,[lu.h,Yo]);var Sg=function(){function e(e,t,n,r){this._textToApplyTo=null,this._textFormattingCommands=null,this._autoCorrectRulesFuture=null,this._languageReader=null,this._textToApplyTo=e,this._textFormattingCommands=t,this._autoCorrectRulesFuture=n,this._languageReader=r}return e.prototype.getSelectedContextLanguage=function(e){return e.val=this._languageReader.getProofingEnabledFromContext(this._textToApplyTo),this._languageReader.getLanguageInfoFromContext(this._textToApplyTo)},e.prototype.setSelectedContextLanguage=function(e,t){if(this._textFormattingCommands){var n=new Kl.DictionaryPropertySet;this._autoCorrectRulesFuture.execute((function(t){t.ensureAutoCorrectListLoaded(e)})),n.setValue(Kc.b.languageID,e),n.setValue(us.n.get_instance().get_item(20)?ks.j.noProof:zl.k.noProofBox4,t);var r=new as.GraphTransaction(15);r.set(Br.App.theNotebookManager.get_theGraph()),this._textFormattingCommands.setLanguage(n),r.dispose()}},e}();(0,o.l)(Sg,"LanguageEditor",null,[uu]);var vg=n(4047),bg=n(4104),Tg=7,Ag=function(){function e(t,n){var r=this;void 0===t&&(t=!1),void 0===n&&(n=0),this._lcidToCultureInfo=null,this._recentlyUsedLanguagesList=null,this._recentlyUsedLanguagesSet=null,this._recentlyUsedLanguagesMaxSize=0,this._recentlyUsedLanguagesIsEnabled=!1,this._recentlyUsedLanguageHits=0,this._recentlyUsedLanguageMisses=0,this._hasLoggedRecentlyUsedLanguageHitRate=!1,this._languages=null,this._allLanguageOptions=null,this._languages=e.getSortedByDisplayName(Kt.i.getCultures(1)),this._lcidToCultureInfo=new Ws.u(Kt.i),this._recentlyUsedLanguagesList=new Array(0),this._recentlyUsedLanguagesSet=new bg.f(Number),this._recentlyUsedLanguagesIsEnabled=t,this._recentlyUsedLanguagesMaxSize=n<=0?Tg:n,this._recentlyUsedLanguageHits=0,this._recentlyUsedLanguageMisses=0,this._hasLoggedRecentlyUsedLanguageHitRate=!1,t&&(this.initializeRecentlyUsedLanguages(),L.AFrameworkApplication.subscribeToBeforeAppShutDown((function(e,t){r.logRecentlyUsedLanguageHitRate()})))}return e.prototype.get_recentlyUsedLanguagesList=function(){return this._recentlyUsedLanguagesList},e.prototype.get_languages=function(){return this._languages},e.prototype.get_recentlyUsedLanguagesIsEnabled=function(){return this._recentlyUsedLanguagesIsEnabled},e.prototype.initializeRecentlyUsedLanguages=function(){for(var e=0,t=this._languages;e<t.length;e++){var n=t[e];this._lcidToCultureInfo.set_item(n.get_LCID(),n)}var r=new Array(0);try{var i=ve.g("RecentlyUsedLcids");if(i&&""!==i)for(var o=decodeURIComponent(i).split(",").slice(0,this._recentlyUsedLanguagesMaxSize),a=function(e){var t,n=parseInt(e);n!==Number.NaN&&s._lcidToCultureInfo.tryGetValue(n,(0,p.m)((function(){return t}),(function(e){return t=e})))&&r.push(t)},s=this,l=0,c=o;l<c.length;l++){a(c[l])}}catch(e){C.ULS.sendTraceTag(38385057,324,15,"Error occurred while loading LCIDs from cookie, loading default LCID. Message: {0}",e.message),Array.clear(r)}if(r.length)for(var u=0,g=r;u<g.length;u++){var d=g[u];_=d.get_LCID();this._recentlyUsedLanguagesSet.contains(_)||(this._recentlyUsedLanguagesList.push(d),this._recentlyUsedLanguagesSet.add(_))}else{var h,_=L.AFrameworkApplication.lcid;this._lcidToCultureInfo.tryGetValue(_,(0,p.m)((function(){return h}),(function(e){return h=e})))&&(this._recentlyUsedLanguagesList.push(h),this._recentlyUsedLanguagesSet.add(_))}this.saveRecentlyUsedLanguagesToCookie()},e.prototype.saveRecentlyUsedLanguagesToCookie=function(){var e=vg.toArray(Number,vg.select(Kt.i,Number,vg.asEnumerable(Kt.i,this._recentlyUsedLanguagesList),(function(e){return e.get_LCID()}))).join(",");ve.r("RecentlyUsedLcids",e,180)},e.prototype.populateList=function(t,n){if(t&&!(t.options.length>0)){var r=-1,i=e.getSortedByDisplayName(this._recentlyUsedLanguagesList);if(this._recentlyUsedLanguagesIsEnabled&&i.length>0){var o=e.buildOptionElements(i);r=e.addOptionElementsToList(t,o,n),t.add(e.buildDividerOption(),null)}this._allLanguageOptions||(this._allLanguageOptions=e.buildOptionElements(this._languages));var a=e.addOptionElementsToList(t,this._allLanguageOptions,n);-1===r&&(r=a),t.selectedIndex=r}},e.prototype.getLanguageList=function(t,n,r){var i=-1,o=null,a=e.getSortedByDisplayName(this.get_recentlyUsedLanguagesList());this.get_recentlyUsedLanguagesIsEnabled()&&a.length>0&&(o=vg.toArray(Object,vg.Si(Kt.i,Object,vg.asEnumerable(Kt.i,a),(function(e,n){return t===e.get_LCID()&&-1===i&&(i=n),{key:n,text:e.get_displayName(),value:e.get_LCID().toString()}}))));var s=0;o&&(s=o.length),r.val=s;var l=vg.toArray(Object,vg.Si(Kt.i,Object,vg.asEnumerable(Kt.i,this.get_languages()),(function(e,n){return t===e.get_LCID()&&-1===i&&(i=s+n),{key:s+n,text:e.get_displayName(),value:e.get_LCID().toString()}})));return n.val=i,s>0?o.concat.apply(o,l):l},e.prototype.setLanguageAsMostRecentlyUsed=function(e,t){var n;if(this._recentlyUsedLanguagesIsEnabled&&this._lcidToCultureInfo.tryGetValue(e,(0,p.m)((function(){return n}),(function(e){return n=e})))){var r=e!==t;if(this._recentlyUsedLanguagesSet.contains(e)){var i=Array.indexOf(this._recentlyUsedLanguagesList,n);i>=0&&(Array.removeAt(this._recentlyUsedLanguagesList,i),this._recentlyUsedLanguagesList.push(n)),r&&this._recentlyUsedLanguageHits++}else{if(this._recentlyUsedLanguagesSet.add(e),this._recentlyUsedLanguagesList.push(n),this._recentlyUsedLanguagesList.length>this._recentlyUsedLanguagesMaxSize){var o=this._recentlyUsedLanguagesList.shift();this._recentlyUsedLanguagesSet.remove(o.get_LCID())}r&&this._recentlyUsedLanguageMisses++}this.saveRecentlyUsedLanguagesToCookie()}},e.prototype.logRecentlyUsedLanguageHitRate=function(){var e=this._recentlyUsedLanguageHits+this._recentlyUsedLanguageMisses;if(!this._hasLoggedRecentlyUsedLanguageHitRate&&e>0){var t=100*this._recentlyUsedLanguageHits/e;C.ULS.sendTraceTag(39662593,324,50,"Recently Used Languages Hit Rate: {0}%",t),this._hasLoggedRecentlyUsedLanguageHitRate=!0}},e.buildOptionElements=function(e){return vg.toArray(Object,vg.select(Kt.i,Object,vg.asEnumerable(Kt.i,e),(function(e){var t=document.createElement("OPTION"),n=e.get_displayName();return t.value=e.get_LCID().toString(),t.text=n,t})))},e.buildDividerOption=function(){var e=document.createElement("OPTION");return e.text="\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500",e.value="-1",e.disabled=!0,e},e.addOptionElementsToList=function(e,t,n){for(var r=n.toString(),i=-1,o=0,a=t;o<a.length;o++){var s=a[o];e.add(s,null),s.value===r&&(i=e.options.length-1)}return i},e.getSortedByDisplayName=function(e){var t=Array.clone(e);return t.sort((function(e,t){return e.get_displayName().localeCompare(t.get_displayName())})),t},e}();(0,o.l)(Ag,"LanguageListHelper",null,[hu]);var Ig=(0,o.y)("ISpacingCommands"),wg=n(3995),xg=function(e){function t(){var t=e.call(this)||this;return t.Number=0,t.Type=0,t}return(0,S.t)(t,e),t.prototype.get_ControlType=function(){return 10},t}(wg.i);(0,o.l)(xg,"NumberButtonProps",wg.i,[]);var Fg=function(){function e(){}return e.get_spacingCommands=function(){return e._spacingCommands||(e._spacingCommands=se.w.get_instance().tryResolve(Ig))},e.get_shouldPopulateMenu=function(){return!!e.get_spacingCommands()},e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(ii.KM,cl.n,e.populateLineSpacingFlyout),t.setActionFlags(ii.KM,1126)},e.populateLineSpacingFlyout=function(t,n,r,i,o){if(1===r||!e.get_shouldPopulateMenu())return e.get_shouldPopulateMenu()?32:8;var a=o;if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var s=new Array(0);s.push((0,O.m)(new xg,{ExternalId:"LineSpacing1_00",Number:1,Type:0})),s.push((0,O.m)(new xg,{ExternalId:"LineSpacing1_15",Number:1.15,Type:0})),s.push((0,O.m)(new xg,{ExternalId:"LineSpacing1_50",Number:1.5,Type:0})),s.push((0,O.m)(new xg,{ExternalId:"LineSpacing2_00",Number:2,Type:0})),s.push((0,O.m)(new xg,{ExternalId:"LineSpacing2_50",Number:2.5,Type:0})),s.push((0,O.m)(new xg,{ExternalId:"LineSpacing3_00",Number:3,Type:0})),a.MenuItems=Tu.UW(s)}else{var l=Tu.ZB("buttonLineSpacing1_00","1.00","2759860553","4080183461",1,0),c=Tu.ZB("buttonLineSpacing1_15","1.15","2759860553","4080183461",1.15,0),u=Tu.ZB("buttonLineSpacing1_50","1.50","2759860553","4080183461",1.5,0),g=Tu.ZB("buttonLineSpacing2_00","2.00","2759860553","4080183461",2,0),p=Tu.ZB("buttonLineSpacing2_50","2.50","2759860553","4080183461",2.5,0),d=Tu.ZB("buttonLineSpacing3_00","3.00","2759860553","4080183461",3,0),h=Tu.yL("buttonParagraphDialog","2465215107",Box4Intl.Box4Strings.L_LineSpacingOptions),_=Tu.IV("LineSpacing.Menu.Controls",[l,c,u,g,p,d,h]),m=Tu.OU("msLineSpacing",_,"Menu"),f=Tu.wF([m]);a.PopulationXML=f}return 32},e._spacingCommands=null,e}();(0,o.l)(Fg,"LineSpacingRibbonMenu",null,[]);var Eg,Pg,kg=n(9087),Dg=n(7441),Mg=n(5272),Rg=n(2945),Lg=function(e,t,n,r,i){if(1===n)return 32;var o=Br.App.get_activeAppFrame().get_notificationBar().createEntry("Automation test",!1);return o.set_image(3),Br.App.get_activeAppFrame().get_notificationBar().addEntry(o),32},Ng=function(e,t,n,r,i){var o;return Bg(i,(0,p.m)((function(){return o}),(function(e){return o=e})))?(Rg.UISurfaces.getNotificationsAPIAsync().then((function(e){var t=null,n=(0,O.m)(new Dg.u,{label:"OK",onExecute:function(){t&&e.removeNotification(t)}}),r=(0,O.m)(new Mg.w,{target:"#"+kg.u.ribbonPanelId,content:"Here's the text for the callout",title:"Your title",primaryButtonProps:n,useTeachingStyles:o}),i=e.callout(r);return t=e.addNotification(i),null})),32):16},Bg=function(e,t){return t.val=!1,!!e&&(t.val=Boolean.parse(e),!0)},Og=function(){return function(){this.Color=null,this.DisplayColor=null,this.Alt=null}}();(0,o.l)(Og,"ColorCellProps",null,[]);var Ug=function(){function e(){this._isRecentSectionAdded=!1,this._recentColors=new y.c(String)}return e.prototype.addRecentColor=function(e){var t=this._recentColors.indexOf(e),n=!0;if(-1!==t){if(n=!1,!t)return n;this._recentColors.removeAt(t)}return this._recentColors.insert(0,e),C.ULS.sendTraceTag(594899716,340,50,"{0} is added at the start of recent color list.",e),11===this._recentColors.get_count()&&(C.ULS.sendTraceTag(594899715,340,50,"Removing {0} from the recent color list.",this._recentColors.get_item(10)),this._recentColors.removeAt(10)),this.updateRecentColorsMenuSection(),n},e.prototype.updateRecentColorsMenuSection=function(){if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){C.ULS.sendTraceTag(594899714,340,50,"Sending a redux action to populate the recent colors menu section");for(var t=new Array(0),n=0;n<this._recentColors.get_count();n++){var r="#"+this._recentColors.get_item(n).substring(4,6)+this._recentColors.get_item(n).substring(2,4)+this._recentColors.get_item(n).substring(0,2),i=(0,O.m)(new Og,{Color:this._recentColors.get_item(n),Alt:r,DisplayColor:r});t.push(appChrome.api.colorPickerCell(i.Color,i.DisplayColor,i.Alt))}for(var o=e._recentColorsMenuSections.$$lge();o.$$mn();){var a=o.$$cu();appChrome.api.dispatch(appChrome.actions.populateColorPickerCells(a,t))}this._isRecentSectionAdded||this.updateMenuSections(),this._isRecentSectionAdded=!0}},e.prototype.updateMenuSections=function(){for(var t=0,n=Object.keys(e._menuSectionsMapping);t<n.length;t++){var r=n[t];C.ULS.sendTraceTag(594899713,340,50,"Sending a redux action to update the {0} menu",r);for(var i=e._menuSectionsMapping[r],o=new Array(0),a=i.$$lge();a.$$mn();){var s=a.$$cu();o.push(appChrome.api.menuSection([s],s in e._menuSectionsTitlesMapping?e._menuSectionsTitlesMapping[s].toString():null))}appChrome.api.dispatch(appChrome.actions.updateMenu(r,o,e._menuSectionsTitlesMapping[r].toString()))}},e._menuSectionsMapping={FontColor:(Pg=new y.c(String),Pg.add("AutomaticFontColor"),Pg.add("ThemeFontColorPickerMCU"),Pg.add("ThemeFontColorPicker"),Pg.add("StandardFontColorPicker"),Pg.add("RecentFontColorPicker"),Pg.add("MoreFontColors"),Pg),CellShading:(Eg=new y.c(String),Eg.add("ThemeShadingColorPickerMCU"),Eg.add("ThemeShadingColorPicker"),Eg.add("StandardShadingColorPicker"),Eg.add("RecentCellShadingColorPicker"),Eg.add("ClearShadingColor"),Eg.add("MoreCellShadingColors"),Eg)},e._menuSectionsTitlesMapping={StandardFontColorPicker:Box4Intl.Box4Strings.L_MenuStandardColors,StandardShadingColorPicker:Box4Intl.Box4Strings.L_MenuStandardColors,RecentFontColorPicker:Box4Intl.Box4Strings.L_MenuRecentColors,RecentHighlighterColorPicker:Box4Intl.Box4Strings.L_MenuRecentColors,RecentCellShadingColorPicker:Box4Intl.Box4Strings.L_MenuRecentColors,FontColor:Box4Intl.Box4Strings.L_FontColor,Highlighter:Box4Intl.Box4Strings.L_HighlightColor,CellShading:Box4Intl.Box4Strings.L_CellShadingColor},e._recentColorsMenuSections=((Pg=new y.c(String)).add("RecentFontColorPicker"),Pg.add("RecentCellShadingColorPicker"),Pg),e}();(0,o.l)(Ug,"RecentColorsSectionHandler",null,[]);var Hg=function(){function e(e){this._appFrame=null,this._appFrame=e}return e.prototype.updateControls=function(e){this._appFrame&&this._appFrame.updateRibbonControls(e)},e.prototype.updateControl=function(e){this._appFrame&&this._appFrame.updateRibbonControl(e)},e}();(0,o.l)(Hg,"RibbonButtonUpdater",null,[fu.l]);var Gg=n(2720),Vg=function(){function e(e,t){var n=this;this._reactRoot=null,this._externalCommandDefinitionMapping=null,this._hasInitialized=!1,this._contextualUIContainer=null,this._reactRoot=e,this._externalCommandDefinitionMapping=t,Be.p.get_instance().registerHandler(Le.d.mouseDown,this.getContextualUIContainer(),o.i(this,this.onContextualUIMouseDown,"onContextualUIMouseDown")),L.AFrameworkApplication.get_theActionManager().addAction(te.Zu,nt.a,Ze.ActionManager.doNothingButReportHandler),L.AFrameworkApplication.get_theActionManager().addAction(te.Vj,nt.a,Ze.ActionManager.doNothingButReportHandler),L.AFrameworkApplication.get_theActionManager().addAction(te.Fj,nt.a,Ze.ActionManager.doNothingButReportHandler),wi.r.get_instance().executeWhen(7,(function(){n.initializeContextualUI(n.getContextualUIContainer())}))}return e.prototype.get_isChromeReady=function(){return wi.r.get_instance().isCompleted(7)},e.prototype.showFloatie=function(e,t,n){this.get_isChromeReady()?this.setupContextualUI(t).then((function(){var t={};t.target=e,Rg.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.showFloatie(t,n)),L.AFrameworkApplication.get_theActionManager().processAction(te.Zu,2),null}))})):this.logUnableToLaunchContextualUI()},e.prototype.showContextMenu=function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=null),this.get_isChromeReady()?this.setupContextualUI(null).then((function(){var i={};i.target=e,r&&(i.directionalHint=r),Rg.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.showContextMenu(i,t,n)),L.AFrameworkApplication.get_theActionManager().processAction(te.Vj,2),null}))})):this.logUnableToLaunchContextualUI()},e.prototype.showContextMenuAndFloatie=function(e,t,n){this.get_isChromeReady()?this.setupContextualUI(t).then((function(){var t={};t.target=e;var r={};r.target=e,Rg.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.showContextualUI(t,r,n)),L.AFrameworkApplication.get_theActionManager().processAction(te.Fj,2),null}))})):this.logUnableToLaunchContextualUI()},e.prototype.logUnableToLaunchContextualUI=function(){C.ULS.sendTraceTag(51431558,340,15,"Unable to launch contextual ui because ribbon hasn't loaded yet")},e.prototype.dismissContextMenu=function(){this.get_isChromeReady()&&Rg.UISurfaces.isLoaded()&&Rg.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.hideContextMenu()),null}))},e.prototype.dismissFloatie=function(){this.get_isChromeReady()&&Rg.UISurfaces.isLoaded()&&Rg.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.hideFloatie()),null}))},e.prototype.dismissContextualUI=function(){this.get_isChromeReady()&&Rg.UISurfaces.isLoaded()&&Rg.UISurfaces.getContextualAPIAsync().then((function(e){return appChrome.api.dispatch(e.hideContextualUI()),null}))},e.prototype.initializeContextualUI=function(e){var t=this;return Rg.UISurfaces.getContextualAPIAsync().then((function(n){return t._hasInitialized||(n.initializeContextualUI(e),t._hasInitialized=!0),null}))},e.prototype.setupContextualUI=function(e){var t=this;return this._hasInitialized?(this.setActiveFloatieGroups(e),Promise.resolve(null)):this.initializeContextualUI(this.getContextualUIContainer()).then((function(n){return t.setActiveFloatieGroups(e),null}))},e.prototype.setActiveFloatieGroups=function(e){var t=this,n=new Array(0);e&&e.length>0&&n.push(appChrome.actions.setActiveFloatieGroups(e)),n.length>0&&appChrome.api.dispatch(n);var r=new Array(0);Rg.UISurfaces.getContextualAPIAsync().then((function(e){return r.push.apply(r,t._reactRoot.get_reactRibbonRootPoller().getUpdateActionsForCommands(e.selectors.getFloatieOnlyControlsMap())),r.length>0&&appChrome.api.dispatch(r),null}))},e.prototype.getContextualUIContainer=function(){return this._contextualUIContainer?this._contextualUIContainer:(this._contextualUIContainer=Bi.n.createElement("div"),this._contextualUIContainer.id="ReactContextualUIDiv",this._contextualUIContainer.style.position="absolute",this._contextualUIContainer.style.zIndex="1001",document.body.insertBefore(this._contextualUIContainer,document.body.firstChild),this._contextualUIContainer)},e.prototype.onContextualUIMouseDown=function(e){return e.innerEvent&&e.innerEvent.target&&"input"===e.innerEvent.target.tagName.toLowerCase()&&Nt.FocusManager.instance().scopeChanged("ribbon"),!1},e}();(0,o.l)(Vg,"ReactContextualUILauncher",null,[au]);var Wg,zg=n(8525),Kg=n(7501),qg=(0,o.y)("IRootCommandHandler"),jg=(0,o.y)("IReactRibbonRootPoller"),$g=n(8341),Qg=n(2252);!function(e){e[e.UnspecifiedGallery=0]="UnspecifiedGallery",e[e.CharacterCodeGallery=1]="CharacterCodeGallery",e[e.FontStyleGallery=2]="FontStyleGallery",e[e.IconGallery=3]="IconGallery",e[e.ListGallery=4]="ListGallery",e[e.TableStyleGallery=5]="TableStyleGallery",e[e.PageNumberGallery=6]="PageNumberGallery",e[e.ChangeColorsGallery=7]="ChangeColorsGallery"}(Wg||(Wg={})),(0,o.h)("GalleryType",Wg);var Jg=n(6365),Xg=function(e,t,n,r){if(lp(r)){var i=new Array(0);switch(t){case"ToggleButtonModel":i.push(Zg(e,n[Di.e.On]));break;case"CheckboxModel":i.push(ep(e,n[Di.e.On]));break;case"ComboBoxModel":var o=n[_o.g.Key];o?i.push(appChrome.actions.updateComboBoxKey(e,o,n[_o.g.Value])):i.push(appChrome.actions.updateComboBoxValue(e,n[_o.g.Value]));break;case"SplitButtonModel":i.push(Zg(e,n[Wo.z.On]));break;case"SpinButtonModel":i.push(appChrome.actions.updateSpinButton(e,n[Ho.Number],Jg.Iy(n[Ho.UnitType]),n[Ho.Text],n[Ho.MaxValue],n[Ho.Alt]));break;case"ColorPickerModel":i.push(appChrome.actions.updateColorPickerSelectedColor(e,n[Gi.IndexColorSelected]));break;case"PageNumberGalleryButtonModel":i.push(appChrome.actions.updatePageNumberGalleryButtonText(e,n[bo.u.Text]));break;case"CompoundButtonModel":n[Di.e.Description]&&i.push(appChrome.actions.updateCompoundButtonDescription(e,n[Di.e.Description])),Di.e.On in n&&i.push(Zg(e,n[Di.e.On]));break;case"SliderModel":n.snapToStep?i.push(appChrome.actions.updateSliderSelectedValue(e,n[No.u.Value])):i.push(appChrome.actions.updateSliderValue(e,n[No.u.Value],0,n[No.u.MaxValue],n[No.u.Text]));break;case"FlyoutAnchorModel":So.g.ImageIsVisible in n&&i.push(appChrome.actions.hideFlyoutAnchorIcon(e,!n[So.g.ImageIsVisible]));break;case"InputBoxModel":i.push(appChrome.actions.updateInputBoxValue(e,n[jo.Text]))}return op(e,n,i),rp(e,n,i),ip(e,n,i),np(e,n,i),ap(n,i),i}return null},Yg=function(e,t){return appChrome.actions.updateControlEnabledDisabledState(e,t)},Zg=function(e,t){return appChrome.actions.toggleButton(e,t)},ep=function(e,t){return appChrome.actions.toggleCheckbox(e,t)},tp=function(e,t){return appChrome.actions.setControlLabel(e,t)},np=function(e,t,n){var r=(0,f.e)(String,t[Ni.b.customTooltip]);r&&er.appChromeContainsAction("setControlCustomTooltip")&&n.push(function(e,t){return appChrome.actions.setControlCustomTooltip(e,t)}(e,r))},rp=function(e,t,n){var r=(0,f.e)(String,t[Ni.b.Icon]);r&&n.push(function(e,t){return appChrome.actions.setControlIcon(e,t)}(e,r))},ip=function(e,t,n){var r=(0,f.e)(Object,t[Ni.b.IconSet]);r&&n.push(function(e,t){return appChrome.actions.setControlIconSet(e,t)}(e,r))},op=function(e,t,n){var r=(0,f.e)(String,t[Ni.b.iconColor]);r&&n.push(appChrome.actions.updateIconColor(e,r))},ap=function(e,t){var n=(0,f.e)(Array,e[Ni.b.reduxActions]);n&&t.push.apply(t,n)},sp=function(e){return(1&e)<1},lp=function(e){return(2&e)>0},cp=function(){function e(e,t,n,r){this._externalUICommandDefinitionMapping=null,this._rootPoller=null,this._rootUser=null,this._rootType=0,this._justPopulatedFullGalleryButtonsMap=null,this._externalUICommandDefinitionMapping=r,this._rootPoller=e,this._rootUser=t,this._rootType=n,this._justPopulatedFullGalleryButtonsMap={}}return e.prototype.populateGallery=function(e,t,n,r){var i=e.ExternalGalleryId||e.ExternalId,o=e.ExternalId;if(r.push(i),!appChrome.selectors.isControlDefined(i)){if(3!==e.Type)return;n.push(appChrome.api.iconGalleryControl(i,e.Width,[appChrome.api.gallerySection(new Array(0),o)],e.GalleryStyle))}t.push.apply(t,this.getPopulateActionsFromGalleryButtonPropsArray(e.GalleryItems,i,o,!1))},e.prototype.getPreviewGalleryQueryCommandActions=function(e){var t=new Array(0),n=null,r=!1;if(!e)return null;var i=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,e.get_commandId());if(t.push(Yg(e.get_externalUxCommand(),!i)),e.previewControlIds){for(var o=new Array(0),a=0;a<e.previewControlIds.length;a++){var s={},l=e.previewControlIds[a];s.SourceControlId=l;var c=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(l);this.getPollResult(c||e,s),s[bo.u.On]&&(n=s.SourceControlId,s[bo.u.HighlightOn]&&(r=!0)),rp(l,s,t);var u=(0,f.e)(Qg.f,s[bo.u.GalleryButtonProps]);if(u){if(o.push(u),i){var g=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,u.Command);u.IsDisabled=!g}}else;}o.length>0&&t.push.apply(t,this.getPopulateActionsFromGalleryButtonPropsArray(o,e.get_externalUxCommand(),e.get_externalUxCommand(),!0)),t.push(appChrome.actions.updateGallerySelectedId(e.get_externalUxCommand(),n)),r&&(C.ULS.sendTraceTag(51517593,340,50,"HighlightSelectedFontStyle fired for {0} button",n),t.push(appChrome.actions.highlightSelectedFontStyle(n)))}return t},e.prototype.getPopulateActionsFromGalleryButtonPropsArray=function(e,t,n,r){for(var i=new Array(0),o=new Array(0),a=new Array(0),s=0;s<e.length;s++){var l=e[s],c=Li.t(l.ExternalId)?l.Id:l.ExternalId;switch(o.push(c),l.get_Type()){case 1:var u=l;a.push(appChrome.api.characterCodeGalleryButton(c,u.Character,u.Style?u.Style:null,l.Alt,l.IsDisabled));break;case 2:a.push(appChrome.api.fontStyleGalleryButton(c,l.LabelText,l.Style,l.Alt,l.IsDisabled,l.PreviewStyleLabel));break;case 3:null!=l.IsDisabled?a.push(appChrome.api.iconGalleryButton(c,l.Icon,l.LabelText,l.Alt,l.FullIconStyle,l.PreviewIconStyle,l.IsDisabled)):a.push(appChrome.api.iconGalleryButton(c,l.Icon,l.LabelText,l.Alt,l.FullIconStyle,l.PreviewIconStyle));break;case 4:a.push(appChrome.api.listGalleryButton(c,l.LevelInfo,l.Alt,l.IsDisabled));break;case 5:a.push(appChrome.api.tableStyleGalleryButton(c,l.TableCellStyles,l.TableStyles,l.Alt,l.IsDisabled));break;case 7:a.push(appChrome.api.changeColorsGalleryButton(c,l.TableCellStyles,l.TableStyles,l.Alt,l.IsDisabled));break;case 6:a.push(appChrome.api.pageNumberGalleryButton(c,l.Text,l.Alt,l.IsDisabled))}this._externalUICommandDefinitionMapping.addCommandToMaps((0,O.m)(new $g.d(c,l.Command),{queryCommandId:l.QueryCommand,menuItemId:l.MenuItemId})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OptimizeGalleryPopulationIsEnabled")&&!r&&(this._justPopulatedFullGalleryButtonsMap[c]=!1)}if(i.push(appChrome.actions.addControls(a)),r)i.push(appChrome.actions.populateGalleryItems(t,o));else{if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OptimizeGalleryPopulationIsEnabled")){var g=e.length>0?e[0].get_Type():0;i.push.apply(i,this.getGalleryQueryCommandActionsInternal(t,Wg[g],o,null,4===g))}i.push(appChrome.actions.updateGallerySectionItems(t,n,o))}return i},e.prototype.getGalleryQueryCommandActions=function(e){var t=e.items,n=e.sections;return this.getGalleryQueryCommandActionsInternal(e.ExternalUxId,e.galleryType,t,n,e.isListGallery)},e.prototype.getGalleryQueryCommandActionsInternal=function(e,t,n,r,i){var o=new Array(0),a=-1,s=null;if(n)s=this.addGalleryButtonQueryActions(t,n,o,(0,p.m)((function(){return a}),(function(e){return a=e})));else if(r)for(var l=0,c=r;l<c.length;l++){var u=c[l],g=this.addGalleryButtonQueryActions(t,u.galleryButtons,o,(0,p.m)((function(){return a}),(function(e){return a=e})));g&&(s=g)}return o.push(appChrome.actions.updateGallerySelectedId(e,s)),o.push(Yg(e,!1)),i&&a>0&&o.push(appChrome.actions.updateListGalleryTextDirection(e,2===a)),o},e.prototype.addGalleryButtonQueryActions=function(e,t,n,r){var i=null;r.val=-1;for(var o=!1,a=0,s=t;a<s.length;a++){var l=s[a];if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OptimizeGalleryPopulationIsEnabled")&&l in this._justPopulatedFullGalleryButtonsMap){if(this._justPopulatedFullGalleryButtonsMap[l]){delete this._justPopulatedFullGalleryButtonsMap[l];continue}this._justPopulatedFullGalleryButtonsMap[l]=!0}var c=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OptimizeGalleryPopulationIsEnabled")?this.getGalleryButtonModelTypeFromFullGalleryType(e):appChrome.selectors.getModelType(l),u={};u.SourceControlId=l;var g=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(l);if(g){var p=this.getPollResult(g,u);n.push(Yg(l,sp(p)));var d=Xg(l,c,u,p);d&&n.push.apply(n,d),u[bo.u.On]&&(i=l,u[bo.u.HighlightOn]&&u[bo.u.HighlightOn]&&(o=!0)),void 0!==u[Ni.b.labelText]&&null!==u[Ni.b.labelText]&&n.push(tp(g.get_externalUxCommand(),u[Ni.b.labelText])),u[bo.u.IsRtl]&&r.val<0&&(r.val=u[bo.u.IsRtl])}}return o&&(C.ULS.sendTraceTag(51517594,340,50,"HighlightSelectedFontStyle fired for {0} button",i),n.push(appChrome.actions.highlightSelectedFontStyle(i))),i},e.prototype.getGalleryButtonModelTypeFromFullGalleryType=function(e){switch(e){case"CharacterCodeGallery":return"CharacterCodeGalleryButtonModel";case"FontStyleGallery":return"FontStyleGalleryButtonModel";case"IconGallery":return"IconGalleryButtonModel";case"ListGallery":return"ListGalleryButtonModel";case"TableStyleGallery":return"TableStyleGalleryButtonModel";case"ChangeColorsGallery":return"ChangeColorsGalleryButtonModel";case"PageNumberGallery":return"PageNumberGalleryButtonModel"}return"None"},e.prototype.getPollResult=function(e,t){return t.MenuItemId=e.menuItemId,this._rootPoller.pollForCommandState(this._rootUser,this._rootType,e.get_commandId(),e.queryCommandId,t)},e}();(0,o.l)(cp,"ReactGalleryPoller",null,[]);var up=n(1244),gp=n(3084),pp=n(7101),dp=n(6422),hp=n(4116),_p=n(2075),mp=function(){return function(){this.iconSet=null,this.disabled=!1,this.hidden=!1,this.iconColor=null,this.fullDescriptionLabel=null,this.keytip=null,this.customTooltip=null}}();(0,o.l)(mp,"CommonOptionalButtonProperties",null,[]);var fp=function(e){function t(){var t=e.call(this)||this;return t.commandValueId=null,t.role=null,t.hideLabel=!1,t.supportsPreview=!1,t.lang=null,t}return(0,S.t)(t,e),t}(mp);(0,o.l)(fp,"OptionalButtonProperties",mp,[]);var yp=function(e){function t(){var t=e.call(this)||this;return t.commandValueId=null,t.styles=null,t.roleInMenu=null,t.lang=null,t.ariaDescription=null,t}return(0,S.t)(t,e),t}(mp);(0,o.l)(yp,"OptionalCompoundButtonProperties",mp,[]);var Cp=function(e){function t(){var t=e.call(this)||this;return t.menuModel=null,t.hideLabel=!1,t.downChevronIcon=null,t.hideChevron=!1,t.hideIcon=!1,t.lang=null,t.labelInMenu=null,t.toggled=!1,t.roleInMenu=null,t}return(0,S.t)(t,e),t}(mp);(0,o.l)(Cp,"OptionalFlyoutAnchorProperties",mp,[]);var Sp=function(e){function t(){var t=e.call(this)||this;return t.secondaryText=null,t.styles=null,t.flipIconInRtl=!1,t}return(0,S.t)(t,e),t}(fp);(0,o.l)(Sp,"OptionalPersonaButtonProperties",fp,[]);var vp=function(e){function t(){var t=e.call(this)||this;return t.toggled=!1,t.roleInMenu=null,t.toggleUsingIcon=!1,t}return(0,S.t)(t,e),t}(mp);(0,o.l)(vp,"OptionalToggleButtonProperties",mp,[]);var bp=function(){return function(){}}();(0,o.l)(bp,"PersonaIdentifiers",null,[]);var Tp=function(){return function(){}}();(0,o.l)(Tp,"PersonaInfo",null,[]);var Ap=n(99),Ip=function(){function e(){}return e.prototype.getStateProps=function(e,t){switch(t){case"ColorPickerModel":return appChrome.selectors.getColorPickerState(e);case"ToggleButtonModel":return this.getPropsForToggleButtonModel(e);case"GalleryModel":return appChrome.selectors.getGalleryState(e);case"SplitButtonModel":return appChrome.selectors.getSplitButtonState(e);case"SliderModel":return appChrome.selectors.getSliderState(e)}return{}},e.prototype.getPropsForToggleButtonModel=function(e){var t={};return t[Di.e.On]=appChrome.selectors.getButtonToggleState(e),t},e}();(0,o.l)(Ip,"ReactStatePropsSelector",null,[]);var wp=function(){function e(e,t,n,r,i){this._rootPoller=null,this._rootUser=null,this._rootType=0,this._reactGalleryPoller=null,this._externalUICommandDefinitionMapping=null,this._reactStatePropsSelector=null,this._successfullyPolledPopulateCommands=null,this._rootPoller=e,this._rootUser=t,this._rootType=n,this._externalUICommandDefinitionMapping=r,this._successfullyPolledPopulateCommands={},this._reactStatePropsSelector=new Ip,this._reactGalleryPoller=i}return e.prototype.skipPopulation=function(e){var t=e.populationProps.get_populateQueryCommandId();return e.populationProps.get_populateOnlyOnce()&&t in this._successfullyPolledPopulateCommands},e.prototype.getReduxActions=function(t,n,r){void 0===r&&(r=0);var i=new Array(0);if(!this.skipPopulation(t)){var o=t.populationProps.get_populateQueryCommandId(),a={};a.MenuId=t.get_externalUxCommand();var s=a;if((1&this._rootPoller.pollForCommandState(this._rootUser,this._rootType,o,o,a,r))>0&&s.MenuItems)switch(this._successfullyPolledPopulateCommands[o]=!0,n){case"ComboBoxModel":i.push(e.getPopulateComboBoxAction(t,s));break;case"FlyoutAnchorModel":case"PreviewGalleryModel":case"SplitButtonModel":case"StatefulSplitButtonModel":i.push.apply(i,this.getUpdateActionsForMenuControls(t.get_externalUxCommand(),n,s.MenuItems))}}return i},e.prototype.getUpdateActionsForMenuControls=function(e,t,n){for(var r=new Array(0),i=new Array(0),o=new Array(0),a=new Array(0),s=0;s<n.MenuSectionList.length;s++){var l=(0,f.e)(pa.x,n.MenuSectionList[s]);if(l){var c=null,u=new Array(0);Li.x(l.Title)||(c=l.Title);for(var g=0;g<l.ControlList.length;g++){var p=(0,f.e)(wg.i,l.ControlList[g]);if(!p||p.ExternalId)switch(p.get_ControlType()){case 1:case 3:var d=(0,f.e)(da.k,l.ControlList[g]);this.populateButton(d,r,i,u),d.MenuItemsStatefulData&&er.appChromeContainsAction("setStatefulSplitButtonMenuItemsStatefulData")&&r.push(appChrome.actions.setStatefulSplitButtonMenuItemsStatefulData(e,d.MenuItemsStatefulData));continue;case 2:this.populateToggleButton((0,f.e)(Ap.d,l.ControlList[g]),r,i,u);continue;case 6:this.populateCheckMarkToggleButton((0,f.e)(gp.e,l.ControlList[g]),r,i,u);continue;case 4:this.populatePersonaButton((0,f.e)(ha,l.ControlList[g]),r,i,u);continue;case 7:this.populateColorPicker((0,f.e)(pp.z,l.ControlList[g]),r,i,u);continue;case 9:var h=(0,f.e)(ua.b,l.ControlList[g]);this.populateFlyoutAnchor(h,r,i,u),"StatefulSplitButtonModel"===t&&a.push(h.ExternalId);continue;case 8:this._reactGalleryPoller.populateGallery((0,f.e)(hp.b,l.ControlList[g]),r,i,u);continue}}n.UpdateDynamically&&o.push(appChrome.api.menuSection(u,c,l.Lang))}}return n.UpdateDynamically&&r.push(appChrome.actions.updateMenu(e,o,n.Title,n.AriaLabel,n.ShouldAutoOpen,n.AriaRoleDescription)),i.length>0&&r.splice(0,0,appChrome.actions.addControls(i)),a.length>0&&er.appChromeContainsAction("setStatefulSplitButtonMruBypassControls")&&r.push(appChrome.actions.setStatefulSplitButtonMruBypassControls(e,a)),r},e.prototype.populateButton=function(e,t,n,r){r.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)?(e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)),e.Description&&t.push(appChrome.actions.updateCompoundButtonDescription(e.ExternalId,e.Description))):(e.Description||o.r(Pu,e)?n.push(appChrome.api.createCompoundButtonModel(e.ExternalId,e.LabelText,e.Description,(0,O.m)(new yp,{iconSet:new _p.x(this.getIconName(e)).iconSet,keytip:e.KeyTip,roleInMenu:e.RoleInMenu,ariaDescription:e.AriaDescription}))):n.push(appChrome.api.createButtonModel(e.ExternalId,e.LabelText,(0,O.m)(new fp,{iconSet:new _p.x(this.getIconName(e)).iconSet,keytip:e.KeyTip,supportsPreview:!!e.CommandPreviewId&&!!e.CommandRevertId,customTooltip:e.LabelText!==e.Alt?e.Alt:null}))),this._externalUICommandDefinitionMapping.addCommandToMaps((0,O.m)(new $g.d(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand,commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId}))),e.Lang&&er.appChromeContainsAction("setControlLanguage")&&t.push(appChrome.actions.setControlLanguage(e.ExternalId,e.Lang))},e.prototype.populateCheckMarkToggleButton=function(e,t,n,r){r.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)?e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)):(n.push(appChrome.api.createToggleButtonModel(e.ExternalId,e.LabelText,(0,O.m)(new vp,{iconSet:new _p.x(this.getIconName(e)).iconSet,keytip:e.KeyTip,toggled:e.IsChecked,fullDescriptionLabel:e.Description,roleInMenu:e.AriaLabel,customTooltip:e.LabelText!==e.Alt?e.Alt:null,toggleUsingIcon:!!e.CheckedImageClass}))),this._externalUICommandDefinitionMapping.addCommandToMaps((0,O.m)(new $g.d(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand})))},e.prototype.populateToggleButton=function(e,t,n,r){r.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId)?e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText)):(n.push(appChrome.api.createToggleButtonModel(e.ExternalId,e.LabelText,(0,O.m)(new vp,{iconSet:new _p.x(this.getIconName(e)).iconSet,keytip:e.KeyTip,fullDescriptionLabel:e.Description,roleInMenu:e.AriaLabel}))),this._externalUICommandDefinitionMapping.addCommandToMaps((0,O.m)(new $g.d(e.ExternalId,e.Command),{menuItemId:e.MenuItemId,queryCommandId:e.QueryCommand})))},e.prototype.populatePersonaButton=function(e,t,n,r){r.push(e.ExternalId);var i=this.getPersonaInfoFromProps(e);appChrome.selectors.isControlDefined(e.ExternalId)?e.LabelText&&t.push(appChrome.actions.setPersonaButtonCoauthor(e.ExternalId,i,e.LabelText)):er.apiExists("createPersonaButtonModel")&&n.push(appChrome.api.createPersonaButtonModel(e.ExternalId,i,e.LabelText,(0,O.m)(new Sp,{role:e.RoleInMenu,fullDescriptionLabel:e.AriaDescription,iconSet:{default:"doughboywhiteglyph_20"}})))},e.prototype.populateFlyoutAnchor=function(e,t,n,r){if(r.push(e.ExternalId),appChrome.selectors.isControlDefined(e.ExternalId))e.LabelText&&t.push(appChrome.actions.setControlLabel(e.ExternalId,e.LabelText));else{var i=!(void 0===e.ImageIsVisible||null===e.ImageIsVisible||e.ImageIsVisible),o=!(void 0===e.ImageIsVisible||null===e.ImageIsVisible)&&e.ImageIsVisible;n.push(appChrome.api.createFlyoutAnchorModel(e.ExternalId,e.LabelText,(0,O.m)(new Cp,{iconSet:new _p.x(this.getIconName(e)).iconSet,keytip:e.KeyTip,hideIcon:i,toggled:o,roleInMenu:e.AriaLabel}))),this._externalUICommandDefinitionMapping.addCommandToMaps((0,O.m)(new $g.d(e.ExternalId,e.Command),{queryCommandId:e.QueryCommand,populationProps:new up.s(e.PopulateQueryCommand,e.PopulateOnlyOnce)}))}e.Menu&&t.push.apply(t,this.getUpdateActionsForMenuControls(e.ExternalId,"FlyoutAnchorModel",e.Menu)),e.Lang&&t.push(appChrome.actions.setControlLanguage(e.ExternalId,e.Lang))},e.prototype.populateColorPicker=function(e,t,n,r){e.McuLayout&&r.push(e.McuExternalId),r.push(e.ExternalId);var i=0;appChrome.selectors.isControlDefined(e.ExternalId)?e.McuLayout&&(i=this._reactStatePropsSelector.getStateProps(e.ExternalId,"ColorPickerModel").columnCount):(e.McuLayout&&(n.push(appChrome.api.createColorPickerModel(e.McuExternalId,e.Width)),this._externalUICommandDefinitionMapping.addCommandToMaps((0,O.m)(new $g.d(e.McuExternalId,e.Command),{commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId})),i=e.Width),n.push(appChrome.api.createColorPickerModel(e.ExternalId,e.Width)),this._externalUICommandDefinitionMapping.addCommandToMaps((0,O.m)(new $g.d(e.ExternalId,e.Command),{commandPreviewId:e.CommandPreviewId,commandRevertId:e.CommandRevertId})));for(var o=new Array(0),a=new Array(0),s=0;s<e.Colors.length;s++){var l=e.Colors[s];s<i?o.push(appChrome.api.colorPickerCell(l.Color,l.DisplayColor,l.Alt)):a.push(appChrome.api.colorPickerCell(l.Color,l.DisplayColor,l.Alt))}o.length>0&&t.push(appChrome.actions.populateColorPickerCells(e.McuExternalId,o)),t.push(appChrome.actions.populateColorPickerCells(e.ExternalId,a))},e.prototype.getIconName=function(e){return e.Image32by32Class?this._externalUICommandDefinitionMapping.getExternalIconIdByLegacyIconId(e.Image32by32Class):e.Image16by16Class?this._externalUICommandDefinitionMapping.getExternalIconIdByLegacyIconId(e.Image16by16Class):e.ExternalImageId},e.prototype.getPersonaInfoFromProps=function(e){return e?(0,O.m)(new Tp,{displayName:e.DisplayName,personaCoinColor:e.ImageBackColor,isUnauthenticatedSender:e.IsAnonymous,identifiers:(0,O.m)(new bp,{PersonaType:"User",Smtp:e.PersonaId})}):null},e.getPopulateComboBoxAction=function(e,t){for(var n=new Array(0),r=0;r<t.MenuItems.MenuSectionList.length;r++){var i=t.MenuItems.MenuSectionList[r];i.Title&&n.push(appChrome.api.comboBoxHeader("Header-"+r.toString(),i.Title));for(var o=0;o<i.ControlList.length;o++){var a=(0,f.e)(dp.z,i.ControlList[o]);a&&n.push(appChrome.api.comboBoxItem(a.MenuItemId,a.LabelText,a.Styles,a.CommandValueId,a.AriaLabel,a.Data))}r<t.MenuItems.MenuSectionList.length-1&&n.push(appChrome.api.comboBoxDivider("Divider-"+r.toString()))}return appChrome.actions.populateComboBoxOptions(e.get_externalUxCommand(),n)},e}();(0,o.l)(wp,"ReactPopulateQueryCommandPoller",null,[]);var xp=function(){function e(e,t,n,r,i){this._externalUICommandDefinitionMapping=null,this._rootPoller=null,this._rootUser=null,this._rootType=0,this._reactGalleryPoller=null,this._externalUICommandDefinitionMapping=n,this._rootPoller=e,this._rootUser=t,this._rootType=r,this._reactGalleryPoller=i}return e.prototype.getReduxActions=function(e,t,n){var r=new Array(0);if(this.isContainerModelType(t)){var i=this.getStateActionsForContainerModelType(e,t,n);null!=i&&r.push.apply(r,i)}else if(e){var o=this.getPollResult(e,n);if(Ni.b.visible in n&&r.push(function(e,t){return appChrome.actions.updateControlHiddenState(e,t)}(e.get_externalUxCommand(),!n[Ni.b.visible])),r.push(Yg(e.get_externalUxCommand(),sp(o))),void 0!==n[Ni.b.labelText]&&null!==n[Ni.b.labelText]&&r.push(tp(e.get_externalUxCommand(),n[Ni.b.labelText])),null!=t){var a=Xg(e.get_externalUxCommand(),t,n,o);null!=a&&r.push.apply(r,a),"PeopleWell"===t&&this.addPeopleWellStateActions(e.get_externalUxCommand(),n,r)}}return r},e.prototype.getEnabledDisabledActionBasedOnChildrenCommands=function(e,t){var n=new Array(0),r={};switch(t){case"FlyoutAnchorModel":r=appChrome.selectors.getFlyoutAnchorMenuItems(e);break;case"SplitButtonModel":var i=appChrome.selectors.getSplitButtonState(e),o=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(i.command);if(o){var a=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,o.get_commandId());n.push(appChrome.actions.updateSplitButtonPrimaryDisabledState(e,!a)),n.push(Yg(e,!1))}return n;default:return null}var s=!1;for(var l in r){var c={key:l,value:r[l]},u=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(c.key);if(Li.x(u))s=!0;else if(a=this._rootPoller.pollForEnabledDisabledControlState(this._rootUser,u.get_commandId(),{SourceControlId:u.get_externalUxCommand()}))return n.push(Yg(e,!1)),n}return n.push(Yg(e,!s)),n},e.prototype.getStateActionsForContainerModelType=function(e,t,n){switch(t){case"PreviewGalleryModel":return this._reactGalleryPoller.getPreviewGalleryQueryCommandActions(e);case"GalleryModel":return this._reactGalleryPoller.getGalleryQueryCommandActions(n)}return null},e.prototype.isContainerModelType=function(e){return"GalleryModel"===e||"PreviewGalleryModel"===e},e.prototype.getPollResult=function(e,t){return t.MenuItemId=e.menuItemId,this._rootPoller.pollForCommandState(this._rootUser,this._rootType,e.get_commandId(),e.queryCommandId,t)},e.prototype.addPeopleWellStateActions=function(e,t,n){var r=t[So.g.LabelText],i=t[So.g.LabelTextUserGeneratedPlaceholderReplacements],o=r;return i&&i.length>0&&(o=String.format.apply(null,[o].concat(i))),n.push(this.getUpdatePeopleWellAction(e,o)),n},e.prototype.getUpdatePeopleWellAction=function(e,t){return appChrome.actions.updatePeopleWell(this.getCoauthorsInfo(e),t)},e.prototype.getCoauthorsInfo=function(e){var t=new Array(0),n={},r=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e).populationProps.get_populateQueryCommandId();this._rootPoller.pollForCommandState(this._rootUser,this._rootType,"1285265560",r,n);var i=n.MenuItems;if(!i)return t;for(var o=i.MenuSectionList[0],a=0;a<o.ControlList.length;a++){var s=o.ControlList[a],l={};l.name=s.Alt,l.id=s.MenuItemId,l.description=s.Description,l.color=s.ImageBackColor,l.joinTime=s.JoinTimeInMS,l.imageUrl=s.ImageUrl,l.activeStatus=s.ActiveStatus,l.isAnonymous=s.IsAnonymous,l.canJump=s.CanJump,l.chatCapable=s.ChatCapable,l.upn=s.Upn,t.push(l)}return t},e}();(0,o.l)(xp,"ReactQueryCommandPoller",null,[]);var Fp=n(9190),Ep=function(){function e(e,t,n){this._externalUICommandDefinitionMapping=null,this._rootUser=null,this._statePropsSelector=null,this._queryCommandPoller=null,this._reactPopulateQueryCommandPoller=null,this._reactGalleryPoller=null,this._externalUICommandDefinitionMapping=e,this._rootUser=t;var r=new Fp.g;this._statePropsSelector=new Ip,this._reactGalleryPoller=new cp(r,this._rootUser,n,this._externalUICommandDefinitionMapping),this._reactPopulateQueryCommandPoller=new wp(r,this._rootUser,n,this._externalUICommandDefinitionMapping,this._reactGalleryPoller),this._queryCommandPoller=new xp(r,this._rootUser,this._externalUICommandDefinitionMapping,n,this._reactGalleryPoller)}return e.prototype.getPollForStateAndUpdateActions=function(){var e=new Array(0);if(!er.appChromeAlreadyLoaded())return e;e.push.apply(e,this.getUpdateContextualTabsActions());var t=this.getDisableControlsInTabsActions(appChrome.selectors.getSelectedTabId());if(t.length>0)e.push.apply(e,t);else{for(var n=appChrome.selectors.getActiveControlIds(),r=0,i=this.getDisabledControlsInGroups(appChrome.selectors.getActiveGroupIds());r<i.length;r++){var o=i[r];e.push(appChrome.actions.updateControlEnabledDisabledState(o,!0)),delete n[o]}e.push.apply(e,this.getUpdateActionsForCommands(n))}return e},e.prototype.pollForStateAndUpdateCommands=function(e){if(er.appChromeAlreadyLoaded()){var t=this.getUpdateActionsForCommands(e);appChrome.api.dispatch(t)}},e.prototype.populateControlMenu=function(e,t,n){if(void 0===n&&(n=0),!Li.x(e)&&e.populationProps&&!this._reactPopulateQueryCommandPoller.skipPopulation(e)){var r=this._reactPopulateQueryCommandPoller.getReduxActions(e,t,n);if(r.length>0)return appChrome.api.dispatch(r),!0}return!1},e.prototype.getUpdateActionsForCommands=function(e){var t=new Array(0);for(var n in e){var r={key:n,value:e[n]},i=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(r.key),o=r.value,a=this._statePropsSelector.getStateProps(r.key,o);if(Li.x(i)){a.ExternalUxId=r.key;var s=this._queryCommandPoller.getEnabledDisabledActionBasedOnChildrenCommands(r.key,r.value);s&&s.length>0&&t.push.apply(t,s)}else a.MenuItemId=i.menuItemId,a.SourceControlId=r.key;t.push.apply(t,this._queryCommandPoller.getReduxActions(i,o,a))}return t},e.prototype.getUpdateContextualTabsActions=function(){for(var e=new Array(0),t=appChrome.selectors.getContextualTabIds(),n=0;n<t.length;n++){var r=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(t[n]);if(r){var i=this._rootUser.isRootCommandEnabled(r);e.push(appChrome.actions.activateDeactivateContextualTab(t[n],i))}}return e},e.prototype.getDisableControlsInTabsActions=function(e){var t=new Array(0),n=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(e);n&&(this._rootUser.isRootCommandEnabled(n)||t.push(appChrome.actions.updateDisabledEnabledStateForControlsInTab(e,!0)));return t},e.prototype.getDisabledControlsInGroups=function(e){for(var t=new Array(0),n=0,r=e;n<r.length;n++){var i=r[n],o=this._externalUICommandDefinitionMapping.getGroupsMetadataByExternalUxId(i);if(o)for(var a=0,s=o;a<s.length;a++){var l=s[a];if(!this._rootUser.isRootCommandEnabled(l.commandId)){var c=l.externalUxCommandIds;c||(c=appChrome.selectors.getVisibleControlsInGroup(l.externalUxGroupId)),t.push.apply(t,c)}}}return t},e.prototype.getDisableControlsInGroupsActions=function(e){for(var t=new Array(0),n=0,r=e;n<r.length;n++){var i=r[n],o=this._externalUICommandDefinitionMapping.getGroupsMetadataByExternalUxId(i);if(o)for(var a=0,s=o;a<s.length;a++){var l=s[a];if(!this._rootUser.isRootCommandEnabled(l.commandId))if(l.externalUxCommandIds)for(var c=0,u=l.externalUxCommandIds;c<u.length;c++){var g=u[c];t.push(appChrome.actions.updateControlEnabledDisabledState(g,!0))}else t.push(appChrome.actions.updateDisabledEnabledStateForControlsInGroup(l.externalUxGroupId,!0))}}return t},e}();(0,o.l)(Ep,"ReactRibbonRootPoller",null,[jg]);var Pp=function(){function e(e,t,n){void 0===n&&(n=null),this._reactCommandDefinitionMapping=null,this._reactRibbonRootPoller=null,this._lastPollTime=null,this.$$pf_RootUser=null,this._reactCommandDefinitionMapping=t,e.addRoot(this),this.set_rootUser(n)}return e.prototype.get_lastPollTime=function(){return this._lastPollTime||(this._lastPollTime=new Date,this._lastPollTime.setTime(0)),this._lastPollTime},e.prototype.set_lastPollTime=function(e){return this._lastPollTime=e,e},e.prototype.get_rootType=function(){return 2},e.prototype.get_rootUser=function(){return this.$$pf_RootUser},e.prototype.set_rootUser=function(e){return this.$$pf_RootUser=e,e},e.prototype.get_reactRibbonRootPoller=function(){return this._reactRibbonRootPoller||(this._reactRibbonRootPoller=new Ep(this._reactCommandDefinitionMapping,this.get_rootUser(),this.get_rootType())),this._reactRibbonRootPoller},e.prototype.commitAnyPendingChange=function(){var e=document.activeElement;_i.s.isEditable(e)&&e.blur()},e.prototype.executeCommand=function(e,t,n,r,i,o,a,s){if(void 0===s&&(s=2),!Li.x(this.get_rootUser())){var l=new Do.f;l.CommandLocation=s,l.InvocationMethod=r,l.CommandTabName=n,this.checkFloodgateSurveyInfo(),this.get_rootUser().executeRootCommand(e,t,l,o,a)}},e.prototype.getPollForStateAndUpdateActions=function(){return Li.x(this.get_rootUser())?new Array(0):this.get_reactRibbonRootPoller().getPollForStateAndUpdateActions()},e.prototype.pollForStateAndUpdate=function(){var e=this.getPollForStateAndUpdateActions();e.length>0&&(this.set_lastPollTime(new Date),appChrome.api.dispatch(e))},e.prototype.updatePeopleWellControl=function(){if(er.appChromeAlreadyLoaded()){var e={PeopleWell:"PeopleWell"};this.get_reactRibbonRootPoller().pollForStateAndUpdateCommands(e)}},e.prototype.updateDocChatControl=function(){if(er.appChromeAlreadyLoaded()){var e={DocChat:"ButtonModel"};this.get_reactRibbonRootPoller().pollForStateAndUpdateCommands(e)}},e.prototype.updateControl=function(e){},e.prototype.checkFloodgateSurveyInfo=function(){var e=se.w.get_instance().tryResolve(zg.t);e?e.logActivity("SLRCommandUsed","FGSLRUsageEnabled"):C.ULS.sendTraceTag(36741406,340,50,"ISystemInitiatedFeedback was null")},e}();(0,o.l)(Pp,"ReactRibbonRoot",null,[Kg.l,qg]);var kp="TheStandaloneRoot",Dp=function(){function e(e){this._standaloneRoot=null;var t=new oa;t.ImageUpArrow=t.ImageDownArrow=t.ImageSideArrow=t.ImageCheckMark=t.ImageUncheckMark=t.ImageDownArrow8by8=t.ImageUpArrow8by8=e,t.ImageUpArrowClass=Lt.getImageClass("RibbonUpArrow_5x3x32"),t.ImageDownArrowClass=Lt.getImageClass("SplitButtonArrow_5x3x32"),t.ImageUpArrow8by8Class=Lt.getImageClass("RibbonUpArrow_8x8x32"),t.ImageDownArrow8by8Class=Lt.getImageClass("SplitButtonArrow_8x8x32"),t.ImageSideArrowClass=Lt.getImageClass("SubmenuFlyoutArrow_13x13x32"),t.ImageCheckMarkClass=Lt.getImageClass("CheckboxChecked_16x16x32"),t.ImageUncheckMarkClass=Lt.getImageClass("CheckboxUnchecked_16x16x32"),t.TextDirection=L.AFrameworkApplication.get_isRtl()?"rtl":"ltr",this._standaloneRoot=Zo.w.createStandaloneRoot(kp,t),this._standaloneRoot.refresh()}return e.prototype.get_sharedStandaloneRoot=function(){return this._standaloneRoot},e.prototype.dispose=function(){this._standaloneRoot.dispose()},e}();(0,o.l)(Dp,"StandaloneRootController",null,[ou.r,Sys.IDisposable]);var Mp=function(){function e(){this._container=null,this._contextMenuController=null,this._standaloneRootController=null}return e.prototype.get_name=function(){return"Box4.UI"},e.prototype.configure=function(e){var t=this;this._container=e,L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactFloatieEnabled()?(e.register(au).singleInstance().usingFactory((function(){return new Vg(e.resolve(Pp),e.resolve(su.u))})),e.register(iu.k).singleInstance().usingFactory((function(){return new Ou(e.resolve(au))}))):e.register(iu.k).singleInstance().usingFactory((function(){return new bu(e.resolveFuture(lu.h))})),e.register(lu.h).usingFactory((function(){return new Cg(e.resolve(Yu),L.AFrameworkApplication.get_theActionManager())})).singleInstance(),e.register(lg).singleInstance().usingFactory((function(){return new lg(e.resolve(cu.z),new Gg.b,e.resolve($a.b).get_instance())})),e.register(uu).usingFactory((function(){return new Sg(Oa.SelectionManager.get_instance().get_selectionContextForActionDispatch(),e.tryResolve(gu.n),e.resolveFuture(Ha.r),e.resolve(pu.e))})),e.register(Dp).as(ou.r).singleInstance().usingFactory((function(){return new Dp(L.AFrameworkApplication.get_imageClusterPath())})),e.register(du).usingFactory((function(){return new rg(e.resolve(Wa),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReplaceQuoteWithSmartQuoteIsEnabled"))})),e.register(Ag).as(hu).singleInstance().usingFactory((function(){return new Ag(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RecentlyUsedLanguagesListIsEnabled"))})),e.register(Ru).as(_u).singleInstance(),e.register(Au).singleInstance().usingFactory((function(){return new Au(e.resolve(_u))})),e.register(Mu).as(mu).singleInstance().usingFactory((function(){return new Mu(e.resolve(Au),e.resolve(Du))})),e.register(Hg).as(fu.l).singleInstance().usingFactory((function(){return new Hg(t._container.resolve(yu.r))})),e.register(Ug).singleInstance().usingFactory((function(){return new Ug}))},e.prototype.init=function(){var e,t=Br.App.get_activeAppFrame(),n=t.get_applicationInstance();Mr.initSignOutResponseUI(t,o.i(n,n.onAuthenticationLost,"onAuthenticationLost"),o.i(n,n.onAuthenticationRestored,"onAuthenticationRestored"),t.get_canUseAppAfterAuthLost()),Zu.registerActions(),(e=L.AFrameworkApplication.get_theActionManager()).addAction(ii.Ui,cl.U,dg),e.addActionWithFlags(ii.ad,cl.U,hg,96),e.addActionWithFlags(ii.yJ,cl.U,_g,96),function(){var e=L.AFrameworkApplication.get_theActionManager();e.addActionWithFlags(ii.Yk,cl.U,Lg,96),e.addActionWithFlags(ii.Yu,cl.U,Ng,96)}(),Fg.registerActions(),this._contextMenuController=this._container.tryResolve(iu.k),this.initializeStandaloneRoot(),this._standaloneRootController=this._container.resolve(ou.r)},e.prototype.initializeStandaloneRoot=function(){var e=this;this._container.resolveFuture(lu.h).execute((function(t){e._container.resolveFuture(ou.r).execute((function(e){e.get_sharedStandaloneRoot().set_rootUser(t)}))}))},e.prototype.dispose=function(){this._contextMenuController&&(this._contextMenuController.dispose(),this._contextMenuController=null),this._standaloneRootController.dispose(),this._standaloneRootController=null},e.main=function(){N.o.get_instance().registerPackage(new e,6)},e}();(0,o.l)(Mp,"Box4UIPackage",null,[l.u,c.s]);var Rp=n(6473),Lp=n(323),Np=n(5100),Bp=n(426),Op=function(e,t){var n=0,r=t.x-e.x,i=t.y-e.y;return(n=Math.atan2(i,r))<0&&(n+=2*Math.PI),n},Up=function(){function e(e,t,n){this._startPoint=null,this._endPoint=null,this._offset=null,this._classNameDirection=0,this._cursorDirection=0,this._imagePresenter=null,this._actionManager=null,this._zoomManager=null,this._angle=0,this._flipX=!1,this._flipY=!1,this._isHorizontal=!1,this._isVertical=!1,this._imageWidth=0,this._imageHeight=0,this._imageScale=0,this._imagePresenter=e,this._actionManager=t,this._zoomManager=n}return e.prototype.isDragPossible=function(e){return!!Br.App.get_activeAppFrame().workspace.get_isEditingAllowed()&&""!==this.getHandleClassName(e.get_sourceElement())},e.prototype.onDragStart=function(e){var t=this;return!!this.isDragPossible(e)&&(this._angle=this._imagePresenter.getCurrentRotationAngle(),this.setResizeClassNameDirection(e),this.setResizeCursorDirection(),this.setResizeDirectionPermissions(this._cursorDirection,(0,p.m)((function(){return t._isHorizontal}),(function(e){return t._isHorizontal=e})),(0,p.m)((function(){return t._isVertical}),(function(e){return t._isVertical=e}))),this.setResizeOffsetFlags(),this._startPoint=e.get_screenPoint(),this._offset=new Sys.UI.Point(0,0),this._imagePresenter.getDimensions((0,p.m)((function(){return t._imageWidth}),(function(e){return t._imageWidth=e})),(0,p.m)((function(){return t._imageHeight}),(function(e){return t._imageHeight=e}))),C.ULS.sendTraceTag(16802335,322,50,"Image resize drag started"),!0)},e.prototype.onDragMove=function(e){return this._endPoint=e.get_screenPoint(),this.calcOffset(),this._imageScale=function(e,t,n,r,i,o,a,s){var l,c=1;if(!e&&!t||!n||!r)return c;if(i&&o){var u=n+e,g=r+t,p=1/n,d=1/r,h=p>d?p:d;if(u<1?u=1:u>1920&&(u=1920),g<1?g=1:g>1280&&(g=1280),e=u-n,t=g-r,L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordSmoothImageHelperGetScaleSettings"),s){var _=u/n,m=g/r;c=Math.abs(_-a)<Math.abs(m-a)?_:m}else c=Math.abs(e/n)>Math.abs(t/r)?u/n:g/r;c<h&&(c=h)}else i?((l=n+e)<1?l=1:l>1920&&(l=1920),c=l/n):o&&((l=r+t)<1?l=1:l>1280&&(l=1280),c=l/r);return c}(this._offset.x,this._offset.y,this._imageWidth,this._imageHeight,this._isHorizontal,this._isVertical,this._imageScale,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmoothImageHelperGetScaleIsEnabled")),this._imagePresenter.updateRenderSize(this._imageScale,this._isHorizontal,this._isVertical),!0},e.prototype.onDragEnd=function(e){this.setSize(),C.ULS.sendTraceTag(16802336,322,50,"Image resize drag succeeded")},e.prototype.onDragCancel=function(e){this._imagePresenter.resetRenderSize(),C.ULS.sendTraceTag(16802337,322,50,"Image resize drag canceled")},e.prototype.setResizeCursorDirection=function(){var e=Math.floor((this._angle+22)/45)%8+this._classNameDirection;this._cursorDirection=e%8},e.prototype.setResizeDirectionPermissions=function(e,t,n){if(this._angle&&90!==this._angle&&180!==this._angle&&270!==this._angle&&360!==this._angle||this.isIntermediateDirection(e))return t.val=!0,void(n.val=!0);switch(t.val=!1,n.val=!1,e){case 1:case 5:n.val=!0;break;case 3:case 7:t.val=!0}},e.prototype.setResizeOffsetFlags=function(){switch(this._flipX=!1,this._flipY=!1,this._cursorDirection){case 0:this._flipX=!0,this._flipY=!0;break;case 1:case 2:this._flipY=!0;break;case 7:case 6:this._flipX=!0}},e.prototype.isIntermediateDirection=function(e){return!(e%2)},e.prototype.getHandleClassName=function(e){var t=e.className;-1===t.indexOf("WACImageResizeHandle")&&e.parentNode&&(t=e.parentNode.className);for(var n=t.split(" "),r=0;r<n.length;r++){var i=n[r].toString();if(i.startsWith("WACImageResizeHandle")&&"WACImageResizeHandles"!==i)return i}return""},e.prototype.setResizeClassNameDirection=function(e){switch(this.getHandleClassName(e.get_sourceElement())){case"WACImageResizeHandleNW":this._classNameDirection=0;break;case"WACImageResizeHandleN":this._classNameDirection=1;break;case"WACImageResizeHandleNE":this._classNameDirection=2;break;case"WACImageResizeHandleE":this._classNameDirection=3;break;case"WACImageResizeHandleSE":this._classNameDirection=4;break;case"WACImageResizeHandleS":this._classNameDirection=5;break;case"WACImageResizeHandleSW":this._classNameDirection=6;break;case"WACImageResizeHandleW":this._classNameDirection=7}},e.prototype.calcOffset=function(){var e=1;this._zoomManager.get_instance()&&(e=this._zoomManager.get_instance().get_currentZoom());var t=(this._endPoint.x-this._startPoint.x)/e,n=(this._endPoint.y-this._startPoint.y)/e;this._offset.x=this._flipX?-t:t,this._offset.y=this._flipY?-n:n},e.prototype.setSize=function(){var e,t,n=new Kl.DictionaryPropertySet;(n.setValue(zl.k.imageScale,100*this._imageScale),n.setValue(zl.k.imageScaleFromCurrent,!0),90===this._angle||270===this._angle)?(this.setResizeDirectionPermissions(this._classNameDirection,(0,p.m)((function(){return e}),(function(t){return e=t})),(0,p.m)((function(){return t}),(function(e){return t=e}))),n.setValue(zl.k.imageResizeIsHorizontal,e),n.setValue(zl.k.imageResizeIsVertical,t)):(n.setValue(zl.k.imageResizeIsHorizontal,this._isHorizontal),n.setValue(zl.k.imageResizeIsVertical,this._isVertical));this._actionManager.processActionWithData(ii.dK,2,n)},e}();(0,o.l)(Up,"ImageResizeDragAdapter",null,[Bp.q]);var Hp=function(){function e(e,t){this._actionManager=null,this._zoomManager=null,this._actionManager=e,this._zoomManager=t}return e.prototype.getImageResizeDragAdapter=function(e){return new Up(e,this._actionManager,this._zoomManager)},e}();(0,o.l)(Hp,"ImageResizeDragAdapterFactory",null,[Rp.i]);var Gp=(0,o.y)("IImageRotateDragAdapter"),Vp=n(4469),Wp=n(5531),zp=function(){function e(e,t,n,r,i,o){this._interactiveView=null,this._imagePresenter=null,this._actionManager=null,this._selectionManager=null,this._zoomManager=null,this._rotationContext=null,this._startPoint=null,this._endPoint=null,this._imgTopLeft=null,this._selectElement=null,this._rotateGripper=null,this._rotateHandle=null,this._wetChangeAngle=0,this._rotatingAngle=0,this._originalAngle=0,this._localAngle=0,this._properties=null,this._rotationGripperCreated=!1,this._isDisposed=!1,this._actionManager=e,this._selectionManager=t,this._interactiveView=n,this._imagePresenter=r,this._zoomManager=i,this._rotatingAngle=0,this._localAngle=0,this._selectElement=o}return e.prototype.createRotationHandle=function(){this._selectElement?(this._rotateHandle=Vp.s(this._selectElement.ownerDocument,Wp.q.span),this._rotateHandle.className="WacImgRotateHandle WacImgRotateBase",this._rotateGripper=Lt.createClusteredImage(24,24,"RotationArrow_24x24x32","WacImgRotateArrow",!1,""),this._rotateGripper.style.left="-12px",this._rotateGripper.style.position="absolute",this._rotateHandle.appendChild(this._rotateGripper),this._selectElement.appendChild(this._rotateHandle),this._rotationGripperCreated=!0):C.ULS.sendTraceTag(50868820,322,15,"_selectElement is null when creating rotate handle")},e.prototype.flipRotateGripper=function(e){this._rotationGripperCreated&&!this._isDisposed||C.ULS.sendTraceTag(50597971,322,15,"{0}",{Message:"FlipRotateGripper called before create gripper or after dispose",RotationGripperCreated:this._rotationGripperCreated,IsDisposed:this._isDisposed}),this._rotateHandle&&this._rotateGripper||(C.ULS.sendTraceTag(50597972,322,15,"{0}",{Message:"_rotateHandle or _rotateGripper is null. Call CreateRotationHandle again",SelectElementIsNull:!this._selectElement,RotateHandleIsNull:!this._rotateHandle,RotateGripperIsNull:!this._rotateGripper}),this.createRotationHandle()),e?(this._rotateGripper&&Sys.UI.DomElement.addCssClass(this._rotateGripper,"Flipped"),this._rotateHandle&&Sys.UI.DomElement.addCssClass(this._rotateHandle,"Flipped"),hi.o.setFlipTransForms(this._rotateGripper,!0,!0)):(this._rotateGripper&&Sys.UI.DomElement.removeCssClass(this._rotateGripper,"Flipped"),this._rotateHandle&&Sys.UI.DomElement.removeCssClass(this._rotateHandle,"Flipped"),hi.o.setFlipTransForms(this._rotateGripper,!1,!1))},e.prototype.getRotationGripper=function(){return this.createRotationHandle(),this._rotateGripper},e.prototype.isDragPossible=function(e){return!!Br.App.get_activeAppFrame().workspace.get_isEditingAllowed()&&(!!e&&(this._rotationContext=this.getImageContext(),!!this._rotationContext))},e.prototype.onDragStart=function(e){return!!this.isDragPossible(e)&&(this._rotationContext=this.getImageContext(),this._properties=ka.ImageReader.getImagePropertiesFromContext(this._rotationContext),this._properties?(this._startPoint=this.getClientPoint(e),this._imgTopLeft=Sys.UI.DomElement.getBounds(this._selectElement),this._wetChangeAngle=ka.ImageReader.getImageWetChangeRotationAngle(this._properties)>0?ka.ImageReader.getImageWetChangeRotationAngle(this._properties):0,this._originalAngle=ka.ImageReader.getImagePersistedRotationAngle(this._properties),C.ULS.sendTraceTag(22052886,322,50,"Image rotate drag event started."),!0):(C.ULS.sendTraceTag(24496074,322,15,"Drag start cancelled. Attempted to rotate with null img. properties."),!1))},e.prototype.onDragMove=function(e){return this._endPoint=this.getClientPoint(e),this.calculateAngle(),this._imagePresenter?(this._imagePresenter.updateRotationEffect(this._rotatingAngle,this._localAngle),C.ULS.sendTraceTag(25179723,322,50,"Image rotate drag move is happening."),!0):(C.ULS.sendTraceTag(25179724,322,50,"Image rotate drag move aborted because img presenter is null."),!1)},e.prototype.onDragEnd=function(e){var t;this._rotatingAngle=(t=this._rotatingAngle,(t%=360)<0&&(t+=360),t),this._wetChangeAngle=this._rotatingAngle,this.setRotation(),C.ULS.sendTraceTag(22052887,322,50,"Image rotate drag event ended.")},e.prototype.onDragCancel=function(e){this._imagePresenter.updateRotationEffect(this._originalAngle,0),C.ULS.sendTraceTag(22052888,322,50,"Image rotate drag event canceled.")},e.prototype.getClientPoint=function(e){return this._interactiveView.getClientPointFromDomEvent(e)},e.prototype.getImageContext=function(){return this._selectionManager.get_selectionContextForActionDispatch()},e.prototype.calculateAngle=function(){var e=1;this._zoomManager&&this._zoomManager.get_instance()&&(e=this._zoomManager.get_instance().get_currentZoom());var t=this._imgTopLeft.x+this._selectElement.clientWidth/2*e,n=this._imgTopLeft.y+this._selectElement.clientHeight/2*e,r=new Sys.UI.Point(t,n),i=Op(this._startPoint,r),o=Op(this._endPoint,r);this._rotatingAngle=Math.round(Jg.ns(o-i)),this._wetChangeAngle>0&&(this._rotatingAngle+=this._wetChangeAngle-this._originalAngle),this._localAngle=this._rotatingAngle,this._rotatingAngle+=this._originalAngle},e.prototype.setRotation=function(){var e=new Kl.DictionaryPropertySet;e.setValue(zl.k.imageRotateActionType,0),e.setValue(zl.k.imageRotateAngle,this._rotatingAngle),this._actionManager.processActionWithData(ii.xN,2,e)},e.prototype.dispose=function(){C.ULS.sendTraceTag(50597973,322,50,"ImageRotateDragAdapter is disposed."),this._isDisposed||(this._rotateHandle&&(this._rotateGripper&&this._rotateHandle.contains(this._rotateGripper)&&(this._rotateHandle.removeChild(this._rotateGripper),this._rotateGripper=null),this._selectElement&&this._selectElement.contains(this._rotateHandle)&&(this._selectElement.removeChild(this._rotateHandle),this._rotateHandle=null)),this._isDisposed=!0)},e}();(0,o.l)(zp,"ImageRotateDragAdapter",null,[Gp,Bp.q,Sys.IDisposable]);var Kp=function(){function e(e,t,n){this._selectionManager=null,this._actionManager=null,this._zoomManager=null,this._actionManager=e,this._selectionManager=t,this._zoomManager=n}return e.prototype.create=function(e,t,n){return new zp(this._actionManager,this._selectionManager,e,t,this._zoomManager,n)},e}();(0,o.l)(Kp,"ImageRotateDragAdapterFactory",null,[Np.j]);var qp=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.Images"},e.prototype.configure=function(e){this._container=e,this._container.register(Hp).as(Rp.i).singleInstance().usingFactory((function(){return new Hp(L.AFrameworkApplication.get_theActionManager(),se.w.get_instance().resolveFuture(Lp.w))})),this._container.register(Kp).as(Np.j).singleInstance().usingFactory((function(){return new Kp(L.AFrameworkApplication.get_theActionManager(),Oa.SelectionManager.get_instance(),se.w.get_instance().resolveFuture(Lp.w))}))},e.prototype.init=function(){this._container.resolve(Np.j)},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(qp,"Box4ImagesPackage",null,[l.u,c.s]);var jp=(0,o.y)("ISelectAllHandlers"),$p=n(1264),Qp=n(4347),Jp=n(6166),Xp=n(6546),Yp=function(){function e(){this._paragraphNode=null}return e.prototype.get_contentTitle=function(){return null},e.prototype.getTitle=function(e){return null},e.prototype.getDescription=function(e){return null},e.prototype.reset=function(e){this._paragraphNode=e.get_node()},e.prototype.tryGetCpContext=function(e,t){var n=Xp.o(this._paragraphNode,e);return t.val=null,!(!n||n.get_blobType()!==this.get_blobType())&&(t.val=new xa.e,t.val.set_providerKey(this.get_key()),t.val.set_contentObject(n),t.val.title=this.getTitle(n),t.val.description=this.getDescription(n),!0)},e}();(0,o.l)(Yp,"BlobDetailsProvider",null,[Ia.q,Jp.f]);var Zp=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.get_key=function(){return"EQUATION"},t.prototype.get_blobType=function(){return 11},t.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_EquationContentTitle},t}(Yp);(0,o.l)(Zp,"EquationDetailsProvider",Yp,[]);var ed=function(){function e(){this._hyperlinkRanges=null}return e.prototype.get_key=function(){return"LINK"},e.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_HyperlinkContentTitle},e.prototype.reset=function(e){this._hyperlinkRanges=Hs.HyperlinkReader.getHyperlinksInParagraph(e.get_node())},e.prototype.tryGetCpContext=function(e,t){t.val=null;for(var n=0,r=this._hyperlinkRanges;n<r.length;n++){var i=r[n];if(i.cpBegin<=e&&e<i.cpEnd)return t.val=new xa.e,t.val.set_providerKey(this.get_key()),t.val.set_contentObject(i.hyperlink),!0}return!1},e}();(0,o.l)(ed,"HyperlinkDetailsProvider",null,[Ia.q,Jp.f]);var td=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.get_key=function(){return"IMAGE"},t.prototype.get_blobType=function(){return 5},t.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_ImageContentTitle},t.prototype.getTitle=function(e){return ka.ImageReader.getImageAltText(e.properties)},t.prototype.getDescription=function(e){return ka.ImageReader.getImageAltTextDescription(e.properties)},t}(Yp);(0,o.l)(td,"ImageDetailsProvider",Yp,[]);var nd=function(){function e(){}return e.prototype.get_key=function(){return"IMAGENODE"},e.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_ImageContentTitle},e.prototype.tryGetDocumentStructureDetails=function(e,t){return t.val=null,!(!e||!ka.ImageReader.isImageNode(e.get_currentNode()))&&(t.val=new Ea,t.val.set_providerKey(this.get_key()),t.val.contentId=e.get_currentNode().get_id(),t.val.set_contentObject(e.get_currentNode()),!0)},e.prototype.getContentIncrementalDetails=function(e,t){var n=e.get_contentObject(),r=Box4Intl.Box4Strings.l_AccessibleContentDetailsFormat,i="";return t&&n.get_id()===t.get_contentObject().get_id()||(i=String.format(r,ka.ImageReader.getImageAltText(n.get_properties()),Box4Intl.Box4Strings.l_ImageContentTitle)),i},e.prototype.tryCollapseNestedContent=function(e,t,n){return n.val=null,!1},e}();(0,o.l)(nd,"ImageNodeDetailsProvider",null,[wa,Jp.f]);var rd,id=n(4150),od=function(){function e(t,n){this._proofingType=0,this._errorRangeEditor=null,this._errorRanges=null,this.key=null,this.contentTitle=null,this._errorRangeEditor=n,this._proofingType=t,this.key=e.keys.get_item(t),this.contentTitle=e.contentTitles.get_item(t)}return e.prototype.get_key=function(){return this.key},e.prototype.get_contentTitle=function(){return this.contentTitle},e.prototype.reset=function(e){this._errorRanges=this._errorRangeEditor.getErrorRanges(e.get_node())},e.prototype.tryGetCpContext=function(t,n){var r=this,i=e.firstOrDefault(id.w,this._errorRanges||new Array(0),(function(e){return r.isCpInErrorRangeOfProofingType(t,e)}));return n.val=this.createCpContentDetails(i),!!n.val},e.prototype.isCpInErrorRangeOfProofingType=function(e,t){return t.get_begin()<=e&&e<t.get_end()&&(!t.errorDetails||this._proofingType===t.errorDetails.get_proofingType())},e.prototype.createCpContentDetails=function(e){var t;return e?((t=new xa.e).set_providerKey(this.get_key()),t.set_contentObject(e.errorDetails),t.description=this.getContentDetailsDescription(),t):null},e.prototype.getContentDetailsDescription=function(){return L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordEditorIdeasCardsIsEnabled")?Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress:null},e.firstOrDefault=function(e,t,n){for(var r=0,i=t;r<i.length;r++){var a=i[r];if(n(a))return a}return o.c(e)},e.keys=((rd=new Iu.n(Fu.t,String)).add(1,"SPELLINGERROR"),rd.add(2,"GRAMMATICALERROR"),rd.add(3,"ADVANCEDERROR"),rd),e.contentTitles=((rd=new Iu.n(Fu.t,String)).add(1,Box4Intl.Box4Strings.l_SpellingErrorContentTitle),rd.add(2,Box4Intl.Box4Strings.l_GrammaticalErrorContentTitle),rd.add(3,Box4Intl.Box4Strings.l_AdvancedProofingIssueContentTitle),rd),e}();(0,o.l)(od,"ProofingDetailsProvider",null,[Ia.q,Jp.f]);var ad=function(){return function(){this.tableNode=null,this.rows=0,this.columns=0,this.rowIdx=0,this.colIdx=0}}();(0,o.l)(ad,"TableInfo",null,[]);var sd=n(2544),ld=n(2534),cd=n(5360),ud=function(){function e(){}return e.prototype.get_key=function(){return"TABLE"},e.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_TableContentTitle},e.prototype.tryGetDocumentStructureDetails=function(e,t){if(t.val=null,!Zc.isTableCell(e))return!1;var n=new Da.GraphIterator;n.setFrom(e);var r=new ad;return r.rowIdx=cd.z(n)+1,r.colIdx=sd.e(n)+1,ld.returnToContainingTable(n),r.tableNode=n.get_currentNode(),r.columns=dc.TableReader.getColumnCount(r.tableNode),r.rows=dc.TableReader.getRowCount(r.tableNode),t.val=new Ea,t.val.set_providerKey(this.get_key()),t.val.contentId=r.tableNode.get_id(),t.val.set_contentObject(r),!0},e.prototype.getContentIncrementalDetails=function(e,t){var n=e.get_contentObject(),r=new Ra.o(String);return t||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsFormat,n.columns,n.rows)),t&&t.get_contentObject().colIdx===n.colIdx||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsColumnFormat,n.colIdx)),t&&t.get_contentObject().rowIdx===n.rowIdx||r.add(String.format(Box4Intl.Box4Strings.l_TableContentDetailsRowFormat,n.rowIdx)),r.toArray().join(" ")},e.prototype.tryCollapseNestedContent=function(e,t,n){return n.val=null,!1},e}();(0,o.l)(ud,"TableDetailsProvider",null,[wa,Jp.f]);var gd=function(){function e(e,t){this._futureAccessibilityContextManager=null,this._errorRangeEditor=null,this._futureAccessibilityContextManager=e,this._errorRangeEditor=t}return e.prototype.registerContentDetailsProviders=function(){var e=this;this._futureAccessibilityContextManager.execute((function(t){t.registerCpContentDetailsProvider(new ed),t.registerCpContentDetailsProvider(new od(1,e._errorRangeEditor)),t.registerCpContentDetailsProvider(new od(2,e._errorRangeEditor)),t.registerCpContentDetailsProvider(new od(3,e._errorRangeEditor)),t.registerCpContentDetailsProvider(new Zp),t.registerCpContentDetailsProvider(new td),t.registerStructuralContentDetailsProvider(new ud),t.registerStructuralContentDetailsProvider(new nd)}))},e}();(0,o.l)(gd,"AccessibilityActor$0",null,[]);var pd=(0,o.y)("IBox4PasteStewardFactory"),dd=n(4901),hd=(0,o.y)("IBox4PasteStewardUtils"),_d=n(2840),md=(0,o.y)("ISystemClipboard"),fd=n(9323),yd=(0,o.y)("IChromeExtensionHelper"),Cd=(0,o.y)("ISystemClipboardAccessManagerFactory"),Sd=(0,o.y)("ISystemClipboardAccessManager"),vd=n(9552),bd=(0,o.y)("IClipboardOperationCutStrategy"),Td=(0,o.y)("IDeleteTableSegmentStrategy"),Ad=(0,o.y)("ISelectionFactory"),Id=(0,o.y)("IRenderOrderGraphIteratorFactory"),wd=(0,o.y)("IDomElementContentStateFactory"),xd=(0,o.y)("IClipboardOperationPasteOvertypeStrategy"),Fd=n(9504),Ed=n(3806),Pd=n(8861),kd=n(2586),Dd=n(1647),Md=n(3679),Rd=(0,o.y)("IClipboardOperationPasteFactory"),Ld=(0,o.y)("IClipboardOperationPasteStrategyFactory"),Nd=(0,o.y)("IClipboardOperationCutCopyFactory"),Bd=n(1992),Od=n(7593),Ud=n(51),Hd=(0,o.y)("IClipboardOperationClipboardAccessHelper"),Gd=n(2958),Vd=n(2013),Wd=n(6826),zd=(0,o.y)("IExternalPasteExecutionManagerFactory"),Kd=(0,o.y)("IBox4ImageStewardFactory"),qd=(0,o.y)("IBox4TableStewardFactory"),jd=(0,o.y)("IBox4WordConverterFactory"),$d=(0,o.y)("IHtmlTranslatorSettings"),Qd=(0,o.y)("IContentControlCopyPasteHelper"),Jd=(0,o.y)("IExternalPasteCssConverter"),Xd=(0,o.y)("IHtmlNormalizerSettings"),Yd=n(7415),Zd=n(9487),eh=n(1408),th=n(4e3),nh=(0,o.y)("IInternalPasteExecutionManagerFactory"),rh=(0,o.y)("IImageStewardBridge"),ih=n(6339),oh=n(7734),ah=n(770),sh=n(1714),lh=(0,o.y)("IFontNameFormattingStrategy"),ch=n(4890),uh=(0,o.y)("ILanguageDialog"),gh=n(274),ph=n(8123),dh=(0,o.y)("IProofingErrorPresenter"),hh=(0,o.y)("IFormattingViewOperationFinishedStageProcessor"),_h=(0,o.y)("IEopFormattingStrategy"),mh=n(9205),fh=function(){function e(e,t,n){this._activityManager=null,this._autoCorrectOptionsDialogFactory=null,this._theActionManager=null,this._theActionManager=e,this._activityManager=t,this._autoCorrectOptionsDialogFactory=n}return e.prototype.registerActions=function(){this._theActionManager.addActionWithFlags(ii.tN,cl.n,o.i(this,this.openAutoCorrectOptionsView,"openAutoCorrectOptionsView"),1028)},e.prototype.openAutoCorrectOptionsView=function(e,t,n,r,i){return 1===n?32:(this._autoCorrectOptionsDialogFactory().showLanguageDialog(),32)},e}();(0,o.l)(fh,"AutoCorrectActor",null,[]);var yh=n(5692),Ch=(0,o.y)("IBox4ImageSteward"),Sh=function(){function e(e,t){this.noteTagName=null,this.noteTagStatus=null,this.noteTagName=e,this.noteTagStatus=t||"Normal"}return e.prototype.get_noteTagName=function(){return this.noteTagName},e.prototype.get_noteTagStatus=function(){return this.noteTagStatus},e}();(0,o.l)(Sh,"NoteTagInfo",null,[]);var vh=function(){function e(e,t,n,r,i){this.ownerHtmlElementInfo=null,this.htmlElementInfoFromHierarchy=null,this.absolutePosition=null,this.ownerNoteTagInfo=null,this.cultureName=null,e&&(this.ownerHtmlElementInfo=e),t&&(this.htmlElementInfoFromHierarchy=t),this.ownerNoteTagInfo=n||new y.c(Sh),r&&""!==r&&(this.cultureName=r),this.absolutePosition=i}return e.prototype.get_ownerHtmlElementInfo=function(){return this.ownerHtmlElementInfo},e.prototype.get_htmlElementInfoFromHierarchy=function(){return this.htmlElementInfoFromHierarchy},e.prototype.get_cultureName=function(){return this.cultureName},e}();(0,o.l)(vh,"GlobalAttributesArgs",null,[]);var bh=function(e){function t(t,n,r,i,o,a,s,l,c){void 0===o&&(o=null),void 0===a&&(a=0),void 0===s&&(s=0),void 0===l&&(l=null),void 0===c&&(c=null);var u=e.call(this,o?o.get_ownerHtmlElementInfo():null,o?o.get_htmlElementInfoFromHierarchy():null,o?o.ownerNoteTagInfo:null,o?o.get_cultureName():null,o?o.absolutePosition:null)||this;return u.src=null,u.alt=null,u.width=0,u.height=0,u.maxWidth=0,u.maxHeight=0,u.href=null,u.desc=null,u.src=t,u.alt=n,u.width=r,u.height=i,u.maxWidth=a,u.maxHeight=s,u.href=l,u.desc=c,u}return(0,S.t)(t,e),t}(vh);(0,o.l)(bh,"ImageSemanticArgs",vh,[]);var Th=function(){function e(t){this._arrayList=null,o.m(this,e.$$(t)),this._arrayList=[]}return e.prototype.getCopy=function(){for(var t=new e(o.f(this,"Box3.List$1").T),n=0;n<this._arrayList.length;n++)t.add(this.get_item(n));return t},e.prototype.get_count=function(){return this._arrayList.length},e.prototype.get_item=function(e){return this._arrayList[e]},e.prototype.set_item=function(e,t){return this._arrayList[e]=t,t},e.prototype.add=function(e){Array.add(this._arrayList,e)},e.prototype.clear=function(){Array.clear(this._arrayList)},e.prototype.contains=function(e){return Array.contains(this._arrayList,e)},e.prototype.getRange=function(t,n){for(var r=new e(o.f(this,"Box3.List$1").T),i=0;i<n;i++)r.add(this.get_item(t+i));return r},e.prototype.indexOf=function(e){return Array.indexOf(this._arrayList,e)},e.prototype.insert=function(e,t){Array.insert(this._arrayList,e,t)},e.prototype.remove=function(e){return Array.remove(this._arrayList,e)},e.prototype.removeAt=function(e){Array.removeAt(this._arrayList,e)},e.prototype.removeRange=function(e,t){for(var n=0;n<t;n++)Array.removeAt(this._arrayList,e)},e.prototype.reverse=function(){this._arrayList.reverse()},e.prototype.sort=function(){this._arrayList.sort()},e.prototype.toArray=function(){return Array.clone(this._arrayList)},e.$$=function(t){var n="List$1$"+t.getName(),r=o.x(n);return r||o.u(n,"Box3.List$1",e,[{T:t}],null,[])},e}(),Ah=function(){return function(e,t,n,r){void 0===r&&(r=0),this.node=null,this.blob=null,this.location=0,this.imageAnchorId=0,this.node=e,this.blob=t,this.location=n,this.imageAnchorId=r}}();(0,o.l)(Ah,"InsertPictureResult",null,[]);var Ih=function(){function e(e){this._iterator=null,this._box4PasteSteward=null,this._maxPicturesExceeded=!1,this._parentGraphSpace=null,this._results=new Th(Ah),this._imageSemanticArgs=new Th(bh),this._iterator=e}return e.prototype.get_numPicturesPasted=function(){return Vl.x(4281429,307,this._results.get_count()===this._imageSemanticArgs.get_count()),this._results.get_count()},e.prototype.get_maxPicturesExceeded=function(){return this._maxPicturesExceeded},e.prototype.set_maxPicturesExceeded=function(e){return this._maxPicturesExceeded=e,e},e.prototype.bindToOwnerSteward=function(e){this._box4PasteSteward=e},e.prototype.get_desiredRevisionId=function(){return null},e.prototype.aggregateImages=function(e,t){this._results.add(e),this._imageSemanticArgs.add(t)},e.maxAltTextLength=2712,e}();(0,o.l)(Ih,"APicturePasteHandler",null,[Ch]);var wh=n(1588),xh=function(){return function(e,t,n,r){this.request=null,this.requestSerialized=null,this.url=null,this.hasBeenRetried=!1,this.insertPictureResults=null,this.request=e,this.requestSerialized=t,this.url=r,this.insertPictureResults=n}}();(0,o.l)(xh,"PicturePasteRequestInfo",null,[]);var Fh=n(2399),Eh=function(){function e(){this.ImageId=null,this.Src=null,this.Alt=null,this.Desc=null,this.Width=0,this.Height=0,this.LockId=0,this.ImageAnchorId=0,this.IsImageFromPaste=!1,this.EditContainerWidth=0,this.LocalizedPicture=null,this.IsLayoutSizeSetByUser=!1}return e.construct=function(t,n,r,i,o,a,s,l,c,u,g,p){var d=new e;return d.ImageId=t,d.Src=n,d.Alt=r,d.Width=i,d.Height=o,d.Desc=a,d.LockId=s,d.ImageAnchorId=l,d.IsImageFromPaste=c,d.EditContainerWidth=u,d.LocalizedPicture=g,d.IsLayoutSizeSetByUser=p,d},e}();(0,o.l)(Eh,"PastedPicture",null,[]);var Ph=n(2213),kh=function(e){function t(){var t=e.call(this)||this;return t.DataUriPictures=!1,t.PastedPictures=null,t}return(0,S.t)(t,e),t.prototype.getClassId=function(){return 31},t.construct=function(e,n){var r=new t;return r.DataUriPictures=n,r.PastedPictures=e,r},t}(Ph.z);(0,o.l)(kh,"PicturePasteRequest",Ph.z,[]);var Dh=n(1050),Mh=n(1130),Rh=n(2561),Lh=n(2975),Nh=n(121),Bh=n(8757),Oh=n(5739),Uh=n(6781),Hh=n(6129),Gh=function(e){function t(t,n,r,i,o,a,s,l){void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=!1),void 0===l&&(l=!1);var c=e.call(this,t)||this;return c._numRequestsSuccessfullySent=0,c._revisionBeforeReplication=null,c._lastNotificationBarEntry=null,c._imageEditor=null,c._taskManager=null,c._undoManager=null,c._imageStewardBridge=null,c._notificationBar=null,c._pastePictureFailedImprovementIsEnabled=!1,c._pastePictureFailedNotificationBarIsEnabled=!1,c._stopwatchBuilder=null,c._picturePasteRequestStopwatch=null,c._desiredRevisionId=ae.l.get_nil(),c._requests=new Th(xh),c._imageEditor=n,c._taskManager=r,c._undoManager=i,c._stopwatchBuilder=Br.App.get_activeAppFrame().get_theStopwatchBuilder(),c._imageStewardBridge=o,c._notificationBar=a,c._pastePictureFailedImprovementIsEnabled=s,c._pastePictureFailedNotificationBarIsEnabled=l,Br.App.get_theSaveStatusManager().addHandler(c),c}return(0,S.t)(t,e),t.prototype.get_appSettingsManager=function(){return L.AFrameworkApplication.appSettingsManager},t.prototype.get_picturePasteIsEnabled=function(){return Br.App.picturePasteIsEnabled},t.prototype.get_maxPicturesReached=function(){return this.get_numPicturesPasted()===Br.App.maxImagesPerPaste},t.prototype.get_unsentRequestsRemain=function(){return this._numRequestsSuccessfullySent!==this._requests.get_count()},t.prototype.get_numImagesSent=function(){for(var e=0,t=0;t<this._numRequestsSuccessfullySent;t++)e+=this._requests.get_item(t).request.PastedPictures.length;return e},t.prototype.get_desiredRevisionId=function(){return this._desiredRevisionId},t.prototype.onFile=function(e){},t.prototype.onImage=function(e){if(e.alt.length>Ih.maxAltTextLength){var n=Jn.l.isLowSurrogateCharAt(e.alt,Ih.maxAltTextLength)?Ih.maxAltTextLength-1:Ih.maxAltTextLength;e.alt=e.alt.substring(0,n)}if(t.isImageSrcLocalUrl(e)&&L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordNotificationBarImageErrorSettings"),this._notificationBar&&this._pastePictureFailedImprovementIsEnabled&&this._pastePictureFailedNotificationBarIsEnabled&&t.isImageSrcLocalUrl(e))return C.ULS.sendTraceTag(41969745,322,15,"Unable to paste image with local URL"),void this.showSingleNotificationError();var r=new Kl.DictionaryPropertySet,i=null;if(us.n.get_instance().get_item(11)&&(e=this.scaleImageForWord(e)),this._imageEditor.preparePlaceholderForImageUpload(r,e.width,e.height,!0),us.n.get_instance().get_item(1))C.ULS.shipAssertTag(7869443,307,Ls.OutlineElementReader.isOutlineElement(this._iterator)||vc.isOutline(this._iterator)),this._box4PasteSteward.moveToNextOutlineElementForHtmlImport(!1),i=this._imageEditor.insertPictureBlock(this._iterator,r);else if(us.n.get_instance().get_item(11)){C.ULS.shipAssertTag(7869444,307,cs.ParagraphReader.isParagraphNode(this._iterator.get_currentNode())),this._picturePasteRequestStopwatch=this._stopwatchBuilder.makeAndStartStopwatch("WebServiceCall",t.picturePasteRequestTime),C.ULS.sendTraceTag(20505094,322,50,String.format("ImagePasteRequest img width: {0}, height {1}",e.width,e.height));var o=_s.y.createIpContextAtEndOfParagraph(this._iterator.get_currentNode());i=this._imageEditor.insertPictureInline(o,r)}this.aggregateImages(i,e)},t.prototype.onPasteCompletion=function(){this.get_numPicturesPasted()>0&&(this._desiredRevisionId=ae.l.create(),this._parentGraphSpace=this._results.get_item(0).node.getParentGraphSpace(),C.ULS.sendTraceTag(38122840,307,50,"Pasted pictures: {0}",this.get_numPicturesPasted()),this.get_maxPicturesExceeded()&&(C.ULS.sendTraceTag(38122841,307,15,"MaxPicturesExceeded in paste."),this.showMaxPicturesExceededDialog()),Fh.q.get_instance().uploadStarted(this._parentGraphSpace),this._parentGraphSpace.get_contentReplicator().forceOutbound(o.i(this,this.preparePicturePasteRequests,"preparePicturePasteRequests"),null,null))},t.prototype.setImageProperties=function(e){if(this.get_numPicturesPasted()>0)for(var t=e.getValueWithDefault(Boolean,ks.j.isImageFromPaste,!1),n=e.getValueWithDefault(Boolean,zl.k.isUploadingImageCanFailedEarly,!1),r=e.getValueWithDefault(Boolean,zl.k.isImageInsertion,!1),i=e.getValueWithDefault(Number,Oh.p.editContainerWidth,-1),o=e.getValueWithDefault(Boolean,Kc.b.isLayoutSizeSetByUser,!1),a=0;a<this._results.get_count();a++)this._results.get_item(a).blob&&(this._results.get_item(a).blob.properties.setValue(ks.j.isImageFromPaste,t),this._results.get_item(a).blob.properties.setValue(zl.k.isUploadingImageCanFailedEarly,n),this._results.get_item(a).blob.properties.setValue(zl.k.isImageInsertion,r),this._results.get_item(a).blob.properties.setValue(Oh.p.editContainerWidth,i),this._imageEditor.scaleImageWidthAndHeight(this._results.get_item(a).blob.properties,i)),us.n.get_instance().get_item(113)&&this._results.get_item(a).node&&this._results.get_item(a).node.get_properties().setValue(Kc.b.isLayoutSizeSetByUser,o)},t.prototype.onRenderAugmentation=function(e){},t.prototype.scaleImageForWord=function(e){C.ULS.shipAssertTag(7869447,307,us.n.get_instance().get_item(59));var n=Dh.d.get_instance().navigateToWordSectionNode(this._iterator.get_currentINode());if(!n)return e;var r=Hh.X(t.get_wordSectionReader().getPageHeight(n)-t.get_wordSectionReader().getMarginBottom(n)-t.get_wordSectionReader().getMarginTop(n),1),i=Hh.X(t.get_wordSectionReader().getPageWidth(n)-t.get_wordSectionReader().getMarginLeft(n)-t.get_wordSectionReader().getMarginRight(n),0);if(C.ULS.shipAssertTag(7869449,307,r>=0),C.ULS.shipAssertTag(7869450,307,i>=0),e.height>r){var o=r/e.height;e.height=r,e.width=Math.floor(e.width*o)}if(e.width>i){o=i/e.width;e.width=i,e.height=Math.floor(e.height*o)}return e},t.prototype.showSingleNotificationError=function(){var e=Box4Intl.Box4Strings.l_PastedImageFailedWithInvalidUrl;this._lastNotificationBarEntry&&(this._lastNotificationBarEntry.get_message()===e||this._lastNotificationBarEntry.get_isShowing())||(this._lastNotificationBarEntry=this._notificationBar.createEntry(e,!1),this._notificationBar.addEntry(this._lastNotificationBarEntry))},t.prototype.getBaseUrl=function(){if(this._imageStewardBridge&&this._imageStewardBridge.isCustomBaseUrlEnabled())return this._imageStewardBridge.getCustomBaseUrl();var e=new Sys.Net.WebRequest;e.set_url("PicturePaste.ashx");var t=e.getResolvedUrl();return t=tt.n.addParameterValue(t,Rh.h.fileId,this._parentGraphSpace.get_fileQuerySignature())},t.prototype.preparePicturePasteRequests=function(e){var n=this.getBaseUrl(),r=0;us.n.get_instance().get_item(11)?r=131073:us.n.get_instance().get_item(1)?r=393233:C.ULS.shipAssertTag(7869451,307,!1),n=tt.n.addParameterValue(n,Rh.h.cellId,this._parentGraphSpace.get_objectSpaceId().toString()),n=tt.n.addParameterValue(n,Rh.h.desiredRevisionId,this._desiredRevisionId.toString()),n=tt.n.addParameterValue(n,Rh.h.classId,r.toString()),this._parentGraphSpace.get_encryptionSessionString()&&(n=tt.n.addParameterValue(n,Rh.h.encryptionSessionString,this._parentGraphSpace.get_encryptionSessionString())),us.n.get_instance().get_item(11)&&(n=tt.n.addParameterValue(n,Rh.h.wordMode,"1"),n=tt.n.addParameterValue(n,Lh.a.imageType,"1"),n=Nh.n.get_instance().addToStringUrl(n)),this._parentGraphSpace.get_contentReplicator()&&this._parentGraphSpace.get_contentReplicator().get_isUsingOneNoteContentSync()&&(n=tt.n.addParameterValue(n,Rh.h.blockOnSaving,"1"));for(var i,o=0,a=n,s=new Th(Eh),l=new Th(Ah),c=new Th(Eh),u=new Th(Ah),g="",p=0;p<this.get_numPicturesPasted();p++){C.ULS.shipAssertTag(7869452,307,!!this._imageSemanticArgs.get_item(p).src),C.ULS.shipAssertTag(7869453,307,""!==this._imageSemanticArgs.get_item(p).src),C.ULS.shipAssertTag(7869454,307,this._imageSemanticArgs.get_item(p).src.length<19922944);var d=wh.z.lockIdNil;us.n.get_instance().get_item(50)&&(d=this._results.get_item(p).node.getValueWithDefault(Number,Oh.p.lockId,wh.z.lockIdNil)),this.updateImageWidthAndHeight(this._results.get_item(p).blob,this._imageSemanticArgs.get_item(p));var h=Eh.construct(this._results.get_item(p).blob?this._results.get_item(p).blob.id.toString():this._results.get_item(p).node.get_id().toString(),this._imageSemanticArgs.get_item(p).src,this._imageSemanticArgs.get_item(p).alt,this._imageSemanticArgs.get_item(p).width,this._imageSemanticArgs.get_item(p).height,this._imageSemanticArgs.get_item(p).desc,d,this._results.get_item(p).imageAnchorId,!!this._results.get_item(p).blob&&this._results.get_item(p).blob.properties.getValueWithDefault(Boolean,ks.j.isImageFromPaste,!1),this._results.get_item(p).blob?this._results.get_item(p).blob.properties.getValueWithDefault(Number,Oh.p.editContainerWidth,-1):-1,us.n.get_instance().get_item(50)&&this._results.get_item(p).blob?this._results.get_item(p).blob.properties.getValueWithDefault(String,ks.j.localizedPicture,Box4Intl.Box4Strings.l_Picture):"",!!this._results.get_item(p).node&&this._results.get_item(p).node.get_properties().getValueWithDefault(Boolean,Kc.b.isLayoutSizeSetByUser,!1));if(this._imageSemanticArgs.get_item(p).src.startsWith("data:")){c.add(h),u.add(this._results.get_item(p));var _=kh.construct(c.toArray(),!0),m=w.w(_);m.length>t.maximumRequestSize?(C.ULS.shipAssertTag(7869456,307,c.get_count()>1),c.remove(h),u.remove(this._results.get_item(p)),i=this._requests.get_count()?new Dt.h(this._desiredRevisionId,o).toString():this._parentGraphSpace.get_contentReplicator().get_lastReplicated().toString(),a=tt.n.addParameterValue(a,Rh.h.baseRevisionId,i),a=tt.n.addParameterValue(a,Rh.h.pasteSequenceNumber,o.toString()),this._requests.add(new xh(kh.construct(c.toArray(),!0),g,u,a)),o+=c.get_count(),(c=new Th(Eh)).add(h),(u=new Th(Ah)).add(this._results.get_item(p))):g=m}else s.add(h),l.add(this._results.get_item(p))}if(c.get_count()){a=n,i=this._requests.get_count()?new Dt.h(this._desiredRevisionId,o).toString():this._parentGraphSpace.get_contentReplicator().get_lastReplicated().toString(),a=tt.n.addParameterValue(a,Rh.h.baseRevisionId,i),a=tt.n.addParameterValue(a,Rh.h.pasteSequenceNumber,o.toString());var f=kh.construct(c.toArray(),!0);this._requests.add(new xh(f,w.w(f),u,a)),o+=c.get_count()}if(s.get_count()){a=n,i=this._requests.get_count()?new Dt.h(this._desiredRevisionId,o).toString():this._parentGraphSpace.get_contentReplicator().get_lastReplicated().toString(),a=tt.n.addParameterValue(a,Rh.h.baseRevisionId,i),a=tt.n.addParameterValue(a,Rh.h.pasteSequenceNumber,o.toString());var y=kh.construct(s.toArray(),!1);this._requests.add(new xh(y,w.w(y),l,a))}var S=this._requests?this._requests.get_count():-1;C.ULS.sendTraceTag(595068930,307,50,"Prepared "+S+" picture paste requests to send"),this.sendPicturePasteRequest()},t.prototype.updateImageWidthAndHeight=function(e,t){if(e&&t){var n=Hh.E(ka.ImageReader.getImageWidth(e.properties),0),r=Hh.E(ka.ImageReader.getImageHeight(e.properties),1);n>0&&n<t.width&&(t.width=n,t.height=r)}},t.prototype.sendPicturePasteRequest=function(){L.AFrameworkApplication.theClientRequestManager.addRequest(this._requests.get_item(this._numRequestsSuccessfullySent).url,2,this._requests.get_item(this._numRequestsSuccessfullySent).requestSerialized,{},!1,2,o.i(this,this.picturePasteRequestSucceeded,"picturePasteRequestSucceeded"),o.i(this,this.picturePasteRequestFailed,"picturePasteRequestFailed"),null,void 0,void 0,void 0,void 0,"26"),t.numberOfPasteRequest++},t.prototype.picturePasteRequestSucceeded=function(e){var n,r=this;if(Bh.j.tryDeserializeServerResponse(e.get_data().responseData,(0,p.m)((function(){return n}),(function(e){return n=e})))){var i=n.Responses[0];if(i.StatusCode)46!==i.StatusCode||this._requests.get_item(this._numRequestsSuccessfullySent).hasBeenRetried?(C.ULS.sendTraceTag(51212675,322,15,"Picture paste request failed with reason "+i.StatusCode),this.handleFailure()):(this._requests.get_item(this._numRequestsSuccessfullySent).hasBeenRetried=!0,this.sendPicturePasteRequest());else{var a="";e&&e.get_data()&&e.get_data().responseHeaders&&"X-CorrelationId"in e.get_data().responseHeaders&&e.get_data().responseHeaders["X-CorrelationId"]&&(a=e.get_data().responseHeaders["X-CorrelationId"]),C.ULS.sendTraceTag(595068929,307,50,"PicturePasteRequestSucceeded called. [X-CorrelationID: {0}]",a),this._picturePasteRequestStopwatch&&(this._picturePasteRequestStopwatch.stop(),this._picturePasteRequestStopwatch=null),this._numRequestsSuccessfullySent++,this.get_unsentRequestsRemain()&&this.sendPicturePasteRequest(),this._revisionBeforeReplication=this._parentGraphSpace.get_contentReplicator().get_lastReplicated();var s=new De.c(2,1,t.forceInboundDelay,(function(e){r._parentGraphSpace.get_contentReplicator().postProcessFDOUpload(o.i(r,r.forceInboundSucceeded,"forceInboundSucceeded"),null,null)}),124);this._taskManager.addTask(s)}}else{C.ULS.sendTraceTag(7869457,307,10,"PicturePasteRequestSucceeded received null or empty server response group");var l=new Uh.o(e.get_data());this.picturePasteRequestFailed(l)}},t.prototype.forceInboundSucceeded=function(e){var n=this,r=!Dt.h.areEqual(this._revisionBeforeReplication,this._parentGraphSpace.get_contentReplicator().get_lastReplicated());if(C.ULS.sendTraceTag(8246492,307,50,"Revision changed after ForceInbound: {0}",r),r)this.callBackOnPasteSucceeded();else{var i=new De.c(2,1,t.forceInboundDelay,(function(e){n._parentGraphSpace.get_contentReplicator().postProcessFDOUpload(null,null,null)}),125);this._taskManager.addTask(i),this.callBackOnRevisionChanged()}t.numberOfPasteRequest--,L.AFrameworkApplication.get_theActionManager().processAction(te.iH,2),Fh.q.get_instance().uploadCompleted(this._parentGraphSpace,0)},t.prototype.picturePasteRequestFailed=function(e){var t="",n="";e&&e.get_data()&&e.get_data().responseHeaders&&("X-CorrelationId"in e.get_data().responseHeaders&&e.get_data().responseHeaders["X-CorrelationId"]&&(t=e.get_data().responseHeaders["X-CorrelationId"]),Lh.a.operationResult in e.get_data().responseHeaders&&e.get_data().responseHeaders[Lh.a.operationResult]&&(n=e.get_data().responseHeaders[Lh.a.operationResult])),C.ULS.sendTraceTag(51212676,322,15,"Picture paste request failed. [Operation Result: {0}] [X-CorrelationID: {1}]",n,t),9===e.get_data().status||this._requests.get_item(this._numRequestsSuccessfullySent).hasBeenRetried?(Fh.q.get_instance().uploadCompleted(this._parentGraphSpace,127),this.changeOutstandingPlaceholdersToFailure(),this._picturePasteRequestStopwatch=null):(this._requests.get_item(this._numRequestsSuccessfullySent).hasBeenRetried=!0,this.sendPicturePasteRequest())},t.prototype.handleFailure=function(){Fh.q.get_instance().uploadCompleted(this._parentGraphSpace,127),this.changeOutstandingPlaceholdersToFailure()},t.prototype.changeOutstandingPlaceholdersToFailure=function(){C.ULS.shipAssertTag(7869458,307,this.get_unsentRequestsRemain());var e=new as.GraphTransaction(15);e.setFromNode(this._results.get_item(0).node);for(var t=this._numRequestsSuccessfullySent;t<this._requests.get_count();t++)for(var n=0;n<this._requests.get_item(t).insertPictureResults.get_count();n++)us.n.get_instance().get_item(11)?(this._imageEditor.setImageAltText(this._requests.get_item(t).insertPictureResults.get_item(n).blob.properties,Box4Intl.Box4Strings.l_PastedImageFailed),ka.ImageReader.setImageUploadState(this._requests.get_item(t).insertPictureResults.get_item(n).blob.properties,2)):this._requests.get_item(t).insertPictureResults.get_item(n).node&&this._requests.get_item(t).insertPictureResults.get_item(n).node.get_isConnected()&&(this._imageEditor.setImageAltText(this._requests.get_item(t).insertPictureResults.get_item(n).node.get_properties(),Box4Intl.Box4Strings.l_PastedImageFailed),ka.ImageReader.setImageUploadState(this._requests.get_item(t).insertPictureResults.get_item(n).node.get_properties(),2));e.dispose(),this._undoManager.clearUndoHistory(this._parentGraphSpace,!1),this.callBackOnPasteFailed()},t.prototype.showMaxPicturesExceededDialog=function(){var e=new ar.StandardDialog;e.set_buttonsOption(0),e.showError(0,Box4Intl.Box4Strings.l_MaxPicturesExceededTitle,String.format(Box4Intl.Box4Strings.l_MaxPicturesExceededMessage,Br.App.maxImagesPerPaste),null,!0),L.AFrameworkApplication.get_theActionManager().processAction(ii.ZR,2)},t.prototype.onInsertInlineImageWithContext=function(e,t){if(e.alt.length>Ih.maxAltTextLength){var n=Jn.l.isLowSurrogateCharAt(e.alt,Ih.maxAltTextLength)?Ih.maxAltTextLength-1:Ih.maxAltTextLength;e.alt=e.alt.substring(0,n)}var r,i=new Kl.DictionaryPropertySet;this._imageEditor.preparePlaceholderForImageUpload(i,e.width,e.height),r=this._imageEditor.insertPictureInline(t,i),e=this.scaleImageForWord(e),this.aggregateImages(r,e)},t.prototype.callBackOnPasteFailed=function(){},t.prototype.callBackOnPasteSucceeded=function(){},t.prototype.callBackOnRevisionChanged=function(){},t.prototype.hasUnsavedData=function(){return!!t.numberOfPasteRequest},t.get_wordSectionReader=function(){return Mh.p.get_instance()},t.isImageSrcLocalUrl=function(e){var t=new RegExp("file:.*AppData\\/Local\\/Temp|^cid:[0-9a-fA-F]+$");return!!e&&!!e.src&&t.test(e.src)},t.forceInboundDelay=1e3,t.picturePasteRequestTime="PicturePasteRequestTime",t.numberOfPasteRequest=0,t.maximumRequestSize=20971520,t}(Ih);(0,o.l)(Gh,"Box4ImageSteward",Ih,[yh.d]);var Vh=function(){function e(){this._maxPicturesExceeded=!0}return e.prototype.onImage=function(e){},e.prototype.onFile=function(e){},e.prototype.onRenderAugmentation=function(e){},e.prototype.bindToOwnerSteward=function(e){},e.prototype.onPasteCompletion=function(){},e.prototype.setImageProperties=function(e){},e.prototype.get_picturePasteIsEnabled=function(){return!1},e.prototype.get_numPicturesPasted=function(){return 0},e.prototype.get_maxPicturesExceeded=function(){return this._maxPicturesExceeded},e.prototype.set_maxPicturesExceeded=function(e){return this._maxPicturesExceeded=e,e},e.prototype.get_maxPicturesReached=function(){return!1},e.prototype.get_desiredRevisionId=function(){return ae.l.get_nil()},e}();(0,o.l)(Vh,"TextOnlyBox4ImageSteward",null,[Ch]);var Wh=function(){function e(e,t,n,r,i,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1),this._imageEditor=null,this._taskManager=null,this._undoManager=null,this._imageStewardBridge=null,this._notificationBar=null,this._pastePictureFailedImprovementIsEnabled=!1,this._pastePictureFailedNotificationBarIsEnabled=!1,this._imageEditor=e,this._taskManager=t,this._undoManager=n,this._imageStewardBridge=r,this._notificationBar=i,this._pastePictureFailedImprovementIsEnabled=o,this._pastePictureFailedNotificationBarIsEnabled=a}return e.prototype.create=function(e,t){return 1===e?new Vh:new Gh(t,this._imageEditor,this._taskManager,this._undoManager,this._imageStewardBridge,this._notificationBar,this._pastePictureFailedImprovementIsEnabled,this._pastePictureFailedNotificationBarIsEnabled)},e}();(0,o.l)(Wh,"Box4ImageStewardFactory",null,[Kd]);var zh=n(792),Kh=function(){function e(e){this._isPasteBrAsNewParagraphEnabled=!1,this._isPasteBrAsNewParagraphEnabled=e}return e.prototype.isPageBreak=function(e){var t=this;if(!e||!e.get_htmlElementInfoFromHierarchy()||e.get_htmlElementInfoFromHierarchy().get_count()<1)return!1;var n=[zh.e.cssClassPageBreakTextSpan,zh.e.cssClassPageBreakBlob];return!!this.getClosestAncestorHtmlElementInfoMatchingCondition(e.get_htmlElementInfoFromHierarchy(),1,(function(e){return t.containsCssClasses(e,n)}))},e.prototype.isEOP=function(e){var t=this;return!(!e||!e.get_htmlElementInfoFromHierarchy()||e.get_htmlElementInfoFromHierarchy().get_count()<1)&&!!this.getClosestAncestorHtmlElementInfoMatchingCondition(e.get_htmlElementInfoFromHierarchy(),1,(function(e){return t.containsCssClasses(e,[zh.e.eopClassName])}))},e.prototype.isInLineBreak=function(e){var t=this;return!(!e||!e.get_htmlElementInfoFromHierarchy()||e.get_htmlElementInfoFromHierarchy().get_count()<1)&&!!this.getClosestAncestorHtmlElementInfoMatchingCondition(e.get_htmlElementInfoFromHierarchy(),2,(function(e){return t.containsCssClasses(e,[zh.e.lineBreakBlobClassName])}))},e.prototype.isParagraph=function(e){var t=this;return!(!e||!e.get_htmlElementInfoFromHierarchy()||e.get_htmlElementInfoFromHierarchy().get_count()<1)&&!!this.getClosestAncestorHtmlElementInfoMatchingCondition(e.get_htmlElementInfoFromHierarchy(),1,(function(e){return t.containsCssClasses(e,[zh.e.paragraphClassName])}))},e.prototype.isFormatless=function(e){if(!e||!e.get_htmlElementInfoFromHierarchy())return!1;for(var t=e.get_htmlElementInfoFromHierarchy(),n=0;n<t.get_count();++n)if(!t.get_item(n)||t.get_item(n).get_attributesCount()>0)return!1;return!0},e.prototype.escapeTextOfParagraphEnd=function(e,t){return this.isEOP(t)||this.isInLineBreak(t)?"":e},e.prototype.get_isPasteBrAsNewParagraphEnabled=function(){return this._isPasteBrAsNewParagraphEnabled},e.prototype.getClosestAncestorHtmlElementInfoMatchingCondition=function(e,t,n){if(e&&e.get_count()>0)for(var r=e.get_count()-1;r>=0;--r){if(n(e.get_item(r)))return e.get_item(r);if(e.get_count()-r>=t)return null}return null},e.prototype.containsCssClasses=function(e,t){var n=e&&e.get_htmlClass()?e.get_htmlClass().split(" "):null;if(!n)return!1;for(var r=0,i=t;r<i.length;r++){var o=i[r];if(Array.indexOf(n,o)>=0)return!0}return!1},e}();(0,o.l)(Kh,"Box4PasteStewardUtils",null,[hd]);var qh=(0,o.y)("IWordConverter"),jh=function(){return function(){this.uniqueListId=0,this.listLevelMetadataForEachLevel=null,this.listLevelMetadataForEachLevel=new Array(9)}}();(0,o.l)(jh,"FullListMetadata",null,[]);var $h=function(){return function(){this.level=0,this.wordListId=null,this.uniqueListId=0,this.originalNode=null,this.fakeListMarker=null,this.pasteFromRichClient=!1}}();(0,o.l)($h,"ListItemMetadata",null,[]);var Qh=function(){return function(){this.tagName=null,this.mostRecentFakeListMarker=null,this.ignore=!1,this.numberOfItems=0,this.listStyle=null,this.level=0,this.listItems=null,this.levelText=null,this.font=null,this.tagName="UL",this.mostRecentFakeListMarker=null,this.ignore=!1,this.numberOfItems=0,this.listStyle="BulletListStyle1",this.listItems=new Th($h),this.levelText="",this.font=""}}();(0,o.l)(Qh,"ListLevelMetadata",null,[]);var Jh=function(){return function(){this.listsMetadata=null,this.currentUniqueListId=0,this.listsMetadata={},this.currentUniqueListId=-1}}();(0,o.l)(Jh,"LevelLists",null,[]);var Xh=function(){return function(e){this.nodes=null,this.currentIndex=0,this.lists=null,this.listItems=null,this.currentListIdsByLevels=null,this.lastProcessedItem=null,this.nodes=e,this.currentIndex=0,this.lists={},this.listItems=new Array(0),this.lastProcessedItem=null,this.currentListIdsByLevels=new Array(0),this.currentListIdsByLevels[0]=new Jh}}();(0,o.l)(Xh,"WordConverterArguments",null,[]);var Yh=n(9407),Zh=(0,o.y)("IHtmlEventAcceptor"),e_=function(){return function(){this.x=0,this.y=0,this.left=null,this.top=null}}();(0,o.l)(e_,"AbsolutePosition",null,[]);var t_=function(){function e(t,n,r,i){void 0===r&&(r=""),void 0===i&&(i=0),this.isValid=!1,this.htmlIdentifier=null,this.htmlElementType=null,this.htmlClass=null,this.attributesCount=0;var o=!1;e.isHTMLIdentifierValid(t)&&(o=!0,this.htmlIdentifier=t),e.isHtmlElementTypeValid(n)&&(this.htmlElementType=n),this.htmlClass=r,this.attributesCount=i,o&&this.get_htmlElementType()?this.isValid=!0:this.isValid=!1}return e.prototype.get_isValid=function(){return this.isValid},e.prototype.get_htmlIdentifier=function(){return this.htmlIdentifier},e.prototype.get_htmlElementType=function(){return this.htmlElementType},e.prototype.get_htmlClass=function(){return this.htmlClass},e.prototype.get_attributesCount=function(){return this.attributesCount},e.isHTMLIdentifierValid=function(e){return!e||-1===e.indexOf(" ")&&e.length>0},e.isHtmlElementTypeValid=function(e){return!!e&&(-1===e.indexOf(" ")&&e.length>0)},e}();(0,o.l)(t_,"HtmlElementInfo",null,[]);var n_=function(){function e(t){this.next=null,o.m(this,e.$$(t)),this.data=o.c(o.f(this,"Box3.StackNode$1").TNode)}return e.$$=function(t){var n="StackNode$1$"+t.getName(),r=o.x(n);return r||o.u(n,"Box3.StackNode$1",e,[{TNode:t}],null,[])},e}(),r_=function(){function e(t){this._top=null,this._count=0,o.m(this,e.$$(t)),this._top=null,this._count=0}return e.prototype.get_count=function(){return this._count},e.prototype.get_isEmpty=function(){return!this._count||!this._top},e.prototype.push=function(e){var t=new n_(o.f(this,"Box3.Stack$1").T);t.data=e,t.next=this._top,this._top=t,this._count++},e.prototype.peek=function(){return this.get_isEmpty()?null:this._top.data},e.prototype.pop=function(){if(this.get_isEmpty())return null;var e=this._top;return this._top=e.next,this._count--,e.data},e.prototype.clear=function(){this._top=null,this._count=0},e.prototype.toArray=function(){for(var e=new Array(this.get_count()),t=this._top,n=this.get_count()-1;n>=0&&t;n--)e[n]=t.data,t=t.next;return e},e.$$=function(t){var n="Stack$1$"+t.getName(),r=o.x(n);return r||o.u(n,"Box3.Stack$1",e,[{T:t}],null,[])},e}(),i_=function(){function e(e){this.normalizer=null,this._onCloseCallbacks=null,this._formattingStack=null,this._elementHasRegisteredCallbacks=!1,this.normalizer=e}return e.prototype.get_currentFormatting=function(){return this._formattingStack.peek()},e.prototype.reset=function(){this.normalizer.reset(),this._onCloseCallbacks=new r_(Object),this._formattingStack=new r_(Yh.q),this._formattingStack.push(this.normalizer.get_defaultFormatting()),this._elementHasRegisteredCallbacks=!1},e.prototype.onBeforeNewElement=function(){this._elementHasRegisteredCallbacks=!1},e.prototype.registerOnCloseCallback=function(e){this._elementHasRegisteredCallbacks||(this._onCloseCallbacks.push(null),this._elementHasRegisteredCallbacks=!0),this._onCloseCallbacks.push(e)},e.prototype.onClose=function(){for(;;){var e=this._onCloseCallbacks.pop();if(!e)break;e()}},e.prototype.setFormattingFromAttributes=function(e,t){return!1},e.prototype.notifyNormalizerOfCurrentFormatting=function(){return this.handleSpecifiedFormatting((function(){return!0}))},e.prototype.handleSpecifiedFormatting=function(e){var t=this.get_currentFormatting().clone();return!!e(t)&&(this._formattingStack.push(t),this.normalizer.onFormattingChange(t),this.registerOnCloseCallback(o.i(this,this.onFormattingEnd,"onFormattingEnd")),!0)},e.prototype.handleCommonAttributes=function(e){var t=this;return e.style&&this.handleSpecifiedFormatting((function(n){return t.setFormattingFromAttributes(n,e)}))?1:2},e.prototype.onFormattingEnd=function(){this._formattingStack.pop(),this.normalizer.onFormattingChange(this.get_currentFormatting())},e.prototype.onText=function(e,t){},e.prototype.onAOpen=function(e){return 2},e.prototype.onAbbrOpen=function(e){return 2},e.prototype.onAcronymOpen=function(e){return 2},e.prototype.onAddressOpen=function(e){return 2},e.prototype.onAppletOpen=function(e){return 3},e.prototype.onAreaTag=function(e){},e.prototype.onBOpen=function(e){return 2},e.prototype.onBaseTag=function(e){},e.prototype.onBasefontTag=function(e){},e.prototype.onBdoOpen=function(e){return 2},e.prototype.onBigOpen=function(e){return 2},e.prototype.onBlockquoteOpen=function(e){return 2},e.prototype.onBodyOpen=function(e){return 2},e.prototype.onBrTag=function(e){},e.prototype.onButtonOpen=function(e){return 2},e.prototype.onCaptionOpen=function(e){return 2},e.prototype.onCenterOpen=function(e){return 2},e.prototype.onCiteOpen=function(e){return 2},e.prototype.onCodeOpen=function(e){return 2},e.prototype.onColTag=function(e){},e.prototype.onColgroupOpen=function(e){return 2},e.prototype.onDdOpen=function(e){return 2},e.prototype.onDelOpen=function(e){return 2},e.prototype.onDfnOpen=function(e){return 2},e.prototype.onDirOpen=function(e){return 2},e.prototype.onDivOpen=function(e){return 2},e.prototype.onDlOpen=function(e){return 2},e.prototype.onDtOpen=function(e){return 2},e.prototype.onEmOpen=function(e){return 2},e.prototype.onFieldsetOpen=function(e){return 2},e.prototype.onFontOpen=function(e){return 2},e.prototype.onFormOpen=function(e){return 2},e.prototype.onFrameTag=function(e){},e.prototype.onFramesetOpen=function(e){return 2},e.prototype.onH1Open=function(e){return 2},e.prototype.onH2Open=function(e){return 2},e.prototype.onH3Open=function(e){return 2},e.prototype.onH4Open=function(e){return 2},e.prototype.onH5Open=function(e){return 2},e.prototype.onH6Open=function(e){return 2},e.prototype.onHeadOpen=function(e){return 3},e.prototype.onHrTag=function(e){},e.prototype.onHtmlOpen=function(e){return 2},e.prototype.onIOpen=function(e){return 2},e.prototype.onIframeOpen=function(e){return 3},e.prototype.onImgTag=function(e){},e.prototype.onInputTag=function(e){},e.prototype.onInsOpen=function(e){return 2},e.prototype.onIsindexOpen=function(e){return 3},e.prototype.onKbdOpen=function(e){return 2},e.prototype.onLabelOpen=function(e){return 2},e.prototype.onLegendOpen=function(e){return 2},e.prototype.onLiOpen=function(e){return 2},e.prototype.onLinkTag=function(e){},e.prototype.onMapOpen=function(e){return 3},e.prototype.onMathOpen=function(e){return 2},e.prototype.onMenuOpen=function(e){return 2},e.prototype.onMetaTag=function(e){},e.prototype.onNoframesOpen=function(e){return 2},e.prototype.onNoscriptOpen=function(e){return 2},e.prototype.onObjectOpen=function(e){return 3},e.prototype.onOlOpen=function(e){return 2},e.prototype.onOptgroupOpen=function(e){return 2},e.prototype.onOptionOpen=function(e){return 2},e.prototype.onPOpen=function(e){return 2},e.prototype.onParamTag=function(e){},e.prototype.onPreOpen=function(e){return 2},e.prototype.onQOpen=function(e){return 2},e.prototype.onSOpen=function(e){return 2},e.prototype.onSampOpen=function(e){return 2},e.prototype.onScriptOpen=function(e){return 3},e.prototype.onSelectOpen=function(e){return 2},e.prototype.onSmallOpen=function(e){return 2},e.prototype.onSpanOpen=function(e){return 2},e.prototype.onStrikeOpen=function(e){return 2},e.prototype.onStrongOpen=function(e){return 2},e.prototype.onStyleOpen=function(e){return 3},e.prototype.onSubOpen=function(e){return 2},e.prototype.onSupOpen=function(e){return 2},e.prototype.onTableOpen=function(e){return 2},e.prototype.onTbodyOpen=function(e){return 2},e.prototype.onTdOpen=function(e){return 2},e.prototype.onTextareaOpen=function(e){return 2},e.prototype.onTfootOpen=function(e){return 2},e.prototype.onThOpen=function(e){return 2},e.prototype.onTheadOpen=function(e){return 2},e.prototype.onTitleOpen=function(e){return 3},e.prototype.onTrOpen=function(e){return 2},e.prototype.onTtOpen=function(e){return 2},e.prototype.onUOpen=function(e){return 2},e.prototype.onUlOpen=function(e){return 2},e.prototype.onVarOpen=function(e){return 2},e.prototype.onUnknownOpen=function(e){return 2},e.getPixelSize=function(e){if(e&&-1!==e.indexOf("px")){var t=parseInt(Jn.l.substring(e,0,e.indexOf("px")));if(!isNaN(t))return t}return 0},e.getSizeInPoints=function(e){if(!e||""===e)return-1;var t=Jn.l.toLower(e);if(-1!==t.indexOf("pt")){var n=parseFloat(Jn.l.substring(e,0,t.indexOf("pt")));if(!isNaN(n))return n}else if(-1!==t.indexOf("px")){n=parseFloat(Jn.l.substring(e,0,t.indexOf("px")));if(!isNaN(n))return 3*n/4}return-1},e.getPositionInPixel=function(t){return t&&""!==t?e.getPixelSize(t):null},e.parseGlobalAttributes=function(t){var n=null,r=null,i=null,o=null;return t&&t.get_domElement()&&(n=e.getField(t.get_domElement(),"id"),r=e.getField(t.get_domElement(),"lang"),i=t.get_domElement().tagName,t.get_applyAbsolutePosition()&&(o=(0,O.m)(new e_,{x:e.getPixelSize(t.get_domElement().style.left),y:e.getPixelSize(t.get_domElement().style.top),left:e.getPositionInPixel(t.get_domElement().style.left),top:e.getPositionInPixel(t.get_domElement().style.top)})),void 0===n&&(n=""),void 0===r&&(r="")),new vh(new t_(n,i),t.get_htmlElementInfoFromHierarchy(),null,r,o)},e.getField=function(e,t){return e[t]},e}();(0,o.l)(i_,"AHtmlTranslator",null,[Zh]);var o_=function(e){function t(t,n,r,i,o,a){void 0===i&&(i=0),void 0===o&&(o=0),void 0===a&&(a=null);var s=e.call(this,a?a.get_ownerHtmlElementInfo():null,a?a.get_htmlElementInfoFromHierarchy():null,a?a.ownerNoteTagInfo:null,a?a.get_cultureName():null,a?a.absolutePosition:null)||this;return s.dataRenderSrc=null,s.dataRenderMethod=null,s.dataRenderFallback=null,s.width=0,s.height=0,s.dataRenderSrc=t,s.dataRenderMethod=n,s.dataRenderFallback=r,s.width=i,s.height=o,s}return(0,S.t)(t,e),t}(vh);(0,o.l)(o_,"AugmentationSemanticArgs",vh,[]);var a_=function(){return function(){this.color=null,this.stop=null}}();(0,o.l)(a_,"ColorStopPair",null,[]);var s_=function(){function e(t,n,r){this.fromAttribute=!1,o.m(this,e.$$(t)),this.value=o.c(o.f(this,"Box3.DefaultHtmlTranslatorHelper.ElementValueWrapper$1").T),this.value=n,this.fromAttribute=r}return e.prototype.get_isFromStyle=function(){return!this.fromAttribute},e.prototype.get_isFromAttribute=function(){return this.fromAttribute},e.$$=function(t){var n="ElementValueWrapper$1$"+t.getName(),r=o.x(n);return r||o.u(n,"Box3.DefaultHtmlTranslatorHelper.ElementValueWrapper$1",e,[{T:t}],null,[])},e}(),l_=function(e){function t(t,n,r){var i=e.call(this,Number,t,n)||this;return i.isRelativeDimension=!1,i.isRelativeDimension=r,i}return(0,S.t)(t,e),t}(s_);(0,o.l)(l_,"DimensionWrapper",s_.$$(Number),[]);var c_=function(){return function(e,t,n,r,i,o,a,s,l,c,u,g){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===r&&(r=0),void 0===i&&(i=""),void 0===o&&(o=""),void 0===a&&(a=""),void 0===s&&(s=""),void 0===l&&(l="0pt"),void 0===c&&(c="0pt"),void 0===u&&(u="0pt"),void 0===g&&(g="0pt"),this.borderTopStyle=0,this.borderRightStyle=0,this.borderBottomStyle=0,this.borderLeftStyle=0,this.borderTopWidth=null,this.borderRightWidth=null,this.borderBottomWidth=null,this.borderLeftWidth=null,this.borderTopColor=null,this.borderRightColor=null,this.borderBottomColor=null,this.borderLeftColor=null,this.borderTopStyle=e,this.borderRightStyle=t,this.borderBottomStyle=n,this.borderLeftStyle=r,this.borderTopColor=i,this.borderRightColor=o,this.borderBottomColor=a,this.borderLeftColor=s,this.borderTopWidth=l,this.borderRightWidth=c,this.borderBottomWidth=u,this.borderLeftWidth=g}}();(0,o.l)(c_,"TableCellBorderProperties",null,[]);var u_=function(){return function(e,t,n,r){void 0===e&&(e=""),void 0===t&&(t=""),void 0===n&&(n=""),void 0===r&&(r=""),this.cellMarginTop=null,this.cellMarginRight=null,this.cellMarginBottom=null,this.cellMarginLeft=null,this.cellMarginTop=e,this.cellMarginRight=t,this.cellMarginBottom=n,this.cellMarginLeft=r}}();(0,o.l)(u_,"TableCellMarginProperties",null,[]);var g_=function(){function e(){}return e.get_htmlColorNamesRgb=function(){return e._htmlColorNamesRgb},e.get_tableCellVerticalAlignTypes=function(){return e._tableCellVerticalAlignTypes},e.get_tableCellBorderStyleTypes=function(){return e._tableCellBorderStyleTypes},e.getValueFromStyleOrAttribute=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=e.getValueFromStyles(t,n),a=!1;return o||(a=!!(o=e.getValueFromAttributes.apply(null,[t].concat(r)))),new s_(String,o,a)},e.getValueFromStyles=function(e,t){for(var n=0,r=t;n<r.length;n++){var i=r[n];if(null!=i&&""!==i)return i.trim()}return null},e.getValueFromAttributes=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r],a=e.getAttribute(o);if(null!=a){var s=a+"";if(null!=s&&""!==s)return s.trim()}}return null},e.getPixelsFromValueString=function(e,t,n){var r;if(r=parseFloat(t),isNaN(r))return 0;switch(e){case"px":return Math.round(r);case"pt":return Math.round(Hh.r(r,n,!1));case"in":return Math.round(Hh.L(r,n,!1));case"cm":return Math.round(Hh.L(Jg.Ty(r),n,!1));case"mm":return Math.round(Hh.L(Jg.Ty(.1*r),n,!1));default:return r}},e.retrieveRenderDimensionInfoInPixels=function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=e.getValueFromStyleOrAttribute.apply(null,[t,r].concat(i)),s=0,l=!1;if(a.value){var c=null,u=null;if(l=a.value.endsWith("%"))c="%",u=Jn.l.substring(a.value,0,a.value.length-1);else if(a.get_isFromAttribute())c="px",u=a.value;else{c=a.value.substr(a.value.length-2);var g=parseFloat(c);isNaN(g)?u=Jn.l.substring(a.value,0,a.value.length-2):(c="px",u=a.value)}s=e.getPixelsFromValueString(c,u,0)}return new l_(s,a.get_isFromAttribute(),l)},e.getWidth=function(t){return e.retrieveRenderDimensionInfoInPixels(t,0,[t.style.width],"width","WIDTH","Width")},e.getHeight=function(t){return e.retrieveRenderDimensionInfoInPixels(t,1,[t.style.height],"height","HEIGHT","Height")},e.getMarginLeft=function(t){return e.retrieveRenderDimensionInfoInPixels(t,0,[t.style.marginLeft],"leftmargin","LEFTMARGIN","LeftMargin")},e.getMarginRight=function(t){return e.retrieveRenderDimensionInfoInPixels(t,0,[t.style.marginRight],"rightmargin","RIGHTMARGIN","RightMargin")},e.getVerticalAlign=function(t){var n=e.getValueFromStyleOrAttribute(t,[t.style.verticalAlign],"vAlign","valign","VALIGN","VAlign");return n.value&&n.value in e.get_tableCellVerticalAlignTypes()&&void 0!==e.get_tableCellVerticalAlignTypes()[n.value]&&null!==e.get_tableCellVerticalAlignTypes()[n.value]?e.get_tableCellVerticalAlignTypes()[n.value]:0},e.isTableCellBordersCollpased=function(t){var n=e.getValueFromStyles(t,[t.style.borderCollapse]);return!(!n||null==n||"collapse"!==n&&"COLLAPSE"!==n&&"Collapse"!==n)},e.getBackground=function(t){return e.getValueFromStyleOrAttribute(t,[t.style.backgroundColor,t.style.background],"bgcolor","BGCOLOR","BgColor","BGColor").value},e.convertShorthandHexToHexStringColor=function(e){var t=Jn.l.substring(e,0,1),n=Jn.l.substring(e,1,2),r=Jn.l.substring(e,2,3);return t+t+n+n+r+r},e.convertColorValueToRgb=function(t){var n="";if(!t||""===t)return n;if((n=t.trim()).startsWith("rgb")){var r=(n=Jn.l.substring(n,n.indexOf("(")+1,n.length-1)).split(",");if(3!==r.length)return"";n="";for(var i=0;i<r.length;i++){var o=parseInt(r[i]);if(isNaN(o)||o<0||o>255)return"";var a=o.toString(16);1===a.length&&(a="0"+a),n+=a}return Jn.l.toUpper(n)}return e.get_htmlColorNamesRgb()[Jn.l.toLower(n)]?e.get_htmlColorNamesRgb()[Jn.l.toLower(n)]:(n.startsWith("#")&&(n=Jn.l.substring(n,1,n.length)),isNaN(parseInt(n,16))?"":(3===n.length&&(n=e.convertShorthandHexToHexStringColor(n)),6!==n.length?"":n))},e.parseMsoTabCount=function(e){var t=e.indexOf("mso-tab-count");if(-1===t)return 0;for(var n=new RegExp("([\\d])"),r="",i=t+"mso-tab-count".length+1;i<e.length;i++){var o=e.charAt(i).toString();if(!n.test(o))break;r+=o}var a=0;return""!==r&&(a=parseInt(r)),a},e.handleCommonTableFormattingProperties=function(t,n){var r=e.getBackground(t);r&&""!==r&&n.handleSpecifiedFormatting((function(t){return t.setCellShadingColor(e.convertColorValueToRgb(r))}))},e.getCellBorders=function(t){var n=t.style;if(!n)return null;var r=e.get_tableCellBorderStyleTypes()[n.borderTopStyle],i=e.convertColorValueToRgb(n.borderTopColor),o=n.borderTopWidth,a=e.get_tableCellBorderStyleTypes()[n.borderRightStyle],s=e.convertColorValueToRgb(n.borderRightColor),l=n.borderRightWidth,c=e.get_tableCellBorderStyleTypes()[n.borderBottomStyle],u=e.convertColorValueToRgb(n.borderBottomColor),g=n.borderBottomWidth,p=e.get_tableCellBorderStyleTypes()[n.borderLeftStyle],d=e.convertColorValueToRgb(n.borderLeftColor),h=n.borderLeftWidth;return new c_(r,a,c,p,i,s,u,d,o,l,g,h)},e.getCellInternalMargins=function(e){var t,n=e.firstChild;return(t=n&&n.className&&-1!==n.className.indexOf("TableCellContent")?e.firstChild.style:e.style)?new u_(t.paddingTop,t.paddingRight,t.paddingBottom,t.paddingLeft):null},e._htmlColorNamesRgb=E.i("aliceblue","F0F8FF","antiquewhite","FAEBD7","aqua","00FFFF","aquamarine","7FFFD4","azure","F0FFFF","beige","F5F5DC","bisque","FFE4C4","black","000000","blanchedalmond","FFEBCD","blue","0000FF","blueviolet","8A2BE2","brown","A52A2A","burlywood","DEB887","cadetblue","5F9EA0","chartreuse","7FFF00","chocolate","D2691E","coral","FF7F50","cornflowerblue","6495ED","cornsilk","FFF8DC","crimson","DC143C","cyan","00FFFF","darkblue","00008B","darkcyan","008B8B","darkgoldenrod","B8860B","darkgray","A9A9A9","darkgrey","A9A9A9","darkgreen","006400","darkkhaki","BDB76B","darkmagenta","8B008B","darkolivegreen","556B2F","darkorange","FF8C00","darkorchid","9932CC","darkred","8B0000","darksalmon","E9967A","darkseagreen","8FBC8F","darkslateblue","483D8B","darkslategray","2F4F4F","darkslategrey","2F4F4F","darkturquoise","00CED1","darkviolet","9400D3","deeppink","FF1493","deepskyblue","00BFFF","dimgray","696969","dimgrey","696969","dodgerblue","1E90FF","firebrick","B22222","floralwhite","FFFAF0","forestgreen","228B22","fuchsia","FF00FF","gainsboro","DCDCDC","ghostwhite","F8F8FF","gold","FFD700","goldenrod","DAA520","gray","808080","grey","808080","green","008000","greenyellow","ADFF2F","honeydew","F0FFF0","hotpink","FF69B4","indianred","CD5C5C","indigo","4B0082","ivory","FFFFF0","khaki","F0E68C","lavender","E6E6FA","lavenderblush","FFF0F5","lawngreen","7CFC00","lemonchiffon","FFFACD","lightblue","ADD8E6","lightcoral","F08080","lightcyan","E0FFFF","lightgoldenrodyellow","FAFAD2","lightgray","D3D3D3","lightgrey","D3D3D3","lightgreen","90EE90","lightpink","FFB6C1","lightsalmon","FFA07A","lightseagreen","20B2AA","lightskyblue","87CEFA","lightslategray","778899","lightslategrey","778899","lightsteelblue","B0C4DE","lightyellow","FFFFE0","lime","00FF00","limegreen","32CD32","linen","FAF0E6","magenta","FF00FF","maroon","800000","mediumaquamarine","66CDAA","mediumblue","0000CD","mediumorchid","BA55D3","mediumpurple","9370D8","mediumseagreen","3CB371","mediumslateblue","7B68EE","mediumspringgreen","00FA9A","mediumturquoise","48D1CC","mediumvioletred","C71585","midnightblue","191970","mintcream","F5FFFA","mistyrose","FFE4E1","moccasin","FFE4B5","navajowhite","FFDEAD","navy","000080","oldlace","FDF5E6","olive","808000","olivedrab","6B8E23","orange","FFA500","orangered","FF4500","orchid","DA70D6","palegoldenrod","EEE8AA","palegreen","98FB98","paleturquoise","AFEEEE","palevioletred","D87093","papayawhip","FFEFD5","peachpuff","FFDAB9","peru","CD853F","pink","FFC0CB","plum","DDA0DD","powderblue","B0E0E6","purple","800080","red","FF0000","rosybrown","BC8F8F","royalblue","4169E1","saddlebrown","8B4513","salmon","FA8072","sandybrown","F4A460","seagreen","2E8B57","seashell","FFF5EE","sienna","A0522D","silver","C0C0C0","skyblue","87CEEB","slateblue","6A5ACD","slategray","708090","slategrey","708090","snow","FFFAFA","springgreen","00FF7F","steelblue","4682B4","tan","D2B48C","teal","008080","thistle","D8BFD8","tomato","FF6347","turquoise","40E0D0","violet","EE82EE","wheat","F5DEB3","white","FFFFFF","whitesmoke","F5F5F5","yellow","FFFF00","yellowgreen","9ACD32"),e._tableCellVerticalAlignTypes=E.i("",0,"unset",1,"top",1,"middle",2,"bottom",3,"start",2,"baseline",1,"sub",3,"super",1,"initial",1,"inherit",2,"text-top",1,"text-bottom",3),e._tableCellBorderStyleTypes=E.i("",0,"initial",3,"inherit",11,"nil",1,"dotted",5,"dashed",4,"solid",11,"double",6,"groove",7,"ridge",10,"inset",8,"outset",9,"none",1,"hidden",2),e}();(0,o.l)(g_,"DefaultHtmlTranslatorHelper",null,[]);var p_=function(){function e(){this.direction=null,this.colorStops=new Th(a_)}return e.prototype.hasDirection=function(){return!!this.direction&&this.direction.length>0},e}();(0,o.l)(p_,"LinearGradient",null,[]);var d_=function(){return function(){this.isCopiedFromSameApp=!1}}();(0,o.l)(d_,"HtmlTranslatorContext",null,[]);var h_=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g,p,d,h,_,m,f,y,C,S,v,b,T){void 0===e&&(e=!1),void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),void 0===a&&(a=!0),void 0===s&&(s=!1),void 0===l&&(l=!0),void 0===c&&(c=!0),void 0===u&&(u=!0),void 0===g&&(g=!1),void 0===p&&(p=!1),void 0===d&&(d=!1),void 0===h&&(h=!1),void 0===_&&(_=!1),void 0===m&&(m=!1),void 0===f&&(f=null),void 0===y&&(y=null),void 0===C&&(C=null),void 0===S&&(S=null),void 0===v&&(v=null),void 0===b&&(b=null),void 0===T&&(T=null),this._pasteListImprovementsEnabled=!1,this._pasteTableImprovementsEnabled=!1,this._pasteComplexTablesImprovementsEnabled=!1,this._pasteTableCellMarginImprovementsEnabled=!1,this._shouldGetListLevelForEachListItem=!1,this._shouldGetFontSizeStyle=!1,this._shouldGetBackgroundColorStyle=!1,this._shouldGetBackgroundColorStyleFromImage=!1,this._shouldGetColorStyle=!1,this._shouldGetFontFamilyStyle=!1,this._shouldGetCapsStyle=!1,this._shouldGetPasteStyleId=!1,this._inlineTabInsertionEnabled=!1,this._shouldGetParagraphProperties=null,this._shouldGetThemeAttributes=null,this._shouldGetTextIndentStyle=null,this._shouldGetMarginLeftStyle=null,this._shouldGetLineHeightStyle=null,this._shouldGetTextAlignStyle=null,this._shouldGetTextSuperscriptSubscriptStyle=null,this.shouldGetThemeMarginAndIndentAttributes=!1,this.shouldSkipAppendText=!1,this.shouldGetThemeFontFamily=!1,this.supportPasteCloudFont=!1,this.isCopiedFromSameApp=!1,this._pasteListImprovementsEnabled=e,this._pasteTableImprovementsEnabled=t,this._pasteComplexTablesImprovementsEnabled=n,this._pasteTableCellMarginImprovementsEnabled=r,this._shouldGetListLevelForEachListItem=i,this._shouldGetFontSizeStyle=o,this._shouldGetBackgroundColorStyle=a,this._shouldGetBackgroundColorStyleFromImage=s,this._shouldGetColorStyle=l,this._shouldGetFontFamilyStyle=c,this._shouldGetCapsStyle=u,this.shouldGetThemeMarginAndIndentAttributes=g,this.shouldSkipAppendText=p,this.shouldGetThemeFontFamily=d,this.supportPasteCloudFont=h,this._shouldGetPasteStyleId=_,this._inlineTabInsertionEnabled=m,this._shouldGetParagraphProperties=f,this._shouldGetThemeAttributes=y,this._shouldGetLineHeightStyle=v,this._shouldGetTextIndentStyle=C,this._shouldGetMarginLeftStyle=S,this._shouldGetTextAlignStyle=b,this._shouldGetTextSuperscriptSubscriptStyle=T}return e.prototype.get_pasteListImprovementsEnabled=function(){return this._pasteListImprovementsEnabled},e.prototype.get_pasteTableImprovementsEnabled=function(){return this._pasteTableImprovementsEnabled},e.prototype.get_pasteComplexTableImprovementsEnabled=function(){return this._pasteComplexTablesImprovementsEnabled},e.prototype.get_pasteTableCellMarginImprovementsEnabled=function(){return this._pasteTableCellMarginImprovementsEnabled},e.prototype.get_shouldGetListLevelForEachListItem=function(){return this._shouldGetListLevelForEachListItem},e.prototype.get_shouldGetFontSizeStyle=function(){return this._shouldGetFontSizeStyle},e.prototype.get_shouldGetBackgroundColorStyle=function(){return this._shouldGetBackgroundColorStyle},e.prototype.get_shouldGetBackgroundColorStyleFromImage=function(){return this._shouldGetBackgroundColorStyleFromImage},e.prototype.get_shouldGetColorStyle=function(){return this._shouldGetColorStyle},e.prototype.get_shouldGetFontFamilyStyle=function(){return this._shouldGetFontFamilyStyle},e.prototype.get_shouldGetCapsStyle=function(){return this._shouldGetCapsStyle},e.prototype.get_shouldGetPasteStyleId=function(){return this._shouldGetPasteStyleId},e.prototype.get_inlineTabInsertionEnabled=function(){return this._inlineTabInsertionEnabled},e.prototype.get_shouldGetThemeMarginAndIndentAttributes=function(){return this.shouldGetThemeMarginAndIndentAttributes},e.prototype.get_shouldSkipAppendText=function(){return this.shouldSkipAppendText},e.prototype.get_shouldGetThemeFontFamily=function(){return this.shouldGetThemeFontFamily},e.prototype.get_supportPasteCloudFont=function(){return this.supportPasteCloudFont},e.prototype.get_shouldGetParagraphProperties=function(){return this._shouldGetParagraphProperties||o.i(this,this.returnFalse,"returnFalse")},e.prototype.get_shouldGetThemeAttributes=function(){return this._shouldGetThemeAttributes||o.i(this,this.returnFalse,"returnFalse")},e.prototype.get_shouldGetTextIndentStyle=function(){return this._shouldGetTextIndentStyle||o.i(this,this.returnTrue,"returnTrue")},e.prototype.get_shouldGetMarginLeftStyle=function(){return this._shouldGetMarginLeftStyle||o.i(this,this.returnTrue,"returnTrue")},e.prototype.get_shouldGetLineHeightStyle=function(){return this._shouldGetLineHeightStyle||o.i(this,this.returnFalse,"returnFalse")},e.prototype.get_shouldGetTextAlignStyle=function(){return this._shouldGetTextAlignStyle||o.i(this,this.returnTrue,"returnTrue")},e.prototype.get_shouldGetTextSuperscriptSubscriptStyle=function(){return this._shouldGetTextSuperscriptSubscriptStyle||o.i(this,this.returnFalse,"returnFalse")},e.prototype.returnTrue=function(e){return!0},e.prototype.returnFalse=function(e){return!1},e}();(0,o.l)(h_,"HtmlTranslatorSettings",null,[$d]);var __=function(){return function(e,t){this.spaceBefore=0,this.spaceAfter=0,this.spaceBefore=e,this.spaceAfter=t}}();(0,o.l)(__,"IndentationProperties",null,[]);var m_=function(e){function t(t,n,r,i,o,a,s,l,c,u,g){void 0===i&&(i=0),void 0===o&&(o=-1),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===l&&(l=""),void 0===c&&(c=""),void 0===u&&(u=null),void 0===g&&(g=-1);var p=e.call(this,r?r.get_ownerHtmlElementInfo():null,r?r.get_htmlElementInfoFromHierarchy():null,r?r.ownerNoteTagInfo:null,r?r.get_cultureName():null,r?r.absolutePosition:null)||this;return p._originalListStyle=0,p._listStyleOverride=0,p._currentNumber=0,p._useCurrentNumberAsOffsetFromStart=!1,p._startNumber=0,p._listLevel=0,p._listId=0,p._pasteFromRichClient=!1,p._externalPasteImprovementsEnabled=!1,p._levelText=null,p._font=null,p._charCodes=null,p._buAutoNum=0,p._isAutoNumber=!1,p._originalListStyle=t,p._listStyleOverride=0,p._startNumber=n,p._isAutoNumber=1===n&&-1===o&&!p._externalPasteImprovementsEnabled,p._listId=i,p._listLevel=o,p._pasteFromRichClient=a,p._externalPasteImprovementsEnabled=s,p._levelText=l,p._font=c,p._charCodes=u,p._buAutoNum=g,p._currentNumber=-1,p._useCurrentNumberAsOffsetFromStart=!0,p}return(0,S.t)(t,e),t.prototype.get_listStyleType=function(){return this.get_isListItemStyleSpecified()?this._listStyleOverride:this._originalListStyle},t.prototype.get_isListStyleSpecified=function(){return 2!==this._originalListStyle&&6!==this._originalListStyle},t.prototype.get_isListItemStyleSpecified=function(){return!!this._listStyleOverride},t.prototype.get_startNumber=function(){return this._startNumber},t.prototype.get_listLevel=function(){return this._listLevel},t.prototype.set_listLevel=function(e){return this._listLevel=e,e},t.prototype.get_listId=function(){return this._listId},t.prototype.set_listId=function(e){return this._listId=e,e},t.prototype.get_pasteFromRichClient=function(){return this._pasteFromRichClient},t.prototype.set_pasteFromRichClient=function(e){return this._pasteFromRichClient=e,e},t.prototype.get_externalPasteImprovementsEnabled=function(){return this._externalPasteImprovementsEnabled},t.prototype.set_externalPasteImprovementsEnabled=function(e){return this._externalPasteImprovementsEnabled=e,e},t.prototype.get_levelText=function(){return this._levelText},t.prototype.set_levelText=function(e){return this._levelText=e,e},t.prototype.get_font=function(){return this._font},t.prototype.set_font=function(e){return this._font=e,e},t.prototype.get_charCodes=function(){return this._charCodes},t.prototype.set_charCodes=function(e){return this._charCodes=e,e},t.prototype.get_buAutoNum=function(){return this._buAutoNum},t.prototype.set_buAutoNum=function(e){return this._buAutoNum=e,e},t.prototype.get_isListNumbered=function(){return this.get_listStyleType()>=6},t.prototype.get_isAutoNumber=function(){return this._isAutoNumber},t.prototype.get_currentNumber=function(){return this._externalPasteImprovementsEnabled,this._useCurrentNumberAsOffsetFromStart?this._startNumber+this._currentNumber:this._currentNumber},t.prototype.clone=function(){var e=new t(this._originalListStyle,this._startNumber,new vh(this.get_ownerHtmlElementInfo(),this.get_htmlElementInfoFromHierarchy(),this.ownerNoteTagInfo,this.get_cultureName(),this.absolutePosition),this._listId,this._listLevel,this._pasteFromRichClient,this._externalPasteImprovementsEnabled);return e._listStyleOverride=this._listStyleOverride,e._isAutoNumber=this._isAutoNumber,e._currentNumber=this._currentNumber,e._useCurrentNumberAsOffsetFromStart=this._useCurrentNumberAsOffsetFromStart,e._levelText=this._levelText,e._font=this._font,e._charCodes=this._charCodes,e._buAutoNum=this._buAutoNum,e},t.prototype.applyListItemInfo=function(e,t,n){this._listStyleOverride=e,t>0?(this._isAutoNumber=!1,this._currentNumber=t,this._useCurrentNumberAsOffsetFromStart=!1):(this._currentNumber++,this._isAutoNumber=!n)},t.prototype.resetListStartNumber=function(e){this._startNumber=e},t}(vh);(0,o.l)(m_,"ListSemanticArgs",vh,[]);var f_=function(e){function t(t,n,r,i,o,a,s,l,c,u,g,p){void 0===o&&(o=null),void 0===a&&(a=0),void 0===s&&(s=null),void 0===l&&(l=null),void 0===c&&(c=!1),void 0===u&&(u=!1),void 0===g&&(g=69905),void 0===p&&(p=null);var d=e.call(this,p?p.get_ownerHtmlElementInfo():null,p?p.get_htmlElementInfoFromHierarchy():null,p?p.ownerNoteTagInfo:null,p?p.get_cultureName():null,p?p.absolutePosition:null)||this;return d.colSpan=0,d.rowSpan=0,d.width=0,d.isSkipCell=!1,d.height=0,d.isRelativeWidth=!1,d.shadingColor=null,d.verticalAlignment=0,d.tableCellBorderProperties=null,d.cellLook=0,d.tableCellMarginProperties=null,d.colSpan=t,d.rowSpan=n,d.width=r,d.isSkipCell=u,d.height=i,d.isRelativeWidth=c,d.shadingColor=o,d.verticalAlignment=a,d.tableCellBorderProperties=s,d.tableCellMarginProperties=l,d.cellLook=g,d}return(0,S.t)(t,e),t}(vh);(0,o.l)(f_,"TableCellSemanticArgs",vh,[]);var y_=function(e){function t(t,n){void 0===n&&(n=null);var r=e.call(this,n?n.get_ownerHtmlElementInfo():null,n?n.get_htmlElementInfoFromHierarchy():null,n?n.ownerNoteTagInfo:null,n?n.get_cultureName():null,n?n.absolutePosition:null)||this;return r.height=0,r.height=t,r}return(0,S.t)(t,e),t}(vh);(0,o.l)(y_,"TableRowSemanticArgs",vh,[]);var C_=function(e){function t(t,n,r,i,o,a,s,l,c,u,g,p){void 0===u&&(u=null),void 0===g&&(g=-1),void 0===p&&(p=null);var d=e.call(this,p?p.get_ownerHtmlElementInfo():null,p?p.get_htmlElementInfoFromHierarchy():null,p?p.ownerNoteTagInfo:null,p?p.get_cultureName():null,p?p.absolutePosition:null)||this;if(d.rowCount=0,d.colCount=0,d.width=0,d.isRelativeWidth=!1,d.colWidths=null,d.isBorderHidden=!1,d.isBorderCollapsed=!1,d.tableBorderProperties=null,d.styleId=null,d.tableLook=0,d.indentationProperties=null,d.rowCount=t,d.colCount=n,d.width=r,o){d.colWidths=new Array(o.length);for(var h=0;h<o.length;++h)d.colWidths[h]=o[h]}return d.isBorderHidden=a,d.tableBorderProperties=l,d.isBorderCollapsed=s,d.isRelativeWidth=i,d.indentationProperties=c,d.styleId=u,d.tableLook=g,d}return(0,S.t)(t,e),t}(vh);(0,o.l)(C_,"TableSemanticArgs",vh,[]);var S_,v_=n(4910),b_=function(e){function t(t,n,r,i){void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null);var o=e.call(this,t)||this;return o._settings=null,o._context=null,o._listUsageData=null,o._listInfoStack=null,o._listStyleTypes=E.i("none",1,"disc",3,"circle",4,"square",5,"1",7,"A",10,"a",8,"I",11,"i",9,"armenian",7,"decimal",7,"decimal-leading-zero",7,"georgian",7,"lower-alpha",8,"lower-greek",8,"lower-latin",8,"lower-roman",9,"upper-alpha",10,"upper-latin",10,"upper-roman",11),o._settings=n||new h_,o._context=r||new d_,o._listUsageData=i,o}return(0,S.t)(t,e),t.prototype.get_listStyleTypes=function(){return this._listStyleTypes},t.prototype.getListStyleTypeFromElement=function(e,n){var r,i=e.style?e.style.listStyleType:"";if(i&&""!==i&&(r=this.get_listStyleTypes()[Jn.l.toLower(i)]))return r;var o=i_.getField(e,"type");if(o&&""!==o&&(r=this.get_listStyleTypes()[o]))return r;if(this._settings.get_pasteListImprovementsEnabled()){var a=e.tagName.toLowerCase();if(a&&("ol"===a||"ul"===a)){var s=e.className;if(s&&""!==s)if("ul"===a)switch(s=t.getTrimmedListStyleFromExternalWacElement(s,"BulletListStyle")){case"BulletListStyle1":return 3;case"BulletListStyle2":return 4;case"BulletListStyle3":return 5;default:return n}else if("ol"===a)switch(s=t.getTrimmedListStyleFromExternalWacElement(s,"NumberListStyle")){case"NumberListStyle1":return 7;case"NumberListStyle2":return 8;case"NumberListStyle3":return 9;case"NumberListStyle4":return 10;case"NumberListStyle5":return 11;default:return n}}}return n},t.prototype.getListLevelFromElement=function(e){var n=-1,r=e.tagName.toLowerCase();if("ol"===r||"ul"===r){if(!(e=_i.s.getFirstChildByTagName(e,"li")))return n;r="li"}if("li"===r){if((n=(n=this.getAttributeValueAsNonNegativeInt(e,"data-aria-level",0))||-1)>0)return n-1;if(e=_i.s.getFirstChildByTagName(e,"p"))return t.getListLevelFromStyleValue(e)-1}return n},t.prototype.getAttributeValueAsNonNegativeInt=function(e,t,n){var r;r=this._settings.get_pasteListImprovementsEnabled()?e.getAttribute(t):i_.getField(e,t);var i=parseInt(r);return isNaN(i)||i<0?n:i},t.prototype.onListElementClose=function(){this._listInfoStack.pop(),this.normalizer.onListEnd()},t.prototype.handleListOpen=function(e,n){this.handleSpecifiedFormatting((function(e){return e.setParagraphSpacing(0,0)}));var r,i=this.getListStyleTypeFromElement(e.get_domElement(),n?6:2),a=1;n&&(a=this.getAttributeValueAsNonNegativeInt(e.get_domElement(),"start",1));var s=!1;if(this._settings.get_pasteListImprovementsEnabled()){var l=e.get_domElement().getAttribute("data-pasteFromRc");(s=!!l&&"true"===l)&&e.get_domElement().removeAttribute("data-pasteFromRc"),(G.y.get_isInternetExplorerOrEdge()||G.y.get_isFirefox())&&t.clearMargins(e.get_domElement())}return r=new m_(i,a,i_.parseGlobalAttributes(e),0,-1,s,this._settings.get_pasteListImprovementsEnabled()),this._listInfoStack.push(r),this.normalizer.onListStart(r),this.registerOnCloseCallback(o.i(this,this.onListElementClose,"onListElementClose")),1},t.prototype.reset=function(){e.prototype.reset.call(this),this._listInfoStack=new r_(m_)},t.prototype.setFormattingFromAttributes=function(e,n){var r,i=!1;try{r=n.getAttribute("xml:lang")||i_.getField(n,"lang")}catch(e){r=null}r&&""!==r&&(i=e.setLang(r)||i);var o=i_.getField(n,"dir");o&&(i=e.setTextDir(o)||i);var a=n.style;if(a){if(a.fontWeight){var s=Jn.l.toUpper(a.fontWeight),l=parseInt(s);isNaN(l)?"BOLD"===s?i=e.setBold(!0)||i:"NORMAL"===s&&(i=e.setBold(!1)||i):i=l>=600?e.setBold(!0)||i:e.setBold(!1)||i}if(this._settings.get_shouldGetFontSizeStyle()&&a.fontSize){var c=i_.getSizeInPoints(a.fontSize);c>0&&(i=e.setFontsize(Math.floor(2*c))||i)}if(this._settings.get_shouldGetTextIndentStyle()(this._context))if(this._settings.get_shouldGetThemeMarginAndIndentAttributes()&&n.getAttribute){var u=n.getAttribute("data-indent");if(u&&u.length>0){var g=Hh.X(parseInt(u),0)+"px";i=e.setTextIndent(g)||i}}else a.textIndent&&(i=e.setTextIndent(a.textIndent)||i);if(this._settings.get_shouldGetMarginLeftStyle()(this._context)&&a.marginLeft)if(this._settings.get_shouldGetThemeMarginAndIndentAttributes()&&n.getAttribute){var p=n.getAttribute("data-margin");p&&p.length>0&&(i=e.setMarginLeft(a.marginLeft)||i)}else"TABLE"!==n.tagName&&(i=e.setMarginLeft(a.marginLeft)||i);if(this._settings.get_shouldGetLineHeightStyle()(this._context)&&a.lineHeight&&(i=e.setLineSpacing(a.lineHeight)||i),this._settings.get_shouldGetCapsStyle()){var d=a.textTransform?Jn.l.toLower(a.textTransform):null,h=a,_=h.fontVariantCaps?Jn.l.toLower(h.fontVariantCaps):null,m=a.fontVariant?Jn.l.toLower(a.fontVariant):null;"uppercase"===d?i=e.setTextCapsType("uppercase")||i:("small-caps"===_||m&&m.indexOf("small-caps")>=0)&&(i=e.setTextCapsType("small-caps")||i)}if(this._settings.get_shouldGetTextAlignStyle()(this._context)&&a.textAlign&&(i=e.setTextAlign(Jn.l.toLower(a.textAlign))||i),a.fontStyle){var f=Jn.l.toUpper(a.fontStyle);"ITALIC"===f||"OBLIQUE"===f?i=e.setItalics(!0)||i:"NORMAL"===f&&(i=e.setItalics(!1)||i)}var y=t.getTextDecorationLine(n);if(a.textDecoration||y){var S=Jn.l.toLower(a.textDecoration||"");if(y=Jn.l.toLower(y||""),n.parentNode&&n.parentNode.tagName&&"a"===Jn.l.toLower(n.parentNode.tagName)){var v=(n.querySelector(".TextRun")||n).className;v&&v.indexOf("Underlined")>-1&&(i=e.setUnderline(!0)||i)}else(a.textDecorationUnderline||t.isUnderline(S)||t.isUnderline(y))&&(i=e.setUnderline(!0)||i);(a.textDecorationLineThrough||t.isLineThrough(S)||t.isLineThrough(y))&&(i=e.setStrikethrough(!0)||i)}if(a.verticalAlign){var b=Jn.l.toUpper(a.verticalAlign);if("SUB"===b||this._settings.get_shouldGetTextSuperscriptSubscriptStyle()(this._context)&&n.className&&n.className.indexOf("Subscript")>-1?i=e.setSubscript(!0)||i:("SUPER"===b||this._settings.get_shouldGetTextSuperscriptSubscriptStyle()(this._context)&&n.className&&n.className.indexOf("Superscript")>-1)&&(i=e.setSuperscript(!0)||i),this._settings.get_shouldGetFontSizeStyle()&&("SUB"===b||"SUPER"===b)&&n.getAttribute){var T=parseFloat(n.getAttribute("data-fontsize"));isNaN(T)||(i=e.setFontsize(Math.floor(2*T))||i)}}var A=!1;if(L.AFrameworkApplication.appSettingsManager&&(A=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CopyAndPasteFontTelemetryIsEnabled")),this._settings.get_shouldGetFontFamilyStyle()&&a.fontFamily)if(this._settings.get_shouldGetThemeFontFamily()&&n.getAttribute){var I=n.getAttribute("data-usefontface");I&&"true"===I&&(A&&C.ULS.sendTraceTag(41707205,307,50,"Customized fontface"),i=this.setFontFaceFromFontFamily(e,a.fontFamily,i))}else i=this.setFontFaceFromFontFamily(e,a.fontFamily,i);var w=null;this._settings.get_shouldGetColorStyle()&&a.color&&(w=g_.convertColorValueToRgb(a.color));var x=!!w;if(this._settings.get_shouldGetThemeAttributes()(this._context)&&n.getAttribute){var F=n.getAttribute("data-scheme-color");x=""!==(w=null!==F?F:"")||!this._context.isCopiedFromSameApp||t.isTextRunSpan(n)}if(x&&(i=e.setFontColor(w)||i),this._settings.get_shouldGetBackgroundColorStyle()&&a.backgroundColor&&(!this._settings.get_pasteTableImprovementsEnabled()||!n.tagName||!t.tableTags.contains(Jn.l.toUpper(n.tagName)))){var E=a.backgroundColor;i=e.setFontHighlight(g_.convertColorValueToRgb(E))||i}if(this._settings.get_shouldGetBackgroundColorStyleFromImage()&&a.backgroundImage&&n.className&&n.className.indexOf("Highlight")>-1){var P=t.getValuesFromLinearGradient(a.backgroundImage);if(P&&P.colorStops.get_count()>0){E=P.colorStops.get_item(0).color;for(var k=!0,D=0;D<P.colorStops.get_count()&&(k=k&&E===P.colorStops.get_item(D).color);D++);k&&(A&&C.ULS.sendTraceTag(41707206,307,50,"Paste text with highlight"),i=e.setFontHighlight(g_.convertColorValueToRgb(E))||i)}}}if(this._settings.get_shouldGetParagraphProperties()(this._context)&&n.getAttribute){var M=n.getAttribute("data-ccp-props");M&&(i=e.setParagraphProperties(M)||i)}if(n.getAttribute){var R=n.getAttribute("data-ccp-charstyle");R&&this._settings.get_shouldGetPasteStyleId()&&(i=e.setCharacterStyle(R)||i);var N=n.getAttribute("data-ccp-parastyle");N&&this._settings.get_shouldGetPasteStyleId()&&(i=e.setParagraphStyle(N)||i)}return i},t.prototype.shouldSkipAppendCommentAnchorText=function(e){if(this._settings.get_shouldSkipAppendText())for(var t=e.parentNode;t&&t.tagName;){if(t.className&&Object.getType(t.className)===String&&Jn.l.toUpper(t.className).indexOf("MSOCOM")>-1)return!0;if("DIV"===Jn.l.toUpper(t.tagName))break;t=t.parentNode}return!1},t.prototype.setFontFaceFromFontFamily=function(e,n,r){var i=t.getFontFaceForFormattingSteward(n);return e.setFontface(i,this._settings.get_supportPasteCloudFont())||r},t.prototype.onText=function(e,t){"\u200b"===e&&(e="\xa0"),t&&t.get_domElement()&&this.shouldSkipAppendCommentAnchorText(t.get_domElement())&&(e=""),this.normalizer.onText(e,i_.parseGlobalAttributes(t))},t.prototype.onAOpen=function(e){var t=i_.getField(e.get_domElement(),"href");return t&&""!==t?(this.normalizer.onAnchorStart(t,i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onAnchorEnd,"onAnchorEnd")),1):2},t.prototype.onBOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setBold(!0)}))?1:2},t.prototype.onBigOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.growFontsize()}))?1:2},t.prototype.onBlockquoteOpen=function(e){return this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onBrTag=function(e){this.normalizer.onLineBreak(i_.parseGlobalAttributes(e))},t.prototype.onCaptionOpen=function(e){return this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onCiteOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setItalics(!0)}))?1:2},t.prototype.onCenterOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setTextAlign("center")})),this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onCodeOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setFontface("consolas")}))?1:2},t.prototype.onDelOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setStrikethrough(!0)}))?1:2},t.prototype.onDdOpen=function(e){return this.handleListOpen(e,!1)},t.prototype.onDfnOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setItalics(!0)}))?1:2},t.prototype.onDirOpen=function(e){return this.handleListOpen(e,!1)},t.prototype.onDivOpen=function(e){var n=e.get_domElement().getAttribute("data-render-src"),r=e.get_domElement().getAttribute("data-render-method");if(n&&""!==n&&r&&""!==r){var i=e.get_domElement().getAttribute("data-render-fallback"),a=0,s=0;if(e.get_domElement().currentStyle){var l=e.get_domElement().currentStyle.width,c=e.get_domElement().currentStyle.height;if(l&&-1!==l.indexOf("px")){var u=parseInt(Jn.l.substring(l,0,l.indexOf("px")));isNaN(u)||(a=u)}if(c&&-1!==c.indexOf("px")){var g=parseInt(Jn.l.substring(c,0,c.indexOf("px")));isNaN(g)||(s=g)}}var p=new o_(n,r,i,a,s,i_.parseGlobalAttributes(e));return this.normalizer.onRenderAugmentation(p),2}if(this._settings.get_pasteListImprovementsEnabled()&&(G.y.get_isInternetExplorerOrEdge()||G.y.get_isFirefox())){var d=new RegExp("^SCX[0-9a-zA-Z]+$"),h=e.get_domElement().className.match(d);this._settings.get_pasteListImprovementsEnabled()&&h&&h.length&&t.clearMargins(e.get_domElement())}var _=e.get_domElement().getAttribute("align");return this.handleSpecifiedFormatting((function(e){return e.setTextAlign(_)})),this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onDlOpen=function(e){return this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onDtOpen=function(e){return this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onEmOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setItalics(!0)}))?1:2},t.prototype.onFontOpen=function(e){return this.handleSpecifiedFormatting((function(n){var r=t.getFontFaceForFormattingSteward(e.get_domElement().getAttribute("face")),i=n.setFontface(r),o=n.setFontColor(g_.convertColorValueToRgb(e.get_domElement().getAttribute("color")));return i||o}))?1:2},t.prototype.onH1Open=function(e){var t=this;return this.handleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(1):e.setParagraphStyleType(1)})),this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onH2Open=function(e){var t=this;return this.handleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(2):e.setParagraphStyleType(2)})),this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onH3Open=function(e){var t=this;return this.handleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(3):e.setParagraphStyleType(3)})),this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onH4Open=function(e){var t=this;return this.handleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(4):e.setParagraphStyleType(4)})),this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onH5Open=function(e){var t=this;return this.handleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(5):e.setParagraphStyleType(5)})),this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onH6Open=function(e){var t=this;return this.handleSpecifiedFormatting((function(e){return t._settings.get_shouldGetPasteStyleId()?e.setParagraphHeadingStyle(6):e.setParagraphStyleType(6)})),this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onHrTag=function(e){this.normalizer.onLineBreak(i_.parseGlobalAttributes(e))},t.prototype.onImgTag=function(e){var t=e.get_domElement(),n=t.src,r=t.alt,i=t.longdesc,o=0,a=0;t.style&&(o=i_.getPixelSize(t.style.width),a=i_.getPixelSize(t.style.height)),o&&a||(o=t.width,a=t.height);var s=0,l=0;e.get_domElement().currentStyle&&(o||a||(o=i_.getPixelSize(e.get_domElement().currentStyle.width),a=i_.getPixelSize(e.get_domElement().currentStyle.height)),s=i_.getPixelSize(e.get_domElement().currentStyle.maxWidth),l=i_.getPixelSize(e.get_domElement().currentStyle.maxHeight));var c=new bh(n,r,o,a,i_.parseGlobalAttributes(e),s,l,i);this.normalizer.onImage(c)},t.prototype.onIOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setItalics(!0)}))?1:2},t.prototype.onInsOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setUnderline(!0)}))?1:2},t.prototype.onKbdOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setFontface("consolas")}))?1:2},t.prototype.onLabelOpen=function(e){return this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onLegendOpen=function(e){return this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onLiOpen=function(e){var n,r=this.getListStyleTypeFromElement(e.get_domElement(),0),i=this.getAttributeValueAsNonNegativeInt(e.get_domElement(),"value",0),a=!1;if(this._listInfoStack.get_count()>0?n=this._listInfoStack.peek():(n=new m_(2,1,i_.parseGlobalAttributes(e)),i||(i=1)),this._settings.get_pasteListImprovementsEnabled()){var s=n.get_listLevel(),l=n.get_listId();this._settings.get_shouldGetListLevelForEachListItem()?(s=(s=this.getListLevelFromElement(e.get_domElement()))<0&&n.get_listLevel()<0&&this._listInfoStack.get_count()>0?n.set_listLevel(this._listInfoStack.get_count()-1):n.set_listLevel(s>=0?s:n.get_listLevel()),this._listUsageData&&this._listUsageData.b<s&&(this._listUsageData.b=s)):s<0&&(s=n.set_listLevel(this.getListLevelFromElement(e.get_domElement()))),l<1&&(l=n.set_listId(this.getAttributeValueAsNonNegativeInt(e.get_domElement(),"data-listid",0))),e.get_domElement().getAttribute("data-leveltext")&&n.set_levelText(e.get_domElement().getAttribute("data-leveltext"));var c=e.get_domElement().getAttribute("data-font");c&&n.set_font(c);var u=!1;if(L.AFrameworkApplication.appSettingsManager&&(u=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FollowDestinationThemePasteIsEnabled")),u){var g=e.get_domElement().getAttribute("data-charcodes"),p=[];if(g&&""!==g)if(g.indexOf(",")>-1)for(var d=g.split(","),h=0;h<d.length;h++)Array.add(p,parseInt(d[h]));else Array.add(p,parseInt(g));if(p&&p.length>0){var _=new Array(p.length);for(h=0;h<p.length;h++)_[h]=p[h];n.set_charCodes(_)}var m=e.get_domElement().getAttribute("data-buAutoNum");m&&m.length>0&&n.set_buAutoNum(parseInt(m))}(a=s>=0&&l>0)&&t.clearMargins(e.get_domElement())}return n.applyListItemInfo(r,i,a),this.normalizer.onListItemStart(n.clone()),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onListItemEnd,"onListItemEnd")),1},t.prototype.onMenuOpen=function(e){return this.handleListOpen(e,!1)},t.prototype.onMathOpen=function(e){if(this.handleSpecifiedFormatting((function(e){return e.setMath(!0)}))){var t=e.get_domElement().getAttribute("OuterHtml");this.normalizer.onMathStart(t,i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onMathEnd,"onMathEnd"))}return 1},t.prototype.onOlOpen=function(e){return this.handleListOpen(e,!0)},t.prototype.onOptionOpen=function(e){return this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onPOpen=function(e){var n=e.get_domElement().getAttribute("align");if(this.handleSpecifiedFormatting((function(e){return e.setTextAlign(n)})),this._settings.get_pasteListImprovementsEnabled()){var r=e.get_domElement().parentNode;r&&r.tagName.toLowerCase().startsWith("li")&&t.clearMargins(e.get_domElement(),G.y.get_isInternetExplorerOrEdge()||G.y.get_isFirefox())}return this.normalizer.onParagraphStart(i_.parseGlobalAttributes(e)),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onParagraphEnd,"onParagraphEnd")),1},t.prototype.onPreOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setFontface("consolas")})),this.normalizer.onPreFormattedTextStart(),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onPreFormattedTextEnd,"onPreFormattedTextEnd")),1},t.prototype.onSOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setStrikethrough(!0)}))?1:2},t.prototype.onSampOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setFontface("consolas")}))?1:2},t.prototype.onSmallOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.shrinkFontsize()}))?1:2},t.prototype.onSpanOpen=function(e){var t=e.get_domElement().attributes.getNamedItem("style"),n="";t&&t.value&&(n=t.value);var r=g_.parseMsoTabCount(n);if(r>0&&this._settings.get_inlineTabInsertionEnabled()){for(var i=0;i<r;i++)this.normalizer.onTab(i_.parseGlobalAttributes(e));return 3}return 2},t.prototype.onStrikeOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setStrikethrough(!0)}))?1:2},t.prototype.onStrongOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setBold(!0)}))?1:2},t.prototype.onSubOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setSubscript(!0)}))?1:2},t.prototype.onSupOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setSuperscript(!0)}))?1:2},t.prototype.onTableOpen=function(e){this.handleSpecifiedFormatting((function(e){return e.clearFormatting()&&e.resetJustification()})),g_.handleCommonTableFormattingProperties(e.get_domElement(),this);var t=g_.getWidth(e.get_domElement()),n=g_.getCellBorders(e.get_domElement()),r=g_.getMarginLeft(e.get_domElement()),i=g_.getMarginRight(e.get_domElement()),a=!parseInt(i_.getField(e.get_domElement(),"border")),s=g_.isTableCellBordersCollpased(e.get_domElement()),l=-1,c="",u=-1;e.get_domElement().attributes.hasOwnProperty("style")&&-1!==(u=e.get_domElement().attributes.getNamedItem("style").value.indexOf("mso-yfti-tbllook:"))?l=parseInt(e.get_domElement().attributes.getNamedItem("style").value.substr(u+"mso-yfti-tbllook:".length)):e.get_domElement().attributes.hasOwnProperty(v_.x.dataTableLook.toString())&&(l=parseInt(e.get_domElement().attributes.getNamedItem(v_.x.dataTableLook.toString()).value));var g=-1;return e.get_domElement().attributes.hasOwnProperty("class")&&-1!==(g=e.get_domElement().attributes.getNamedItem("class").value.indexOf("Mso"))?c=e.get_domElement().attributes.getNamedItem("class").value.substr(g).split(" ")[0]:e.get_domElement().attributes.hasOwnProperty(v_.x.dataTableStyle.toString())&&(c=e.get_domElement().attributes.getNamedItem(v_.x.dataTableStyle.toString()).value),this.normalizer.onTableStart(new C_(0,0,t.value,t.isRelativeDimension,null,a,s,n,new __(r.value,i.value),c,l,i_.parseGlobalAttributes(e))),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onTableEnd,"onTableEnd")),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableCellMarginImprovementsSettings"),1},t.prototype.onTdOpen=function(e){var t=g_.getHeight(e.get_domElement()),n=g_.getWidth(e.get_domElement());if(!n.value&&n.get_isFromAttribute()&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this._settings.get_pasteComplexTableImprovementsEnabled()))return 3;var r=parseInt(i_.getField(e.get_domElement(),"colSpan"));null!=r&&r+""!=""||(r=n.value?1:0);var i=parseInt(i_.getField(e.get_domElement(),"rowSpan"));null!=i&&i+""!=""||(i=t.value?1:0);var a=!1;e.get_domElement().attributes.hasOwnProperty("style")&&(a=-1!==e.get_domElement().attributes.getNamedItem("style").value.indexOf("mso-cell-special:placeholder")||-1!==e.get_domElement().attributes.getNamedItem("style").value.indexOf("mso-cell-special: placeholder")),!a&&e.get_domElement().attributes.hasOwnProperty("class")&&(a=-1!==e.get_domElement().attributes.getNamedItem("class").value.indexOf("SkippedGhostCell"));var s=69905;if(e.get_domElement().attributes.hasOwnProperty(v_.x.dataCellLook.toString())){var l=parseInt(e.get_domElement().attributes.getNamedItem(v_.x.dataCellLook.toString()).value);isNaN(l)||(s=l)}var c=g_.convertColorValueToRgb(e.get_domElement().style.backgroundColor),u=g_.getVerticalAlign(e.get_domElement());this.handleSpecifiedFormatting((function(e){return e.setParagraphSpacing(0,0)})),g_.handleCommonTableFormattingProperties(e.get_domElement(),this);var g=g_.getCellBorders(e.get_domElement()),p=this._settings.get_pasteTableCellMarginImprovementsEnabled()?g_.getCellInternalMargins(e.get_domElement()):null,d=new f_(r,i,n.value,t.value,c,u,g,p,n.isRelativeDimension,a,s,i_.parseGlobalAttributes(e));return this.normalizer.onTableCellStart(d),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onTableCellEnd,"onTableCellEnd")),this.notifyNormalizerOfCurrentFormatting(),1},t.prototype.onThOpen=function(e){var t=this.onTdOpen(e);return 3===t?t:(this.handleSpecifiedFormatting((function(e){var t=e.setBold(!0),n=e.setTextAlign("center");return t||n})),g_.handleCommonTableFormattingProperties(e.get_domElement(),this),1)},t.prototype.onTrOpen=function(e){g_.handleCommonTableFormattingProperties(e.get_domElement(),this);var t=g_.getHeight(e.get_domElement());return t.get_isFromAttribute()&&!t.value&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this._settings.get_pasteComplexTableImprovementsEnabled())?3:(this.normalizer.onTableRowStart(new y_(t.value,i_.parseGlobalAttributes(e))),this.registerOnCloseCallback(o.i(this.normalizer,this.normalizer.onTableRowEnd,"onTableRowEnd")),1)},t.prototype.onTtOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setFontface("consolas")}))?1:2},t.prototype.onUOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setUnderline(!0)}))?1:2},t.prototype.onUlOpen=function(e){return this.handleListOpen(e,!1)},t.prototype.onVarOpen=function(e){return this.handleSpecifiedFormatting((function(e){return e.setUnderline(!0)}))?1:2},t.getEffectiveFontFace=function(e){return e?e.split(",")[0]:null},t.trimCssFontValueToFontName=function(e){if(!e)return null;var t=Jn.l.removeSurroundingChar(e,'"');return t=Jn.l.removeSurroundingChar(t,"'")},t.getFontFaceForFormattingSteward=function(e){if(!e)return null;var n=t.getEffectiveFontFace(e);return n=t.trimCssFontValueToFontName(n)},t.addSubstringToLinearGradient=function(e,t){t=t.trim();var n=new RegExp("^-?[0-9]+deg$"),r=t.match(n);if(r&&r.length>0)return!e.hasDirection()&&(e.direction=t,!0);var i,o=new RegExp("^to +(left|right|top|bottom|lefttop|leftbottom|righttop|rightbottom)$"),a=t.match(o);if(a&&a.length>0)return!e.hasDirection()&&(e.direction=t,!0);var s=new RegExp("^rgb\\(.*\\)"),l=t.match(s),c=-1===(i=l&&l.length>0?t.indexOf(")")+1:t.indexOf(" "))?t:g_.convertColorValueToRgb(t.substr(0,i).trim());if(!c||""===c)return!1;var u=-1===i?"":t.substr(i).trim(),g=new a_;return g.color=c,g.stop=u,e.colorStops.add(g),!0},t.getValuesFromLinearGradient=function(e){try{if(!e)return null;if(!(e=e.trim()).startsWith("linear-gradient(")||!e.endsWith(")"))return null;var n=e.substr("linear-gradient(".length);n=n.substr(0,n.lastIndexOf(")"));for(var r=new p_;n.trim().length>0;){var i=n.indexOf(","),o=n.indexOf("(");if(o>0&&o<i){var a=n.indexOf(")");if(a<o)return null;i=n.indexOf(",",a)}if(-1===i){if(!t.addSubstringToLinearGradient(r,n))return null;n=""}else{var s=n.substr(0,i);if(n=n.substr(i+1),!t.addSubstringToLinearGradient(r,s))return null}}return r}catch(e){return null}},t.getTrimmedListStyleFromExternalWacElement=function(e,t){var n=e.split(" ");if(n.length>0)for(var r=0;r<n.length;r++)if(n[r].indexOf(t)>=0)return n[r];return""},t.clearMargins=function(e,n){void 0===n&&(n=!1),e&&e.nodeType!==Ya.o.text&&(e.style.margin="",n&&t.clearChildMargins(e,n))},t.clearChildMargins=function(e,n){if(e)for(e=e.firstChild;e;)e.nodeType!==Ya.o.text&&(e.style&&(e.style.margin=""),n&&t.clearChildMargins(e,n)),e=e.nextSibling},t.getListLevelFromStyleValue=function(e){if("p"!==e.tagName.toLowerCase())return-1;var t=e.getAttribute("style");if(t&&t.length>0&&-1!==t.indexOf("mso-list"))for(var n=t.split(";"),r=0;r<n.length;r++){var i=n[r].split(":");if(2===i.length&&"mso-list"===i[0].trim()){var o=i[1].trim().split(" ");if(3===o.length)return Number.parseInvariant(o[1].substr(5))}}return-1},t.isTextRunSpan=function(e){return!(void 0===e.className||null===e.className)&&e.className.startsWith("TextRun")},t.getTextDecorationLine=function(e){var t;return null==(t=e.style.textDecorationLine)?null:t},t.isLineThrough=function(e){return e.indexOf("line-through")>=0},t.isUnderline=function(e){return e.indexOf("underline")>=0},t.tableTags=((S_=new y.c(String)).add("TABLE"),S_.add("THEAD"),S_.add("TBODY"),S_.add("TFOOT"),S_.add("TR"),S_.add("TH"),S_.add("TD"),S_),t}(i_);(0,o.l)(b_,"DefaultHtmlTranslator",i_,[]);var T_=n(2224),A_=n(3106),I_=function(){function e(e){void 0===e&&(e=null),this._nextUniqueId=0,this._numBulletsConverted=0,this._numNumberedConverted=0,this.usageData=null,this.usageData=e||T_.z.getWordConverterUsageDataInstance(""),this._nextUniqueId=Number.parseInvariant((new Date).format("HHmmss"))}return e.prototype.get_usageData=function(){return this.usageData},e.prototype.process=function(e,t){if(e&&(this._numNumberedConverted=0,this._numBulletsConverted=0,e.querySelectorAll)){var n=e.querySelectorAll("p");if(n&&n.length>0){for(var r=0,i=!1,a=n[0].parentNode;r<5&&a&&a!==e;){r++;var s=a.id.toLowerCase();if(s&&s.length&&-1!==s.indexOf("_editingelement")){if(Sys.UI.DomElement.containsCssClass(a,"WACEditing")&&Sys.UI.DomElement.containsCssClass(a,"EditingSurfaceBody")){i=!0;break}a=a.parentNode}else a=a.parentNode}if(i&&a!==e){for(var l=e.firstChild,c=!1;a.children.length>0&&a.children[0]!==l;)e.insertBefore(a.children[0],l),c=!0;if(c)for(var u=null;l;)u=l.nextSibling,e.removeChild(l),l=u}var g=new A_.a(t,o.i(this,this.processNodesDiscovery,"processNodesDiscovery"),new Xh(n));g.setDebugName("Word Converter Operation"),g.set_isSynchronous(!t||t.get_isSynchronous()),g.run()}}},e.prototype.processNodesDiscovery=function(t,n){var r=n,i=r.nodes[r.currentIndex],a=e.getListItemMetadata(i);if(a){var s=new RegExp("level[0-9]"),l=a.wordListId.replace(s,"").trim();l=l&&l.length?l:a.wordListId;var c=r.lists[l];c||((c=new jh).uniqueListId=this._nextUniqueId++);var u=c.listLevelMetadataForEachLevel[a.level-1];u||((u=new Qh).level=a.level);var g=i.parentNode;if(g&&"li"===g.tagName.toLowerCase()){var p=g.parentNode;if(p){var d=p.tagName.toUpperCase();!d||"OL"!==d&&"UL"!==d||(u.tagName=d)}}else u.mostRecentFakeListMarker=e.getFakeListMarkerText(i,5),u.mostRecentFakeListMarker&&u.mostRecentFakeListMarker.length||(u.mostRecentFakeListMarker=e.getSupportListFakeListMarkerText(i,5)),u.ignore=!u.mostRecentFakeListMarker||!u.mostRecentFakeListMarker.length,u.tagName=e.getFakeBulletTagName(u.mostRecentFakeListMarker);if(a.uniqueListId=c.uniqueListId,u.numberOfItems++,!u.ignore&&"li"!==i.parentNode.tagName.toLowerCase()){var h=e.getSupportListFakeListMarkerText(i,5);if((h=h||u.mostRecentFakeListMarker)&&h.length){a.fakeListMarker=h;var _=e.setListStyleAndStartFromOrderedFakeListMarker(i,h,u.listStyle,a.level-1);_&&_.length&&(u.listStyle=_)}}r.listItems[r.listItems.length]=a,u.listItems.contains(a)||u.listItems.add(a),void 0!==c.listLevelMetadataForEachLevel[a.level-1]&&null!==c.listLevelMetadataForEachLevel[a.level-1]&&c.listLevelMetadataForEachLevel[a.level-1]===u||(c.listLevelMetadataForEachLevel[a.level-1]=u),r.lists[l]&&r.lists[l]===c||(r.lists[l]=c),r.lastProcessedItem=i}else{var m=r.lastProcessedItem;if(m&&e.getRealPreviousSibling(i)===m&&i.tagName===m.tagName&&i.className===m.className){for(m.appendChild(m.ownerDocument.createElement("BR")),m.appendChild(m.ownerDocument.createElement("BR"));i.firstChild;)m.appendChild(i.firstChild);i.parentNode.removeChild(i)}}if(r.currentIndex++,r.nodes.length<=r.currentIndex){if(!r.listItems.length)return!1;r.currentIndex=0,t.changeStepCallback(o.i(this,this.processNodeConvert,"processNodeConvert"))}return!0},e.prototype.processNodeConvert=function(t,n){var r=n,i=r.listItems[r.currentIndex],o=i.originalNode,a=new RegExp("level[0-9]"),s=i.wordListId.replace(a,"").trim();s=s&&s.length?s:i.wordListId;var l=r.lists[s],c=l.listLevelMetadataForEachLevel[i.level-1],u=o.parentNode.tagName.toLowerCase();if(!c.ignore&&o.parentNode&&"li"!==u){var g=e.createListForNode(o,c);if(g){e.cleanupListIgnore(o,5);var p=o.ownerDocument.createElement("LI");for(p.setAttribute("data-aria-level",String.format("{0}",i.level)),p.setAttribute("data-listid",String.format("{0}",l.uniqueListId));o.firstChild;)p.appendChild(o.firstChild);g.appendChild(p),o.parentNode.removeChild(o),"UL"===c.tagName?(this._numBulletsConverted++,this.get_usageData().b++):(this._numNumberedConverted++,this.get_usageData().c++)}}else if("li"===u){var d=c.tagName,h=o.parentNode;if(i.pasteFromRichClient){var _=h.parentNode;_&&_.tagName.toUpperCase()===d&&_.setAttribute("data-pasteFromRc","true")}h.setAttribute("data-listid",String.format("{0}",l.uniqueListId)),"UL"===d?(this._numBulletsConverted++,this.get_usageData().b++):(this._numNumberedConverted++,this.get_usageData().c++)}return r.currentIndex++,r.currentIndex<r.listItems.length},e.createListForNode=function(t,n){var r=e.createListAtNode(t,n.tagName);return e.convertListIfNeeded(r,n)},e.convertListIfNeeded=function(e,t){if(t.tagName!==e.tagName){for(var n=e.ownerDocument.createElement(t.tagName);e.firstChild;)n.appendChild(e.firstChild);e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e),e=n}return e},e.createListAtNode=function(e,t){var n=e.ownerDocument.createElement(t||"UL"),r=e.getAttribute("start");r&&r.length>0&&(n.setAttribute("start",r),e.removeAttribute("start"));var i,o=e.className;return o&&o.length>0&&(i="OL"===n.tagName?b_.getTrimmedListStyleFromExternalWacElement(o,"NumberListStyle"):b_.getTrimmedListStyleFromExternalWacElement(o,"BulletListStyle")).length>0&&(Sys.UI.DomElement.addCssClass(n,i),Sys.UI.DomElement.removeCssClass(e,i)),e.parentNode.insertBefore(n,e),n},e.cleanupListIgnore=function(t,n){for(var r=0;r<t.childNodes.length;r++){var i=t.childNodes[r];i.nodeType===Ya.o.element&&n>1&&e.cleanupListIgnore(i,n-1),(e.isEmptySpan(i)||e.isIgnoreNode(i))&&(t.removeChild(i),r--)}},e.getListItemMetadata=function(t){if(t.nodeType===Ya.o.element){var n=e.getStyleValue(t,"mso-list");if(n&&n.length>0)try{var r=n.split(" ");if(3===r.length)return(o=new $h).level=Number.parseInvariant(r[1].substr(5)),o.wordListId=n,o.originalNode=t,o.pasteFromRichClient=!0,o}catch(e){}else{var i=t.parentNode;if(i&&"li"===i.tagName.toLocaleLowerCase()){var o,a=i.getAttribute("data-"+Ot.t.ariaLevelAttribute),s=i.getAttribute("data-listid");if(a&&s&&a.length>0&&s.length>0)return(o=new $h).level=Number.parseInvariant(a),o.wordListId=s+" level"+a,o.originalNode=t,o.pasteFromRichClient=!1,o}}}return null},e.setListStyleAndStartFromOrderedFakeListMarker=function(t,n,r,i){if("p"===t.tagName.toLowerCase()&&n&&n.length){var o=void 0;if("UL"===e.getFakeBulletTagName(n))return o=e.getBulletListStyleFromMarker(n),Sys.UI.DomElement.addCssClass(t,o),o;var a=-1,s=new RegExp("^[0-9]+"),l=void 0;if((l=n.match(s))&&l.length)return o="NumberListStyle1",Sys.UI.DomElement.addCssClass(t,o),t.setAttribute("start",l[0]),o;var c=new RegExp("^[a-zA-Z]+");if((l=n.match(c))&&l.length){var u=l[0],g=new RegExp("^[ivxlcdmIVXLCDM]+"),p=u.match(g);if(1!==(a=p&&p.length?e.getRomanAlphaStyle(r,i):1)){var d=new RegExp("^[ivxlcdm]+");if(o=e.convertListMarkerIfMatchedAndSetProperties(t,u,d,Jn.l.convertFromRoman,"NumberListStyle3"))return o;var h=new RegExp("^[IVXLCDM]+");if(o=e.convertListMarkerIfMatchedAndSetProperties(t,u,h,Jn.l.convertFromRoman,"NumberListStyle5"))return o}if(a){var _=new RegExp("^[a-z]+");if(o=e.convertListMarkerIfMatchedAndSetProperties(t,u,_,Jn.l.convertFromAlpha,"NumberListStyle2"))return o;var m=new RegExp("^[A-Z]+");if(o=e.convertListMarkerIfMatchedAndSetProperties(t,u,m,Jn.l.convertFromAlpha,"NumberListStyle4"))return o}}return"NumberListStyle1"}return null},e.getBulletListStyleFromMarker=function(e){switch(e){case"o":return"BulletListStyle2";case"\xa7":return"BulletListStyle3";case"\xb7":case"-":default:return"BulletListStyle1"}},e.getRomanAlphaStyle=function(e,t){var n=-1;switch(e&&e.length||(e=""),e){case"NumberListStyle2":case"NumberListStyle4":n=1;break;case"NumberListStyle3":case"NumberListStyle5":n=0;break;default:n=-1}if(n<0)switch(t%3){case 0:n=0;break;case 1:n=1;break;case 2:default:n=0}return n},e.convertListMarkerIfMatchedAndSetProperties=function(e,t,n,r,i){var o=t.match(n);if(o&&o.length){var a=r(o[0]);return a=a<1?1:a,Sys.UI.DomElement.addCssClass(e,i),e.setAttribute("start",a+""),i}return null},e.getFakeBulletTagName=function(e){return e&&"o"!==e&&"\xb7"!==e&&"\xa7"!==e&&"-"!==e?"OL":"UL"},e.getSupportListFakeListMarkerText=function(t,n){for(var r,i,o,a=null,s=-1;!a&&s<t.childNodes.length;s++){var l=-1===s?t:t.childNodes[s];if(l)if((r=l.innerHTML)&&r.length>0){if((i=r.indexOf("\x3c!--[if !supportLists]--\x3e"))>=0&&(o=r.indexOf("\x3c!--[endif]--\x3e"))>=0){var c=r.substring(i,o+14);if(l.innerHTML=l.innerHTML.replace(c,""),c.length){var u=t.ownerDocument.createElement("span");return u.innerHTML=c,a=u.innerText.trim()}a&&a.length||(a="o")}}else s>=0&&l.nodeType===Ya.o.element&&n>1&&(a=e.getSupportListFakeListMarkerText(l,n-1))}return a},e.getFakeListMarkerText=function(t,n){for(var r=null,i=0;!r&&i<t.childNodes.length;i++){var o=t.childNodes[i];e.isIgnoreNode(o)?((r="string"==typeof o.innerText?o.innerText.trim():o.textContent.trim()).length||(r="o"),o.parentNode.removeChild(o)):o.nodeType===Ya.o.element&&n>1&&(r=e.getFakeListMarkerText(o,n-1))}return r},e.isIgnoreNode=function(t){if(t.nodeType===Ya.o.element){var n=e.getStyleValue(t,"mso-list");if(n&&n.length>0&&"ignore"===n.trim().toLowerCase())return!0}return!1},e.isEmptySpan=function(e){return e.nodeType===Ya.o.element&&!e.firstChild&&"SPAN"===e.tagName.toUpperCase()},e.getStyleValue=function(e,t){var n=e.getAttribute("style");if(n&&n.length>0&&-1!==n.indexOf(t))for(var r=n.split(";"),i=0;i<r.length;i++){var o=r[i].split(":");if(2===o.length&&o[0].trim()===t)return o[1].trim()}return null},e.getRealPreviousSibling=function(t){var n=t;do{n=n.previousSibling}while(n&&e.isEmptyTextNode(n));return n},e.isEmptyTextNode=function(t){if(!t)return!0;if(t.nodeType===Ya.o.text){var n=t.nodeValue;return!(n=n.replace(e._lineBreaks,"")).trim().length}return t.nodeType===Ya.o.element&&t.firstChild===t.lastChild&&("SPAN"===t.tagName||"FONT"===t.tagName)&&e.isEmptyTextNode(t.firstChild)},e._lineBreaks=new RegExp("[\n|\r]","gi"),e}();(0,o.l)(I_,"WacAndRichClientWordConverter",null,[qh]);var w_=function(){return function(){this.uniqueListId=0,this.tagName=null,this.firstFakeBullet=null,this.ignore=!1,this.numberOfItems=0,this.tagName="UL",this.firstFakeBullet=null,this.ignore=!1,this.numberOfItems=0}}();(0,o.l)(w_,"ListMetadata",null,[]);var x_=n(8846),F_=function(){function e(e){void 0===e&&(e=null),this._nextUniqueId=1,this._numBulletsConverted=0,this._numNumberedConverted=0,this.usageData=null,this.usageData=e||T_.z.getWordConverterUsageDataInstance("")}return e.prototype.get_usageData=function(){return this.usageData},e.prototype.process=function(e,t){if(e&&(this._numNumberedConverted=0,this._numBulletsConverted=0,e.querySelectorAll)){var n=e.querySelectorAll("p");if(n&&n.length>0){var r=new A_.a(t,o.i(this,this.processNodesDiscovery,"processNodesDiscovery"),new Xh(n));r.setDebugName("Word Converter Operation"),r.set_isSynchronous(!t||t.get_isSynchronous()),r.run()}}},e.prototype.processNodesDiscovery=function(t,n){var r=n,i=r.nodes[r.currentIndex],a=e.getListItemMetadata(i);if(a){var s=r.currentListIdsByLevels[a.level-1];s||(s=new Jh,r.currentListIdsByLevels[a.level-1]=s),r.lastProcessedItem&&e.getRealPreviousSibling(i)!==r.lastProcessedItem&&e.resetCurrentLists(r);var l=s.listsMetadata[a.wordListId];if(l){if(!l.ignore&&1===l.numberOfItems){var c=e.getFakeBulletText(i,5);l.tagName=l.firstFakeBullet===c?"UL":"OL"}}else(l=new w_).uniqueListId=this._nextUniqueId++,l.firstFakeBullet=e.getFakeBulletText(i,5),l.ignore=!l.firstFakeBullet||!l.firstFakeBullet.length,l.tagName=e.getFakeBulletTagName(l.firstFakeBullet),s.listsMetadata[a.wordListId]=l,r.lists[l.uniqueListId.toString()]=l;a.uniqueListId=l.uniqueListId,l.ignore||"OL"===l.tagName&&l.numberOfItems>0&&s.currentUniqueListId!==a.uniqueListId?(l.ignore=!0,r.currentListIdsByLevels[0].currentUniqueListId=-1,r.currentListIdsByLevels=r.currentListIdsByLevels.slice(0,1)):(r.currentListIdsByLevels.length>a.level&&(r.currentListIdsByLevels=r.currentListIdsByLevels.slice(0,a.level)),s.currentUniqueListId=a.uniqueListId,r.listItems[r.listItems.length]=a,l.numberOfItems++),r.lastProcessedItem=i}else{var u=r.lastProcessedItem;if(u&&e.getRealPreviousSibling(i)===u&&i.tagName===u.tagName&&i.className===u.className){for(u.appendChild(u.ownerDocument.createElement("BR")),u.appendChild(u.ownerDocument.createElement("BR"));i.firstChild;)u.appendChild(i.firstChild);i.parentNode.removeChild(i)}}if(r.currentIndex++,r.nodes.length<=r.currentIndex){if(!r.listItems.length)return!1;r.currentIndex=0,t.changeStepCallback(o.i(this,this.processNodeConvert,"processNodeConvert"))}return!0},e.prototype.processNodeConvert=function(t,n){var r=n,i=r.listItems[r.currentIndex],o=i.originalNode,a=r.lists[i.uniqueListId.toString()];if(!a.ignore){var s=e.getOrCreateListForNode(o,i,a);if(s){e.cleanupListIgnore(o,5);for(var l=o.ownerDocument.createElement("LI");o.firstChild;)l.appendChild(o.firstChild);s.appendChild(l),o.parentNode.removeChild(o),"UL"===a.tagName?(this._numBulletsConverted++,this.get_usageData().b++):(this._numNumberedConverted++,this.get_usageData().c++)}}return r.currentIndex++,r.currentIndex<r.listItems.length},e.getOrCreateListForNode=function(t,n,r){var i=e.recurringGetOrCreateListAtNode(t,n.level,r),o=x_.j(i,"UniqueListId");if(o&&o!==n.uniqueListId||!o&&i.firstChild){var a=t.ownerDocument.createElement(r.tagName);i.parentNode.insertBefore(a,i.nextSibling),i=a}return x_.v(i,"UniqueListId",n.uniqueListId),e.convertListIfNeeded(i,r)},e.convertListIfNeeded=function(e,t){if(t.tagName!==e.tagName){var n=e.ownerDocument.createElement(t.tagName);for(x_.v(n,"UniqueListId",x_.j(e,"UniqueListId"));e.firstChild;)n.appendChild(e.firstChild);e.parentNode.insertBefore(n,e),e.parentNode.removeChild(e),e=n}return e},e.recurringGetOrCreateListAtNode=function(t,n,r){var i,o=null;if((i=1===n?e.getRealPreviousSibling(t):(o=e.recurringGetOrCreateListAtNode(t,n-1,null)).lastChild)&&i.nodeType===Ya.o.element){var a=i.tagName.toUpperCase();if("UL"===a||"OL"===a)return i}var s=t.ownerDocument.createElement(r?r.tagName:"UL");return 1===n?t.parentNode.insertBefore(s,t):o.appendChild(s),s},e.cleanupListIgnore=function(t,n){for(var r=0;r<t.childNodes.length;r++){var i=t.childNodes[r];i.nodeType===Ya.o.element&&n>1&&e.cleanupListIgnore(i,n-1),(e.isEmptySpan(i)||e.isIgnoreNode(i))&&(t.removeChild(i),r--)}},e.getListItemMetadata=function(t){if(t.nodeType===Ya.o.element){var n=e.getStyleValue(t,"mso-list");if(n&&n.length>0)try{var r=n.split(" ");if(3===r.length){var i=new $h;return i.level=Number.parseInvariant(r[1].substr(5)),i.wordListId=n,i.originalNode=t,i}}catch(e){}}return null},e.getFakeBulletTagName=function(e){return"o"!==e&&"\xb7"!==e&&"\xa7"!==e&&"-"!==e?"OL":"UL"},e.getFakeBulletText=function(t,n){for(var r=null,i=0;!r&&i<t.childNodes.length;i++){var o=t.childNodes[i];e.isIgnoreNode(o)?(r="string"==typeof o.innerText?o.innerText.trim():o.textContent.trim()).length||(r="o"):o.nodeType===Ya.o.element&&n>1&&(r=e.getFakeBulletText(o,n-1))}return r},e.isIgnoreNode=function(t){if(t.nodeType===Ya.o.element){var n=e.getStyleValue(t,"mso-list");if(n&&n.length>0&&"ignore"===n.trim().toLowerCase())return!0}return!1},e.isEmptySpan=function(e){return e.nodeType===Ya.o.element&&!e.firstChild&&"SPAN"===e.tagName.toUpperCase()},e.getStyleValue=function(e,t){var n=e.getAttribute("style");if(n&&n.length>0&&-1!==n.indexOf(t))for(var r=n.split(";"),i=0;i<r.length;i++){var o=r[i].split(":");if(2===o.length&&o[0].trim()===t)return o[1].trim()}return null},e.getRealPreviousSibling=function(t){var n=t;do{n=n.previousSibling}while(n&&e.isEmptyTextNode(n));return n},e.isEmptyTextNode=function(t){if(!t)return!0;if(t.nodeType===Ya.o.text){var n=t.nodeValue;return!(n=n.replace(e._lineBreaks,"")).trim().length}return t.nodeType===Ya.o.element&&t.firstChild===t.lastChild&&("SPAN"===t.tagName||"FONT"===t.tagName)&&e.isEmptyTextNode(t.firstChild)},e.resetCurrentLists=function(e){for(var t=0;t<e.currentListIdsByLevels.length;t++){var n=e.currentListIdsByLevels[t];n&&(n.currentUniqueListId=-1)}},e._lineBreaks=new RegExp("[\n|\r]","gi"),e}();(0,o.l)(F_,"WordConverter",null,[qh]);var E_="ExternalPasteImprovementsEnabled",P_=function(){function e(e){this._externalPasteImprovementsEnabled=!1,this._externalPasteImprovementsEnabled=e.getBooleanAppSetting(E_)&&e.getBooleanAppSetting("ListMarkerIsEnabled")}return e.prototype.get_externalPasteImprovementsEnabled=function(){return this._externalPasteImprovementsEnabled},e.prototype.create=function(e){return void 0===e&&(e=null),this._externalPasteImprovementsEnabled?new I_(e):new F_(e)},e}();(0,o.l)(P_,"Box4WordConverterFactory",null,[jd]);var k_=n(5323),D_=n(9911),M_=n(8960),R_=function(){function e(e,t,n,r,i){this._activityManager=null,this._systemClipboard=null,this._browserUtils=null,this._simpleOperationFactory=null,this._chromeClipboardAccessOperationTimeout=0,this._ensureOperationStartTime=0,this._activityManager=e,this._browserUtils=t,this._chromeClipboardAccessOperationTimeout=i,this._systemClipboard=n,this._simpleOperationFactory=r}return e.prototype.checkSystemClipboardReady=function(e,t,n){C.ULS.sendTraceTag(9037318,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",t,n,this._browserUtils.get_browserNameForlogging()),e.get_isSynchronous()&&this._browserUtils.get_isChrome()&&window.chrome&&C.ULS.sendTraceTag(18354842,307,15,"ClipboardOperation isn't called async when using system clipboard and Chrome extension: {0}",t),this._systemClipboard.ensureSystemClipboardAccess(!!(16&t)),this._simpleOperationFactory.create(e,o.i(this,this.waitingForEnsureAccessOperationResult,"waitingForEnsureAccessOperationResult"),null).setDebugName("ClipboardPreProcess"),this._ensureOperationStartTime=Date.now()},e.prototype.resetSystemClipboard=function(){this._systemClipboard.reset()},e.prototype.waitingForEnsureAccessOperationResult=function(e,t){var n=!0,r=this._systemClipboard.get_ensureOperationResult();return null!=r?(e.set_operationContext(r),n=!1):Date.now()-this._ensureOperationStartTime>this._chromeClipboardAccessOperationTimeout&&(C.ULS.sendTraceTag(18354843,307,50,null),this._activityManager.recordEvent(D_.f.failedProcessingStep,{Reason:M_.i.operationTimeout}),e.set_operationContext(!1),n=!1),n},e}();(0,o.l)(R_,"ClipboardOperationClipboardAccessHelper",null,[Hd]);var L_=(0,o.y)("IClipboardOperationCutCopy"),N_=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g,p,d,h){this._actionManager=null,this._activityManager=null,this._systemClipboard=null,this._internalClipboard=null,this._outlineElementEditor=null,this._selectionManager=null,this._paragraphReader=null,this._selectionEditor=null,this._outlineElementNavigator=null,this._graphIteratorFactory=null,this._outlineElementReader=null,this._renderOrderGraphIteratorFactory=null,this._selectionFactory=null,this._clipboardDataHelper=null,this._imageDataURLSkippedForSafari12IsEnabled=!1,this._isPasteTextKeepSourceFontSizeEnabled=!1,this._actionManager=e,this._activityManager=t,this._internalClipboard=n,this._outlineElementEditor=r,this._selectionManager=i,this._systemClipboard=o,this._paragraphReader=a,this._selectionEditor=s,this._outlineElementNavigator=l,this._graphIteratorFactory=c,this._outlineElementReader=u,this._renderOrderGraphIteratorFactory=g,this._selectionFactory=p,this._clipboardDataHelper=h,this._imageDataURLSkippedForSafari12IsEnabled=!!d&&d.getBooleanAppSetting("ImageDataURLSkippedForSafari12IsEnabled"),this._isPasteTextKeepSourceFontSizeEnabled=!!d&&d.getBooleanAppSetting("PasteKeepSourceFontSizeFixIsEnabled")}return e.prototype.get_outlineElementEditor=function(){return this._outlineElementEditor},e.prototype.get_activityManager=function(){return this._activityManager},e.prototype.waitBeforeCopy=function(e,t){return e.yield(),!0},e.prototype.copyExternal=function(e,t){var n=t,r=n.actionIdFlags;if(C.ULS.shipAssertTag(18130960,307,!!(16&r)),256&r){var i=!1;if(G.y.get_isSafari12Up()&&L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWoncaImageDataURLSkippedSettings"),this._imageDataURLSkippedForSafari12IsEnabled&&G.y.get_isSafari12Up()){var o=n.interactiveView.get_editingDom().get_editingElement();this._clipboardDataHelper.replaceImageSrcWithCustomFieldSrc(o,"data-src","data-srcurl"),i=this._systemClipboard.copy(),this._clipboardDataHelper.replaceImageSrcWithCustomFieldSrc(o,"data-srcurl","data-src")}else if(this._isPasteTextKeepSourceFontSizeEnabled&&n.interactiveView&&n.interactiveView.get_editingDom()){var a=this._clipboardDataHelper.changeFontSizeUnitBeforeCutCopy(n.interactiveView.get_editingDom().get_editingElement(),n.interactiveView.get_displayUnitConverter(),!0);i=this._systemClipboard.copy(),a&&this._clipboardDataHelper.changeFontSizeUnitBeforeCutCopy(n.interactiveView.get_editingDom().get_editingElement(),n.interactiveView.get_displayUnitConverter(),!1)}else i=this._systemClipboard.copy();if(!i)return C.ULS.sendTraceTag(6305540,307,50,"SystemClipboard didn't copy"),this.get_activityManager().recordEvent(D_.f.failedResult,{Reason:M_.i.systemClipboardFailed}),n.operationTelemetry&&n.operationTelemetry.fail("SystemClipboard did not copy",!1),n.failed=!0,!1}return!0},e.prototype.copyInternal=function(e,t){var n=t,r=n.interactiveView,i=n.actionIdFlags;return C.ULS.shipAssertTag(18130961,307,!!(16&i)),n.skipInternalCopy?this._internalClipboard.clearInternalData():this._internalClipboard.copySelectionToInternalClipboard(r,e),!0},e.prototype.deleteForCut=function(e,t){var n,r=t,i=(r.interactiveView,r.context),o=r.actionData,a=r.reportingData,s=!1,l=this._selectionManager.get_selectionCollection().get_currentSelection().get_lastContext();if(this._paragraphReader.isParagraphContext(l)||this._selectionEditor.isEndOfParagraphContext(l)){var c=this._graphIteratorFactory.getGraphIteratorFromNode(l.get_node()),u=c.tryToRootAtOutlineAncestor();C.ULS.shipAssertTag(18130962,307,u),this._outlineElementNavigator.returnToOutlineElement(c),this._outlineElementReader.isLastOutlineElementInOutline(c)&&(s=!0)}(n=64&r.actionIdFlags?new Kl.DictionaryPropertySet:o||new Kl.DictionaryPropertySet).setValue(zl.k.doNotDeleteTableSegments,!1);var g=this._actionManager.processActionAgainstContext(i,ii.Dx,2,!0,a,n);if(8===g&&(C.ULS.sendTraceTag(18130963,307,50,"DeleteKey failed"),this.get_activityManager().recordEvent(D_.f.failedProcessingStep,{Reason:M_.i.deleteFailed}),r.operationTelemetry&&r.operationTelemetry.fail("DeleteKey failed",!1),r.failed=!0),32===g&&s){var p=this._selectionManager.get_selectionCollection().get_currentSelection();if(this._selectionEditor.isInsertionPointSelection(p)&&p.get_firstContext().get_node()===l.get_node()&&!this._paragraphReader.textLength(p.get_firstContext().get_node())){var d=this._graphIteratorFactory.getGraphIteratorFromNode(p.get_firstContext().get_node());u=this._selectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(d);if(C.ULS.shipAssertTag(18130964,307,u),this._outlineElementNavigator.returnToOutlineElement(d),!this._outlineElementReader.isFirstOutlineElementInOutline(d)){var h=this._renderOrderGraphIteratorFactory.create();h.setFrom(d),this._outlineElementNavigator.moveToPreviousOutlineElement(h,!1,!1);var _=this._outlineElementNavigator.moveToContent(h);this._paragraphReader.isParagraphNode(_)&&(this._outlineElementNavigator.returnToOutlineElement(h),this.get_outlineElementEditor().merge(h,d,!1,!1),this._selectionManager.setSelection(this._selectionFactory.createIpSelection(_,this._paragraphReader.textLength(_))))}}}return!0},e}();(0,o.l)(N_,"ClipboardOperationCutCopy",null,[L_]);var B_=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g,p,d,h){this._actionManager=null,this._activityManager=null,this._systemClipboard=null,this._internalClipboard=null,this._selectionManager=null,this._outlineElementEditor=null,this._paragraphReader=null,this._selectionEditor=null,this._outlineElementNavigator=null,this._graphIteratorFactory=null,this._outlineElementReader=null,this._renderOrderGraphIteratorFactory=null,this._selectionFactory=null,this._appSettingsManager=null,this._clipboardDataHelper=null,this._actionManager=e,this._activityManager=t,this._internalClipboard=n,this._systemClipboard=o,this._selectionManager=i,this._outlineElementEditor=r,this._paragraphReader=a,this._selectionEditor=s,this._outlineElementNavigator=l,this._graphIteratorFactory=c,this._outlineElementReader=u,this._renderOrderGraphIteratorFactory=g,this._selectionFactory=p,this._appSettingsManager=d,this._clipboardDataHelper=h}return e.prototype.create=function(){return new N_(this._actionManager,this._activityManager,this._internalClipboard,this._outlineElementEditor,this._selectionManager,this._systemClipboard,this._paragraphReader,this._selectionEditor,this._outlineElementNavigator,this._graphIteratorFactory,this._outlineElementReader,this._renderOrderGraphIteratorFactory,this._selectionFactory,this._appSettingsManager,this._clipboardDataHelper)},e}();(0,o.l)(B_,"Factory$15",null,[Nd]);var O_=function(){function e(){}return e.prototype.shouldDeleteTableForCut=function(){return!0},e}();(0,o.l)(O_,"ClipboardOperationCutStrategy",null,[bd]);var U_=n(5119),H_=function(e,t){var n=e.__sortedValues;if(!n){for(var r in n=[],e)"string"==typeof r&&n.push({key:r,value:e[r]});n.sort((function(e,t){return e.value-t.value})),e.__sortedValues=n}for(var i=[],o=t,a=1;o>0;)1&o&&e[a]&&i.push(e[a]),a<<=1,o>>=1;if(i.length&&0===o)return i.reverse().join(", ")},G_=n(9844),V_=n(7089),W_=n(3029),z_=n(3291),K_=function(){function e(t,n,r,i,a,s,l,c,u){void 0===s&&(s=null),void 0===l&&(l=""),void 0===c&&(c=!0),void 0===u&&(u=!1),this.context=null,this.interactiveView=null,this.actionIdFlags=0,this.actionData=null,this.reportingData=null,this.isOvertype=!1,this.isEndOfParagraphLastContext=!1,this.originalParagraphFormat=null,this.selectPastedContent=!1,this.replacedFormatting=null,this.skipInternalCopy=!1,this.browserName=null,this.useVirtualSelection=!1,this.operationTelemetry=null,this.clipboardOperationId=null,this.isTouch=!1,this.propertySetCopy=null,this.useSelection=!1,this.failed=!1,this.startSelection=null,this.finalSelection=null,this.isIncrementalAction=!1,this.incrementalActionId=null,this.numberOfIncrements=0,this.copySource=0,this.context=t,this.interactiveView=t.view,this.actionIdFlags=n,this.actionData=a,this.operationTelemetry=r,this.reportingData=i,this.failed=!1,this.selectPastedContent=!1,this.originalParagraphFormat=null,this.isOvertype=!1,this.isEndOfParagraphLastContext=!1,this.skipInternalCopy=e.contextContainsWetChanges(t),this.browserName=l,this.useSelection=c,this.isTouch=u,this.useVirtualSelection=!1,this.copySource=0,this.clipboardOperationId=Dt.h.create().toString();var g=o.r(U_.d,a)?a:null;if(g){if(this.propertySetCopy=new Kl.DictionaryPropertySet,this.propertySetCopy.copyProperties(g),g.getValueWithDefault(Boolean,zl.k.pastingForOvertype,!1)){this.isOvertype=!0,this.isEndOfParagraphLastContext=g.getValueWithDefault(Boolean,zl.k.isEndOfParagraphLastContext,!1),this.originalParagraphFormat=s;for(var p=this.interactiveView.get_selectionManager().get_selectionContextForActionDispatch(),d=void 0;p.get_isContextSet();)p=p.getContext(0);d=p;var h=(0,f.e)(hc.AParagraphNode,d.get_node());if(h){var _=0,m=cs.ParagraphReader.textLength(h);switch(d.get_contextId()){case cl.Z:_=d.get_cpBegin(),m=d.get_cpEnd();break;case cl.A:_=m}this.replacedFormatting=Ps.FormattingReader.getFirstFormattingObjectAtOrBeforeCp(d.get_node(),_,d.get_ccBoundaryIdxAtCpBegin()),C.ULS.shipAssertTag(6305503,307,!!this.replacedFormatting);for(var y=0,S=Hs.HyperlinkReader.getHyperlinksInParagraph(h);y<S.length;y++){var v=S[y];v.cpEnd<=_||v.cpBegin>=m||e.get_hyperlinkEditor().removeHyperlink(d.get_node(),v.hyperlink)}}}this.selectPastedContent=g.getValueWithDefault(Boolean,zl.k.selectPastedContent,!1),this.useVirtualSelection=g.getValueWithDefault(Boolean,zl.k.useVirtualSelection,!1)}64&n&&(this.selectPastedContent=!0)}return e.get_activityManager=function(){return ji.y.get_instance()},e.get_hyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=se.w.get_instance().resolve(Ja.o))},e.contextContainsWetChanges=function(t){if(t){if(t.get_isContextSet()){for(var n=t,r=0;r<n.get_length();r++)if(e.contextContainsWetChanges(n.getContext(r)))return!0;return!1}if(o.r(z_.k,t)){var i=t.get_nextContext();return e.contextContainsWetChanges(i)}var a=t;if(cs.ParagraphReader.isParagraphNode(a.get_node()))if(a.get_node().get_containsWetChanges())return!0}return!1},e._hyperlinkEditor=null,e}();(0,o.l)(K_,"ClipboardActionArguments",null,[]);var q_=n(565),j_=function(e){for(var t=e.get_selectionCollection().clone(),n=new Array(0),r=0;r<t.get_length();r++)Array.addRange(n,t.get_item(r).toArray());return n},$_=function(e){for(var t={},n="",r=0;r<e.length;r++)t[n=Object.getType(e[r].get_node()).getName()]?t[n]=t[n]+1:t[n]=1;var i="";for(var o in t){var a={key:o,value:t[o]};i+=a.value+" "+a.key+" elements,"}return i=i.substring(0,i.length-1)},Q_=function(e){function t(t,n,r,i,a,s,l,c,u,g,p,d,h,_,m,y,C,S,v,b,T,A,I,w,x,F,E){void 0===E&&(E=!0);var P=e.call(this)||this;P._transaction=null,P._childArgs=null,P._operationStage=0,P._context=null,P._actionIdFlags=0,P._interactiveView=null,P._activityManager=null,P._selectionEditor=null,P._browserUtils=null,P._graphTransactionFactory=null,P._cannotCutDialog=null,P._simpleOperationFactory=null,P._operationTelemetry=null,P._telemetry=null,P._useSelection=!1,P._chromeClipboardAccessIsEnabled=!1,P._clipboardOperationContentControlShowPlaceholderProcessor=null,P._clipboardOperationMoveProcessor=null,P._clipboardOperationCutCopyProcessor=null,P._clipboardOperationPasteProcessor=null,P._clipboardOperationClipboardAccessHelper=null,P._clipboardOperationWordStrategy=null,P._trackChangeReader=null,P._trackChangeManager=null,P._undoManager=null,P._pasteFloatieEventSource=null,P._actionFlagsAsText=null,P._selectionContextForDispath=null,P._targetSelections=null,P._isTouch=!1,P.init(t),P.setDebugName("ClipboardOperation"),P.initAction(u,n,a,s,l),P._activityManager=g,P._selectionEditor=p,P._browserUtils=d,P._graphTransactionFactory=h,P._clipboardOperationContentControlShowPlaceholderProcessor=_,P._clipboardOperationMoveProcessor=m,P._clipboardOperationCutCopyProcessor=y,P._clipboardOperationPasteProcessor=C,P._clipboardOperationClipboardAccessHelper=S,P._clipboardOperationWordStrategy=v,P._chromeClipboardAccessIsEnabled=c,P._cannotCutDialog=b,P._simpleOperationFactory=T,P._useSelection=E,P._trackChangeReader=A,P._trackChangeManager=I,P._undoManager=w,P._pasteFloatieEventSource=x,P._context=i,P._telemetry=F,l&&o.r(U_.d,l)&&(P._operationTelemetry=(0,f.e)(G_.u,l.getValueWithDefault(Object,zl.k.clipboardTelemetry,null))),P._operationTelemetry||(P._operationTelemetry=P._telemetry.startMeasurement("ClipboardOperation")),P._actionFlagsAsText=null==r?"NotAvailable":H_(q_.u,r),P._operationTelemetry.appendOperationFlags(P._actionFlagsAsText.split(", "));var k=P._context;if(!k.view.get_isInteractiveView())return P._activityManager.recordEvent(D_.f.noExecute,{Reason:M_.i.nonInteractiveView}),P._operationTelemetry.fail("Not in interactive view",!0),P.set_response(8),P.finish(),P;if(P._interactiveView=k.view,!P._interactiveView.get_selectionManager())return P._activityManager.recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),P._operationTelemetry.fail("No selection manager",!1),P.set_response(8),P.finish(),P;if(P._isTouch=3===P._interactiveView.get_lastPointerInputMethod(),P._operationStage=0,P._actionIdFlags=r,P._targetSelections=C.get_pasteTarget(),E&&(!P._targetSelections||!P._targetSelections.get_currentSelection()||!P._targetSelections.get_length()))return P._activityManager.recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),P._operationTelemetry.fail("No selection when one required",!0),P.set_response(8),P.finish(),P;var D=!!(16&P._actionIdFlags),M=Pa.SelectionEditor.isInsertionPointSelection(P._targetSelections.get_currentSelection()),R=!(D&&M),L=P.get_selectionContextForActionDispatch();return R=v.isClipboardOperationEnabledWithThisSelection(r,L)&&R,1!==P.get_behavior()&&R||(R||P._operationTelemetry.fail("Clipboard operation disabled for selection",!0),P.set_response(R?32:8),P.setIsCompleted()),P}return(0,S.t)(t,e),t.prototype.get_selectionContextForActionDispatch=function(){return this._selectionContextForDispath||(this._selectionContextForDispath=Oa.SelectionManager.buildSectionContext(this._targetSelections)),this._selectionContextForDispath},t.prototype.recycle=function(){e.prototype.recycle.call(this),this._targetSelections=null},t.prototype.run=function(){this._operationStage||this.setup(),1===this._operationStage&&this.process(),2===this._operationStage&&this.teardownSync(),3===this._operationStage&&this.teardownAsync(),4===this._operationStage&&this.finish()},t.prototype.setup=function(){if(256&this._actionIdFlags&&this._chromeClipboardAccessIsEnabled){if(this.get_childOperation()||this._clipboardOperationClipboardAccessHelper.checkSystemClipboardReady(this,this._actionIdFlags,this._actionFlagsAsText),this.get_childOperation().run(),this.get_childOperation().get_inProgress())return;var e=this.get_childOperation().get_operationContext();if(this.clearChildOperation(),!e)return this._operationTelemetry.fail("No access to system clipboard",!0),this.set_response(8),this._operationStage=4,void this.logCopyPasteShortcutDialogData()}else C.ULS.sendTraceTag(9037319,307,50,"ClipboardOperation ran into Setup: {0}; {1}; {2}",this._actionIdFlags,this._actionFlagsAsText,this._browserUtils.get_browserNameForlogging());return 32&this._actionIdFlags&&!this._selectionEditor.isCutAllowed(this._interactiveView.get_selectionManager().get_selectionContextForActionDispatch())?(C.ULS.sendTraceTag(6305506,307,50,"Cut not allowed"),this._activityManager.recordEvent(D_.f.noExecute,{Reason:M_.i.cutNotAllowed}),this._operationTelemetry.fail("Cut not allowed",!0),this._cannotCutDialog.show(),this.set_response(8),void(this._operationStage=4)):(16&this._actionIdFlags||32&this._actionIdFlags)&&this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeReader.isSelectionInsideDeletionChange(this._interactiveView.get_selectionManager().get_selectionCollection().get_currentSelection())?(this._operationTelemetry.fail("Selected content deleted in coauthoring",!0),this._trackChangeManager.showDeletedContentSelectedDialog(),this.set_response(8),void(this._operationStage=4)):(4096&this._actionIdFlags&&(this._pasteFloatieEventSource.raisePastedFloatieStatusChangeEvent((0,O.m)(new W_.k,{isFloatieLocked:!0,pasteCommand:this._actionFlagsAsText})),this._undoManager.undo()),this._clipboardOperationWordStrategy.prepareForSetup(this._actionIdFlags),this._transaction=this._graphTransactionFactory.getTransaction(15),this._transaction.setFromNode(this._interactiveView.get_targetNode()),void(this._operationStage=1))},t.prototype.process=function(){if(!this.get_childOperation()){C.ULS.sendTraceTag(9037320,307,50,"ClipboardOperation ran into Process: {0}; {1}; {2}",this._actionIdFlags,this._actionFlagsAsText,this._browserUtils.get_browserNameForlogging()),C.ULS.shipAssertTag(6305507,307,!this._childArgs),this._childArgs=new K_(this._context,this._actionIdFlags,this._operationTelemetry,this.get_reportingData(),this._actionData,void 0,this._browserUtils.get_browserNameForlogging(),this._useSelection,this._isTouch);var e=void 0;e=65536&this._actionIdFlags?o.i(this._clipboardOperationContentControlShowPlaceholderProcessor,this._clipboardOperationContentControlShowPlaceholderProcessor.process,"process"):64&this._actionIdFlags?o.i(this._clipboardOperationMoveProcessor,this._clipboardOperationMoveProcessor.process,"process"):1&this._actionIdFlags?o.i(this._clipboardOperationPasteProcessor,this._clipboardOperationPasteProcessor.process,"process"):o.i(this._clipboardOperationCutCopyProcessor,this._clipboardOperationCutCopyProcessor.process,"process"),16&this._actionIdFlags&&this._interactiveView.get_selectionManager().get_theDelayedSelectionTask().forcePendingTasks(),this._simpleOperationFactory.create(this,e,this._childArgs).setDebugName("ClipboardAction")}C.ULS.shipAssertTag(6305536,307,!!this.get_childOperation()),this.get_childOperation().run(),this.get_childOperation().get_inProgress()||(this.clearChildOperation(),this._operationStage=this.get_isSynchronous()?2:3)},t.prototype.teardownSync=function(){this._childArgs.isOvertype&&this._transaction.set_undoActionId(ii.sf),this._childArgs.isIncrementalAction&&this._transaction.makeIncrementalAction(this._childArgs.incrementalActionId,this._childArgs.numberOfIncrements),this._transaction.dispose(),this.set_response(this._childArgs.failed?8:32),this._operationStage=4},t.prototype.teardownAsync=function(){if(this.get_childOperation()){if(this.get_childOperation().run(),this.get_childOperation().get_inProgress())return}else if(this._childArgs.isOvertype&&this._transaction.set_undoActionId(ii.sf),this._transaction.setAsyncOperation(this),this._childArgs.isIncrementalAction&&this._transaction.makeIncrementalAction(this._childArgs.incrementalActionId,this._childArgs.numberOfIncrements),this._transaction.dispose(),this.get_activeChildOperation())return;this.set_response(this._childArgs.failed?8:32),this._operationStage=4},t.prototype.finish=function(){this._pasteFloatieEventSource.raisePastedFloatieStatusChangeEvent((0,O.m)(new W_.k,{isFloatieLocked:!1})),this.setIsCompleted(),32===this.get_response()?C.ULS.sendTraceTag(6305537,307,50,"ClipboardOperation Succeeded after {0} milliseconds: {1}; {2}; {3} ",+this.get_endTime()-+this.get_startTime(),this._actionIdFlags,this._actionFlagsAsText,this._browserUtils.get_browserNameForlogging()):C.ULS.sendTraceTag(6305538,307,50,"ClipboardOperation Failed after {0} milliseconds: {1}; {2}; {3}",+this.get_endTime()-+this.get_startTime(),this._actionIdFlags,this._actionFlagsAsText,this._browserUtils.get_browserNameForlogging()),this._telemetry.endMeasurement(this._operationTelemetry)},t.prototype.logCopyPasteShortcutDialogData=function(){var e=!!(1&this._actionIdFlags),t=this._context.view;t&&function(e,t,n){if(L.AFrameworkApplication.get_theActionManager().processAction(ii.vY,2),e)C.ULS.sendTraceTag(18617483,307,50,"CopyPasteShortcutDialog showed for paste operation in {0}.",n);else{C.ULS.sendTraceTag(18617484,307,50,"CopyPasteShortcutDialog showed for copy operation in {0}.",n);var r=j_(t);if(1===r.length)C.ULS.sendTraceTag(18425100,307,50,"CopyPasteShortcutDialog showed for copying 1 {0} element in {1}.",Object.getType(r[0].get_node()).getName(),n);else{var i=$_(r);C.ULS.sendTraceTag(18425101,307,50,"CopyPasteShortcutDialog showed for copying {0} elements: {1} in {2}.",r.length,i,n)}}}(e,t.get_selectionManager(),this._browserUtils.get_browserNameForlogging())},t}(V_.g);(0,o.l)(Q_,"ClipboardOperation",V_.g,[]);var J_=(0,o.y)("IClipboardOperationContentControlShowPlaceholderProcessor"),X_=n(6981),Y_=function(){function e(e,t){this._internalClipboard=null,this._clipboardOperationPaste=null,this._contentControlActions=null,this._currentStep=0,this._internalClipboard=e,this._clipboardOperationPaste=t,this._currentStep=0}return e.prototype.process=function(e,t){this._currentStep||(this._contentControlActions=[o.i(this,this.copyGlossarySelection,"copyGlossarySelection"),o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.pasteGlossaryPlaceholder,"pasteGlossaryPlaceholder")]);var n=!0;return this._currentStep<this._contentControlActions.length&&(n=this._contentControlActions[this._currentStep++](e,t)),!!n&&this._currentStep<this._contentControlActions.length},e.prototype.copyGlossarySelection=function(e,t){var n=this,r=t;if(!o.r(U_.d,r.actionData))return!1;var i=(0,f.e)(U_.d,r.actionData);if(!i.hasProperty(zl.k.glossarySelection))return!1;var a=i.getValue(X_.Selection,zl.k.glossarySelection),s=r.interactiveView,l=s.get_selectionManager();return this._internalClipboard.useVirtualClipboardRoot(),l.runAgainstSelectionCollection((function(t){l.setSelection(a,void 0,!0),n._internalClipboard.copySelectionToInternalClipboard(s,e)}),!0),!0},e}();(0,o.l)(Y_,"ClipboardOperationContentControlShowPlaceholderProcessor",null,[J_]);var Z_=(0,o.y)("IClipboardOperationCutCopyProcessor"),em=function(){function e(e){this._clipboardOperationCutCopy=null,this._cutCopyActions=null,this._currentStep=0,this._clipboardOperationCutCopy=e,this._currentStep=-1}return e.prototype.process=function(e,t){-1===this._currentStep&&(this.cutCopyProcessorSetup(e,t),this._currentStep=0);var n=!1;return this._currentStep<this._cutCopyActions.length&&(n=this._cutCopyActions[this._currentStep++](e,t)),!!n&&this._currentStep<this._cutCopyActions.length},e.prototype.cutCopyProcessorSetup=function(e,t){var n=t;if(G.y.get_isMobile()||512&n.actionIdFlags?(this._cutCopyActions=[o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.copyInternal,"copyInternal")],C.ULS.sendTraceTag(18158306,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyInternal.")):!e.get_isSynchronous()&&256&n.actionIdFlags?(this._cutCopyActions=[o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.waitBeforeCopy,"waitBeforeCopy"),o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.copyExternal,"copyExternal"),o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.copyInternal,"copyInternal")],C.ULS.sendTraceTag(18158307,307,50,"ClipboardOperationCutCopyProcessor: setup actions as WaitBeforeCopy, CopyExternal, CopyInternal.")):(this._cutCopyActions=[o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.copyExternal,"copyExternal"),o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.copyInternal,"copyInternal")],C.ULS.sendTraceTag(18158336,307,50,"ClipboardOperationCutCopyProcessor: setup actions as CopyExternal, CopyInternal.")),32&n.actionIdFlags){var r=o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.deleteForCut,"deleteForCut");this._cutCopyActions.push(r),C.ULS.sendTraceTag(18158337,307,50,"ClipboardOperationCutCopyProcessor: setup actions add DeleteForCut for cut.")}return function(e){var t=e.browserName;if(C.ULS.sendTraceTag(18617485,307,50,"Copy operation in {0}.",t),e.interactiveView){var n=e.interactiveView.get_selectionManager(),r=j_(n);if(1===r.length)C.ULS.sendTraceTag(18425102,307,50,"Copy 1 {0} element in {1}.",Object.getType(r[0].get_node()).getName(),t);else{var i=$_(r);C.ULS.sendTraceTag(18425103,307,50,"Copy {0} elements: {1} in {2}.",r.length,i,t)}}}(n),!0},e}();(0,o.l)(em,"ClipboardOperationCutCopyProcessor",null,[Z_]);var tm=(0,o.y)("IClipboardOperationMoveProcessor"),nm=function(){function e(e,t,n,r){this._internalClipboard=null,this._clipboardOperationCutCopy=null,this._clipboardOperationPaste=null,this._selectionManager=null,this._moveActions=null,this._currentStep=0,this._internalClipboard=e,this._selectionManager=t,this._clipboardOperationCutCopy=n,this._clipboardOperationPaste=r,this._currentStep=0}return e.prototype.process=function(e,t){this._currentStep||(this._moveActions=[o.i(this,this.copyMovedSelection,"copyMovedSelection"),o.i(this._clipboardOperationCutCopy,this._clipboardOperationCutCopy.deleteForCut,"deleteForCut"),o.i(this,this.moveIp,"moveIp"),o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.pasteInternal,"pasteInternal"),o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.setSelectionAfterPaste,"setSelectionAfterPaste")]);var n=!0;return this._currentStep<this._moveActions.length&&(n=this._moveActions[this._currentStep++](e,t)),!!n&&this._currentStep<this._moveActions.length},e.prototype.copyMovedSelection=function(e,t){var n=t.interactiveView;return this._internalClipboard.useDragDropClipboardRoot(),this._internalClipboard.copySelectionToInternalClipboard(n,e),!0},e.prototype.moveIp=function(e,t){var n=[t.actionData],r=new X_.Selection(n,!0);return this._selectionManager.setSelection(r,e),!0},e}();(0,o.l)(nm,"ClipboardOperationMoveProcessor",null,[tm]);var rm=(0,o.y)("IClipboardOperationPasteProcessor"),im=function(){function e(e,t,n,r,i,o){this._activityManager=null,this._browserUtils=null,this._clipboardOperationPaste=null,this._htmlImportStrategyLazy=null,this._chromeClipboardAccessIsEnabled=!1,this._externalPasteOnMobileIsEnabled=!1,this._chromeClipboardAccessOperationTimeout=0,this._pasteActions=null,this._currentStep=0,this._prepareStartTime=0,this._clipboardAccessHelper=null,this._activityManager=r,this._browserUtils=t,this._clipboardOperationPaste=i,this._htmlImportStrategyLazy=n,this._chromeClipboardAccessIsEnabled=L.AFrameworkApplication.shouldUseChromeExtension(),this._chromeClipboardAccessOperationTimeout=e.get_appSettings().ChromeClipboardAccessOperationTimeout,this._currentStep=0,this._clipboardAccessHelper=o,this._externalPasteOnMobileIsEnabled=e.getBooleanAppSetting("EnableExternalPasteSupportOnMobileIsEnabled")}return e.prototype.get_pasteTarget=function(){return this._clipboardOperationPaste.get_pasteTarget()},e.prototype.process=function(e,t){return this._currentStep?1===this._currentStep?this.prepareForPaste(e,t):2===this._currentStep?(this._currentStep=3,this._pasteActions(e,t)):3===this._currentStep&&(this._clipboardOperationPaste.setSelectionAfterPaste(e,t),!1):this.pasteProcessorSetup(e,t)},e.prototype.pasteProcessorSetup=function(e,t){var n=t,r=!0;return this._browserUtils.get_isMobile()&&L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordEnableExternalPasteSupportOnMobileSettings"),this._externalPasteOnMobileIsEnabled&&(r=!(1&n.actionIdFlags)),this._browserUtils.get_isMobile()&&r||512&n.actionIdFlags?(2&n.actionIdFlags?this._pasteActions=o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.paste,"paste"):this._pasteActions=o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.pasteInternal,"pasteInternal"),this._currentStep=2):(this._chromeClipboardAccessIsEnabled?(this._currentStep=1,this._prepareStartTime=Date.now()):this._currentStep=2,this._pasteActions=o.i(this._clipboardOperationPaste,this._clipboardOperationPaste.paste,"paste")),function(e){var t=e.browserName;C.ULS.sendTraceTag(18617486,307,50,"Paste operation in {0}.",t)}(n),!0},e.prototype.prepareForPaste=function(e,t){var n=t,r=!0;if(this._htmlImportStrategyLazy.get_value().prepare())this._currentStep=2;else{var i=Date.now()-this._prepareStartTime;i>this._chromeClipboardAccessOperationTimeout&&(C.ULS.sendTraceTag(18158340,307,50,"prepareTime : {0}",i),this._activityManager.recordEvent(D_.f.failedProcessingStep,{Reason:M_.i.operationTimeout}),n.operationTelemetry&&n.operationTelemetry.fail("Prepare for paste timed out",!1),t.failed=!0,r=!1,this._clipboardAccessHelper.resetSystemClipboard())}return r},e}();(0,o.l)(im,"ClipboardOperationPasteProcessor",null,[rm]);var om=n(6391),am=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g,p,d,h,_,m,f){this._internalClipboard=null,this._actionManager=null,this._chromeClipboardAccessIsEnabled=!1,this._activityManager=null,this._selectionEditor=null,this._browserUtils=null,this._graphTransactionFactory=null,this._clipboardOperationPasteFactory=null,this._clipboardOperationCutCopyFactory=null,this._clipboardOperationClipboardAccessHelper=null,this._clipboardOperationWordStrategy=null,this._cannotCutDialog=null,this._simpleOperationFactory=null,this._trackChangeReader=null,this._trackChangeManager=null,this._undoManager=null,this._pasteFloatieEventSource=null,this._telemetry=null,this._internalClipboard=e,this._actionManager=t,this._chromeClipboardAccessIsEnabled=n,this._activityManager=r,this._selectionEditor=i,this._browserUtils=o,this._graphTransactionFactory=a,this._clipboardOperationPasteFactory=s,this._clipboardOperationCutCopyFactory=l,this._clipboardOperationClipboardAccessHelper=c,this._clipboardOperationWordStrategy=u,this._cannotCutDialog=g,this._simpleOperationFactory=p,this._trackChangeReader=d,this._trackChangeManager=h,this._undoManager=_,this._pasteFloatieEventSource=m,this._telemetry=f}return e.prototype.create=function(e,t,n,r,i,o,a,s,l){void 0===l&&(l=!0);var c=this._clipboardOperationPasteFactory.create(r,(0,f.e)(U_.d,s)),u=this._clipboardOperationCutCopyFactory.create(),g=new Y_(this._internalClipboard,c),p=new nm(this._internalClipboard,Oa.SelectionManager.get_instance(),u,c),d=new em(u),h=new im(L.AFrameworkApplication.appSettingsManager,om.k.get_instance(),r,ji.y.get_instance(),c,this._clipboardOperationClipboardAccessHelper);return new Q_(e,t,n,i,o,a,s,this._chromeClipboardAccessIsEnabled,this._actionManager,this._activityManager,this._selectionEditor,this._browserUtils,this._graphTransactionFactory,g,p,d,h,this._clipboardOperationClipboardAccessHelper,this._clipboardOperationWordStrategy,this._cannotCutDialog,this._simpleOperationFactory,this._trackChangeReader,this._trackChangeManager,this._undoManager,this._pasteFloatieEventSource,this._telemetry,l)},e}();(0,o.l)(am,"Factory$13",null,[_d.d]);var sm=(0,o.y)("IClipboardOperationPaste"),lm=n(9853),cm=function(){function e(e,t){this.graphObjectUsageData=null,this.cpUsageData=null,this.chpUsageData=null,this.blobUsageData=null,this.graphObjectUsageData=e.getGraphObjectUsageDataInstance(t),this.cpUsageData=e.getCpUsageDataInstance(t),this.chpUsageData=e.getChpUsageDataInstance(t),this.blobUsageData=e.getBlobUsageDataInstance(t)}return e.getAnInstance=function(t){return e.getAnInstanceWithResolvedDependencies(t)},e.getAnInstanceWithResolvedDependencies=function(t){return new e(lm.z.get_instance(),t)},e}();(0,o.l)(cm,"CpUsageHelper",null,[]);var um=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g){this._htmlImportStrategyLazy=null,this._activityManager=null,this._pasteCoordinator=null,this._internalClipboard=null,this._usageEditor=null,this._undoManagerLazy=null,this._selectionManager=null,this._actionManager=null,this._pasteStrategy=null,this._domElementContentStateFactory=null,this._clipboardOperationPasteOvertypeStrategy=null,this._trackChangeManager=null,this._activityManager=e,this._internalClipboard=t,this._pasteCoordinator=n,this._usageEditor=r,this._selectionManager=i,this._actionManager=o,this._htmlImportStrategyLazy=a,this._undoManagerLazy=l,this._pasteStrategy=s,this._domElementContentStateFactory=c,this._clipboardOperationPasteOvertypeStrategy=u,this._trackChangeManager=g}return e.prototype.get_undoManager=function(){return this._undoManagerLazy.get_value()},e.prototype.get_usageEditor=function(){return this._usageEditor},e.prototype.get_activityManager=function(){return this._activityManager},e.prototype.get_pasteTarget=function(){return this._pasteStrategy.get_pasteTarget()},e.prototype.paste=function(e,t){var n=this,r=this._trackChangeManager.beginUntrackedChangeCapture();try{var i,a=t,s=a.interactiveView,l=a.actionIdFlags;if(C.ULS.shipAssertTag(18131010,307,!!(1&l)),o.r(U_.d,a.actionData)&&a.actionData.setValue(Oh.p.editContainerWidth,s.get_editingDom().get_editingElement().clientWidth),this._clipboardOperationPasteOvertypeStrategy.tryStoreOriginalFormat(e,t),!this._htmlImportStrategyLazy.get_value().tryGetContentDom((0,p.m)((function(){return i}),(function(e){return i=e}))))return a.operationTelemetry&&a.operationTelemetry.fail("HTML import strategy failed",!1),a.failed=!0,!1;this.get_undoManager().interruptUndoMerging();var c=!0,u=null,g=this._domElementContentStateFactory.create(i),d=a.useSelection;return s.get_selectionManager().runAgainstSelectionCollection((function(e){d&&2===n._actionManager.processAction(ii.kl,2)?c=!1:(u=d?n._selectionManager.get_selectionCollection().get_currentSelection().get_firstContext():a.actionData,C.ULS.shipAssertTag(18158338,307,Pa.SelectionEditor.isInsertionPointContext(u)),n.logMetricsForGraphLocation(u,"paste"))}),this._pasteStrategy.get_isPasteToVirtualSelection()),c?(s.get_editingView().disable(!0,25),g.restore(),this._pasteCoordinator.pasteAtIp(i,u,e),!0):!1}finally{r&&r.dispose()}},e.prototype.pasteGlossaryPlaceholder=function(e,t){var n=t,r=(0,f.e)(U_.d,n.actionData).getValue(_s.y,zl.k.glossaryInsertionIPContext);if(C.ULS.shipAssertTag(20492440,307,Pa.SelectionEditor.isInsertionPointContext(r)),!this.checkValidIpContextForInternalPasteAtIp(r,n))return!1;this.get_undoManager().interruptUndoMerging();var i=(new Gg.b).getTransaction(15);return i.setFromNode(this._internalClipboard.get_theClipboardRoot()),this._pasteCoordinator.internalPasteAtIp(r,e),this._internalClipboard.clearInternalData(),i.dispose(),!0},e.prototype.pasteInternal=function(e,t){var n=this._selectionManager.get_selectionCollection().get_currentSelection().get_firstContext();return!!this.checkValidIpContextForInternalPasteAtIp(n,t)&&(this.get_undoManager().interruptUndoMerging(),this._actionManager.processAction(ii.kl,2),C.ULS.shipAssertTag(18158339,307,Pa.SelectionEditor.isInsertionPointContext(n)),this.logMetricsForGraphLocation(n,"intPaste"),this._pasteCoordinator.internalPasteAtIp(n,e),!0)},e.prototype.checkValidIpContextForInternalPasteAtIp=function(e,t){return!((!e||!e.get_isValid())&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordAbortClipboardOperationWhenFailReturnToOESettings"),C.ULS.sendTraceTag(595142426,307,15,"Invalid ip context. IsTouch: {0}",!!t&&t.isTouch),L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AbortClipboardOperationWhenFailReturnToOEIsEnabled")))},e.prototype.logMetricsForGraphLocation=function(e,t){var n=cm.getAnInstance(t);this.get_usageEditor().recordCpMetrics(n,e.get_node(),e.get_cpBegin()),this.get_usageEditor().logCpUsageData(n.cpUsageData),this.get_usageEditor().logGraphObjectUsageData(n.graphObjectUsageData),this.get_usageEditor().logChpUsageData(n.chpUsageData),this.get_usageEditor().logBlobUsageData(n.blobUsageData)},e.prototype.setSelectionAfterPaste=function(e,t){var n=t;return!!n.useSelection&&(64&n.actionIdFlags&&this._internalClipboard.useUserClipboardRoot(),n.finalSelection?(this._pasteStrategy.updatedSelectionAfterPaste(n),this.get_undoManager().interruptUndoMerging(),!1):(C.ULS.sendTraceTag(3994450,307,50,"No selection after paste"),this.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.invalidSelection}),n.operationTelemetry&&n.operationTelemetry.fail("No selection after paste",!1),n.failed=!0,!1))},e}();(0,o.l)(um,"ClipboardOperationPaste",null,[sm]);var gm=function(){function e(e,t,n,r,i,o,a,s,l,c,u){this._activityManager=null,this._pasteCoordinator=null,this._internalClipboard=null,this._usageEditor=null,this._selectionManager=null,this._actionManager=null,this._undoManagerLazy=null,this._pasteStrategyFactory=null,this._domElementContentStateFactory=null,this._clipboardOperationPasteOvertypeStrategy=null,this._trackChangeManager=null,this._activityManager=e,this._internalClipboard=t,this._pasteCoordinator=n,this._usageEditor=r,this._selectionManager=i,this._actionManager=o,this._undoManagerLazy=s,this._pasteStrategyFactory=a,this._domElementContentStateFactory=l,this._clipboardOperationPasteOvertypeStrategy=c,this._trackChangeManager=u}return e.prototype.create=function(e,t){var n=this._pasteStrategyFactory.create(this._selectionManager,t);return new um(this._activityManager,this._internalClipboard,this._pasteCoordinator,this._usageEditor,this._selectionManager,this._actionManager,e,n,this._undoManagerLazy,this._domElementContentStateFactory,this._clipboardOperationPasteOvertypeStrategy,this._trackChangeManager)},e}();(0,o.l)(gm,"Factory$14",null,[Rd]);var pm=function(){function e(e,t){this.stylePropertySet=null,this.pargraphFormattingData=null,this.stylePropertySet=e,this.pargraphFormattingData=t}return e.prototype.get_stylePropertySet=function(){return this.stylePropertySet},e.prototype.get_pargraphFormattingData=function(){return this.pargraphFormattingData},e}();(0,o.l)(pm,"ParagraphFormatStore",null,[]);var dm=function(){function e(e,t,n,r){this._selectionManager=null,this._paragraphReader=null,this._styleReader=null,this._isStyleEnabled=!1,this._selectionManager=e,this._paragraphReader=t,this._styleReader=n,this._isStyleEnabled=r}return e.prototype.tryStoreOriginalFormat=function(e,t){if(t.isOvertype&&this._isStyleEnabled){var n=e.get_operationContext(),r=this._selectionManager.get_selectionCollection().get_currentSelection().get_firstContext().get_node(),i=null;if(this._paragraphReader.isParagraphNode(r)){var o=this._styleReader.getStyleFromParagraphNode(r),a=this._paragraphReader.getParagraphProperties(r);i=new pm(o,a)}n=new K_(n.context,n.actionIdFlags,n.operationTelemetry,n.reportingData,n.actionData,i),e.set_operationContext(n)}},e}();(0,o.l)(dm,"ClipboardOperationPasteOvertypeStrategy",null,[xd]);var hm=(0,o.y)("IVirtualSelectionMerger"),_m=(0,o.y)("IClipboardOperationPasteStrategy"),mm=function(){function e(e){var t=this;this._selectionManager=null,this._liveSelectionRecord=null,this._selectionManager=e,e.runAgainstSelectionCollection((function(e){t._liveSelectionRecord=e}),!1)}return e.prototype.get_isPasteToVirtualSelection=function(){return!1},e.prototype.updatedSelectionAfterPaste=function(e){var t=this.adjustSelectionAfterPaste(e);this.setSelection(this._selectionManager,t)},e.prototype.adjustSelectionAfterPaste=function(e){var t=e.finalSelection;return(e.useVirtualSelection||e.selectPastedContent)&&e.startSelection&&(t=ss.SelectionFactory.extendSelection(e.startSelection,t.get_firstContext())),t},e.prototype.setSelection=function(e,t){e.setSelection(t)},e}();(0,o.l)(mm,"AClipboardOperationPasteStrategy",null,[_m]);var fm=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.get_pasteTarget=function(){return this._liveSelectionRecord},t}(mm);(0,o.l)(fm,"ClipboardOperationPasteToLiveSelectionStrategy",mm,[]);var ym=function(e){function t(t,n){var r=e.call(this,t)||this;return r._merger=null,r._virtualSelectionRecord=null,r._merger=n,t.runAgainstSelectionCollection((function(e){r._virtualSelectionRecord=e}),!0),r}return(0,S.t)(t,e),t.prototype.get_isPasteToVirtualSelection=function(){return!0},t.prototype.get_pasteTarget=function(){return this._virtualSelectionRecord},t.prototype.adjustSelectionAfterPaste=function(t){var n=e.prototype.adjustSelectionAfterPaste.call(this,t);return t.actionData.setValue(zl.k.pasteToVirtualSelectionIntermidiateResult,n),n=this._merger.getMergedSelection(this._liveSelectionRecord.get_currentSelection(),this._virtualSelectionRecord.get_currentSelection(),n)},t}(mm);(0,o.l)(ym,"ClipboardOperationPasteToVirtualSelectionStrategy",mm,[]);var Cm=function(){function e(e){this._virtualSelectionEnabled=!1,this._merger=null,this._virtualSelectionEnabled=e.getBooleanAppSetting("EnableVirtualSelectionInSelectionManager")}return e.prototype.create=function(e,t){return!!t&&t.getValueWithDefault(Boolean,zl.k.useVirtualSelection,!1)&&this._virtualSelectionEnabled?new ym(e,this.get_virtualSelectionMerger()):new fm(e)},e.prototype.get_virtualSelectionMerger=function(){return this._merger||(this._merger=se.w.get_instance().tryResolve(hm)),this._merger},e}();(0,o.l)(Cm,"ClipboardOperationPasteStrategyFactory",null,[Ld]);var Sm=function(){function e(e,t,n,r,i,o){this._selectionManager=null,this._coauthManager=null,this._lockedRangeEditor=null,this._activityManager=null,this._isLockedRangeEnabled=!1,this._isWordCoauthEnabled=!1,this._activityManager=e,this._selectionManager=t,this._coauthManager=n,this._lockedRangeEditor=r,this._isLockedRangeEnabled=i,this._isWordCoauthEnabled=o}return e.prototype.prepareForSetup=function(e){this._isWordCoauthEnabled&&(1&e||32&e)&&this._coauthManager.get_isCoauthorable()&&this._selectionManager.acquireLocksForSelection()},e.prototype.isClipboardOperationEnabledWithThisSelection=function(e,t){return!this._isLockedRangeEnabled||(!(1&e&&this._lockedRangeEditor.contextSetContainsLockedRange(t,!0))||(this._activityManager.recordEvent(D_.f.noExecute,{Reason:M_.i.containsLockedRange}),!1))},e}();(0,o.l)(Sm,"ClipboardOperationWordStrategy",null,[]);var vm=function(){function e(e){}return e.prototype.convertStyleDomToInlineStyle=function(e,t){if(t){var n=t.sheet;if(n){var r=n.cssRules;if(r){var i=Array.clone(r);i.reverse();for(var o=0,a=0,s=0,l=0,c=0,u=i;c<u.length;c++){var g=u[c],p=g.style,d=g.selectorText,h=p?p.cssText:null,_=d?d.split(","):null;if(h&&_&&g.type===g.STYLE_RULE){l+=_.length;for(var m=0,f=_;m<f.length;m++){var y=f[m];y.indexOf("#")>=0&&o++,y.indexOf(".")>=0&&a++,y.indexOf("#")<0&&y.indexOf(".")<0&&s++;var S=null;try{S=e.querySelectorAll(y)}catch(e){C.ULS.sendTraceTag(41427107,307,10,"ConvertStyleDomToInlineStyle failed to query selector: {0}. Exception: {1}",y,e.message)}if(S)for(var v=0;v<S.length;v++)S[v].setAttribute("style",h+(S[v].getAttribute("style")||""))}}}C.ULS.sendTraceTag(51245663,307,50,"selectorCount: {0}; idSelectorCount: {1}; classSelectorCount: {2}; tagSelectorCount: {3}",l,o,a,s)}else this.logStyleSheetPropertiesUnavailable("cssRules")}else this.logStyleSheetPropertiesUnavailable("sheet")}},e.prototype.logStyleSheetPropertiesUnavailable=function(e){C.ULS.sendTraceTag(41211202,307,15,"Could not access {0} for Style DOMElement in ConvertStyleDomToInlineStyle and abort the conversion. Browser: {1} ",G.y.get_browserNameForlogging())},e}();(0,o.l)(vm,"ExternalPasteCssConverter",null,[Jd]);var bm=n(8931),Tm=(0,o.y)("ISingleLevelListEditor"),Am=n(2166),Im=(0,o.y)("IPastedParagraphSpaceHandler"),wm=n(7937),xm=n(7685),Fm=function(){return function(){this.value=!1,this.value=!1}}();(0,o.l)(Fm,"OutBool",null,[]);var Em=function(){function e(e){this._originNode=null,this._targetNode=null,this._originalIterator=null,this._childRoles=null,this._childNodes=null,this._childIndices=null,this._itemFilter=null,this._filterData=null,this._targetNode=e.get_currentNode();var t=new Da.GraphIterator;t.setFrom(e),this._originalIterator=new Da.GraphIterator,this._originalIterator.setFrom(e),this._originNode=t.get_origin(),this._childIndices=new Array(t.get_depth()),this._childRoles=new Array(t.get_depth()),this._childNodes=new Array(t.get_depth());for(var n=t.get_depth()-1;n>=0;--n){var r=t.get_currentNode();this._childRoles[n]=t.get_role(),this._childNodes[n]=r,t.returnToParent(),this._childIndices[n]=t.getChildIndexByRole(r,this._childRoles[n])}}return e.prototype.setFilter=function(e,t){this._itemFilter=e,this._filterData=t},e.prototype.restore=function(e){var t=new Fm,n=new Fm;return this.restoreDetailed(e,t,n),n.value},e.prototype.restoreDetailed=function(e,t,n){if(t.value=!0,this._originalIterator.get_isValid())return e.setFrom(this._originalIterator),void(n.value=!1);for(var r=this._childNodes.length-1;r>=0;--r){var i=this._childNodes[r];if(i.get_anchor()&&!i.get_anchor().get_isRetired()&&(e.set(i),e.tryToRootAtAncestor(this._originNode)||this._originNode.get_isGraphRoot()&&e.tryToRootAtMainGraphRoot()))return n.value=this.extendDownward(e,r+1),void e.get_isValid();t.value=!1}e.set(this._originNode),n.value=this.extendDownward(e,0)},e.prototype.extendDownward=function(e,t){var n,r,i=!1;if(n=this._childIndices[t],r=this._childRoles[t],n<e.getChildCountByRole(r))e.goToChildIndexByRole(n,r);else if(i=!0,!e.goToLastChildByRole(r))return!0;if(!this.moveToClosestNodeWithFilter(e,r))return i;for(var o=t+1;o<this._childIndices.length;++o){if(i){if(!e.goToLastChildByRole(this._childRoles[o]))return!0}else if(!e.goToFirstChildByRole(this._childRoles[o]))return!1;if(!this.moveToClosestNodeWithFilter(e,this._childRoles[o]))return i}return i},e.prototype.moveToClosestNodeWithFilter=function(e,t){if(this._itemFilter&&!this._itemFilter(e,this._filterData)){var n=new Da.GraphIterator;n.setFrom(e);var r=!0;do{if(!e.goToNextSiblingByRole(t)){r=!1;break}}while(!this._itemFilter(e,this._filterData));if(!r){e.setFrom(n);do{if(!e.goToPreviousSiblingByRole(t))return e.returnToParent(),!1}while(!this._itemFilter(e,this._filterData))}}return!0},e}();(0,o.l)(Em,"NodeReference",null,[]);var Pm=n(2262),km=function(){function e(e,t,n,r,i){this._pageContentEditor=null,this._styleEditor=null,this._paragraphEditor=null,this._contentControlCopyPasteHelper=null,this._listReader=null,this._listEditor=null,this._workspace=null,this._singleLevelListEditor=null,this.ipContext=null,this.topMostSelectableNode=null,this.precedingNodeRef=null,this.followingNodeRef=null,this.parentArgs=null,this.transaction=null,this._trackChangeEditor=null,this._trackChangeReader=null,this._trackChangeManager=null,this._changeIdEditor=null,this._pastedParagraphSpaceHandler=null,this._renderOrderGraphIteratorFactory=null,this.ipContext=e,this.precedingNodeRef=null,this.followingNodeRef=null,this.parentArgs=t,this.transaction=n,this._contentControlCopyPasteHelper=r,this._workspace=i}return e.prototype.get_appSettingsManager=function(){return L.AFrameworkApplication.appSettingsManager},e.prototype.get_styleEditor=function(){return this._styleEditor||(this._styleEditor=se.w.get_instance().resolve(uc.e))},e.prototype.get_paragraphEditor=function(){return this._paragraphEditor||(this._paragraphEditor=se.w.get_instance().resolve(gc.g))},e.prototype.get_pageContentEditor=function(){return this._pageContentEditor||(this._pageContentEditor=se.w.get_instance().resolve(bm.m))},e.prototype.get_outlineEditor=function(){return e._outlineEditor||(e._outlineEditor=se.w.get_instance().resolve(rc.a))},e.prototype.get_listReader=function(){return this._listReader||(this._listReader=se.w.get_instance().resolve(ts.c))},e.prototype.get_listEditor=function(){return this._listEditor||(this._listEditor=se.w.get_instance().resolve(rs.v))},e.prototype.get_singleLevelListEditor=function(){return this._singleLevelListEditor||(this._singleLevelListEditor=se.w.get_instance().tryResolve(Tm))},e.prototype.get_trackChangeEditor=function(){return this._trackChangeEditor||(this._trackChangeEditor=se.w.get_instance().resolve(cc.x).get_instance())},e.prototype.get_trackChangeReader=function(){return this._trackChangeReader||(this._trackChangeReader=se.w.get_instance().resolve(za.p).get_instance())},e.prototype.get_trackChangeManager=function(){return this._trackChangeManager||(this._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},e.prototype.get_changeIdEditor=function(){return this._changeIdEditor||(this._changeIdEditor=se.w.get_instance().resolve(Am.p))},e.prototype.get_pastedParagraphSpaceHandler=function(){return this._pastedParagraphSpaceHandler||(this._pastedParagraphSpaceHandler=se.w.get_instance().tryResolve(Im))},e.prototype.set_pastedParagraphSpaceHandler=function(e){return this._pastedParagraphSpaceHandler=e,e},e.prototype.get_renderOrderGraphIteratorFactory=function(){return this._renderOrderGraphIteratorFactory||(this._renderOrderGraphIteratorFactory=se.w.get_instance().tryResolve(Id))},e.prototype.set_renderOrderGraphIteratorFactory=function(e){return this._renderOrderGraphIteratorFactory=e,e},e.prototype.get_pastingOutlines=function(){return!1},e.prototype.get_shouldGetPasteConstrainingWidth=function(){return this.get_appSettingsManager().getBooleanAppSetting("WordEditorAutoResizeImageIsEnabled")},e.prototype.executePasteOfOutlines=function(e,t){},e.prototype.pasteSetup=function(e,t){var n=void 0===this.parentArgs.actionIdFlags||null===this.parentArgs.actionIdFlags?"not available":H_(q_.u,this.parentArgs.actionIdFlags);if(C.ULS.sendTraceTag(8765522,307,50,"PasteSetup: {0} [{1}].",this.parentArgs.actionIdFlags,n),C.ULS.shipAssertTag(6305487,307,Pa.SelectionEditor.isInsertionPointContext(this.ipContext)),this.get_nothingToPaste())return C.ULS.sendTraceTag(6305488,307,50,"NothingToPaste"),this.parentArgs.finalSelection=ss.SelectionFactory.createSelectionFromContext(this.ipContext),e.changeStepCallback(o.i(this,this.pasteTeardown,"pasteTeardown")),!0;var r=new Da.GraphIterator;if(r.set(this.ipContext.get_node()),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(r),hs.OutlineElementNavigator.returnToOutlineElement(r),this.topMostSelectableNode=r.get_origin(),this.get_pastingOutlines())return r.returnToNodeOfType(10),this.executePasteOfOutlines(r,e),e.changeStepCallback(o.i(this,this.setSelectionAfterPastingOutlines,"setSelectionAfterPastingOutlines")),!0;if(Hr.b(r)){if(this.get_isContentSingleParagraph())return this.parentArgs.finalSelection=this.pastePlainText(this.ipContext,this.get_contentAsText()),e.changeStepCallback(o.i(this,this.pasteTeardown,"pasteTeardown")),!0;var i=this.moveFromTitleToDocument(r);this.ipContext=i.get_item(0)}this._contentControlCopyPasteHelper&&this._contentControlCopyPasteHelper.onBeforeSplit(this.ipContext),this.splitLine(this.ipContext);var a=new Pm.z;return a.setFrom(r),hs.OutlineElementNavigator.moveToNextOutlineElement(a,!1,!1),this.precedingNodeRef=new Em(r),this.followingNodeRef=new Em(a),e.changeStepCallback(o.i(this,this.pasteExecution,"pasteExecution")),!0},e.prototype.pasteExecution=function(e,t){Xi.t.mark(5568),this.executePaste(e);var n=o.i(this,this.mergeAfterPaste,"mergeAfterPaste");if(this.get_isMergeFixEnabled()){var r=this.shouldSkipMergeAfterPaste();r&&(n=o.i(this,this.pasteTeardown,"pasteTeardown")),C.ULS.sendTraceTag(40387030,307,50,"ExecutePaste: shouldSkipMerge: {0}.",r)}return e.changeStepCallback(n),!0},e.prototype.shouldSkipMergeAfterPaste=function(){return!1},e.prototype.get_isMergeFixEnabled=function(){return this.get_appSettingsManager().getBooleanAppSetting("PptCcpFix2IsEnabled")},e.prototype.get_shouldGetSingleOEFixEnable=function(){return this.get_appSettingsManager().getBooleanAppSetting("CopyAndPasteOneParagraphIndentationFixIsEnabled")},e.prototype.mergeAfterPaste=function(t,n){Xi.t.mark(5569);var r=new Da.GraphIterator;this.precedingNodeRef.restore(r),this.precedingNodeRef=null;var i=new Da.GraphIterator;this.followingNodeRef.restore(i),this.followingNodeRef=null,C.ULS.shipAssertTag(6305489,307,Ls.OutlineElementReader.isOutlineElement(r)),C.ULS.shipAssertTag(6305490,307,Ls.OutlineElementReader.isOutlineElement(i)),hs.OutlineElementNavigator.moveToContent(r);var a=cs.ParagraphReader.isParagraph(r)?cs.ParagraphReader.textLength(r.get_currentNode()):0;hs.OutlineElementNavigator.returnToOutlineElement(r),hs.OutlineElementNavigator.moveToContent(i),C.ULS.shipAssertTag(6305491,307,cs.ParagraphReader.isParagraph(i));var s,l=cs.ParagraphReader.textLength(i.get_currentNode());hs.OutlineElementNavigator.returnToOutlineElement(i);var c,u=this.get_shouldMergeAfterContent(),g=new Pm.z;g.setFrom(r),hs.OutlineElementNavigator.moveToNextOutlineElement(g,!1,!1);var d=g.get_currentNode()===i.get_currentNode(),h=!!this.parentArgs&&!!(8192&this.parentArgs.actionIdFlags),_=!1;if(!h&&this.parentArgs.actionData&&o.r(Kl.DictionaryPropertySet,this.parentArgs.actionData)&&2===Br.App.get_mode()){var m=this.parentArgs.actionData.getProperty_Unchecked(zl.k.pastedPlainTextContent);h=!(!m||""===m)}if(d){var f=Da.GraphIterator.createFromNode(r.get_currentNode());if(cs.ParagraphReader.canContainIpOrTextRange(hs.OutlineElementNavigator.moveToContent(f))||(r=i),r.get_currentNode().get_id()!==i.get_currentNode().get_id()){C.ULS.sendTraceTag(40691869,307,50,"MergeAfterPaste NothingPasted: precedingIteratorIsList: {0}, followingIteratorIsList: {1}",mc.ListReader.isListOutlineElement(r),mc.ListReader.isListOutlineElement(i));var y=e.get_outlineElementEditor().merge(r,i,!0,h);C.ULS.shipAssertTag(6305492,307,y)}s=r,c=!0}else{var S=!!(4&this.parentArgs.actionIdFlags),v=this.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&this.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()&&S&&this.parentArgs.isEndOfParagraphLastContext;this.get_pastedParagraphSpaceHandler()&&this.parentArgs&&2===Br.App.get_mode()&&!S&&(this.get_pastedParagraphSpaceHandler().handleSpacesAroundPastedContent(r,!1),this.get_pastedParagraphSpaceHandler().handleSpacesAroundPastedContent(i,!0)),hs.OutlineElementNavigator.moveToContent(g);var b=cs.ParagraphReader.isParagraph(g)?cs.ParagraphReader.textLength(g.get_currentNode()):0;if(hs.OutlineElementNavigator.returnToOutlineElement(g),this.applyTrackChangesOnPastedNode(g,r,i),this.get_changeIdEditor().get_catchUpActivityIsEnabled()||this.get_shouldGetSingleOEFixEnable())if((x=new Pm.z).setFrom(g),hs.OutlineElementNavigator.moveToNextOutlineElement(x,!1,!1),x.get_currentINode().get_id()!==i.get_currentINode().get_id()){for(;g.get_currentNode().get_id()!==i.get_currentNode().get_id();)hs.OutlineElementNavigator.moveToContent(g,!1),this.get_changeIdEditor().setChangeIdOnContext(_s.y.create(g.get_currentNode())),g.returnToParent(),hs.OutlineElementNavigator.moveToNextOutlineElement(g,!1,!1);g.setFrom(r),hs.OutlineElementNavigator.moveToNextOutlineElement(g,!1,!1)}else _=!0;if(this._contentControlCopyPasteHelper&&this._contentControlCopyPasteHelper.processPastedContentsInMergeAfterPaste(r,i,(0,p.m)((function(){return u}),(function(e){return u=e})),(0,p.m)((function(){return g}),(function(e){return g=e}))),this.parentArgs.replacedFormatting){C.ULS.shipAssertTag(6305493,307,this.parentArgs.isOvertype);var T=new Da.GraphIterator;T.setFrom(g);var A=hs.OutlineElementNavigator.moveToContent(T);if(A){var I=this.parentArgs.replacedFormatting.cloneUnderDifferentChp(A.get_characterProperties().get_item(0));A.get_characterProperties().get_item(0).set_formatting(I)}}var w=void 0;if(mc.ListReader.isListOutlineElement(r)?(e.get_listSettings().isSingleLevelListImprovementEnabled&&this.get_singleLevelListEditor()&&this.get_singleLevelListEditor().inflateSingleLevelListIfNeeded(r),w=!mc.ListReader.isListOutlineElement(g)||this.get_shouldMergePastedListIntoList()):Ls.OutlineElementReader.isEmpty(r,!0)?(e.get_outlineElementEditor().disconnectOutlineElement(r),w=!1):w=mc.ListReader.get_isListMarkerEnabled()||!mc.ListReader.isListOutlineElement(g),this._contentControlCopyPasteHelper&&(w=this._contentControlCopyPasteHelper.checkShouldMergeBeforeContent(r,w)),this.parentArgs.startSelection=null,(this.parentArgs.selectPastedContent||this.parentArgs.useVirtualSelection)&&(this.parentArgs.startSelection=this.getStartSelection(w?r.get_currentNode():g.get_currentNode(),w)),w){var x,F=mc.ListReader.isListOutlineElement(r);if(C.ULS.sendTraceTag(40691870,307,50,"MergeAfterPaste MergeBeforeContent, precedingIsList: {0}, firstPastedOeIsList: {1}",F,mc.ListReader.isListOutlineElement(i)),e.get_outlineElementEditor().merge(r,g,!0,h,i,void 0,_,v),mc.ListReader.isListOutlineElement(r))if(this.get_listReader().get_qoEListInternalCCPImprovementIsEnabled())if((x=new Pm.z).setFrom(r),hs.OutlineElementNavigator.moveToNextOutlineElement(x,!1,!1),x.get_currentINode().get_id()!==i.get_currentINode().get_id()){var E=this.get_listReader().getListInfo(r);this.get_listReader().moveToList(r);var P=r.get_currentNode().getValueWithDefault(Number,ks.j.listID,0);for(r.returnToParent(),E.set_restartAt(wm.z.startAtNone);x.get_currentNode().get_id()!==i.get_currentNode().get_id();){if(mc.ListReader.isListOutlineElement(x)){if(F){var k=this.get_listReader().getListLevelInfoFromListNode(x),D=this.get_listReader().getListPropertiesFromIdLevel(r.get_currentNode(),P,k),M=D?ds.j.createFromExistingPropertySet(D,null):E,R=ds.j.createFromScratch(M.get_listType(),E.get_listStyle(),null,0,k,"","");R.oeToJoin=r.get_currentNode(),this.get_listEditor().setPendingListInfo(R),this.get_listEditor().setListInfoAndIndentAfterPaste(x,!0)}}else this.get_listEditor().applyBulletsNumbering(E.get_propertySet(),x,(0,p.m)((function(){return E}),(function(e){return E=e})));hs.OutlineElementNavigator.moveToNextOutlineElement(x,!1,!1)}}}if(u){var L=new Pm.z;L.setFrom(i),hs.OutlineElementNavigator.moveToPreviousOutlineElement(L,!1,!1);var N=mc.ListReader.isListOutlineElement(L),B=mc.ListReader.isListOutlineElement(i);y=e.get_outlineElementEditor().merge(L,i,!0,h,void 0,!0,void 0,v);C.ULS.sendTraceTag(40691871,307,50,"MergeAfterPaste MergeAfterContent, lastPastedOeIsList: {0}, followingIteratorIsList: {1}, MergeSucceeded: {2}",N,B,y?"True":"False, will cause IP to reset to zero."),s=y?L:i,c=y}else s=i,c=!1,C.ULS.sendTraceTag(51463189,307,50,"No merge, will cause IP to reset to zero.");if(this.get_changeIdEditor().get_catchUpActivityIsEnabled()&&_)if(w){var O=new Da.GraphIterator;O.setFrom(r);var U=hs.OutlineElementNavigator.moveToContent(O);this.get_changeIdEditor().setChangeIdOnTextRange(U,a,a+b)}else if(u){var H=new Da.GraphIterator;H.setFrom(g);var G=hs.OutlineElementNavigator.moveToContent(H);this.get_changeIdEditor().setChangeIdOnTextRange(G,0,b)}else{var V=new Da.GraphIterator;V.setFrom(g);var W=hs.OutlineElementNavigator.moveToContent(V);this.get_changeIdEditor().setChangeIdOnContext(_s.y.create(W))}}C.ULS.shipAssertTag(6305494,307,s.get_isValid());var z=hs.OutlineElementNavigator.moveToContent(s),K=c?cs.ParagraphReader.textLength(z)-l:0,q=!1;if(o.r(U_.d,this.parentArgs.actionData)&&(q=this.parentArgs.actionData.getValueWithDefault(Boolean,zl.k.isImageInsertion,!1)),q&&us.n.get_instance().get_item(11)?this.parentArgs.finalSelection=ss.SelectionFactory.createTextRangeOrIpSelection(z,K-1,K):this.parentArgs.finalSelection=ss.SelectionFactory.createIpSelection(z,K),us.n.get_instance().get_item(71)&&this.parentArgs&&this.parentArgs.isOvertype&&cs.ParagraphReader.isParagraphNode(z)&&this.parentArgs.originalParagraphFormat){var j=this.parentArgs.originalParagraphFormat.get_stylePropertySet();j&&this.get_styleEditor().setStyleOnParagraphNode(j,z,!0);var $=this.parentArgs.originalParagraphFormat.get_pargraphFormattingData();$&&this.get_paragraphEditor().applyParagraphProperties(z,$)}return t.changeStepCallback(o.i(this,this.pasteTeardown,"pasteTeardown")),!0},e.prototype.applyTrackChangesOnPastedNode=function(t,n,r){var i=!1;if(this.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&this.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()){var o=!1;if(this._contentControlCopyPasteHelper){var a=n.get_currentNode();o=this._contentControlCopyPasteHelper.isPastedInBlockContentControl(a)||this._contentControlCopyPasteHelper.isPastedInInlineContentControl(a)}o?this.get_trackChangeManager().set_pendingUntrackedChangeAlert(1):i=!0}if(i){for(var s=function(){hs.OutlineElementNavigator.moveToContent(t,!1);var n,r=l.get_trackChangeReader().splitAndSortTrackableContexts(_s.y.create(t.get_currentNode()));r.getUntrackedChangeType((0,p.m)((function(){return n}),(function(e){return n=e})))&&l.get_trackChangeManager().alertUntrackedChange(n);for(var i=function(t){var n,i=r.getContext(t,(0,p.m)((function(){return n}),(function(e){return n=e})));n&&(e.get_hyperlinkEditor().normalizeHyperlinksinGraphNodeContext(i,1),l.get_trackChangeEditor().setTrackChangeOnContext(i,1,null,!0))},o=0;o<r.get_length();o++)i(o);t.returnToParent(),hs.OutlineElementNavigator.moveToNextOutlineElement(t,!1,!1)},l=this;t.get_currentNode()!==r.get_currentNode();)s();t.setFrom(n),hs.OutlineElementNavigator.moveToNextOutlineElement(t,!1,!1)}},e.prototype.getStartSelection=function(e,t){var n=Da.GraphIterator.createFromNode(e);if(hs.OutlineElementNavigator.moveToContent(n),cs.ParagraphReader.isParagraphNode(n.get_currentNode())){var r=t?cs.ParagraphReader.textLength(n.get_currentNode()):0;return ss.SelectionFactory.createIpSelection(n.get_currentNode(),r)}return dc.TableReader.isTableNode(n.get_currentNode())?ss.SelectionFactory.createSelectionFromNode(n.get_currentNode()):null},e.prototype.setSelectionAfterPastingOutlines=function(e,t){var n=Da.GraphIterator.createFromNode(this.topMostSelectableNode);return n.goToLastChildByRole(1),this.parentArgs.finalSelection=ss.SelectionFactory.createCollapsedSelection(n.get_currentNode(),!1),e.changeStepCallback(o.i(this,this.pasteTeardown,"pasteTeardown")),!0},e.prototype.pasteTeardown=function(e,t){var n=void 0===this.parentArgs.actionIdFlags||null===this.parentArgs.actionIdFlags?"not available":H_(q_.u,this.parentArgs.actionIdFlags);C.ULS.sendTraceTag(8765523,307,50,"PasteTeardown: {0} [{1}].",this.parentArgs.actionIdFlags,n),C.ULS.shipAssertTag(6305497,307,!!this.parentArgs.finalSelection),this.transaction.dispose();var r=this._workspace.get_activeView();if(!r.get_isInteractiveView())return!1;var i=r;return!!i.get_editingView().get_isContentEditableView()&&(i.get_editingView().tearDownForPasteAction(),!1)},e.prototype.shouldCopyWordIdDuringSplitAtEndOfParagraphOnPaste=function(t,n){if(!e.get_featureHelper())return!1;if(e.get_featureHelper().logUniqueFeatureUsage(39),!e.get_featureHelper().isFeatureEnabled(39))return!1;var r=new Da.GraphIterator;r.setFrom(t);var i=hs.OutlineElementNavigator.moveToContent(r),o=cs.ParagraphReader.isParagraphNode(i)&&n===cs.ParagraphReader.textLength(i);return C.ULS.sendTraceTag(50384992,307,50,"ShouldCopyWordIdDuringSplitAtEndParagraphOnPaste feature is enabled. isPasteAtEndofParagraph: {0}",o),o},e.prototype.splitLine=function(t){C.ULS.shipAssertTag(6305498,307,Pa.SelectionEditor.isInsertionPointContext(t));var n=Da.GraphIterator.createFromNode(t.get_node()),r=n.tryToRootAtOutlineAncestor();hs.OutlineElementNavigator.returnToOutlineElement(n);var i=t.get_node().get_type();C.ULS.sendTraceTag(40425481,307,50,"sourceOE GraphIterator setup. {0}",{tryToRootAtOutlineAncestorSuccess:r,ipContextNodeType:i,isValidIpContext:t.get_isValid()});var o=e.get_outlineElementEditor().insertOutlineElementBelow(n,!0),a=this.shouldCopyWordIdDuringSplitAtEndOfParagraphOnPaste(n,t.get_cpBegin());e.get_outlineElementEditor().splitAtIp(n,o,t,!1,!1,!0,a)},e.prototype.pastePlainText=function(t,n){C.ULS.shipAssertTag(6305500,307,t.get_contextId()===cl.V);var r=t.get_node();return n=n.replace(Jn.l.get__lineBreakRegExp()," "),e.get_characterPropertiesEditor().replaceTextRange(t,n),ss.SelectionFactory.createIpSelection(r,t.get_cpBegin()+n.length)},e.prototype.moveFromTitleToDocument=function(t){t.tryToRootAtPageContent(),e.get_pageNavigator().returnToPageContent(t);var n=e.get_pageReader().getOutlineCount(t),r=this.get_pageContentEditor().createOutline(t);return n?Yc.m(t.get_currentNode(),n+1,n+2):this.get_outlineEditor().setOutlineToDefaultPosition(r,Br.App.get_activeAppFrame().workspace.get_contentView().getViewWidth()),this.get_outlineEditor().insertOutlineElementAsChild(t,null,!0),ss.SelectionFactory.createCollapsedSelection(t.get_currentNode(),!0)},e.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=se.w.get_instance().resolve(Va.x))},e.get_hyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=se.w.get_instance().resolve(Ja.o))},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=se.w.get_instance().resolve(Es.p))},e.get_listSettings=function(){return e._listSettings||(e._listSettings=se.w.get_instance().tryResolve(xm.r))},e.get_featureHelper=function(){return e._featureHelper||(e._featureHelper=se.w.get_instance().tryResolve($p.d))},e._outlineEditor=null,e._featureHelper=null,e._outlineElementEditor=null,e._characterPropertiesEditor=null,e._hyperlinkEditor=null,e._listSettings=null,e}();(0,o.l)(km,"APasteExecutionManager",null,[]);var Dm=n(27),Mm=function(){function e(){this.actionIdFlags=0,this.foundDataCcpTimestampAttribute=!1,this.foundDataClipserviceCcpidAttribute=!1,this.foundDataShapeIdsAttribute=!1,this.foundGoogleDocsInternalGuidId=!1,this.foundOneNoteOnlineSequenceClass=!1,this.foundPowerPointOnlineSequenceClass=!1,this.foundWordOnlineSequenceClass=!1,this.progId=null,this.foundText=!1,this.foundEquation=!1,this.foundList=!1,this.foundTable=!1,this.foundImage=!1,this.pasteBrowser=0,this.pastedHtmlLength=0,this.platform=null,this.operationId=null,this._htmlTagStyleMap=null,this.copySourceBrowser=6,this._htmlTagStyleMap={}}return e.prototype.get_sourceApp=function(){if(this.foundWordOnlineSequenceClass)return"Word Online";if(this.foundGoogleDocsInternalGuidId)return"Google Docs";if(this.foundPowerPointOnlineSequenceClass||this.foundDataClipserviceCcpidAttribute||this.foundDataShapeIdsAttribute)return"PowerPoint Online";if(this.foundDataCcpTimestampAttribute)return"Excel Online";switch(this.progId){case"Word.Document":return"Word";case"OneNote.File":return"OneNote";case"Excel.Sheet":return"Excel";case"PowerPoint.Slide":return"PowerPoint"}return"Other"},e.prototype.logHtmlContentMetadata=function(){var e=this.buildHtmlContentMetadataDictForLogging();C.ULS.sendTraceTag(51406241,307,50,JSON.stringify(e))},e.prototype.logHtmlContentStyledata=function(){var e=this._htmlTagStyleMap;for(var t in e){var n={key:t,value:e[t]},r=n.value;r&&(r.SourceApp=this.get_sourceApp(),r.Browser=Dm.h[this.pasteBrowser],r.TagName=n.key,r.OperationId=this.operationId,C.ULS.sendTraceTag(51406242,307,50,JSON.stringify(r)))}},e.prototype.incrementStyleCountForTag=function(e,t){if(e&&e.length&&t&&t.length){e=e.toLowerCase(),t=t.toLowerCase(),e in this._htmlTagStyleMap||(this._htmlTagStyleMap[e]={});var n=this._htmlTagStyleMap[e],r=this.getStyleCountForTag(e,t);n[t]=r+1}},e.prototype.getStyleCountForTag=function(e,t){if(!(e&&e.length&&t&&t.length&&this._htmlTagStyleMap&&e in this._htmlTagStyleMap))return 0;e=e.toLowerCase(),t=t.toLowerCase();var n=this._htmlTagStyleMap[e];return n&&t in n?n[t]:0},e.prototype.buildHtmlContentMetadataDictForLogging=function(){var e={};return e.ActionIdFlags=this.actionIdFlags,e.FoundDataCcpTimestampAttribute=this.foundDataCcpTimestampAttribute,e.FoundDataClipserviceCcpidAttribute=this.foundDataClipserviceCcpidAttribute,e.FoundDataShapeIdsAttribute=this.foundDataShapeIdsAttribute,e.FoundGoogleDocsInternalGuidId=this.foundGoogleDocsInternalGuidId,e.FoundOneNoteOnlineSequenceClass=this.foundOneNoteOnlineSequenceClass,e.FoundPowerPointOnlineSequenceClass=this.foundPowerPointOnlineSequenceClass,e.FoundWordOnlineSequenceClass=this.foundWordOnlineSequenceClass,e.ProgId=this.progId,e.SourceApp=this.get_sourceApp(),e.FoundText=this.foundText,e.FoundEquation=this.foundEquation,e.FoundList=this.foundList,e.FoundTable=this.foundTable,e.FoundImage=this.foundImage,e.CopySourceBrowser=this.copySourceBrowser,e.PasteBrowser=this.pasteBrowser,e.IsSameBrowserPaste=this.isSameBrowserPaste(this.copySourceBrowser,this.pasteBrowser),e.IsCrossBrowserPaste=this.isCrossBrowserPaste(this.copySourceBrowser,this.pasteBrowser),e.IsUncategorizedBrowserPaste=this.isUncategorizedBrowserPaste(this.copySourceBrowser,this.pasteBrowser),e.Platform=this.platform,e.PastedHtmlLength=this.pastedHtmlLength,e.OperationId=this.operationId,e},e.prototype.isSameBrowserPaste=function(e,t){return 5!==e&&6!==e&&e===t},e.prototype.isCrossBrowserPaste=function(e,t){return 6!==e&&e!==t},e.prototype.isUncategorizedBrowserPaste=function(e,t){return 5===e&&5===t},e}();(0,o.l)(Mm,"HtmlContentMetadata",null,[]);var Rm=function(){function e(e,t,n){void 0===n&&(n=!1),this.domElement=null,this.htmlElementInfoFromHierarchy=null,this.applyAbsolutePosition=!1,this.domElement=e,this.htmlElementInfoFromHierarchy=t,this.applyAbsolutePosition=n}return e.prototype.get_domElement=function(){return this.domElement},e.prototype.get_htmlElementInfoFromHierarchy=function(){return this.htmlElementInfoFromHierarchy},e.prototype.get_applyAbsolutePosition=function(){return this.applyAbsolutePosition},e}();(0,o.l)(Rm,"TagEventParam",null,[]);var Lm=function(){function e(e,t){void 0===t&&(t=null),this._translator=null,this._voidElements=null,this._transparentTags=null,this._prunedElements=null,this._domElementHandlers=null,this.usageData=null,this._translator=e,this.set_usageData(t||T_.z.getHtmlProcessorUsageDataInstance("")),this.setUpTagDictionaries()}return e.prototype.get_usageData=function(){return this.usageData},e.prototype.set_usageData=function(e){return this.usageData=e,e},e.prototype.registerNewTag=function(e){e=Jn.l.toUpper(e),this._transparentTags[e]?delete this._transparentTags[e]:this._prunedElements[e]?delete this._prunedElements[e]:this._domElementHandlers[e]=o.i(this._translator,this._translator.onUnknownOpen,"onUnknownOpen")},e.prototype.notifyVoidElement=function(e,t,n,r){if(this._transparentTags[t])this.notifyTransparentElement();else{this.get_usageData().e++;var i=this._domElementHandlers[t];i&&i(new Rm(e,n,r)),this.get_usageData().b++}},e.prototype.notifyTransparentElement=function(){this.get_usageData().d++},e.prototype.notifyPrunedElement=function(){this.get_usageData().c++},e.prototype.notifyElementOpen=function(e,t,n,r){if(this._transparentTags[t])this.notifyTransparentElement();else{var i=this._domElementHandlers[t];if(i)return this.get_usageData().b++,i(new Rm(e,n,r));this.get_usageData().f++}return 2},e.prototype.setUpTagDictionaries=function(){this._voidElements=E.i("AREA",!0,"BASE",!0,"BASEFONT",!0,"BR",!0,"COL",!0,"FRAME",!0,"HR",!0,"IMG",!0,"INPUT",!0,"LINK",!0,"META",!0,"PARAM",!0),this._transparentTags=E.i("ABBR",!0,"ACRONYM",!0,"ADDRESS",!0,"BDO",!0,"BODY",!0,"BUTTON",!0,"FIELDSET",!0,"FORM",!0,"FRAMESET",!0,"HTML",!0,"NOFRAMES",!0,"NOSCRIPT",!0,"OPTGROUP",!0,"Q",!0,"SELECT",!0,"TEXTAREA",!0),this._prunedElements=E.i("APPLET",!0,"AREA",!0,"BASE",!0,"BASEFONT",!0,"FRAME",!0,"HEAD",!0,"IFRAME",!0,"INPUT",!0,"ISINDEX",!0,"LINK",!0,"MAP",!0,"META",!0,"OBJECT",!0,"PARAM",!0,"SCRIPT",!0,"STYLE",!0,"TITLE",!0),this._domElementHandlers=E.i("A",o.i(this._translator,this._translator.onAOpen,"onAOpen"),"ABBR",o.i(this._translator,this._translator.onAbbrOpen,"onAbbrOpen"),"ACRONYM",o.i(this._translator,this._translator.onAcronymOpen,"onAcronymOpen"),"ADDRESS",o.i(this._translator,this._translator.onAddressOpen,"onAddressOpen"),"APPLET",o.i(this._translator,this._translator.onAppletOpen,"onAppletOpen"),"AREA",o.i(this._translator,this._translator.onAreaTag,"onAreaTag"),"B",o.i(this._translator,this._translator.onBOpen,"onBOpen"),"BASE",o.i(this._translator,this._translator.onBaseTag,"onBaseTag"),"BASEFONT",o.i(this._translator,this._translator.onBasefontTag,"onBasefontTag"),"BDO",o.i(this._translator,this._translator.onBdoOpen,"onBdoOpen"),"BIG",o.i(this._translator,this._translator.onBigOpen,"onBigOpen"),"BLOCKQUOTE",o.i(this._translator,this._translator.onBlockquoteOpen,"onBlockquoteOpen"),"BODY",o.i(this._translator,this._translator.onBodyOpen,"onBodyOpen"),"BR",o.i(this._translator,this._translator.onBrTag,"onBrTag"),"BUTTON",o.i(this._translator,this._translator.onButtonOpen,"onButtonOpen"),"CAPTION",o.i(this._translator,this._translator.onCaptionOpen,"onCaptionOpen"),"CENTER",o.i(this._translator,this._translator.onCenterOpen,"onCenterOpen"),"CITE",o.i(this._translator,this._translator.onCiteOpen,"onCiteOpen"),"CODE",o.i(this._translator,this._translator.onCodeOpen,"onCodeOpen"),"COL",o.i(this._translator,this._translator.onColTag,"onColTag"),"COLGROUP",o.i(this._translator,this._translator.onColgroupOpen,"onColgroupOpen"),"DD",o.i(this._translator,this._translator.onDdOpen,"onDdOpen"),"DEL",o.i(this._translator,this._translator.onDelOpen,"onDelOpen"),"DFN",o.i(this._translator,this._translator.onDfnOpen,"onDfnOpen"),"DIR",o.i(this._translator,this._translator.onDirOpen,"onDirOpen"),"DIV",o.i(this._translator,this._translator.onDivOpen,"onDivOpen"),"DL",o.i(this._translator,this._translator.onDlOpen,"onDlOpen"),"DT",o.i(this._translator,this._translator.onDtOpen,"onDtOpen"),"EM",o.i(this._translator,this._translator.onEmOpen,"onEmOpen"),"FIELDSET",o.i(this._translator,this._translator.onFieldsetOpen,"onFieldsetOpen"),"FONT",o.i(this._translator,this._translator.onFontOpen,"onFontOpen"),"FORM",o.i(this._translator,this._translator.onFormOpen,"onFormOpen"),"FRAME",o.i(this._translator,this._translator.onFrameTag,"onFrameTag"),"FRAMESET",o.i(this._translator,this._translator.onFramesetOpen,"onFramesetOpen"),"H1",o.i(this._translator,this._translator.onH1Open,"onH1Open"),"H2",o.i(this._translator,this._translator.onH2Open,"onH2Open"),"H3",o.i(this._translator,this._translator.onH3Open,"onH3Open"),"H4",o.i(this._translator,this._translator.onH4Open,"onH4Open"),"H5",o.i(this._translator,this._translator.onH5Open,"onH5Open"),"H6",o.i(this._translator,this._translator.onH6Open,"onH6Open"),"HEAD",o.i(this._translator,this._translator.onHeadOpen,"onHeadOpen"),"HR",o.i(this._translator,this._translator.onHrTag,"onHrTag"),"HTML",o.i(this._translator,this._translator.onHtmlOpen,"onHtmlOpen"),"I",o.i(this._translator,this._translator.onIOpen,"onIOpen"),"IFRAME",o.i(this._translator,this._translator.onIframeOpen,"onIframeOpen"),"IMG",o.i(this._translator,this._translator.onImgTag,"onImgTag"),"INPUT",o.i(this._translator,this._translator.onInputTag,"onInputTag"),"INS",o.i(this._translator,this._translator.onInsOpen,"onInsOpen"),"ISINDEX",o.i(this._translator,this._translator.onIsindexOpen,"onIsindexOpen"),"KBD",o.i(this._translator,this._translator.onKbdOpen,"onKbdOpen"),"LABEL",o.i(this._translator,this._translator.onLabelOpen,"onLabelOpen"),"LEGEND",o.i(this._translator,this._translator.onLegendOpen,"onLegendOpen"),"LI",o.i(this._translator,this._translator.onLiOpen,"onLiOpen"),"LINK",o.i(this._translator,this._translator.onLinkTag,"onLinkTag"),"MAP",o.i(this._translator,this._translator.onMapOpen,"onMapOpen"),"MATH",o.i(this._translator,this._translator.onMathOpen,"onMathOpen"),"MENU",o.i(this._translator,this._translator.onMenuOpen,"onMenuOpen"),"META",o.i(this._translator,this._translator.onMetaTag,"onMetaTag"),"NOFRAMES",o.i(this._translator,this._translator.onNoframesOpen,"onNoframesOpen"),"NOSCRIPT",o.i(this._translator,this._translator.onNoscriptOpen,"onNoscriptOpen"),"OBJECT",o.i(this._translator,this._translator.onObjectOpen,"onObjectOpen"),"OL",o.i(this._translator,this._translator.onOlOpen,"onOlOpen"),"OPTGROUP",o.i(this._translator,this._translator.onOptgroupOpen,"onOptgroupOpen"),"OPTION",o.i(this._translator,this._translator.onOptionOpen,"onOptionOpen"),"P",o.i(this._translator,this._translator.onPOpen,"onPOpen"),"PARAM",o.i(this._translator,this._translator.onParamTag,"onParamTag"),"PRE",o.i(this._translator,this._translator.onPreOpen,"onPreOpen"),"Q",o.i(this._translator,this._translator.onQOpen,"onQOpen"),"S",o.i(this._translator,this._translator.onSOpen,"onSOpen"),"SAMP",o.i(this._translator,this._translator.onSampOpen,"onSampOpen"),"SCRIPT",o.i(this._translator,this._translator.onScriptOpen,"onScriptOpen"),"SELECT",o.i(this._translator,this._translator.onSelectOpen,"onSelectOpen"),"SMALL",o.i(this._translator,this._translator.onSmallOpen,"onSmallOpen"),"SPAN",o.i(this._translator,this._translator.onSpanOpen,"onSpanOpen"),"STRIKE",o.i(this._translator,this._translator.onStrikeOpen,"onStrikeOpen"),"STRONG",o.i(this._translator,this._translator.onStrongOpen,"onStrongOpen"),"STYLE",o.i(this._translator,this._translator.onStyleOpen,"onStyleOpen"),"SUB",o.i(this._translator,this._translator.onSubOpen,"onSubOpen"),"SUP",o.i(this._translator,this._translator.onSupOpen,"onSupOpen"),"TABLE",o.i(this._translator,this._translator.onTableOpen,"onTableOpen"),"TBODY",o.i(this._translator,this._translator.onTbodyOpen,"onTbodyOpen"),"TD",o.i(this._translator,this._translator.onTdOpen,"onTdOpen"),"TEXTAREA",o.i(this._translator,this._translator.onTextareaOpen,"onTextareaOpen"),"TFOOT",o.i(this._translator,this._translator.onTfootOpen,"onTfootOpen"),"TH",o.i(this._translator,this._translator.onThOpen,"onThOpen"),"THEAD",o.i(this._translator,this._translator.onTheadOpen,"onTheadOpen"),"TITLE",o.i(this._translator,this._translator.onTitleOpen,"onTitleOpen"),"TR",o.i(this._translator,this._translator.onTrOpen,"onTrOpen"),"TT",o.i(this._translator,this._translator.onTtOpen,"onTtOpen"),"U",o.i(this._translator,this._translator.onUOpen,"onUOpen"),"UL",o.i(this._translator,this._translator.onUlOpen,"onUlOpen"),"VAR",o.i(this._translator,this._translator.onVarOpen,"onVarOpen"))},e}();(0,o.l)(Lm,"AHtmlProcessor",null,[]);var Nm=function(){return function(e,t){this.childNodes=null,this.htmlElementInfoFromHierarchy=null,this.currentChildIndex=0,this.isCurrentChildClosing=!1,this.childNodes=e.childNodes,this.htmlElementInfoFromHierarchy=t,this.currentChildIndex=0,this.isCurrentChildClosing=!1}}();(0,o.l)(Nm,"HtmlProcessorArguments",null,[]);var Bm=function(e){function t(t,n){void 0===n&&(n=null);var r=e.call(this,t,n)||this;return r._isPasteTextFromWordWin32FixEnabled=null,r}return(0,S.t)(t,e),t.prototype.get_isPasteTextFromWordWin32FixEnabled=function(){return null==this._isPasteTextFromWordWin32FixEnabled&&(L.AFrameworkApplication.appSettingsManager?this._isPasteTextFromWordWin32FixEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CopyAndPasteTextFromWordWin32FixIsEnabled"):this._isPasteTextFromWordWin32FixEnabled=!1),this._isPasteTextFromWordWin32FixEnabled},t.prototype.process=function(e,t){void 0===t&&(t=null),e&&(this._translator.reset(),this.processChildren(new Nm(e,new Th(t_)),t))},t.prototype.processChildren=function(e,t){if(e.childNodes.length){var n=new A_.a(t,o.i(this,this.processChild,"processChild"),e);n.setDebugName("HTML Processing Operation"),t||n.set_isSynchronous(!0),n.run()}},t.prototype.processChild=function(e,n){var r=n,i=r.childNodes[r.currentChildIndex];if(i.nodeType===Ya.o.text)return this._translator.onBeforeNewElement(),this._translator.onText(i.nodeValue,new Rm(i,r.htmlElementInfoFromHierarchy.getCopy())),t.tryToMoveToNextSibling(r);if(i.nodeType!==Ya.o.element)return t.tryToMoveToNextSibling(r);if(!r.isCurrentChildClosing){var o=Jn.l.toUpper(i.tagName);if(t.hasBeenProcessed(i));else if(this._prunedElements[o])this.notifyPrunedElement();else{t.markAsAlreadyProcessed(i),this._translator.onBeforeNewElement();var a=i.id,s=i.tagName,l=r.htmlElementInfoFromHierarchy.getCopy(),c=i.getAttribute?i.getAttribute("class"):null,u=i.attributes?i.attributes.length:0,g=new t_(a,s,c||"",u);if(g.get_isValid()&&l.add(g),this._voidElements[o])return this.notifyVoidElement(i,o,l,!1),t.tryToMoveToNextSibling(r);var p=!1;switch(this.notifyElementOpen(i,o,l,!1)){case 1:p=!0;break;case 3:return t.tryToMoveToNextSibling(r)}switch(this._translator.handleCommonAttributes(i)){case 1:p=!0}if(r.isCurrentChildClosing=p,this.processChildren(new Nm(i,l),e),!e.get_isSynchronous())return!0}}if(r.isCurrentChildClosing){if(this.get_isPasteTextFromWordWin32FixEnabled()&&!this._domElementHandlers[Jn.l.toUpper(i.tagName)])return t.tryToMoveToNextSibling(r);this._translator.onClose()}return t.tryToMoveToNextSibling(r)},t.markAsAlreadyProcessed=function(e){e.nodeType!==Ya.o.text&&x_.v(e,"alreadyPasted",!0)},t.hasBeenProcessed=function(e){return e.nodeType!==Ya.o.text&&x_.j(e,"alreadyPasted")},t.tryToMoveToNextSibling=function(e){return e.currentChildIndex++,e.isCurrentChildClosing=!1,e.currentChildIndex<e.childNodes.length},t}(Lm);(0,o.l)(Bm,"HtmlProcessor",Lm,[]);var Om=function(){function e(){}return e.dataCcpTimestampAttribute="data-ccp-timestamp",e.dataClipserviceCcpidAttribute="data-clipservice-ccpid",e.dataShapeIdsAttribute="data-shapeids",e.googleDocsInternalGuidIdPrefix="docs-internal-guid-",e.oneNoteOnlineSequenceClassPrefix="SCXO",e.powerPointOnlineSequenceClassPrefix="SCXP",e.wordOnlineSequenceClassPrefix="SCXW",e.msoListFirstParagraphClass="MsoListParagraphCxSpFirst",e.msoListLastParagraphClass="MsoListParagraphCxSpLast",e}();(0,o.l)(Om,"HtmlContentMetadataConstants",null,[]);var Um=function(){function e(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),this._nextAcceptor=null,this._shouldParseStyleForHtmlTagEventIsEnabled=!1,this._shouldParseStyleForUncommonHtmlTagEventIsEnabled=!1,this._commonHtmlTagNamesContainer=null,this.usageData=null,this.contentMetadata=null,this._commonHtmlTagNames=["span","p","div","br","a","img","label","b","font","i","strong","u","em","h1","h2","h3","h4","h5","h6","table","tbody","td","tr","li","ol","ul"],this._nextAcceptor=e,this.usageData=t||T_.z.getHtmlEventUsageDataInstance(G.y.get_browserCodeForLogging(),""),this.contentMetadata=n,this._shouldParseStyleForHtmlTagEventIsEnabled=!!r&&r.getBooleanAppSetting("ParseStyleForHtmlTagEventIsEnabled"),this._shouldParseStyleForUncommonHtmlTagEventIsEnabled=!!r&&r.getBooleanAppSetting("ParseStyleForUncommonHtmlTagEventIsEnabled"),this._commonHtmlTagNamesContainer=new Z.e(String,ee.b.get_ordinalIgnoreCase());for(var i=0,o=this._commonHtmlTagNames;i<o.length;i++){var a=o[i];this._commonHtmlTagNamesContainer.add(a)}}return e.prototype.get_usageData=function(){return this.usageData},e.prototype.get_contentMetadata=function(){return this.contentMetadata},e.prototype.increment=function(e){return e?e+1:1},e.prototype.reset=function(){this._nextAcceptor.reset()},e.prototype.onBeforeNewElement=function(){this._nextAcceptor.onBeforeNewElement()},e.prototype.handleCommonAttributes=function(e){if(e&&this.get_contentMetadata()&&(e.getAttribute&&(e.getAttribute(Om.dataCcpTimestampAttribute)&&(this.get_contentMetadata().foundDataCcpTimestampAttribute=!0),e.getAttribute(Om.dataClipserviceCcpidAttribute)&&(this.get_contentMetadata().foundDataClipserviceCcpidAttribute=!0),e.getAttribute(Om.dataShapeIdsAttribute)&&(this.get_contentMetadata().foundDataShapeIdsAttribute=!0)),e.id&&e.id.startsWith&&e.id.startsWith(Om.googleDocsInternalGuidIdPrefix)&&(this.get_contentMetadata().foundGoogleDocsInternalGuidId=!0),e.className&&e.className.split))for(var t=0,n=e.className.split(" ");t<n.length;t++){var r=n[t];if(r.startsWith(Om.oneNoteOnlineSequenceClassPrefix)&&(this.get_contentMetadata().foundOneNoteOnlineSequenceClass=!0),r.startsWith(Om.powerPointOnlineSequenceClassPrefix)&&(this.get_contentMetadata().foundPowerPointOnlineSequenceClass=!0),r.startsWith(Om.wordOnlineSequenceClassPrefix)&&(this.get_contentMetadata().foundWordOnlineSequenceClass=!0),r.startsWith(G.y.browserCodePrefix)&&r.length===G.y.browserCodePrefix.length+1){var i=parseInt(Jn.l.substring(r,r.length-1,r.length));isNaN(i)||(this.get_contentMetadata().copySourceBrowser=i)}r!==Om.msoListFirstParagraphClass&&r!==Om.msoListLastParagraphClass||(this.get_contentMetadata().foundList=!0)}return this._nextAcceptor.handleCommonAttributes(e)},e.prototype.onClose=function(){this._nextAcceptor.onClose()},e.prototype.onText=function(e,t){this.get_contentMetadata()&&(this.get_contentMetadata().foundText=!0),this.get_usageData().d=this.increment(this.get_usageData().d),this._nextAcceptor.onText(e,t)},e.prototype.onAOpen=function(e){return this.get_usageData().e=this.increment(this.get_usageData().e),this.parseStyleUsageForTag(e),this._nextAcceptor.onAOpen(e)},e.prototype.onAbbrOpen=function(e){return this.get_usageData().f=this.increment(this.get_usageData().f),this.parseStyleUsageForTag(e),this._nextAcceptor.onAbbrOpen(e)},e.prototype.onAcronymOpen=function(e){return this.get_usageData().g=this.increment(this.get_usageData().g),this.parseStyleUsageForTag(e),this._nextAcceptor.onAcronymOpen(e)},e.prototype.onAddressOpen=function(e){return this.get_usageData().h=this.increment(this.get_usageData().h),this.parseStyleUsageForTag(e),this._nextAcceptor.onAddressOpen(e)},e.prototype.onAppletOpen=function(e){return this.get_usageData().i=this.increment(this.get_usageData().i),this.parseStyleUsageForTag(e),this._nextAcceptor.onAppletOpen(e)},e.prototype.onAreaTag=function(e){this.get_usageData().j=this.increment(this.get_usageData().j),this.parseStyleUsageForTag(e),this._nextAcceptor.onAreaTag(e)},e.prototype.onBOpen=function(e){return this.get_usageData().k=this.increment(this.get_usageData().k),this.parseStyleUsageForTag(e),this._nextAcceptor.onBOpen(e)},e.prototype.onBaseTag=function(e){this.get_usageData().l=this.increment(this.get_usageData().l),this.parseStyleUsageForTag(e),this._nextAcceptor.onBaseTag(e)},e.prototype.onBasefontTag=function(e){this.get_usageData().m=this.increment(this.get_usageData().m),this.parseStyleUsageForTag(e),this._nextAcceptor.onBasefontTag(e)},e.prototype.onBdoOpen=function(e){return this.get_usageData().n=this.increment(this.get_usageData().n),this.parseStyleUsageForTag(e),this._nextAcceptor.onBdoOpen(e)},e.prototype.onBigOpen=function(e){return this.get_usageData().o=this.increment(this.get_usageData().o),this.parseStyleUsageForTag(e),this._nextAcceptor.onBigOpen(e)},e.prototype.onBlockquoteOpen=function(e){return this.get_usageData().p=this.increment(this.get_usageData().p),this.parseStyleUsageForTag(e),this._nextAcceptor.onBlockquoteOpen(e)},e.prototype.onBodyOpen=function(e){return this.get_usageData().q=this.increment(this.get_usageData().q),this.parseStyleUsageForTag(e),this._nextAcceptor.onBodyOpen(e)},e.prototype.onBrTag=function(e){this.get_usageData().r=this.increment(this.get_usageData().r),this.parseStyleUsageForTag(e),this._nextAcceptor.onBrTag(e)},e.prototype.onButtonOpen=function(e){return this.get_usageData().s=this.increment(this.get_usageData().s),this.parseStyleUsageForTag(e),this._nextAcceptor.onButtonOpen(e)},e.prototype.onCaptionOpen=function(e){return this.get_usageData().t=this.increment(this.get_usageData().t),this.parseStyleUsageForTag(e),this._nextAcceptor.onCaptionOpen(e)},e.prototype.onCenterOpen=function(e){return this.get_usageData().u=this.increment(this.get_usageData().u),this.parseStyleUsageForTag(e),this._nextAcceptor.onCenterOpen(e)},e.prototype.onCiteOpen=function(e){return this.get_usageData().v=this.increment(this.get_usageData().v),this.parseStyleUsageForTag(e),this._nextAcceptor.onCiteOpen(e)},e.prototype.onCodeOpen=function(e){return this.get_usageData().w=this.increment(this.get_usageData().w),this.parseStyleUsageForTag(e),this._nextAcceptor.onCodeOpen(e)},e.prototype.onColTag=function(e){this.get_usageData().x=this.increment(this.get_usageData().x),this.parseStyleUsageForTag(e),this._nextAcceptor.onColTag(e)},e.prototype.onColgroupOpen=function(e){return this.get_usageData().y=this.increment(this.get_usageData().y),this.parseStyleUsageForTag(e),this._nextAcceptor.onColgroupOpen(e)},e.prototype.onDdOpen=function(e){return this.get_usageData().z=this.increment(this.get_usageData().z),this.parseStyleUsageForTag(e),this._nextAcceptor.onDdOpen(e)},e.prototype.onDelOpen=function(e){return this.get_usageData().ba=this.increment(this.get_usageData().ba),this.parseStyleUsageForTag(e),this._nextAcceptor.onDelOpen(e)},e.prototype.onDfnOpen=function(e){return this.get_usageData().bb=this.increment(this.get_usageData().bb),this.parseStyleUsageForTag(e),this._nextAcceptor.onDfnOpen(e)},e.prototype.onDirOpen=function(e){return this.get_usageData().bc=this.increment(this.get_usageData().bc),this.parseStyleUsageForTag(e),this._nextAcceptor.onDirOpen(e)},e.prototype.onDivOpen=function(e){return this.get_usageData().bd=this.increment(this.get_usageData().bd),this.parseStyleUsageForTag(e),this._nextAcceptor.onDivOpen(e)},e.prototype.onDlOpen=function(e){return this.get_usageData().be=this.increment(this.get_usageData().be),this.parseStyleUsageForTag(e),this._nextAcceptor.onDlOpen(e)},e.prototype.onDtOpen=function(e){return this.get_usageData().bf=this.increment(this.get_usageData().bf),this.parseStyleUsageForTag(e),this._nextAcceptor.onDtOpen(e)},e.prototype.onEmOpen=function(e){return this.get_usageData().bg=this.increment(this.get_usageData().bg),this.parseStyleUsageForTag(e),this._nextAcceptor.onEmOpen(e)},e.prototype.onFieldsetOpen=function(e){return this.get_usageData().bh=this.increment(this.get_usageData().bh),this.parseStyleUsageForTag(e),this._nextAcceptor.onFieldsetOpen(e)},e.prototype.onFontOpen=function(e){return this.get_usageData().bi=this.increment(this.get_usageData().bi),this.parseStyleUsageForTag(e),this._nextAcceptor.onFontOpen(e)},e.prototype.onFormOpen=function(e){return this.get_usageData().bj=this.increment(this.get_usageData().bj),this.parseStyleUsageForTag(e),this._nextAcceptor.onFormOpen(e)},e.prototype.onFrameTag=function(e){this.get_usageData().bk=this.increment(this.get_usageData().bk),this.parseStyleUsageForTag(e),this._nextAcceptor.onFrameTag(e)},e.prototype.onFramesetOpen=function(e){return this.get_usageData().bl=this.increment(this.get_usageData().bl),this.parseStyleUsageForTag(e),this._nextAcceptor.onFramesetOpen(e)},e.prototype.onH1Open=function(e){return this.get_usageData().bm=this.increment(this.get_usageData().bm),this.parseStyleUsageForTag(e),this._nextAcceptor.onH1Open(e)},e.prototype.onH2Open=function(e){return this.get_usageData().bm=this.increment(this.get_usageData().bm),this.parseStyleUsageForTag(e),this._nextAcceptor.onH2Open(e)},e.prototype.onH3Open=function(e){return this.get_usageData().bm=this.increment(this.get_usageData().bm),this.parseStyleUsageForTag(e),this._nextAcceptor.onH3Open(e)},e.prototype.onH4Open=function(e){return this.get_usageData().bm=this.increment(this.get_usageData().bm),this.parseStyleUsageForTag(e),this._nextAcceptor.onH4Open(e)},e.prototype.onH5Open=function(e){return this.get_usageData().bm=this.increment(this.get_usageData().bm),this.parseStyleUsageForTag(e),this._nextAcceptor.onH5Open(e)},e.prototype.onH6Open=function(e){return this.get_usageData().bm=this.increment(this.get_usageData().bm),this.parseStyleUsageForTag(e),this._nextAcceptor.onH6Open(e)},e.prototype.onHeadOpen=function(e){return this.get_usageData().bn=this.increment(this.get_usageData().bn),this._nextAcceptor.onHeadOpen(e)},e.prototype.onHrTag=function(e){this.get_usageData().bo=this.increment(this.get_usageData().bo),this.parseStyleUsageForTag(e),this._nextAcceptor.onHrTag(e)},e.prototype.onHtmlOpen=function(e){return this.get_usageData().bp=this.increment(this.get_usageData().bp),this._nextAcceptor.onHtmlOpen(e)},e.prototype.onIOpen=function(e){return this.get_usageData().bq=this.increment(this.get_usageData().bq),this.parseStyleUsageForTag(e),this._nextAcceptor.onIOpen(e)},e.prototype.onIframeOpen=function(e){return this.get_usageData().br=this.increment(this.get_usageData().br),this.parseStyleUsageForTag(e),this._nextAcceptor.onIframeOpen(e)},e.prototype.onImgTag=function(e){this.get_contentMetadata()&&(this.get_contentMetadata().foundImage=!0),this.parseStyleUsageForTag(e),this.get_usageData().bs=this.increment(this.get_usageData().bs),this._nextAcceptor.onImgTag(e)},e.prototype.onInputTag=function(e){this.get_usageData().bt=this.increment(this.get_usageData().bt),this.parseStyleUsageForTag(e),this._nextAcceptor.onInputTag(e)},e.prototype.onInsOpen=function(e){return this.get_usageData().bu=this.increment(this.get_usageData().bu),this.parseStyleUsageForTag(e),this._nextAcceptor.onInsOpen(e)},e.prototype.onIsindexOpen=function(e){return this.get_usageData().bv=this.increment(this.get_usageData().bv),this.parseStyleUsageForTag(e),this._nextAcceptor.onIsindexOpen(e)},e.prototype.onKbdOpen=function(e){return this.get_usageData().bw=this.increment(this.get_usageData().bw),this.parseStyleUsageForTag(e),this._nextAcceptor.onKbdOpen(e)},e.prototype.onLabelOpen=function(e){return this.get_usageData().bx=this.increment(this.get_usageData().bx),this.parseStyleUsageForTag(e),this._nextAcceptor.onLabelOpen(e)},e.prototype.onLegendOpen=function(e){return this.get_usageData().by=this.increment(this.get_usageData().by),this.parseStyleUsageForTag(e),this._nextAcceptor.onLegendOpen(e)},e.prototype.onLiOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundList=!0),this.get_usageData().bz=this.increment(this.get_usageData().bz),this.parseStyleUsageForTag(e),this._nextAcceptor.onLiOpen(e)},e.prototype.onLinkTag=function(e){this.get_usageData().ca=this.increment(this.get_usageData().ca),this.parseStyleUsageForTag(e),this._nextAcceptor.onLinkTag(e)},e.prototype.onMapOpen=function(e){return this.get_usageData().cb=this.increment(this.get_usageData().cb),this.parseStyleUsageForTag(e),this._nextAcceptor.onMapOpen(e)},e.prototype.onMathOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundEquation=!0),this.get_usageData().cc=this.increment(this.get_usageData().cc),this.parseStyleUsageForTag(e),this._nextAcceptor.onMathOpen(e)},e.prototype.onMenuOpen=function(e){return this.get_usageData().cd=this.increment(this.get_usageData().cd),this.parseStyleUsageForTag(e),this._nextAcceptor.onMenuOpen(e)},e.prototype.onMetaTag=function(e){this.get_usageData().ce=this.increment(this.get_usageData().ce),this._nextAcceptor.onMetaTag(e)},e.prototype.onNoframesOpen=function(e){return this.get_usageData().cf=this.increment(this.get_usageData().cf),this.parseStyleUsageForTag(e),this._nextAcceptor.onNoframesOpen(e)},e.prototype.onNoscriptOpen=function(e){return this.get_usageData().cg=this.increment(this.get_usageData().cg),this.parseStyleUsageForTag(e),this._nextAcceptor.onNoscriptOpen(e)},e.prototype.onObjectOpen=function(e){return this.get_usageData().ch=this.increment(this.get_usageData().ch),this.parseStyleUsageForTag(e),this._nextAcceptor.onObjectOpen(e)},e.prototype.onOlOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundList=!0),this.get_usageData().ci=this.increment(this.get_usageData().ci),this.parseStyleUsageForTag(e),this._nextAcceptor.onOlOpen(e)},e.prototype.onOptgroupOpen=function(e){return this.get_usageData().cj=this.increment(this.get_usageData().cj),this.parseStyleUsageForTag(e),this._nextAcceptor.onOptgroupOpen(e)},e.prototype.onOptionOpen=function(e){return this.get_usageData().ck=this.increment(this.get_usageData().ck),this.parseStyleUsageForTag(e),this._nextAcceptor.onOptionOpen(e)},e.prototype.onPOpen=function(e){return this.get_usageData().cl=this.increment(this.get_usageData().cl),this.parseStyleUsageForTag(e),this._nextAcceptor.onPOpen(e)},e.prototype.onParamTag=function(e){this.get_usageData().cm=this.increment(this.get_usageData().cm),this.parseStyleUsageForTag(e),this._nextAcceptor.onParamTag(e)},e.prototype.onPreOpen=function(e){return this.get_usageData().cn=this.increment(this.get_usageData().cn),this.parseStyleUsageForTag(e),this._nextAcceptor.onPreOpen(e)},e.prototype.onQOpen=function(e){return this.get_usageData().co=this.increment(this.get_usageData().co),this.parseStyleUsageForTag(e),this._nextAcceptor.onQOpen(e)},e.prototype.onSOpen=function(e){return this.get_usageData().cp=this.increment(this.get_usageData().cp),this.parseStyleUsageForTag(e),this._nextAcceptor.onSOpen(e)},e.prototype.onSampOpen=function(e){return this.get_usageData().cq=this.increment(this.get_usageData().cq),this.parseStyleUsageForTag(e),this._nextAcceptor.onSampOpen(e)},e.prototype.onScriptOpen=function(e){return this.get_usageData().cr=this.increment(this.get_usageData().cr),this._nextAcceptor.onScriptOpen(e)},e.prototype.onSelectOpen=function(e){return this.get_usageData().cs=this.increment(this.get_usageData().cs),this.parseStyleUsageForTag(e),this._nextAcceptor.onSelectOpen(e)},e.prototype.onSmallOpen=function(e){return this.get_usageData().ct=this.increment(this.get_usageData().ct),this.parseStyleUsageForTag(e),this._nextAcceptor.onSmallOpen(e)},e.prototype.onSpanOpen=function(e){return this.get_usageData().cu=this.increment(this.get_usageData().cu),this.parseStyleUsageForTag(e),this._nextAcceptor.onSpanOpen(e)},e.prototype.onStrikeOpen=function(e){return this.get_usageData().cv=this.increment(this.get_usageData().cv),this.parseStyleUsageForTag(e),this._nextAcceptor.onStrikeOpen(e)},e.prototype.onStrongOpen=function(e){return this.get_usageData().cw=this.increment(this.get_usageData().cw),this.parseStyleUsageForTag(e),this._nextAcceptor.onStrongOpen(e)},e.prototype.onStyleOpen=function(e){return this.get_usageData().cx=this.increment(this.get_usageData().cx),this._nextAcceptor.onStyleOpen(e)},e.prototype.onSubOpen=function(e){return this.get_usageData().cy=this.increment(this.get_usageData().cy),this.parseStyleUsageForTag(e),this._nextAcceptor.onSubOpen(e)},e.prototype.onSupOpen=function(e){return this.get_usageData().cz=this.increment(this.get_usageData().cz),this.parseStyleUsageForTag(e),this._nextAcceptor.onSupOpen(e)},e.prototype.onTableOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().da=this.increment(this.get_usageData().da),this.parseStyleUsageForTag(e),this._nextAcceptor.onTableOpen(e)},e.prototype.onTbodyOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().db=this.increment(this.get_usageData().db),this.parseStyleUsageForTag(e),this._nextAcceptor.onTbodyOpen(e)},e.prototype.onTdOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().dc=this.increment(this.get_usageData().dc),this.parseStyleUsageForTag(e),this._nextAcceptor.onTdOpen(e)},e.prototype.onTextareaOpen=function(e){return this.get_usageData().dd=this.increment(this.get_usageData().dd),this.parseStyleUsageForTag(e),this._nextAcceptor.onTextareaOpen(e)},e.prototype.onTfootOpen=function(e){return this.get_usageData().de=this.increment(this.get_usageData().de),this.parseStyleUsageForTag(e),this._nextAcceptor.onTfootOpen(e)},e.prototype.onThOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().df=this.increment(this.get_usageData().df),this.parseStyleUsageForTag(e),this._nextAcceptor.onThOpen(e)},e.prototype.onTheadOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().dg=this.increment(this.get_usageData().dg),this.parseStyleUsageForTag(e),this._nextAcceptor.onTheadOpen(e)},e.prototype.onTitleOpen=function(e){return this.get_usageData().dh=this.increment(this.get_usageData().dh),this.parseStyleUsageForTag(e),this._nextAcceptor.onTitleOpen(e)},e.prototype.onTrOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundTable=!0),this.get_usageData().di=this.increment(this.get_usageData().di),this.parseStyleUsageForTag(e),this._nextAcceptor.onTrOpen(e)},e.prototype.onTtOpen=function(e){return this.get_usageData().dj=this.increment(this.get_usageData().dj),this.parseStyleUsageForTag(e),this._nextAcceptor.onTtOpen(e)},e.prototype.onUOpen=function(e){return this.get_usageData().dk=this.increment(this.get_usageData().dk),this.parseStyleUsageForTag(e),this._nextAcceptor.onUOpen(e)},e.prototype.onUlOpen=function(e){return this.get_contentMetadata()&&(this.get_contentMetadata().foundList=!0),this.get_usageData().dl=this.increment(this.get_usageData().dl),this.parseStyleUsageForTag(e),this._nextAcceptor.onUlOpen(e)},e.prototype.onVarOpen=function(e){return this.get_usageData().dm=this.increment(this.get_usageData().dm),this.parseStyleUsageForTag(e),this._nextAcceptor.onVarOpen(e)},e.prototype.onUnknownOpen=function(e){return this.get_usageData().dn=this.increment(this.get_usageData().dn),this._nextAcceptor.onUnknownOpen(e)},e.prototype.parseStyleUsageForTag=function(e){var t=e.get_domElement();if(t&&this.get_contentMetadata()){var n=t.tagName.toLowerCase();if(this._shouldParseStyleForHtmlTagEventIsEnabled&&this.isCommonHtmlTags(n)||this._shouldParseStyleForUncommonHtmlTagEventIsEnabled&&!this.isCommonHtmlTags(n)){if("font"===n&&this.parseStyleUsageForFontTagAttributes(e),!t.style)return;var r=t.style;if(!r)return;for(var i=0,o=r;i<o.length;i++){var a=o[i];a&&a.length>0&&this.get_contentMetadata().incrementStyleCountForTag(t.tagName,a)}}}},e.prototype.parseStyleUsageForFontTagAttributes=function(e){var t=e.get_domElement();if(t&&"font"===t.tagName.toLowerCase()&&this.get_contentMetadata()){var n=t.getAttribute("face");n&&n.length>0&&this.get_contentMetadata().incrementStyleCountForTag(t.tagName,"font-attr-face");var r=t.getAttribute("color");r&&r.length>0&&this.get_contentMetadata().incrementStyleCountForTag(t.tagName,"font-attr-color");var i=t.getAttribute("size");i&&i.length>0&&this.get_contentMetadata().incrementStyleCountForTag(t.tagName,"font-attr-size")}},e.prototype.isCommonHtmlTags=function(e){return this._commonHtmlTagNamesContainer.contains(e)},e}();(0,o.l)(Um,"HtmlEventUsageCollector",null,[Zh]);var Hm=n(519),Gm=n(7732),Vm=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._nextAcceptor=null,this.usageData=null,this.tableUsageData=null,this._nextAcceptor=e,this.usageData=t||T_.z.getSemanticEventsUsageDataInstance(""),this.tableUsageData=n||T_.z.getSemanticTableEventsUsageDataInstance("")}return e.prototype.get_usageData=function(){return this.usageData},e.prototype.get_tableUsageData=function(){return this.tableUsageData},e.prototype.onTableStart=function(e){this.get_tableUsageData().b++,this._nextAcceptor.onTableStart(e)},e.prototype.onTableEnd=function(){this._nextAcceptor.onTableEnd()},e.prototype.onTableRowStart=function(e){this.get_tableUsageData().c++,this._nextAcceptor.onTableRowStart(e)},e.prototype.onTableRowEnd=function(){this._nextAcceptor.onTableRowEnd()},e.prototype.onTableCellStart=function(e){this.get_tableUsageData().d++,this._nextAcceptor.onTableCellStart(e)},e.prototype.onTableCellEnd=function(){this._nextAcceptor.onTableCellEnd()},e.prototype.onTablePartStart=function(e){this.get_tableUsageData().e++,this._nextAcceptor.onTablePartStart(e)},e.prototype.onTablePartEnd=function(){this._nextAcceptor.onTablePartEnd()},e.prototype.reset=function(){this._nextAcceptor.reset()},e.prototype.get_defaultFormatting=function(){return this._nextAcceptor.get_defaultFormatting()},e.prototype.onText=function(e,t){this.get_usageData().b++,this._nextAcceptor.onText(e,t)},e.prototype.onLineBreak=function(e){this.get_usageData().c++,this._nextAcceptor.onLineBreak(e)},e.prototype.onTab=function(e){this.get_usageData().b++,this._nextAcceptor.onTab(e)},e.prototype.onImage=function(e){this.get_usageData().d++,this._nextAcceptor.onImage(e)},e.prototype.onFile=function(e){this.get_usageData().e++,this._nextAcceptor.onFile(e)},e.prototype.onFormattingChange=function(e){this.get_usageData().f++,this._nextAcceptor.onFormattingChange(e)},e.prototype.onAnchorStart=function(e,t){this.get_usageData().g++,this._nextAcceptor.onAnchorStart(e,t)},e.prototype.onAnchorEnd=function(){this._nextAcceptor.onAnchorEnd()},e.prototype.onParagraphStart=function(e){this.get_usageData().h++,this._nextAcceptor.onParagraphStart(e)},e.prototype.onParagraphEnd=function(){this._nextAcceptor.onParagraphEnd()},e.prototype.onPreFormattedTextStart=function(){this._nextAcceptor.onPreFormattedTextStart()},e.prototype.onPreFormattedTextEnd=function(){this._nextAcceptor.onPreFormattedTextEnd()},e.prototype.onMathStart=function(e,t){this.get_usageData().i++,this._nextAcceptor.onMathStart(e,t)},e.prototype.onMathEnd=function(){this._nextAcceptor.onMathEnd()},e.prototype.onListStart=function(e){this.get_usageData().j++,this._nextAcceptor.onListStart(e)},e.prototype.onListEnd=function(){this._nextAcceptor.onListEnd()},e.prototype.onListItemStart=function(e){this.get_usageData().k++,this._nextAcceptor.onListItemStart(e)},e.prototype.onListItemEnd=function(){this._nextAcceptor.onListItemEnd()},e.prototype.onRenderAugmentation=function(e){this.get_usageData().l++,this._nextAcceptor.onRenderAugmentation(e)},e.prototype.onSpanStart=function(){this.get_usageData().m++,this._nextAcceptor.onSpanStart()},e.prototype.onSpanEnd=function(){this._nextAcceptor.onSpanEnd()},e}();(0,o.l)(Vm,"SemanticEventUsageCollector",null,[Hm.m,Gm.p]);var Wm=function(){function e(e){this.steward=null,this.steward=e}return e.prototype.reset=function(){this.steward.reset()},e.prototype.get_defaultFormatting=function(){return this.steward.get_defaultFormatting()},e.prototype.onText=function(e,t){this.steward.onText(e,t)},e.prototype.onLineBreak=function(e){this.steward.onLineBreak(e)},e.prototype.onTab=function(e){this.steward.onTab(e)},e.prototype.onImage=function(e){this.steward.onImage(e)},e.prototype.onFile=function(e){this.steward.onFile(e)},e.prototype.onFormattingChange=function(e){this.steward.onFormattingChange(e)},e.prototype.onAnchorStart=function(e,t){this.steward.onAnchorStart(e,t)},e.prototype.onAnchorEnd=function(){this.steward.onAnchorEnd()},e.prototype.onParagraphStart=function(e){this.steward.onParagraphStart(e)},e.prototype.onParagraphEnd=function(){this.steward.onParagraphEnd()},e.prototype.onPreFormattedTextStart=function(){this.steward.onPreFormattedTextStart()},e.prototype.onPreFormattedTextEnd=function(){this.steward.onPreFormattedTextEnd()},e.prototype.onListStart=function(e){this.steward.onListStart(e)},e.prototype.onListEnd=function(){this.steward.onListEnd()},e.prototype.onListItemStart=function(e){this.steward.onListItemStart(e)},e.prototype.onListItemEnd=function(){this.steward.onListItemEnd()},e.prototype.onRenderAugmentation=function(e){this.steward.onRenderAugmentation(e)},e.prototype.onSpanStart=function(){this.steward.onSpanStart()},e.prototype.onSpanEnd=function(){this.steward.onSpanEnd()},e.prototype.onTableStart=function(e){this.steward.onTableStart(e)},e.prototype.onTableEnd=function(){this.steward.onTableEnd()},e.prototype.onTableRowStart=function(e){this.steward.onTableRowStart(e)},e.prototype.onTableRowEnd=function(){this.steward.onTableRowEnd()},e.prototype.onTableCellStart=function(e){this.steward.onTableCellStart(e)},e.prototype.onTableCellEnd=function(){this.steward.onTableCellEnd()},e.prototype.onTablePartStart=function(e){this.steward.onTablePartStart(e)},e.prototype.onTablePartEnd=function(){this.steward.onTablePartEnd()},e.prototype.onMathStart=function(e,t){this.steward.onMathStart(e,t)},e.prototype.onMathEnd=function(){this.steward.onMathEnd()},e}();(0,o.l)(Wm,"AHtmlNormalizer",null,[Hm.m,Gm.p]);var zm=function(e){function t(t){var n=e.call(this,t)||this;return n.queueMode=!1,n}return(0,S.t)(t,e),t.prototype.onText=function(e,t){var n=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){n.processText(e,t)})):this.processText(e,t)},t.prototype.processText=function(e,t){this.steward.onText(e,t)},t.prototype.onLineBreak=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processLineBreak(e)})):this.processLineBreak(e)},t.prototype.processLineBreak=function(e){this.steward.onLineBreak(e)},t.prototype.onImage=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processImage(e)})):this.processImage(e)},t.prototype.processImage=function(e){this.steward.onImage(e)},t.prototype.onFile=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processFile(e)})):this.processFile(e)},t.prototype.processFile=function(e){this.steward.onFile(e)},t.prototype.onFormattingChange=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processFormattingChange(e)})):this.processFormattingChange(e)},t.prototype.processFormattingChange=function(e){this.steward.onFormattingChange(e)},t.prototype.onAnchorStart=function(e,t){var n=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){n.processAnchorStart(e,t)})):this.processAnchorStart(e,t)},t.prototype.processAnchorStart=function(e,t){this.steward.onAnchorStart(e,t)},t.prototype.onAnchorEnd=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processAnchorEnd,"processAnchorEnd")):this.processAnchorEnd()},t.prototype.processAnchorEnd=function(){this.steward.onAnchorEnd()},t.prototype.onParagraphStart=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processParagraphStart(e)})):this.processParagraphStart(e)},t.prototype.processParagraphStart=function(e){this.steward.onParagraphStart(e)},t.prototype.onParagraphEnd=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processParagraphEnd,"processParagraphEnd")):this.processParagraphEnd()},t.prototype.processParagraphEnd=function(){this.steward.onParagraphEnd()},t.prototype.onPreFormattedTextStart=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processPreFormattedTextStart,"processPreFormattedTextStart")):this.processPreFormattedTextStart()},t.prototype.processPreFormattedTextStart=function(){this.steward.onPreFormattedTextStart()},t.prototype.onPreFormattedTextEnd=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processPreFormattedTextEnd,"processPreFormattedTextEnd")):this.processPreFormattedTextEnd()},t.prototype.processPreFormattedTextEnd=function(){this.steward.onPreFormattedTextEnd()},t.prototype.onListStart=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processListStart(e)})):this.processListStart(e)},t.prototype.processListStart=function(e){this.steward.onListStart(e)},t.prototype.onListEnd=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processListEnd,"processListEnd")):this.processListEnd()},t.prototype.processListEnd=function(){this.steward.onListEnd()},t.prototype.onListItemStart=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processListItemStart(e)})):this.processListItemStart(e)},t.prototype.processListItemStart=function(e){this.steward.onListItemStart(e)},t.prototype.onListItemEnd=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processListItemEnd,"processListItemEnd")):this.processListItemEnd()},t.prototype.processListItemEnd=function(){this.steward.onListItemEnd()},t.prototype.onTableStart=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processTableStart(e)})):this.processTableStart(e)},t.prototype.processTableStart=function(e){this.steward.onTableStart(e)},t.prototype.onTableEnd=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processTableEnd,"processTableEnd")):this.processTableEnd()},t.prototype.processTableEnd=function(){this.steward.onTableEnd()},t.prototype.onTableRowStart=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processTableRowStart(e)})):this.processTableRowStart(e)},t.prototype.processTableRowStart=function(e){this.steward.onTableRowStart(e)},t.prototype.onTableRowEnd=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processTableRowEnd,"processTableRowEnd")):this.processTableRowEnd()},t.prototype.processTableRowEnd=function(){this.steward.onTableRowEnd()},t.prototype.onTableCellStart=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processTableCellStart(e)})):this.processTableCellStart(e)},t.prototype.processTableCellStart=function(e){this.steward.onTableCellStart(e)},t.prototype.onTableCellEnd=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processTableCellEnd,"processTableCellEnd")):this.processTableCellEnd()},t.prototype.processTableCellEnd=function(){this.steward.onTableCellEnd()},t.prototype.onTablePartStart=function(e){var t=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){t.processTablePartStart(e)})):this.processTablePartStart(e)},t.prototype.processTablePartStart=function(e){this.steward.onTablePartStart(e)},t.prototype.onTablePartEnd=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processTablePartEnd,"processTablePartEnd")):this.processTablePartEnd()},t.prototype.processTablePartEnd=function(){this.steward.onTablePartEnd()},t.prototype.onMathStart=function(e,t){var n=this;this.queueMode?this.get_queueManager().enqueueEvent((function(){n.processMathStart(e,t)})):this.processMathStart(e,t)},t.prototype.processMathStart=function(e,t){this.steward.onMathStart(e,t)},t.prototype.onMathEnd=function(){this.queueMode?this.get_queueManager().enqueueEvent(o.i(this,this.processMathEnd,"processMathEnd")):this.processMathEnd()},t.prototype.processMathEnd=function(){this.steward.onMathEnd()},t}(Wm);(0,o.l)(zm,"AQueuingHtmlNormalizer",Wm,[]);var Km=function(){function e(t){this.next=null,o.m(this,e.$$(t)),this.data=o.c(o.f(this,"Box3.QueueNode$1").TNode)}return e.$$=function(t){var n="QueueNode$1$"+t.getName(),r=o.x(n);return r||o.u(n,"Box3.QueueNode$1",e,[{TNode:t}],null,[])},e}(),qm=function(){function e(t){this._back=null,this._front=null,this._count=0,o.m(this,e.$$(t)),this._back=null,this._front=null,this._count=0}return e.prototype.get_count=function(){return this._count},e.prototype.get_isEmpty=function(){return!this._count||!this._back||!this._front},e.prototype.enqueue=function(e){var t=new Km(o.f(this,"Box3.Queue$1").T);t.data=e,this.get_isEmpty()?(this._back=t,this._front=t):(this._back.next=t,this._back=t),this._count++},e.prototype.front=function(){return this.get_isEmpty()?null:this._front.data},e.prototype.back=function(){return this.get_isEmpty()?null:this._back.data},e.prototype.dequeue=function(){if(this.get_isEmpty())return null;var e=this._front;return this._front=e.next,this._count--,this._front||(this._back=null),e.data},e.prototype.clear=function(){this._back=null,this._front=null,this._count=0},e.prototype.toArray=function(){for(var e=new Array(this.get_count()),t=this._front,n=0;n<this.get_count()&&t;n++)e[n]=t.data,t=t.next;return e},e.$$=function(t){var n="Queue$1$"+t.getName(),r=o.x(n);return r||o.u(n,"Box3.Queue$1",e,[{T:t}],null,[])},e}(),jm=function(){function e(){this._queuedEvents=null,this._queuedEvents=new qm(Object)}return e.prototype.get_isQueueEmpty=function(){return this._queuedEvents.get_isEmpty()},e.prototype.enqueueEvent=function(e){this._queuedEvents.enqueue(e)},e.prototype.flush=function(e){for(void 0===e&&(e=!1),e&&this.setContextAsWhenEnqueuing();!this._queuedEvents.get_isEmpty();){this._queuedEvents.dequeue()()}e&&this.resetContextAfterFlushing()},e.prototype.setContextAsWhenEnqueuing=function(){},e.prototype.resetContextAfterFlushing=function(){},e}();(0,o.l)(jm,"QueuedEventManager",null,[]);var $m=function(e){function t(t){var n=e.call(this)||this;return n._normalizer=null,n.currentParagraphArgs=null,n.isInsideParagraph=!1,n.paragraphText="",n.isPreformattedText=!1,n.isInsideHyperlink=!1,n.currentHref=null,n.currentHrefGlobalAttributes=null,n.nestedListCount=0,n.isUnderImpliedList=!1,n.isUnderListItem=!1,n.isListItemEmpty=!1,n.table=null,n.nestedOrphanedTableCellCount=0,n._normalizer=t,n}return(0,S.t)(t,e),t.prototype.get_amidstTableStructure=function(){return!!this.table},t.prototype.setContextAsWhenEnqueuing=function(){this._normalizer.outerContentStates.push(this._normalizer.currentState),this._normalizer.currentState=this},t.prototype.resetContextAfterFlushing=function(){this._normalizer.currentState=this._normalizer.outerContentStates.pop()},t}(jm);(0,o.l)($m,"ContentState",jm,[]);var Qm=function(){return function(e,t,n){this.colSpan=0,this.rowSpan=0,this.width=0,this.isSkipCell=!1,this.height=0,this.isRelativeWidth=!1,this.shadingColor=null,this.verticalAlignment=0,this.globalAttributesOnCell=null,this.contents=null,this.tableCellBorderProperties=null,this.tableCellMarginProperties=null,this.cellLook=0,this.colSpan=e.colSpan,this.rowSpan=e.rowSpan,this.width=e.width,this.height=e.height,this.isRelativeWidth=e.isRelativeWidth,this.shadingColor=e.shadingColor,this.verticalAlignment=e.verticalAlignment,this.tableCellBorderProperties=e.tableCellBorderProperties,this.tableCellMarginProperties=e.tableCellMarginProperties,this.isSkipCell=e.isSkipCell,this.cellLook=e.cellLook,this.contents=n,this.globalAttributesOnCell=t}}();(0,o.l)(Qm,"TableCell$0",null,[]);var Jm=function(e){function t(t,n){var r=e.call(this)||this;return r._normalizer=null,r._columns=null,r._globalAttributesArgs=null,r._currentRowIdx=0,r._tableRowsGlobalAttributesArgs=null,r._currentColIdx=0,r._isBorderHidden=!1,r._isBorderCollapsed=!1,r._tableBorderProperties=null,r._width=0,r._isRelativeWidth=!1,r._indentationProperties=null,r._tableLook=0,r._tableStyleId=null,r._mergedCellExtensionBoundaries=null,r._rowHeights=null,r._normalizer=t,r._tableRowsGlobalAttributesArgs=new Th(y_),r._columns=new Th(Array),r._mergedCellExtensionBoundaries=new Array(0),r._rowHeights=new Array(0),r._currentRowIdx=-1,r._currentColIdx=0,r._isBorderHidden=n.isBorderHidden,r._isBorderCollapsed=n.isBorderCollapsed,r._tableBorderProperties=n.tableBorderProperties,r._width=n.width,r._isRelativeWidth=n.isRelativeWidth,r._globalAttributesArgs=new vh(new t_(n.get_ownerHtmlElementInfo().get_htmlIdentifier(),n.get_ownerHtmlElementInfo().get_htmlElementType()),n.get_htmlElementInfoFromHierarchy(),n.ownerNoteTagInfo,n.get_cultureName(),n.absolutePosition),r._indentationProperties=n.indentationProperties,r._tableStyleId=n.styleId,r._tableLook=n.tableLook,r}return(0,S.t)(t,e),t.prototype.get_steward=function(){return this._normalizer.steward},t.prototype.prepareToNormalizeNextRow=function(e){this._currentRowIdx++,this._tableRowsGlobalAttributesArgs.add(e),this._rowHeights[this._currentRowIdx]=e.height,this._currentColIdx=0},t.prototype.get_currentColumn=function(){for(;this._currentColIdx>=this._columns.get_count();)this._columns.add(new Array(this._currentRowIdx+1));return this._columns.get_item(this._currentColIdx)},t.prototype.addCell=function(e,t,n,r,i,o,a){if(this._currentRowIdx<0)return!1;for(;this._mergedCellExtensionBoundaries[this._currentColIdx]>=this._currentRowIdx;)this._currentColIdx++;var s=new Qm(e,new vh(t,n,r,i,o),a);if(this.get_currentColumn()[this._currentRowIdx]=s,s.rowSpan>1)for(var l=this._currentRowIdx+s.rowSpan-1,c=this._currentColIdx,u=this._currentColIdx+s.colSpan-1,g=c;g<=u;g++)this._mergedCellExtensionBoundaries[g]>=l||(this._mergedCellExtensionBoundaries[g]=l);return this._currentColIdx+=s.colSpan,this._rowHeights[this._currentRowIdx]<s.height&&(this._rowHeights[this._currentRowIdx]=s.height),!0},t.prototype.setContextAsWhenEnqueuing=function(){this._normalizer.currentState.table=this},t.prototype.resetContextAfterFlushing=function(){this._normalizer.currentState.table=null},t.prototype.flushTable=function(){this.flush(!0);for(var e=this._currentRowIdx+1,t=new Array(e),n=0;n<e;n++)t[n]=new Array(this._columns.get_count());for(var r=!0,i=0,o=0;o<this._columns.get_count();o++){var a=this._columns.get_item(o),s=!0;for(n=0;n<e;n++){var l=a[n];l&&(s=!1,t[n][o+i]=new f_(l.colSpan,l.rowSpan,l.width,l.height,void 0,void 0,void 0,void 0,l.isRelativeWidth,l.isSkipCell))}s?(this._columns.removeAt(o),o--,++i):r=!1}if(!r){var c=null;(c=this._isRelativeWidth?this._normalizer.calculateTableWidths(t,this._width/100):this._normalizer.calculateTableWidths(t))&&c.length!==this._columns.get_count()&&(c=null),this._normalizer.ensureCurrentContentEnded(!0),this._normalizer.closeExpiredImpliedList(),this.get_steward().onTableStart(new C_(e,this._columns.get_count(),this._width,this._isRelativeWidth,c,this._isBorderHidden,this._isBorderCollapsed,this._tableBorderProperties,this._indentationProperties,this._tableStyleId,this._tableLook,this._globalAttributesArgs));for(n=0;n<e;n++){var u=this._tableRowsGlobalAttributesArgs.get_item(n),g=this._rowHeights[n];this.get_steward().onTableRowStart(new y_(g,new vh(u.get_ownerHtmlElementInfo(),u.get_htmlElementInfoFromHierarchy(),u.ownerNoteTagInfo,u.get_cultureName(),u.absolutePosition)));for(o=0;o<this._columns.get_count();o++){var p=this._columns.get_item(o)[n],d=!!this._tableStyleId&&""!==this._tableStyleId&&"Custom"!==this._tableStyleId,h=p?p.colSpan:0,_=p?p.rowSpan:0,m=p?p.width:0,f=p?p.height:0,y=p?p.cellLook:0,C=!!p&&p.isRelativeWidth,S=p&&(65536&y||!d)?p.shadingColor:"",v=p?p.verticalAlignment:0,b=!!p&&p.isSkipCell,T=p?this._normalizer.getNormalizedTableCellBorder(p.tableCellBorderProperties,o,n,this._columns,this._isBorderCollapsed,d,p.cellLook):new c_,A=p?p.tableCellMarginProperties:new u_,I=p?p.globalAttributesOnCell:null,w=I?I.get_ownerHtmlElementInfo():null,x=I?I.get_htmlElementInfoFromHierarchy():null,F=I?I.ownerNoteTagInfo:null,E=I?I.get_cultureName():null,P=I?I.absolutePosition:null;this.get_steward().onTableCellStart(new f_(h,_,m,f,S,v,T,A,C,b,y,new vh(w,x,F,E,P))),p&&!p.isSkipCell&&(p.contents.setContextAsWhenEnqueuing(),p.contents.flush(),this._normalizer.ensureCurrentContentEnded(!1),this._normalizer.closeExpiredImpliedList(),p.contents.resetContextAfterFlushing()),this.get_steward().onTableCellEnd()}this.get_steward().onTableRowEnd()}this.get_steward().onTableEnd(),this._normalizer.currentState.isListItemEmpty=!1,this._normalizer.ensureOutsideListItem(!1)}},t}(jm);(0,o.l)(Jm,"NormalizedTable",jm,[]);var Xm=function(){function e(e,t){void 0===e&&(e=!1),void 0===t&&(t=!1),this._isInlineTabInsertionEnabled=!1,this._splitHyperlinkFixWithEnterIsEnabled=!1,this._isInlineTabInsertionEnabled=e,this._splitHyperlinkFixWithEnterIsEnabled=t}return e.prototype.get_isInlineTabInsertionEnabled=function(){return this._isInlineTabInsertionEnabled},e.prototype.get_splitHyperlinkFixWithEnterIsEnabled=function(){return this._splitHyperlinkFixWithEnterIsEnabled},e}();(0,o.l)(Xm,"HtmlNormalizerSettings",null,[Xd]);var Ym=function(e){function t(t,n){void 0===n&&(n=null);var r=e.call(this,t)||this;return r.currentState=null,r._htmlNormalizerSettings=null,r.outerContentStates=null,r.outerContentStates=new r_($m),r._htmlNormalizerSettings=n||new Xm,r}return(0,S.t)(t,e),t.prototype.reset=function(){e.prototype.reset.call(this),this.currentState=new $m(this),this.outerContentStates.clear(),this.queueMode=!1},t.prototype.get_queueManager=function(){return this.currentState&&this.currentState.get_amidstTableStructure()?this.currentState.table:this.currentState},t.prototype.ensureReadyForText=function(e){void 0===e&&(e=!1),this.currentState.isInsideParagraph||(this.closeExpiredImpliedList(),this.steward.onParagraphStart(this.currentState.currentParagraphArgs),this.currentState.isInsideParagraph=!0,this.currentState.isListItemEmpty=!1),e||!this.currentState.currentHref||this.currentState.isInsideHyperlink||(this.steward.onAnchorStart(this.currentState.currentHref,this.currentState.currentHrefGlobalAttributes),this.currentState.isInsideHyperlink=!0)},t.prototype.ensureOutsideHyperlink=function(){this.currentState.isInsideHyperlink&&(this.steward.onAnchorEnd(),this.currentState.isInsideHyperlink=!1)},t.prototype.ensureOutsideParagraph=function(){this.currentState.isInsideParagraph&&(this.steward.onParagraphEnd(),this.currentState.isInsideParagraph=!1,this.currentState.paragraphText="")},t.prototype.ensureOutsideListItem=function(e){this.currentState.isUnderListItem&&(this.currentState.isListItemEmpty?e||(this.steward.onParagraphStart(null),this.steward.onParagraphEnd(),this.steward.onListItemEnd(),this.currentState.isUnderListItem=!1):(this.steward.onListItemEnd(),this.currentState.isUnderListItem=!1,this.currentState.isListItemEmpty=!0))},t.prototype.ensureCurrentContentEnded=function(e,t){void 0===t&&(t=!1),t&&!this.currentState.isInsideParagraph||(this.ensureOutsideHyperlink(),this.ensureOutsideParagraph(),this.ensureOutsideListItem(e))},t.prototype.openNewImpliedList=function(e){this.steward.onListStart(new m_(2,1,e)),this.currentState.nestedListCount++,this.currentState.isUnderImpliedList=!0},t.prototype.closeExpiredImpliedList=function(){!this.currentState.isUnderListItem&&this.currentState.isUnderImpliedList&&(this.steward.onListEnd(),this.currentState.nestedListCount--,this.currentState.isUnderImpliedList=!1)},t.prototype.processText=function(e,n){if(""!==(e=this.normalizeWhiteSpaces(e)))if(this.ensureReadyForText(),this.currentState.isPreformattedText)this.processTextInternal(e,n);else{for(var r=e.split(t.c_tab),i=0;i<r.length-1;i++)this.processTextInternal(r[i],n),this.steward.onTab(n);this.processTextInternal(r[r.length-1],n)}},t.prototype.processMathStart=function(e,t){""!==e&&(this.ensureReadyForText(),this.steward.onMathStart(e,t))},t.prototype.processLineBreak=function(e){this._htmlNormalizerSettings.get_splitHyperlinkFixWithEnterIsEnabled()||this.ensureOutsideHyperlink(),this.ensureReadyForText(!0),this.steward.onLineBreak(e)},t.prototype.processFormattingChange=function(e){this.currentState.get_amidstTableStructure()||this.steward.onFormattingChange(e)},t.prototype.processImage=function(t){this.currentState.currentHref&&(t.href=this.currentState.currentHref),e.prototype.processImage.call(this,t)},t.prototype.processAnchorStart=function(e,t){this.ensureOutsideHyperlink(),this.currentState.currentHref=e,this.currentState.currentHrefGlobalAttributes=t},t.prototype.processAnchorEnd=function(){this.ensureOutsideHyperlink(),this.currentState.currentHref=null,this.currentState.currentHrefGlobalAttributes=null},t.prototype.processParagraphStart=function(e){this.currentState.currentParagraphArgs=e,this.ensureCurrentContentEnded(!0)},t.prototype.processParagraphEnd=function(){this.currentState.currentParagraphArgs=null,this.ensureCurrentContentEnded(!0)},t.prototype.processPreFormattedTextStart=function(){this.currentState.isPreformattedText=!0},t.prototype.processPreFormattedTextEnd=function(){this.currentState.isPreformattedText=!1},t.prototype.processListStart=function(e){this.ensureCurrentContentEnded(!1),this.closeExpiredImpliedList(),this.steward.onListStart(e),this.currentState.nestedListCount++},t.prototype.processListEnd=function(){this.ensureCurrentContentEnded(!1),this.steward.onListEnd(),this.currentState.nestedListCount--},t.prototype.processListItemStart=function(e){this.ensureCurrentContentEnded(!1),this.currentState.nestedListCount||this.openNewImpliedList(e),this.steward.onListItemStart(e),this.currentState.isUnderListItem=!0,this.currentState.isListItemEmpty=!0},t.prototype.processListItemEnd=function(){this.ensureCurrentContentEnded(!1)},t.prototype.onTableStart=function(e){this.currentState.get_amidstTableStructure()||(this.queueMode=!0,this.currentState.table=new Jm(this,e))},t.prototype.processTableStart=function(e){},t.prototype.onTableEnd=function(){if(this.currentState.table){var e=this.currentState.table;this.currentState.table=null,this.outerContentStates.get_isEmpty()?(this.queueMode=!1,e.flushTable()):this.get_queueManager().enqueueEvent(o.i(e,e.flushTable,"flushTable"))}},t.prototype.processTableEnd=function(){},t.prototype.onTableRowStart=function(e){this.currentState.get_amidstTableStructure()&&this.currentState.table.prepareToNormalizeNextRow(e)},t.prototype.processTableRowStart=function(e){},t.prototype.onTableRowEnd=function(){},t.prototype.processTableRowEnd=function(){},t.prototype.onTableCellStart=function(e){var t=!1;if(this.currentState.get_amidstTableStructure()){var n=new $m(this);this.currentState.table.addCell(e,new t_(e.get_ownerHtmlElementInfo().get_htmlIdentifier(),e.get_ownerHtmlElementInfo().get_htmlElementType()),e.get_htmlElementInfoFromHierarchy(),e.ownerNoteTagInfo,e.get_cultureName(),e.absolutePosition,n)?(this.outerContentStates.push(this.currentState),this.currentState=n):t=!0}else t=!0;t&&this.currentState.nestedOrphanedTableCellCount++},t.prototype.processTableCellStart=function(e){},t.prototype.onTableCellEnd=function(){this.currentState.nestedOrphanedTableCellCount>0?this.currentState.nestedOrphanedTableCellCount--:this.currentState=this.outerContentStates.pop()},t.prototype.processTableCellEnd=function(){},t.prototype.calculateTableWidths=function(e,t){if(void 0===t&&(t=1),!e)return null;var n=e.length;if(!n)return null;for(var r=e[0].length,i=1;i<n;i++)if(e[i].length!==r)return null;var o=new Array(r+1);o[0]=0;for(var a=new Array(r+1),s=0;s<a.length;s++)a[s]=!1;var l=new y.c(Number);for(s=0;s<r;s++){for(i=0;i<n;i++)if(e[i][s]&&e[i][s].width>0){var c=Math.min(s+e[i][s].colSpan,r);o[c]=o[s]+e[i][s].width*(e[i][s].isRelativeWidth?t:1),a[c]=!0}if(a[s+1]){var u=o[s+1]-o[s];if(u<=0)return null;l.add(u)}else o[s+1]=o[s]}return l.toArray()},t.prototype.markTableStyleBorders=function(e,t){return 1&t||(e.borderTopStyle=12),16&t||(e.borderRightStyle=12),256&t||(e.borderBottomStyle=12),4096&t||(e.borderLeftStyle=12),e},t.prototype.getNormalizedTableCellBorder=function(e,t,n,r,i,o,a){if(!e)return null;if(o&&(e=this.markTableStyleBorders(e,a)),n<0||t<0||t>r.get_count()-1)return e;var s;t-1>=0&&n<=r.get_item(t-1).length-1&&1===e.borderLeftStyle&&((s=r.get_item(t-1)[n])&&1!==s.tableCellBorderProperties.borderRightStyle&&(e.borderLeftStyle=s.tableCellBorderProperties.borderRightStyle,e.borderLeftColor=s.tableCellBorderProperties.borderRightColor,e.borderLeftWidth=s.tableCellBorderProperties.borderRightWidth));n-1>=0&&n<=r.get_item(t).length-1&&1===e.borderTopStyle&&((s=r.get_item(t)[n-1])&&1!==s.tableCellBorderProperties.borderBottomStyle&&(e.borderTopStyle=s.tableCellBorderProperties.borderBottomStyle,e.borderTopColor=s.tableCellBorderProperties.borderBottomColor,e.borderTopWidth=s.tableCellBorderProperties.borderBottomWidth));return e},t.prototype.normalizeWhiteSpaces=function(e){return this.currentState.isPreformattedText||(e=this._htmlNormalizerSettings.get_isInlineTabInsertionEnabled()?e.replace(t.htmlWhiteSpaceRegExpRetainTabs," "):e.replace(t.htmlWhiteSpaceRegExp," ")),e.startsWith(" ")&&(this.currentState.paragraphText.endsWith(" ")||""===this.currentState.paragraphText)&&(e=Jn.l.substring(e,1,e.length)),e},t.prototype.processTextInternal=function(e,t){""!==e&&(this.steward.onText(e,t),this.currentState.paragraphText+=e)},t.htmlWhiteSpaceRegExp=new RegExp("[ \t\f\u200b\r\n]+","g"),t.htmlWhiteSpaceRegExpRetainTabs=new RegExp("[ \f\u200b\r\n]+","g"),t.c_tab="\t",t}(zm);(0,o.l)(Ym,"DefaultHtmlNormalizer",zm,[]);var Zm=function(e){function t(t,n,r){var i=e.call(this,t,r)||this;return i._imageSteward=null,i._haveShownAnonymousEditingDialog=!1,i._imageSteward=n,i}return(0,S.t)(t,e),t.prototype.processImage=function(e){if(this._imageSteward.get_picturePasteIsEnabled())if(L.AFrameworkApplication.limitedEdit){if(!this._haveShownAnonymousEditingDialog){var t=new ar.StandardDialog;t.set_buttonsOption(0),t.setButtonText(1,CommonUIStrings.l_DialogClose),t.messageBox(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_SignInToPasteImages,1,null),this._haveShownAnonymousEditingDialog=!0}}else this._imageSteward.get_maxPicturesReached()?this._imageSteward.set_maxPicturesExceeded(!0):e.src&&""!==e.src?tt.n.getOrigin(e.src)!==tt.n.getOrigin(window.location.href)?e.src.startsWith("data:")&&e.src.length>19922944?L.AFrameworkApplication.get_theActionManager().processAction(ii.SD,2):e.src.startsWith("webkit-fake-url")?L.AFrameworkApplication.get_theActionManager().processAction(ii.tP,2):(us.n.get_instance().get_item(1)?this.ensureCurrentContentEnded(!1):us.n.get_instance().get_item(11)&&(this.ensureOutsideHyperlink(),this.ensureReadyForText(!0)),this.steward.onImage(e)):L.AFrameworkApplication.get_theActionManager().processAction(ii.Tq,2):L.AFrameworkApplication.get_theActionManager().processAction(ii.Td,2)},t}(Ym);(0,o.l)(Zm,"Box4HtmlNormalizer",Ym,[]);var ef=function(){return function(e,t,n,r,i,o,a,s,l,c){this.htmlProcessor=null,this.imageSteward=null,this.wordConverterUsageData=null,this.formattingStewardUsageData=null,this.semanticEventsUsageData=null,this.semanticTableEventsUsageData=null,this.htmlContentMetadata=null,this.htmlEventsUsageData=null,this.htmlProcessorUsageData=null,this.listUsageData=null,this.htmlProcessor=e,this.imageSteward=t,this.wordConverterUsageData=n,this.formattingStewardUsageData=r,this.semanticEventsUsageData=i,this.semanticTableEventsUsageData=o,this.htmlContentMetadata=a,this.htmlEventsUsageData=s,this.htmlProcessorUsageData=l,this.listUsageData=c}}();(0,o.l)(ef,"ExecutePasteArguments",null,[]);var tf=function(e){return 8192&e?1:0},nf=function(e){function t(t,n,r,i,o,a,s,l,c,u,g,p,d,h){var _=e.call(this,n,r,i,u,p)||this;return _._pastedHtmlContainer=null,_._importIterator=null,_._box4PasteStewardFactory=null,_._imageStewardFactory=null,_._tableStewardFactory=null,_._wordConverterFactory=null,_._htmlNormalizerSettings=null,_._htmlTranslatorSettings=null,_._htmlTranslatorContext=null,_._externalPasteCssConverter=null,_._appSettingsManager=null,_._shouldGatherMetadataAboutPastedHtmlContent=!1,_._shouldConvertStyleDomToInlineStyle=!1,_._pastedHtmlContainer=t,_._box4PasteStewardFactory=o,_._imageStewardFactory=a,_._tableStewardFactory=s,_._wordConverterFactory=l,_._htmlTranslatorSettings=c,_._htmlNormalizerSettings=h,_._appSettingsManager=g,_._htmlTranslatorContext=(0,O.m)(new d_,{isCopiedFromSameApp:2===_.parentArgs.copySource||3===_.parentArgs.copySource}),_._externalPasteCssConverter=d,_._shouldGatherMetadataAboutPastedHtmlContent=g.getBooleanAppSetting("GatherMetadataAboutExternalPastedHTMLContentIsEnabled"),_._shouldConvertStyleDomToInlineStyle=g.getBooleanAppSetting("ParseStyleFromRawHtmlHeadIsEnabled"),_}return(0,S.t)(t,e),t.prototype.get_nothingToPaste=function(){return!1},t.prototype.get_isContentSingleParagraph=function(){return!Jn.l.testGlobal(Jn.l.get__lineBreakRegExp(),this._pastedHtmlContainer.innerText)},t.prototype.get_contentAsText=function(){return this._pastedHtmlContainer.innerText},t.prototype.executePaste=function(e){this._importIterator=new Da.GraphIterator,this.precedingNodeRef.restore(this._importIterator),C.ULS.shipAssertTag(6305550,307,Ls.OutlineElementReader.isOutlineElement(this._importIterator)),this.parentArgs.operationTelemetry&&this.parentArgs.operationTelemetry.appendOperationFlag("external");var t=tf(this.parentArgs.actionIdFlags),n=this._imageStewardFactory.get_value().create(t,this._importIterator),r=this._tableStewardFactory.get_value().create(t,this._importIterator),i=T_.z.getWordConverterUsageDataInstance(L.AFrameworkApplication.userSessionId),a=T_.z.getFormattingStewardUsageDataInstance(G.y.get_browserCodeForLogging(),this.parentArgs.clipboardOperationId),s=T_.z.getSemanticEventsUsageDataInstance(L.AFrameworkApplication.userSessionId),l=T_.z.getSemanticTableEventsUsageDataInstance(L.AFrameworkApplication.userSessionId),c=this._shouldGatherMetadataAboutPastedHtmlContent?this.initializeHtmlContentMetadataInstance():null,u=T_.z.getHtmlEventUsageDataInstance(G.y.get_browserCodeForLogging(),this.parentArgs.clipboardOperationId),g=T_.z.getHtmlProcessorUsageDataInstance(L.AFrameworkApplication.userSessionId),p=this._htmlTranslatorSettings.get_shouldGetListLevelForEachListItem()?T_.z.getListUsageDataInstance(L.AFrameworkApplication.userSessionId):null,d=this._box4PasteStewardFactory.get_value().create(t,this._importIterator,n,r,null,a),h=new Vm(d,s,l),_=new Zm(h,n,this._htmlNormalizerSettings),m=new b_(_,this._htmlTranslatorSettings,this._htmlTranslatorContext,p),f=new Um(m,u,c,this._appSettingsManager),y=new Bm(f,g),S=new ef(y,n,i,a,s,l,c,u,g,p),v=new A_.a(e,o.i(this,this.preprocessStyle,"preprocessStyle"),S);v.setDebugName("paste and request pictures"),v.set_isSynchronous(!e||e.get_isSynchronous()),v.run()},t.prototype.preprocessStyle=function(e,t){if(this._shouldConvertStyleDomToInlineStyle){var n=this._pastedHtmlContainer.getElementsByTagName("style");if(n&&n.length>0){C.ULS.sendTraceTag(41211203,307,50,"Detect <style> tags in pasted content and start converting to inline style.");for(var r=0;r<n.length;r++)this._externalPasteCssConverter.convertStyleDomToInlineStyle(this._pastedHtmlContainer,n[r]),n[r]&&(n[r].parentNode.removeChild(n[r]),r--)}}return e.changeStepCallback(o.i(this,this.convertWordListHtml,"convertWordListHtml")),!0},t.prototype.convertWordListHtml=function(e,t){var n=t;return this._wordConverterFactory.get_value().create(n.wordConverterUsageData).process(this._pastedHtmlContainer,e),e.changeStepCallback(o.i(this,this.processHtml,"processHtml")),!0},t.prototype.processHtml=function(e,t){var n,r=t;return r.htmlProcessor.process(this._pastedHtmlContainer,e),n=r.imageSteward&&r.imageSteward.get_picturePasteIsEnabled()?o.i(this,this.requestImages,"requestImages"):o.i(this,this.endPasteOperation,"endPasteOperation"),e.changeStepCallback(n),!0},t.prototype.requestImages=function(e,t){var n=t.imageSteward;if(n){var r=!1,i=!1,a=!1,s=!1,l=-1,c=new Kl.DictionaryPropertySet,u=new RegExp('imagedata\\s+src="file:.*AppData\\/Local\\/Temp');if(o.r(U_.d,this.parentArgs.actionData)){r=this.parentArgs.actionData.getValueWithDefault(Boolean,ks.j.isImageFromPaste,!1);var g=this.parentArgs.actionData.getValueWithDefault(String,zl.k.pastedHtmlContent,"");a=this.parentArgs.actionData.getValueWithDefault(Boolean,zl.k.isImageInsertion,!1),s=this.parentArgs.actionData.getValueWithDefault(Boolean,Kc.b.isLayoutSizeSetByUser,!1),u.test(g)&&(i=!0),this.get_shouldGetPasteConstrainingWidth()&&(l=this.parentArgs.actionData.getValueWithDefault(Number,Oh.p.editContainerWidth,-1))}else 256&this.parentArgs.actionIdFlags&&this._pastedHtmlContainer&&(r=!0,u.test(this._pastedHtmlContainer.innerHTML)&&(i=!0));c.setValue(ks.j.isImageFromPaste,r),c.setValue(zl.k.isUploadingImageCanFailedEarly,i),c.setValue(zl.k.isImageInsertion,a),c.setValue(Oh.p.editContainerWidth,l),c.setValue(Kc.b.isLayoutSizeSetByUser,s),n.setImageProperties(c),n.onPasteCompletion(),n.get_numPicturesPasted()&&(this.parentArgs.isIncrementalAction=!0,this.parentArgs.incrementalActionId=n.get_desiredRevisionId(),this.parentArgs.numberOfIncrements=n.get_numPicturesPasted(),L.AFrameworkApplication.get_theActionManager().processAction(ii.PS,2))}return e.changeStepCallback(o.i(this,this.endPasteOperation,"endPasteOperation")),!0},t.prototype.endPasteOperation=function(e,t){var n=t;T_.z.logWordConverterUsageData(n.wordConverterUsageData),T_.z.logHtmlProcessorUsageData(n.htmlProcessorUsageData),T_.z.logSemanticEventsUsageData(n.semanticEventsUsageData),T_.z.logSemanticTableEventsUsageData(n.semanticTableEventsUsageData),T_.z.logListUsageData(n.listUsageData);var r="Others";return n.htmlContentMetadata&&(n.htmlContentMetadata.logHtmlContentMetadata(),n.htmlContentMetadata.logHtmlContentStyledata(),r=n.htmlContentMetadata.get_sourceApp()),T_.z.logHtmlEventsUsageData(n.htmlEventsUsageData,r),T_.z.logFormattingStewardUsageData(n.formattingStewardUsageData,r),!1},t.prototype.initializeHtmlContentMetadataInstance=function(){var e=new Mm;return e.pasteBrowser=G.y.get_browserCodeForLogging(),this.parentArgs&&(e.actionIdFlags=this.parentArgs.actionIdFlags,e.operationId=this.parentArgs.clipboardOperationId,this.parentArgs.actionData&&(e.progId=this.parentArgs.actionData.getValueWithDefault(String,zl.k.pastedHtmlProdId,""))),this._pastedHtmlContainer&&this._pastedHtmlContainer.innerHTML&&(e.pastedHtmlLength=this._pastedHtmlContainer.innerHTML.length),L.AFrameworkApplication.sessionStartInfoSettings&&(e.platform=L.AFrameworkApplication.sessionStartInfoSettings.Platform),e},t.prototype.get_shouldMergePastedListIntoList=function(){return!0},t.prototype.get_shouldMergeAfterContent=function(){if(C.ULS.shipAssertTag(6305551,307,!!this._importIterator),this._htmlTranslatorSettings.get_shouldGetParagraphProperties()(this._htmlTranslatorContext)){var e=!1;Ls.OutlineElementReader.isOutlineElement(this._importIterator)&&(this._importIterator.goToLastChild(),e=!0);var t=cs.ParagraphReader.isParagraph(this._importIterator)&&!this._importIterator.get_currentNode().getValueWithDefault(Boolean,zl.k.isEopFromCopy,!1);return e&&this._importIterator.returnToParent(),t}return cs.ParagraphReader.isParagraph(this._importIterator)},t}(km);(0,o.l)(nf,"ExternalPasteExecutionManager",km,[]);var rf=function(){function e(e,t,n,r,i,o,a,s,l){this._box4PasteStewardFactory=null,this._imageStewardFactory=null,this._tableStewardFactory=null,this._wordConverterFactory=null,this._htmlTranslatorSettings=null,this._contentControlCopyPasteHelper=null,this._appSettingsManager=null,this._externalPasteCssConverter=null,this._htmlNormalizerSettings=null,this._box4PasteStewardFactory=e,this._imageStewardFactory=t,this._tableStewardFactory=n,this._wordConverterFactory=r,this._htmlTranslatorSettings=i,this._contentControlCopyPasteHelper=o,this._appSettingsManager=a,this._externalPasteCssConverter=s,this._htmlNormalizerSettings=l}return e.prototype.create=function(e,t,n,r){return new nf(e,t,n,r,this._box4PasteStewardFactory,this._imageStewardFactory,this._tableStewardFactory,this._wordConverterFactory,this._htmlTranslatorSettings,this._contentControlCopyPasteHelper,this._appSettingsManager,Br.App.get_activeAppFrame().workspace,this._externalPasteCssConverter,this._htmlNormalizerSettings)},e}();(0,o.l)(rf,"Factory$11",null,[zd]);var of=n(4381),af=n(4120),sf=function(){function e(e){this.internalCopyUsageData=null,this.graphObjectUsageData=null,this.paragraphUsageData=null,this.chpUsageData=null,this.blobUsageData=null;this.internalCopyUsageData=e.getInternalCopyUsageDataInstance("intCopy"),this.graphObjectUsageData=e.getGraphObjectUsageDataInstance("intCopy"),this.paragraphUsageData=e.getParagraphUsageDataInstance("intCopy"),this.chpUsageData=e.getChpUsageDataInstance("intCopy"),this.blobUsageData=e.getBlobUsageDataInstance("intCopy")}return e.getAnInstance=function(){return e.getAnInstanceWithResolvedDependencies()},e.getAnInstanceWithResolvedDependencies=function(){return new e(lm.z.get_instance())},e}();(0,o.l)(sf,"InternalCopyUsageHelper",null,[]);var lf=function(){function e(e,t,n){this.source=null,this.target=null,this.paragraphLinks=null,this.childOperationReturnValue=null,this.useChildReturnValue=!1,this.shouldCopySubtree=!1,this.$$pf_FeatureArgs=null,this._usageHelper=sf.getAnInstance(),this.source=e,this.target=t,this.paragraphLinks=n}return e.prototype.get_usageHelper=function(){return this._usageHelper},e.prototype.get_featureArgs=function(){return this.$$pf_FeatureArgs},e.prototype.set_featureArgs=function(e){return this.$$pf_FeatureArgs=e,e},e}();(0,o.l)(lf,"InternalCopyArguments",null,[]);var cf=function(e){function t(t,n,r,i){var o=e.call(this,t,n,{})||this;o.selectedContexts=null,o.contextIndex=0,o.graphTransaction=null,o.selectedContexts=new Array(0);for(var a=0;a<r.get_length();a++)Array.addRange(o.selectedContexts,r.get_item(a).toArray());return o.contextIndex=0,o.graphTransaction=i,o}return(0,S.t)(t,e),t}(lf);(0,o.l)(cf,"BasicInternalCopyArguments",lf,[]);var uf=function(e){function t(t){var n=e.call(this)||this;return n.featureArgs=null,n.featureArgs=t,n}return(0,S.t)(t,e),t}(Sys.EventArgs);(0,o.l)(uf,"BeforePasteArguments",Sys.EventArgs,[]);var gf=function(e){function t(t,n){var r=e.call(this,t.source,t.target,t.paragraphLinks)||this;return r.parentArgs=null,r.insertAfter=null,r.parentArgs=t,r.insertAfter=n,r}return(0,S.t)(t,e),t.prototype.get_usageHelper=function(){return this.parentArgs.get_usageHelper()},t.prototype.get_featureArgs=function(){return this.parentArgs.get_featureArgs()},t.prototype.set_featureArgs=function(e){return this.parentArgs.set_featureArgs(e),e},t}(lf);(0,o.l)(gf,"CoreInternalCopyArguments",lf,[]);var pf=function(){return function(e,t,n,r,i){void 0===i&&(i=null),this.source=null,this.target=null,this.insertAfter=null,this.outlineOffset=null,this.featureArgs=null,this.source=e,this.target=t,this.insertAfter=n,this.outlineOffset=r,this.featureArgs=i||{}}}();(0,o.l)(pf,"CoreInternalPasteArguments",null,[]);var df=function(){return function(e,t,n,r,i,o,a,s,l){this.tableCellPasteOperation=null,this.source=null,this.target=null,this.outlineOffset=null,this.rowIndex=0,this.columnIndex=0,this.pasteOperationStep=null,this.changedCellIndices=null,this.interactiveView=null,this.tableCellPasteOperation=e,this.source=t,this.target=n,this.outlineOffset=r,this.rowIndex=i,this.columnIndex=o,this.changedCellIndices=a,this.pasteOperationStep=s,this.interactiveView=l}}();(0,o.l)(df,"CoreInternalTablePasteArguments",null,[]);var hf=function(e){function t(t,n,r,i,o){var a=e.call(this)||this;return a.operation=null,a.operationStep=null,a.original=null,a.clone=null,a.featureArgs=null,a.operation=t,a.operationStep=n,a.original=r,a.clone=i,a.featureArgs=o,a}return(0,S.t)(t,e),t}(Sys.EventArgs);(0,o.l)(hf,"ParagraphCopyPasteArguments",Sys.EventArgs,[]);var _f,mf=n(1278),ff=n(5665),yf=n(9891),Cf=n(5534),Sf=n(8720);!function(e){e[e.unknown=-2]="unknown",e[e.all=-1]="all",e[e.none=0]="none",e[e.element=1]="element",e[e.content=2]="content",e[e.bodyText=3]="bodyText",e[e.list=4]="list",e[e.structureElement=5]="structureElement",e[e.anchoredObject=6]="anchoredObject",e[e.footnoteEndnoteContainer=7]="footnoteEndnoteContainer",e[e.footnoteEndnote=8]="footnoteEndnote",e[e.metaContent=9]="metaContent",e[e.headerAllPages=10]="headerAllPages",e[e.headerFirstPage=11]="headerFirstPage",e[e.headerEvenPages=12]="headerEvenPages",e[e.footerAllPages=13]="footerAllPages",e[e.footerFirstPage=14]="footerFirstPage",e[e.footerEvenPages=15]="footerEvenPages",e[e.commentContent=16]="commentContent",e[e.shapeContainer=17]="shapeContainer",e[e.appsRole=18]="appsRole",e[e.appRole=19]="appRole",e[e.appRefRole=20]="appRefRole",e[e.appPropRole=21]="appPropRole",e[e.appBindingRole=22]="appBindingRole",e[e.customXmlRootRole=23]="customXmlRootRole",e[e.customXmlRole=24]="customXmlRole",e[e.contentControlRootRole=25]="contentControlRootRole",e[e.contentControlRole=26]="contentControlRole",e[e.notesContent=27]="notesContent",e[e.glossaryPageManifestRole=28]="glossaryPageManifestRole",e[e.glossaryPageContentRole=29]="glossaryPageContentRole",e[e.bookmarkContainerRole=30]="bookmarkContainerRole",e[e.shadowNumberListRole=31]="shadowNumberListRole",e[e.slideMasterContentRole=32]="slideMasterContentRole",e[e.ocsVectorClockContainerRole=33]="ocsVectorClockContainerRole",e[e.pptSectionContent=34]="pptSectionContent",e[e.autoSaveParametersRole=35]="autoSaveParametersRole",e[e.promptTextRole=36]="promptTextRole",e[e.smartArtSubShapeRole=37]="smartArtSubShapeRole",e[e.taskContent=38]="taskContent",e[e.embeddedFontContainer=39]="embeddedFontContainer",e[e.embeddedFont=40]="embeddedFont",e[e.intelligenceRegion=41]="intelligenceRegion",e[e.intelligenceRejection=42]="intelligenceRejection",e[e.intelligenceContentLocator=43]="intelligenceContentLocator",e[e.intelligenceRoot=44]="intelligenceRoot",e[e.reserved01=45]="reserved01",e[e.reserved02=46]="reserved02",e[e.reserved03=47]="reserved03",e[e.reserved04=48]="reserved04",e[e.reserved05=49]="reserved05",e[e.reserved06=50]="reserved06",e[e.reserved07=51]="reserved07",e[e.reserved08=52]="reserved08",e[e.reserved09=53]="reserved09",e[e.reserved10=54]="reserved10",e[e.reserved11=55]="reserved11",e[e.reserved12=56]="reserved12",e[e.reserved13=57]="reserved13",e[e.reserved14=58]="reserved14",e[e.reserved15=59]="reserved15",e[e.reserved16=60]="reserved16",e[e.reserved17=61]="reserved17",e[e.reserved18=62]="reserved18",e[e.reserved19=63]="reserved19",e[e.reserved20=64]="reserved20",e[e.reserved21=65]="reserved21",e[e.reserved22=66]="reserved22",e[e.reserved23=67]="reserved23",e[e.reserved24=68]="reserved24",e[e.reserved25=69]="reserved25",e[e.reserved26=70]="reserved26",e[e.reserved27=71]="reserved27",e[e.reserved28=72]="reserved28",e[e.reserved29=73]="reserved29",e[e.reserved30=74]="reserved30",e[e.graphSpaceElement=75]="graphSpaceElement",e[e.graphSpaceContext=76]="graphSpaceContext",e[e.graphSpaceVersionHistoryContext=77]="graphSpaceVersionHistoryContext",e[e.graphSpaceFileReference=78]="graphSpaceFileReference",e[e.graphSpace=79]="graphSpace",e[e.graphSpaceContent=80]="graphSpaceContent",e[e.viewTarget=81]="viewTarget",e[e.selected=82]="selected",e[e.tempElement=83]="tempElement",e[e.widget=84]="widget",e[e.widgetTarget=85]="widgetTarget",e[e.text=86]="text",e[e.textStructure=87]="textStructure",e[e.noteTag=88]="noteTag",e[e.wetContent=89]="wetContent",e[e.countRoles=90]="countRoles",e[e.firstPersisted=1]="firstPersisted",e[e.lastPersisted=78]="lastPersisted",e[e.firstGraphSpaceRole=75]="firstGraphSpaceRole",e[e.lastGraphSpaceRole=79]="lastGraphSpaceRole",e[e.firstGraphSpaceContextRole=76]="firstGraphSpaceContextRole",e[e.lastGraphSpaceContextRole=77]="lastGraphSpaceContextRole"}(_f||(_f={})),(0,o.h)("ChildNodeRole",_f);var vf=n(4594),bf=n(7506),Tf=function(){function e(){}return e.$$cctor=function(){e.rolesToIgnore=new Iu.n(_f,Boolean),e.rolesToIgnore.set_item(88,!0),e.rolesToIgnore.set_item(4,!0)},e.generalizeSelectionToOEs=function(t,n,r){var i=[];if(us.n.get_instance().get_item(104)&&t.get_isTableCellSelection()&&ss.SelectionFactory.isTableFullSelectedForCellSelection(t)){(C=Da.GraphIterator.createFromNode(t.get_currentSelection().get_tableSelectionContexts().get_firstContext().get_node())).tryToRootAtAncestorOfType(14);var o=_s.y.create(C.get_origin()),a=e.ascendWhileNodeIsFirstAndOrLast(o,!0,!0,null);C.set(a),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(C),e.generalizeNodeToOE(C,i)}else for(var s=0;s<t.get_length()&&!(r&&i.length>0);++s){var l=t.get_item(s),c=e.getFirstOrLastGraphContext(l,!0),u=e.getFirstOrLastGraphContext(l,!1);if(c&&u)if(c!==u||c.get_contextId()!==cl.V){var g=null,p=null,d=null,h=-1,_=void 0,m=void 0;if(c.get_node()===u.get_node())_=c.get_node(),m=u.get_node();else{g=e.getAllAncestors(c.get_node()),p=e.getAllAncestors(u.get_node());var f=void 0;for(f=0;f<g.length&&f<p.length&&g[f]===p[f];++f);d=g[f-1],h=f-1,_=e.ascendWhileNodeIsFirstAndOrLast(c,!0,!1,d),m=e.ascendWhileNodeIsFirstAndOrLast(u,!1,!0,d)}if(_===m){o=void 0;o=_===c.get_node()?c:_s.y.create(_);a=e.ascendWhileNodeIsFirstAndOrLast(o,!0,!0,null);(C=new Pm.z).set(a),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(C),e.generalizeNodeToOE(C,i)}else{for((C=new Pm.z).set(_),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(C),_===d&&C.goToFirstChild(),e.generalizeNodeToOE(C,i);C.get_parentNode()!==d;){for(;C.goToNextSibling();)e.generalizeNodeToOE(C,i);C.returnToParent()}if(m===d)for(;C.goToNextSibling();)e.generalizeNodeToOE(C,i);else{C.goToNextSibling();for(f=h+1;f<p.length;++f){for(;;){if((y=C.get_currentNode())===p[f])break;e.generalizeNodeToOE(C,i),C.goToNextSibling()}if(m===p[f])break;C.goToFirstChild()}e.generalizeNodeToOE(C,i)}}}else{var y=c.get_node();(C=Da.GraphIterator.createFromNode(y)).tryToRootAtAncestorOfType(11)&&e.generalizeNodeToOE(C,i)}}if(i.length<=0)return null;if(n){var C=new Da.GraphIterator;for(s=0;s<i.length;++s)C.set(i[s].get_node()),hs.OutlineElementNavigator.moveToContent(C),i[s]=_s.y.create(C.get_currentNode())}return bf.x.createSet(i)},e.getFirstOrLastGraphContext=function(e,t){if(t)for(var n=0;n<e.get_length();++n){if(e.get_item(n).get_isGraphNodeContext())return e.get_item(n);if(e.get_item(n).get_isContextSet())for(var r=e.get_item(n),i=0;i<r.get_length();++i)if(r.getContext(i).get_isGraphNodeContext())return r.getContext(i)}else for(n=e.get_length()-1;n>=0;--n){if(e.get_item(n).get_isGraphNodeContext())return e.get_item(n);if(e.get_item(n).get_isContextSet())for(i=(r=e.get_item(n)).get_length()-1;i>=0;--i)if(r.getContext(i).get_isGraphNodeContext())return r.getContext(i)}return null},e.generalizeNodeToOE=function(t,n){if(e.isParentOfOutlienElement(t))e.findAllOEsUnder(t,n);else if(!e.rolesToIgnore.containsKey(t.get_role())){var r=t.useAncestorOfType(11);!r||n.length&&n[n.length-1].get_node()===r||Array.add(n,_s.y.create(r))}},e.getAllAncestors=function(e){var t=[],n=new Da.GraphIterator;for(n.set(e),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(n),Array.add(t,e);n.returnToParent();)Array.add(t,n.get_currentNode());return t.reverse(),t},e.ascendWhileNodeIsFirstAndOrLast=function(t,n,r,i){var o=t.get_node();if(Pa.SelectionEditor.isTextRangeContext(t)){if(n&&t.get_cpBegin()>0)return o;if(r&&t.get_cpEnd()<cs.ParagraphReader.textLength(o))return o}if(Pa.SelectionEditor.isEndOfParagraphContext(t)&&n&&cs.ParagraphReader.textLength(o)>0)return o;var a=new Pm.z;for(a.set(o),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(a);!a.get_isAtOrigin();){if(i===(o=a.get_currentNode()))return o;if(n&&!e.isFirstSignificantChild(a))return o;if(r&&!e.isLastSignificantChild(a))return o;a.returnToParent()}return a.get_currentNode()},e.isLastSignificantChild=function(t){var n=!0;if(t.goToNextSibling())for(n=!1;e.rolesToIgnore.containsKey(t.get_role())||us.n.get_instance().get_item(77)&&16===t.get_currentNodeType()&&Zc.isGhostCell(t);)if(!t.goToNextSibling()){n=!0;break}return n},e.isFirstSignificantChild=function(t){var n=t.get_currentNode(),r=!0;if(t.goToPreviousSibling())for(r=!1;e.rolesToIgnore.containsKey(t.get_role());)if(!t.goToPreviousSibling()){r=!0;break}return t.returnToParent(),t.goToChild(n),r},e.findAllOEsUnder=function(t,n){var r=vf.z.createTraverserFromIterator(t);for(r.setFilter(e.filterNonElementRoles,null);r.moveNext();)if(Ls.OutlineElementReader.isOutlineElementNode(r.get_currentNode())){var i=r.get_currentNode();Array.add(n,_s.y.create(i))}},e.filterNonElementRoles=function(t,n){return e.isParentOfOutlienElement(t)},e.isParentOfOutlienElement=function(e){return e.get_isAtOrigin()||1===e.get_role()||27===e.get_role()},e.rolesToIgnore=null,e}();(0,o.l)(Tf,"OutlineElementGeneralizer",null,[]),Tf.$$cctor();var Af=function(){return function(){this.containingTable=null,this.controlCell=null,this.rowSpan=0,this.colSpan=0,this.response=0,this.response=2}}();(0,o.l)(Af,"ComplexCellData",null,[]);var If=n(2778),wf=n(6843),xf=n(2585),Ff=function(){function e(e){this._graph=null,this._graph=e;e.lockTempGraphAlgorithm()}return e.prototype.dispose=function(){this._graph.unlockTempGraphAlgorithm()},e.createFromNode=function(t){return new e(t.get_containingGraph())},e}();(0,o.l)(Ff,"TempGraphAlgorithmLock",null,[Sys.IDisposable]);var Ef=function(){function e(t,n,r){this._pageContentEditor=null,this._doNotDeleteThisTable=null,this._topmostSelectableContentContainer=null,this._tempAlgorithmLock=null,this._refCount=0,this._deleteTableSegments=!1,this._deleteOutlineElementNodeStrategy=null,this._tableEditor=null,this._paragraphsToMerge=[],this._tableCellsList=[],this._columnDeletedCount={},this._oldRowCount={},this._anyRowDeleted={},this._topmostSelectableContentContainer=e.getTopMostSelectableContentContainer(t),this._topmostSelectableContentContainer.maskTempAlgorithmPropagation(),this._tempAlgorithmLock=Ff.createFromNode(this._topmostSelectableContentContainer),e._currentNormalizer=this,this._refCount=1,this._deleteTableSegments=n,this._deleteOutlineElementNodeStrategy=r}return e.prototype.get_tableEditor=function(){return this._tableEditor||(this._tableEditor=se.w.get_instance().resolve(cu.z))},e.prototype.get_isContentControlEditingEnabled=function(){return!!e.get_contentControlEditor()&&!!e.get_contentControlConfigSettings()&&e.get_contentControlConfigSettings().get_isContentControlEditingEnabled()},e.prototype.get_pageContentEditor=function(){return this._pageContentEditor||(this._pageContentEditor=se.w.get_instance().resolve(bm.m))},e.prototype.normalize=function(){if(!(--this._refCount>0)){var t=new as.GraphTransaction(7);t.setFromNode(this._topmostSelectableContentContainer);var n=this.pruneDeletedNodes();this.mergeAtEndsOfParagraphs(),e.fixDeadOutlines(n),us.n.get_instance().get_item(63)&&this.cleanUpTableCells(),this.fixEmptyPage(),t.dispose(),this.cleanUp()}},e.prototype.setTableAsNotDeletable=function(e){this._doNotDeleteThisTable=e},e.prototype.fixEmptyPage=function(){var t=Da.GraphIterator.createFromNode(this._topmostSelectableContentContainer);if(!t.hasChildren()){var n=this.get_pageContentEditor().createOutline(t);e.get_outlineEditor().appendOutlineElement(t,!0);var r=Br.App.get_activeAppFrame().workspace.get_contentView();r.get_isPageView()&&e.get_outlineEditor().setOutlineToDefaultPosition(n,r.getViewWidth())}},e.prototype.cancel=function(){if(!(--this._refCount>0)){var t=xf.p.createTraverser(this._topmostSelectableContentContainer);for(t.setFilter(e._canDeleteCheckFilterDelegate,null);t.moveNext();)t.get_iterator().get_isAtOrigin()||t.get_iterator().validateCoreChannel(16,!1);this.cleanUp()}},e.prototype.cleanUp=function(){this._topmostSelectableContentContainer.unmaskTempAlgorithmPropagation(),this._tempAlgorithmLock.dispose(),e._currentNormalizer=null},e.prototype.trackContext=function(t){if(t.get_isGraphNodeContext()){var n=t;e.isUnlockedContext(n)&&Array.add(this._paragraphsToMerge,n.get_node()),this.trackNode(n.get_node())}else t.get_isContextSet()&&this.trackContextSet(t)},e.prototype.trackContextSet=function(e){for(var t=0;t<e.get_length();++t)this.trackContext(e.getContext(t))},e.prototype.trackNode=function(e){e.get_anchor().invalidateCoreChannel(16)},e.prototype.mergeAtEndsOfParagraphs=function(){for(var t=0;t<this._paragraphsToMerge.length;++t){var n=this._paragraphsToMerge[t];if(n.get_anchor()&&!n.get_anchor().get_isRetired()){var r=new Da.GraphIterator;if(r.set(n),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(r))if(hs.OutlineElementNavigator.returnToOutlineElement(r),this._deleteOutlineElementNodeStrategy.canDeleteWithoutMerge(r))e.get_outlineElementEditor().disconnectOutlineElement(r);else{var i=new Pm.z;if(i.setFrom(r),hs.OutlineElementNavigator.moveToNextOutlineElement(i,!1,!1)&&36!==i.get_role()&&(hs.OutlineElementNavigator.moveToContent(i),!i.get_currentNode().get_isBlockContent()&&!dc.TableReader.isTable(i))){hs.OutlineElementNavigator.returnToOutlineElement(i);var o=new Da.GraphIterator;o.setFrom(i),o.returnToParent(),e.get_outlineElementEditor().merge(r,i,!1,!1),Ls.OutlineElementReader.isOutlineGroup(o)&&!o.hasChildren()&&i.disconnectNodeAndReturnToParent()}}}}Array.clear(this._paragraphsToMerge)},e.prototype.cleanUpTableCells=function(){for(var t=0;t<this._tableCellsList.length;++t){var n=this._tableCellsList[t];if(n.get_anchor()&&!n.get_anchor().get_isRetired()&&!Zc.isGhostCellNode(n)){var r=new Da.GraphIterator;r.set(n),r.goToLastChildByRole(1),r.goToFirstChildByRole(2),dc.TableReader.isTable(r)&&(r.returnToParent(),e.get_outlineElementEditor().insertOutlineElementAsSibling(r,!1,!0,null))}}Array.clear(this._tableCellsList)},e.prototype.getColumnListForTable=function(e){var t=e.get_id().toString();if(this._columnDeletedCount[t])return this._columnDeletedCount[t];for(var n=new Array(dc.TableReader.getColumnCount(e)),r=0;r<dc.TableReader.getColumnCount(e);++r)n[r]=0;return this._columnDeletedCount[t]=n,this._oldRowCount[t]=dc.TableReader.getRowCount(e),n},e.prototype.pruneDeletedNodes=function(){var t=xf.p.createTraverser(this._topmostSelectableContentContainer);t.setFilter(e._canDeleteCheckFilterDelegate,null);for(var n=[],r=!!e.get_featureHelper()&&e.get_featureHelper().isFeatureEnabled(47),i=t.moveNext(),o=new Da.GraphIterator,a=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CanChangeComplexTableStructureIsEnabled"),s=0;i;)if(t.get_iterator().get_isAtOrigin())this.cleanChildTempGraphAlgorithmBits(t.get_iterator()),i=t.moveNext();else if(this._deleteOutlineElementNodeStrategy.isParentOfDeletedOutlineElements(t.get_iterator())&&Array.add(n,t.get_iterator().get_currentNode()),us.n.get_instance().get_item(63)&&Zc.isTableCell(t.get_iterator())&&Array.add(this._tableCellsList,t.get_iterator().get_currentNode()),e.canIteratorBeDisconnected(t.get_iterator()))switch(t.get_iterator().get_currentNodeType()){case 16:var l=ld.getContainingTable(t.get_iterator());if(!this._deleteTableSegments||!a&&dc.TableReader.isComplexTableNode(l)||Zc.isGhostCell(t.get_iterator()))i=t.moveNext();else++this.getColumnListForTable(l)[sd.e(t.get_iterator())],i=t.moveNext();break;case 15:l=ld.getContainingTable(t.get_iterator());if(!this._deleteTableSegments||!a&&dc.TableReader.isComplexTableNode(l))i=t.moveNext();else{var c=l.get_id().toString();this._anyRowDeleted[c]=!0,o.setFrom(t.get_iterator()),i=t.moveNext(),this.get_tableEditor().deleteRows(o,1)}break;case 14:(m=t.get_iterator().get_currentNode())!==this._doNotDeleteThisTable?(i=t.moveNext(),this.get_isContentControlEditingEnabled()&&e.get_contentControlEditor().updateContentControlNodeStartEndObjectOnTableDeleted(m),o.setFrom(t.get_iterator()),i=t.moveNext(),e.get_outlineElementEditor().disconnectOutlineElement(o)):(t.get_iterator().validateCoreChannel(16,!1),i=t.moveNext());break;case 23:o.setFrom(t.get_iterator());var u=e.isLastOutlineGroupNode(o);if(i=t.moveNext(),u&&e.get_featureHelper()&&e.get_featureHelper().logUniqueFeatureUsage(47),r)if(u){var g=new Da.GraphIterator;if(g.set(o.get_currentNode()),1===g.getChildCountByRole(1)){g.goToFirstChild();var p=g.goToFirstChild();if(p&&12===p.get_type()&&e.get_styleEditor()){var d=Tc.StyleReader.getStyleSetFromParagraphNode(p);e.get_styleEditor().setStyleOnParagraphNode(d.getStyleById(Tc.StyleReader.get_wordStyleIdNormal()),p,!0)}}}else o.disconnectNodeAndReturnToParent();else o.disconnectNodeAndReturnToParent();break;case 11:s++,Hr.b(t.get_iterator())?(t.get_iterator().validateCoreChannel(16,!1),i=t.moveNext()):(o.setFrom(t.get_iterator()),mc.ListReader.isListOutlineElement(o)&&!this._deleteOutlineElementNodeStrategy.shouldFollowFirstSelectedOEAfterDelete(o,s)&&e.get_listEditor().removeList(o),o.hasChildrenOfRole(2)?this._deleteOutlineElementNodeStrategy.shouldKeepOutlineElementAfterDelete(o,s)?i=t.moveNext():(o.setFrom(t.get_iterator()),i=t.moveNext(),e.get_outlineElementEditor().disconnectOutlineElement(o)):(i=t.moveNext(),e.get_outlineElementEditor().disconnectOutlineElement(o)));break;case 12:var h=t.get_iterator().get_currentNode();i=t.moveNext(),this.get_isContentControlEditingEnabled()&&e.get_contentControlEditor().updateContentControlNodeStartEndObjectOnParagraphDeleted(h);break;default:i=t.moveNext()}else{var _=!0;if(dc.TableReader.isTable(t.get_iterator())&&this._deleteTableSegments){c=(m=t.get_currentNode()).get_id().toString();var m,f=this._columnDeletedCount[c],y=!1;if(f)for(var C=this._oldRowCount[c],S=dc.TableReader.getColumnCount(m)-1;S>=0;--S)f[S]===C&&(this.get_tableEditor().deleteColumns(t.get_iterator(),S,1),y=!0);dc.TableReader.getColumnCount(t.get_iterator().get_currentNode())?us.n.get_instance().get_item(30)&&(y||this._anyRowDeleted[c])&&dc.TableReader.isSingleCellTable(t.get_iterator().get_currentNode())&&(o.setFrom(t.get_iterator()),ld.moveToFirstRow(o),ld.moveToFirstColumn(o),i=t.moveNext(),e.get_outlineElementEditor().replaceContentWithContentOfOutline(t.get_iterator(),o)):(i=t.moveNext(),o.setFrom(t.get_iterator()),i=t.moveNext(),o.disconnectNodeAndReturnToParent(),_=!1)}_&&(t.get_iterator().validateCoreChannel(16,!1),i=t.moveNext())}return this._columnDeletedCount={},this._oldRowCount={},this._anyRowDeleted={},n},e.prototype.cleanChildTempGraphAlgorithmBits=function(e){if(e.goToFirstChild())do{e.validateCoreChannel(16,!1)}while(e.goToNextSiblingOrReturnToParent())},e.get_styleEditor=function(){return e._styleEditor||(e._styleEditor=se.w.get_instance().resolve(uc.e))},e.get_listEditor=function(){return e._listEditor||(e._listEditor=se.w.get_instance().resolve(rs.v))},e.get_outlineEditor=function(){return e._outlineEditor||(e._outlineEditor=se.w.get_instance().resolve(rc.a))},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=se.w.get_instance().resolve(Es.p))},e.get_unsupportedNodeEditor=function(){return wf.q.get_instance()},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_contentControlEditor=function(){return e._contentControlEditor||(e._contentControlEditor=se.w.get_instance().tryResolve(yf.p))},e.get_contentControlConfigSettings=function(){return e._contentControlConfigSettings||(e._contentControlConfigSettings=se.w.get_instance().tryResolve(Cf.i))},e.get_featureHelper=function(){return e._featureHelper||(e._featureHelper=se.w.get_instance().tryResolve($p.d))},e.getNormalizer=function(t,n){return e._currentNormalizer?(e._currentNormalizer._refCount++,e._currentNormalizer):(e._currentNormalizer=new e(t,n,se.w.get_instance().resolve(If.j)),e._currentNormalizer)},e.getTopMostSelectableContentContainer=function(e){var t=Da.GraphIterator.createFromNode(e);return Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(t),t.returnToNodeMatchingCondition((function(e){return e.get_isTopmostSelectableContentContainer()})),t.get_currentNode()},e.isUnlockedContext=function(t){var n=!1;return Pa.SelectionEditor.isEndOfParagraphContext(t)&&(n=!us.n.get_instance().get_item(14)||!e.get_lockedRangeEditor().isEopContextInLockedRange(t)),!n&&cs.ParagraphReader.isParagraphContext(t)&&(n=!us.n.get_instance().get_item(14)||!e.get_lockedRangeEditor().isParaContextInLockedRange(t)&&!t.get_node().getValueWithDefault(Boolean,ks.j.isResilientEop,!1)),n},e.fixDeadOutlines=function(t){for(var n=0;n<t.length;++n){var r=t[n];if(r.get_anchor()&&!r.get_anchor().get_isRetired()){var i=new Da.GraphIterator;if(i.set(r),!Sc.moveToFirstOutlineElement(i)){if(i.get_currentNode().setValue(Kc.b.outlineElementChildLevel,Cc.k.first),us.n.get_instance().get_item(41)&&10===i.get_currentNodeType()){var o=e.get_outlineElementEditor().insertOutlineGroup(i,null,1);i.goToChild(o)}e.get_outlineEditor().appendOutlineElement(i,!0)}}}},e.isOutlineGroup=function(e,t){return 23===e.get_currentNodeType()},e.isLastOutlineGroupNode=function(t){var n=new Da.GraphIterator;if(n.set(t.get_currentNode()),!n.tryToRootAtOutlineAncestor())return!1;if(!n.returnToOutlineNode())return!1;var r=vf.z.createPartialTraverser(n,n.get_currentNode());return r.setFilter(e.isOutlineGroup,null),!r.moveNext()||!r.moveNext()},e.canIteratorBeDisconnected=function(t){switch(t.get_currentNodeType()){case 12:return t.get_currentNode().get_canBeDisconnectedDuringDelete()}if(!t.goToFirstChild())return!e.get_unsupportedNodeEditor().isUnsupported(t)||e.get_unsupportedNodeEditor().canBeDeleted(t.get_currentNode());var n=!0;do{switch(t.get_role()){case 2:case 1:case 3:case 86:case 87:16&t.get_invalidSubGraphCoreState()||16===t.get_currentNodeType()&&Zc.isGhostCell(t)||(n=!1)}t.validateCoreChannel(16,!0)}while(t.goToNextSiblingOrReturnToParent());return n&&e.get_unsupportedNodeEditor().isUnsupported(t)&&(n=e.get_unsupportedNodeEditor().canBeDeleted(t.get_currentNode())),n},e.canDeleteCheckFilter=function(e,t){return e.get_isAtOrigin()||!!(16&e.get_invalidSubGraphCoreState())},e._canDeleteCheckFilterDelegate=e.canDeleteCheckFilter,e._currentNormalizer=null,e._eventSource=new bt.f,e._outlineEditor=null,e._listEditor=null,e._outlineElementEditor=null,e._contentControlEditor=null,e._contentControlConfigSettings=null,e._featureHelper=null,e._styleEditor=null,e}();(0,o.l)(Ef,"GraphStructureNormalizer",null,[]);var Pf=function(){return function(){this.processContexts=null,this.containingTable=null,this.response=0,this.singleElement=null,this.numberOfOperations=0,this.response=2}}();(0,o.l)(Pf,"TableGeneralizeData",null,[]);var kf=n(7253),Df=n(9119),Mf=function(){return kf.ContextSetEditor.get_instance()},Rf=function(e,t,n,r,i,o,a){var s=!1;if(o&&o.CollapseIp&&o.CollapseIp&&(s=!0),!t.view.get_isInteractiveView())return 2;var l,c=t.view,u=c.get_selectionManager();if(1===n)return u&&u.get_selectionCollection().get_currentSelection()?(l=a?Mf().generalizeContextToSetOfType(t.get_nextContext(),a,!0):t.get_nextContext(),L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l,e,n,!0,r,i)):8;o&&o.PerfMarkStart&&Xi.t.mark(o.PerfMarkStart);var g=Df.a.get_instance().createReferenceToCurrentSelection(),p=u.get_selectionCollection().get_currentSelection().get_firstContext(),d=new as.GraphTransaction(15);d.setFromNode(p.get_node()),d.setAllViewsToUpdate(),l=a?Mf().generalizeContextToSetOfType(t.get_nextContext(),a):t.get_nextContext();var h=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l,e,n,!0,r,i);return 32===h&&g.restoreSelection(s),Nt.FocusManager.instance().setScope(c.get_focusScopeId()),d.dispose(),Br.App.get_activeAppFrame().updateCommandUI(),o&&o.PerfMarkEnd&&Xi.t.mark(o.PerfMarkEnd),h},Lf=function(e,t,n,r,i,o){var a,s=Oa.SelectionManager.get_instance(),l=!1;if(o&&o.CollapseIp&&o.CollapseIp&&(l=!0),1===n)return s&&s.get_selectionCollection().get_currentSelection()&&(a=Tf.generalizeSelectionToOEs(s.get_selectionCollection(),!1,!0))?L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(a,e,n,!0,r,i):8;o&&o.PerfMarkStart&&Xi.t.mark(o.PerfMarkStart);var c=Df.a.get_instance().createReferenceToCurrentSelection(),u=s.get_selectionCollection().get_currentSelection().get_firstContext();if(!(a=Tf.generalizeSelectionToOEs(s.get_selectionCollection(),!1)))return 8;var g=new as.GraphTransaction(15);g.setFromNode(u.get_node()),g.setAllViewsToUpdate();var p=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(a,e,n,!0,r,i);32===p&&c.restoreSelection(l);var d=t.view;return d&&Nt.FocusManager.instance().setScope(d.get_focusScopeId()),g.dispose(),Br.App.get_activeAppFrame().updateCommandUI(),o&&o.PerfMarkEnd&&Xi.t.mark(o.PerfMarkEnd),p},Nf=n(312),Bf=n(1905),Of=n(6559),Uf=function(){return function(){this.controlCell=null,this.rowOffset=0,this.colOffset=0,this.firstGhostCellInSameRow=null,this.firstGhostCellInSameColumn=null}}();(0,o.l)(Uf,"MergedCellInfo",null,[]);var Hf=n(1987),Gf=n(1996),Vf=n(1847),Wf=n(1879),zf=n(281),Kf=n(4305),qf=function(){function e(t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null),this._trackChangeManager=null,this._trackChangeEditor=null,e._outlineEditor=t,e._outlineElementEditor=n,this._trackChangeEditor=r,this._trackChangeManager=i}return e.prototype.handlePargraphDeletion=function(e){},e.prototype.setNewWordTableColumnWidth=function(e,t){},e.prototype.setNewWordTableLayout=function(e){},e.prototype.getTableWidthMus=function(e){return 0},e.prototype.setColumnWidths=function(e){},e.prototype.setTableAndParentTableColumnWidths=function(e){},e.prototype.resetRowAndColumnCountsUpdatingSpans=function(e){var t=e.tableIterator.get_currentNode();this.updateGhostCellsWithoutControllingCell(t);var n=this.countColumnsOnTable(t),r=this.getTableStructure(t,n),i=r.length;e.deletedRows=this.findRowsToDelete(r),e.deletedColumns=this.findColumnsToDelete(r);var o=e.deletedRows.toArray().length,a=e.deletedColumns.toArray().length;(o>0||a>0)&&(i-=o,n-=a,this.updateTableCellSpans(e)),this.setRowCount((0,f.e)(Wf.k,t),i),this.setColumnCount((0,f.e)(Wf.k,t),n),this.resetColumnWidths(e)},e.prototype.findColumnsToDelete=function(e){for(var t=new y.c(Number),n=0;n<e[0].length;n++){for(var r=!0,i=0;i<e.length;i++)if(1===e[i][n]){r=!1;break}r&&t.add(n)}return t},e.prototype.findRowsToDelete=function(e){for(var t=new y.c(Number),n=0;n<e.length;n++){for(var r=!0,i=0;i<e[n].length;i++)if(1===e[n][i]){r=!1;break}r&&t.add(n)}return t},e.prototype.countColumnsOnTable=function(e){var t=0,n=Da.GraphIterator.createFromNode(e);ld.moveToFirstRow((0,f.e)(Da.GraphIterator,n)),ld.moveToFirstColumn((0,f.e)(Da.GraphIterator,n));for(var r=(0,f.e)(Bf.v,n.get_currentINode()),i=!1;r;)!r.get_isGhostCell()||Zc.isSkippedCell((0,f.e)(Wf.k,r))?(t+=r.get_hasColSpan()?r.get_colSpan():1,i=!0):i||t++,r=(0,f.e)(Bf.v,ld.moveToNextColumn((0,f.e)(Da.GraphIterator,n)));return t},e.prototype.updateTableCellSpans=function(e){var t=e.tableIterator.get_currentINode(),n=Da.GraphIterator.createFromNode(t),r=0;ld.moveToFirstRow((0,f.e)(Da.GraphIterator,n));for(var i=n.get_currentINode(),o=Hh.y(zf.k.minimumRowHeightInPixels,1);i;){for(;e.deletedRows.contains(r);)r++;var a=1,s=e.sourceCellLocation?e.sourceCellLocation.rowIndex:0,l=e.sourceRowHeights[s+r];for(l<o&&(l=o);e.deletedRows.contains(r+a);){var c=e.sourceRowHeights[s+r+a];c<o&&(c=o),l+=c,a++}i.setValue(ks.j.tableRowHeight,l);var u=a-1,g=0;ld.moveToFirstColumn((0,f.e)(Da.GraphIterator,n));for(var p=(0,f.e)(Bf.v,n.get_currentINode());p;){var d=p.get_hasColSpan()?p.get_colSpan():1;p.get_hasRowSpan()&&p.get_rowSpan();if(!p.get_isGhostCell()||d>1){u>0&&(p.set_rowSpan(p.get_rowSpan()-u),p.get_rowSpan()<1&&p.set_rowSpan(1));for(var h=0,_=1;_<d;_++)e.deletedColumns.contains(g+_)&&h++;h>0&&(p.set_colSpan(p.get_colSpan()-h),p.get_colSpan()<1&&p.set_colSpan(1))}g+=d,p=(0,f.e)(Bf.v,ld.moveToNextColumn((0,f.e)(Da.GraphIterator,n)))}r++,ld.moveToFirstColumn((0,f.e)(Da.GraphIterator,n)),n.returnToParent(),i=ld.moveToNextRow((0,f.e)(Da.GraphIterator,n))}},e.prototype.updateGhostCellsWithoutControllingCell=function(e){var t=new y.c(Number),n=Da.GraphIterator.createFromNode(e);ld.moveToFirstRow((0,f.e)(Da.GraphIterator,n));for(var r=n.get_currentINode();r;){var i=!1,o=0;ld.moveToFirstColumn((0,f.e)(Da.GraphIterator,n));for(var a=(0,f.e)(Hf.TableCellNode,n.get_currentNode());a;){if(a.get_isGhostCell())a.get_hasColSpan()?(i=!0,t.contains(o)||(a.set_isGhostCell(!1),a.clearCellSpans())):Zc.isSkippedCell((0,f.e)(Wf.k,a))||t.contains(o)&&(i||us.n.get_instance().get_item(77))||(a.set_isGhostCell(!1),a.clearCellSpans());else{i=!0;for(var s=a.get_hasColSpan()?a.get_colSpan():1,l=0;l<s;l++)t.contains(o+l)||t.add(o+l)}o++,a=(0,f.e)(Hf.TableCellNode,ld.moveToNextColumn((0,f.e)(Da.GraphIterator,n)))}ld.moveToFirstColumn((0,f.e)(Da.GraphIterator,n)),n.returnToParent(),r=ld.moveToNextRow((0,f.e)(Da.GraphIterator,n))}},e.prototype.getTableStructure=function(e,t){var n=[],r=0,i=Da.GraphIterator.createFromNode(e);ld.moveToFirstRow((0,f.e)(Da.GraphIterator,i));for(var o=i.get_currentINode();o;){var a=0;ld.moveToFirstColumn((0,f.e)(Da.GraphIterator,i));for(var s=(0,f.e)(Bf.v,i.get_currentINode());s;){if(!s.get_isGhostCell()||Zc.isSkippedCell((0,f.e)(Wf.k,s))){for(var l=s.get_hasColSpan()?s.get_colSpan():1,c=s.get_hasRowSpan()?s.get_rowSpan():1;r<n.length&&2===n[r][a];)a++,(a%=t)||r++;for(var u=0;u<c;u++){var g=r+u;g===n.length&&Array.add(n,new Array(t));for(var p=0;p<l;p++)n[g][a+p]=u>0||p>0?2:1}a+=l}s=(0,f.e)(Bf.v,ld.moveToNextColumn((0,f.e)(Da.GraphIterator,i)))}ld.moveToFirstColumn((0,f.e)(Da.GraphIterator,i)),i.returnToParent(),o=ld.moveToNextRow((0,f.e)(Da.GraphIterator,i)),r++}return n},e.prototype.resetColumnWidths=function(e){if(dc.TableReader.isTable(e.tableIterator)&&e.sourceCellLocation&&e.sourceColumnWidths){for(var t=(0,f.e)(Nf.w,e.tableIterator.get_currentINode()),n=e.sourceColumnWidths,r=new Array(t.get_columnCount()),i=e.sourceCellLocation.columnIndex,o=0;o<r.length;o++)for(r[o]=n[i],i++;e.deletedColumns.contains(i-e.sourceCellLocation.columnIndex);)r[o]+=n[i],i++;t.set_columnWidths(r)}},e.prototype.getTableCellWidth=function(e){var t=(0,f.e)(Bf.v,e.get_currentNode());return t?t.get_width():0},e.prototype.updateMergeCellInfo=function(e){var t=this;(us.n.get_instance().get_item(77)||us.n.get_instance().get_item(63))&&(ld.forEachCellInTable(e,(function(e,t,n){return e.get_currentNode().set_mergeCellInfo(null),!0})),ld.forEachCellInTable(e,(function(e,n,r){var i=e.get_currentNode();if(!i.get_isGhostCell()){var o=i.get_rowSpan(),a=i.get_colSpan();o>1||a>1?t.createMergeCell(e,o,a):i.resetCellSpansToDefault()}return!0})))},e.prototype.createMergeCell=function(t,n,r){var i=this,a=t.get_currentNode(),s=new Da.GraphIterator;s.setFrom(t),ld.forEachCell(s,n,r,(function(n,s,l){var c=n.get_currentNode();if(c!==a){c.set_isGhostCell(!0);var u=!0,g=!1,p=e.get_featureHelper();p&&(g=p.isFeatureEnabled(88),p.logUniqueFeatureUsage(88));do{if(n.goToFirstChildByRole(1),o.r(Of.w,n.get_currentNode())){var d=u&&Ls.OutlineElementReader.isEmpty(n,!1);if(d){var h=Da.GraphIterator.createFromNode(n.get_currentINode());h.tryToRootAtAncestorOfType(16),d=!h.goToNextSiblingByRole(1)}d||t.addChild(n.get_currentNode(),1),g||i.handlePargraphDeletion(n),n.disconnectNodeAndReturnToParent()}u=!1}while(n.hasChildrenOfRole(1))}c.set_mergeCellInfo((0,O.m)(new Uf,{controlCell:a,rowOffset:s,colOffset:l})),1!==s||l||(a.get_mergeCellInfo().firstGhostCellInSameColumn=c),s||1!==l||(a.get_mergeCellInfo().firstGhostCellInSameRow=c),c.resetCellSpansToDefault(),l||c.set_colSpan(r)})),a.set_rowSpan(n),a.set_colSpan(r)},e.prototype.createSplitCell=function(e,t,n){var r=new Da.GraphIterator;if(r.setFrom(e),n>1&&this.splitCell$p(r,n,!1),t>1)for(var i=e.get_currentNode().get_colSpan(),o=0;o<n;o++){this.splitCell$p(r,t,!0);for(var a=0;a<i;a++)ld.moveToNextColumn(r)}ld.returnToContainingTable(r),this.updateMergeCellInfo(r)},e.prototype.splitCell$p=function(t,n,r){if(!(n<=1)){var i=t.get_currentNode(),o=new Da.GraphIterator;o.setFrom(t);var a=e.getCellSpan(i,r);if(1===a){r?this.setNewRowHeightWhenSplitting(o,n):this.setNewColumnWidthWhenSplitting(o,n);for(var s=0;s<n-1;s++)r?this.insertDeadRow(o):this.insertDeadCol(o);this.splitCell$p(t,n,r)}else if(a%n){if(!(n%a)){this.splitCell$p(o,a,r);for(s=0;s<a;s++){l=n/a;this.splitCell$p(o,l,r);for(g=0;g<l;g++)r?ld.moveToNextRow(o):ld.moveToNextColumn(o)}}}else{var l=a/n,c=r?l:i.get_rowSpan(),u=r?i.get_colSpan():l;e.setCellSpan(t.get_currentNode(),r,l);for(var s=0;s<n;s++){s>0&&this.promoteToNonGhostCellImpl(o,t),(c>1||u>1)&&this.createMergeCell(o,c,u);for(var g=0;g<l;g++)r?ld.moveToNextRow(o):ld.moveToNextColumn(o)}}}},e.prototype.setNewColumnWidthWhenSplitting=function(e,t){var n=new Da.GraphIterator;n.setFrom(e);var r=sd.e(e);ld.returnToContainingTable(n);var i=n.get_currentNode().getValueWithDefault(Array,Kc.b.tableColumnWidths,null);i&&((i=ku.v(i))[r]=i[r]/t,n.get_currentNode().setValue(Kc.b.tableColumnWidths,i))},e.prototype.setNewRowHeightWhenSplitting=function(e,t){var n=Hh.y(zf.k.minimumRowHeightInPixels,1),r=new Da.GraphIterator;r.setFrom(e),ld.returnToContainingRow(r);var i=r.get_currentNode().getValueWithDefault(Number,ks.j.tableRowHeight,0);i>n*t?r.get_currentNode().setValue(ks.j.tableRowHeight,i/t):r.get_currentNode().removeProperty(ks.j.tableRowHeight)},e.prototype.insertDeadRow=function(e){var t=new Da.GraphIterator;t.setFrom(e),ld.returnToContainingRow(t);var n=t.get_currentNode();t.goToFirstChildByRole(1);var r=new Da.GraphIterator;r.setFrom(e),ld.returnToContainingTable(r);var i=r.get_currentNode();this.updateMergeCellInfo(r);var o=_c.u.get_instance().createInstance(393251);this.insertRowNode(r,o,n,n,!1),r.goToChild(o);for(var a=dc.TableReader.getColumnCount(i),s=0;s<a;++s){var l=t.get_currentNode(),c=this.createTableCellNode();if(this.addCellNode(r,c,l,!1,!0),!c.get_isGhostCell())if(l.get_isGhostCell()){var u=void 0;(u=l.get_mergeCellInfo().controlCell).set_rowSpan(u.get_rowSpan()+1)}else l.set_rowSpan(2);t.goToNextSiblingByRole(1)}return this.setRowCount(i,dc.TableReader.getRowCount(i)+1),ld.returnToContainingTable(r),this.updateMergeCellInfo(r),o},e.prototype.insertDeadCol=function(e){var t=Da.GraphIterator.createFromNode(e.useIAncestorOfType(14)),n=dc.TableReader.getColumnCount(t.get_currentNode()),r=sd.e(e),i=r+1;this.updateMergeCellInfo(t),t.goToFirstChildByRole(1);do{var o=t.goToChildIndexByRole(r,1);t.returnToParent();var a=this.createTableCellNode();if(this.insertCellNode(t,a,o,!1,!1),!a.get_isGhostCell())if(o.get_isGhostCell()){var s=void 0;(s=o.get_mergeCellInfo().controlCell).set_colSpan(s.get_colSpan()+1)}else o.set_colSpan(2)}while(t.goToNextSiblingByRoleOrReturnToParent(1));this.updateMergeCellInfo(t);var l=t.get_currentNode().getValueWithDefault(Array,Kc.b.tableColumnWidths,null);return l&&(l=ku.v(l)),this.setColumnCount(t.get_currentNode(),++n),l&&(Array.insert(l,i,l[r]),t.get_currentNode().setValue(Kc.b.tableColumnWidths,l)),this.onInsertColumnsCompleted(t.get_currentNode(),i,!1,1,null),i},e.prototype.removeDeadCells=function(e,t){var n=this;dc.TableReader.isComplexTableNode(e.get_currentNode())&&us.n.get_instance().get_item(63)&&this.removeDeadCellsImpl(e,(function(e){return n.getHeightFromRow(e,t)}),(function(e,t){e.setProperty_Unchecked(ks.j.tableRowHeight,t)}),ks.j.complexTable)},e.prototype.handleInsertCellWithMerged=function(t,n,r,i){var o=n,a=n.get_mergeCellInfo();if(us.n.get_instance().get_item(77)&&t.set_isGhostCell(!1),a)if(e.getOffSet(a,!i))t.set_isGhostCell(!0);else{var s=e.getCellSpan(a.controlCell,i);!n.get_isGhostCell()&&r||!r&&e.getOffSet(a,i)===s-1?(o=a.controlCell,!i&&o.get_hasRowSpan()&&t.set_rowSpan(o.get_rowSpan())):(t.set_isGhostCell(!0),e.setCellSpan(a.controlCell,i,s+1)),i&&o.get_hasColSpan()&&t.set_colSpan(o.get_colSpan())}return o},e.prototype.handleDeleteCell=function(t,n,r){var i=t.get_mergeCellInfo();if(i)if(t.get_isGhostCell())this.handleGhostCellDeletion(t,i,n);else{var o=e.getCellSpan(t,n);if(o>1){var a=e.getCellSpan(t,!n),s=new Da.GraphIterator;s.set(t),s.tryToRootAtAncestorOfType(14);var l=new Da.GraphIterator;l.setFrom(s);var c=n?ld.moveToNextRow(l):l.goToNextSiblingByRole(1);e.setCellSpan(c,n,o-1),e.setCellSpan(c,!n,a),r(l,s)}}},e.prototype.handleGhostCellDeletion=function(t,n,r){if(!e.getOffSet(n,!r)){var i=e.getCellSpan(n.controlCell,r);e.setCellSpan(n.controlCell,r,i-1)}},e.prototype.updateIsComplexTableProperty=function(e,t){var n=!1;ld.forEachCellInTable(e,(function(e,t,r){return!Zc.isGhostCell(e)||(n=!0,!1)})),e.get_currentNode().setProperty_Unchecked(t,n)},e.prototype.removeDeadCellsImpl=function(e,t,n,r){var i=dc.TableReader.getRowCount(e.get_currentNode()),o=dc.TableReader.getColumnCount(e.get_currentNode());if(i&&o){var a=!1,s=!1,l=new Array(i);ld.forEachCellInTable(e,(function(e,t,n){n||(l[t]=new Array(o));var r=e.get_currentNode();return r.get_isGhostCell()?Zc.isSkippedCell(r)?l[t][n]=2:l[t][n]=1:l[t][n]=0,!0}));for(var c=new Array(i),u=new Array(i),g=0;g<i;g++){for(var p=!!g,d=!0,h=0;h<o;h++){if(!l[g][h]){p=!1,d=!1;break}1===l[g][h]?d=!1:g&&2===l[g-1][h]||(p=!1)}c[g]=p,u[g]=d}for(g=i-1;g>=0;g--)if(u[g])e.goToChildIndexByRole(g,1),this.deleteRows(e,1),Array.removeAt(l,g),a=!0;else if(c[g]&&t){e.goToChildIndexByRole(g,1);var _=e.getPreviousSiblingByRole(1);n(_,t(e.get_currentNode())+t(_)),this.deleteRows(e,1),Array.removeAt(l,g),a=!0}if((i=l.length)>0){c=new Array(o),u=new Array(o);for(h=0;h<o;h++){var m=!!h,f=!0;for(g=0;g<i;g++){if(!l[g][h]){m=!1,f=!1;break}1===l[g][h]?f=!1:h&&2===l[g][h-1]||(m=!1)}c[h]=m,u[h]=f}var y=e.get_currentNode().getValueWithDefault(Array,Kc.b.tableColumnWidths,null),C=!1;if(y){C=!0,y=Array.clone(y);for(g=0;g<y.length;g++)if(!y[g]){C=!1;break}}for(h=o-1;h>=0;h--)u[h]?(y&&Array.removeAt(y,h),this.deleteColumns(e,h,1),s=!0):c[h]&&C&&(y[h-1]+=y[h],Array.removeAt(y,h),this.deleteColumns(e,h,1),s=!0);s&&y&&e.get_currentNode().setValue(Kc.b.tableColumnWidths,y)}(a||s)&&this.updateIsComplexTableProperty(e,r)}},e.prototype.getHeightFromRow=function(e,t){var n=cd.n(e);if(!n){var r=e.getHtmlViewElement(t);r&&(n=Jg.YW(r.get_htmlElement().offsetHeight))}return n},e.prototype.get_tableLoggingCategory=function(){return"Tables"},e.prototype.setRowCount=function(e,t){dc.TableReader.getRowCount(e)!==t&&e.get_properties().setValue(Kc.b.tableRowCount,t)},e.prototype.setColumnCount=function(e,t){var n=dc.TableReader.getColumnCount(e);n!==t&&(t&&n&&e.get_properties().removeProperties(Kc.b.tableColumnWidths,Kc.b.tableLockedColumns),e.get_properties().setValue(Kc.b.tableColumnCount,t))},e.prototype.createTable=function(e,t,n,r,i,o){void 0===r&&(r=null),void 0===i&&(i=!1),void 0===o&&(o=!1);var a=this.createTableInternal(e,t,n);return us.n.get_instance().get_item(71)&&Tc.StyleReader.get_tableStyleReader()&&Tc.StyleReader.get_tableStyleReader().onBeforeTableInsert(a),this.finishCreateTable(a,t,n,r,i,o),us.n.get_instance().get_item(71)&&Tc.StyleReader.get_tableStyleReader()&&Tc.StyleReader.get_tableStyleReader().onAfterTableInsert(a),a},e.prototype.createTableInternal=function(e,t,n){if(us.n.get_instance().get_item(63)&&dc.TableReader.isInTable(e)){var r=ld.getContainingTable(e);r&&this.setColumnWidths(r)}var i=_c.u.get_instance().createInstance(393250);return e.addChild(i,2),e.goToChild(i),i},e.prototype.recreatePastedTable=function(e,t,n,r,i,o,a){var s=this.createTableInternal(e,t,n);return us.n.get_instance().get_item(71)&&Tc.StyleReader.get_tableStyleReader()&&Tc.StyleReader.get_tableStyleReader().decorateNewTable(s,r,i),this.finishCreateTable(s,t,n,o,!1,a),C.ULS.sendTraceTag(50373653,324,50,String.format("Table pasted: TableId={0}, RowCount={1}, ColumnCount={2}",s.get_id().toString(),t,n)),s},e.prototype.finishCreateTable=function(e,t,n,r,i,o){void 0===r&&(r=null),void 0===i&&(i=!1),void 0===o&&(o=!1);var a=Da.GraphIterator.createFromNode(e);this.createRowsAndColumns(a,t,n,r,i),this.setRowCount(e,t),this.setColumnCount(e,n),us.n.get_instance().get_item(63)&&(this.setNewWordTableColumnWidth(e,n),this.setNewWordTableLayout(e)),e.setValue(Kc.b.tableBordersVisible,!o)},e.prototype.createRowsAndColumns=function(e,t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=!1);for(var o=0;o<t;++o){var a=new Vf.o;e.addChild(a,1),us.n.get_instance().get_item(55)&&a.setValue(ks.j.wordId,jc.K())}var s=null,l=!0;e.goToFirstChildByRole(1);do{for(var c=0;c<n;++c){var u=this.createTableCellNode();e.addChild(u,1),this.finishCell(e,u,i,r,(0,p.m)((function(){return s}),(function(e){return s=e})),(0,p.m)((function(){return l}),(function(e){return l=e}))),ld.returnToContainingRow(e)}}while(e.goToNextSiblingByRoleOrReturnToParent(1))},e.prototype.finishCell=function(t,n,r,i,o,a){t.goToChild(n),o.val&&r?e._outlineElementEditor.cloneEmptyParagraphElement(t,o.val):(e._outlineEditor.appendOutlineElement(t,!0,i),!a.val&&r&&(o.val=new Da.GraphIterator,o.val.setFrom(t)),a.val=!1)},e.prototype.insertRows=function(e,t,n,r){var i=new Da.GraphIterator;i.setFrom(e);var o,a=i.get_currentNode();i.goToFirstChildByRole(1);var s=cd.z(e);t?o=e.goToPreviousSiblingByRole(1):(o=e.get_currentNode(),s++);var l=e.returnToParent();us.n.get_instance().get_item(63)&&this.setTableAndParentTableColumnWidths(e.get_currentNode()),this.updateMergeCellInfo(e);for(var c=null,u=null,g=0;g<n;++g){var p=_c.u.get_instance().createInstance(393251);u||(u=p),c=p,this.insertRowNode(e,p,o,a,t)}var d=dc.TableReader.getColumnCount(e.get_currentNode()),h=!0;do{h?(e.goToChild(c),h=!1):e.goToNextSiblingByRole(1);for(var _=0;_<d;++_){var m=this.createTableCellNode(),f=this.addCellNode(e,m,i.get_currentNode(),t,!0);this.appendNonGhostCellOutlineElement(e,m,r(f)),i.goToNextSiblingByRole(1)}i.goToFirstSiblingByRole(1)}while(e.get_currentNode()!==u);return this.setRowCount(l,dc.TableReader.getRowCount(l)+n),this.onInsertRowsCompleted(l,t,s,n),e.get_currentNode()},e.prototype.deleteRows=function(e,t){var n=cd.z(e),r=n+t;e.returnToParent(),us.n.get_instance().get_item(63)&&this.setTableAndParentTableColumnWidths(e.get_currentNode()),this.updateMergeCellInfo(e);for(var i=r-1;i>=n;--i){e.goToChildIndexByRole(i,1);for(var o=e.goToFirstChildByRole(1);o;)this.onCellDeleted(o,!0),o=e.goToNextSiblingByRoleOrReturnToParent(1);this.handlePargraphDeletion(e),e.disconnectNodeAndReturnToParent()}this.setRowCount(e.get_currentNode(),dc.TableReader.getRowCount(e.get_currentNode())-t),this.onDeleteRowsCompleted(e,n,t)},e.prototype.insertColumns=function(e,t,n,r,i){us.n.get_instance().get_item(63)&&this.setTableAndParentTableColumnWidths(e.get_currentNode()),this.updateMergeCellInfo(e);var o=dc.TableReader.getColumnCount(e.get_currentNode());-1===t&&(t=o);var a=n?t:t-1;e.goToFirstChildByRole(1);do{var s=e.goToChildIndexByRole(a,1);e.returnToParent();new Array(r);for(var l=0;l<r;++l){var c=this.createTableCellNode(),u=this.insertCellNode(e,c,s,n,!1);this.appendNonGhostCellOutlineElement(e,c,i(u))}}while(e.goToNextSiblingByRoleOrReturnToParent(1));o+=r,this.recomputeAndSetColumnWidthsAfterColInsertion(e,o,r,t,n),this.onInsertColumnsCompleted(e.get_currentNode(),t,n,r,i)},e.prototype.recomputeAndSetColumnWidthsAfterColInsertion=function(e,t,n,r,i){var o=e.get_currentNode().getValueWithDefault(Array,Kc.b.tableLockedColumns,null),a=e.get_currentNode().getValueWithDefault(Array,Kc.b.tableColumnWidths,null);if(o&&(o=ku.v(o)),a&&(a=ku.v(a)),this.setColumnCount(e.get_currentNode(),t),us.n.get_instance().get_item(30)&&o){for(var s=new Array(t),l=0;l<r;++l)s[l]=o[l];for(;l<r+n;++l)s[l]=!1;for(;l<t;++l)s[l]=o[l-n];e.get_currentNode().setValue(Kc.b.tableLockedColumns,s)}if(a){var c=this.ajustColumnWidthsAfterInsertColumn(e,a,t,r,i,n);e.get_currentNode().setValue(Kc.b.tableColumnWidths,c)}},e.prototype.ajustColumnWidthsAfterInsertColumn=function(e,t,n,r,i,o){for(var a=new Array(n),s=0,l=0;s<r;++s)a[s]=t[s],l+=a[s];for(;s<n;++s)a[s]=s-o<0?t[0]:t[s-o],l+=a[s];if(us.n.get_instance().get_item(63)){var c=this.getTableWidthMus(e.get_currentNode());if(l>c){var u=c/l;for(s=0;s<n;++s)a[s]=Math.max(Hh.y(Kf.i(),0),a[s]*u)}}return a},e.prototype.onInsertColumnsCompleted=function(e,t,n,r,i){},e.prototype.onInsertRowsCompleted=function(e,t,n,r){},e.prototype.insertRowNode=function(t,n,r,i,o){t.insertChildUsingId(n,r,1,e._getIdForNewCell?e._getIdForNewCell():null)},e.prototype.insertCellNode=function(t,n,r,i,o){t.goToChild(r);var a=i?t.getPreviousSiblingByRole(1):r;return t.returnToParent(),t.insertChildUsingId(n,a,1,e._getIdForNewCell?e._getIdForNewCell():null),r},e.prototype.getNodeToInsertAfter=function(e,t,n){e.goToChild(t);var r=n?e.getPreviousSiblingByRole(1):t;return e.returnToParent(),r},e.prototype.addCellNode=function(t,n,r,i,o){return t.addChildUsingId(n,1,e._getIdForNewCell?e._getIdForNewCell():null),r},e.prototype.copyCells=function(e,t,n,r,i){return n},e.prototype.appendNonGhostCellOutlineElement=function(t,n,r){Zc.isGhostCellNode(n)||(t.goToChild(n),e._outlineEditor.appendOutlineElement(t,!0,r),ld.returnToContainingRow(t))},e.prototype.deleteColumns=function(e,t,n){us.n.get_instance().get_item(63)&&this.setTableAndParentTableColumnWidths(e.get_currentNode()),this.updateMergeCellInfo(e);var r=dc.TableReader.getColumnCount(e.get_currentNode());-1===t&&(t=r-n),e.goToFirstChildByRole(1);do{for(var i=t+n-1;i>=t;--i)e.goToChildIndexByRole(i,1),this.onCellDeleted(e.get_currentNode(),!1),this.handlePargraphDeletion(e),e.disconnectNodeAndReturnToParent()}while(e.goToNextSiblingByRoleOrReturnToParent(1));r-=n,this.recomputeAndSetColumnWidthsAfterColDeletion(e,r,t,n),this.onDeleteColumnsCompleted(e,t,n)},e.prototype.recomputeAndSetColumnWidthsAfterColDeletion=function(e,t,n,r){var i=e.get_currentNode().getValueWithDefault(Array,Kc.b.tableLockedColumns,null),o=e.get_currentNode().getValueWithDefault(Array,Kc.b.tableColumnWidths,null);if(i&&(i=ku.v(i)),o&&(o=ku.v(o)),this.setColumnCount(e.get_currentNode(),t),i){for(var a=new Array(t),s=0;s<n;++s)a[s]=i[s];for(;s<t;++s)a[s]=i[s+r];e.get_currentNode().setValue(Kc.b.tableLockedColumns,a)}if(o){var l=new Array(t);for(s=0;s<n;++s)l[s]=o[s];for(;s<t;++s)l[s]=o[s+r];e.get_currentNode().setValue(Kc.b.tableColumnWidths,l)}},e.prototype.mergeCells=function(e,t,n){},e.prototype.splitCell=function(e,t,n){},e.prototype.onCellDeleted=function(e,t){},e.prototype.promoteToNonGhostCellImpl=function(e,t){},e.prototype.onDeleteRowsCompleted=function(e,t,n){},e.prototype.onDeleteColumnsCompleted=function(e,t,n){},e.prototype.onMergeCellsCompleted=function(e){},e.prototype.onSplitCellsCompleted=function(e){},e.prototype.deleteColumnsContainingCell=function(e,t){var n=sd.e(e);e.returnToParent(),e.returnToParent(),this.deleteColumns(e,n,t)},e.prototype.createTableCellNode=function(){var e=_c.u.get_instance().createInstance(393252);return e.setValue(Kc.b.outlineElementChildLevel,Cc.k.first),new Xc.OutlineIndentInfo(!0).saveToProperty(e),e},e.prototype.setJustification=function(e,t){e.setValue(Kc.b.layoutAlignmentInParent,t),e.setValue(Kc.b.layoutAlignmentSelf,t)},e.prototype.clearColumnWidth=function(e,t){},e.prototype.clearAllColumnWidths=function(e){e.removeProperties(Kc.b.tableLockedColumns,Kc.b.tableColumnWidths)},e.prototype.setColumnWidthsMu=function(e,t,n){var r=dc.TableReader.getColumnCount(e),i=e.getValueWithDefault(Array,Kc.b.tableLockedColumns,null);i=i?ku.v(i):new Array(r);var o=e.getValueWithDefault(Array,Kc.b.tableColumnWidths,null);o=o?ku.v(o):new Array(r),i[t]=!0,o[t]=n;var a=null;if(us.n.get_instance().get_item(45)&&this._trackChangeManager&&this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeManager.get_changeTrackingDocumentSettingEnabled()&&this._trackChangeManager.get_trackTableFormattingIsEnabled()){var s=(0,f.e)(Ac.f,e);s&&(a=s.preparePreviousFormatProperties())}e.setValue(Kc.b.tableColumnWidths,o),e.setValue(Kc.b.tableLockedColumns,i),us.n.get_instance().get_item(45)&&this._trackChangeManager&&this._trackChangeEditor&&this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeManager.get_changeTrackingDocumentSettingEnabled()&&this._trackChangeEditor.setTableFormatChange(e,a)},e.prototype.setRowHeightMu=function(e,t){e.setValue(ks.j.tableRowHeight,t)},e.prototype.setTableAltTextDescription=function(e,t){},e.prototype.setTableAltTextTitle=function(e,t){},e.get_formattingEditor=function(){return e._formattingEditor||(e._formattingEditor=se.w.get_instance().resolve(xs.z))},e.get_featureHelper=function(){return e._featureHelper||(e._featureHelper=se.w.get_instance().tryResolve($p.d))},e.getOutlineElementInfoFromCell=function(t,n){void 0===n&&(n=!0);var r=new Gf.d;if(t){var i=null,o=ss.SelectionFactory.createCollapsedSelection(t,n);if(o){for(var a=0;a<o.get_length();a++)if(Ps.FormattingReader.containsFormatting(o.get_item(a))){i=o.get_item(a);break}}else C.ULS.sendTraceTag(19244694,315,10,"Unexpected null selection.");if(i){var s=Ps.FormattingReader.getFormattingObject(i);s.get_cache().get_isLink()&&(s=s.cloneUnderDifferentChp(null),e.get_formattingEditor().removeLinkFormatting(s)),r.formatting=s.get_formattingId(),r.languageId=Ps.FormattingReader.language(s),us.n.get_instance().get_item(71)&&(r.style=Tc.StyleReader.getStyleFromParagraphNode(i.get_node()))}}return r},e.setCellSpan=function(e,t,n){t?e.set_rowSpan(n):e.set_colSpan(n)},e.getCellSpan=function(e,t){return t?e.get_rowSpan():e.get_colSpan()},e.getOffSet=function(e,t){return t?e.rowOffset:e.colOffset},e.getFirstGhostCell=function(e,t){return t?e.firstGhostCellInSameRow:e.firstGhostCellInSameColumn},e.clearColumnWidth_TableLockedColumnsProperty=function(e,t,n){var r=e.getValueWithDefault(Array,Kc.b.tableLockedColumns,null);(r=r?ku.v(r):new Array(n))[t]=!1,e.setValue(Kc.b.tableLockedColumns,r)},e.clearColumnWidth_TableColumnWidthsProperty=function(e,t,n){var r=e.getValueWithDefault(Array,Kc.b.tableColumnWidths,null);(r=r?ku.v(r):new Array(n))[t]=0,e.setValue(Kc.b.tableColumnWidths,r)},e._formattingEditor=null,e._featureHelper=null,e._outlineEditor=null,e._outlineElementEditor=null,e._getIdForNewCell=null,e}();(0,o.l)(qf,"TableEditor$0",null,[cu.z]);var jf=function(){function e(e,t,n,r,i,a){this.inputElement=null,this.tooltipContainerElement=null,this.tooltipContentElement=null,this.visible=!1,this.timer=0,this.maxInputNumber=0,this.minInputNumber=0,this.currentSpan=0,this.nonNumericTooltipText=null,this.overSizeTooltipText=null,this.nonNegUnderSizeTooltipText=null,this.negUnderSizeTooltipText=null,this.notMultipleOrFactorTooltipText=null,this.visible=!1,this.minInputNumber=r,this.maxInputNumber=i,this.inputElement=e,this.currentSpan=a,this.tooltipContainerElement=document.getElementById(t),this.tooltipContentElement=document.getElementById(n),this.tooltipContainerElement.style.display="none",this.overSizeTooltipText=String.format(Box4Intl.Box4Strings.l_TableOverSizeWarningMessage,i),this.nonNegUnderSizeTooltipText=String.format(Box4Intl.Box4Strings.l_TableNonNegUnderSizeWarningMessage,r),this.negUnderSizeTooltipText=Box4Intl.Box4Strings.l_TableNegUnderSizeWarningMessage,this.nonNumericTooltipText=Box4Intl.Box4Strings.l_TableNonNumericWarningMessage,this.notMultipleOrFactorTooltipText=String.format(Box4Intl.Box4Strings.l_TableNotMultipleOrFactorOfSpanWarningMessage,a),qo.n.addHandler(e,Le.d.blur,o.i(this,this.onInputBlur,"onInputBlur")),qo.n.addHandler(e,Le.d.keyUp,o.i(this,this.onInputChange,"onInputChange"))}return e.prototype.inputValueUpdated=function(){var e;if(this.tryParseInt(this.inputElement.value,(0,p.m)((function(){return e}),(function(t){return e=t}))))if(e>this.maxInputNumber)this.tooltipContentElement.innerText=this.overSizeTooltipText,this.popup();else if(e>=0&&e<this.minInputNumber)this.tooltipContentElement.innerText=this.nonNegUnderSizeTooltipText,this.popup();else if(e<0)this.tooltipContentElement.innerText=this.negUnderSizeTooltipText,this.popup();else{if(!(e%this.currentSpan&&this.currentSpan%e))return this.hide(),!0;this.tooltipContentElement.innerText=this.notMultipleOrFactorTooltipText,this.popup()}else this.tooltipContentElement.innerText=this.nonNumericTooltipText,this.popup();return!1},e.prototype.popup=function(){this.visible?(this.clearTimer(),this.setTimer()):(this.visible=!0,this.tooltipContainerElement.style.display="",this.setTimer())},e.prototype.hide=function(){this.clearTimer(),this.tooltipContainerElement.style.display="none",this.visible=!1},e.prototype.dispose=function(){this.hide(),qo.n.removeHandler(this.inputElement,Le.d.blur,o.i(this,this.onInputBlur,"onInputBlur")),qo.n.removeHandler(this.inputElement,Le.d.keyUp,o.i(this,this.onInputChange,"onInputChange"))},e.prototype.tryParseInt=function(t,n){return n.val=0,!!e.numericRegEx.test(t)&&(n.val=parseInt(t),!0)},e.prototype.onInputBlur=function(e){this.hide()},e.prototype.onInputChange=function(e){this.inputValueUpdated()},e.prototype.setTimer=function(){this.timer=window.setTimeout(o.i(this,this.hide,"hide"),1e4)},e.prototype.clearTimer=function(){window.clearTimeout(this.timer)},e.numericRegEx=new RegExp("^(\\+|\\-)?[0-9]*$"),e}();(0,o.l)(jf,"TableSizeDialogTooltip",null,[]);var $f=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,Box4Intl.Box4Strings.l_TableDialogColumnLabelText,Box4Intl.Box4Strings.l_TableDialogRowLabelText)},e.dialogHtmlFormat="<div class='WACDialogRow' id='RowTableSize'> <div class='WacDialogLabels' id='TableSizeDialogLabels'> <label id='TableSizeDialogColumn' class='DialogSpinnerLabel' for='TableSizeDialogColumnSpinner'>{0}</label> <br/> <label id='TableSizeDialogRow' class='DialogSpinnerLabel' for='TableSizeDialogRowSpinner'>{1}</label> <br/> </div> <div class='WacSpinnerBox' id='TableSizeDialogSpinners'> <div id='TableSizeDialogColumnSpinnerContainer' class='WacSpinnerBoxes'></div> <div class='InsertTableDialogTooltipContainer' id='TableSizeDialogColumnTooltipContainer'> <div id='TableSizeDialogColumnTooltipContent' class='InsertTableDialogTooltipContent'></div> </div> <br/> <div id='TableSizeDialogRowSpinnerContainer' class='WacSpinnerBoxes'></div> <div class='InsertTableDialogTooltipContainer' id='TableSizeDialogRowTooltipContainer'> <div id='TableSizeDialogRowTooltipContent' class='InsertTableDialogTooltipContent'></div> </div> <br/> </div> </div>",e}();(0,o.l)($f,"TableSizeDialogHtml",null,[]);var Qf="TableSizeDialog",Jf=function(e){function t(t,n,r,i,a,s,l,c,u,g){var p=e.call(this)||this;return p.disposing=!1,p.properties=null,p.callback=null,p.tooltipControls=null,p.minRowCount=0,p.minColCount=0,p.maxRowCount=0,p.maxColCount=0,p.defRowCount=0,p.defColCount=0,p.colIncrement=0,p.rowIncrement=0,p.standaloneRoot=se.w.get_instance().resolve(ou.r).get_sharedStandaloneRoot(),p.properties={},p.disposing=!1,p.tooltipControls={},p.minRowCount=r,p.minColCount=i,p.maxRowCount=a,p.maxColCount=s,p.defRowCount=l,p.defColCount=c,p.rowIncrement=u,p.colIncrement=g,p.callback=n,p.set_dialogHtml($f.get_dialogHtml()),p.set_dialogId(Qf),p.initializeAndShow(t,o.i(p,p.tableSizeDialogResultHandler,"tableSizeDialogResultHandler"),null),p.initializeSpinners(),p}return(0,S.t)(t,e),t.prototype.onInnerHtmlSet=function(){var e=String.format(Box4Intl.Box4Strings.l_TableSizeHoverMessage,this.minColCount,this.maxColCount),t=String.format(Box4Intl.Box4Strings.l_TableSizeHoverMessage,this.minRowCount,this.maxRowCount);this.buildTableSizeDialogSpinner("TableSizeDialogColumnSpinnerContainer","TableSizeDialogColumnSpinner","TableSizeDialogColumnTooltipContainer","TableSizeDialogColumnTooltipContent",ii.JV,ii.KI,e,this.minColCount,this.maxColCount,this.colIncrement),this.buildTableSizeDialogSpinner("TableSizeDialogRowSpinnerContainer","TableSizeDialogRowSpinner","TableSizeDialogRowTooltipContainer","TableSizeDialogRowTooltipContent",ii.Cy,ii.ox,t,this.minRowCount,this.maxRowCount,this.rowIncrement)},t.prototype.initializeSpinners=function(){for(var e=t.get_spinnerCommandIds(),n=0;n<e.length;n++)Zu.attachCommandHandlers(e[n],o.i(this,this.setAdvancedControlValue,"setAdvancedControlValue"),o.i(this,this.getAdvancedControlValue,"getAdvancedControlValue"));this.standaloneRoot.pollForControlState("TableSizeDialogColumnSpinner"),this.standaloneRoot.pollForControlState("TableSizeDialogRowSpinner")},t.prototype.getAdvancedControlValue=function(e,t){var n=this.fieldNameFromCommandId(e);if(this.properties[n])t[Ho.Number]=this.properties[n];else{var r=e===ii.KI?this.defColCount:this.defRowCount;t[Ho.UnitType]=0,t[Ho.Number]=r,this.properties[n]=r}},t.prototype.setAdvancedControlValue=function(e,t){this.properties[this.fieldNameFromCommandId(e)]=parseInt(t[Ho.Number]);var n=this.tooltipControls[e.toString()];n&&n.inputValueUpdated(),this.standaloneRoot.pollForStateAndUpdate()},t.prototype.tableSizeDialogResultHandler=function(e,t){if(1===e){var n=this.properties[this.fieldNameFromCommandId(ii.Cy)],r=this.properties[this.fieldNameFromCommandId(ii.JV)];this.callback(n?parseInt(n):this.defRowCount,r?parseInt(r):this.defColCount)}this.dispose()},t.prototype.dispose=function(){if(!this.disposing){this.disposing=!0,this.tooltipControls[2781309760].dispose(),this.tooltipControls[3232519678].dispose();for(var n=t.get_spinnerCommandIds(),r=0;r<n.length;r++)Zu.detachCommandHandlers(n[r]);this.standaloneRoot.removeControl("TableSizeDialogColumnSpinner"),this.standaloneRoot.removeControl("TableSizeDialogRowSpinner"),e.prototype.dispose.call(this)}},t.prototype.buildTableSizeDialogSpinner=function(e,t,n,r,i,o,a,s,l,c){var u=this.buildTableSizeSpinnerXml(t,i,o,a,s,l,c);this.attachSpinner(u,e,t,n,r,i,s,l,c)},t.prototype.attachSpinner=function(e,t,n,r,i,o,a,s,l){var c=document.getElementById(t);this.standaloneRoot.addControl(n,e);var u=this.standaloneRoot.getDOMElementForControlDisplayMode(n,"Medium");this.tooltipControls[o.toString()]=new jf(u.children[0],r,i,a,s,l),c.appendChild(u)},t.prototype.buildTableSizeSpinnerXml=function(e,t,n,r,i,o,a){return Tu.ws(e,t,n,r,[this.buildTableSizeUnitXml(i,o,a)])},t.prototype.buildTableSizeUnitXml=function(e,t,n){return Tu.nf("none",e.toString(),t.toString(),n.toString())},t.prototype.fieldNameFromCommandId=function(e){switch(e){case ii.Cy:case ii.ox:return"rows";case ii.JV:case ii.KI:return"columns"}return null},t.get_spinnerCommandIds=function(){return[ii.JV,ii.Cy,ii.KI,ii.ox]},t}(ri.o);(0,o.l)(Jf,"TableSizeDialog",ri.o,[]);var Xf=function(){function e(e){this._nodeRef=null,this._offset=0,this._ccIndex=0,Pa.SelectionEditor.isInsertionPointSelection(e)||(e=Pa.SelectionEditor.collapseToIp(e,!0,!1));var t=e.get_firstContext(),n=new Da.GraphIterator;n.set(t.get_node()),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(n),Pa.SelectionEditor.isInsertionPointContext(t)&&(this._offset=t.get_cpBegin(),this._ccIndex=t.get_ccBoundaryIdxAtCpBegin()),Pa.SelectionEditor.isAnchoredObjectContext(t)&&n.returnToAncestorOfType(12),this._nodeRef=new Em(n)}return e.prototype.restore=function(){var e=new Da.GraphIterator;this._nodeRef.setFilter(o.i(this,this.selectableFilter,"selectableFilter"),null);var t=new Fm,n=new Fm;if(this._nodeRef.restoreDetailed(e,n,t),cs.ParagraphReader.canContainIpOrTextRange(e.get_currentNode())){if(!n.value&&t.value)return ss.SelectionFactory.createCollapsedSelection(e.get_currentNode(),!1);var r=_s.y.createIpContext(e.get_currentNode(),this._offset);if(-1!==this._ccIndex){var i=cs.ParagraphReader.getContentControlCountAtCp(e.get_currentNode(),this._offset);this._ccIndex>0&&this._ccIndex<=i&&(r.set_ccBoundaryIdxAtCpBegin(this._ccIndex),r.set_ccBoundaryIdxAtCpEnd(this._ccIndex))}return ss.SelectionFactory.createSelectionFromContext(r)}if(e.get_currentNode().get_isSelectable())return Pa.SelectionEditor.collapseToIp(ss.SelectionFactory.createSelectionFromNode(e.get_currentNode()),!t.value,!1);var a=Pa.SelectionEditor.findFirstOrLastSelectableContentNode(e,!t.value);return a?cs.ParagraphReader.canContainIpOrTextRange(a)?ss.SelectionFactory.createIpSelection(a,t.value?cs.ParagraphReader.textLength(a):0):ss.SelectionFactory.createSelectionFromNode(a):null},e.prototype.selectableFilter=function(e,t){return e.get_currentNode().get_isSelectableContentContainer()||e.get_currentNode().get_isSelectableContent()},e}();(0,o.l)(Xf,"IpReference",null,[]);var Yf,Zf=n(3672);!function(e){e[e.unspecified=-1]="unspecified",e[e.none=0]="none",e[e.left=1]="left",e[e.center=2]="center",e[e.right=3]="right",e[e.inner=4]="inner",e[e.outer=5]="outer",e[e.both=6]="both",e[e.distribute=7]="distribute",e[e.margin=8]="margin",e[e.highKashida=9]="highKashida",e[e.lowKashida=10]="lowKashida",e[e.mediumKashida=11]="mediumKashida",e[e.numTab=12]="numTab",e[e.thaiDistribute=13]="thaiDistribute",e[e.start=14]="start",e[e.end=15]="end"}(Yf||(Yf={})),(0,o.h)("Justification",Yf);var ey=n(311),ty=function(){return function(){this.forceDeletion=!1}}();(0,o.l)(ty,"TrackChangeDeletionActionData",null,[]);var ny=function(){function e(){}return e.get_ccConfigSettings=function(){return e._ccConfigSettings||(e._ccConfigSettings=se.w.get_instance().tryResolve(Cf.i))},e.get_autoCorrectScheduler=function(){return e._autoCorrectScheduler||(e._autoCorrectScheduler=se.w.get_instance().tryResolve(qa.g))},e.get_paragraphIndentationReader=function(){return e._paragraphIndentationReader||(e._paragraphIndentationReader=se.w.get_instance().resolve(Yd.p))},e.get_tableAltTextDialog=function(){return e._tableAltTextDialog||(e._tableAltTextDialog=se.w.get_instance().tryResolve(lg))},e.get_deleteTableSegmentStrategy=function(){return e._deleteTableSegmentStrategy||(e._deleteTableSegmentStrategy=se.w.get_instance().resolve(Td))},e.get_externalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=se.w.get_instance().resolveFuture(gh.i))},e.get_getNewOutlineElementInfoDelegate=function(){return e._getNewOutlineElementInfoDelegate||(e._getNewOutlineElementInfoDelegate=function(e){return qf.getOutlineElementInfoFromCell(e)})},e.set_getNewOutlineElementInfoDelegate=function(t){return e._getNewOutlineElementInfoDelegate=t,t},e.get_getRefRowWhenInsertRowDelegate=function(){return e._getRefRowWhenInsertRowDelegate||(e._getRefRowWhenInsertRowDelegate=e.getRefRowWhenInsertRowImpl)},e.set_getRefRowWhenInsertRowDelegate=function(t){return e._getRefRowWhenInsertRowDelegate=t,t},e.get_getRefCellWhenInsertColumnDelegate=function(){return e._getRefCellWhenInsertColumnDelegate||(e._getRefCellWhenInsertColumnDelegate=e.getRefCellWhenInsertColumnImpl)},e.set_getRefCellWhenInsertColumnDelegate=function(t){return e._getRefCellWhenInsertColumnDelegate=t,t},e.get_getRefColumnFromRefCellDelegate=function(){return e._getRefColumnFromRefCellDelegate||(e._getRefColumnFromRefCellDelegate=e.getRefColumnFromRefCellImpl)},e.set_getRefColumnFromRefCellDelegate=function(t){return e._getRefColumnFromRefCellDelegate=t,t},e.get_getRefColumnsWhenSelectColumnDelegate=function(){return e._getRefColumnsWhenSelectColumnDelegate||(e._getRefColumnsWhenSelectColumnDelegate=e.getRefColumnsWhenSelectColumnImpl)},e.set_getRefColumnsWhenSelectColumnDelegate=function(t){return e._getRefColumnsWhenSelectColumnDelegate=t,t},e.get_getRefRowsWhenSelectRowDelegate=function(){return e._getRefRowsWhenSelectRowDelegate||(e._getRefRowsWhenSelectRowDelegate=e.getRefRowsWhenSelectRowImpl)},e.set_getRefRowsWhenSelectRowDelegate=function(t){return e._getRefRowsWhenSelectRowDelegate=t,t},e.get_gotoFocusCellAfterInsertColumnDelegate=function(){return e._gotoFocusCellAfterInsertColumnDelegate||(e._gotoFocusCellAfterInsertColumnDelegate=e.gotoFocusCellAfterInsertColumnImpl)},e.set_gotoFocusCellAfterInsertColumnDelegate=function(t){return e._gotoFocusCellAfterInsertColumnDelegate=t,t},e.get_getRowOrColumnsForDeleteDelegate=function(){return e._getRowOrColumnsForDeleteDelegate||(e._getRowOrColumnsForDeleteDelegate=e.getRowOrColumnsForDeleteImpl)},e.set_getRowOrColumnsForDeleteDelegate=function(t){return e._getRowOrColumnsForDeleteDelegate=t,t},e.get_isRowOrColumnOperationEnabledDelegate=function(){return e._isRowOrColumnOperationEnabledDelegate||(e._isRowOrColumnOperationEnabledDelegate=e.isRowColumnOperationEnabledForComplexTable)},e.set_isRowOrColumnOperationEnabledDelegate=function(t){return e._isRowOrColumnOperationEnabledDelegate=t,t},e.get_featureHelper=function(){return e._featureHelper||(e._featureHelper=se.w.get_instance().tryResolve($p.d))},e.get_formattingEditor=function(){return e._formattingEditor||(e._formattingEditor=se.w.get_instance().resolve(xs.z))},e.get_trackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},e.get_trackChangeEditor=function(){return e._trackChangeEditor||(e._trackChangeEditor=se.w.get_instance().resolve(cc.x).get_instance())},e.get_changeIdEditor=function(){return e._changeIdEditor||(e._changeIdEditor=se.w.get_instance().resolve(Am.p))},e.get_unsupportedNodeEditor=function(){return wf.q.get_instance()},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_listReader=function(){return e._listReader||(e._listReader=se.w.get_instance().resolve(ts.c))},e.get_listEditor=function(){return e._listEditor||(e._listEditor=se.w.get_instance().resolve(rs.v))},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=se.w.get_instance().resolve(Es.p))},e.get_contentControlChpHelper=function(){return e._contentControlChpHelper||(e._contentControlChpHelper=se.w.get_instance().tryResolve(ff.k))},e.get_contentControlConverter=function(){return e._contentControlConverter||(e._contentControlConverter=se.w.get_instance().tryResolve(lc.t))},e.get_contentControlEditor=function(){return e._contentControlEditor||(e._contentControlEditor=se.w.get_instance().tryResolve(yf.p))},e.get_contextSetEditor=function(){return e._contextSetEditor||(e._contextSetEditor=kf.ContextSetEditor.get_instance())},e.set_contextSetEditor=function(t){return e._contextSetEditor=t,t},e.get_activityManager=function(){return ji.y.get_instance()},e.get_tableEditor=function(){return e._tableEditor||(e._tableEditor=se.w.get_instance().resolve(cu.z))},e.get_isUnblockComplexTableEnabled=function(){return null==e._isUnblockComplexTableEnabled&&(e._isUnblockComplexTableEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UnblockComplexTableIsEnabled")&&!us.n.get_instance().get_item(30)),e._isUnblockComplexTableEnabled},e.get_tableFormattingBugsFixEnabled=function(){return null==e._TableFormattingBugsFixEnabled&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.Common.Flighting.TableFormattingBugsFixIsEnabled"),L.AFrameworkApplication.appSettingsManager?e._TableFormattingBugsFixEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TableFormattingBugsFixIsEnabled"):e._TableFormattingBugsFixEnabled=!1),e._TableFormattingBugsFixEnabled},e.registerActions=function(t){L.AFrameworkApplication.get_theActionManager();var n=function(e){return Tf.generalizeSelectionToOEs(e.get_selectionCollection(),!1)},r=function(t,r,i,o,a){var s=Br.App.theContextSetActor.createDelegatedViewHandler(n);return a[e.cumulativeJustificationKey]={},s(t,r,i,o,a)};e.initializeActionToJustificationMap();var i=L.AFrameworkApplication.get_theActionManager(),o=t.createDelegatedViewHandlerForUniqueNodeOfType(14);i.addAction(ii.eK,cl.n,e.createTableView),i.addAction(ii.eK,cl.V,e.createTable),i.setActionFlags(ii.eK,1028),i.addAction(ii.QL,cl.n,e.insertRowView),i.addAction(ii.QL,cl.D,e.insertRow),i.setActionFlags(ii.QL,1028),i.addAction(ii.cb,cl.n,e.insertRowView),i.addAction(ii.cb,cl.D,e.insertRow),i.setActionFlags(ii.cb,1028),i.addAction(ii.fB,cl.n,e.insertColumnView),i.addAction(ii.fB,cl.M,e.insertColumn),i.setActionFlags(ii.fB,4),i.addAction(ii.RZ,cl.n,e.insertColumnView),i.setActionFlags(ii.RZ,4),i.addAction(ii.sq,cl.n,e.insertColumnView),i.addAction(ii.sq,cl.M,e.insertColumn),i.setActionFlags(ii.sq,4),i.addAction(ii.KP,cl.n,e.insertColumnView),i.setActionFlags(ii.KP,4),i.addAction(ii.qS,cl.n,e.deleteTableSegmentView),i.addAction(ii.qS,cl.M,e.deleteColumn),i.setActionFlags(ii.qS,4),i.addAction(ii.ym,cl.n,e.deleteTableSegmentView),i.addAction(ii.ym,cl.D,e.deleteRow),i.setActionFlags(ii.ym,1028),i.addAction(ii.iL,cl.n,e.deleteTableView),i.addAction(ii.iL,cl.i,e.deleteTable),i.setActionFlags(ii.iL,1028),i.addAction(ii.ze,cl.i,e.collapseTable),i.addAction(ii.ze,cl.n,o),i.setActionFlags(ii.ze,4),i.addAction(ii.gH,cl.n,e.insertTableView),i.addAction(ii.gH,cl.V,e.insertTable),i.setActionFlags(ii.gH,1036),i.addAction(ii.tu,cl.n,e.insertTableDialogHandler),i.setActionFlags(ii.tu,1028),i.addAction(ii.TZ,cl.n,e.mergeCellsView),i.addAction(ii.TZ,cl.M,e.mergeCells),i.setActionFlags(ii.TZ,4),i.addAction(ii.Lo,cl.n,e.splitCellsDialogHandler),i.setActionFlags(ii.Lo,4),i.addAction(ii.Wc,cl.n,e.splitCellsView),i.addAction(ii.Wc,cl.M,e.splitCells),i.setActionFlags(ii.Wc,4),i.addActionWithFlags(ii.KI,cl.n,Zu.queryDialogControl,96),i.addActionWithFlags(ii.ox,cl.n,Zu.queryDialogControl,96),i.addAction(ii.JV,cl.n,Zu.handleDialogControl),i.addAction(ii.Cy,cl.n,Zu.handleDialogControl),i.addAction(ii.UW,cl.n,e.insertTableFlyoutEnabled),i.setActionFlags(ii.UW,1124),i.addAction(ii.FI,cl.n,e.editTableAltText),i.setActionFlags(ii.FI,100),i.addAction(ii.vc,cl.n,e.selectTable),i.addAction(ii.jh,cl.n,e.selectRowView),i.addAction(ii.cl,cl.n,e.selectColumn),i.addAction(ii.pX,cl.n,e.selectCell),i.addAction(ii.KV,cl.n,o),i.addAction(ii.KV,cl.i,e.toggleBorders),i.setActionFlags(ii.KV,4),i.addAction(ii.Kp,cl.n,o),i.addAction(ii.Kp,cl.i,e.queryBordersHidden),i.setActionFlags(ii.Kp,96),us.n.get_instance().get_item(30)&&(i.addAction(ii.wz,cl.n,e.insertColumnView),i.addAction(ii.wz,cl.V,e.insertColumn),i.setActionFlags(ii.wz,4),i.addAction(ii.Jy,cl.V,e.insertRow),i.addAction(ii.Jy,cl.n,e.insertRowView),i.setActionFlags(ii.Jy,4)),i.addAction(ii.KK,cl.n,e.queryTableTabGroup),us.n.get_instance().get_item(63)?i.setActionFlags(ii.KK,96):i.setActionFlags(ii.KK,1124);for(var a=0,s=[ii.fp,ii.xP,ii.dC,ii.Ak,ii.Eu,ii.sj,ii.Tp,ii.oo,ii.Fq,ii.Bo,ii.Jp,ii.dk,ii.Fi,ii.nP,ii.lv,ii.IN];a<s.length;a++){var l=s[a];i.addAction(l,cl.n,e.genericViewActionTableCellHandler),i.addAction(l,cl.M,e.applyTableCellJustification),i.setActionFlags(l,4)}for(var c=0,u=[ii.oe,ii.uC,ii.pB,ii.sn,ii.hr,ii.or,ii.sC,ii.aQ,ii.Sf];c<u.length;c++){l=u[c];i.addAction(l,cl.n,r),i.addAction(l,cl.K,e.queryDirectTableCellParagraphJustification),i.setActionFlags(l,68)}},e.initializeActionToJustificationMap=function(){e._actionIdToVAlignMap.set_item(ii.Eu,e._actionIdToVAlignMap.set_item(ii.oo,e._actionIdToVAlignMap.set_item(ii.Fq,e._actionIdToVAlignMap.set_item(ii.Bo,e._actionIdToVAlignMap.set_item(ii.oe,e._actionIdToVAlignMap.set_item(ii.uC,e._actionIdToVAlignMap.set_item(ii.pB,e.topJustify))))))),e._actionIdToVAlignMap.set_item(ii.sj,e._actionIdToVAlignMap.set_item(ii.Jp,e._actionIdToVAlignMap.set_item(ii.dk,e._actionIdToVAlignMap.set_item(ii.Fi,e._actionIdToVAlignMap.set_item(ii.sn,e._actionIdToVAlignMap.set_item(ii.hr,e._actionIdToVAlignMap.set_item(ii.or,e.middleJustify))))))),e._actionIdToVAlignMap.set_item(ii.Tp,e._actionIdToVAlignMap.set_item(ii.nP,e._actionIdToVAlignMap.set_item(ii.lv,e._actionIdToVAlignMap.set_item(ii.IN,e._actionIdToVAlignMap.set_item(ii.sC,e._actionIdToVAlignMap.set_item(ii.aQ,e._actionIdToVAlignMap.set_item(ii.Sf,e.bottomJustify))))))),e._actionIdToHAlignMap.set_item(ii.fp,e._actionIdToHAlignMap.set_item(ii.oo,e._actionIdToHAlignMap.set_item(ii.Jp,e._actionIdToHAlignMap.set_item(ii.nP,e._actionIdToHAlignMap.set_item(ii.oe,e._actionIdToHAlignMap.set_item(ii.sn,e._actionIdToHAlignMap.set_item(ii.sC,1))))))),e._actionIdToHAlignMap.set_item(ii.xP,e._actionIdToHAlignMap.set_item(ii.Fq,e._actionIdToHAlignMap.set_item(ii.dk,e._actionIdToHAlignMap.set_item(ii.lv,e._actionIdToHAlignMap.set_item(ii.uC,e._actionIdToHAlignMap.set_item(ii.hr,e._actionIdToHAlignMap.set_item(ii.aQ,2))))))),e._actionIdToHAlignMap.set_item(ii.dC,e._actionIdToHAlignMap.set_item(ii.Bo,e._actionIdToHAlignMap.set_item(ii.Fi,e._actionIdToHAlignMap.set_item(ii.IN,e._actionIdToHAlignMap.set_item(ii.pB,e._actionIdToHAlignMap.set_item(ii.or,e._actionIdToHAlignMap.set_item(ii.Sf,3))))))),e._actionIdToHAlignMap.set_item(ii.Ak,6)},e.editTableAltText=function(t,n,r,i,o){if(1===r)return 32;if(!n.view.get_isInteractiveView())return 2;var a=n.view;if(!a.get_selectionManager())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelectionManager}),8;var s=a.get_selectionManager().get_selectionContextForActionDispatch();return(s=e.get_contextSetEditor().attemptToGeneralizeToNodeContextOfType(s,14))?(e.get_tableAltTextDialog().create(s),32):(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.failedToGeneralizeToTable}),8)},e.selectTable=function(t,n,r,i,o){if(Xi.t.mark(5756),!n.view.get_isInteractiveView())return 2;var a=n.view;if(!a.get_selectionManager())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelectionManager}),8;var s=a.get_selectionManager().get_selectionContextForActionDispatch();if(!(s=e.get_contextSetEditor().attemptToGeneralizeToNodeContextOfType(s,14)))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.failedToGeneralizeToTable}),8;if(2===r){var l=null,c=s.get_node(),u=dc.TableReader.isComplexTableNode(c),g=e.get_isUnblockComplexTableEnabled();if(us.n.get_instance().get_item(104)&&(!u||g))if(us.n.get_instance().get_item(77)){var p=ss.SelectionFactory.createTableCellSelectionFromTable(c,g);a.get_selectionManager().setSelectionFromSelectionCollectionAsync(p,null)}else{var d=Da.GraphIterator.createFromNode(c);d.goToFirstChildByRole(1);for(var h=[Sf.TableNodeContext.create(d.get_currentNode())];d.goToNextSiblingByRole(1);)u&&cd.q(d)||Array.add(h,Sf.TableNodeContext.create(d.get_currentNode()));l=new X_.Selection(h,!0)}else l=ss.SelectionFactory.createSelectionFromNode(s.get_node());if(l){var _=new A_.a(null,(function(e,t){return a.get_selectionManager().setSelection(l,e),!1}),null);_.setDebugName("SelectTable"),_.run()}}return Xi.t.mark(5757),32},e.selectRowView=function(t,n,r,i,o){if(Xi.t.mark(5752),!n.view.get_isInteractiveView())return 2;var a=n.view;if(!a.get_selectionManager())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelectionManager}),8;var s=a.get_selectionManager().get_selectionCollection();if(!s)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),2;var l=e.get_getRefRowsWhenSelectRowDelegate()(s);if(32!==l.response)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.failedToGeneralizeToTable}),l.response;if(2===r){var c=l.processContexts,u=c[0].get_node(),g=u,p=Da.GraphIterator.createFromNode(u);p.tryToRootAtAncestorOfType(14);for(var d=null,h=ld.getContainingTable(p),_=dc.TableReader.isComplexTableNode(h),m=e.get_isUnblockComplexTableEnabled(),f=us.n.get_instance().get_item(104)&&(!_||m),y=[],C=0;C<c.length;++C){var S=p.get_currentNode()===c[C].get_node();(S||_&&cd.d(p))&&(g=p.get_currentNode(),!f||_&&cd.q(p)||Array.add(y,Sf.TableNodeContext.create(p.get_currentNode())),ld.moveToNextRow(p),S||--C)}var v=a.get_selectionManager().get_selectionCollection().get_currentSelection(),b=null;if(f)if(us.n.get_instance().get_item(77)){var T=new Da.GraphIterator,A=new Da.GraphIterator;v.isForward?(T.set(u),A.set(g)):(T.set(g),A.set(u)),T.tryToRootAtAncestorOfType(14),ld.moveToFirstColumn(T),A.tryToRootAtAncestorOfType(14),ld.moveToLastColumn(A),b=_?ss.SelectionFactory.createTableCellSelectionBetweenIteratorEx(T,A):ss.SelectionFactory.createTableCellSelectionBetweenIterator(T,A)}else d=new X_.Selection(y,us.n.get_instance().get_item(63)||v.isForward);else d=ss.SelectionFactory.createSelectionFromContentBetweenNodes(u,g);d&&(b=new Zf.SelectionCollection([d],0)),a.get_selectionManager().setSelectionFromSelectionCollectionAsync(b,null)}return Xi.t.mark(5753),32},e.selectColumn=function(t,n,r,i,o){if(Xi.t.mark(5754),!n.view.get_isInteractiveView())return 2;var a=n.view;if(!a.get_selectionManager())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelectionManager}),8;var s=a.get_selectionManager().get_selectionCollection();if(!s)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),2;var l=e.get_getRefColumnsWhenSelectColumnDelegate()(s);if(32!==l.response)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.failedToGeneralizeToTable}),l.response;if(2===r){var c=[],u=l.processContexts,g=new Da.GraphIterator;g.set(u[0].get_node()),g.tryToRootAtAncestorOfType(14);var p=ld.getContainingTable(g),d=Number.MAX_VALUE,h=0;if(u.length===dc.TableReader.getColumnCount(ld.getContainingTable(g))){var _=null;if(us.n.get_instance().get_item(104)&&(_=ss.SelectionFactory.createTableCellSelectionFromTable(p,e.get_isUnblockComplexTableEnabled())))c=_.toArray();else{var m=ss.SelectionFactory.createSelectionFromNode(p);Array.add(c,m)}d=0,h=dc.TableReader.getColumnCount(p)-1}else{for(var f=0;f<u.length;++f){var y=Da.GraphIterator.createFromNode(u[f].get_node());y.tryToRootAtAncestorOfType(14);var C=sd.e(y);d=Math.min(d,C),h=Math.max(h,C)}var S=Da.GraphIterator.createFromNode(p);ld.moveToFirstRow(S),ld.moveToColumnByIndex(S,d);var v=new Da.GraphIterator;v.setFrom(S),ld.moveToColumnByIndex(v,h);var b=void 0,T=p.isComplexTable(),A=us.n.get_instance().get_item(104)&&(!T||e.get_isUnblockComplexTableEnabled());do{(m=A?ss.SelectionFactory.createSelectionBetweenTableCellNodes(S,v,!0,!0):ss.SelectionFactory.createSelectionFromContentBetweenNodes(S.get_currentNode(),v.get_currentNode()))&&Array.add(c,m),b=!ld.moveToNextRow(S),ld.moveToNextRow(v)}while(!b)}var I=Da.GraphIterator.createFromNode(p);ld.moveToCell(I,0,d);var w=dc.TableReader.getRowCount(p),x=Da.GraphIterator.createFromNode(p);ld.moveToCell(x,w-1,h);var F=new Zf.SelectionCollection(c,c.length-1,0,I,x);a.get_selectionManager().setSelectionFromSelectionCollectionAsync(F,null)}return Xi.t.mark(5751),32},e.selectCell=function(t,n,r,i,o){if(Xi.t.mark(5750),!n.view.get_isInteractiveView())return 2;var a=n.view;if(!a.get_selectionManager())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelectionManager}),8;var s=a.get_selectionManager().get_selectionContextForActionDispatch();if(!s)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),2;for(var l=e.get_contextSetEditor().breakDownContextSets(s),c={},u=0;u<l.length;++u)if(l[u].get_isGraphNodeContext()){if((T=Da.GraphIterator.createFromNode(l[u].get_node())).tryToRootAtOutlineAncestor(),!Zc.isTableCellOrInside(T))return 8;ld.returnToCell(T),c[T.get_currentNode().get_id().toString()]=T}if(2===r){if(us.n.get_instance().get_item(104)){var g=a.get_selectionManager().get_selectionCollection();if(g.get_currentSelection().get_tableSelectionContexts())return Xi.t.mark(5751),32;var p=g.get_currentSelection(),d=p.isForward?p.get_firstContext():p.get_lastContext(),h=p.isForward?p.get_lastContext():p.get_firstContext(),_=new Da.GraphIterator;_.set(d.get_node()),_.tryToRootAtOutlineAncestor();var m=new Da.GraphIterator;m.set(h.get_node()),m.tryToRootAtOutlineAncestor();var f=null;if((f=ld.returnToLowestCommonTable(_,m))&&!f.isComplexTable()){var y=Pa.SelectionEditor.collapseToIp(p,!0,!1),C=Sf.TableNodeContext.create(_.get_currentNode(),y.get_firstContext()),S=ss.SelectionFactory.createSelectionCollectionFromSelection(ss.SelectionFactory.createSelectionFromContext(C));return a.get_selectionManager().setSelectionFromSelectionCollection(S),Xi.t.mark(5751),32}}var v=[];for(var b in c){var T={key:b,value:c[b]}.value,A=ss.SelectionFactory.createSelectionFromNode(T.get_currentNode());Array.add(v,A)}if(v.length>0){var I=new Zf.SelectionCollection(v,v.length-1);a.get_selectionManager().setSelectionFromSelectionCollectionAsync(I,null)}}return Xi.t.mark(5751),32},e.getTableCellAlignmentIsEnabled=function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacTableCellAlignmentIsEnabled")},e.applyTableCellJustification=function(t,n,r,i,o){var a=e.alignmentEnabledGetter();if(1===r)return a?32:8;if(!o||!a)return 2;var s=n;if(!n||!s.get_node())return 2;var l=s.get_node();if(Zc.isGhostCellNode(l))return 32;if(e._actionIdToVAlignMap.containsKey(t)){if(e._trackChangeManager&&e._trackChangeManager.get_trackChangeFeatureIsEnabled()&&e._trackChangeManager.get_changeTrackingDocumentSettingEnabled()){var c=(0,f.e)(Hf.TableCellNode,l);if(c){var u=c.preparePreviousFormatProperties();e.get_trackChangeEditor().setTableCellFormatChange(c,u)}}var g=e._actionIdToVAlignMap.get_item(t);l.setProperty_Unchecked(ks.j.tableCellVerticalAlignment,g)}if(e._actionIdToHAlignMap.containsKey(t)){var p=e._actionIdToHAlignMap.get_item(t);e.applyCellHorizontalJustification(l,p)}return 32},e.applyCellHorizontalJustification=function(t,n){if(!Zc.isGhostCellNode(t)){var r=Da.GraphIterator.createFromNode(t);if(Sc.moveToFirstOutlineElement(r))do{if(r.goToFirstChildByRole(2)){var i=r.get_currentNode();if(12===i.get_type()){var o=(0,f.e)(hc.AParagraphNode,i),a=null;e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&o&&(a=o.getCurrentFormatProperties()),i.setProperty_Unchecked(Kc.b.layoutAlignmentInParent,n),e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&a&&o&&e.get_trackChangeEditor().setParagraphFormatChange(o,a,e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled())}else 14===i.get_type()?dc.TableReader.foreachCellInTable(i,(function(t){e.applyCellHorizontalJustification(t,n)})):C.ULS.sendTraceTag(8439839,324,50,"Unsupported node type for justification set:{0}",ey.l[i.get_type()]);r.returnToParent()}}while(r.goToNextSibling())}},e.queryDirectTableCellParagraphJustification=function(t,n,r,i,o){if(!o)return 2;if(1===r)return 32;var a=o,s=a[e.cumulativeJustificationKey];if(e.consistentKey in s&&!s[e.consistentKey])return 32;var l=e._actionIdToHAlignMap.get_item(t),c=e._actionIdToVAlignMap.get_item(t),u=n;if(!n||!u.get_node())return 2;var g=u.get_node(),p=cs.ParagraphReader.getJustification(g),d=Da.GraphIterator.createFromNode(g);d.tryToRootAtAncestorOfType(16),d.returnToAncestorOfType(16);var h=d.get_currentNode().getValueWithDefault(String,ks.j.tableCellVerticalAlignment,e.topJustify);return s[e.consistentKey]=a[Di.e.On]=l===p&&c===h,32},e.deleteTableView=function(t,n,r,i,o){var a=n;if(!a.view.get_isInteractiveView())return 2;var s=a.view;if(!s.get_selectionManager())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelectionManager}),8;var l=s.get_selectionManager().get_selectionContextForActionDispatch();if(!(l=e.get_contextSetEditor().attemptToGeneralizeToNodeContextOfType(l,14)))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.failedToGeneralizeToTable}),8;if(1===r)return d=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l,ii.iL,r,!0,i,o);Xi.t.mark(7117);var c=new Xf(Pa.SelectionEditor.collapseToIp(ss.SelectionFactory.createSelectionFromContext(l),!0,!1)),u=new as.GraphTransaction(15);try{u.setFromNode(a.view.get_targetNode());var g=Ef.getNormalizer(l.get_node(),!0);g.trackContext(l);var p=(0,f.e)(ty,o)||new ty,d=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l,ii.iL,r,!0,i,e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()?p:o),h=!e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()||!e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()||p.forceDeletion;32===d&&2===r&&h?(g.normalize(),s.get_selectionManager().setSelection(c.restore()),Nt.FocusManager.instance().setScope(s.get_focusScopeId())):g.cancel()}finally{u&&u.dispose()}return Xi.t.mark(7118),32},e.createTableView=function(t,n,r,i,o){var a=n;Xi.t.mark(4943);var s=null;2===r&&(s=new as.GraphTransaction(15)).setFromNode(a.view.get_targetNode());var l=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(a.get_nextContext(),t,r,!0,i,o);if(32===l&&2===r){if(!a.view.get_isInteractiveView())return 2;var c=a.view,u=c.get_selectionManager().get_selectionContextForActionDispatch();u=e.get_contextSetEditor().attemptToGeneralizeToNodeContextOfType(u,16);var g=new Da.GraphIterator;g.set(u.get_node()),g.tryToRootAtAncestorOfType(14),ld.moveToNextOrPreviousCell(g,!1),c.get_selectionManager().setSelection(ss.SelectionFactory.createCollapsedSelection(g.get_currentNode(),!0))}return s&&s.dispose(),Xi.t.mark(4944),l},e.insertColumnView=function(t,n,r,i,o){var a=n;if(!a.view.get_isInteractiveView())return 2;var s=a.view;if(!s.get_selectionManager()||!s.get_selectionManager().get_selectionCollection().get_currentSelection())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),8;Xi.t.mark(4945);var l=s.get_selectionManager().get_selectionContextForActionDispatch();if(!l)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),8;var c=t===ii.fB||t===ii.wz,u=e.get_contextSetEditor().breakDownContextSets(l);if(!u||u.length<=0)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),8;var g=u[0].get_node();if(!g)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),8;c=dc.TableReader.isRtlForView(g)?t===ii.KP||c:t===ii.RZ||c;var p=e.get_getRefCellWhenInsertColumnDelegate()(l,c);if(32!==p.response)return p.response;var d,h=p.containingTable,_=dc.TableReader.isComplexTableNode(h),m=t;(d=c?(0,f.e)(mf.s,p.processContexts[p.processContexts.length-1]):(0,f.e)(mf.s,p.processContexts[0])).get_node();t!==ii.wz&&(t=c?ii.fB:ii.sq);var y=null;2===r&&(y=new as.GraphTransaction(15)).setFromNode(a.view.get_targetNode());var S=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(d,t,r,!0,i,p.numberOfOperations);return y&&y.dispose(),2===r&&C.ULS.sendTraceTag(9011547,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, ColumnCount={6}",m,ii.rG(m)||"Unknown",us.n.get_instance().get_item(77),_,S,h.get_id().toString(),dc.TableReader.getColumnCount(h))),Xi.t.mark(4946),S},e.insertRowView=function(t,n,r,i,o){var a=n;if(!a.view.get_isInteractiveView())return 2;var s=t===ii.Jy,l=t===ii.cb;Xi.t.mark(4947);var c=a.view;if(!c.get_selectionManager())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelectionManager}),8;var u=c.get_selectionManager().get_selectionContextForActionDispatch();if(!u)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),8;var g=e.get_getRefRowWhenInsertRowDelegate()(u,l);if(32!==g.response)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.failedToGeneralizeToTable}),g.response;var p,d=dc.TableReader.isComplexTableNode(g.containingTable),h=null;2===r&&(h=new as.GraphTransaction(15)).setFromNode(a.view.get_targetNode());(p=l?(0,f.e)(mf.s,g.processContexts[0]):(0,f.e)(mf.s,g.processContexts[g.processContexts.length-1])).get_node();var _=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(s?u:p,t,r,!1,i,g.numberOfOperations);return h&&h.dispose(),2===r&&C.ULS.sendTraceTag(9011548,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}, RowCount={6}",t,ii.rG(t)||"Unknown",us.n.get_instance().get_item(77),d,_,g.containingTable.get_id().toString(),dc.TableReader.getRowCount(g.containingTable))),Xi.t.mark(4948),_},e.moveToFirstColumnControlCell=function(e){for(ld.moveToFirstColumn(e);Zc.isGhostCell(e);){if(!ld.moveToPreviousRow(e))break}},e.moveToFirstRowControlCell=function(e){for(ld.moveToFirstRow(e);Zc.isGhostCell(e);){if(!ld.moveToPreviousColumn(e))break}},e.mergeCellsView=function(t,n,r,i,o){if(us.n.get_instance().get_item(30))return 2;var a=n;if(!a.view.get_isInteractiveView())return 2;var s=a.view;if(!s.get_selectionManager()||!s.get_selectionManager().get_selectionCollection().get_currentSelection())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),8;var l=s.get_selectionManager().get_selectionContextForActionDispatch(),c=e.getMergeCellContextData(l);if(32!==c.response)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.failedToGeneralizeToTable}),c.response;var u=null,g=null;if(2===r){(u=new Xf(s.get_selectionManager().get_selectionCollection().get_currentSelection())).restore();(g=new as.GraphTransaction(15)).setFromNode(a.view.get_targetNode())}var p=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(_s.y.create(c.controlCell),t,r,!1,i,c);if(2===r&&32===p){var d=Da.GraphIterator.createFromNode(c.containingTable);d.tryToRootAtOutlineAncestor()&&e.get_tableEditor().removeDeadCells(d,s.get_viewId()),u&&(s.get_selectionManager().setSelection(ss.SelectionFactory.createCollapsedSelection(c.controlCell,!0)),Nt.FocusManager.instance().setScope(s.get_focusScopeId()))}return g&&g.dispose(),2===r&&(C.ULS.sendTraceTag(38397411,324,50,String.format("Merge Cells command run. Response={0}",p)),e.get_trackChangeManager().alertUntrackedChange(5)),p},e.isTableCellContext=function(e){var t=Da.GraphIterator.createFromNode(e[0].get_node());if(!t.tryToRootAtAncestorOfType(14))return!1;for(var n=ld.getContainingTableCell(t),r=1;r<e.length;r++)if(!(t=Da.GraphIterator.createFromNode(e[r].get_node())).tryToRootAtAncestorOfType(14)||ld.getContainingTableCell(t)!==n)return!1;return!0},e.getMergeCellContextData=function(t){var n=new Af;if(n.containingTable=null,n.controlCell=null,!t)return n.response=8,n;var r=e.get_contextSetEditor().breakDownContextSets(t);if(r.length<=1)return n.response=2,n;if(e.get_tableFormattingBugsFixEnabled()&&e.isTableCellContext(r))return n.response=2,n;for(var i=new y.c(String),o={},a=0;a<r.length;++a)if(r[a].get_isGraphNodeContext()){var s=Da.GraphIterator.createFromNode(r[a].get_node());if(s.tryToRootAtOutlineAncestor(),!Zc.isTableCellOrInside(s))return n.response=8,n;var l=(0,f.e)(hc.AParagraphNode,s.get_currentNode());if(l&&!l.getValueWithDefault(Boolean,ks.j.isFullySupportedParagraph,!0))return n.response=8,n;ld.returnToCell(s);var c=s.get_currentNode();if(i.contains(c.get_id().toString()))continue;i.add(c.get_id().toString());var u=ld.getContainingTable(s),g=ld.getContainingTableRow(s).get_id().toString();if(n.containingTable)if(n.containingTable!==u){if(s.hasAncestor(n.containingTable))continue;if(!Da.GraphIterator.createFromNode(n.containingTable).tryToRootAtAncestor(u))return n.response=8,n;o={},n.containingTable=u,n.controlCell=c,o[g]=c.get_colSpan()}else o[g]=g in o?o[g]+c.get_colSpan():c.get_colSpan();else o={},n.containingTable=u,n.controlCell=c,o[g]=c.get_colSpan();for(var p=1;p<c.get_rowSpan();p++){ld.moveToNextRow(s);var d=ld.getContainingTableRow(s).get_id().toString();o[d]=d in o?o[d]+c.get_colSpan():c.get_colSpan()}}if(!n.controlCell)return n.response=2,n;var h=Object.keys(o);n.rowSpan=h.length,n.colSpan=o[h[0]];for(var _=0,m=h;_<m.length;_++){g=m[_];if(n.colSpan!==o[g])return n.response=2,n}return n.response=32,n},e.splitCellsDialogHandler=function(t,n,r,i,o){if(1===r)return L.AFrameworkApplication.get_theActionManager().processAction(ii.Wc,r);var a=e.getSelectedCell(n);return a?(new Jf(Box4Intl.Box4Strings.L_SplitCells,e.splitCellsDialogCallback,1,1,100,63,a.get_rowSpan(),1===a.get_colSpan()?2:a.get_colSpan(),a.get_rowSpan(),a.get_colSpan()),32):2},e.getSelectedCell=function(t){var n,r=t.view;if(Pa.SelectionEditor.isInsertionPointSelection(r.get_selectionManager().get_selectionCollection().get_currentSelection())){n=r.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext().get_node()}else{var i=r.get_selectionManager().get_selectionContextForActionDispatch();n=e.get_contextSetEditor().breakDownContextSets(i)[0].get_node()}var o=Da.GraphIterator.createFromNode(n);return o.tryToRootAtOutlineAncestor(),Zc.isInTableCell(o)?(ld.returnToContainingCell(o),o.get_currentNode()):null},e.splitCellsDialogCallback=function(e,t){var n={};n.rows=e,n.columns=t,L.AFrameworkApplication.get_theActionManager().processActionWithData(ii.Wc,2,n)},e.splitCellsView=function(t,n,r,i,o){if(us.n.get_instance().get_item(30))return 2;var a=n;if(!a.view.get_isInteractiveView())return 2;var s,l=a.view;if(!l.get_selectionManager()||!l.get_selectionManager().get_selectionCollection().get_currentSelection())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),8;if(Pa.SelectionEditor.isInsertionPointSelection(l.get_selectionManager().get_selectionCollection().get_currentSelection())){s=l.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext().get_node()}else{var c=l.get_selectionManager().get_selectionContextForActionDispatch();if(!c)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.failedToGeneralizeToTable}),8;var u=e.get_contextSetEditor().breakDownContextSets(c);if(e.get_tableFormattingBugsFixEnabled()&&!e.isTableCellContext(u))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsMultiCellTable}),8;s=u[0].get_node()}var g=Da.GraphIterator.createFromNode(s);if(g.tryToRootAtOutlineAncestor(),!Zc.isInTableCell(g))return 2;ld.returnToContainingCell(g);var p=g.get_currentNode(),d=null,h=null;if(2===r){(d=new Xf(l.get_selectionManager().get_selectionCollection().get_currentSelection())).restore();(h=new as.GraphTransaction(15)).setFromNode(a.view.get_targetNode())}var _=_s.y.create(p),m=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(_,t,r,!1,i,o);return 2===r&&32===m&&d&&(l.get_selectionManager().setSelection(ss.SelectionFactory.createCollapsedSelection(p,!0)),Nt.FocusManager.instance().setScope(l.get_focusScopeId())),h&&h.dispose(),2===r&&(C.ULS.sendTraceTag(38397440,324,50,String.format("Split Cells command run. Response={0}",m)),e.get_trackChangeManager().alertUntrackedChange(11)),m},e.deleteTableSegmentView=function(t,n,r,i,o){var a=n;if(!a.view.get_isInteractiveView())return 2;var s=t===ii.ym;s?Xi.t.mark(4951):Xi.t.mark(4949);var l=a.view;if(!l.get_selectionManager()||!l.get_selectionManager().get_selectionCollection().get_currentSelection())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),8;var c=l.get_selectionManager().get_selectionContextForActionDispatch(),u=e.get_getRowOrColumnsForDeleteDelegate()(c,s,l.get_selectionManager());if(32!==u.response)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.failedToGeneralizeToTable}),u.response;var g=dc.TableReader.isComplexTableNode(u.containingTable),d=null,h=null,_=null,m=!1,y=!1;if(2===r){var S=(d=new Xf(l.get_selectionManager().get_selectionCollection().get_currentSelection())).restore();(x=Da.GraphIterator.createFromNode(S.get_firstContext().get_node())).tryToRootAtAncestorOfType(14),ld.returnToContainingCell(x),y=Zc.isLastCellInRow(x),ld.returnToContainingRow(x),m=cd.r(x),h=Ef.getNormalizer(a.view.get_targetNode(),!0),g&&e.get_deleteTableSegmentStrategy().excludeControlCells((0,p.m)((function(){return c}),(function(e){return c=e}))),h.trackContext(c),(_=new as.GraphTransaction(15)).setFromNode(a.view.get_targetNode())}var v=(0,f.e)(ty,o)||new ty,b=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(bf.x.createSet(u.processContexts),t,r,!1,i,e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&s?v:o),T=!e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()||!e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()||!s||v.forceDeletion,A=!1,I=!1;2===r&&32===b&&T&&((x=Da.GraphIterator.createFromNode(u.containingTable)).tryToRootAtOutlineAncestor()&&e.get_tableEditor().removeDeadCells(x,l.get_viewId()));if(2===r&&32===b&&us.n.get_instance().get_item(30)&&dc.TableReader.isSingleCellTable(u.containingTable)&&T&&(x=Da.GraphIterator.createFromNode(u.containingTable)).tryToRootAtOutlineAncestor()){d=new Xf(s?ss.SelectionFactory.createCollapsedSelection(u.containingTable,!m):ss.SelectionFactory.createCollapsedSelection(u.containingTable,!y)),l.get_selectionManager().setSelection(Pa.SelectionEditor.collapseToIp(ss.SelectionFactory.createSelectionFromNode(u.containingTable),!1,!1));L.AFrameworkApplication.get_theActionManager().processAction(ii.ze,2);A=!0,I=!0}if(32===b&&2===r&&T){if((!A&&dc.TableReader.getColumnCount(u.containingTable)<=0||dc.TableReader.getRowCount(u.containingTable)<=0)&&(A=!0),h.normalize(),d){var w=d.restore();if(A)w=I&&!s?ss.SelectionFactory.createCollapsedSelection(w.get_firstContext().get_node(),!y):ss.SelectionFactory.createCollapsedSelection(w.get_firstContext().get_node(),!0);else{var x;(x=Da.GraphIterator.createFromNode(w.get_firstContext().get_node())).tryToRootAtAncestorOfType(14);s?(ld.returnToContainingRow(x),m&&!us.n.get_instance().get_item(77)?(x.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(x),e.get_outlineElementEditor().insertOutlineElementAsSibling(x,!1,!0)):e.moveToFirstColumnControlCell(x),w=ss.SelectionFactory.createCollapsedSelection(x.get_currentNode(),!0)):(ld.returnToCell(x),y&&us.n.get_instance().get_item(30)?(ld.moveToLastRow(x),w=ss.SelectionFactory.createCollapsedSelection(x.get_currentNode(),!1)):(us.n.get_instance().get_item(63)||us.n.get_instance().get_item(77))&&(e.moveToFirstRowControlCell(x),w=ss.SelectionFactory.createCollapsedSelection(x.get_currentNode(),!0)))}l.get_selectionManager().setSelection(w),Nt.FocusManager.instance().setScope(l.get_focusScopeId())}}else h&&h.cancel();return _&&_.dispose(),2===r&&(C.ULS.sendTraceTag(9011549,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, IsComplexTable={3}, Response={4}, TableId={5}",t,ii.rG(t)||"Unknown",us.n.get_instance().get_item(77),g,b,u.containingTable.get_id().toString())),s||32!==b||e.get_trackChangeManager().alertUntrackedChange(12)),s?Xi.t.mark(4952):Xi.t.mark(4950),b},e.gotoFocusCellAfterInsertColumnImpl=function(e,t){ld.moveToFirstRow(e);var n=(0,f.e)(Hf.TableCellNode,e.get_currentNode()).get_colSpan();if(t)for(var r=0;r<n;r++)ld.moveToNextColumn(e);else ld.moveToPreviousColumn(e)},e.getRefRowWhenInsertRowImpl=function(t,n){return e.generalizeTableContextsToLowestCommonTable(t,!1,!0,!0)},e.getRefCellWhenInsertColumnImpl=function(t,n){return e.generalizeTableContextsToLowestCommonTable(t,!0,!0,!0)},e.getRefColumnFromRefCellImpl=function(e,t){var n=sd.e(e);return t&&(n+=e.get_currentNode().get_colSpan()-1),n},e.getRefColumnsWhenSelectColumnImpl=function(t){var n=Oa.SelectionManager.buildSectionContext(t);return e.generalizeTableContextsToLowestCommonTable(n,!0,!0,us.n.get_instance().get_item(104)&&e.get_isUnblockComplexTableEnabled())},e.getRefRowsWhenSelectRowImpl=function(t){var n=Oa.SelectionManager.buildSectionContext(t);return e.generalizeTableContextsToLowestCommonTable(n,!1,!0,us.n.get_instance().get_item(104)&&e.get_isUnblockComplexTableEnabled())},e.getRowOrColumnsForDeleteImpl=function(t,n,r){return e.generalizeTableContextsToLowestCommonTable(t,!n,!0,!0)},e.generalizeTableContextsToLowestCommonTable=function(t,n,r,i){var o=new Pf;if(o.containingTable=null,!t)return o.response=8,o;var a={},s=new Array(0),l=!1,c=e.get_contextSetEditor().breakDownContextSets(t);1===c.length&&(l=!0);for(var u=function(t){if(c[t].get_isGraphNodeContext()){var r=[],l=Da.GraphIterator.createFromNode(c[t].get_node());if(l.tryToRootAtOutlineAncestor(),!Zc.isTableCellOrInside(l))return o.response=8,{value:o};if(n)ld.returnToCell(l),i&&Zc.getColSpan(l.get_currentNode())>1?Zc.foreachMergedCells(l.get_currentNode(),(function(e){var t=Da.GraphIterator.createFromNode(e);t.tryToRootAtOutlineAncestor(),ld.moveToFirstRow(t),Array.add(r,t)}),2):Array.add(r,l),ld.moveToFirstRow(l);else{Zc.isTableCell(l)||ld.returnToCell(l);var u=l.get_currentNode().get_rowSpan();if(ld.returnToContainingRow(l),u>1)for(var g=1;g<u;g++){var p=Da.GraphIterator.createFromNode(l.get_currentNode());p.tryToRootAtOutlineAncestor(),Array.add(r,p),ld.moveToNextRow(l)}Array.add(r,l)}for(var d=0;d<r.length;++d){l=r[d];var h=ld.getContainingTable(l),_=l.get_currentNode().get_id().toString();if(!a[_])if(a[_]=!0,o.containingTable)if(o.containingTable!==h)if(l.hasAncestor(o.containingTable))e.generalizeToElementOfTable(l,o.containingTable,n),_=l.get_currentNode().get_id().toString(),a[_]||(a[_]=!0,Array.add(s,l));else{if(a[_]=!1,!Da.GraphIterator.createFromNode(o.containingTable).tryToRootAtAncestor(h))return o.response=8,{value:o};for(var m=[],f=0;f<s.length;f++){var y=s[f];e.generalizeToElementOfTable(y,h,n),_=y.get_currentNode().get_id().toString(),a[_]||(a[_]=!0,Array.add(m,y))}_=l.get_currentNode().get_id().toString(),a[_]||(a[_]=!0,Array.add(m,l)),o.containingTable=h,Array.clear(s),s=m}else Array.add(s,l);else o.containingTable=h,Array.add(s,l)}Array.clear(r)}},g=0;g<c.length;++g){var p=u(g);if("object"==typeof p)return p.value}if(!s.length)return o.response=8,o;if(!r&&s.length>1)return o.response=8,o;o.singleElement=s[0].get_currentNode();var d=[];for(g=0;g<s.length;g++){var h=s[g];if(!i&&dc.TableReader.isInComplexTable(h))return o.response=8,o;Array.add(d,_s.y.create(h.get_currentNode()))}return o.numberOfOperations=l?1:d.length,o.processContexts=d,o.response=32,o},e.generalizeToElementOfTable=function(e,t,n){do{n?ld.returnToContainingCell(e):ld.returnToContainingRow(e)}while(ld.getContainingTable(e)!==t);n&&ld.moveToFirstRow(e)},e.insertTableFlyoutEnabled=function(e,t,n,r,i){if(1===n){var o=t.get_nextContext();return o&&Pa.SelectionEditor.isInsertionPointContext(o)?L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(o,ii.gH,n,!0,r,i):2}return 32},e.insertTableDialogHandler=function(t,n,r,i,o){return 1===r?L.AFrameworkApplication.get_theActionManager().processAction(ii.gH,r):(new Jf(Box4Intl.Box4Strings.l_TableInsertDialog,e.insertTableDialogCallback,1,1,100,63,2,5,1,1),32)},e.insertTableDialogCallback=function(e,t){var n=new zu;n.rows=e,n.columns=t,L.AFrameworkApplication.get_theActionManager().processActionWithData(ii.gH,2,n)},e.insertTableView=function(t,n,r,i,o){i.dataValue1=0,i.dataValue2=0;var a=-1,s=null,l=null,c=null;if(!n.view.get_isInteractiveView())return 2;var u=n.view;if(!u.get_selectionManager())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelectionManager}),8;if(Xi.t.mark(4941),2===r){var g=u.get_selectionManager().get_selectionContextForActionDispatch();g.get_isGraphNodeContext()&&(c=new as.GraphTransaction(15),l=zc.q.get_instance().getTraversableIteratorAtOutlineElement(g.get_node()),c.setFromIterator(l),(s=new Da.GraphIterator).setFrom(l),s.returnToParent(),a=s.getChildIndex(l.get_currentNode()))}var p=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n.get_nextContext(),t,r,!0,i,o);if(32===p&&2===r){var d=void 0;if(l.get_isValid()?(hs.OutlineElementNavigator.moveToNextOutlineElement(l,!1,!1),hs.OutlineElementNavigator.moveToContent(l),d=ss.SelectionFactory.createCollapsedSelection(l.get_currentNode(),!0)):(s.goToChildIndex(a),hs.OutlineElementNavigator.moveToContent(s),d=ss.SelectionFactory.createCollapsedSelection(s.get_currentNode(),!0)),u.get_selectionManager().setSelection(d),Nt.FocusManager.instance().setScope(u.get_focusScopeId()),Br.App.get_box4Bridge()&&Br.App.get_box4Bridge().get_commandUi()){var h=void 0;h=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?"Table":Br.App.tableToolsDesignTabIsEnabled?"ContextualTabs.Tables.Design":"ContextualTabs.Tables.Layout",Br.App.get_box4Bridge().get_commandUi().ribbonActivateTab(h)}}return c&&c.dispose(),Xi.t.mark(4942),p},e.queryTableTabGroup=function(t,n,r,i,o){var a=n;if(!a.view.get_isInteractiveView())return 8;var s=a.view;if(!s.get_selectionManager())return 8;var l=s.get_selectionManager().get_selectionContextForActionDispatch(),c=e.get_contextSetEditor().breakDownContextSets(l);if(c.length<=0)return 8;for(var u=new Da.GraphIterator,g=0;g<c.length;++g)if(u.set(c[g].get_node()),u.tryToRootAtOutlineAncestor(),!dc.TableReader.isInTable(u))return 8;return 32},e.createTable=function(t,n,r,i,o){var a=n.get_contextId()===cl.V,s=null,l=null;if(a){if(s=n,Hs.HyperlinkReader.isIpInHyperlink(s,!0))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsHyperlink}),8;(l=new Da.GraphIterator).set(s.get_node()),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(l),Hr.b(l)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsTitle}),a=!1),!s.get_cpBegin()&&l.get_isFirstSibling()&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.invalidTableLocation}),a=!1)}if(1===r||!a)return a?32:8;Xi.t.mark(4929);var c=new as.GraphTransaction(7);c.setFromIterator(l),hs.OutlineElementNavigator.returnToOutlineElement(l);var u=l.get_currentNode();e.get_outlineElementEditor().insertOutlineElementAsSibling(l,!1,!1);var g=e.get_tableEditor().createTable(l,1,2);e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()&&e.get_trackChangeEditor().markTableForInsertion(g);var p=new Da.GraphIterator;return p.set(u),p.tryToRootAtOutlineAncestor(),ld.moveToCellContent(l,0,1),e.get_outlineElementEditor().splitAtIp(p,l,s,!0,!0,!0),ld.returnToContainingTable(l),ld.moveToCellContent(l,0,0),l.disconnectNodeAndReturnToParent(),Ec.u(p,l,null,p.get_role()),e.get_listEditor().applyListInfo(p,null),ld.returnToContainingTable(l),hs.OutlineElementNavigator.returnToOutlineElement(l),p.goToFirstChildByRole(1)&&Ec.i(l,null,1,1,p,-1),e.get_autoCorrectScheduler()&&e.get_autoCorrectScheduler().tryToAutocorrectAtTextBreak(u,Je.v.vK_Tab),c.dispose(),C.ULS.sendTraceTag(42505434,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",t,ii.rG(t)||"Unknown",us.n.get_instance().get_item(77),g.get_id().toString())),Xi.t.mark(4930),32},e.insertColumn=function(t,n,r,i,o){var a=Pa.SelectionEditor.isInsertionPointContext(n)&&t===ii.wz||n.get_contextId()===cl.M,s=null;if(a&&((s=new Da.GraphIterator).set(n.get_node()),s.tryToRootAtAncestorOfType(14),Zc.isTableCellOrInside(s)||(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsTableCell}),a=!1),a&&!e.get_isRowOrColumnOperationEnabledDelegate()(s,t)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedOrComplexTable}),a=!1),a)){ld.returnToContainingCell(s);var l=us.n.get_instance().get_item(63)?63:255;if(dc.TableReader.getColumnCount(ld.getContainingTable(s))>=l)return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.maxColumnCount}),8}if(1===r||!a)return a?32:8;Xi.t.mark(4931);var c=t!==ii.sq,u=new as.GraphTransaction(15);u.setFromIterator(s),n.get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(2);var g=new Da.GraphIterator;g.set(s.get_currentNode()),g.tryToRootAtAncestorOfType(15),ld.returnToContainingTable(s);var p=s.get_currentNode(),d=e.get_getRefColumnFromRefCellDelegate()(g,c);c&&d++;var h=o||1;if(e.get_tableEditor().insertColumns(s,d,!c,h,e.get_getNewOutlineElementInfoDelegate()),e.get_ccConfigSettings()&&e.get_ccConfigSettings().get_isContentControlEditingEnabled()&&p.hasProperty(ks.j.contentControlHolderObjectId)){var _=p.getValueWithDefault(Dt.h,ks.j.contentControlHolderObjectId,Dt.h.get_nil());if(!_.equals(Dt.h.get_nil())){var m=new y.c(Wf.k),f=Da.GraphIterator.createFromNode(p);ld.forEachCellInTable(f,(function(e,t,n){return n!==d||Zc.isGhostCell(e)||cs.ParagraphReader.getParagraphsUnderIterator(e,!1,!1,m),!0})),e.get_contentControlEditor()&&e.get_contentControlEditor().addBlockContentControlInformationToParagraphs(m,_)}}if(s.set(n.get_node()),s.tryToRootAtAncestorOfType(16),t===ii.wz)ld.moveToNextColumn(g),Sc.moveToFirstOutlineElement(g),hs.OutlineElementNavigator.returnToOutlineElement(s),e.get_outlineElementEditor().removeContent(g),e.get_outlineElementEditor().splitAtIp(s,g,n,!0,!0,!0),e.get_autoCorrectScheduler()&&e.get_autoCorrectScheduler().tryToAutocorrectAtTextBreak(s.get_currentNode(),Je.v.vK_Tab);else{var C=Br.App.get_activeAppFrame().workspace,S=Da.GraphIterator.createFromNode(n.get_node());S.tryToRootAtOutlineAncestor(),e.get_gotoFocusCellAfterInsertColumnDelegate()(S,c),C.get_contentView().get_selectionManager().setSelection(ss.SelectionFactory.createCollapsedSelection(S.get_currentNode(),!0))}return e.get_trackChangeManager().alertUntrackedChange(12),u.dispose(),Xi.t.mark(4932),32},e.isRowColumnOperationEnabledForComplexTable=function(e,t){return!(us.n.get_instance().get_item(14)&&dc.TableReader.isInLockedOrComplexTable(e)||us.n.get_instance().get_item(30)&&dc.TableReader.isInComplexTable(e))},e.insertRow=function(t,n,r,i,o){var a=t===ii.Jy,s=t===ii.cb,l=n.get_node(),c=new Da.GraphIterator;c.set(l),c.tryToRootAtOutlineAncestor();var u=!0;if(cd.g(l)||dc.TableReader.isInTable(c)||(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.doesNotContainTable}),u=!1),u&&!e.get_isRowOrColumnOperationEnabledDelegate()(c,t)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedOrComplexTable}),u=!1),1===r||!u)return u?32:8;if(Xi.t.mark(4933),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordTrackChangeTableFormattingSettings"),e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_featureHelper().isFeatureEnabled(147)){var g=(0,f.e)(Ac.f,ld.getContainingTable(c));if(g&&g.get_trackedChangeFormat())if(e.get_trackChangeManager().alertCannotInsertRowIfTableGridChangeExists(g))return 32}var p=new as.GraphTransaction(15);p.setFromIterator(c),n.get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(2);var d=null;if(a){var h=new Da.GraphIterator;h.setFrom(c),hs.OutlineElementNavigator.returnToOutlineElement(h),ld.returnToContainingRow(c),d=e.get_tableEditor().insertRows(c,s,1,e.get_getNewOutlineElementInfoDelegate()),ld.moveToFirstColumn(c),Sc.moveToFirstOutlineElement(c),e.get_outlineElementEditor().splitAtIp(h,c,n,!1,!0,!0),ld.returnToContainingRow(c),e.get_autoCorrectScheduler()&&e.get_autoCorrectScheduler().tryToAutocorrectAtTextBreak(h.get_currentNode(),Je.v.vK_Tab)}else{var _=o||1;d=e.get_tableEditor().insertRows(c,s,_,e.get_getNewOutlineElementInfoDelegate())}e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()&&e.get_trackChangeEditor().markTableRowForInsertion(d),e.get_changeIdEditor().get_catchUpActivityIsEnabled()&&e.get_changeIdEditor().setChangeIdOnTableRow(d);var m=ld.getContainingTable(c);if(e.get_ccConfigSettings()&&e.get_ccConfigSettings().get_isContentControlEditingEnabled()&&m&&m.hasProperty(ks.j.contentControlHolderObjectId)){var y=m.getValueWithDefault(Dt.h,ks.j.contentControlHolderObjectId,Dt.h.get_nil());if(!y.equals(Dt.h.get_nil())&&e.get_contentControlEditor()){var C=Da.GraphIterator.createFromNode(d);e.get_contentControlEditor().addOrCopyBlockContentControlInformationToSubGraph(C,null,null,y,!1)}}var S=Br.App.get_activeAppFrame().workspace,v=Da.GraphIterator.createFromNode(l);return v.tryToRootAtAncestorOfType(14),cd.u(v)||ld.returnToContainingRow(v),s?ld.moveToPreviousRow(v):ld.moveToNextRow(v),e.moveToFirstColumnControlCell(v),S.get_contentView().get_selectionManager().setSelection(ss.SelectionFactory.createCollapsedSelection(v.get_currentNode(),!0)),p.dispose(),Xi.t.mark(4934),32},e.genericViewActionTableCellHandler=function(t,n,r,i,o){var a=Rf(t,n,r,i,o,{},16);if(2===r&&e.shouldLog(t)){var s=ii.rG(t)||"Unknown";C.ULS.sendTraceTag(8791561,324,50,String.format("ActionId={0}, ActionName={1}, Response={2}",t,s,a))}return 2===r&&32===a&&(e.get_trackChangeManager().get_trackTableFormattingIsEnabled()||e.get_trackChangeManager().alertUntrackedChange(13)),a},e.shouldLog=function(e){return e===ii.oo||e===ii.Fq||e===ii.Bo||e===ii.Jp||e===ii.dk||e===ii.Fi||e===ii.nP||e===ii.lv||e===ii.IN},e.deleteColumn=function(t,n,r,i,o){var a=new Da.GraphIterator,s=n.get_isValid();if(s&&(a.set(n.get_node()),a.tryToRootAtOutlineAncestor()||(e.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.failedToRoot}),s=!1),Zc.isTableCellNode(n.get_node())||(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsTableCell}),s=!1)),s&&!e.get_isRowOrColumnOperationEnabledDelegate()(a,t)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedOrComplexTable}),s=!1),s&&!e.get_unsupportedNodeEditor().areAllObjectsDeletable()){var l;(l=new Da.GraphIterator).setFrom(a);do{if(!e.get_unsupportedNodeEditor().canAllContentBeDeleted(l.get_currentNode())){e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.contentCannotBeDeleted}),s=!1;break}}while(ld.moveToNextRow(l))}if(s&&((l=new Da.GraphIterator).setFrom(a),1!==r&&us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()))do{for(var c=vf.z.createTraverser(l.get_currentNode());c.moveNext();){var u=c.get_currentNode();cs.ParagraphReader.isParagraphNode(u)&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(u)}}while(ld.moveToNextRow(l));if(1===r)return s?32:8;if(s){Xi.t.mark(4935);var g=new as.GraphTransaction(7);try{g.setFromIterator(a),e.get_tableEditor().deleteColumnsContainingCell(a,1)}finally{g&&g.dispose()}return Xi.t.mark(4936),32}return 2},e.mergeCells=function(t,n,r,i,o){var a=o,s=new Da.GraphIterator,l=n.get_isValid();if(l){if(s.set(n.get_node()),s.tryToRootAtOutlineAncestor()||(e.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.failedToRoot}),l=!1),Zc.isTableCellNode(n.get_node())||(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsTableCell}),l=!1),l&&!e.get_unsupportedNodeEditor().areAllObjectsDeletable()){(g=new Da.GraphIterator).setFrom(s),(p=new Da.GraphIterator).setFrom(s);for(var c=0;c<a.rowSpan;c++){for(var u=0;u<a.colSpan;u++){if(!e.get_unsupportedNodeEditor().canAllContentBeDeleted(g.get_currentNode())){e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.contentCannotBeDeleted}),l=!1;break}g.goToNextSiblingByRole(1)}if(!l)break;ld.moveToNextRow(p),g.setFrom(p)}}if(l&&1!==r&&us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()){var g,p;(g=new Da.GraphIterator).setFrom(s),(p=new Da.GraphIterator).setFrom(s);for(c=0;c<a.rowSpan;c++){for(u=0;u<a.colSpan;u++)Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(g.get_currentNode()),g.goToNextSiblingByRole(1);if(!l)break;ld.moveToNextRow(p),g.setFrom(p)}}}if(1===r)return l?32:8;if(l){var d=new as.GraphTransaction(7);try{d.setFromIterator(s),e.get_tableEditor().mergeCells(s,a.rowSpan,a.colSpan)}finally{d&&d.dispose()}return 32}return 2},e.splitCells=function(t,n,r,i,o){var a=new Da.GraphIterator,s=n.get_isValid();if(s&&(a.set(n.get_node()),a.tryToRootAtOutlineAncestor()||(e.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.failedToRoot}),s=!1),Zc.isTableCellNode(n.get_node())||(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsTableCell}),s=!1),s&&1!==r&&us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable())){var l=new Da.GraphIterator;l.setFrom(a),Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(l.get_currentNode())}if(1===r)return s?32:8;if(s){var c=o,u=c.rows,g=c.columns,p=new as.GraphTransaction(7);try{p.setFromIterator(a),e.get_tableEditor().splitCell(a,u,g)}finally{p&&p.dispose()}return 32}return 2},e.deleteTable=function(t,n,r,i,o){var a=n.get_node(),s=!0;if(dc.TableReader.isTableNode(a)||(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsTable}),s=!1),e.get_unsupportedNodeEditor().canAllContentBeDeleted(a)||(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.contentCannotBeDeleted}),s=!1),s&&(us.n.get_instance().get_item(14)||us.n.get_instance().get_item(63))&&e.get_lockedRangeEditor().isTableNodeInLockedRange(a)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),s=!1),1===r)return s?32:8;if(s){if(us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable())for(var l=vf.z.createTraverser(a);l.moveNext();){var c=l.get_currentNode();12===c.get_type()&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(c)}var u=(0,f.e)(ty,o);if(!e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()||!e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()||!!u&&u.forceDeletion||!e.get_trackChangeEditor().tryMarkTableForDeletion(a)){var g=new as.GraphTransaction(7);g.setFromNode(a);var p=new Da.GraphIterator;p.set(a),p.tryToRootAtOutlineAncestor(),p.returnToParent(),e.get_tableEditor().handlePargraphDeletion(p),e.get_ccConfigSettings()&&e.get_ccConfigSettings().get_isContentControlEditingEnabled()&&e.get_contentControlEditor()&&e.get_contentControlEditor().updateContentControlNodeStartEndObjectOnTableDeleted(a),e.get_outlineElementEditor().disconnectOutlineElement(p),g.dispose(),u&&(u.forceDeletion=!0)}return C.ULS.sendTraceTag(42505435,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}",t,ii.rG(t)||"Unknown",us.n.get_instance().get_item(77),a.get_id().toString())),32}return 2},e.deleteRow=function(t,n,r,i,o){var a=n.get_node();if(!e.get_unsupportedNodeEditor().canAllContentBeDeleted(a))return 8;var s=new Da.GraphIterator;s.set(a),s.tryToRootAtOutlineAncestor();var l=cd.g(a);if(l||e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsTableRow}),l&&!e.get_isRowOrColumnOperationEnabledDelegate()(s,t)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedOrComplexTable}),l=!1),1===r)return l?32:8;if(l){if(us.n.get_instance().get_item(50)&&!Br.App.get_theCoauthManager().get_amIAlone())for(var c=vf.z.createTraverser(a);c.moveNext();){var u=c.get_currentNode();12===u.get_type()&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(u)}Xi.t.mark(4937);var g=(0,f.e)(ty,o);if(!e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()||!e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()||!!g&&g.forceDeletion||!e.get_trackChangeEditor().tryMarkTableRowForDeletion(a)){var p=new as.GraphTransaction(7);p.setFromNode(a),e.get_tableEditor().deleteRows(s,1),p.dispose(),g&&(g.forceDeletion=!0)}return Xi.t.mark(4938),32}return 2},e.collapseTable=function(t,n,r,i,o){var a=!1,s=null;if(n.get_isGraphNodeContext()&&((s=new Da.GraphIterator).set(n.get_node()),(a=dc.TableReader.isTable(s)&&dc.TableReader.isSingleCellTable(s.get_currentNode()))?s.tryToRootAtOutlineAncestor():e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsSingleCellTable})),1===r)return a?32:8;if(a){Xi.t.mark(4939);var l=new Da.GraphIterator;l.setFrom(s),ld.moveToCell(l,0,0),hs.OutlineElementNavigator.returnToOutlineElement(s);var c=new as.GraphTransaction(7);return c.setFromIterator(l),e.get_outlineElementEditor().replaceContentWithContentOfOutline(s,l),c.dispose(),Xi.t.mark(4940),32}return 2},e.insertTable=function(t,n,r,i,o){if(!n.get_isGraphNodeContext())return 2;if(!Pa.SelectionEditor.isInsertionPointContext(n))return 2;if(us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isIpOrTextRangeContextInLockedRange(n))return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),2;var a=null;if(e.get_ccConfigSettings()&&e.get_ccConfigSettings().get_isContentControlEditingEnabled()){var s=n,l=(a=e.get_contentControlChpHelper().getContentControlsWrappedIp(s.get_node(),s.get_cpBegin(),s.get_ccBoundaryIdxAtCpBegin())).get_item(a.get_count()-1);if(a.get_count()>0&&!l.isBlock&&(!e.get_contentControlConverter()||!e.get_contentControlConverter().isInlineContentControlToBeConvertedToBlock(s,l.get_contentControlObjectId())))return 2}if(e.get_externalSelectionManagerFuture()&&e.get_externalSelectionManagerFuture().get_instance()&&e.get_externalSelectionManagerFuture().get_instance().isExternalSelectionContext(n))return 2;var c=new Da.GraphIterator;if(c.set(n.get_node()),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(c),Hr.b(c))return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsTitle}),2;if(1===r)return 32;var u=1,g=2,p=o;if(p&&(u=p.rows,g=p.columns),i.dataValue1=g,i.dataValue2=u,e.get_contentControlConverter()&&e.get_contentControlConverter().tryToConvertInlineContentControlToBlock(n),Pa.SelectionEditor.isInsertionPointContext(n)){var d=new as.GraphTransaction(7);Xi.t.mark(4927),d.setFromNode(n.get_node()),n.get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(2);var h=new Gf.d;if(us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()){var _=n.get_node();Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(_)}var m=Ps.FormattingReader.getFormattingObject(n);if(us.n.get_instance().get_item(49)&&(m.get_cache().get_isLink()&&(m=m.cloneUnderDifferentChp(null),e.get_formattingEditor().removeLinkFormatting(m)),h.formatting=m.get_formattingId()),h.languageId=Ps.FormattingReader.language(m),us.n.get_instance().get_item(71)&&(h.style=Tc.StyleReader.getStyleFromParagraphNode(n.get_node()),e.get_listReader().doesStyleImplyList(h.style))){var f=Tc.StyleReader.getStyleSetFromParagraphNode(n.get_node());f&&(h.style=f.getStyleById(Tc.StyleReader.get_wordStyleIdNormal()))}var y=null;if(us.n.get_instance().get_item(54)){var S=Da.GraphIterator.createFromNode(n.get_node());S.tryToRootAtAncestorOfType(11),y=e.get_paragraphIndentationReader().getLeftIndent(S.get_currentNode())}else y=new wc.e(1,-1);var v=e.get_outlineElementEditor().insertOutlineElementAt(n,!0),b=null;if(b=p&&p.isRichApi?e.get_tableEditor().createTable(v,u,g,h):e.get_tableEditor().createTable(v,u,g,h,!0),e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()&&e.get_trackChangeEditor().markTableForInsertion(b),e.get_changeIdEditor().get_catchUpActivityIsEnabled()&&e.get_changeIdEditor().setChangeIdOnTable(b),p&&(p.tableNode=b),hs.OutlineElementNavigator.returnToOutlineElement(v),e.get_ccConfigSettings()&&e.get_ccConfigSettings().get_isContentControlEditingEnabled()&&a&&a.get_count()>0){var T=Da.GraphIterator.createFromNode(b),A=a.get_item(a.get_count()-1).get_contentControlObjectId();e.get_contentControlEditor()&&(e.get_contentControlEditor().addOrCopyBlockContentControlInformationToSubGraph(T,null,null,A,!1),b.setValue(ks.j.contentControlHolderObjectId,A))}if(us.n.get_instance().get_item(56)&&h.style&&!Ls.OutlineElementReader.isRtlSet(v.get_currentNode()))h.style.getValueWithDefault(Boolean,Kc.b.outlineElementRTL,!1)&&e.get_outlineElementEditor().setRtl(v.get_currentNode(),!0);return e.get_listEditor().applyListInfo(v,null,!0,!1,-1),e.get_listEditor().setLeftIndentOnTableIfNecessary(v,y.get_unit(),y.get_value()),Ls.OutlineElementReader.isLastOutlineElementInOutline(v)&&e.get_outlineElementEditor().insertOutlineElementAsSibling(v,!1,!0,h),d.dispose(),C.ULS.sendTraceTag(42505436,324,50,String.format("ActionId={0}, ActionName={1}, IsPptTable={2}, TableId={3}, RowCount={4}, ColumnCount={5}",t,ii.rG(t)||"Unknown",us.n.get_instance().get_item(77),b.get_id().toString(),u,g)),Xi.t.mark(4928),L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorGridTableDefaultStyleSettings"),32}return Pa.SelectionEditor.isTextRangeContext(n),2},e.toggleBorders=function(e,t,n,r,i){if(1===n)return 32;Xi.t.mark(5748);var o=t.get_node(),a=new as.GraphTransaction(15);a.setFromNode(o);var s=!o.getValueWithDefault(Boolean,Kc.b.tableBordersVisible,!0);return o.setValue(Kc.b.tableBordersVisible,s),a.dispose(),Xi.t.mark(5749),32},e.queryBordersHidden=function(e,t,n,r,i){var o=!t.get_node().getValueWithDefault(Boolean,Kc.b.tableBordersVisible,!0);return i.setValue(Kc.b.tableBordersVisible,o),32},e.topJustify="top",e.middleJustify="center",e.bottomJustify="bottom",e.cumulativeJustificationKey="__cumulative__",e.consistentKey="__consistent__",e._actionIdToHAlignMap=new g.w(Yf),e._actionIdToVAlignMap=new g.w(String),e._outlineElementEditor=null,e._autoCorrectScheduler=null,e._paragraphIndentationReader=null,e._tableAltTextDialog=null,e._deleteTableSegmentStrategy=null,e._isUnblockComplexTableEnabled=null,e._ccConfigSettings=null,e._externalSelectionManagerFuture=null,e._getNewOutlineElementInfoDelegate=null,e.alignmentEnabledGetter=e.getTableCellAlignmentIsEnabled,e._getRefRowWhenInsertRowDelegate=null,e._getRefCellWhenInsertColumnDelegate=null,e._getRefColumnFromRefCellDelegate=null,e._getRefColumnsWhenSelectColumnDelegate=null,e._getRefRowsWhenSelectRowDelegate=null,e._gotoFocusCellAfterInsertColumnDelegate=null,e._getRowOrColumnsForDeleteDelegate=null,e._isRowOrColumnOperationEnabledDelegate=null,e._featureHelper=null,e._formattingEditor=null,e._trackChangeManager=null,e._trackChangeEditor=null,e._changeIdEditor=null,e._listReader=null,e._listEditor=null,e._contentControlChpHelper=null,e._contentControlConverter=null,e._contentControlEditor=null,e._contextSetEditor=null,e._tableEditor=null,e._TableFormattingBugsFixEnabled=null,e}();(0,o.l)(ny,"TableActor",null,[]);var ry=n(4666),iy=n(8743),oy=n(669),ay=n(6991),sy=n(9879),ly=function(){return function(e,t,n,r){this.sourceRowHeights=null,this.sourceColumnWidths=null,this.tableIterator=null,this.deletedColumns=null,this.deletedRows=null,this.sourceCellLocation=null,this.sourceCellLocation=e,this.tableIterator=t,this.sourceColumnWidths=n,this.sourceRowHeights=r}}();(0,o.l)(ly,"TableSimplificationInformation",null,[]);var cy=n(9054),uy=n(3205),gy=n(3793),py=n(665),dy=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g,p,d,h,_){this._tableEditor=null,this._outlineEditor=null,this._outlineElementEditor=null,this._clipboardRoot=null,this._virtualClipboardRoot=null,this._userClipboardRoot=null,this._dragdropClipboardRoot=null,this._selectionCollection=null,this._listEditor=null,this._usageHelper=null,this._imageEditor=null,this._notebookManager=null,this._paragraphIndentationReader=null,this._appSettingsManager=null,this._getNewOutlineElementInfoDelegate=null,this._listReader=null,this._graphTransactionFactory=null,this._contentControlCopyPasteHelper=null,this._tableCellReader=null,this._trackChangeReader=null,this._trackChangeManager=null,this._sequenceCodePrefix=null,this._sequenceCodeCommonPrefix=null,this._formattingPropertyTransitStrategy=null,this._noOutlineLevelContentOverride=!1,this._notebookManager=o,this._paragraphIndentationReader=a,this._imageEditor=e,this._tableEditor=t,this._outlineEditor=n,this._outlineElementEditor=r,this._listEditor=i,this._appSettingsManager=s,this._graphTransactionFactory=c,this._userClipboardRoot=l.create(2097162),this.registerClipboardRoot(this._userClipboardRoot),this._dragdropClipboardRoot=l.create(2097162),this.registerClipboardRoot(this._dragdropClipboardRoot),this._virtualClipboardRoot=l.create(2097162),this.registerClipboardRoot(this._virtualClipboardRoot),this._clipboardRoot=this._userClipboardRoot,this._contentControlCopyPasteHelper=u,this._tableCellReader=g,this._trackChangeReader=p,this._trackChangeManager=d,this._sequenceCodePrefix=h,this._sequenceCodeCommonPrefix=h.substr(0,3),this._formattingPropertyTransitStrategy=_}return e.prototype.get_listReader=function(){return this._listReader||(this._listReader=se.w.get_instance().resolve(ts.c))},e.prototype.get_sequenceCode=function(){return this._selectionCollection?this._selectionCollection.get_sequenceCode():0},e.prototype.get_containsEop=function(){return this._selectionCollection.get_currentSelection().containsEop},e.prototype.get_endsWithEop=function(){return this._selectionCollection.get_currentSelection().endsWithEop},e.prototype.get_theClipboardRoot=function(){return this._clipboardRoot},e.prototype.get_theVirtualClipboardRoot=function(){return this._virtualClipboardRoot},e.prototype.get_containsOutlineLevelContent=function(){return this._selectionCollection.isOutlineLevelSelection&&!this._noOutlineLevelContentOverride},e.prototype.set_containsOutlineLevelContent=function(e){return e?C.ULS.shipAssertTag(6305555,307,!1):this._noOutlineLevelContentOverride=!0,e},e.prototype.get_onlyCopySelectedNodes=function(){return!this._selectionCollection.isOutlineLevelSelection},e.prototype.get_usageEditor=function(){return lm.z.get_instance()},e.prototype.get_isPasteTableWithReplacingCellEnabled=function(){return this._appSettingsManager.getBooleanAppSetting("InternalPasteTableWithReplacingCellIsEnabled")&&us.n.get_instance().get_item(63)||us.n.get_instance().get_item(77)},e.prototype.registerClipboardRoot=function(e){var t=new Kr.n(-1);this._notebookManager.get_theGraph().addRoot(t);var n=new Da.GraphIterator;n.set(t);var r=3;this._appSettingsManager&&this._appSettingsManager.getBooleanAppSetting("ComplexTableCellPasteWithFormattingIsEnabled")&&(r=0);var i=this._graphTransactionFactory.getTransaction(r);i.setFromIterator(n),n.addChild(e,80),i.dispose()},e.prototype.copySelectionToInternalClipboard=function(e,t){void 0===t&&(t=null);var n=e.get_selectionManager();this._selectionCollection=n.get_selectionCollection().clone(),this._noOutlineLevelContentOverride=!1;var r=Da.GraphIterator.createFromNode(n.get_theSelectionRoot()),i=Da.GraphIterator.createFromNode(this._clipboardRoot),a=this._graphTransactionFactory.getTransaction(3);a.setFromIterator(i),r.goToFirstChildByRole(82);do{r.get_currentNode().validateProperties(null)}while(r.goToNextSiblingByRoleOrReturnToParent(82));var s=new A_.a(t,o.i(this,this.clearInternalClipboard,"clearInternalClipboard"),new cf(r,i,this._selectionCollection,a));s.setDebugName("InternalCopy"),s.set_isSynchronous(!t||t.get_isSynchronous()),s.run()},e.prototype.clearInternalClipboard=function(e,t){Xi.t.mark(5566);var n=t.target;return n.goToFirstChild()?(n.disconnectNodeAndReturnToParent(),!0):(e.changeStepCallback(o.i(this,this.executeCopy,"executeCopy")),!0)},e.prototype.executeCopy=function(e,t){var n=new gf(t,null),r=new A_.a(e,o.i(this,this.coreCopySetup,"coreCopySetup"),n);return r.setDebugName("ExecuteCoreCopyToInternalClipboard"),r.run(),e.changeStepCallback(o.i(this,this.trimNewText,"trimNewText")),!0},e.prototype.coreCopySetup=function(e,t){var n=t,r=n.source;n.target,n.insertAfter;return r.goToFirstChild()?(e.changeStepCallback(o.i(this,this.coreCopyIteration,"coreCopyIteration")),!0):(n.parentArgs&&(n.parentArgs.childOperationReturnValue=null),C.ULS.shipAssertTag(6305560,307,!1),!1)},e.prototype.coreCopyIteration=function(e,t){var n=t,r=n.insertAfter,i=n.source,a=n.target,s=i.get_currentNode(),l=this.get_onlyCopySelectedNodes();if(!s.get_isPersistable())return e.changeStepCallback(o.i(this,this.coreCopyIncrement,"coreCopyIncrement")),!0;if(n.parentArgs.shouldCopySubtree&&(n.shouldCopySubtree=!0),!n.shouldCopySubtree&&(s.excludeFromInternalClipboard()&&n.get_usageHelper().internalCopyUsageData.c++,s.excludeFromInternalClipboard()||l&&!s.isPartOfSelectedStructure(this.get_sequenceCode())))return e.changeStepCallback(o.i(this,this.coreCopyIncrement,"coreCopyIncrement")),!0;if(!n.shouldCopySubtree&&l&&!s.get_renderToClipboard()){if(i.hasChildren()){n.useChildReturnValue=!0;var c=new A_.a(e,o.i(this,this.coreCopySetup,"coreCopySetup"),new gf(n,r));c.setDebugName("RecursiveCoreCopyToInternalClipboard"),c.run()}return e.changeStepCallback(o.i(this,this.coreCopyIncrement,"coreCopyIncrement")),!0}var u=a.get_currentNode().getParentGraphSpace().get_contentObjectSpace(),g=Ec.x(s,u,!0);this.get_usageEditor().recordNodeTypeMetrics(n.get_usageHelper().graphObjectUsageData,g);var p=18===i.get_parentNode().get_type()?1:i.get_role();if(a.insertChild(g,r,p),a.goToChild(g),n.insertAfter=g,cs.ParagraphReader.isParagraphNode(g)&&(this.processCopiedParagraphs(e,o.i(this,this.coreCopySetup,"coreCopySetup"),s,g,n),this.processCopiedBlobs(e,s,g)),this.ensureTableCellHasWidth(s,g),i.hasChildren()){C.ULS.shipAssertTag(6305562,307,!n.useChildReturnValue);var d=new A_.a(e,o.i(this,this.coreCopySetup,"coreCopySetup"),new gf(n,null));d.setDebugName("RecursiveCoreCopyToInternalClipboard"),d.run()}return e.changeStepCallback(o.i(this,this.coreCopyIterationPostProcessing,"coreCopyIterationPostProcessing")),!0},e.prototype.coreCopyIterationPostProcessing=function(t,n){var r=n,i=r.source,a=r.target,s=a.get_currentNode(),l=i.get_currentNode();if(cs.ParagraphReader.isParagraph(a)&&(r.paragraphLinks[l.get_id().toString()]=s),us.n.get_instance().get_item(54)&&cs.ParagraphReader.isParagraphNode(s)){if(cs.ParagraphReader.getTabCountInTheBeginning(l)>0)if(this._paragraphIndentationReader.getHangingIndent(l).get_valueAsTwips()>0)l.setValue(ks.j.paraTabCountInTheBeginning,0);else{var c=this._paragraphIndentationReader.getFirstLineIndentWithTabs(l).get_valueAsTwips();e.get_paragraphEditor().getIndentationEditor().setFirstLineIndent(s,c)}if(!this.get_isComplexTableCellPasteWithFormattingEnabled()&&this._formattingPropertyTransitStrategy.get_pasteParagraphImprovementIsEnabled()){if(i.returnToParent(),!dc.TableReader.isInTable(a)&&i.get_isLastSibling()&&!this.get_endsWithEop())for(var u=0,g=this._formattingPropertyTransitStrategy.get_paragraphPropertyWhitelist();u<g.length;u++){var p=g[u];s.removeProperty(p)}i.goToChild(l)}}if(us.n.get_instance().get_item(57)&&cs.ParagraphReader.isParagraphNode(s)){for(var d=s,h=new Array(0),_=new Array(0),m=0;m<d.get_wordRunProperties().get_length();m++)d.get_wordRunProperties().runIds.set_item(m,ry.CharacterPropertiesEditor.newWordRunId),d.get_wordRunProperties().paraIds.set_item(m,ry.CharacterPropertiesEditor.newWordParaId),h[m]=!0,_[m]=!1;d.setProperty_Unchecked(ks.j.newlyTypedRuns,h),C.ULS.shipAssertTag(6305563,307,h.length===d.get_wordRunProperties().get_length()),C.ULS.shipAssertTag(6305564,307,us.n.get_instance().get_item(50)),C.ULS.shipAssertTag(6305565,307,!!Br.App.get_theCoauthManager()),us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()&&(d.setProperty_Unchecked(Oh.p.runsFromMerge,_),C.ULS.shipAssertTag(6305566,307,_.length===d.get_wordRunProperties().get_length())),(this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeManager.get_changeTrackingDocumentSettingEnabled()||us.n.get_instance().get_item(45)&&Br.App.get_box4Bridge().get_trackedChangesEnabled())&&s.setValue(ks.j.isNewEop,!0),us.n.get_instance().get_item(14)&&s.removeProperties(ks.j.fieldNestedLevel,ks.j.paraEndInField,ks.j.paraStartInField),us.n.get_instance().get_item(45)&&cs.ParagraphReader.isParagraphNode(s)&&s.removeProperties(ks.j.isResilientEop)}if(this.oneNoteShouldPostProcessFdo(a)){var f=a.get_currentNode().getGraphSpace(),y=ka.ImageReader.getPictureContainerAsFileDataObject(a.get_currentNode().get_properties(),f.get_contentObjectSpace(),!1),S=ka.ImageReader.getPictureContainerAsFileDataObject(a.get_currentNode().get_properties(),f.get_contentObjectSpace(),!0),v=null;af.EmbeddedFileReader.isEmbeddedFile(a)&&(v=af.EmbeddedFileReader.getEmbeddedFileContainer(a.get_currentNode())),this.fileDataObjectCopyPostProcessing(y,l),this.fileDataObjectCopyPostProcessing(S,l),this.fileDataObjectCopyPostProcessing(v,l)}if(this.get_onlyCopySelectedNodes()&&(this.ensureTableCellHasOutlineElement(a),dc.TableReader.isTable(a))){var b=this._selectionCollection.createSelectionContextsIterator();b.moveNext();var T=Zc.getCellLocation(i,b.get_current().get_node());T||(T=new sy.x(0,0));var A=new ly(T,a,dc.TableReader.getColumnWidths(i),dc.TableReader.getRowHeights(i));this._tableEditor.resetRowAndColumnCountsUpdatingSpans(A)}return Ls.OutlineElementReader.isOutlineElement(a)&&!a.hasChildrenOfRole(2)&&(this._outlineElementEditor.createParagraph(a),a.returnToParent()),a.returnToParent(),r.parentArgs&&(r.parentArgs.childOperationReturnValue=r.insertAfter),t.changeStepCallback(o.i(this,this.coreCopyIncrement,"coreCopyIncrement")),!0},e.prototype.coreCopyIncrement=function(e,t){var n=t;if(n.useChildReturnValue&&(n.insertAfter=n.childOperationReturnValue,n.useChildReturnValue=!1),!n.source.goToNextSiblingOrReturnToParent()){n.parentArgs&&(n.parentArgs.childOperationReturnValue=n.insertAfter);var r=n.source;return 11!==r.get_currentNodeType()||r.getNextSiblingByRole(-1)||this.processOnCopyComplete(e,null,r.get_currentNode(),n.target.get_currentNode(),n),!1}return e.changeStepCallback(o.i(this,this.coreCopyIteration,"coreCopyIteration")),!0},e.prototype.processCopiedBlobs=function(e,t,n){for(var r=Xp.e(t),i=Xp.e(n),a=0;a<r.length;a++)r[a].onBlobCopy(i[a],e,o.i(this,this.coreCopySetup,"coreCopySetup"))},e.prototype.trimNewText=function(t,n){var r=n;if(r.contextIndex>=r.selectedContexts.length)return t.changeStepCallback(o.i(this,this.copyTeardown,"copyTeardown")),!0;var i=r.selectedContexts[r.contextIndex],a=i.get_node(),s=i.get_cpBegin(),l=i.get_cpEnd();if(!Pa.SelectionEditor.isInsertionPointOrTextRangeContext(i))if(!r.contextIndex&&Pa.SelectionEditor.isEndOfParagraphContext(i))l=s=cs.ParagraphReader.textLength(a);else if(cs.ParagraphReader.isParagraphContext(i))s=0,l=cs.ParagraphReader.textLength(a);else{if(!Pa.SelectionEditor.isAnchoredObjectContext(i)){if(vc.isOutlineContext(i))for(var c=xf.p.createTraverser(i.get_node());c.moveNext();){var u=c.get_currentNode();cs.ParagraphReader.isParagraphNode(u)&&Array.add(r.selectedContexts,_s.y.createTextRange(u,0,cs.ParagraphReader.textLength(u)))}return r.contextIndex++,!0}C.ULS.shipAssertTag(6305568,307,!r.contextIndex);var g=Da.GraphIterator.createFromNode(a),p=g.tryToRootAtAncestorOfType(12);C.ULS.shipAssertTag(6305569,307,p),a=g.get_origin(),l=s=cs.ParagraphReader.textLength(a)}var d=r.paragraphLinks[a.get_id().toString()];if(C.ULS.shipAssertTag(6305570,307,!!d),!d)return C.ULS.sendTraceTag(21041548,307,15,"TrimNewTextParagraphCloneNull: {0}",{ContextIndex:r.contextIndex,SelectedContextsLength:r.selectedContexts.length,SelectedNodeType:a.get_type(),ContextId:i.get_contextId()}),r.contextIndex++,!0;var h,_=Xp.e(d),m=!1;for(h=_.length-1;h>=0;h--)if(!_[h].get_canBeCopied())if(4!==_[h].get_blobType()){if(_[h].get_containingProperties().set_blob(null),us.n.get_instance().get_item(57)&&-1!==_[h].get_runIndex()){var f=_[h].get_containingProperties().get_formatting(),y=0,S=0;f&&-1===f.runIndex?(S=_[h].get_runIndex()+1,y=_[h].get_noOfRunsEmbedded()-1,f.runIndex=_[h].get_runIndex()):(y=_[h].get_noOfRunsEmbedded(),S=_[h].get_runIndex());for(var v=0;v<y;v++)d.get_wordRunProperties().removeAt(S,16);y>0&&(m=!0)}var b="";if(gy.s(_[h]))b=" ",r.get_usageHelper().internalCopyUsageData.f++;else if(gy.i(_[h])){var T=gy.g(_[h]);T&&(b=gy.w(T),r.get_usageHelper().internalCopyUsageData.g++)}var A=_[h].get_containingProperties().get_cp();A>=s&&A<l&&(e.get_characterPropertiesEditor().replaceTextRange(_s.y.createTextRange(d,A,A+1),b),l=l-1+b.length,r.get_usageHelper().internalCopyUsageData.i++)}else _[h].get_containingProperties().set_blob(null),_[h].get_containingProperties().set_blob(new uy.y(_[h].get_containingProperties(),uy.y.defaultLineBreakText)),r.get_usageHelper().internalCopyUsageData.e++;m&&d.updateRunIndices(),this.removeParagraphRanges(d);var I=cs.ParagraphReader.textLength(d);l<I&&e.get_characterPropertiesEditor().replaceTextRange(_s.y.createTextRange(d,l,I),""),s>0&&e.get_characterPropertiesEditor().replaceTextRange(_s.y.createTextRange(d,0,s),"");var w=0,x=Da.GraphIterator.createFromNode(d);for(x.goToFirstChildByRole(6);!x.get_isAtOrigin();){var F=x.get_currentNode();if(x.goToNextSiblingByRoleOrReturnToParent(6),ka.ImageReader.isImageNode(F))if(ka.ImageReader.isReproduceable(F))e.get_paragraphEditor().convertAnchoredImageToInline(F,_s.y.createIpContext(d,w)),w++,r.get_usageHelper().internalCopyUsageData.d++;else{var E=Da.GraphIterator.createFromNode(F);E.tryToRootAtAncestorOfType(12),E.disconnectNodeAndReturnToParent(),r.get_usageHelper().internalCopyUsageData.h++}else C.ULS.shipAssertTag(6305571,307,!1)}if(!cs.ParagraphReader.textLength(d)&&r.contextIndex===r.selectedContexts.length-1&&Pa.SelectionEditor.isInsertionPointOrTextRangeContext(i)){var P=Da.GraphIterator.createFromNode(d);P.tryToRootAtAncestorOfType(25)&&(hs.OutlineElementNavigator.returnToOutlineElement(P),this._outlineElementEditor.disconnectOutlineElement(P),r.contextIndex&&(this._selectionCollection.get_currentSelection().endsWithEop=!0))}return this.get_usageEditor().recordParagraphMetrics(r.get_usageHelper().paragraphUsageData,r.get_usageHelper().chpUsageData,r.get_usageHelper().blobUsageData,d),r.contextIndex++,!0},e.prototype.removeParagraphRanges=function(t){var n=us.n.get_instance().get_item(14),r=!this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&us.n.get_instance().get_item(45),i=e.get_isImprovedFieldProcessingEnabled(),o=t.get_characterProperties();if(us.n.get_instance().get_item(57)&&o&&(n||r)){for(var a=new y.c(cy.j),s=new y.c(Number),l=0;l<o.get_length();l++){var c=o.get_item(l);if(n){if(c.get_dynamicRangeObjects()&&a.add(c),i){if(c.get_fieldMarkerObjects()){for(var u=0;u<c.get_fieldMarkerObjects().get_length();u++)s.add(c.get_fieldMarkerObjects().get_item(u).get_runIndex());c.set_fieldMarkerObjects(null)}}else c.get_fieldRangeEnd()&&(s.add(c.get_fieldRangeEnd().get_runIndex()),c.set_fieldRangeEnd(null)),c.get_fieldRangeStart()&&(s.add(c.get_fieldRangeStart().get_runIndex()),c.set_fieldRangeStart(null));if(c.get_contentControlRangeObjects()){for(u=0;u<c.get_contentControlRangeObjects().get_length();u++)s.add(c.get_contentControlRangeObjects().get_item(u).get_runIndex());c.set_contentControlRangeObjects(null)}}if(r){if(Br.App.get_box4Bridge().get_trackedChangesEnabled()){if(c.get_formatting()&&e.get_formattingEditor().removeLinkFormatting(c.get_formatting()),c.get_hyperlink()){for(u=0;u<c.get_hyperlink().get_noOfRunsEmbedded();u++)s.add(c.get_hyperlink().runIndex+u);c.set_hyperlink(null)}c.set_isHyperlinkEnd(!1)}c.set_trackedChange(null),c.set_isTrackedChangeEnd(!1)}}t.removeAndUpdateWordRunProperties(!0,s);for(var g=a.$$lge();g.$$mn();){(c=g.$$cu()).set_dynamicRangeObjects(null)}if(r&&o.get_length()>1){var p=o.get_first();p.set_trackedChange(new iy.b(p)),o.get_last().set_isTrackedChangeEnd(!0)}}},e.prototype.copyTeardown=function(e,t){var n=t;return this._clipboardRoot.validateProperties(null),t.graphTransaction.dispose(),Xi.t.mark(5567),this.normalizeCopiedTable(),this.dumpInternalClipboard(),this._usageHelper=n.get_usageHelper(),this.logClipboardMetricsForPaste("Copy"),this.get_isClipboardRootEmpty()&&C.ULS.sendTraceTag(6305600,307,50,"Empty ClipboardRoot"),!1},e.prototype.get_isClipboardRootEmpty=function(){return!Da.GraphIterator.createFromNode(this._clipboardRoot).goToFirstChild()},e.prototype.useVirtualClipboardRoot=function(){this._clipboardRoot=this._virtualClipboardRoot},e.prototype.useUserClipboardRoot=function(){this._clipboardRoot=this._userClipboardRoot},e.prototype.useDragDropClipboardRoot=function(){this._clipboardRoot=this._dragdropClipboardRoot},e.prototype.get_isUserClipboard=function(){return this._clipboardRoot===this._userClipboardRoot},e.prototype.get_isDragDropClipboard=function(){return this._clipboardRoot===this._dragdropClipboardRoot},e.prototype.get_isVirtualClipboard=function(){return this._clipboardRoot===this._virtualClipboardRoot},e.prototype.clearInternalData=function(){for(var e=Da.GraphIterator.createFromNode(this._clipboardRoot);e.goToFirstChild();)e.disconnectNodeAndReturnToParent()},e.prototype.logClipboardMetricsForPaste=function(e){var t=this._usageHelper.internalCopyUsageData.b;e+="-"+t,this._usageHelper.internalCopyUsageData.b=e,this._usageHelper.graphObjectUsageData.b=e,this._usageHelper.paragraphUsageData.b=e,this._usageHelper.chpUsageData.b=e,this._usageHelper.blobUsageData.b=e,this.get_usageEditor().logInternalCopyUsageData(this._usageHelper.internalCopyUsageData),this.get_usageEditor().logGraphObjectUsageData(this._usageHelper.graphObjectUsageData),this.get_usageEditor().logParagraphUsageData(this._usageHelper.paragraphUsageData),this.get_usageEditor().logChpUsageData(this._usageHelper.chpUsageData),this.get_usageEditor().logBlobUsageData(this._usageHelper.blobUsageData),this._usageHelper.internalCopyUsageData.b=t,this._usageHelper.graphObjectUsageData.b=t,this._usageHelper.paragraphUsageData.b=t,this._usageHelper.chpUsageData.b=t,this._usageHelper.blobUsageData.b=t},e.prototype.pasteFromInternalClipboard=function(t,n,r,i,a,s){void 0===a&&(a=null),void 0===s&&(s=null),this.logClipboardMetricsForPaste("Paste");var l=Da.GraphIterator.createFromNode(n),c=Da.GraphIterator.createFromNode(this._clipboardRoot),u=null;if(a){var g=new Jc.i(vc.defaultHorizontalOffset,vc.defaultVerticalOffset);u=a.equals(new Jc.i(-1,-1))?new Jc.i(0,0):a.subtract(g)}if(this.internalClipboardContainsSingleOutlineLevelElement())if(c.goToFirstChild(),ka.ImageReader.isImageNode(c.get_currentNode())){var p=c.get_currentNode();c.returnToParent(),c.insertChild(this._outlineElementEditor.createOutlineElementNode(),null,1),c.goToFirstChild(),c.insertChild(p,null,2),c.returnToParent(),c.goToChild(p),c.disconnectNodeAndReturnToParent(),this._imageEditor.onFloatingImageChangeToNormal(p),this.set_containsOutlineLevelContent(!1)}else if(af.EmbeddedFileReader.isFloatingEmbeddedFileNode(c.get_currentNode())){var d=c.get_currentNode();c.returnToParent(),c.insertChild(this._outlineElementEditor.createOutlineElementNode(),null,1),c.goToFirstChild();var h=this._outlineElementEditor.createParagraph(c),_=_s.y.createIpContext(h,0);e.get_characterPropertiesEditor().replaceTextRange(_,"<<"+af.EmbeddedFileReader.getEmbeddedFileName(d)+">>"),c.returnToParent(),c.returnToParent(),c.goToChild(d),c.disconnectNodeAndReturnToParent(),this.set_containsOutlineLevelContent(!1)}if((!this._contentControlCopyPasteHelper||!this._contentControlCopyPasteHelper.isPastedInInlineContentControl(r))&&this.get_isPasteTableWithReplacingCellEnabled()&&this.isToPasteATableInTableCell(c,l))return c.get_currentNode().validateProperties(null),C.ULS.sendTraceTag(7869376,307,50,"Begin internal paste table in table"),this.replaceTableCellsFromClipboardTable(s,c,l,u,t),void C.ULS.sendTraceTag(39699553,307,50,"The call to ReplaceTableCellsFromClipboardTable ended.");Xi.t.mark(5564),c.get_currentNode().validateProperties(null);var m={};m[e.imagePasteConstrainingWidth]=i,mc.ListReader.isListOutlineElementNode(r)&&this.get_listReader().get_qoEListInternalCCPImprovementIsEnabled()&&(m[oy.c.internalListPasteIntoListSkipRenumberSourceList]=!0);var f=new pf(c,l,r,u,m),y=new A_.a(s,o.i(this,this.corePasteSetup,"corePasteSetup"),f);y.setDebugName("ExecuteCorePasteFromInternalClipboard"),y.set_isSynchronous(!s||s.get_isSynchronous()),this.processBeforePaste(f),y.run()},e.prototype.isTableCellPaste=function(e){if(e&&e.get_isValid()){var t=Da.GraphIterator.createFromNode(this._clipboardRoot);return this.isToPasteATableInTableCell(t,e)}return!1},e.prototype.isToPasteATableInTableCell=function(e,t){if(Zc.isTableCellOrInside(t)&&1===e.getChildCount()){if(e.goToFirstChildByRole(1),Ls.OutlineElementReader.isOutlineElement(e)){if(hs.OutlineElementNavigator.moveToContent(e),dc.TableReader.isTable(e)){if(dc.TableReader.isComplexTableNode(e.get_currentNode())&&C.ULS.sendTraceTag(17835601,307,50,"Source table is a complex table."),t.tryToRootAtAncestorOfType(14)&&!dc.TableReader.isComplexTableNode(ld.getContainingTable(t)))return C.ULS.sendTraceTag(19269659,307,50,"Target table is not a complex table."),!0;if(C.ULS.sendTraceTag(19269660,307,50,"Target table is a complex table."),this.get_isComplexTableCellPasteWithFormattingEnabled())return!0}hs.OutlineElementNavigator.returnToOutlineElement(e)}e.returnToParent()}return!1},e.prototype.replaceTableCellsFromClipboardTable=function(e,t,n,r,i,a){void 0===a&&(a=null),n.tryToRootAtAncestorOfType(14);var s=cd.z(n),l=sd.e(n);n.returnToAncestorOfType(14);var c=dc.TableReader.getRowCount(n.get_currentNode()),u=dc.TableReader.getColumnCount(n.get_currentNode()),g=dc.TableReader.getRowCount(t.get_currentNode()),p=dc.TableReader.getColumnCount(t.get_currentNode());if(C.ULS.sendTraceTag(8716373,307,50,"Target and source table row column counts: target: {0},{1}; source: {2},{3};",c,u,g,p),this._getNewOutlineElementInfoDelegate=a?function(){return null}:ny.get_getNewOutlineElementInfoDelegate(),this.isTableDimensionValid(s+g,l+p)){var d=s+g-c;d>0&&(ld.moveToLastRow(n),C.ULS.sendTraceTag(8716374,307,50,"Begin insert rows: "+d),this._tableEditor.insertRows(n,!1,d,this._getNewOutlineElementInfoDelegate),C.ULS.sendTraceTag(8716375,307,50,"Completed inserting rows."),n.returnToAncestorOfType(14));var h=l+p-u;if(h>0){C.ULS.sendTraceTag(8716376,307,50,"Begin insert columns: "+h);try{this._tableEditor.insertColumns(n,u,!1,h,this._getNewOutlineElementInfoDelegate)}catch(e){throw C.ULS.sendTraceTag(19269661,307,10,"Insert columns failed: {0}",e.toString()),e}C.ULS.sendTraceTag(8716377,307,50,"Completed inserting columns.")}var _=this.getChangedCellIndices(c,u,g,p,s,l);C.ULS.sendTraceTag(8716378,307,50,"Begin paste cell contents");var m=new A_.a(this.get_isComplexTableCellPasteWithFormattingEnabled()?e:null,o.i(this,this.pasteTableOperationRun,"pasteTableOperationRun"),new df(null,t,n,r,s,l,_,a,i));m.setDebugName("ExecuteCorePasteTableInTable"),m.set_isSynchronous(!1),m.run()}},e.prototype.isTableDimensionValid=function(t,n){if(!this.get_isNormalTableCellPasteWithFormattingEnabled())return!0;var r={};t>e.c_maxTableRowColCount&&(r.rowCount=t,r.c_maxTableRowColCount=e.c_maxTableRowColCount),n>e.c_maxTableRowColCount&&(r.columnCount=n,r.c_maxTableRowColCount=e.c_maxTableRowColCount);var i=t*n;return i>e.c_maxTableCellCount&&(r.rowCount=t,r.columnCount=n,r.cellsCount=i,r.c_maxTableCellCount=e.c_maxTableCellCount),of.f(r).length>0&&C.ULS.sendTraceTag(39716808,307,10,"IsTableDimensionValid: {0}",r),!of.f(r).length},e.prototype.pasteTableOperationRun=function(e,t){var n=t;if(n.tableCellPasteOperation){if(n.tableCellPasteOperation.get_inProgress())return!0;if(Zc.isTableCell(n.source)||n.source.returnToAncestorOfType(16),this.get_isNormalTableCellPasteWithFormattingEnabled()&&Zc.isFirstCellInTable(n.source)&&this.adjustSelectionAfterPaste(n.interactiveView,n.target.get_currentNode()),Zc.isLastCellInTable(n.source))return this._contentControlCopyPasteHelper&&this._contentControlCopyPasteHelper.processPastedContentsAfterReplaceTableCellsFromClipboardTable(n.target,n.changedCellIndices),this.normalizePastedTable(ld.getContainingTable(n.target)),C.ULS.sendTraceTag(7869377,307,50,"End of internal paste table in table"),!1;Zc.isTableCell(n.target)||n.target.returnToAncestorOfType(16);var r=!this.get_isComplexTableCellPasteWithFormattingEnabled();Zc.isLastCellInRow(n.source)?(ld.moveToNextRow(n.target),ld.moveToColumnByIndex(n.target,n.columnIndex),C.ULS.sendTraceTag(8716379,307,50,"Move to next row to replace cell contents")):ld.moveToNextOrPreviousCell(n.target,!1,r),ld.moveToNextOrPreviousCell(n.source,!1,r)}else dc.TableReader.isTable(n.target)||n.target.returnToAncestorOfType(14),dc.TableReader.isTable(n.source)||n.source.returnToAncestorOfType(14),ld.moveToCell(n.target,n.rowIndex,n.columnIndex),ld.moveToCell(n.source,0,0);for(;n.target.goToFirstChild();)n.target.disconnectNodeAndReturnToParent();return n.tableCellPasteOperation=new A_.a(e,n.pasteOperationStep?n.pasteOperationStep:o.i(this,this.corePasteSetup,"corePasteSetup"),new pf(n.source,n.target,null,n.outlineOffset)),n.tableCellPasteOperation.setDebugName("ExecuteCorePasteCellContentInCell"),n.tableCellPasteOperation.set_isSynchronous(!1),n.tableCellPasteOperation.run(),!0},e.prototype.normalizeCopiedTable=function(){if(this.get_isComplexTableCellPasteWithFormattingEnabled()){for(var e=Da.GraphIterator.createFromNode(this.get_theClipboardRoot()),t=e.get_currentNode();14!==e.get_currentNodeType();)if(!(t=e.goToFirstChild()))return void C.ULS.sendTraceTag(39716809,307,50,"NormalizeCopiedTable: Couldn't find any Table graph node under this.TheClipboardRoot.");this.normalizeTable(t)}},e.prototype.normalizePastedTable=function(e){this.get_isComplexTableCellPasteWithFormattingEnabled()&&this.normalizeTable(e)},e.prototype.toControlCell=function(e){var t=Da.GraphIterator.createFromNode(e);this._outlineEditor.insertOutlineElementAsChild(t,null,!0),e.set_isGhostCell(!1),e.set_rowSpan(1),e.set_colSpan(1)},e.prototype.normalizeTable=function(t){var n=this;if(t&&14===t.get_type()){C.ULS.sendTraceTag(39716810,307,50,"NormalizeTable: start to normalize.");var r={},i=dc.TableReader.getRowCount(t),o=dc.TableReader.getColumnCount(t),a=Da.GraphIterator.createFromNode(t);ld.forEachCellInTable(a,(function(a,s,l){var c={},u=s,g=l,p=a.get_currentNode();if(16===p.get_type())if(p.get_isGhostCell()){e.composeKeyOfGhostCell(s,l)in r||(n.toControlCell(p),c.IsGhostCell="->false")}else{us.n.get_instance().get_item(77),e.refreshCellRowSpan(t,p,u,g,i,(function(e,t,n){c.rowSpan=String.format("{0}:{1}->{2}",e,t,n)})),e.refreshCellColSpan(t,p,g,u,o,(function(e,t,n){c.colSpan=String.format("{0}:{1}->{2}",e,t,n)}));for(var d=String.format("{0},{1}-{2},{3}",u,g,u+p.get_rowSpan(),g+p.get_colSpan()),h=0;h<p.get_rowSpan();h++)for(var _=0;_<p.get_colSpan();_++)(h||_)&&(r[e.composeKeyOfGhostCell(u+h,g+_)]=d)}return of.f(c).length>0&&(void 0!==c.IsGhostCell&&null!==c.IsGhostCell||(void 0!==c.rowSpan&&null!==c.rowSpan||(c.rowSpan=p.get_rowSpan()),void 0!==c.colSpan&&null!==c.colSpan||(c.colSpan=p.get_colSpan())),C.ULS.sendTraceTag(39175904,307,50,"NormalizeTable: [{0},{1}]: {2}.",s,l,c)),!0})),e.dumpGhostCells(r)}},e.prototype.get_isNormalTableCellPasteWithFormattingEnabled=function(){return us.n.get_instance().get_item(77)},e.prototype.get_isComplexTableCellPasteWithFormattingEnabled=function(){return!!this._appSettingsManager&&this._appSettingsManager.getBooleanAppSetting("ComplexTableCellPasteWithFormattingIsEnabled")},e.prototype.adjustSelectionAfterPaste=function(e,t){if(e){var n=Da.GraphIterator.createFromNode(t);if(n.goToLastChildByRole(1)){var r=n.goToFirstChildByRole(2);if(r){var i=ss.SelectionFactory.createIpSelection(r,0);e.get_selectionManager().setSelection(i)}else C.ULS.sendTraceTag(38843739,307,50,"AdjustSelectionAfterPaste: no child paragraph node was found.")}else C.ULS.sendTraceTag(38843740,307,50,"AdjustSelectionAfterPaste: no child OE node was found.")}else C.ULS.sendTraceTag(38843738,307,50,"AdjustSelectionAfterPaste: interactiveView is null, abort.")},e.prototype.getChangedCellIndices=function(e,t,n,r,i,o){for(var a=new Array(0),s=0;s<Math.max(i+n,e);s++){var l=0,c=o+r;for(s<i?l=t:s>=i&&s<Math.min(i+n,e)?l=o:s>=i+n&&s<e?l=t:c=Math.max(o+r,t);l<c;l++)Array.add(a,new Array(2)),a[a.length-1][0]=s,a[a.length-1][1]=l}return a},e.prototype.corePasteSetup=function(e,t){return t.source.goToFirstChild()?(e.changeStepCallback(o.i(this,this.corePasteIteration,"corePasteIteration")),!0):(e.changeStepCallback(o.i(this,this.pasteTeardown,"pasteTeardown")),!0)},e.prototype.replicateTableCellProperties=function(e,t){if(!this.get_isComplexTableCellPasteWithFormattingEnabled())return 0;if(!t||!e)return C.ULS.sendTraceTag(39175905,307,50,"ReplicateTableCellProperties: {0}",{source:e,table:t}),0;if(16!==t.get_currentNode().get_type()||16!==e.get_parentNode().get_type())return 0;var n=t.get_currentNode(),r=e.get_parentNode(),i={};return n.get_isGhostCell()!==r.get_isGhostCell()&&(n.set_isGhostCell(r.get_isGhostCell()),i.IsGhostCell=n.get_isGhostCell()),n.get_isSkippedCell()!==r.get_isSkippedCell()&&(n.set_isSkippedCell(r.get_isSkippedCell()),i.IsSkippedCell=n.get_isSkippedCell()),n.get_shouldRenderCell()!==r.get_shouldRenderCell()&&(n.set_shouldRenderCell(r.get_shouldRenderCell()),i.ShouldRenderCell=n.get_shouldRenderCell()),n.get_colSpan()!==r.get_colSpan()&&(i.ColSpan=String.format("{0}<={1}.",n.get_colSpan(),r.get_colSpan()),n.set_colSpan(r.get_colSpan())),n.get_rowSpan()!==r.get_rowSpan()&&(i.RowSpan=String.format("{0}<={1}.",n.get_rowSpan(),r.get_rowSpan()),n.set_rowSpan(r.get_rowSpan())),of.f(i).length},e.prototype.corePasteIteration=function(e,t){var n=t,r=n.source,i=n.target,a=r.get_currentNode();if(!a.get_isPersistable())return e.changeStepCallback(o.i(this,this.corePasteIncrement,"corePasteIncrement")),!0;if(!a.get_canBePasted())return e.changeStepCallback(o.i(this,this.corePasteIncrement,"corePasteIncrement")),!0;if(this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&Ls.OutlineElementReader.isOutlineElement(r)){if(!hs.OutlineElementNavigator.moveToContent(r).get_canBePasted())return hs.OutlineElementNavigator.returnToOutlineElement(r),e.changeStepCallback(o.i(this,this.corePasteIncrement,"corePasteIncrement")),!0;hs.OutlineElementNavigator.returnToOutlineElement(r)}C.ULS.shipAssertTag(6305608,307,!a.excludeFromInternalClipboard());var s=i.get_currentNode().getParentGraphSpace().get_contentObjectSpace(),l=Ec.x(a,s,!0);l.onBeforePaste(),this.replicateTableCellProperties(r,i),i.insertChild(l,n.insertAfter,r.get_role()),i.goToChild(l),n.insertAfter=l,us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(l),this.ensureTableCellHasWidth(a,l);var c=new A_.a(e,o.i(this,this.corePasteSetup,"corePasteSetup"),new pf(r,i,null,n.outlineOffset,n.featureArgs));return c.setDebugName("RecursiveCorePasteOperation"),c.run(),e.changeStepCallback(o.i(this,this.corePasteIterationPostProcessing,"corePasteIterationPostProcessing")),!0},e.prototype.processPastedBlobs=function(t,n,r){for(var i=Xp.e(n),a=Xp.e(r),s=i.length-1;s>=0;s--){if(!i[s].shouldRetainBlobAfterPaste(r)){var l=_s.y.createTextRange(r,i[s].get_containingProperties().get_cp(),i[s].get_containingProperties().get_cp()+1);e.get_characterPropertiesEditor().replaceTextRange(l,"")}i[s].onBlobPaste(a[s],t,o.i(this,this.corePasteSetup,"corePasteSetup"))}},e.prototype.fileDataObjectCopyPostProcessing=function(e,t){if(e){C.ULS.shipAssertTag(6305610,307,e.hasProperty(py.w.originalObjectDataBlobId)),e.hasProperty(py.w.originalObjectDataBlobId)||e.setValue(py.w.originalObjectDataBlobId,e.getValueWithDefault(String,py.w.objectDataBlobId,""));var n=ay.getSection(t),r=n?n.get_fileId():Br.App.get_activeAppFrame().workspace.get_activeSection()?Br.App.get_activeAppFrame().workspace.get_activeSection().get_fileId():null;!e.hasProperty(py.w.fileId)&&r&&e.setValue(py.w.fileId,r)}},e.prototype.fileDataObjectPastePostProcessing=function(e){e&&this._imageEditor.setNewFileDataObjectId(e)},e.prototype.corePasteIterationPostProcessing=function(t,n){var r=n,i=r.target,a=i.get_currentNode(),s=r.source.get_currentNode(),l=-1;if(r.featureArgs[e.imagePasteConstrainingWidth]&&(l=r.featureArgs[e.imagePasteConstrainingWidth]),cs.ParagraphReader.isParagraphNode(a)&&(this.processPastedParagraphs(t,o.i(this,this.corePasteSetup,"corePasteSetup"),s,a,r),this.processPastedBlobs(t,s,a)),a.onAfterPaste(),r.featureArgs[oy.c.internalListPasteIntoListSkipRenumberSourceList]?22===a.get_type()&&a.setValue(ks.j.listID,Number.MAX_VALUE):this._listEditor.renumberForOEPasteIfNecessary(a),us.n.get_instance().get_item(11)&&cs.ParagraphReader.isParagraphNode(a)){var c=Xp.g(a,5);if(c.length>0){for(var u=0,g=c;u<g.length;u++){var p=g[u];if(!p.properties.hasProperty(ks.j.pictureUpdatedGraphicProperties)&&p.properties.hasProperty(ks.j.pictureGraphicProperties)){var d=p.properties.getValue(String,ks.j.pictureGraphicProperties);p.properties.setValue(ks.j.pictureUpdatedGraphicProperties,d)}ka.ImageReader.isCanvasRenderEnabled()?ka.ImageReader.isUneditedImage(p.properties)&&this._imageEditor.scaleImageWidthAndHeight(p.properties,l):ka.ImageReader.isRenderedImage(p.properties)||this._imageEditor.scaleImageWidthAndHeight(p.properties,l)}(m=a.getParentGraphSpace()).get_contentReplicator().forceOutbound(null,null,null)}}if(us.n.get_instance().get_item(25)&&Ls.OutlineElementReader.isOutlineElement(i)&&this._outlineElementEditor.updateAuthorAndTimeStamp(i.get_currentNode()),us.n.get_instance().get_item(10)&&vc.isOutlineLevelNode(a)){var h=Yc.e(a),_=r.outlineOffset;Yc.m(a,h.get_x()+_.get_x(),h.get_y()+_.get_y())}if(this.oneNoteShouldPostProcessFdo(i)){var m=i.get_currentNode().getGraphSpace(),f=ka.ImageReader.getPictureContainerAsFileDataObject(i.get_currentNode().get_properties(),m.get_contentObjectSpace(),!1),y=ka.ImageReader.getPictureContainerAsFileDataObject(i.get_currentNode().get_properties(),m.get_contentObjectSpace(),!0),C=null;af.EmbeddedFileReader.isEmbeddedFile(i)&&(C=af.EmbeddedFileReader.getEmbeddedFileContainer(i.get_currentNode())),this.fileDataObjectPastePostProcessing(f),this.fileDataObjectPastePostProcessing(y),this.fileDataObjectPastePostProcessing(C),(f||y||C)&&(m.isOneNoteEnsureFreshNeeded=!0,m.isOneNotePageVersionCreatePending=!0)}if(us.n.get_instance().get_item(24)&&af.EmbeddedFileReader.isEmbeddedFile(i)){var S=i.get_currentNode();if(af.EmbeddedFileReader.isFloatingEmbeddedFile(i)){i.returnToParent();var v=this._outlineEditor.createOutlineNode();v.setValue(Kc.b.layoutAlignmentSelf,e.get_pageReader().isRtl(S)?11:9);h=Yc.e(a);Yc.m(v,h.get_x(),h.get_y()),i.insertChild(v,S,1),i.goToChild(S),i.disconnectNodeAndGoToNextSiblingOrReturnToParent(),this._outlineEditor.appendOutlineElement(i,!1)}else i.disconnectNodeAndReturnToParent();var b=this._outlineElementEditor.createParagraph(i),T=_s.y.createIpContext(b,0);e.get_characterPropertiesEditor().replaceTextRange(T,"<<"+af.EmbeddedFileReader.getEmbeddedFileName(S)+">>")}return this.ensureTableCellHasOutlineElement(i),this.updateTableRowCount(s,a),i.returnToParent(),t.changeStepCallback(o.i(this,this.corePasteIncrement,"corePasteIncrement")),!0},e.prototype.oneNoteShouldPostProcessFdo=function(e){return us.n.get_instance().get_item(1)&&ka.ImageReader.isImage(e)||us.n.get_instance().get_item(24)&&af.EmbeddedFileReader.isEmbeddedFile(e)},e.prototype.updateTableRowCount=function(e,t){if(this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&dc.TableReader.isTableNode(e)){for(var n=0,r=dc.TableReader.getRowCount(e),i=dc.TableReader.getRowsInTable(e,0,r-1).$$lge();i.$$mn();){i.$$cu().get_trackedChangeDeletion()&&n++}var o=this._graphTransactionFactory.getTransaction(4);o.setFromNode(t),t.get_properties().setValue(Kc.b.tableRowCount,r-n),o.dispose()}},e.prototype.corePasteIncrement=function(e,t){return t.source.goToNextSiblingOrReturnToParent()?(e.changeStepCallback(o.i(this,this.corePasteIteration,"corePasteIteration")),!0):(e.changeStepCallback(o.i(this,this.pasteTeardown,"pasteTeardown")),!0)},e.prototype.pasteTeardown=function(e,t){return Xi.t.mark(5565),!1},e.prototype.nothingToPaste=function(){return!Da.GraphIterator.createFromNode(this._clipboardRoot).goToFirstChild()},e.prototype.internalClipboardContainsSingleOutlineLevelElement=function(){return!!this.get_containsOutlineLevelContent()&&1===Da.GraphIterator.createFromNode(this._clipboardRoot).getChildCount()},e.prototype.internalClipboardContainsSingleParagraph=function(t){var n=Da.GraphIterator.createFromNode(this._clipboardRoot);return t&&this.internalClipboardContainsSingleOutlineLevelElement()&&n.goToFirstChild(),!(1!==n.getChildCount()||(n.goToFirstChild(),!Ls.OutlineElementReader.isOutlineElement(n)||1!==n.getChildCount()||!n.goToFirstChildByRole(2)))&&(cs.ParagraphReader.isParagraph(n)&&!e.get_unsupportedNodeEditor().containsUnsupportedObject(n))},e.prototype.getClipboardParagraphText=function(){var e=Da.GraphIterator.createFromNode(this._clipboardRoot);return this.internalClipboardContainsSingleOutlineLevelElement()&&e.goToFirstChild(),e.goToFirstChild(),e.goToFirstChild(),C.ULS.shipAssertTag(6305614,307,cs.ParagraphReader.isParagraph(e)),cs.ParagraphReader.text(e.get_currentNode())},e.prototype.getCopySourceFromDOMTree=function(e){try{return this.getCopySourceFromDOMTreeInternal(e)}catch(e){return C.ULS.sendTraceTag(23643968,307,10,"GetCopySourceFromDOMTree failed with exception:{0}",e.message),0}},e.prototype.getCopySourceFromDOMTreeInternal=function(e){var t=0;if(e&&!(t=this.getCopySourceFromDOMElement(e))&&e.childNodes)for(var n=0;n<e.childNodes.length&&!(t=this.getCopySourceFromDOMTree(e.childNodes[n]));n++);return t},e.prototype.getCopySourceFromDOMElement=function(e){if(e.nodeType===Ya.o.element&&e.getAttribute)for(var t=0,n=(e.getAttribute("class")||"").split(" ");t<n.length;t++){var r=n[t];if(r.startsWith(this._sequenceCodeCommonPrefix))return r.startsWith(this._sequenceCodePrefix)?this.get_sequenceCode()&&r===this._sequenceCodePrefix+this.get_sequenceCode()?3:2:1}return 0},e.prototype.dumpInternalClipboard=function(){return new Array(0)},e.prototype.processCopiedParagraphs=function(t,n,r,i,o){o.get_featureArgs()||o.set_featureArgs({}),e._eventSource.raiseEvent("OnParagraphCopy",new hf(t,n,r,i,o.get_featureArgs()))},e.prototype.processOnCopyComplete=function(t,n,r,i,o){o.get_featureArgs()||o.set_featureArgs({}),e._eventSource.raiseEvent("OnCopyComplete",new hf(t,n,r,i,o.get_featureArgs()))},e.prototype.processBeforePaste=function(t){t.featureArgs||(t.featureArgs={}),e._eventSource.raiseEvent("BeforePaste",new uf(t.featureArgs))},e.prototype.processPastedParagraphs=function(t,n,r,i,o){e._eventSource.raiseEvent("OnParagraphPaste",new hf(t,n,r,i,o.featureArgs))},e.prototype.ensureTableCellHasOutlineElement=function(e){Zc.isTableCell(e)&&(e.goToFirstChildByRole(1)||this._outlineEditor.appendOutlineElement(e,!0),e.returnToParent())},e.prototype.ensureTableCellHasWidth=function(e,t){this._tableCellReader.isTableCellNode(t)&&t.set_width(e.get_width())},e.add_onParagraphCopy=function(t){e._eventSource.addHandler("OnParagraphCopy",t)},e.remove_onParagraphCopy=function(t){e._eventSource.removeHandler("OnParagraphCopy",t)},e.add_onParagraphPaste=function(t){e._eventSource.addHandler("OnParagraphPaste",t)},e.remove_onParagraphPaste=function(t){e._eventSource.removeHandler("OnParagraphPaste",t)},e.add_onCopyComplete=function(t){e._eventSource.addHandler("OnCopyComplete",t)},e.remove_onCopyComplete=function(t){e._eventSource.removeHandler("OnCopyComplete",t)},e.add_beforePaste=function(t){e._eventSource.addHandler("BeforePaste",t)},e.remove_beforePaste=function(t){e._eventSource.removeHandler("BeforePaste",t)},e.get_formattingEditor=function(){return e._formattingEditor||(e._formattingEditor=se.w.get_instance().resolve(xs.z))},e.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=se.w.get_instance().resolve(Va.x))},e.get_paragraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=se.w.get_instance().resolve(gc.g))},e.get_isImprovedFieldProcessingEnabled=function(){var e=se.w.get_instance().tryResolve($p.d);return!!e&&e.isFeatureEnabled(77)},e.get_unsupportedNodeEditor=function(){return wf.q.get_instance()},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e.dumpGhostCells=function(e){for(var t={},n=0,r=of.f(e);n<r.length;n++){var i=r[n],o=e[i];t[o]=o in t?String.format("{0}|{1}",t[o],i):i}of.f(t).length>=1&&C.ULS.sendTraceTag(39204995,307,50,"NormalizeTable: ghostCells - {0}",t)},e.refreshCellColSpan=function(t,n,r,i,o,a){n.get_colSpan()>o-r&&(a&&a("A",n.get_colSpan(),o-r),n.set_colSpan(o-r));var s=e.shrinkOrExtendColSpan(t,n,i,r);n.get_colSpan()!==s&&(a&&a("B",n.get_colSpan(),s),n.set_colSpan(s))},e.refreshCellRowSpan=function(t,n,r,i,o,a){n.get_rowSpan()>o-r&&(a&&a("A",n.get_rowSpan(),o-r),n.set_rowSpan(o-r));var s=e.shrinkOrExtendRowSpan(t,n,r,i);n.get_rowSpan()!==s&&(a&&a("B",n.get_rowSpan(),s),n.set_rowSpan(s))},e.shrinkOrExtendColSpan=function(t,n,r,i){var o=n.get_colSpan();return e.shrinkOrExtendSpan(t,o,(function(e,t){ld.moveToCell(e,r,i+t);e.get_currentNode()}))},e.shrinkOrExtendRowSpan=function(t,n,r,i){var o=n.get_rowSpan();return e.shrinkOrExtendSpan(t,o,(function(e,t){ld.moveToCell(e,r+t,i);e.get_currentNode()}))},e.shrinkOrExtendSpan=function(e,t,n){if(14!==e.get_type())throw Error.argument("tableNode is not a Table.");if(!n)throw Error.argumentNull("MoveToCellAction");for(var r=1;r<t;r++){var i=Da.GraphIterator.createFromNode(e);n(i,r);var o=i.get_currentNode();if(!o||16!==o.get_type()||!o.get_isGhostCell())return r}return t},e.composeKeyOfGhostCell=function(e,t){return e+","+t},e._eventSource=new bt.f,e._formattingEditor=null,e._characterPropertiesEditor=null,e._paragraphEditor=null,e.c_maxTableRowColCount=50,e.c_maxTableCellCount=1225,e.imagePasteConstrainingWidth="PasteConstrainingWidth",e}();(0,o.l)(dy,"InternalClipboard",null,[]);var hy=function(e){function t(t,n,r,i,o,a,s){var l=e.call(this,t,n,r,o,a)||this;return l._internalClipboard=null,l._lazyPageView=null,l._internalClipboard=i,l._lazyPageView=s,l}return(0,S.t)(t,e),t.prototype.get_shouldGetDragDropConstrainingWidth=function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AutoResizeDragDropImageIsEnabled")},t.prototype.get__pageView=function(){return this._lazyPageView.get_value()},t.prototype.get_nothingToPaste=function(){return this._internalClipboard.nothingToPaste()},t.prototype.get_pastingOutlines=function(){var e=this._internalClipboard;return e.get_containsOutlineLevelContent()&&!e.internalClipboardContainsSingleOutlineLevelElement()},t.prototype.executePasteOfOutlines=function(e,t){C.ULS.shipAssertTag(6305616,307,vc.isOutline(e));var n=Yc.e(e.get_currentNode());if(vc.isEmpty(e)){var r=_s.y.create(e.get_currentNode());e.returnToNodeOfType(8),L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(r,ii.Dx,2,!0,null,null)}else e.returnToNodeOfType(8);var i=e.goToLastChildByRole(1);i&&e.returnToParent(),this._internalClipboard.pasteFromInternalClipboard(this.parentArgs.interactiveView,e.get_currentNode(),i,-1,n,t)},t.prototype.get_isContentSingleParagraph=function(){return this._internalClipboard.internalClipboardContainsSingleParagraph(!0)},t.prototype.get_contentAsText=function(){return this._internalClipboard.getClipboardParagraphText()},t.prototype.executePaste=function(e){var t=new Da.GraphIterator;this.precedingNodeRef.restore(t),C.ULS.shipAssertTag(6305618,307,Ls.OutlineElementReader.isOutlineElement(t)),this.parentArgs.operationTelemetry&&this.parentArgs.operationTelemetry.appendOperationFlag("internal");var n=-1;if(this.get_shouldGetPasteConstrainingWidth()&&o.r(U_.d,this.parentArgs.actionData))n=this.parentArgs.actionData.getValueWithDefault(Number,Oh.p.editContainerWidth,-1);else if(this.get_shouldGetDragDropConstrainingWidth()){var r=this.getDOMElementFromGraphNodeContext(t.get_currentNode());n=r?r.clientWidth:n}if(this._internalClipboard.pasteFromInternalClipboard(this.parentArgs.interactiveView,t.get_parentNode(),t.get_currentNode(),n,null,e),this.get_isMergeFixEnabled()&&(this.precedingNodeRef.restore(t),Ls.OutlineElementReader.isOutlineElement(t)&&this._internalClipboard.isTableCellPaste(t))){var i=hs.OutlineElementNavigator.moveToContent(t);i&&(this.parentArgs.finalSelection=ss.SelectionFactory.createIpSelection(i,0))}},t.prototype.getDOMElementFromGraphNodeContext=function(e){if(!e)return null;var t=e?e.getHtmlViewElement(this.get__pageView().get_viewId()):null;return t?t.get_htmlElement():null},t.prototype.shouldSkipMergeAfterPaste=function(){var e=new Da.GraphIterator;return this.precedingNodeRef.restore(e),this._internalClipboard.isTableCellPaste(e)},t.prototype.get_shouldMergePastedListIntoList=function(){return mc.ListReader.get_isListMarkerEnabled()},t.prototype.get_shouldMergeAfterContent=function(){return!this._internalClipboard.get_endsWithEop()&&!this._internalClipboard.get_containsOutlineLevelContent()},t}(km);(0,o.l)(hy,"InternalPasteExecutionManager",km,[]);var _y,my=function(){function e(e,t,n){this._internalClipboard=null,this._contentControlCopyPasteHelper=null,this._lazyPageView=null,this._internalClipboard=e,this._contentControlCopyPasteHelper=t,this._lazyPageView=n}return e.prototype.create=function(e,t,n){return new hy(e,t,n,this._internalClipboard,this._contentControlCopyPasteHelper,Br.App.get_activeAppFrame().workspace,this._lazyPageView)},e}();(0,o.l)(my,"Factory$12",null,[nh]),function(e){e[e.unknown=0]="unknown",e[e.differentBox4App=1]="differentBox4App",e[e.sameBox4AppDifferentSession=2]="sameBox4AppDifferentSession",e[e.sameBox4AppSameSession=3]="sameBox4AppSameSession"}(_y||(_y={})),(0,o.h)("CopySource",_y);var fy=function(){function e(e,t,n){this._internalClipboard=null,this._internalPasteExecutionManagerFactory=null,this._externalPasteExecutionManagerFactory=null,this._internalClipboard=e,this._internalPasteExecutionManagerFactory=t,this._externalPasteExecutionManagerFactory=n}return e.prototype.pasteAtIp=function(t,n,r){C.ULS.shipAssertTag(6305620,307,!!t),C.ULS.shipAssertTag(6305621,307,Pa.SelectionEditor.isInsertionPointContext(n)),C.ULS.shipAssertTag(6305622,307,!!r),C.ULS.shipAssertTag(6305623,307,o.r(K_,r.get_operationContext()));var i=r.get_operationContext();i.copySource=this._internalClipboard.getCopySourceFromDOMTree(t),this.logInlineTabUsage(t,i);var a=this.isInternalPaste(t,n,i);if(a||this.shouldContinueProcessContent(t,n,i)){var s,l=new as.GraphTransaction(7);l.setFromNode(n.get_node()),n.get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(8),a?(C.ULS.sendTraceTag(40706500,307,50,"Internal paste operation starts. {0}; {1}",i.actionIdFlags,i.browserName),s=this._internalPasteExecutionManagerFactory.create(n,i,l)):(C.ULS.sendTraceTag(40706501,307,50,"External paste operation starts. {0}; {1}; {2}",i.actionIdFlags,i.copySource,i.browserName),e.logIfPasteTextIsUrl(t),s=this._externalPasteExecutionManagerFactory.create(t,n,i,l));var c=new A_.a(r,o.i(s,s.pasteSetup,"pasteSetup"),null);c.setDebugName("Paste"),c.run()}else i.finalSelection=ss.SelectionFactory.createSelectionFromContext(n)},e.prototype.isInternalPaste=function(e,t,n){return!this.isPasteTextOnly(n)&&3===n.copySource},e.prototype.shouldContinueProcessContent=function(e,t,n){return!0},e.prototype.isPasteTextOnly=function(e){return 1===tf(e.actionIdFlags)},e.prototype.internalPasteAtIp=function(e,t){C.ULS.shipAssertTag(6305624,307,Pa.SelectionEditor.isInsertionPointContext(e)),C.ULS.shipAssertTag(6305625,307,!!t),C.ULS.shipAssertTag(6305626,307,o.r(K_,t.get_operationContext()));var n=new as.GraphTransaction(7);n.setFromNode(e.get_node());var r=t.get_operationContext(),i=this._internalPasteExecutionManagerFactory.create(e,r,n),a=new A_.a(t,o.i(i,i.pasteSetup,"pasteSetup"),null);a.setDebugName("InternalPasteAtIp"),a.run()},e.prototype.logInlineTabUsage=function(e,t){if(e){var n=!1,r=!1;e.innerHTML&&e.innerHTML.indexOf("mso-tab-count")>=0?r=!0:e.innerText&&e.innerText.indexOf("\t")>=0&&(n=!0),(n||r)&&(L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),C.ULS.sendTraceTag(42471960,307,50,"User pasted InlineTabs. Source: {0}, Contains tab character (u0009): {1}, IsFromRichClient: {2}",_y[t.copySource],n,r))}},e.logIfPasteTextIsUrl=function(t){return!!t&&(!!e._webUrlRegEx.test(t.innerText)&&(C.ULS.sendTraceTag(6350173,307,50,"External paste operation starts on WebUrl"),!0))},e._webUrlRegEx=new RegExp("^[\\s]*(((http|https):\\/\\/)|(www\\.))[\\w\\-_]+(\\.[\\w\\-_]+)+[\\w\\-\\.,@?^=%&amp;:/~\\+#]*[\\s]*$"),e}();(0,o.l)(fy,"PasteCoordinator",null,[]);var yy=n(3427),Cy=n(9038),Sy=n(9767),vy=function(){function e(e,t,n,r,i,o,a,s,l,c,u){this._pasteFloatieManager=null,this._pasteFloatieEventSource=null,this._interactiveViewManager=null,this._pressOnlyKeyEvent=null,this._activeFrame=null,this._pasteFloatiePositionProvider=null,this._appSettingsManager=null,this._pasteFloatieFeatureSetBuilder=null,this._paragraphNodeEventHandlers=null,this._graphTransactionManager=null,this._currentInteractiveView=null,this._isLocked=!1,this._pasteCommand=null,this._isHiding=!1,this._pasteFloatieManager=e,this._pasteFloatieEventSource=t,this._interactiveViewManager=n,this._pressOnlyKeyEvent=r,this._activeFrame=i,this._pasteFloatiePositionProvider=o,this._appSettingsManager=a,this._pasteFloatieFeatureSetBuilder=s,this._paragraphNodeEventHandlers=l,this._graphTransactionManager=c,2===u&&this.startEventListening()}return e.prototype.startEventListening=function(){this._pasteFloatieEventSource.add_onShowPasteFloatie(o.i(this,this.showFloatieHandler,"showFloatieHandler")),this._pasteFloatieEventSource.add_onDismissPasteFloatie(o.i(this,this.floatieDismissedHandler,"floatieDismissedHandler"))},e.prototype.createFloatie=function(e,t){this._pasteFloatiePositionProvider.invalidPastedPositionCache(),1!==this._pasteFloatieFeatureSetBuilder.createFromPastedHtmlString(t.pasteHtmlString)&&this.showFloatie(e,t)&&(this._isHiding?this._isHiding=!1:this.registerViewChangeEventHandlers(),this.registerFloatieEventHandler(),C.ULS.sendTraceTag(40379588,307,50,"Box4 Paste floatie created."),this.updateFloatiePosition())},e.prototype.dismissFloatie=function(e){this._isLocked||(this._pasteFloatieManager.isFloatieVisible()||this._isHiding)&&(e&&(this._pasteFloatiePositionProvider.invalidPastedPositionCache(),this.unregisterViewChangedEventHandlers(),C.ULS.sendTraceTag(50685514,307,50,"Last paste command before dimiss or hiding the floatie. Command: {0}",this._pasteCommand)),this._isHiding=!e,this.unregisterFloatieHandler(),this._pasteFloatieManager.dismissFloatie())},e.prototype.registerViewChangeEventHandlers=function(){this._currentInteractiveView=this._interactiveViewManager.get_selectionView(),qo.n.addHandler(this._currentInteractiveView.get_container(),"scroll",o.i(this,this.scrollHandler,"scrollHandler")),this._activeFrame.add_onResize(o.i(this,this.resizeHandler,"resizeHandler"))},e.prototype.unregisterViewChangedEventHandlers=function(){qo.n.removeHandler(this._currentInteractiveView.get_container(),"scroll",o.i(this,this.scrollHandler,"scrollHandler")),this._activeFrame.remove_onResize(o.i(this,this.resizeHandler,"resizeHandler"))},e.prototype.updateFloatiePosition=function(){var e=new Cy.g(0,L.AFrameworkApplication.get_isRtl());e.location=this._pasteFloatiePositionProvider.getFloatiePosition(),this._pasteFloatiePositionProvider.isFloatieInContentView(e.location)?this.showFloatie(null,e):this._pasteFloatieEventSource.raiseDismissPasteFloatieEvent(new yy.g(!1))},e.prototype.resizeHandler=function(){this.updateFloatiePosition()},e.prototype.scrollHandler=function(e){this.updateFloatiePosition()},e.prototype.floatieDismissedHandler=function(e,t){this.dismissFloatie(t.get_finalDismiss())},e.prototype.showFloatieHandler=function(e,t){this.createFloatie(e,t)},e.prototype.registerFloatieEventHandler=function(){this._pressOnlyKeyEvent.add_onKeyCodeWasPressedOnly(o.i(this,this.onOnlyKeyPressed,"onOnlyKeyPressed")),this._pasteFloatieEventSource.add_onExpandPasteFloatieMenu(o.i(this._pasteFloatieManager,this._pasteFloatieManager.expandFloatie,"expandFloatie")),this._pasteFloatieEventSource.add_onPastedFloatieStatusChange(o.i(this,this.pastedFloatieStatusChange,"pastedFloatieStatusChange")),this._paragraphNodeEventHandlers.add_onConnected(o.i(this,this.onParagraphConnect,"onParagraphConnect")),this._paragraphNodeEventHandlers.add_onDisconnected(o.i(this,this.onParagraphDisconnected,"onParagraphDisconnected")),this._paragraphNodeEventHandlers.add_onPropertyChanged(o.i(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"))},e.prototype.unregisterFloatieHandler=function(){this._pressOnlyKeyEvent.remove_onKeyCodeWasPressedOnly(o.i(this,this.onOnlyKeyPressed,"onOnlyKeyPressed")),this._pasteFloatieEventSource.remove_onExpandPasteFloatieMenu(o.i(this._pasteFloatieManager,this._pasteFloatieManager.expandFloatie,"expandFloatie")),this._pasteFloatieEventSource.remove_onPastedFloatieStatusChange(o.i(this,this.pastedFloatieStatusChange,"pastedFloatieStatusChange")),this._paragraphNodeEventHandlers.remove_onConnected(o.i(this,this.onParagraphConnect,"onParagraphConnect")),this._paragraphNodeEventHandlers.remove_onDisconnected(o.i(this,this.onParagraphDisconnected,"onParagraphDisconnected")),this._paragraphNodeEventHandlers.remove_onPropertyChanged(o.i(this,this.onParagraphPropertyChanged,"onParagraphPropertyChanged"))},e.prototype.pastedFloatieStatusChange=function(e,t){this._isLocked=t.isFloatieLocked,t.pasteCommand&&(this._pasteCommand=t.pasteCommand),t.shouldUpdatePosition&&this._pasteFloatieManager.isFloatieVisible()&&this.updateFloatiePosition()},e.prototype.onParagraphPropertyChanged=function(e,t){t.get_property()===Kc.b.lastModifiedTime&&(this._graphTransactionManager.get_currentModificationOperations().contains(ii.yZ)||this.raiseDismissEventIfNotLoading(t))},e.prototype.onParagraphDisconnected=function(e,t){this.raiseDismissEventIfNotLoading(t)},e.prototype.onParagraphConnect=function(e,t){t.get_isDelayLoad()||this.raiseDismissEventIfNotLoading(t)},e.prototype.raiseDismissEventIfNotLoading=function(e){e.get_node().get_loading()||this._pasteFloatieEventSource.raiseDismissPasteFloatieEvent(new yy.g(!0))},e.prototype.showFloatie=function(e,t){return t||(t=new Cy.g(0,L.AFrameworkApplication.get_isRtl())),t.location||(t.location=this._pasteFloatiePositionProvider.getFloatiePosition()),!!t.location&&(this._isHiding&&(this._isHiding=!1,this.registerFloatieEventHandler()),this._pasteFloatieManager.showFloatie(e,t),!0)},e.prototype.onOnlyKeyPressed=function(e,t){Sy.i.get_instance().keyCode===Je.v.vK_Ctrl&&this._pasteFloatieEventSource.raiseExpandPasteFloatieMenuEvent()},e}();(0,o.l)(vy,"PasteFloatieEventManager",null,[]);var by=function(){function e(e,t){this._clipboardDataHelper=null,this._commandUiBridge=null,this._clipboardDataHelper=e,this._commandUiBridge=t}return e.prototype.createFromPastedHtmlString=function(t){var n=this;if(!vg.any(String,vg.where(String,vg.asEnumerable(String,e.supportedCommands),(function(e){return n._commandUiBridge.isRibbonCommandEnabled(e)}))))return 1;var r=this._clipboardDataHelper.parseHtmlUsingDomParser(t);if(r){var i=r.innerText;if(!!i&&i.trim().length>0)return 0}return 1},e.supportedCommands=["1604545586","2385042182"],e}();(0,o.l)(by,"PasteFloatieFeatureSetBuilder",null,[]);var Ty=n(4805),Ay=n(1537),Iy=n(5266),wy=n(4443),xy=function(){return function(){this.pastedNode=null,this.pastedCp=0}}();(0,o.l)(xy,"PasteFloatieAnchorData",null,[]);var Fy=function(){function e(e,t,n,r,i){this._selectionManager=null,this._textMetricsAdapter=null,this._interactiveViewManager=null,this._getElementBoundFunc=null,this._pasteFloatieManager=null,this._pasteFloatieAnchorData=null,this._selectionManager=e,this._textMetricsAdapter=t,this._interactiveViewManager=n,this._getElementBoundFunc=r,this._pasteFloatieManager=i}return e.prototype.invalidPastedPositionCache=function(){this._pasteFloatieAnchorData=null},e.prototype.getFloatiePosition=function(){var e=this.getFloatiePositionFromNode(this._pasteFloatieAnchorData)||this.calculateFloatiePosition();if(!e){var t="null",n="null";if(this._pasteFloatieAnchorData.pastedNode){if(!this._interactiveViewManager.get_selectionView())return C.ULS.sendTraceTag(51143187,307,15,"SelectoinView is null when we try to get floatie position"),null;t=Object.getType(this._pasteFloatieAnchorData.pastedNode).getName();var r=this._pasteFloatieAnchorData.pastedNode.getViewElement(this._interactiveViewManager.get_selectionView().get_viewId());r&&(n=Object.getType(r).getName())}C.ULS.shipAssertTag(40641054,307,!1,"Failed to calculate position for pasted node type {0}, view element type {1}",t,n)}return e},e.prototype.isFloatieInContentView=function(e){if(!e)return!1;var t=this._pasteFloatieManager.getFloatieBounds(),n=this._getElementBoundFunc(this._interactiveViewManager.get_selectionView().get_container()),r=new Sys.UI.Bounds(e.x,e.y,t.width,t.height);return r.y>=n.y&&r.y+r.height<=n.y+n.height},e.prototype.calculateFloatiePosition=function(){if(!this._selectionManager||!this._selectionManager.get_selectionCollection()||!this._selectionManager.get_selectionCollection().get_currentSelection())return C.ULS.sendTraceTag(51431265,307,15,"Selection is null when we try to calculate floatie position"),null;var e=this._selectionManager.get_selectionCollection().get_currentSelection().get_firstContext(),t=!e.get_cpBegin()&&!e.get_cpEnd(),n=e.get_node();if(n&&t)do{n=this.getPreviousContentNode(n)}while(n&&o.r(hc.AParagraphNode,n)&&!n.get_characterData().trim().length);var r="",i=(0,f.e)(hc.AParagraphNode,n);i&&(r=i.get_characterData().length===e.get_cpBegin()||t?i.get_characterData().trimEnd():i.get_characterData().substring(0,e.get_cpBegin()).trimEnd());var a=i?r.length:e.get_cpBegin(),s=(0,O.m)(new xy,{pastedNode:(0,f.e)(Ty.k,(i?(0,f.e)(Ty.k,i):(0,f.e)(Ty.k,n))||e.get_node()),pastedCp:a});return this.getFloatiePositionFromNode(s)},e.prototype.getPreviousContentNode=function(e){var t=new Da.GraphIterator;return e.get_anchor()?(t.set(e),t.tryToRootAtOutlineAncestor()?(t.returnToAncestorOfType(11),t.goToPreviousSibling()?t.goToFirstChildByRole(2):null):null):null},e.prototype.getFloatiePositionFromNode=function(e){if(!e||!e.pastedNode)return null;this._pasteFloatieAnchorData=e;var t=this._interactiveViewManager.get_selectionView();if(!t)return C.ULS.sendTraceTag(51143188,307,15,"SelectoinView is null when we try to get floatie position"),null;var n=(0,f.e)(Ay.e,e.pastedNode.getViewElement(t.get_viewId()));if(!n)return null;var r=null;if(o.r(hc.AParagraphNode,e.pastedNode)){var i=(0,f.e)(Iy.e,n);if(!i)return null;try{(r=this._textMetricsAdapter.boundsFromIp(e.pastedCp,i,e.pastedCp>0,!1,!1,!1)).height+=2}catch(e){C.ULS.sendTraceTag(40953486,307,15,"Failed to get ip bound due to exception {0}, will use fallback value.",e),r=null}}else if(o.r(Ac.f,e.pastedNode)){r=(0,f.e)(wy.v,n).getTableContentBounds()}return r||(r=n.getBounds()),L.AFrameworkApplication.get_isRtl()&&this._pasteFloatieManager.isFloatieVisible()&&(r.x-=this._pasteFloatieManager.getFloatieBounds().width),new Sys.UI.Point(r.x+r.width,r.y+r.height)},e}();(0,o.l)(Fy,"PasteFloatiePositionProvider",null,[]);var Ey=(0,o.y)("ICopyPasteShortcutDialogFactory"),Py=function(){function e(e,t){this._dialogHandler=null,this.clipboardAccessExtensionLink=null,this._dialogHandler=e,this.clipboardAccessExtensionLink=t}return e.prototype.get_titleText=function(){return CommonUIStrings.l_ClipboardUseShortcutTitle},e.prototype.get_forwardElementText=function(){return CommonUIStrings.l_ClipboardUseShortcutMessage},e.prototype.get_cutText=function(){return CommonUIStrings.l_ClipboardCut},e.prototype.get_macCutText=function(){return CommonUIStrings.l_ClipboardCut_Mac},e.prototype.get_copyText=function(){return CommonUIStrings.l_ClipboardCopy},e.prototype.get_macCopyText=function(){return CommonUIStrings.l_ClipboardCopy_Mac},e.prototype.get_pasteText=function(){return CommonUIStrings.l_ClipboardPaste},e.prototype.get_macPasteText=function(){return CommonUIStrings.l_ClipboardPaste_Mac},e.prototype.get_pasteTextOnly=function(){return CommonUIStrings.l_ClipboardPasteText},e.prototype.get_macPasteTextOnly=function(){return CommonUIStrings.l_ClipboardPasteText_Mac},e.prototype.get_clipboardAccessExtensionLink=function(){return this.clipboardAccessExtensionLink},e.prototype.get_clipboardExtensionLinkText=function(){return CommonUIStrings.l_ClipboardExtensionLink},e.prototype.get_clipboardExtensionSuggestionText=function(){return CommonUIStrings.l_ClipboardExtensionSuggestion},e.prototype.extensionLinkHandler=function(e){C.ULS.sendTraceTag(8716421,307,50,null),window.open(this.get_clipboardAccessExtensionLink(),"_blank")},e.prototype.resolveCopyPasteShortcut=function(e,t){var n=G.y.get_isMac();return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CcpFixIPadShortcutStringsIsEnabled")&&(n=G.y.get_isIPad()||n),n?String.format(t,"\u2318"):e},e.prototype.dispose=function(){this._dialogHandler=null},e.prototype.reactCopyPasteShortcutDialogHandler=function(e,t){this.copyPasteShortcutDialogHandler(e)},e.prototype.legacyCopyPasteShortcutDialogHandler=function(e,t){this.copyPasteShortcutDialogHandler(e)},e.prototype.copyPasteShortcutDialogHandler=function(e){this._dialogHandler&&this._dialogHandler(e)},e.id="CopyPasteShortcutDialog",e.textElementId="CopyPasteText",e}();(0,o.l)(Py,"ACopyPasteShortcutDialog",null,[Sys.IDisposable]);var ky="WACCopyPasteShortcutDialogTextPanel",Dy="span",My="UIFontBold",Ry=function(e){function t(t,n,r){var i=e.call(this,t,n)||this,a=document.createElement(Dy);a.className=ky;var s=document.createElement(Dy);s.id=Py.textElementId;var l=document.createElement(Dy);l.innerText=i.get_forwardElementText();var c=document.createElement(Dy);c.className=My,c.innerText=i.resolveCopyPasteShortcut(i.get_cutText(),i.get_macCutText());var u=document.createElement(Dy);u.className=My,u.innerText=i.resolveCopyPasteShortcut(i.get_copyText(),i.get_macCopyText());var g=document.createElement(Dy);if(g.className=My,g.innerText=i.resolveCopyPasteShortcut(i.get_pasteText(),i.get_macPasteText()),s.appendChild(l),s.appendChild(document.createElement("br")),s.appendChild(c),s.appendChild(u),s.appendChild(g),r.getBooleanAppSetting("PasteTextOnlyShortcutDialogIsEnabled")&&(G.y.get_isChrome()||G.y.get_isFirefox())){var p=document.createElement(Dy);p.className=My,p.innerText=i.resolveCopyPasteShortcut(i.get_pasteTextOnly(),i.get_macPasteTextOnly()),s.appendChild(p)}if(a.appendChild(s),i.get_clipboardAccessExtensionLink()){C.ULS.sendTraceTag(8716420,307,50,null);var d=document.createElement(Dy),h=document.createElement("a");h.href="#",h.innerText=i.get_clipboardExtensionLinkText(),qo.n.addHandler(h,"click",o.i(i,i.extensionLinkHandler,"extensionLinkHandler")),d.appendChild(h);var _=i.get_clipboardExtensionSuggestionText().indexOf("{0}");if(-1!==_){var m=i.get_clipboardExtensionSuggestionText().substring(0,_),f=i.get_clipboardExtensionSuggestionText().substring(_+3,i.get_clipboardExtensionSuggestionText().length),y=document.createTextNode(m),S=document.createTextNode(f);d.insertBefore(y,h),d.appendChild(S)}a.appendChild(document.createElement("br")),a.appendChild(d)}else C.ULS.sendTraceTag(8716422,307,50,null);var v=new ar.StandardDialog;return v.set_buttonsOption(0),v.set_dialogId(Py.id),v.messageBox(i.get_titleText(),null,0,o.i(i,i.legacyCopyPasteShortcutDialogHandler,"legacyCopyPasteShortcutDialogHandler"),a),v.setDescribedByForDialog(Py.textElementId),i}return(0,S.t)(t,e),t}(Py);(0,o.l)(Ry,"CopyPasteShortcutDialog",Py,[]);var Ly="CopyPasteInstallDialog",Ny="{0}",By=function(e){function t(t,n,r){var i,a=e.call(this,t,n)||this,s={};if(1===r){i=a.get_installTitleTextUX1();var l=a.get_extensionTextUX1().indexOf(Ny);if(-1===l)return C.ULS.sendTraceTag(594882644,307,10,"Placeholder should be present"),a;s.extensionStartText=a.get_extensionTextUX1().substring(0,l);s.extensionLink={type:"AppLinkProps",id:"extensionLink",text:a.get_extensionLinkTextUX1(),handler:function(e){a.extensionLinkHandler(e)}},s.extensionEndText=a.get_extensionTextUX1().substring(l+Ny.length,a.get_extensionTextUX1().length)}else{if(2!==r)return C.ULS.sendTraceTag(594882643,307,10,"Invalid UX version"),a;i=a.get_installTitleTextUX2(),s.extensionStartText=a.get_extensionStartTextUX2(),s.extensionLink=null,s.extensionEndText=null}s.shortcutsMessageText=a.get_shortcutsMessageText(),s.cutText=a.resolveCopyPasteShortcut(a.get_cutText(),a.get_macCutText()),s.copyText=a.resolveCopyPasteShortcut(a.get_copyText(),a.get_macCopyText()),s.pasteText=a.resolveCopyPasteShortcut(a.get_pasteText(),a.get_macPasteText()),s.pasteTextOnly=a.resolveCopyPasteShortcut(a.get_pasteTextOnly(),a.get_macPasteTextOnly());var c={id:Ly,bodyControls:s},u=new ri.o(!1,!1,!0);return u.set_dialogId(Ly),u.set_buttonsOption(0),u.setButtonText(1,a.get_installText()),u.setDefaultButton(1),u.initializeAndShow(i,o.i(a,a.reactCopyPasteShortcutDialogHandler,"reactCopyPasteShortcutDialogHandler"),c),a}return(0,S.t)(t,e),t.prototype.get_shortcutsMessageText=function(){return CommonUIStrings.l_ClipboardInstallDialogShortcutsMessage},t.prototype.get_installText=function(){return CommonUIStrings.l_ClipboardInstallDialogInstallButton},t.prototype.get_installTitleTextUX1=function(){return CommonUIStrings.l_ClipboardInstallDialogTitleUX1},t.prototype.get_extensionTextUX1=function(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessageUX1},t.prototype.get_extensionLinkTextUX1=function(){return CommonUIStrings.l_ClipboardInstallDialogExtensionNameUX1},t.prototype.get_installTitleTextUX2=function(){return CommonUIStrings.l_ClipboardInstallDialogTitleUX2},t.prototype.get_extensionStartTextUX2=function(){return CommonUIStrings.l_ClipboardInstallDialogExtensionMessageUX2},t.getInstallVersion=function(e){switch(e){case t.installUX1:return 1;case t.installUX2:return 2;case t.noInstallUX:default:return 0}},t.noInstallUX="none",t.installUX1="ux1",t.installUX2="ux2",t}(Py);(0,o.l)(By,"ReactCopyPasteInstallDialog",Py,[]);var Oy=function(e){function t(t,n,r){var i=e.call(this,t,n)||this,a={};if(a.forwardElementText=i.get_forwardElementText(),a.cutText=i.resolveCopyPasteShortcut(i.get_cutText(),i.get_macCutText()),a.copyText=i.resolveCopyPasteShortcut(i.get_copyText(),i.get_macCopyText()),a.pasteText=i.resolveCopyPasteShortcut(i.get_pasteText(),i.get_macPasteText()),r.getBooleanAppSetting("PasteTextOnlyShortcutDialogIsEnabled")&&(G.y.get_isChrome()||G.y.get_isFirefox())&&(a.pasteTextOnly=i.resolveCopyPasteShortcut(i.get_pasteTextOnly(),i.get_macPasteTextOnly())),i.get_clipboardAccessExtensionLink()){C.ULS.sendTraceTag(40726914,307,50,null);a.extensionLink={type:"AppLinkProps",id:"extensionLink",text:i.get_clipboardExtensionLinkText(),handler:function(e){i.extensionLinkHandler(e)}};var s=i.get_clipboardExtensionSuggestionText().indexOf("{0}");-1!==s&&(a.suggestionPrefixElement=i.get_clipboardExtensionSuggestionText().substring(0,s),a.suggestionSuffixElement=i.get_clipboardExtensionSuggestionText().substring(s+3,i.get_clipboardExtensionSuggestionText().length))}else C.ULS.sendTraceTag(40726915,307,50,null);var l={id:Py.id,bodyControls:a},c=new ri.o(!1,!1,!0);return c.set_buttonsOption(0),c.set_dialogId(Py.id),c.initializeAndShow(i.get_titleText(),o.i(i,i.reactCopyPasteShortcutDialogHandler,"reactCopyPasteShortcutDialogHandler"),l),i}return(0,S.t)(t,e),t}(Py);(0,o.l)(Oy,"ReactCopyPasteShortcutDialog",Py,[]);var Uy=function(){function e(){this._isReactDialogEnabled=!1,this._isReactDialogEnabled=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactDialogEnabled()}return e.prototype.createCopyPasteShortcutDialog=function(e,t,n){return void 0===n&&(n=0),C.ULS.sendTraceTag(594882645,307,50,String.format("_isReactDialogEnabled={0}, installUXVersion={1}",this._isReactDialogEnabled,n)),this._isReactDialogEnabled?(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordCcpInstallDialogSettings"),n?new By(e,t,n):new Oy(e,t,L.AFrameworkApplication.appSettingsManager)):new Ry(e,t,L.AFrameworkApplication.appSettingsManager)},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,o.l)(Uy,"CopyPasteShortcutDialogFactory",null,[Ey]);var Hy=n(2698),Gy=function(){function e(e,t,n,r,i,o,a){this._stopTesting=!1,this._isInUse=!1,this._systemClipboardAccessManager=null,this._interactiveViewManager=null,this._workspace=null,this._focusManager=null,this._editingDomManager=null,this._editViewStateManager=null,this._browserUtils=null,this._systemClipboardAccessManager=e,this._interactiveViewManager=t,this._workspace=n,this._focusManager=r,this._editingDomManager=i,this._editViewStateManager=o,this._browserUtils=a}return e.prototype.get_systemClipboardAccessManager=function(){return this._systemClipboardAccessManager},e.prototype.get_isInUse=function(){return this._isInUse},e.prototype.set_isInUse=function(e){return this._isInUse=e,this._editViewStateManager.set_ignoreClipboardEvents(e),e},e.prototype.ensureSystemClipboardAccess=function(e){this.get_systemClipboardAccessManager().ensureSystemClipboardAccess(e),e||this.testClipboardAccess(!0)},e.prototype.get_ensureOperationResult=function(){return this.get_systemClipboardAccessManager().get_resultForEnsureAccessOperation()},e.prototype.prepareForPaste=function(e){this.set_isInUse(!0),this.get_systemClipboardAccessManager().prepareForPaste(e,this.get_targetDocument())},e.prototype.reset=function(){this.set_isInUse(!1)},e.prototype.paste=function(){var e=this._interactiveViewManager.get_selectionView();e&&this._focusManager.setScope(e.get_focusScopeId());var t=this._workspace.get_activeView();if(!t.get_isInteractiveView())return null;var n=t;if(!n.get_editingView().get_isContentEditableView())return null;var r=n.get_editingView(),i=this._editingDomManager.getEditingElement();this.set_isInUse(!0),t.validateSynchronous();var o=null;try{r.prepareForPasteAction(),this.get_systemClipboardAccessManager().executePasteCommand(this.get_targetDocument(),(0,p.m)((function(){return i}),(function(e){return i=e}))),o=i}catch(e){C.ULS.shipAssertTag(6305672,307,!1),this.handleBlockedAccessAttempt(!0)}return this.set_isInUse(!1),o},e.prototype.copy=function(){var e=this._interactiveViewManager.get_selectionView();e&&this._focusManager.setScope(e.get_focusScopeId());var t,n=this._workspace.get_activeView();if(!n.get_isInteractiveView())return!1;if(1!==n.get_editingView().get_mode())return!1;this.set_isInUse(!0);try{this.get_systemClipboardAccessManager().executeCopyCommand(this.get_targetDocument()),t=!0}catch(e){C.ULS.shipAssertTag(6305673,307,G.y.get_isFirefox()),C.ULS.sendTraceTag(17148117,307,50,"Known blocked access attempt handle in SystemClipboard: copy, {0}",G.y.get_browserNameForlogging()),t=!1}return this.set_isInUse(!1),!!t},e.prototype.testClipboardAccess=function(e){if(this._stopTesting)return!0;var t=this._workspace.get_activeView();if(!t.get_isInteractiveView())return!1;var n=t;if(!n.get_editingView().get_isContentEditableView())return!1;var r=n.get_editingView(),i=this._editingDomManager.getEditingElement();this.set_isInUse(!0);var o=new Hy.w(i),a=!1;try{a=this.get_systemClipboardAccessManager().testClipboardAccess(i,(function(){r.clearSurface()}),(function(){r.selectAllContent()}))}catch(e){C.ULS.shipAssertTag(6305674,307,!G.y.get_isInternetExplorerNonEdge())}return o.restore(),this.set_isInUse(!1),a?this._stopTesting=!0:(C.ULS.sendTraceTag(42517522,307,50,"Known blocked access attempt handle in SystemClipboard: paste, {0}",G.y.get_browserNameForlogging()),G.y.get_isInternetExplorerNonEdge()||this.handleBlockedAccessAttempt(e)),a},e.prototype.handleBlockedAccessAttempt=function(e){if(this._stopTesting=!1,L.AFrameworkApplication.get_wacCopyPasteShortcutDialogIsEnabled())Uy.get_instance().createCopyPasteShortcutDialog(null,null);else{var t=new ar.StandardDialog;t.set_buttonsOption(0),t.showWarning(CommonUIStrings.l_ClipboardAccessDeniedTitle,CommonUIStrings.l_ClipboardAccessDenied,null)}},e.prototype.get_targetDocument=function(){var e=this._editingDomManager.getEditingDomOwnerDocument();return e?e.get_domDocument():null},e}();(0,o.l)(Gy,"SystemClipboard",null,[md]);var Vy=n(484),Wy=(0,o.y)("IEdgeSystemClipboardSelectionEnsureStrategy"),zy="a",Ky=function(){function e(e,t,n){this._chromeClipboardAccessExtensionSuggestionIsEnabled=!1,this._chromeClipboardAccessRichFormatContentIsEnabled=!1,this._chromeSingleTextRunCopyImprovementIsEnabled=!1,this._googleWebstoreLink=null,this._extensionHelper=null,this._clipboardDataHelper=null,this._oldCopyPasteExtensionId=null,this._installUXVersion=0,this._clipboardContentFromExtension=null,this._lastPasteUid=null,this._extensionId=null,this._isAnchorElement=null,this.resultForEnsureAccessOperation=null,this._chromeClipboardAccessExtensionSuggestionIsEnabled=e.getBooleanAppSetting("ChromeClipboardAccessExtensionSuggestionIsEnabled"),this._chromeClipboardAccessRichFormatContentIsEnabled=e.getBooleanAppSetting("ChromeClipboardAccessRichFormatContentIsEnabled"),this._chromeSingleTextRunCopyImprovementIsEnabled=e.getBooleanAppSetting("ChromeSingleTextRunCopyImprovementIsEnabled"),this._googleWebstoreLink=e.getStringAppSetting("ChromeClipboardAccessExtensionLink"),this._extensionHelper=t,this._clipboardDataHelper=n,this._oldCopyPasteExtensionId=e.getStringAppSetting("ChromeClipboardAccessExtensionId"),this._installUXVersion=L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactDialogEnabled()?By.getInstallVersion(e.getStringAppSetting("CcpInstallDialogIsEnabled")):0,this._extensionId=null,this._isAnchorElement=function(e){return!!e.tagName&&e.tagName.toLowerCase()===zy}}return e.prototype.ensureSystemClipboardAccess=function(e){e?this.resultForEnsureAccessOperation=!0:(this.resultForEnsureAccessOperation=null,chrome.runtime&&chrome.runtime.sendMessage?(this._extensionId=this._extensionHelper.getExtensionId(),this._extensionHelper.get_shouldCheckExtensionBySendingMessage()?this.checkExtensionExistenceAsync():(this.resultForEnsureAccessOperation=!0,C.ULS.sendTraceTag(19256732,307,50,Dt.h.create().toString()))):(this.popupInstallDialog(),this.resultForEnsureAccessOperation=!1))},e.prototype.get_resultForEnsureAccessOperation=function(){return this.resultForEnsureAccessOperation},e.prototype.testClipboardAccess=function(e,t,n){return!0},e.prototype.executeCopyCommand=function(e){C.ULS.sendTraceTag(24402115,307,50,"Execute chrome copy"),Bt.g.executeDocumentCommand(e,"copy")||C.ULS.sendTraceTag(24402116,307,10,String.format("In Chrome {0} execute copy failed",window.navigator.userAgent.split("/")[3].substring(0,2)))},e.prototype.executePasteCommand=function(e,t){if(this._clipboardContentFromExtension){var n=document.implementation.createHTMLDocument("doc");n.body.innerHTML=this._clipboardContentFromExtension,t.val=n.body,this._clipboardContentFromExtension=null}},e.prototype.prepareForPaste=function(e,t){var n=this,r=Dt.h.create();this._lastPasteUid=r,this._extensionHelper.get_shouldCheckExtensionBySendingMessage()?C.ULS.sendTraceTag(7377737,307,50,r.toString()):C.ULS.sendTraceTag(19256735,307,50,r.toString());var i={command:"paste"};chrome.runtime.sendMessage(this._extensionId,i,(function(t){r.equals(n._lastPasteUid)?n._clipboardContentFromExtension=t:C.ULS.sendTraceTag(7385868,307,50,null),C.ULS.sendTraceTag(7377738,307,50,r.toString()),chrome.runtime.lastError&&(n.dropExtensionAndPopDialog(),n._extensionHelper.get_shouldCheckExtensionBySendingMessage()?C.ULS.sendTraceTag(7377739,307,10,chrome.runtime.lastError.message):C.ULS.sendTraceTag(19256737,307,10,chrome.runtime.lastError.message)),e()}))},e.prototype.popupInstallDialog=function(){C.ULS.sendTraceTag(8716423,307,50,null);var e=null;this._installUXVersion?e=this._googleWebstoreLink+this._oldCopyPasteExtensionId:this._chromeClipboardAccessExtensionSuggestionIsEnabled&&(e=this._googleWebstoreLink+this._extensionId),Uy.get_instance().createCopyPasteShortcutDialog(o.i(this,this.popupInstallDialogHandler,"popupInstallDialogHandler"),e,this._installUXVersion)},e.prototype.popupInstallDialogHandler=function(e){1===e?(C.ULS.sendTraceTag(9013382,307,50,String.format("SuggestionEnabled={0}",this._chromeClipboardAccessExtensionSuggestionIsEnabled)),this._installUXVersion&&(C.ULS.sendTraceTag(594882642,307,50,String.format("UXVersion={0}",this._installUXVersion)),window.open(this._googleWebstoreLink+this._oldCopyPasteExtensionId,"_blank"))):e||C.ULS.sendTraceTag(9013383,307,50,String.format("SuggestionEnabled={0}",this._chromeClipboardAccessExtensionSuggestionIsEnabled))},e.prototype.dropExtensionAndPopDialog=function(){this._extensionHelper.resetExtensionId(),this.popupInstallDialog()},e.prototype.sendTestCommandMessage=function(e,t){var n={command:"test",object:"ping"};chrome.runtime.sendMessage(e,n,t)},e.prototype.checkExtensionExistenceAsync=function(){var e=this,t=Dt.h.create();C.ULS.sendTraceTag(7726105,307,50,t.toString()),this.sendTestCommandMessage(this._extensionId,(function(n){if(C.ULS.sendTraceTag(7726106,307,50,t.toString()),n&&"ping"===n)e.resultForEnsureAccessOperation=!0;else{if(n){var r=n;"ping"!==r&&C.ULS.sendTraceTag(7726107,307,10,"ChromeApi has unexpected response: {0}. ErrorMsg: {1}",r,chrome.runtime.lastError?chrome.runtime.lastError.message:null)}else C.ULS.sendTraceTag(39190680,307,50,"ChromeApi has null response. ErrorMsg: {0}",chrome.runtime.lastError?chrome.runtime.lastError.message:null);e.popupInstallDialog(),e.resultForEnsureAccessOperation=!1}}))},e.prototype.logInstallationStatusDictionary=function(e,t){var n={};n.OfficeOnlineExtensionInstallationStatus=e,n.OfficeClipboardExtensionInstallationStatus=t,C.ULS.sendTraceTag(51144839,307,50,JSON.stringify(n))},e.prototype.logExtensionInstallationStatus=function(){var e=this;if(chrome.runtime&&chrome.runtime.sendMessage){var t=!this._extensionHelper.get_shouldCheckExtensionBySendingMessage();this.sendTestCommandMessage(this._oldCopyPasteExtensionId,(function(n){var r=!!n;e.logInstallationStatusDictionary(t,r)}))}else this.logInstallationStatusDictionary(!1,!1)},e}();(0,o.l)(Ky,"ChromeSystemClipboardAccessManager",null,[Sd]);var qy=function(){function e(e,t){this._browserUtils=null,this._appSettingsManager=null,this._blockFirefoxCopyCutThroughSystemClipboard=!1,this.resultForEnsureAccessOperation=null,this._browserUtils=e,this._appSettingsManager=t,this._blockFirefoxCopyCutThroughSystemClipboard=!this._appSettingsManager.getBooleanAppSetting("UseSyncCopyCutCommandOnFirefoxIsEnabled")&&this._appSettingsManager.getBooleanAppSetting("BlockCopyCutOnFirefoxIsEnabled")}return e.prototype.ensureSystemClipboardAccess=function(e){if(this._blockFirefoxCopyCutThroughSystemClipboard&&e&&this._browserUtils.get_isFirefox())return Uy.get_instance().createCopyPasteShortcutDialog(null,null),void(this.resultForEnsureAccessOperation=!1);this.resultForEnsureAccessOperation=!0},e.prototype.get_resultForEnsureAccessOperation=function(){return this.resultForEnsureAccessOperation},e.prototype.executeCopyCommand=function(e){Bt.g.executeDocumentCommand(e,"copy")},e.prototype.executePasteCommand=function(e,t){Bt.g.executeDocumentCommand(e,"paste")},e.prototype.prepareForPaste=function(e,t){void 0===t&&(t=null),e()},e.prototype.testClipboardAccess=function(e,t,n){if(this._browserUtils.get_isElectron())return!1;t(),n(),this.executePasteCommand(e.ownerDocument,(0,p.m)((function(){return e}),(function(t){return e=t})));var r=e.innerHTML;e.innerHTML=ae.l.create().toString(),n(),this.executePasteCommand(e.ownerDocument,(0,p.m)((function(){return e}),(function(t){return e=t})));var i=r===e.innerHTML;return this.resultForEnsureAccessOperation=i,i},e}();(0,o.l)(qy,"DefaultSystemClipboardAccessManager",null,[Sd]);var jy=function(){function e(e,t,n,r){this._clipboardDataHelper=null,this._processImageStrategy=null,this._maxImageNumber=0,this._clientCallback=null,this._pastedContentDom=null,this._pastedTargetElement=null,this._pasteTargetDocument=null,this._imageBlobs=null,this._edgeSystemClipboardSelectionEnsureStrategy=null,this._isEdgeSystemClipboardSelectionEnsureStrategyIsEnabled=!1,this._shouldGrantEdgeSystemClipboardAccessForCopyCut=!1,this.resultForEnsureAccessOperation=null,this._clipboardDataHelper=t,this._processImageStrategy=n,this._maxImageNumber=e.getIntAppSetting("ClipboardDataImageBlobLimitaton",10),this._isEdgeSystemClipboardSelectionEnsureStrategyIsEnabled=e.getBooleanAppSetting("EdgeSystemClipboardSelectionEnsureStrategyIsEnabled"),this._edgeSystemClipboardSelectionEnsureStrategy=r,this._shouldGrantEdgeSystemClipboardAccessForCopyCut=e.getBooleanAppSetting("ShouldGrantEdgeSystemClipboardAccessForCopyCut")}return e.prototype.ensureSystemClipboardAccess=function(e){this._shouldGrantEdgeSystemClipboardAccessForCopyCut&&e&&(this.resultForEnsureAccessOperation=!0)},e.prototype.get_resultForEnsureAccessOperation=function(){return this.resultForEnsureAccessOperation},e.prototype.executeCopyCommand=function(e){e&&Bt.g.executeDocumentCommand(e,Le.d.copy)},e.prototype.executePasteCommand=function(e,t){this._pastedContentDom&&(t.val=this._pastedContentDom,this._pastedContentDom=null)},e.prototype.prepareForPaste=function(e,t){if(void 0===t&&(t=null),e&&t){if(this._clientCallback=e,this._pasteTargetDocument=t,$addHandler(this._pasteTargetDocument,Le.d.paste,o.i(this,this.onPasteEvent,"onPasteEvent")),this._pastedTargetElement=null,this._imageBlobs=null,this._isEdgeSystemClipboardSelectionEnsureStrategyIsEnabled&&this._edgeSystemClipboardSelectionEnsureStrategy.ensureSelection(),this.tryPaste(this._pasteTargetDocument)){if(this._imageBlobs&&this._imageBlobs.length>0&&(!this._pastedTargetElement||this._clipboardDataHelper.useImageDataFromPasteEvent(this._pastedTargetElement)))return this._processImageStrategy.convertImageBlobToBase64(this._imageBlobs,o.i(this,this.onImageConverted,"onImageConverted")),void(this._pastedContentDom&&!this._pastedContentDom.hasChildNodes()&&C.ULS.sendTraceTag(42592151,307,50,"pastedContentDom has no child nodes."));this._pastedTargetElement&&this._pastedTargetElement.innerHTML&&(this._pastedContentDom=this.htmlStringToDom(this._pastedTargetElement.innerHTML),this._pastedContentDom&&!this._pastedContentDom.hasChildNodes()&&C.ULS.sendTraceTag(42592152,307,50,"pastedContentDom has no child nodes."),_i.s.clearElement(this._pastedTargetElement))}this.finishPrepareForPaste()}else e&&e()},e.prototype.testClipboardAccess=function(e,t,n){var r=this.tryPaste(e.ownerDocument);return this.resultForEnsureAccessOperation=r,r},e.prototype.onPasteEvent=function(e){try{if(e&&e.rawEvent){if(this._pastedTargetElement=e.rawEvent.target,this._pastedTargetElement&&this._pastedTargetElement.id&&this._pastedTargetElement.id.indexOf("Paste")>-1)return C.ULS.sendTraceTag(40690080,307,15,"The pasted target element of paste event: "+this._pastedTargetElement.id),void(this._pastedTargetElement=null);this._imageBlobs=this.getImageBlobs(e.rawEvent)}}catch(e){C.ULS.sendTraceTag(22073952,307,15,"Exception while processing context menu paste event: "+e.toString())}},e.prototype.onImageConverted=function(e){e&&(this._processImageStrategy.get_shouldPassImageDataUriAsPasteContent()&&(e=String.format('<img src="{0}">',e)),this._pastedContentDom=this.htmlStringToDom(e)),this.finishPrepareForPaste()},e.prototype.finishPrepareForPaste=function(){this._pasteTargetDocument&&($removeHandler(this._pasteTargetDocument,Le.d.paste,o.i(this,this.onPasteEvent,"onPasteEvent")),this._pasteTargetDocument=null),this._clientCallback&&(this._clientCallback(),this._clientCallback=null)},e.prototype.getImageBlobs=function(e){var t,n=null,r=this._clipboardDataHelper.getClipboardDataTransferIfOnlyContainsImage(e);r&&this._clipboardDataHelper.tryGetPastedImageBlob(r,this._maxImageNumber,this._processImageStrategy.get_maxImageBlobSizeInBytes(),(0,p.m)((function(){return n}),(function(e){return n=e})),(0,p.m)((function(){return t}),(function(e){return t=e})));return n},e.prototype.tryPaste=function(e){return Bt.g.executeDocumentCommand(e,Le.d.paste)},e.prototype.htmlStringToDom=function(e){var t=document.implementation.createHTMLDocument("doc");return t.body.innerHTML=e,t.body},e}();(0,o.l)(jy,"EdgeSystemClipboardAccessManager",null,[Sd]);var $y=function(){function e(e,t,n,r){this._appSettingsManager=null,this._chromeExtensionHelper=null,this._clipboardDataHelper=null,this._browserUtils=null,this._appSettingsManager=e,this._chromeExtensionHelper=t,this._clipboardDataHelper=n,this._browserUtils=r}return e.prototype.create=function(){var e=null;return e||(L.AFrameworkApplication.shouldUseChromeExtension()&&this._browserUtils.get_isChrome()&&window.chrome?(C.ULS.sendTraceTag(7377743,307,50,"ChromeSystemClipboardAccessManager"),e=new Ky(this._appSettingsManager,this._chromeExtensionHelper,this._clipboardDataHelper),this._appSettingsManager.getBooleanAppSetting("LogChromeExtensionInstallationStatusIsEnabled")&&e.logExtensionInstallationStatus()):this._appSettingsManager.getBooleanAppSetting("EdgeContextMenuPasteFixIsEnabled")&&this._browserUtils.get_isInternetExplorerEdge()?(C.ULS.sendTraceTag(22073953,307,50,"EdgeSystemClipboardAccessManager"),e=new jy(this._appSettingsManager,se.w.get_instance().resolve(fd.t),se.w.get_instance().resolve(Vy.f),se.w.get_instance().resolve(Wy))):(C.ULS.sendTraceTag(7377744,307,50,"DefaultSystemClipboardAccessManager"),e=new qy(this._browserUtils,this._appSettingsManager))),e},e}();(0,o.l)($y,"SystemClipboardAccessManagerFactory",null,[Cd]);var Qy=function(){function e(){}return e.prototype.excludeControlCells=function(e){},e}();(0,o.l)(Qy,"DeleteTableSegmentStrategy",null,[Td]);var Jy=n(4742),Xy=n(2318),Yy=n(9892),Zy=n(8072),eC=function(){function e(e,t){this._isFrozen=!1,this._containingObjectSpace=null,this._paragraphWithIpFormatting=null,this._textFormattingCommands=null,this._fontSlotProvider=null,this._fontNameFormattingStrategy=null,this._ipProperties=new Kl.DictionaryPropertySet,this._fontSlotProvider=e,this._fontNameFormattingStrategy=t}return e.prototype.get_textFormattingCommands=function(){return this._textFormattingCommands||(this._textFormattingCommands=se.w.get_instance().tryResolve(gu.n))},e.prototype.get_formattingEditor=function(){return e._formattingEditor||(e._formattingEditor=se.w.get_instance().resolve(xs.z))},e.prototype.resetFormatting=function(){this._isFrozen||(this._ipProperties.removeAllProperties(),this._containingObjectSpace=null,this.removeIpFormattingCharacterProperty())},e.prototype.copyRunFormatting=function(e){var t=Ps.FormattingReader.getFormattingObject(e);if(!t.get_cache().get_isLink()){var n=t.get_formattingContainer();if(n){var r=new Kl.DictionaryPropertySet;r.copyProperties(n),r.copyProperties(this._ipProperties),r.hasProperty(qc.o.characterStyle)&&(this._containingObjectSpace=t.get_paragraph().get_containingObjectSpace()),this._ipProperties=r}}},e.prototype.hasProperty=function(e){return this._ipProperties.hasProperty(e)},e.prototype.hasPropertiesApplied=function(){return this._ipProperties.countOfProperties()>0},e.prototype.get_ipProperties=function(){return this._ipProperties},e.prototype.freeze=function(){this._isFrozen=!0},e.prototype.thaw=function(){this._isFrozen=!1},e.prototype.getPropertyWithDefault=function(e,t,n){return this.get_ipProperties().getValueWithDefault(e,t,n)},e.prototype.setFontSize=function(e){this._ipProperties.setValue(Kc.b.fontSize,this.get_formattingEditor().constrainFontSize(e)),this.setIpFormattingCharacterProperty()},e.prototype.fontSize=function(){return this._ipProperties.getValueWithDefault(Number,Kc.b.fontSize,Hu.Font.defaultSize)},e.prototype.setFontName=function(e){this._ipProperties.setValue(Kc.b.font,e),this._fontNameFormattingStrategy.setFontName(this._ipProperties,e),this._fontSlotProvider&&this._fontSlotProvider.get_enabled()&&(Vl.k(40506690,306,50,"InsertionPointFomatting: Set font slot values"),this._fontSlotProvider.setFontSlotValues(this._ipProperties,e)),this.setIpFormattingCharacterProperty()},e.prototype.setThemeFont=function(e){this._ipProperties.setValue(ks.j.themeFont,e),this._fontSlotProvider&&this._fontSlotProvider.get_enabled()&&(Vl.k(40506691,306,50,"InsertionPointFomatting: Set font theme slot values"),this._fontSlotProvider.setThemeSlotValues(this._ipProperties,e)),this.setIpFormattingCharacterProperty()},e.prototype.setFontColor=function(e){var t=Oa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection().get_firstContext().get_node(),n=Jy.m.get_instance().colorFromThemeColor(t,e);this._ipProperties.setValue(Kc.b.fontColor,n),this.setIpFormattingCharacterProperty()},e.prototype.clearFontColor=function(){this._ipProperties.setValue(Kc.b.fontColor,Xy.o.auto),this.setIpFormattingCharacterProperty()},e.prototype.fontColor=function(){return this._ipProperties.getValueWithDefault(Number,Kc.b.fontColor,Xy.o.nil)},e.prototype.setFontHighlight=function(e){this._ipProperties.setValue(Kc.b.highlight,parseInt(e,16)),this.setIpFormattingCharacterProperty()},e.prototype.clearFontHighlight=function(){this._ipProperties.setValue(Kc.b.highlight,Xy.o.auto),this.setIpFormattingCharacterProperty()},e.prototype.fontHighlight=function(){return this._ipProperties.getValueWithDefault(Number,Kc.b.highlight,Xy.o.nil)},e.prototype.isBold=function(){return this._ipProperties.getValueWithDefault(Boolean,Kc.b.bold,!1)},e.prototype.setBold=function(e){this._ipProperties.setValue(Kc.b.bold,e),this.setIpFormattingCharacterProperty()},e.prototype.isItalic=function(){return this._ipProperties.getValueWithDefault(Boolean,Kc.b.italic,!1)},e.prototype.setItalic=function(e){this._ipProperties.setValue(Kc.b.italic,e),this.setIpFormattingCharacterProperty()},e.prototype.isUnderline=function(){return this._ipProperties.getValueWithDefault(Boolean,Kc.b.underline,!1)},e.prototype.setUnderline=function(e){this._ipProperties.setValue(Kc.b.underline,e),this._ipProperties.setValue(Kc.b.underlineType,e?Hu.Font.get_underlineTypeSingle():Hu.Font.get_underlineTypeNone()),this.setIpFormattingCharacterProperty()},e.prototype.underlineType=function(){return this._ipProperties.getValueWithDefault(Number,Kc.b.underlineType,Hu.Font.get_underlineTypeNone())},e.prototype.setUnderlineType=function(e){e<Hu.Font.get_underlineTypeSingle()||e>Hu.Font.get_underlineTypeNone()||(this._ipProperties.setValue(Kc.b.underline,e!==Hu.Font.get_underlineTypeNone()),this._ipProperties.setValue(Kc.b.underlineType,e),this.setIpFormattingCharacterProperty())},e.prototype.isSuperscript=function(){return this._ipProperties.getValueWithDefault(Boolean,Kc.b.superscript,!1)},e.prototype.setSuperscript=function(e){this._ipProperties.setValue(Kc.b.superscript,e),e&&this.isSuperscript()&&this._ipProperties.setValue(Kc.b.subscript,!1),this.setIpFormattingCharacterProperty()},e.prototype.isSubscript=function(){return this._ipProperties.getValueWithDefault(Boolean,Kc.b.subscript,!1)},e.prototype.setSubscript=function(e){this._ipProperties.setValue(Kc.b.subscript,e),e&&this.isSubscript()&&this._ipProperties.setValue(Kc.b.superscript,!1),this.setIpFormattingCharacterProperty()},e.prototype.isStrikethrough=function(){return this._ipProperties.getValueWithDefault(Boolean,Kc.b.strikethrough,!1)},e.prototype.setStrikethrough=function(e){this._ipProperties.setValue(Kc.b.strikethrough,e),this.setIpFormattingCharacterProperty()},e.prototype.isDoubleStrikethrough=function(){return this._ipProperties.getValueWithDefault(Boolean,qc.o.doubleStrikethrough,!1)},e.prototype.setDoubleStrikethrough=function(e){this._ipProperties.setValue(qc.o.doubleStrikethrough,e),this.setIpFormattingCharacterProperty()},e.prototype.getCharacterStyleObjectId=function(){return this._ipProperties.getValueWithDefault(Dt.h,qc.o.characterStyle,null)},e.prototype.setCharacterStyle=function(e,t){this._ipProperties.removeAllProperties(),this._ipProperties.setValue(qc.o.characterStyle,e.get_id()),this._containingObjectSpace=t.get_containingObjectSpace(),this.setIpFormattingCharacterProperty()},e.prototype.hasValidCharacterStyleObjectSpace=function(e){return!this._containingObjectSpace||e===this._containingObjectSpace},e.prototype.setLanguage=function(e){var t=Kc.b.languageID;if(us.n.get_instance().get_item(13)){var n=Yy.k.lcidToLanguageHint(e);switch(n){case 1:t=ks.j.languageIDBidi;break;case 2:t=ks.j.languageIDEastAsia}this._ipProperties.setValue(ks.j.languageHint,n)}this._ipProperties.setValue(t,e),this.setIpFormattingCharacterProperty()},e.prototype.language=function(){var e=Kc.b.languageID;if(us.n.get_instance().get_item(13))switch(this._ipProperties.getValueWithDefault(Number,ks.j.languageHint,0)){case 1:e=ks.j.languageIDBidi;break;case 2:e=ks.j.languageIDEastAsia}return this._ipProperties.getValueWithDefault(Number,e,0)},e.prototype.setNoProof=function(t){this._ipProperties.setValue(e.get_noProofProperty(),t),this.setIpFormattingCharacterProperty()},e.prototype.isNoProof=function(){return this._ipProperties.getValueWithDefault(Boolean,e.get_noProofProperty(),!1)},e.prototype.isNoProofSetOnIP=function(){return this._ipProperties.hasProperty(e.get_noProofProperty())},e.prototype.isLanguageSetOnIP=function(){return us.n.get_instance().get_item(13)?this._ipProperties.hasProperty(Kc.b.languageID)||this._ipProperties.hasProperty(ks.j.languageIDBidi)||this._ipProperties.hasProperty(ks.j.languageIDEastAsia):this._ipProperties.hasProperty(Kc.b.languageID)},e.prototype.setIpFormattingCharacterProperty=function(){if(G.y.get_supportsPlacingIpInEmptySpan()){Ur.InteractiveViewManager.get_instance().get_editingView();var e=Oa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection().get_firstContext(),t=e.get_node();if(t!==this._paragraphWithIpFormatting){this._paragraphWithIpFormatting=t;var n=this._paragraphWithIpFormatting.suspendAutoCoreInvalidations();try{this._paragraphWithIpFormatting.ensureChPOnCp(e.get_cpBegin()).set_isIpFormatting(!0)}finally{n&&n.dispose()}}else this._paragraphWithIpFormatting.invalidateViewElements(16,!0)}},e.prototype.removeIpFormattingCharacterProperty=function(){if(G.y.get_supportsPlacingIpInEmptySpan()&&this._paragraphWithIpFormatting){var e=this._paragraphWithIpFormatting.suspendAutoCoreInvalidations();try{for(var t=this._paragraphWithIpFormatting.get_characterProperties().get_length()-1;0<=t;t--){var n=this._paragraphWithIpFormatting.get_characterProperties().get_item(t);n.get_isIpFormatting()&&(n.set_isIpFormatting(!1),n.get_isEmpty()&&this._paragraphWithIpFormatting.get_characterProperties().removeAt(t))}}finally{e&&e.dispose()}this._paragraphWithIpFormatting=null}},e.prototype.contextHasIpFormatting=function(e){var t=e,n=t.get_node();if(t.get_cpBegin()!==t.get_cpEnd())return!1;var r=n.get_characterProperties().getChpAtCp(t.get_cpBegin());return!!r&&r.get_isIpFormatting()},e.prototype.applyIpFormattingToContext=function(e){if(this.get_textFormattingCommands()){this.freeze();var t=new as.GraphTransaction(7);t.setFromNode(e.get_node()),this.get_textFormattingCommands().setFormattingFromIp(e),this.thaw(),this.resetFormatting(),t.dispose()}},e.prototype.getSelectionForIpFormatting=function(e){var t=e.get_node(),n=cs.ParagraphReader.text(t);if(!e.get_cpBegin()||e.get_cpBegin()===n.length)return null;if(Jn.l.isWhitespace(n.charCodeAt(e.get_cpBegin())))return null;if(Zy.i.get_instance().getForwardBreakByWord(n,e.get_cpBegin()-1)===e.get_cpBegin())return null;if(!Pa.SelectionEditor.isSelectionExpandableToWord(e))return null;var r=Pa.SelectionEditor.expandSelectionToWordBoundary(e,!1);return r&&(r.get_length()>1||Pa.SelectionEditor.isTextRangeContext(r.get_firstContext()))?r:null},e.get_noProofProperty=function(){return us.n.get_instance().get_item(20)?ks.j.noProof:zl.k.noProofBox4},e._formattingEditor=null,e}();(0,o.l)(eC,"InsertionPointFormatting",null,[ah.c]);var tC=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.bullets=function(e,t){var n=new Kl.DictionaryPropertySet;return n.setValue(zl.k.listSoftType,e),n.setValue(zl.k.listSoftStyle,t),32===this.get_actionManager().processActionWithData(ii.Gk,2,n)},e.prototype.numbering=function(e,t,n){var r=new Kl.DictionaryPropertySet;return r.setValue(zl.k.listSoftType,e),r.setValue(zl.k.listSoftStyle,t),r.setValue(zl.k.listLastStartAt,n),32===this.get_actionManager().processActionWithData(ii.nQ,2,r)},e}();(0,o.l)(tC,"ListCommands",null,[ns]);var nC=(0,o.y)("IProofingWholeDocumentCallbacks"),rC=function(){function e(e){this._selectionEditor=null,this._selectionEditor=e}return e.prototype.checkExecutionIsEnabled=function(e,t){var n=(0,f.e)(z_.k,e);return!!n&&!!n.view&&n.view.get_isInteractiveView()},e.prototype.setupCallback=function(e,t,n){return!0},e.prototype.processCurrentParagraphAtBeginningCallback=function(e,t){return!0},e.prototype.processOtherParagraphCallback=function(e,t){return!0},e.prototype.processCurrentParagraphAtEndCallback=function(e,t){},e.prototype.teardownCallback=function(e,t){return!0},e.prototype.spellErrorFilter=function(e,t){if(e.get_isAtOrigin())return!0;var n=e.get_role();return 1===n||2===n||3===n||4===n||5===n},e.prototype.getProofingWholeDocumentRootNode=function(e){if(!e||!this._selectionEditor)return e;var t=new Pm.z;if(t.set(e),this._selectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(t)){for(;!t.get_isAtOrigin();)t.returnToParent();return t.get_currentNode()}return e},e}();(0,o.l)(rC,"SimpleProofingWholeDocumentCallBacks",null,[nC]);var iC=function(){return function(e){this.value=!1,this.value=e}}();(0,o.l)(iC,"RefBool",null,[]);var oC=function(){return function(){this.nextError=null,this.errorNode=null,this.uncheckedRanges=new iC(!1)}}();(0,o.l)(oC,"FindNextErrorOperationParam",null,[]);var aC=function(e){function t(t,n){var r=e.call(this,n)||this;return r._errorRangeEditor=null,r._errorRangeEditor=t,r}return(0,S.t)(t,e),t.prototype.processCurrentParagraphAtBeginningCallback=function(e,t){return!this.locateNextErrorInParagraph(e.get_node(),e.get_cpBegin(),t)},t.prototype.processOtherParagraphCallback=function(e,t){return!this.locateNextErrorInParagraph(e,0,t)},t.prototype.processCurrentParagraphAtEndCallback=function(e,t){this.locateNextErrorInParagraph(e.get_node(),0,t);(0,f.e)(oC,t)},t.prototype.locateNextErrorInParagraph=function(e,t,n){var r=(0,f.e)(oC,n);if(cs.ParagraphReader.isParagraphNode(e)&&!e.get_isBlockContent())if(Ps.FormattingReader.getFormattingObject(_s.y.createIpContext(e,t)).get_cache().get_isNoProof())r.uncheckedRanges.value=!0;else for(var i=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SkipIgnoredProofingErrorsFromRibbon"),o=this._errorRangeEditor.getErrorRanges(e),a=0;a<o.length;a++){var s=o[a],l=i&&s.errorDetails.isIgnored();if(s.get_begin()>=t&&!l)return r.nextError=s,r.errorNode=e,!0}return!1},t}(rC);(0,o.l)(aC,"FindNextErrorCallbackSteps",rC,[]);var sC=function(e){function t(t,n,r,i,o,a,s,l,c,u,g){var p=e.call(this)||this;return p._context=null,p._selectionManager=null,p._selectionEditor=null,p._operationStage=0,p._proofingWholeDocCallbacks=null,p._currentIpContext=null,p._traverser=null,p._proofingWholeDocumentRootNode=null,p.init(t),p.setDebugName(g),p.initAction(l,n,i,o,a),p._actionData=a,p._context=r,p._selectionManager=c,p._selectionEditor=u,p._proofingWholeDocCallbacks=s,p._operationStage=0,p}return(0,S.t)(t,e),t.prototype.run=function(){this.checkExecutionIsEnabled(),this._operationStage||this.setupStage(),1===this._operationStage&&this.processStage(),2===this._operationStage&&this.teardownStage(),3===this._operationStage&&this.finishedStage()},t.prototype.checkExecutionIsEnabled=function(){if(!this._selectionManager.get_selectionCollection()||!this._selectionManager.get_selectionCollection().get_currentSelection())return C.ULS.sendTraceTag(20321351,324,15,"No selection for ignore all"),this.set_response(2),void(this._operationStage=3);1===this.get_behavior()&&(this._proofingWholeDocCallbacks.checkExecutionIsEnabled(this._context,this._actionData)?this.set_response(32):this.set_response(2),this._operationStage=3)},t.prototype.setupStage=function(){this.buildProofingContext(),this._proofingWholeDocCallbacks.setupCallback(this,this._currentIpContext,this._actionData)?(this.buildHereToEndTraverser(),this._operationStage=1):(this.set_response(8),this._operationStage=3)},t.prototype.processStage=function(){this.get_childOperation()||new A_.a(this,o.i(this,this.processCurrentNodeAtBegin,"processCurrentNodeAtBegin"),this._actionData);do{if(this.get_childOperation().run(),this.get_childOperation().get_inProgress()&&!this.get_isSynchronous())return}while(this.get_childOperation().get_inProgress());this.clearChildOperation(),this._operationStage=2},t.prototype.teardownStage=function(){this._proofingWholeDocCallbacks.teardownCallback(this,this._actionData)?this.set_response(32):this.set_response(8),this._operationStage=3},t.prototype.finishedStage=function(){this.setIsCompleted()},t.prototype.processCurrentNodeAtBegin=function(e,t){var n=this._proofingWholeDocCallbacks.processCurrentParagraphAtBeginningCallback(this._currentIpContext,t);return e.changeStepCallback(o.i(this,this.fromHereToEnd,"fromHereToEnd")),n},t.prototype.fromHereToEnd=function(e,t){if(this._traverser.moveNext()){var n=this._traverser.get_currentNode();return 12!==n.get_type()||(n===this._currentIpContext.get_node()||this._proofingWholeDocCallbacks.processOtherParagraphCallback(n,t))}return this.buildStartToHereTraverser(),e.changeStepCallback(o.i(this,this.fromStartToHere,"fromStartToHere")),!0},t.prototype.fromStartToHere=function(e,t){if(this._traverser.moveNext()){var n=this._traverser.get_currentNode();return 12!==n.get_type()||(n===this._currentIpContext.get_node()?(e.changeStepCallback(o.i(this,this.processCurrentNodeAtEnd,"processCurrentNodeAtEnd")),!0):this._proofingWholeDocCallbacks.processOtherParagraphCallback(n,t))}return!1},t.prototype.processCurrentNodeAtEnd=function(e,t){return this._proofingWholeDocCallbacks.processCurrentParagraphAtEndCallback(this._currentIpContext,t),!1},t.prototype.buildProofingContext=function(){var e=this._selectionManager.get_selectionCollection().get_currentSelection();(e=this._selectionEditor.collapseToIp(e,!0,!1))&&(this._currentIpContext=e.get_firstContext()),this._currentIpContext&&this._currentIpContext.get_node()&&(this._proofingWholeDocumentRootNode=this._proofingWholeDocCallbacks.getProofingWholeDocumentRootNode(this._currentIpContext.get_node()))},t.prototype.buildHereToEndTraverser=function(){if(!this._proofingWholeDocumentRootNode)throw Error.argumentNull("_proofingWholeDocumentRootNode");var e=new Pm.z;e.set(this._currentIpContext.get_node()),e.tryToRootAtAncestorOfType(this._proofingWholeDocumentRootNode.get_type()),this._traverser=xf.p.createPartialTraverser(e,this._proofingWholeDocumentRootNode),this._traverser.setFilter(o.i(this._proofingWholeDocCallbacks,this._proofingWholeDocCallbacks.spellErrorFilter,"spellErrorFilter"),null)},t.prototype.buildStartToHereTraverser=function(){if(!this._proofingWholeDocumentRootNode)throw Error.argumentNull("_proofingWholeDocumentRootNode");var e=new Pm.z;e.set(this._proofingWholeDocumentRootNode),this._traverser=xf.p.createTraverserFromIterator(e),this._traverser.setFilter(o.i(this._proofingWholeDocCallbacks,this._proofingWholeDocCallbacks.spellErrorFilter,"spellErrorFilter"),null)},t}(V_.g);(0,o.l)(sC,"ProofingWholeDocumentOperation",V_.g,[]);var lC=n(2543),cC=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g,p,d,h){this._selectionContextMenuProvider=null,this._characterPropertiesEditor=null,this._lockedRangeEditor=null,this._acceptedCritiqueActionIds=null,this._rejectedCritiqueActionIds=null,this._activityManager=null,this._languageDialogFactory=null,this._actionManager=null,this._errorRangeEditor=null,this._graphTransactionFactory=null,this._selectionManager=null,this._externalSelectionManagerFuture=null,this._selectionEditor=null,this._contextMenuController=null,this._proofingErrorPresenterFuture=null,this._appFeaturesLookup=null,this._isProofingSecondaryContextualMenuEnabled=!1,this._actionManager=t,this._errorRangeEditor=e,this._languageDialogFactory=n,this._characterPropertiesEditor=r,this._graphTransactionFactory=i,this._selectionManager=o,this._externalSelectionManagerFuture=a,this._selectionEditor=s,this._selectionContextMenuProvider=l,this._lockedRangeEditor=c,this._activityManager=u,this._contextMenuController=(0,f.e)(bu,g),this._isProofingSecondaryContextualMenuEnabled=p.get_isProofingSecondaryContextualMenuEnabled(),this._proofingErrorPresenterFuture=d,this._appFeaturesLookup=h,this._acceptedCritiqueActionIds=new Iu.n(Fu.t,Number),this._acceptedCritiqueActionIds.set_item(1,ii.zQ),this._acceptedCritiqueActionIds.set_item(2,ii.Ib),this._acceptedCritiqueActionIds.set_item(3,ii.RM),this._rejectedCritiqueActionIds=new Iu.n(Fu.t,Number),this._rejectedCritiqueActionIds.set_item(1,ii.WF),this._rejectedCritiqueActionIds.set_item(2,ii.qW),this._rejectedCritiqueActionIds.set_item(3,ii.Qs)}return e.prototype.registerActions=function(){var e=this._actionManager,t=o.i(this,this.correctError,"correctError"),n=o.i(this,this.collapseIp,"collapseIp");e.addActionWithFlags(ii.ej,cl.n,o.i(this,this.openLanguageDialogView,"openLanguageDialogView"),1028),e.addAction(ii.ls,cl.V,o.i(this,this.deleteRepeatedWord,"deleteRepeatedWord")),e.addAction(ii.Rv,cl.V,o.i(this,this.ignoreSpellingError,"ignoreSpellingError")),e.addAction(ii.fd,cl.V,t),e.addAction(ii.kL,cl.V,t),e.addAction(ii.hY,cl.V,t),e.addAction(ii.sS,cl.V,t),e.addAction(ii.hE,cl.V,t),e.addAction(ii.ls,cl.n,n),e.addAction(ii.Rv,cl.n,n),e.addAction(ii.fd,cl.n,n),e.addAction(ii.kL,cl.n,n),e.addAction(ii.hY,cl.n,n),e.addAction(ii.sS,cl.n,n),e.addAction(ii.hE,cl.n,n),e.setActionFlags(ii.ls,1028),e.setActionFlags(ii.Rv,1028),e.setActionFlags(ii.fd,1028),e.setActionFlags(ii.kL,1028),e.setActionFlags(ii.hY,1028),e.setActionFlags(ii.sS,1028),e.setActionFlags(ii.hE,1028),e.addAction(ii.If,nt.a,Ze.ActionManager.doNothingButReportHandler),this._isProofingSecondaryContextualMenuEnabled&&e.addActionWithFlags(ii.T,cl.n,o.i(this,this.populateProofingSecondaryMenu,"populateProofingSecondaryMenu"),1124),e.addActionWithFlags(ii.WE,cl.n,o.i(this,this.findNextProofingError,"findNextProofingError"),1028),this.registerLoggingActions([ii.VT,ii.zQ,ii.WF,ii.cf,ii.Ib,ii.qW,ii.Ok,ii.RM,ii.Qs])},e.prototype.registerLoggingActions=function(e){for(var t=0;t<e.length;t++)this._actionManager.addActionWithFlags(e[t],cl.n,Ze.ActionManager.doNothingHandler,1028)},e.prototype.collapseIp=function(e,t,n,r,i){var o=this._selectionManager.get_selectionCollection().get_currentSelection();if(!o)return this._activityManager.recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),2;var a=this._selectionEditor.collapseToIp(o,!0,!1);return this._actionManager.processActionAgainstContext(a.get_firstContext(),e,n,!1,r,i)},e.prototype.openLanguageDialogView=function(e,t,n,r,i){return 1===n?this._actionManager.processAction(ii.So,1):(this._languageDialogFactory().showLanguageDialog(),32)},e.prototype.tryHandleUnexpectedStates=function(e){return e?!e.errorDetails&&(C.ULS.sendTraceTag(7660829,324,10,"Ignore Spelling Error: No suggestions on flagged word"),this._activityManager.recordEvent(D_.f.failedResult,{Reason:"ErrorRangeMissingErrorDetails"}),Xi.t.mark(4671),!0):(C.ULS.sendTraceTag(7660828,324,10,"Ignore Spelling Error: No flagged word"),this._activityManager.recordEvent(D_.f.failedResult,{Reason:"RequestedErrorRangeNotFound"}),Xi.t.mark(4671),!0)},e.prototype.deleteRepeatedWord=function(e,t,n,r,i){if(1===n)return 32;Xi.t.mark(4670);var o=this._errorRangeEditor.getErrorAtContext(t);if(this.tryHandleUnexpectedStates(o))return 8;var a=t.get_node(),s=this._graphTransactionFactory.getTransaction(15),l=o.get_begin();" "===cs.ParagraphReader.text(a).charAt(l-1)&&l--,s.setFromNode(a);var c=this._characterPropertiesEditor.replaceTextRange(_s.y.createTextRange(a,o.get_begin()>0?o.get_begin()-1:0,o.get_end()),"",!0,!1);return this._selectionManager.setSelection(ss.SelectionFactory.createIpSelection(a,c+l)),s.dispose(),o.errorDetails.traceUserAction(e),Xi.t.mark(4671),32},e.prototype.logRejectedSuggestion=function(e){var t;this._rejectedCritiqueActionIds.tryGetValue(e.errorDetails.get_proofingType(),(0,p.m)((function(){return t}),(function(e){return t=e})))&&this._actionManager.processAction(t,2)},e.prototype.ignoreSpellingError=function(e,t,n,r,i){if(1===n)return 32;C.ULS.sendTraceTag(7660830,324,50,"Ignore spelling error triggerred"),Xi.t.mark(4670);var o=this._errorRangeEditor.getErrorAtContext(t);if(this.tryHandleUnexpectedStates(o))return 8;var a=t.get_node(),s=this._graphTransactionFactory.getTransaction(15);return s.setFromNode(a),this._errorRangeEditor.removeErrorRanges(a,[o],!0),a.setValue(Kc.b.containsIgnoredSpellingError,!0),s.dispose(),o.errorDetails.traceUserAction(e,1),Xi.t.mark(4671),C.ULS.sendTraceTag(7692317,324,50,"Ignore spelling error action succeeded"),this.logRejectedSuggestion(o),32},e.prototype.getCorrectionIndex=function(e){switch(e){case ii.fd:return 0;case ii.kL:return 1;case ii.hY:return 2;case ii.sS:return 3;case ii.hE:return 4;default:return-1}},e.prototype.logAcceptedSuggestion=function(e){var t;this._acceptedCritiqueActionIds.tryGetValue(e.errorDetails.get_proofingType(),(0,p.m)((function(){return t}),(function(e){return t=e})))&&this._actionManager.processAction(t,2)},e.prototype.correctError=function(e,t,n,r,i){var o=!0,a=t;if(this._appFeaturesLookup.get_item(14)&&(o=!this._lockedRangeEditor.isIpOrTextRangeContextInLockedRange(a)),this._externalSelectionManagerFuture&&this._externalSelectionManagerFuture.get_instance()&&this._externalSelectionManagerFuture.get_instance().isExternalSelectionContext(a)&&(o=!1),1===n||!o)return o?32:8;this._actionManager.processAction(ii.If,2),Xi.t.mark(4670);var s=this.getCorrectionIndex(e);if(s<0)return 8;var l=this._errorRangeEditor.getErrorAtContext(t);if(this.tryHandleUnexpectedStates(l))return 8;var c=t.get_node(),u=l.errorDetails.get_suggestions();if(!u)return this._activityManager.recordEvent(D_.f.failedResult,{Reason:"NoSuggestionsFound"}),Xi.t.mark(4671),8;var g=s<u.length?u[s]:null;if(!g)return this._activityManager.recordEvent(D_.f.failedResult,{Reason:"RequestedSuggestionIsNull"}),Xi.t.mark(4671),8;this._appFeaturesLookup.get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(c),g=g.replace("  "," \xa0");var p=this._graphTransactionFactory.getTransaction(15);p.setFromNode(c);var d=this._characterPropertiesEditor.replaceTextRange(_s.y.createTextRange(c,l.get_begin(),l.get_end()),g,!0,!1,ii.If);return this._selectionManager.setSelection(ss.SelectionFactory.createIpSelection(c,l.get_begin()+g.length+d)),p.dispose(),l.errorDetails.traceUserAction(e),Xi.t.mark(4671),this.logAcceptedSuggestion(l),32},e.prototype.scrollSelectionIntoViewAndShowContextMenu=function(e,t,n,r){e.scrollSelectionIntoView();var i=n.getHtmlViewElement(e.get_viewId());if(i){var o=L.AFrameworkApplication.get_isRtl()?r.get_begin():r.get_end(),a=lC.n.boundsFromCp(i,o);this._selectionContextMenuProvider.showContextMenuForSelection(new Sys.UI.Point(a.x,a.y+a.height),t)}else C.ULS.sendTraceTag(5902807,324,50,"Failed to pop up proofing context menu")},e.prototype.findNextProofingError=function(e,t,n,r,i){var o=this;if(!t.view.get_isInteractiveView())return 2;var a=t.view;if(!this._selectionManager.get_selectionCollection().get_currentSelection())return this._activityManager.recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),2;if(1===n)return 32;var s=new oC,l=new aC(this._errorRangeEditor,this._selectionEditor),c=new sC(null,e,t,n,r,s,l,this._actionManager,this._selectionManager,this._selectionEditor,null);if(c.set_isSynchronous(!0),c.run(),c.get_isCompleted()&&s.nextError){var u=ss.SelectionFactory.createIpSelection(s.errorNode,s.nextError.get_begin()),g=ss.SelectionFactory.extendSelection(u,_s.y.createIpContext(s.errorNode,s.nextError.get_end()));if(!this._proofingErrorPresenterFuture.get_instance()||!this._proofingErrorPresenterFuture.get_instance().presentProofingError(s.nextError,g,a)){this._selectionManager.setSelection(g);var p=0;i&&(p=i.inputMethod),a.shouldScrollSelectionIntoView=!1,Oe.y.get_instance().addTask(new De.c(1,1,1,(function(){o.scrollSelectionIntoViewAndShowContextMenu(a,p,s.errorNode,s.nextError)})))}}else{var d=new ar.StandardDialog;d.set_buttonsOption(0),Br.App.theProofingManager.get_isSpellingComplete()?d.showInformation(CommonUIStrings.l_DefaultDialogTitle,s.uncheckedRanges.value?Box4Intl.Box4Strings.l_ProofingCompleteNoErrorsWithIgnoredRanges:Box4Intl.Box4Strings.l_ProofingCompleteNoErrors,null):(d.showInformation(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ProofingInProgress,null),Br.App.theProofingManager.addProofingCompletedCallback((function(){d.get_isShowing()&&(d.hide(),o._actionManager.processAction(e,2))}),!1))}return 32},e.prototype.populateProofingSecondaryMenu=function(e,t,n,r,i){if(1===n)return 32;if(this._contextMenuController&&this._contextMenuController.get_theRoot()){var o=this._contextMenuController.get_theRoot().getValidControl(xu.proofingSection);o&&!o.menuLaunched&&(o.launchMenu(0),o.get_menu().focusNext(0))}return 32},e}();(0,o.l)(cC,"ProofingActor$0",null,[]);var uC=n(5062),gC=n(563),pC=function(){function e(){}return e.get_styleFormattingAttrs=function(){return e.styleFormattingAttrsArray||(e.styleFormattingAttrsArray=new Array(e.styleFormattingAttrsArraySize),e.styleFormattingAttrsArray[0]=Kc.b.fontColor,e.styleFormattingAttrsArray[1]=qc.o.shading,e.styleFormattingAttrsArray[2]=Kc.b.languageID,e.styleFormattingAttrsArray[3]=Kc.b.underline,e.styleFormattingAttrsArray[4]=Kc.b.underlineType,e.styleFormattingAttrsArray[5]=qc.o.doubleStrikethrough,e.styleFormattingAttrsArray[6]=Kc.b.font,e.styleFormattingAttrsArray[7]=Kc.b.fontSize,e.styleFormattingAttrsArray[8]=Kc.b.superscript,e.styleFormattingAttrsArray[9]=Kc.b.subscript,e.styleFormattingAttrsArray[10]=Kc.b.isHidden,e.styleFormattingAttrsArray[11]=ks.j.noProof,e.styleFormattingAttrsArray[12]=zl.k.noProofBox4,e.styleFormattingAttrsArray[13]=qc.o.capitalization,e.styleFormattingAttrsArray[14]=Kc.b.bold,e.styleFormattingAttrsArray[15]=Kc.b.italic,e.styleFormattingAttrsArray[16]=Kc.b.underline),e.styleFormattingAttrsArray},e.get_paragraphStyleAttrs=function(){return e.paragraphStyleAttrsArray||(e.paragraphStyleAttrsArray=new Array(e.paragraphStyleAttrsArraySize),e.paragraphStyleAttrsArray[0]=qc.o.paragraphStyle,e.paragraphStyleAttrsArray[1]=qc.o.paragraphStyleId),e.paragraphStyleAttrsArray},e.get_paragraphListAttrs=function(){return e.paragraphListAttrsArray||(e.paragraphListAttrsArray=new Array(e.paragraphListAttrsArraySize),e.paragraphListAttrsArray[0]=ks.j.listID,e.paragraphListAttrsArray[1]=ks.j.listLevel),e.paragraphListAttrsArray},e.get_paragraphFormattingAttrs=function(){return e.paragraphFormattingAttrsArray||(e.paragraphFormattingAttrsArray=new Array(e.paragraphFormattingAttrsArraySize),e.paragraphFormattingAttrsArray[0]=ks.j.paraIndentFirstLine,e.paragraphFormattingAttrsArray[1]=ks.j.paraIndentFirstLineChars,e.paragraphFormattingAttrsArray[2]=ks.j.paraIndentLeft,e.paragraphFormattingAttrsArray[3]=ks.j.paraIndentLeftChars,e.paragraphFormattingAttrsArray[4]=ks.j.paraIndentRight,e.paragraphFormattingAttrsArray[5]=ks.j.paraIndentRightChars,e.paragraphFormattingAttrsArray[6]=ks.j.paraIndentHanging,e.paragraphFormattingAttrsArray[7]=ks.j.paraIndentHangingChars,e.paragraphFormattingAttrsArray[8]=qc.o.paragraphSpaceBefore,e.paragraphFormattingAttrsArray[9]=qc.o.paragraphSpaceAfter,e.paragraphFormattingAttrsArray[10]=ks.j.paraSpacingBefore,e.paragraphFormattingAttrsArray[11]=ks.j.paraSpacingAfter,e.paragraphFormattingAttrsArray[12]=ks.j.lineSpacingRule,e.paragraphFormattingAttrsArray[13]=ks.j.lineSpacingValue,e.paragraphFormattingAttrsArray[14]=ks.j.paragraphSpaceBeforeAuto,e.paragraphFormattingAttrsArray[15]=ks.j.paragraphSpaceAfterAuto,e.paragraphFormattingAttrsArray[16]=ks.j.paraSpacingBeforeLines,e.paragraphFormattingAttrsArray[17]=ks.j.paraSpacingAfterLines,e.paragraphFormattingAttrsArray[18]=Kc.b.layoutAlignmentInParent,e.paragraphFormattingAttrsArray[19]=Kc.b.layoutAlignmentSelf,e.paragraphFormattingAttrsArray[20]=qc.o.readingOrderRTL,e.paragraphFormattingAttrsArray[21]=Kc.b.outlineElementRTL),e.paragraphFormattingAttrsArray},e.styleFormattingAttrsArraySize=17,e.paragraphFormattingAttrsArraySize=22,e.paragraphStyleAttrsArraySize=2,e.paragraphListAttrsArraySize=2,e.styleFormattingAttrsArray=null,e.paragraphFormattingAttrsArray=null,e.paragraphStyleAttrsArray=null,e.paragraphListAttrsArray=null,e}();(0,o.l)(pC,"StyleConstants",null,[]);var dC=n(9040),hC=n(8812),_C=n(3651),mC=n(1773),fC=n(8128),yC=n(596),CC=function(){function e(){}return e.get_propertySetComparer=function(){return e._comparer||(e._comparer=new _C.h)},e.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.isSelectedStyleIsDifferentFromSelection=function(t,n){if(!t||!t.get_node()||!n)return!1;var r=Ps.FormattingReader.getFormattingObject(t),i=r?r.get_formattingContainer():null;if(e.isFormattingAndStyleAttributesDifferent(i,n,pC.get_styleFormattingAttrs()))return C.ULS.sendTraceTag(51218398,324,50,"Difference in formatting attributes b/w text selection and style"),!0;var o=t.get_node().getCurrentFormatProperties();return!!e.isFormattingAndStyleAttributesDifferent(o,n,pC.get_paragraphFormattingAttrs())&&(C.ULS.sendTraceTag(51218399,324,50,"Difference in paragraph attributes b/w text selection and style"),!0)},e.isFormattingAndStyleAttributesDifferent=function(t,n,r){var i=!1;if(t)for(var o=0,a=r;o<a.length;o++){var s=a[o];i=!!t.hasProperty(s)&&(!n.hasProperty(s)||!e.get_propertySetComparer().compare(t,n,s))||i}return i},e.getStyleDefinitionString=function(e){if(!Tc.StyleReader.isValidStyleContainer(e))return C.ULS.sendTraceTag(595345820,324,50,"Received an invalid style container in GetStyleDefinitionString()."),null;var t=new hC.SerializedObject(e,!1,!0);return w.w(t)},e.getStyleFromDefinitionString=function(t){if(!t)return C.ULS.sendTraceTag(595345819,324,50,"Received null string in GetStyleFromDefinitionString()."),null;var n=null;return w.t(hC.SerializedObject,t,(0,p.m)((function(){return n}),(function(e){return n=e})))?e.revisionObjectDeserializer.deserialize(new gC.w(n),!1):(C.ULS.sendTraceTag(595345818,324,50,"Unable to parse json to construct style object in GetStyleFromDefinitionString()."),null)},e.getStyleObjectIds=function(e){if(!e)return null;for(var t=[],n=0;n<e.get_countOfStyles();n++){var r=e.getStyleByIndex(n);Array.add(t,r.get_id())}return t},e.addCustomStyles=function(t,n){if(!t||!t.length)return!1;var r=e.get_pageNavigator().navigateToPageContentNode(n);if(!r)return!1;var i=dC.w.getStyleSetFromPageContentNode(r);if(!i)return!1;for(var o=r.get_containingObjectSpace(),a=0;a<t.length;a++){var s=(0,f.e)(kc.t,t[a]);if(!s||!Tc.StyleReader.isValidStyleContainer(s))return!1;if(!!i.getStyleByName(Tc.StyleReader.getStyleName(s))||!!i.getStyleByWordId(Tc.StyleReader.getStyleWordId(s))||!!i.getStyleById(Tc.StyleReader.getStyleId(s)))return!1;var l=o.registerSharedObject(s);if(!i.addNewStyleToStyleSet(l,s.hasProperty(qc.o.isQuickStyle)))return!1}var c=e.getStyleObjectIds(i),u=new as.GraphTransaction(15);return u.setFromNode(r),r.setValue(qc.o.styleSet,c),u.setDisallowUndoIfMergeRequired(),u.dispose(),!0},e.revisionObjectDeserializer=new mC.n(new fC.x(new yC.u)),e._comparer=null,e}();(0,o.l)(CC,"StyleUtils",null,[]);var SC=function(){function e(e,t,n,r,i,o,a,s,l,c){this.styleShortcuts=null,this._characterPropertiesEditor=null,this._styleEditor=null,this._styleReader=null,this._formattingEditor=null,this._contextSetEditor=null,this._insertionPointFormatting=null,this._lockedRangeEditor=null,this._activityManager=null,this._textFormattingHelper=null,this._viewActionHandler=null,this._isHighlightStyleWhenDifferentFromSelectionEnabled=null,this._characterPropertiesEditor=e,this._styleEditor=t,this._styleReader=n,this._formattingEditor=r,this._contextSetEditor=i,this._insertionPointFormatting=o,this._lockedRangeEditor=a,this._activityManager=s,this._textFormattingHelper=l,this._viewActionHandler=c}return e.prototype.get_characterPropertiesEditor=function(){return this._characterPropertiesEditor},e.prototype.get_styleEditor=function(){return this._styleEditor},e.prototype.get_styleReader=function(){return this._styleReader},e.prototype.get_contextSetEditor=function(){return this._contextSetEditor},e.prototype.get_insertionPointFormatting=function(){return this._insertionPointFormatting},e.prototype.get_formattingEditor=function(){return this._formattingEditor},e.prototype.get_lockedRangeEditor=function(){return this._lockedRangeEditor},e.prototype.get_activityManager=function(){return this._activityManager},e.prototype.get_textFormattingHelper=function(){return this._textFormattingHelper},e.prototype.get_viewActionHandler=function(){return this._viewActionHandler},e.prototype.get_isHighlightStyleWhenDifferentFromSelectionEnabled=function(){return null==this._isHighlightStyleWhenDifferentFromSelectionEnabled&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),L.AFrameworkApplication.appSettingsManager?this._isHighlightStyleWhenDifferentFromSelectionEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HighlightStyleWhenDifferentFromSelectionIsEnabled"):this._isHighlightStyleWhenDifferentFromSelectionEnabled=!1),this._isHighlightStyleWhenDifferentFromSelectionEnabled},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager(),t=Br.App.theContextSetActor.createDelegatedViewHandlerForNodeType(12);us.n.get_instance().get_item(61)&&(e.addAction(ii.zV,cl.Z,o.i(this,this.applyStyleToTextRange,"applyStyleToTextRange")),e.addAction(ii.zU,cl.Z,o.i(this,this.queryStyleTextRange,"queryStyleTextRange")),e.addAction(ii.zV,cl.V,o.i(this,this.applyStyleToIp,"applyStyleToIp")),e.addAction(ii.zU,cl.V,o.i(this,this.queryStyleIp,"queryStyleIp"))),e.addAction(ii.zV,cl.K,o.i(this,this.applyStyleToParagraph,"applyStyleToParagraph")),e.addAction(ii.zV,cl.n,o.i(this,this.applyStyleView,"applyStyleView")),e.setActionFlags(ii.zV,1036),e.addAction(ii.zU,cl.n,o.i(this,this.queryStyleView,"queryStyleView")),e.addAction(ii.zU,cl.K,o.i(this,this.queryStyleParagraph,"queryStyleParagraph")),e.setActionFlags(ii.zU,99|(us.n.get_instance().get_item(7)?0:4)),e.addAction(ii.kc,cl.n,t),e.addAction(ii.kc,cl.K,o.i(this,this.populateMenuMoreStyles,"populateMenuMoreStyles")),e.setActionFlags(ii.kc,1127),e.addActionWithFlags(ii.SO,cl.n,o.i(this,this.applyStyleShortcut,"applyStyleShortcut"),4),e.addActionWithFlags(ii.sg,cl.n,o.i(this,this.applyStyleShortcut,"applyStyleShortcut"),4),e.addActionWithFlags(ii.Wf,cl.n,o.i(this,this.applyStyleShortcut,"applyStyleShortcut"),4),e.addActionWithFlags(ii.DE,cl.n,o.i(this,this.applyStyleShortcut,"applyStyleShortcut"),4),e.addActionWithFlags(ii.ks,cl.n,o.i(this,this.applyStyleShortcut,"applyStyleShortcut"),4),e.addActionWithFlags(ii.GY,cl.n,o.i(this,this.applyStyleShortcut,"applyStyleShortcut"),4),e.addActionWithFlags(ii.Py,cl.n,o.i(this,this.applyStyleShortcut,"applyStyleShortcut"),4),e.addActionWithFlags(ii.eX,cl.n,o.i(this,this.applyStyleShortcut,"applyStyleShortcut"),4),e.addActionWithFlags(ii.Ht,cl.n,o.i(this,this.applyStyleShortcut,"applyStyleShortcut"),4),e.addActionWithFlags(ii.BU,cl.n,o.i(this,this.applyStyleShortcut,"applyStyleShortcut"),4),this.styleShortcuts=new Array(10),this.get_styleReader().setStyleActorDefaultStyleShortcuts(this.styleShortcuts)},e.prototype.getStyleCommandIndex=function(e){switch(e){case ii.SO:return 0;case ii.sg:return 1;case ii.Wf:return 2;case ii.DE:return 3;case ii.ks:return 4;case ii.GY:return 5;case ii.Py:return 6;case ii.eX:return 7;case ii.Ht:return 8;case ii.BU:return 9;default:return-1}},e.prototype.applyStyleShortcut=function(e,t,n,r,i){var o,a=this.getStyleCommandIndex(e);return a<0||a>this.styleShortcuts.length?2:(o=this.styleShortcuts[a])?L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(t,ii.zV,n,!0,r,o):2},e.prototype.populateMenuMoreStyles=function(e,t,n,r,i){var o=!0;if(t.get_contextId()!==cl.K&&t.get_contextId()!==cl.Z&&t.get_contextId()!==cl.V&&(o=!1),1===n||!o)return o?32:8;if(2===n&&!i)return 8;var a=t.get_node(),s=i,l=this.get_styleReader().getStyleSetFromParagraphNode(a),c=us.n.get_instance().get_item(61);return L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&(s.MenuItems=uC.StylePreviewGenerator.getMoreStylesMenuProps(l,c)),s.PopulationXML=uC.StylePreviewGenerator.generateMoreStylesMenuXml(l,c),32},e.prototype.queryStyleParagraph=function(e,t,n,r,i){var o=!0;if(t.get_contextId()!==cl.K&&(o=!1),1===n&&!o)return 8;var a=t.get_node(),s=this.get_styleReader().getStyleFromParagraphNode(a);return s&&i?(i.styleProperties.copyProperties(s),this.get_isHighlightStyleWhenDifferentFromSelectionEnabled()&&(i.isHighlightedStyleDiffFromSelection=CC.isSelectedStyleIsDifferentFromSelection(t,s)),32):(C.ULS.sendTraceTag(51218391,324,10,"actionData : {}, graphNode : {}, paragraphStyle : {}",i,a,s),8)},e.prototype.applyStyleToParagraph=function(e,t,n,r,i){if(t.get_contextId()!==cl.K)return 8;if(us.n.get_instance().get_item(14)&&this.get_lockedRangeEditor().isParaStartOrEndInLockedRange(t))return this.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),8;if(1===n)return 32;var o=t.get_node(),a=i;if(!a)return 8;var s=this.getStyleToApplyFromStyleId(a,o);if(!s)return this.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.failedToFindStyle}),8;if(2!==this.get_styleReader().getStyleTargetType(s))return 2;var l=new as.GraphTransaction(15);l.setFromNode(o),this.get_insertionPointFormatting().resetFormatting(),this.get_styleEditor().setStyleOnParagraphNode(s,o,!1),l.dispose();var c=Jn.l.calcHashCode(a),u=c>>>16^65535&c;return r.dataValue1=u,32},e.prototype.queryStyleTextRange=function(e,t,n,r,i){var o=!0;if(t.get_contextId()!==cl.Z&&(o=!1),1===n&&!o)return 2;var a=t,s=a.get_node(),l=Ps.FormattingReader.getFormattingObject(a),c=Ps.FormattingReader.getCharacterStyleContainer(l);if(this.get_isHighlightStyleWhenDifferentFromSelectionEnabled()){if(!i||!s)return C.ULS.sendTraceTag(51218393,324,10,"actionData : {}, graphNode : {}",i,s),8;if(!(c=c||this.get_styleReader().getStyleFromParagraphNode(s)))return C.ULS.sendTraceTag(51218394,324,10,"No paragraph style for Text range context is found"),2;i.isHighlightedStyleDiffFromSelection=CC.isSelectedStyleIsDifferentFromSelection(t,c)}else{if(!c)return 2;if(!i)return 8}return i.styleProperties.copyProperties(c),32},e.prototype.applyStyleToTextRange=function(e,t,n,r,i){var o=this;if(t.get_contextId()!==cl.Z)return 8;if(!us.n.get_instance().get_item(61))return 8;if(this.get_lockedRangeEditor().isParaStartOrEndInLockedRange(t))return this.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),8;if(1===n)return 32;var a=t,s=a.get_node(),l=i;if(!l)return 8;var c=this.getStyleToApplyFromStyleId(l,a.get_node());if(!c)return this.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.failedToFindStyle}),8;if(1!==this.get_styleReader().getStyleTargetType(c))return 2;var u=this.get_styleReader().getStyleSetFromParagraphNode(s);if(!u)return this.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.failedToFindStyleSet}),8;if(!u.getStyleById(this.get_styleReader().getStyleId(c)))return this.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.failedToFindStyle}),8;var g=new as.GraphTransaction(7);try{g.setFromNode(s),this.get_styleEditor().updateStyleSetFromParagraphNode(s,u),this.get_textFormattingHelper().applyCharacterFormattingOnTextRange(a,(function(e){o.get_formattingEditor().clearCharacterFormatting(e),o.get_formattingEditor().setCharacterStyle(e,c)}))}finally{g&&g.dispose()}var p=Jn.l.calcHashCode(l),d=p>>>16^65535&p;return r.dataValue1=d,32},e.prototype.queryStyleIp=function(e,t,n,r,i){var o=!0;if(t.get_contextId()!==cl.V&&(o=!1),1===n&&!o)return 2;var a=this.get_styleEditor().getStyleFromIp(t),s=t.get_node();if(this.get_isHighlightStyleWhenDifferentFromSelectionEnabled()){if(!i||!s)return C.ULS.sendTraceTag(51218396,324,10,"actionData : {}, graphNode : {}",i,s),8;if(!(a=a||this.get_styleReader().getStyleFromParagraphNode(s)))return C.ULS.sendTraceTag(51218397,324,10,"No paragraph style for I/P context is found"),2;i.isHighlightedStyleDiffFromSelection=CC.isSelectedStyleIsDifferentFromSelection(t,a)}else{if(!a)return 2;if(!i)return 8}return i.styleProperties.copyProperties(a),32},e.prototype.applyStyleToIp=function(e,t,n,r,i){if(t.get_contextId()!==cl.V)return 8;if(!us.n.get_instance().get_item(61))return 8;if(this.get_lockedRangeEditor().isParaStartOrEndInLockedRange(t))return this.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),8;if(1===n)return 32;var o=t,a=o.get_node(),s=i;if(!s)return 8;var l=this.getStyleToApplyFromStyleId(s,o.get_node());if(!l)return this.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.failedToFindStyle}),8;var c,u=this.get_styleReader().getStyleTargetType(l);if(1!==u&&2!==u)return 2;var g=this.get_insertionPointFormatting().getSelectionForIpFormatting(o);if(g){var p=Oa.SelectionManager.createMultiRangeOrGraphContext(g);c=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(p,e,2,!1,r,i)}else{var d=new as.GraphTransaction(7);d.setFromNode(a),this.get_styleEditor().setStyleOnIp(l,a),d.dispose(),c=32}var h=Jn.l.calcHashCode(s),_=h>>>16^65535&h;return r.dataValue1=_,c},e.prototype.queryStyleView=function(e,t,n,r,i){if(us.n.get_instance().get_item(61)){var o=this.get_viewActionHandler().performGenericViewLevelAction(e,t,n,r,i,null,0);if(2!==o)return o}return this.get_viewActionHandler().performGenericViewLevelAction(e,t,n,r,i,null,12)},e.prototype.applyStyleView=function(e,t,n,r,i){var o={};o[this.get_viewActionHandler().get_viewActionPerfMarkStart()]=6168,o[this.get_viewActionHandler().get_viewActionPerfMarkEnd()]=6169;var a=12;if(us.n.get_instance().get_item(61)){if(!t.view.get_isInteractiveView())return 2;var s=t.view.get_selectionManager(),l=s?s.get_selectionContextForActionDispatch():null;if(!l)return this.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),8;if(us.n.get_instance().get_item(11)&&this.get_contextSetEditor().contextContentsCheck(ka.ImageReader.isAnchoredImageContext,l))return this.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsAnchoredImage}),8;if(us.n.get_instance().get_item(14)&&this.get_lockedRangeEditor().isContextSetInLockedParagraphs(l))return this.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsLockedRange}),8;var c=this.get_styleReader().getStyleSetFromActivePage();if(i&&c){var u=c.getStyleById(i);if(u){var g=this.get_styleReader().getLinkedStyle(u,c),p=this.get_styleReader().getStyleTargetType(u);if(g){var d=s.get_selectionCollection().get_item(0);(d.get_containsSingleContext()&&d.get_firstContext().get_contextId()===cl.Z||2===d.get_length()&&d.get_firstContext().get_contextId()===cl.Z&&d.get_lastContext().get_contextId()===cl.A)&&(p=1,i=g.getValue(String,qc.o.paragraphStyleId))}1===p?a=0:3===p&&(a=14)}}}return this.get_viewActionHandler().performGenericViewLevelAction(e,t,n,r,i,o,a)},e.prototype.getStyleToApplyFromStyleId=function(e,t){if(!e||!t)return null;return cs.ParagraphReader.isParagraphNode(t)?this.get_styleReader().getStyleSetFromParagraphNode(t).getStyleById(e):null},e}();(0,o.l)(SC,"StyleActor",null,[]);var vC,bC=n(4709),TC=n(8895),AC=n(5391),IC=n(9514),wC=(0,o.y)("IColorMenu");!function(e){e[e.automatic=1]="automatic",e[e.clear=2]="clear",e[e.themeColors=3]="themeColors",e[e.standardColors=4]="standardColors",e[e.recentColors=5]="recentColors",e[e.moreColors=6]="moreColors"}(vC||(vC={})),(0,o.h)("ColorMenuControls",vC);var xC=n(8193),FC=function(){function e(e){this._menuName=null,this._menuPopulationXmlCache=null,this._menuPopulationPropertiesCache=null,this._isRecentSectionAdded=!1,this._colorMenuControls={},this._recentColors=new y.c(String),this._menuName=e}return e.prototype.invalidateMenu=function(){this._menuPopulationXmlCache=null,this._menuPopulationPropertiesCache=null},e.prototype.generateColorControlProperties=function(e,t){if(this._menuPopulationPropertiesCache)return this._menuPopulationPropertiesCache;if(!e)return null;var n=(0,O.m)(new ga.b,{Id:String.format("menu{0}Color",this._menuName),ExternalId:String.format("{0}Color",this._menuName)});if(n.MenuSectionList=[],Array.add(n.MenuSectionList,this.addAutomaticControl()),Array.add(n.MenuSectionList,this.addClearControl()),Array.add(n.MenuSectionList,this.addThemeColorsControl(e,t)),Array.add(n.MenuSectionList,this.addStandardColorsControl()),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordRecentFontColorSettings"),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordRecentAndMoreColorsSettings"),L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RecentFontColorIsEnabled")&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&!L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RecentAndMoreColorsIsEnabled")){var r=this.addRecentColorsControl();r&&Array.add(n.MenuSectionList,r)}return this._menuPopulationPropertiesCache=n,this._menuPopulationPropertiesCache},e.prototype.addRecentColor=function(e){var t=this._recentColors.indexOf(e);if(-1!==t){if(C.ULS.sendTraceTag(595345440,340,50,"Color selected from Recent Colors section. Menu: {0}",this._menuName),!t)return;this._recentColors.removeAt(t)}this.invalidateMenu(),this._recentColors.insert(0,e),C.ULS.sendTraceTag(51389399,340,50,"{0} is added at the start of recent color list. Menu: {1}",e,this._menuName),11===this._recentColors.get_count()&&(C.ULS.sendTraceTag(51389400,340,50,"Removing {0} from the recent color list. Menu: {1}",this._recentColors.get_item(10),this._menuName),this._recentColors.removeAt(10)),this.sendUpdateMenuRecentSectionReduxAction()},e.prototype.createColorControl=function(e,t){if(this._menuPopulationXmlCache)return this._menuPopulationXmlCache;var n=this.generateColorControlProperties(e,t);return this._menuPopulationXmlCache=Tu.gu(n),this._menuPopulationXmlCache},e.prototype.addMenuControl=function(e,t){vC[e]in this._colorMenuControls||(this._colorMenuControls[vC[e]]=t)},e.prototype.addToMenuCacheInvalidator=function(e,t){e.addCallback(o.i(this,this.invalidateMenu,"invalidateMenu"),t)},e.prototype.addAutomaticControl=function(){var e;if(!this.tryGetActionIdForControl(1,(0,p.m)((function(){return e}),(function(t){return e=t}))))return null;var t=(0,O.m)(new pa.x,{Id:String.format("{0}Color",this._menuName),ControlsId:String.format("{0}.Color.Menu.Controls",this._menuName),DisplayMode:"Menu16",ControlList:[]}),n=(0,O.m)(new da.k,{Command:e.toString(),LabelText:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_Automatic),Image16by16:L.AFrameworkApplication.get_imageClusterPath(),Image16by16Class:Lt.getImageClass("Automatic_16x16x32"),Id:"automatic",KeyTip:CommonUIStrings.l_AutomaticKeytip});return Array.add(t.ControlList,n),t},e.prototype.addClearControl=function(){var e;if(!this.tryGetActionIdForControl(2,(0,p.m)((function(){return e}),(function(t){return e=t}))))return null;var t=(0,O.m)(new pa.x,{Id:String.format("{0}Color",this._menuName),ControlsId:String.format("{0}.Color.Menu.Controls",this._menuName),DisplayMode:"Menu16",ControlList:[]}),n=(0,O.m)(new da.k,{Command:e.toString(),LabelText:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_BtnClearShading),Image16by16:L.AFrameworkApplication.get_imageClusterPath(),Image16by16Class:Lt.getImageClass("NoHighlight_16x16x32"),Id:"clear",KeyTip:CommonUIStrings.l_NoHighlightKeytip});return Array.add(t.ControlList,n),t},e.prototype.addThemeColorsControl=function(t,n){var r;if(!this.tryGetActionIdForControl(3,(0,p.m)((function(){return r}),(function(e){return r=e}))))return null;var i=(0,O.m)(new pa.x,{Id:"Colors",ControlsId:String.format("{0}.Color.Menu.Controls",this._menuName),ControlList:[]}),o=(0,O.m)(new pp.z,{Id:String.format("Theme{0}ColorPicker",this._menuName),ExternalId:String.format("Theme{0}ColorPicker",this._menuName),McuExternalId:String.format("Theme{0}ColorPickerMCU",this._menuName),McuLayout:!0,Command:r.toString(),Width:10});return o.Colors=e.getThemeColors(t,n),Array.add(i.ControlList,o),i},e.prototype.addStandardColorsControl=function(){var t;if(!this.tryGetActionIdForControl(4,(0,p.m)((function(){return t}),(function(e){return t=e}))))return null;var n=(0,O.m)(new pa.x,{Id:String.format("{0}Colors",this._menuName),ControlsId:String.format("{0}.Color.Menu.Controls",this._menuName),Title:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_MenuStandardColors),ControlList:[]}),r=(0,O.m)(new pp.z,{Id:String.format("Standard{0}ColorPicker",this._menuName),ExternalId:String.format("Standard{0}ColorPicker",this._menuName),Command:t.toString(),Width:10,Colors:new Array(0)});return r.Colors=e.getStandardColors(),Array.add(n.ControlList,r),n},e.prototype.addRecentColorsControl=function(){var e;if(!this.tryGetActionIdForControl(5,(0,p.m)((function(){return e}),(function(t){return e=t})))||!this._recentColors.get_count())return null;for(var t=(0,O.m)(new pa.x,{Id:String.format("{0}Colors",this._menuName),ControlsId:String.format("{0}.Color.Menu.Controls",this._menuName),Title:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_MenuRecentColors),ControlList:[]}),n=(0,O.m)(new pp.z,{Id:String.format("Recent{0}ColorPicker",this._menuName),ExternalId:String.format("Recent{0}ColorPicker",this._menuName),Command:e.toString(),Width:10,Colors:new Array(0)}),r=0;r<this._recentColors.get_count();r++){var i="#"+this._recentColors.get_item(r).substring(4,6)+this._recentColors.get_item(r).substring(2,4)+this._recentColors.get_item(r).substring(0,2);n.Colors.push((0,O.m)(new Og,{Color:this._recentColors.get_item(r),Alt:i,DisplayColor:i}))}return Array.add(t.ControlList,n),t},e.prototype.sendUpdateMenuRecentSectionReduxAction=function(){if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&!this._isRecentSectionAdded){C.ULS.sendTraceTag(51389402,340,50,"Sending a redux action to update the font menu");var e=(0,O.m)(new xC.p,{title:Box4Intl.Box4Strings.L_FontColor,sections:new Array(0)});e.sections.push(appChrome.api.menuSection(["AutomaticFontColor"],null)),e.sections.push(appChrome.api.menuSection(["ThemeFontColorPickerMCU"],null)),e.sections.push(appChrome.api.menuSection(["ThemeFontColorPicker"],null)),e.sections.push(appChrome.api.menuSection(["StandardFontColorPicker"],Box4Intl.Box4Strings.L_MenuStandardColors)),e.sections.push(appChrome.api.menuSection(["RecentFontColorPicker"],Box4Intl.Box4Strings.L_MenuRecentColors)),e.sections.push(appChrome.api.menuSection(["MoreFontColors"],null)),appChrome.api.dispatch(appChrome.actions.updateMenu("FontColor",e.sections,Box4Intl.Box4Strings.L_FontColor)),this._isRecentSectionAdded=!0}},e.prototype.tryGetActionIdForControl=function(e,t){t.val=0;var n=vC[e];return n in this._colorMenuControls&&(t.val=this._colorMenuControls[n],!0)},e.addThemeColors=function(t,n,r){for(var i=e.getThemeColors(t,r),o=0;o<i.length;o++){n.val+=String.format('\r\n\t\t\t\t<Color Color="{0}" Alt="{1}" DisplayColor="{2}"/>',i[o].Color,i[o].Alt,i[o].DisplayColor)}},e.getStandardColors=function(){var e=new Array(0);return e.push((0,O.m)(new Og,{Color:"0000C0",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorDarkRed),DisplayColor:"#C00000"})),e.push((0,O.m)(new Og,{Color:"0000FF",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorRed),DisplayColor:"#FF0000"})),e.push((0,O.m)(new Og,{Color:"00C0FF",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorOrange),DisplayColor:"#FFC000"})),e.push((0,O.m)(new Og,{Color:"00FFFF",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorYellow),DisplayColor:"#FFFF00"})),e.push((0,O.m)(new Og,{Color:"50D092",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorLightGreen),DisplayColor:"#92D050"})),e.push((0,O.m)(new Og,{Color:"50B000",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorDarkGreen),DisplayColor:"#00B050"})),e.push((0,O.m)(new Og,{Color:"F0B000",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorLightBlue),DisplayColor:"#00B0F0"})),e.push((0,O.m)(new Og,{Color:"C07000",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorBlue),DisplayColor:"#0070C0"})),e.push((0,O.m)(new Og,{Color:"602000",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorDarkBlue),DisplayColor:"#002060"})),e.push((0,O.m)(new Og,{Color:"A03070",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_FontColorPurple),DisplayColor:"#7030A0"})),e},e.getThemeColors=function(t,n){var r=t.get_properties().getValueWithDefault(Array,ks.j.themeColors,null),i=t.get_properties().getValue(String,ks.j.themeTooltips).split(" "),o=new Array(10);o[0]=Box4Intl.Box4Strings.l_ThemeLabel1,o[1]=Box4Intl.Box4Strings.l_ThemeLabel2,o[2]=Box4Intl.Box4Strings.l_ThemeLabel3,o[3]=Box4Intl.Box4Strings.l_ThemeLabel4,o[4]=Box4Intl.Box4Strings.l_ThemeLabel5,o[5]=Box4Intl.Box4Strings.l_ThemeLabel6,o[6]=Box4Intl.Box4Strings.l_ThemeLabel7,o[7]=Box4Intl.Box4Strings.l_ThemeLabel8,o[8]=Box4Intl.Box4Strings.l_ThemeLabel9,o[9]=Box4Intl.Box4Strings.l_ThemeLabel10;for(var a=new Array(0),s=0;s<6;s++)for(var l=0;l<10;l++){var c=10*s+l,u=r[c],g=c+1<<24,p=4278190080&u|(255&u)<<16|65280&u|(16711680&u)>>>16,d=n[i[l]],h=e.toolTipForModifiedColor(o,s,l,d,r[l]);a.push((0,O.m)(new Og,{Color:Jn.l.convertToHex(g,8),DisplayColor:"#"+Jn.l.convertToHex(p,6),Alt:Jn.l.xmlEncode(h)}))}return a},e.toolTipForModifiedColor=function(e,t,n,r,i){if(t){var o=255&i,a=(65280&i)>>>8,s=(16711680&i)>>>16,l=Math.min(Math.min(o,a),s),c=Math.max(Math.max(o,a),s),u=Math.floor((l+c)/2),g=t-1,p=void 0,d=void 0;if(u)if(255===u){p=!1,d=[242,217,191,166,128][g]}else if(u>204){p=!1,d=[230,191,128,64,26][g]}else if(u<51){p=!0,d=[26,64,128,191,230][g]}else{var h=[51,102,153];d=(p=g<h.length)?h[g]:[191,128][g-h.length]}else{p=!0,d=[128,166,191,217,242][g]}return d=255-d,String.format(p?Box4Intl.Box4Strings.l_ColorPickerTooltipTint:Box4Intl.Box4Strings.l_ColorPickerTooltipShade,r,e[n],Math.round(100*d/255))}return String.format(Box4Intl.Box4Strings.l_ColorPickerTooltipBase,r,e[n])},e}();(0,o.l)(FC,"ColorMenu",null,[wC]);var EC=function(e){function t(t,n){var r=e.call(this,!1,!1,!0)||this;return r._menuName=null,r._commandId=0,r._recentAndMoreColorsIsEnabled=null,r._menuName=t,r._commandId=n,r}return(0,S.t)(t,e),t.prototype.get_isRecentAndMoreColorsMenuSectionEnabled=function(){return null==this._recentAndMoreColorsIsEnabled&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordRecentAndMoreColorsSettings"),L.AFrameworkApplication.appSettingsManager?this._recentAndMoreColorsIsEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RecentAndMoreColorsIsEnabled"):this._recentAndMoreColorsIsEnabled=!1),null!=this._recentAndMoreColorsIsEnabled},t.prototype.showColorPickerDialog=function(e){void 0===e&&(e=0);var t={};t.initColor=Xy.o.convertToCSSValue(e),t.redLabel=Box4Intl.Box4Strings.L_FontColorRed,t.blueLabel=Box4Intl.Box4Strings.L_FontColorBlue,t.greenLabel=Box4Intl.Box4Strings.L_FontColorGreen,t.hexLabel=Box4Intl.Box4Strings.L_FontColorHex;var n={id:"ColorPickerDialog",bodyControls:t};this.initializeAndShow(Box4Intl.Box4Strings.L_MenuCustomColors,o.i(this,this.colorPickerHandler,"colorPickerHandler"),n),C.ULS.sendTraceTag(595345437,340,50,"Color picker dialog is opened. Menu: {0}",this._menuName)},t.prototype.colorPickerHandler=function(e,t){if(1===e){var n=t.selectedColorText;if(6!==n.length)return void C.ULS.sendTraceTag(595345436,340,10,"Color picker dialog did not return the color in expected format RRGGBB. Color returned: {0}, Menu: {1}",n,this._menuName);var r=n.substring(4,6)+n.substring(2,4)+n.substring(0,2);return this.get_isRecentAndMoreColorsMenuSectionEnabled()?L.AFrameworkApplication.get_theActionManager().processActionWithData(this._commandId,2,r):L.AFrameworkApplication.get_theActionManager().processActionWithData(ii.xj,2,r),void C.ULS.sendTraceTag(595345435,340,50,"Color selected from color picker dialog. Menu: {0}",this._menuName)}C.ULS.sendTraceTag(595345434,340,50,"Color picker dialog closed without selecting any color. Menu: {0}",this._menuName)},t}(ri.o);(0,o.l)(EC,"ColorPickerDialog",ri.o,[]);var PC=function(){function e(e){this._colorMenu=null,this._menuCacheInvalidator=null,this._menuCacheInvalidator=e}return e.prototype.get_fontColorMenu=function(){return this._colorMenu||(this._colorMenu=new FC(e.colorMenuName),this.initializeMenu(this._colorMenu)),this._colorMenu},e.prototype.initializeMenu=function(e){e.addMenuControl(1,ii.fc),e.addMenuControl(3,ii.EN),e.addMenuControl(4,ii.EN),e.addMenuControl(5,ii.xj),e.addMenuControl(6,ii.Fb),e.addToMenuCacheInvalidator(this._menuCacheInvalidator,1)},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager();e.addAction(ii.Fb,cl.n,o.i(this,this.openMoreColorsDialog,"openMoreColorsDialog")),e.addAction(ii.BE,cl.n,o.i(this,this.populateFontColor,"populateFontColor")),e.setActionFlags(ii.BE,1127)},e.prototype.openMoreColorsDialog=function(t,n,r,i,o){if(1===r)return 32;L.AFrameworkApplication.get_theActionManager().processActionWithData(ii.zG,2,o);var a=o,s=a&&a.fontColor>=0&&a.fontColor<=16777215?a.fontColor:0;return Br.App.get_activeAppFrame().dismissFloatie(),new EC(e.colorMenuName,ii.xj).showColorPickerDialog(s),32},e.prototype.populateFontColor=function(t,n,r,i,o){if(1===r)return 32;if(2===r&&!o)return 8;var a=e.get_pageReader().getPageContentNodeFromContext(n),s=o;if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var l=this.get_fontColorMenu().generateColorControlProperties(a,Br.App.colorMenuThemeStringsType);if(!l)return 8;s.MenuItems=l}var c=this.get_fontColorMenu().createColorControl(a,Br.App.colorMenuThemeStringsType);return c?(s.PopulationXML=c,C.ULS.sendTraceTag(595153826,340,50,"Font color dropdown menu is opened."),32):8},e.prototype.addRecentColor=function(e){this.get_fontColorMenu().addRecentColor(e)},e.getFontColorActorWithResolvedDependencies=function(){return new e(IC.d.get_instance())},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=e.getFontColorActorWithResolvedDependencies())},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e.colorMenuName="Font",e._singletonInstance=null,e}();(0,o.l)(PC,"FontColorActor",null,[]);var kC=n(6052),DC=function(){function e(){}return e.get_contextSetEditor=function(){return kf.ContextSetEditor.get_instance()},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_activityManager=function(){return ji.y.get_instance()},e.get_featureHelper=function(){return e._featureHelper||(e._featureHelper=se.w.get_instance().resolve($p.d))},e.get_externalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=se.w.get_instance().resolveFuture(gh.i))},e.get_paragraphIndentationReader=function(){return e._paragraphIndentationReader||(e._paragraphIndentationReader=se.w.get_instance().resolve(Yd.p))},e.applyFormattingToView=function(t,n,r,i,o){var a=!0;if(!n.view.get_isInteractiveView())return 2;var s=n.view,l=s.get_selectionManager();if(l&&l.get_selectionCollection().get_currentSelection()||(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),a=!1),us.n.get_instance().get_item(11)&&(e.get_contextSetEditor().contextContentsCheck(ka.ImageReader.isImageContext,s.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsImage}),a=!1),e.get_contextSetEditor().contextContentsCheck(ka.ImageReader.isAnchoredImageContext,s.get_selectionManager().get_selectionContextForActionDispatch())))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsAnchoredImage}),8;us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isContextSetInLockedParagraphs(s.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsLockedRange}),a=!1),e.get_contextSetEditor().contextContentsCheck(ka.ImageReader.isFloatingImageContext,s.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsFloatingImage}),a=!1),e.get_contextSetEditor().contextContentsCheck(gy.v,s.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsFloatingInk}),a=!1),e.get_contextSetEditor().contextContentsCheck(kC.isFloatingIFrameContext,s.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsFloatingIFrame}),a=!1),e.get_externalSelectionManagerFuture()&&e.get_externalSelectionManagerFuture().get_instance()&&e.get_externalSelectionManagerFuture().get_instance().isExternalSelectionContext(s.get_selectionManager().get_selectionContextForActionDispatch())&&(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.externalSelection}),a=!1),t!==ii.w||us.n.get_instance().get_item(54)||us.n.get_instance().get_item(84)||(a=!1);var c=null;if(l&&l.get_selectionCollection().get_currentSelection()&&(c=l.get_selectionCollection().get_currentSelection()),t===ii.ns&&c&&c.get_containsSingleContext()&&cs.ParagraphReader.isGraphNodeInsideList(c.get_firstContext().get_node())&&!mc.ListReader.get_isListMarkerEnabled()&&(a=!1),1===r||!a||!c)return a?32:8;var u,g=t===ii.LV||t===ii.vL||t===ii.Qv||t===ii.WB,p=t===ii.Fm||t===ii.iT||t===ii.tV,d=t===ii.UT||t===ii.Fw||t===ii.w,h=new as.GraphTransaction(15);h.setFromNode(c.get_firstContext().get_node());var _=new y.c(Number),m=!1;if(g||p||d)Xi.t.mark(7121),u=e.get_contextSetEditor().generalizeContextToOutlineElementContents(n.get_nextContext());else{if(Xi.t.mark(7119),!(u=Tf.generalizeSelectionToOEs(l.get_selectionCollection(),!0)))return e.get_activityManager().recordEvent(D_.f.failedProcessingStep,{Reason:M_.i.failedToGeneralizeToOEs}),h.dispose(),8;var f=t===ii.EO||t===ii.Mm;u.get_isContextSet()&&f&&(m=e.hasMultipleIndentationTypes(_,u))}return u.get_isContextSet()&&u.get_length()>1&&e.hasMultipleJustificationTypes(u)&&(o||(o={}),o.InContextSet=!0),L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(u,t,r,!0,i,o),m&&e.normalizeHybridGraphNodesLeftValues(_,u,o),h.dispose(),Br.App.get_activeAppFrame().updateCommandUI(),g||p||d?Xi.t.mark(7122):Xi.t.mark(7120),32},e.hasMultipleIndentationTypes=function(t,n){if(!n.get_isContextSet())return!1;for(var r=n,i=!1,o=!1,a=0;a<r.get_length();a++)if(r.getContext(a).get_isGraphNodeContext()){var s=r.getContext(a).get_node();if(s){var l=e.get_paragraphIndentationReader().getIndentInfo(s);2===l.specialIndentType?(i=!0,t.add(a)):1!==l.specialIndentType&&l.specialIndentType||(o=!0)}}return o&&i},e.normalizeHybridGraphNodesLeftValues=function(t,n,r){if(n.get_isContextSet())for(var i=n,o=r,a=0;a<t.get_count();a++){var s=i.getContext(t.get_item(a));if(s.get_isGraphNodeContext()){var l=s.get_node(),c=e.get_paragraphIndentationReader().getIndentInfo(l);2!==c.specialIndentType||jc.g(o.value,c.indentLeftValue)||l.setValue(ks.j.paraIndentLeft,c.indentLeftValue-c.specialIndentValueTwips)}}},e.shouldExecuteParagraphAction=function(t,n,r){var i=!0;return n.get_contextId()!==cl.K?i=!1:us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isParaStartOrEndInLockedRange(n)?(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),i=!1):e.get_externalSelectionManagerFuture()&&e.get_externalSelectionManagerFuture().get_instance()&&e.get_externalSelectionManagerFuture().get_instance().isExternalSelectionContext(n)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.externalSelection}),i=!1),r.val=i?32:8,1!==t&&i},e.shouldExecuteImageAction=function(e,t,n){var r=!0;return t.get_contextId()!==cl.H&&t.get_contextId()!==cl.I&&(r=!1),us.n.get_instance().get_item(11)&&(r=!1),n.val=r?32:8,1!==e&&r},e.hasMultipleJustificationTypes=function(e){if(!e.get_isContextSet())return!1;for(var t=e,n=1,r=0;r<t.get_length();r++){var i=t.getContext(r);if(i&&i.get_isGraphNodeContext()&&i.get_contextId()===cl.K){var o=i.get_node();if(o){var a=cs.ParagraphReader.getJustification(o);if(r){if(a!==n)return!0}else n=a}}}return!1},e._featureHelper=null,e._externalSelectionManagerFuture=null,e._paragraphIndentationReader=null,e}();(0,o.l)(DC,"FormattingActionHelper",null,[]);var MC=function(e){function t(t,n,r,i,o,a,s,l){var c=e.call(this)||this;return c._transaction=null,c._selectionReference=null,c._ViewOperationStage=0,c._isEnabled=!1,c._context=null,c._finishedStageProcessor=null,c._externalSelectionManagerFuture=null,c.init(t),c.setDebugName("FormattingViewOperation"),c.initAction(L.AFrameworkApplication.get_theActionManager(),n,i,o,a),c._context=r,c._ViewOperationStage=0,c._isEnabled=!0,c._finishedStageProcessor=s,c._externalSelectionManagerFuture=l,c}return(0,S.t)(t,e),t.prototype.get_externalSelectionManager=function(){return this._externalSelectionManagerFuture.get_instance()},t.prototype.run=function(){var e=this._context.view,n=null;(e.get_isInteractiveView()&&(n=e.get_selectionManager()),n)?!(r=n.get_selectionCollection().get_currentSelection())||us.n.get_instance().get_item(14)&&t.get_lockedRangeEditor().isSelectionInLockedRange(r)?(t.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsLockedRange}),this._isEnabled=!1):this.get_externalSelectionManager()&&this.get_externalSelectionManager().isExternalSelection(r)&&(t.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.externalSelection}),this._isEnabled=!1):(t.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelectionManager}),this._isEnabled=!1);if(1===this.get_behavior()||!this._isEnabled){if(this._isEnabled){var r=n.get_selectionCollection().get_currentSelection();1===n.get_selectionCollection().get_length()&&1===r.get_length()&&Pa.SelectionEditor.isTextRangeContext(r.get_firstContext())&&Xp.n(r.get_firstContext())&&(t.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsNonFormattableBlob}),this._isEnabled=!1)}var i=this._isEnabled;if(i&&this.get_actionId()===ii.So){r=n.get_selectionCollection().get_currentSelection();(i=vg.AT(_s.y,r,Ps.FormattingReader.containsFormatting))||t.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.doesNotContainParagraph})}this.set_response(i?32:8),this._ViewOperationStage=3}if(!this._ViewOperationStage){Xi.t.mark(5730),this._selectionReference=Df.a.get_instance().createReferenceToCurrentSelection();var o=n.get_selectionCollection().get_currentSelection().get_firstContext();this._transaction=new as.GraphTransaction(15),this._transaction.setFromNode(o.get_node()),this._ViewOperationStage=1}if(1===this._ViewOperationStage){if(this.get_childOperation()||this.setCurrentOperationFromContext(this._context.get_nextContext()),1===this.processCurrentOperation())return;this._ViewOperationStage=2}if(2===this._ViewOperationStage){if(this.get_actionId()===ii.So){var a=n.get_selectionContextForActionDispatch();if(a.get_isContextSet())for(var s=a,l=0;l<s.get_length();l++){o=s.getContext(l);this.trySpellCheckGraphNodeContext(o)}else o=a,this.trySpellCheckGraphNodeContext(o)}var c=this.get_actionId()===ii.iX||this.get_actionId()===ii.EU;this._selectionReference.restoreSelection(c);var u=(0,f.e)(bC.p,this.get_actionData());u&&!u.get_shouldCanvasTakeFocus()||Nt.FocusManager.instance().setScope(e.get_focusScopeId()),this._transaction.dispose(),this._transaction=null,Br.App.get_activeAppFrame().updateCommandUI(),Xi.t.mark(5731),this._ViewOperationStage=3,this.set_response(32)}3===this._ViewOperationStage&&(this._finishedStageProcessor.process(this.get_actionId(),this._context,this.get_behavior(),this.get_response()),this.setIsCompleted())},t.prototype.trySpellCheckGraphNodeContext=function(e){return!(!Pa.SelectionEditor.isInsertionPointOrTextRangeContext(e)&&!Pa.SelectionEditor.isEndOfParagraphContext(e))&&(Br.App.theProofingManager.spellCheck(e.get_node()),!0)},t.get_lockedRangeEditor=function(){return ls.k.get_instance()},t.get_activityManager=function(){return ji.y.get_instance()},t}(V_.g);(0,o.l)(MC,"FormattingViewOperation",V_.g,[]);var RC=n(8345),LC=function(){function e(e,t,n){this._eopFormattingStrategy=null,this._textRenderingStrategy=null,this._recentFontColorIsEnabled=null,this._recentAndMoreColorsIsEnabled=null,this._formattingViewOperationFinishedStageProcessor=null,this._formattingViewOperationFinishedStageProcessor=e,this._eopFormattingStrategy=t,this._textRenderingStrategy=n}return e.prototype.get_recentColors=function(){return e._recentColorsSectionHandler||(e._recentColorsSectionHandler=se.w.get_instance().tryResolve(Ug))},e.prototype.get_isRecentFontColorMenuSectionEnabled=function(){return null==this._recentFontColorIsEnabled&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordRecentFontColorSettings"),L.AFrameworkApplication.appSettingsManager?this._recentFontColorIsEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RecentFontColorIsEnabled"):this._recentFontColorIsEnabled=!1),this._recentFontColorIsEnabled},e.prototype.get_isRecentAndMoreColorsMenuSectionEnabled=function(){return null==this._recentAndMoreColorsIsEnabled&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordRecentAndMoreColorsSettings"),L.AFrameworkApplication.appSettingsManager?this._recentAndMoreColorsIsEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RecentAndMoreColorsIsEnabled"):this._recentAndMoreColorsIsEnabled=!1),null!=this._recentAndMoreColorsIsEnabled},e.prototype.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager(),n=o.i(this,this.queryNonParagraphFormatting,"queryNonParagraphFormatting");!!us.n.get_instance().get_item(105)&&(e.get_featureHelper()?e.get_featureHelper().isFeatureUIEnabled(56):L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Box4EndOfParagraphFormattingIsEnabled"))?(t.addAction(ii.NS,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.Us,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.nV,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.yf,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.EN,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.xj,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.fc,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.iX,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.pV,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.EU,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.aH,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.Vt,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.yL,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.Ob,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.CT,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.Pt,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.NZ,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.gT,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.So,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP")),t.addAction(ii.GA,cl.A,o.i(this,this.applyFormattingEOP,"applyFormattingEOP"))):Br.App.listBulletFormattingIsEnabled&&(t.addAction(ii.NS,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),t.addAction(ii.Us,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),t.addAction(ii.EN,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),t.addAction(ii.xj,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),t.addAction(ii.fc,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),mc.ListReader.get_isListMarkerEnabled()&&(t.addAction(ii.aH,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),t.addAction(ii.Vt,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),t.addAction(ii.CT,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),t.addAction(ii.Pt,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),t.addAction(ii.NZ,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),t.addAction(ii.gT,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP"))),(us.n.get_instance().get_item(94)||us.n.get_instance().get_item(96))&&(t.addAction(ii.nV,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP")),t.addAction(ii.yf,cl.A,o.i(this,this.applyListFormattingEOP,"applyListFormattingEOP"))));var r=Br.App.theContextSetActor.createDelegatedViewHandler((function(e){return Tf.generalizeSelectionToOEs(e.get_selectionCollection(),!0)}));us.n.get_instance().get_item(77)||t.addAction(ii.RP,cl.i,o.i(this,this.queryTableFormatting,"queryTableFormatting")),t.addAction(ii.zG,cl.n,o.i(this,this.queryCharacterFormatting,"queryCharacterFormatting")),t.addAction(ii.Iu,cl.n,o.i(this,this.queryCharacterFormatting,"queryCharacterFormatting")),t.addAction(ii.RP,cl.n,r),t.addAction(ii.RP,cl.K,o.i(this,this.queryParagraphFormatting,"queryParagraphFormatting")),t.addAction(ii.RP,cl.H,o.i(this,this.queryImageFormatting,"queryImageFormatting")),t.addAction(ii.RP,cl.k,n),t.setActionFlags(ii.zG,99|(us.n.get_instance().get_item(7)?0:1028)),t.setActionFlags(ii.Iu,1127),t.setActionFlags(ii.RP,97|(us.n.get_instance().get_item(7)?0:1028)),this.addDefaultFormattingActionHandlers(t,ii.NS),this.addDefaultFormattingActionHandlers(t,ii.Us),(us.n.get_instance().get_item(94)||us.n.get_instance().get_item(96))&&(this.addDefaultFormattingActionHandlers(t,ii.nV),this.addDefaultFormattingActionHandlers(t,ii.yf)),us.n.get_instance().get_item(48)&&(t.addAsyncAction(ii.fe,cl.n,o.i(this,this.applyCharacterFormattingViewAsync,"applyCharacterFormattingViewAsync")),t.setActionFlags(ii.fe,1092)),this.addDefaultFormattingActionHandlers(t,ii.EN),this.addDefaultFormattingActionHandlers(t,ii.xj),this.addDefaultFormattingActionHandlers(t,ii.fc),this.addDefaultFormattingActionHandlers(t,ii.iX),this.addDefaultFormattingActionHandlers(t,ii.pV),this.addDefaultFormattingActionHandlers(t,ii.wS),this.addDefaultFormattingActionHandlers(t,ii.oy),this.addDefaultFormattingActionHandlers(t,ii.fs),this.addDefaultFormattingActionHandlers(t,ii.ZM),this.addDefaultFormattingActionHandlers(t,ii.cM),this.addDefaultFormattingActionHandlers(t,ii.EU),this.addDefaultFormattingActionHandlers(t,ii.aH),t.setActionDataGenerator(ii.aH,o.i(this,this.generateActionArguments,"generateActionArguments")),this.addDefaultFormattingActionHandlers(t,ii.Vt),t.setActionDataGenerator(ii.Vt,o.i(this,this.generateActionArguments,"generateActionArguments")),this.addDefaultFormattingActionHandlers(t,ii.yL),t.setActionDataGenerator(ii.yL,o.i(this,this.generateActionArguments,"generateActionArguments")),this.addDefaultFormattingActionHandlers(t,ii.Ob),this.addDefaultFormattingActionHandlers(t,ii.CT),t.setActionDataGenerator(ii.CT,o.i(this,this.generateActionArguments,"generateActionArguments")),this.addDefaultFormattingActionHandlers(t,ii.Pt),t.setActionDataGenerator(ii.Pt,o.i(this,this.generateActionArguments,"generateActionArguments")),this.addDefaultFormattingActionHandlers(t,ii.NZ),t.setActionDataGenerator(ii.NZ,o.i(this,this.generateActionArguments,"generateActionArguments")),this.addDefaultFormattingActionHandlers(t,ii.gT),t.setActionDataGenerator(ii.gT,o.i(this,this.generateActionArguments,"generateActionArguments")),t.addActionWithFlags(ii.bS,cl.Z,o.i(this,this.applyCharacterFormatting,"applyCharacterFormatting"),96),t.addAsyncAction(ii.So,cl.n,o.i(this,this.applyCharacterFormattingViewAsync,"applyCharacterFormattingViewAsync")),t.addAction(ii.So,cl.K,o.i(this,this.applyParagraphFormatting,"applyParagraphFormatting")),t.addAction(ii.So,cl.Z,o.i(this,this.applyCharacterFormatting,"applyCharacterFormatting")),t.addAction(ii.So,cl.V,o.i(this,this.applyFormattingIp,"applyFormattingIp")),t.addAction(ii.GA,cl.n,o.i(this,this.clearFormattingView,"clearFormattingView")),t.addAction(ii.GA,cl.K,o.i(this,this.clearFormattingParagraph,"clearFormattingParagraph")),t.addAction(ii.GA,cl.Z,o.i(this,this.applyCharacterFormatting,"applyCharacterFormatting")),t.addAction(ii.GA,cl.V,o.i(this,this.applyFormattingIp,"applyFormattingIp")),t.setActionFlags(ii.GA,1028),t.addAction(ii.xv,cl.Z,o.i(this,this.clearFormattingParagraphLevel,"clearFormattingParagraphLevel")),t.addAction(ii.xv,cl.V,o.i(this,this.clearFormattingParagraphLevel,"clearFormattingParagraphLevel")),t.addAction(ii.kA,cl.n,o.i(this,this.clearFormattingMultiParagraphLevel,"clearFormattingMultiParagraphLevel")),t.addAction(ii.UB,cl.n,DC.applyFormattingToView),t.addAction(ii.UB,cl.K,o.i(this,this.applyParagraphFormatting,"applyParagraphFormatting")),t.addAction(ii.UB,cl.H,o.i(this,this.applyTextDirectionToImage,"applyTextDirectionToImage")),t.addAction(ii.UB,cl.k,o.i(this,this.applyTextDirectionToNonParagraph,"applyTextDirectionToNonParagraph")),t.setActionFlags(ii.UB,1028),t.addAction(ii.vV,cl.n,DC.applyFormattingToView),t.addAction(ii.vV,cl.K,o.i(this,this.applyParagraphFormatting,"applyParagraphFormatting")),t.addAction(ii.vV,cl.H,o.i(this,this.applyTextDirectionToImage,"applyTextDirectionToImage")),t.addAction(ii.vV,cl.k,o.i(this,this.applyTextDirectionToNonParagraph,"applyTextDirectionToNonParagraph")),t.setActionFlags(ii.vV,1028)},e.prototype.addDefaultFormattingActionHandlers=function(e,t){e.addAsyncAction(t,cl.n,o.i(this,this.applyCharacterFormattingViewAsync,"applyCharacterFormattingViewAsync")),e.addAction(t,cl.Z,o.i(this,this.applyCharacterFormatting,"applyCharacterFormatting")),e.addAction(t,cl.V,o.i(this,this.applyFormattingIp,"applyFormattingIp")),e.setActionFlags(t,1028)},e.prototype.generateActionArguments=function(){return new ju.b(2)},e.prototype.queryCharacterFormatting=function(e,t,n,r,i){var o=!0;if(t.get_contextId()!==cl.n&&(o=!1),1===n&&!o)return 8;var a=t,s=null,l=null;if(e===ii.Iu){var c=i;s=c.formatting,l=c.sourceData}else{if(!a.view||!a.view.get_isInteractiveView())return 2;var u=a.view;if(!u.get_selectionManager()||!u.get_selectionManager().get_selectionCollection().get_currentSelection())return 8;s=i,l=u.get_selectionManager().get_selectionCollection()}return this.computeConsistentFormattingFromSelection(l,s),32},e.prototype.computeConsistentFormattingFromSelection=function(e,t){for(var n=e.getEnumerator();n.$$mn();)for(var r=n.$$cu(),i=r.get_isTableCellSelection(),o=r.getEnumerator();o.$$mn();){var a=o.$$cu(),s=null;if(a.get_contextId()===cl.Z){if(Xp.n(a))continue;if(s=[],_=a.get_node().get_characterProperties()){for(var l=_.get_length()-1,c=a.get_cpBegin(),u=a.get_cpEnd(),g=!1,p=0;p<l;p++){var d=_.get_item(p).get_cp(),h=_.get_item(p+1).get_cp();if(_.get_item(p).get_formatting()&&Math.max(d,c)<Math.min(h,u))g=!0,Array.add(s,_.get_item(p).get_formatting());else if(g)break}_.get_item(l).get_formatting()&&a.get_cpEnd()>_.get_item(l).get_cp()&&Array.add(s,_.get_item(l).get_formatting())}}else if(a.get_contextId()===cl.K){var _;if(s=[],_=a.get_node().get_characterProperties())for(p=0;p<_.get_length();p++)_.get_item(p).get_formatting()&&Array.add(s,_.get_item(p).get_formatting())}else if(a.get_contextId()===cl.A){s=[Ps.FormattingReader.getFormattingObject(a)]}else if(a.get_contextId()===cl.V)return void this.queryCharacterFormattingIp(a,t);if(s&&s.length>0)for(var m=0,f=s;m<f.length;m++){var y=f[m];if(Ps.FormattingReader.updateConsistentFormatting(t,y.get_cache(),a,i))return}}},e.prototype.queryCharacterFormattingIp=function(t,n){var r=Ps.FormattingReader.getFormattingObject(t);if(r){var i,o=r.get_cache();i=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.bold,o.get_isBold()),n.bold=i?1:0,i=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.italic,o.get_isItalic()),n.italic=i?1:0,i=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.underline,o.get_isUnderline()),n.underline=i?1:0,n.underlineType=e.get_insertionPointFormatting().getPropertyWithDefault(Number,Kc.b.underlineType,o.get_underlineType()),i=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.superscript,o.get_isSuperscript()),n.superscript=i?1:0,i=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.subscript,o.get_isSubscript()),n.subscript=i?1:0,i=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.strikethrough,o.get_isStrikethrough()),n.strikethrough=i?1:0,i=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,qc.o.doubleStrikethrough,o.get_isDoubleStrikethrough()),n.doubleStrikethrough=i?1:0;var a=e.get_insertionPointFormatting().getPropertyWithDefault(String,Kc.b.font,o.get_fontFace());n.fontName=Hu.Font.getFontNameFromFace(a),n.themeFontIndex=o.get_themeFont(),n.fontSize=this._textRenderingStrategy.getFontSize(e.get_insertionPointFormatting().getPropertyWithDefault(Number,Kc.b.fontSize,o.get_fontSize()),t.get_node()),n.fontColor=e.get_insertionPointFormatting().getPropertyWithDefault(Number,Kc.b.fontColor,o.get_fontColor()),n.highlight=e.get_insertionPointFormatting().getPropertyWithDefault(Number,Kc.b.highlight,o.get_highlight())}},e.prototype.applyCharacterFormattingViewAsync=function(t,n,r,i,o,a){return new MC(t,n,r,i,o,a,this._formattingViewOperationFinishedStageProcessor,e.get_externalSelectionManagerFuture())},e.prototype.applyCharacterFormatting=function(t,n,r,i,o){var a=this,s=!0,l=n;if(n.get_contextId()!==cl.Z&&n.get_contextId()!==cl.V?s=!1:(us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isIpOrTextRangeContextInLockedRange(l)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),s=!1),e.get_externalSelectionManagerFuture()&&e.get_externalSelectionManagerFuture().get_instance()&&e.get_externalSelectionManagerFuture().get_instance().isExternalSelectionContext(l)&&(s=!1),s&&Pa.SelectionEditor.isTextRangeContext(n)&&Xp.n(l)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsNonFormattableBlob}),s=!1)),1===r||!s)return s?32:8;if(n.get_contextId()===cl.V)return 2;if(this._textRenderingStrategy.shouldTrimWhiteSpaceForApplyCharacterFormatting(t)){var c=Pa.SelectionEditor.trimWhitespaceFromTextRange(l);Pa.SelectionEditor.isInsertionPointContext(c)||(l=c)}var u="boolean"==typeof o&&o;return e.get_textFormattingHelper().applyCharacterFormattingOnTextRange(l,(function(e){a.setCharacterFormatting(e,t,o,l.get_cpEnd())}),u),this.isChangeCaseCommand(t)&&this.changeCaseHandler(l,t),32},e.prototype.setCharacterFormatting=function(t,n,r,i){var o,a=t.get_cache(),s=(0,f.e)(bC.p,r);switch(n){case ii.aH:2===(o=r).value&&(o.value=a.get_isBold()?0:1),e.get_formattingEditor().setBold(t,1===o.value);break;case ii.Vt:2===(o=r).value&&(o.value=a.get_isItalic()?0:1),e.get_formattingEditor().setItalic(t,1===o.value);break;case ii.yL:2===(o=r).value&&(o.value=a.get_isUnderline()?0:1),e.get_formattingEditor().setUnderline(t,1===o.value);break;case ii.Ob:e.get_formattingEditor().setUnderlineType(t,r);break;case ii.CT:2===(o=r).value&&(o.value=a.get_isSuperscript()?0:1),e.get_formattingEditor().setSuperscript(t,1===o.value);break;case ii.Pt:2===(o=r).value&&(o.value=a.get_isSubscript()?0:1),e.get_formattingEditor().setSubscript(t,1===o.value);break;case ii.NZ:2===(o=r).value&&(o.value=a.get_isStrikethrough()?0:1),e.get_formattingEditor().setStrikethrough(t,1===o.value);break;case ii.gT:2===(o=r).value&&(o.value=a.get_isDoubleStrikethrough()?0:1),e.get_formattingEditor().setDoubleStrikethrough(t,1===o.value);break;case ii.NS:if(s&&s.get_actionData()){var l=s.get_actionData(),c=void 0,u=-1;if("string"==typeof l)c=l;else{var g=l;c=g.fontName,u=g.themeFontIndex}c=c.substr(0,31),e.get_formattingEditor().setFontFace(t,c),us.n.get_instance().get_item(53)&&e.get_formattingEditor().setThemeFont(t,u)}break;case ii.EN:C.ULS.sendTraceTag(595153825,340,50,"Font color is selected from Standard/Theme colors."),e.get_formattingEditor().setFontColor(t,r,null);break;case ii.xj:if(e.get_formattingEditor().setFontColor(t,r,null),this.get_isRecentAndMoreColorsMenuSectionEnabled())this.get_recentColors().addRecentColor(r)||C.ULS.sendTraceTag(594899727,340,50,"Color selected from Recent Colors section. Menu: Font");else this.get_isRecentFontColorMenuSectionEnabled()&&PC.get_instance().addRecentColor(r);break;case ii.fc:e.get_formattingEditor().clearFontColor(t);break;case ii.iX:C.ULS.sendTraceTag(594899726,340,50,"Font background color is selected from Standard colors."),e.get_formattingEditor().setFontHighlight(t,r);break;case ii.pV:if(e.get_formattingEditor().setFontHighlight(t,r),this.get_isRecentAndMoreColorsMenuSectionEnabled())this.get_recentColors().addRecentColor(r)||C.ULS.sendTraceTag(594899724,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ii.EU:e.get_formattingEditor().clearFontHighlight(t);break;case ii.Us:e.get_formattingEditor().setFontSize(t,s.get_actionData());break;case ii.nV:e.get_formattingEditor().growFontSizeAndSet(t);break;case ii.yf:e.get_formattingEditor().shrinkFontSizeAndSet(t);break;case ii.So:var p=r,d=us.n.get_instance().get_item(20)?ks.j.noProof:zl.k.noProofBox4,h=p.getValueWithDefault(Boolean,d,!1);e.get_formattingEditor().setLanguageOnRange(t,p.getValue(Number,Kc.b.languageID),i,h);break;case ii.bS:e.get_formattingEditor().setFormattingFromIp(t);break;case ii.GA:e.get_formattingEditor().clearCharacterFormatting(t);break;case ii.oy:case ii.fs:case ii.wS:case ii.ZM:case ii.cM:a.get_hasCapitalization()&&2===a.get_capitalization()&&e.get_formattingEditor().clearCapitalization(t)}},e.prototype.clearFormattingParagraphLevel=function(t,n,r,i,o){var a=!0,s=n;if(n.get_contextId()!==cl.Z&&n.get_contextId()!==cl.V?a=!1:(us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isIpOrTextRangeContextInLockedRange(s)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),a=!1),a&&Pa.SelectionEditor.isTextRangeContext(n)&&Xp.n(s)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsNonFormattableBlob}),a=!1)),1===r||!a)return a?32:8;var l=s.get_node();return e.get_paragraphEditor().clearParagraphFormatting(l,!1),32},e.prototype.clearFormattingMultiParagraphLevel=function(t,n,r,i,o){var a={PerfMarkStart:6168,PerfMarkEnd:6169},s=n.view,l=null;s.get_isPageView()&&(l=s);var c=!0,u=null,g=32;if(l&&(u=l.get_selectionManager().get_selectionCollection().get_currentSelection())&&us.n.get_instance().get_item(14)&&(e.get_lockedRangeEditor().isSelectionInLockedRange(u)?(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsLockedRange}),g=8,c=!1):1===r&&(g=32,c=!1)),c&&us.n.get_instance().get_item(54)){var p=1===r?3:15,d=new as.GraphTransaction(p);d.setFromNode(s.get_root()),g=Rf(ii.xv,n,r,i,o,a,12),d.dispose()}return g},e.prototype.applyFormattingIp=function(t,n,r,i,o){var a=!0,s=32;if(n.get_contextId()!==cl.V?a=!1:us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isIpOrTextRangeContextInLockedRange(n)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),a=!1),1===r||!a)return a?32:8;var l=n,c=l.get_node(),u=null;if(us.n.get_instance().get_item(54)&&us.n.get_instance().get_item(61)&&t===ii.GA){e.get_listEditor().clearListFromParagraph(c),e.get_paragraphEditor().clearWordParagraphFormatting(c);var g=Tc.StyleReader.getStyleSetFromParagraphNode(c).getStyleById(Tc.StyleReader.get_wordStyleIdNormal());e.get_styleEditor().setStyleOnParagraphNode(g,c,!0)}if((t!==ii.GA||us.n.get_instance().get_item(49))&&(u=e.get_insertionPointFormatting().getSelectionForIpFormatting(l)),u){var p=Oa.SelectionManager.createMultiRangeOrGraphContext(u);s=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(p,t,2,!1,i,o)}else{var d=void 0,h=(0,f.e)(bC.p,o),_=Ps.FormattingReader.getFormattingObject(l).get_cache();switch(t){case ii.NS:if(h&&h.get_actionData()){var m=h.get_actionData(),y=void 0,S=-1;if("string"==typeof m)y=m;else{var v=m;y=v.fontName,S=v.themeFontIndex}e.get_insertionPointFormatting().setFontName(y),us.n.get_instance().get_item(53)&&e.get_insertionPointFormatting().setThemeFont(S)}break;case ii.EN:C.ULS.sendTraceTag(595153824,340,50,"Font color is selected from Standard/Theme colors."),e.get_insertionPointFormatting().setFontColor(o);break;case ii.xj:if(e.get_insertionPointFormatting().setFontColor(o),this.get_isRecentAndMoreColorsMenuSectionEnabled())this.get_recentColors().addRecentColor(o)||C.ULS.sendTraceTag(594899723,340,50,"Color selected from Recent Colors section. Menu: Font");else this.get_isRecentFontColorMenuSectionEnabled()&&PC.get_instance().addRecentColor(o);break;case ii.fc:e.get_insertionPointFormatting().clearFontColor();break;case ii.iX:C.ULS.sendTraceTag(594899722,340,50,"Font background color is selected from Standard colors."),e.get_insertionPointFormatting().setFontHighlight(o);break;case ii.pV:if(e.get_insertionPointFormatting().setFontHighlight(o),this.get_isRecentAndMoreColorsMenuSectionEnabled())this.get_recentColors().addRecentColor(o)||C.ULS.sendTraceTag(594899720,340,50,"Color selected from Recent Colors section. Menu: Highlighter");break;case ii.EU:e.get_insertionPointFormatting().clearFontHighlight();break;case ii.Us:h.get_actionData();e.get_insertionPointFormatting().setFontSize(h.get_actionData());break;case ii.nV:d=e.get_insertionPointFormatting().getPropertyWithDefault(Number,Kc.b.fontSize,_.get_fontSize()),e.get_insertionPointFormatting().setFontSize(e.get_formattingEditor().growFontSize(d));break;case ii.yf:d=e.get_insertionPointFormatting().getPropertyWithDefault(Number,Kc.b.fontSize,_.get_fontSize()),e.get_insertionPointFormatting().setFontSize(e.get_formattingEditor().shrinkFontSize(d));break;case ii.aH:var b=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.bold,_.get_isBold());e.get_insertionPointFormatting().setBold(!b);break;case ii.Vt:var T=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.italic,_.get_isItalic());e.get_insertionPointFormatting().setItalic(!T);break;case ii.yL:var A=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.underline,_.get_isUnderline());e.get_insertionPointFormatting().setUnderline(!A);break;case ii.Ob:e.get_insertionPointFormatting().setUnderlineType(o);break;case ii.CT:var I=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.superscript,_.get_isSuperscript());e.get_insertionPointFormatting().setSuperscript(!I);break;case ii.Pt:var w=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.subscript,_.get_isSubscript());e.get_insertionPointFormatting().setSubscript(!w);break;case ii.NZ:var x=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,Kc.b.strikethrough,_.get_isStrikethrough());e.get_insertionPointFormatting().setStrikethrough(!x);break;case ii.gT:var F=e.get_insertionPointFormatting().getPropertyWithDefault(Boolean,qc.o.doubleStrikethrough,_.get_isDoubleStrikethrough());e.get_insertionPointFormatting().setDoubleStrikethrough(!F);break;case ii.GA:e.get_insertionPointFormatting().resetFormatting(),us.n.get_instance().get_item(54)||(e.get_listEditor().clearListFromParagraph(c),e.get_paragraphEditor().clearParagraphFormatting(c,!0),us.n.get_instance().get_item(71)&&e.get_styleEditor().clearStyleOnParagraphNode(c));break;case ii.So:var E=o;E.hasProperty(Kc.b.languageID)&&e.get_insertionPointFormatting().setLanguage(E.getValue(Number,Kc.b.languageID));var P=us.n.get_instance().get_item(20)?ks.j.noProof:zl.k.noProofBox4;if(E.hasProperty(P)){var k=E.getValue(Boolean,P);e.get_insertionPointFormatting().setNoProof(k)}}}return Br.App.get_activeAppFrame().updateCommandUI(),s},e.prototype.removeRTLFormattingProperty=function(e,t){ii.GA===t&&hs.OutlineElementNavigator.getContainingOutlineElementNode(e).get_properties().removeProperty(Kc.b.outlineElementRTL)},e.prototype.applyFormattingEOP=function(t,n,r,i,o){var a=e.get_activityManager().startActivity(ii.oc),s=!0,l=!1;if(n.get_contextId()!==cl.A&&(s=!1),1===r||!s)return s?32:8;var c=n,u=c.get_node(),g=Da.GraphIterator.createFromNode(c.get_node());g.tryToRootAtOutlineAncestor();var p=g.goToFirstSiblingByRole(4);if((l=!!p&&e.get_listReader().isListNode(p))&&!Br.App.listBulletFormattingIsEnabled)return 8;var d=!cs.ParagraphReader.textLength(u);if(a.get_properties().set_item("Action",t.toString()),a.get_properties().set_item("ListContext",l.toString()),a.get_properties().set_item("IsEmptyParagraph",d.toString()),C.ULS.sendTraceTag(8700679,324,50,"Apply format to EOP: Action - {0}, InList - {1}, IsEmpty - {2}.",t,l,d),this._eopFormattingStrategy.supportsListFormattingProperties(l))this.updateListFormattingProperties(t,o,p);else{var h=u,_=h.get_characterProperties().get_last();this.removeRTLFormattingProperty(h,t);var m=_.get_formatting(),f=e.get_characterPropertiesEditor().ensureEndOfParagraphFormatting(h);if(this._eopFormattingStrategy.isOnlySetEopFormatSupported(m)){var y=f.cloneUnderDifferentChp(f.get_containingProperties());this.setCharacterFormatting(f,t,o,_.get_cp()),e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeEditor().setFormattingTrackChangeOnParagraph(h,_,c.get_cpBegin(),c.get_cpEnd(),y,f,e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled())}}return a.end(),32},e.prototype.updateListFormattingProperties=function(t,n,r){var i=!1,o=(0,f.e)(bC.p,n);switch(t){case ii.EN:case ii.xj:e.get_listFormattingEditor().setFontColor(r,n);break;case ii.Us:e.get_listFormattingEditor().setFontSize(r,o.get_actionData());break;case ii.fc:e.get_listFormattingEditor().clearFontColor(r);break;case ii.nV:e.get_listFormattingEditor().growFontSize(r);break;case ii.yf:e.get_listFormattingEditor().shrinkFontSize(r);break;case ii.NS:e.get_listFormattingEditor().setFontFaceAndTheme(r,o.get_actionData());break;case ii.aH:i=this.resolveTriStateValueListNode(n,Kc.b.bold,r),e.get_listFormattingEditor().setBold(r,i);break;case ii.Vt:i=this.resolveTriStateValueListNode(n,Kc.b.italic,r),e.get_listFormattingEditor().setItalic(r,i);break;case ii.Pt:i=this.resolveTriStateValueListNode(n,Kc.b.subscript,r),e.get_listFormattingEditor().setSubscript(r,i);break;case ii.CT:i=this.resolveTriStateValueListNode(n,Kc.b.superscript,r),e.get_listFormattingEditor().setSuperscript(r,i);break;case ii.NZ:i=this.resolveTriStateValueListNode(n,Kc.b.strikethrough,r),e.get_listFormattingEditor().setStrikethrough(r,i);break;case ii.gT:i=this.resolveTriStateValueListNode(n,qc.o.doubleStrikethrough,r),e.get_listFormattingEditor().setDoubleStrikethrough(r,i)}},e.prototype.resolveTriStateValueListNode=function(e,t,n){var r=e;return 2===r.value&&(r.value=n?n.getValueWithDefault(Boolean,t,!1)?0:1:0),1===r.value},e.prototype.applyListFormattingEOP=function(t,n,r,i,o){var a=!0,s=n,l=Da.GraphIterator.createFromNode(s.get_node());l.tryToRootAtOutlineAncestor(),n.get_contextId()===cl.A&&l.goToFirstSiblingByRole(4)||(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.listNotApplied}),a=!1);var c=l.get_currentNode();return e.get_listReader().isListNode(c)?1!==r&&a?(this.updateListFormattingProperties(t,o,c),32):a?32:8:8},e.prototype.queryParagraphFormatting=function(t,n,r,i,o){var a=!0;if(n.get_contextId()!==cl.K&&(a=!1),1===r&&!a)return 8;var s=o,l=n.get_node();if(-1!==s.layoutAlignmentInParent?s.layoutAlignmentInParent!==cs.ParagraphReader.getJustification(l)&&(s.layoutAlignmentInParent=0):s.layoutAlignmentInParent=cs.ParagraphReader.getJustification(l),us.n.get_instance().get_item(54)&&us.n.get_instance().get_item(59)){var c=e.get_paragraphIndentationReader().getIndentInfo(l);s.indentInfo?(!s.hasMultipleIndentTypes&&this.hasMultipleParagraphIndentTypes(s.indentInfo,c)&&2===s.indentInfo.specialIndentType&&(s.indentInfo.specialIndentType=0),s.indentInfo.indentLeftUnit===c.indentLeftUnit&&jc.g(s.indentInfo.indentLeftValue,c.indentLeftValue)||(s.indentInfo.indentLeftValue=Number.MAX_VALUE),s.indentInfo.indentRightUnit===c.indentRightUnit&&jc.g(s.indentInfo.indentRightValue,c.indentRightValue)||(s.indentInfo.indentRightValue=Number.MAX_VALUE)):s.indentInfo=c;var u=e.get_contextSetEditor().attemptToGeneralizeToOutlineNodeContext(n.get_nextContext());if(null!=u){var g=u.get_node();if(null!=g){var p=Dh.d.get_instance().navigateToWordSectionNode(g);if(null!=p){var d=e.get_wordSectionReader().getPageWidth(p)-(e.get_wordSectionReader().getMarginLeft(p)+e.get_wordSectionReader().getMarginRight(p)+Br.App.wordPageBufferInTwips);c.indentRightMax=d-c.indentLeftValue,c.indentLeftMax=d-c.indentRightValue,s.indentInfo.indentLeftMax=Math.min(s.indentInfo.indentLeftMax,c.indentLeftMax),s.indentInfo.indentRightMax=Math.min(s.indentInfo.indentRightMax,c.indentRightMax)}}}}if(us.n.get_instance().get_item(54)&&us.n.get_instance().get_item(59)||us.n.get_instance().get_item(84)){var h=e.get_lineSpacingHelper().getParagraphSpacing(l);s.spacing?(s.spacing.beforeSpacing=e.adjustCumulativeSpacingProperty(h.beforeSpacing,s.spacing.beforeSpacing),s.spacing.afterSpacing=e.adjustCumulativeSpacingProperty(h.afterSpacing,s.spacing.afterSpacing),s.spacing.lineSpacing.unit===h.lineSpacing.unit&&jc.g(s.spacing.lineSpacing.value,h.lineSpacing.value)||(s.spacing.lineSpacing.unit=0,s.spacing.lineSpacing.value=0)):s.spacing=h}var _=new Da.GraphIterator;_.set(l),_.tryToRootAtAncestorOfType(11);var m=_.returnToAncestorOfType(11);m&&(s.isRtl=Ls.OutlineElementReader.isRtlForView(m));var f=e.get_listReader().getListInfo(_),y=16;return null!=f&&(y=f.get_listType()),s.listType=e.getCumulativeListType(s.listType,y),s.listInfo=16===s.listType?null:f,32},e.prototype.hasMultipleParagraphIndentTypes=function(e,t){return this.areIndentationsDifferent(e,t)||this.areIndentationsDifferent(t,e)},e.prototype.areIndentationsDifferent=function(e,t){return(1===e.specialIndentType||!e.specialIndentType)&&2===t.specialIndentType},e.prototype.queryNonParagraphFormatting=function(e,t,n,r,i){var o=i,a=t.get_node(),s=hs.OutlineElementNavigator.getContainingOutlineElementNode(a);return o.isRtl=Ls.OutlineElementReader.isRtlForView(s),32},e.prototype.applyTextDirectionToNonParagraph=function(t,n,r,i,o){var a;if(t===ii.vV)a=!0;else{if(t!==ii.UB)return 2;a=!1}if(a&&this.logRtlUsage(n),1===r)return 32;var s=n.get_node(),l=hs.OutlineElementNavigator.getContainingOutlineElementNode(s);return e.get_outlineElementEditor().setRtl(l,a),32},e.prototype.queryImageFormatting=function(e,t,n,r,i){var o=i,a=t.get_node(),s=hs.OutlineElementNavigator.getContainingOutlineElementNode(a);return o.isRtl=Ls.OutlineElementReader.isRtl(s),o.layoutAlignmentInParent=ka.ImageReader.getJustification(a),32},e.prototype.queryTableFormatting=function(e,t,n,r,i){var o=i,a=t.get_node(),s=hs.OutlineElementNavigator.getContainingOutlineElementNode(a);return o.isRtl=Ls.OutlineElementReader.isRtl(s),o.layoutAlignmentInParent=dc.TableReader.getJustification(a),-1!==o.layoutAlignmentInParent&&o.layoutAlignmentInParent||(o.layoutAlignmentInParent=o.isRtl?3:1),32},e.prototype.applyTextDirectionToImage=function(t,n,r,i,o){var a;if(!DC.shouldExecuteImageAction(r,n,(0,p.m)((function(){return a}),(function(e){return a=e}))))return a;var s=n.get_node();switch(t){case ii.UB:case ii.vV:var l=hs.OutlineElementNavigator.getContainingOutlineElementNode(s),c=!0;t===ii.UB&&(c=!1),e.get_outlineElementEditor().setRtl(l,c),c&&this.logRtlUsage(n)}return 32},e.prototype.applyParagraphFormatting=function(t,n,r,i,o){var a;if(!DC.shouldExecuteParagraphAction(r,n,(0,p.m)((function(){return a}),(function(e){return a=e}))))return a;var s=n,l=s.get_node();switch(t){case ii.UB:e.get_outlineElementEditor().setTextDir(l,!1);break;case ii.vV:this.logRtlUsage(n),e.get_outlineElementEditor().setTextDir(l,!0);break;case ii.So:32===(a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(s.get_nextContext(),t,r,!0,i,o))&&cs.ParagraphReader.isParagraphContext(s)&&e.get_proofingManager()&&e.get_proofingManager().spellCheck(l)}return 32},e.prototype.clearFormattingView=function(t,n,r,i,o){var a={PerfMarkStart:6168,PerfMarkEnd:6169},s=n.view,l=1===r?3:15,c=new as.GraphTransaction(l);c.setFromNode(s.get_root());var u=Rf(t,n,r,i,o,a,0),g=null;s.get_isPageView()&&(g=s);var p=!0,d=null;return g&&(d=g.get_selectionManager().get_selectionCollection().get_currentSelection())&&us.n.get_instance().get_item(14)&&(e.get_lockedRangeEditor().isSelectionInLockedRange(d)?(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsLockedRange}),u=8,p=!1):1===r&&(u=32,p=!1)),p&&this.isSuperParagraphSelection(d)&&(u=us.n.get_instance().get_item(54)?Rf(ii.xv,n,r,i,o,a,12):Rf(t,n,r,i,o,a,12)),c.dispose(),u},e.prototype.clearFormattingParagraph=function(t,n,r,i,o){var a=!0;if(n.get_contextId()!==cl.K&&n.get_contextId()!==cl.V?a=!1:us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isParaStartOrEndInLockedRange(n)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),a=!1),1===r||!a)return a?32:8;var s=n.get_node(),l=new as.GraphTransaction(15);return l.setFromNode(s),e.get_listEditor().clearListFromParagraph(s),e.get_paragraphEditor().clearParagraphFormatting(s,!0),e.get_styleEditor().clearStyleOnParagraphNode(s),l.dispose(),2},e.prototype.isSuperParagraphSelection=function(e){return!!e&&(!Pa.SelectionEditor.isInsertionPointSelection(e)&&!(1===e.get_length()&&Pa.SelectionEditor.isTextRangeContext(e.get_firstContext())&&!Pa.SelectionEditor.isEntireParagraphTextContext(e.get_firstContext())))},e.prototype.logRtlUsage=function(t){e._rtlUsageLoggingDictionary.containsKey(t.get_contextId())||(C.ULS.sendTraceTag(42276747,340,50,"RTL Usage : {0}",t.get_contextId()),e._rtlUsageLoggingDictionary.set_item(t.get_contextId(),!0))},e.prototype.isChangeCaseCommand=function(e){return e===ii.wS||e===ii.oy||e===ii.fs||e===ii.ZM||e===ii.cM},e.prototype.changeCaseHandler=function(t,n){var r=t.get_node(),i=r.get_characterData().substr(t.get_cpBegin(),t.get_cpEnd()-t.get_cpBegin()),o=e.textChangeCase(i,n);r.get_characterData();return r.set_characterData(r.get_characterData().substr(0,t.get_cpBegin())+o+r.get_characterData().substr(t.get_cpEnd())),32},e.get_formattingEditor=function(){return e._formattingEditor||(e._formattingEditor=se.w.get_instance().resolve(xs.z))},e.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=se.w.get_instance().resolve(Va.x))},e.get_paragraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=se.w.get_instance().resolve(gc.g))},e.get_lineSpacingHelper=function(){return e._lineSpacingHelper||(e._lineSpacingHelper=se.w.get_instance().resolve(TC.r))},e.get_styleEditor=function(){return e._styleEditor||(e._styleEditor=se.w.get_instance().resolve(uc.e))},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=se.w.get_instance().resolve(Es.p))},e.get_insertionPointFormatting=function(){return e._insertionPointFormatting||(e._insertionPointFormatting=se.w.get_instance().resolve(ah.c))},e.get_listFormattingEditor=function(){return e._listFormattingEditor||(e._listFormattingEditor=se.w.get_instance().resolve(AC.a))},e.get_paragraphIndentationReader=function(){return e._paragraphIndentationReader||(e._paragraphIndentationReader=se.w.get_instance().resolve(Yd.p))},e.get_externalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=se.w.get_instance().resolveFuture(gh.i))},e.get_contextSetEditor=function(){return kf.ContextSetEditor.get_instance()},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_activityManager=function(){return ji.y.get_instance()},e.get_featureHelper=function(){return e._featureHelper||(e._featureHelper=se.w.get_instance().tryResolve($p.d))},e.get_proofingManager=function(){return Br.App.theProofingManager},e.get_trackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},e.get_trackChangeEditor=function(){return e._trackChangeEditor||(e._trackChangeEditor=se.w.get_instance().resolve(cc.x).get_instance())},e.get_textFormattingHelper=function(){return e._textFormattingHelper||(e._textFormattingHelper=se.w.get_instance().resolve(RC.d))},e.get_listReader=function(){return e._listReader||(e._listReader=se.w.get_instance().resolve(ts.c))},e.get_listEditor=function(){return e._listEditor||(e._listEditor=se.w.get_instance().resolve(rs.v))},e.get_wordSectionReader=function(){return Mh.p.get_instance()},e.getCumulativeListType=function(e,t){return 42===e?t:e!==t||16===e?16:e},e.adjustCumulativeSpacingProperty=function(e,t){return e.isContextualSpacing||(t.isContextualSpacing?t=e:t.unit===e.unit&&jc.g(t.value,e.value)||(t.value=-1)),t},e.textChangeCase=function(t,n){switch(n){case ii.oy:return t.toLowerCase();case ii.fs:return t.toUpperCase();case ii.wS:case ii.ZM:return e.changeTitleCase(t,n===ii.ZM);case ii.cM:return e.toggleTextCase(t);default:return t}},e.toggleTextCase=function(e){for(var t="",n=0;n<e.length;n++)e.charAt(n)===e.charAt(n).toUpperCase()?t+=e.charAt(n).toLowerCase():t+=e.charAt(n).toUpperCase();return t},e.changeTitleCase=function(t,n){for(var r,i,o=!0,a=t.length,s=0,l=e.isSubSetenceAllCaps(t,s,a);a>0;){r=!1,i=!1;var c,u,g=a,p=0;for(p=0;g>0&&e.checksIfWhiteSpacePunctuationOrNonAlphaNumericChar(t.charAt(s+p));p++,g--)i=e.isSentenceBreak(t.charAt(s+p));for(c=p;g>0&&(!(r=e.isSentenceBreak(t.charAt(s+p)))&&" "!==t.charAt(s+p)&&"/"!==t.charAt(s+p));p++,g--);if((u=p-c)<=0)break;s+=c;var d=t.substr(s,u),h=d===d.toUpperCase();!l&&h||(t=o||i||n?t.substr(0,s)+t.charAt(s).toUpperCase()+t.substr(s+1,u-1).toLowerCase()+t.substr(s+u):t.substr(0,s)+t.substr(s,u).toLowerCase()+t.substr(s+u)),a-=u+c,s+=u,o=r,r&&(s++,a--,l=e.isSubSetenceAllCaps(t,s,a))}return t},e.isSubSetenceAllCaps=function(t,n,r){for(;r>0&&!e.isSentenceBreak(t.charAt(n));){if(t.charAt(n)!==t.charAt(n).toUpperCase())return!1;n++,r--}return!0},e.isSentenceBreak=function(e){return"."===e||"!"===e||"?"===e},e.checksIfWhiteSpacePunctuationOrNonAlphaNumericChar=function(e){return-1==="0123456789".indexOf(e)&&e.toUpperCase()===e.toLowerCase()},e._formattingEditor=null,e._outlineElementEditor=null,e._rtlUsageLoggingDictionary=new g.w(Boolean),e._lineSpacingHelper=null,e._characterPropertiesEditor=null,e._paragraphEditor=null,e._styleEditor=null,e._insertionPointFormatting=null,e._listFormattingEditor=null,e._paragraphIndentationReader=null,e._externalSelectionManagerFuture=null,e._featureHelper=null,e._trackChangeManager=null,e._trackChangeEditor=null,e._textFormattingHelper=null,e._recentColorsSectionHandler=null,e._listReader=null,e._listEditor=null,e}();(0,o.l)(LC,"TextFormattingActor",null,[]);var NC=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.setFormattingFromIp=function(e,t){void 0===t&&(t=!1),this.get_actionManager().processActionAgainstContext(e,ii.bS,2,!0,null,t)},e.prototype.setLanguage=function(e){this.get_actionManager().processActionWithData(ii.So,2,e)},e}();(0,o.l)(NC,"TextFormattingCommands",null,[gu.n]);var BC=(0,o.y)("IViewActionHandler"),OC=function(){function e(){}return e.prototype.get_viewActionPerfMarkStart=function(){return"PerfMarkStart"},e.prototype.get_viewActionPerfMarkEnd=function(){return"PerfMarkEnd"},e.prototype.get_viewActionCollapseIp=function(){return"CollapseIp"},e.prototype.performGenericViewLevelAction=function(e,t,n,r,i,o,a){return Rf(e,t,n,r,i,o,a)},e.prototype.performGenericViewLevelActionAgainstOEs=function(e,t,n,r,i,o){return Lf(e,t,n,r,i,o)},e.get_instance=function(){return e._instance||(e._instance=new e),e._instance},e._instance=null,e}();(0,o.l)(OC,"ViewActionHandlerProxy",null,[BC]);var UC=n(3400),HC=function(e){function t(){var t=e.call(this,1,3)||this;return t.testHook=!1,t}return(0,S.t)(t,e),t.prototype.disposeFloatie=function(){var e=(0,f.e)(Sys.IDisposable,this._floatie);e&&e.dispose(),this._floatie=null},t.prototype.showFloatieAt=function(e,t,n){var r=n?this.rtlReferencePoint:this.ltrReferencePoint;this.ensureFloatieConstructedIfAvailable(),this._floatie&&(this._floatie.get_isVisible()&&this._floatie.dismissFloatie(),this.testHook||(0,f.e)(fg.z,this._floatie).pollForStateAndUpdate(),this._floatie.showFloatieAt(e,r,t,!0))},t.prototype.ensureFloatieConstructedIfAvailable=function(){return this.get_floatieFactory()&&!this._floatie&&(this._floatie=this._floatieFactory()),this._floatie},t.prototype.expandFloatie=function(){if(this._floatie&&this._floatie.get_isVisible()){var e=(0,f.e)(Pi.Control,this._floatie.get_controls()["PasteFloatie.FlyoutAnchor"]);e.behavior.doDefaultAction(e.getDisplayedComponentElement(),1,null)}},t}(UC.r);(0,o.l)(HC,"PasteFloatieManager",UC.r,[]);var GC=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.moveCursor=function(e){var t;if(4===e)t=ii.yt;else if(2===e)t=ii.vX;else if(1===e)t=ii.qF;else{if(3!==e)return;t=ii.iU}this._actionManager.processAction(t,2)},e.prototype.expandSelection=function(){this._actionManager.processAction(ii.vo,2)},e}();(0,o.l)(GC,"SelectionCommands",null,[ih.i]);var VC=n(3174),WC=function(){function e(){}return e.prototype.createIpSelection=function(e,t){return ss.SelectionFactory.createIpSelection(e,t)},e.prototype.extendSelection=function(e,t){return ss.SelectionFactory.extendSelection(e,t)},e.prototype.createSelectionFromContext=function(e,t){return void 0===t&&(t=!0),ss.SelectionFactory.createSelectionFromContext(e,t)},e.prototype.createTextRangeOrIpSelection=function(e,t,n){return ss.SelectionFactory.createTextRangeOrIpSelection(e,t,n)},e.prototype.createSelectionFromNode=function(e){return ss.SelectionFactory.createSelectionFromNode(e)},e.prototype.tryExtendTableCellSelection=function(e,t,n,r){return void 0===r&&(r=!1),ss.SelectionFactory.tryExtendTableCellSelection(e,t,n,r)},e}();(0,o.l)(WC,"SelectionFactoryProxy",null,[Ad]);var zC=n(9469),KC=n(6776),qC=n(1489),jC=function(e){function t(t,n,r,i,o,a,s,l){void 0===s&&(s=null),void 0===l&&(l=null);var c=e.call(this,t,a,s,l)||this;return c._internalLinkManager=null,c._paragraphEditor=null,c._formatting=null,c._formattingInvalidated=!1,c._pastingIntoList=!1,c._nestedListCount=0,c._tableSteward=null,c.indentationEditor=null,c.listEditor=null,c.listReader=null,c.box4PasteStewardBridge=null,c._followDestinationFormattingPasteIsEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FollowDestinationFormattingPasteIsEnabled"),c._tablesToDelist=new y.c(Wf.k),Vl.x(8128527,307,Ls.OutlineElementReader.isOutlineElement(t)),c._tableSteward=n,c._tableSteward.bindToOwnerSteward(c),c.indentationEditor=r,c.listEditor=i,c.listReader=o,c.box4PasteStewardBridge=l,c._pastingIntoList=mc.ListReader.isListOutlineElement(c._iterator),c}return(0,S.t)(t,e),t.prototype.get_internalLinkManager=function(){return this._internalLinkManager||(this._internalLinkManager=se.w.get_instance().tryResolve(qs.v))},t.prototype.get_paragraphEditor=function(){return this._paragraphEditor||(this._paragraphEditor=se.w.get_instance().resolve(gc.g))},t.prototype.get_currentFormatting=function(){return null},t.prototype.get_continuingExistingList=function(){return this._pastingIntoList&&!this._tableSteward.get_currentlyInsidePastedTable()},t.prototype.get_currentlyUnderPastedList=function(){return this._nestedListCount>0},t.prototype.get_indentationEditor=function(){return this.indentationEditor},t.prototype.get_listEditor=function(){return this.listEditor},t.prototype.get_listReader=function(){return this.listReader},t.prototype.get_box4PasteStewardBridge=function(){return this.box4PasteStewardBridge},t.prototype.onText=function(e,t){if(!this._box4PasteStewardBridge.tryHandlePageBreak(this._iterator,t,!0)){Vl.x(8701077,307,cs.ParagraphReader.isParagraph(this._iterator));var n=this._iterator.get_currentNode(),r=_s.y.createIpContextAtEndOfParagraph(n);if(this._followDestinationFormattingPasteIsEnabled&&this._formatting.get_formattingObject()){var i=n.get_characterProperties().get_last();this._formattingInvalidated&&(i.set_formatting(this._formatting.get_formattingObject().cloneUnderDifferentChp(i)),this._formattingInvalidated=!1),e=this._box4PasteStewardBridge.handleParagraphEnd(e,t),this._box4PasteStewardBridge.setParagraphProperties(this._iterator.get_currentNode(),this._formatting.get_paragraphProperties(),t)}this.get_characterPropertiesEditor().replaceTextRange(r,e)}},t.prototype.onLineBreak=function(e){Vl.x(8701078,307,cs.ParagraphReader.isParagraph(this._iterator));var t=this._iterator.get_currentNode(),n=_s.y.createIpContextAtEndOfParagraph(t);this.get_characterPropertiesEditor().insertBlobAtIp(n,(function(e){return new uy.y(e,uy.y.defaultLineBreakText)}),hc.AParagraphNode.embeddedObjectText)},t.prototype.onTab=function(e){this._box4PasteStewardBridge.handleTabCharacter(this._iterator,e)},t.prototype.onFormattingChange=function(e){this._followDestinationFormattingPasteIsEnabled&&(this._formattingInvalidated=!0)},t.prototype.onAnchorStart=function(e,t){Vl.x(8701079,307,cs.ParagraphReader.isParagraph(this._iterator))},t.prototype.onAnchorEnd=function(){Vl.x(8701080,307,cs.ParagraphReader.isParagraph(this._iterator))},t.prototype.onParagraphStart=function(e){this._tableSteward.get_currentlyInsidePastedTable()||(this._followDestinationFormattingPasteIsEnabled?(this.appendNewParagraph(e),this._formatting.tryApplyParagraphStyle(this._iterator.get_currentNode()),e&&"P"===e.get_ownerHtmlElementInfo().get_htmlElementType()&&this.get_box4PasteStewardBridge().setParagraphSpacing(this._iterator.get_currentNode(),this._formatting.get_paragraphSpacing()),this._box4PasteStewardBridge.setParagraphProperties(this._iterator.get_currentNode(),this._formatting.get_paragraphProperties(),e)):this.beginParagraph(e))},t.prototype.onParagraphEnd=function(){this._tableSteward.get_currentlyInsidePastedTable()||this.endParagraph()},t.prototype.onMathStart=function(e,t){},t.prototype.onMathEnd=function(){},t.prototype.onListStart=function(e){Vl.x(8701081,307,Ls.OutlineElementReader.isOutlineElement(this._iterator)||vc.isOutline(this._iterator)||cs.ParagraphReader.isParagraph(this._iterator)&&this._tableSteward.get_currentlyInsidePastedTable());var t=!1;this.get_currentlyUnderPastedList()||(t=this.get_continuingExistingList()||this.get_listReader().doListItemsAutoIndent()),t||this.set_pendingIndentationLevel(this.get_pendingIndentationLevel()+1),this._nestedListCount++},t.prototype.onListEnd=function(){this._nestedListCount--;var e=!1;this.get_currentlyUnderPastedList()||(e=this.get_continuingExistingList()||this.get_listReader().doListItemsAutoIndent(),this.get_listEditor().removeListsFromTablesIfNecessary(this._tablesToDelist)),e||(this.set_pendingIndentationLevel(this.get_pendingIndentationLevel()-1),this.get_pendingIndentationLevel())},t.prototype.onListItemStart=function(e){Vl.x(8701082,307,Ls.OutlineElementReader.isOutlineElement(this._iterator)||vc.isOutline(this._iterator)||cs.ParagraphReader.isParagraph(this._iterator)&&this._tableSteward.get_currentlyInsidePastedTable()),Vl.x(8701083,307,!!e.get_listStyleType())},t.prototype.onListItemEnd=function(){Vl.x(8701084,307,Ls.OutlineElementReader.isOutlineElement(this._iterator)||cs.ParagraphReader.isParagraph(this._iterator)&&this._tableSteward.get_currentlyInsidePastedTable()),this._tableSteward.get_currentlyInsidePastedTable()||Vl.x(8701085,307,this._iterator.hasChildrenOfRole(2))},t.prototype.onTableStart=function(e){this._tableSteward.onTableStart(e)},t.prototype.onTableEnd=function(){this._tableSteward.onTableEnd()},t.prototype.trackTableToDelist=function(e){this._tablesToDelist.add(e)},t.prototype.onTableRowStart=function(e){this._tableSteward.onTableRowStart(e)},t.prototype.onTableRowEnd=function(){this._tableSteward.onTableRowEnd()},t.prototype.onTableCellStart=function(e){this._tableSteward.onTableCellStart(e)},t.prototype.onTableCellEnd=function(){this._tableSteward.onTableCellEnd()},t.prototype.onTablePartStart=function(e){this._tableSteward.onTablePartStart(e)},t.prototype.onTablePartEnd=function(){this._tableSteward.onTablePartEnd()},t.prototype.beginParagraph=function(e){this.moveToNextOutlineElementForHtmlImport(!1),(new Da.GraphIterator).setFrom(this._iterator);var t=qC.a.get_outlineElementEditor().createParagraph(this._iterator,this.getNewOutlineElementInfo(e));Vl.x(8128534,307,t===this._iterator.get_currentNode()),Vl.x(8128535,307,cs.ParagraphReader.isParagraphNode(t))},t.prototype.endParagraph=function(){Vl.x(8128536,307,cs.ParagraphReader.isParagraph(this._iterator)),hs.OutlineElementNavigator.returnToOutlineElement(this._iterator)},t.prototype.reset=function(){this._followDestinationFormattingPasteIsEnabled&&(e.prototype.reset.call(this),this._formatting=this.getDefaultFormatting(!0))},t.prototype.appendNewParagraph=function(e){this.moveToNextOutlineElementForHtmlImport(!1),(new Da.GraphIterator).setFrom(this._iterator);var t=qC.a.get_outlineElementEditor().createParagraph(this._iterator,this.getNewOutlineElementInfo(e));Vl.x(36577367,307,t===this._iterator.get_currentNode()),Vl.x(36577368,307,cs.ParagraphReader.isParagraphNode(t)),-1!==this._formatting.get_justification()&&this.get_paragraphEditor().setJustification(t,this._formatting.get_justification()),this._formatting.get_lineSpacing()&&this.get_box4PasteStewardBridge().setLineSpacing(t,this._formatting.get_lineSpacing()),this._formatting.get_specialIndent()&&this.get_box4PasteStewardBridge().setSpecialIndent(t,this._formatting.get_specialIndent()),this._formatting.get_leftIndent()&&this.get_box4PasteStewardBridge().setLeftIndent(t,this._formatting.get_leftIndent()),this._formattingInvalidated=!0,this._formatting.set_paragraph(t)},t.convertToTwips=function(e,t){var n=0;switch(t){case 3:n=Jg.AP(e);break;case 7:n=Hh.o(e,0);break;case 1:n=Jg.cm(e);break;case 5:var r=Jg.We(e);n=Jg.AP(r);break;default:C.ULS.sendTraceTag(36577369,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",e,t)}return n},t}(qC.a);(0,o.l)(jC,"TextOnlyBox4PasteSteward",qC.a,[]);var $C=function(){function e(e,t,n,r){this._outlineElementIndentationEditor=null,this._listEditor=null,this._listReader=null,this._box4PasteStewardBridge=null,this._outlineElementIndentationEditor=e,this._listEditor=t,this._listReader=n,this._box4PasteStewardBridge=r}return e.prototype.create=function(e,t,n,r,i,o){return void 0===i&&(i=null),void 0===o&&(o=null),1===e?new jC(t,r,this._outlineElementIndentationEditor,this._listEditor,this._listReader,i,o,this._box4PasteStewardBridge):new KC.Box4PasteSteward(t,n,r,this._outlineElementIndentationEditor,this._listEditor,this._listReader,i,o,this._box4PasteStewardBridge)},e}();(0,o.l)($C,"Box4PasteStewardFactory",null,[pd]);var QC=(0,o.y)("IBox4TableSteward"),JC=function(){function e(){}return e.get_htmlClassStyleToPersistedStyleName=function(){return e._htmlClassStyleToBuildInStyleName},e.get_htmlValignStyleToVerticalAlignPersistedValue=function(){return e._htmlValignStyleToVerticalAlignPersistedValue},e.get_htmlStyleToBorderPersistedValue=function(){return e._htmlStyleToBorderPersistedValue},e.processMergedCell=function(t,n){var r=t.get_currentNode();ld.forEachCell(t,n.rowSpan,n.colSpan,(function(t,i,o){var a=t.get_currentNode();a!==r&&(a.set_isGhostCell(!0),e.detachChildrenNodes(t),o||n.colSpan>=1&&a.set_colSpan(n.colSpan),e.setGhostCellBorders(t,n.tableCellBorderProperties,i,o,n.rowSpan,n.colSpan))}))},e.processSkippedCell=function(t,n){ld.forEachCell(t,n.rowSpan,n.colSpan,(function(t,n,r){e.applySkippedCellProperties(t),e.detachChildrenNodes(t)}))},e.applySkippedCellProperties=function(e){var t=e.get_currentNode();t.set_isGhostCell(!0),t.set_isSkippedCell(!0),t.set_shouldRenderCell(!0)},e.detachChildrenNodes=function(e){e&&(e.goToFirstChildByRole(1),o.r(Of.w,e.get_currentNode())&&e.disconnectNodeAndReturnToParent())},e.applyWidthToCell=function(e,t,n){if(t>0){var r=(0,f.e)(Hf.TableCellNode,e.get_currentNode());if(!r)return;r.set_width(n?t:Hh.y(t,0))}},e.applyIdentationToTable=function(e,t,n){var r=(0,f.e)(Ac.f,e.get_currentNode());r&&(t>0&&r.set_paraIndentLeft(Hh.o(t,0)),n>0&&r.set_paraIndentRight(Hh.o(n,0)))},e.applyVerticalAlignToCell=function(t,n){null!=n&&t.get_currentNode().get_properties().setValue(ks.j.tableCellVerticalAlignment,e.get_htmlValignStyleToVerticalAlignPersistedValue()[n+""])},e.applyShadingToCell=function(e,t){if(null!=t&&""!==t){var n=parseInt(KC.Box4PasteSteward.convertRgbToBgr(t),16);e.get_currentNode().get_properties().setValue(Kc.b.cellShadingColor,n)}},e.getUsablePageWidth=function(e){var t=new Da.GraphIterator;t.setFrom(e);var n=Sc.returnToOutline(t);return n&&vc.isOutline(t)?n.getProperty_Unchecked(ks.j.pageWidth)-n.getProperty_Unchecked(ks.j.marginLeft)-n.getProperty_Unchecked(ks.j.marginRight):0},e.isRenderableBorder=function(e){return!(null==e||1===e)},e.setBorderWidth=function(t,n,r,i,o){if(null==n||""!==n){var a=0;switch(n){case"thin":a=Jg.vR(.25);break;case"initial":case"medium":a=Jg.vR(.5);break;case"thick":a=Jg.vR(1);break;default:a=e.getStorableBorderWidthFromValue(n,r,i)}o.get_currentNode().get_properties().setValue(t,a)}},e.setBorderStyle=function(t,n,r){null!=n&&n&&r.get_currentNode().get_properties().setValue(t,e.get_htmlStyleToBorderPersistedValue()[n+""])},e.setBorderColor=function(e,t,n){if(null!=t&&""!==t){var r=parseInt(KC.Box4PasteSteward.convertRgbToBgr(t),16);n.get_currentNode().get_properties().setValue(e,r)}},e.getStorableBorderWidthFromValue=function(e,t,n){var r=0,i=0,o=KC.Box4PasteSteward.parseCssValue(e,(0,p.m)((function(){return i}),(function(e){return i=e})));switch(i){case 5:r=Jg.vR(o);break;case 1:r=Jg.Kb(o);break;case 3:r=Jg.Ni(o);break;case 7:r=Hh.f(o,n)}return 6!==t&&7!==t&&10!==t||(r/=3),Math.round(r)},e.getStorableMarginFromValue=function(e,t){var n=0,r=0,i=KC.Box4PasteSteward.parseCssValue(e,(0,p.m)((function(){return r}),(function(e){return r=e})));switch(r){case 5:n=Jg.YW(i);break;case 1:n=Jg.IB(i);break;case 3:n=Jg.vE(i);break;case 7:n=Hh.y(i,t)}return n},e.setCellBorders=function(t,n,r,i,o,a,s){if(o&&(!s||16===o.get_currentNodeType()||s||14!==o.get_currentNodeType())&&12!==r){var l,c,u,g;if(s)switch(i){case 5:l=ks.j.tableBorderTopColor,c=ks.j.tableBorderTopStyle,u=ks.j.tableBorderTopSize,g=0;break;case 4:l=ks.j.tableBorderRightColor,c=ks.j.tableBorderRightStyle,u=ks.j.tableBorderRightSize,g=1;break;case 0:l=ks.j.tableBorderBottomColor,c=ks.j.tableBorderBottomStyle,u=ks.j.tableBorderBottomSize,g=0;break;case 3:l=ks.j.tableBorderLeftColor,c=ks.j.tableBorderLeftStyle,u=ks.j.tableBorderLeftSize,g=1;break;default:return}else switch(i){case 5:l=ks.j.tableCellBorderTopColor,c=ks.j.tableCellBorderTopStyle,u=ks.j.tableCellBorderTopSize,g=0;break;case 4:l=ks.j.tableCellBorderRightColor,c=ks.j.tableCellBorderRightStyle,u=ks.j.tableCellBorderRightSize,g=1;break;case 0:l=ks.j.tableCellBorderBottomColor,c=ks.j.tableCellBorderBottomStyle,u=ks.j.tableCellBorderBottomSize,g=0;break;case 3:l=ks.j.tableCellBorderLeftColor,c=ks.j.tableCellBorderLeftStyle,u=ks.j.tableCellBorderLeftSize,g=1;break;default:return}void 0!==o.get_currentNode()&&null!==o.get_currentNode()&&(e.isRenderableBorder(r)?(e.setBorderColor(l,t,o),e.setBorderStyle(c,r,o),e.setBorderWidth(u,n,r,g,o)):a||s||o.get_currentNode().get_properties().setValue(c,"nil"))}},e.setGhostCellBorders=function(t,n,r,i,o,a){i||(e.applyLeftCellBorder(n,t,!1,!1),e.applyRightCellBorder(n,t,!0,!1)),i===a-1&&e.applyRightCellBorder(n,t,!0,!1),r||e.applyTopCellBorder(n,t,!0,!1),r===o-1&&e.applyBottomCellBorder(n,t,!0,!1)},e.applyAllTableCellBorders=function(t,n,r,i){t&&(e.applyTopCellBorder(t,n,r,i),e.applyRightCellBorder(t,n,r,i),e.applyBottomCellBorder(t,n,r,i),e.applyLeftCellBorder(t,n,r,i))},e.applyTopCellBorder=function(t,n,r,i){e.setCellBorders(t.borderTopColor,t.borderTopWidth,t.borderTopStyle,5,n,r,i)},e.applyRightCellBorder=function(t,n,r,i){e.setCellBorders(t.borderRightColor,t.borderRightWidth,t.borderRightStyle,4,n,r,i)},e.applyBottomCellBorder=function(t,n,r,i){e.setCellBorders(t.borderBottomColor,t.borderBottomWidth,t.borderBottomStyle,0,n,r,i)},e.applyLeftCellBorder=function(t,n,r,i){e.setCellBorders(t.borderLeftColor,t.borderLeftWidth,t.borderLeftStyle,3,n,r,i)},e.setCellMargin=function(t,n,r){if(r&&16===r.get_currentNodeType()&&""!==t){var i,o;switch(n){case 3:i=ks.j.tableCellTopMargin,o=0;break;case 2:i=ks.j.tableCellRightMargin,o=1;break;case 0:i=ks.j.tableCellBottomMargin,o=0;break;case 1:i=ks.j.tableCellLeftMargin,o=1;break;default:return}var a=e.getStorableMarginFromValue(t,o);a&&r.get_currentNode().get_properties().setValue(i,a)}},e.applyAllTableCellMargins=function(t,n){n&&(e.applyTopCellMargin(n,t),e.applyRightCellMargin(n,t),e.applyBottomCellMargin(n,t),e.applyLeftCellMargin(n,t))},e.applyTopCellMargin=function(t,n){e.setCellMargin(t.cellMarginTop,3,n)},e.applyRightCellMargin=function(t,n){e.setCellMargin(t.cellMarginRight,2,n)},e.applyBottomCellMargin=function(t,n){e.setCellMargin(t.cellMarginBottom,0,n)},e.applyLeftCellMargin=function(t,n){e.setCellMargin(t.cellMarginLeft,1,n)},e.nestedTablePixelsToChop=8,e.normalTableStyleIdName="Normal Table",e.defaultTableStyleIdName="Table Grid",e._htmlClassStyleToBuildInStyleName=E.i("MsoNormalTable","Normal Table","MsoTableGrid",e.defaultTableStyleIdName,"MsoTableGridLight","Grid Table Light","MsoTable15Plain1","Plain Table 1","MsoTable15Plain2","Plain Table 2","MsoTable15Plain3","Plain Table 3","MsoTable15Plain4","Plain Table 4","MsoTable15Plain5","Plain Table 5","MsoTable15Grid1Light","Grid Table 1 Light","MsoTable15Grid1LightAccent1","Grid Table 1 Light Accent 1","MsoTable15Grid1LightAccent2","Grid Table 1 Light Accent 2","MsoTable15Grid1LightAccent3","Grid Table 1 Light Accent 3","MsoTable15Grid1LightAccent4","Grid Table 1 Light Accent 4","MsoTable15Grid1LightAccent5","Grid Table 1 Light Accent 5","MsoTable15Grid1LightAccent6","Grid Table 1 Light Accent 6","MsoTable15Grid2","Grid Table 2","MsoTable15Grid2Accent1","Grid Table 2 Accent 1","MsoTable15Grid2Accent2","Grid Table 2 Accent 2","MsoTable15Grid2Accent3","Grid Table 2 Accent 3","MsoTable15Grid2Accent4","Grid Table 2 Accent 4","MsoTable15Grid2Accent5","Grid Table 2 Accent 5","MsoTable15Grid2Accent6","Grid Table 2 Accent 6","MsoTable15Grid3","Grid Table 3","MsoTable15Grid3Accent1","Grid Table 3 Accent 1","MsoTable15Grid3Accent2","Grid Table 3 Accent 2","MsoTable15Grid3Accent3","Grid Table 3 Accent 3","MsoTable15Grid3Accent4","Grid Table 3 Accent 4","MsoTable15Grid3Accent5","Grid Table 3 Accent 5","MsoTable15Grid3Accent6","Grid Table 3 Accent 6","MsoTable15Grid4","Grid Table 4","MsoTable15Grid4Accent1","Grid Table 4 Accent 1","MsoTable15Grid4Accent2","Grid Table 4 Accent 2","MsoTable15Grid4Accent3","Grid Table 4 Accent 3","MsoTable15Grid4Accent4","Grid Table 4 Accent 4","MsoTable15Grid4Accent5","Grid Table 4 Accent 5","MsoTable15Grid4Accent6","Grid Table 4 Accent 6","MsoTable15Grid5Dark","Grid Table 5 Dark","MsoTable15Grid5DarkAccent1","Grid Table 5 Dark Accent 1","MsoTable15Grid5DarkAccent2","Grid Table 5 Dark Accent 2","MsoTable15Grid5DarkAccent3","Grid Table 5 Dark Accent 3","MsoTable15Grid5DarkAccent4","Grid Table 5 Dark Accent 4","MsoTable15Grid5DarkAccent5","Grid Table 5 Dark Accent 5","MsoTable15Grid5DarkAccent6","Grid Table 5 Dark Accent 6","MsoTable15Grid6Colorful","Grid Table 6 Colorful","MsoTable15Grid6ColorfulAccent1","Grid Table 6 Colorful Accent 1","MsoTable15Grid6ColorfulAccent2","Grid Table 6 Colorful Accent 2","MsoTable15Grid6ColorfulAccent3","Grid Table 6 Colorful Accent 3","MsoTable15Grid6ColorfulAccent4","Grid Table 6 Colorful Accent 4","MsoTable15Grid6ColorfulAccent5","Grid Table 6 Colorful Accent 5","MsoTable15Grid6ColorfulAccent6","Grid Table 6 Colorful Accent 6","MsoTable15Grid7Colorful","Grid Table 7 Colorful","MsoTable15Grid7ColorfulAccent1","Grid Table 7 Colorful Accent 1","MsoTable15Grid7ColorfulAccent2","Grid Table 7 Colorful Accent 2","MsoTable15Grid7ColorfulAccent3","Grid Table 7 Colorful Accent 3","MsoTable15Grid7ColorfulAccent4","Grid Table 7 Colorful Accent 4","MsoTable15Grid7ColorfulAccent5","Grid Table 7 Colorful Accent 5","MsoTable15Grid7ColorfulAccent6","Grid Table 7 Colorful Accent 6","MsoTable15List1Light","List Table 1 Light","MsoTable15List1LightAccent1","List Table 1 Light Accent 1","MsoTable15List1LightAccent2","List Table 1 Light Accent 2","MsoTable15List1LightAccent3","List Table 1 Light Accent 3","MsoTable15List1LightAccent4","List Table 1 Light Accent 4","MsoTable15List1LightAccent5","List Table 1 Light Accent 5","MsoTable15List1LightAccent6","List Table 1 Light Accent 6","MsoTable15List2","List Table 2","MsoTable15List2Accent1","List Table 2 Accent 1","MsoTable15List2Accent2","List Table 2 Accent 2","MsoTable15List2Accent3","List Table 2 Accent 3","MsoTable15List2Accent4","List Table 2 Accent 4","MsoTable15List2Accent5","List Table 2 Accent 5","MsoTable15List2Accent6","List Table 2 Accent 6","MsoTable15List3","List Table 3","MsoTable15List3Accent1","List Table 3 Accent 1","MsoTable15List3Accent2","List Table 3 Accent 2","MsoTable15List3Accent3","List Table 3 Accent 3","MsoTable15List3Accent4","List Table 3 Accent 4","MsoTable15List3Accent5","List Table 3 Accent 5","MsoTable15List3Accent6","List Table 3 Accent 6","MsoTable15List4","List Table 4","MsoTable15List4Accent1","List Table 4 Accent 1","MsoTable15List4Accent2","List Table 4 Accent 2","MsoTable15List4Accent3","List Table 4 Accent 3","MsoTable15List4Accent4","List Table 4 Accent 4","MsoTable15List4Accent5","List Table 4 Accent 5","MsoTable15List4Accent6","List Table 4 Accent 6","MsoTable15List5Dark","List Table 5 Dark","MsoTable15List5DarkAccent1","List Table 5 Dark Accent 1","MsoTable15List5DarkAccent2","List Table 5 Dark Accent 2","MsoTable15List5DarkAccent3","List Table 5 Dark Accent 3","MsoTable15List5DarkAccent4","List Table 5 Dark Accent 4","MsoTable15List5DarkAccent5","List Table 5 Dark Accent 5","MsoTable15List5DarkAccent6","List Table 5 Dark Accent 6","MsoTable15List6Colorful","List Table 6 Colorful","MsoTable15List6ColorfulAccent1","List Table 6 Colorful Accent 1","MsoTable15List6ColorfulAccent2","List Table 6 Colorful Accent 2","MsoTable15List6ColorfulAccent3","List Table 6 Colorful Accent 3","MsoTable15List6ColorfulAccent4","List Table 6 Colorful Accent 4","MsoTable15List6ColorfulAccent5","List Table 6 Colorful Accent 5","MsoTable15List6ColorfulAccent6","List Table 6 Colorful Accent 6","MsoTable15List7Colorful","List Table 7 Colorful","MsoTable15List7ColorfulAccent1","List Table 7 Colorful Accent 1","MsoTable15List7ColorfulAccent2","List Table 7 Colorful Accent 2","MsoTable15List7ColorfulAccent3","List Table 7 Colorful Accent 3","MsoTable15List7ColorfulAccent4","List Table 7 Colorful Accent 4","MsoTable15List7ColorfulAccent5","List Table 7 Colorful Accent 5","MsoTable15List7ColorfulAccent6","List Table 7 Colorful Accent 6"),e._htmlValignStyleToVerticalAlignPersistedValue=E.i("0","center","1","top","2","center","3","bottom"),e._htmlStyleToBorderPersistedValue=E.i("0","nil","1","none","2","nil","3","single","5","dotted","4","dashed","11","single","6","double","7","double","10","double","8","inset","9","outset"),e}();(0,o.l)(JC,"Box4TableStewardHelper",null,[]);var XC=function(){function e(e,t,n,r,i,o){void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===o&&(o=!1),this._iterator=null,this._box4PasteSteward=null,this._pasteTableImprovementsIsEnabled=!1,this._pasteComplexTableImprovementsIsEnabled=!1,this._pasteTableCellMarginImprovementsIsEnabled=!1,this._nestedTableCount=0,this.listEditor=null,this.tableEditor=null,this._iterator=e,this.listEditor=t,this.tableEditor=n,this._pasteTableImprovementsIsEnabled=r,this._pasteComplexTableImprovementsIsEnabled=i,this._pasteTableCellMarginImprovementsIsEnabled=o}return e.prototype.bindToOwnerSteward=function(e){this._box4PasteSteward=e},e.prototype.get_currentlyInsidePastedTable=function(){return this._nestedTableCount>0},e.prototype.onTableStart=function(e){Vl.x(7869459,307,!!this._box4PasteSteward),Vl.x(7869460,307,Ls.OutlineElementReader.isOutlineElement(this._iterator)||vc.isOutline(this._iterator)),Vl.k(38563978,307,50,"Table pasting started"),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteTableImprovementsSettings"),this._box4PasteSteward.moveToNextOutlineElementForHtmlImport(!0);var t=new Da.GraphIterator;t.setFrom(this._iterator);var n=(0,f.e)(String,JC.get_htmlClassStyleToPersistedStyleName()[e.styleId]);e.tableLook;n||(n=JC.defaultTableStyleIdName);var r=this.tableEditor.recreatePastedTable(this._iterator,e.rowCount,e.colCount,n,e.tableLook,this._box4PasteSteward.getNewOutlineElementInfo(e),e.isBorderHidden);if(this._pasteTableImprovementsIsEnabled&&(Vl.k(23938568,307,50,e.colWidths?"Table-widths exist":"Table-widths missing, table may be invalid"),e.tableBorderProperties&&JC.applyAllTableCellBorders(e.tableBorderProperties,this._iterator,!1,!0),JC.applyIdentationToTable(this._iterator,e.indentationProperties.spaceBefore,e.indentationProperties.spaceAfter),e.colWidths)){var i=0,o=new Array(e.colWidths.length),a=0;e.isRelativeWidth&&us.n.get_instance().get_item(63)&&(a=(a=Jg.zS(JC.getUsablePageWidth(this._iterator)))||1);for(var s=0;s<e.colWidths.length;s++)o[s]=a>0?e.colWidths[s]*(a/100):Hh.y(e.colWidths[s],0),i+=o[s];var l=r.getValue(Array,Kc.b.tableColumnWidths),c=new Da.GraphIterator;c.setFrom(this._iterator);var u=0;if(Zc.isInTableCell(c)){var g=ld.returnToContainingCell(c);g&&(u=g.get_width());var p=sd.e(c),d=ld.returnToContainingTable(c);if(-1!==p&&p<=d.get_columnWidths().length){var h=0;for(s=p;s<p+g.get_colSpan()&&s<d.get_columnWidths().length;s++)h+=d.get_columnWidths()[s];(u=Math.min(u,h))===h&&(u-=Hh.y(JC.nestedTablePixelsToChop,0))}}else if(l)for(s=0;s<l.length;s++)u+=l[s];if(u>0&&i>u&&i){var _=u/i;for(s=0;s<o.length;s++)o[s]*=_}r.setValue(Kc.b.tableColumnWidths,o)}this._box4PasteSteward.applyPendingListAndIndentationInfo(t,!1),this._nestedTableCount++,us.n.get_instance().get_item(63)&&mc.ListReader.isListOutlineElement(t)&&this._box4PasteSteward.trackTableToDelist(t.get_currentNode()),Vl.x(7869461,307,dc.TableReader.isTable(this._iterator))},e.prototype.onTableEnd=function(){Vl.x(7869462,307,!!this._box4PasteSteward),Vl.x(7869463,307,cd.u(this._iterator)),Vl.k(38563979,307,50,"Table pasting finished"),hs.OutlineElementNavigator.returnToOutlineElement(this._iterator),this._nestedTableCount--},e.prototype.onTableRowStart=function(e){Vl.x(7869464,307,!!this._box4PasteSteward),dc.TableReader.isTable(this._iterator)?ld.moveToFirstRow(this._iterator):cd.u(this._iterator)&&ld.moveToNextRow(this._iterator),this._pasteTableImprovementsIsEnabled&&e.height&&this._iterator.get_currentNode().setValue(ks.j.tableRowHeight,Hh.y(e.height,1)),Vl.x(7869465,307,cd.u(this._iterator))},e.prototype.onTableRowEnd=function(){Vl.x(7869466,307,!!this._box4PasteSteward),Vl.x(7869467,307,Zc.isTableCell(this._iterator)),ld.returnToContainingRow(this._iterator)},e.prototype.onTableCellStart=function(e){if(Vl.x(7869468,307,!!this._box4PasteSteward),Vl.x(7869469,307,!this._box4PasteSteward.get_pendingIndentationLevel()),cd.u(this._iterator)?ld.moveToFirstColumn(this._iterator):Zc.isTableCell(this._iterator)?ld.moveToNextColumn(this._iterator):Vl.x(7869471,307,!1),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPasteComplexTablesSettings"),this._pasteComplexTableImprovementsIsEnabled){if(!this._iterator.get_currentNode())return;var t=(0,f.e)(Hf.TableCellNode,this._iterator.get_currentNode()),n=!t&&16!==this._iterator.get_currentNode().get_type()||!!t&&16===this._iterator.get_currentNode().get_type();if(Vl.x(50689760,307,n),!t)return;if((i=new Da.GraphIterator).setFrom(this._iterator),!e.colSpan||!e.rowSpan)return;if(e.isSkipCell)return void JC.processSkippedCell(i,e);if(e.colSpan>1||e.rowSpan>1){var r=ld.returnToContainingTable(i);if(!r)return;r.setValue(ks.j.complexTable,!0),i.setFrom(this._iterator),JC.processMergedCell(i,e),t.set_rowSpan(e.rowSpan),t.set_colSpan(e.colSpan)}}if(this._pasteTableImprovementsIsEnabled&&(JC.applyShadingToCell(this._iterator,e.shadingColor),JC.applyVerticalAlignToCell(this._iterator,e.verticalAlignment),this._pasteTableCellMarginImprovementsIsEnabled&&JC.applyAllTableCellMargins(this._iterator,e.tableCellMarginProperties)),this._pasteComplexTableImprovementsIsEnabled&&JC.applyAllTableCellBorders(e.tableCellBorderProperties,this._iterator,!e.colSpan&&!e.rowSpan,!1),this._pasteTableImprovementsIsEnabled){var i;if(!this._pasteComplexTableImprovementsIsEnabled)(i=new Da.GraphIterator).setFrom(this._iterator),ld.forEachCell(i,e.rowSpan,e.colSpan,(function(t,n,r){JC.applyShadingToCell(t,e.shadingColor),JC.applyVerticalAlignToCell(t,e.verticalAlignment),JC.setGhostCellBorders(t,e.tableCellBorderProperties,n,r,e.rowSpan,e.colSpan)}));JC.applyWidthToCell(this._iterator,e.width,e.isRelativeWidth)}Vl.x(7869472,307,vc.isOutline(this._iterator))},e.prototype.onTableCellEnd=function(){Vl.x(7869473,307,!!this._box4PasteSteward),Vl.x(7869474,307,Ls.OutlineElementReader.isOutlineElement(this._iterator)||Zc.isTableCell(this._iterator)),ld.returnToCell(this._iterator),Vl.x(7869475,307,this._box4PasteSteward.get_pendingIndentationLevel()<=0),this._box4PasteSteward.clearPendingIndentation()},e.prototype.onTablePartStart=function(e){Vl.x(7869504,307,!1)},e.prototype.onTablePartEnd=function(){Vl.x(7869505,307,!1)},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=se.w.get_instance().resolve(Es.p))},e._outlineElementEditor=null,e}();(0,o.l)(XC,"Box4TableSteward",null,[QC,Gm.p]);var YC=function(){function e(e,t,n){this._iterator=null,this._box4PasteSteward=null,this._nestedTableCount=0,this.listEditor=null,this.tableEditor=null,this._iterator=e,this.listEditor=t,this.tableEditor=n}return e.prototype.bindToOwnerSteward=function(e){this._box4PasteSteward=e},e.prototype.get_currentlyInsidePastedTable=function(){return this._nestedTableCount>0},e.prototype.onTableStart=function(e){this.get_currentlyInsidePastedTable()&&(Vl.x(8787101,307,cs.ParagraphReader.isParagraph(this._iterator)),hs.OutlineElementNavigator.returnToOutlineElement(this._iterator)),Vl.x(8701086,307,!!this._box4PasteSteward),Vl.x(8701087,307,Ls.OutlineElementReader.isOutlineElement(this._iterator)||vc.isOutline(this._iterator)),this._nestedTableCount++},e.prototype.onTableEnd=function(){if(Vl.x(8701088,307,!!this._box4PasteSteward),hs.OutlineElementNavigator.returnToOutlineElement(this._iterator),this._nestedTableCount--,this.get_currentlyInsidePastedTable()){this._box4PasteSteward.moveToNextOutlineElementForHtmlImport(!0);var t=e.get_outlineElementEditor().createParagraph(this._iterator);Vl.x(8787102,307,t===this._iterator.get_currentNode()),Vl.x(8787103,307,cs.ParagraphReader.isParagraph(this._iterator))}},e.prototype.onTableRowStart=function(t){Vl.x(8701089,307,!!this._box4PasteSteward),this._box4PasteSteward.moveToNextOutlineElementForHtmlImport(!0);var n=new Da.GraphIterator;n.setFrom(this._iterator),this._box4PasteSteward.applyPendingListAndIndentationInfo(n,!1),us.n.get_instance().get_item(63)&&mc.ListReader.isListOutlineElement(n)&&this._box4PasteSteward.trackTableToDelist(n.get_currentNode());var r=e.get_outlineElementEditor().createParagraph(this._iterator,this._box4PasteSteward.getNewOutlineElementInfo(t));Vl.x(8701090,307,r===this._iterator.get_currentNode()),Vl.x(8701091,307,cs.ParagraphReader.isParagraph(this._iterator))},e.prototype.onTableRowEnd=function(){Vl.x(8701120,307,!!this._box4PasteSteward),Vl.x(8701121,307,cs.ParagraphReader.isParagraph(this._iterator)),hs.OutlineElementNavigator.returnToOutlineElement(this._iterator)},e.prototype.onTableCellStart=function(e){Vl.x(8701122,307,!!this._box4PasteSteward),Vl.x(8701123,307,cs.ParagraphReader.isParagraph(this._iterator)),Vl.x(8701124,307,!this._box4PasteSteward.get_pendingIndentationLevel());var t=this._iterator.get_currentNode();if(cs.ParagraphReader.textLength(t)){var n=_s.y.createIpContextAtEndOfParagraph(t);this._box4PasteSteward.get_characterPropertiesEditor().replaceTextRange(n,", ")}},e.prototype.onTableCellEnd=function(){Vl.x(8701125,307,!!this._box4PasteSteward),Vl.x(8701126,307,cs.ParagraphReader.isParagraph(this._iterator)),Vl.x(8701127,307,this._box4PasteSteward.get_pendingIndentationLevel()<=0),this._box4PasteSteward.clearPendingIndentation()},e.prototype.onTablePartStart=function(e){Vl.x(8701128,307,!1)},e.prototype.onTablePartEnd=function(){Vl.x(8701129,307,!1)},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=se.w.get_instance().resolve(Es.p))},e._outlineElementEditor=null,e}();(0,o.l)(YC,"TextOnlyBox4TableSteward",null,[QC,Gm.p]);var ZC=function(){function e(e,t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),this._listEditor=null,this._tableEditor=null,this._pasteTableImprovementsIsEnabled=!1,this._pasteComplexTableImprovementsIsEnabled=!1,this._pasteTableCellMarginImprovementsIsEnabled=!1,this._listEditor=e,this._tableEditor=t,this._pasteTableImprovementsIsEnabled=n,this._pasteComplexTableImprovementsIsEnabled=r,this._pasteTableCellMarginImprovementsIsEnabled=i}return e.prototype.create=function(e,t){return 1===e?new YC(t,this._listEditor,this._tableEditor):new XC(t,this._listEditor,this._tableEditor,this._pasteTableImprovementsIsEnabled,this._pasteComplexTableImprovementsIsEnabled,this._pasteTableCellMarginImprovementsIsEnabled)},e}();(0,o.l)(ZC,"Box4TableStewardFactory",null,[qd]);var eS=n(9339),tS=function(){function e(){}return e.prototype.create=function(){return new Pm.z},e}();(0,o.l)(tS,"Factory$10",null,[Id]);var nS=function(){function e(e){this.isBrsOfOfficeOnlineExtensionSwitchedOn=!1,this.officeOnlineExtensionId=null,this.oldCopyPasteExtensionId=null,this.currentUsingExtensionId=null,this.shouldCheckExtensionBySendingMessage=!1,this.officeOnlineExtensionId=e.getStringAppSetting("OfficeOnlineChromeExtensionId"),this.oldCopyPasteExtensionId=e.getStringAppSetting("ChromeClipboardAccessExtensionId"),this.isBrsOfOfficeOnlineExtensionSwitchedOn=e.getBooleanAppSetting("OfficeOnlineChromeExtensionIsEnabled"),this.shouldCheckExtensionBySendingMessage=!this.isOfficeOnlineExtensionAvailable(),this.get_shouldCheckExtensionBySendingMessage()?this.currentUsingExtensionId=this.oldCopyPasteExtensionId:this.currentUsingExtensionId=this.officeOnlineExtensionId}return e.prototype.getExtensionId=function(){return this.currentUsingExtensionId},e.prototype.resetExtensionId=function(){this.currentUsingExtensionId===this.officeOnlineExtensionId&&this.get_isLocalStorageAccessible()&&(localStorage.removeItem("IsOfficeOnlineExtensionInstalled"),localStorage.removeItem("IsCopyPasteSupported")),this.currentUsingExtensionId=this.oldCopyPasteExtensionId,this.shouldCheckExtensionBySendingMessage=!0},e.prototype.get_shouldCheckExtensionBySendingMessage=function(){return this.shouldCheckExtensionBySendingMessage},e.prototype.isOfficeOnlineExtensionAvailable=function(){if(this.isBrsOfOfficeOnlineExtensionSwitchedOn&&this.get_isLocalStorageAccessible()){var e=localStorage.getItem("IsOfficeOnlineExtensionInstalled");if(e&&"true"===e){var t=localStorage.getItem("IsCopyPasteSupported");return!!t&&"true"===t}}return!1},e.prototype.get_isLocalStorageAccessible=function(){var e="LocalStorageAccessiblityTest",t=!1;try{localStorage.setItem(e,e),t=localStorage.getItem(e)===e,localStorage.removeItem(e)}catch(e){C.ULS.sendTraceTag(19452045,307,50,e.toString())}return t},e}();(0,o.l)(nS,"ChromeExtensionHelper",null,[yd]);var rS=function(){function e(){}return e.prototype.create=function(e){return new Hy.w(e)},e}();(0,o.l)(rS,"Factory$9",null,[wd]);var iS=n(3596),oS=function(){function e(){}return e.prototype.configure=function(e){e.register($C).as(pd).singleInstance().usingFactory((function(){return new $C(yc.z.get_getOutlineElementIndentationEditor(),e.resolve(rs.v),e.resolve(ts.c),e.resolve(dd.n))})),e.register(Kh).as(hd).singleInstance().usingFactory((function(){return new Kh(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacPasteBrAsNewParagraphIsEnabled"))})),e.register(k_.ClipboardActor).singleInstance().usingFactory((function(){return new k_.ClipboardActor(e.resolveLazy(_d.d),e.resolve(md),ji.y.get_instance(),e.resolve(fd.t),Oa.SelectionManager.get_instance(),L.AFrameworkApplication.get_theActionManager(),e.resolve(ja.n),L.AFrameworkApplication.appSettingsManager)})),e.register(yd).singleInstance().usingFactory((function(){return new nS(L.AFrameworkApplication.appSettingsManager)})),e.register(Cd).singleInstance().usingFactory((function(){return new $y(L.AFrameworkApplication.appSettingsManager,e.resolve(yd),e.resolve(fd.t),om.k.get_instance())})),e.register(Sd).singleInstance().usingFactory((function(){return e.resolve(Cd).create()})),e.register(md).singleInstance().usingFactory((function(){return new Gy(e.resolve(Sd),Ur.InteractiveViewManager.get_instance(),Br.App.get_activeAppFrame().workspace,Nt.FocusManager.instance(),e.resolve(Lr.q),e.resolve(vd.d),om.k.get_instance())})),e.register(bd).singleInstance().usingFactory((function(){return new O_})),e.register(Td).singleInstance().usingFactory((function(){return new Qy})),e.register(Ad).singleInstance().usingFactory((function(){return new WC})),e.register(Id).singleInstance().usingFactory((function(){return new tS})),e.register(wd).singleInstance().usingFactory((function(){return new rS})),e.register(xd).singleInstance().usingFactory((function(){return new dm(Oa.SelectionManager.get_instance(),e.resolve(Fd.s),e.resolve(Ed.h),us.n.get_instance().get_item(71))})),e.register(Fy).singleInstance().usingFactory((function(){return new Fy(Oa.SelectionManager.get_instance(),e.resolve(Pd.d),Ur.InteractiveViewManager.get_instance(),Bt.g.getElementBounds,e.resolve(HC))})),e.register(by).singleInstance().usingFactory((function(){return new by(e.resolve(fd.t),Br.App.get_box4Bridge().get_commandUi())})),e.register(vy).singleInstance().usingFactory((function(){return new vy(e.resolve(HC),e.resolve(kd.z),Ur.InteractiveViewManager.get_instance(),iS.f.instance(),L.AFrameworkApplication.get_activeFrame(),e.resolve(Fy),e.resolve(Dd.x),e.resolve(by),Br.App.theNotebookManager.get_theGraph().getSpecificEventHandlers(12),e.resolve(Md.w),Br.App.get_mode())})),e.register(Rd).singleInstance().usingFactory((function(){return new gm(ji.y.get_instance(),e.resolve(dy),e.resolve(fy),lm.z.get_instance(),Oa.SelectionManager.get_instance(),L.AFrameworkApplication.get_theActionManager(),e.resolve(Ld),e.resolveLazy(ja.n),e.resolve(wd),e.resolve(xd),e.resolve($a.b).get_instance())})),e.register(Nd).singleInstance().usingFactory((function(){return new B_(L.AFrameworkApplication.get_theActionManager(),ji.y.get_instance(),e.resolve(dy),e.resolve(Es.p),Oa.SelectionManager.get_instance(),e.resolve(md),e.resolve(Fd.s),VC.e.get_instance(),e.resolve(Bd.j),e.resolve(Od.v),e.resolve(Ud.x),e.resolve(Id),e.resolve(Ad),e.resolve(Dd.x),e.resolve(fd.t))})),e.register(Hd).singleInstance().usingFactory((function(){return new R_(ji.y.get_instance(),om.k.get_instance(),e.resolve(md),e.resolve(Gd.h),L.AFrameworkApplication.appSettingsManager.get_appSettings().ChromeClipboardAccessOperationTimeout)})),e.register(Ld).singleInstance().usingFactory((function(){return new Cm(L.AFrameworkApplication.appSettingsManager)})),e.register(_d.d).singleInstance().usingFactory((function(){return new am(e.resolve(dy),L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.shouldUseChromeExtension(),ji.y.get_instance(),VC.e.get_instance(),om.k.get_instance(),e.resolve(Vd.c),e.resolve(Rd),e.resolve(Nd),e.resolve(Hd),e.resolve(Sm),e.resolve(Wd.b),e.resolve(Gd.h),e.resolve(za.p).get_instance(),e.resolve($a.b).get_instance(),e.resolve(ja.n),e.resolve(kd.z),e.resolve(al.s))})),e.register(zd).singleInstance().usingFactory((function(){return new rf(e.resolveLazy(pd),e.resolveLazy(Kd),e.resolveLazy(qd),e.resolveLazy(jd),e.resolve($d),e.tryResolve(Qd),e.resolve(Dd.x),e.resolve(Jd),e.resolve(Xd))})),e.register(dy).singleInstance().usingFactory((function(){return new dy(e.resolve(rl.w),e.resolve(cu.z),e.resolve(rc.a),e.resolve(Es.p),e.resolve(rs.v),Br.App.theNotebookManager,e.resolve(Yd.p),L.AFrameworkApplication.appSettingsManager,e.resolve(Zd.u),e.resolve(Vd.c),e.tryResolve(Qd),e.resolve(eh.v),e.resolve(za.p).get_instance(),e.resolve($a.b).get_instance(),e.resolve(th.b).get_sequenceCodePrefix(),e.resolve(sc.x))})),e.register(nh).singleInstance().usingFactory((function(){return new my(e.resolve(dy),e.tryResolve(Qd),new yt.q(eS.g,(function(){return Br.App.get_activeAppFrame().workspace.get_contentView()})))})),e.register(ns).singleInstance().usingFactory((function(){return new tC(L.AFrameworkApplication.get_theActionManager())})),e.register(fy).singleInstance().usingFactory((function(){return new fy(e.resolve(dy),e.resolve(nh),e.resolve(zd))})),us.n.get_instance().get_item(78)||(e.register(Wh).as(Kd).singleInstance().usingFactory((function(){return new Wh(e.resolve(rl.w),L.AFrameworkApplication.get_theTaskManager(),e.resolve(ja.n),e.tryResolve(rh),Br.App.get_activeAppFrame().get_notificationBar(),e.resolve(Dd.x).getBooleanAppSetting("WordEditorPastePictureFailedImprovementIsEnabled"),e.resolve(Dd.x).getBooleanAppSetting("NotificationBarImageErrorIsEnabled"))})),e.register(ZC).as(qd).singleInstance().usingFactory((function(){return new ZC(se.w.get_instance().resolve(rs.v),se.w.get_instance().resolve(cu.z),e.resolve(Dd.x).getBooleanAppSetting("WordEditorPasteTableImprovementsIsEnabled"),e.resolve(Dd.x).getBooleanAppSetting("PasteComplexTablesIsEnabled"),e.resolve(Dd.x).getBooleanAppSetting("PasteTableCellMarginImprovementsIsEnabled"))}))),e.register(Sm).singleInstance().usingFactory((function(){return new Sm(ji.y.get_instance(),Oa.SelectionManager.get_instance(),Br.App.get_theCoauthManager(),ls.k.get_instance(),us.n.get_instance().get_item(14),us.n.get_instance().get_item(50))})),e.register(P_).as(jd).singleInstance().usingFactory((function(){return new P_(L.AFrameworkApplication.appSettingsManager)})),e.register(Jd).singleInstance().usingFactory((function(){return new vm(L.AFrameworkApplication.appSettingsManager)})),e.register(ih.i).singleInstance().usingFactory((function(){return new GC(L.AFrameworkApplication.get_theActionManager())})),e.register(gu.n).singleInstance().usingFactory((function(){return new NC(L.AFrameworkApplication.get_theActionManager())})),e.register(gd).singleInstance().usingFactory((function(){return new gd(e.resolveFuture(va.t),e.resolve(oh.d))})),e.register(eC).as(ah.c).singleInstance().usingFactory((function(){return new eC(e.tryResolve(sh.c),e.resolve(lh))})),e.register(HC).as(ch.h).singleInstance().usingFactory((function(){return new HC})),e.register(cC).singleInstance().usingFactory((function(){return new cC(se.w.get_instance().resolve(oh.d),L.AFrameworkApplication.get_theActionManager(),(function(){return se.w.get_instance().resolve(uh)}),se.w.get_instance().resolve(Va.x),se.w.get_instance().resolve(Vd.c),Oa.SelectionManager.get_instance(),se.w.get_instance().resolveFuture(gh.i),VC.e.get_instance(),se.w.get_instance().resolve(cg.f),ls.k.get_instance(),ji.y.get_instance(),se.w.get_instance().resolve(iu.k),se.w.get_instance().resolve(ph.c),se.w.get_instance().resolveFuture(dh),us.n.get_instance())})),e.register(SC).singleInstance().usingFactory((function(){return new SC(se.w.get_instance().resolve(Va.x),se.w.get_instance().resolve(uc.e),zC.z.get_instance(),se.w.get_instance().resolve(xs.z),kf.ContextSetEditor.get_instance(),se.w.get_instance().resolve(ah.c),ls.k.get_instance(),ji.y.get_instance(),se.w.get_instance().resolve(RC.d),OC.get_instance())})),e.register(LC).singleInstance().usingFactory((function(){return new LC(e.resolve(hh),e.resolve(_h),e.resolve(mh.s))})),e.register(fh).singleInstance().usingFactory((function(){return new fh(L.AFrameworkApplication.get_theActionManager(),ji.y.get_instance(),(function(){return se.w.get_instance().resolve(du)}))}))},e}();(0,o.l)(oS,"Box4ActorsComponentConfiguration",null,[c.s]);var aS=function(e,t,n,r,i){if(Br.App.disableEmbedDownload)return 8;if(2===n){var o=new ar.StandardDialog;return o.set_buttonsOption(4),o.setDefaultButton(1),o.setButtonText(1,Box4Intl.Box4Strings.l_DownloadEmbeddedFileYesButton),o.setButtonText(2,Box4Intl.Box4Strings.l_DownloadEmbeddedFileNoButton),o.showQuestion(Box4Intl.Box4Strings.l_DownloadEmbeddedFileTitle,Box4Intl.Box4Strings.l_DownloadEmbeddedFileMessage,sS),32}return 2},sS=function(e,t){1===e&&L.AFrameworkApplication.get_theActionManager().processAction(ii.CM,2)},lS=function(e,t,n,r,i){if(Br.App.disableEmbedDownload)return 8;if(1===n)return(o=t.get_node()).hasProperty(Kc.b.embeddedFileContainer)?32:2;if(2===n&&(t.get_contextId()===cl.n&&t.view.get_selectionManager()&&(t=t.view.get_selectionManager().get_selectionContextForActionDispatch()),af.EmbeddedFileReader.isEmbeddedFileOrFloatingEmbeddedFileContext(t))){var o=t.get_node(),a=af.EmbeddedFileReader.getFileUrl(o);uS();try{cS(a)}catch(e){C.ULS.sendTraceTag(37515617,339,15,"Window.Open failed with error: {0}",e)}}return 32},cS=function(e){if(1!==Br.App.get_mode()||!L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteSaveFileThroughRequest")||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsTeamsSession")&&G.y.get_isElectron())window.open(e);else{var t=new Ar.QueryStringBuilder(e).getParam("Filename"),n=new XMLHttpRequest;n.onloadstart=function(e){n.responseType="blob"},n.open("GET",e,!0),n.onload=function(r){try{var i=n.response,o=t;if(!o&&(o="GetImage",i.type&&-1!=i.type.indexOf("image/"))){["bmp","gif","ico","jpeg","png","svg","tiff","webp"].forEach((function(e){-1!=i.type.indexOf(e)&&(o="GetImage."+e)}))}if(o=decodeURIComponent(escape(o)),G.y.get_isInternetExplorerOrEdge())return"undefined"!=typeof navigator.msSaveBlob?void navigator.msSaveBlob(i,o):void window.open(e);var a=window.URL||window.webkitURL,s=a.createObjectURL(i),l=document.createElement("a");l.href=s,l.download=o,document.body.appendChild(l),l.click(),setTimeout((function(){document.body.removeChild(l),a.revokeObjectURL(s)}),0)}catch(t){window.open(e)}},n.send()}},uS=function(){ve.v("DownloadCheck","1",6e4,"/o/GetImage.ashx")},gS=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.registerActions=function(){this._actionManager.addAction(ii.LN,cl.n,o.i(this,this.openMoreColorsDialog,"openMoreColorsDialog"))},e.prototype.openMoreColorsDialog=function(e,t,n,r,i){if(1===n)return 32;L.AFrameworkApplication.get_theActionManager().processActionWithData(ii.zG,2,i);var o=i,a=o&&o.highlight>=0&&o.highlight<=16777215?o.highlight:0;return Br.App.get_activeAppFrame().dismissFloatie(),new EC("Highlighter",ii.pV).showColorPickerDialog(a),32},e.getHighlighterColorActorWithResolvedDependencies=function(){return new e(L.AFrameworkApplication.get_theActionManager())},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=e.getHighlighterColorActorWithResolvedDependencies())},e._singletonInstance=null,e}();(0,o.l)(gS,"HighlighterColorActor",null,[]);var pS=n(4329),dS=n(991),hS=(0,o.y)("IInsertLinkDialogFactory"),_S=function(){function e(t,n){if(this._internalLinkManager=null,this._trackChangeEditor=null,this._interactiveView=null,this._selectedContext=null,this._friendlyText=null,this._isDisplayTextDisabled=!1,this._interactiveView=Ur.InteractiveViewManager.get_instance().get_selectionView(),this._selectedContext=t,e.get_addHyperlinkWhenSelectionContainsLineBreak()&&Pa.SelectionEditor.isTextRangeContext(t)){var r=Pa.SelectionEditor.trimLeadingLineBreakObjectFromTextRange(this._selectedContext);Pa.SelectionEditor.isTextRangeContext(r)?this._selectedContext=r:C.ULS.sendTraceTag(41522313,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}var i=Pa.SelectionEditor.trimWhitespaceFromTextRange(this._selectedContext);Pa.SelectionEditor.isTextRangeContext(i)&&(this._selectedContext=i)}return e.prototype.get_internalLinkManager=function(){return this._internalLinkManager||(this._internalLinkManager=se.w.get_instance().tryResolve(qs.v))},e.prototype.get_trackChangeEditor=function(){return this._trackChangeEditor||(this._trackChangeEditor=se.w.get_instance().resolve(cc.x).get_instance())},e.prototype.get_titleText=function(){return Box4Intl.Box4Strings.l_InsertLinkTitle},e.prototype.get_insertButtonText=function(){return Box4Intl.Box4Strings.l_InsertLinkButtonText},e.prototype.dispose=function(){},e.prototype.expandSelectionToFullHyperlink=function(e,t,n){if(t!==this._selectedContext.get_cpEnd()||e!==this._selectedContext.get_cpBegin()){var r=ss.SelectionFactory.createTextRangeOrIpSelection(n,e,t);this._interactiveView.get_selectionManager().setSelection(r);var i=Pa.SelectionEditor.trimWhitespaceFromTextRange(r.get_firstContext().clone());this._selectedContext=i}},e.prototype.getDialogContent=function(t,n,r,i,o){if(o.val=Hs.HyperlinkReader.getSelectedHyperlinks(this._selectedContext),r.val=this._selectedContext.get_cpBegin(),i.val=this._selectedContext.get_cpEnd(),n.val="",!o.val.length)return this._friendlyText=t.substring(this._selectedContext.get_cpBegin(),this._selectedContext.get_cpEnd()),!0;if(o.val[0].hyperlink){for(var a=0,s=0,l=Math.max(0,t.length-1),c=0,u=0;u<o.val.length;u++)o.val[u].cpBegin>=s&&(e.get_hyperlinkStrategy().getHyperlink(this._selectedContext,o.val[u],(0,p.m)((function(){return a}),(function(e){return a=e})),(0,p.m)((function(){return s}),(function(e){return s=e}))),l=Math.min(a,l),c=Math.max(s,c));return r.val=Math.min(l,r.val),i.val=Math.max(c,i.val),this._friendlyText=t.substring(r.val,i.val),r.val===l&&(n.val=o.val[0].hyperlink.get_url()),!0}return!1},e.prototype.trimTrackedChanges=function(t){e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().trimTrackChangeOnTextRange(t)},e.prototype.insertLinkDialogHandler=function(t,n){if(this._interactiveView.get_isAttached()){var r;r=e.get_hyperlinkExpandEditEnabled()?Hs.HyperlinkReader.getSelectedHyperlinks(this._selectedContext):Hs.HyperlinkReader.getHyperlinksInRange(this._selectedContext,!0);var i=this._interactiveView.get_selectionManager().get_selectionCollection().get_currentSelection();if(i){var o=i.get_firstContext();if(cs.ParagraphReader.isParagraphContext(o)&&(o=_s.y.createTextRange(o.get_node(),0,cs.ParagraphReader.textLength(o.get_node()))),e.get_addHyperlinkWhenSelectionContainsLineBreak()&&Pa.SelectionEditor.isTextRangeContext(o)){var a=Pa.SelectionEditor.trimLeadingLineBreakObjectFromTextRange(o);Pa.SelectionEditor.isTextRangeContext(a)?o=a:C.ULS.sendTraceTag(41522316,324,15,"Should not reach here, the selectedContext should be textRangeContext after trimleadinglinebreak.")}var s=Pa.SelectionEditor.trimWhitespaceFromTextRange(o);if(Pa.SelectionEditor.isTextRangeContext(s)&&(o=s),0===t||us.n.get_instance().get_item(22)&&32!==L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(o,ii.jg,1,!0,null,null)||this.isInvalidSelectionForHyperlinkDialog(r)||!this._selectedContext.equals(o))this._interactiveView.synchronizeEditingView();else{Xi.t.mark(5562),us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager()&&Br.App.get_theCoauthManager().get_isCoauthorable()&&this._interactiveView.get_selectionManager().acquireLocksForSelection();var l=new as.GraphTransaction(15);l.setFromNode(this._selectedContext.get_node()),this._selectedContext.get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(4);var c=n.txtDisplay,u=n.txtLink.trim();this.insertLink(c,u,r),l.dispose(),Xi.t.mark(5563),this.cleanUp()}}else C.ULS.sendTraceTag(41522314,324,50,"InsertLinkDialog:InsertLinkDialogHandler - CurrentSelection is null.")}},e.prototype.isInvalidSelectionForHyperlinkDialog=function(t){return!e.get_hyperlinkExpandEditEnabled()&&(t.length>1||1===t.length&&(t[0].cpBegin>this._selectedContext.get_cpBegin()||t[0].cpEnd<this._selectedContext.get_cpEnd()))},e.prototype.trackEditHyperLink=function(t,n,r,i,o){var a=null,s=null;if(i)s=_s.y.createTextRange(this._selectedContext.get_node(),this._selectedContext.get_cpBegin(),this._selectedContext.get_cpBegin()+t.length),e.get_hyperlinkEditor().editHyperlinkUrl(s,r,n),a=ss.SelectionFactory.createIpSelection(this._selectedContext.get_node(),this._selectedContext.get_cpBegin()+t.length);else{e.get_hyperlinkEditor().normalizeHyperlinksinGraphNodeContext(this._selectedContext,2),this.get_trackChangeEditor().setTrackChangeOnContext(this._selectedContext,2);var l=_s.y.createIpContext(this._selectedContext.get_node(),this._selectedContext.get_cpEnd());e.get_characterPropertiesEditor().replaceTextRange(l,t,!0),s=_s.y.createTextRange(this._selectedContext.get_node(),this._selectedContext.get_cpEnd(),this._selectedContext.get_cpEnd()+t.length),e.get_hyperlinkEditor().createHyperlink(s,n,o,!1),a=ss.SelectionFactory.createIpSelection(this._selectedContext.get_node(),this._selectedContext.get_cpEnd()+t.length)}a&&this._interactiveView.get_selectionManager().setSelection(a)},e.prototype.insertLink=function(t,n,r){var i=null;if(t||(t=n),n&&(!r.length||n!==r[0].hyperlink.get_url())){n=Hs.HyperlinkReader.getSanitizedUrl(n);var o="",a="";this.get_internalLinkManager()&&this.get_internalLinkManager().tryConvertToRelativeLink(n,(0,p.m)((function(){return o}),(function(e){return o=e})),!1,(0,p.m)((function(){return a}),(function(e){return a=e})))&&(n=o)}this._isDisplayTextDisabled||(t=e.get_hyperlinkEditor().replaceWhiteSpaceForRender(t));var s=!1;if(r.length&&!e.get_hyperlinkExpandEditEnabled()||!n){if(r.length>0){var l,c,u=r[0],g=e.get_hyperlinkStrategy().getHyperlink(this._selectedContext,u,(0,p.m)((function(){return l}),(function(e){return l=e})),(0,p.m)((function(){return c}),(function(e){return c=e})));if(n)if(u.hyperlink.get_hasEmbeddedRuns()){if(n!==u.hyperlink.get_url())if(e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()){_=_s.y.createTextRange(this._selectedContext.get_node(),l,l+t.length);e.get_hyperlinkEditor().editHyperlinkUrl(_,u.hyperlink,n)}else e.get_hyperlinkStrategy().updateHyperlinksUrl(n,g);if(t!==this._friendlyText){e.get_hyperlinkStrategy().needGroupHyperlinkRanges()&&e.get_hyperlinkStrategy().removeHyperlinks(this._selectedContext,g),e.get_characterPropertiesEditor().replaceTextRange(_s.y.createTextRange(this._selectedContext.get_node(),l,c),t,!0);var d=_s.y.createTextRange(this._selectedContext.get_node(),l,l+t.length);this.trimTrackedChanges(d),e.get_hyperlinkStrategy().needGroupHyperlinkRanges()&&e.get_hyperlinkEditor().createHyperlink(d,n,!1),i=ss.SelectionFactory.createIpSelection(this._selectedContext.get_node(),l+t.length),s=!0}}else if(e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()){var h=cs.ParagraphReader.text(this._selectedContext.get_node()).substring(this._selectedContext.get_cpBegin(),this._selectedContext.get_cpEnd())===t;this.trackEditHyperLink(t,n,r[0].hyperlink,h,!1)}else{e.get_hyperlinkStrategy().removeHyperlinks(this._selectedContext,g),e.get_characterPropertiesEditor().replaceTextRange(_s.y.createTextRange(this._selectedContext.get_node(),l,c),t,!0);var _=_s.y.createTextRange(this._selectedContext.get_node(),l,l+t.length);e.get_hyperlinkEditor().createHyperlink(_,n,!1),i=ss.SelectionFactory.createIpSelection(this._selectedContext.get_node(),l+t.length)}else e.get_hyperlinkEditor().removeHyperlink(u.paragraph,u.hyperlink)}}else{var m=r.length>0,f=!0;if(e.get_isKeepHyperlinkFormatFixEnabled())f=cs.ParagraphReader.text(this._selectedContext.get_node()).substring(this._selectedContext.get_cpBegin(),this._selectedContext.get_cpEnd())!==t;if(e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()&&1===r.length)return void this.trackEditHyperLink(t,n,r[0].hyperlink,!f,m);if(m)for(var y=0;y<r.length;y++)e.get_hyperlinkEditor().removeHyperlink(this._selectedContext.get_node(),r[y].hyperlink,!1);f&&e.get_characterPropertiesEditor().replaceTextRange(this._selectedContext,t,!0),!f&&e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()&&this.get_trackChangeEditor().setTrackChangeOnContext(this._selectedContext,1);var _=_s.y.createTextRange(this._selectedContext.get_node(),this._selectedContext.get_cpBegin(),this._selectedContext.get_cpBegin()+t.length);e.get_hyperlinkEditor().createHyperlink(_,n,m,!1),i=ss.SelectionFactory.createIpSelection(this._selectedContext.get_node(),this._selectedContext.get_cpBegin()+t.length)}s&&e.get_trackChangeManager().alertUntrackedChange(4),i&&this._interactiveView.get_selectionManager().setSelection(i)},e.get_hyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=se.w.get_instance().resolve(Ja.o))},e.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=se.w.get_instance().resolve(Va.x))},e.get_trackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},e.get_hyperlinkStrategy=function(){return e._hyperlinkStrategy||(e._hyperlinkStrategy=se.w.get_instance().resolve(pS.n))},e.get_hyperlinkExpandEditEnabled=function(){return null==e._HyperlinkExpandEditEnabled&&(L.AFrameworkApplication.appSettingsManager?e._HyperlinkExpandEditEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HyperlinkExpandEditEnabled"):e._HyperlinkExpandEditEnabled=!1),e._HyperlinkExpandEditEnabled},e.get_isKeepHyperlinkFormatFixEnabled=function(){return null==e._isKeepHyperlinkFormatFixEnabled&&(L.AFrameworkApplication.appSettingsManager?e._isKeepHyperlinkFormatFixEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("KeepHyperlinkFormatFixIsEnabled"):e._isKeepHyperlinkFormatFixEnabled=!1),e._isKeepHyperlinkFormatFixEnabled},e.get_isHyperlinkUrlValidationEnabled=function(){return null==e._isHyperlinkUrlValidationEnabled&&(L.AFrameworkApplication.appSettingsManager?e._isHyperlinkUrlValidationEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HyperlinkUrlValidationIsEnabled"):e._isHyperlinkUrlValidationEnabled=!1),e._isHyperlinkUrlValidationEnabled},e.get_addHyperlinkWhenSelectionContainsLineBreak=function(){return null==e._AddHyperlinkWhenSelectionContainsLineBreak&&(L.AFrameworkApplication.appSettingsManager?e._AddHyperlinkWhenSelectionContainsLineBreak=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AddHyperlinkWhenSelectionContainsLineBreak"):e._AddHyperlinkWhenSelectionContainsLineBreak=!1),e._AddHyperlinkWhenSelectionContainsLineBreak},e._hyperlinkEditor=null,e._characterPropertiesEditor=null,e._trackChangeManager=null,e._hyperlinkStrategy=null,e._HyperlinkExpandEditEnabled=null,e._isKeepHyperlinkFormatFixEnabled=null,e._isHyperlinkUrlValidationEnabled=null,e._AddHyperlinkWhenSelectionContainsLineBreak=null,e.source="Source",e.commandingSource="CommandingInterface",e.displayText="DisplayText",e.url="Url",e.id="InsertLinkDialog",e}();(0,o.l)(_S,"AInsertLinkDialog",null,[Sys.IDisposable]);var mS=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,Box4Intl.Box4Strings.l_InsertLinkDisplayText,Box4Intl.Box4Strings.l_InsertLinkAddress)},e.dialogHtmlFormat="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='txtDisplay' >{0}</label> <input type='text' id='txtDisplay' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtLink' >{1}</label> <input type='text' id='txtLink' class='WACDialogInput' autocomplete=\"off\"/> </div>",e}();(0,o.l)(mS,"InsertLinkDialogHtml",null,[]);var fS=function(e){function t(t,n){var r=e.call(this,t,n)||this;r._dialog=null,r._dialog=new ri.o,r._dialog.set_dialogId(_S.id),r._friendlyText="";var i,a="",s=cs.ParagraphReader.text(r._selectedContext.get_node()),l=r._selectedContext.get_cpBegin(),c=r._selectedContext.get_cpEnd();_S.get_hyperlinkExpandEditEnabled()?r.getDialogContent(s,(0,p.m)((function(){return a}),(function(e){return a=e})),(0,p.m)((function(){return l}),(function(e){return l=e})),(0,p.m)((function(){return c}),(function(e){return c=e})),(0,p.m)((function(){return i}),(function(e){return i=e}))):1===(i=Hs.HyperlinkReader.getHyperlinksInRange(r._selectedContext,!0)).length&&i[0].cpBegin<=r._selectedContext.get_cpBegin()&&i[0].cpEnd>=r._selectedContext.get_cpEnd()&&i[0].hyperlink?(r._friendlyText=_S.get_hyperlinkStrategy().getHyperlinkText(t,i[0],s),a=i[0].hyperlink.get_url()):i.length||(r._friendlyText=s.substring(r._selectedContext.get_cpBegin(),r._selectedContext.get_cpEnd()));var u=(0,f.e)(Object,n);if(u&&(u[_S.source]&&u[_S.source]===_S.commandingSource||u[_S.url]&&u[_S.displayText])){var g=u[_S.displayText],d=u[_S.url];return r.insertLink(g,d,i),r}_S.get_hyperlinkExpandEditEnabled()&&i[0]&&r.expandSelectionToFullHyperlink(l,c,i[0].paragraph),r._dialog.set_dialogHtml(mS.get_dialogHtml()),""===a.trim()&&r._dialog.setButtonText(1,r.get_insertButtonText());var h={txtLink:a,txtDisplay:r._friendlyText};if(r._dialog.set_dialogOnKeyPressHandler(o.i(r,r.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")),r._dialog.set_dialogOnKeyDownHandler(o.i(r,r.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")),r._dialog.initializeAndShow(r.get_titleText(),o.i(r,r.insertLinkDialogHandler,"insertLinkDialogHandler"),h),_S.get_isHyperlinkUrlValidationEnabled()){var _=document.getElementById("txtLink");qo.n.addHandler(_,Le.d.input,o.i(r,r.onLinkChanged,"onLinkChanged")),qo.n.addHandler(_,Le.d.change,o.i(r,r.onLinkChanged,"onLinkChanged"))}(document.getElementById("txtLink").focus(),_S.get_addHyperlinkWhenSelectionContainsLineBreak())?Xp.t(_s.y.createContextFromCpResult(l,c,!1,r._selectedContext.get_node())).length>0&&(r._isDisplayTextDisabled=!0,document.getElementById("txtDisplay").disabled=!0):i.length<=1&&_S.get_hyperlinkStrategy().containsBlob(t,i[0],1===i.length)&&(r._isDisplayTextDisabled=!0,document.getElementById("txtDisplay").disabled=!0);return r}return(0,S.t)(t,e),t.prototype.onLinkChanged=function(e){if(this._dialog){var t=document.getElementById("txtLink");this._dialog.setButtonState(1,!t||!t.value.length||Hs.HyperlinkReader.isValidUrl(t.value))}},t.prototype.dialogDefaultEnterKeyHandler=function(e){return!!this._dialog&&(_S.get_isHyperlinkUrlValidationEnabled()?!!this._dialog.getButtonState(this._dialog.getDefaultButton())&&this._dialog.dialogDefaultEnterKeyHandler(e):this._dialog.dialogDefaultEnterKeyHandler(e))},t.prototype.cleanUp=function(){if(_S.get_isHyperlinkUrlValidationEnabled()){var e=document.getElementById("txtLink");e&&(qo.n.removeHandler(e,Le.d.change,o.i(this,this.onLinkChanged,"onLinkChanged")),qo.n.removeHandler(e,Le.d.input,o.i(this,this.onLinkChanged,"onLinkChanged")))}this._dialog&&(this._dialog=null)},t}(_S);(0,o.l)(fS,"InsertLinkDialog",_S,[]);var yS=function(e){function t(t,n){var r=e.call(this,t,n)||this,i=new ri.o(!1,!1,!0),a={};a.displayTextLabel=Box4Intl.Box4Strings.l_InsertLinkDisplayText,a.addressLabel=Box4Intl.Box4Strings.l_InsertLinkAddress,r._friendlyText="";var s,l="",c=cs.ParagraphReader.text(r._selectedContext.get_node()),u=r._selectedContext.get_cpBegin(),g=r._selectedContext.get_cpEnd();_S.get_hyperlinkExpandEditEnabled()?r.getDialogContent(c,(0,p.m)((function(){return l}),(function(e){return l=e})),(0,p.m)((function(){return u}),(function(e){return u=e})),(0,p.m)((function(){return g}),(function(e){return g=e})),(0,p.m)((function(){return s}),(function(e){return s=e}))):1===(s=Hs.HyperlinkReader.getHyperlinksInRange(r._selectedContext,!0)).length&&s[0].cpBegin<=r._selectedContext.get_cpBegin()&&s[0].cpEnd>=r._selectedContext.get_cpEnd()&&s[0].hyperlink?(r._friendlyText=_S.get_hyperlinkStrategy().getHyperlinkText(t,s[0],c),l=s[0].hyperlink.get_url()):s.length||(r._friendlyText=c.substring(r._selectedContext.get_cpBegin(),r._selectedContext.get_cpEnd()));var d=(0,f.e)(Object,n);if(d&&(d[_S.source]&&d[_S.source]===_S.commandingSource||d[_S.url]&&d[_S.displayText])){var h=d[_S.displayText],_=d[_S.url];return r.insertLink(h,_,s),r}_S.get_hyperlinkExpandEditEnabled()&&s[0]&&r.expandSelectionToFullHyperlink(u,g,s[0].paragraph);var m=CommonUIStrings.l_DialogOk;(""===l.trim()&&(m=r.get_insertButtonText()),i.setButtonText(1,m),a.txtLink=l,a.txtDisplay=r._friendlyText,_S.get_addHyperlinkWhenSelectionContainsLineBreak())?Xp.t(_s.y.createContextFromCpResult(u,g,!1,r._selectedContext.get_node())).length>0&&(r._isDisplayTextDisabled=!0,a.textDisplayDisabled=!0):s.length<=1&&_S.get_hyperlinkStrategy().containsBlob(t,s[0],1===s.length)&&(r._isDisplayTextDisabled=!0,a.textDisplayDisabled=!0);var y={id:_S.id,bodyControls:a};return i.initializeAndShow(r.get_titleText(),o.i(r,r.insertLinkDialogHandler,"insertLinkDialogHandler"),y),r}return(0,S.t)(t,e),t.prototype.cleanUp=function(){},t}(_S);(0,o.l)(yS,"ReactInsertLinkDialog",_S,[]);var CS=function(){function e(){this._isReactDialogEnabled=!1,this._isReactDialogEnabled=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactDialogEnabled()}return e.prototype.createInsertLinkDialog=function(e,t){return this._isReactDialogEnabled?new yS(e,t):new fS(e,t)},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,o.l)(CS,"InsertLinkDialogFactory",null,[hS]);var SS="InsertMultiParagraphLinkDialog",vS=function(e){function t(t,n){var r=e.call(this)||this;r._selectedContexts=null,r._interactiveView=null,r._selection=null,r.firstExpandedCpBegin=0,r.lastExpandedCpEnd=0,r._selectedContexts=t,r._interactiveView=Ur.InteractiveViewManager.get_instance().get_selectionView(),r._selection=r._interactiveView.get_selectionManager().get_selectionCollection().get_currentSelection();var i="";return r.firstExpandedCpBegin=t[0].get_cpBegin(),r.lastExpandedCpEnd=t[t.length-1].get_cpEnd(),r.set_dialogId(SS),r.updateExpandCpsAndGetSelectedUrl((0,p.m)((function(){return i}),(function(e){return i=e}))),r.showDialog("",i),r}return(0,S.t)(t,e),t.prototype.showDialog=function(e,n){C.ULS.sendTraceTag(41261264,324,50,"Insert multiple paragraph link dialog shows."),this.set_dialogHtml(mS.get_dialogHtml()),""===n.trim()&&this.setButtonText(1,Box4Intl.Box4Strings.l_InsertLinkButtonText);var r={txtLink:n,txtDisplay:e};if(this.initializeAndShow(Box4Intl.Box4Strings.l_InsertLinkTitle,o.i(this,this.insertLinkDialogHandler,"insertLinkDialogHandler"),r),document.getElementById("txtLink").focus(),document.getElementById("txtDisplay").disabled=!0,t.get_isHyperlinkUrlValidationEnabled()){var i=document.getElementById("txtLink");qo.n.addHandler(i,Le.d.input,o.i(this,this.onLinkChanged,"onLinkChanged")),qo.n.addHandler(i,Le.d.change,o.i(this,this.onLinkChanged,"onLinkChanged"))}},t.prototype.hide=function(){if(t.get_isHyperlinkUrlValidationEnabled()){var n=document.getElementById("txtLink");n&&(qo.n.removeHandler(n,Le.d.change,o.i(this,this.onLinkChanged,"onLinkChanged")),qo.n.removeHandler(n,Le.d.input,o.i(this,this.onLinkChanged,"onLinkChanged")))}e.prototype.hide.call(this)},t.prototype.onLinkChanged=function(e){var t=document.getElementById("txtLink");this.setButtonState(1,!t||!t.value.length||Hs.HyperlinkReader.isValidUrl(t.value))},t.prototype.dialogDefaultEnterKeyHandler=function(n){return t.get_isHyperlinkUrlValidationEnabled()?!!this.getButtonState(this.getDefaultButton())&&e.prototype.dialogDefaultEnterKeyHandler.call(this,n):e.prototype.dialogDefaultEnterKeyHandler.call(this,n)},t.prototype.updateExpandCpsAndGetSelectedUrl=function(e){var n,r;e.val="";var i=this._selectedContexts.length,o=Hs.HyperlinkReader.getHyperlinksInRange(this._selectedContexts[0],!1);o.length>0&&(t.get_hyperlinkStrategy().getHyperlink(this._selectedContexts[0],o[0],(0,p.m)((function(){return n}),(function(e){return n=e})),(0,p.m)((function(){return r}),(function(e){return r=e}))),n<=this._selectedContexts[0].get_cpBegin()&&(e.val=o[0].hyperlink.get_url()),this.firstExpandedCpBegin=Math.min(this.firstExpandedCpBegin,n));var a=Hs.HyperlinkReader.getHyperlinksInRange(this._selectedContexts[i-1],!1);a.length>0&&(t.get_hyperlinkStrategy().getHyperlink(this._selectedContexts[i-1],a[a.length-1],(0,p.m)((function(){return n}),(function(e){return n=e})),(0,p.m)((function(){return r}),(function(e){return r=e}))),this.lastExpandedCpEnd=Math.max(this.lastExpandedCpEnd,r)),this.tryExpandSelectionToFullHyperlink(this.firstExpandedCpBegin,this.lastExpandedCpEnd)},t.prototype.tryExpandSelectionToFullHyperlink=function(e,t){var n=this._selectedContexts.length;if(e!==this._selectedContexts[0].get_cpBegin()||t!==this._selectedContexts[n-1].get_cpEnd()){var r=_s.y.createIpContext(this._selectedContexts[0].get_node(),e),i=ss.SelectionFactory.createSelectionFromContext(r),o=_s.y.createIpContext(this._selectedContexts[n-1].get_node(),t),a=ss.SelectionFactory.extendSelection(i,o),s=this.getTextRangeContext(a.get_firstContext().clone()),l=this.getTextRangeContext(a.get_lastContext().clone());s&&l&&(this._selectedContexts[0]=s,this._selectedContexts[n-1]=l,this._interactiveView.get_selectionManager().setSelection(a),this._selection=a)}},t.prototype.insertLinkDialogHandler=function(e,n){if(this._interactiveView.get_isAttached()){var r=this._interactiveView.get_selectionManager().get_selectionCollection().get_currentSelection();if(r)if(r.equals(this._selection)&&0!==e){var i=new as.GraphTransaction(15);i.setFromNode(this._selectedContexts[0].get_node());for(var o=0;o<this._selectedContexts.length;o++)this._selectedContexts[o].get_node().getGraphSpace().get_graphTransactionOperations().blockRttSend(4);var a=n.txtLink.trim(),s=this.deleteAllExistHyperlinks(),l=this.insertHyperlinks(a);(s||l)&&t.get_trackChangeManager().alertUntrackedChange(4),this.hide(),i.dispose()}else this._interactiveView.synchronizeEditingView()}},t.prototype.insertHyperlinks=function(e){if(!e)return!1;e=Hs.HyperlinkReader.getSanitizedUrl(e);for(var n=0;n<this._selectedContexts.length;n++){var r=this._selectedContexts[n];if(!t.get_addHyperlinkWhenSelectionContainsLineBreak()||!Pa.SelectionEditor.isTextRangeContext(r)||(r=Pa.SelectionEditor.trimLeadingLineBreakObjectFromTextRange(r),Pa.SelectionEditor.isTextRangeContext(r))){var i=_s.y.createTextRange(this._selectedContexts[n].get_node(),r.get_cpBegin(),r.get_cpEnd());this.trimTrackedChanges(i),t.get_hyperlinkEditor().createHyperlink(i,e,!1)}}return!0},t.prototype.trimTrackedChanges=function(e){t.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&t.get_trackChangeManager().trimTrackChangeOnTextRange(e)},t.prototype.getTextRangeContext=function(e){return cs.ParagraphReader.isParagraphContext(e)&&!Pa.SelectionEditor.isBlockContext(e)&&cs.ParagraphReader.textLength(e.get_node())?_s.y.createTextRange(e.get_node(),0,cs.ParagraphReader.textLength(e.get_node())):Pa.SelectionEditor.isTextRangeContext(e)?e:null},t.prototype.deleteAllExistHyperlinks=function(){for(var e=!1,n=0,r=this._selectedContexts;n<r.length;n++){var i=r[n],o=Hs.HyperlinkReader.getHyperlinksInRange(i,!1);o&&(e=t.get_hyperlinkStrategy().removeHyperlinks(i,o)||e)}return e},t.get_hyperlinkStrategy=function(){return t._hyperlinkStrategy||(t._hyperlinkStrategy=se.w.get_instance().resolve(pS.n))},t.get_trackChangeManager=function(){return t._trackChangeManager||(t._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},t.get_hyperlinkEditor=function(){return t._hyperlinkEditor||(t._hyperlinkEditor=se.w.get_instance().resolve(Ja.o))},t.get_addHyperlinkWhenSelectionContainsLineBreak=function(){return null==t._AddHyperlinkWhenSelectionContainsLineBreak&&(L.AFrameworkApplication.appSettingsManager?t._AddHyperlinkWhenSelectionContainsLineBreak=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AddHyperlinkWhenSelectionContainsLineBreak"):t._AddHyperlinkWhenSelectionContainsLineBreak=!1),t._AddHyperlinkWhenSelectionContainsLineBreak},t.get_isHyperlinkUrlValidationEnabled=function(){return null==t._isHyperlinkUrlValidationEnabled&&(L.AFrameworkApplication.appSettingsManager?t._isHyperlinkUrlValidationEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HyperlinkUrlValidationIsEnabled"):t._isHyperlinkUrlValidationEnabled=!1),t._isHyperlinkUrlValidationEnabled},t._hyperlinkStrategy=null,t._trackChangeManager=null,t._hyperlinkEditor=null,t._AddHyperlinkWhenSelectionContainsLineBreak=null,t._isHyperlinkUrlValidationEnabled=null,t}(ri.o);(0,o.l)(vS,"InsertMultiParagraphLinkDialog",ri.o,[]);var bS=function(){function e(){}return e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_hyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=se.w.get_instance().resolve(Ja.o))},e.get_contentControlChpHelper=function(){return e._ccChpHelper||(e._ccChpHelper=se.w.get_instance().tryResolve(ff.k))},e.get_hyperlinkStrategy=function(){return e._hyperlinkStrategy||(e._hyperlinkStrategy=se.w.get_instance().resolve(pS.n))},e.get_externalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=se.w.get_instance().resolveFuture(gh.i))},e.get_trackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},e.get_trackChangeReader=function(){return e._trackChangeReader||(e._trackChangeReader=se.w.get_instance().resolve(za.p).get_instance())},e.get_viewAndOpenImageHyperlinksEnabled=function(){return null==e._ViewAndOpenImageHyperlinksEnabled&&(L.AFrameworkApplication.appSettingsManager?e._ViewAndOpenImageHyperlinksEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ViewAndOpenImageHyperlinksIsEnabled"):e._ViewAndOpenImageHyperlinksEnabled=!1),e._ViewAndOpenImageHyperlinksEnabled},e.get_hyperlinkExpandEditEnabled=function(){return null==e._HyperlinkExpandEditEnabled&&(L.AFrameworkApplication.appSettingsManager?e._HyperlinkExpandEditEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HyperlinkExpandEditEnabled"):e._HyperlinkExpandEditEnabled=!1),e._HyperlinkExpandEditEnabled},e.get_multiParagraphHyperlinkEditEnabled=function(){return null==e._MultiParagraphHyperlinkEditEnabled&&(L.AFrameworkApplication.appSettingsManager?e._MultiParagraphHyperlinkEditEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MultiParagraphHyperlinkEditEnabled"):e._MultiParagraphHyperlinkEditEnabled=!1),e._MultiParagraphHyperlinkEditEnabled},e.get_addHyperlinkWhenSelectionContainsLineBreak=function(){return null==e._AddHyperlinkWhenSelectionContainsLineBreak&&(L.AFrameworkApplication.appSettingsManager?e._AddHyperlinkWhenSelectionContainsLineBreak=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AddHyperlinkWhenSelectionContainsLineBreak"):e._AddHyperlinkWhenSelectionContainsLineBreak=!1),e._AddHyperlinkWhenSelectionContainsLineBreak},e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(ii.jg,cl.n,e.hyperlinkActionViewHandler),t.addAction(ii.jg,cl.V,e.insertLink),t.addAction(ii.jg,cl.Z,e.insertLink),t.setActionFlags(ii.jg,1028),t.addAction(ii.FE,cl.n,e.hyperlinkActionViewHandler),t.addAction(ii.FE,cl.V,e.removeLink),t.addAction(ii.FE,cl.Z,e.removeLink),t.setActionFlags(ii.FE,1028),t.addAction(ii.Ot,cl.n,e.hyperlinkActionViewHandler),t.addAction(ii.Ot,cl.V,e.selectLink),t.addAction(ii.Ot,cl.Z,e.selectLink),t.addAction(ii.cK,cl.n,e.hyperlinkActionViewHandler),t.addAction(ii.cK,cl.V,e.openTextLink),t.addAction(ii.cK,cl.Z,e.openTextLink),t.addAction(ii.cK,cl.H,e.openImageLink),t.addAction(ii.cK,cl.X,e.openImageLink),e.get_viewAndOpenImageHyperlinksEnabled()&&t.addAction(ii.cK,cl.r,e.openImageLink),t.addAction(ii.dm,cl.n,e.hyperlinkActionViewHandler)},e.hyperlinkActionViewHandler=function(t,n,r,i,o){if(e.get_multiParagraphHyperlinkEditEnabled())return e.hyperlinksActionViewHandler(t,n,r,i,o);if(!n.view.get_isInteractiveView())return 2;var a=n.view.get_selectionManager();if(!a||!a.get_selectionCollection()||!a.get_selectionCollection().get_length())return 8;var s=a.get_selectionCollection().get_currentSelection(),l=s.get_firstContext().clone();if(2===s.get_length()){var c=s.get_item(1);if(!Pa.SelectionEditor.isTextRangeContext(l)||!Pa.SelectionEditor.isEndOfParagraphContext(c)||l.get_node()!==c.get_node())return 8}else if(s.get_length()>2)return 8;if(a.get_selectionCollection().isOutlineLevelSelection)return 8;if(cs.ParagraphReader.isParagraphContext(l)&&!Pa.SelectionEditor.isBlockContext(l)){var u=l.get_node();l=_s.y.createTextRange(u,0,cs.ParagraphReader.textLength(u))}return t===ii.dm?e.copyLinkHelper(t,n,l,r,i,o):L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l,t,r,!0,i,o)},e.hyperlinksActionViewHandler=function(t,n,r,i,o){if(!n.view.get_isInteractiveView())return 2;var a=n.view.get_selectionManager();if(!a||!a.get_selectionCollection()||!a.get_selectionCollection().get_length())return 8;if(a.get_selectionCollection().isOutlineLevelSelection)return 8;var s,l=a.get_selectionCollection().get_currentSelection(),c=e.isSingleParagraphContext(l);if(c)s=e.getTextRangeFromParagraph(l.get_firstContext().clone(),!0);else{for(var u=l.get_item(0).clone(),g=1;g<l.get_length()&&(!cs.ParagraphReader.textLength(u.get_node())||Pa.SelectionEditor.isEndOfParagraphContext(u)||e.get_addHyperlinkWhenSelectionContainsLineBreak()&&Xp.v(u));)u=l.get_item(g).clone(),g++;s=e.getTextRangeFromParagraph(u,!1)}return e.get_addHyperlinkWhenSelectionContainsLineBreak()&&Pa.SelectionEditor.isTextRangeContext(s)&&Xp.v(s)?8:Pa.SelectionEditor.isTextRangeContext(s)||c?t===ii.dm?e.copyLinkHelper(t,n,s,r,i,o):L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(s,t,r,!0,i,o):8},e.isSingleParagraphContext=function(e){if(1===e.get_length())return!0;if(2===e.get_length()){var t=e.get_firstContext().clone(),n=e.get_item(1);return!(!Pa.SelectionEditor.isTextRangeContext(t)||!Pa.SelectionEditor.isEndOfParagraphContext(n)||t.get_node()!==n.get_node())}return!1},e.composeHyperlinkEditableContexts=function(t,n){t.val=null;for(var r=[],i=0;i<n.get_length();i++){var o=e.getTextRangeFromParagraph(n.get_item(i).clone(),!1);if(!Pa.SelectionEditor.isTextRangeContext(o)){if(Pa.SelectionEditor.isEndOfParagraphContext(o)||cs.ParagraphReader.isParagraphContext(o))continue;return!1}e.get_addHyperlinkWhenSelectionContainsLineBreak()&&Xp.v(o)||Array.add(r,o)}return t.val=ku.m(mf.s,r),!e.get_addHyperlinkWhenSelectionContainsLineBreak()||t.val.length>0},e.insertLink=function(t,n,r,i,o){if(e.get_multiParagraphHyperlinkEditEnabled())return e.insertLinks(t,n,r,i,o);if(!e.canInsertHyperlink()||!e.canMakeHyperlinkModification(n))return 8;if(Oa.SelectionManager.get_instance().get_selectionCollection().isOutlineLevelSelection)return 8;if(e.get_viewAndOpenImageHyperlinksEnabled()&&Pa.SelectionEditor.isInlineImageContext(n))return 2;var a,s=n;if(!e.isValidTextContextForHyperlinkAction(s,!0,(0,p.m)((function(){return a}),(function(e){return a=e})))||e.containsDeletedTrackedChanges(s))return 8;if(1===r)return 32;if(!a&&Pa.SelectionEditor.isInsertionPointContext(s)&&Pa.SelectionEditor.isSelectionExpandableToWord(s)){var l=Pa.SelectionEditor.expandSelectionToWordBoundary(s,!1);if(l&&(Oa.SelectionManager.get_instance().setSelection(l),s=l.get_firstContext(),e.containsDeletedTrackedChanges(s)))return e.get_trackChangeManager().showDeletedContentSelectedDialog(!1),8}return CS.get_instance().createInsertLinkDialog(s,o),32},e.insertLinks=function(t,n,r,i,o){var a,s=Oa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection(),l=e.isSingleParagraphContext(s);if(l)a=[n];else if(!e.composeHyperlinkEditableContexts((0,p.m)((function(){return a}),(function(e){return a=e})),s))return 8;if(!e.canInsertHyperlink())return 8;for(var c=0;c<a.length;c++)if(!e.canMakeHyperlinkModification(a[c]))return 8;if(Oa.SelectionManager.get_instance().get_selectionCollection().isOutlineLevelSelection)return 8;var u=new Array(a.length),g=null;for(c=0;c<a.length;c++)if(u[c]=a[c],!e.isValidTextContextForHyperlinkAction(u[c],!0,(0,p.m)((function(){return g}),(function(e){return g=e})))||e.containsDeletedTrackedChanges(u[c]))return 8;if(1===r)return 32;if(!g&&1===u.length&&l&&Pa.SelectionEditor.isInsertionPointContext(u[0])&&Pa.SelectionEditor.isSelectionExpandableToWord(u[0])){var d=Pa.SelectionEditor.expandSelectionToWordBoundary(u[0],!1);if(d&&(Oa.SelectionManager.get_instance().setSelection(d),u[0]=d.get_firstContext(),e.containsDeletedTrackedChanges(u[0])))return e.get_trackChangeManager().showDeletedContentSelectedDialog(!1),8}return l?CS.get_instance().createInsertLinkDialog(u[0],o):new vS(u,o),32},e.removeLink=function(t,n,r,i,o){if(e.get_multiParagraphHyperlinkEditEnabled())return e.removeLinks(t,n,r,i,o);if(!e.canMakeHyperlinkModification(n))return 2;if(e.get_viewAndOpenImageHyperlinksEnabled()&&Pa.SelectionEditor.isInlineImageContext(n))return 2;var a,s=n;if(!e.isValidTextContextForHyperlinkAction(s,!1,(0,p.m)((function(){return a}),(function(e){return a=e}))))return 2;if(2===r){var l=new as.GraphTransaction(15);try{l.set_undoActionId(t),l.setFromNode(a.paragraph),e.get_hyperlinkExpandEditEnabled()?e.removeSelectedHyperlinks(s):e.get_hyperlinkStrategy().removeHyperlink(s,a)}finally{l&&l.dispose()}}return 32},e.removeLinks=function(t,n,r,i,o){var a,s,l=Oa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection();if(e.isSingleParagraphContext(l))a=[n];else if(!e.composeHyperlinkEditableContexts((0,p.m)((function(){return a}),(function(e){return a=e})),l))return 8;if(!e.canInsertHyperlink())return 8;for(var c=0;c<a.length;c++)if(!e.canMakeHyperlinkModification(a[c]))return 8;if(1===r){var u=a[0];if(!e.isValidTextContextForHyperlinkAction(u,!1,(0,p.m)((function(){return s}),(function(e){return s=e}))))return 2}if(2===r){for(c=0;c<a.length;c++){u=a[c];if(!e.isValidTextContextForHyperlinkAction(u,!0,(0,p.m)((function(){return s}),(function(e){return s=e}))))return 2}var g=new as.GraphTransaction(15);try{u=a[0];g.set_undoActionId(t),g.setFromNode(u.get_node());for(c=0;c<a.length;c++)e.removeSelectedHyperlinks(a[c])}finally{g&&g.dispose()}e.get_trackChangeManager().alertUntrackedChange(4)}return 32},e.removeSelectedHyperlinks=function(t){for(var n=Hs.HyperlinkReader.getSelectedHyperlinks(t),r=0,i=0,o=0;o<n.length;o++)if(n[o].cpBegin>=i){var a=e.get_hyperlinkStrategy().getHyperlink(t,n[o],(0,p.m)((function(){return r}),(function(e){return r=e})),(0,p.m)((function(){return i}),(function(e){return i=e})));e.get_hyperlinkStrategy().removeHyperlinks(t,a)}},e.selectLink=function(t,n,r,i,o){if(e.get_viewAndOpenImageHyperlinksEnabled()&&ka.ImageReader.isAnyImageContext(n))return 2;var a,s,l,c=n;if(!e.isValidTextContextForHyperlinkAction(c,!1,(0,p.m)((function(){return a}),(function(e){return a=e}))))return 2;2===r&&(e.get_hyperlinkStrategy().getHyperlink(c,a,(0,p.m)((function(){return s}),(function(e){return s=e})),(0,p.m)((function(){return l}),(function(e){return l=e}))),Oa.SelectionManager.get_instance().setSelection(ss.SelectionFactory.createTextRangeOrIpSelection(a.paragraph,s,l)));return 32},e.openTextLink=function(t,n,r,i,o){var a,s=n;if(e.get_viewAndOpenImageHyperlinksEnabled()&&e.isValidImageBlobForHyperlinkAction(s,(0,p.m)((function(){return a}),(function(e){return a=e}))))C.ULS.sendTraceTag(50934737,324,50,"Logging for image blob object with hyperlink");else if(!e.isValidTextContextForHyperlinkAction(s,!1,(0,p.m)((function(){return a}),(function(e){return a=e}))))return 2;return 2===r&&Br.App.followUrl(a.hyperlink.get_url()),32},e.openImageLink=function(e,t,n,r,i){var o=t,a=ka.ImageReader.getHyperlink(o.get_node());return a?(2===n&&Br.App.followUrl(a),32):2},e.copyLinkHelper=function(t,n,r,i,o,a){if(e.get_viewAndOpenImageHyperlinksEnabled()&&ka.ImageReader.isAnyImageContext(r))return 2;var s,l,c,u=Ur.InteractiveViewManager.get_instance().get_editingView();if(!u.get_isContentEditableView())return 2;if(!e.isValidTextContextForHyperlinkAction(r,!1,(0,p.m)((function(){return s}),(function(e){return s=e}))))return 2;if(1===i)return 32;e.get_hyperlinkStrategy().getHyperlink(r,s,(0,p.m)((function(){return l}),(function(e){return l=e})),(0,p.m)((function(){return c}),(function(e){return c=e}))),Oa.SelectionManager.get_instance().setSelection(ss.SelectionFactory.createTextRangeOrIpSelection(s.paragraph,l,c));var g=u.get_ownerDocument(),d=u.get_editingElement(),h=new Hy.w(d);_i.s.clearElement(d);var _=g.createElement("span");d.appendChild(_),_.innerText=s.hyperlink.get_url(),u.selectAllContent(),u.setSequenceCodeOnHtml();var m=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,ii.xx,2,!0,o,a);return h.restore(),m},e.isValidTextContextForHyperlinkAction=function(t,n,r){if(r.val=null,Pa.SelectionEditor.isTextRangeContext(t)){var i=Xp.t(t),o=ku.r(dS.y,i,(function(e){return 6===e.get_blobType()}));if(i.length>0&&(!e.get_addHyperlinkWhenSelectionContainsLineBreak()||!o))return!1;if(e.get_lockedRangeEditor().get_isContentControlEditingEnabled()&&e.get_contentControlChpHelper())if(e.get_contentControlChpHelper().getContentControlBoundariesInTextRange(t).get_count()>0)return!1}if(e.get_hyperlinkExpandEditEnabled())return e.isValidContextForExpandedHyperlinkAction(t,n,r);var a=Hs.HyperlinkReader.getHyperlinksInRange(t,!0);return 1===a.length&&a[0].cpBegin<=t.get_cpBegin()&&a[0].cpEnd>=t.get_cpEnd()&&a[0].hyperlink?(r.val=a[0],!0):!a.length&&n},e.isValidImageBlobForHyperlinkAction=function(e,t){return t.val=null,!(!ka.ImageReader.isAnyImageContext(e)||(t.val=Hs.HyperlinkReader.getImageHyperlink(e),!t.val))},e.isValidContextForExpandedHyperlinkAction=function(e,t,n){n.val=null;var r=Hs.HyperlinkReader.getSelectedHyperlinks(e);return r.length?!!r[0].hyperlink&&(n.val=r[0],!(e.get_cpBegin()<r[0].cpBegin)||t):t},e.containsDeletedTrackedChanges=function(t){if(e.get_trackChangeManager().get_trackChangeFeatureIsEnabled())for(var n=e.get_trackChangeReader().getTrackedChangesInRange(t.get_node(),t.get_cpBegin(),t.get_cpEnd()),r=0;r<n.get_count();++r)if(2===n.get_item(r).changeInfo.changeType)return!0;return!1},e.canInsertHyperlink=function(){return!!e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()||(!us.n.get_instance().get_item(45)||!Br.App.get_box4Bridge().get_trackedChangesEnabled())},e.canMakeHyperlinkModification=function(t){return(!us.n.get_instance().get_item(14)||!e.get_lockedRangeEditor().contextSetContainsLockedRange(t))&&!(e.get_externalSelectionManagerFuture()&&e.get_externalSelectionManagerFuture().get_instance()&&e.get_externalSelectionManagerFuture().get_instance().isExternalSelectionContext(t))},e.getTextRangeFromParagraph=function(e,t){return cs.ParagraphReader.isParagraphContext(e)&&!Pa.SelectionEditor.isBlockContext(e)&&(cs.ParagraphReader.textLength(e.get_node())||t)?_s.y.createTextRange(e.get_node(),0,cs.ParagraphReader.textLength(e.get_node())):e},e._hyperlinkEditor=null,e._ccChpHelper=null,e._hyperlinkStrategy=null,e._externalSelectionManagerFuture=null,e._trackChangeManager=null,e._trackChangeReader=null,e._ViewAndOpenImageHyperlinksEnabled=null,e._HyperlinkExpandEditEnabled=null,e._MultiParagraphHyperlinkEditEnabled=null,e._AddHyperlinkWhenSelectionContainsLineBreak=null,e}();(0,o.l)(bS,"HyperlinkActor",null,[]);var TS=function(){function e(){}return e.get_indentationEditor=function(){return yc.z.get_getOutlineElementIndentationEditor()},e.get_contextSetEditor=function(){return kf.ContextSetEditor.get_instance()},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_activityManager=function(){return ji.y.get_instance()},e.get_externalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=se.w.get_instance().resolveFuture(gh.i))},e.get_paragraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=se.w.get_instance().resolve(gc.g))},e.get_paragraphReader=function(){return e._paragraphReader||(e._paragraphReader=se.w.get_instance().resolve(Fd.s))},e.get_paragraphIndentationReader=function(){return e._paragraphIndentationReader||(e._paragraphIndentationReader=se.w.get_instance().resolve(Yd.p))},e.get_paragraphIndentationEditor=function(){return e.get_paragraphEditor().getIndentationEditor()},e.get_listReader=function(){return e._listReader||(e._listReader=se.w.get_instance().resolve(ts.c))},e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(ii.lN,cl.n,e.applyPromoteDemoteView),t.addAction(ii.lN,cl.z,e.applyPromoteDemote),t.setActionFlags(ii.lN,1028),t.addAction(ii.Hm,cl.n,e.applyPromoteDemoteView),t.addAction(ii.Hm,cl.z,e.applyPromoteDemote),t.setActionFlags(ii.Hm,1028)},e.applyPromoteDemoteView=function(t,n,r,i,o){var a=n.view;if(!a.get_isInteractiveView())return 2;var s=a.get_selectionManager();if(!s)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelectionManager}),8;var l=s.get_selectionContextForActionDispatch();if(!l)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),8;if(us.n.get_instance().get_item(62)&&1===r)return 32;if(us.n.get_instance().get_item(11)&&e.get_contextSetEditor().contextContentsCheck(e.anchoredImageCheck,l))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsAnchoredImage}),8;if(us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isContextSetInLockedParagraphs(l))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsLockedRange}),8;if(e.get_externalSelectionManagerFuture()&&e.get_externalSelectionManagerFuture().get_instance()&&e.get_externalSelectionManagerFuture().get_instance().isExternalSelectionContext(l))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.externalSelection}),8;var c={PerfMarkStart:5794,PerfMarkEnd:5795},u=2;if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Box4PartialPromoteDemoteIsEnabled")){var g=e.canPromoteDemoteContext(t===ii.lN,n,!0);if(1===r)return g?32:8;g&&(u=Lf(t,n,r,i,o,c))}else if(u=Lf(t,n,1,i,o,c),1!==r&&32===u){a.get_selectionManager().onSelectionTopologyChange();var p=new as.GraphTransaction(15);p.setFromNode(n.view.get_targetNode()),u=e.canPromoteDemoteContext(t===ii.lN,n,!1)?Lf(t,n,r,i,o,c):8,p.dispose()}else 1!==r&&8===u&&(a.get_selectionManager().onSelectionTopologyChange(),e.completePromoteDemoteAndIndentationAdjust(t,n,s));return u},e.canPromoteDemoteContext=function(t,n,r){var i=n.view.get_selectionManager();if(!i||!i.get_selectionCollection().get_currentSelection())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.nonInteractiveView}),!1;if(i.get_selectionCollection().isOutlineLevelSelection)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsOutline}),!1;var o=Tf.generalizeSelectionToOEs(i.get_selectionCollection(),!1);if(!o)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.failedToGeneralizeToOEs}),!1;for(var a=!1,s=0;s<o.get_length();s++){var l=o.getContext(s),c=new Da.GraphIterator;if(c.set(l.get_node()),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(c),!Ls.OutlineElementReader.isOutlineElement(c)){if(r)continue;return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.doesNotContainOe}),!1}if(!(t?e.get_indentationEditor().canPromote(c,-1):e.get_indentationEditor().canDemote(c,1))){if(r)continue;return e.get_activityManager().recordEvent(D_.f.doNothingResult,{Reason:M_.i.cannotPromoteOrDemote}),!1}a=!0}return!r||a},e.applyPromoteDemote=function(t,n,r,i,o){if(n.get_contextId()!==cl.z)return 2;var a=n;if(us.n.get_instance().get_item(14)){var s=a.clone().specialize();if(dc.TableReader.isTableContext(s)){if(e.get_lockedRangeEditor().isTableContextInLockedRange(s))return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),8}else if(e.get_lockedRangeEditor().isParaStartOrEndInLockedRange(s))return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),2}var l=new Da.GraphIterator;if(l.set(a.get_node()),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(l),!Ls.OutlineElementReader.isOutlineElement(l))return 2;var c=!1;switch(t){case ii.lN:c=e.get_indentationEditor().canPromote(l,-1);break;case ii.Hm:c=e.get_indentationEditor().canDemote(l,1);break;default:return 2}if(1===r||!c)return c?32:8;var u=0;switch(t===ii.Hm&&o&&o.getValueWithDefault(Boolean,zl.k.autoDemoteLists,!1)&&(u|=2),t){case ii.lN:e.get_indentationEditor().promote(l,-1,u);break;case ii.Hm:e.get_indentationEditor().demote(l,1,u)}return 32},e.completePromoteDemoteAndIndentationAdjust=function(t,n,r){var i=new as.GraphTransaction(15);try{i.setFromNode(n.view.get_targetNode());for(var o=!0,a=Tf.generalizeSelectionToOEs(r.get_selectionCollection(),!1),s=0;s<a.get_length();s++){var l=a.getContext(s);if((h=new Da.GraphIterator).set(l.get_node()),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(h),Ls.OutlineElementReader.isOutlineElement(h)){if(t===ii.lN?e.get_indentationEditor().canPromote(h,-1):e.get_indentationEditor().canDemote(h,1))switch(o=!1,t){case ii.lN:e.get_indentationEditor().promote(h,-1,0);break;case ii.Hm:e.get_indentationEditor().demote(h,1,0)}}else o=!1}if(o){var c=r.get_selectionCollection().get_currentSelection();for(s=0;s<c.get_length();s++){var u=c.get_item(s);if(u.get_isGraphNodeContext()){var g=u.get_node(),p=e.get_paragraphIndentationReader().getIndentInfo(g),d=p.specialIndentValueTwips;if(t===ii.lN?p.indentLeftValue>d:p.indentLeftValue<2*d*9){var h;(h=new Da.GraphIterator).set(u.get_node());var _=d;_=t===ii.lN?p.indentLeftValue>=2.5*d?p.indentLeftValue-2*d:d:p.indentLeftValue<2*d*8?p.indentLeftValue+2*d:2*d*9,e.get_paragraphIndentationEditor().setIndentLeft(h,1,_)}}}}}finally{i&&i.dispose()}},e._externalSelectionManagerFuture=null,e._paragraphEditor=null,e._paragraphReader=null,e._paragraphIndentationReader=null,e._listReader=null,e.anchoredImageCheck=ka.ImageReader.isAnchoredImageContext,e}();(0,o.l)(TS,"IndentationActor",null,[]);var AS=function(){function e(){}return e.get_imageEditor=function(){return e._imageEditor||(e._imageEditor=se.w.get_instance().resolve(rl.w))},e.get_paragraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=se.w.get_instance().resolve(gc.g))},e.get_tableEditor=function(){return e._tableEditor||(e._tableEditor=se.w.get_instance().resolve(cu.z))},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_activityManager=function(){return ji.y.get_instance()},e.get_externalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=se.w.get_instance().resolveFuture(gh.i))},e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();us.n.get_instance().get_item(77)||(t.addAction(ii.AI,cl.i,e.applyTableJustification),t.addAction(ii.IY,cl.i,e.applyTableJustification),t.addAction(ii.Gm,cl.i,e.applyTableJustification)),t.addAction(ii.AI,cl.n,DC.applyFormattingToView),t.addAction(ii.AI,cl.K,e.applyParagraphJustification),t.addAction(ii.AI,cl.H,e.applyImageJustification),t.addAction(ii.AI,cl.I,e.applyImageJustification),t.setActionFlags(ii.AI,1028),t.addAction(ii.IY,cl.n,DC.applyFormattingToView),t.addAction(ii.IY,cl.K,e.applyParagraphJustification),t.addAction(ii.IY,cl.H,e.applyImageJustification),t.addAction(ii.IY,cl.I,e.applyImageJustification),t.setActionFlags(ii.IY,1028),t.addAction(ii.Gm,cl.n,DC.applyFormattingToView),t.addAction(ii.Gm,cl.K,e.applyParagraphJustification),t.addAction(ii.Gm,cl.H,e.applyImageJustification),t.addAction(ii.Gm,cl.I,e.applyImageJustification),t.setActionFlags(ii.Gm,1028),us.n.get_instance().get_item(54)&&(t.addAction(ii.dF,cl.n,DC.applyFormattingToView),t.addAction(ii.dF,cl.K,e.applyParagraphJustification),t.setActionFlags(ii.dF,1028),t.addAction(ii.uK,cl.n,DC.applyFormattingToView),t.addAction(ii.uK,cl.K,e.applyParagraphJustification),t.setActionFlags(ii.uK,1028),t.addAction(ii.lL,cl.n,DC.applyFormattingToView),t.addAction(ii.lL,cl.K,e.applyParagraphJustification),t.setActionFlags(ii.lL,1028),t.addAction(ii.uM,cl.n,DC.applyFormattingToView),t.addAction(ii.uM,cl.K,e.applyParagraphJustification),t.setActionFlags(ii.uM,1028)),t.addAction(ii.LV,cl.n,DC.applyFormattingToView),t.addAction(ii.LV,cl.K,e.applyParagraphJustification),t.addAction(ii.LV,cl.H,e.applyImageJustification),t.setActionFlags(ii.LV,1028),t.addAction(ii.vL,cl.n,DC.applyFormattingToView),t.addAction(ii.vL,cl.K,e.applyParagraphJustification),t.addAction(ii.vL,cl.H,e.applyImageJustification),t.setActionFlags(ii.vL,1028),t.addAction(ii.Qv,cl.n,DC.applyFormattingToView),t.addAction(ii.Qv,cl.K,e.applyParagraphJustification),t.addAction(ii.Qv,cl.H,e.applyImageJustification),t.setActionFlags(ii.Qv,1028),us.n.get_instance().get_item(54)&&(t.addAction(ii.WB,cl.n,DC.applyFormattingToView),t.addAction(ii.WB,cl.K,e.applyParagraphJustification),t.setActionFlags(ii.WB,1028))},e.applyTableJustification=function(t,n,r,i,o){var a=!0,s=n;if(!s)return 8;if(dc.TableReader.isTableContext(s)?us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isTableContextInLockedRange(s)?(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),a=!1):e.get_externalSelectionManagerFuture()&&e.get_externalSelectionManagerFuture().get_instance()&&e.get_externalSelectionManagerFuture().get_instance().isExternalSelectionContext(n)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.externalSelection}),a=!1):(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.doesNotContainTable}),a=!1),1===r||!a)return a?32:8;var l=s.get_node();switch(t){case ii.AI:e.get_tableEditor().setJustification(l,1);break;case ii.IY:e.get_tableEditor().setJustification(l,2);break;case ii.Gm:e.get_tableEditor().setJustification(l,3)}return 32},e.applyImageJustification=function(t,n,r,i,o){var a;if(!DC.shouldExecuteImageAction(r,n,(0,p.m)((function(){return a}),(function(e){return a=e}))))return a;var s=n.get_node();switch(t){case ii.AI:case ii.LV:e.get_imageEditor().setJustification(s,1);break;case ii.IY:case ii.vL:e.get_imageEditor().setJustification(s,2);break;case ii.Gm:case ii.Qv:e.get_imageEditor().setJustification(s,3)}return 32},e.applyParagraphJustification=function(t,n,r,i,o){var a=!0;if(n.get_contextId()!==cl.K?a=!1:us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isParaStartOrEndInLockedRange(n)?(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),a=!1):e.get_externalSelectionManagerFuture()&&e.get_externalSelectionManagerFuture().get_instance()&&e.get_externalSelectionManagerFuture().get_instance().isExternalSelectionContext(n)&&(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.externalSelection}),a=!1),1===r||!a)return a?32:8;var s=n.get_node(),l=cs.ParagraphReader.getJustification(s);switch(t){case ii.AI:case ii.LV:e.get_paragraphEditor().setJustification(s,1===l&&e.isToggleActionEnabled(o)?6:1);break;case ii.IY:case ii.vL:e.get_paragraphEditor().setJustification(s,2===l&&e.isToggleActionEnabled(o)?1:2);break;case ii.Gm:case ii.Qv:e.get_paragraphEditor().setJustification(s,3===l&&e.isToggleActionEnabled(o)?1:3);break;case ii.dF:case ii.WB:e.get_paragraphEditor().setJustification(s,6===l&&e.isToggleActionEnabled(o)?1:6);break;case ii.lL:e.get_paragraphEditor().setJustification(s,11);break;case ii.uK:e.get_paragraphEditor().setJustification(s,7);break;case ii.uM:e.get_paragraphEditor().setJustification(s,13)}return 32},e.isToggleActionEnabled=function(e){var t=!1;return null!==e&&Object.getType(e)===Object&&e.hasOwnProperty("InContextSet")&&(t=e.InContextSet),!t&&us.n.get_instance().get_item(110)},e._imageEditor=null,e._tableEditor=null,e._paragraphEditor=null,e._externalSelectionManagerFuture=null,e}();(0,o.l)(AS,"JustificationActor",null,[]);var IS=function(e,t,n,r,i){return 1===n?32:(L.AFrameworkApplication.get_theActionManager().processAction(ii.lX,2),Br.App.theNotebookManager.syncNotebook(),32)},wS=function(e,t,n,r,i){return 1===n?2===Br.App.get_activeAppFrame().get_mode()?32:8:(L.AFrameworkApplication.get_theActionManager().processAction(ii.lX,2),2!==Br.App.get_activeAppFrame().get_mode()?32:(Br.App.theNotebookManager.saveNotebook(null,null,null,!1),32))},xS=function(){function e(){}return e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager();e.addAction(ii.sR,cl.n,o.i(this,this.activateRibbonTab,"activateRibbonTab")),e.setActionFlags(ii.sR,5),e.addAction(ii.AN,cl.n,o.i(this,this.launchJewelOpenMenuShortcut,"launchJewelOpenMenuShortcut"))},e.prototype.activateRibbonTab=function(e,t,n,r,i){return Br.App.get_box4Bridge().get_commandUi().ribbonActivateTab(i.toString()),32},e.prototype.launchJewelOpenMenuShortcut=function(e,t,n,r,i){return L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings"),Br.App.get_box4Bridge().get_commandUi().jewelMenuLaunch(1,i.toString()),32},e.get_instance=function(){return e._instance||(e._instance=e.getInstanceWithResolvedDependencies())},e.getInstanceWithResolvedDependencies=function(){return new e},e._instance=null,e}();(0,o.l)(xS,"RibbonActor$0",null,[]);var FS=n(6197),ES=function(){function e(e,t,n,r){this._touchStarted=!1,this._actionManager=null,this._appSettingsManager=null,this._grippersManager=null,this._selectionManager=null,this._actionManager=e,this._appSettingsManager=t,this._grippersManager=n,this._selectionManager=r}return e.prototype.registerActions=function(){var t=this;(this._actionManager.addActionWithFlags(te.BO,cl.n,o.i(this,this.touchStartHandler,"touchStartHandler"),4),this._actionManager&&this._appSettingsManager&&(this._appSettingsManager.getBooleanAppSetting("TouchImageGrippiesResizedIsEnabled")&&(this._actionManager.addActionWithFlags(ii.gj,cl.n,o.i(this,this.processImageOnTouchSelection,"processImageOnTouchSelection"),4),this._actionManager.addActionWithFlags(ii.NX,cl.n,o.i(this,this.processImageOnClickSelection,"processImageOnClickSelection"),4)),this._appSettingsManager.getBooleanAppSetting("HideGrippersWhenPinchingIsEnabled")&&(this._actionManager.addActionWithFlags(te.Fq,cl.U,o.i(this,this.processStartPinchToZoom,"processStartPinchToZoom"),4),this._actionManager.addActionWithFlags(te.Ir,cl.U,o.i(this,this.processEndPinchToZoom,"processEndPinchToZoom"),4)),fi.EventHandlerManager.get_instance().registerOnTouchMove((function(){t.onTouchMoveHandler()}))),Br.App.get_activeAppFrame().workspace.get_contentView()&&Br.App.get_activeAppFrame().workspace.get_contentView().get_isInteractiveView())&&Br.App.get_activeAppFrame().workspace.get_contentView().add_scrolled((function(t,n){e.logIfScrollTriggeredByTouch()}));this._selectionManager&&this._selectionManager.add_processSetSelectionFinished(o.i(this,this.onProcessSetSelectionFinished,"onProcessSetSelectionFinished"))},e.prototype.touchStartHandler=function(e,t,n,r,i){return 2!==n?2:(this._touchStarted||(this._touchStarted=!0),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPinchZoomSettings"),L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordViewerPinchZoomSettings"),G.y.get_isChrome()&&L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordForceSelectionIntoTopWhenTouchSettings"),32)},e.prototype.processImageOnTouchSelection=function(e,t,n,r,i){if(2!==n)return 2;var o=i;return this.processImageSelection(o,!0),32},e.prototype.processImageOnClickSelection=function(e,t,n,r,i){if(2!==n)return 2;var o=i;return this.processImageSelection(o,!1),32},e.prototype.processStartPinchToZoom=function(e,t,n,r,i){return 2!==n?2:this._grippersManager?(this._grippersManager.hideForPinchToZoom(),32):8},e.prototype.processEndPinchToZoom=function(e,t,n,r,i){return 2!==n?2:this._grippersManager?(this._grippersManager.restoreForPinchToZoom(),32):8},e.prototype.onTouchMoveHandler=function(){e._lastTouchMoveTicks=window.performance.now()},e.prototype.processImageSelection=function(t,n){if(t)for(var r=t.firstChild;r;){if("SPAN"===r.tagName&&Sys.UI.DomElement.containsCssClass(r,e.imageSelectionCssClass)){for(var i=r.firstChild;i;)this.adjustImageResizeHandle(i,n),i=i.nextSibling;break}r=r.nextSibling}},e.prototype.adjustImageResizeHandle=function(t,n){if(Sys.UI.DomElement.containsCssClass(t,e.imageResizeHandlesCssClass)){n&&!Sys.UI.DomElement.containsCssClass(t,e.imageResizeHandlesTouchCssClass)?Sys.UI.DomElement.addCssClass(t,e.imageResizeHandlesTouchCssClass):!n&&Sys.UI.DomElement.containsCssClass(t,e.imageResizeHandlesTouchCssClass)&&Sys.UI.DomElement.removeCssClass(t,e.imageResizeHandlesTouchCssClass);var r="WACImageResizeHandleTouch"+this.getHandleClassNameSuffix(t);n&&!Sys.UI.DomElement.containsCssClass(t,r)?Sys.UI.DomElement.addCssClass(t,r):!n&&Sys.UI.DomElement.containsCssClass(t,r)&&Sys.UI.DomElement.removeCssClass(t,r)}},e.prototype.getHandleClassName=function(t){for(var n=t.className.split(" "),r=0;r<n.length;r++){var i=n[r].toString();if(i.startsWith("WACImageResizeHandle")&&i!==e.imageResizeHandlesCssClass)return i}return""},e.prototype.getHandleClassNameSuffix=function(e){var t=this.getHandleClassName(e);return""!==t?Jn.l.substring(t,"WACImageResizeHandle".length,t.length):""},e.prototype.onProcessSetSelectionFinished=function(e,t){3===t.inputMethod&&ke.b(ii.Kt)},e.getTouchInputActorWithResolvedDependencies=function(){return new e(L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager,FS.o.get_instance(),Oa.SelectionManager.get_instance())},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=e.getTouchInputActorWithResolvedDependencies())},e.logIfScrollTriggeredByTouch=function(){var t=window.performance.now();e._lastTouchMoveTicks&&t-e._lastTouchMoveTicks<250&&t-e._lastScrollLoggedTicks>1e3&&(ke.b(ii.nU),e._lastScrollLoggedTicks=t)},e.imageResizeHandlesCssClass="WACImageResizeHandles",e.imageResizeHandlesTouchCssClass="WACImageResizeHandlesTouch",e.imageSelectionCssClass="WACImgSelection",e._singletonInstance=null,e._lastTouchMoveTicks=0,e._lastScrollLoggedTicks=0,e}();(0,o.l)(ES,"TouchInputActor",null,[]);var PS=n(6117),kS=function(){function e(e,t){this._undoManager=null,this._undoManagerFactory=null,this._coauthCashTelemetry=null,this._undoManagerFactory=e,this._coauthCashTelemetry=t}return e.prototype.get_undoManager=function(){return this._undoManager||(this._undoManager=this._undoManagerFactory())},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager(),t=o.i(this,this.undoRedo,"undoRedo");e.addActionWithFlags(ii.sb,cl.n,t,1028),e.addActionWithFlags(ii.vf,cl.n,t,1028)},e.prototype.undoRedo=function(t,n,r,i,o){var a,s=n.view;if(!s.get_isInteractiveView())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.nonInteractiveView}),8;var l=s;if(a=t===ii.sb?this.get_undoManager().get_hasUndoEntries():this.get_undoManager().get_hasRedoEntries(),1===r)return a?32:8;if(!a)return C.ULS.sendTraceTag(17069441,365,50,"User attempted {0} without an undo stack",t===ii.sb?"undo":"redo"),this._coauthCashTelemetry.get_value().undoRedoAttemptedWhenThereIsNoStack(),e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.undoDisabled}),2;var c,u=new as.GraphTransaction(3);if(u.setFromNode(l.get_targetNode()),u.setAsyncOperationWithoutParent(),c=t===ii.sb?this.get_undoManager().undo():this.get_undoManager().redo(),u.dispose(),o){var g=o;FS.o.get_instance().updateVisibilityFromInputMethod(g.inputMethod)}return c?32:(e.get_activityManager().recordEvent(D_.f.doNothingResult,{Reason:M_.i.noEntries}),8)},e.get_instance=function(){return e._instance||(e._instance=e.getInstanceWithResolvedDependencies())},e.getInstanceWithResolvedDependencies=function(){var t=se.w.get_instance();return new e((function(){return t.resolve(ja.n)}),t.resolveLazy(PS.r))},e.get_activityManager=function(){return ji.y.get_instance()},e._instance=null,e}();(0,o.l)(kS,"UndoActor",null,[]);var DS=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.Actors"},e.prototype.configure=function(e){this._container=e,(new oS).configure(e)},e.prototype.init=function(){var e,t,n=this;(this._container.resolve(k_.ClipboardActor).registerActions(),e=aS,L.AFrameworkApplication.get_theActionManager().addAction(ii.oR,cl.I,e),L.AFrameworkApplication.get_theActionManager().addAction(ii.CM,cl.I,lS),L.AFrameworkApplication.get_theActionManager().addAction(ii.CM,cl.c,lS),PC.get_instance().registerActions(),bS.registerActions(),TS.registerActions(),AS.registerActions(),ES.get_instance().registerActions(),gS.get_instance().registerActions(),this._container.resolve(jp).registerActions(),(t=L.AFrameworkApplication.get_theActionManager()).addAction(ii.Pl,nt.a,wS),t.addAction(ii.Ny,nt.a,IS),us.n.get_instance().get_item(70))&&this._container.resolve(cC).registerActions();xS.get_instance().registerActions();var r=this._container.tryResolve($p.d);r?r.get_graphFeaturesNodeTask().CW((function(e){n.registerPotentiallyDelayedActions()})):this.registerPotentiallyDelayedActions(),ny.registerActions(Br.App.theContextSetActor),this._container.resolve(LC).registerActions(),kS.get_instance().registerActions(),this._container.resolve(gd).registerContentDetailsProviders(),this._container.resolve(Qp.h),this._container.resolve(vy),Br.App.get_activeAppFrame().updateCommandUI()},e.prototype.registerPotentiallyDelayedActions=function(){us.n.get_instance().get_item(71)&&this._container.resolve(SC).registerActions()},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(DS,"Box4ActorsPackage",null,[l.u,c.s]);var MS=function(){function e(e,t,n,r,i,o){this._colorMenu=null,this._colorPickerDialog=null,this._actionManager=null,this._themeColorResolver=null,this._menuCacheInvalidator=null,this._pageReader=null,this._trackChangeManager=null,this._trackChangeEditor=null,this._recentAndMoreColorsIsEnabled=null,this._actionManager=e,this._themeColorResolver=t,this._menuCacheInvalidator=n,this._pageReader=r,this._trackChangeManager=i,this._trackChangeEditor=o}return e.prototype.get_recentColors=function(){return e._recentColorsSectionHandler||(e._recentColorsSectionHandler=se.w.get_instance().tryResolve(Ug))},e.prototype.get_isRecentAndMoreColorsMenuSectionEnabled=function(){return null==this._recentAndMoreColorsIsEnabled&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordRecentAndMoreColorsSettings"),L.AFrameworkApplication.appSettingsManager?this._recentAndMoreColorsIsEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RecentAndMoreColorsIsEnabled"):this._recentAndMoreColorsIsEnabled=!1),null!=this._recentAndMoreColorsIsEnabled},e.prototype.get_shadingColorMenu=function(){return this._colorMenu||(this._colorMenu=new FC("Shading"),this.initializeMenu(this._colorMenu)),this._colorMenu},e.prototype.initializeMenu=function(e){e.addMenuControl(2,ii.uF),e.addMenuControl(3,ii.EB),e.addMenuControl(4,ii.EB),e.addToMenuCacheInvalidator(this._menuCacheInvalidator,1)},e.prototype.registerActions=function(){this._actionManager.addAction(ii.fF,cl.n,o.i(this,this.populateCellShadingColor,"populateCellShadingColor")),this._actionManager.addAction(ii.fF,cl.M,o.i(this,this.populateCellShadingColor,"populateCellShadingColor")),this._actionManager.setActionFlags(ii.fF,102),this._actionManager.addAction(ii.rR,cl.n,ny.genericViewActionTableCellHandler),this._actionManager.addAction(ii.rR,cl.M,o.i(this,this.cellShadingColorMenuOpen,"cellShadingColorMenuOpen")),this._actionManager.setActionFlags(ii.rR,4),this._actionManager.addAction(ii.EB,cl.n,ny.genericViewActionTableCellHandler),this._actionManager.addAction(ii.EB,cl.M,o.i(this,this.cellShadingColor,"cellShadingColor")),this._actionManager.setActionFlags(ii.EB,4),this._actionManager.addAction(ii.uF,cl.n,ny.genericViewActionTableCellHandler),this._actionManager.addAction(ii.uF,cl.M,o.i(this,this.clearCellShadingColor,"clearCellShadingColor")),this._actionManager.setActionFlags(ii.uF,4),this._actionManager.addAction(ii.iw,cl.n,ny.genericViewActionTableCellHandler),this._actionManager.addAction(ii.iw,cl.M,o.i(this,this.queryCellShadingColor,"queryCellShadingColor")),this._actionManager.setActionFlags(ii.iw,100),this._actionManager.addAction(ii.UM,cl.n,ny.genericViewActionTableCellHandler),this._actionManager.addAction(ii.UM,cl.M,o.i(this,this.cellShadingCustomColor,"cellShadingCustomColor")),this._actionManager.setActionFlags(ii.UM,4),this._actionManager.addAction(ii.hU,cl.n,o.i(this,this.openMoreColorsDialog,"openMoreColorsDialog")),this._actionManager.setActionFlags(ii.hU,4)},e.prototype.cellShadingColorMenuOpen=function(e,t,n,r,i){return this.isShadingActionEnabled(t,n,i,!1)?32:8},e.prototype.cellShadingColor=function(e,t,n,r,i){var o;if(!this.shouldExecuteShadingAction(t,n,i,!0,(0,p.m)((function(){return o}),(function(e){return o=e}))))return o;C.ULS.sendTraceTag(594899719,340,50,"Cell shading color is selected from Standard/Theme colors.");var a=t,s=this._themeColorResolver.colorFromThemeColor(a.get_node(),i);return this.performShadingColorTransaction(a.get_node(),s),32},e.prototype.clearCellShadingColor=function(e,t,n,r,i){var o;if(!this.shouldExecuteShadingAction(t,n,i,!1,(0,p.m)((function(){return o}),(function(e){return o=e}))))return o;var a=t;return this.performClearShadingColorTransaction(a.get_node()),32},e.prototype.queryCellShadingColor=function(e,t,n,r,i){return 1===n?32:this.handleQueryTableCellShading(t,i)},e.prototype.populateCellShadingColor=function(e,t,n,r,i){if(1===n)return 32;var o=t.get_contextId()===cl.n?this._pageReader.getPageContentNodeFromContext(t):this.getPageContentNodeFromTableCellContext(t),a=i;if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var s=this.get_shadingColorMenu().generateColorControlProperties(o,Br.App.colorMenuThemeStringsType);if(!s)return 8;a.MenuItems=s}var l=this.get_shadingColorMenu().createColorControl(o,Br.App.colorMenuThemeStringsType);return l?(a.PopulationXML=l,32):8},e.prototype.openMoreColorsDialog=function(e,t,n,r,i){if(1===n)return 32;Br.App.get_activeAppFrame().dismissFloatie(),L.AFrameworkApplication.get_theActionManager().processActionWithData(ii.iw,2,i);var o=i;return this._colorPickerDialog=new EC("Shading",ii.UM),this._colorPickerDialog.showColorPickerDialog(o&&o.CellShading?o.CellShading:0),32},e.prototype.cellShadingCustomColor=function(e,t,n,r,i){if(1===n)return 32;(L.AFrameworkApplication.get_theActionManager().processActionWithData(ii.EB,2,i),this.get_isRecentAndMoreColorsMenuSectionEnabled())&&(this.get_recentColors().addRecentColor(i)||C.ULS.sendTraceTag(594899717,340,50,"Color selected from Recent Colors section. Menu: {0}","Shading"));return 32},e.prototype.shouldExecuteShadingAction=function(e,t,n,r,i){return this.isShadingActionEnabled(e,t,n,r)?(i.val=32,2===t):(i.val=8,!1)},e.prototype.isShadingActionEnabled=function(e,t,n,r){if(e.get_contextId()!==cl.M)return!1;if(2===t){if(r&&!n)return!1;if(!e.get_node())return!1}return!0},e.prototype.performShadingColorTransaction=function(e,t){var n=new as.GraphTransaction(15);n.setFromNode(e),this.setTableCellFormatChangeHelper(e),e.get_properties().setValue(Kc.b.cellShadingColor,t),n.dispose()},e.prototype.performClearShadingColorTransaction=function(e){var t=new as.GraphTransaction(15);t.setFromNode(e),this.setTableCellFormatChangeHelper(e),e.get_properties().removeProperty(Kc.b.cellShadingColor),t.dispose()},e.prototype.getPageContentNodeFromTableCellContext=function(t){if(t.get_contextId()!==cl.M)return null;var n=t,r=e.get_pageNavigator().navigateToPageContentNode(n.get_node());return r||null},e.prototype.setTableCellFormatChangeHelper=function(e){if(this._trackChangeManager&&this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeManager.get_changeTrackingDocumentSettingEnabled()){var t=(0,f.e)(Hf.TableCellNode,e);if(t){var n=t.preparePreviousFormatProperties();this._trackChangeEditor.setTableCellFormatChange(t,n)}}},e.prototype.handleQueryTableCellShading=function(e,t){if(e.get_contextId()!==cl.M)return 8;var n=e.get_node();n&&n.hasProperty(Kc.b.cellShadingColor)&&(t.CellShading=n.getValue(Number,Kc.b.cellShadingColor));return 32},e.getCellShadingActorWithResolvedDependencies=function(){return new e(L.AFrameworkApplication.get_theActionManager(),Jy.m.get_instance(),IC.d.get_instance(),Qc.PageReader.get_instance(),se.w.get_instance().resolve($a.b).get_instance(),se.w.get_instance().resolve(cc.x).get_instance())},e.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=e.getCellShadingActorWithResolvedDependencies())},e._recentColorsSectionHandler=null,e._singletonInstance=null,e}();(0,o.l)(MS,"CellShadingActor",null,[]);var RS=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.CellShading"},e.prototype.configure=function(e){this._container=e},e.prototype.init=function(){var e=this,t=this._container.tryResolve($p.d);t?t.get_graphFeaturesNodeTask().CW((function(t){e.onAfterGraphFeaturesNodeLoaded()})):this.onAfterGraphFeaturesNodeLoaded()},e.prototype.onAfterGraphFeaturesNodeLoaded=function(){var e=this._container.tryResolve($p.d);(e?e.isFeatureEnabled(17):Br.App.cellShadingUIIsEnabled)&&(MS.get_instance().registerActions(),Br.App.get_activeAppFrame().updateCommandUI())},e.prototype.dispose=function(){},e}();(0,o.l)(RS,"CellShadingPackage",null,[l.u,c.s]);var LS,NS=n(4162);!function(e){e[e.element=1]="element",e[e.attribute=2]="attribute",e[e.text=3]="text",e[e.characterData=4]="characterData",e[e.entityReference=5]="entityReference",e[e.entity=6]="entity",e[e.processingInstruction=7]="processingInstruction",e[e.comment=8]="comment",e[e.document=9]="document",e[e.documentType=10]="documentType",e[e.documentFragment=11]="documentFragment",e[e.notation=12]="notation"}(LS||(LS={})),(0,o.h)("XmlNodeType",LS);var BS=function(){function e(){this._clipUrl=null,this._assetId=null,this._thumbnailUrl=null,this._previewUrl=null,this._width=null,this._height=null,this._resolution=0,this._rating=null,this._numOfRatings=null,this._displayName=null,this._contentLength=0,this._keywords=null,this._provider=null,this._attributionLink=null,this._isCSC=!1,this._additionalValue=null,this._additionalCaption=null,this._additionalString=null}return e.prototype.get_clipUrl=function(){return this._clipUrl},e.prototype.get_assetId=function(){return this._assetId},e.prototype.get_thumbnailUrl=function(){return this._thumbnailUrl},e.prototype.get_previewUrl=function(){return this._previewUrl},e.prototype.get_displayName=function(){return this._displayName},e.prototype.get_dimensions=function(){return String.format(Box4Intl.Box4Strings.l_ClipartDimensionsDisplay,this._width,this._height)},e.prototype.get_additionalLink=function(){if(this._additionalCaption&&this._additionalString&&this._additionalValue){var e=document.createElement("a");return e.setAttribute("href",this._additionalValue),e.setAttribute("target","_blank"),e.innerText=this._additionalString,e}return null},e.prototype.get_additionalCaption=function(){return this._additionalCaption},e.prototype.get_fileSize=function(){return String.format(Box4Intl.Box4Strings.l_ClipartFileSizeDisplay,this._contentLength)},e.prototype.get_ratingSpan=function(){var e=document.createElement("span"),t=0;if(this._rating&&this._rating.length>0){for(var n=this._rating.indexOf("."),r=n<0?this._rating:this._rating.substring(0,n),i=Number.parseInvariant(r);t<i&&t<5;t++)e.appendChild(Lt.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Za.f.box4Image("box42.png"),"","",!0,""));if(n>0){var o=Number.parseInvariant(this._rating.substr(n+1));o<3?e.appendChild(Lt.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Za.f.box4Image("box42.png"),"","",!0,"")):o<8?e.appendChild(Lt.createClusteredImageFromCluster(13,13,"RsHalf_13x13x8","box42",Za.f.box4Image("box42.png"),"","",!0,"")):e.appendChild(Lt.createClusteredImageFromCluster(13,13,"RsFull_13x13x8","box42",Za.f.box4Image("box42.png"),"","",!0,"")),t++}}for(var a=t;a<5;a++)e.appendChild(Lt.createClusteredImageFromCluster(13,13,"RsEmpty_13x13x8","box42",Za.f.box4Image("box42.png"),"","",!0,""));if(this._numOfRatings){var s=document.createElement("span");s.innerText=String.format(Box4Intl.Box4Strings.l_ClipartRatingVotes,this._numOfRatings),e.appendChild(s)}return e},e.prototype.get_resolution=function(){return this._resolution>0?String.format(Box4Intl.Box4Strings.l_ClipartResolutionDisplay,this._resolution):""},e.prototype.get_attributionLink=function(){var t;return this._isCSC?((t=document.createElement("span")).innerText=Box4Intl.Box4Strings.l_ClipartProvidedByCommunity,t):this._attributionLink&&this._provider?e.createLink(this._attributionLink,this._provider):((t=document.createElement("span")).innerText=Box4Intl.Box4Strings.l_ClipartProvidedByMicrosoft,t)},e.prototype.get_keywords=function(){var e;if(this._keywords){var t=this._keywords.split(",");e=new Array(t.length);for(var n=0;n<t.length;n++)e[n]=t[n].trim()}else e=new Array(0);return e},e.fromXML=function(t){for(var n=new e,r=0;r<t.childNodes.length;r++){var i=t.childNodes[r];if(i.nodeType===LS.element)try{var o=i.firstChild.nodeValue;switch(i.nodeName){case"src":n._clipUrl=o;break;case"assetid":n._assetId=o;break;case"thumb":"64x64"===i.attributes.getNamedItem("size").nodeValue?n._thumbnailUrl=e.trimProtocol(o):"192x192"===i.attributes.getNamedItem("size").nodeValue&&(n._previewUrl=e.trimProtocol(o));break;case"imagedim":if(o){var a=o.indexOf("x");a>0&&a<o.length&&(n._width=o.substr(0,a),n._height=o.substr(a+1))}break;case"resolution":n._resolution=Number.parseInvariant(o);break;case"rating":n._rating=o;break;case"numofratings":n._numOfRatings=o;break;case"displayname":n._displayName=o;break;case"contentlength":n._contentLength=Number.parseInvariant(o)/1024;break;case"subject":n._keywords=o;break;case"provider":n._provider=o;break;case"attributionlink":n._attributionLink=o;break;case"iscsc":n._isCSC=1===Number.parseInvariant(o);break;case"additional":var s=i.firstChild;if(i.hasChildNodes()&&s&&"id"===s.nodeName&&1===Number.parseInvariant(s.text))for(var l=0;l<i.childNodes.length;l++){var c=i.childNodes[l];switch(c.nodeName){case"caption":n._additionalCaption=c.text;break;case"value":n._additionalValue=c.text;break;case"string":n._additionalString=c.text}}}}catch(e){}}return n},e.createLink=function(e,t){var n=document.createElement("a");return n.setAttribute("href",e),n.setAttribute("target","_blank"),n.innerText=t,n},e.trimProtocol=function(e){var t;return e&&(t=e.indexOf("://"))>0?e.substr(t+1):e},e}();(0,o.l)(BS,"ClipArtSearchResult",null,[]);var OS=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,Box4Intl.Box4Strings.l_ClipartSearchButtonText,Box4Intl.Box4Strings.l_ClipartDefaultText)},e.dialogHtmlFormat="<div class='ClipartDialog' id='clipartdialog'> <div class='ClipartResultsPane' id='clipartresultspane'> <div class='ClipartSearchHeader' id='clipartsearchheader'> <input type='text' id='textInput' class='ClipartSearchInput' title='{0}' autocomplete=\"off\"/> <input type='image' id='btnSearch' class='WACButton ClipartSearchButton' title='{0}' alt='{0}'/> </div> <div class='ClipartSearchResults' id='clipartsearchresults'> {1} </div> </div> <div class='ClipartPreviewPane' id='clipartpreviewpane'> <div class='ClipartDisplayName UIFontBold' id='clipartattributedisplayname'> </div> <div class='ClipartSeeSimilar' id='clipartseesimilar'> </div> <div class='ClipartPreviewImage' id='clipartpreviewimage'> </div> <div class='ClipartPreviewDetails' id='clipartpreviewdetails'> <div class='ClipartAttributeContainer' id='clipartattribution'> <div class='ClipartAttributeName' id='clipartattributionname'> </div> <div class='ClipartAttributeValue' id='clipartattributionvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartadditional'> <div class='ClipartAttributeName' id='clipartadditionalname'> </div> <div class='ClipartAttributeValue' id='clipartadditionalvalue'> </div> </div> <div class='ClipartAttributeContainer' id='clipartrating'> <div class='ClipartAttributeName' id='clipartratingname'> </div> <div class='ClipartAttributeValue' id='clipartratingvalue'> </div> </div> <div class='ClipartDimensions' id='clipartdimensions'> </div> <div class='ClipartAttributeContainer' id='clipartkeywords'> </div> </div> </div> </div>",e}();(0,o.l)(OS,"InsertClipartDialogHtml",null,[]);var US=n(9638),HS="InsertClipartDialog",GS=function(e){function t(t){var n=e.call(this)||this;return n._textInput=null,n._searchResult=null,n._clipartUploader=null,n._iSelectedClip=0,n._iFocusedClip=0,n._prevQuery=null,n._prevSimilar=!1,n._images=null,n._divPreview=null,n._divDisplayName=null,n._divSeeSimilar=null,n._divDimensions=null,n._divAdditional=null,n._divRating=null,n._divAttribution=null,n._divKeywords=null,n._btnSearch=null,n._divAdditionalName=null,n._divRatingName=null,n._divAttributionName=null,n._progress=null,n._searchResultsKeyDownHandler=null,n._textInputKeyDownHandler=null,n._textInputKeyPressHandler=null,n._textInputPasteHandler=null,n._searchButtonClickHandler=null,n._searchResultScrollHandler=null,n._previewClipHandler=null,n._thumbnailLoadErrorHandler=null,n._previewLoadErrorHandler=null,n._hyperlinkClickHandler=null,n._hyperlinkKeyDownHandler=null,n._keywordClickHandler=null,n._keywordKeyDownHandler=null,n._seeSimilarClickHandler=null,n._seeSimilarKeyDownHandler=null,n._clipartUploader=t,n.set_dialogHtml(OS.get_dialogHtml()),n.set_dialogId(HS),n.setButtonText(1,Box4Intl.Box4Strings.l_ClipartUploadButtonText),n.showDialog(Box4Intl.Box4Strings.l_ClipartUploadDialogTitle,o.i(n,n.insertClipartDialogHandler,"insertClipartDialogHandler")),n._searchResult=document.getElementById("clipartsearchresults"),n._searchResultsKeyDownHandler=o.i(n,n.onKeyDown,"onKeyDown"),qo.n.addHandler(n._searchResult,"keydown",n._searchResultsKeyDownHandler),n._searchResultScrollHandler=o.i(n,n.onScroll,"onScroll"),qo.n.addHandler(n._searchResult,"scroll",n._searchResultScrollHandler),n._textInput=document.getElementById("textInput"),n._textInputKeyDownHandler=o.i(n,n.onSearchQueryKeyDown,"onSearchQueryKeyDown"),qo.n.addHandler(n._textInput,"keydown",n._textInputKeyDownHandler),n._textInputKeyPressHandler=o.i(n,n.onSearchQueryAddCharacters,"onSearchQueryAddCharacters"),qo.n.addHandler(n._textInput,"keypress",n._textInputKeyPressHandler),n._textInputPasteHandler=o.i(n,n.onSearchQueryAddCharacters,"onSearchQueryAddCharacters"),qo.n.addHandler(n._textInput,"paste",n._textInputPasteHandler),n._btnSearch=document.getElementById("btnSearch"),n._btnSearch.setAttribute("src",Za.f.box4Image("search.16x16x32.png")),n._searchButtonClickHandler=o.i(n,n.onSearchButton,"onSearchButton"),qo.n.addHandler(n._btnSearch,"click",n._searchButtonClickHandler),n._divPreview=document.getElementById("clipartpreviewimage"),n._divDisplayName=document.getElementById("clipartattributedisplayname"),n._divSeeSimilar=document.getElementById("clipartseesimilar"),n._divDimensions=document.getElementById("clipartdimensions"),n._divAdditional=document.getElementById("clipartadditionalvalue"),n._divRating=document.getElementById("clipartratingvalue"),n._divAttribution=document.getElementById("clipartattributionvalue"),n._divKeywords=document.getElementById("clipartkeywords"),n._divAdditionalName=document.getElementById("clipartadditionalname"),n._divRatingName=document.getElementById("clipartratingname"),n._divAttributionName=document.getElementById("clipartattributionname"),n._previewClipHandler=o.i(n,n.onPreviewClip,"onPreviewClip"),n._thumbnailLoadErrorHandler=o.i(n,n.onThumbnailLoadError,"onThumbnailLoadError"),n._hyperlinkClickHandler=o.i(n,n.onHyperlinkClick,"onHyperlinkClick"),n._hyperlinkKeyDownHandler=o.i(n,n.onHyperlinkKeyDown,"onHyperlinkKeyDown"),n._keywordClickHandler=o.i(n,n.onKeywordClick,"onKeywordClick"),n._keywordKeyDownHandler=o.i(n,n.onKeywordKeyDown,"onKeywordKeyDown"),n._seeSimilarClickHandler=o.i(n,n.onSeeSimilarClick,"onSeeSimilarClick"),n._seeSimilarKeyDownHandler=o.i(n,n.onSeeSimilarKeyDown,"onSeeSimilarKeyDown"),n._textInput.focus(),n.setButtonState(1,!1),n}return(0,S.t)(t,e),t.prototype.dispose=function(){this._searchResult&&this.cleanupSearchResults(),this._searchResult&&this._searchResultsKeyDownHandler&&(qo.n.removeHandler(this._searchResult,"keydown",this._searchResultsKeyDownHandler),this._searchResultsKeyDownHandler=null),this._searchResult&&this._searchResultScrollHandler&&(qo.n.removeHandler(this._searchResult,"scroll",this._searchResultScrollHandler),this._searchResultScrollHandler=null),this._searchResult=null,this._textInput&&this._textInputKeyDownHandler&&(qo.n.removeHandler(this._textInput,"keydown",this._textInputKeyDownHandler),this._textInputKeyDownHandler=null),this._textInput&&this._textInputKeyPressHandler&&(qo.n.removeHandler(this._textInput,"keypress",this._textInputKeyPressHandler),this._textInputKeyPressHandler=null),this._textInput&&this._textInputPasteHandler&&(qo.n.removeHandler(this._textInput,"paste",this._textInputPasteHandler),this._textInputPasteHandler=null),this._textInput=null,this._btnSearch&&this._searchButtonClickHandler&&(qo.n.removeHandler(this._btnSearch,"click",this._searchButtonClickHandler),this._searchButtonClickHandler=null,this._btnSearch=null),this._previewClipHandler=null,this._thumbnailLoadErrorHandler=null,this._previewLoadErrorHandler=null,this._hyperlinkClickHandler=null,this._hyperlinkKeyDownHandler=null,this._keywordClickHandler=null,this._keywordKeyDownHandler=null,this._seeSimilarClickHandler=null,this._seeSimilarKeyDownHandler=null,this._divPreview=null,this._divDisplayName=null,this._divSeeSimilar=null,this._divDimensions=null,this._divAdditional=null,this._divRating=null,this._divAttribution=null,this._divKeywords=null,this._divAdditionalName=null,this._divRatingName=null,this._divAttributionName=null,this._progress&&(this._progress.dispose(),this._progress=null),e.prototype.dispose.call(this)},t.prototype.sizeAndPositionDialog=function(){e.prototype.sizeAndPositionDialog.call(this);document.getElementById(this.myId("WACDialogPanel")).style.width=String.format("{0}px",656)},t.prototype.onSearchButton=function(e){var t=this._textInput.value;t&&t.trim().length>0&&(this.search(this._textInput.value),this.setButtonState(1,!1)),e.preventDefault(),e.stopPropagation()},t.prototype.search=function(e){this.sendSearchRequest(e,!1,o.i(this,this.processSearchResults,"processSearchResults"))},t.prototype.sendSearchRequest=function(e,t,n){if(this._iSelectedClip=0,this._iFocusedClip=0,this.cleanupSearchResults(),this._images&&e===this._prevQuery&&this._prevSimilar===t)window.setTimeout(o.i(this,this.displaySearchResults,"displaySearchResults"),500);else{this._images&&(Array.clear(this._images),this._images=null),this._prevQuery=e,this._prevSimilar=t;var r=new Sys.StringBuilder('<search xmlns="urn:schema-microsoft-com:office:office">');r.append("<query>"),r.append(Jn.l.xmlEncode(e)),r.append("</query>"),r.append("<mediatype>Illustration</mediatype>"),r.append("<mediatype>Photo</mediatype>"),r.append("<filetype>jpg</filetype>"),r.append("<filetype>jpeg</filetype>"),r.append("<filetype>gif</filetype>"),r.append("<filetype>bmp</filetype>"),r.append("<filetype>tif</filetype>"),r.append("<filetype>tiff</filetype>"),r.append("<filetype>png</filetype>"),r.append("</search>");for(var i={"Content-Type":"text/xml; charset=utf-8"},a=L.AFrameworkApplication.lcid.toString(16).toUpperCase(),s=a.length;s<4;s++)a="0"+a;L.AFrameworkApplication.theClientRequestManager.addRequest(String.format("{0}OfficeOnlineProxy.ashx?lidhelp={1}&liduser={1}&lidui={1}&{2}={3}",Br.App.webServiceBase,a,Lh.a.similar,t.toString()),2,r.toString(),i,!0,2,n,o.i(this,this.onError,"onError"),null)}},t.prototype.searchSimilar=function(e){this.sendSearchRequest(e.get_assetId(),!0,o.i(this,this.processSearchResults,"processSearchResults")),this._images||(this._images=[],Array.add(this._images,e))},t.prototype.onSearchQueryKeyDown=function(e){(e?e.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&(this.onSearchButton(e),e.preventDefault(),e.stopPropagation())},t.prototype.onSearchQueryAddCharacters=function(e){this._textInput.value.length>=100&&(e.preventDefault(),e.stopPropagation())},t.prototype.onPreviewClip=function(e){var t=e.target.parentNode.id,n=Number.parseInvariant(t.substr(4));this.previewClip(n),this.setFocusOnClip(n)},t.prototype.onScroll=function(e){var t=this._searchResult.scrollTop;if(this._searchResult&&this._searchResult.children&&!(this._searchResult.children.length<2)){var n=this._searchResult.children[0].children[0],r=this._searchResult.clientHeight-(n.clientHeight-n.children[0].clientHeight+2)+this._searchResult.scrollTop,i=n.clientHeight+2,o=parseInt(String(t/i)),a=parseInt(String(r/i)),s=parseInt(String(this._searchResult.clientWidth/i));a<r/i&&a<parseInt(String(this._images.length/s))&&a++;for(var l=o;l<a;l++)for(var c=0;c<s;c++){var u=l*s+c,g=this._images[u],p=document.getElementById("clip"+u);if(p&&!p.childNodes.length){var d=this.createThumbnailImage(g);p.appendChild(d)}}}},t.prototype.createThumbnailImage=function(e){var t,n=document.createElement("img");return Sys.UI.DomElement.addCssClass(n,"ClipartThumbImage"),n.setAttribute("src",e.get_thumbnailUrl()),t=e.get_displayName()?e.get_displayName():Box4Intl.Box4Strings.l_ClipartImageAltNoCaption,n.setAttribute("title",t),n.setAttribute("alt",t),qo.n.addHandler(n,"click",this._previewClipHandler),qo.n.addHandler(n,"error",this._thumbnailLoadErrorHandler),n},t.prototype.deleteThumbnailImage=function(e){if(1===e.childNodes.length){var t=e.childNodes[0];qo.n.removeHandler(t,"click",this._previewClipHandler),qo.n.removeHandler(t,"error",this._thumbnailLoadErrorHandler)}},t.prototype.onThumbnailLoadError=function(e){e.target.setAttribute("src",Za.f.box4Image("phthumb.64x64x32.png"))},t.prototype.onPreviewLoadError=function(e){e.target.setAttribute("src",Za.f.box4Image("phpreview.96x96x32.png"))},t.prototype.previewClip=function(e){var t=this._images[e],n=t.get_previewUrl();t.get_clipUrl();this.cleanupPreview(),this._previewLoadErrorHandler=o.i(this,this.onPreviewLoadError,"onPreviewLoadError");var r,i=document.createElement("img");if(i.setAttribute("src",n),t.get_displayName())r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltWithCaption,t.get_displayName());else{for(var a=new Sys.StringBuilder,s=0;s<t.get_keywords().length&&s<5;s++)s&&a.append(", "),a.append(t.get_keywords()[s]);r=String.format(Box4Intl.Box4Strings.l_ClipartPreviewAltNoCaption,a.toString())}i.setAttribute("title",r),i.setAttribute("alt",r),qo.n.addHandler(i,"error",this._previewLoadErrorHandler),this._divPreview.appendChild(i);var l=document.getElementById("clip"+this._iSelectedClip);Sys.UI.DomElement.removeCssClass(l,"ClipartSelectedImage"),l=document.getElementById("clip"+e),Sys.UI.DomElement.addCssClass(l,"ClipartSelectedImage"),this._iSelectedClip=e,t.get_displayName()&&(this._divDisplayName.innerText=t.get_displayName());var c=document.createElement("a");c.innerText=Box4Intl.Box4Strings.l_ClipartSeeSimilarLink,c.setAttribute("href",'""'),qo.n.addHandler(c,"click",this._seeSimilarClickHandler),qo.n.addHandler(c,"keydown",this._seeSimilarKeyDownHandler),this._divSeeSimilar.appendChild(c),this._divDimensions.innerText=String.format("{0} | {1} | {2}",t.get_dimensions(),t.get_resolution(),t.get_fileSize());var u=t.get_additionalLink();u&&t.get_additionalCaption()?(this._divAdditional.parentNode.style.display="block",this._divAdditionalName.innerText=t.get_additionalCaption(),this._divAdditional.appendChild(u)):this._divAdditional.parentNode.style.display="none",this._divRating.appendChild(t.get_ratingSpan()),_i.s.clearElementHtml(this._divAttribution);var g=t.get_attributionLink();g&&(this._divAttribution.appendChild(g),"a"===g.nodeName.toLowerCase()&&(qo.n.addHandler(g,"click",this._hyperlinkClickHandler),qo.n.addHandler(g,"keydown",this._hyperlinkKeyDownHandler))),this._divKeywords.innerText=Box4Intl.Box4Strings.l_ClipartKeywords;for(s=0;s<t.get_keywords().length;s++){var p=t.get_keywords()[s],d=document.createElement("a");if(d.innerText=p,d.setAttribute("href",'""'),qo.n.addHandler(d,"click",this._keywordClickHandler),qo.n.addHandler(d,"keydown",this._keywordKeyDownHandler),this._divKeywords.appendChild(d),s<t.get_keywords().length-1){var h=document.createElement("span");h.innerText=", ",this._divKeywords.appendChild(h)}}this._divRatingName.innerText=Box4Intl.Box4Strings.l_ClipartRating,this._divAttributionName.innerText=Box4Intl.Box4Strings.l_ClipartProvidedBy,this.setButtonState(1,!0)},t.prototype.cleanupPreview=function(){if(this._divPreview&&1===this._divPreview.childNodes.length&&(this._previewLoadErrorHandler&&(qo.n.removeHandler(this._divPreview.childNodes[0],"error",this._previewLoadErrorHandler),this._previewLoadErrorHandler=null),_i.s.clearElementHtml(this._divPreview)),this._divAttribution&&this._divAttribution.childNodes.length>0&&"a"===this._divAttribution.childNodes[0].nodeName.toLowerCase()&&(this._hyperlinkClickHandler&&qo.n.removeHandler(this._divAttribution.childNodes[0],"click",this._hyperlinkClickHandler),this._hyperlinkKeyDownHandler&&qo.n.removeHandler(this._divAttribution.childNodes[0],"keydown",this._hyperlinkKeyDownHandler)),this._divSeeSimilar&&this._divSeeSimilar.children.length>0&&"a"===this._divSeeSimilar.children[0].nodeName.toLowerCase()&&(this._seeSimilarClickHandler&&qo.n.removeHandler(this._divSeeSimilar.children[0],"click",this._seeSimilarClickHandler),this._seeSimilarKeyDownHandler&&qo.n.removeHandler(this._divSeeSimilar.children[0],"keydown",this._seeSimilarKeyDownHandler),_i.s.clearElementHtml(this._divSeeSimilar)),this._divKeywords){for(var e=0;e<this._divKeywords.childNodes.length;e++){var t=this._divKeywords.childNodes[e];"a"===t.nodeName.toLowerCase()&&(qo.n.removeHandler(t,"click",this._keywordClickHandler),qo.n.removeHandler(t,"keydown",this._keywordKeyDownHandler))}_i.s.clearElementHtml(this._divKeywords)}this._divDisplayName.innerText="",this._divDimensions.innerText="",_i.s.clearElementHtml(this._divAdditional),_i.s.clearElementHtml(this._divRating),_i.s.clearElementHtml(this._divAttribution),this._divKeywords.innerText="",this._divAdditionalName.innerText="",this._divRatingName.innerText="",this._divAttributionName.innerText=""},t.prototype.forceRepeatSearch=function(e){this._prevQuery=null,this._prevSimilar?(this._iSelectedClip=0,this._iFocusedClip=0,this.onSeeSimilarClick(e)):this.onSearchButton(e)},t.prototype.onHyperlinkClick=function(e){window.open(e.target.attributes.getNamedItem("href").value,e.target.attributes.getNamedItem("target").value),e.stopPropagation(),e.preventDefault()},t.prototype.onHyperlinkKeyDown=function(e){(e?e.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.onHyperlinkClick(e)},t.prototype.onKeywordClick=function(e){var t=e.target.innerText;this._textInput&&(this._textInput.value=t),this.search(t),e.stopPropagation(),e.preventDefault(),this.setButtonState(1,!1)},t.prototype.onKeywordKeyDown=function(e){(e?e.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.onKeywordClick(e)},t.prototype.onSeeSimilarClick=function(e){this._images&&(this.searchSimilar(this._images[this._iSelectedClip]),e.stopPropagation(),e.preventDefault(),this._textInput.value="",this.setButtonState(1,!1))},t.prototype.onSeeSimilarKeyDown=function(e){(e?e.keyCode:window.event.keyCode)===Sys.UI.Key.enter&&this.onSeeSimilarClick(e)},t.prototype.onKeyDown=function(e){if(e.keyCode>=Sys.UI.Key.left&&e.keyCode<=Sys.UI.Key.down){var t=0;switch(e.keyCode){case Sys.UI.Key.up:t=-5;break;case Sys.UI.Key.down:t=5;break;case Sys.UI.Key.left:t=-1;break;case Sys.UI.Key.right:t=1}this._iFocusedClip=this._iFocusedClip+t<this._searchResult.children.length-1?this._iFocusedClip+t<0?0:this._iFocusedClip+t:this._searchResult.children.length-1,this.setFocusOnClip(this._iFocusedClip),e.preventDefault(),e.stopPropagation()}else if(e.keyCode===Sys.UI.Key.enter){var n=e.target.id,r=Number.parseInvariant(n.substr(4));r>=0&&r<this._searchResult.children.length&&this.selectSearchResult(r)}else e.keyCode===Sys.UI.Key.tab&&(this._iFocusedClip=e.shiftKey?Math.max(0,this._iFocusedClip-1):Math.min(this._iFocusedClip+1,this._searchResult.children.length-1))},t.prototype.selectSearchResult=function(e){if(!(this._searchResult.children.length<=e||e<0)){var t=this._searchResult.children[e],n=this._searchResult.children[0],r=n.clientHeight-n.children[0].clientHeight+2;this._searchResult.scrollTop+this._searchResult.clientHeight<t.offsetTop+t.clientHeight?this._searchResult.scrollTop=t.offsetTop-3*t.clientHeight-r:this._searchResult.scrollTop>t.offsetTop&&(this._searchResult.scrollTop=t.offsetTop-r/2),this.previewClip(e)}},t.prototype.validate=function(){return!0},t.prototype.onError=function(e){this._searchResult&&(this._searchResult.innerText=Box4Intl.Box4Strings.l_ClipartCannotConnect)},t.prototype.processSearchResults=function(e){if(this._searchResult)if(e.get_data().responseXml){var t=e.get_data().responseXml.lastChild.childNodes;this._images||(this._images=[]);for(var n=0;n<t.length&&this._images.length<100;n++){var r=t[n];if(LS.element===r.nodeType&&"image"===r.nodeName){var i=BS.fromXML(r);Array.add(this._images,i)}}this.displaySearchResults(),this._images.length||(this._searchResult.innerText=Box4Intl.Box4Strings.l_ClipartNoResultsFound)}else if(e.get_data().responseData){var o=e.get_data().responseData,a=Jn.l.stripPreTag(o),s=void 0;try{s=parseInt(a)}catch(e){s=14}this._searchResult.innerText=26===s?Box4Intl.Box4Strings.l_ClipartCannotConnect:Box4Intl.Box4Strings.l_ClipartNoResultsFound}},t.prototype.displaySearchResults=function(){if(this._images){_i.s.clearElementHtml(this._searchResult),this._progress&&(this._progress.dispose(),this._progress=null),this._searchResult.focus(),Sys.UI.DomElement.removeCssClass(this._searchResult,"ClipartSearchInProgress");for(var e=0;e<this._images.length;e++){var t=document.createElement("a");t.setAttribute("href","#"),t.id="itab"+e;var n=document.createElement("span");if(n.id="clip"+e,Sys.UI.DomElement.addCssClass(n,"ClipartImageContainer"),t.appendChild(n),this._searchResult.appendChild(t),e<parseInt(String(this._searchResult.clientHeight/n.clientHeight))*parseInt(String(this._searchResult.clientWidth/n.clientWidth))){var r=this.createThumbnailImage(this._images[e]);n.appendChild(r)}}this._prevSimilar&&(this.selectSearchResult(this._iSelectedClip),this.setFocusOnClip(this._iSelectedClip))}},t.prototype.cleanupSearchResults=function(){if(Nt.FocusManager.usable()){var e=Nt.FocusManager.instance().getRegion(this.get_fullDialogFocusId());e&&e.listing.trySetCurrentElement(this._textInput)}else this._textInput.focus();for(var t=0;t<this._searchResult.childNodes.length;t++){var n=this._searchResult.childNodes[t];1===n.childNodes.length&&this.deleteThumbnailImage(n.childNodes[0])}_i.s.clearElementHtml(this._searchResult),this.cleanupPreview(),this.setButtonState(1,!1),this._progress=new US.k(Box4Intl.Box4Strings.l_ClipartSearching),this._progress.set_isSmall(!1),this._searchResult.appendChild(this._progress.get_element()),Sys.UI.DomElement.addCssClass(this._searchResult,"ClipartSearchInProgress")},t.prototype.insertClipartDialogHandler=function(e,n){if(1===e&&this._images&&(2!==Br.App.get_mode()||t.get_imageEditor().canInsertPictureInContext(this._clipartUploader.get_context()))){var r=this._images[this._iSelectedClip];r&&this._clipartUploader.startUpload(r)}},t.prototype.setFocusOnClip=function(e){this._iFocusedClip=e;var t=this._searchResult.children[this._iFocusedClip];Nt.FocusManager.usable()?Nt.FocusManager.instance().getRegion(this.get_fullDialogFocusId()).listing.trySetCurrentElement(t):t.focus()},t.get_imageEditor=function(){return t._imageEditor=t._imageEditor||se.w.get_instance().resolve(rl.w)},t._imageEditor=null,t}(ri.o);(0,o.l)(GS,"InsertClipartDialog",ri.o,[]);var VS=n(6928),WS=n(601),zS=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n,r,i,o,a,!1)||this;return new GS(s),s}return(0,S.t)(t,e),t.prototype.startUpload=function(e){this.insertPlaceholder()&&this._node.getParentGraphSpace().get_contentReplicator().forceOutbound(o.i(this,this.onPlaceholderNodeSaved$3,"onPlaceholderNodeSaved$3"),null,e)},t.prototype.onPlaceholderNodeSaved$3=function(e){if(this.isPlaceholderValid()){var t=this._node.getParentGraphSpace(),n=t.get_contentReplicator().get_lastReplicated().toString(),r=e,i=new Sys.Net.WebRequest;i.set_url("ClipArtUpload.ashx");var a=new Sys.StringBuilder(i.getResolvedUrl());this.addEscapedAttribute(a,Lh.a.assetId,r.get_assetId(),!0),this.addEscapedAttribute(a,Rh.h.lcid,L.AFrameworkApplication.lcid.toString());var s=this._blob?this._blob.id.toString():this._node.get_id().toString();this.addEscapedAttribute(a,Rh.h.nodeId,s),this.addEscapedAttribute(a,Rh.h.cellId,t.get_objectSpaceId().toString()),this.addEscapedAttribute(a,Rh.h.fileId,t.get_fileQuerySignature()),this.addEscapedAttribute(a,Rh.h.baseRevisionId,n),this.addEscapedAttribute(a,Rh.h.desiredRevisionId,this._desiredRevisionId.toString());var l=wh.z.lockIdNil;us.n.get_instance().get_item(50)&&(l=this._node.getValueWithDefault(Number,Oh.p.lockId,wh.z.lockIdNil)),this.addEscapedAttribute(a,Rh.h.lockId,l.toString()),us.n.get_instance().get_item(11)&&this.addEscapedAttribute(a,Rh.h.wordMode,"1"),t.get_encryptionSessionString()&&this.addEscapedAttribute(a,Rh.h.encryptionSessionString,t.get_encryptionSessionString());var c=this._blob?this._blob.properties.get_runtimeClassId().toString():this._node.get_runtimeClassId().toString();this.addEscapedAttribute(a,Rh.h.classId,c),this._propertySet.hasProperty(ks.j.imageType)&&this.addEscapedAttribute(a,Lh.a.imageType,this._propertySet.getValue(Number,ks.j.imageType).toString()),Nh.n.get_instance().addToUrlStringBuilder(a),L.AFrameworkApplication.theClientRequestManager.addRequest(a.toString(),2,"",{},!1,2,o.i(this,this.uploadFinished,"uploadFinished"),o.i(this,this.uploadFailed,"uploadFailed"),null),NS.e.numberOfImagesUploading++}},t.prototype.addEscapedAttribute=function(e,t,n,r){e.append(r?"?":"&"),e.append(Jn.l.urlKeyValueEncode(t)),e.append("="),e.append(Jn.l.urlKeyValueEncode(n))},t.prototype.uploadFinished=function(e){var t,n=e.get_data().responseData;if(Bh.j.tryDeserializeServerResponse(n,(0,p.m)((function(){return t}),(function(e){return t=e})))){var r=t.Responses[0];r.requestInvokedTime=e.get_data().invokedTime,r.correlation=e.get_data().responseHeaders?e.get_data().responseHeaders[WS.h.correlationIdHeaderName]:"",this.uploadResponseReceived(r)}else this.uploadFailed(null)},t.prototype.uploadFailed=function(e){e&&e.get_data()&&e.get_data().responseData;var t=new VS.x;t.StatusCode=14,this.uploadResponseReceived(t)},t.prototype.errorMessageFromCode=function(t){switch(t){case 26:return Box4Intl.Box4Strings.l_ClipartCannotConnect;case 27:return Box4Intl.Box4Strings.l_ClipartCannotDownload;default:return e.prototype.errorMessageFromCode.call(this,t)}},t.prototype.uploadResponseReceived=function(t){e.prototype.uploadResponseReceived.call(this,t),NS.e.numberOfImagesUploading--},t.get_imageEditor$3=function(){return t._imageEditor$3||(t._imageEditor$3=se.w.get_instance().resolve(rl.w))},t._imageEditor$3=null,t}(NS.e);(0,o.l)(zS,"ClipartUploader",NS.e,[]);var KS=function(){function e(e,t,n){this._imageEditor=null,this._undoManager=null,this._actionManager=null,this._imageEditor=e,this._undoManager=t,this._actionManager=n}return e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(ii.Jm,cl.n,o.i(this,this.insertClipartDialogView,"insertClipartDialogView"),260)},e.prototype.insertClipartDialogView=function(e,t,n,r,i){var o=this._imageEditor.canInsertPictureInContext(t),a=i;return 2===n&&o?(new zS(t,Oe.y.get_instance(),L.AFrameworkApplication.appSettingsManager,a,this._undoManager,this._actionManager),32):1===n?o&&Br.App.clipartInsertEnabled?32:8:2},e}();(0,o.l)(KS,"ClipArtActor",null,[]);var qS=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.ClipArt"},e.prototype.configure=function(e){this._container=e,e.register(KS).singleInstance().usingFactory((function(){return new KS(e.resolve(rl.w),e.resolve(ja.n),L.AFrameworkApplication.get_theActionManager())}))},e.prototype.init=function(){this._container.resolve(KS).registerActions();var e=Br.App.get_activeAppFrame();e&&e.updateCommandUI()},e.prototype.dispose=function(){},e}();(0,o.l)(qS,"ClipartPackage",null,[l.u,c.s]);var jS=(0,o.y)("IListMarker"),$S=function(){function e(e,t){this._listMarker=null,this._font=null,this.levelInfo=null,this.multilevelDefInfo=null,this._listMarker=e,this._font=t}return e.prototype.get_previewContent=function(){return this.get_levelText()},e.prototype.get_levelInfo=function(){return this.levelInfo},e.prototype.get_levelText=function(){return this._listMarker},e.prototype.get_listStyle=function(){return 6},e.prototype.get_justification=function(){return"left"},e.prototype.get_multilevelDefInfo=function(){return this.multilevelDefInfo},e.prototype.get_font=function(){return this._font},e}();(0,o.l)($S,"ListMarkerBullet",null,[jS]);var QS=(0,o.y)("IListMarkerGalleryLoader"),JS=function(){function e(){this.listMarkersDictionary=null,this.listMarkersInDocumentDictionary=null,this.listMarkersDictionary=new yt.q(Object,o.i(this,this.createListMarkerDictionary,"createListMarkerDictionary")),this.listMarkersInDocumentDictionary={}}return e.prototype.get_listMarkersDictionary=function(){return this.listMarkersDictionary},e.prototype.get_listMarkersInDocumentDictionary=function(){return this.listMarkersInDocumentDictionary},e}();(0,o.l)(JS,"AListMarkerGalleryLoader",null,[QS]);var XS=n(1421),YS=function(e){function t(){var t=e.call(this)||this;return t.LevelInfo=null,t}return(0,S.t)(t,e),t.prototype.get_Type=function(){return 4},t}(Qg.f);(0,o.l)(YS,"ListGalleryButtonProps",Qg.f,[]);var ZS=function(){function e(e,t,n,r){switch(this._listMarkerType=0,this._listMarkerIdPrefix=null,this._listInfos=null,this._isSimplifiedRibbonEnabled=!1,this.bulletExternalGalleryId="BulletLibraryGallery",this.numberingExternalGalleryId="NumberingLibraryGallery",this.multilevelExternalGalleryId="MultilevelGallery",this.bulletsInDocumentGalleryExternalId="BulletDocumentGallery",this.numberingInDocumentGalleryExternalId="NumberingDocumentGallery",this.listMarkersLoader=null,this._listMarkerType=e,this.listMarkersLoader=t,e){case 0:this._listMarkerIdPrefix="BulletStyle";break;case 1:this._listMarkerIdPrefix="NumberingStyle";break;case 2:this._listMarkerIdPrefix="MultilevelStyle";break;default:this._listMarkerIdPrefix="BulletStyle"}this._listInfos=n,this._isSimplifiedRibbonEnabled=r}return e.prototype.get_listMarkersLoader=function(){return this.listMarkersLoader},e.prototype.getListMarkerGalleryDropDownXml=function(){var e=this.getListMarkerGalleryDropDownProps();return Tu.gu(e)},e.prototype.getListMarkerGalleryDropDownProps=function(e){void 0===e&&(e=!1);var t=(0,O.m)(new ga.b,{Id:"menuListMarkersDropDown",MenuSectionList:[]});return Array.add(t.MenuSectionList,this.addListMarkersPositionsGallery(e)),this.get_listMarkersLoader().updateListMarkersInDocumentDictionary(this._listInfos),of.f(this.get_listMarkersLoader().get_listMarkersInDocumentDictionary()).length>0&&Array.add(t.MenuSectionList,this.addListMarkersInDocumentGallery()),this._listMarkerType||Array.add(t.MenuSectionList,this.addDefineNewBulletButton()),t},e.prototype.addListMarkersPositionsGallery=function(e){var t,n,r=1,i="";switch(this._listMarkerType){case 0:t=Box4Intl.Box4Strings.L_BulletsLibraryTitle,n="BulletsLibrary",i="BulletsLibrary";break;case 1:t=Box4Intl.Box4Strings.L_NumberingLibraryTitle,n="NumberingLibrary",r=4,i="NumberingLibrary";break;case 2:t=Box4Intl.Box4Strings.L_ListLibraryTitle,n="MultilevelLibrary",r=4,i="Multilevel";break;default:t=Box4Intl.Box4Strings.L_BulletsLibraryTitle,n="BulletsLibrary",i="BulletsLibrary"}for(var o=(0,O.m)(new pa.x,{Id:String.format("msListMarkersPosition{0}",n),Title:t,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),a=this._listMarkerType?"Size48by48":"Size40by40",s=(0,O.m)(new hp.b,{Id:String.format("galleryListMarkersPosition{0}",n),ExternalId:i,ExternalGalleryId:this.getGalleryExternalId(this._listMarkerType),Type:r,Width:6,ElementDimensions:a,GalleryItems:new Array(0)}),l=this.get_listMarkersLoader().get_listMarkersDictionary().get_value(),c=of.f(l),u=Math.min(18,c.length),g=0;g<u;g++){var p=l[c[g]];this._isSimplifiedRibbonEnabled&&e&&(!(1!==this._listMarkerType&&2!==this._listMarkerType||p.get_levelInfo())||!this._listMarkerType&&p.get_levelText()===Box4Intl.Box4Strings.L_ListStyleNone)||s.GalleryItems.push(this.getGalleryButtonPropsForListMarker(this._listMarkerIdPrefix+n+"_"+g,p,this._listMarkerType))}return Array.add(o.ControlList,s),o},e.prototype.getGalleryExternalId=function(e){switch(e){case 0:return this.bulletExternalGalleryId;case 1:return this.numberingExternalGalleryId;case 2:return this.multilevelExternalGalleryId;default:return this.bulletExternalGalleryId}},e.prototype.getInDocumentGalleryExternalId=function(e){switch(e){case 0:return this.bulletsInDocumentGalleryExternalId;case 1:return this.numberingInDocumentGalleryExternalId;default:return this.bulletsInDocumentGalleryExternalId}},e.prototype.addListMarkersInDocumentGallery=function(){var e,t,n=1,r="";switch(this._listMarkerType){case 0:t=Box4Intl.Box4Strings.L_BulletsInDocumentTitle,e="DocumentBullets",r="BulletsInDocument";break;case 1:t=Box4Intl.Box4Strings.L_NumberingInDocumentTitle,e="DocumentNumbering",n=4,r="NumberingInDocument";break;case 2:t=Box4Intl.Box4Strings.L_MultilevelInDocumentTitle,e="DocumentMultilevelList",n=4;break;default:t=Box4Intl.Box4Strings.L_BulletsLibraryTitle,e="DocumentBullets",r="BulletsInDocument"}for(var i=(0,O.m)(new pa.x,{Id:String.format("msListMarkersPosition{0}",e),Title:t,ShowMenuSectionSeparator:!1,DisplayMode:"Menu16",ControlList:[]}),o=this._listMarkerType?"Size48by48":"Size40by40",a=(0,O.m)(new hp.b,{Id:String.format("galleryListMarkersInDocument{0}",e),ExternalId:r,ExternalGalleryId:this.getInDocumentGalleryExternalId(this._listMarkerType),Type:n,Width:6,ElementDimensions:o,GalleryItems:new Array(0)}),s=of.f(this.get_listMarkersLoader().get_listMarkersInDocumentDictionary()),l=Math.min(18,s.length),c=of.f(this.get_listMarkersLoader().get_listMarkersDictionary().get_value()).length,u=0;u<l;u++){var g=s[u];a.GalleryItems.push(this.getGalleryButtonPropsForListMarker(this._listMarkerIdPrefix+e+"_"+(u+c),this.get_listMarkersLoader().get_listMarkersInDocumentDictionary()[g],this._listMarkerType))}return Array.add(i.ControlList,a),i},e.prototype.addDefineNewBulletButton=function(){var e=this._listMarkerType?Box4Intl.Box4Strings.L_NumberingInDocumentTitle:Box4Intl.Box4Strings.L_BulletsInDocumentTitle,t=(0,O.m)(new pa.x,{Id:String.format("msListMarkersPosition{0}","DefineNewBullet"),Title:e,ControlsId:"ctrlMoreCommandsBullets",DisplayMode:"Menu16",ControlList:[]}),n=(0,O.m)(new da.k,{Command:"1851657168",LabelText:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_DefineNewBullet),Id:"DefineNewBullet",Alt:Jn.l.xmlEncode(Box4Intl.Box4Strings.L_DefineNewBullet)});return Array.add(t.ControlList,n),t},e.prototype.getFontStyle=function(e){var t={},n=Xu.v.convertFontNameToCSSValue(e.get_font());return t.fontFamily=Xu.v.addWebFontsToFallback(n,e.get_font(),!0,!1,!1),t},e.prototype.getGalleryButtonPropsForListMarker=function(t,n,r){var i,o,a="",s=!1;if(!r&&n.get_levelText()!==Box4Intl.Box4Strings.L_ListStyleNone){var l=Jn.l.convertToHex(n.get_levelText().charCodeAt(0),4);l=e.isAsciiFont(n.get_font())&&!l.indexOf("f")?" 0x0"+l.substr(1):" 0x"+l,a=n.get_font()+l,s=!0}var c=null;switch(r){case 0:i=ii.Gk,o=ii.df,c=(0,O.m)(new XS.n,{Character:n.get_levelText(),Style:this.getFontStyle(n)});break;case 1:i=ii.nQ,o=ii.rf,c=(0,O.m)(new YS,{LevelInfo:n.get_levelInfo()});break;case 2:i=ii.Ff,o=ii.PC,c=(0,O.m)(new YS,{LevelInfo:n.get_levelInfo()}),n.get_multilevelDefInfo()&&(a=n.get_multilevelDefInfo().description,s=!0);break;default:i=ii.Gk,o=ii.df,c=(0,O.m)(new XS.n,{Character:n.get_levelText(),Style:this.getFontStyle(n)})}return c.Id=t,c.Command=i.toString(),c.QueryCommand=o.toString(),c.Alt=a,c.InnerHTML=Jn.l.xmlEncode(this.listMarkerGalleryButtonInnerHtml(n)),c.ShouldSetTitle=s.toString(),c},e.prototype.listMarkerGalleryButtonInnerHtml=function(e){return String.format('<DIV class="ListMarkerPreview" style="{0}">{1}</DIV>',this.getListMarkerPreviewCssString(e),this.getListMarkerContentString(e))},e.prototype.getListMarkerPreviewCssString=function(t){var n=new Sys.StringBuilder;if(n.append("position: relative; "),t.get_previewContent()===Box4Intl.Box4Strings.L_ListStyleNone&&t.get_font()===e.invalidFontName)n.append("font-size: 12pt; "),n.append("top: 22%;");else{n.append("font-family: ");var r=Xu.v.convertFontNameToCSSValue(t.get_font());n.append(Xu.v.addWebFontsToFallback(r,t.get_font(),!0,!1,!1)),n.append("; "),n.append("font-size: 24pt;")}return n.toString()},e.prototype.getListMarkerContentString=function(e){return e.get_previewContent()},e.generalizeLevelText=function(e){var t=new RegExp("%[1-9]");return e.replace(t,"%1")},e.isAsciiFont=function(t){for(var n=0;n<e.asciiFonts.length;n++)if(t===e.asciiFonts[n])return!0;return!1},e.invalidFontName="EXYdHRyjlYTe8nDSGfyW",e.asciiFonts=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"],e}();(0,o.l)(ZS,"ListMarkerGalleryUtility",null,[]);var ev=function(e){function t(){var t=e.call(this)||this;return t._listMarkersInDocumentKeySet=null,t._listMarkersInDocumentKeySet=new Z.e(String,ee.b.get_ordinalIgnoreCase()),t}return(0,S.t)(t,e),t.prototype.createListMarkerDictionary=function(){var e={};return e[0]=new $S(Box4Intl.Box4Strings.L_ListStyleNone,ZS.invalidFontName),e[1]=new $S(String.fromCharCode(61623),"Symbol"),e[2]=new $S(String.fromCharCode(111),"Courier New"),e[3]=new $S(String.fromCharCode(61607),"Wingdings"),e[4]=new $S(String.fromCharCode(9643),"Courier New"),e[5]=new $S(String.fromCharCode(61611),"Wingdings"),e[6]=new $S(String.fromCharCode(61614),"Symbol"),e[7]=new $S(String.fromCharCode(61483),"Symbol"),e[8]=new $S(String.fromCharCode(61485),"Symbol"),e[9]=new $S(String.fromCharCode(9830),"Courier New"),e[10]=new $S(String.fromCharCode(61664),"Symbol"),e[11]=new $S(String.fromCharCode(61558),"Wingdings"),e[12]=new $S(String.fromCharCode(61656),"Wingdings"),e[13]=new $S(String.fromCharCode(61514),"Wingdings"),e[14]=new $S(String.fromCharCode(61516),"Wingdings"),e[15]=new $S(String.fromCharCode(61692),"Wingdings"),e[16]=new $S(String.fromCharCode(61691),"Wingdings"),e[17]=new $S(String.fromCharCode(61553),"Wingdings"),e},t.prototype.updateListMarkersInDocumentDictionary=function(e){return e&&e.length?(this.buildListMarkersInDocumentDictionary(e),this.get_listMarkersInDocumentDictionary()):this.get_listMarkersInDocumentDictionary()},t.prototype.prepareListMarkersInDocumentDictionarySet=function(){if(this.get_listMarkersInDocumentDictionary())for(var e=of.f(this.get_listMarkersInDocumentDictionary()),t=e.length,n=0;n<t;n++){var r=e[n],i=this.get_listMarkersInDocumentDictionary()[r],o=i.get_levelText()+"_"+i.get_font();this._listMarkersInDocumentKeySet.add(o)}},t.prototype.buildListMarkersInDocumentDictionary=function(e){this.prepareListMarkersInDocumentDictionarySet();for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r&&!r.get_isOrdered()&&r.get_hasLevelText()&&r.get_hasFont()){var i=r.get_levelText()+"_"+r.get_font();if(!this._listMarkersInDocumentKeySet.contains(i)){var o=of.f(this.get_listMarkersInDocumentDictionary()).length+of.f(this.get_listMarkersDictionary().get_value()).length+"";this.get_listMarkersInDocumentDictionary()[o]=new $S(r.get_levelText(),r.get_font()),this._listMarkersInDocumentKeySet.add(i)}}}},t}(JS);(0,o.l)(ev,"ListMarkerBulletLoader",JS,[]);var tv=function(){return function(){this.textAtLevel=null,this.styleAtLevel=null}}();(0,o.l)(tv,"InfoAtLevel",null,[]);var nv=function(){function e(e){this._multilevelDefInfo=null,this._multilevelDefInfo=e}return e.prototype.get_font=function(){return"Calibri"},e.prototype.get_listStyle=function(){return 42},e.prototype.get_justification=function(){return"left"},e.prototype.get_multilevelDefInfo=function(){return this._multilevelDefInfo},e.prototype.get_previewContent=function(){return this._multilevelDefInfo?this.previewMultiLevelButton(3):this.previewMultilevelNoneButton()},e.prototype.get_levelInfo=function(){return this._multilevelDefInfo?this.previewMultiLevelButtonWithoutCSS(3):null},e.prototype.get_levelText=function(){return""},e.prototype.getFirstNumberForStyle=function(e){switch(e){case 1:return"1";case 2:return"a";case 3:return"i";case 4:return"A";case 5:return"I";case 0:return"";default:return"1"}},e.prototype.previewMultiLevelButton=function(t){for(var n="",r=0;r<t;r++)n+=this.getPreviewLine(r);return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',e.getCssString(),n)},e.prototype.previewMultiLevelButtonWithoutCSS=function(e){for(var t=new Array(0),n=0;n<e;n++)t.push((0,O.m)(new tv,{textAtLevel:this.getPreviewLineWithoutCSS(n),styleAtLevel:this.getStyleForLevel(n)}));return t},e.prototype.previewMultilevelNoneButton=function(){return String.format('<DIV class="ListMultilevelPreview" style="{0}">{1}</DIV>',e.getCssStringForNone(),Box4Intl.Box4Strings.L_ListStyleNone)},e.prototype.getPreviewLineWithoutCSS=function(e){for(var t=this._multilevelDefInfo.levelTextArray[e],n=0;n<9;n++){var r=this._multilevelDefInfo.listStyleArray[n];t=Jn.l.replaceAll(t,"%"+(n+1),this.getFirstNumberForStyle(r))}return t},e.prototype.getStyleForLevel=function(e){var t={},n=this._multilevelDefInfo.listStyleArray[e];return t.fontFamily=6===n?this._multilevelDefInfo.fontArray[e]:this.get_font(),t},e.prototype.getPreviewLine=function(e){var t=this.getPreviewLineWithoutCSS(e),n=new Sys.StringBuilder;6===this._multilevelDefInfo.listStyleArray[e]&&n.append(String.format("font-family:{0};",this._multilevelDefInfo.fontArray[e]));return String.format('<DIV class="level{0}" style="position: relative;">\r\n\t\t\t\t\t<SPAN style="{1}">{2}</SPAN>\r\n\t\t\t\t\t<SPAN style="height: 2px; margin-left: 4px; margin-right: 4px; background-color: #aaaaaa; width: 100%; position: absolute; top: 50%; outline: 1px solid transparent;"></SPAN>\r\n\t\t\t\t</DIV>',e,n.toString(),t)},e.getCssString=function(){var e=new Sys.StringBuilder;return e.append("padding-left: 2pt; "),e.append("font-size: 9pt; "),e},e.getCssStringForNone=function(){var e=new Sys.StringBuilder;return e.append("text-align: center; "),e.append("margin-top: 22%; "),e.append("font-size: 12pt; "),e},e}();(0,o.l)(nv,"ListMarkerMultilevel",null,[jS]);var rv=function(){return function(e,t,n,r,i){this.levelTextArray=null,this.listStyleArray=null,this.justificationArray=null,this.fontArray=null,this.description=null,this.levelTextArray=e,this.listStyleArray=t,this.justificationArray=r,this.fontArray=n,this.description=i}}();(0,o.l)(rv,"MultilevelDefInfo",null,[]);var iv=function(){function e(){}return e.prototype.createDefaultMultilevel=function(e){for(var t="",n=new Array(9),r=new Array(9),i=new Array(9),o=new Array(9),a=0;a<9;a++)t+="%"+(a+1)+".",n[a]=t,r[a]=1,i[a]="left";return new rv(n,r,o,i,e)},e.prototype.createNumbers=function(e,t,n){for(var r=new Array(9),i=new Array(9),o=0;o<9;o++)r[o]=o%3==2?"right":"left";return new rv(e,t,i,r,n)},e.prototype.createBullets=function(e,t,n){for(var r=new Array(9),i=new Array(9),o=new Array(9),a=0;a<9;a++)o[a]=String.fromCharCode(e[a]),r[a]=6,i[a]="left";return new rv(o,r,t,i,n)},e}();(0,o.l)(iv,"MultilevelDefInfoAdaptor",null,[]);var ov=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.createListMarkerDictionary=function(){var e=new iv,t={};return t[0]=new nv(null),t[1]=new nv(e.createDefaultMultilevel(Box4Intl.Box4Strings.L_MultilevelListLabelNumericalStyle)),t[2]=new nv(e.createNumbers(["%1)","%2)","%3)","(%4)","(%5)","(%6)","%7.","%8.","%9."],[1,2,3,1,2,3,1,2,3],Box4Intl.Box4Strings.L_MultilevelListLabelAlphanumericalStyle)),t[3]=new nv(e.createBullets([61558,61656,61607,61623,9830,61656,61607,61623,9830],["Wingdings","Wingdings","Wingdings","Symbol","Courier New","Wingdings","Wingdings","Symbol","Courier New"],Box4Intl.Box4Strings.L_MultilevelListLabelBulletedStyle)),t},t.prototype.updateListMarkersInDocumentDictionary=function(e){return this.get_listMarkersInDocumentDictionary()},t}(JS);(0,o.l)(ov,"ListMarkerMultilevelLoader",JS,[]);var av=function(){function e(e,t){this._levelText=null,this._listStyle=0,this.multilevelDefInfo=null,this._levelText=e,this._listStyle=t}return e.prototype.get_font=function(){return"Calibri"},e.prototype.get_listStyle=function(){return this._listStyle},e.prototype.get_justification=function(){switch(this._listStyle){case 3:case 5:return"right";default:return"left"}},e.prototype.get_multilevelDefInfo=function(){return this.multilevelDefInfo},e.prototype.get_previewContent=function(){switch(this._listStyle){case 1:return this.previewNumberingButton("1","2","3");case 2:return this.previewNumberingButton("a","b","c");case 3:return this.previewNumberingButton("i","ii","iii");case 4:return this.previewNumberingButton("A","B","C");case 5:return this.previewNumberingButton("I","II","III");case 0:return this.previewNumberingNoneButton();default:return this.previewNumberingButton("1","2","3")}},e.prototype.get_levelInfo=function(){var e=new Array(0),t={};switch(t.fontFamily=Xu.v.convertFontNameToCSSValue(this.get_font()),this._listStyle){case 1:return e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("1"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("2"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("3"),styleAtLevel:t})),e;case 2:return e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("a"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("b"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("c"),styleAtLevel:t})),e;case 3:return e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("i"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("ii"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("iii"),styleAtLevel:t})),e;case 4:return e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("A"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("B"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("C"),styleAtLevel:t})),e;case 5:return e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("I"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("II"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("III"),styleAtLevel:t})),e;case 0:return null;default:return e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("1"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("2"),styleAtLevel:t})),e.push((0,O.m)(new tv,{textAtLevel:this.getPreviewListCharacter("3"),styleAtLevel:t})),e}},e.prototype.get_levelText=function(){return this._levelText},e.prototype.previewNumberingButton=function(t,n,r){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}{2}{3}</DIV>',e.getCssString(),this.getPreviewLine(t),this.getPreviewLine(n),this.getPreviewLine(r))},e.prototype.previewNumberingNoneButton=function(){return String.format('<DIV class="ListNumberPreview" style="{0}">{1}</DIV>',e.getCssStringForNone(),Box4Intl.Box4Strings.L_ListStyleNone)},e.prototype.getPreviewLine=function(e){var t=this.getPreviewListCharacter(e);return String.format('<DIV style="position: relative;"><SPAN>{0}</SPAN><SPAN class="ListMarkerGalleryPreviewLine"></SPAN></DIV>',t)},e.prototype.getPreviewListCharacter=function(e){return Jn.l.replaceAll(this._levelText,"%1",e)},e.getCssString=function(){var e=new Sys.StringBuilder;return e.append("padding-left: 2pt; "),e.append("font-size: 9pt; "),e},e.getCssStringForNone=function(){var e=new Sys.StringBuilder;return e.append("text-align: center; "),e.append("margin-top: 22%; "),e.append("font-size: 12pt; "),e},e}();(0,o.l)(av,"ListMarkerNumbering",null,[jS]);var sv=function(e){function t(){var t=e.call(this)||this;return t._listMarkersInDocumentKeySet=null,t._listMarkersInDocumentKeySet=new Z.e(String,ee.b.get_ordinalIgnoreCase()),t}return(0,S.t)(t,e),t.prototype.isSimpleNumberingLevelText=function(e){var t=new RegExp("%[1-9]","g"),n=e.match(t);return!!n&&1===n.length},t.prototype.createListMarkerDictionary=function(){var e={};return e[0]=new av(Box4Intl.Box4Strings.L_ListStyleNone,0),e[1]=new av("%1.",5),e[2]=new av("%1.",4),e[3]=new av("%1.",1),e[4]=new av("%1.",2),e[5]=new av("%1.",3),e[6]=new av("%1)",5),e[7]=new av("%1)",4),e[8]=new av("%1)",1),e[9]=new av("%1)",2),e[10]=new av("%1)",3),e[11]=new av("(%1)",5),e[12]=new av("(%1)",4),e[13]=new av("(%1)",1),e[14]=new av("(%1)",2),e[15]=new av("(%1)",3),e},t.prototype.updateListMarkersInDocumentDictionary=function(e){return e&&e.length?(this.buildListMarkersInDocumentDictionary(e),this.get_listMarkersInDocumentDictionary()):this.get_listMarkersInDocumentDictionary()},t.prototype.prepareListMarkersInDocumentDictionarySet=function(){if(this.get_listMarkersInDocumentDictionary())for(var e=of.f(this.get_listMarkersInDocumentDictionary()),t=e.length,n=0;n<t;n++){var r=e[n],i=this.get_listMarkersInDocumentDictionary()[r],o=i.get_levelText()+"_"+i.get_listStyle();this._listMarkersInDocumentKeySet.add(o)}},t.prototype.buildListMarkersInDocumentDictionary=function(e){this.prepareListMarkersInDocumentDictionarySet();for(var t=0,n=e;t<n.length;t++){var r=n[t];if(r&&r.get_isOrdered()&&r.get_hasLevelText()&&this.isSimpleNumberingLevelText(r.get_levelText())&&r.get_listStyle()){var i=ZS.generalizeLevelText(r.get_levelText());if(i){var o=i+"_"+r.get_listStyle();if(!this._listMarkersInDocumentKeySet.contains(o)){var a=of.f(this.get_listMarkersInDocumentDictionary()).length+of.f(this.get_listMarkersDictionary().get_value()).length+"";this.get_listMarkersInDocumentDictionary()[a]=new av(i,r.get_listStyle())}this._listMarkersInDocumentKeySet.add(o)}}}},t}(JS);(0,o.l)(sv,"ListMarkerNumberingLoader",JS,[]);var lv=function(){function e(){}return e.get_listEditor=function(){return e._listEditor||(e._listEditor=se.w.get_instance().resolve(rs.v))},e.get_listReader=function(){return e._listReader||(e._listReader=se.w.get_instance().resolve(ts.c))},e.get_insertionPointFormatting=function(){return e._insertionPointFormatting||(e._insertionPointFormatting=se.w.get_instance().resolve(ah.c))},e.get_externalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=se.w.get_instance().resolveFuture(gh.i))},e.get_contextSetEditor=function(){return kf.ContextSetEditor.get_instance()},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_activityManager=function(){return ji.y.get_instance()},e.get_listSettings=function(){return e._listSettings||(e._listSettings=se.w.get_instance().tryResolve(xm.r))},e.get_singleLevelListEditor=function(){return e._singleLevelListEditor||(e._singleLevelListEditor=se.w.get_instance().tryResolve(Tm))},e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(ii.Gk,cl.n,e.applyBulletsNumberingView),t.addAction(ii.Gk,cl.z,e.applyBulletsNumbering),t.setActionFlags(ii.Gk,1036),t.addAction(ii.nQ,cl.n,e.applyBulletsNumberingView),t.addAction(ii.nQ,cl.z,e.applyBulletsNumbering),t.setActionFlags(ii.nQ,1036),e.get_listReader().get_listSymbolsImprovementsEnabled()&&(t.addAction(ii.Ff,cl.n,e.applyBulletsNumberingView),t.addAction(ii.Ff,cl.z,e.applyBulletsNumbering),t.setActionFlags(ii.Ff,1036)),t.addAction(ii.rk,cl.n,Ze.ActionManager.doNothingButReportHandler),t.addAction(ii.XD,cl.n,Ze.ActionManager.doNothingButReportHandler),t.addAction(ii.nh,cl.n,Ze.ActionManager.doNothingButReportHandler),t.addAction(ii.DZ,cl.n,Ze.ActionManager.doNothingButReportHandler),t.addAction(ii.OJ,cl.n,Ze.ActionManager.doNothingButReportHandler),t.addAction(ii.Nw,cl.n,Ze.ActionManager.doNothingButReportHandler),t.addAction(ii.Og,cl.n,Ze.ActionManager.doNothingButReportHandler),t.addAction(ii.uO,cl.n,Ze.ActionManager.doNothingButReportHandler)},e.applyBulletsNumberingView=function(t,n,r,i,o){if(!n.view.get_isInteractiveView())return 2;var a=e.get_activityManager().startActivity(ii.VC);i.dataValue1=42,i.dataValue2=42;var s={PerfMarkStart:5796,PerfMarkEnd:5797},l=n.view;if(us.n.get_instance().get_item(11)){if(e.get_contextSetEditor().contextContentsCheck(e.imageCheck,l.get_selectionManager().get_selectionContextForActionDispatch()))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsImage}),a.end(),8;if(e.get_contextSetEditor().contextContentsCheck(e.anchoredImageCheck,l.get_selectionManager().get_selectionContextForActionDispatch()))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsAnchoredImage}),a.end(),8}if(us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isContextSetInLockedParagraphs(l.get_selectionManager().get_selectionContextForActionDispatch()))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsLockedRange}),a.end(),8;if(e.get_externalSelectionManagerFuture()&&e.get_externalSelectionManagerFuture().get_instance()&&e.get_externalSelectionManagerFuture().get_instance().isExternalSelectionContext(n))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.externalSelection}),a.end(),8;if(1===r)return a.end(),32;o||(o=new Kl.DictionaryPropertySet);var c=null,u=2;if(2===r){(c=new as.GraphTransaction(15)).setFromNode(n.view.get_targetNode()),e.isSwitchStyleByRangeSelect=!1;var g=l.get_selectionManager(),p=Tf.generalizeSelectionToOEs(g.get_selectionCollection(),!1);if(!p)return c.dispose(),e.get_activityManager().recordEvent(D_.f.failedProcessingStep,{Reason:M_.i.failedToGeneralizeToOEs}),a.end(),8;L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings"),p.get_length()>1&&o.setValue(zl.k.multipleOeSelection,null);var d=o.getValueWithDefault(Number,zl.k.listStyleId,-1),h=o.getValueWithDefault(Number,zl.k.listSoftType,-1);if(e.get_listSettings().isSingleLevelListImprovementEnabled&&e.get_singleLevelListEditor()&&e.get_singleLevelListEditor().checkTargetSetForSingleLevelListAndInflateIfNeeded(p),e.get_listReader().get_switchListByRangeSelectionImprovementIsEnabled()){var _=e.shouldClearList(d,h,p);_&&(o.setValue(zl.k.listSoftType,16),o.setValue(zl.k.listSoftStyle,0));var m=l.get_selectionManager().get_selectionContextForActionDispatch();if(!Pa.SelectionEditor.isInsertionPointContext(m)&&!_&&t!==ii.Ff&&p.get_length()>0&&d){for(var f=new Da.GraphIterator,y=new Array(p.get_length()),S=0;S<p.get_length();S++)f.set(p.getContext(S).get_node()),y[S]=e.get_listReader().getListInfo(f);if(e.shouldCleanListBeforeApplyNewListStlye(y,o)){var v=new Kl.DictionaryPropertySet;v.setValue(zl.k.listSoftType,16),v.setValue(zl.k.listSoftStyle,0),u=Rf(t,n,r,i,v,s,11),L.AFrameworkApplication.get_theActionManager().processAction(ii.Og,2),C.ULS.sendTraceTag(38544075,393,50,"List Actions: Switch List Style - Range Select"),e.isSwitchStyleByRangeSelect=!0}}}var b=new Da.GraphIterator;b.set(p.getContext(0).get_node());var T=e.get_listReader().getListInfo(b);e.logListActionsTelemetry(d,h,T,p.get_length())}return us.n.get_instance().get_item(63)||us.n.get_instance().get_item(77)?u=Rf(t,n,r,i,o,s,11):us.n.get_instance().get_item(30)&&(u=Lf(t,n,r,i,o,s)),32===u&&o.getValueWithDefault(Boolean,zl.k.autoDemoteLists,!1)&&(us.n.get_instance().get_item(62)?u=Rf(ii.Hm,n,r,i,o,s,11):us.n.get_instance().get_item(29)?u=Lf(ii.Hm,n,r,i,o,s):us.n.get_instance().get_item(76)),c&&c.dispose(),a.end(),u},e.shouldCleanListBeforeApplyNewListStlye=function(e,t){for(var n=null,r=!1,i=e.length-1;i>=0;i--){if(n){var o=e[i];r=-1!==t.getValueWithDefault(Number,zl.k.listStyleId,-3)?!o||(n.get_listType()!==o.get_listType()||n.get_listStyle()!==o.get_listStyle()):!o||n.get_listType()!==o.get_listType()}else n=e[i];if(r)break}if(n){var a=!1;if(!r){var s=t.getValueWithDefault(Number,zl.k.listSoftType,42),l=t.getValueWithDefault(Number,zl.k.listStyleId,-3);a=s!==n.get_listType()||l>0}if(r||a)return!0}return!1},e.logListActionsTelemetry=function(t,n,r,i){if(!(i<=0||e.isSwitchStyleByRangeSelect)){if(!t)return L.AFrameworkApplication.get_theActionManager().processAction(ii.uO,2),void C.ULS.sendTraceTag(39715533,393,50,"List Actions: Clean List Style - None list style");if(!r)return L.AFrameworkApplication.get_theActionManager().processAction(n?ii.DZ:ii.OJ,2),void C.ULS.sendTraceTag(39715534,393,50,"List Actions: Apply {0} List Style",n?"Bullet":"Numbering");var o=r.get_listType();return-1===t&&n===o?(L.AFrameworkApplication.get_theActionManager().processAction(ii.uO,2),void C.ULS.sendTraceTag(39715535,393,50,"List Actions: Clean List Style - Ribbon button")):t>0&&(!n||1===n)?(L.AFrameworkApplication.get_theActionManager().processAction(n?ii.DZ:ii.OJ,2),void C.ULS.sendTraceTag(39715536,393,50,"List Actions: Apply {0} List Style",n?"Bullet":"Numbering")):void 0}},e.shouldClearList=function(t,n,r){if(-1!==t&&t||!r.get_length())return!1;for(var i=new Da.GraphIterator,o=null,a=r.get_length()-1;a>=0&&(i.set(r.getContext(a).get_node()),!(o=e.get_listReader().getListInfo(i)));a--);return!(!o||n!==o.get_listType())},e.applyBulletsNumbering=function(t,n,r,i,o){if(n.get_contextId()!==cl.z)return 2;var a=n;if(us.n.get_instance().get_item(14)){var s=a.clone().specialize();if(e.get_lockedRangeEditor().isParaStartOrEndInLockedRange(s))return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),2}var l=new Da.GraphIterator;if(l.set(a.get_node()),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(l),!Ls.OutlineElementReader.isOutlineElement(l))return 2;if(1===r)switch(t){case ii.Gk:case ii.nQ:case ii.Ff:return 32;default:return 2}var c,u=e.get_listReader().getListInfo(l),g=o;if(!g)return 8;mc.ListReader.get_isListMarkerEnabled()||t===ii.nQ&&l.goToPreviousSibling()&&(l.hasChildrenOfRole(4)||g.setValue(zl.k.listLastStartAt,1),l.goToNextSibling());if(e.get_listReader().get_listSymbolsImprovementsEnabled()?(t===ii.nQ||t===ii.Gk?(g=e.get_listEditor().ensureValidPropertySetFromAction(t,g),c=ds.j.createFromScratch(g.getValue(Number,zl.k.listSoftType),g.getValue(Number,zl.k.listSoftStyle))):c=t===ii.Ff?ds.j.createFromScratch(0,1):null,e.logUsageData(t,g),e.setListPropertiesForListInfo(c,g)):(g=e.get_listEditor().ensureValidPropertySetFromAction(t,g),c=ds.j.createFromScratch(g.getValue(Number,zl.k.listSoftType),g.getValue(Number,zl.k.listSoftStyle))),mc.ListReader.get_isListMarkerEnabled()||c.set_restartAt(g.getValueWithDefault(Number,Kc.b.listRestart,wm.z.startAtNone)),e.setPropertyValuesFromIp(g,l),!e.get_listEditor().applyBulletsNumbering(g,l,(0,p.m)((function(){return c}),(function(e){return c=e})),!1))return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.listNotApplied}),2;if(2===r){L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");var d=o.getValueWithDefault(Number,zl.k.listSoftType,-1);if(c&&-1!==d){var h=o.getValueWithDefault(String,ks.j.listMultiLevelType,"Invalid MultiLevel Type");u?c.get_listType()&&1!==c.get_listType()||e.isSwitchStyleByRangeSelect||(L.AFrameworkApplication.get_theActionManager().processAction(ii.Nw,2),C.ULS.sendTraceTag(38544078,393,50,"List Actions: Switch Style - IP Select - {0}, {1}",d?"Bullet":"Numbering",h)):16===c.get_listType()?(L.AFrameworkApplication.get_theActionManager().processAction(ii.XD,2),C.ULS.sendTraceTag(38544076,393,50,"List Actions: ClearList Style - {0}, {1}",d?"Bullet":"Numbering",h)):c.get_listType()&&1!==c.get_listType()||e.isSwitchStyleByRangeSelect||(L.AFrameworkApplication.get_theActionManager().processAction(ii.rk,2),C.ULS.sendTraceTag(38544077,393,50,"List Actions: ApplyList Style - {0}, {1}",d?"Bullet":"Numbering",h))}var _=Nt.FocusManager.instance();_.get_currentScope().name===kg.u.ribbonFocusId&&_.scopeChanged($e.AFrame.documentFocusID)}return i.dataValue1=c.get_listType(),i.dataValue2=c.get_listStyle(),32},e.setPropertyValuesFromIp=function(t,n){var r=new Da.GraphIterator;r.setFrom(n);var i=r.goToFirstChildByRole(2);if(i&&cs.ParagraphReader.isParagraphNode(i)){var o=Oa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection();if(!o||!o.get_firstContext())return;var a=i;if(o.get_firstContext().get_node()!==a)return;Pa.SelectionEditor.isSelectionIpAtParagraphEnd(o)&&(e.setFontSizeFromIp(t),e.setFontColorFromIp(t))}},e.setListPropertiesForListInfo=function(t,n){if(n.hasProperty(ks.j.listMultiLevelType)&&t.setListMultiLevelType(n.getValue(String,ks.j.listMultiLevelType)),t.set_listStyleId(n.getValueWithDefault(Number,zl.k.listStyleId,-1)),t.get_isStyleSelected()){var r=e.getListMarker(t,n);e.setPropertiesFromListMarker(t,r)}else e.setDefaultProperties(t)},e.setDefaultProperties=function(e){if(e.get_isOrdered())e.get_hasListStyleId()&&-1===e.get_listStyleId()||(e.set_levelText("%1."),e.get_propertySet().hasProperty(Kc.b.numberListFormat)||e.setListStyle(0,1));else{if(1!==e.get_listType())return;e.get_hasListStyleId()&&-1===e.get_listStyleId()||(e.set_font(wm.z.defaultBulletFont),e.set_levelText(wm.z.defaultBullet),e.get_propertySet().hasProperty(Kc.b.numberListFormat)||e.setListStyle(1,6))}e.set_justification("left")},e.setPropertiesFromListMarker=function(t,n){1===t.get_listMultiLevelType()?e.setMulitlevelListPropertiesFromListMarker(t,n):e.setHybridListPropertiesFromListMarker(t,n)},e.setMulitlevelListPropertiesFromListMarker=function(e,t){e.multilevelDefInfo=t.get_multilevelDefInfo()},e.setHybridListPropertiesFromListMarker=function(e,t){if(e.set_levelText(t.get_levelText()),e.get_isOrdered()){var n=t.get_listStyle();e.setListStyle(0,n)}else e.set_font(t.get_font()),e.setListStyle(1,1);e.set_justification(t.get_justification())},e.getListMarker=function(e,t){var n=null;2===e.get_listMultiLevelType()?n=e.get_isOrdered()?se.w.get_instance().tryResolve(sv):se.w.get_instance().tryResolve(ev):1===e.get_listMultiLevelType()&&(n=se.w.get_instance().tryResolve(ov));var r=n.get_listMarkersDictionary().get_value(),i=e.get_listStyleId()+"";if(i in r||(r=n.get_listMarkersInDocumentDictionary()),!(i in r)&&t.hasProperty(Kc.b.font)){var o=t.getValueWithDefault(String,Kc.b.font,""),a=Jn.l.fromCharCode(parseInt(i));return new $S(a,o)}return r[i]},e.setFontColorFromIp=function(t){e.get_insertionPointFormatting().hasProperty(Kc.b.fontColor)&&t.setValue(Kc.b.fontColor,e.get_insertionPointFormatting().fontColor())},e.setFontSizeFromIp=function(t){e.get_insertionPointFormatting().hasProperty(Kc.b.fontSize)&&t.setValue(Kc.b.fontSize,e.get_insertionPointFormatting().fontSize())},e.logUsageData=function(e,t){var n=e===ii.Gk?0:e===ii.nQ?1:e===ii.Ff?2:-1,r=t.getValueWithDefault(Number,zl.k.listStyleId,-1);C.ULS.sendTraceTag(22923024,324,50,"{ListType:%1, ListStyleId:%2}",n,r)},e.imageCheck=ka.ImageReader.isImageContext,e.anchoredImageCheck=ka.ImageReader.isAnchoredImageContext,e._listEditor=null,e._listReader=null,e._insertionPointFormatting=null,e._externalSelectionManagerFuture=null,e._listSettings=null,e._singleLevelListEditor=null,e.isSwitchStyleByRangeSelect=!1,e}();(0,o.l)(lv,"ListActor",null,[]);var cv=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Box4.ListMarker"},e.prototype.init=function(){lv.registerActions()},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,this._container.register(ev).singleInstance().usingFactory((function(){return new ev})),this._container.register(sv).singleInstance().usingFactory((function(){return new sv})),this._container.register(ov).singleInstance().usingFactory((function(){return new ov}))},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(cv,"Box4ListMarkerPackage",null,[l.u,c.s]);var uv=(0,o.y)("IListMarkerGalleryActor"),gv=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,Box4Intl.Box4Strings.L_DefineNewBulletFont,Box4Intl.Box4Strings.L_DefineNewBulletCharacterCode,"")},e.dialogHtmlFormat="<div class='DefineNewBulletDialogFontTitle UIFontBold' id='FontTitle'> <label id='FontTitleLabel' class='WACDialogLabel' for='FontPlaceholder' >{0}</label> </div> <div class='normal' id='FontControl'> <div id='DefineNewBulletFontPlaceholder'></div> </div> <div class='normal' id='ListMarkerTable'> <div id='DefineNewBulletTableContainer' class='DefineNewBulletTableContainer' style='height: 195px; overflow-x: hidden; overflow-y: scroll;'></div> </div> <div class='WACDialogRow' id='CharacterCode'> <label id='CharacterCodeLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogRow' id='CharacterCodeValue'> <label id='CharacterCodeValueLabel' class='WACDialogLabel' >{2}</label> </div>",e}();(0,o.l)(gv,"DefineNewBulletDialogHtml",null,[]);var pv="DefineNewBulletDialog",dv=function(e){function t(n,r,i,a){var s=e.call(this)||this;if(s._theStandaloneRoot=null,s._disposed$4=!1,s.focusManager=null,s._actionManager=null,s._lastFocusedSymbol=null,s._lastSelectedListMarkerId=null,s._listMarkerClickHandler=null,s._listMarkerKeyHandler=null,s._offsetForIndex=0,s.initialPopulateOfFontDropdown=!0,s.fontName=null,s.asciiFonts=["Symbol","Wingdings","Wingdings 2","Wingdings 3","Webdings"],s._theStandaloneRoot=n,s.focusManager=r,s._actionManager=i,s._disposed$4=!1,a){var l=a.indexOf(",");-1!==l&&(a=a.substring(0,l))}return s.fontName=a,s.set_dialogId(pv),s.set_dialogHtml(gv.get_dialogHtml()),s.setButtonText(1,Box4Intl.Box4Strings.L_SymbolInsertButtonText),s.setButtonText(0,CommonUIStrings.l_DialogClose),s.initializeAndShow(Box4Intl.Box4Strings.L_SymbolSingle,o.i(s,s.defineNewBulletHandler,"defineNewBulletHandler"),null),s._hideOnButtonClick=!1,s.rebindTabNavigationHandlers(),document.getElementById(t.fontStyleComboBoxId).focus(),s}return(0,S.t)(t,e),t.prototype.rebindTabNavigationHandlers=function(){this.focusManager.getCurrentRegion().scope.unBindAction(Nt.FocusManager.instance()._tabInput),this.focusManager.getCurrentRegion().scope.unBindAction(Nt.FocusManager.instance()._tabShiftInput),this.focusManager.getCurrentRegion().scope.bindAction(Nt.FocusManager.instance()._tabInput,ii.JO),this.focusManager.getCurrentRegion().scope.bindAction(Nt.FocusManager.instance()._tabShiftInput,ii.zC)},t.prototype.onInnerHtmlSet=function(){this.buildFontComboBox(t.fontStyleComboBoxId,"DefineNewBulletFontPlaceholder","1850463992","1223894949","715955193",Box4Intl.Box4Strings.L_FontName,"100px"),this.buildDefineNewBulletListMarkerTable()},t.prototype.sizeAndPositionDialog=function(){e.prototype.sizeAndPositionDialog.call(this),document.getElementById(this.myId("WACDialogPanel")).style.width="auto"},t.prototype.buildFontComboBox=function(e,t,n,r,i,o,a){var s=Tu.au(e,n,!0,!0,r,i,Jn.l.xmlEncode(o),!0,a);this.createDomElementFromXml(e,t,s,"Medium")},t.prototype.buildDefineNewBulletListMarkerTable=function(){var e=document.getElementById(t.defineNewBulletTableContainerId);e&&(e.innerHTML=this.getDefineNewBulletListMarkerTableHtml(),this.registerFocusForListMarkersInTable(e))},t.prototype.registerFocusForListMarkersInTable=function(e){var t=e.getElementsByClassName("DefineNewBulletTableCell");if(t)for(var n=0;n<t.length;n++)qo.n.addHandler(t[n],Le.d.focus,o.i(this,this.defineNewBulletListMarkerTableFocusHandler,"defineNewBulletListMarkerTableFocusHandler"))},t.prototype.updateFontOnListMarkerTable=function(){var e=document.getElementById(t.defineNewBulletTableContainerId);if(e){var n=this.fontName,r=ZS.isAsciiFont(this.fontName);if(r&&61472!==this._offsetForIndex||!r&&32!==this._offsetForIndex)e.innerHTML=this.getDefineNewBulletListMarkerTableHtml(),this.registerFocusForListMarkersInTable(e);else{var i=e.getElementsByTagName("table");i&&1===i.length&&n&&(n=this.addQuotesToFontIfNeeded(n),i[0].style.fontFamily=n)}}},t.prototype.defineNewBulletListMarkerTableFocusHandler=function(e){if(this._lastFocusedSymbol&&e.target!==this._lastFocusedSymbol){var t=this.focusManager.getCurrentRegion();t&&t.listing&&(t.listing.trySetCurrentElement(e.target),this._lastFocusedSymbol=e.target)}this.onSelectedListMarkerChanged(e.target.id)},t.prototype.onSelectedListMarkerChanged=function(e){this.setListMarkereElementSelectedState(this._lastSelectedListMarkerId,!1),this._lastSelectedListMarkerId=e,this.setListMarkereElementSelectedState(e,!0);var t=document.getElementById("CharacterCodeValueLabel");if(t&&this._lastSelectedListMarkerId){var n=parseInt(this._lastSelectedListMarkerId.substr(this._lastSelectedListMarkerId.lastIndexOf("_")+1));-1!==n&&(n-=61472===this._offsetForIndex?61440:0,t.innerText=Jn.l.convertToHex(n,4))}},t.prototype.setListMarkereElementSelectedState=function(e,t){var n=this.getListMarkerElement(e);n&&(t?n.setAttribute("selected","true"):n.removeAttribute("selected"))},t.prototype.getListMarkerElement=function(e){var n=document.getElementById(t.defineNewBulletTableContainerId);return n?n.querySelector("#"+e):null},t.prototype.attachDialogEvents=function(){var n=document.getElementById(t.defineNewBulletTableContainerId);n&&(this._listMarkerClickHandler||(this._listMarkerClickHandler=o.i(this,this.listMarkerTableClickHandler,"listMarkerTableClickHandler"),this._clickManager.registerHandler(Le.d.click,n,this._listMarkerClickHandler)),this._listMarkerKeyHandler||(this._listMarkerKeyHandler=o.i(this,this.listMarkerTableKeyHandler,"listMarkerTableKeyHandler"),this._keyInputManager.registerHandler(Le.d.keyDown,n,this._listMarkerKeyHandler),this._keyInputManager.registerHandler(Le.d.keyPress,n,this._listMarkerKeyHandler),this._keyInputManager.registerHandler(Le.d.keyUp,n,this._listMarkerKeyHandler))),e.prototype.attachDialogEvents.call(this)},t.prototype.isValidElementForHandler=function(e){return Sys.UI.DomElement.containsCssClass(e,"DefineNewBulletTableCell")},t.prototype.listMarkerTableClickHandler=function(e){var t=e.get_sourceElement();return!!this.isValidElementForHandler(t)&&(this.focusManager.getCurrentRegion().listing.trySetCurrentElement(t),t.focus(),!0)},t.prototype.listMarkerTableKeyHandler=function(e){var n=e.get_sourceElement();if(!this.isValidElementForHandler(n))return!1;var r=n.id,i=parseInt(r.substr(r.lastIndexOf("_")+1))-this._offsetForIndex;if(e.innerEvent.ctrlKey||e.innerEvent.altKey||e.innerEvent.keyCode>=Je.v.vK_F1&&e.innerEvent.keyCode<=Je.v.vK_F12)return!1;var o=e.innerEvent.keyCode;if(e.eventName===Le.d.keyDown){var a=-1;if(o===Sys.UI.Key.enter)return this.focusManager.getCurrentRegion().listing.trySetCurrentElement(n),n.focus(),this.onInsertNewListMarker(n.id),this.hide(),!0;if(o===Sys.UI.Key.up?a=i-17:o===Sys.UI.Key.down?a=i+17:o===Sys.UI.Key.left?a=L.AFrameworkApplication.get_isRtl()?i+1:i-1:o===Sys.UI.Key.right&&(a=L.AFrameworkApplication.get_isRtl()?i-1:i+1),a>=0){var s=this.getListMarkerElement(t.defineNewBulletTableContainerId+"_"+(a+this._offsetForIndex));s&&s.focus()}}return!0},t.prototype.onInsertNewListMarker=function(e){if(e){var t=e.split("_"),n=new Kl.DictionaryPropertySet;n.setValue(zl.k.listStyleId,parseInt(t[1])),n.setValue(Kc.b.font,this.fontName),n.setValue(zl.k.listSoftType,1),this._actionManager.processActionWithData(ii.Gk,2,n)}this.focusManager.pushScope(this.get_fullDialogFocusId(),!0)},t.prototype.getDefineNewBulletListMarkerTableHtml=function(){var e=new Sys.StringBuilder,t=ZS.isAsciiFont(this.fontName),n=this.fontName;return n=this.addQuotesToFontIfNeeded(n),e.append(String.format('<table class="DefineNewBulletTable" style="font-family: {0};">',n)),t?(this._offsetForIndex=61472,e.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61472" title="0x0020" tabindex="0">\uf020</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61473" title="0x0021" tabindex="0">\uf021</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61474" title="0x0022" tabindex="0">\uf022</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61475" title="0x0023" tabindex="0">\uf023</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61476" title="0x0024" tabindex="0">\uf024</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61477" title="0x0025" tabindex="0">\uf025</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61478" title="0x0026" tabindex="0">\uf026</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61479" title="0x0027" tabindex="0">\uf027</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61480" title="0x0028" tabindex="0">\uf028</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61481" title="0x0029" tabindex="0">\uf029</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61482" title="0x002a" tabindex="0">\uf02a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61483" title="0x002b" tabindex="0">\uf02b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61484" title="0x002c" tabindex="0">\uf02c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61485" title="0x002d" tabindex="0">\uf02d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61486" title="0x002e" tabindex="0">\uf02e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61487" title="0x002f" tabindex="0">\uf02f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61488" title="0x0030" tabindex="0">\uf030</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61489" title="0x0031" tabindex="0">\uf031</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61490" title="0x0032" tabindex="0">\uf032</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61491" title="0x0033" tabindex="0">\uf033</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61492" title="0x0034" tabindex="0">\uf034</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61493" title="0x0035" tabindex="0">\uf035</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61494" title="0x0036" tabindex="0">\uf036</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61495" title="0x0037" tabindex="0">\uf037</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61496" title="0x0038" tabindex="0">\uf038</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61497" title="0x0039" tabindex="0">\uf039</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61498" title="0x003a" tabindex="0">\uf03a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61499" title="0x003b" tabindex="0">\uf03b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61500" title="0x003c" tabindex="0">\uf03c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61501" title="0x003d" tabindex="0">\uf03d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61502" title="0x003e" tabindex="0">\uf03e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61503" title="0x003f" tabindex="0">\uf03f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61504" title="0x0040" tabindex="0">\uf040</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61505" title="0x0041" tabindex="0">\uf041</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61506" title="0x0042" tabindex="0">\uf042</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61507" title="0x0043" tabindex="0">\uf043</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61508" title="0x0044" tabindex="0">\uf044</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61509" title="0x0045" tabindex="0">\uf045</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61510" title="0x0046" tabindex="0">\uf046</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61511" title="0x0047" tabindex="0">\uf047</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61512" title="0x0048" tabindex="0">\uf048</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61513" title="0x0049" tabindex="0">\uf049</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61514" title="0x004a" tabindex="0">\uf04a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61515" title="0x004b" tabindex="0">\uf04b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61516" title="0x004c" tabindex="0">\uf04c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61517" title="0x004d" tabindex="0">\uf04d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61518" title="0x004e" tabindex="0">\uf04e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61519" title="0x004f" tabindex="0">\uf04f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61520" title="0x0050" tabindex="0">\uf050</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61521" title="0x0051" tabindex="0">\uf051</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61522" title="0x0052" tabindex="0">\uf052</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61523" title="0x0053" tabindex="0">\uf053</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61524" title="0x0054" tabindex="0">\uf054</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61525" title="0x0055" tabindex="0">\uf055</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61526" title="0x0056" tabindex="0">\uf056</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61527" title="0x0057" tabindex="0">\uf057</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61528" title="0x0058" tabindex="0">\uf058</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61529" title="0x0059" tabindex="0">\uf059</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61530" title="0x005a" tabindex="0">\uf05a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61531" title="0x005b" tabindex="0">\uf05b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61532" title="0x005c" tabindex="0">\uf05c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61533" title="0x005d" tabindex="0">\uf05d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61534" title="0x005e" tabindex="0">\uf05e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61535" title="0x005f" tabindex="0">\uf05f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61536" title="0x0060" tabindex="0">\uf060</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61537" title="0x0061" tabindex="0">\uf061</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61538" title="0x0062" tabindex="0">\uf062</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61539" title="0x0063" tabindex="0">\uf063</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61540" title="0x0064" tabindex="0">\uf064</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61541" title="0x0065" tabindex="0">\uf065</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61542" title="0x0066" tabindex="0">\uf066</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61543" title="0x0067" tabindex="0">\uf067</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61544" title="0x0068" tabindex="0">\uf068</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61545" title="0x0069" tabindex="0">\uf069</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61546" title="0x006a" tabindex="0">\uf06a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61547" title="0x006b" tabindex="0">\uf06b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61548" title="0x006c" tabindex="0">\uf06c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61549" title="0x006d" tabindex="0">\uf06d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61550" title="0x006e" tabindex="0">\uf06e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61551" title="0x006f" tabindex="0">\uf06f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61552" title="0x0070" tabindex="0">\uf070</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61553" title="0x0071" tabindex="0">\uf071</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61554" title="0x0072" tabindex="0">\uf072</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61555" title="0x0073" tabindex="0">\uf073</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61556" title="0x0074" tabindex="0">\uf074</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61557" title="0x0075" tabindex="0">\uf075</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61558" title="0x0076" tabindex="0">\uf076</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61559" title="0x0077" tabindex="0">\uf077</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61560" title="0x0078" tabindex="0">\uf078</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61561" title="0x0079" tabindex="0">\uf079</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61562" title="0x007a" tabindex="0">\uf07a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61563" title="0x007b" tabindex="0">\uf07b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61564" title="0x007c" tabindex="0">\uf07c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61565" title="0x007d" tabindex="0">\uf07d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61566" title="0x007e" tabindex="0">\uf07e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61567" title="0x007f" tabindex="0">\uf07f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61568" title="0x0080" tabindex="0">\uf080</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61569" title="0x0081" tabindex="0">\uf081</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61570" title="0x0082" tabindex="0">\uf082</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61571" title="0x0083" tabindex="0">\uf083</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61572" title="0x0084" tabindex="0">\uf084</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61573" title="0x0085" tabindex="0">\uf085</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61574" title="0x0086" tabindex="0">\uf086</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61575" title="0x0087" tabindex="0">\uf087</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61576" title="0x0088" tabindex="0">\uf088</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61577" title="0x0089" tabindex="0">\uf089</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61578" title="0x008a" tabindex="0">\uf08a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61579" title="0x008b" tabindex="0">\uf08b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61580" title="0x008c" tabindex="0">\uf08c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61581" title="0x008d" tabindex="0">\uf08d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61582" title="0x008e" tabindex="0">\uf08e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61583" title="0x008f" tabindex="0">\uf08f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61584" title="0x0090" tabindex="0">\uf090</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61585" title="0x0091" tabindex="0">\uf091</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61586" title="0x0092" tabindex="0">\uf092</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61587" title="0x0093" tabindex="0">\uf093</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61588" title="0x0094" tabindex="0">\uf094</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61589" title="0x0095" tabindex="0">\uf095</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61590" title="0x0096" tabindex="0">\uf096</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61591" title="0x0097" tabindex="0">\uf097</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61592" title="0x0098" tabindex="0">\uf098</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61593" title="0x0099" tabindex="0">\uf099</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61594" title="0x009a" tabindex="0">\uf09a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61595" title="0x009b" tabindex="0">\uf09b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61596" title="0x009c" tabindex="0">\uf09c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61597" title="0x009d" tabindex="0">\uf09d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61598" title="0x009e" tabindex="0">\uf09e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61599" title="0x009f" tabindex="0">\uf09f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61600" title="0x00a0" tabindex="0">\uf0a0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61601" title="0x00a1" tabindex="0">\uf0a1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61602" title="0x00a2" tabindex="0">\uf0a2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61603" title="0x00a3" tabindex="0">\uf0a3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61604" title="0x00a4" tabindex="0">\uf0a4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61605" title="0x00a5" tabindex="0">\uf0a5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61606" title="0x00a6" tabindex="0">\uf0a6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61607" title="0x00a7" tabindex="0">\uf0a7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61608" title="0x00a8" tabindex="0">\uf0a8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61609" title="0x00a9" tabindex="0">\uf0a9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61610" title="0x00aa" tabindex="0">\uf0aa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61611" title="0x00ab" tabindex="0">\uf0ab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61612" title="0x00ac" tabindex="0">\uf0ac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61613" title="0x00ad" tabindex="0">\uf0ad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61614" title="0x00ae" tabindex="0">\uf0ae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61615" title="0x00af" tabindex="0">\uf0af</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61616" title="0x00b0" tabindex="0">\uf0b0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61617" title="0x00b1" tabindex="0">\uf0b1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61618" title="0x00b2" tabindex="0">\uf0b2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61619" title="0x00b3" tabindex="0">\uf0b3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61620" title="0x00b4" tabindex="0">\uf0b4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61621" title="0x00b5" tabindex="0">\uf0b5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61622" title="0x00b6" tabindex="0">\uf0b6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61623" title="0x00b7" tabindex="0">\uf0b7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61624" title="0x00b8" tabindex="0">\uf0b8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61625" title="0x00b9" tabindex="0">\uf0b9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61626" title="0x00ba" tabindex="0">\uf0ba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61627" title="0x00bb" tabindex="0">\uf0bb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61628" title="0x00bc" tabindex="0">\uf0bc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61629" title="0x00bd" tabindex="0">\uf0bd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61630" title="0x00be" tabindex="0">\uf0be</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61631" title="0x00bf" tabindex="0">\uf0bf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61632" title="0x00c0" tabindex="0">\uf0c0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61633" title="0x00c1" tabindex="0">\uf0c1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61634" title="0x00c2" tabindex="0">\uf0c2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61635" title="0x00c3" tabindex="0">\uf0c3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61636" title="0x00c4" tabindex="0">\uf0c4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61637" title="0x00c5" tabindex="0">\uf0c5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61638" title="0x00c6" tabindex="0">\uf0c6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61639" title="0x00c7" tabindex="0">\uf0c7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61640" title="0x00c8" tabindex="0">\uf0c8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61641" title="0x00c9" tabindex="0">\uf0c9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61642" title="0x00ca" tabindex="0">\uf0ca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61643" title="0x00cb" tabindex="0">\uf0cb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61644" title="0x00cc" tabindex="0">\uf0cc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61645" title="0x00cd" tabindex="0">\uf0cd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61646" title="0x00ce" tabindex="0">\uf0ce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61647" title="0x00cf" tabindex="0">\uf0cf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61648" title="0x00d0" tabindex="0">\uf0d0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61649" title="0x00d1" tabindex="0">\uf0d1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61650" title="0x00d2" tabindex="0">\uf0d2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61651" title="0x00d3" tabindex="0">\uf0d3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61652" title="0x00d4" tabindex="0">\uf0d4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61653" title="0x00d5" tabindex="0">\uf0d5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61654" title="0x00d6" tabindex="0">\uf0d6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61655" title="0x00d7" tabindex="0">\uf0d7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61656" title="0x00d8" tabindex="0">\uf0d8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61657" title="0x00d9" tabindex="0">\uf0d9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61658" title="0x00da" tabindex="0">\uf0da</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61659" title="0x00db" tabindex="0">\uf0db</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61660" title="0x00dc" tabindex="0">\uf0dc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61661" title="0x00dd" tabindex="0">\uf0dd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61662" title="0x00de" tabindex="0">\uf0de</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61663" title="0x00df" tabindex="0">\uf0df</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61664" title="0x00e0" tabindex="0">\uf0e0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61665" title="0x00e1" tabindex="0">\uf0e1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61666" title="0x00e2" tabindex="0">\uf0e2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61667" title="0x00e3" tabindex="0">\uf0e3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61668" title="0x00e4" tabindex="0">\uf0e4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61669" title="0x00e5" tabindex="0">\uf0e5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61670" title="0x00e6" tabindex="0">\uf0e6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61671" title="0x00e7" tabindex="0">\uf0e7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61672" title="0x00e8" tabindex="0">\uf0e8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61673" title="0x00e9" tabindex="0">\uf0e9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61674" title="0x00ea" tabindex="0">\uf0ea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61675" title="0x00eb" tabindex="0">\uf0eb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61676" title="0x00ec" tabindex="0">\uf0ec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61677" title="0x00ed" tabindex="0">\uf0ed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61678" title="0x00ee" tabindex="0">\uf0ee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61679" title="0x00ef" tabindex="0">\uf0ef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61680" title="0x00f0" tabindex="0">\uf0f0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61681" title="0x00f1" tabindex="0">\uf0f1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61682" title="0x00f2" tabindex="0">\uf0f2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61683" title="0x00f3" tabindex="0">\uf0f3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61684" title="0x00f4" tabindex="0">\uf0f4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61685" title="0x00f5" tabindex="0">\uf0f5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61686" title="0x00f6" tabindex="0">\uf0f6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61687" title="0x00f7" tabindex="0">\uf0f7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61688" title="0x00f8" tabindex="0">\uf0f8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61689" title="0x00f9" tabindex="0">\uf0f9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61690" title="0x00fa" tabindex="0">\uf0fa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61691" title="0x00fb" tabindex="0">\uf0fb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61692" title="0x00fc" tabindex="0">\uf0fc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61693" title="0x00fd" tabindex="0">\uf0fd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61694" title="0x00fe" tabindex="0">\uf0fe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61695" title="0x00ff" tabindex="0">\uf0ff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')):(this._offsetForIndex=32,e.append('<tbody>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_32" title="0x0020" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_33" title="0x0021" tabindex="0">!</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_34" title="0x0022" tabindex="0">"</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_35" title="0x0023" tabindex="0">#</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_36" title="0x0024" tabindex="0">$</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_37" title="0x0025" tabindex="0">%</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_38" title="0x0026" tabindex="0">&amp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_39" title="0x0027" tabindex="0">\'</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_40" title="0x0028" tabindex="0">(</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_41" title="0x0029" tabindex="0">)</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_42" title="0x002a" tabindex="0">*</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_43" title="0x002b" tabindex="0">+</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_44" title="0x002c" tabindex="0">,</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_45" title="0x002d" tabindex="0">-</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_46" title="0x002e" tabindex="0">.</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_47" title="0x002f" tabindex="0">/</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_48" title="0x0030" tabindex="0">0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_49" title="0x0031" tabindex="0">1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_50" title="0x0032" tabindex="0">2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_51" title="0x0033" tabindex="0">3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_52" title="0x0034" tabindex="0">4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_53" title="0x0035" tabindex="0">5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_54" title="0x0036" tabindex="0">6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_55" title="0x0037" tabindex="0">7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_56" title="0x0038" tabindex="0">8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_57" title="0x0039" tabindex="0">9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_58" title="0x003a" tabindex="0">:</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_59" title="0x003b" tabindex="0">;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_60" title="0x003c" tabindex="0">&lt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_61" title="0x003d" tabindex="0">=</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_62" title="0x003e" tabindex="0">&gt;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_63" title="0x003f" tabindex="0">?</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_64" title="0x0040" tabindex="0">@</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_65" title="0x0041" tabindex="0">A</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_66" title="0x0042" tabindex="0">B</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_67" title="0x0043" tabindex="0">C</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_68" title="0x0044" tabindex="0">D</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_69" title="0x0045" tabindex="0">E</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_70" title="0x0046" tabindex="0">F</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_71" title="0x0047" tabindex="0">G</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_72" title="0x0048" tabindex="0">H</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_73" title="0x0049" tabindex="0">I</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_74" title="0x004a" tabindex="0">J</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_75" title="0x004b" tabindex="0">K</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_76" title="0x004c" tabindex="0">L</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_77" title="0x004d" tabindex="0">M</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_78" title="0x004e" tabindex="0">N</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_79" title="0x004f" tabindex="0">O</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_80" title="0x0050" tabindex="0">P</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_81" title="0x0051" tabindex="0">Q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_82" title="0x0052" tabindex="0">R</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_83" title="0x0053" tabindex="0">S</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_84" title="0x0054" tabindex="0">T</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_85" title="0x0055" tabindex="0">U</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_86" title="0x0056" tabindex="0">V</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_87" title="0x0057" tabindex="0">W</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_88" title="0x0058" tabindex="0">X</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_89" title="0x0059" tabindex="0">Y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_90" title="0x005a" tabindex="0">Z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_91" title="0x005b" tabindex="0">[</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_92" title="0x005c" tabindex="0">\\</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_93" title="0x005d" tabindex="0">]</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_94" title="0x005e" tabindex="0">^</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_95" title="0x005f" tabindex="0">_</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_96" title="0x0060" tabindex="0">`</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_97" title="0x0061" tabindex="0">a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_98" title="0x0062" tabindex="0">b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_99" title="0x0063" tabindex="0">c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_100" title="0x0064" tabindex="0">d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_101" title="0x0065" tabindex="0">e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_102" title="0x0066" tabindex="0">f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_103" title="0x0067" tabindex="0">g</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_104" title="0x0068" tabindex="0">h</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_105" title="0x0069" tabindex="0">i</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_106" title="0x006a" tabindex="0">j</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_107" title="0x006b" tabindex="0">k</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_108" title="0x006c" tabindex="0">l</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_109" title="0x006d" tabindex="0">m</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_110" title="0x006e" tabindex="0">n</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_111" title="0x006f" tabindex="0">o</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_112" title="0x0070" tabindex="0">p</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_113" title="0x0071" tabindex="0">q</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_114" title="0x0072" tabindex="0">r</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_115" title="0x0073" tabindex="0">s</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_116" title="0x0074" tabindex="0">t</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_117" title="0x0075" tabindex="0">u</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_118" title="0x0076" tabindex="0">v</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_119" title="0x0077" tabindex="0">w</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_120" title="0x0078" tabindex="0">x</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_121" title="0x0079" tabindex="0">y</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_122" title="0x007a" tabindex="0">z</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_123" title="0x007b" tabindex="0">{</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_124" title="0x007c" tabindex="0">|</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_125" title="0x007d" tabindex="0">}</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_126" title="0x007e" tabindex="0">~</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_127" title="0x007f" tabindex="0">\x7f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_128" title="0x0080" tabindex="0">\x80</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_129" title="0x0081" tabindex="0">\x81</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_130" title="0x0082" tabindex="0">\x82</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_131" title="0x0083" tabindex="0">\x83</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_132" title="0x0084" tabindex="0">\x84</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_133" title="0x0085" tabindex="0"></div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_134" title="0x0086" tabindex="0">\x86</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_135" title="0x0087" tabindex="0">\x87</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_136" title="0x0088" tabindex="0">\x88</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_137" title="0x0089" tabindex="0">\x89</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_138" title="0x008a" tabindex="0">\x8a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_139" title="0x008b" tabindex="0">\x8b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_140" title="0x008c" tabindex="0">\x8c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_141" title="0x008d" tabindex="0">\x8d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_142" title="0x008e" tabindex="0">\x8e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_143" title="0x008f" tabindex="0">\x8f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_144" title="0x0090" tabindex="0">\x90</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_145" title="0x0091" tabindex="0">\x91</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_146" title="0x0092" tabindex="0">\x92</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_147" title="0x0093" tabindex="0">\x93</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_148" title="0x0094" tabindex="0">\x94</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_149" title="0x0095" tabindex="0">\x95</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_150" title="0x0096" tabindex="0">\x96</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_151" title="0x0097" tabindex="0">\x97</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_152" title="0x0098" tabindex="0">\x98</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_153" title="0x0099" tabindex="0">\x99</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_154" title="0x009a" tabindex="0">\x9a</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_155" title="0x009b" tabindex="0">\x9b</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_156" title="0x009c" tabindex="0">\x9c</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_157" title="0x009d" tabindex="0">\x9d</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_158" title="0x009e" tabindex="0">\x9e</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_159" title="0x009f" tabindex="0">\x9f</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_160" title="0x00a0" tabindex="0">&nbsp;</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_161" title="0x00a1" tabindex="0">\xa1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_162" title="0x00a2" tabindex="0">\xa2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_163" title="0x00a3" tabindex="0">\xa3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_164" title="0x00a4" tabindex="0">\xa4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_165" title="0x00a5" tabindex="0">\xa5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_166" title="0x00a6" tabindex="0">\xa6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_167" title="0x00a7" tabindex="0">\xa7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_168" title="0x00a8" tabindex="0">\xa8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_169" title="0x00a9" tabindex="0">\xa9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_170" title="0x00aa" tabindex="0">\xaa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_171" title="0x00ab" tabindex="0">\xab</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_172" title="0x00ac" tabindex="0">\xac</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_173" title="0x00ad" tabindex="0">\xad</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_174" title="0x00ae" tabindex="0">\xae</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_175" title="0x00af" tabindex="0">\xaf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_176" title="0x00b0" tabindex="0">\xb0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_177" title="0x00b1" tabindex="0">\xb1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_178" title="0x00b2" tabindex="0">\xb2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_179" title="0x00b3" tabindex="0">\xb3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_180" title="0x00b4" tabindex="0">\xb4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_181" title="0x00b5" tabindex="0">\xb5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_182" title="0x00b6" tabindex="0">\xb6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_183" title="0x00b7" tabindex="0">\xb7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_184" title="0x00b8" tabindex="0">\xb8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_185" title="0x00b9" tabindex="0">\xb9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_186" title="0x00ba" tabindex="0">\xba</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_187" title="0x00bb" tabindex="0">\xbb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_188" title="0x00bc" tabindex="0">\xbc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_189" title="0x00bd" tabindex="0">\xbd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_190" title="0x00be" tabindex="0">\xbe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_191" title="0x00bf" tabindex="0">\xbf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_192" title="0x00c0" tabindex="0">\xc0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_193" title="0x00c1" tabindex="0">\xc1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_194" title="0x00c2" tabindex="0">\xc2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_195" title="0x00c3" tabindex="0">\xc3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_196" title="0x00c4" tabindex="0">\xc4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_197" title="0x00c5" tabindex="0">\xc5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_198" title="0x00c6" tabindex="0">\xc6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_199" title="0x00c7" tabindex="0">\xc7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_200" title="0x00c8" tabindex="0">\xc8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_201" title="0x00c9" tabindex="0">\xc9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_202" title="0x00ca" tabindex="0">\xca</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_203" title="0x00cb" tabindex="0">\xcb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_204" title="0x00cc" tabindex="0">\xcc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_205" title="0x00cd" tabindex="0">\xcd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_206" title="0x00ce" tabindex="0">\xce</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_207" title="0x00cf" tabindex="0">\xcf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_208" title="0x00d0" tabindex="0">\xd0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_209" title="0x00d1" tabindex="0">\xd1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_210" title="0x00d2" tabindex="0">\xd2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_211" title="0x00d3" tabindex="0">\xd3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_212" title="0x00d4" tabindex="0">\xd4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_213" title="0x00d5" tabindex="0">\xd5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_214" title="0x00d6" tabindex="0">\xd6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_215" title="0x00d7" tabindex="0">\xd7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_216" title="0x00d8" tabindex="0">\xd8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_217" title="0x00d9" tabindex="0">\xd9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_218" title="0x00da" tabindex="0">\xda</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_219" title="0x00db" tabindex="0">\xdb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_220" title="0x00dc" tabindex="0">\xdc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_221" title="0x00dd" tabindex="0">\xdd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_222" title="0x00de" tabindex="0">\xde</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_223" title="0x00df" tabindex="0">\xdf</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_224" title="0x00e0" tabindex="0">\xe0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_225" title="0x00e1" tabindex="0">\xe1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_226" title="0x00e2" tabindex="0">\xe2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_227" title="0x00e3" tabindex="0">\xe3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_228" title="0x00e4" tabindex="0">\xe4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_229" title="0x00e5" tabindex="0">\xe5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_230" title="0x00e6" tabindex="0">\xe6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_231" title="0x00e7" tabindex="0">\xe7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_232" title="0x00e8" tabindex="0">\xe8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_233" title="0x00e9" tabindex="0">\xe9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_234" title="0x00ea" tabindex="0">\xea</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_235" title="0x00eb" tabindex="0">\xeb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_236" title="0x00ec" tabindex="0">\xec</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_237" title="0x00ed" tabindex="0">\xed</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_238" title="0x00ee" tabindex="0">\xee</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_239" title="0x00ef" tabindex="0">\xef</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_240" title="0x00f0" tabindex="0">\xf0</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_241" title="0x00f1" tabindex="0">\xf1</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_242" title="0x00f2" tabindex="0">\xf2</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_243" title="0x00f3" tabindex="0">\xf3</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_244" title="0x00f4" tabindex="0">\xf4</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_245" title="0x00f5" tabindex="0">\xf5</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_246" title="0x00f6" tabindex="0">\xf6</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_247" title="0x00f7" tabindex="0">\xf7</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_248" title="0x00f8" tabindex="0">\xf8</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_249" title="0x00f9" tabindex="0">\xf9</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_250" title="0x00fa" tabindex="0">\xfa</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_251" title="0x00fb" tabindex="0">\xfb</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_252" title="0x00fc" tabindex="0">\xfc</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t\t<tr role = "presentation">\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_253" title="0x00fd" tabindex="0">\xfd</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_254" title="0x00fe" tabindex="0">\xfe</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t\t<td unselectable="on">\r\n\t\t\t\t\t\t<div class="DefineNewBulletTableCell" role="button" id="DefineNewBulletTableContainer_255" title="0x00ff" tabindex="0">\xff</div>\r\n\t\t\t\t\t</td>\r\n\t\t\t\t</tr>\r\n\t\t\t</tbody>')),e.append("</table>"),e.toString()},t.prototype.addQuotesToFontIfNeeded=function(e){return e&&-1!==e.indexOf(" ")&&(e="'"+e+"'"),e},t.prototype.createDomElementFromXml=function(e,t,n,r){var i=document.getElementById(t);this._theStandaloneRoot.addControl(e,n);var o=this._theStandaloneRoot.getDOMElementForControlDisplayMode(e,r);i.appendChild(o),this._theStandaloneRoot.pollForControlState(e)},t.prototype.defineNewBulletHandler=function(e,t){1===e&&this.onInsertNewListMarker(this._lastSelectedListMarkerId),this.hide()},t.prototype.dispose=function(){this._disposed$4||(this._theStandaloneRoot.removeControl(t.fontStyleComboBoxId),this._disposed$4=!0),e.prototype.dispose.call(this)},t.fontStyleComboBoxId="DefineNewBulletFontStyleComboBox",t.defineNewBulletTableContainerId="DefineNewBulletTableContainer",t}(ri.o);(0,o.l)(dv,"DefineNewBulletDialog",ri.o,[]);var hv=(0,o.y)("IListMarkerGalleryCommands"),_v=function(){function e(){}return e.prototype.getListMarkerGalleryOpenCommand=function(){return ii.DI},e.prototype.getPopulateListMarkerGalleryDropDownCommand=function(){return ii.jY},e}();(0,o.l)(_v,"ListMarkerGalleryBulletCommands",null,[hv]);var mv=function(){function e(){}return e.prototype.getListMarkerGalleryOpenCommand=function(){return ii.IW},e.prototype.getPopulateListMarkerGalleryDropDownCommand=function(){return ii.aG},e}();(0,o.l)(mv,"ListMarkerGalleryMultilevelCommands",null,[hv]);var fv=function(){function e(){}return e.prototype.getListMarkerGalleryOpenCommand=function(){return ii.jZ},e.prototype.getPopulateListMarkerGalleryDropDownCommand=function(){return ii.uW},e}();(0,o.l)(fv,"ListMarkerGalleryNumberingCommands",null,[hv]);var yv=function(){function e(e,t,n,r,i){var o;switch(this._actionManager=null,this._listMarkerGalleryUtility=null,this._listMarkerGalleryCommands=null,this._listReader=null,this._standalone=null,this._defineNewBulletDialog=null,this._listMarkerType=0,this.floatieMenuIds=["floatiesbBulletGallery","floatiesbNumberingGallery","floatieflyMultilevelGallery"],this._actionManager=e,this._listReader=r.resolve(ts.c),this._listMarkerType=t,this._standalone=n,this._listMarkerType){case 0:o=r.resolve(ev),this._listMarkerGalleryCommands=new _v;break;case 1:o=r.resolve(sv),this._listMarkerGalleryCommands=new fv;break;case 2:o=r.resolve(ov),this._listMarkerGalleryCommands=new mv;break;default:o=r.resolve(ev),this._listMarkerGalleryCommands=new _v}var a=this._listReader?this._listReader.getListInfos(i):null;o.updateListMarkersInDocumentDictionary(a),this._listMarkerGalleryUtility=new ZS(t,o,a,!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled())}return e.prototype.registerActions=function(){var e=Br.App.theContextSetActor.createDelegatedViewHandlerForNodeType(11);this._actionManager.addAction(this._listMarkerGalleryCommands.getPopulateListMarkerGalleryDropDownCommand(),cl.n,e),this._actionManager.addAction(this._listMarkerGalleryCommands.getPopulateListMarkerGalleryDropDownCommand(),cl.z,o.i(this,this.populateListMarkerGalleryDropDown,"populateListMarkerGalleryDropDown")),this._actionManager.setActionFlags(this._listMarkerGalleryCommands.getPopulateListMarkerGalleryDropDownCommand(),1124),this._listMarkerType||(this._actionManager.addActionWithFlags(ii.ji,cl.n,o.i(this,this.launchDefineNewBulletDialogHandler,"launchDefineNewBulletDialogHandler"),1028),this._actionManager.addActionWithFlags(ii.rh,cl.n,o.i(this,this.populateDefineNewBulletFontDropdown,"populateDefineNewBulletFontDropdown"),1124),this._actionManager.addActionWithFlags(ii.WN,cl.n,o.i(this,this.defineNewBulletFontNameHandler,"defineNewBulletFontNameHandler"),1028),this._actionManager.addActionWithFlags(ii.JO,nt.a,o.i(this,this.defineNewBulletMoveFocusForTabsHandler,"defineNewBulletMoveFocusForTabsHandler"),64),this._actionManager.addActionWithFlags(ii.zC,nt.a,o.i(this,this.defineNewBulletMoveFocusForTabsHandler,"defineNewBulletMoveFocusForTabsHandler"),64)),this._actionManager.addAction(this._listMarkerGalleryCommands.getListMarkerGalleryOpenCommand(),cl.n,o.i(this,this.listMarkerGalleryMenuOpen,"listMarkerGalleryMenuOpen")),this._actionManager.addAction(this._listMarkerGalleryCommands.getListMarkerGalleryOpenCommand(),cl.z,o.i(this,this.listMarkerGalleryMenuOpen,"listMarkerGalleryMenuOpen")),this._actionManager.setActionFlags(this._listMarkerGalleryCommands.getListMarkerGalleryOpenCommand(),1124)},e.prototype.defineNewBulletMoveFocusForTabsHandler=function(e,t,n,r,i){if(!this._defineNewBulletDialog)return 2;if(this._defineNewBulletDialog.focusManager.getCurrentRegion().listing.get_currentElement().id.startsWith(dv.defineNewBulletTableContainerId)){var o=null;if(e===ii.JO?o=this._defineNewBulletDialog.get_btnAction():e===ii.zC&&(o=document.getElementById(dv.fontStyleComboBoxId)),!o)return 2;this._defineNewBulletDialog.focusManager.getCurrentRegion().listing.trySetCurrentElement(o),o.focus()}else if(e===ii.JO)this._defineNewBulletDialog.focusManager.getCurrentRegion().moveForward();else{if(e!==ii.zC)return 2;this._defineNewBulletDialog.focusManager.getCurrentRegion().moveBackward()}return 32},e.prototype.listMarkerGalleryMenuOpen=function(e,t,n,r,i){var o=t,a=null;return o.view.get_isInteractiveView()&&(a=o.view),a&&a.get_selectionManager()?32:(Vl.k(17887427,315,50,"DefaultActionHandler would have crashed. The context passed in was {0} which does not contain a selection manager",t.toString()),8)},e.prototype.launchDefineNewBulletDialogHandler=function(e,t,n,r,i){if(1===n)return 32;if(2===n){var o=this.getSelectedGraphNodeContextFromViewContext(t),a=Ps.FormattingReader.getFormattingObject(o).get_cache().get_fontFace();return this._defineNewBulletDialog=new dv(this._standalone,Nt.FocusManager.instance(),L.AFrameworkApplication.get_theActionManager(),a),32}return 8},e.prototype.getSelectedGraphNodeContextFromViewContext=function(e){return this.getCollapsedSelectionFromContext(e).get_firstContext()},e.prototype.getCollapsedSelectionFromContext=function(e){var t=null,n=e.view;return n&&(t=Pa.SelectionEditor.collapseToIp(n.get_selectionManager().get_selectionCollection().get_item(0),!1,!1))||t},e.prototype.populateDefineNewBulletFontDropdown=function(e,t,n,r,i){if(1===n)return 32;if(2===n&&!i)return 8;if(this._defineNewBulletDialog.initialPopulateOfFontDropdown){for(var o=function(e){var t;Xu.v.trySupportDocumentFont(ZS.asciiFonts[e],(0,p.m)((function(){return t}),(function(e){return t=e})))},a=0;a<ZS.asciiFonts.length;a++)o(a);this._defineNewBulletDialog.initialPopulateOfFontDropdown=!1}return Hu.Font.initializeFontDropDown(t),i.PopulationXML=Xu.v.generateFontDropdownXml(Hu.Font.shouldShowThemeFont,Hu.Font.formatThemeFontDisplayNameDelegate,ii.WN,!1),32},e.prototype.populateListMarkerGalleryDropDown=function(e,t,n,r,i){var o=t.get_contextId()===cl.z;if(1===n||!o)return o?32:8;if(2===n&&!i)return 8;t.get_node();var a=i;if(L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled())a.MenuItems=this._listMarkerGalleryUtility.getListMarkerGalleryDropDownProps(!0),a.MenuId&&Array.contains(this.floatieMenuIds,a.MenuId)&&(a.PopulationXML=this._listMarkerGalleryUtility.getListMarkerGalleryDropDownXml());else{var s=this._listMarkerGalleryUtility.getListMarkerGalleryDropDownXml();a.PopulationXML=s}return 32},e.prototype.defineNewBulletFontNameHandler=function(e,t,n,r,i){if(1===n)return 32;if(2===n){var o=(0,f.e)(bC.p,i);if(!o||!o.get_actionData())return 8;var a=o.get_actionData();return this._defineNewBulletDialog.fontName=a.fontName,this._defineNewBulletDialog.updateFontOnListMarkerTable(),32}return 8},e}();(0,o.l)(yv,"ListMarkerGalleryActor",null,[uv]);var Cv=function(){function e(){this._container=null,this._node=null}return e.prototype.get_name=function(){return"Box4.ListMarkerGallery"},e.prototype.init=function(){if(Ur.InteractiveViewManager.get_instance()){var e=Ur.InteractiveViewManager.get_instance();e.get_editingView()&&(this._node=e.get_editingView().get_targetNode(),this.registerListMarkerGalleryActors())}},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e},e.prototype.registerListMarkerGalleryActors=function(){new yv(L.AFrameworkApplication.get_theActionManager(),1,this._container.resolve(ou.r).get_sharedStandaloneRoot(),this._container,this._node).registerActions(),new yv(L.AFrameworkApplication.get_theActionManager(),0,this._container.resolve(ou.r).get_sharedStandaloneRoot(),this._container,this._node).registerActions(),new yv(L.AFrameworkApplication.get_theActionManager(),2,this._container.resolve(ou.r).get_sharedStandaloneRoot(),this._container,this._node).registerActions()},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Cv,"Box4ListMarkerGalleryPackage",null,[l.u,c.s]);var Sv=(0,o.y)("IBusinessBarRankProvider"),vv=n(6295),bv=n(4706),Tv=n(2238),Av=function(){function e(){}return e.prototype.get_ranking=function(){return[24,23,7,6,19,1,5,9,22,2,4,3,10,8,14,13,11,12,15,16,17,18,20,21,25,26,27,28,29,30]},e}();(0,o.l)(Av,"BusinessBarRankProvider",null,[Sv]);var Iv,wv=(0,o.y)("IReactBusinessBar"),xv=(0,o.y)("IBusinessBarDom"),Fv=n(4513),Ev=n(5587),Pv=n(4195),kv=n(3210),Dv=function(e){e.get_element().style.top=""},Mv=n(5521),Rv="WACBusinessBar",Lv=function(){function e(e,t,n){this._businessBar=null,this._visible=!1,this._element=null,this._target=null,this._targetOffset=0,this._currentHeight=0,this._originalTargetTop=null,this._contextMenuHandler=null,this._isRegionComposerEnabled=!1,this._target=e,this._targetOffset=t,this._businessBar=n;var r=e.ownerDocument;this._element=r.createElement("div"),this._element.className=Rv,this._isRegionComposerEnabled=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRegionComposerEnabled(),this._isRegionComposerEnabled&&!this._businessBar.get_displayOverTarget()&&Sys.UI.DomElement.addCssClass(this._element,"regionComposer"),this._element.id=Rv,G.y.get_isFirefox()&&Sys.UI.DomElement.addCssClass(this._element,"FireFox")}return e.prototype.get_htmlElement=function(){return this._element},e.prototype.get_visible=function(){return this._visible},e.prototype.set_visible=function(e){return this._visible===e?e:(this._visible=e,e?this.attachToTarget():this.detachFromTarget(),e)},e.prototype.dispose=function(){this.get_visible()&&this.detachFromTarget(),_i.s.clearElementHtml(this._element),this._element=null,this._target=null},e.prototype.showEntry=function(e,t){var n=e.get_htmlElement()||e.createElement();t===this._element.childNodes.length?this._element.appendChild(n):this._element.insertBefore(n,this._element.childNodes[t]),e.resizeToFit(),this._currentHeight+=e.get_htmlElement().clientHeight,function(e,t,n,r){kv.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var i=new Pv.g(e);i.animateOpacity(0,1),kv.WacAirSpace.animate(i,null,null);var o=new Ev.r(e);o.animateY(e.clientTop-30,e.clientTop),kv.WacAirSpace.animate(o,null,r);for(var a=n+1;a<t.length;a++){var s=t[a];kv.WacAirSpace.setAnimationClass(s,"Shared_BasicClass");var l=new Ev.r(s);l.animateY(s.clientTop-e.clientHeight,s.clientTop),kv.WacAirSpace.animate(l,null,null)}}(n,this._element.childNodes,t,o.i(this,this.onAfterShowEntry,"onAfterShowEntry")),e.showEntryForScreenReader(),this.set_visible(!0)},e.prototype.hideEntry=function(e){var t=e.get_htmlElement();_i.s.isInDocument(t)&&(this._currentHeight-=e.get_htmlElement().clientHeight,function(e,t,n,r){kv.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var i=new Fv.y(e);i.animateOpacity(1,0),kv.WacAirSpace.animate(i,n,r);for(var o=!1,a=0;a<t.length;a++){if(o){var s=t[a];kv.WacAirSpace.setAnimationClass(s,"Shared_BasicClass");var l=new Ev.r(s);l.animateY(s.clientTop,-e.clientHeight),kv.WacAirSpace.animate(l,null,Dv)}o||t[a]!==e||(o=!0)}}(t,t.parentNode.children,null,o.i(this,this.onAfterHideEntry,"onAfterHideEntry")))},e.prototype.onAfterShowEntry=function(e){e.get_element().style.top="",L.AFrameworkApplication.get_activeFrame().notifyResize()},e.prototype.onAfterHideEntry=function(e){e.get_element().parentNode.removeChild(e.get_element()),this._element.hasChildNodes()||this.set_visible(!1),L.AFrameworkApplication.get_activeFrame().notifyResize()},e.prototype.attachToTarget=function(){var e=this;""===this._target.style.top.trim()&&(this._target.style.top=this._target.offsetTop+"px"),this._element.style.left=this._target.style.left,this._element.style.top=this._target.style.top,this._element.style.height="auto",this._element.style.visibility="visible";var t=Sys.UI.DomElement.getBounds(this._element);if(this._originalTargetTop=this._target.style.top,this._currentHeight=t.height,this.updateTarget(),L.AFrameworkApplication.get_activeFrame().add_onResize(o.i(this,this.onResize,"onResize")),qo.n.addHandler(this._element,Le.d.selectStart,qo.n.cancelEventHandler),this._contextMenuHandler=o.i(this,this.contextMenuHandler,"contextMenuHandler"),L.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().registerHandler(this._element,this._contextMenuHandler,null),Nt.FocusManager.usable()){var n=Nt.FocusManager.instance(),r=n.getScope(Mv.t.businessBarFocusID);r.parent=$e.AFrame.mainAppFocusId;var i=new Qe.DOMFocusListing((function(){return e._element}));i.addValidTag(1),i.addValidTag(2),i.addValidTag(8),n.buildRegionWithDelegate((function(){return e._element}),r,i);var a=n.getRegion(Mv.t.businessBarFocusID);a.rememberFocusStealers(),a.looped=!0,a.contained=!0;var s=L.AFrameworkApplication.get_activeFrame().get_theF6Manager();r.addDispose((function(){s.deactivateFocus(Mv.t.businessBarFocusID)})),s.addF6KeyBindings(Mv.t.businessBarFocusID),i.get_firstElement()&&s.activateFocus(Mv.t.businessBarFocusID)}},e.prototype.detachFromTarget=function(){if(this.shouldUpdateTargetTop()&&(this._target.style.top=this._originalTargetTop),this._element.style.visibility="hidden",L.AFrameworkApplication.get_activeFrame()){if(Nt.FocusManager.usable())Nt.FocusManager.instance().removeScope(Mv.t.businessBarFocusID);this._contextMenuHandler&&(L.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().unregisterHandler(this._element,this._contextMenuHandler),this._contextMenuHandler=null)}qo.n.removeHandler(this._element,Le.d.selectStart,qo.n.cancelEventHandler)},e.prototype.updateTarget=function(){this.shouldUpdateTargetTop()&&this.get_visible()&&function(e,t,n,r){var i=_i.s.parseCssSize(e.style.top);kv.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var o=new Ev.r(e);o.animateY(i,t),kv.WacAirSpace.animate(o,n,r)}(this._target,this._currentHeight+this._targetOffset,null,null)},e.prototype.shouldUpdateTargetTop=function(){return!this._isRegionComposerEnabled&&!this._businessBar.get_displayOverTarget()},e.prototype.onResize=function(){for(var e,t=this._businessBar.get_entries().length,n=Sys.UI.DomElement.getBounds(this._element).height,r=0;r<t;++r)(e=this._businessBar.get_entries()[r]).get_htmlElement()&&e.resizeToFit();this._currentHeight=Sys.UI.DomElement.getBounds(this._element).height,n!==this._currentHeight&&this.updateTarget()},e.prototype.contextMenuHandler=function(e){return!0},e}();(0,o.l)(Lv,"BusinessBarDom",null,[xv,Sys.IDisposable]),function(e){e[e.none=0]="none",e[e.corruptPage=1]="corruptPage",e[e.currentPageStatus=2]="currentPageStatus",e[e.documentMarkedAsFinal=3]="documentMarkedAsFinal",e[e.documentSigned=4]="documentSigned",e[e.fileAccess=5]="fileAccess",e[e.kickoutWithDataLoss=6]="kickoutWithDataLoss",e[e.lostSession=7]="lostSession",e[e.malformedHyperlinkUris=8]="malformedHyperlinkUris",e[e.odt=9]="odt",e[e.readonlyRecommended=10]="readonlyRecommended",e[e.saveReplaySuccess=11]="saveReplaySuccess",e[e.saveReplayFailed=12]="saveReplayFailed",e[e.unsupportedObjects=13]="unsupportedObjects",e[e.word11Compat=14]="word11Compat",e[e.unsupportedBrowser=15]="unsupportedBrowser",e[e.applicationNotification=16]="applicationNotification",e[e.skypeDocChatFailed=17]="skypeDocChatFailed",e[e.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo",e[e.sessionExpired=19]="sessionExpired",e[e.irmPolicyDescription=20]="irmPolicyDescription",e[e.policyWarningMessage=21]="policyWarningMessage",e[e.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled",e[e.gdprPrivacyNotice=23]="gdprPrivacyNotice",e[e.datacenterDecommissionWarning=24]="datacenterDecommissionWarning",e[e.graphMergePrompt=25]="graphMergePrompt",e[e.readOnlyDocument=26]="readOnlyDocument",e[e.dictationSilence=27]="dictationSilence",e[e.autoSensitivityLabel=28]="autoSensitivityLabel",e[e.recommendedSensitivityLabel=29]="recommendedSensitivityLabel",e[e.dictationDebugInfo=30]="dictationDebugInfo",e[e.testEntry1=31]="testEntry1",e[e.testEntry2=32]="testEntry2",e[e.testEntry3=33]="testEntry3",e[e.testEntry4=34]="testEntry4",e[e.testEntry5=35]="testEntry5",e[e.testEntry6=36]="testEntry6",e[e.testEntry7=37]="testEntry7"}(Iv||(Iv={})),(0,o.h)("BusinessBarId",Iv);var Nv=function(){function e(e,t,n,r){void 0===t&&(t=0),void 0===n&&(n=null),void 0===r&&(r=null),this._displayOverTarget=!1,this._isReactBusinessBarStoreInitialized=!1,this._priorityMap=null,this._businessBarDom=null,this._entries=[],this._businessBarDom=r||new Lv(e,t,this),this.initializePriorityMap(n)}return e.prototype.initializePriorityMap=function(e){if(e){this._priorityMap={};for(var t=e.get_ranking(),n=0;n<t.length;n++)this._priorityMap[Iv[t[n]]]=n}},e.prototype.dispose=function(){this._businessBarDom.dispose(),Pr.q(this._entries),this._entries=null},e.prototype.get_htmlElement=function(){return this._businessBarDom.get_htmlElement()},e.prototype.get_visible=function(){return this._businessBarDom.get_visible()},e.prototype.get_displayOverTarget=function(){return this._displayOverTarget},e.prototype.set_displayOverTarget=function(e){return this._displayOverTarget=e,e},e.prototype.get_isReactBusinessBarStoreInitialized=function(){return this._isReactBusinessBarStoreInitialized},e.prototype.set_isReactBusinessBarStoreInitialized=function(e){return this._isReactBusinessBarStoreInitialized=e,e},e.prototype.get_entries=function(){return this._entries},e.prototype.set_entries=function(e){return this._entries=e,e},e.prototype.isEntryExistent=function(e){for(var t=0;t<this._entries.length;t++)if(this._entries[t].get_id()===e)return!0;return!1},e.prototype.addEntry=function(t,n,r){void 0===n&&(n=!1),void 0===r&&(r=null),t.set_businessBar(this);var i=this.getIndexForNewEntry(t.get_id());n&&!this._priorityMap&&(i=0),i<e.maxBarsVisible&&(this._businessBarDom.showEntry(t,i),this._entries.length>=e.maxBarsVisible&&this._businessBarDom.hideEntry(this._entries[e.maxBarsVisible-1]),this._businessBarDom.updateTarget()),Array.insert(this._entries,i,t),C.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",Iv[t.get_id()],void 0===t.get_containerID()||null===t.get_containerID()?"":t.get_containerID()),t.get_errorCode()&&L.AFrameworkApplication.reportError(t.get_errorCode(),r)},e.prototype.removeEntry=function(t){var n=Array.indexOf(this._entries,t);-1!==n&&n<e.maxBarsVisible&&(this._entries.length>e.maxBarsVisible&&this._businessBarDom.showEntry(this._entries[e.maxBarsVisible],e.maxBarsVisible),this._businessBarDom.hideEntry(t),this._businessBarDom.updateTarget()),Array.remove(this._entries,t),t.set_businessBar(null),t.dispose()},e.prototype.getIndexForNewEntry=function(e){if(!this._priorityMap)return this._entries.length;if(!e)return this._entries.length;var t=this._priorityMap[Iv[e]];if(null==t)return this._entries.length;for(var n=0;n<this._entries.length;n++)if(t<this._priorityMap[Iv[this._entries[n].get_id()]])return n;return this._entries.length},e.maxBarsVisible=2,e}();(0,o.l)(Nv,"BusinessBar",null,[Fr.c,Sys.IDisposable,wv]);var Bv=n(2599),Ov=function(){function e(){}return e.prototype.create=function(e,t,n){return new Bv.l(e,t,n)},e}();(0,o.l)(Ov,"Factory$8",null,[Er]);var Uv=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Wonca.UI"},e.prototype.configure=function(e){this._container=e,e.register(Sv).singleInstance().usingFactory((function(){return new Av})),function(e,t,n){void 0===n&&(n=0),e.register(Nv).as(Fr.c).singleInstance().usingFactory((function(){return new Nv(t.get_value(),n,e.tryResolve(Sv))})),e.register(Ov).as(Er).singleInstance()}(e,new yt.q(Object,(function(){return Br.App.get_activeAppFrame().get_documentPanelContent()}))),e.register(Du).singleInstance().usingFactory((function(){return new Du(e.resolve(_u),e.resolve(ph.c),e.resolve(vv.o),L.AFrameworkApplication.get_imageClusterName(),L.AFrameworkApplication.get_imageClusterPath(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordEditorProofingIgnoreAll"),e.resolve(bv.d))}))},e.prototype.init=function(){this._container.resolve(Tv.x),this._container.resolve(Fr.c)},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Uv,"WoncaUIPackage",null,[l.u,c.s]);var Hv=n(1706),Gv=function(){function e(){}return e.editInBrowser="UI_EditInBrowser",e.newPage="NewPage",e.navigationResult="WacPageNavigationResult",e}();(0,o.l)(Gv,"MessageId",null,[]);var Vv=function(){function e(){}return e.pageId="PageId",e.pageTarget="PageTarget",e.sectionName="SectionName",e.succeeded="Succeeded",e.url="Url",e}();(0,o.l)(Vv,"MessageKey",null,[]);var Wv=function(){function e(e,t){this.hostingAppUrl=null,this._hostPostMessenger=null,this.hostingAppUrl=e,this._hostPostMessenger=t}return e.prototype.sendNavigationResult=function(e,t,n){if(!this._hostPostMessenger)return!1;var r=new dl.f;r.MessageId=Gv.navigationResult;var i={};return i[Vv.sectionName]=e,i[Vv.pageId]=t,i[Vv.succeeded]=n,r.Values=i,this._hostPostMessenger.send(r,this.hostingAppUrl)},e.prototype.sendMessageToHostApp=function(e,t){if(!this._hostPostMessenger)return!1;var n=new dl.f;return n.MessageId=e,n.Values=t,this._hostPostMessenger.send(n,this.hostingAppUrl)},e.prototype.sendNewPageMesssageToHostApp=function(e,t){var n=String.format("https://{0}.one&page-id={1}&end",encodeURIComponent(e),t),r=(new dl.f,{});return r[Vv.url]=n,this.sendMessageToHostApp(Gv.newPage,r)},e.prototype.sendEditInBrowser=function(e){var t={};return t[Vv.pageTarget]=e,this.sendMessageToHostApp(Gv.editInBrowser,t)},e}();(0,o.l)(Wv,"OneNoteEmbeddingMessageSender",null,[]);var zv=function(){function e(){}return e.messageKey="Message",e.commandName="CommandName",e.actionId="ActionId",e.handlerLoadedMessageId="HandlerLoaded",e.handlerLoadedMessage="Handler is ready for commands",e.actionResponse="CommandingInterfaceResponse",e.actionResponseInvalidId="CommandId is not valid",e.actionFailed="Failed",e.actionResult="Result",e.cause="Cause",e.titleChanged="TitleChanged",e.title="Title",e}();(0,o.l)(zv,"MessageValues",null,[]);var Kv=function(){function e(e,t,n,r){this._hostPostmessengerFuture=null,this._hostPostmessenger=null,this._cuiuser=null,this._hostingApp=null,this._graphInstance=null,this._pageReader=null,this._messageSender=null,this._hostPostmessengerFuture=e,this._hostingApp=t,this._graphInstance=n.get_theGraph(),this._pageReader=r}return e.prototype.registerActions=function(e){Wr.App.get_isEmbedMessageEnabled()&&(this._hostPostmessengerFuture.execute(o.i(this,this.onHostPostmessengerCreated,"onHostPostmessengerCreated")),this._cuiuser=e,this._graphInstance&&(C.ULS.sendTraceTag(17646672,339,50,"GraphInstance Avaliable"),this._graphInstance.getSpecificEventHandlers(1).add_onPropertyChanged(o.i(this,this.onTitlePropertyChanged,"onTitlePropertyChanged"))),this._messageSender=new Wv(this._hostingApp,this._hostPostmessenger))},e.prototype.onTitlePropertyChanged=function(e,t){if(t.get_property().id===Kc.b.pageTitle.id){var n=t.get_node(),r=this._pageReader.getPageTitle(n),i={};i[zv.title]=r,this._messageSender.sendMessageToHostApp(zv.titleChanged,i)}},e.prototype.onHostPostmessengerCreated=function(t){this._hostPostmessenger=t,this._hostPostmessenger.addAllowedReceivingMessage(Me.a.commanding),this._hostPostmessenger.addAllowedOrigin(e.onenoteOrigin),this._hostPostmessenger.addAllowedOrigin(e.onenoteEdogOrigin),this._hostPostmessenger.registerCallback(Me.a.commanding,o.i(this,this.commandingHandler,"commandingHandler"));var n={};n[zv.messageKey]=zv.handlerLoadedMessage,this._messageSender.sendMessageToHostApp(zv.handlerLoadedMessageId,n)},e.prototype.commandingHandler=function(e){C.ULS.sendTraceTag(17646674,339,50,"Commanding Handler Received Message");var t=e.Values.ActionId?e.Values.ActionId:"",n=parseInt(t);if(""!==t&&isFinite(n)){var r=function(e){switch(e){case 0:return"3136828847";case 1:return"2639435831";case 2:return"3383614517";case 3:return"237279923";case 4:return"2309168610";case 5:return"4143129361";case 6:return"3569444222";case 7:return"1863297734";case 8:return"1107614";case 9:return"1455408143";case 10:return"4169095173";case 11:return"3430668515";case 12:return"3217001754";case 13:return"2652969281";case 14:return"1000936187";case 15:return"1473951236";case 16:return"2670646631";case 17:return"576018453";case 18:return"2583004990";case 19:return"2733690884";case 20:return"4284004393";case 21:return"2539120357";case 22:return"393413924";case 23:return"4073520836";case 24:return"3376107472";case 25:return"1526710486";case 26:return"4279018031";case 33:return"3414872289";case 27:return"4211422424";case 28:return"501553948";case 29:return"2456990301";case 30:return"1951024620";case 31:return"2339730315";case 32:return"737662428";default:C.ULS.sendTraceTag(17646671,339,15,"Unhandled command in Commanding interface {0}",e)}return null}(n);if(r){var i=e.Values,o=this._cuiuser.executeRootCommand(r,i,null);C.ULS.sendTraceTag(17646675,339,50,"Commanding Interface Processed Command "+r+" with result "+o);var a={};a[zv.commandName]=t,a[zv.actionResult]=o,this._messageSender.sendMessageToHostApp(zv.actionResponse,a)}else this.sendExecutionFailedMessage(t)}else this.sendExecutionFailedMessage(t)},e.prototype.sendExecutionFailedMessage=function(e){var t={};t[zv.commandName]=e,t[zv.actionResult]=zv.actionFailed,t[zv.cause]=zv.actionResponseInvalidId,this._messageSender.sendMessageToHostApp(zv.actionResponse,t)},e.onenoteOrigin="https://www.onenote.com",e.onenoteEdogOrigin="https://edog.onenote.com",e}();(0,o.l)(Kv,"CommandingMessageHandler",null,[]);var qv,jv=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.CommandingEditors"},e.prototype.configure=function(e){this._container=e,e.register(Kv).singleInstance().usingFactory((function(){return new Kv(e.resolveFuture(Fe.i),L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteEmbedHostingApp,e.resolve(Hv.m),Qc.PageReader.get_instance())}))},e.prototype.getContainingGraph=function(){return Br.App.get_activeAppFrame().workspace&&Br.App.get_activeAppFrame().workspace.get_contentView()&&Br.App.get_activeAppFrame().workspace.get_contentView().get_targetNode()?Br.App.get_activeAppFrame().workspace.get_contentView().get_targetNode().get_containingGraph():null},e.prototype.init=function(){if(Wr.App.get_isEmbedMessageEnabled()){var e=this._container.resolve(lu.h);this._container.resolve(Kv).registerActions(e)}},e.prototype.dispose=function(){},e.main=function(){Wr.App.get_isEmbedMessageEnabled()&&N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(jv,"OneNoteCommandingEditorsPackage",null,[l.u,c.s]),"undefined"==typeof qv&&(qv={}),window.MSOJS=qv,qv.ClientUtils=function(){function e(){return Boolean(Q)||(Q=!0,J=r("Windows NT")),J>=6.1&&!(window.navigator.userAgent.indexOf("ARM;")>=0)&&(l()||d()||g())}function t(){return window.navigator.userAgent.indexOf("Windows")>=0}function n(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function r(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),n=-1;return null!=t&&t.length>=2&&(n=parseFloat(t[1]),isNaN(n)&&(n=-1)),n}function i(){return Boolean(X)||(X=!0,Y=r("Windows Phone")),Y>=8}function o(){return"function"==typeof navigator.msLaunchUri&&!n()&&!p()&&!s()}function a(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function s(){return window.navigator.userAgent.indexOf("Edge/")>=0}function l(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function c(){return!!l()&&8==window.document.documentMode}function u(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function g(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")>=0}function p(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("android")>=0&&e.indexOf("chrome")>=0}function d(){return(u()?_("firefox/"):0)>=3}function h(){return(window.navigator.userAgent.indexOf(" AppleWebKit/")>=0?_("version/"):0)>=3}function _(e){var t,n,r=window.navigator.userAgent.toLowerCase(),i=r.indexOf(e);return i>=0?(t=i+e.length,n=r.length,parseInt(r.substring(t,n))):0}function m(e,t,n,r){r&&null!=t?t():o()?navigator.msLaunchUri(e,t,n):!g()&&!(window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0)||s()?y(e,t,n):f(e,t,n)}function f(e,t,n){var r="OICLinkTag",i=document.getElementById(r);null==i&&((i=document.createElement("a")).id=r,i.style.visibility="hidden",i.href="",i.target=S($)?"_top":"_blank",document.body.appendChild(i),null!=i.addEventListener&&i.addEventListener("click",(function(e){null!=e.stopPropagation&&e.stopPropagation()}),!1));try{i.href=e,i.click()}catch(e){return void(null!=n&&n())}null!=t&&t()}function y(e,t,n){var r="OICFrame",i=document.getElementById(r);null==i&&((i=document.createElement("iframe")).className="ObjectInDialog",i.style.visibility="hidden",i.src="about:blank",document.body.appendChild(i),i.id=r);try{i.contentWindow.location.href=e}catch(e){return void(null!=n&&n())}null!=t&&t()}function C(e){return 0!=(e.Options&Ae.SkipProtocolHandler)||c()}function S(e){return 0!=(e.Options&Ae.SupportsTopTargetNavigation)}function v(e){return a()&&(e.Application==xe.OneNote||M(oe,!1)||M(ae,!1))}function b(e){return!C(e)&&(!!v(e)||(!!o()||(!!p()||(!(T()||"ActiveXObject"in window&&!n()||g())||V()>=15))))}function T(){return a()&&(d()||h())||d()}function A(e){return e===Te.ReadOnly||e===Te.ReadWrite}function I(e,t,r,o,a){var s,l,c,u;if(e==xe.Visio&&r==Te.ReadWrite&&(r=Te.WriteOnly),s=a,(o=o||n()&&!i())||(l="",l+=A(r)?ge+pe:de,s+=x(l+=he)),s+=x(t),null!=(c=function(e,t){var n,r,i=e.toLowerCase().indexOf("&"+t+"=");return-1==i?void 0:(n=i+(t.length+2),-1==(r=e.indexOf("&",n))?e.substr(n):e.substring(n,r))}(window.location.href,me))&&"undefined"!=typeof c){u="";try{u=decodeURIComponent(c)}catch(e){}u.length>0&&function(e){return RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(e)}(u)&&(s+=_e,s+=u)}return s}function w(e,t,n,r,i){var o=B(e);return null==o?(G(Ie.Unattempted,$.Application),!1):(m(I(e,t,n,r,o),F,E,i),!0)}function x(e){if(a()&&g()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function F(){H(we.ProtocolHandler)}function E(){$.Options|=Ae.SkipProtocolHandler,U($,z,K)}function P(){null!=q&&q(we.RoamingProtocolHandler)}function k(){null!=j&&j(Ie.ControlNeeded)}function D(){var e,t,n=document.getElementById(le);if(null==n){if(e=re,a()&&h()&&R(ie)&&(e=ie),!R(e)){if(!a()||!R(se))return null;e=se}(t=document.createElement("object")).id=le,t.type=e,t.style.width="0px",t.style.height="0px",t.style.setProperty("visibility","hidden",""),document.body.appendChild(t),n=document.getElementById(le)}return n}function M(e,t){var n,r=window.navigator.mimeTypes;return null!=r&&(!!(n=r[e])&&!(t&&!n.enabledPlugin))}function R(e){return M(e,!0)}function L(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function N(e){switch(e){case xe.OneNote:return ue;default:return""}}function B(e){if(e!=xe.OneNote&&n()&&!i())return"office:";switch(e){case xe.Excel:return"ms-excel:";case xe.OneNote:return"onenote:";case xe.PowerPoint:return"ms-powerpoint:";case xe.Visio:return"ms-visio:";case xe.Word:return"ms-word:";case xe.Project:return"ms-project:";case xe.Publisher:return"ms-publisher:";case xe.Infopath:return"ms-infopath:";case xe.Access:return"ms-access:";default:return""}}function O(e){switch(e){case xe.Excel:return"root\\office15\\excel.exe";case xe.PowerPoint:return"root\\office15\\powerpnt.exe";case xe.Visio:return"root\\office15\\visio.exe";case xe.Word:return"root\\office15\\winword.exe";case xe.Project:return"root\\office15\\winproj.exe";case xe.Publisher:return"root\\office15\\mspub.exe";case xe.Infopath:return"root\\office15\\infopath.exe";case xe.Access:return"root\\office15\\msaccess.exe";default:return null}}function U(t,n,r){var i;if($=t,z=n,K=r,t.DocumentUrl){var o=t.DocumentUrl,s=t.DocumentUrl,u=t.DocumentUrl;try{u=decodeURIComponent(t.DocumentUrl)}catch(e){}try{s=encodeURI(t.DocumentUrl)}catch(e){}if(t.Mode===Te.ReadWrite&&Ae.CheckoutRequired===(t.Options&Ae.CheckoutRequired)&&(t.Mode=Te.ForceCheckout),Ae.HostIsEditOnly===(t.Options&Ae.HostIsEditOnly)&&(t.Mode=Te.WriteOnly),b(t))w(t.Application,t.EncodeUrl?s:o,t.Mode,t.Application==xe.OneNote,t.SilentExternalHandler);else if(c()&&function(e,t,n,r){try{var i=new ActiveXObject(Z);if(i)return i.ViewDocument3(window.self,e,t,r)}catch(e){}return!1}(t.EncodeUrl?o:u,t.Mode,t.Options,N(t.Application)))H(we.O15ActiveX);else if(T()?i=function(e,t,n){var r,i=D();if(null==i)return Ie.Unattempted;r=!1;try{r=i.ViewDocument3(window.self,e,t,n)}catch(e){}if(!r)try{r=A(t)?i.ViewDocument2(window.self,e,n):i.EditDocument2(window.self,e,n)}catch(e){}return r?(H(we.NpapiPlugin),Ie.None):Ie.Failed}(t.EncodeUrl?o:u,t.Mode,N(t.Application)):(function(){try{var e=new ActiveXObject(ce);null!=e&&e.SaveSSOCreds()}catch(e){}}(),i=function(e,t,n,r){var i;try{if(i=new ActiveXObject(ee))return i.ViewDocument3(window.self,e,t,r)?(H(we.O14ActiveX),Ie.None):Ie.Failed}catch(e){}if(Ae.O14Only===(n&Ae.O14Only))return Ie.Unattempted;try{if(i=new ActiveXObject(te))return i.ViewDocument3(window.self,e,t,r)?(H(we.O12ActiveX),Ie.None):Ie.Failed}catch(e){}if(Ae.O12UpOnly===(n&Ae.O12UpOnly))return Ie.Unattempted;try{if(i=new ActiveXObject(ne))return(A(t)?i.ViewDocument2(window.self,e,r):i.EditDocument2(window.self,e,r))?(H(we.O11ActiveX),Ie.None):Ie.Failed}catch(e){}return Ie.Unattempted}(t.EncodeUrl?o:u,t.Mode,t.Options,N(t.Application))),i!=Ie.None){if(t.CouldUseRoamingApps&&e()&&t.Application!=xe.OneNote){if(!qv.ClientUtils.CanUseRoamingControl())return void G(Ie.ControlNeeded,$.Application);if(t.RoamingAppsLauncher)return void function(e){"undefined"!=typeof e.RoamingAppsLauncher&&null!=e.RoamingAppsLauncher?"undefined"==typeof e.RoamingBitsUrl||null==e.RoamingBitsUrl?qv.ClientUtils.LaunchRoamingApps(e.DocumentUrl,e.RoamingAppsLauncher,e.Application,e.ApplicationParameters,z,K):qv.ClientUtils.LaunchRoamingApps2(e.DocumentUrl,e.RoamingAppsLauncher,e.RoamingApplicationExe,e.ApplicationParameters,e.RoamingPlatform,e.RoamingBitsUrl,z,K):G(Ie.Unattempted,$.Application)}(t);if(!t.ContinueIfLauncherIsNull)return void G(Ie.LauncherNeeded,$.Application)}if(!(Ae.NoProtocolHandlerFallback==(t.Options&Ae.NoProtocolHandlerFallback)||C(t)||l()||a()&&i!=Ie.Unattempted))return void w(t.Application,t.EncodeUrl?s:o,t.Mode,t.Application==xe.OneNote,t.SilentExternalHandler);G(i,$.Application)}}else G(Ie.Unattempted,$.Application)}function H(e){null!=z&&z(e)}function G(e,t){"undefined"==typeof t&&(t=null),null!=K&&K(e,t)}function V(){var e,t=0;if(T()||g()){e=D();try{null!=e&&(t=e.GetOfficeVersion())}catch(e){}}else L(Z)?t=15:L(ee)?t=14:L(te)?t=12:L(ne)&&(t=11);return t}function W(){return a()&&(R(re)||R(ie))}var z,K,q,j,$,Q,J,X,Y,Z="SharePoint.OpenDocuments.5",ee="SharePoint.OpenDocuments.4",te="SharePoint.OpenDocuments.3",ne="SharePoint.OpenDocuments.2",re="application/x-sharepoint",ie="application/x-sharepoint-webkit",oe="application/x-sharepoint-protocolhandler",ae="application/x-sharepoint-webkit-protocolhandler",se="application/officelive",le="npSharePointPlugin",ce="IDBHO.IDBHOCtrl",ue="OneNote.Notebook",ge="ofv|",pe="ofc|",de="ofe|",he="u|",_e="|f|",me="wdlor",fe="RoamingOfficeActiveX.RoamingOffice",ye="application/x-vnd.officeondemand",Ce="office:",Se="",ve="",be="",Te={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Ae={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},Ie={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5},we={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},xe={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Te,OpenDocumentOptions:Ae,OpenDocumentFailureType:Ie,OpenDocumentControl:we,OfficeApplication:xe,EditDocumentInClient:U,EditDocumentInClientParams:function(){this.DocumentUrl="",this.Mode=0,this.Options=0,this.Application=xe.Unknown,this.CouldUseRoamingApps=!1,this.RoamingAppsLauncher="",this.ContinueIfLauncherIsNull=!1,this.ApplicationParameters="",this.RoamingPlatform="",this.RoamingApplicationExe="",this.RoamingBitsUrl="",this.SilentExternalHandler=!1,this.EncodeUrl=!1},OfficeVersionInstalled:V,IsO14MacPluginInstalled:W,OfferOfficeInDialog:function(){return t()&&V()<=11},OfferOfficeNoIntrusive:function(){return t()&&V()<15},OfferMacOffice:function(){return a()&&!(window.navigator.userAgent.indexOf("PPC Mac")>=0)&&!W()},InstallRoamingControl:function(){u()?window.InstallTrigger.install({Office:{URL:ve}}):y(be,null,null)},CanUseRoamingControl:function(){var e,t;if(o())return!0;if(g())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),Boolean(navigator.mimeTypes[ye]);if(u())return e=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(e),(t=document.createEvent("Events")).initEvent("RoamingOfficeInstalled",!0,!1),e.dispatchEvent(t),Boolean(e.getAttribute("installed"));if(l())try{return new ActiveXObject(fe).HrExists()}catch(e){}return!1},InitUrls:function(e,t,n){Se=e,ve=n,be=t},LaunchRoamingApps:function(e,t,n,r,i,o){qv.ClientUtils.LaunchRoamingApps2(e,t,O(n),r,"x86",Se,i,o)},LaunchRoamingApps2:function(e,t,n,r,i,a,s,c){var p,d,h,_,f="";if(null!=r&&(f+=" "+r),null!=e&&(f+=' "'+e+'"'),o()||g())q=s,j=c,p=Ce,p+=' "'+a+'"',p+=' "'+n+'"',p+=' "ROAMING"',p+=' "'+t+'"',p+=' "'+i+'"',m(p+=" "+f,P,k,!1);else if(u())(d=document.createElement("RoamingExtensionElement")).setAttribute("cabUrl",a),d.setAttribute("app",n),d.setAttribute("licensingEntitlements",t),d.setAttribute("platform",i),d.setAttribute("args",f),document.documentElement.appendChild(d),(h=document.createEvent("Events")).initEvent("RoamingOfficeLaunch",!0,!1),d.dispatchEvent(h),null!=s&&s(we.RoamingFFExtension);else if(l()){if(null!=(_=new ActiveXObject(fe)))try{_.HrConfigureSingle(a,n,t,i,f),null!=s&&s(we.RoamingActiveX)}catch(e){}}else null!=c&&c(Ie.Failed)},ShouldShowDialog:function(){return!n()},NavigateToUrlUsingClickingOnATag:f,OpenDocumentWithProtocolHandler:w,OpenDocumentWithProtocolHandlerNoCallBack:function(e,t,n,r){var i=B(e);return null==i?(G(Ie.Unattempted,$.Application),!1):(m(I(e,t,n,r,i),null,null,!1),!0)}}}(),qv.ClientUtils=qv.ClientUtils;var $v=n(5626),Qv=n(1681),Jv=function(){function e(e,t){this._actionManager=null,this._hostPostmessengerFuture=null,this.hostPostmessenger=null,this._actionManager=e,this._hostPostmessengerFuture=t}return e.prototype.get_hostPostmessenger=function(){return this.hostPostmessenger},e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(te.bT,nt.a,o.i(this,this.closeDocument,"closeDocument"),2176),this._actionManager.addActionWithFlags(te.MQ,nt.a,o.i(this,this.fileProperties,"fileProperties"),128),this._actionManager.addAction(te.mX,nt.a,o.i(this,this.fileSharing,"fileSharing")),this._actionManager.addActionWithFlags(te.te,nt.a,o.i(this,this.copyAndEdit,"copyAndEdit"),128),this._actionManager.addActionWithFlags(te.LL,nt.a,o.i(this,this.replyWithChanges,"replyWithChanges"),128),this._actionManager.addActionWithFlags(te.vZ,nt.a,o.i(this,this.fileVersion,"fileVersion"),128),this._actionManager.addAction(te.Ci,nt.a,o.i(this,this.downloadACopy,"downloadACopy")),this._actionManager.addActionWithFlags(te.eb,nt.a,o.i(this,this.reportAbuseLink,"reportAbuseLink"),128),this._actionManager.addActionWithFlags(te.Ec,nt.a,o.i(this,this.signInInternal,"signInInternal"),128),this._actionManager.addAction(te.Jn,nt.a,o.i(this,this.workflow,"workflow")),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DocumentNameInJewelInfoMenuIsEnabled")&&this._actionManager.addActionWithFlags(te.nN,nt.a,o.i(this,this.queryBreadcrumbDocName,"queryBreadcrumbDocName"),96),this._actionManager.addActionWithFlags(te.Dt,nt.a,o.i(this,this.queryCopyAndEditButton,"queryCopyAndEditButton"),96),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DiagnosticsInfoInJewelAboutMenuIsEnabled")&&(this._actionManager.addActionWithFlags(te.VR,nt.a,o.i(this,this.queryBuildVersion,"queryBuildVersion"),2144),this._actionManager.addActionWithFlags(te.qb,nt.a,o.i(this,this.querySessionId,"querySessionId"),2144)),this._actionManager.addAction(te.bg,nt.a,o.i(this,this.conversation,"conversation")),this._hostPostmessengerFuture.execute(o.i(this,this.onHostPostmessengerCreated,"onHostPostmessengerCreated"))},e.prototype.onHostPostmessengerCreated=function(e){this.hostPostmessenger=e},e.prototype.closeDocument=function(e,t,n,r,i){var o=2===n,a=ai.p;return i&&(a=i),t&&o&&!this.beforeCloseDocument(a)?8:this.closeDocumentInternal(o,a)},e.prototype.beforeCloseDocument=function(e){return!0},e.prototype.closeDocumentInternal=function(e,t){if(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().shouldCommandBeHostControlled("3033402446"))return C.ULS.sendTraceTag(41231952,306,50,"CloseDocumentInternal - Sending FileClose postMessage to give the host control of closing the page"),this.sendPostmessage(e,Me.a.fileClose,!0,{});if(L.AFrameworkApplication.reportAbuseUrl&&t&&t===ai.d)return C.ULS.sendTraceTag(6070357,306,50,"CloseDocumentInternal - navigating to ReportAbuseUrl"),L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(e,L.AFrameworkApplication.reportAbuseUrl);if(L.AFrameworkApplication.get_isEmbedded())return e&&C.ULS.sendTraceTag(6070358,306,50,"CloseDocumentInternal - cannot close because application is embedded"),8;if(L.AFrameworkApplication.get_closeWindowOnAppClose()){if(!e)return 32;C.ULS.sendTraceTag(6070359,306,50,"CloseDocumentInternal - closing the window");try{return window.top.close(),32}catch(e){return C.ULS.sendTraceTag(6070360,306,10,"CloseDocumentInternal - encountered unexpected exception: {0}",e),8}}var n,r=L.AFrameworkApplication.closeUrl;return r?(t||(t=ai.p),t===ai.j||t===ai.p?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(e,r):L.AFrameworkApplication.replyWithChangesUrl?(e&&C.ULS.sendTraceTag(6070362,306,50,"CloseDocumentInternal - Using ReplyWithChanges postmessage"),32!==(n=t===ai.k||t===ai.l?this.sendPostmessage(e,Me.a.replyWithChanges,L.AFrameworkApplication.useReplyWithChangesPostMessage,{event_source:t}):2)?(r=t?tt.n.addOrReplaceParameterValue(L.AFrameworkApplication.replyWithChangesUrl,ai.x,t):L.AFrameworkApplication.replyWithChangesUrl,L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(e,r)):n):(e&&C.ULS.sendTraceTag(6070363,306,50,"CloseDocumentInternal - Using FileClose postmessage"),32!==(n=t===ai.l?this.sendPostmessage(e,Me.a.fileClose,L.AFrameworkApplication.useClosePostMessage,null):2)?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(e,r):n)):(e&&C.ULS.sendTraceTag(6070361,306,50,"CloseDocumentInternal - no closeUrl found"),8)},e.prototype.signInInternal=function(e,t,n,r,i){var o=i,a=this.sendPostmessage(2===n,Me.a.signIn,!0,o);return 8===a&&(window.top.location=L.AFrameworkApplication.signInUrl,a=32),a},e.prototype.fileProperties=function(e,t,n,r,i){var o=this.sendPostmessage(2===n,Me.a.fileProperties,L.AFrameworkApplication.useFilePropertiesPostMessage,null);return 32!==o?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,L.AFrameworkApplication.filePropertiesUrl):o},e.prototype.fileSharing=function(e,t,n,r,i){var o,a=i,s=ae.l.create().toString(),l={};l.event_source=a,l[qn.t.shareCorrelation]=s;var c=i,u=c?c.nav:null;u&&(l[qn.t.shareNavId]=u),c&&"CopyLink"===c.SourceControlId&&(c.mode="copy");var g=c?c.mode:null;if(g&&(l[qn.t.shareMode]=g),2===n){var p={};p[qn.t.shareCorrelation]=s,C.ULS.sendTraceTag(38278995,306,50,w.w(p))}var d=this.sendPostmessage(2===n,Me.a.sharing,L.AFrameworkApplication.useFileSharingPostMessage,l);if(32!==d){if(L.AFrameworkApplication.fileSharingUrl)return o=a?tt.n.addOrReplaceParameterValue(L.AFrameworkApplication.fileSharingUrl,ai.x,a):L.AFrameworkApplication.fileSharingUrl,L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,o,!0);C.ULS.sendTraceTag(7985242,306,50,"Sharing PostMessage didn't succeed but there is no FileSharingURL to fallback to.",{Result:d})}return d},e.prototype.conversation=function(e,t,n,r,i){return this.sendPostmessage(2===n,Me.a.conversation,!0,{})},e.prototype.workflow=function(e,t,n,r,i){var o=this.sendPostmessage(2===n,Me.a.workflow,L.AFrameworkApplication.useWorkflowPostMessage,{WorkflowType:L.AFrameworkApplication.workflowTypeString});if(32!==o){if(L.AFrameworkApplication.workflowUrl)return L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,L.AFrameworkApplication.workflowUrl,!0);C.ULS.sendTraceTag(19781538,306,50,"Workflow PostMessage didn't succeed.",{Result:o})}return o},e.prototype.reportAbuseLink=function(e,t,n,r,i){var o=2===n;return t&&o&&!this.beforeCloseDocument(ai.d)?8:L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(o,L.AFrameworkApplication.reportAbuseUrl)},e.prototype.copyAndEdit=function(e,t,n,r,i){var o={};2===n&&(o=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().getCopyAndEditParams());var a=this.sendPostmessage(2===n,Me.a.copyAndEdit,L.AFrameworkApplication.useCopyAndEditPostMessage,o);return 32!==a?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,L.AFrameworkApplication.copyAndEditUrl,L.AFrameworkApplication.hideHeader):a},e.prototype.downloadACopy=function(e,t,n,r,i){return 1===n?L.AFrameworkApplication.get_protectedFile()?8:32:L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,L.AFrameworkApplication.downloadACopyUrl,!0)},e.prototype.replyWithChanges=function(e,t,n,r,i){var o=2===n;if(t&&o&&!this.beforeCloseDocument(ai.k))return 8;var a=this.sendPostmessage(o,Me.a.replyWithChanges,L.AFrameworkApplication.useReplyWithChangesPostMessage,{event_source:ai.k});if(32!==a){var s=tt.n.addOrReplaceParameterValue(L.AFrameworkApplication.replyWithChangesUrl,ai.x,ai.k);return L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(o,s)}return a},e.prototype.fileVersion=function(e,t,n,r,i){var o=this.sendPostmessage(2===n,Me.a.fileVersions,L.AFrameworkApplication.useFileVersionPostMessage,null);return 32!==o?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(2===n,L.AFrameworkApplication.fileVersionUrl):o},e.prototype.queryBreadcrumbDocName=function(e,t,n,r,i){if(2===n){if(!i)return 8;var o=i,a=L.AFrameworkApplication.docPropertiesProvider.get_breadcrumbDocName();o.Value=Jn.l.getFileNameWithoutExtension(a)}return 32},e.prototype.queryBuildVersion=function(e,t,n,r,i){if(2===n){if(!i)return 8;i.Text=L.AFrameworkApplication.get_instance().get_diagnosticsBuildVersion()}return 32},e.prototype.querySessionId=function(e,t,n,r,i){if(2===n){if(!i)return 8;i.Text=L.AFrameworkApplication.get_instance().get_diagnosticsSessionId()}return 32},e.prototype.sendPostmessage=function(e,t,n,r){return n?e?this.get_hostPostmessenger().sendMessage(t,r)?32:8:32:2},e.prototype.queryCopyAndEditButton=function(e,t,n,r,i){if(2===n){if(!i)return 8;var o=i;L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEditAndReplyFlow")&&(o.LabelText=CommonUIStrings.l_EditAndReply)}return 32},e}();(0,o.l)(Jv,"WebAppFrameCommandUIActor",null,[]);var Xv=n(9959),Yv=n(3626),Zv=function(){function e(){}return e.$$cctor=function(){e._oicSurvey=new wt.z(Object)},e.waitOreoOICSurvey=function(){return e._oicSurvey.get_task().get_isCompleted()?e._oicSurvey.get_task():(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOreoIsEnabled")||e._oicSurvey.get_task().get_isFaulted()||e._oicSurvey.SX(Error.invalidOperation("Oreo is disabled")),e._oicSurvey.get_task())},e.onSurveyDismissed=function(){e._oicSurvey.setResult(null)},e._oicSurvey=null,e}();(0,o.l)(Zv,"OreoOICSurvey",null,[]),Zv.$$cctor();var eb=n(3079),tb=n(6983),nb=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,CommonUIStrings.l_OICLaunchDialogTitle)},e.dialogHtmlFormat="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>",e}();(0,o.l)(nb,"OICLaunchDialogHtml",null,[]);var rb=function(e){for(var t=0;t<e.children.length;t++){var n=e.children[t];n.style.position="relative",n.style.top=(n.parentNode.offsetHeight-n.offsetHeight)/2+"px"}},ib=function(e){return(e.innerEvent.keyCode===Je.v.vK_Enter||e.innerEvent.keyCode===Je.v.vK_Space)&&(e.get_sourceElement().click(),!0)},ob=function(e,t,n,r,i,o,a){var s=document.createElement("a");s.className="ProtocolLaunchingDialogButtonAnchor",s.className+=" OICDialog",s.id=e,s.setAttribute(Ot.t.ariaRoleAttribute,Ot.t.ariaButtonRole),s.style.padding="0",s.style.margin="0",r&&ab(i,t,n,r,s);var l=document.createElement("span");return l.className="ProtocolLaunchingDialogButtonLabel",l.innerText=i,s.appendChild(l),s.tabIndex=0,o&&hn.s.get_instance().registerHandler(Le.d.click,s,o),a&&Xe.KeyInputManager.get_instance().registerHandler(Le.d.keyUp,s,a),s},ab=function(e,t,n,r,i){var o=document.createElement("img");o.alt=e,o.className=Lt.getImageClassWithCluster(n,r),o.src=t,o.setAttribute(Ot.t.ariaRoleAttribute,Ot.t.ariaPresentationRole);var a=document.createElement("span");a.className="ProtocolLaunchingDialogImg32Container",a.appendChild(o);var s=document.createElement("span");s.className="ProtocolLaunchingDialogIconContainer",s.appendChild(a),i.appendChild(s)},sb="ProtocolLaunchingDialogTitle",lb="OICLaunchDialog",cb=function(e){function t(t){var n=e.call(this)||this;return n._operation=null,n._btnRichClient=null,n._btnReturn=null,n._disposed$4=!1,n._operation=t,n.set_dialogHtml(nb.get_dialogHtml()),n.set_autoSize(!0),n.set_buttonsOption(5),n.set_dialogId(lb),n.showDialog("",o.i(n,n.oicLaunchDialogResultHandler,"oicLaunchDialogResultHandler")),n.setLabelledByForDialog(sb),n.setDescribedByForDialog(sb),4!==L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()&&(document.getElementById(sb).innerText=CommonUIStrings.l_OICLaunchDialogTitleForView),n.setFocusOnElement(n._btnRichClient),C.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened"),document.getElementById("WACDialogTitlePanel").className+=" OICDialog",n}return(0,S.t)(t,e),t.prototype.onInnerHtmlSet=function(){this._btnRichClient=ob("BtnRichClient",this._operation.get_dlgImgClusterPath(),this._operation.get_imgClusterName(),this._operation.get_imgBtnGetRichClient(),CommonUIStrings.l_OICLaunchRichClient,o.i(this,this.onRichClientButtonClick,"onRichClientButtonClick"),ib),document.getElementById("OICLaunchRichClient").appendChild(this._btnRichClient),rb(this._btnRichClient),this._btnReturn=ob("BtnReturn",this._operation.get_dlgImgClusterPath(),this._operation.get_imgClusterName(),this._operation.get_imgBtnEdit(),CommonUIStrings.l_OICReturnToOnlineClient,o.i(this,this.onReturnButtonClick,"onReturnButtonClick"),ib),document.getElementById("OICReturnToApp").appendChild(this._btnReturn),rb(this._btnReturn)},t.prototype.onReturnButtonClick=function(e){return this.hide(),this._operation.get_suppressRestartAfterOpenInClientTriggered()||this._operation.restartApplication(),!0},t.prototype.onRichClientButtonClick=function(e){return C.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client"),this.hide(),L.AFrameworkApplication.get_theActionManager().processAction(te.CO,2),!0},t.prototype.oicLaunchDialogResultHandler=function(e,t){this._operation.get_suppressRestartAfterOpenInClientTriggered()||this._operation.restartApplication()},t.prototype.dispose=function(){this._disposed$4||(this._btnRichClient&&(hn.s.get_instance().unregisterHandler(Le.d.click,this._btnRichClient,o.i(this,this.onRichClientButtonClick,"onRichClientButtonClick")),Xe.KeyInputManager.get_instance().unregisterHandler(Le.d.keyUp,this._btnRichClient,ib)),this._btnReturn&&(hn.s.get_instance().unregisterHandler(Le.d.click,this._btnReturn,o.i(this,this.onReturnButtonClick,"onReturnButtonClick")),Xe.KeyInputManager.get_instance().unregisterHandler(Le.d.keyUp,this._btnReturn,ib)),e.prototype.dispose.call(this),this._disposed$4=!0)},t}(ri.o);(0,o.l)(cb,"OICLaunchDialog",ri.o,[]);var ub=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,CommonUIStrings.l_OICDialogTitle)},e.dialogHtmlFormat="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>",e}();(0,o.l)(ub,"ProtocolLaunchingDialogV2Html",null,[]);var gb=n(8058),pb=5e3,db=5e3,hb="ProtocolLaunchingDialogTitle",_b="ProtocolLaunchingDialog",mb="Issues",fb=function(e){function t(t){var n=e.call(this)||this;return n._operation=null,n._btnEdit=null,n._btnGiveFeedback=null,n._disposed$4=!1,n._btnRetryOIC=null,n._operation=t,n.set_dialogHtml(ub.get_dialogHtml()),n.set_autoSize(!0),n.set_buttonsOption(5),n.set_dialogId(_b),n._customCssClass="OICRetryDialog",L.AFrameworkApplication.get_theTaskManager().get_hasStopped()&&L.AFrameworkApplication.get_theTaskManager().restart(),n._operation.get_suppressRestartAfterOpenInClientTriggered()?L.AFrameworkApplication.get_theTaskManager().addTask(new De.c(2,1,db,(function(e){n.dismissProtocolLaunchingDialog()}))):L.AFrameworkApplication.get_theTaskManager().addTask(new De.c(2,1,pb,(function(e){n.switchToBackupMode()}),101)),n.showDialog("",o.i(n,n.protocolLaunchingDialogResultHandler,"protocolLaunchingDialogResultHandler")),n.setLabelledByForDialog(hb),n.setDescribedByForDialog(mb),n.focusOnEditButton(),C.ULS.sendTraceTag(19239262,211,50,"OIC dialog launched"),document.getElementById("WACDialogTitlePanel").className+=" OICDialog",n}return(0,S.t)(t,e),t.prototype.onInnerHtmlSet=function(){var e=document.getElementById("Issues");if(e){ab("",this._operation.get_dlgImgClusterPath(),this._operation.get_imgClusterName(),this._operation.get_imgBtnGetRichClient(),e);var t=document.createElement("span");t.className="WACDialogSectionTitle",t.innerText=5===this._operation.get_openDocumentMode()?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle,e.appendChild(t),rb(e),e.style.display="none"}if(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_giveFeedbackOnOpenClient()){var n=CommonUIStrings.l_OICDialogSectionGiveFeedback;this._btnGiveFeedback=ob("GiveFeedback",this._operation.get_dlgImgClusterPath(),this._operation.get_imgClusterName(),"",n,o.i(this,this.onGiveFeedbackClick,"onGiveFeedbackClick"),o.i(this,this.onGiveFeedbackKeyUp,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this._btnGiveFeedback),rb(this._btnGiveFeedback)}else document.getElementById("ButtonGiveFeedback").style.display="none";if(L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()&&!L.AFrameworkApplication.get_disableEditIfAndroid()){var r=null;if(r=2===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()?4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:this._operation.get_suppressRestartAfterOpenInClientTriggered()?CommonUIStrings.l_DialogOk:4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,this._btnEdit=ob("Edit",this._operation.get_dlgImgClusterPath(),this._operation.get_imgClusterName(),"",r,o.i(this,this.onEditClick,"onEditClick"),o.i(this,this.onEditKeyUp,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this._btnEdit),rb(this._btnEdit),this._operation.get_suppressRestartAfterOpenInClientTriggered()){document.getElementById("Buttons").style.textAlign="right",document.getElementById("Edit").style.textAlign="center";var i=document.getElementById(this.myId("WACDialogButtonPanel"));i&&(i.style.display="none",this.set_buttonsOption(5))}}else document.getElementById("ButtonEdit").style.display="none";L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()||L.AFrameworkApplication.isOfficeTrialOfferEnabled||e&&(e.style.display="none")},t.prototype.focusOnRetryButton=function(){return!!this._btnRetryOIC&&(this.setFocusOnElement(this._btnRetryOIC),!0)},t.prototype.focusOnEditButton=function(){return!!this._btnEdit&&(this.setFocusOnElement(this._btnEdit),!0)},t.prototype.onFinishedClick=function(e){return this._operation.closeApplication(),!0},t.prototype.onEditKeyUp=function(e){return this.onBtnKeyUp(e,0)},t.prototype.onGiveFeedbackKeyUp=function(e){return this.onBtnKeyUp(e,2)},t.prototype.onRetryOICKeyUp=function(e){return this.onBtnKeyUp(e,1)},t.prototype.onBtnKeyUp=function(e,t){var n=!1;if(e.innerEvent.keyCode===Je.v.vK_Enter||e.innerEvent.keyCode===Je.v.vK_Space)e.get_sourceElement().click(),n=!0;else if(e.innerEvent.keyCode===Sys.UI.Key.down||e.innerEvent.keyCode===Sys.UI.Key.up)switch(t){case 1:n=this.focusOnEditButton();break;case 0:n=this.focusOnRetryButton()}return n},t.prototype.onEditClick=function(e){return this.hide(),4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_editMode()?this._operation.get_suppressRestartAfterOpenInClientTriggered()||(C.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this._operation.restartApplication()):(C.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this._operation.handleEditInBrowser()),!0},t.prototype.onGiveFeedbackClick=function(e){return C.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog"),this._operation.handleGiveFeedback(),!0},t.prototype.onGetRichClientClick=function(e){var t=se.w.get_instance().resolve($v.v),n=se.w.get_instance().resolve(Qv.u);return G.y.get_isMac()?n.launchMacOfficeTrialWindow(this._operation.application):t.launchOffer(this._operation.application),!0},t.prototype.onLearnMoreClick=function(e){return gb.Redirect.showHelp("OICFailure"),!0},t.prototype.onRetryOICClick=function(e){return C.ULS.sendTraceTag(19239263,211,50,"OIC dialog retry"),document.getElementById("WACDialogPanel").style.display="none",L.AFrameworkApplication.get_theActionManager().processAction(te.CO,2),!0},t.prototype.protocolLaunchingDialogResultHandler=function(e,t){this._operation.get_suppressRestartAfterOpenInClientTriggered()||this._operation.restartApplication()},t.prototype.switchToBackupMode=function(){var e=document.getElementById("ProtocolLaunchingDialogTitle");if(e){this._operation.get_suppressRestartAfterOpenInClientTriggered()?e.innerText="":e.innerText=CommonUIStrings.l_OICDialog2ndTitle;var t=document.getElementById("Issues");if(t&&(t.style.display="block"),this._operation.get_suppressRestartAfterOpenInClientTriggered()){var n=document.getElementById("ButtonRetryOIC");n&&(n.style.display="none")}else{var r=document.getElementById("ProtocolHandlerDialogRetryOIC");r&&!r.children.length&&(this._btnRetryOIC=ob("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,o.i(this,this.onRetryOICClick,"onRetryOICClick"),o.i(this,this.onRetryOICKeyUp,"onRetryOICKeyUp")),r.appendChild(this._btnRetryOIC),rb(this._btnRetryOIC),this._btnEdit||this.focusOnRetryButton())}}},t.prototype.dismissProtocolLaunchingDialog=function(){document.getElementById("ProtocolLaunchingDialogTitle")&&(C.ULS.sendTraceTag(50857158,211,50,"OIC dialog auto hidden after client launched"),this.hide())},t.prototype.dispose=function(){this._disposed$4||(this._btnEdit&&(hn.s.get_instance().unregisterHandler(Le.d.click,this._btnEdit,o.i(this,this.onEditClick,"onEditClick")),Xe.KeyInputManager.get_instance().unregisterHandler(Le.d.keyUp,this._btnEdit,o.i(this,this.onEditKeyUp,"onEditKeyUp"))),this._btnGiveFeedback&&(hn.s.get_instance().unregisterHandler(Le.d.click,this._btnGiveFeedback,o.i(this,this.onGiveFeedbackClick,"onGiveFeedbackClick")),Xe.KeyInputManager.get_instance().unregisterHandler(Le.d.keyUp,this._btnGiveFeedback,o.i(this,this.onGiveFeedbackKeyUp,"onGiveFeedbackKeyUp"))),this._btnRetryOIC&&(hn.s.get_instance().unregisterHandler(Le.d.click,this._btnRetryOIC,o.i(this,this.onRetryOICClick,"onRetryOICClick")),Xe.KeyInputManager.get_instance().unregisterHandler(Le.d.keyUp,this._btnRetryOIC,o.i(this,this.onRetryOICKeyUp,"onRetryOICKeyUp"))),e.prototype.dispose.call(this),this._disposed$4=!0)},t}(ri.o);(0,o.l)(fb,"ProtocolLaunchingDialog",ri.o,[]);var yb=function(){return function(){}}();(0,o.l)(yb,"EditDocumentInClientParams",null,[]);var Cb=function(e,t,n,r,i,o,a,s,l){void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===l&&(l="");var c=new yb;c.DocumentUrl=e,c.Mode=t,c.Options=n,c.Application=r,c.SilentExternalHandler=a,c.EncodeUrl=s,c.CorrelationIdForWinClient=l,MSOJS.ClientUtils.EditDocumentInClient(c,i,o)},Sb=function(){function e(e){this._clientUrl=null,this._downloadUrl=null,this._postmessengerlazy=null,this._forceClose=!1,this._officeTrialExperience=null,this._macOfficeOffer=null,this._mode=0,this.silentExternalHandler=!1,this.application=0,this.suppressClose=!1,this.suppressRestart=!1,this.useLaunchDialog=!1,this.useLaunchDialog=e&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OICLaunchDialogIsEnabled"),L.AFrameworkApplication.get_theActionManager().getActionMetadata(te.CO)||L.AFrameworkApplication.get_theActionManager().addAction(te.CO,nt.a,o.i(this,this.retryOpenInClientAction,"retryOpenInClientAction")),this.silentExternalHandler=!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SilentExternalHandler")}return e.prototype.get_openDocumentMode=function(){return this._mode},e.prototype.retryOpenInClientAction=function(e,t,n,r,i){return t.get_contextId()!==nt.a?2:1===n?32:this.retryOpenInClient()},e.prototype.get_options=function(){var e=0;return L.AFrameworkApplication.get_requiresCheckout()&&(e|=1),L.AFrameworkApplication.openInClientEditOnly&&(e|=4),this.supportsTopTargetNavigation()&&(e|=64),e},e.prototype.supportsTopTargetNavigation=function(){return!(2===this.application&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEmbeddedScenario"))},e.prototype.get_openInClientCommandString=function(){return null},e.prototype.get_dlgImgClusterPath=function(){return L.AFrameworkApplication.get_imageClusterPath()},e.prototype.get_imgClusterName=function(){return L.AFrameworkApplication.get_imageClusterName()},e.prototype.get_imgBtnFinished=function(){return"ImFinished_32x32x32"},e.prototype.get_imgBtnEdit=function(){return""},e.prototype.get_imgBtnGetRichClient=function(){return""},e.prototype.get_suppressProtocolHandlerDialog=function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteMobileViewerIsEnabled")},e.prototype.get_suppressRestartAfterOpenInClientTriggered=function(){return!1},e.prototype.get_theOfficeTrialExperience=function(){return this._officeTrialExperience||(this._officeTrialExperience=se.w.get_instance().resolve($v.v))},e.prototype.get_theMacOfficeOffer=function(){return this._macOfficeOffer||(this._macOfficeOffer=se.w.get_instance().resolve(Qv.u))},e.prototype.closeApplication=function(){this.suppressClose||this.executeCloseApplication()},e.prototype.restartApplication=function(){this.suppressRestart||this.executeRestartApplication()},e.prototype.readyForClientLaunch=function(e){return this.useLaunchDialog&&G.y.get_isIPad()?(new cb(this),32):this.completeClientLaunch(e)},e.prototype.completeClientLaunch=function(e){var t,n=this.launchClient(e,(0,p.m)((function(){return t}),(function(e){return t=e})));return C.ULS.sendTraceTag(34198736,211,50,"OICLaunchClient,{0},{1}",32===n,t),n},e.prototype.begin=function(e,t,n,r,i,o){return this._clientUrl=e,this._downloadUrl=t,this._postmessengerlazy=o,this.application=n,this._mode=r,L.AFrameworkApplication.downloadCopyOnOpenInClient?(this.launchDownload(),32):L.AFrameworkApplication.limitedEdit&&!L.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?(L.AFrameworkApplication.showRequiresSignInDialog(),8):this.beforeClientLaunch(i)},e.prototype.retryOpenInClient=function(){return this.completeClientLaunch(this._forceClose)},e.prototype.sendOICPostMessage=function(){var e=new dl.f(Me.a.openInClient);return e.Values["ui-language"]=L.AFrameworkApplication.lcid.toString(),e.Values[pl.a.currentSessionParamName]=L.AFrameworkApplication.userSessionId,this._postmessengerlazy.get_value().send(e)?32:8},e.prototype.sendTelemetryPostMessage=function(e){var t=new dl.f(Me.a.wacActionComplete);t.Values["ui-language"]=L.AFrameworkApplication.lcid.toString(),t.Values[pl.a.currentSessionParamName]=L.AFrameworkApplication.userSessionId,t.Values[qn.t.wacAction]=e,this._postmessengerlazy.get_value().send(t)},e.prototype.launchClient=function(t,n){return this._forceClose=t,this.sendTelemetryPostMessage(5===this._mode?e.openInBrowserAction:e.openInDesktopAction),5===this._mode?this.launchBrowser(n):this.launchDesktop(n)},e.prototype.launchBrowser=function(e){return e.val="",new fb(this),e.val+="HostEditUrl,",32},e.prototype.launchDesktop=function(e){e.val="";var t="";if(L.AFrameworkApplication.addSessionIdToClientUrl&&(t="|f|"+L.AFrameworkApplication.userSessionId),L.AFrameworkApplication.preferPostMessageOverCommandUrlForOpenInClient){e.val+="NewOrder,";var n=8;return this._postmessengerlazy&&this._postmessengerlazy.get_value()&&this._postmessengerlazy.get_value().isEnabled()&&L.AFrameworkApplication.useOpenInClientPostMessage&&(e.val+="Post,",n=this.sendOICPostMessage()),32===n?n:(C.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl()?(C.ULS.shipAssertTag(5566816,211,!!L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl()),e.val+="HostUrl,",L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(!0,L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl())):this._clientUrl?(C.ULS.sendTraceTag(18715405,211,15,"Try to open doc in rich client, SessionId {0}",L.AFrameworkApplication.userSessionId),e.val+="DocUrl,",Cb(this._clientUrl+t,this._mode,this.get_options(),this.application,o.i(this,this.onEditInClientSuccess,"onEditInClientSuccess"),o.i(this,this.onEditInClientFailure,"onEditInClientFailure"),this.silentExternalHandler,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OICEncodeUrlIsEnabled")),32):8)}if(e.val+="OldOrder,",!this._clientUrl&&L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl()){n=void 0;return this._postmessengerlazy&&this._postmessengerlazy.get_value()&&this._postmessengerlazy.get_value().isEnabled()&&L.AFrameworkApplication.useOpenInClientPostMessage?(e.val+="Post,",n=this.sendOICPostMessage()):(C.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),n=8),32!==n?(C.ULS.shipAssertTag(22595484,211,!!L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl()),e.val+="HostUrl,",L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(!0,L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl())):n}return C.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",L.AFrameworkApplication.userSessionId),e.val+="DocUrl,",Cb(this._clientUrl+t,this._mode,this.get_options(),this.application,o.i(this,this.onEditInClientSuccess,"onEditInClientSuccess"),o.i(this,this.onEditInClientFailure,"onEditInClientFailure"),this.silentExternalHandler,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OICEncodeUrlIsEnabled")),32},e.prototype.reportControlUsed=function(e){L.AFrameworkApplication.theWsaClient.setDw(8981,e)},e.prototype.onEditInClientSuccess=function(e){this.reportControlUsed(e),C.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed"),6===e&&MSOJS.ClientUtils.ShouldShowDialog()?this.get_suppressProtocolHandlerDialog()||new fb(this):this.suppressClose||this.closeApplication()},e.prototype.onEditInClientFailure=function(e,t){if(void 0===t&&(t=0),C.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0}, Application: {1}",e,t),5===e)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{var n=!!this._downloadUrl&&!this._forceClose,r=0;1===e&&(r=2),2===e&&(r=1,1===t&&(this.suppressClose=!0)),this.get_theOfficeTrialExperience().get_offerOfficeTrialInDialog()?(C.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",r),tb.p.get_instance().createOICErrorDialogWithTrial(this._forceClose?o.i(this,this.oicErrorDialogHandlerCloseForced,"oicErrorDialogHandlerCloseForced"):o.i(this,this.oicErrorDialogHandlerNoCloseForced,"oicErrorDialogHandlerNoCloseForced"),n?o.i(this,this.onLaunchDownload,"onLaunchDownload"):null,this.directInvokeHandler(!1)?o.i(this,this.iHaveOfficeButtonHandler,"iHaveOfficeButtonHandler"):null,null,r,t)):(C.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",r),tb.p.get_instance().createOICErrorDialog(this._forceClose?o.i(this,this.oicErrorDialogHandlerCloseForced,"oicErrorDialogHandlerCloseForced"):o.i(this,this.oicErrorDialogHandlerNoCloseForced,"oicErrorDialogHandlerNoCloseForced"),n?o.i(this,this.onLaunchDownload,"onLaunchDownload"):null,null,r))}},e.prototype.oicErrorDialogHandlerCloseForced=function(e){this.closeApplication()},e.prototype.oicErrorDialogHandlerNoCloseForced=function(e){this.restartApplication()},e.prototype.onLaunchDownload=function(e){this.launchDownload()},e.prototype.iHaveOfficeButtonHandler=function(e){return this.directInvokeHandler(!0)},e.prototype.directInvokeHandler=function(e){var t=(G.y.get_isInternetExplorer10Up()||G.y.get_isInternetExplorerEdge())&&!!L.AFrameworkApplication.directInvokeDAVUrl;return t&&e&&(window.open(L.AFrameworkApplication.directInvokeDAVUrl,"_blank"),this.closeApplication()),t},e.openInDesktopAction="OpenInDesktop",e.openInBrowserAction="OpenInBrowser",e}();(0,o.l)(Sb,"AOpenInClientOperation",null,[]);var vb=function(e){function t(t,n,r){void 0===r&&(r=!1);var i=e.call(this,r)||this;return i._imgBtnGetRichClient=null,i._imgBtnEdit=null,i._imgBtnGetRichClient=t,i._imgBtnEdit=n,i}return(0,S.t)(t,e),t.prototype.get_imgBtnEdit=function(){return this._imgBtnEdit},t.prototype.get_imgBtnGetRichClient=function(){return this._imgBtnGetRichClient},t.prototype.executeCloseApplication=function(){L.AFrameworkApplication.get_theActionManager().processActionWithData(te.bT,2,ai.e)},t.prototype.executeRestartApplication=function(){},t.prototype.beforeClientLaunch=function(e){return this.readyForClientLaunch(e)},t.prototype.launchDownload=function(){C.ULS.shipAssertTag(5566817,211,!!this._downloadUrl),L.AFrameworkApplication.isCloseable?L.AFrameworkApplication.get_activeFrame().navigateToHostUrl(!0,this._downloadUrl):window.open(this._downloadUrl)},t.prototype.handleEditInBrowser=function(){L.AFrameworkApplication.get_activeFrame().get_applicationInstance().handleEditInBrowser()},t.prototype.handleGiveFeedback=function(){L.AFrameworkApplication.get_activeFrame().get_applicationInstance().handleGiveFeedback()},t}(Sb);(0,o.l)(vb,"OpenInClientOperation",Sb,[]);var bb=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i._embedMessageSender=null,i._embedMessageSender=r,i}return(0,S.t)(t,e),t.prototype.registerActions=function(){e.prototype.registerActions.call(this),this._actionManager.addAction(ii.AM,nt.a,o.i(this,this.onEditInClient,"onEditInClient")),Wr.App.get_isOneNoteEmbedded()&&this._actionManager.addAction(eb.eK,nt.a,o.i(this,this.onEditInBrowserForEmbed,"onEditInBrowserForEmbed"))},t.prototype.onEditInBrowserForEmbed=function(e,t,n,r,i){if(t.get_contextId()!==nt.a)return 2;if(1===n)return 32;var o=Wr.App.buildPageUrl(Br.App.get_activeAppFrame().workspace.get_activePage());if(!o)return 8;try{return window.open(o,"_blank"),32}catch(e){return C.ULS.sendTraceTag(37232902,339,15,"Electron crash caused by window.open in Embed_Edit_Teams mode: {0}",e),32}},t.prototype.onEditInClient=function(e,t,n,r,i){if(t.get_contextId()!==nt.a)return 2;if(!Br.App.get_clientEditDocumentUrl()&&!L.AFrameworkApplication.docPropertiesProvider.get_openInClientCommandUrl()&&!L.AFrameworkApplication.useOpenInClientPostMessage)return 8;if(1===n)return 32;C.ULS.sendTraceTag(22298957,339,50,'Click "EDIT IN ONENOTE" button.');var o=!1;return null!=i&&(o=i),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOICSurveyIsEnabled")&&"undefined"!=typeof oreo_slice2&&"undefined"!=typeof oreo_slice2.OreoOICSurvey?(this.showOICSurveyBeforeOpenInClient(o),32):this.startOpeningOneNoteInClient(o)},t.prototype.showOICSurveyBeforeOpenInClient=function(e){var t=this;C.ULS.sendTraceTag(38638724,339,50,"loading ONO Oreo OIC Survey"),this._actionManager.processAction(eb.YS,2),Zv.waitOreoOICSurvey().CWo((function(n){t.startOpeningOneNoteInClient(e)}),gr.d.onlyOnRanToCompletion)},t.prototype.startOpeningOneNoteInClient=function(e){var t=this;return new vb("OneNote_32x32x32","EditInOneNoteWebApp_32x32x32").begin(this.getPageUrl(),L.AFrameworkApplication.downloadACopyUrl,2,2,e,new yt.q(Fe.i,(function(){return t.get_hostPostmessenger()})))},t.prototype.getPageUrl=function(){var e=Br.App.get_clientEditDocumentUrl();e&&Br.App.get_activeAppFrame().workspace.get_activePage()&&((e=Xv.j.getAnInstanceFromGraphNode(Br.App.get_activeAppFrame().workspace.get_activePage(),Br.App.get_clientEditDocumentUrl(),null).getClientUrl(Br.App.notebookMode)||Br.App.get_clientEditDocumentUrl()).startsWith(Yv.u.protocolOnenote)&&(e=e.substr(Yv.u.protocolOnenote.length)));return e},t}(Jv);(0,o.l)(bb,"OneNoteAppFrameCommandUIActor",Jv,[]);var Tb=function(){function e(e,t,n){this._actionManager=null,this._isMacOfficeTrialOfferEnabled=!1,this._lcid=0,this._actionManager=e,this._isMacOfficeTrialOfferEnabled=t,this._lcid=n}return e.prototype.registerActions=function(){this._actionManager.addAction(te.BA,nt.a,o.i(this,this.onTryMacOffice,"onTryMacOffice")),this._actionManager.addAction(te.mE,nt.a,o.i(this,this.onTryMacOfficeFromViewer,"onTryMacOfficeFromViewer")),this._actionManager.addAction(te.ws,nt.a,o.i(this,this.onTryMacOfficeFromViewer,"onTryMacOfficeFromViewer"))},e.prototype.onTryMacOffice=function(e,t,n,r,i){if(1===n)return 32;if(i){var o=i.SourceControlId;"btnjTryMacOfficeForWordEditor"===o?window.open(tt.n.getFwLinkForUpsellFeatures(12),"_blank"):"PptJewel.About.TryMacOffice"===o&&window.open(tt.n.getFwLinkForUpsellFeatures(22),"_blank")}else this.launchMacOfficeTrialWindow();return 32},e.prototype.onTryMacOfficeFromViewer=function(e,t,n,r,i){if(1===n)return 32;switch(e){case te.mE:window.open(tt.n.getFwLinkForUpsellFeatures(15),"_blank");break;case te.ws:window.open(tt.n.getFwLinkForUpsellFeatures(25),"_blank")}return 32},e.prototype.launchMacOfficeTrialWindow=function(t){void 0===t&&(t=null);var n=0;t&&(n=t);var r=2===n?"https://go.microsoft.com/fwlink/?LinkId=331579":e.get_macOfficeTrialTarget();window.open(r,"_blank")},e.prototype.get_shouldOfferMacOfficeTrial=function(){return this._isMacOfficeTrialOfferEnabled&&G.y.get_isMac()&&!G.y.get_isPpcMac()&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()},e.prototype.get_shouldOfferMacOfficeTrialInFileMenu=function(){var e=this.get_shouldOfferMacOfficeTrial();return e||L.AFrameworkApplication.theWsaClient.setBool(9124,1),e},e.prototype.get_shouldOfferMacOfficeTrialInErrorDialog=function(){return this.get_shouldOfferMacOfficeTrial()},e.get_macOfficeTrialTarget=function(){return tt.n.getFwLinkUrl("522401")},e}();(0,o.l)(Tb,"MacOfficeOffer",null,[Qv.u]);var Ab=function(){function e(e,t,n){this._actionManager=null,this._isOfficeTrialOfferEnabled=!1,this._lcid=0,this._actionManager=e,this._isOfficeTrialOfferEnabled=t,this._lcid=n}return e.prototype.registerActions=function(){this._actionManager.addAction(te.KW,nt.a,o.i(this,this.onTryOffice,"onTryOffice")),this._actionManager.addAction(te.er,nt.a,o.i(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe")),this._actionManager.addAction(te.PD,nt.a,o.i(this,this.tryOfficeThroughViewer,"tryOfficeThroughViewer")),this._actionManager.addAction(te.BJ,nt.a,o.i(this,this.tryOfficeThroughViewer,"tryOfficeThroughViewer"))},e.prototype.onTryOffice=function(e,t,n,r,i){if(2===n)if(i){var o=i.SourceControlId;"btnjTryOfficeForWordEditor"===o?window.open(tt.n.getFwLinkForUpsellFeatures(11),"_blank"):"PptJewel.About.TryOffice"===o?window.open(tt.n.getFwLinkForUpsellFeatures(21),"_blank"):this.launchOffer()}else this.launchOffer();return 32},e.prototype.tryOfficeThroughTellMe=function(e,t,n,r,i){if(2===n)if(i){var o=i.SourceControlId;window.open(tt.n.getFwLinkUrl("862405")+this.getParameterForTellMeFeatures(o),"_blank")}else window.open(tt.n.getFwLinkUrl("522402"),"_blank");return 32},e.prototype.tryOfficeThroughViewer=function(e,t,n,r,i){if(2===n)switch(e){case te.PD:window.open(tt.n.getFwLinkForUpsellFeatures(14),"_blank");break;case te.BJ:window.open(tt.n.getFwLinkForUpsellFeatures(24),"_blank")}return 32},e.prototype.get_offerOfficeTrialInFileMenu=function(){return this.get_shouldOfferOfficeTrial()},e.prototype.get_offerOfficeTrialInDialog=function(){return this.get_shouldOfferOfficeTrial()&&MSOJS.ClientUtils.OfferOfficeInDialog()},e.prototype.get_shouldOfferOfficeTrial=function(){return this._isOfficeTrialOfferEnabled&&!G.y.get_isMac()},e.prototype.launchOffer=function(t){void 0===t&&(t=null);var n=0;t&&(n=t),window.open(e.getLinkForPlatformAndApplication(n),"_blank")},e.prototype.getParameterForTellMeFeatures=function(e){var t=0;switch(e){case"jbtnTryOfficeThroughTellMeForWordTrackChanges":t=1;break;case"jbtnTryOfficeThroughTellMeForWordShapes":t=2;break;case"jbtnTryOfficeThroughTellMeForWordLabel":t=3;break;case"jbtnTryOfficeThroughTellMeForWordCitations":t=4;break;case"jbtnTryOfficeThroughTellMeForWordTextBox":t=5;break;case"jbtnTryOfficeThroughTellMeForWordTableOfContent":t=6;break;case"jbtnTryOfficeThroughTellMeForWordSmartArt":t=7;break;case"jbtnTryOfficeThroughTellMeForWordWordArt":t=8;break;case"jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":t=9;break;case"jbtnTryOfficeThroughTellMeForWordEquation":t=10;break;case"jbtnTryOfficeThroughTellMeForPPTGroupShapes":t=16;break;case"jbtnTryOfficeThroughTellMeForPPTWordArt":t=17;break;case"jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":t=18;break;case"jbtnTryOfficeThroughTellMeForPPTInsertAudio":t=19;break;case"jbtnTryOfficeThroughTellMeForPPTInsertChart":t=20;break;case"TellMe.TryOfficeThroughTellMeForXLSSpellCheck":t=26;break;case"TellMe.TryOfficeThroughTellMeForXLSMacros":t=27;break;case"TellMe.TryOfficeThroughTellMeForXLSPivotTable":t=28;break;case"TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":t=29}return t?String.format("&pc={0:D}",t):""},e.getLinkForPlatformAndApplication=function(e){if(G.y.get_isIPad())switch(e){case 1:return tt.n.getFwLinkUrl("393806");case 2:return tt.n.getFwLinkUrl("393810");case 3:return tt.n.getFwLinkUrl("393809");case 5:return tt.n.getFwLinkUrl("393805")}else if(G.y.get_isAndroid())switch(e){case 1:return tt.n.getFwLinkUrl("521979");case 3:return tt.n.getFwLinkUrl("521980");case 5:return tt.n.getFwLinkUrl("521978");case 2:return tt.n.getFwLinkUrl("522490")}else{if(2===e)return tt.n.getFwLinkUrl("517778");if(1===e)return tt.n.getFwLinkForUpsellFeatures(30)}return tt.n.getFwLinkUrl("522402")},e}();(0,o.l)(Ab,"OfficeTrialExperience",null,[$v.v]);var Ib=function(){function e(){}return e.prototype.configure=function(e){e.register(Ab).as($v.v).singleInstance().usingFactory((function(){return new Ab(L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.isOfficeTrialOfferEnabled,L.AFrameworkApplication.lcid)})),e.register(Tb).as(Qv.u).singleInstance().usingFactory((function(){return new Tb(L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.isMacOfficeTrialOfferEnabled,L.AFrameworkApplication.lcid)}))},e}();(0,o.l)(Ib,"OpenInClientConfiguration",null,[c.s]);var wb=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.CommandUIActors"},e.prototype.init=function(){this._container.resolve(Jv).registerActions(),this._container.resolve($v.v).registerActions(),this._container.resolve(Qv.u).registerActions()},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e;var t=null;Wr.App.get_isOneNoteEmbedded()&&(t=new yt.q(Wv,(function(){return new Wv(L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteEmbedHostingApp,e.tryResolve(Fe.i))}))),e.register(Jv).singleInstance().usingFactory((function(){return new bb(L.AFrameworkApplication.get_theActionManager(),e.resolveFuture(Fe.i),t)})),(new Ib).configure(e)},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(wb,"OneNoteBootstrapActorsPackage",null,[l.u,c.s]);var xb=(0,o.y)("IExternalContentEditor"),Fb=n(8053),Eb=n(892),Pb=n(7301),kb=n(9934),Db=n(8065),Mb=function(){function e(){}return e.prototype.insertExternalContent=function(e,t,n){var r=this,i=(0,f.e)(_s.y,e);if(i&&(i.get_contextId()===cl.V||i.get_contextId()===cl.Z)&&(!n||i.get_contextId()===cl.Z)){var o={"Content-Type":"application/json; charset=utf-8"},a=Pb.b.constructExternalContentEmbedRequest(t,!0),s=Eb.y(a);L.AFrameworkApplication.theClientRequestManager.addRequest(Br.App.webServiceBase+"OneNote.ashx",2,s,o,!1,2,(function(e){var o=r.prepareResponse(e);o&&r.insertExternalContentCore(o,i,t,n)}),(function(e){}),a)}},e.prototype.insertIFrameNode=function(e,t,n){if(!e||!e.get_isConnected()||!ka.ImageReader.isImageNode(e))return null;var r=new kb.IFrameNode;return r.setValue(qc.o.iFrameMediaType,n),r.setValue(qc.o.iFrameOriginUrl,t),Da.GraphIterator.createFromNode(e).addChild(r,2),r},e.prototype.insertExternalContentCore=function(t,n,r,i){var o=!1,a=0,s=null,l=ae.l.create(),c=Oa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection();i&&c.get_lastContext().get_node()===n.get_node()&&(o=!0,s=n.get_node(),a=c.get_lastContext().get_cpEnd()-n.get_cpEnd());var u=new as.GraphTransaction(15);if(u.setFromNode(n.get_node()),t.Title){if(i){var g=Hs.HyperlinkReader.getHyperlinksInRange(n,!1);if(g&&1!==g.length)return void u.dispose();e.get_hyperlinkEditor().removeHyperlink(g[0].paragraph,g[0].hyperlink)}n=this.replaceContextWithHyperlink(n,t.Title,r)}var p=this.createEmptyLineAndOutlineElementBelow(n),d=new Kl.DictionaryPropertySet;e.get_imageEditor().preparePlaceholderForImageUpload(d,t.Width,t.Height);var h=Db.q.parseMediaType(t.MediaType),_=this.getExternalContentAltText(h,t.Title);d.setValue(Kc.b.imageAltText,_);var m=e.get_imageEditor().insertPictureBlock(p,d);this.insertIFrameNode(m.node,r,h),i?(o&&(c=ss.SelectionFactory.createIpSelection(s,a+n.get_cpEnd())),Oa.SelectionManager.get_instance().setSelection(c)):Oa.SelectionManager.get_instance().setSelection(c),u.makeIncrementalAction(l,1),u.dispose(),this.doServerRequestToDownloadThumbnailImageBlob(m.node,t.Thumbnail,l)},e.prototype.prepareResponse=function(e){var t;if(!Bh.j.tryDeserializeServerResponse(e.get_data().responseData,(0,p.m)((function(){return t}),(function(e){return t=e}))))return null;var n=t.Responses[0];return n.StatusCode?null:n},e.prototype.replaceContextWithHyperlink=function(t,n,r){var i=t.get_cpBegin()+n.length;e.get_characterPropertiesEditor().replaceTextRange(t,n);var o=_s.y.createTextRange(t.get_node(),t.get_cpBegin(),i);return e.get_hyperlinkEditor().createHyperlink(o,r,!1),o},e.prototype.createEmptyLineAndOutlineElementBelow=function(t){var n=Da.GraphIterator.createFromNode(t.get_node());n.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(n);var r=e.get_outlineElementEditor().insertOutlineElementBelow(n);return e.get_outlineElementEditor().createParagraph(r),hs.OutlineElementNavigator.returnToOutlineElement(r),r=e.get_outlineElementEditor().insertOutlineElementBelow(r)},e.prototype.getExternalContentAltText=function(e,t){switch(e){case 1:return""===t?String.format(OneNoteIntl.OneNoteStrings.L_ThumbnailAltText,OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextVideo):String.format(OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextTitled,OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextVideo,t);case 2:return""===t?String.format(OneNoteIntl.OneNoteStrings.L_ThumbnailAltText,OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextRich):String.format(OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextTitled,OneNoteIntl.OneNoteStrings.L_ThumbnailAltTextRich,t);default:return String.format(OneNoteIntl.OneNoteStrings.L_ThumbnailAltText,"").trimStart()}},e.prototype.doServerRequestToDownloadThumbnailImageBlob=function(t,n,r){var i=function(e){},o=function(e){};t.getParentGraphSpace().get_contentReplicator().forceOutbound((function(a){e.get_imageEditor().addImageBlobFromExternalUrl(t,n,r,o,i)}),(function(e,t){}),null)},e.get_imageEditor=function(){return e._imageEditor||(e._imageEditor=se.w.get_instance().resolve(Fb.w))},e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=se.w.get_instance().resolve(Es.p))},e.get_hyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=se.w.get_instance().resolve(Ja.o))},e.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=se.w.get_instance().resolve(Va.x))},e._imageEditor=null,e._outlineElementEditor=null,e._hyperlinkEditor=null,e._characterPropertiesEditor=null,e}();(0,o.l)(Mb,"ExternalContentEditor",null,[xb]);var Rb=function(){function e(){this._externalContentEditor=null}return e.prototype.get_externalContentEditor=function(){return this._externalContentEditor||(this._externalContentEditor=se.w.get_instance().resolve(xb))},e.prototype.postProcessHyperlink=function(e,t){this.get_externalContentEditor().insertExternalContent(e,t,!0)},e}();(0,o.l)(Rb,"PostHyperlinkAutoCorrectStrategy",null,[js]);var Lb=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.ExternalContentEmbed"},e.prototype.configure=function(e){e.register(Mb).as(xb).singleInstance().usingFactory((function(){return new Mb})),e.register(Rb).as(js).singleInstance().usingFactory((function(){return new Rb}))},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteExternalContentIsEnabled")&&N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Lb,"ExternalContentPackage",null,[l.u,c.s]);var Nb=n(3730),Bb=n(2346),Ob=n(2567),Ub=n(2734),Hb=n(3463),Gb=function(){function e(e,t,n,r,i,o,a,s){this._outlineElementEditor=null,this._characterPropertiesEditor=null,this._graphTransactionFactory=null,this._outlineEditor=null,this._paragraphEditor=null,this._selectionManager=null,this._externalSelectionManagerFuture=null,this._selectionFactory=null,this._changeIdEditor=null,this.insertedPictureResult=null,this._outlineEditor=e,this._outlineElementEditor=t,this._graphTransactionFactory=n,this._paragraphEditor=r,this._characterPropertiesEditor=i,this._selectionManager=o,this._externalSelectionManagerFuture=a,this._selectionFactory=s}return e.prototype.get_changeIdEditor=function(){return this._changeIdEditor||(this._changeIdEditor=se.w.get_instance().resolve(Am.p))},e.prototype.get_pageReader=function(){return Qc.PageReader.get_instance()},e.prototype.setImageAltTextHelper=function(e,t,n){var r=this._graphTransactionFactory.getTransaction(15);r.setFromNode(t.get_node()),this.setImageAltText(e,n),r.dispose()},e.prototype.setImageAltTextDescriptionHelper=function(e,t,n){var r=this._graphTransactionFactory.getTransaction(15);r.setFromNode(t.get_node()),this.setImageAltTextDescription(e,n),r.dispose()},e.prototype.setImageAltText=function(e,t){e.setValue(Kc.b.imageAltText,t)},e.prototype.setImageAltTextDescription=function(e,t){e.setValue(ks.j.imageAltTextDescription,t)},e.prototype.setImageHyperlink=function(e,t){e.setValue(Kc.b.hyperlinkUrl,t)},e.prototype.setImageLockAspectRatio=function(e,t){e.setValue(ks.j.imageLockAspectRatio,t)},e.prototype.setImageCroppingSizeAdjusted=function(e,t,n,r,i,o){var a=0,s=0;ka.ImageReader.getImageDimensionsUncropped(e,(0,p.m)((function(){return a}),(function(e){return a=e})),(0,p.m)((function(){return s}),(function(e){return s=e})));var l=a-a*((i+o)/1e5),c=s-s*((n+r)/1e5);this.setImageWidth(e,l),this.setImageHeight(e,c),this.setLayoutSizeSetByUser(e,!0),e.setValue(ks.j.imageCropSourceRectangleTop,n),e.setValue(ks.j.imageCropSourceRectangleBottom,r),e.setValue(ks.j.imageCropSourceRectangleLeft,i),e.setValue(ks.j.imageCropSourceRectangleRight,o)},e.prototype.setSizeHelper=function(e,t,n,r){var i=this._graphTransactionFactory.getTransaction(15);i.setFromNode(t.get_node()),this.setDimensionsProperties(e,t,n,r),i.dispose()},e.prototype.setDimensionsProperties=function(e,t,n,r){this.setImageWidth(e,n),this.setImageHeight(e,r),this.setLayoutSizeSetByUser(e,!0)},e.prototype.setImageWidth=function(e,t){e.setValue(Kc.b.layoutMaxWidth,t),e.setValue(zl.k.imageAbsoluteWidth,-1)},e.prototype.setImageHeight=function(e,t){e.setValue(Kc.b.layoutMaxHeight,t),e.setValue(zl.k.imageAbsoluteHeight,-1)},e.prototype.setJustification=function(e,t){e.setValue(ks.j.horizontalRelativePosition,t),e.setValue(Kc.b.layoutAlignmentInParent,t),e.setValue(Kc.b.layoutAlignmentSelf,t)},e.prototype.setTextWrapType=function(e,t){e.setValue(ks.j.textWrapType,t)},e.prototype.setBehindDoc=function(e,t){e.setValue(ks.j.behindDoc,t)},e.prototype.setToInline=function(e){if(!ka.ImageReader.isInlineImageContext(e)&&e.get_isGraphNodeContext()){var t=e.get_node();if(ka.ImageReader.isAnchoredImageNode(t)){var n=this._graphTransactionFactory.getTransaction(15);n.setFromNode(e.get_node());var r=Da.GraphIterator.createFromNode(t);r.tryToRootAtAncestorOfType(12);var i=r.get_parentNode(),o=i.get_properties().getProperty_Unchecked(ks.j.runIds),a=t.get_properties().getValue(Number,ks.j.runId),s=(t.getValueWithDefault(Number,ks.j.wordId,wh.z.wordIdNil),i.get_characterProperties()),l=[ks.j.horizontalRelativePosition,Kc.b.layoutAlignmentInParent,Kc.b.layoutAlignmentSelf,ks.j.behindDoc,ks.j.textWrapType,ks.j.anchorImageChangeId];t.removeProperties.apply(t,l);var c=this.getCpForRunId(a,o,s),u=_s.y.createIpContext(i,c);this._paragraphEditor.convertAnchoredImageToInline(t,u);var g=this._selectionFactory.createTextRangeOrIpSelection(i,c,c+1);g&&this._selectionManager.setSelection(g),this.get_changeIdEditor().setChangeIdOnTextRange(i,c,c+1),n.dispose()}}},e.prototype.setToAnchored=function(e,t,n,r){if(void 0===n&&(n=0),void 0===r&&(r=!1),e.get_isGraphNodeContext()){var i=this._graphTransactionFactory.getTransaction(15),o=e,a=e.get_node();if(i.setFromNode(a),ka.ImageReader.isInlineImageContext(e)){var s=new Ob.x;s.copyProperties(ka.ImageReader.getImagePropertiesFromContext(e));var l=o.get_cpBegin(),c=a.get_characterProperties(),u=this.findImageBlobIndexInCharacterPropertiesArray(l,c);this.areCommentsEnclosedInContext(o.get_cpEnd(),c,u)&&C.ULS.sendTraceTag(594392136,322,50,"[ImageEditor][SetToAnchor]Comment will be lost");var g=c.get_item(u).get_blob().get_runIndex(),p=a.get_properties().getProperty_Unchecked(ks.j.runIds),d=(p=this.reCalculateRunIds(p))[g],h=a.getValueWithDefault(Number,ks.j.wordId,wh.z.wordIdNil);this._characterPropertiesEditor.replaceTextRange(e,""),s.get_properties().setValue(ks.j.runId,d),s.get_properties().setValue(ks.j.wordId,h);var _=Da.GraphIterator.createFromNode(a);_.tryToRootAtAncestorOfType(12),_.addChild(s,6);var m=s.get_anchor().get_node().get_id();if(_.get_currentINode().get_properties().hasProperty(ks.j.anchoredObjectNodes)){var f=_.get_currentINode().get_properties().getProperty_Unchecked(ks.j.anchoredObjectNodes);Array.add(f,m),_.get_currentNode().get_properties().setValue(ks.j.anchoredObjectNodes,Array.clone(f))}else _.get_currentNode().get_properties().setValue(ks.j.anchoredObjectNodes,[m]);a=s}n&&this.setJustification(a.get_properties(),n),this.setBehindDoc(a.get_properties(),r),this.setTextWrapType(a.get_properties(),t),this.get_changeIdEditor().setChangeIdOnImageNode(a);var y=this._selectionFactory.createSelectionFromNode(a);y&&this._selectionManager.setSelection(y),i.dispose()}},e.prototype.scaleImageWidthAndHeight=function(e,t){if(t<=0)return!1;var n=Hh.y(t,0),r=ka.ImageReader.getImageWidthWithoutEffects(e),i=ka.ImageReader.getImageHeightWithoutEffects(e);return r>n&&(i*=n/r,this.setImageWidth(e,n),this.setImageHeight(e,i),C.ULS.sendTraceTag(37843205,322,50,"Scale image width and height to fit constraining width {0} : ",t),!0)},e.prototype.areCommentsEnclosedInContext=function(e,t,n){var r=t.get_length();if(n>=r||!t.get_item(n).get_commentRangeObjects())return!1;for(var i=new bg.f(Dt.h),o=n;o<r;o++){var a=t.get_item(o);if(a.get_cp()>e||!a.get_commentRangeObjects())break;for(var s=0;s<a.get_commentRangeObjects().get_length();s++){if(i.contains(a.get_commentRangeObjects().get_item(s).get_commentObjectId()))return!0;i.add(a.get_commentRangeObjects().get_item(s).get_commentObjectId())}}return!1},e.prototype.reCalculateRunIds=function(e){for(var t=0;t<e.length&&!e[t];)t++;if(t===e.length)for(var n=0;n<e.length;)e[n]=n+1,n++;else{for(var r=e[t],i=(n=t-1,r-1);n>=0;)e[n]=i,n--,i--;var o=0,a=r;for(n=t+1;n<e.length;){var s=e[n];s?s<a?(a=s+o,e[n]=a):a=s:(o+=2,a++,e[n]=a),n++}}return e},e.prototype.findRunIndexInRunIdsForRunId=function(e,t){for(var n=0;n<t.length&&!(e<t[n]);)n++;return n},e.prototype.getCpForRunId=function(e,t,n){var r=0,i=this.findRunIndexInRunIdsForRunId(e,t),o=0;if(i===t.length)o=n.get_length()-1;else for(;o<n.get_length();){var a=n.get_item(o);if(a.get_formatting()&&a.get_formatting().runIndex===i)break;o++}o<n.get_length()?r=n.get_item(o).get_cp():C.ULS.sendTraceTag(21248159,322,15,"GetCpForRunId index out of bound. {0}",{Index:o,RunId:e,CharacterPropertiesArrayLength:n.get_length()});return r},e.prototype.findImageBlobIndexInCharacterPropertiesArray=function(e,t){for(var n=0;n<t.get_length();){if(t.get_item(n).get_cp()===e)break;n++}return n===t.get_length()&&C.ULS.sendTraceTag(21248160,322,15,"FindImageBlobIndexInCharacterPropertiesArray index out of bound. {0}",{Index:n,CharacterPropertiesArrayLength:t.get_length()}),n},e.prototype.setLayoutSizeSetByUser=function(e,t){e.setValue(Kc.b.isLayoutSizeSetByUser,t)},e.prototype.onFloatingImageChangeToNormal=function(e){},e.prototype.setNewFileDataObjectId=function(e){var t=new Dt.h(ae.l.create(),1);e.setValue(py.w.objectDataBlobId,t.toString()),e.setValue(qc.o.fileDataObject,t.guid)},e.prototype.preparePlaceholderForImageUpload=function(e,t,n,r){var i,o;void 0===r&&(r=!1),t&&n?(i=Math.max(t,Hb.n.minImagePlaceholderSize),o=Math.max(n,Hb.n.minImagePlaceholderSize)):(i=Hb.n.defaultImagePlaceholderSize,o=Hb.n.defaultImagePlaceholderSize),e.setValue(Kc.b.layoutMaxWidth,Hh.y(i,0)),e.setValue(Kc.b.layoutMaxHeight,Hh.y(o,1)),e.setValue(Kc.b.imageAltText,Box4Intl.Box4Strings.l_PastedImageLoading),e.setValue(qc.o.imageUploadState,1),e.setValue(ks.j.isImageFromPaste,r)},e.prototype.insertPictureBlock=function(e,t){return null},e.prototype.insertPictureInline=function(e,t){return null},e.prototype.doInsertPicture=function(e,t,n){var r=null,i=this.doInsertPictureWithoutSelectionSet(e,t,n,(0,p.m)((function(){return r}),(function(e){return r=e})));return r&&e.view.get_selectionManager().setSelection(r),i},e.prototype.doInsertPictureWithoutSelectionSet=function(t,n,r,i){if(i.val=null,!this.canInsertPictureInContext(t))return null;var a=t.view,s=this._graphTransactionFactory.getTransaction(15,ii.us);s.setFromNode(a.get_targetNode()),n||(n=new Kl.DictionaryPropertySet),n.setValue(zl.k.dontPrompt,!0);var l=a.get_selectionManager().get_selectionContextForActionDispatch(),c=new Gf.d;if(Pa.SelectionEditor.isInsertionPointContext(l)){if(l.get_isGraphNodeContext()&&cs.ParagraphReader.isParagraphNode(l.get_node())){us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(l.get_node());var u=Ps.FormattingReader.getFormattingObject(l);u.get_cache().get_isLink()&&(u=u.cloneUnderDifferentChp(null),e.get_formattingEditor().removeLinkFormatting(u)),c.formatting=u.get_formattingId(),c.languageId=Ps.FormattingReader.language(u),us.n.get_instance().get_item(71)&&(c.style=Tc.StyleReader.getStyleFromParagraphNode(l.get_node()))}}else{if(2===L.AFrameworkApplication.get_theActionManager().processAction(ii.kl,2))return s.dispose(),null;l=a.get_selectionManager().get_selectionContextForActionDispatch()}if(!l.get_isGraphNodeContext())return s.dispose(),null;if(!this.insertPictureInContext(t.get_nextContext(),n))return s.dispose(),this.insertedPictureResult=null,null;var g=this.insertedPictureResult;if(this.insertedPictureResult=null,1===g.location){var p=g.node,d=zc.q.get_instance().getTraversableIteratorAtOutlineElement(p);if(hs.OutlineElementNavigator.moveToNextOutlineElement(d,!1,!1)||(Sc.returnToOutlineOrTableCell(d),this._outlineEditor.appendOutlineElement(d,!0,c)),hs.OutlineElementNavigator.moveToContent(d),dc.TableReader.isTable(d)){if(o.r(Pm.z,d)||o.r(Ub.u,d)){var h=new Da.GraphIterator;h.set(d.get_currentNode()),ld.moveToCellContent(h,0,0),d.set(h.get_currentNode())}else ld.moveToCellContent(d,0,0);Ls.OutlineElementReader.isOutlineElement(d)?hs.OutlineElementNavigator.moveToContent(d):d=zc.q.get_instance().getTraversableIteratorAtOutlineElement(p)}cs.ParagraphReader.canContainIpOrTextRange(d.get_currentNode())?i.val=this._selectionFactory.createIpSelection(d.get_currentNode(),0):i.val=this._selectionFactory.createSelectionFromNode(d.get_currentNode())}else if(!g.location){var _=g.blob.get_containingProperties().get_cp()+1;i.val=this._selectionFactory.createTextRangeOrIpSelection(g.node,_-1,_)}return s.makeIncrementalAction(r,1),s.dispose(),g},e.prototype.insertPictureInContext=function(e,t){return!1},e.prototype.canInsertPictureInContext=function(t){if(t.get_contextId()===cl.n&&t.view.get_isInteractiveView()&&t.view.get_selectionManager()&&(t=t.view.get_selectionManager().get_selectionContextForActionDispatch()),!t)return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.noSelection}),!1;if(us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().contextSetContainsLockedRange(t))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsLockedRange}),!1;if(this._externalSelectionManagerFuture&&this._externalSelectionManagerFuture.get_instance()&&this._externalSelectionManagerFuture.get_instance().isExternalSelectionContext(t))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.externalSelection}),!1;if(us.n.get_instance().get_item(51)&&this.get_pageReader().get_isCompatMode())return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.compatMode}),!1;if(t.get_isGraphNodeContext())return Hr.l(t)?(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsTitle}),!1):vc.isOutlineContext(t)?(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsOutline}),!1):ka.ImageReader.isFloatingImageContext(t)?(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsFloatingImage}),!1):gy.v(t)?(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsFloatingInk}),!1):!kC.isFloatingIFrameContext(t)||(e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsFloatingIFrame}),!1);if(Bb.u.isMultiRangeContext(t)){for(var n=t,r=0;r<n.get_length();++r){var i=n.getContext(r);if(!i.get_isGraphNodeContext())return!1;if(Hr.l(i))return e.get_activityManager().recordEvent(D_.f.noExecute,{Reason:M_.i.containsTitle}),!1}return!0}return!1},e.prototype.removePicture=function(e,t){var n=this._graphTransactionFactory.getTransaction(7);if(n.setFromNode(e),12===e.get_type()){var r=t.get_containingProperties().get_cp(),i=r+1===cs.ParagraphReader.textLength(e),o=_s.y.createContextFromCpResult(r,r+1,i,e);this._characterPropertiesEditor.replaceTextRange(o,"");var a=_s.y.createIpContext(e,r);this._selectionManager.setSelection(ss.SelectionFactory.createSelectionFromContext(a))}else this._outlineElementEditor.removeContainingOutlineElement(e);n.dispose()},e.get_formattingEditor=function(){return e._formattingEditor||(e._formattingEditor=se.w.get_instance().resolve(xs.z))},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_activityManager=function(){return ji.y.get_instance()},e._formattingEditor=null,e}();(0,o.l)(Gb,"ImageEditor$0",null,[rl.w]);var Vb=n(5783),Wb=n(4675),zb=function(e){function t(){var t=e.call(this)||this;return t.ThumbnailUrl=null,t.AltText=null,t.DesiredRevisionIncrement=0,t.ContentNodes=null,t}return(0,S.t)(t,e),t.prototype.getClassId=function(){return 51},t.constructRequest=function(e,n,r,i,o,a,s,l,c,u,g,p,d,h,_){var m=(0,O.m)(new t,{ImageId:e,ObjectDataBlobId:null,lcid:n,CellId:r,FileId:i,BaseRevisionId:o,Knowledge:a,DesiredRevisionId:s,ClassId:c,access_token:u,w:d,h:h,ThumbnailUrl:g,AltText:p,DesiredRevisionIncrement:l});m.ContentNodes=new Array(0);for(var f=0,y=_;f<y.length;f++){var C=y[f];m.ContentNodes.push(Wb.w(C))}return m},t}(Vb.u);(0,o.l)(zb,"ExternalContentFetchThumbnailRequest",Vb.u,[]);var Kb=function(e){function t(t,n,r,i,o,a,s,l){return e.call(this,t,n,r,i,o,a,s,l)||this}return(0,S.t)(t,e),t.prototype.setJustification=function(e,t){e.setValue(Kc.b.layoutAlignmentInParent,t),e.setValue(Kc.b.layoutAlignmentSelf,t)},t.prototype.onFloatingImageChangeToNormal=function(e){e.removeProperties(Kc.b.offsetFromParentHoriz,Kc.b.offsetFromParentVert)},t.prototype.insertPictureBlock=function(e,t){var n=this._outlineElementEditor.createImage(e);return t&&n.copyProperties(t),new Ah(n,null,1)},t.prototype.insertPictureInContext=function(e,t){if(!this.canInsertPictureInContext(e))return!1;var n,r=e,i=this._graphTransactionFactory.getTransaction(7);return i.setFromNode(r.get_node()),ka.ImageReader.isImageContext(e)?((n=new Da.GraphIterator).set(e.get_node()),n.tryToRootAtAncestorOfType(10),hs.OutlineElementNavigator.returnToOutlineElement(n),this._outlineElementEditor.insertOutlineElementAsSibling(n,!0,!1)):n=this._outlineElementEditor.insertOutlineElementAt(e),this.insertedPictureResult=this.insertPictureBlock(n,t),i.dispose(),!0},t.prototype.insertPictureFromUrl=function(e,t,n,r,i,o){var a=this,s=this.insertPictureBlock(e,t);return s.node.getParentGraphSpace().get_contentReplicator().forceOutbound((function(e){a.addImageBlobFromExternalUrl(s.node,n,r,i,o)}),(function(e,t){o&&o(t)}),null),s},t.prototype.addImageBlobFromExternalUrl=function(e,t,n,r,i){if(e&&e.get_isConnected()&&ka.ImageReader.isImageNode(e)){var o=e.getParentGraphSpace(),a=e.getValue(Array,Kc.b.contentNodes),s=zb.constructRequest(e.get_id().toString(),L.AFrameworkApplication.lcid.toString(),o.get_objectSpaceId().toString(),o.get_fileQuerySignature(),o.get_contentReplicator().get_lastReplicated().toString(),o.get_contentReplicator().get_knowledge(),n.toString(),1,e.get_runtimeClassId().toString(),L.AFrameworkApplication.get_accessToken(),t,e.getValue(String,Kc.b.imageAltText),Hh.E(e.getValue(Number,Kc.b.layoutMaxWidth),0),Hh.E(e.getValue(Number,Kc.b.layoutMaxHeight),1),a),l={"Content-Type":"application/json; charset=utf-8"},c=Eb.y(s),u=function(t){r&&r(e)},g=function(e,t){i&&i(t)};L.AFrameworkApplication.theClientRequestManager.addRequest(Br.App.webServiceBase+"OneNote.ashx",2,c,l,!1,2,(function(e){o.get_contentReplicator().forceInbound(u,g,null)}),(function(e){i&&i(27)}),s)}else i&&i(122)},t}(Gb);(0,o.l)(Kb,"ImageEditor",Gb,[Fb.w,rl.w]);var qb=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.ImageEditors"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ImageEditorsDelayInitializationEnabled")&&function(e){e.register(Kb).as(Fb.w).as(rl.w).singleInstance().usingFactory((function(){return new Kb(e.resolve(rc.a),e.resolve(Es.p),e.resolve(Vd.c),e.resolve(gc.g),e.resolve(Va.x),e.resolve(Nb.l),e.resolveFuture(gh.i),e.resolve(Ad))}))}(e)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(qb,"OneNoteImageEditorsPackage",null,[l.u,c.s]);var jb=n(5258),$b=(0,o.y)("IInkThicknessUIBuilder"),Qb=n(2439),Jb=function(){function e(e,t,n,r){this.xOffset=0,this.yOffset=0,this.pressureOffset=null,this.pressureMaxValue=null,this.xOffset=e,this.yOffset=t,this.pressureOffset=n,this.pressureMaxValue=r}return e.prototype.get_xOffset=function(){return this.xOffset},e.prototype.get_yOffset=function(){return this.yOffset},e.prototype.get_pressureOffset=function(){return this.pressureOffset},e.prototype.get_pressureMaxValue=function(){return this.pressureMaxValue},e}();(0,o.l)(Jb,"PacketDimensionProperties",null,[]);var Xb=n(7549),Yb=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g){this.packetDescriptions=null,this.isFormatValid=!1,this.dimensionAttributes=null,this.format=null,this.inkDrawingHeight=0,this.inkDrawingWidth=0,this.inkColor=0,this.inkPropertiesObjectId=null,this.penTip=0,this.transparency=0,this.rasterOperation=0,this.ignorePressure=!1,this.antiAliased=!1,this.fitToCurve=!1,this.customProperties=null,this.packetDescriptions=e,this.inkDrawingHeight=t,this.inkDrawingWidth=n,this.inkColor=r,this.inkPropertiesObjectId=i,this.penTip=o,this.transparency=a,this.rasterOperation=s,this.ignorePressure=l,this.antiAliased=c,this.fitToCurve=u,this.format=new y.c(String);for(var p=e.$$ge();p.$$mn();){var d=p.$$cu();this.get_format().add(d.get_format())}this.calculatePacketDimensionProperties(),this.customProperties=g}return e.prototype.get_packetDescriptions=function(){return this.packetDescriptions},e.prototype.get_isFormatValid=function(){return this.isFormatValid},e.prototype.get_dimensionAttributes=function(){return this.dimensionAttributes},e.prototype.get_format=function(){return this.format},e.prototype.get_inkDrawingHeight=function(){return this.inkDrawingHeight},e.prototype.get_inkDrawingWidth=function(){return this.inkDrawingWidth},e.prototype.get_inkColor=function(){return this.inkColor},e.prototype.get_penTip=function(){return this.penTip},e.prototype.get_transparency=function(){return this.transparency},e.prototype.get_rasterOperation=function(){return this.rasterOperation},e.prototype.get_ignorePressure=function(){return this.ignorePressure},e.prototype.get_antiAliased=function(){return this.antiAliased},e.prototype.get_fitToCurve=function(){return this.fitToCurve},e.prototype.get_customProperties=function(){return this.customProperties},e.prototype.calculatePacketDimensionProperties=function(){this.dimensionAttributes=e.calculatePacketDimensionProperties(this.get_packetDescriptions()),this.isFormatValid=!!this.get_dimensionAttributes()},e.calculatePacketDimensionProperties=function(e){for(var t=-1,n=-1,r=null,i=null,o=0;o<e.get_count();o++){var a=e.get_item(o);Jn.l.toLower(a.get_format())===Xb.s.xLowerCaseCoordinateGuid&&(t=o),Jn.l.toLower(a.get_format())===Xb.s.yLowerCaseCoordinateGuid&&(n=o),Jn.l.toLower(a.get_format())===Xb.s.pressureLowerCaseCoordinateGuid&&(r=o,i=a.get_max())}if(-1===t||-1===n){var s=new Sys.StringBuilder;for(o=0;o<e.get_count();o++){a=e.get_item(o);s.append(a.toString()+",")}return C.ULS.sendTraceTag(17098841,339,10,"Found invalid format guids in inkProperties. {0}",s.toString()),null}return new Jb(t,n,r,i)},e.defaultInkDrawingHeightValue=1,e.defaultInkDrawingWidthValue=53,e.defaultInkColorValue=0,e.defaultPenTipValue=0,e.defaultTransparencyValue=0,e.defaultRasterOpValue=13,e.defaultIgnorePressueValue=!1,e.defaultAntiAliasedValue=!0,e.defaultFitToCurveValue=!1,e}();(0,o.l)(Yb,"InkProperties",null,[]);var Zb=function(e,t){if(!t)return"";e||(e="");for(var n=new Sys.StringBuilder,r=0;r<t.length;r++)n.append(t[r]),r<t.length-1&&n.append(e);return n.toString()},eT=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g,p){this.data=null,this.isDataInAbsoluteCoordinates=!1,this.inkStrokeObjectId=null,this.lcid=0,this.strokeBias=0,this.isHighlighter=!1,this.inkProperties=null,this.customProperties=null,this.scaleX=0,this.scaleY=0,this.dx=0,this.dy=0,this.parentInkNodeId=null,this.inkStrokeObjectId=e,this.parentInkNodeId=t,this.lcid=r,this.strokeBias=i,this.isHighlighter=o,this.inkProperties=a,this.data=n,this.scaleX=s,this.scaleY=l,this.dx=c,this.dy=u,this.isDataInAbsoluteCoordinates=g,this.customProperties=p}return e.prototype.get_lcid=function(){return this.lcid},e.prototype.get_strokeBias=function(){return this.strokeBias},e.prototype.get_isHighlighter=function(){return this.isHighlighter},e.prototype.get_inkProperties=function(){return this.inkProperties},e.prototype.get_customProperties=function(){return this.customProperties},e.prototype.get_hasData=function(){return this.data.length>0},e.prototype.toString=function(){return String.format("Stroke, Bias: {0}, IsHighlighter: {1}, Lcid: {2}, HasPressure: {3}, IsDataInAbsoluteCoordinates:{4} Packet: [{5}]",this.get_strokeBias(),this.get_isHighlighter(),this.get_lcid(),this.get_inkProperties().get_packetDescriptions().get_count()>2,this.isDataInAbsoluteCoordinates,Zb(",",this.data))},e.prototype.get_scaleX=function(){return this.scaleX},e.prototype.get_scaleY=function(){return this.scaleY},e.prototype.get_dx=function(){return this.dx},e.prototype.get_dy=function(){return this.dy},e.strokeBiasInvalidValue=42,e.inkMinTransparencyValue=0,e}();(0,o.l)(eT,"InkStroke",null,[]);var tT=function(e,t){var n,r,i=(0,f.e)(Pc.b,Qb.c.get_instance().createInstance(1179720));!function(e,t){if(null!==e&&t){for(var n=new Sys.StringBuilder("["),r=0;r<t.get_count();r++)n.append(t.get_item(r).toString()),r!==t.get_count()-1&&n.append(",");n.append("]"),e.setValue(qc.o.inkPacketDescription,n.toString())}}(i,t.get_packetDescriptions()),n=i,r=t.get_inkDrawingHeight(),null!==n&&(r===Yb.defaultInkDrawingHeightValue?C.ULS.sendTraceTag(17098777,339,100,"Stroke height property will not be set because the default value {0} was specified",r):n.setValue(qc.o.inkDrawingAttrib_Height,r)),function(e,t){null!==e&&(t===Yb.defaultInkDrawingWidthValue?C.ULS.sendTraceTag(17098780,339,100,"Stroke width property will not be set because the default value {0} was specified",t):e.setValue(qc.o.inkDrawingAttrib_Width,t))}(i,t.get_inkDrawingWidth()),function(e,t){null!==e&&(t===Yb.defaultInkColorValue?C.ULS.sendTraceTag(17098783,339,100,"Stroke color property will not be set because the default value {0} was specified",t):e.setValue(qc.o.inkDrawingAttrib_Color,t))}(i,t.get_inkColor()),function(e,t){null!==e&&(t===Yb.defaultPenTipValue?C.ULS.sendTraceTag(17098786,339,100,"Stroke penTip property will not be set because the default value {0} was specified",t):e.setValue(qc.o.inkDrawingAttrib_PenTip,t))}(i,t.get_penTip()),function(e,t){null!==e&&(t===Yb.defaultTransparencyValue?C.ULS.sendTraceTag(17098817,339,100,"Stroke transparency property will not be set because the default value {0} was specified",t):e.setValue(qc.o.inkDrawingAttrib_Transparency,t))}(i,t.get_transparency()),function(e,t){null!==e&&(t===Yb.defaultRasterOpValue?C.ULS.sendTraceTag(17098820,339,100,"Stroke rasterOperation property will not be set because the default value {0} was specified",t):e.setValue(qc.o.inkDrawingAttrib_RasterOperation,t))}(i,t.get_rasterOperation()),function(e,t){null!==e&&(t===Yb.defaultIgnorePressueValue?C.ULS.sendTraceTag(17098823,339,100,"Stroke ignorePressure property will not be set because the default value {0} was specified",t):e.setValue(qc.o.inkDrawingAttrib_IgnorePressure,t))}(i,t.get_ignorePressure()),function(e,t){null!==e&&(t===Yb.defaultAntiAliasedValue?C.ULS.sendTraceTag(17098826,339,100,"Stroke antiAliased property will not be set because the default value {0} was specified",t):e.setValue(qc.o.inkDrawingAttrib_AntiAliased,t))}(i,t.get_antiAliased()),function(e,t){null!==e&&(t===Yb.defaultFitToCurveValue?C.ULS.sendTraceTag(17098829,339,100,"Stroke fitToCurve property will not be set because the default value {0} was specified",t):e.setValue(qc.o.inkDrawingAttrib_FitToCurve,t))}(i,t.get_fitToCurve()),t.inkPropertiesObjectId!==Dt.h.get_nil()?e.registerObject(i,t.inkPropertiesObjectId):(i=e.registerSharedObject(i),t.inkPropertiesObjectId=i.get_id()),C.ULS.sendTraceTag(17098837,339,100,"Registered a new Stroke14PropertiesObject with ObjectId {0}",t.inkPropertiesObjectId)},nT=function(e,t){rT(e,t);var n=(0,f.e)(Pc.b,Qb.c.get_instance().createInstance(131131));return function(e,t){e&&e.setValue(qc.o.ink14Strokes,t)}(n,[t.inkStrokeObjectId]),e.registerObject(n)},rT=function(e,t){var n=(0,f.e)(Pc.b,Qb.c.get_instance().createInstance(131143));if(n){!function(e,t){e&&t&&e.setValue(qc.o.inkPacketDataCompressed,"["+Zb(",",t)+"]")}(n,t.data),n.setValue(qc.o.inkExtendedProp_Lid,t.get_lcid());var r=t.get_strokeBias();-1===t.get_strokeBias()&&(r=eT.strokeBiasInvalidValue),n.setValue(qc.o.inkExtendedProp_StrokeBasis,r),function(e,t){e&&t&&e.setValue(qc.o.inkStrokeProperties,t)}(n,t.get_inkProperties().inkPropertiesObjectId),t.inkStrokeObjectId!==Dt.h.get_nil()?e.registerObject(n,t.inkStrokeObjectId):t.inkStrokeObjectId=e.registerObject(n),C.ULS.sendTraceTag(17098839,339,100,"Registered a new Stroke14Object with ObjectId {0}",t.inkStrokeObjectId)}},iT=function(e,t){var n=new Array(e.length),r=t.get_count();if(e.length%t.get_count())return C.ULS.sendTraceTag(17098846,339,10,"Invalid packet description length!"),[];for(var i=e.length/r,o=0;o<r;o++){n[o*i]=e[o];for(var a=n[o*i],s=1;s<i;s++){var l=e[s*r+o];n[s+o*i]=l-a,a=l}}return n},oT=function(){function e(e,t,n,r,i){this.format=null,this.max=0,this.min=0,this.units=0,this.resolution=0,this.format=e,this.max=n,this.min=t,this.units=r,this.resolution=i}return e.prototype.get_format=function(){return this.format},e.prototype.get_max=function(){return this.max},e.prototype.get_min=function(){return this.min},e.prototype.get_units=function(){return this.units},e.prototype.get_resolution=function(){return this.resolution},e.prototype.toString=function(){return String.format('["{0}",{1},{2},{3},{4}]',this.get_format(),this.get_min().toString(),this.get_max().toString(),this.get_units().toString(),this.get_resolution())},e.prototype.logUnexpectedPacketDescriptionValues=function(){Jn.l.toLower(this.get_format())===Xb.s.xLowerCaseCoordinateGuid||Jn.l.toLower(this.get_format())===Xb.s.yLowerCaseCoordinateGuid?(this.get_resolution()!==e.expectedXAndYResolutionInHimetric&&C.ULS.sendTraceTag(17098848,339,10,"Unexpected resolution in {0} dimension: expected:{1} actual:{2}",this.get_format(),e.expectedXAndYResolutionInHimetric,this.get_resolution()),2!==this.get_units()&&C.ULS.sendTraceTag(17098850,339,10,"Unexpected units in {0} dimension: expected:{1} actual:{2}",this.get_format(),2,this.get_units())):this.get_format()===Xb.s.pressureLowerCaseCoordinateGuid?this.get_max()!==e.expectedPressureMaxValue&&C.ULS.sendTraceTag(17098880,339,10,"Unexpected Max in pressure dimension: expected:{0} actual:{1}",e.expectedPressureMaxValue,this.get_max()):C.ULS.sendTraceTag(17098882,339,15,"Unexpected dimension: {0}",this.get_format())},e.get_xPacketDescription=function(){return new e(Xb.s.xLowerCaseCoordinateGuid,e.int32MinValue,e.int32MaxValue,2,1e3)},e.get_yPacketDescription=function(){return new e(Xb.s.yLowerCaseCoordinateGuid,e.int32MinValue,e.int32MaxValue,2,1e3)},e.get_pressurePacketDescription=function(){return new e(Xb.s.pressureLowerCaseCoordinateGuid,0,32767,0,0)},e.int32MinValue=-2147483648,e.int32MaxValue=2147483647,e.expectedXAndYResolutionInHimetric=1e3,e.expectedPressureMaxValue=32767,e}();(0,o.l)(oT,"PacketDescription",null,[]);var aT=function(){function e(){}return e.prototype.createAndRegisterInkNode=function(t,n){C.ULS.sendTraceTag(17098773,339,50,"InkEditor: Creating a new ink stroke");var r=e.getPacketDescriptionFromInkStrokeParameters(n),i=n.properties.isHighlighter?9:0,o=new Yb(r,n.properties.strokeDimensions.strokeHeight,n.properties.strokeDimensions.strokeWidth,n.properties.inkColor,Dt.h.get_nil(),n.properties.penTip,n.properties.transparency,i,!1,!0,!0,null);tT(t.get_containingObjectSpace(),o);var a,s=new eT(Dt.h.get_nil(),Dt.h.get_nil(),n.oneNoteCoordinates,0,2,!1,o,1,1,0,0,!0,null);(a=s).isDataInAbsoluteCoordinates&&(a.data=iT(a.data,a.get_inkProperties().get_packetDescriptions()),a.isDataInAbsoluteCoordinates=!1);var l=function(e,t){var n=nT(e,t),r=(0,f.e)(Wf.k,Qb.c.get_instance().createInstance(393236));return r&&(r.setValue(qc.o.ink14,n),r.setValue(Kc.b.scaleFactorX,t.get_scaleX()),r.setValue(Kc.b.scaleFactorY,t.get_scaleY()),r.setValue(Kc.b.offsetFromParentHoriz,t.get_dx()),r.setValue(Kc.b.offsetFromParentVert,t.get_dy())),r}(t.get_containingObjectSpace(),s),c=new Da.GraphIterator;return c.set(t),c.addChild(l,1),l},e.getPacketDescriptionFromInkStrokeParameters=function(e){if(e.properties.hasPressure){var t=void 0;return(t=new y.c(oT)).add(oT.get_xPacketDescription()),t.add(oT.get_yPacketDescription()),t.add(oT.get_pressurePacketDescription()),t}var n=void 0;return(n=new y.c(oT)).add(oT.get_xPacketDescription()),n.add(oT.get_yPacketDescription()),n},e}();(0,o.l)(aT,"InkEditor",null,[jb.y]);var sT=n(2529),lT=n(7632),cT=n(8979),uT=function(){function e(){}return e.prototype.buildInkThicknessProps=function(){return this.getInkThicknessDropdownProperties()},e.prototype.buildInkThicknessXml=function(){return this.getInkThicknessDropDownXml()},e.prototype.getInkThicknessDropDownXml=function(){var e=this.getInkThicknessDropdownProperties();return e?Tu.gu(e):""},e.prototype.getInkThicknessDropdownProperties=function(){var e=(0,O.m)(new ga.b,{Id:"menuInkThicknessDropDown",MenuSectionList:[]});return Array.add(e.MenuSectionList,this.getInkThicknessPositions()),e},e.prototype.getInkThicknessPositions=function(){for(var e=(0,O.m)(new pa.x,{Id:"msInkThicknessPosition",ShowMenuSectionSeparator:!1,ControlList:[]}),t=(0,O.m)(new hp.b,{Type:2,Id:"galleryInkThicknessPosition",ExternalId:"InkThickness",ExternalGalleryId:"InkThicknessGallery",Width:1,ElementDimensions:"Size85by16",GalleryItems:new Array(0)}),n=sT.k.getUIThicknessOptionCount(),r=lT.u.getCurrentInkColorCss(),i=0;i<n;i++)Array.add(t.GalleryItems,this.getGalleryButtonForInkThickness(i,r));return Array.add(e.ControlList,t),e},e.prototype.getGalleryButtonForInkThickness=function(e,t){var n=sT.k.getUIOptionForIndex(e),r="",i="";n&&(r=3===Wr.App.oneNoteInputMode?n.highlighterDimensions.getMillimetersForCaption():n.penDimensions.getMillimetersForCaption(),i=n.getGalleryHeightPixels());var o=(0,O.m)(new cT.n,{Id:String.format("{0}_{1}","ThicknessOption",e),Command:"737662428",QueryCommand:"2890613869",Alt:r});return L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?(o.Style=this.getCssStyleDictionaryForGalleryButton(i,t),o.LabelText=r):o.InnerHTML=Jn.l.xmlEncode(this.getInnerHtmlForGalleryButton(i,t)),o},e.prototype.getCssStyleDictionaryForGalleryButton=function(e,t){var n={};"#ffffff"===Jn.l.toLower(t)&&(t="#000000");var r,i=0;return Jn.l.parseNumberAndUnitsFromString(e,[7],L.AFrameworkApplication.get_numberFormat(),(0,p.m)((function(){return i}),(function(e){return i=e})),(0,p.m)((function(){return r}),(function(e){return r=e}))),i<1&&(e="1px"),n.height=e,n["background-color"]=t,n["font-size"]="0px",n.position="absolute",n.left="0",n},e.prototype.getInnerHtmlForGalleryButton=function(e,t){"#ffffff"===Jn.l.toLower(t)&&(t="#000000");return String.format('<div class="InkThicknessOuterDiv"><div class="InkThicknessMiddleDiv"><div class="InkThicknessInnerDiv"><div class="InkThicknessDiv" style="height:{0}; background-color:{1}"></div></div></div></div>',e,t)},e}();(0,o.l)(uT,"InkThicknessUIBuilder",null,[$b]);var gT=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.InkEditors"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInkInputEnabled")&&(e.register(aT).as(jb.y).singleInstance().usingFactory((function(){return new aT})),e.register(uT).as($b).singleInstance().usingFactory((function(){return new uT})))},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(gT,"OneNoteInkEditorsPackage",null,[l.u,c.s]);var pT=n(5201),dT=n(3261),hT=n(8605),_T=n(2300),mT=function(){function e(){}return e.base62Chars="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",e.base16Chars="0123456789abcdef",e.wacData="wd=",e.endField="&",e.seperator="-",e.guidLength=32,e}();(0,o.l)(mT,"HashedInternalLinkConstants",null,[]);var fT=function(){function e(){this.url=null,this.isRelativeLink=!1,this.isInternalLink=!1,this.decomposeSuccess=!1,this.protocol=null,this.sectionGroup=null,this.sectionName=null,this.sectionId=null,this.pageName=null,this.pageId=null,this.basePath=null,this.preserveLink=!1,this.url="",this.isRelativeLink=!1,this.isInternalLink=!1,this.decomposeSuccess=!1,this.protocol="",this.sectionGroup=null,this.sectionName="",this.sectionId="",this.pageName="",this.pageId="",this.basePath="",this.preserveLink=!1}return e.pageInSection=function(t,n){t.pageId=e.base16Base62Converter(n[n.length-1],mT.base62Chars,mT.base16Chars),t.pageName=unescape(n[n.length-2])},e.sectionInNotebook=function(t,n){t.sectionId=e.base16Base62Converter(n[n.length-1],mT.base62Chars,mT.base16Chars),t.sectionName=unescape(n[n.length-2])},e.pageInNotebook=function(t,n){t.pageId=e.base16Base62Converter(n[n.length-1],mT.base62Chars,mT.base16Chars),t.sectionId=e.base16Base62Converter(n[n.length-2],mT.base62Chars,mT.base16Chars),t.pageName=unescape(n[n.length-3]),t.sectionName=unescape(n[n.length-4])},e.sectionWithSgInNotebook=function(t,n){t.sectionId=e.base16Base62Converter(n[n.length-1],mT.base62Chars,mT.base16Chars),t.sectionName=unescape(n[n.length-2]),t.sectionGroup=[];for(var r=0;n.length-3-r>=0;)Array.insert(t.sectionGroup,r,unescape(n[n.length-3-r])),r++;t.sectionGroup.reverse()},e.pageWithSgInNotebook=function(t,n){t.pageId=e.base16Base62Converter(n[n.length-1],mT.base62Chars,mT.base16Chars),t.sectionId=e.base16Base62Converter(n[n.length-2],mT.base62Chars,mT.base16Chars),t.pageName=unescape(n[n.length-3]),t.sectionName=unescape(n[n.length-4]),t.sectionGroup=[];for(var r=0;n.length-5-r>=0;)Array.insert(t.sectionGroup,r,unescape(n[n.length-5-r])),r++;t.sectionGroup.reverse()},e.base16Base62Converter=function(e,t,n){var r=null;if(n===mT.base62Chars)(r=e.split("-")).length;else if(n===mT.base16Chars){r=[e.substring(0,6),e.substring(6,9),e.substring(9,12),e.substring(12,15),e.substring(15,24)]}for(var i=t.length,o=n.length,a=new Sys.StringBuilder,s=0;s<5;s++){for(var l=0,c=r[s].length,u=0;u<c;u++)l=l*i+t.indexOf(r[s].charAt(u));if(l<0)return"0";for(var g=l%o,p=n.charAt(g),d=Math.floor(l/o);d;)g=d%o,d=Math.floor(d/o),p=n.charAt(g)+p;n===mT.base62Chars?(5!==p.length&&8!==p.length&&2!==p.length||(p="0"+p),a.append(p)):n===mT.base16Chars&&(7!==p.length&&3!==p.length&&11!==p.length||(p="0"+p),a.append(p),4!==s&&a.append("-"))}return a.toString()},e}();(0,o.l)(fT,"HyperlinkData",null,[]);var yT=function(){function e(){}return e.prototype.getInternalUrl=function(t){for(var n=[];t&&t!==Br.App.theNotebookManager.get_mainGraphRoot()&&(Br.App.notebookMode||!_T.d(t));)Array.add(n,t),t=t.getParentGraphSpace();for(var r=new Sys.StringBuilder,i=null,o=null,a=!0,s=n.length-1;s>-1;s--){a=!0;var l=n[s];if(hT.FolderReader.isSectionGroupNode(l)){var c=this.formatForURL(Hs.HyperlinkReader.onenoteCharEscape(hT.FolderReader.getTitle(l)));r.append(c)}else if(_T.d(l)){var u=_T.I(l);u||(u=Box4Intl.Box4Strings.l_UntitledSection),u=this.formatForURL(Hs.HyperlinkReader.onenoteCharEscape(u)),r.append(u);var g=new Da.GraphIterator;g.set(l),g.tryToRootAtAncestorOfType(4),g.returnToAncestorOfType(4)&&g.get_currentNode().get_properties().hasProperty(py.w.fileIdentityGuid)&&(i=g.get_currentNode().get_properties().getValue(String,py.w.fileIdentityGuid))}else if(e.get_pageReader().isPageNode(l)){var p=Hs.HyperlinkReader.getFriendlyPageTitle(e.get_pageReader().getTitle(l));p=this.formatForURL(Hs.HyperlinkReader.onenoteCharEscape(p)),r.append(p),o=e.get_pageReader().getNotebookManagementEntityId(l).toString()}else e.get_pageReader().isVersionHistoryNode(l)?r.append(e.get_pageReader().versionHistoryContext.toString()):e.get_pageReader().isVersionNode(l)?r.append(l.get_contextId().toString()):e.get_pageReader().isConflictPageNode(l)?r.append(l.get_objectSpaceId().toString()):a=!1;a&&r.append("-")}var d=this.encodeIds(i,o);return r.append(d),r.toString()},e.prototype.buildTargetArgHash=function(t){for(var n=[];t&&t!==Br.App.theNotebookManager.get_mainGraphRoot()&&(Br.App.notebookMode||!_T.d(t));)Array.add(n,t),t=t.getParentGraphSpace();for(var r=new Sys.StringBuilder,i=null,o=null,a=!0,s=n.length-1;s>-1;s--){a=!0;var l=n[s];if(hT.FolderReader.isSectionGroupNode(l)){var c=this.formatForURL(hT.FolderReader.getTitle(l));r.append(c)}else if(_T.d(l)){var u=_T.I(l);u||(u=Box4Intl.Box4Strings.l_UntitledSection),u=this.formatForURL(u),r.append(u);var g=new Da.GraphIterator;g.set(l),g.tryToRootAtAncestorOfType(4),g.returnToAncestorOfType(4)&&g.get_currentNode().get_properties().hasProperty(py.w.fileIdentityGuid)&&(i=g.get_currentNode().get_properties().getValue(String,py.w.fileIdentityGuid))}else if(e.get_pageReader().isPageNode(l)){var p=Hs.HyperlinkReader.getFriendlyPageTitle(e.get_pageReader().getTitle(l));p=this.formatForURL(p),r.append(p),o=e.get_pageReader().getNotebookManagementEntityId(l).toString()}else e.get_pageReader().isVersionHistoryNode(l)?r.append(e.get_pageReader().versionHistoryContext.toString()):e.get_pageReader().isVersionNode(l)?r.append(l.get_contextId().toString()):e.get_pageReader().isConflictPageNode(l)?r.append(l.get_objectSpaceId().toString()):a=!1;a&&r.append("-")}var d=this.encodeIds(i,o);return r.append(d),r.toString()},e.prototype.formatForURL=function(e){return e=(e=(e=(e=e.replace(new RegExp("\\.","g"),"..")).replace(new RegExp("\\-","g"),".-")).replace(new RegExp("\\_","g"),"._")).replace(new RegExp("\\s","g"),"_")},e.prototype.encodeIds=function(e,t){return e||t?e?t?fT.base16Base62Converter(e,mT.base16Chars,mT.base62Chars)+"-"+fT.base16Base62Converter(t,mT.base16Chars,mT.base62Chars):fT.base16Base62Converter(e,mT.base16Chars,mT.base62Chars):fT.base16Base62Converter(t,mT.base16Chars,mT.base62Chars):null},e.prototype.buildTargetArgForPageUrl=function(e){return"target("+this.buildPageTargetStr(e)+")"},e.prototype.buildPageTargetStr=function(t){for(var n=[];t&&t!==Br.App.theNotebookManager.get_mainGraphRoot()&&(Br.App.notebookMode||!_T.d(t));)Array.add(n,t),t=t.getParentGraphSpace();for(var r=new Sys.StringBuilder,i=!0,o=n.length-1;o>-1;o--){i=!0;var a=n[o];if(hT.FolderReader.isSectionGroupNode(a))r.append(Hs.HyperlinkReader.onenoteCharEscape(hT.FolderReader.getTitle(a)));else if(_T.d(a)){var s=_T.I(a);s||(s=Box4Intl.Box4Strings.l_UntitledSection),r.append(Hs.HyperlinkReader.onenoteCharEscape(s)),r.append(Hs.HyperlinkReader.onenoteFileExtension),r.append("|");var l=new Da.GraphIterator;l.set(a),l.tryToRootAtAncestorOfType(4),l.returnToAncestorOfType(4)&&l.get_currentNode().get_properties().hasProperty(py.w.fileIdentityGuid)&&r.append(l.get_currentNode().get_properties().getValue(String,py.w.fileIdentityGuid))}else if(e.get_pageReader().isVersionHistoryNode(a))r.append(e.get_pageReader().versionHistoryContext.toString());else if(e.get_pageReader().isVersionNode(a))r.append(a.get_contextId().toString());else if(e.get_pageReader().isConflictPageNode(a))r.append(a.get_objectSpaceId().toString());else if(e.get_pageReader().isPageNode(a)){var c=Hs.HyperlinkReader.getFriendlyPageTitle(e.get_pageReader().getTitle(a));r.append(Hs.HyperlinkReader.onenoteCharEscape(c)),r.append("|"),r.append(e.get_pageReader().getNotebookManagementEntityId(a).toString())}else i=!1;i&&r.append("/")}return r.toString()},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e}();(0,o.l)(yT,"InternalLinkBuilder",null,[pT.s]);var CT=n(4614),ST=n(6393),vT=n(4215),bT=n(8734),TT=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._sectionEditor=null,this._embedMode=!1,this.sectionNodeIdx=0,this._messageSender=null,this.methodToRunAfterLoad=null,this.methodToRunAfterLoadFail=null,this.callbackData=null,this._unescapedCharacters=[new bT.o(new RegExp("\\\\\\\\","g"),"%5c"),new bT.o(new RegExp("\\\\/","g"),"%2F"),new bT.o(new RegExp("\\\\\\|","g"),"%7c"),new bT.o(new RegExp("\\\\\\)","g"),"%29")],this._embedMode=e,this._embedMode&&(this._messageSender=new Wv(n,t))}return e.prototype.get_sectionEditor=function(){return this._sectionEditor||(this._sectionEditor=se.w.get_instance().resolve(CT.f))},e.prototype.get_pageReader=function(){return Qc.PageReader.get_instance()},e.prototype.createInternalLinkManagerWithCallBack=function(t,n,r){var i=new e(!1);return i.methodToRunAfterLoad=t,i.methodToRunAfterLoadFail=n,i.callbackData=r,i},e.prototype.activatePageInSection=function(e,t,n,r,i){if(!n&&!t){var o=_T.P(e);return o?Br.App.get_activeAppFrame().workspace.set_activePage(o):Br.App.get_activeAppFrame().workspace.set_activeSection(e),void this.onNavigationSucceeded(r,n)}var a=this.findBestMatchingPageInSection(e,t,n);a?(Br.App.get_activeAppFrame().workspace.set_activePage(a),this.onNavigationSucceeded(r,this.get_pageReader().getNotebookManagementEntityId(a).toString())):this.onNavigationFailed(r,n,i)},e.prototype.findBestMatchingPageInSection=function(e,t,n){t=t?Hs.HyperlinkReader.getFriendlyPageTitle(t).toLowerCase():"",n=n?n.toLowerCase():"";var r=null,i=null,o=new Da.GraphIterator;if(o.set(e),!o.goToFirstChildByRole(79))return null;do{var a=o.get_currentNode();switch(this.matchPage(a,t,n)){case 0:return a;case 1:r=a;break;case 2:i=a}}while(o.goToNextSiblingByRole(79));return r||(i||null)},e.prototype.matchPage=function(e,t,n){var r,i=Hs.HyperlinkReader.getFriendlyPageTitle(this.get_pageReader().getTitle(e)).toLowerCase()===t;return r=this.get_pageReader().getNotebookManagementEntityId(e).toString().toLowerCase()===n,i&&r?0:i?1:r?2:3},e.prototype.setVisiblePageAfterLoad=function(e){var t=e[this.sectionNodeIdx],n=Br.App.get_activeAppFrame().workspace.get_navigationPaneView(),r=t.getHtmlViewElement(n.get_viewId());r&&r.setIsLoading(!1),this.activatePageInSection(e[this.sectionNodeIdx],e[1],e[2],e[3],e[4])},e.prototype.failedToNavigate=function(e,t){this.onNavigationFailed(e[3],e[2],e[4])},e.prototype.setVisiblePageAfterSectionGroupLoad=function(e){var t=e[5],n=e[6],r=e[this.sectionNodeIdx],i=e[1],a=e[2],s=e[3],l=e[4],c=Br.App.get_activeAppFrame().workspace.get_navigationPaneView(),u=r.getHtmlViewElement(c.get_viewId());if(u&&u.onSectionGroupContentLoaded(!0),t.length>n+1){var g=t[n+1],p=new Da.GraphIterator;p.set(r);for(var d=p.goToLastChildByRole(79),h=!1;!h&&d;)hT.FolderReader.isSectionGroup(p)&&hT.FolderReader.getTitle(p.get_currentNode()).toLowerCase()===g.toLowerCase()?h=!0:d=p.goToPreviousSiblingByRole(79);if(!h)return void this.onNavigationFailed(i,l,t);var _=d,m=Br.App.get_activeAppFrame().workspace.get_navigationPaneView(),f=_.getHtmlViewElement(m.get_viewId());f&&(f.setIsLoading(!0),f.setExpanded(!0)),hT.FolderReader.get_instance().loadIfNecessaryAndNavigate(d,o.i(this,this.setVisiblePageAfterSectionGroupLoad,"setVisiblePageAfterSectionGroupLoad"),null,[d,i,a,s,l,t,n+1])}else{if(Br.App.get_activeAppFrame().workspace.get_contentView().get_isPageView())Br.App.get_activeAppFrame().workspace.get_contentView().resume();this.activatePageInSectionGroup(e[this.sectionNodeIdx],e[1],e[2],e[3],e[4],e[5])}},e.prototype.activatePageInSectionGroup=function(e,t,n,r,i,a){var s=new Da.GraphIterator;if(s.set(e),!t&&!n){var l=ST.getFirstVisiblePageIfLoaded(e);return l?(Br.App.get_activeAppFrame().workspace.set_activePage(l),void this.onNavigationSucceeded(t,i)):void this.onNavigationFailed(t,i,a)}var c=s.goToFirstChildByRole(79),u=null;if(t)for(t=Hs.HyperlinkReader.removeUndesirableHyperlinkChars(t).toLowerCase(),u=c;u&&(!_T.D(s)||Hs.HyperlinkReader.removeUndesirableHyperlinkChars(_T.k(s.get_currentNode())).toLowerCase()!==t);)u=s.goToNextSiblingByRole(79);if(!u&&n&&c){n=n.toLowerCase(),s.set(c),s.tryToRootAtAncestorOfType(3);for(var g=s.returnToAncestorOfType(4);g&&(4!==s.get_currentNodeType()||g.get_properties().getValueWithDefault(String,py.w.fileIdentityGuid,"").toLowerCase()!==n);)g=s.goToNextSibling();g&&(u=s.goToFirstChildByRole(78))}if(u){if(!u.get_isContentPresent()){var p=u;p.get_contentReplicator()||p.set_contentReplicator(Qb.c.get_instance().createGraphSpaceReplicator(p,"InternalLink"));var d=Br.App.get_activeAppFrame().workspace.get_navigationPaneView(),h=p.getHtmlViewElement(d.get_viewId());return h&&(h.setIsLoading(!0),h.setExpanded(!0)),void this.get_sectionEditor().load(p,o.i(this,this.setVisiblePageAfterLoad,"setVisiblePageAfterLoad"),o.i(this,this.failedToNavigate,"failedToNavigate"),[p,r,i,t,a])}this.activatePageInSection(u,r,i,t,a)}else{if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInternalLinksSearchLoadedGraphIsEnabled")&&Br.App.notebookMode&&""!==n){var _=this.findSectionGroupContainingSection(n);if(_&&_!==e)return C.ULS.sendTraceTag(19010569,339,50,"InternalLinksManager found different sectionGroup containing section."),void this.activatePageInSectionGroup(_,t,n,r,i,null)}this.onNavigationFailed(t,i,a)}},e.prototype.handleInternalLink=function(e){this.activatePage(e)},e.prototype.activatePage=function(e){try{e=unescape(decodeURI(e))}catch(t){e=unescape(e)}var t=this.decomposeInternalLink(e),n=Br.App.get_activeAppFrame().workspace.get_activeSection(),r="";n&&(r=_T.k(n).toLowerCase());var i=t.pageName,o=t.pageId,a=t.sectionName,s=t.sectionId;t.sectionGroup&&t.sectionGroup.length||""!==a||(a=r,t.sectionName=r);var l=this.getRelativeFolderPath(t);if(Br.App.notebookMode||!(l&&l.length>=1||a!==r)){var c=null;if(n&&l){if(!this.navigateThroughRelativeFolderPath(n,l,t,(0,p.m)((function(){return c}),(function(e){return c=e}))))return}else c||(c=n?n.getParentGraphSpace():Br.App.theNotebookManager.get_notebookNode());this.activatePageInSectionGroup(c,a,s,i,o,l)}else this.onNavigationFailed(a,o,l,Box4Intl.Box4Strings.l_OpenCrossSectionLinkError)},e.prototype.getRelativeFolderPath=function(e){var t=null;if(e.isRelativeLink)t=e.sectionGroup;else{var n=Br.App.get_activeAppFrame().workspace.get_activeSection()?ay.getContainingSectionGroups(Br.App.get_activeAppFrame().workspace.get_activeSection()):null;t=this.getRelativeSectionGroupPath(e.sectionGroup,n)}return t},e.prototype.navigateThroughRelativeFolderPath=function(e,t,n,r){for(var i=e.getParentGraphSpace(),a=null,s=0;s<t.length&&".."===t[s].toString();)a=(a=s?a:i).getParentGraphSpace(),s++;r.val=a;var l=new Da.GraphIterator,c=null;if(s<t.length&&(c=t[s].toString()),c){r.val?l.set(r.val):l.set(Br.App.theNotebookManager.get_notebookNode()),r.val=l.goToLastChildByRole(79);for(var u=!1;!u&&r.val;)hT.FolderReader.isSectionGroup(l)&&hT.FolderReader.getTitle(l.get_currentNode()).toLowerCase()===c.toLowerCase()?u=!0:r.val=l.goToPreviousSiblingByRole(79);if(!u)return this.onNavigationFailed(n.sectionName,n.pageId,t),!1;if(Br.App.get_activeAppFrame().workspace.get_contentView().get_isPageView())Br.App.get_activeAppFrame().workspace.get_contentView().suspend();var g=r.val,p=Br.App.get_activeAppFrame().workspace.get_navigationPaneView(),d=g.getHtmlViewElement(p.get_viewId());return d&&(d.setIsLoading(!0),d.setExpanded(!0)),hT.FolderReader.get_instance().loadIfNecessaryAndNavigate(r.val,o.i(this,this.setVisiblePageAfterSectionGroupLoad,"setVisiblePageAfterSectionGroupLoad"),null,[r.val,n.sectionName,n.sectionId,n.pageName,n.pageId,t,s,r.val]),!1}return!0},e.prototype.onNavigationSucceeded=function(e,t){this._embedMode&&this._messageSender.sendNavigationResult(e,t,!0),this.methodToRunAfterLoad&&this.methodToRunAfterLoad(this.callbackData)},e.prototype.onNavigationFailed=function(e,t,n,r){if(void 0===r&&(r=null),this._embedMode)this._messageSender.sendNavigationResult(e,t,!1);else{this.methodToRunAfterLoadFail?this.methodToRunAfterLoadFail(this.callbackData,14):this.showLinkOpenErrorDialog(r);var i=this.getUpLayersFromRelativeFolderPath(n),o=n?n.length-i:0;C.ULS.sendTraceTag(18661900,339,50,"Open internal link failed: {0} layers up and {1} layers down.",i,o)}},e.prototype.getUpLayersFromRelativeFolderPath=function(e){var t=0;if(e)for(var n=0;n<e.length;n++)".."===e[n].toString()&&t++;return t},e.prototype.getRelativeSectionGroupPath=function(e,t){var n=null,r=t?t.length:0,i=e?e.length:0;if(r>0||i>0){for(var o=0;o<r&&o<i&&t[o].toString().toLowerCase()===e[o].toString().toLowerCase();o++);for(var a=o;a<r;a++)n||(n=[]),Array.add(n,"..");for(a=o;a<i;a++)n||(n=[]),Array.add(n,e[a].toString())}return n},e.prototype.tryConvertToRelativeLink=function(t,n,r,i,o){void 0===o&&(o=!1),n.val="",i.val="";try{t=unescape(decodeURI(t))}catch(e){t=unescape(t)}if(this.isAbsoluteInternalLink(t)||this.isWebNotebookInternalLink(t)){var a=this.decomposeInternalLink(t);if(!a||!a.decomposeSuccess)return!1;if(a.preserveLink)return!1;if(a.isRelativeLink)return!1;n.val=Yv.u.protocolOnenote,o&&(n.val+=Wr.App.notebookName+"\\");var s=a.sectionGroup,l=ay.getContainingSectionGroups(Br.App.get_activeAppFrame().workspace.get_activeSection()),c=o?s:this.getRelativeSectionGroupPath(s,l);n.val+=c&&c.length?c.join("\\")+"\\":"",s&&r&&(i.val=s[s.length-1].toString());var u=a.sectionName,g=a.sectionId;if(c&&""===u&&""===g)return n.val+="#",n.val=e.addBasePathToRelativeLink(n.val,a.basePath),!0;if(""!==u){var p=Br.App.get_activeAppFrame().workspace.get_activeSection(),d=_T.k(p);(c||d!==u||o)&&(n.val+=u+Hs.HyperlinkReader.onenoteFileExtension),r&&(i.val=u)}else r&&(i.val=Box4Intl.Box4Strings.l_UntitledSection);n.val+="#";var h=a.pageName,_=a.pageId;return""===h&&""===_?(""!==g&&(n.val+=String.format("{0}={{{1}}}",Yv.u.onenoteSectionId,g)),n.val=e.addBasePathToRelativeLink(n.val,a.basePath),!0):(""!==h?(n.val+=Hs.HyperlinkReader.getFriendlyPageTitle(h),r&&(i.val=h)):r&&(i.val=Box4Intl.Box4Strings.l_UntitledPageText),""!==g&&(n.val+=String.format("&{0}={{{1}}}",Yv.u.onenoteSectionId,g)),""!==_&&(n.val+=String.format("&{0}={{{1}}}",Yv.u.onenotePageId,_)),n.val=e.addBasePathToRelativeLink(n.val,a.basePath),!0)}return!1},e.prototype.showLinkOpenErrorDialog=function(e){void 0===e&&(e=null);var t=new ar.StandardDialog;t.set_buttonsOption(0),t.showWarning(CommonUIStrings.l_DefaultDialogTitle,e||Box4Intl.Box4Strings.l_LinkOpenError,null)},e.prototype.isValidInternalLinkProtocol=function(t){return t.substr(0,Yv.u.protocolOnenote.length).toLowerCase()===Yv.u.protocolOnenote||t.substr(0,Hs.HyperlinkReader.protocolHttp.length).toLowerCase()===Hs.HyperlinkReader.protocolHttp||t.substr(0,e.protocolHttps.length).toLowerCase()===e.protocolHttps},e.prototype.isInternalLink=function(e){return!(!us.n.get_instance().get_item(12)||!e)&&(e=unescape(e),!!this.isValidInternalLinkProtocol(e)&&(this.isRelativeInternalLink(e)||this.isAbsoluteInternalLink(e)||this.isWebNotebookInternalLink(e)))},e.prototype.isClientUrl=function(e){if(!e)return!1;try{e=unescape(decodeURI(e))}catch(t){e=unescape(e)}e=e.toLowerCase();var t=this.getClientNotebookLink(),n=this.getClientNotebookWebLink();return!!(""!==n&&e.startsWith(n)||""!==t&&e.startsWith(t))},e.prototype.getInternalLinkType=function(e){return us.n.get_instance().get_item(12)?(e=e.toLowerCase(),this.isRelativeInternalLink(e)?1:this.isWebNotebookInternalLink(e)?3:this.isAbsoluteInternalLink(e)?2:0):0},e.prototype.isWebNotebookInternalLink=function(e){if(!us.n.get_instance().get_item(12))return!1;e=e.toLowerCase();var t=this.getWebNotebookViewLink(),n=this.getWebNotebookEditLink(),r=this.getClientNotebookWebLink();if(""!==t&&e.startsWith(t)||""!==n&&e.startsWith(n)||""!==r&&e.startsWith(r))return!0;var i=tt.n.getParameterValue(e,Yv.u.oneDriveResId);if(!i)return!1;var o=tt.n.getHost(e),a=tt.n.getHost(t),s=tt.n.getParameterValue(t,Yv.u.oneDriveResId);return o===a&&i===s},e.prototype.isAbsoluteInternalLink=function(e){if(!us.n.get_instance().get_item(12))return!1;e=e.toLowerCase();var t=this.getClientNotebookLink();return""!==t&&e.startsWith(t)},e.prototype.isRelativeInternalLink=function(t){return!!us.n.get_instance().get_item(12)&&((t=t.toLowerCase()).startsWith(Yv.u.protocolOnenote)&&!t.startsWith(Yv.u.protocolOnenote+Hs.HyperlinkReader.protocolHttp)&&!t.startsWith(Yv.u.protocolOnenote+e.protocolHttps))},e.prototype.getClientNotebookLink=function(){return Br.App.get_clientEditDocumentUrl()?unescape(decodeURI(Yv.u.protocolOnenote+Br.App.get_clientEditDocumentUrl())).toLowerCase():""},e.prototype.getClientNotebookWebLink=function(){var t=this.getClientNotebookLink();if(""===t)return"";var n=t.length-1;"/"===t.substr(n,1)&&n--;var r=t.lastIndexOf("/",n);n=r-1,r=t.lastIndexOf("/",n);var i=t.substr(r+1);return unescape(tt.n.getAbsoluteUrl("OneNote.aspx?"+e.webLinkIdField+"=/"+i)).toLowerCase()},e.prototype.getWebNotebookViewLink=function(){return Br.App.hostUrl?unescape(decodeURI(tt.n.getAbsoluteUrl(Br.App.hostUrl))).toLowerCase():""},e.prototype.getWebNotebookEditLink=function(){return Br.App.hostEditUrl?unescape(decodeURI(tt.n.getAbsoluteUrl(Br.App.hostEditUrl))).toLowerCase():""},e.prototype.decomposeInternalLink=function(e){var t=this.getInternalLinkType(e);if(!t)return null;var n=new fT;switch(n.url=e,n.isInternalLink=!0,n.isRelativeLink=1===t,t){case 1:this.decomposeRelativeLink(n);break;case 2:this.decomposeOnenoteClientLink(n);break;case 3:this.decomposeWebNotebookLink(n)}return n},e.prototype.decomposeRelativeLink=function(e){e.decomposeSuccess=!1;var t=e.url;e.protocol=Yv.u.protocolOnenote;var n=Yv.u.protocolOnenote.length,r=t.indexOf("#",n),i=t.substring(n,r),o=t.substr(r+1);(""===i||(i=i.replace("/","\\"),this.decomposeSGAndSection(i,"\\",e)))&&(""===o||this.decomposePageAndId(o,e))&&(e.decomposeSuccess=!0)},e.prototype.decomposeOnenoteClientLink=function(e){var t=e.url;e.protocol=Yv.u.protocolOnenote;var n=this.getClientNotebookLink(),r="",i="",o=n.length;n.endsWith(Hs.HyperlinkReader.onenoteFileExtension)&&(o=n.lastIndexOf("/")+1);"/"===t.substr(o,1)&&o++;var a=t.indexOf("#",o);a<0?r=t.substr(o):(r=t.substring(o,a),i=t.substr(a+1)),(""===r||this.decomposeSGAndSection(r,"/",e))&&(""===i||this.decomposePageAndId(i,e))&&(e.decomposeSuccess=!0)},e.prototype.decomposeWebNotebookLink=function(e){switch(e.preserveLink=e.url.indexOf(Yv.u.oneNotePreserveLink,0)>=0,this.getWdTargetType(e.url)){case 1:e.decomposeSuccess=this.decomposeWdField(e.url,e);break;case 2:e.decomposeSuccess=this.decomposeWdHashField(e.url,e)}},e.prototype.getWdTargetType=function(e){return-1===e.indexOf(Yv.u.wacDataTarget)?2:1},e.prototype.decomposeSGAndSection=function(e,t,n){if(n.sectionGroup=null,n.sectionName="",""===e)return!0;for(var r=0,i=(e=this.onenoteCharUnescapeEncode(e)).indexOf(t);i>=0;){n.sectionGroup||(n.sectionGroup=[]);var o=e.substring(r,i);""!==o&&Array.add(n.sectionGroup,unescape(o)),r=i+1,i=e.indexOf(t,r)}return r<e.length&&(n.sectionName=unescape(e.substr(r))),""!==n.sectionName&&(i=n.sectionName.toLowerCase().lastIndexOf(Hs.HyperlinkReader.onenoteFileExtension),n.sectionName=n.sectionName.substring(0,i)),!0},e.prototype.decomposePageAndId=function(t,n){if(""===t)return!0;for(var r=0,i=(t=this.onenoteCharUnescapeEncode(t)).indexOf("&",r),o=!0,a=0;a<50;){var s="",l=(s=i>=0?t.substring(r,i):t.substr(r)).toLowerCase(),c=-1===l.indexOf("{",0)?1:2,u=-1===l.indexOf("}",0)?0:1;if(l.startsWith(Yv.u.onenoteSectionId)?n.sectionId=s.substring(Yv.u.onenoteSectionId.length+c,s.length-u):l.startsWith(Yv.u.onenotePageId)?n.pageId=s.substring(Yv.u.onenotePageId.length+c,s.length-u):l.startsWith(e.onenoteBasePath)?n.basePath=unescape(s.substring(e.onenoteBasePath.length+1,s.length)):o&&(n.pageName=unescape(s)),o=!1,i<0)break;r=i+1,i=t.indexOf("&",r),a++}return!0},e.prototype.decomposeWdField=function(e,t){if(""===e)return!0;var n=(e=this.onenoteCharUnescapeEncode(e)).indexOf(Yv.u.wacDataTarget,0);if(n<0)return!1;if(n+=Yv.u.wacDataTarget.length,"("!==e.substr(n,1))return!1;n++,"/"===e.substr(n,1)&&n++;var r=e.indexOf(")",n);if(r<0)return!1;var i=e.substring(n,r);"/"===i.substr(i.length-1,1)&&(i=i.substr(0,i.length-1)),r=i.length-1,"/"===i.substr(r,1)&&r--;for(var o=i.lastIndexOf("/",r),a=0;a<50;){var s="";if(""!==(s=o<0?i.substring(0,r+1):i.substring(o+1,r+1))){var l=!1,c=!1,u=s,g="",p=s.indexOf("|");p>=0?(u=s.substring(0,p),g=s.substr(p+1),u.toLowerCase().indexOf(Hs.HyperlinkReader.onenoteFileExtension)>=0?l=!0:c=!0):u.toLowerCase().indexOf(Hs.HyperlinkReader.onenoteFileExtension)>=0&&(l=!0),c?(t.pageName=unescape(u),t.pageId=g):l?(p=u.toLowerCase().lastIndexOf(Hs.HyperlinkReader.onenoteFileExtension),t.sectionName=unescape(u.substring(0,p)),t.sectionId=g):(t.sectionGroup||(t.sectionGroup=[]),Array.insert(t.sectionGroup,0,unescape(u)))}if(o<=0)break;r=o-1,o=i.lastIndexOf("/",r),a++}return!0},e.prototype.decomposeWdHashField=function(e,t){if(""===e)return!0;var n=(e=this.onenoteCharUnescapeEncode(e)).indexOf(mT.wacData,0),r=e.indexOf(mT.endField,n);if(n<0||r<0)return!1;n+=mT.wacData.length;var i=e.substring(n,r),o=[];o=(i=(i=(i=(i=(i=i.replace(new RegExp("\\.\\.","g"),".")).replace(new RegExp("\\.\\-","g"),Jn.l.calcHashCode(".-").toString())).replace(new RegExp("\\.\\_","g"),Jn.l.calcHashCode("._").toString())).replace(new RegExp("\\_","g")," ")).replace(new RegExp(Jn.l.calcHashCode("._").toString(),"g"),"_")).split(mT.seperator);for(var a=0;a<o.length;a++)o[a]=o[a].replace(new RegExp(Jn.l.calcHashCode(".-").toString(),"g"),"-");switch(this.getLinkLocation(o)){case 1:fT.pageInSection(t,o);break;case 2:fT.sectionInNotebook(t,o);break;case 3:fT.pageInNotebook(t,o);break;case 4:fT.sectionWithSgInNotebook(t,o);break;case 5:fT.pageWithSgInNotebook(t,o);break;default:return!1}return!0},e.prototype.getLinkLocation=function(e){var t=new RegExp("[a-zA-Z0-9]{24}"),n=t.exec(e[e.length-1]),r=t.exec(e[e.length-2]);return Br.App.notebookMode?n&&r?e.length>=5?5:3:n?e.length>=3?4:2:6:1},e.prototype.onenoteCharUnescapeEncode=function(e){return Jn.l.encodeString(unescape(e),this._unescapedCharacters)},e.prototype.findSectionGroupContainingSection=function(e,t){void 0===t&&(t=null);var n=new vT.m;if(t||(t=Br.App.theNotebookManager.get_mainGraphRoot()),n.set(t),!n.goToFirstChildByRole(79))return null;do{var r=n.get_currentNode();if(_T.d(r)){var i=_T.t(r);if(i&&i.toLowerCase()===e)return(0,f.e)(Wf.k,r.getParentGraphSpace())}if(hT.FolderReader.isFolderNode(r)){var o=this.findSectionGroupContainingSection(e,r);if(o)return o}}while(n.goToNextSiblingByRole(79));return null},e.addBasePathToRelativeLink=function(t,n){return t+="&end",""!==n&&(t+="&"+e.onenoteBasePath+"="+Jn.l.urlKeyValueEncode(n)),t=t.replace(new RegExp(" ","g"),"%20")},e.onenoteBasePath="base-path",e.onenoteObjectId="object-id",e.onenoteAltObjectId="altobject-id",e.webLinkIdField="id",e.protocolHttps="https://",e}();(0,o.l)(TT,"InternalLinkManager",null,[dT.b,qs.v]);var AT=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.InternalLinks"},e.prototype.init=function(){},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,e.register(yT).as(pT.s).singleInstance().usingFactory((function(){return new yT})),e.register(TT).as(dT.b).as(qs.v).singleInstance().usingFactory((function(){return new TT(Wr.App.get_isEmbedMessageEnabled(),L.AFrameworkApplication.hostPostmessenger,L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteEmbedHostingApp)}))},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(AT,"OneNoteInternalLinksPackage",null,[l.u,c.s]);var IT,wT=(0,o.y)("IHierarchicalListEditorFactory"),xT=n(5780),FT=function(){function e(e,t,n){void 0===n&&(n=null),this.listReader=null,this._outlineElementEditor=null,this._pendingListInfo=null,this._listFormattingEditor=null,this.listReader=e,this._outlineElementEditor=t,this._pendingListInfo=null,this._listFormattingEditor=n}return e.prototype.get_shouldRemoveDestinationListBeforeMerge=function(){return!1},e.prototype.delistTableIfNecessary=function(e,t,n){},e.prototype.renumberForOEPasteIfNecessary=function(e){},e.prototype.removeListsFromTablesIfNecessary=function(e){},e.prototype.reapplyListInfoWithoutPargraphStyleIfNecessary=function(e,t){return e},e.prototype.setListInfo=function(e){var t,n,r;if(t=mc.ListReader.get_externalPasteImprovementsEnabled(),n=e.get_propertySet().getValueWithDefault(Number,ks.j.listID,0),r=e.get_propertySet().getValueWithDefault(Number,ks.j.listLevel,-1),us.n.get_instance().get_item(85)||t&&n>0&&r>=0)this._pendingListInfo=e;else{var i=1,o=e.get_listStyle();t&&42!==o&&o>0&&(i=o),this._pendingListInfo=ds.j.createFromScratch(e.get_listType(),i,null,n,r,void 0,"")}},e.prototype.setPendingListInfo=function(e){e&&(this._pendingListInfo=e)},e.prototype.setLeftIndentOnTableIfNecessary=function(e,t,n){},e.prototype.setListBaseStyleIfNecessary=function(e){},e.prototype.duplicateListLevelIfNecessary=function(e,t){},e.prototype.createList=function(e){var t=ji.y.get_instance().startActivity(ii.ZX);Ls.OutlineElementReader.isOutlineElement(e)||ji.y.get_instance().recordEvent("PossiblyIncorrectListCreation",{Reason:M_.i.doesNotContainOe}),mc.ListReader.isListOutlineElement(e)&&ji.y.get_instance().recordEvent("PossiblyIncorrectListCreation",{Reason:M_.i.containsList});var n=this.createListNode();return e.addChild(n,4),e.goToChild(n),t.end(),n},e.prototype.createListNode=function(){return _c.u.get_instance().createInstance(393234)},e.prototype.removeList=function(e){var t=ji.y.get_instance().startActivity(ii.BZ);Ls.OutlineElementReader.isOutlineElement(e)||ji.y.get_instance().recordEvent("PossiblyIncorrectListRemoval",{Reason:M_.i.doesNotContainOe}),mc.ListReader.isListOutlineElement(e)&&this.removeOEListElement(e),t.end()},e.prototype.removeOEListElement=function(e){this.listReader.moveToList(e),e.disconnectNodeAndReturnToParent()},e.prototype.applyBulletsNumbering=function(e,t,n,r){void 0===r&&(r=!1);var i=ji.y.get_instance().startActivity(ii.ei);if(!this.canChangeListType(t,n.val))return!1;this.setRestartAtIfNeeded(e,n.val,r);var o=e.hasProperty(zl.k.multipleOeSelection),a=e.getValueWithDefault(Boolean,zl.k.isChainedAction,!1),s=!1;1===n.val.get_listMultiLevelType()&&n.val.get_isStyleSelected()&&!n.val.get_listStyleId()&&(s=!0);var l=n.val.get_propertySet().getValueWithDefault(String,ks.j.listLevelText,null);if(l&&l===Box4Intl.Box4Strings.L_ListStyleNone&&(1===n.val.get_listType()?s=n.val.get_isStyleSelected()&&!n.val.get_listStyleId():n.val.get_listType()||(s=!n.val.get_listStyle())),a)s&&(n.val.setListStyle(16,0),e.setValue(zl.k.listSoftType,16),e.setValue(zl.k.listSoftStyle,0));else{var c=this.listReader.getListInfo(t);if(this.shouldToggleOff(n.val,c,o,s,e)&&(i.get_properties().set_item("ToggledOff","true"),n.val.setListStyle(16,0),this.setListStyleAndTypeToNone(e)),!this.performAutoCorrectNumbering(e,t,n.val,r))return i.end(),!1;!n.val.get_listType()&&e.hasProperty(zl.k.listLastStartAt)&&(n.val.set_restartAt(e.getValue(Number,zl.k.listLastStartAt)),e.removeProperty(zl.k.listLastStartAt))}return o&&(i.get_properties().set_item("MultipleOESelection","true"),this.shouldSkipEmptyOE(t,n))?(i.end(),!1):(this.adjustAndSetLevel(t,n.val,e,r),e.setValue(zl.k.isChainedAction,!0),i.end(),!0)},e.prototype.shouldToggleOff=function(e,t,n,r,i){if(r)return!0;if(t){var o=e.get_listType()===t.get_listType(),a=!e.get_listStyle()&&e.get_restartAt()===wm.z.startAtNone,s=e.get_listStyle()===t.get_listStyle()&&e.get_restartAt()===t.get_restartAt();if(this.listReader.get_listSymbolsImprovementsEnabled()){var l=(!e.get_isStyleSelected()||this.sameListLevelText(t,e))&&!n;s=s&&l}return o&&(a||s)}return!1},e.prototype.setListStyleAndTypeToNone=function(e){e.setValue(zl.k.listSoftType,16),e.setValue(zl.k.listSoftStyle,0)},e.prototype.sameListLevelText=function(e,t){return!0},e.prototype.setRestartAtIfNeeded=function(e,t,n){},e.prototype.performAutoCorrectNumbering=function(e,t,n,r){return!0},e.prototype.canChangeListType=function(e,t){return!0},e.prototype.shouldSkipEmptyOE=function(e,t){return 16!==t.val.get_listType()&&Ls.OutlineElementReader.isEmpty(e,!0)},e.prototype.clearListFromParagraph=function(e){var t=ji.y.get_instance().startActivity(ii.oB);cs.ParagraphReader.isParagraphNode(e)||ji.y.get_instance().recordEvent("ClearingListFromNonParagraph",{Reason:M_.i.doesNotContainParagraph});var n=new Da.GraphIterator;n.set(e),n.tryToRootAtOutlineAncestor(),n.returnToNodeOfType(12),hs.OutlineElementNavigator.returnToOutlineElement(n),this.applyListInfo(n,null),t.end()},e.prototype.applyListInfoFromStyle=function(e,t){},e.prototype.merge=function(t,n,r,i){void 0===i&&(i=null);var o=ji.y.get_instance().startActivity(ii.Dz);if(Ls.OutlineElementReader.isOutlineElement(n)||ji.y.get_instance().recordEvent("PossibleIncorrectMergeOfOEs",{Reason:"SrcIsNotOE"}),Ls.OutlineElementReader.isOutlineElement(t)||ji.y.get_instance().recordEvent("PossibleIncorrectMergeOfOEs",{Reason:"DestIsNotOE"}),mc.ListReader.isListOutlineElement(n)){o.get_properties().set_item("UseSourceListWithNonlistDestination",r.toString());var a;if(a=mc.ListReader.get_externalPasteImprovementsEnabled(),r&&this.get_shouldRemoveDestinationListBeforeMerge()&&mc.ListReader.isListOutlineElement(t)&&this.removeList(t),!mc.ListReader.isListOutlineElement(t)||r&&a){if(r){L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordSwitchListByRangeSelectionImprovementSettings");var s=this.getListInfoForCopyPaste(n);this.listReader.get_switchListByRangeSelectionImprovementIsEnabled()&&s.get_propertySet().setProperty_Unchecked(Kc.b.listRestart,wm.z.startAtNone),1===s.get_listMultiLevelType()&&s.checkValidMultilevelDefInfo(!0),this.applyListInfo(t,s),o.get_properties().set_item("MoveListInfoFromSrcToDestOE","true")}L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings"),e.get_listSettings().isQoEListExternalPasteImprovementIsEnabled&&this.carrySourceListMarkerFontFormattingIntoDestinationList(n,t),this.removeList(n)}else this.listReader.get_qoEListInternalCCPImprovementIsEnabled()&&this.processNeededSourceListFormatIntoDestination(n,t),e.get_listSettings().isQoEListExternalPasteImprovementIsEnabled&&this.carrySourceListMarkerFontFormattingIntoDestinationList(n,t),this.removeList(n);o.get_properties().set_item("RemoveListFromSrcOE","true")}return o.end(),!0},e.prototype.processNeededSourceListFormatIntoDestination=function(e,t){},e.prototype.carrySourceListMarkerFontFormattingIntoDestinationList=function(e,t){var n=cs.ParagraphReader.getFirstParagraphUnderNode(e.get_currentNode()),r=this.listReader.getListNodeFromOE(t);this.setListFormatting(r,n,null)},e.prototype.getListInfoForCopyPaste=function(e){return this.listReader.getListInfo(e)},e.prototype.setListFormatting=function(t,n,r){if(t){var i,o,a=_s.y.create(n),s=Ps.FormattingReader.getFormattingObject(a);if(this.setListPropertyValue(Number,t,Kc.b.fontColor,r,s),this.setListPropertyValue(Number,t,Kc.b.fontSize,r,s),this._listFormattingEditor)this.getPropertyValue(String,Kc.b.font,r,s,"",(0,p.m)((function(){return i}),(function(e){return i=e})))&&this._listFormattingEditor.setFontFace(t,i),this.getPropertyValue(Number,ks.j.themeFont,r,s,-1,(0,p.m)((function(){return o}),(function(e){return o=e})))&&this._listFormattingEditor.setThemeFont(t,o);else this.setListPropertyValue(String,t,Kc.b.font,r,s),this.setListPropertyValue(Number,t,ks.j.themeFont,r,s);L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings"),e.get_listSettings().isQoEListExternalPasteImprovementIsEnabled&&(this.setListPropertyValue(Boolean,t,Kc.b.bold,r,s),this.setListPropertyValue(Boolean,t,Kc.b.italic,r,s),this.setListPropertyValue(Boolean,t,Kc.b.superscript,r,s),this.setListPropertyValue(Boolean,t,Kc.b.subscript,r,s))}},e.prototype.setProperPendingListInfoAfterPaste=function(e){},e.prototype.setListPropertyValue=function(e,t,n,r,i){if(r&&r.hasProperty(n))t.setValue(n,r.getValue(e,n));else{if(!i||!i.get_cache())return;var o=i.get_cache();o.hasProperty(n)&&t.setValue(n,o.getValue(e,n))}},e.prototype.getPropertyValue=function(e,t,n,r,i,o){if(o.val=i,n&&n.hasProperty(t))return o.val=n.getValue(e,t),!0;if(!r||!r.get_cache())return!1;var a=r.get_cache();return!!a.hasProperty(t)&&(o.val=a.getValue(e,t),!0)},e.prototype.ensureValidPropertySetFromAction=function(e,t){return t.hasProperty(zl.k.listSoftType)||(e===ii.Gk?t.setValue(zl.k.listSoftType,1):e===ii.nQ&&t.setValue(zl.k.listSoftType,0)),t.hasProperty(zl.k.listSoftStyle)||t.setValue(zl.k.listSoftStyle,0),t},e.prototype.autocorrectNumberList=function(t,n,r,i,o,a,s){var l=ji.y.get_instance().startActivity(ii.Wv),c=this.listReader.getListInfo(n),u=ds.j.createFromScratch(0,r);if(u.set_restartAt(i),u.set_autoTriggerString(a),c&&u.hasMatchingListFormat(c)&&u.get_restartAt()===c.get_lastStartAt())l.end();else{var g=new as.GraphTransaction(15);g.setFromIterator(n),s.numbering(u.get_listType(),u.get_listStyle(),u.get_restartAt())&&e.get_characterPropertiesEditor().replaceTextRange(o,""),g.dispose(),l.end()}},e.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=se.w.get_instance().resolve(Va.x))},e.get_listSettings=function(){return e._listSettings||(e._listSettings=se.w.get_instance().tryResolve(xm.r))},e._characterPropertiesEditor=null,e._listSettings=null,e}();(0,o.l)(FT,"ListEditor",null,[rs.v]),function(e){e[e.number=0]="number",e[e.bullet=1]="bullet",e[e.lim=13]="lim",e[e.nil=14]="nil",e[e.any=15]="any",e[e.noList=16]="noList",e[e.invalid=42]="invalid"}(IT||(IT={})),(0,o.h)("ListType",IT);var ET=n(1692),PT=n(9171),kT=n(1397),DT=n(8940),MT=function(e){function t(t,n,r,i){var o=e.call(this,t,r,i)||this;return o._indentationEditorLazy=null,o._indentationEditorLazy=n,o}return(0,S.t)(t,e),t.prototype.get_hierarchicalListReader=function(){return this.listReader},t.prototype.setListInfoAndIndentAfterPaste=function(e,t){this.applyListInfo(e,this._pendingListInfo),this._pendingListInfo=null},t.prototype.setListInfoAndInsertNewOE=function(e,t,n,r){if(Ls.OutlineElementReader.isEmpty(e,!1)&&(mc.ListReader.isListOutlineElement(e)&&this.applyListInfo(e,null,!1,!1,-1),PT.b.isOutlineElementWithNoteTags(e)))ET.e(n.get_iterator());else{var i=this._outlineElementEditor.insertOutlineElementBelow(e);this._outlineElementEditor.splitAtIp(e,i,n,!1,!1,!0),this.isTodoList(e)&&this.extendTodoList(i)}},t.prototype.shouldAutocorrectList=function(e){return!0},t.prototype.shouldTransferListInfo=function(e,t){return e&&t},t.prototype.setListInfo=function(t){us.n.get_instance().get_item(85)||ji.y.get_instance().recordEvent("PossibleLossOfListProperties",{Reason:"ImportListStyleIsNull"}),t.get_listStyle()&&e.prototype.setListInfo.call(this,t)},t.prototype.adjustAndSetLevel=function(e,t,n,r){this._indentationEditorLazy.get_value()||ji.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:"IOutlineElementIndentationEditorIsNull"}),this._indentationEditorLazy.get_value()&&this._indentationEditorLazy.get_value().canDemote(e,1)&&1===Ls.OutlineElementReader.getAbsoluteOutlineLevel(e)&&!this.doesOutlineHaveListofTypeAtLevel1(e,t)&&16!==t.get_listType()&&n.setValue(zl.k.autoDemoteLists,!0),this.applyListInfo(e,t)},t.prototype.transferListInfo=function(e,t,n,r){var i=ds.j.createFromScratch(15,0);i.setFrom(this.getListInfoFromOutlineElementNode(n)),i.clearNumbering(),this.applyListInfo(e,i)},t.prototype.getListInfoFromOutlineElementNode=function(e){if(!mc.ListReader.isListOutlineElementNode(e))return ji.y.get_instance().recordEvent("PossibleLossOfListProperties",{Reason:"NotListOutlineNode"}),null;var t=new Da.GraphIterator;return t.set(e),this.listReader.moveToList(t),this.get_hierarchicalListReader().getListInfoFromListNode(t)},t.prototype.doesOutlineHaveListofTypeAtLevel1=function(e,t){var n=new Da.GraphIterator;n.setFrom(e),Sc.returnToOutlineOrTableCell(n),vc.isOutlineNode(n.get_currentNode())||ji.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:M_.i.doesNotContainOe});for(var r=!1,i=n.goToFirstChildByRole(1);i;i=n.goToNextSiblingByRoleOrReturnToParent(1))if(!Ls.OutlineElementReader.isOutlineGroup(n)&&1===Ls.OutlineElementReader.getAbsoluteOutlineLevel(n)&&this.hasMatchingListType(n,t.get_listType())){n.returnToParent(),r=!0;break}return r},t.prototype.applyListInfo=function(e,t,n,r,i){var o=this;void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===i&&(i=-1);var a=ji.y.get_instance().startActivity(ii.mf);a.get_properties().set_item("ListTypeToApply",t?IT[t.get_listType()]:"null"),Da.GraphIterator.executeVoidReturnWithDebugAssertRestored(e,(function(){if(!Ls.OutlineElementReader.isOutlineElement(e))return ji.y.get_instance().recordEvent("PossibleListStateNotUpdated",{Reason:M_.i.doesNotContainOe}),void a.end();if(!t||16===t.get_listType())return o.removeList(e),a.get_properties().set_item("ListRemoved","true"),void a.end();mc.ListReader.isListOutlineElement(e)||(o.createList(e),a.get_properties().set_item("CreatedList","true"),e.returnToParent());var n=o.listReader.getListInfo(e);if(!n||t.get_listType()===n.get_listType()&&t.hasMatchingListFormat(n)&&(!t.get_isOrdered()||t.get_restartAt()===n.get_restartAt()))return a.get_properties().set_item("NoOp","true"),void a.end();n.setFrom(t),a.end()}))},t.prototype.setListFormatting=function(e,t,n){},t.prototype.hasMatchingListType=function(e,t){return Ls.OutlineElementReader.isOutlineElement(e)||ji.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:M_.i.doesNotContainOe}),!!mc.ListReader.isListOutlineElement(e)&&this.listReader.getListInfo(e).get_listType()===t},t.prototype.isTodoList=function(e){if(PT.b.isOutlineElementWithNoteTags(e)){var t=new Da.GraphIterator;if(t.setFrom(e),hs.OutlineElementNavigator.moveToContent(t)&&t.goToFirstChildByRole(88)&&DT.g(t,0))return!0}return!1},t.prototype.extendTodoList=function(e){var t=new Da.GraphIterator;t.setFrom(e),hs.OutlineElementNavigator.moveToContent(t)&&kT.n.get_instance().insertDefaultNoteTag(t,0)},t}(FT);(0,o.l)(MT,"HierarchicalListEditor",FT,[]);var RT=function(e){function t(t,n,r,i){var o=e.call(this,t,r,i)||this;return o._indentationEditorLazy=null,o._indentationEditorLazy=n,o}return(0,S.t)(t,e),t.prototype.get_hierarchicalListReader=function(){return this.listReader},t.prototype.setListInfoAndIndentAfterPaste=function(e,t){this.applyListInfo(e,this._pendingListInfo),this._pendingListInfo=null},t.prototype.setListInfoAndInsertNewOE=function(e,t,n,r){if(Ls.OutlineElementReader.isEmpty(e,!1)&&(mc.ListReader.isListOutlineElement(e)&&this.applyListInfo(e,null,!1,!1,-1),PT.b.isOutlineElementWithNoteTags(e)))ET.e(n.get_iterator());else if(t){var i=this._outlineElementEditor.insertOutlineElementBelow(e);this._outlineElementEditor.splitAtIp(e,i,n,!1,!1,!0),this.isTodoList(e)&&this.extendTodoList(i)}else this.promoteSourceOutlineElement(e)},t.prototype.promoteSourceOutlineElement=function(e){!mc.ListReader.isListOutlineElement(e)&&Ls.OutlineElementReader.isEmpty(e,!1)&&this._indentationEditorLazy.get_value()&&this._indentationEditorLazy.get_value().canPromote(e,-1)&&this._indentationEditorLazy.get_value().promote(e,-1,0)},t.prototype.shouldAutocorrectList=function(e){return!0},t.prototype.shouldTransferListInfo=function(e,t){return e&&t},t.prototype.setListInfo=function(t){us.n.get_instance().get_item(85)||ji.y.get_instance().recordEvent("PossibleLossOfListProperties",{Reason:"ImportListStyleIsNull"}),t.get_listStyle()&&e.prototype.setListInfo.call(this,t)},t.prototype.adjustAndSetLevel=function(e,t,n,r){C.ULS.sendTraceTag(17622208,324,50,"AdjustAndSetLevel is called in OneNote."),this._indentationEditorLazy.get_value()||ji.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:"IOutlineElementIndentationEditorIsNull"}),this._indentationEditorLazy.get_value()&&this._indentationEditorLazy.get_value().canDemote(e,1)&&1===Ls.OutlineElementReader.getAbsoluteOutlineLevel(e)&&!this.doesOutlineHaveListofTypeAtLevel1(e,t)&&16!==t.get_listType()&&n.setValue(zl.k.autoDemoteLists,!0),this.applyListInfoOneNote(e,t,n)},t.prototype.transferListInfo=function(e,t,n,r){var i=ds.j.createFromScratch(15,0);i.setFrom(this.getListInfoFromOutlineElementNode(n)),i.clearNumbering(),this.applyListInfo(e,i)},t.prototype.getListInfoFromOutlineElementNode=function(e){if(!mc.ListReader.isListOutlineElementNode(e))return ji.y.get_instance().recordEvent("PossibleLossOfListProperties",{Reason:"NotListOutlineNode"}),null;var t=new Da.GraphIterator;return t.set(e),this.listReader.moveToList(t),this.get_hierarchicalListReader().getListInfoFromListNode(t)},t.prototype.doesOutlineHaveListofTypeAtLevel1=function(e,t){var n=new Da.GraphIterator;n.setFrom(e),Sc.returnToOutlineOrTableCell(n),vc.isOutlineNode(n.get_currentNode())||ji.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:M_.i.doesNotContainOe});for(var r=!1,i=n.goToFirstChildByRole(1);i;i=n.goToNextSiblingByRoleOrReturnToParent(1))if(!Ls.OutlineElementReader.isOutlineGroup(n)&&1===Ls.OutlineElementReader.getAbsoluteOutlineLevel(n)&&this.hasMatchingListType(n,t.get_listType())){n.returnToParent(),r=!0;break}return r},t.prototype.applyListInfo=function(e,t,n,r,i){void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===i&&(i=-1),this.applyListInfoOneNote(e,t)},t.prototype.applyListInfoOneNote=function(e,t,n){var r=this;void 0===n&&(n=null);var i=ji.y.get_instance().startActivity(ii.UD);i.get_properties().set_item("ListTypeToApply",t?IT[t.get_listType()]:"null"),Da.GraphIterator.executeVoidReturnWithDebugAssertRestored(e,(function(){if(!Ls.OutlineElementReader.isOutlineElement(e))return ji.y.get_instance().recordEvent("PossibleListStateNotUpdated",{Reason:M_.i.doesNotContainOe}),void i.end();if(!t||16===t.get_listType())return r.removeList(e),i.get_properties().set_item("ListRemoved","true"),void i.end();mc.ListReader.isListOutlineElement(e)||(r.createList(e),i.get_properties().set_item("CreatedList","true"),e.returnToParent());var o=r.listReader.getListInfo(e);if(!o||t.get_listType()===o.get_listType()&&t.hasMatchingListFormat(o)&&(!t.get_isOrdered()||t.get_restartAt()===o.get_restartAt()))return i.get_properties().set_item("NoOp","true"),void i.end();o.setFrom(t),r.setListFormattingIterator(e,n),i.end()}))},t.prototype.hasMatchingListType=function(e,t){return Ls.OutlineElementReader.isOutlineElement(e)||ji.y.get_instance().recordEvent("PossibleIncorrectListIndentation",{Reason:M_.i.doesNotContainOe}),!!mc.ListReader.isListOutlineElement(e)&&this.listReader.getListInfo(e).get_listType()===t},t.prototype.performAutoCorrectNumbering=function(e,t,n,r){if(!n.get_listType()&&t.goToPreviousSibling()){var i=e.getValueWithDefault(Number,zl.k.listLastStartAt,1);23===t.get_currentNodeType()&&1===i?(t.goToLastChildByRole(1),this.continueNumberingIfMatches(t,n,(0,p.m)((function(){return i}),(function(e){return i=e}))),t.returnToAncestorOfType(23)):e.hasProperty(zl.k.listLastStartAt)||n.get_listStyle()&&this.continueNumberingIfMatches(t,n,(0,p.m)((function(){return i}),(function(e){return i=e}))),e.setValue(zl.k.listLastStartAt,i),t.goToNextSibling()}return!0},t.prototype.continueNumberingIfMatches=function(e,t,n){if(e.hasChildrenOfRole(4)){var r=this.listReader.getListInfo(e);r.get_listType()===t.get_listType()&&r.get_listStyle()===t.get_listStyle()&&(n.val=r.get_lastStartAt()+1)}},t.prototype.setRestartAtIfNeeded=function(e,t,n){n||t.get_listType()||t.set_restartAt(e.getValueWithDefault(Number,Kc.b.listRestart,wm.z.startAtNone))},t.prototype.isTodoList=function(e){if(PT.b.isOutlineElementWithNoteTags(e)){var t=new Da.GraphIterator;if(t.setFrom(e),hs.OutlineElementNavigator.moveToContent(t)&&t.goToFirstChildByRole(88)&&DT.g(t,0))return!0}return!1},t.prototype.extendTodoList=function(e){var t=new Da.GraphIterator;t.setFrom(e),hs.OutlineElementNavigator.moveToContent(t)&&kT.n.get_instance().insertDefaultNoteTag(t,0)},t.prototype.setListFormattingIterator=function(e,t){if(e&&mc.ListReader.isListOutlineElement(e)){var n=e.goToFirstChildByRole(4);e.returnToParent();var r=e.goToFirstChildByRole(2);r&&cs.ParagraphReader.isParagraphNode(r)&&this.setListFormatting(n,r,t),hs.OutlineElementNavigator.returnToOutlineElement(e)}},t}(FT);(0,o.l)(RT,"HierarchicalListEditorCssVersion",FT,[]);var LT=function(){function e(e,t,n,r){this._listReader=null,this._outlineElementIndentationEditor=null,this._outlineElementEditor=null,this._listFormattingEditor=null,this.box4CssListSettingIsEnabled=!1,this.box4CssListSettingIsEnabled=mc.ListReader.get_isListMarkerEnabled(),this._listReader=e,this._outlineElementIndentationEditor=t,this._outlineElementEditor=n,this._listFormattingEditor=r}return e.prototype.get_box4CssListSettingIsEnabled=function(){return this.box4CssListSettingIsEnabled},e.prototype.create=function(){return this.get_box4CssListSettingIsEnabled()?(C.ULS.sendTraceTag(17622209,324,50,"ListMarker improvements are enabled."),new RT(this._listReader,this._outlineElementIndentationEditor,this._outlineElementEditor,this._listFormattingEditor)):new MT(this._listReader,this._outlineElementIndentationEditor,this._outlineElementEditor,this._listFormattingEditor)},e}();(0,o.l)(LT,"HierarchicalListEditorFactory",null,[wT]);var NT=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.ListEditors"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OutlineLevelEditorsDelayInitializationEnabled")&&function(e){e.register(LT).as(wT).singleInstance().usingFactory((function(){return new LT(e.resolve(ts.c),e.resolveLazy(xT.p),e.resolve(Es.p),e.resolve(AC.a))})),e.register(rs.v).singleInstance().usingFactory((function(){return e.resolve(wT).create()}))}(e)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(NT,"OneNoteListEditorsPackage",null,[l.u,c.s]);var BT=n(5021),OT=n(6682),UT=function(){function e(e,t,n){this._internalLinkManager=null,this._navigationUtils=null,this._workspace=null,this._internalLinkManager=e,this._navigationUtils=t,this._workspace=n}return e.prototype.registerActions=function(e){var t=nt.a;e.addAction(eb.od,t,o.i(this,this.navigateToConflict,"navigateToConflict")),e.addAction(eb.KC,t,o.i(this,this.navigateToVersion,"navigateToVersion")),e.addAction(eb.nZ,t,o.i(this,this.navigateToPage,"navigateToPage")),e.addAction(eb.ZK,cl.n,o.i(this,this.loadSectionWithoutNavigate,"loadSectionWithoutNavigate")),e.addAction(eb.Uu,cl.n,o.i(this,this.navigateToUrl,"navigateToUrl")),e.addAction(eb.nA,cl.n,o.i(this,this.navigateToNotebook,"navigateToNotebook")),e.addAction(eb.KX,cl.n,o.i(this,this.navigateToNotebookList,"navigateToNotebookList")),e.addAction(eb.Kh,cl.n,o.i(this,this.navigateToSection,"navigateToSection")),e.addAction(eb.Qx,cl.n,o.i(this,this.navigateToSectionGroup,"navigateToSectionGroup")),e.addAction(eb.aH,cl.n,o.i(this,this.toggleSectionGroupExpanded,"toggleSectionGroupExpanded"))},e.prototype.navigateToConflict=function(e,t,n,r,i){var o=i,a=Dt.h.createFromString(o.ParentId.toString()),s=this._workspace.get_activeSection().getChildGraphSpaceNodeForObjectSpace(a),l=Dt.h.createFromString(o.ConflictId.toString()),c=s.getChildGraphSpaceNodeForObjectSpace(l);return this._workspace.set_activePage(c),32},e.prototype.navigateToVersion=function(t,n,r,i,o){var a=o,s=Dt.h.createFromString(a.ParentId.toString()),l=this._workspace.get_activeSection().getChildGraphSpaceNodeForObjectSpace(s),c=Dt.h.createFromString(a.ContextId.toString()),u=e.get_pageNavigator().getVersionHistoryNode(l).getChildGraphSpaceNodeForContext(c,!1);return this._workspace.set_activePage(u),32},e.prototype.navigateToPage=function(e,t,n,r,i){var o=i,a=Dt.h.createFromString(o.PageId.toString());C.ULS.sendTraceTag(40960133,1600,50,"NavigationActor::NavigateToPage with pageCellId: {0}",a);var s=this._workspace.get_activeSection().getChildGraphSpaceNodeForObjectSpace(a);return this._workspace.set_activePage(s),32},e.prototype.navigateToSection=function(e,t,n,r,i){var o=i;C.ULS.sendTraceTag(40960134,1600,50,"NavigationActor::NavigateToSection with sectionId: {0}, parentFolder: {1}",o.SectionId.toString(),o.ParentId.toString());var a=""===o.ParentId.toString()?Br.App.theNotebookManager.get_defaultNotebookNode():this._navigationUtils.findSectionGroupWithFileId(o.ParentId.toString());return this._navigationUtils.switchSection(o.SectionId.toString(),a)?32:8},e.prototype.loadSectionWithoutNavigate=function(e,t,n,r,i){var o=i,a=""===o.ParentId.toString()?Br.App.theNotebookManager.get_defaultNotebookNode():this._navigationUtils.findSectionGroupWithFileId(o.ParentId.toString()),s=o.Callback;return this._navigationUtils.loadSectionWithCallback(o.SectionId.toString(),a,s)?32:8},e.prototype.navigateToUrl=function(e,t,n,r,i){var o=i;return this._internalLinkManager.handleInternalLink(o.Url.toString()),32},e.prototype.navigateToNotebook=function(e,t,n,r,i){var o=i;try{if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEmbedMode")){var a={};a.Url=o.Url.toString(),se.w.get_instance().resolve(OT.q).sendMessage("App_SwitchNotebook",a)}}catch(e){return C.ULS.sendTraceTag(50733516,1600,50,"Exception swallowed in attempted navigation to another notebook through NotebookPane"),8}return 32},e.prototype.navigateToNotebookList=function(e,t,n,r,i){if(!Wr.App.oneNoteNotebooksUrl)return 8;try{L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteTwoPaneNavPaneIsEnabled")?window.open(Wr.App.oneNoteNotebooksUrl,"_blank"):window.open(Wr.App.oneNoteNotebooksUrl,"_top")}catch(e){return C.ULS.sendTraceTag(21616159,1600,50,"Exception swallowed in attempted navigation to NotebookList"),8}return 32},e.prototype.navigateToSectionGroup=function(e,t,n,r,i){var o=i.SectionGroupId.toString();return this._navigationUtils.toggleSectionGroupExpanded(o,!1)?32:8},e.prototype.toggleSectionGroupExpanded=function(e,t,n,r,i){var o=i,a=o.SectionGroupId.toString(),s=o.IsExpanded;return this._navigationUtils.toggleSectionGroupExpanded(a,s)?32:8},e.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e}();(0,o.l)(UT,"NavigationActor",null,[]);var HT=function(){function e(e,t,n){this._internalLinkManager=null,this._workspace=null,this._messenger=null,this._isPoppingFromHistory=!1,this._internalLinkManager=e,this._workspace=t,this._messenger=n}return e.prototype.registerActions=function(t){t.addAction(eb.yK,cl.n,o.i(this,this.altLeftArrow,"altLeftArrow")),t.addAction(eb.Oj,cl.n,o.i(this,this.altRightArrow,"altRightArrow"));var n=Nt.FocusManager.instance().getScope($e.AFrame.mainAppFocusId);$e.AFrame.bindWithDoNothingFallback(n,Xe.KeyInputManager.hashKey(Je.v.vK_LeftArrow,1),eb.yK),$e.AFrame.bindWithDoNothingFallback(n,Xe.KeyInputManager.hashKey(Je.v.vK_RightArrow,1),eb.Oj),this._workspace.add_activePageChanged(o.i(this,this.pushPage,"pushPage")),this.pushPage(),this._messenger.addAllowedReceivingMessage(e.popState),this._messenger.registerCallback(e.popState,o.i(this,this.popPage,"popPage"))},e.prototype.popPage=function(t){try{this._isPoppingFromHistory=!0,this._internalLinkManager.activatePage(t.Values[e.state])}catch(e){C.ULS.sendTraceTag(22291219,1600,15,"Exception encountered in PopPage: {0}",e)}finally{this._isPoppingFromHistory=!1}C.ULS.sendTraceTag(38400023,1600,50,"Navigated using browser history.")},e.prototype.pushPage=function(t,n){void 0===t&&(t=null),void 0===n&&(n=null);try{var r=window.history;if(!this._isPoppingFromHistory&&r.pushState&&this._workspace.get_activePage()&&!e.get_pageReader().isVersionNode(this._workspace.get_activePage())&&!e.get_pageReader().isConflictPageNode(this._workspace.get_activePage())){var i={},o=Wr.App.buildPageUrl(this._workspace.get_activePage());i[e.url]=o,i[e.state]=o,this._messenger.sendMessage(e.pushState,i)}}catch(e){C.ULS.sendTraceTag(22291220,1600,15,"Exception encountered in PushPage: {0}",e)}},e.prototype.altLeftArrow=function(e,t,n,r,i){return window.history.back(),32},e.prototype.altRightArrow=function(e,t,n,r,i){return window.history.forward(),32},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e.popState="App_PopState",e.pushState="App_PushState",e.url="Url",e.state="State",e}();(0,o.l)(HT,"NavigationHistoryActor",null,[]);var GT=n(4005),VT=n(8362),WT="OneNoteNavViewPinSaveToCookieIsEnabled",zT=function(e){function t(t,n,r,i,o){var a=e.call(this,t,n,r,o)||this;return a._parentNavigationView=null,a._appSettingsManager=null,a._isPinned=!1,a._userSetPinnedState=!1,a._cookieSupportEnabled=!1,a._appSettingsManager=i,a._cookieSupportEnabled=!!a._appSettingsManager&&a._appSettingsManager.getBooleanAppSetting(WT),a}return(0,S.t)(t,e),t.prototype.get_clientWidth=function(){return this.buttonElement.clientWidth},t.prototype.get_cookieValue=function(){return!!this._cookieSupportEnabled&&ve.e("WacOneNotePinNav",!1)},t.prototype.get_isPinned=function(){return this._isPinned},t.prototype.get_isCookieSet=function(){return this._cookieSupportEnabled&&""!==ve.g("WacOneNotePinNav")},t.prototype.get_userSetPinnedState=function(){return this.get_isCookieSet()||this._userSetPinnedState},t.prototype.get_parentNavigationView=function(){return this._parentNavigationView},t.prototype.set_parentNavigationView=function(e){return this._parentNavigationView=e,e},t.prototype.changePinnedState=function(e){this.changePinnedStateWithoutNavPaneUpdate(e),this._parentNavigationView&&(this._isPinned||this._parentNavigationView.tryCollapseView(!1))},t.prototype.changePinnedStateWithoutNavPaneUpdate=function(e){this._isPinned=e,this.setButtonImageAndText()},t.prototype.saveCookie=function(){this._cookieSupportEnabled&&(ve.r("WacOneNotePinNav",this._isPinned?"true":"false",ve.i)||C.ULS.sendTraceTag(6824534,1600,50,"Failed to set cookie for navigation pin to {0}",this._isPinned))},t.prototype.addToContainer=function(e){this._isPinned=!1,this.addImageButtonToContainer(e,"NavigationViewPinButton","NavigationViewPinButtonImage",this.createImageElement(20,20,this.getPinImage()),"NavigationViewPinButton",this.getAccessibilityString(),this.getPinTitle()),this.set_isEnabled(!0),this.get_isCookieSet()&&(C.ULS.sendTraceTag(6885953,1600,50,"Cookie for nav pin is set on boot. Value is ",this.get_cookieValue().toString()),this._isPinned=this.get_cookieValue(),this.saveCookie()),this.changePinnedState(this._isPinned)},t.prototype.getPinImage=function(){return this._isPinned?"PushpinPushed_20x20x32":"PushpinNormal_20x20x32"},t.prototype.getPinTitle=function(){return this._isPinned?OneNoteIntl.OneNoteStrings.L_Navigation_UnpinPane:OneNoteIntl.OneNoteStrings.L_Navigation_PinPane},t.prototype.getAccessibilityString=function(){return this.getPinTitle()},t.prototype.setButtonImageAndText=function(){var e=this.buttonElement.querySelector("span"),t=this.createImageElement(20,20,this.getPinImage());t.className=e.className,this.buttonElement.replaceChild(t,e),this.buttonElement.title=this.getPinTitle(),this.buttonElement.setAttribute("title",this.getPinTitle()),this.buttonElement.setAttribute(Ot.t.ariaLabelAttribute,this.getAccessibilityString())},t.prototype.executeButtonAction=function(e){C.ULS.sendTraceTag(6611290,1600,50,"OneNote navigation pin button clicked: {0}",this._isPinned),this._userSetPinnedState=!0,this.changePinnedState(!this._isPinned),this.setButtonImageAndText(),this.saveCookie()},t.get_domButtonId=function(){return"NavigationViewPinButton"},t}(VT.e);(0,o.l)(zT,"NavigationViewPinButton",VT.e,[BT.s,Sys.IDisposable]);var KT=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.Navigation"},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(zT).as(BT.s).singleInstance().usingFactory((function(){return new zT(L.AFrameworkApplication.get_activeFrame().workspace,hn.s.get_instance(),Xe.KeyInputManager.get_instance(),L.AFrameworkApplication.appSettingsManager,Lt.createClusteredImage)})),this._container.register(GT.v).singleInstance().usingFactory((function(){return new GT.v(L.AFrameworkApplication.get_activeFrame().workspace,Qc.PageReader.get_instance(),t._container.resolve(CT.f),hT.FolderReader.get_instance(),L.AFrameworkApplication.get_theActionManager())})),this._container.register(UT).singleInstance().usingFactory((function(){return new UT(t._container.resolve(dT.b),t._container.resolve(GT.v),L.AFrameworkApplication.get_activeFrame().workspace)})),this._container.register(HT).singleInstance().usingFactory((function(){return new HT(t._container.resolve(dT.b),L.AFrameworkApplication.get_activeFrame().workspace,t._container.resolve(OT.q))}))},e.prototype.init=function(){this._container.resolve(zT),this._container.resolve(UT).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteNavigationHistoryIsEnabled")&&this._container.resolve(HT).registerActions(L.AFrameworkApplication.get_theActionManager())},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(KT,"OneNoteNavigationPackage",null,[l.u,c.s]);var qT=n(6133),jT=n(9273),$T=n(4223),QT=n(2691),JT=n(2080),XT=n(4826),YT=n(6987),ZT=(0,o.y)("IPageSeriesEditor"),eA=n(2725),tA=n(1230),nA=(0,o.y)("INotebookEditor"),rA=n(7566),iA=n(7814),oA=n(2065),aA=function(){return function(){this.callbackdata=null,this.destGraphSpaceNode=null,this.sectionGroupGraphSpaceNode=null,this.sectionGroupCreationSucceededCallback=null,this.sectionGroupCreationFailedCallback=null,this.sectionGroupId=null}}();(0,o.l)(aA,"SectionGroupCreationCallbackData",null,[]);var sA=n(6668),lA=function(){function e(e,t,n,r,i){this._workspaceResolver=null,this._recycleBinHelper=null,this._folderEditorHelper=null,this.sectionGroupCreationRetry=2,this._folderContentEditor=null,this._graphTransactionFactory=null,this.recycleBinSectionGroupCreationInterval=15e3,this._folderContentEditor=e,this._graphTransactionFactory=t,this._workspaceResolver=n,this._recycleBinHelper=r,this._folderEditorHelper=i}return e.prototype.activateNextAvailablePage=function(e){var t=new Da.GraphIterator;if(t.set(e.getParentGraphSpace()),t.goToChild(e),t.goToNextSiblingByRole(79)){if(!_T.D(t)||iA.r(t.get_currentNode()))return;var n=_T.P(t.get_currentNode());if(n||t.get_currentNode().get_isContentPresent())(n=ST.getNextPageInNewSection(e))&&this._workspaceResolver().set_activePage(n);else{var r=t.get_currentNode();r.get_contentReplicator()||r.attachContentReplicator("FolderView_ActiveAvailablePage"),r.get_contentReplicator().forceInbound(o.i(this,this.setNextVisiblePageAfterLoad,"setNextVisiblePageAfterLoad"),null,r)}}},e.prototype.activatePreviousAvailablePage=function(e){var t=new Da.GraphIterator;for(t.set(e.getParentGraphSpace()),t.goToChild(e);t.goToPreviousSiblingByRole(79);){if(!_T.D(t)||iA.r(t.get_currentNode()))return;var n=_T.L(t.get_currentNode());if(n||t.get_currentNode().get_isContentPresent())(n=ST.getPreviousPageInNewSection(e))&&this._workspaceResolver().set_activePage(n);else{var r=t.get_currentNode();r.get_contentReplicator()||r.attachContentReplicator("FolderView_ActivePreviousAvailablePage"),r.get_contentReplicator().forceInbound(o.i(this,this.setLastVisiblePageAfterLoad,"setLastVisiblePageAfterLoad"),null,r)}return}},e.prototype.setNextVisiblePageAfterLoad=function(e){var t=e,n=_T.P(t);n?this._workspaceResolver().set_activePage(n):(n=ST.getNextPageInNewSection(t))&&this._workspaceResolver().set_activePage(n)},e.prototype.setLastVisiblePageAfterLoad=function(e){var t=e,n=_T.L(t);n?this._workspaceResolver().set_activePage(n):(n=ST.getPreviousPageInNewSection(t))&&this._workspaceResolver().set_activePage(n)},e.prototype.getNextPage=function(e,t){var n=null;return e?((n=this.get_pageNavigator().getNextVisiblePage(e,!0))||this.activateNextAvailablePage(t),n):n=ST.getNextPageInNewSection(t)},e.prototype.getPreviousPage=function(e,t){var n=null;return e?((n=this.get_pageNavigator().getPrevVisiblePage(e,!0))||this.activatePreviousAvailablePage(t),n):n=ST.getPreviousPageInNewSection(t)},e.prototype.createSectionGroup=function(e,t,n,r,i){var a=new aA;return a.callbackdata=i,a.sectionGroupCreationSucceededCallback=t,a.sectionGroupCreationFailedCallback=n,this.createSectionGroupAndSection(e,o.i(this,this.sectionGroupCreationReplicationSucceededCallback,"sectionGroupCreationReplicationSucceededCallback"),o.i(this,this.sectionGroupCreationReplicationFailedCallback,"sectionGroupCreationReplicationFailedCallback"),r,null,a,0)},e.prototype.createSectionGroupAndSection=function(e,t,n,r,i,a,s){var l=this;void 0===s&&(s=0);var c=Wr.App.extractIdForApiCall(e.get_fileId(),!0);if(""===c)return!1;n||(n=o.i(this,this.noOpReplicationFailedCallback,"noOpReplicationFailedCallback"));var u=this._folderEditorHelper.getGraphSpaceNodeType(e);if(!u)return!1;var g=Br.App.webServiceBase+String.format("OneNoteS2SHandler.ashx?action=sectiongroup&destgraphspacenodeid={0}&sectiongroupname={1}&{2}&destgraphspacetype={3}",Jn.l.urlKeyValueEncode(c),Jn.l.urlKeyValueEncode(r),L.AFrameworkApplication.baseDocQuerySignatureWithoutVersion,Jn.l.urlKeyValueEncode(u));i&&(g+=String.format("&sectionname={0}",i));var p={"Content-Type":"application/json; charset=utf-8"};if(Wr.App.isSharePointNotebook(c)){var d=Wr.App.extractSiteUrl(e.get_fileId());if(""===d)return C.ULS.sendTraceTag(19730785,339,15,"Site URL is empty."),!1;p.OrgIdSiteUrl=d}return s++,C.ULS.sendTraceTag(19957524,339,50,"Api call issued to create a section group."),L.AFrameworkApplication.theClientRequestManager.addRequest(g,2,null,p,!1,2,(function(r){l.onSectionGroupCreationSucceed(r,e,t,n,a)}),(function(o){l.onSectionGroupCreationFail(o,e,t,n,r,i,a,s)}),null,void 0,void 0,void 0,Wr.App.get_oneNoteS2SRequestTimeoutMs()),!0},e.prototype.sectionGroupCreationReplicationSucceededCallback=function(e){var t=(0,f.e)(aA,e);C.ULS.sendTraceTag(19957525,339,50,"Api call succeeded to create a section group."),t.sectionGroupCreationSucceededCallback(t.callbackdata,t.sectionGroupGraphSpaceNode)},e.prototype.sectionGroupCreationReplicationFailedCallback=function(e,t){var n=(0,f.e)(aA,e);C.ULS.sendTraceTag(19957526,339,10,"Api call failed to create a section group, error code {0}.",t),n.sectionGroupCreationFailedCallback(n.callbackdata,t)},e.prototype.noOpReplicationFailedCallback=function(e,t){},e.prototype.onSectionGroupCreationSucceed=function(e,t,n,r,i){var a=null,s=(0,f.e)(aA,i);if(e&&s){try{var l=w.d(e.get_data().responseData);if(l){if(!(a=l.id)){if(o.r(sA.y,i))(0,f.e)(sA.y,i).lastFailure="OnSectionGroupCreationSucceed: response has no section group id";return void r(i,-1)}s.sectionGroupId=a}}catch(e){if(o.r(sA.y,i))(0,f.e)(sA.y,i).lastFailure=String.format("OnSectionGroupCreationSuccess: exception thrown when parsing section group API success : {0}",e.message);return void r(i,-1)}this.replicateNewlyCreatedSectionGroup(t,n,r,i)}else{var c=(0,f.e)(sA.y,i);c&&(c.attempt=0,c.sectionGroupCreationFailedCallback=r,c.sectionGroupCreationSucceededCallback=n,this.replicateNewlyCreatedSectionGroup(t,n,o.i(this,this.onNewlyCreatedSectionGroupReplicatedFailed,"onNewlyCreatedSectionGroupReplicatedFailed"),c))}},e.prototype.replicateNewlyCreatedSectionGroup=function(e,t,n,r){var i=this,o=e.get_contentReplicator();o.set_knowledge(null),o.forceInbound((function(o){i.onNewlyCreatedSectionGroupReplicatedSucceed(e,t,n,r)}),n,r)},e.prototype.onNewlyCreatedSectionGroupReplicatedFailed=function(e,t){var n=(0,f.e)(sA.y,e);if(n)if(n.attempt<this.sectionGroupCreationRetry){var r=n.sectionGroupCreationSucceededCallback;n.attempt=n.attempt+1;var i=n.notebook;this.replicateNewlyCreatedSectionGroup(i,r,o.i(this,this.onNewlyCreatedSectionGroupReplicatedFailed,"onNewlyCreatedSectionGroupReplicatedFailed"),e)}else{(0,n.sectionGroupCreationFailedCallback)(e,t)}},e.prototype.onSectionGroupCreationFail=function(e,t,n,r,i,a,s,l){var c=this;if(C.ULS.sendTraceTag(19710980,339,100,"OnSectionGroupCreationFail: Http Status{0}"+e.get_data().httpStatus),e.get_data().httpStatus===re.f)if(i===this._recycleBinHelper.getRecycleBinSectionListName()){var u=new De.c(4,1,this.recycleBinSectionGroupCreationInterval,(function(e){c.onSectionGroupCreationSucceed(null,t,n,r,s)}),47);L.AFrameworkApplication.get_theTaskManager().addTask(u)}else{if(o.r(sA.y,s))(0,f.e)(sA.y,s).lastFailure="OnSectionGroupCreationFail: we have a conflict but the new section group name doesn't match recycle bin";r(s,this._folderEditorHelper.convertToOperationResult(e))}else if((e.get_data().httpStatus===re.Vu||i===this._recycleBinHelper.getRecycleBinSectionListName())&&l<=1&&oA.o.canRetryRequest(e))this.createSectionGroupAndSection(t,n,r,i,a,s,l);else{if(o.r(sA.y,s))(0,f.e)(sA.y,s).lastFailure="OnSectionGroupCreationFail: unknown reason";r(s,this._folderEditorHelper.convertToOperationResult(e))}},e.prototype.onNewlyCreatedSectionGroupReplicatedSucceed=function(e,t,n,r){var i=(0,f.e)(aA,r);if(i){var a=i.sectionGroupId,s=this._folderEditorHelper.getSectionGroupGraphSpaceNode(e,a);if(!s){if(o.r(sA.y,r))(0,f.e)(sA.y,r).lastFailure=String.format("OnNewlyCreatedSectionGroupReplicatedSucceed: Can't find a graphspace node with the specified graph space node id {0}",a);return void n(r,-1)}i.sectionGroupGraphSpaceNode=s,t(r)}else{var l=this._recycleBinHelper.getRecycleBinGraphSpaceNode(e);if(!l){if(o.r(sA.y,r))(0,f.e)(sA.y,r).lastFailure=String.format("OnNewlyCreatedSectionGroupReplicatedSucceed: Can't find the recyclebin section group graph space node");return void n(r,-1)}this._recycleBinHelper.loadRecycleBinSectionGroup(l,t,n,r)}},e.prototype.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.prototype.moveSection=function(e,t){var n=this._graphTransactionFactory.getTransaction(7);n.setFromNode(e);var r=new Da.GraphIterator;r.set(e),r.tryToRootAtAncestorOfType(4),r.returnToAncestorOfType(4);var i=r.get_currentNode(),o=null;t&&(r.set(t),r.tryToRootAtAncestorOfType(4),r.returnToAncestorOfType(4),o=r.get_currentNode()),r.set(e),r.tryToRootAtAncestorOfType(1),r.returnToAncestorOfType(1);var a=r.get_currentNode();r.goToChild(e),r.disconnectNodeAndReturnToParent(),r.insertChild(e,t,79),r.returnToAncestorOfType(1),r.goToFirstChildByRole(80),r.goToChild(i);var s=new Da.GraphIterator;s.set(a),qr.k(s);var l=s.get_currentNode();s.insertChild(i,o,1),r.disconnectNodeAndReturnToParent();var c=Da.GraphIterator.createFromNode(l);this._folderContentEditor.updateFileIdentityGuids(c);var u=new Da.GraphIterator;if(u.set(i),u.tryToRootAtAncestorOfType(3)){u.returnToAncestorOfType(3);for(var g=1,p=u.goToFirstChild();p&&4===p.get_type();p=u.goToNextSiblingOrReturnToParent())p.get_properties().setValue(Kc.b.sectionOrder,g),g++}n.dispose()},e.prototype.sectionNameInUse=function(e,t){if(!e||""===e)return!1;var n=new Da.GraphIterator;n.set(t);for(var r=n.goToFirstChildByRole(79);r;r=n.goToNextSiblingByRole(79)){if(!_T.D(n))return!1;if(Jn.l.toLower(_T.k(r))===Jn.l.toLower(e))return!0}return!1},e}();(0,o.l)(lA,"FolderEditor",null,[$T.x]);var cA=n(6799),uA=function(){function e(){}return e.prototype.getGraphSpaceNodeType=function(e){return iA.z(e)?"notebooks":hT.FolderReader.isSectionGroupNode(e)?"sectiongroups":null},e.prototype.convertToOperationResult=function(e){switch(e.get_data().httpStatus){case re.Vu:return 28;case re.f:return 131;case re.Al:case re.ih:return-1}if(!e.get_data().responseData)return-1;var t=0;try{var n=w.d(e.get_data().responseData);n&&n.error.code&&(t=Number.parseInvariant(n.error.code))}catch(e){return-1}var r=-1;switch(t){case 10007:r=46}return C.ULS.sendTraceTag(19710983,339,100,String.format("ConvertToOperationResult: ErrorCode:{0} OperationResult:{1}",t,r)),r},e.prototype.getSectionGroupGraphSpaceNode=function(e,t){var n=this.removeHostPrefix(t);return Wr.App.isSharePointNotebook(t)&&(n=n.split("-").join("")),n=Jn.l.urlKeyValueEncode(n),this.getGraphSpaceNode(e,(function(e){return e.get_fileId().toUpperCase().indexOf(n)>0}))},e.prototype.removeHostPrefix=function(e){return(e=e.toUpperCase()).substr(2)},e.prototype.getGraphSpaceNode=function(e,t){var n=new vT.m;n.set(e);for(var r=n.goToFirstChild();r;){var i=(0,f.e)(cA.e,r);if(i&&t(i))return i;r=n.goToNextSibling()}return null},e}();(0,o.l)(uA,"FolderEditorHelper",null,[jT.q]);var gA=function(){function e(e,t,n){this._folderContentEditor=null,this._recycleBinHelper=null,this._folderEditor=null,this._folderContentEditor=e,this._recycleBinHelper=t,this._folderEditor=n}return e.prototype.ensureDeletedPagesExists=function(e,t,n,r){r.notebook=e;var i=this._recycleBinHelper.getRecycleBinGraphSpaceNode(e);i?i.get_isContentPresent()?(r.recycleBinDeletedPagesNode=this._recycleBinHelper.getDeletedPagesNode(i),t(r)):this._recycleBinHelper.loadRecycleBinSectionGroup(i,t,n,r):this.createRecycleBinAndDeletedPages(e,t,n,r)||(r.lastFailure="EnsureDeletedPagesExists: An API to create the recycle bin or the deleted pages section was not successful",n(r,-1))},e.prototype.getRecycleBinGraphSpaceNode=function(e){return this._recycleBinHelper.getRecycleBinGraphSpaceNode(e)},e.prototype.createRecycleBinAndDeletedPages=function(e,t,n,r){return this._folderEditor.createSectionGroupAndSection(e,t,n,this._recycleBinHelper.getRecycleBinSectionListName(),this._recycleBinHelper.getDeletedPagesSectionName(),r,0)},e}();(0,o.l)(gA,"NotebookEditor",null,[nA]);var pA=function(){function e(){}return e.prototype.removeIsSignedProperty=function(e){},e.prototype.removeIsMarkedAsFinalProperty=function(e){},e.prototype.forceDeletePage=function(e){},e.prototype.onPageDeleteFailure=function(e,t){},e.prototype.setHasPageVersions=function(e,t){},e.prototype.setTitle=function(e,t){},e}();(0,o.l)(pA,"PageEditor$0",null,[rA.f]);var dA=n(2027),hA=function(){function e(e,t,n,r,i){this._page=null,this._newSection=null,this._insertAfter=null,this._insertAtEnd=!1,this._pageEditor=null,this._setActivePageToCopyPage=!1,this._pageEditor=e,this._page=t,this._newSection=n,this._insertAfter=r,this._insertAtEnd=i,this._setActivePageToCopyPage=!1}return e.prototype.execute=function(t){e.get_pageReader().hasBeenDeleted(this._page)||(this._newSection.getHtmlViewElement(Br.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId()).setIsLoading(!1),this._newSection.get_isContentPresent()&&this._pageEditor.copy(this._page,this._newSection,this._insertAfter,this._insertAtEnd,this._setActivePageToCopyPage),this.showCopySuccessNotification(this._page,this._newSection))},e.prototype.showCopySuccessNotification=function(t,n){var r=e.get_pageReader().getTitle(t),i=_T.k(n),o=String.format(OneNoteIntl.OneNoteStrings.L_CopyPageSucceedToastMessage,r,i),a=Br.App.get_activeAppFrame().get_notificationBar().createEntry(o,!1);Br.App.get_activeAppFrame().get_notificationBar().addEntry(a)},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e}();(0,o.l)(hA,"DeferredPageCopy",null,[]);var _A=function(){function e(e,t,n){this._pageNode=null,this._level=0,this._pageEditor=null,this._pageEditor=e,this._pageNode=t,this._level=n}return e.prototype.execute=function(e){var t=this._pageNode,n=this._level;t.get_isContentPresent()&&this._pageEditor.setLevel(t,n)},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e}();(0,o.l)(_A,"DeferredPageIndent",null,[]);var mA=function(){function e(e,t,n,r,i,o,a){void 0===a&&(a=!0),this._page=null,this._newSection=null,this._insertAfter=null,this._insertAtEnd=!1,this._pageEditor=null,this._setActivePageToCopyPage=!1,this._workspace=null,this._pageEditor=e,this._workspace=t,this._page=n,this._newSection=r,this._insertAfter=i,this._insertAtEnd=o,this._setActivePageToCopyPage=a}return e.prototype.execute=function(t){e.get_pageReader().hasBeenDeleted(this._page)||(this._newSection.getHtmlViewElement(Br.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId()).setIsLoading(!1),this._newSection.get_isContentPresent()&&(this._pageEditor.move(this._page,this._newSection,this._insertAfter,this._insertAtEnd,this._setActivePageToCopyPage),this._workspace.onGraphSpaceShutdown(this._page)))},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e}();(0,o.l)(mA,"DeferredPageMove",null,[]);var fA=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n,r,i,o,a)||this;return s._setActivePageToCopyPage=!1,s}return(0,S.t)(t,e),t.prototype.execute=function(t){e.prototype.execute.call(this,t);var n=mA.get_pageReader().getTitle(this._page),r=_T.k(this._newSection),i=String.format(OneNoteIntl.OneNoteStrings.L_RestorePageSucceedToastMessage,n,r);this._workspace.onGraphSpaceShutdown(this._page),this._pageEditor.showDeleteRestorePageToast(i)},t}(mA);(0,o.l)(fA,"DeferredPageRestore",mA,[]);var yA=n(7853),CA=function(e){function t(t,n,r,i,o,a,s){var l=e.call(this)||this;return l._firstMoveToNewSection=!0,l._sectionContentEditorLazy=null,l._notebookEditorLazy=null,l._sectionEditorLazy=null,l._versionHistoryEditor=null,l._workspaceResolver=null,l._recycleBinHelperLazy=null,l._businessBarControllerFuture=null,l._deleteRestorePageMessage=null,l._undoManager=null,l._deleteRestorePageNotificationTask=null,l._deleteRestorePageNotificationPending=!1,l._pageSeriesEditorLazy=null,l._graphSpaceEditor=null,l._graphTransactionFactory=null,l._pageSeriesEditorLazy=t,l._graphSpaceEditor=n,l._graphTransactionFactory=r,l._notebookEditorLazy=i,l._sectionContentEditorLazy=o,l._sectionEditorLazy=a,l._workspaceResolver=function(){return Br.App.get_activeAppFrame()?Br.App.get_activeAppFrame().workspace:null},l._recycleBinHelperLazy=s,l}return(0,S.t)(t,e),t.prototype.get_businessBarControllerFuture=function(){return this._businessBarControllerFuture||(this._businessBarControllerFuture=se.w.get_instance().resolveFuture(ni.d))},t.prototype.get_notebookEditor=function(){return this._notebookEditorLazy.get_value()},t.prototype.get_sectionContentEditor=function(){return this._sectionContentEditorLazy.get_value()},t.prototype.get_sectionEditor=function(){return this._sectionEditorLazy.get_value()},t.prototype.get_undoManager=function(){return this._undoManager||(this._undoManager=se.w.get_instance().resolve(ja.n))},t.prototype.get_firstMoveToNewSection=function(){return this._firstMoveToNewSection},t.prototype.set_firstMoveToNewSection=function(e){return this._firstMoveToNewSection=e,e},t.prototype.get_workspaceResolver=function(){return this._workspaceResolver},t.prototype.set_workspaceResolver=function(e){return this._workspaceResolver=e,e},t.prototype.get_versionHistoryEditor=function(){return this._versionHistoryEditor||(this._versionHistoryEditor=se.w.get_instance().resolve(tA.e))},t.prototype.get_recycleBinHelper=function(){return this._recycleBinHelperLazy.get_value()},t.prototype.get_oneNotePageReader=function(){return dA.x.get_instance()},t.prototype.move=function(e,t,n,r,i){void 0===i&&(i=!0),Xi.t.mark(6257);var o=this.get_pageNavigator().getContainingSection(e);o?1===o.get_accessRights()&&1===t.get_accessRights()&&(o!==t?this.movePageOutOfSection(e,t,n,r,i):this.moveWithinSection(e,n)):C.ULS.sendTraceTag(595341391,339,15,"Cannot find contain section of the original Page.")},t.prototype.restorePage=function(e,t){var n=this;L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IOneNoteRecycleBinSettings"),C.ULS.sendTraceTag(19957527,339,50,"Restore page from recyclebin start.");var r=this.get_pageReader().getTitle(e),i=_T.k(t);if(t.get_isContentPresent()){this.move(e,t,null,!0,!1);var o=String.format(OneNoteIntl.OneNoteStrings.L_RestorePageSucceedToastMessage,r,i);this._workspaceResolver().onGraphSpaceShutdown(e),this.showDeleteRestorePageToast(o)}else{var a=this.createDeferredPageRestoreCallback(e,t,!0),s=String.format(OneNoteIntl.OneNoteStrings.L_RestorePageFailureToastMessage,r,i);this.get_sectionEditor().load(t,a,(function(e,t){C.ULS.sendTraceTag(38105925,339,15,s),n.showDeleteRestorePageToast(s)}),null)}},t.prototype.moveWithinSection=function(e,t){Xi.t.mark(6257);var n=this.get_pageNavigator().getContainingSection(e);if(e.get_isContentPresent()){var r=this.get_pageSeriesEditor().getPageSeriesOfPage(e),i=this._graphTransactionFactory.getTransaction(7);i.setFromNode(n),e.ensureContentGraphConnection(),this.updateLevelsInSeriesBeforePageRemoval(e);var o=new Da.GraphIterator;o.set(e),o.tryToRootAtAncestorOfType(1),o.returnToAncestorOfType(1),o.goToChild(e);var a=new Da.GraphIterator;a.set(r),a.tryToRootAtAncestorOfType(5),this.putPageInCurrentSection(e,t,a,o),n.ensureContentGraphConnection(),Xi.t.mark(6258),i.dispose()}else this.loadPageBeforeMove(e,n,t,!1)},t.prototype.putPageInCurrentSection=function(e,t,n,r){var i=this.get_pageNavigator().getContainingSection(e),o=this.getNewLevelForPage(i,t),a=this.get_pageSeriesEditor().getPageSeriesOfPage(e),s=new Da.GraphIterator;s.set(i);var l=this.get_pageSeriesEditor().getPageSeriesOfPage(t);s.insertChild(e,t,79),ay.moveToSectionContentIfLoaded(s);var c=this.get_pageReader().getLevel(e);if(o===Qc.PageReader.minPageLevel&&o===c)s.insertChild(a,l,1),n.disconnectNodeAndReturnToParent();else if(c===Qc.PageReader.minPageLevel&&c!==o)l&&this.get_pageSeriesEditor().moveCachedMetadataReference(a,l,e),1===n.getChildCount()?n.disconnectNodeAndReturnToParent():(C.ULS.shipAssertTag(6373588,324,!1),n.goToChild(e),n.disconnectNodeAndReturnToParent()),s.goToChild(l),s.insertChild(e,t,75);else if(c!==Qc.PageReader.minPageLevel&&o===Qc.PageReader.minPageLevel){var u=void 0;(u=l?Da.GraphIterator.createFromNode(l):Da.GraphIterator.createFromNode(a)).tryToRootAtAncestorOfType(5),u.returnToParent();var g=this.get_sectionContentEditor().insertPageSeries(u,l);this.get_pageSeriesEditor().moveCachedMetadataReference(a,g,e),n.goToChild(e),n.disconnectNodeAndReturnToParent(),u.addChild(e,75)}else{if(n.goToChild(e),n.disconnectNodeAndReturnToParent(),a===l)n.insertChild(e,t,75);else Da.GraphIterator.createFromNode(l).insertChild(e,t,75),this.get_pageSeriesEditor().moveCachedMetadataReference(a,l,e)}r.disconnectNodeAndReturnToParent(),o!==c&&this.setLevel(e,o)},t.prototype.movePageOutOfSection=function(e,t,n,r,i){if(void 0===i&&(i=!0),!t.get_relativePath())if(!this._firstMoveToNewSection||this.get_recycleBinHelper()&&(this.get_recycleBinHelper().isDeletedPagesSectionNode(t)||this.get_recycleBinHelper().isPageInRecycleBin(e)))if(e.get_isContentPresent())if(t.get_isContentPresent()){var o=this._graphTransactionFactory.getTransaction(7);o.setFromNode(t);var a=t.createChildGraphSpace(1,"MovePageOutOfSection");if(r?this.putPageAtEndOfNewSection(t,e,a):this.putPageInNewSection(t,e,a,n),i){var s=this._workspaceResolver();s.get_activePage()===e&&s.set_activePage(a)}if(e.get_contentReplicator().set_blockingPageCopy(a),this.get_recycleBinHelper()&&(this.get_recycleBinHelper().isDeletedPagesSectionNode(t)?this.get_pageReader().getMetadataForWrite(a).removeProperties(Kc.b.isDeletedGraphSpaceContent):this.forceDeletePage(e)),this.setHasConflictPages(a,!1),this.setHasPageVersions(a,!1),o.dispose(),this.get_recycleBinHelper()&&this.get_recycleBinHelper().isDeletedPagesSectionNode(t))e.get_contentReplicator().set_waitingForRecycleBin(!1),e.getParentGraphSpace().get_contentReplicator().set_waitingForRecycleBin(!1);t.ensureContentGraphConnection(),this.get_recycleBinHelper()&&this.get_recycleBinHelper().logRecycleBinSuccess(e,t),Xi.t.mark(6258)}else this.loadNewSectionBeforeMove(e,t,n,r);else this.loadPageBeforeMove(e,t,n,r);else this.showMovePageToOtherSectionDialog(e,t,n,r)},t.prototype.putPageAtEndOfNewSection=function(e,t,n){var r=new Da.GraphIterator;r.set(e),r.addChild(n,79),qr.k(r),this.get_sectionContentEditor().createPageSeries(r),r.addChild(n,75),this._graphSpaceEditor.copyContent(t,n),n.updateCachedMetadata(),this.setNotebookManagementEntityId(n)},t.prototype.putPageInNewSection=function(e,t,n,r){var i=new Da.GraphIterator;i.set(e);var o=this.getNewLevelForPage(e,r);i.insertChild(n,r,79),ay.moveToSectionContentIfLoaded(i),this._graphSpaceEditor.copyContent(t,n);var a=this.get_pageSeriesEditor().getPageSeriesOfPage(t),s=this.get_pageSeriesEditor().getPageSeriesOfPage(r);if(o===Qc.PageReader.minPageLevel){var l=this.get_sectionContentEditor().insertPageSeries(i,s);i.addChild(n,75),this.get_pageSeriesEditor().moveCachedMetadataReference(a,l,n,t)}else i.goToChild(s),i.insertChild(n,r,75),this.get_pageSeriesEditor().moveCachedMetadataReference(a,s,n,t);n.updateCachedMetadata(),o!==this.get_pageReader().getLevel(t)&&this.setLevel(n,o)},t.prototype.showMovePageToOtherSectionDialog=function(e,t,n,r){var i=this;if(!li.h.get_currentDialog()||!li.h.get_currentDialog().get_isShowing()){var o=new ar.StandardDialog;o.set_buttonsOption(4),o.setDefaultButton(2),o.showWarning(CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_MovePageToNewSectionConfirmation,(function(o,a){1===o&&(i._firstMoveToNewSection=!1,i.move(e,t,n,r))}))}},t.prototype.loadPageBeforeMove=function(e,t,n,r){var i=this;e.get_contentReplicator()||e.attachContentReplicator("LoadPageBeforeMove"),e.get_contentReplicator().forceInbound((function(o){i.move(e,t,n,r)}),null,null)},t.prototype.loadNewSectionBeforeMove=function(e,t,n,r){var i=this;t.get_contentReplicator()||t.attachContentReplicator("LoadNewSectionBeforeMove"),t.get_contentReplicator().forceInbound((function(o){i.move(e,t,n,r)}),null,null)},t.prototype.copy=function(e,t,n,r,i){void 0===i&&(i=!0),Xi.t.mark(6257),1===this.get_pageNavigator().getContainingSection(e).get_accessRights()&&1===t.get_accessRights()&&this.copyPageToSection(e,t,n,r,i)},t.prototype.copyPageToSection=function(e,t,n,r,i){if(!t.get_relativePath())if(e.get_isContentPresent())if(t.get_isContentPresent()){var o=this._graphTransactionFactory.getTransaction(7);o.setFromNode(t);var a=t.createChildGraphSpace(1,"CopyPageToSection");if(r?this.putPageAtEndOfNewSection(t,e,a):this.putPageInNewSection(t,e,a,n),i){var s=this._workspaceResolver();s.get_activePage()===e&&s.set_activePage(a)}e.get_contentReplicator().set_blockingPageCopy(a),this.setHasConflictPages(a,!1),this.setHasPageVersions(a,!1),o.dispose(),t.ensureContentGraphConnection(),Xi.t.mark(6258)}else this.loadNewSectionBeforeCopy(e,t,n,r);else this.loadPageBeforeCopy(e,t,n,r)},t.prototype.loadPageBeforeCopy=function(e,t,n,r){var i=this;e.get_contentReplicator()||e.attachContentReplicator("LoadPageBeforeCopy"),e.get_contentReplicator().forceInbound((function(o){i.copy(e,t,n,r)}),null,null)},t.prototype.loadNewSectionBeforeCopy=function(e,t,n,r){var i=this;t.get_contentReplicator()||t.attachContentReplicator("LoadNewSectionBeforeCopy"),t.get_contentReplicator().forceInbound((function(o){i.copy(e,t,n,r)}),null,null)},t.prototype.showDeletePageDialog=function(e){var t=this,n=new ar.StandardDialog;n.set_buttonsOption(7),n.setDefaultButton(0);var r,i=CommonUIStrings.l_DefaultDialogTitle;r=e.get_isPasswordProtectedUnlockable()?OneNoteIntl.OneNoteStrings.L_DeletePagePermanentlyConfirmation:this.get_pageReader().hasConflictPages(e)?Box4Intl.Box4Strings.l_DeletePageWithConflictsConfirmation:this.get_pageReader().hasLockOnPageNode(e)?OneNoteIntl.OneNoteStrings.L_EduDeleteLockedPagePermanentlyConfirmation:Box4Intl.Box4Strings.l_DeletePageConfirmation,n.showWarning(i,r,(function(n,r){1===n&&t.deletePage(e,!0)}))},t.prototype.showDeleteMultiplePagesDialog=function(e){var t=this,n=new ar.StandardDialog;n.set_buttonsOption(4),n.setDefaultButton(2),n.showWarning(CommonUIStrings.l_DefaultDialogTitle,OneNoteIntl.OneNoteStrings.L_DeletePagesPermanentlyConfirmation,(function(n,r){if(1===n)for(var i=e.$$lge();i.$$mn();){var o=i.$$cu();t.deletePage(o,!0)}}))},t.prototype.deletePage=function(e,t){Xi.t.mark(6253);var n=e;L.AFrameworkApplication.get_theActionManager().processAction(eb.KR,2);var r=this._workspaceResolver();if(n.get_anchor()&&r){var i=this._graphTransactionFactory.getTransaction(7);if(i.setFromNode(e),this.get_pageReader().isConflictPageNode(n))r.onGraphSpaceShutdown(n),this.deleteConflictPage(n);else if(this.get_pageReader().isVersionNode(n))r.onGraphSpaceShutdown(n),this.deleteVersion(n);else if(!Br.App.theNotebookManager.get_isRecycleBinEnabled()||iA.o(n)||t)this.forceDeletePage(n),r.onGraphSpaceShutdown(n);else{L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IOneNoteRecycleBinSettings"),C.ULS.sendTraceTag(19957528,339,50,"Move page to recyclebin start.");var o=this.get_pageReader().getTitle(n),a=String.format(OneNoteIntl.OneNoteStrings.L_DeletePageSucceedToastMessage,o);this.showDeleteRestorePageToast(a),r.onGraphSpaceShutdown(n),this.deleteOriginalPageAndMovePageToRecycleBin(n)}i.dispose(),Xi.t.mark(6254)}L.AFrameworkApplication.get_theActionManager().processAction(ii.lX,2)},t.prototype.deleteOriginalPageAndMovePageToRecycleBin=function(e){var t=this;if(!e.get_isContentPresent())return e.get_contentReplicator()||e.attachContentReplicator("DeleteOriginalPageAndMoveToRecycleBin_Page"),void e.get_contentReplicator().forceInbound((function(n){var r=t._graphTransactionFactory.getTransaction(3);r.setFromNode(e),t.deleteOriginalPageAndMovePageToRecycleBin(e),r.dispose()}),null,null);e.get_contentReplicator().set_waitingForRecycleBin(!0);var n=e.getParentGraphSpace();n.get_contentReplicator()||n.attachContentReplicator("DeleteOriginalPageAndMoveToRecycleBin_Section"),n.get_contentReplicator().set_waitingForRecycleBin(!0),this.forceDeletePage(e);var r=(0,O.m)(new sA.y,{pageToDelete:e});C.ULS.sendTraceTag(41161989,339,50,"Starting the process of recycle bin"),this.get_notebookEditor().ensureDeletedPagesExists(Br.App.theNotebookManager.get_defaultNotebookNode(),o.i(this,this.movePageToRecycleBin,"movePageToRecycleBin"),o.i(this.get_recycleBinHelper(),this.get_recycleBinHelper().logRecycleBinFailure,"logRecycleBinFailure"),r)},t.prototype.movePageToRecycleBin=function(e){C.ULS.sendTraceTag(41161990,339,50,"Moving the page into the recycle bin");var t=(0,f.e)(sA.y,e);if(!t)return t=(0,O.m)(new sA.y,{lastFailure:"MovePageToRecycleBin: No valid callbackData when moving page to recycle bin"}),void this.get_recycleBinHelper().logRecycleBinFailure(t,14);var n=t.recycleBinDeletedPagesNode;if(!n)return t.lastFailure="MovePageToRecycleBin: No deleted pages section found to move the page to",void this.get_recycleBinHelper().logRecycleBinFailure(t,14);Xi.t.mark(6257);var r=t.pageToDelete;this.movePageOutOfSection(r,n,null,!0,!1)},t.prototype.showDeleteRestorePageToast=function(e){this._deleteRestorePageMessage&&(Br.App.get_activeAppFrame().get_notificationBar().removeEntry(this._deleteRestorePageMessage),this._deleteRestorePageMessage=null),this._deleteRestorePageNotificationPending&&L.AFrameworkApplication.get_theTaskManager().deleteTask(this._deleteRestorePageNotificationTask),this._deleteRestorePageMessage=Br.App.get_activeAppFrame().get_notificationBar().createEntry(e,!0),this._deleteRestorePageMessage.set_image(5),this._deleteRestorePageMessage.set_imagePath("EmptyTrash_16x16x32"),this._deleteRestorePageNotificationTask=new De.c(4,1,t.deletePageToastTimeInterval,o.i(this,this.removeDeletePageToast,"removeDeletePageToast"),47),L.AFrameworkApplication.get_theTaskManager().addTask(this._deleteRestorePageNotificationTask),this._deleteRestorePageNotificationPending=!0,Br.App.get_activeAppFrame().get_notificationBar().addEntry(this._deleteRestorePageMessage)},t.prototype.removeDeletePageToast=function(e){Br.App.get_activeAppFrame().get_notificationBar().removeEntry(this._deleteRestorePageMessage),this._deleteRestorePageNotificationPending=!1,this._deleteRestorePageNotificationTask=null},t.prototype.deleteConflictPage=function(e){this.get_pageNavigator().getContainingPage(e);var t=new Da.GraphIterator;t.set(this.get_pageNavigator().getContainingPage(e)),t.goToChild(e);var n=new Da.GraphIterator;n.set(e),n.tryToRootAtAncestorOfType(5),n.disconnectNodeAndReturnToParent(),t.disconnectNodeAndReturnToParent();var r=t.get_currentNode();this.get_pageReader().hasConflictPages(r)||this.setHasConflictPages(r,!1),this.get_businessBarControllerFuture().execute((function(e){e.checkCurrentPageStatusBusinessBars()}))},t.prototype.deleteVersion=function(e){var t=this.get_pageNavigator().getContainingVersionHistoryGraphSpace(e),n=this._graphTransactionFactory.getTransaction(4);n.setFromNode(t);var r=new Da.GraphIterator;r.set(t),r.goToChild(e);var i=new Da.GraphIterator;if(i.set(e),i.tryToRootAtAncestorOfType(28),i.disconnectNodeAndReturnToParent(),i.disconnectNodeAndReturnToParent(),r.disconnectNodeAndReturnToParent(),!this.get_versionHistoryEditor().getVersionCount(t)){var o=this.get_pageNavigator().getContainingPage(t);this.setHasPageVersions(o,!1)}n.dispose()},t.prototype.forceDeletePage=function(e){var t=this._graphTransactionFactory.getTransaction(4);t.setFromNode(e),e.setValue(Kc.b.isDeletedGraphSpaceContent,!0),this.updateLevelsInSeriesBeforePageRemoval(e),e.get_isContentPresent()?e.get_deleteOnNavigateAway()?this.forceDeleteBrokenPage(e):this.forceDeleteLoadedPage(e):-1===e.inboundReplicationStatus?this.get_oneNotePageReader().loadWithCallbacks(e,o.i(this,this.pageDeleteAfterSuccessfulLoad,"pageDeleteAfterSuccessfulLoad"),o.i(this,this.pageDeleteAfterFailedLoad,"pageDeleteAfterFailedLoad"),e):this.forceDeleteBrokenPage(e),t.dispose()},t.prototype.forceDeleteLoadedPage=function(e){var t=this._graphTransactionFactory.getTransaction(3);t.setFromNode(e);var n=this.get_pageReader().getMetadataForWrite(e);n?n.setValue(Kc.b.isDeletedGraphSpaceContent,!0):C.ULS.sendTraceTag(38347616,339,10,"In ForceDeleteLoadedPage, no pageMetaData for pageNode\nNodeType: "+e.get_type()),e.get_anchor().invalidateViewChannel(this._workspaceResolver().get_navigationPaneView().get_viewId(),4),t.dispose(),this.get_undoManager().clearUndoHistory(e,!1)},t.prototype.forceDeleteBrokenPage=function(e){var t=Da.GraphIterator.createFromNode(e);if(t.tryToRootAtAncestorOfType(5)){var n=this._graphTransactionFactory.getTransaction(7);n.setFromIterator(t),t.returnToNodeOfType(6)&&(1===t.getChildCountByRole(75)?t.disconnectNodeAndReturnToParent():(t.goToChild(e),t.disconnectNodeAndReturnToParent()),n.dispose())}},t.prototype.pageDeleteAfterSuccessfulLoad=function(e){this.forceDeleteLoadedPage(e)},t.prototype.pageDeleteAfterFailedLoad=function(e,t){this.forceDeleteBrokenPage(e)},t.prototype.onPageDeleteFailure=function(e,t){t.get_contentReplicator().set_blockingPageCopy(null);var n=this._graphTransactionFactory.getTransaction(7);if(n.setFromNode(t),t.removeProperty(Kc.b.isDeletedGraphSpaceContent),t.get_isContentPresent()){var r=this.get_pageReader().getMetadataForWrite(t);r&&r.removeProperty(Kc.b.isDeletedGraphSpaceContent)}t.get_anchor().invalidateViewChannel(this._workspaceResolver().get_navigationPaneView().get_viewId(),4),n.dispose(),this.get_undoManager().clearUndoHistory(t,!1),this.get_pageReader().isPageNode(t)?this.showPageDeleteFailureDialog(e,t):C.ULS.sendTraceTag(37291908,339,10,"A page delete failure occurred on a node that wasn't a page node? \nNodeType: "+t.get_type()+"\nIsSectionNode: "+_T.d(t))},t.prototype.showPageDeleteFailureDialog=function(e,t){if(!li.h.get_currentDialog()){var n,r,i=new ar.StandardDialog;i.set_buttonsOption(0),40===e?(n=String.format(Box4Intl.Box4Strings.l_DeletePageConflictDialogText,this.get_pageReader().getTitle(t)),r=sl.o.deletePageConflict):(n=String.format(Box4Intl.Box4Strings.l_DeletePageUnknownErrorDialogText,this.get_pageReader().getTitle(t)),r=sl.o.deletePageUnknown),i.showError(r,CommonUIStrings.l_DefaultDialogTitle,n,null)}},t.prototype.updateLevelsInSeriesBeforePageRemoval=function(e){if(this.get_pageReader().getLevel(e)===Qc.PageReader.minPageLevel){var t=ay.getNextSiblingPage(e);t&&this.setLevel(t,Qc.PageReader.minPageLevel)}},t.prototype.getNewLevelForPage=function(e,t){var n,r=new Da.GraphIterator;return r.set(e),t?(t.ensureContentGraphConnection(),r.goToChild(t),r.goToNextSiblingByRole(79),this.get_pageReader().isPage(r)?n=this.get_pageReader().getLevel(r.get_currentNode()):(n=Qc.PageReader.minPageLevel,C.ULS.shipAssertTag(6373635,324,!1)),r.returnToParent()):n=Qc.PageReader.minPageLevel,n},t.prototype.setHasConflictPages=function(e,t){var n=this._graphTransactionFactory.getTransaction(4);n.setFromNode(e.getParentGraphSpace());var r=this._graphTransactionFactory.getTransaction(4);r.setFromNode(e),this.get_pageReader().getMetadataForWrite(e).set_hasConflictPages(t),r.dispose(),n.dispose()},t.prototype.get_isReadingMode=function(){return 1===Br.App.get_activeAppFrame().get_mode()},t.prototype.setVersionsVisibility=function(e,t){e.get_properties().setValue(zl.k.versionsVisible,t);var n=new Da.GraphIterator;n.set(e),n.invalidateViewChannel(this._workspaceResolver().get_navigationPaneView().get_viewId(),8);var r=this.get_pageNavigator().getVersionHistoryNode(e);if(r){var i=this._workspaceResolver();t?i.get_navigationPaneView().tryExpandView():i.get_navigationPaneView().tryCollapseView(!1),r.set_isContentBeingViewed(t)}},t.prototype.setConflictPagesVisibility=function(e,t){var n=this._workspaceResolver();t?n.get_navigationPaneView().tryExpandView():n.get_navigationPaneView().tryCollapseView(!1),e.get_properties().setValue(zl.k.conflictPagesVisible,t);var r=new Da.GraphIterator;r.set(e),r.invalidateViewChannel(n.get_navigationPaneView().get_viewId(),8),e.set_isContentBeingViewed(t||n.get_activePage()===e)},t.prototype.increaseIndent=function(e,t){if(this.get_isReadingMode())return 8;if(this.get_pageReader().isConflictPageNode(e)||this.get_pageReader().isVersionNode(e))return 8;var n=this.get_pageReader().getLevel(e);if(n>=Qc.PageReader.maxPageLevel)return 8;var r=new Da.GraphIterator;r.set(e.getParentGraphSpace()),r.goToChild(e);for(var i=!1;r.goToPreviousSiblingByRole(79);)if(this.get_pageReader().isVisiblePage(r.get_currentNode())){i=!0;break}if(!i)return 8;if(2===t){var o=this._graphTransactionFactory.getTransaction(7);o.setFromIterator(r),this.setLevel(e,n+1),o.dispose()}return 32},t.prototype.decreaseIndent=function(e,t){if(this.get_isReadingMode())return 8;if(this.get_pageReader().isConflictPageNode(e)||this.get_pageReader().isVersionNode(e))return 8;var n=this.get_pageReader().getLevel(e);if(n<=Qc.PageReader.minPageLevel)return 8;if(2===t){var r=this._graphTransactionFactory.getTransaction(7);r.setFromNode(e),this.setLevel(e,n-1),r.dispose()}return 32},t.prototype.moveGivenPage=function(e,t){var n=this.get_pageNavigator().getContainingSection(e),r=new Da.GraphIterator;if(r.set(n),r.hasChild(e))if(t){var i=this.get_pageNavigator().getNextVisiblePage(e,!1);if(i&&r.hasChild(i))this.move(e,n,i,!1);else if(r.set(n.getParentGraphSpace()),r.goToChild(n),r.goToNextSiblingByRole(79)&&_T.D(r)&&!iA.r(r.get_currentNode())){var o=r.get_currentNode();this.move(e,o,null,!1)}}else{var a=this.get_pageNavigator().getPrevVisiblePage(e,!1);if(a&&r.hasChild(a)){r.set(n),r.goToChild(a);var s=r.goToPreviousSiblingByRole(79);this.move(e,n,s,!1)}else r.set(n.getParentGraphSpace()),r.goToChild(n),r.goToPreviousSiblingByRole(79)&&this.move(e,r.get_currentNode(),null,!0)}},t.prototype.createDeferredPageMoveCallback=function(e,t,n,r,i){return void 0===i&&(i=!0),o.i(new mA(this,this._workspaceResolver(),e,t,n,r,i),new mA(this,this._workspaceResolver(),e,t,n,r,i).execute,"execute")},t.prototype.createDeferredPageRestoreCallback=function(e,t,n){return o.i(new fA(this,this._workspaceResolver(),e,t,null,n),new fA(this,this._workspaceResolver(),e,t,null,n).execute,"execute")},t.prototype.createDeferredPageCopyCallback=function(e,t,n,r){return o.i(new hA(this,e,t,n,r),new hA(this,e,t,n,r).execute,"execute")},t.prototype.get_pageReader=function(){return Qc.PageReader.get_instance()},t.prototype.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},t.prototype.get_pageSeriesEditor=function(){return this._pageSeriesEditorLazy.get_value()},t.prototype.initializeGraphSpaceVersion=function(e){var t=this.get_pageNavigator().getContainingSection(e),n=qr.f(t,Kc.b.schemaRevisionInOrderToRead),r=yA.s(yA.r(n));this._graphSpaceEditor.writeSchemaRevision(e,Kc.b.schemaRevisionInOrderToRead,r);var i=qr.f(t,qc.o.schemaRevisionInOrderToWrite);16777215===i&&(i=n);var o=yA.s(yA.r(i));this._graphSpaceEditor.writeSchemaRevision(e,qc.o.schemaRevisionInOrderToWrite,o)},t.prototype.setHasPageVersions=function(e,t){var n=this._graphTransactionFactory.getTransaction(4);n.setFromNode(e.getParentGraphSpace());var r=this._graphTransactionFactory.getTransaction(4);r.setFromNode(e),this.get_pageReader().getMetadataForWrite(e).set_hasPageVersions(t),r.dispose(),n.dispose()},t.prototype.setNotebookManagementEntityId=function(e){this.get_pageReader().getMetadataForWrite(e).set_notebookManagementEntityId(ae.l.create())},t.prototype.setCreationDate=function(e){this.get_pageReader().getMetadataForWrite(e).set_creationDate(new Date)},t.prototype.setTitle=function(e,t){var n=this._graphTransactionFactory.getTransaction(4);n.setFromNode(e.getParentGraphSpace());var r=this._graphTransactionFactory.getTransaction(4);r.setFromNode(e),this.get_pageReader().getMetadataForWrite(e).set_title(t),r.dispose(),n.dispose()},t.prototype.setLevel=function(e,t){var n=this._graphTransactionFactory.getTransaction(7);if(n.setFromNode(e),!e.get_isContentPresent()){var r=new _A(this,e,t);return this.get_oneNotePageReader().load(e,o.i(r,r.execute,"execute"),null),void n.dispose()}var i=Da.GraphIterator.createFromNode(e);if(i.tryToRootAtAncestorOfType(6),this.get_pageReader().getMetadataForRead(e).get_pageLevel()!==Qc.PageReader.minPageLevel||t!==Qc.PageReader.minPageLevel+1||i.goToPreviousSibling()){if(this.get_pageReader().getMetadataForRead(e).get_pageLevel()===Qc.PageReader.minPageLevel+1&&t===Qc.PageReader.minPageLevel&&i.goToPreviousSibling()){(a=Da.GraphIterator.createFromNode(e)).tryToRootAtAncestorOfType(5),a.returnToParent();s=a.get_currentNode();this.get_pageSeriesEditor().splitPageSeries(s,e)}}else{var a;(a=Da.GraphIterator.createFromNode(e)).tryToRootAtAncestorOfType(5),a.returnToParent();var s=a.get_currentNode();if(!a.goToPreviousSibling())return void n.dispose();var l=a.get_currentNode();this.get_pageSeriesEditor().mergePageSeries(s,l)}this.get_pageReader().getMetadataForWrite(e).set_pageLevel(t),n.dispose()},t.deletePageToastTimeInterval=5e3,t}(pA);(0,o.l)(CA,"PageEditor",pA,[eA.f,rA.f]);var SA=function(){function e(){}return e.prototype.createSection=function(e,t,n){return void 0===n&&(n=!0),null},e}();(0,o.l)(SA,"FolderContentEditor$0",null,[qT.s]);var vA=n(8515),bA=function(e){function t(t,n,r,i,o){var a=e.call(this)||this;return a._sectionContentEditor=null,a._sectionEditor=null,a._graphTransactionFactory=null,a._graphNodeFactory=null,a._workspaceResolver=null,a._sectionEditor=t,a._sectionContentEditor=n,a._graphTransactionFactory=r,a._graphNodeFactory=i,a._workspaceResolver=o,a}return(0,S.t)(t,e),t.prototype.createSection=function(e,t,n){if(void 0===n&&(n=!0),!hT.FolderReader.isFolderContent(e))return null;var r=new Da.GraphIterator;r.set(e.get_currentNode().getParentGraphSpace());var i=r.goToLastChildByRole(79);if(i)for(;!_T.d(i)&&i;)i=r.goToPreviousSiblingByRole(79);return r.returnToAncestorOfType(1),this.createSectionAfter(r,i,t,n)},t.prototype.createSectionAfter=function(e,t,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=null),!hT.FolderReader.isFolder(e))return null;Xi.t.mark(6251),ST.moveToFolderContentIfLoaded(e);var o=e.get_currentNode(),a=this._graphTransactionFactory.getTransaction(7);a.setFromIterator(e);var s=new Da.GraphIterator;s.set(e.get_currentNode());var l=this.insertSection(s,t,n);this._sectionEditor.setTitleForNewSection(s.get_currentNode(),n),this._sectionEditor.setFileIdentityGuid(s.get_currentNode()),this._sectionEditor.setSectionColor(s.get_currentNode());var c=Da.GraphIterator.createFromNode(o);if(this.updateFileIdentityGuids(c),ay.moveToSectionContentIfLoaded(s),l.set_accessRights(1),r){var u=this._workspaceResolver(),g=this._sectionContentEditor.createPage(s,null,null,i);u&&u.set_activePage(g)}return a.dispose(),Xi.t.mark(6252),l},t.prototype.insertSection=function(e,t,n){if(!hT.FolderReader.isFolderContent(e)||t&&!_T.d(t))return null;if(!e.tryToRootAtAncestorOfType(1))return null;var r=null;t&&((r=new Da.GraphIterator).set(t),r.tryToRootAtAncestorOfType(4),r.returnToAncestorOfType(4));var i=this._graphNodeFactory.create(393221);e.insertChildUsingId(i,t?r.get_currentNode():null,1,new Dt.h(ae.l.create(),1)),e.goToChild(i);var o=e.get_currentNode().getParentGraphSpace(),a=o.createChildFileGraphSpace(n,"InsertSection"),s=new Da.GraphIterator;s.set(o),s.insertChild(a,t,79),e.addChild(a,78),e.goToChild(a);var l=new vA.b;return l.setProperty_Unchecked(Kc.b.topologyCreationTimeStamp,new Date),l.setProperty_Unchecked(Kc.b.notebookManagementEntityGuid,ae.l.create()),e.addChild(l,80),this._sectionEditor.initializeGraphSpaceVersion(a),a.get_contentReplicator()&&a.get_contentReplicator().forceOutbound(null,null,a),a},t.prototype.updateFileIdentityGuids=function(e){for(var t=e.get_currentNode(),n=null,r=e.goToFirstChild();r;){if(4===e.get_currentNodeType()){var i=r.get_properties().getValueWithDefault(String,py.w.fileIdentityGuid,"");""!==i&&(n=n?n+","+i:i)}r=e.goToNextSibling()}n&&t.get_properties().setValue(py.w.sectionFileIdentityGuids,n),e.returnToParent()},t}(SA);(0,o.l)(bA,"FolderContentEditor",SA,[QT.s,qT.s]);var TA=function(){function e(e){void 0===e&&(e=null),this._imageEditor=null,this._imageEditor=e}return e.prototype.writeSchemaRevision=function(e,t,n){var r=e.get_contentMetadata();16777215===n?r.removeProperty(t):r.setValue(t,n)},e.prototype.copyContent=function(e,t){for(var n=t.get_contentObjectSpace().startBuildingRevision(),r=e.get_contentObjectSpace().get_currentRevision(),i=r.listAllObjects(),o=0;o<i.length;o++)this.copyObjectSpaceObject(e,t,i[o],n);for(var a=1;a<=4;a++)if(3!==a){var s=r.getRootObjectId(a);s&&!s.equals(Dt.h.get_nil())&&n.setRootObjectId(s,a)}var l=t.get_contentObjectSpace().finishBuildingRevision();t.loadContent(l)},e.prototype.copyObjectSpaceObject=function(e,t,n,r){var i=n.clone();i.set_id(n.get_id()),(ka.ImageReader.isPictureContainer(i)||524342===i.get_runtimeClassId())&&((e.get_encryptionSessionString()||t.get_encryptionSessionString())&&this._imageEditor.get_value().setNewFileDataObjectId(i),t.isOneNoteEnsureFreshNeeded=!0,t.isOneNotePageVersionCreatePending=!0),393271===(n=i).get_runtimeClassId()&&n.removeProperties(qc.o.graphSpaceVersionHistoryContextNodes,Kc.b.graphSpaceElementNodes),65599!==n.get_runtimeClassId()&&r.addToRevision(n)},e}();(0,o.l)(TA,"GraphSpaceEditor",null,[XT.e]);var AA=n(1482),IA=function(){function e(e,t,n,r){this._pageEditor=null,this._sectionContentEditorLazy=null,this._versionHistoryEditor=null,this._transactionFactory=null,this._pageEditor=e,this._sectionContentEditorLazy=t,this._versionHistoryEditor=n,this._transactionFactory=r}return e.prototype.get_pageReader=function(){return Qc.PageReader.get_instance()},e.prototype.get_sectionContentEditor=function(){return this._sectionContentEditorLazy.get_value()},e.prototype.createPageAfterSubpage=function(e){if(!e)return null;Xi.t.mark(6249);var t=Da.GraphIterator.createFromNode(e);if(!t.tryToRootAtAncestorOfType(6))return Xi.t.mark(6250),null;var n,r=Da.GraphIterator.createFromNode(e);if(r.tryToRootAtAncestorOfType(6),!r.goToPreviousSibling()&&!r.goToNextSibling())return Xi.t.mark(6250),null;n=t.goToNextSibling()?this.get_pageReader().getLevel(t.get_currentNode()):this.get_pageReader().getLevel(e),t.returnToParent();var i=t.get_currentNode().getParentGraphSpace(),o=i.createChildGraphSpace(1,"CreatePageAfterSubpage"),a=new Da.GraphIterator;return a.set(i),a.insertChild(o,e,79),t.insertChild(o,e,75),t.goToChild(o),this.createPageContent(t,void 0,void 0,n),L.AFrameworkApplication.get_theActionManager().processAction(ii.lX,2),Xi.t.mark(6250),o},e.prototype.createPage=function(e,t,n,r){if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),Xi.t.mark(6249),!_T.o(e))return null;var i=this._transactionFactory.getTransaction(4);i.setFromIterator(e);var o=this.findGraphSpaceNodeToInsertPageAfter(e.get_currentNode()),a=e.get_currentNode().getParentGraphSpace(),s=a.createChildGraphSpace(1,"CreatePage"),l=new Da.GraphIterator;return l.set(a),l.insertChild(s,o,79),e.addChild(s,75),e.goToChild(s),this.createPageContent(e,t,n,Qc.PageReader.defaultPageLevel,r),L.AFrameworkApplication.get_theActionManager().processAction(ii.lX,2),i.dispose(),Xi.t.mark(6250),s},e.prototype.createPageContent=function(e,t,n,r,i){if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),r||(r=Qc.PageReader.defaultPageLevel),this.get_pageReader().isPage(e)){var o=e.get_currentNode(),a=fc.i.get_instance().createInstance(393271);e.addChild(a,80),e.goToChild(a),this.initializePageContent(e,t,n),e.returnToNode(o),this._pageEditor.setNotebookManagementEntityId(o),this._pageEditor.setCreationDate(o),this._pageEditor.setLevel(o,r),i&&""!==i&&this._pageEditor.setTitle(o,i),this._pageEditor.initializeGraphSpaceVersion(o),this._versionHistoryEditor.createVersionHistoryGraph(e),e.returnToNode(o)}},e.prototype.initializePageContent=function(t,n,r){var i=fc.i.get_instance().createInstance(393227);e.get_pageContentEditor().setRtl(i,L.AFrameworkApplication.get_isRtl()),e.get_pageContentEditor().setLayoutResolveChildCollisions(i),e.get_pageContentEditor().setMarginOrigin(i),t.addChild(i,2),t.goToChild(i),e.get_pageContentEditor().createTitle(t,n,r),t.returnToAncestorOfType(7)},e.prototype.findGraphSpaceNodeToInsertPageAfter=function(e){var t=new Da.GraphIterator;t.set(e);var n=t.goToLastChild();return n||(t.tryToRootAtAncestorOfType(5),t.goToPreviousSibling()&&t.goToLastChild()?t.get_currentNode():null)},e.prototype.moveCachedMetadataReference=function(e,t,n,r){void 0===r&&(r=null),r||(r=n);var i=Array.clone(e.getValueWithDefault(Array,qc.o.cachedMetaDataObjects,[])),o=Array.clone(t.getValueWithDefault(Array,qc.o.cachedMetaDataObjects,[])),a=Array.indexOf(i,r.get_cachedMetadataId());a>-1&&(Array.removeAt(i,a),Array.add(o,n.get_cachedMetadataId())),i.length>0?e.setValue(qc.o.cachedMetaDataObjects,i):e.get_properties().removeProperty(qc.o.cachedMetaDataObjects),t.setValue(qc.o.cachedMetaDataObjects,o)},e.prototype.mergePageSeries=function(e,t){var n=this._transactionFactory.getTransaction(4);n.setFromNode(t);var r=Da.GraphIterator.createFromNode(e),i=Array.clone(t.getValueWithDefault(Array,qc.o.cachedMetaDataObjects,[])),o=Array.clone(e.getValueWithDefault(Array,qc.o.cachedMetaDataObjects,[]));i=i.concat(o),t.setValue(qc.o.cachedMetaDataObjects,i),r.set(e);for(var a=r.goToFirstChildByRole(75),s=Da.GraphIterator.createFromNode(t);a;){var l=r.goToNextSiblingByRole(75),c=Da.GraphIterator.createFromNode(a);c.tryToRootAtAncestorOfType(6)&&(c.disconnectNodeAndReturnToParent(),s.addChild(a,75),c.tryToRootAtAncestorOfType(5)&&(c.hasChildren()||c.disconnectNodeAndReturnToParent())),a=l}n.dispose()},e.prototype.splitPageSeries=function(e,t){var n=Da.GraphIterator.createFromNode(e);if(n.tryToRootAtAncestorOfType(5)){var r=this._transactionFactory.getTransaction(4);r.setFromIterator(n),n.returnToParent();var i,o=this.get_sectionContentEditor().insertPageSeries(n,e),a=t,s=Da.GraphIterator.createFromNode(t);s.tryToRootAtAncestor(e);for(var l=Array.clone(e.getValueWithDefault(Array,qc.o.cachedMetaDataObjects,[])),c=[];a;){i=s.goToNextSiblingByRole(75);var u=Da.GraphIterator.createFromNode(a);u.tryToRootAtAncestor(e),u.disconnectNodeAndReturnToParent(),n.addChild(a,75);var g=Array.indexOf(l,a.get_cachedMetadataId());g>-1&&(Array.removeAt(l,g),Array.add(c,a.get_cachedMetadataId())),a=i}e.setValue(qc.o.cachedMetaDataObjects,l),o.setValue(qc.o.cachedMetaDataObjects,c),r.dispose()}},e.prototype.getPageSeriesOfPage=function(e){return e?((t=new Da.GraphIterator).set(e),t.tryToRootAtAncestorOfType(6),t.returnToAncestorOfType(6),t.get_currentNode()):null;var t},e.get_pageContentEditor=function(){return e._pageContentEditor||(e._pageContentEditor=se.w.get_instance().resolve(AA.m))},e.set_pageContentEditor=function(t){return e._pageContentEditor=t,t},e._pageContentEditor=null,e}();(0,o.l)(IA,"PageSeriesEditor",null,[ZT]);var wA=function(){function e(e,t,n){this._sectionNavPaneViewElementGetter=null,this._sectionContentEditor=null,this._graphTransactionFactory=null,this.iterator=null,this.iterator=e,this._sectionContentEditor=t,this._graphTransactionFactory=n,this._sectionNavPaneViewElementGetter=function(t){return e.get_currentNode().getHtmlViewElement(Br.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId())}}return e.prototype.set_sectionNavPaneViewElementGetter=function(e){return this._sectionNavPaneViewElementGetter=e,e},e.prototype.execute=function(e){var t=e.iterator;this._sectionNavPaneViewElementGetter(t).setIsLoading(!1),qr.k(t);var n=this._graphTransactionFactory.getTransaction(7);n.setFromIterator(t),this._sectionContentEditor.createPage(t),n.dispose()},e}();(0,o.l)(wA,"DeferredCreatePage",null,[]);var xA=function(){function e(e,t,n,r){this._pageSeriesEditor=null,this._sectionEditorLazy=null,this._graphNodeFactory=null,this._graphTransactionFactory=null,this._sectionNavPaneViewElementGetter=null,this._sectionEditorLazy=e,this._pageSeriesEditor=t,this._graphNodeFactory=n,this._graphTransactionFactory=r,this._sectionNavPaneViewElementGetter=function(e){return e.get_currentNode().getHtmlViewElement(Br.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId())}}return e.prototype.get_sectionEditor=function(){return this._sectionEditorLazy.get_value()},e.prototype.set_sectionNavPaneViewElementGetter=function(e){return this._sectionNavPaneViewElementGetter=e,e},e.prototype.createPageSeries=function(e){if(!_T.r(e))return null;var t=this._graphNodeFactory.create(393224);return this.initializePageSeries(t),e.addChild(t,1),e.goToChild(t),t},e.prototype.insertPageSeries=function(e,t){if(!_T.r(e))return null;var n=this._graphTransactionFactory.getTransaction(4);n.setFromIterator(e);var r=this._graphNodeFactory.create(393224);return this.initializePageSeries(r),e.insertChild(r,t,1),e.goToChild(r),n.dispose(),r},e.prototype.initializePageSeries=function(e){e.setValue(Kc.b.notebookManagementEntityGuid,ae.l.create()),e.setValue(Kc.b.topologyCreationTimeStamp,new Date)},e.prototype.createPage=function(e,t,n,r){if(void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),!_T.r(e)){var i=new wA(e,this,this._graphTransactionFactory),a=this._sectionNavPaneViewElementGetter(e);return a.setIsLoading(!0),this.get_sectionEditor().load(e.get_currentNode(),o.i(i,i.execute,"execute"),o.i(a,a.onSectionContentLoadFail,"onSectionContentLoadFail"),i),null}return e.tryToRootAtAncestorOfType(1)?(this.createPageSeries(e),this._pageSeriesEditor.createPage(e,t,n,r)):null},e.prototype.insertPage=function(e,t){if(!_T.r(e))return null;if(!e.tryToRootAtAncestorOfType(1))return null;var n=null;if(t){var r=new Da.GraphIterator;r.set(t),r.tryToRootAtAncestorOfType(6),n=r.returnToAncestorOfType(6)}return this.insertPageSeries(e,n),this._pageSeriesEditor.createPage(e)},e}();(0,o.l)(xA,"SectionContentEditor",null,[YT.x]);var FA=function(){function e(e,t,n,r,i){this._folderEditorLazy=null,this._folderContentEditor=null,this._graphSpaceEditor=null,this._graphTransactionFactory=null,this._workspaceResolver=null,this._folderEditorLazy=e,this._folderContentEditor=t,this._graphSpaceEditor=n,this._graphTransactionFactory=r,this._workspaceResolver=i}return e.prototype.get_folderEditor=function(){return this._folderEditorLazy.get_value()},e.prototype.get_folderContentEditor=function(){return this._folderContentEditor.get_value()},e.prototype.initializeGraphSpaceVersion=function(e){this._graphSpaceEditor.writeSchemaRevision(e,Kc.b.schemaRevisionInOrderToRead,40),this._graphSpaceEditor.writeSchemaRevision(e,qc.o.schemaRevisionInOrderToWrite,40)},e.prototype.setTitleForRenameSection=function(e,t){e.getContentGraph().get_properties().setValue(qc.o.preferredSectionName,t),this.getMetadataForWrite(e).set_preferredSectionName(t+(t.endsWith(".one")?"":".one"))},e.prototype.setTitleForNewSection=function(e,t){e.getContentGraph().get_properties().setValue(Kc.b.sectionName,t),this.getMetadataForWrite(e).set_newFileName(t+(t.endsWith(".one")?"":".one"))},e.prototype.setFileIdForSection=function(e){var t=Da.GraphIterator.createFromNode(e);t.tryToRootAtAncestorOfType(4),t.returnToAncestorOfType(4);e.getContentGraph();this.getMetadataForWrite(e).set_fileId(t.get_currentNode().getValue(String,zl.k.targetFileId))},e.prototype.setNotebookPagesSectionNode=function(e,t){var n=e.getContentGraph();n&&n.get_properties().setValue(qc.o.isNotebookPagesSection,t)},e.prototype.showDeleteSectionDialog=function(e){var t=this,n=new ar.StandardDialog;n.set_buttonsOption(7),n.setDefaultButton(0),n.showWarning(OneNoteIntl.OneNoteStrings.L_DeleteSectionConfirmationTitle,OneNoteIntl.OneNoteStrings.L_DeleteSectionConfirmationDescription,(function(n,r){1===n&&t.deleteSection(e)}))},e.prototype.deleteSection=function(e){Xi.t.mark(6255);var t=new Da.GraphIterator;t.set(e),t.tryToRootAtAncestorOfType(1),t.returnToAncestorOfType(1),t.goToChild(e);var n=new Da.GraphIterator;n.set(e),n.tryToRootAtAncestorOfType(3);var r=this._graphTransactionFactory.getTransaction(7);r.setFromIterator(t);var i=this.getWorkspaceActionForDeleteSection(e);n.disconnectNodeAndReturnToParent();var o=n.get_currentNode().getValue(String,zl.k.targetFileId),a=n.get_currentNode().getValueWithDefault(String,py.w.fileIdentityGuid,"");n.disconnectNodeAndReturnToParent();var s,l,c=Da.GraphIterator.createFromNode(n.get_currentNode()),u=c.get_currentNode().getGraphSpace();this.get_folderContentEditor().updateFileIdentityGuids(c),s=n.get_currentNode().get_properties().hasProperty(py.w.deletedElements)&&n.get_currentNode().get_properties().getValue(String,py.w.deletedElements).length?(s=n.get_currentNode().get_properties().getValue(String,py.w.deletedElements))+","+o:o,l=n.get_currentNode().get_properties().hasProperty(py.w.deletedFileIdentityGuids)&&n.get_currentNode().get_properties().getValue(String,py.w.deletedFileIdentityGuids).length?(l=n.get_currentNode().get_properties().getValue(String,py.w.deletedFileIdentityGuids))+","+a:a,n.get_currentNode().get_properties().setValue(py.w.deletedElements,s),n.get_currentNode().get_properties().setValue(py.w.deletedFileIdentityGuids,l),i&&i(),u.get_contentReplicator()&&u.get_contentReplicator().forceOutbound(null,null,null),t.disconnectNodeAndReturnToParent(),r.dispose(),Xi.t.mark(6256)},e.prototype.getWorkspaceActionForDeleteSection=function(e){var t=this._workspaceResolver(),n=t.get_activeSection();if(n!==e)return null;var r=ST.getNextPageInNewSection(n)||ST.getPreviousPageInNewSection(n);if(r)return function(){t.set_activePage(r)};var i=ay.getNextSection(n)||ay.getPreviousSection(n);if(i)return function(){t.set_activeSection(i)};var o=t.get_activeFolder();return function(){t.set_activeFolder(o)}},e.prototype.moveGivenSection=function(e,t){var n=new Da.GraphIterator;n.set(e.getParentGraphSpace()),n.goToChild(e),t?_T.d(n.goToNextSiblingByRole(79))&&this.get_folderEditor().moveSection(e,n.get_currentNode()):n.goToPreviousSiblingByRole(79)&&this.get_folderEditor().moveSection(e,n.goToPreviousSiblingByRole(79))},e.prototype.load=function(e,t,n,r){e.get_contentReplicator()||e.attachContentReplicator("LoadSection"),e.get_contentReplicator().forceInbound(t,n,r)},e.prototype.setFileIdentityGuid=function(e){var t=null,n=new Da.GraphIterator;return n.set(e),n.tryToRootAtAncestorOfType(4),n.returnToAncestorOfType(4)&&(t=n.get_currentNode().get_id().guid.toString(),this.getMetadataForWrite(e).set_fileIdentityGuid(t),n.get_currentNode().get_properties().setValue(py.w.fileIdentityGuid,t)),t},e.prototype.setSectionColor=function(e,t){void 0===t&&(t=0);var n=!!t,r=new Da.GraphIterator;r.set(e),r.tryToRootAtAncestorOfType(4),r.returnToAncestorOfType(4)&&(n||(t=jc.s(1,17)),this.getMetadataForWrite(e).set_sectionColor(Xy.o.notebookColorToBGRValue[t]))},e.prototype.persistSectionColor=function(e){if(e&&_T.d(e)&&Br.App.notebookMode){var t=Xy.o.notebookBGRValueToColor[_T.R(e).toString()],n=this._graphTransactionFactory.getTransaction(7);n.setFromNode(e),this.setSectionColor(e,t),n.dispose()}},e.prototype.getMetadataForWrite=function(e){return e.get_contentMetadata()},e}();(0,o.l)(FA,"SectionEditor",null,[CT.f]);var EA=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.NotebookLevelEditors"},e.prototype.configure=function(e){!function(e){e.register(jT.q).singleInstance().usingFactory((function(){return new uA})),e.register(lA).as($T.x).singleInstance().usingFactory((function(){return new lA(e.resolve(QT.s),e.resolve(Vd.c),(function(){return Br.App.get_activeAppFrame().workspace}),e.resolve(JT.v),e.resolve(jT.q))})),e.register(TA).as(XT.e).singleInstance().usingFactory((function(){return new TA(e.resolveLazy(rl.w))})),e.register(bA).as(QT.s).as(qT.s).singleInstance().usingFactory((function(){return new bA(e.resolve(CT.f),e.resolve(YT.x),e.resolve(Vd.c),e.resolve(Zd.u),(function(){return Br.App.get_activeAppFrame()?Br.App.get_activeAppFrame().workspace:null}))})),e.register(FA).as(CT.f).singleInstance().usingFactory((function(){return new FA(e.resolveLazy($T.x),e.resolveLazy(QT.s),e.resolve(XT.e),e.resolve(Vd.c),(function(){return Br.App.get_activeAppFrame().workspace}))})),e.register(xA).as(YT.x).singleInstance().usingFactory((function(){return new xA(e.resolveLazy(CT.f),e.resolve(ZT),e.resolve(Zd.u),e.resolve(Vd.c))})),e.register(IA).as(ZT).singleInstance().usingFactory((function(){return new IA(e.resolve(eA.f),e.resolveLazy(YT.x),e.resolve(tA.e),e.resolve(Vd.c))})),e.register(gA).as(nA).singleInstance().usingFactory((function(){return new gA(e.resolve(QT.s),e.resolve(JT.v),e.resolve($T.x))})),e.register(CA).as(eA.f).as(rA.f).singleInstance().usingFactory((function(){return new CA(e.resolveLazy(ZT),e.resolve(XT.e),e.resolve(Vd.c),e.resolveLazy(nA),e.resolveLazy(YT.x),e.resolveLazy(CT.f),e.resolveLazy(JT.v))}))}(e)},e.prototype.init=function(){se.w.get_instance().resolve(qT.s)},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(EA,"OneNoteNotebookLevelEditorsPackage",null,[l.u,c.s]);var PA=(0,o.y)("ITitleEditor"),kA=n(2960),DA=function(){function e(){}return e.prototype.extendGraphNode=function(e){},e}();(0,o.l)(DA,"CreateParagraphStrategy",null,[oc]);var MA=function(){function e(t,n){this._listEditor=null,this._insertionPointFormatting=null,this._trackChangeManager=null,this._trackChangeEditor=null,this._listEditor=n,e._listReader=t}return e.prototype.get_listEditor=function(){return this._listEditor.get_value()},e.prototype.get_insertionPointFormatting=function(){return this._insertionPointFormatting||(this._insertionPointFormatting=se.w.get_instance().tryResolve(ah.c))},e.prototype.get_trackChangeManager=function(){return this._trackChangeManager||(this._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},e.prototype.get_trackChangeEditor=function(){return this._trackChangeEditor||(this._trackChangeEditor=se.w.get_instance().resolve(cc.x).get_instance())},e.prototype.getStyleFromIp=function(e){var t=e,n=t.get_node(),r=this.get_insertionPointFormatting()?this.get_insertionPointFormatting().getCharacterStyleObjectId():null,i=null;if(r&&!r.equals(Dt.h.get_nil())){var o=n.get_containingObjectSpace();if(!o)return null;var a=o.getObject(r);if(!a)return null;if((i=a)&&1!==Tc.StyleReader.getStyleTargetType(i))return null}else{var s=Ps.FormattingReader.getFormattingObject(t);i=Ps.FormattingReader.getCharacterStyleContainer(s)}return i},e.prototype.setStyleOnParagraphNode=function(t,n,r,i){if(void 0===i&&(i=!1),cs.ParagraphReader.isParagraphNode(n))if(t)if(Tc.StyleReader.isValidStyleContainer(t))if(2===Tc.StyleReader.getStyleTargetType(t)){var o=n,a=Tc.StyleReader.getStyleSetFromParagraphNode(o);if(a){var s=Tc.StyleReader.getStyleId(t);if(s){if(a.getStyleById(s)){var l=null,c=this.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&!i?o.getCurrentFormatProperties():null;r||(l=this.get_listEditor().reapplyListInfoWithoutPargraphStyleIfNecessary(l,o),e.get_paragraphEditor().clearParagraphFormatting(o,!0)),this.updateStyleSetFromParagraphNode(o,a),us.n.get_instance().get_item(61)||(t=a.getStyleById(Tc.StyleReader.getStyleId(t))),o.get_properties().setValue(qc.o.paragraphStyle,t.get_id()),o.styleCache=t;for(var u=0;u<o.get_characterProperties().get_length();u++)o.get_characterProperties().get_item(u).get_formatting()&&o.get_characterProperties().get_item(u).get_formatting().invalidateCache();e.get_lstReader().doesStyleImplyList(t)&&(l||((l=new Da.GraphIterator).set(o),l.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(l)),mc.ListReader.isListOutlineElement(l)||(o.removeProperties(ks.j.paraIndentLeft,ks.j.paraIndentLeftChars,ks.j.paraIndentFirstLine,ks.j.paraIndentFirstLineChars,ks.j.paraTabCountInTheBeginning,ks.j.paraCustomTabStops),this.applyListInfoFromStyle(l,t))),this.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&!i&&c&&this.get_trackChangeEditor().setParagraphFormatChange(o,c,this.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled())}}else C.ULS.shipAssertTag(7467993,324,!1)}else C.ULS.shipAssertTag(7467992,324,!1)}else C.ULS.shipAssertTag(7467991,324,!1);else C.ULS.shipAssertTag(7467990,324,!1);else C.ULS.shipAssertTag(7467989,324,!1);else C.ULS.shipAssertTag(7467988,324,!1)},e.prototype.applyListInfoFromStyle=function(e,t){},e.prototype.setStyleOnParagraphNodeByName=function(e,t){if(t){C.ULS.shipAssertTag(7467995,324,t.get_isConnected(),"paragraphNode not connected");var n=Tc.StyleReader.getStyleSetFromParagraphNode(t);if(n){var r=n.getStyleByName(e);if(!r||!Tc.StyleReader.isValidStyleContainer(r))return C.ULS.shipAssertTag(7467997,324,!!r),void C.ULS.shipAssertTag(7467998,324,Tc.StyleReader.isValidStyleContainer(r));this.setStyleOnParagraphNode(r,t,!1)}else C.ULS.shipAssertTag(7467996,324,!1,"StyleReader.GetStyleSetFromParagraphNode==null")}else C.ULS.shipAssertTag(7467994,324,!1)},e.prototype.clearStyleOnParagraphNode=function(e,t){var n;void 0===t&&(t=!1),n=Hr.n(e)?Hr.x(e)?Tc.StyleReader.getStyleSetFromParagraphNode(e).getStyleById(Tc.StyleReader.styleIdDateTime):Tc.StyleReader.getStyleSetFromParagraphNode(e).getStyleById(Tc.StyleReader.styleIdTitle):Tc.StyleReader.getStyleSetFromParagraphNode(e).getStyleById(us.n.get_instance().get_item(61)?Tc.StyleReader.get_wordStyleIdNormal():Tc.StyleReader.styleIdNormal),this.setStyleOnParagraphNode(n,e,t)},e.prototype.setStyleOnIp=function(e,t){var n=Tc.StyleReader.getStyleSetFromParagraphNode(t);n&&n.getStyleById(Tc.StyleReader.getStyleId(e))&&(this.updateStyleSetFromParagraphNode(t,n),this.get_insertionPointFormatting()&&(this.get_insertionPointFormatting().resetFormatting(),this.get_insertionPointFormatting().setCharacterStyle(e,t)))},e.prototype.updateStyleSetFromParagraphNode=function(t,n){var r=e.get_pageNavigator().navigateToPageContentNode(t);return!!r&&n.setStyleSetOnPageContentNode(r,!1)},e.get_paragraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=se.w.get_instance().resolve(gc.g))},e.set_paragraphEditor=function(t){return e._paragraphEditor=t,t},e.get_lstReader=function(){return e._listReader||(e._listReader=se.w.get_instance().resolve(ts.c))},e.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e._paragraphEditor=null,e._listReader=null,e}();(0,o.l)(MA,"StyleEditor",null,[uc.e]);var RA=function(){return function(){this.depthFromOld=0,this.depthFromNew=0,this.depthFromOld=0,this.depthFromNew=0}}();(0,o.l)(RA,"AboveOutlineElementData",null,[]);var LA=function(){return function(e){this.depthAboveOldParent=0,this.depthAboveNewParent=0,this.nodeToInsertAfter=null,this.nodeToInsertAfter=e,this.depthAboveOldParent=0,this.depthAboveNewParent=0}}();(0,o.l)(LA,"DemoteParentData",null,[]);var NA=function(){return function(e){this.levelDifferenceNewParent=0,this.nodeToInsertAfter=null,this.levelDifferenceNewParent=0,this.nodeToInsertAfter=e}}();(0,o.l)(NA,"PromoteParentData",null,[]);var BA=function(){function e(e,t){this._listReader=null,this._oulineElementEditor=null,this._listReader=e,this._oulineElementEditor=t}return e.prototype.get_outlineElementEditor=function(){return this._oulineElementEditor.get_value()},e.prototype.canPromote=function(e,t){if(!Ls.OutlineElementReader.isOutlineElement(e))return!1;if(Ls.OutlineElementReader.getAbsoluteOutlineLevel(e)+t<Cc.k.first)return!1;if(Hr.b(e))return!1;if(Ls.OutlineElementReader.requiresStrictOutlineStructure(e)&&e.hasChildrenOfRole(1))return!1;var n=new Da.GraphIterator;return n.setFrom(e),this.getPromoteParent(n,t,new NA(null))},e.prototype.promote=function(e,t,n){for(t=this.ensureValidPromoteDemoteAction(e,t);t++<0;)this.promoteOutlineElement(e,n)},e.prototype.canDemote=function(e,t){if(!Ls.OutlineElementReader.isOutlineElement(e))return!1;var n=Ls.OutlineElementReader.getAbsoluteOutlineLevel(e);if(n+t>Cc.k.last)return!1;var r,i=Ls.OutlineElementReader.getIndentInfoFromOutlineElement(e.get_currentNode()),o=Da.GraphIterator.createFromNode(e.get_currentNode());o.tryToRootAtAncestorOfType(10);Sc.returnToOutlineOrTableCell(o);var a=vc.getOutlineWidthInMu(o.get_currentNode(),(0,p.m)((function(){return r}),(function(e){return r=e})));if(r&&i.getDxIndentInMu(Cc.k.body,n+t)>=a-.5)return!1;if(e.tryToRootAtAncestorOfType(10),Hr.b(e))return!1;if(Ls.OutlineElementReader.requiresStrictOutlineStructure(e)){if(1!==t)return!1;var s=new Da.GraphIterator;if(s.setFrom(e),hs.OutlineElementNavigator.returnToOutlineElement(s),s.isFirstSiblingByRole(1))return!1}return!0},e.prototype.demote=function(e,t,n){for(t=this.ensureValidPromoteDemoteAction(e,t);t-- >0;)this.demoteOutlineElement(e,n)},e.prototype.ensureValidPromoteDemoteAction=function(e,t){var n=Ls.OutlineElementReader.getAbsoluteOutlineLevel(e),r=n+t;return r<Cc.k.first?t=(r=Cc.k.first)-n:r>Cc.k.last&&(t=(r=Cc.k.last)-n),t},e.prototype.getPromoteParent=function(e,t,n){for(e.isFirstSiblingByRole(1)?n.nodeToInsertAfter=null:(n.nodeToInsertAfter=e.goToPreviousSiblingByRole(1),e.goToNextSiblingByRole(1)),e.returnToParent();e.get_currentNode();){var r=Ls.OutlineElementReader.getChildLevel(e.get_currentNode());if((t+=r)>0&&(!Ls.OutlineElementReader.isOutlineGroup(e)||r===t))return n.levelDifferenceNewParent=t,!0;if(vc.isOutlineOrTableCellNode(e.get_currentNode()))return!1;n.nodeToInsertAfter=e.get_currentNode(),e.returnToParent()}return!1},e.prototype.promoteOutlineElement=function(e,t){if(Ls.OutlineElementReader.isOutlineElement(e)){this.reparentBelow(e,-1,1,!!(1&t));var n=new Em(e),r=new Da.GraphIterator;r.setFrom(e);var i=new NA(null);if(this.getPromoteParent(r,-1,i)){var o=new bc(i.nodeToInsertAfter);this.get_outlineElementEditor().getValidParent(r,i.levelDifferenceNewParent,e.get_currentNode(),o)&&(n.restore(e),this.moveElementNode(e,r,o.nodeToInsertAfter,t))}}},e.prototype.promoteAllOutlineElements=function(e,t,n){if(!(t>=0)){var r=Ls.OutlineElementReader.getChildLevel(e.get_currentNode());if(r>-t)e.get_currentNode().setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,r+t));else{var i=new Da.GraphIterator;i.setFrom(e),i.goToLastChildByRole(1);var o=!1;do{var a=new Da.GraphIterator;a.setFrom(i),i.isFirstSiblingByRole(1)&&(i.returnToParent(),i.get_currentNode()===e.get_currentNode()?o=!0:i.isFirstSiblingByRole(1)&&(i.returnToParent(),o=!0)),o||(i.goToPreviousSiblingByRole(1),Ls.OutlineElementReader.isOutlineGroup(i)&&i.goToLastChildByRole(1));var s=new Em(i);this.promote(a,t,1|n),s.restore(i)}while(!o)}}},e.prototype.getDemoteParent=function(e,t,n){if(!Ls.OutlineElementReader.isOutlineElement(e))return!1;var r=new RA;if(!this.getAboveOutlineElement(e,t,r))return!1;var i=e.get_currentNode();if(n.depthAboveOldParent=t,r.depthFromNew)if(r.depthFromNew<0)n.depthAboveNewParent=-r.depthFromNew,n.nodeToInsertAfter=null;else{var o=new NA(n.nodeToInsertAfter);if(!this.getPromoteParent(e,-r.depthFromNew,o))return!1;n.depthAboveNewParent=o.levelDifferenceNewParent,n.nodeToInsertAfter=o.nodeToInsertAfter,Ls.OutlineElementReader.isOutlineGroup(e)?(n.nodeToInsertAfter=e.get_currentNode(),e.returnToParent(),n.depthAboveNewParent+=Ls.OutlineElementReader.getChildLevel(e.get_currentNode())):e.hasChild(i)&&(n.nodeToInsertAfter=i)}else{var a=e.returnToParent(),s=Ls.OutlineElementReader.getChildLevel(a);n.depthAboveNewParent=s,n.nodeToInsertAfter=i}return!0},e.prototype.demoteOutlineElement=function(e,t){var n=new Em(e),r=new Da.GraphIterator;r.setFrom(e);var i=new LA(null);if(this.getDemoteParent(r,1,i)){var o=new bc(i.nodeToInsertAfter);if(this.get_outlineElementEditor().getValidParent(r,i.depthAboveNewParent,e.get_currentNode(),o)){n.restore(e);var a=mc.ListReader.isListOutlineElement(e);this.moveElementNode(e,r,o.nodeToInsertAfter,t),1&t||!e.hasChildrenOfRole(1)||this.promoteAllOutlineElements(e,-1,a?0:2)}}},e.prototype.moveElementNode=function(e,t,n,r){if(vc.isOutlineOrTableCellNode(e.get_currentNode())||Ls.OutlineElementReader.isOutlineElement(e)||Ls.OutlineElementReader.isOutlineGroup(e)){var i=new Da.GraphIterator;if(i.setFrom(e),i.returnToParent(),mc.ListReader.isListOutlineElement(e)&&!(2&r)){var o=this._listReader.getListInfo(e);o.setListStyle(o.get_listType(),0),o.clearNumbering()}var a=e.get_currentNode();if(Ec.u(e,t,n,1),t.goToChild(a),this.get_outlineElementEditor().postOutlineElementMove(i),e.set(a),e.tryToRootAtOutlineAncestor(),t.setFrom(e),t.returnToParent(),Br.App.get_activeAppFrame()){var s=Br.App.get_activeAppFrame().workspace.get_contentView();s.get_isInteractiveView()&&s.endEditing(!0,14)}}},e.prototype.getAboveOutlineElement=function(e,t,n){var r=0,i=!1;if(1!==e.get_role()){for(;1!==e.get_role()&&!e.get_isAtOrigin();)e.returnToParent();if(!vc.isOutline(e)&&!Ls.OutlineElementReader.isOutlineElement(e))return!1}else{for(var o=!1;!o&&e.isFirstSiblingByRole(1);)if(e.returnToParent(),Ls.OutlineElementReader.isOutlineGroup(e)){if(r)return!1;r=Ls.OutlineElementReader.getChildLevel(e.get_currentNode())}else o=!0;o||(i=!!e.goToPreviousSiblingByRole(1))}if(i){for(n.depthFromOld=-r;e.getChildCountByRole(1)>0;)n.depthFromOld+=Ls.OutlineElementReader.getChildLevel(e.get_currentNode()),e.goToLastChildByRole(1);return n.depthFromNew=n.depthFromOld-t,!0}var a=Ls.OutlineElementReader.getChildLevel(e.get_currentNode())+r;return n.depthFromNew=-(t+a),n.depthFromOld=-a,!0},e.prototype.reparentBelow=function(e,t,n,r){try{var i=new Da.GraphIterator;i.setFrom(e);var o=null;if(i.hasChildrenOfRole(n)){if(!r)(s=Ls.OutlineElementReader.getChildLevel(i.get_currentNode()))!==Cc.k.nil&&i.get_currentNode().setValue(Kc.b.outlineElementChildLevel,Math.min(Cc.k.nil,s-t));o=i.goToLastChildByRole(n),i.returnToParent()}var a=null;for(i.get_role()===n?a=i.goToNextSiblingByRoleOrReturnToParent(n):(i.returnToParent(),i.hasChildrenOfRole(n)&&(a=i.goToFirstChildByRole(n)));;){if(!a)do{var s;if(t+=s=Ls.OutlineElementReader.getChildLevel(i.get_currentNode()),i.get_isAtOrigin()||(a=i.goToNextSiblingByRoleOrReturnToParent(n)),t>=0)return}while(!a);var l=new Da.GraphIterator;l.setFrom(e);var c=new Da.GraphIterator;c.setFrom(i);var u=new Da.GraphIterator;u.setFrom(c),u.returnToParent(),a=i.goToNextSiblingByRoleOrReturnToParent(n);var g=new Em(c),p=new bc(o);this.get_outlineElementEditor().getValidParent(l,-t,null,p),g.restore(c),Ec.u(c,l,p.nodeToInsertAfter,c.get_role()),o=c.get_currentNode()}}finally{}},e}();(0,o.l)(BA,"OutlineElementIndentationEditor",null,[xT.p]);var OA=function(){function e(t){this._lastCreatedOutlineNode=null,e._outlineEditor=t}return e.prototype.createOutline=function(t){if(!e.get_pageReader().isPageContent(t))return null;t.goToFirstChildByRole(1)&&(t.get_currentNode().invalidateViewElements(8,!0),t.returnToParent());var n=e._outlineEditor.createOutlineNode();return e.get_pageReader().isRtl(t.get_currentNode())?n.setValue(Kc.b.layoutAlignmentSelf,11):n.setValue(Kc.b.layoutAlignmentSelf,9),t.addChild(n,1),t.goToChild(n),n},e.prototype.setLastCreatedOutlineNode=function(e){if(us.n.get_instance().get_item(17)){if(this._lastCreatedOutlineNode&&e!==this._lastCreatedOutlineNode){var t=new De.c(2,1,0,o.i(this,this.checkAndDeleteEphemeralOutline,"checkAndDeleteEphemeralOutline"),120);t.customData=this._lastCreatedOutlineNode,L.AFrameworkApplication.get_theTaskManager().addTask(t)}this._lastCreatedOutlineNode=e}},e.prototype.deleteOutline=function(e,t){this._lastCreatedOutlineNode===e.get_currentNode()&&(this._lastCreatedOutlineNode=null);var n=new as.GraphTransaction(t);n.setFromIterator(e),e.disconnectNodeAndReturnToParent(),n.dispose()},e.prototype.cleanEphemeralOutline=function(){if(us.n.get_instance().get_item(17)&&this._lastCreatedOutlineNode&&this._lastCreatedOutlineNode.get_anchor()){var e=Da.GraphIterator.createFromNode(this._lastCreatedOutlineNode);e.tryToRootAtPageContent()&&vc.isEphemeral(e)&&this.deleteOutline(e,7),this._lastCreatedOutlineNode=null}},e.prototype.checkAndDeleteEphemeralOutline=function(e){var t=e.customData;if(t.get_anchor()){Xi.t.mark(4763);var n=Da.GraphIterator.createFromNode(t);if(n.tryToRootAtAncestorOfType(8)&&n.returnToAncestorOfType(8)&&n.tryGoToChild(t)===t){if(vc.isEmpty(n)){for(var r=!1,i=0;i<Oa.SelectionManager.get_instance().get_selectionCollection().get_length();i++)for(var o=Oa.SelectionManager.get_instance().get_selectionCollection().get_item(i),a=0;a<o.get_length();a++){if(o.get_item(a).get_node()===t){r=!0;break}}r||this.deleteOutline(n,7)}Xi.t.mark(4764)}}},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e.titleOutlineMinimumWidth=2.25,e._outlineEditor=null,e}();(0,o.l)(OA,"PageContentEditor$0",null,[bm.m]);var UA=n(3304),HA=n(4654),GA=n(7041),VA=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.setRtl=function(e,t){e.get_properties().setValue(Kc.b.editRootRTL,t)},t.prototype.setPageColor=function(e,t){t===Xy.o.nil?e.get_properties().removeProperty(Kc.b.pageColor):e.get_properties().setValue(Kc.b.pageColor,t)},t.prototype.setLayoutResolveChildCollisions=function(e){us.n.get_instance().get_item(25)&&e.get_properties().setValue(Kc.b.layoutResolveChildCollisions,!0)},t.prototype.setTitle=function(e,n){if(OA.get_pageReader().isPageContent(e)){var r,i=new Da.GraphIterator;i.setFrom(e),UA.v(i)||this.createTitle(i,null,L.AFrameworkApplication.requestedLcid),i.goToFirstChildByRole(1),i.hasChildrenOfRole(1)?(i.goToFirstChild(),r=hs.OutlineElementNavigator.moveToContent(i)):r=this.createEmptyTitle(i);var o=cs.ParagraphReader.textLength(r),a=_s.y.createTextRange(r,0,o);t.get_characterPropertiesEditor().replaceTextRange(a,n)}},t.prototype.createEmptyTitle=function(e){var n=OA._outlineEditor.appendOutlineElement(e,!0);n.setValue(Kc.b.cannotBeSelected,!0),n.setValue(Kc.b.cannotBeRemoved,!0),t.get_titleEditor().setIsTitleText(e.get_currentNode(),!0);var r=hs.OutlineElementNavigator.moveToContent(e);return t.get_formattingEditor().setLanguageOnParagraph(Ps.FormattingReader.getFormattingObject(_s.y.createIpContext(r,0)),L.AFrameworkApplication.requestedLcid),t.get_styleEditor().setStyleOnParagraphNode(Tc.StyleReader.getStyleSetFromParagraphNode(e.get_currentNode()).getStyleByName(Box4Intl.Box4Strings.L_StyleTitle),e.get_currentNode(),!1),t.get_titleEditor().setIsTitleText(e.get_currentNode(),!0),r},t.prototype.createTitle=function(e,n,r){if(void 0===n&&(n=null),void 0===r&&(r=null),!OA.get_pageReader().isPageContent(e))return null;var i,o,a;this.extractTitleDateTimeLcid(n,r,(0,p.m)((function(){return i}),(function(e){return i=e})),(0,p.m)((function(){return o}),(function(e){return o=e})),(0,p.m)((function(){return a}),(function(e){return a=e})));var s=new HA.f;e.addChild(s,5),e.goToChild(s),s.setValue(Kc.b.offsetFromParentHoriz,0),s.setValue(Kc.b.offsetFromParentVert,0),s.setValue(Kc.b.layoutAlignmentInParent,589836),s.setValue(Kc.b.layoutAlignmentSelf,0);var l=t.get_titleEditor().createOutline(e,!1);l.setValue(Kc.b.cannotBeSelected,!0),l.setValue(Kc.b.cannotBeRemoved,!0),l.setValue(Kc.b.descendantsCannotBeMoved,!0),l.setValue(Kc.b.enforceOutlineStructure,!0),l.setValue(Kc.b.layoutTightAlignment,!0),l.setValue(Kc.b.layoutMinimumOutlineWidth,Jg.vE(OA.titleOutlineMinimumWidth)),t.get_titleEditor().setIsTitleText(e.get_currentNode(),!0);var c=OA._outlineEditor.appendOutlineElement(e,!0);c.setValue(Kc.b.cannotBeSelected,!0),c.setValue(Kc.b.cannotBeRemoved,!0),t.get_titleEditor().setIsTitleText(e.get_currentNode(),!0);var u=hs.OutlineElementNavigator.moveToContent(e);t.get_formattingEditor().setLanguageOnParagraph(Ps.FormattingReader.getFormattingObject(_s.y.createIpContext(u,0)),L.AFrameworkApplication.requestedLcid),t.get_styleEditor().setStyleOnParagraphNode(Tc.StyleReader.getStyleSetFromParagraphNode(e.get_currentNode()).getStyleByName(Box4Intl.Box4Strings.L_StyleTitle),e.get_currentNode(),!1),t.get_titleEditor().setIsTitleText(e.get_currentNode(),!0);var g=new Gf.d;g.languageId=a,e.returnToNodeOfType(9),(l=t.get_titleEditor().createOutline(e,!0)).setValue(Kc.b.cannotBeSelected,!0),l.setValue(Kc.b.isReadOnly,!0),l.setValue(Kc.b.deletable,!0),l.setValue(Kc.b.layoutTightLayout,!0),t.get_titleEditor().setIsTitleDate(e.get_currentNode(),!0),(c=OA._outlineEditor.appendOutlineElement(e,!0,g)).setValue(Kc.b.cannotBeSelected,!0),e.get_currentNode().setValue(Kc.b.deletable,!0),u=hs.OutlineElementNavigator.moveToContent(e);var d=_s.y.createIpContext(u,0);return t.get_formattingEditor().setLanguageOnParagraph(Ps.FormattingReader.getFormattingObject(d),a),t.get_titleEditor().setIsTitleDate(e.get_currentNode(),!0),e.get_currentNode().setValue(Kc.b.isReadOnly,!0),e.get_currentNode().setValue(Kc.b.isBoilerText,!0),e.get_currentNode().setValue(Kc.b.deletable,!0),e.get_currentNode().setValue(Kc.b.layoutTightLayout,!0),t.get_characterPropertiesEditor().replaceTextRange(d,i),t.get_styleEditor().setStyleOnParagraphNode(Tc.StyleReader.getStyleSetFromParagraphNode(e.get_currentNode()).getStyleByName(Box4Intl.Box4Strings.L_StyleDateTime),e.get_currentNode(),!1),e.returnToNodeOfType(10),(c=OA._outlineEditor.appendOutlineElement(e,!0,g)).setValue(Kc.b.cannotBeSelected,!0),e.get_currentNode().setValue(Kc.b.deletable,!0),u=hs.OutlineElementNavigator.moveToContent(e),d=_s.y.createIpContext(u,0),t.get_formattingEditor().setLanguageOnParagraph(Ps.FormattingReader.getFormattingObject(d),a),t.get_titleEditor().setIsTitleTime(e.get_currentNode(),!0),e.get_currentNode().setValue(Kc.b.isReadOnly,!0),e.get_currentNode().setValue(Kc.b.isBoilerText,!0),e.get_currentNode().setValue(Kc.b.deletable,!0),e.get_currentNode().setValue(Kc.b.layoutTightLayout,!0),t.get_characterPropertiesEditor().replaceTextRange(d,o),t.get_styleEditor().setStyleOnParagraphNode(Tc.StyleReader.getStyleSetFromParagraphNode(e.get_currentNode()).getStyleByName(Box4Intl.Box4Strings.L_StyleDateTime),e.get_currentNode(),!1),e.returnToNode(s),s},t.prototype.extractTitleDateTimeLcid=function(e,t,n,r,i){n.val="",r.val="",i.val=Kt.i.get_invariantCulture().get_LCID();var o=Kt.i.getCultureInfo(GA.b.get_dataCulture().name);o&&(i.val=o.get_LCID()),e=e||new Date,n.val=GA.b.formatDate(e,"D",GA.b.get_dataCulture()),r.val=GA.b.formatDate(e,"t",GA.b.get_dataCulture())},t.prototype.setMarginOrigin=function(e){var t=OA.get_pageReader().isRtl(e)?-Qc.PageReader.pageMarginX:Qc.PageReader.pageMarginX;e.setValue(Kc.b.pageMarginOriginX,t),e.setValue(Kc.b.pageMarginOriginY,Qc.PageReader.pageMarginY)},t.get_formattingEditor=function(){return t._formattingEditor||(t._formattingEditor=se.w.get_instance().resolve(xs.z))},t.set_formattingEditor=function(e){return t._formattingEditor=e,e},t.get_styleEditor=function(){return t._styleEditor||(t._styleEditor=se.w.get_instance().resolve(uc.e))},t.set_styleEditor=function(e){return t._styleEditor=e,e},t.get_characterPropertiesEditor=function(){return t._characterPropertiesEditor||(t._characterPropertiesEditor=se.w.get_instance().resolve(Va.x))},t.set_characterPropertiesEditor=function(e){return t._characterPropertiesEditor=e,e},t.get_titleEditor=function(){return t._titleEditor||(t._titleEditor=se.w.get_instance().resolve(PA))},t.set_titleEditor=function(e){return t._titleEditor=e,e},t._formattingEditor=null,t._styleEditor=null,t._characterPropertiesEditor=null,t._titleEditor=null,t}(OA);(0,o.l)(VA,"PageContentEditor",OA,[AA.m,bm.m]);var WA=function(){function e(){}return e.prototype.createOutline=function(t,n){if(!Hr.u(t))return null;var r=e.get_outlineEditor().createOutlineNode(n);return r.setValue(Kc.b.layoutAlignmentSelf,12),t.addChild(r,1),t.goToChild(r),r},e.prototype.setIsTitleTime=function(e,t){e.get_properties().setValue(Kc.b.isTitleTime,t)},e.prototype.setIsTitleDate=function(e,t){e.get_properties().setValue(Kc.b.isTitleDate,t)},e.prototype.setIsTitleText=function(e,t){e.get_properties().setValue(Kc.b.isTitleText,t)},e.prototype.setTitleText=function(t,n){if(n&&""!==n){var r=t.get_currentNode();UA.v(t);var i=UA.q(t),o=_s.y.createIpContext(i,0);e.get_characterPropertiesEditor().replaceTextRange(o,n),t.returnToNode(r)}},e.get_outlineEditor=function(){return e._outlineEditor||(e._outlineEditor=se.w.get_instance().resolve(rc.a))},e.set_outlineEditor=function(t){return e._outlineEditor=t,t},e.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=se.w.get_instance().resolve(Va.x))},e.set_characterPropertiesEditor=function(t){return e._characterPropertiesEditor=t,t},e._outlineEditor=null,e._characterPropertiesEditor=null,e}();(0,o.l)(WA,"TitleEditor",null,[PA]);var zA=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.OutlineLevelEditors"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OutlineLevelEditorsDelayInitializationEnabled")&&function(e){e.register(kA.q).as(ic.z).singleInstance(),e.register(VA).as(AA.m).as(bm.m).singleInstance().usingFactory((function(){return new VA(e.resolve(rc.a))})),e.register(BA).as(xT.p).singleInstance().usingFactory((function(){return new BA(e.resolve(ts.c),e.resolveLazy(Es.p))})),e.register(WA).as(PA).singleInstance().usingFactory((function(){return new WA})),e.register(MA).as(uc.e).singleInstance().usingFactory((function(){return new MA(e.resolve(ts.c),e.resolveLazy(rs.v))})),e.register(DA).as(oc).singleInstance()}(e)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(zA,"OneNoteOutlineLevelEditorsPackage",null,[l.u,c.s]);var KA=(0,o.y)("IOfflineSyncStatusHandler"),qA=n(409),jA=(0,o.y)("ISyncStatusWrapper"),$A=(0,o.y)("IPageSyncStatusPublisher"),QA=n(2714),JA=n(1080),XA=function(){function e(e,t){this._workspace=null,this._timerId=0,this.isOffline=!1,this.isOfflineMoreThanAMinute=!1,e.subscribe(this),this._workspace=t}return e.prototype.get_isOffline=function(){return this.isOffline},e.prototype.get_isOfflineMoreThanAMinute=function(){return this.isOfflineMoreThanAMinute},e.prototype.get_syncStatusPublisher=function(){return se.w.get_instance().resolve($A)},e.prototype.get_syncStatusWrapper=function(){return se.w.get_instance().resolve(jA)},e.prototype.serverConnectivityChanged=function(e){var t=this.get_isOffline();this.isOffline=!e,!t&&this.get_isOffline()?(Br.App.get_activeAppFrame().logUnsavedChanges("NetworkDisconnected"),this._timerId=window.setTimeout(o.i(this,this.offlineAfterTimer,"offlineAfterTimer"),6e4),this._workspace.get_activePage()&&this.get_syncStatusPublisher().publishOfflineStatus(this._workspace.get_activePage().currentSyncState,!1)):t&&!this.get_isOffline()&&this._timerId&&(window.clearTimeout(this._timerId),this._workspace.get_activePage()&&(this.get_syncStatusWrapper().updateSyncStatusFromOffline(this._workspace.get_activePage().get_contentReplicator()),this.get_syncStatusPublisher().publishSyncStatus(this.get_syncStatusWrapper().getCurrentSyncState(this._workspace.get_activePage().get_contentReplicator()))),C.ULS.sendTraceTag(50922010,339,15,"OfflineSyncStatusHandler: Server Connectivity Status changed from offline to online")),this.isOfflineMoreThanAMinute=!1},e.prototype.offlineAfterTimer=function(){this.get_isOffline()&&(this.isOfflineMoreThanAMinute=!0,this._workspace.get_activePage()&&this.get_syncStatusPublisher().publishOfflineStatus(this._workspace.get_activePage().currentSyncState,!0),C.ULS.sendTraceTag(50922011,339,15,"OfflineSyncStatusHandler: In Offline State more than a minute"))},e}();(0,o.l)(XA,"OfflineSyncStatusHandler",null,[KA,JA.s]);var YA=function(){return function(e,t,n,r){void 0===r&&(r=-1),this.status=0,this.resultCode=0,this.lastSuccessfulTime=null,this.uploadingFileCount=0,this.hasUnsavedChanges=!1,this.hasReadAccess=!1,this.status=e,this.resultCode=t,this.lastSuccessfulTime=n,this.uploadingFileCount=r}}();(0,o.l)(YA,"SyncState",null,[]);var ZA=n(2701),eI=function(){function e(e,t,n){var r=this;this._syncStatusWrapper=null,this._syncStatusPublisher=null,this._workspace=null,this._editNotificationEventSource=null,this.offlineHandler=null,e.add_onOutboundReplicationStart(o.i(this,this.onOutboundStart,"onOutboundStart")),e.add_onSuccessfulOutboundEvent(o.i(this,this.onSuccessfulOutbound,"onSuccessfulOutbound")),e.add_onFailedOutboundEvent(o.i(this,this.onFailedOutbound,"onFailedOutbound")),e.add_onSuccessfulInboundEvent(o.i(this,this.onSuccessfulInbound,"onSuccessfulInbound")),e.add_onFirstSuccessfulInboundEvent(o.i(this,this.onSuccessfulInbound,"onSuccessfulInbound")),e.add_onFailedInboundEvent(o.i(this,this.onFailedInbound,"onFailedInbound")),t.add_onUploadStarted(o.i(this,this.onFileUploadStart,"onFileUploadStart")),t.add_onUploadCompleted(o.i(this,this.onFileUploadCompleted,"onFileUploadCompleted")),n.add_beforePageSwitch(o.i(this,this.beforeActivePageChanged,"beforeActivePageChanged")),this._workspace=n,this.offlineHandler=se.w.get_instance().resolve(KA),this._editNotificationEventSource=se.w.get_instance().resolveFuture(Pe.n),this._editNotificationEventSource&&this._editNotificationEventSource.execute((function(e){e.add_onEditHappened(o.i(r,r.onEditHappenedHandler,"onEditHappenedHandler"))})),this.publishInitialSyncStatusUpdate()}return e.prototype.get_syncStatusWrapper=function(){return this._syncStatusWrapper||(this._syncStatusWrapper=se.w.get_instance().resolve(jA))},e.prototype.get_syncStatusPublisher=function(){return this._syncStatusPublisher||(this._syncStatusPublisher=se.w.get_instance().resolve($A))},e.prototype.onOutboundStart=function(e,t){this.updateToSyncingState(t.get_graphSpaceReplicator())},e.prototype.onSuccessfulOutbound=function(e,t){var n=this.get_syncStatusWrapper().getCurrentSyncState(t.get_graphSpaceReplicator()),r=n?n.status:1,i=n?n.resultCode:-1;this.shouldUpdateSyncSuccessful(t.get_graphSpaceReplicator())&&(this.get_syncStatusWrapper().updateSyncState(t.get_graphSpaceReplicator(),2,0),this.shouldPublishSyncStatus(t.get_graphSpaceReplicator().get_node(),r,i,2)&&this.get_syncStatusPublisher().publishSyncStatus(this.get_syncStatusWrapper().getCurrentSyncState(t.get_graphSpaceReplicator())))},e.prototype.onFailedOutbound=function(e,t){if(!t.get_isFilteredError()){var n=t.get_graphSpaceReplicator(),r=zr.PageNavigator.get_instance().getContainingPageFromVersionOrVersionHistory(t.get_graphSpaceReplicator().get_node());r&&(n=r.get_contentReplicator());var i=this.get_syncStatusWrapper().getCurrentSyncState(n);this.updateAndPublishFailureStatus(n.get_node(),i,t.get_operationResult(),r?"Version Outbound":"Outbound")}},e.prototype.onSuccessfulInbound=function(e,t){var n=this.get_syncStatusWrapper().getCurrentSyncState(t.get_graphSpaceReplicator()),r=n?n.status:1,i=n?n.resultCode:-1;this.shouldUpdateSyncSuccessful(t.get_graphSpaceReplicator())&&!this.propagatedSectionBlockingFailure(t.get_graphSpaceReplicator().get_node(),n)&&(this.get_syncStatusWrapper().updateSyncState(t.get_graphSpaceReplicator(),2,0),this.shouldPublishSyncStatus(t.get_graphSpaceReplicator().get_node(),r,i,2)&&this.get_syncStatusPublisher().publishSyncStatus(this.get_syncStatusWrapper().getCurrentSyncState(t.get_graphSpaceReplicator())))},e.prototype.onFailedInbound=function(e,t){if(!t.get_isFilteredError()){var n=this.get_syncStatusWrapper().getCurrentSyncState(t.get_graphSpaceReplicator());this.updateAndPublishFailureStatus(t.get_graphSpaceReplicator().get_node(),n,t.get_operationResult(),"Inbound")}},e.prototype.beforeActivePageChanged=function(e,t){var n=(0,f.e)(ZA.q,t);if(this.shouldHideSyncStatus(n.newPageNode))this.get_syncStatusPublisher().hideSyncStatus();else{var r,i=!1;if(n.newPageNode.currentSyncState&&n.newPageNode.get_contentReplicator())this.propagatedSectionBlockingFailure(n.newPageNode,n.newPageNode.currentSyncState),this.offlineHandler.get_isOffline()&&4!==n.newPageNode.currentSyncState.status?(this.get_syncStatusWrapper().updateSyncState(n.newPageNode.get_contentReplicator(),4),i=!0):this.offlineHandler.get_isOffline()||4!==n.newPageNode.currentSyncState.status||(this.get_syncStatusWrapper().updateSyncStatusFromOffline(n.newPageNode.get_contentReplicator()),i=!0),r=this.get_syncStatusWrapper().getCurrentSyncState(n.newPageNode.get_contentReplicator());else{var o=this.offlineHandler.get_isOffline()?4:this.get_syncStatusWrapper().convertOperationResultToSyncStatus(n.newPageNode.inboundReplicationStatus);i=!0,n.newPageNode.get_contentReplicator()&&-1!==n.newPageNode.inboundReplicationStatus?(this.get_syncStatusWrapper().updateSyncState(n.newPageNode.get_contentReplicator(),o,n.newPageNode.inboundReplicationStatus),r=this.get_syncStatusWrapper().getCurrentSyncState(n.newPageNode.get_contentReplicator())):r=new YA(o,n.newPageNode.inboundReplicationStatus,null)}this.get_syncStatusPublisher().publishSyncStatus(r,i)}},e.prototype.onFileUploadStart=function(e,t){var n=t.get_parentGraphSpaceNode().get_contentReplicator(),r=this.get_syncStatusWrapper().getCurrentSyncState(n),i=r?r.status:1,o=r?r.resultCode:-1,a=this.offlineHandler.get_isOffline()?4:1;this.get_syncStatusWrapper().updateSyncState(n,a,-1,r.uploadingFileCount+1),this.shouldPublishSyncStatus(n.get_node(),i,o,a)&&this.get_syncStatusPublisher().publishSyncStatus(this.get_syncStatusWrapper().getCurrentSyncState(n))},e.prototype.onFileUploadCompleted=function(e,t){if(t.get_parentGraphSpaceNode()){var n=t.get_parentGraphSpaceNode().get_contentReplicator(),r=this.get_syncStatusWrapper().getCurrentSyncState(n),i=r?r.status:1,o=r?r.resultCode:-1,a=i,s=r.uploadingFileCount,l=o;s-1||t.get_uploadResult()||n.hasChangesToOutbound()?t.get_uploadResult()&&(a=this.offlineHandler.get_isOffline()?4:3,l=t.get_uploadResult(),C.ULS.sendTraceTag(50922014,339,15,"PageSyncStatusHandler: File Upload failure: {0}",l)):(a=2,l=0),this.get_syncStatusWrapper().updateSyncState(n,a,l,s-1),this.shouldPublishSyncStatus(n.get_node(),i,o,a,l)&&this.get_syncStatusPublisher().publishSyncStatus(this.get_syncStatusWrapper().getCurrentSyncState(n))}},e.prototype.onEditHappenedHandler=function(e,t){this._workspace.get_activePage()&&this._workspace.get_activePage().get_contentReplicator()&&this.updateToSyncingState(this._workspace.get_activePage().get_contentReplicator())},e.prototype.updateToIntermediateState=function(e){this.get_syncStatusWrapper().updateSyncState(e,1),this.get_syncStatusPublisher().publishSyncStatus(this.get_syncStatusWrapper().getCurrentSyncState(e))},e.prototype.updateToSyncingState=function(e){var t=this.get_syncStatusWrapper().getCurrentSyncState(e),n=t?t.status:2,r=t?t.resultCode:-1,i=!!t&&t.hasUnsavedChanges;this.offlineHandler.get_isOffline()&&4!==n?this.get_syncStatusWrapper().updateSyncState(e,4):t&&this.get_syncStatusWrapper().updateHasUnsavedChanges(e),this.shouldPublishSyncStatus(e.get_node(),n,r,1)?(this.get_syncStatusWrapper().updateSyncState(e,1),this.get_syncStatusPublisher().publishSyncStatus(this.get_syncStatusWrapper().getCurrentSyncState(e))):this.shouldPublishUnsavedChanges(e.get_node(),n,i)&&this.get_syncStatusPublisher().publishSyncStatus(this.get_syncStatusWrapper().getCurrentSyncState(e))},e.prototype.publishInitialSyncStatusUpdate=function(){var e=this._workspace.get_activePage();if(e&&e.get_contentReplicator()){var t=this.get_syncStatusWrapper().convertOperationResultToSyncStatus(e.inboundReplicationStatus);this.get_syncStatusWrapper().updateSyncState(e.get_contentReplicator(),t,e.inboundReplicationStatus),this.get_syncStatusPublisher().publishSyncStatus(this.get_syncStatusWrapper().getCurrentSyncState(e.get_contentReplicator()))}},e.prototype.shouldPublishSyncStatus=function(e,t,n,r,i){if(void 0===i&&(i=-1),this._workspace.get_activePage()===e&&!this.shouldHideSyncStatus(e))if(t!==r){if(4===r&&!this.offlineHandler.get_isOfflineMoreThanAMinute())return!1;if(1!==r||3!==t&&4!==t&&!this.offlineHandler.get_isOffline())return!0}else if(3===r&&n!==i&&-1!==i)return!0;return!1},e.prototype.shouldUpdateSyncSuccessful=function(e){var t=this.get_syncStatusWrapper().getCurrentSyncState(e),n=t?t.uploadingFileCount:0;return!e.hasChangesToOutbound()&&n<=0},e.prototype.shouldPublishUnsavedChanges=function(e,t,n){return!(this._workspace.get_activePage()!==e||n||!this.offlineHandler.get_isOfflineMoreThanAMinute()&&3!==t)},e.prototype.shouldHideSyncStatus=function(e){var t=se.w.get_instance().tryResolve(JT.v);return!e||Qc.PageReader.get_instance().isVersionNode(e)||Qc.PageReader.get_instance().isConflictPageNode(e)||!zr.PageNavigator.get_instance().getContainingSection(e)||Wr.App.oneNoteRecycleBinIsEnabled&&!!t&&t.isPageInRecycleBin(e)||this._workspace.get_contentView().get_isFishbowlView()&&(e.inboundReplicationStatus>0||!e.get_isContentPresent())},e.prototype.propagatedSectionBlockingFailure=function(e,t){if(!Qc.PageReader.get_instance().isPageNode(e))return!1;var n=ay.getSection(e);if(n){var r=_T.c(n.get_outboundReplicationStatus()),i=!_T.a(n.get_accessRights());if(r||i){var o=r?n.get_outboundReplicationStatus():7;return this.updateAndPublishFailureStatus(e,t,o,"Section Blocking"),!0}}return!1},e.prototype.updateAndPublishFailureStatus=function(e,t,n,r){var i=t?t.status:1,o=t?t.resultCode:-1,a=this.offlineHandler.get_isOffline()?4:3;this.get_syncStatusWrapper().updateSyncState(e.get_contentReplicator(),a,n),this.shouldPublishSyncStatus(e,i,o,a,n)&&(C.ULS.sendTraceTag(50922012,339,15,"PageSyncStatusHandler: {0} failure: {1}",r,n),this.get_syncStatusPublisher().publishSyncStatus(this.get_syncStatusWrapper().getCurrentSyncState(e.get_contentReplicator())))},e}();(0,o.l)(eI,"PageSyncStatusHandler",null,[]);var tI,nI=function(){function e(e){this._workspace=null,this._workspace=e}return e.prototype.registerActions=function(e){e.addAction(eb.JF,cl.n,o.i(this,this.retryPageSync,"retryPageSync"))},e.prototype.retryPageSync=function(e,t,n,r,i){var o=this._workspace.get_activePage();return 2===n&&o&&o.get_contentReplicator()?(C.ULS.sendTraceTag(50885588,305,50,"Clicked on Try Again for Page Sync: "+o.get_objectSpaceId().toString()),o.get_contentReplicator().replicateAtMaxSpeed(),se.w.get_instance().resolve(eI).updateToIntermediateState(o.get_contentReplicator()),32):1===n?32:2},e}();(0,o.l)(nI,"PageSyncStatusActor",null,[]),function(e){e[e.InProgress=1]="InProgress",e[e.Success=2]="Success",e[e.Failure=3]="Failure",e[e.Offline=4]="Offline"}(tI||(tI={})),(0,o.h)("SyncStatus",tI);var rI=function(){return function(e,t,n,r){void 0===n&&(n=null),void 0===r&&(r=null),this.syncStatus=null,this.autoShowCallout=!1,this.errorButtonText=null,this.errorButtonSecondaryText=null,this.syncStatus=e,this.autoShowCallout=t,this.errorButtonText=n,this.errorButtonSecondaryText=r}}();(0,o.l)(rI,"SyncControlStatusModel",null,[]);var iI=function(){return function(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=null),this.syncDescription=null,this.lastSyncTime=null,this.linkText=null,this.linkUrl=null,this.lastSyncTime=e,this.syncDescription=t,this.linkText=n,this.linkUrl=r}}();(0,o.l)(iI,"SyncStatusCalloutBody",null,[]);var oI=function(){return function(e,t){this.commandId=null,this.buttonText=null,this.commandId=e,this.buttonText=t}}();(0,o.l)(oI,"SyncStatusCalloutButton",null,[]);var aI=function(){return function(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),this.title=null,this.body=null,this.actionButton=null,this.title=e,this.body=t,this.actionButton=n}}();(0,o.l)(aI,"SyncStatusCalloutContent",null,[]);var sI=function(){return function(e,t){this.controlStatus=null,this.calloutContent=null,this.controlStatus=e,this.calloutContent=t}}();(0,o.l)(sI,"SyncStatusModel",null,[]);var lI=function(){function e(){this._offlineHandler=null,this.lastSyncingPublishedTime=Date.now()}return e.prototype.get_offlineHandler=function(){return this._offlineHandler||(this._offlineHandler=se.w.get_instance().resolve(KA))},e.prototype.publishSyncStatus=function(e,t){if(void 0===t&&(t=!0),e){var n=(3===e.status||4===e.status)&&t,r=null,i=null,o=null,a=null,s=null,l=null,c=null;switch(e.status){case 1:o=OneNoteIntl.OneNoteStrings.L_SyncInProgressCalloutTitle,this.lastSyncingPublishedTime=Date.now();break;case 2:o=OneNoteIntl.OneNoteStrings.L_SyncSuccessfulCalloutTitle,a=new iI(OneNoteIntl.OneNoteStrings.L_SyncSuccessfulCalloutContent);break;case 3:r=this.getSyncStatusTextFromOperationResult(e.resultCode),e.hasUnsavedChanges&&(i=r,r=OneNoteIntl.OneNoteStrings.L_SyncErrorUnsavedChanges);var u=e.lastSuccessfulTime?String.format(OneNoteIntl.OneNoteStrings.L_SyncLastSuccessfulTime,e.lastSuccessfulTime.toLocaleTimeString()):"";(c=this.getLinkToAddInCalloutDescription(e.resultCode))&&(l=OneNoteIntl.OneNoteStrings.L_SyncErrorLearnMore),a=new iI(u,this.getSyncStatusDescriptionFromSyncStatus(e),l,c),s=this.getFailureActionCalloutButton(e.resultCode);break;case 4:return void this.publishOfflineStatus(e,this.get_offlineHandler().get_isOfflineMoreThanAMinute(),n)}var g=new aI(o,a,s),p=new rI(tI[e.status],n,r,i),d=new sI(p,g);this.publishSyncStatusModelToSLR(d,1!==e.status)}},e.prototype.publishOfflineStatus=function(e,t,n){void 0===n&&(n=!0),e||(e=new YA(4,-1,null));var r=t?3:1,i=e.lastSuccessfulTime?String.format(OneNoteIntl.OneNoteStrings.L_SyncLastSuccessfulTime,e.lastSuccessfulTime.toLocaleTimeString()):"",o=null,a=null,s=null,l=null;t?(o=e.hasUnsavedChanges?OneNoteIntl.OneNoteStrings.L_SyncOfflineUnsavedChangesCalloutContent:OneNoteIntl.OneNoteStrings.L_SyncOfflineAfterMinCalloutContent,a=new oI(eb.rG(eb.JF),OneNoteIntl.OneNoteStrings.L_SyncTryAgain),e.hasUnsavedChanges?(l=OneNoteIntl.OneNoteStrings.L_SyncOfflineButtonText,s=OneNoteIntl.OneNoteStrings.L_SyncErrorUnsavedChanges,C.ULS.sendTraceTag(50922015,339,15,"PageSyncStatusPublisher: Publishing Offline status with unsaved changes")):s=OneNoteIntl.OneNoteStrings.L_SyncOfflineButtonText):(o=OneNoteIntl.OneNoteStrings.L_SyncOfflineWithInMinCalloutContent,this.lastSyncingPublishedTime=Date.now());var c=new aI(null,new iI(i,o),a),u=new rI(tI[r],n,s,l),g=new sI(u,c);this.publishSyncStatusModelToSLR(g,t)},e.prototype.hideSyncStatus=function(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("SyncStatus",!0))},e.prototype.publishSyncStatusModelToSLR=function(e,t){void 0===t&&(t=!1),this.showSyncStatus();var n=Date.now()-this.lastSyncingPublishedTime;t&&n<500?window.setTimeout((function(){appChrome.api.dispatch(appChrome.actions.updateSyncStatus(e))}),500-n):appChrome.api.dispatch(appChrome.actions.updateSyncStatus(e))},e.prototype.showSyncStatus=function(){appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("SyncStatus",!1))},e.prototype.getSyncStatusTextFromOperationResult=function(e){switch(e){case 7:return OneNoteIntl.OneNoteStrings.L_SyncErrorPermissionsButtonText;case 22:return OneNoteIntl.OneNoteStrings.L_SyncErrorOutOfStorageButtonText;default:return OneNoteIntl.OneNoteStrings.L_SyncErrorInternalButtonText}},e.prototype.getSyncStatusDescriptionFromSyncStatus=function(e){switch(e.resultCode){case 7:return String.format(e.hasReadAccess?OneNoteIntl.OneNoteStrings.L_SyncErrorPermissionsReadOnlyCalloutContent:OneNoteIntl.OneNoteStrings.L_SyncErrorPermissionsCalloutContent,L.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName"));case 22:return OneNoteIntl.OneNoteStrings.L_SyncErrorOutOfStorageCalloutContent;default:return e.hasUnsavedChanges?OneNoteIntl.OneNoteStrings.L_SyncErrorUnsavedChangesCalloutContent:OneNoteIntl.OneNoteStrings.L_SyncErrorInternalCalloutContent}},e.prototype.getLinkToAddInCalloutDescription=function(e){switch(e){case 22:return"https://support.office.com/article/ec43ed03-eb3c-4a10-8d9d-e9e5433c9ed2";default:return null}},e.prototype.getFailureActionCalloutButton=function(e){return 22===e||7===e?null:new oI(eb.rG(eb.JF),OneNoteIntl.OneNoteStrings.L_SyncTryAgain)},e}();(0,o.l)(lI,"PageSyncStatusPublisher",null,[$A]);var cI=function(){function e(){}return e.prototype.getCurrentSyncState=function(e){return e?e.get_node().currentSyncState:null},e.prototype.updateSyncStatusFromOffline=function(e){if(e&&e.get_node().currentSyncState&&4===e.get_node().currentSyncState.status){var t=e.get_node().inboundReplicationStatus;e.get_node().currentSyncState.hasUnsavedChanges&&(t=e.get_node().get_outboundReplicationStatus()?e.get_node().get_outboundReplicationStatus():-1);var n=this.convertOperationResultToSyncStatus(t);this.updateSyncState(e,n,t)}},e.prototype.updateCurrentUploadingFileCount=function(e,t){e&&e.get_node().currentSyncState?e.get_node().currentSyncState.uploadingFileCount=t:C.ULS.sendTraceTag(42342225,305,15,"Couldn't update File upload count as the current sync state is not initialized")},e.prototype.updateHasUnsavedChanges=function(e){e&&e.get_node().currentSyncState?e.get_node().currentSyncState.hasUnsavedChanges=e.hasChangesToOutbound():C.ULS.sendTraceTag(42796877,305,15,"Couldn't update HasUnsavedChanges as the current sync state is not initialized")},e.prototype.updateSyncState=function(e,t,n,r){if(void 0===n&&(n=-1),void 0===r&&(r=-1),e){if(e.get_node().currentSyncState?(e.get_node().currentSyncState.status=t,e.get_node().currentSyncState.resultCode=n):e.get_node().currentSyncState=new YA(t,n,null),-1!==r&&(e.get_node().currentSyncState.uploadingFileCount=r),2===t)e.get_node().currentSyncState.lastSuccessfulTime=new Date(Date.now());else if(3===t&&7===n){var i=ay.getSection(e.get_node());e.get_node().currentSyncState.hasReadAccess=!!i&&2===i.get_accessRights()}this.updateHasUnsavedChanges(e)}},e.prototype.convertOperationResultToSyncStatus=function(e){switch(e){case-1:return 1;case 0:return 2;default:return 3}},e}();(0,o.l)(cI,"SyncStatusWrapper",null,[jA]);var uI=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.SyncStatus"},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(KA).singleInstance().usingFactory((function(){return new XA(t._container.resolve(qA.q),L.AFrameworkApplication.get_activeFrame().workspace)})),this._container.register(jA).singleInstance().usingFactory((function(){return new cI})),this._container.register($A).singleInstance().usingFactory((function(){return new lI})),this._container.register(eI).singleInstance().usingFactory((function(){return new eI(QA.y.get_instance(),Fh.q.get_instance(),L.AFrameworkApplication.get_activeFrame().workspace)})),this._container.register(nI).singleInstance().usingFactory((function(){return new nI(L.AFrameworkApplication.get_activeFrame().workspace)}))},e.prototype.init=function(){var e=this;Wr.App.get_instance().get_isSyncUxFeatureEnabled()&&(wi.r.get_instance().executeWhen(7,(function(){e._container.resolve(eI)})),this._container.resolve(nI).registerActions(L.AFrameworkApplication.get_theActionManager()))},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(uI,"OneNoteSyncStatusPackage",null,[l.u,c.s]);var gI=(0,o.y)("IAudioFileUploader"),pI=n(7698),dI=n(2553),hI=n(6022),_I=n(3745),mI=n(7975),fI=n(5647),yI=n(8333),CI=function(e){function t(t,n,r,i){var o=e.call(this,null,n,r)||this;return o._desiredRevisionId=null,o._node=null,o._uploadParameters=null,o._insertFileEditor=null,o._undoManager=null,o.uploadState=0,o.useFilePicker=!1,o._insertFileEditor=t,o._undoManager=i,o}return(0,S.t)(t,e),t.prototype.get_uploadState=function(){return this.uploadState},t.prototype.get_filename=function(){return this.get_appSettingsManager().get_appSettings().OneNoteAudioRecordingFilename},t.prototype.get_placeholder=function(){return this._node},t.prototype.createPlaceholder=function(e){this.uploadState=1,this.set_context(e),C.ULS.sendTraceTag(9177241,339,50,"InsertAudio:Start"),this.uploadFrame=new fI.w(document.body,o.i(this,this.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(this,this.uploadResponseReceived,"uploadResponseReceived"),this.get_appSettingsManager(),!1,null)},t.prototype.finalizeUpload=function(e,t){this._desiredRevisionId=ae.l.create(),this._node=this._insertFileEditor.insertPlaceholders(this.get_context(),null,this._desiredRevisionId,this.get_filename()).fileNode,this._node?this.replicatePlaceholder(e):this.reset()},t.prototype.onPlaceholderNodeSaved=function(e){if(hI.i(this._node)){C.ULS.sendTraceTag(9213712,339,50,"InsertAudio:PlaceholderSaved"),this._uploadParameters={};var t=Da.GraphIterator.createFromNode(this._node);t.tryToRootAtPageContent(),t.returnToAncestorOfType(8);var n=t.get_currentINode().get_id().toString();this._uploadParameters[Rh.h.isImage]="0",this._uploadParameters[Rh.h.pageId]=n,hI.y(this.uploadFrame,this._node,this._desiredRevisionId,this._uploadParameters)?(C.ULS.sendTraceTag(9177244,339,50,"InsertAudio:UploadSetup"),this.uploadState=2):this.reset()}else this.reset()},t.prototype.upload=function(e){C.ULS.sendTraceTag(9213713,339,50,"InsertAudio:UploadStart"),this.uploadState=3;var t=this.get_appSettingsManager().getIntAppSetting("OneNoteInsertFileMaxSize",0),n=e.size,r=n/1024;if(C.ULS.sendTraceTag(9213714,339,50,"InsertAudio:Size:{0}",n),r>t)return _I.h.showRecordingFailedUploadError(),C.ULS.sendTraceTag(9177246,339,50,"InsertAudio:FileTooBig"),void this.reset();var i=new yI.w(this.get_filename(),e);this.uploadFrame.submitFormWithBlob(i),this._node?Fh.q.get_instance().uploadStarted(this._node.getParentGraphSpace()):C.ULS.sendTraceTag(42468441,339,15,"Upload Started with Node null")},t.prototype.validateFilename=function(e,t){return!0},t.prototype.uploadResponseReceived=function(e){var t=this,n=e;if(C.ULS.sendTraceTag(9177247,339,50,"InsertAudio:UploadResult:{0}",n.StatusCode),hI.i(this._node))if(n&&!n.StatusCode){if(!this._node.getGraphSpace()||!this._node.getGraphSpace().get_contentReplicator())return C.ULS.shipAssertTag(9177248,339,!1),void this.processFailure(null,14);this._node.getGraphSpace().get_contentReplicator().postProcessFDOUpload((function(e){t.reset()}),(function(e,n){t.reset()}),null),Fh.q.get_instance().uploadCompleted(this._node.getParentGraphSpace(),0)}else{var r=n?n.StatusCode:14;this.processFailure(null,r)}else this.reset()},t.prototype.replicatePlaceholder=function(e){this._node.getParentGraphSpace().get_contentReplicator().forceOutbound(o.i(this,this.onPlaceholderNodeSaved,"onPlaceholderNodeSaved"),o.i(this,this.processFailure,"processFailure"),e)},t.prototype.processFailure=function(e,t){this.retryReplication(e)?C.ULS.sendTraceTag(16798872,339,50,"InsertAudio:OutboundRetry:Retry={0}:Error={1}",this.get_retryCount(),t.toLocaleString()):(C.ULS.sendTraceTag(9213715,339,10,"InsertAudio:Failure:Retries={0}:Error={1}",this.get_retryCount(),t.toLocaleString()),this._node&&this._node.getGraphSpace()&&(mI.r.setUploading(this._node,!1),this._undoManager.clearUndoHistory(this._node.getGraphSpace(),!1),Fh.q.get_instance().uploadCompleted(this._node.getParentGraphSpace(),t)),this.reset())},t.prototype.reset=function(){this._node&&mI.r.setUploading(this._node,!1),this._desiredRevisionId=null,this._node=null,this._uploadParameters=null,this.resetRetries(),this.uploadState=0,C.ULS.sendTraceTag(9213716,339,50,"InsertAudio:UploadReset")},t}(dI.p);(0,o.l)(CI,"AudioFileUploader",dI.p,[gI]);var SI=n(2454),vI=n(9519),bI=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,S.t)(t,e),t.prototype.createPlaceholders=function(e,t){if(!this.canInsertFileInContext(e))return null;var n=new vI.b,r=e,i=new as.GraphTransaction(7);i.setFromNode(r.get_node());var o=this.createIteratorAtNodeOfInsertion(e);return n.imageContainingOutlineNode=o.get_parentNode(),n.fileNode=this.insertFileBlock(o,t),this.createSiblingOutlineElement(o),n.imageContainingOutlineElementNode=o.get_currentNode(),n.imageNode=this.insertImageBlock(o),i.dispose(),n},t.prototype.nodeToPlaceSelectionAfter=function(e){return e.imageNode},t}(mI.r);(0,o.l)(bI,"InsertPrintoutEditor",mI.r,[]);var TI=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.EmbeddedFiles"},e.prototype.configure=function(e){e.register(SI.c).singleInstance().usingFactory((function(){return new SI.c})),e.register(mI.r).singleInstance().usingFactory((function(){return new mI.r(e.resolve(rc.a),e.resolve(Es.p))})),e.register(bI).singleInstance().usingFactory((function(){return new bI(e.resolve(rc.a),e.resolve(Es.p))})),e.register(gI).singleInstance().usingFactory((function(){return new CI(e.resolve(mI.r),Oe.y.get_instance(),L.AFrameworkApplication.appSettingsManager,e.resolve(ja.n))})),e.register(_I.h).singleInstance().usingFactory((function(){return new _I.h(e.resolve(gI))})),Br.App.theNotebookManager.get_theGraph().getSpecificEventHandlers(32).add_onDisconnected(pI.s.fileDisconnected)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInsertFileIsEnabled")&&N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(TI,"OneNoteEmbeddedFilesPackage",null,[l.u,c.s]);var AI=n(411),II=function(e){return""},wI=function(e){return 96*Jg.AF(e)},xI=function(e){return e.containsKey("font-size")?i_.getSizeInPoints(e.get_item("font-size")):Hu.Font.defaultSize/2},FI=function(e){return Jg.BV(e)},EI=function(e){return!e||""===e},PI=function(e,t){if(!t)return"";e||(e="");for(var n=new Sys.StringBuilder,r=0;r<t.length;r++)n.append(t[r].toString()),r<t.length-1&&n.append(e);return n.toString()},kI=function(e){return Jn.l.htmlAttributeEncode(e)},DI=function(e){return Jn.l.htmlEncode(e)},MI=(0,o.y)("IHtmlViewElement$0"),RI=(0,o.y)("IViewElement$0"),LI=function(){return function(){this.x=0,this.y=0,this.width=0,this.height=0}}();(0,o.l)(LI,"Bounds",null,[]);var NI=function(){return function(){this.x=0,this.y=0}}();(0,o.l)(NI,"ViewPoint$0",null,[]);var BI=function(){return function(){}}();(0,o.l)(BI,"ViewSizeConstraints$0",null,[]);var OI=function(){function e(e,t){this._htmlView=null,this._graphNode=null,this.$$pf_HtmlElement=null,e&&t&&(this._htmlView=e,this._graphNode=t)}return e.prototype.addCommonAttributes=function(){if(this._graphNode.hasProperty(Kc.b.offsetFromParentHoriz)){this.get_htmlElement().get_styles().set_item("position","absolute");var e=this._graphNode.getValue(Number,Kc.b.offsetFromParentHoriz);e>=0&&(e=0),this.get_htmlElement().get_styles().set_item("left",wI(e)+"px")}if(this._graphNode.hasProperty(Kc.b.offsetFromParentVert)){this.get_htmlElement().get_styles().set_item("position","absolute");var t=this._graphNode.getValue(Number,Kc.b.offsetFromParentVert);t>=0&&(t=0),this.get_htmlElement().get_styles().set_item("top",wI(t)+"px")}},e.prototype.addToHtmlDocument=function(e){e.addChild(this.get_htmlElement())},e.prototype.get_includeIds=function(){return this._htmlView.get_includeIds()},e.prototype.addId=function(t,n){if(t&&n){for(var r=0,i=e.noIdTags;r<i.length;r++){if(i[r]===t.tagName)return}if(this.get_includeIds()){if(!n.get_id()||!t.tagName)return C.ULS.shipAssertTag(20248345,339,!!n.get_id(),"Node have a null id."),void C.ULS.shipAssertTag(20248346,339,!EI(t.tagName),"Tag is not set in the element.");t.get_attributes().set_item(e.htmlGeneratedId,String.format("{0}:{1}",t.tagName,n.get_id()))}}},e.prototype.getContainingList=function(e,t,n){if(!e||!e.get_currentNode())return null;if(!this._htmlView.get_listContainers().containsKey(e.get_currentNode().get_id().toString())){var r=this._htmlView.createElement(t.get_isOrdered()?"ol":"ul");this.addId(r,e.get_currentINode()),this._htmlView.get_listContainers().add(e.get_currentNode().get_id().toString(),r);var i=new Da.GraphIterator;i.setFrom(e);var o=i.returnToParent(),a=void 0;o&&this._htmlView.get_listContainers().containsKey(o.get_id().toString())?(a=this._htmlView.get_listContainers().get_item(o.get_id().toString())).get_children().get_count()&&"li"===a.get_children().get_item(a.get_children().get_count()-1).tagName&&(a=a.get_children().get_item(a.get_children().get_count()-1)):a=n,a.addChild(r)}return this._htmlView.get_listContainers().get_item(e.get_currentNode().get_id().toString())},e.prototype.get_isHtmlViewElement=function(){return!0},e.prototype.get_sourceNode=function(){return this._graphNode},e.prototype.get_viewInstance=function(){return this._htmlView},e.prototype.get_viewId=function(){return this.get_viewInstance().get_viewId()},e.prototype.onConnect=function(){},e.prototype.onDisconnect=function(){},e.prototype.get_htmlElement=function(){return this.$$pf_HtmlElement},e.prototype.set_htmlElement=function(e){return this.$$pf_HtmlElement=e,e},e.prototype.get_htmlViewInstance=function(){return this._htmlView},e.prototype.get_isStructural=function(){return!1},e.prototype.get_bounds=function(){return new LI},e.prototype.locate=function(){return new NI},e.prototype.get_sizeConstraints=function(){return new BI},e.prototype.get_usesSizeCalculations=function(){return!1},e.prototype.get_isMeasuredElement=function(){return!1},e.enUsCultureLcid=1033,e.htmlGeneratedId="id",e.noIdTags=["span","sub","sup","a","br"],e}();(0,o.l)(OI,"ViewElementBase",null,[MI,RI]);var UI,HI=function(){function e(){}return e.defaultLanguageFontAndLocalesInitialize=function(){var e=new Ma.e(String,String);return e.set_item("Unicode","Arial Unicode MS"),e.set_item("ar-DZ","Arial"),e.set_item("ar-BH","Arial"),e.set_item("ar-EG","Arial"),e.set_item("ar-IQ","Arial"),e.set_item("ar-JO","Arial"),e.set_item("ar-KW","Arial"),e.set_item("ar-LB","Arial"),e.set_item("ar-LY","Arial"),e.set_item("ar-MA","Arial"),e.set_item("ar-OM","Arial"),e.set_item("ar-QA","Arial"),e.set_item("ar-SA","Arial"),e.set_item("ar-SY","Arial"),e.set_item("ar-TN","Arial"),e.set_item("ar-AE","Arial"),e.set_item("ar-YE","Arial"),e.set_item("he-IL","Arial"),e.set_item("vi-VN","Verdana"),e.set_item("th-TH","Thai"),e.set_item("ja-JP","Yu Gothic"),e.set_item("zh-CN","Microsoft YaHei"),e.set_item("zh-SG","Microsoft YaHei"),e.set_item("ko-KR","Malgun Gothic"),e.set_item("zh-HK","PMingLiU"),e.set_item("zh-MO","PMingLiU"),e.set_item("zh-TW","PMingLiU"),e.set_item("hy-AM","Sylfaen"),e.set_item("ka-GE","Sylfaen"),e.set_item("syr-SY","Estrangelo Edessa"),e.set_item("dv-MV","MV Boli"),e.set_item("hi-IN","Mangal"),e.set_item("mr-IN","Mangal"),e.set_item("bn-BD","Vrinda"),e.set_item("bn-IN","Vrinda"),e.set_item("pa-IN","Raavi"),e.set_item("gu-IN","Shruthi"),e.set_item("or-IN","Kalinga"),e.set_item("ta-IN","Latha"),e.set_item("te-IN","Gautami"),e.set_item("kn-IN","Tunga"),e.set_item("ml-IN","Kartika"),e.set_item("lo-LA","DokChampa"),e.set_item("en-US",Hu.Font.defaultFontName),e},e.get_defaultLanguageFontAndLocales=function(){return e.defaultLanguageFontAndLocalesLazy.get_value()},e.modifyElementForAdditionalHtmlOptimizations=function(t){"body"===t.tagName?e.bodyHtmlOptimizations(t):"p"!==t.tagName||!t.get_parent()||"li"!==t.get_parent().tagName&&"td"!==t.get_parent().tagName||1!==t.get_parent().get_children().get_count()?"li"!==t.tagName&&"td"!==t.tagName||1!==t.get_children().get_count()||"p"!==t.get_children().get_item(0).tagName||e.tdAndLiHtmlOptimizations(t):(t.tagName="span",t.get_attributes().remove(OI.htmlGeneratedId))},e.bodyHtmlOptimizations=function(t){var n=e.get_defaultLanguageFontAndLocales().get_item("en-US");t.get_styles().set_item("font-family",n),t.get_styles().set_item("font-size",Hu.Font.defaultSize/2+"pt");var r=t.get_parent();if(r&&"html"===r.tagName){var i=r.get_attributes().get_item("lang");if(i&&e.get_defaultLanguageFontAndLocales().containsKey(i)){var o=e.get_defaultLanguageFontAndLocales().get_item(i);t.get_styles().set_item("font-family",o),C.ULS.sendTraceTag(20248388,339,50,"Set default body font {0} for locale: {1}",o,i)}else C.ULS.sendTraceTag(20248390,339,50,"Setting fallback body font {0} for locale: {1}",n,i)}},e.tdAndLiHtmlOptimizations=function(e){var t=e.get_children().get_item(0),n=xI(t.get_styles());t.get_styles().containsKey("margin-top")?"0pt"===t.get_styles().get_item("margin-top")&&t.get_styles().remove("margin-top"):t.get_styles().set_item("margin-top",String.format("{0}pt",n)),t.get_styles().containsKey("margin-bottom")?"0pt"===t.get_styles().get_item("margin-bottom")&&t.get_styles().remove("margin-bottom"):t.get_styles().set_item("margin-bottom",String.format("{0}pt",n));for(var r=0,i=t.get_styles().get_keys().toArray();r<i.length;r++){var o=i[r],a=t.get_styles().get_item(o);e.get_styles().set_item(o,a)}},e.getEffectiveAttributes=function(t,n){for(var r=new Ma.e(String,String),i=function(i){var o,a=n.get_item(i);e.isAttributeInheritable(i)&&!t.tryGetValue(i,(0,p.m)((function(){return o}),(function(e){return o=e})))&&r.add(i,a)},o=0,a=n.get_keys().toArray();o<a.length;o++){i(a[o])}for(var s=0,l=t.get_keys().toArray();s<l.length;s++){var c=l[s],u=t.get_item(c);r.add(c,u)}return r},e.getPrintableAttributes=function(t,n){for(var r=new Ma.e(String,String),i=function(i){var o,a=t.get_item(i);e.isAttributeInheritable(i)&&n.tryGetValue(i,(0,p.m)((function(){return o}),(function(e){return o=e})))&&o===a||r.add(i,a)},o=0,a=t.get_keys().toArray();o<a.length;o++){i(a[o])}return r},e.isAttributeInheritable=function(e){return"lang"===e},e.getEffectiveStyles=function(t,n){for(var r=new Ma.e(String,String),i=function(i){var o,a=n.get_item(i);e.isStyleInheritable(i)&&!t.tryGetValue(i,(0,p.m)((function(){return o}),(function(e){return o=e})))&&r.add(i,a)},o=0,a=n.get_keys().toArray();o<a.length;o++){i(a[o])}for(var s=0,l=t.get_keys().toArray();s<l.length;s++){var c=l[s],u=t.get_item(c);r.add(c,u)}return r},e.getPrintableStyles=function(t,n){for(var r=new Ma.e(String,String),i=function(i){var o,a=t.get_item(i);e.isAttributeInheritable(i)&&n.tryGetValue(i,(0,p.m)((function(){return o}),(function(e){return o=e})))&&o===a||r.add(i,a)},o=0,a=t.get_keys().toArray();o<a.length;o++){i(a[o])}return r},e.removeRedundantTextAlign=function(e,t){},e.isStyleInheritable=function(e){switch(e){case"list-style-type":case"border":return!1;default:return!0}},e.setDivId=function(t){var n=null,r=null;e.findFirstAndLastIds(t,(0,p.m)((function(){return n}),(function(e){return n=e})),(0,p.m)((function(){return r}),(function(e){return r=e}))),n&&r&&t.get_attributes().set_item(OI.htmlGeneratedId,String.format("{0}:{1}:{2}",t.tagName,n,r))},e.findFirstAndLastIds=function(t,n,r){for(var i=t.get_children().$$lge();i.$$mn();){var o=i.$$cu();"div"!==Jn.l.toLower(o.tagName)&&o.get_attributes().containsKey(OI.htmlGeneratedId)&&(n.val?r.val=e.getNodeIdFromId(o.get_attributes().get_item(OI.htmlGeneratedId)):n.val=r.val=e.getNodeIdFromId(o.get_attributes().get_item(OI.htmlGeneratedId))),e.findFirstAndLastIds(o,n,r)}},e.getNodeIdFromId=function(e){if(EI(e))return null;var t=e.indexOf(":");return t>=0&&e.length>t+1?e.substr(t+1):null},e.defaultLanguageFontAndLocalesLazy=new yt.q(Ma.e.$$(String,String),e.defaultLanguageFontAndLocalesInitialize),e}();(0,o.l)(HI,"HtmlOptimizer",null,[]),function(e){e[e.indentAtStartAndNewLineAtEnd=0]="indentAtStartAndNewLineAtEnd",e[e.indentAndNewlineAtStartAndEnd=1]="indentAndNewlineAtStartAndEnd",e[e.noIndentNoNewlineAtStartAndEnd=2]="noIndentNoNewlineAtStartAndEnd"}(UI||(UI={})),(0,o.h)("HtmlTagIndentType",UI);var GI=function(){function e(){}return e.htmlTagIndentTypesInitialize=function(){var e=new Y.d(String,UI,ee.b.get_ordinalIgnoreCase());return e.set_item("html",1),e.set_item("head",1),e.set_item("body",1),e.set_item("div",1),e.set_item("table",1),e.set_item("tr",1),e.set_item("ul",1),e.set_item("ol",1),e.set_item("a",2),e.set_item("sup",2),e.set_item("sub",2),e.set_item("span",2),e.set_item("td",0),e.set_item("li",0),e.set_item("p",0),e.set_item("img",0),e.set_item("iframe",0),e.set_item("title",0),e.set_item("meta",0),e.set_item("script",0),e.set_item("object",0),e.set_item("cite",0),e.set_item("h1",0),e.set_item("h2",0),e.set_item("h3",0),e.set_item("h4",0),e.set_item("h5",0),e.set_item("h6",0),e.set_item("br",0),e.set_item("math",1),e.set_item("maction",1),e.set_item("maligngroup",1),e.set_item("malignmark",1),e.set_item("menclose",1),e.set_item("merror",1),e.set_item("mfenced",1),e.set_item("mfrac",1),e.set_item("mglyph",1),e.set_item("mi",0),e.set_item("mlabeledtr",1),e.set_item("mlongdiv",1),e.set_item("mmultiscripts",1),e.set_item("mn",0),e.set_item("mo",0),e.set_item("mover",1),e.set_item("mpadded",1),e.set_item("mphantom",1),e.set_item("mroot",1),e.set_item("mrow",1),e.set_item("ms",0),e.set_item("mscarries",1),e.set_item("mscarry",1),e.set_item("msgroup",1),e.set_item("msline",1),e.set_item("mspace",0),e.set_item("msqrt",1),e.set_item("msrow",1),e.set_item("mstack",1),e.set_item("mstyle",1),e.set_item("msub",1),e.set_item("msup",1),e.set_item("msubsup",1),e.set_item("mtable",1),e.set_item("mtd",1),e.set_item("mtext",0),e.set_item("mtr",1),e.set_item("munder",1),e.set_item("munderover",1),e},e.get_htmlTagIndentTypes=function(){return e.htmlTagIndentTypesLazy.get_value()},e.getStartTagIndent=function(t,n,r){if(!t)return null;e.validateTagIndentType(t);var i=new Sys.StringBuilder("");if(!(!!t.get_parent()&&1===e.get_htmlTagIndentTypes().get_item(t.get_parent().tagName)||e._prevElementTerminatedInNewLine||2!==e.get_htmlTagIndentTypes().get_item(t.tagName)&&e.get_htmlTagIndentTypes().get_item(t.tagName)))return"";if(!e._prevElementTerminatedInNewLine&&2===e.get_htmlTagIndentTypes().get_item(t.tagName))return"";t.indent=n;for(var o=0;o<n;o++)i.append("\t");return!r||!e._prevElementTerminatedInNewLine||1!==e.get_htmlTagIndentTypes().get_item(t.tagName)&&e.get_htmlTagIndentTypes().get_item(t.tagName)||(t.indent=t.indent+1,i.append("\t")),i.toString()},e.getEndTagIndent=function(t){if(!t)return null;if(e.validateTagIndentType(t),!EI(t.value))return"";var n=new Sys.StringBuilder("");if(e._prevElementTerminatedInNewLine||1===e.get_htmlTagIndentTypes().get_item(t.tagName)){for(var r=0;r<t.indent;r++)n.append("\t");return n.toString()}return""},e.getStartTagNewLine=function(t,n,r){if(!n)return null;if(e.validateTagIndentType(n),r&&1===e.get_htmlTagIndentTypes().get_item(n.tagName))return e._prevElementTerminatedInNewLine=!0,"\n";if(r)return"";var i=t?2===e.get_htmlTagIndentTypes().get_item(n.tagName)?"":"\n":1===e.get_htmlTagIndentTypes().get_item(n.tagName)?"\n":"";return e._prevElementTerminatedInNewLine=!EI(i),i},e.getEndTagNewLine=function(t){if(!t)return null;e.validateTagIndentType(t);var n="";return 1===e.get_htmlTagIndentTypes().get_item(t.tagName)?n="\n":2===e.get_htmlTagIndentTypes().get_item(t.tagName)?n="":e.get_htmlTagIndentTypes().get_item(t.tagName)||(n="\n"),e._prevElementTerminatedInNewLine=!EI(n),n},e.areChildrenInline=function(t,n){return!!t&&(e.validateTagIndentType(t),!!n||2===e.get_htmlTagIndentTypes().get_item(t.tagName))},e.getChildIndent=function(t,n,r){return t?(e.validateTagIndentType(t),n?r:1===e.get_htmlTagIndentTypes().get_item(t.tagName)?++r:r):0},e.validateTagIndentType=function(t){if(t)if(e.get_htmlTagIndentTypes().containsKey(t.tagName));else String.format("Tag Indent Type not defined for tag {0}.",t.tagName)},e._prevElementTerminatedInNewLine=!1,e.htmlTagIndentTypesLazy=new yt.q(Y.d.$$(String,UI),e.htmlTagIndentTypesInitialize),e}();(0,o.l)(GI,"HtmlOutputFormatter",null,[]);var VI=function(e,t){if(void 0===t&&(t=!1),!e)return null;var n=new Sys.StringBuilder;return WI(e.documentElement,n,t),n.toString()},WI=function(e,t,n){void 0===n&&(n=!1),zI(e,t,n,new Ma.e(String,String),new Ma.e(String,String),0)},zI=function(e,t,n,r,i,o,a){void 0===a&&(a=!1),HI.modifyElementForAdditionalHtmlOptimizations(e),n&&"div"===Jn.l.toLower(e.tagName)&&!e.get_attributes().containsKey(OI.htmlGeneratedId)&&HI.setDivId(e);for(var s,l,c=HI.getEffectiveAttributes(e.get_attributes(),r),u=HI.getPrintableAttributes(e.get_attributes(),r),g=new y.c(String),p=0,d=u.get_keys().toArray();p<d.length;p++){var h=d[p],_=u.get_item(h),m=(l=_,"src"===(s=h)||"data-fullres-src"===s||"data"===s?String.format('{0}="{1}"',s,l):String.format('{0}="{1}"',s,kI(l)));g.add(m)}HI.removeRedundantTextAlign(e,c);for(var f=HI.getEffectiveStyles(e.get_styles(),i),C=HI.getPrintableStyles(e.get_styles(),i),S=new y.c(String),v=0,b=C.get_keys().toArray();v<b.length;v++){var T=b[v],A=C.get_item(T);S.add(T+":"+A)}var I=e.get_hasSemanticValue()||g.get_count()>0||S.get_count()>0,w=e.canSelfEnd&&(!e.value||""===e.value)&&!e.get_children().get_count(),x=String.format("<{0}{1}{2}{3}>",e.tagName,g.get_count()>0?" "+PI(" ",g.toArray()):"",S.get_count()>0?" "+String.format('style="{0}"',kI(PI(";",S.toArray()))):"",w?" /":""),F=String.format("</{0}>",e.tagName);I&&t.append(GI.getStartTagIndent(e,o,a)+x+GI.getStartTagNewLine(w,e,a)),t.append(DI(e.value));for(var E=e.get_children().$$lge();E.$$mn();){var P=E.$$cu(),k=o;I&&(k=GI.getChildIndent(e,a,o)),P.get_isComment()?KI(P,t,k):zI(P,t,n,c,f,k,GI.areChildrenInline(P,a))}!I||w||e.get_isComment()||t.append(GI.getEndTagIndent(e)+F+GI.getEndTagNewLine(e))},KI=function(e,t,n){if(e.get_isComment()){for(var r=0;r<n;r++)t.append("\t");var i=String.format("\x3c!-- {0} --\x3e\n",DI(e.comment));t.append(i)}},qI=(0,o.y)("ISplitImage"),jI=(0,o.y)("IPrintoutFile"),$I=(0,o.y)("IHtmlView$0"),QI=(0,o.y)("IView$0"),JI=function(e){var t=Kt.i.getCultureInfo(e);return t?t.get_name():null},XI=(0,o.y)("IViewElementCreator"),YI=function(e){function t(t,n){var r=e.call(this,t,n.get_currentINode())||this;return r.set_htmlElement(r._htmlView.createElement("object")),393269!==r._graphNode.get_runtimeClassId()?(C.ULS.sendTraceTag(20248353,339,10,"Expects EmbeddedFileNode. Actual input node type was {0}",Object.getType(r._graphNode).toString()),r):(r.addCommonAttributes(),r)}return(0,S.t)(t,e),t}(OI);(0,o.l)(YI,"EmbeddedFileViewElement$1",OI,[]);var ZI=function(e){function t(t,n,r){var i=e.call(this,t,n)||this;return i.set_htmlElement(i._htmlView.createCommentElement(r)),C.ULS.sendTraceTag(20248386,339,15,"PCR Skipped NodeType={0}",n.get_type()),i}return(0,S.t)(t,e),t}(OI);(0,o.l)(ZI,"ErrorViewElement",OI,[]);var ew=function(e){function t(t,n){var r=e.call(this,t,n.get_currentINode())||this;if(r.set_htmlElement(r._htmlView.createElement("iframe")),393304!==r._graphNode.get_runtimeClassId())return C.ULS.sendTraceTag(20248394,339,10,"Expects IFrameNode. Actual input node type was {0}",Object.getType(r._graphNode).toString()),r;r.addCommonAttributes();var i=n.get_parentNode();if(i&&r.addNonSrcAttributes(i),!r._graphNode.hasProperty(qc.o.iFrameOriginUrl))return C.ULS.sendTraceTag(20248396,339,10,"The IFrame node doesn't have valid origin url"),r;var o=r._graphNode.getValue(String,qc.o.iFrameOriginUrl);return r.get_htmlElement().get_attributes().add("data-original-src",o),r._htmlView.get_toAddToHtmlElementDict().set_item(r.get_htmlElement().get_elementId(),o),r}return(0,S.t)(t,e),t.prototype.addNonSrcAttributes=function(e){var t=Hh.N(0);if(e.hasProperty(Kc.b.layoutMaxWidth)){var n=e.getValue(Number,Kc.b.layoutMaxWidth);try{var r=Jg.AF(Math.round(n*t));r>0?this.get_htmlElement().get_attributes().add("width",r.toString()):C.ULS.sendTraceTag(20248398,339,15,"Iframe image width in inches '{0}' was less than equal to 0. Ignoring.",r)}catch(e){C.ULS.sendTraceTag(20248400,339,15,"Conversion of iframe image width '{0}' * PixelsPerInch '{1}' to an int resulted in an overflow exception. Ignoring.",n,t)}}if(e.hasProperty(Kc.b.layoutMaxHeight)){var i=e.getValue(Number,Kc.b.layoutMaxHeight);try{var o=Jg.AF(Math.round(i*t));o>0?this.get_htmlElement().get_attributes().add("height",o.toString()):C.ULS.sendTraceTag(20248402,339,15,"Iframe height in inches '{0}' was less than equal to 0. Ignoring.",o)}catch(e){C.ULS.sendTraceTag(20248404,339,15,"Conversion of Iframe height '{0}' * PixelsPerInch '{1}' to an int resulted in an overflow exception. Ignoring.",i,t)}}},t.get_imageEditor=function(){return t._imageEditor||(t._imageEditor=se.w.get_instance().resolve(Fb.w))},t._imageEditor=null,t}(OI);(0,o.l)(ew,"IframeViewElement",OI,[]);var tw=function(){function e(){}return e.noteTagSymbolGenericNameToRoundtrippableNameInitialize=function(){var e=new Ma.e(String,String);return e.set_item("blue-check-box","to-do"),e.set_item("yellow-star-check-box","important"),e.set_item("question","question"),e.set_item("none","remember-for-later"),e.set_item("marker","highlight"),e.set_item("contact-outlook","contact"),e.set_item("home","address"),e.set_item("telephone","phone-number"),e.set_item("link-globe","web-site-to-visit"),e.set_item("light-bulb","idea"),e.set_item("padlock","password"),e.set_item("high-priority","critical"),e.set_item("red-square-(project-a)","project-a"),e.set_item("yellow-square-(project-b)","project-b"),e.set_item("movie-clip","movie-to-see"),e.set_item("book-(open)","book-to-read"),e.set_item("music-note","music-to-listen-to"),e.set_item("comment","remember-for-blog"),e.set_item("to-do-blue-person","discuss-with-person-a"),e.set_item("to-do-yellow-person","discuss-with-manager"),e.set_item("email","send-in-email"),e.set_item("blue-arrow-check-box","schedule-meeting"),e.set_item("blue-check-box-1","to-do-priority-1"),e.set_item("yellow-check-box-2","to-do-priority-2"),e.set_item("yellow-exclamation-check-box","client-request"),e},e.get_noteTagSymbolGenericNameToRoundtrippableName=function(){return e.noteTagSymbolGenericNameToRoundtrippableNameLazy.get_value()},e.noteTagsDictionaryInitialize=function(){var e=new Ma.e(String,String);return e.set_item("0","none"),e.set_item("1","green-check-box"),e.set_item("2","yellow-check-box"),e.set_item("3","blue-check-box"),e.set_item("4","green-star-check-box"),e.set_item("5","yellow-star-check-box"),e.set_item("6","blue-star-check-box"),e.set_item("7","green-exclamation-check-box"),e.set_item("8","yellow-exclamation-check-box"),e.set_item("9","blue-exclamation-check-box"),e.set_item("10","green-arrow-check-box"),e.set_item("11","yellow-arrow-check-box"),e.set_item("12","blue-arrow-check-box"),e.set_item("13","yellow-star-check-box"),e.set_item("14","follow-up-flag"),e.set_item("15","question"),e.set_item("16","blue-right-arrow"),e.set_item("17","high-priority"),e.set_item("18","telephone"),e.set_item("19","calendar"),e.set_item("20","clock"),e.set_item("21","light-bulb"),e.set_item("22","pushpin"),e.set_item("23","home"),e.set_item("24","comment"),e.set_item("25","smiley"),e.set_item("26","award-ribbon"),e.set_item("27","key"),e.set_item("28","blue-check-box-1"),e.set_item("29","blue-circle-1"),e.set_item("30","blue-check-box-2"),e.set_item("31","blue-circle-2"),e.set_item("32","blue-check-box-3"),e.set_item("33","blue-circle-3"),e.set_item("34","blue-8-point-star"),e.set_item("35","blue-check-mark"),e.set_item("36","blue-circle"),e.set_item("37","blue-down-arrow"),e.set_item("38","blue-left-arrow"),e.set_item("39","blue-solid-target"),e.set_item("40","blue-star-check-box"),e.set_item("41","blue-sun"),e.set_item("42","blue-target"),e.set_item("43","blue-triangle"),e.set_item("44","blue-umbrella"),e.set_item("45","blue-up-arrow"),e.set_item("46","blue-x-with-dots"),e.set_item("47","blue-x"),e.set_item("48","green-check-box-1"),e.set_item("49","green-circle-1"),e.set_item("50","green-check-box-2"),e.set_item("51","green-circle-2"),e.set_item("52","green-check-box-3"),e.set_item("53","green-circle-3"),e.set_item("54","green-8-point-star"),e.set_item("55","green-check-mark"),e.set_item("56","green-circle"),e.set_item("57","green-down-arrow"),e.set_item("58","green-left-arrow"),e.set_item("59","green-right-arrow"),e.set_item("60","green-solid-target"),e.set_item("61","green-star-check-box"),e.set_item("62","green-sun"),e.set_item("63","green-target"),e.set_item("64","green-triangle"),e.set_item("65","green-umbrella"),e.set_item("66","green-up-arrow"),e.set_item("67","green-x-with-dots"),e.set_item("68","green-x"),e.set_item("69","yellow-check-box-1"),e.set_item("70","yellow-circle-1"),e.set_item("71","yellow-check-box-2"),e.set_item("72","yellow-circle-2"),e.set_item("73","yellow-check-box-3"),e.set_item("74","yellow-circle-3"),e.set_item("75","yellow-8-point-star"),e.set_item("76","yellow-check-mark"),e.set_item("77","yellow-circle"),e.set_item("78","yellow-down-arrow"),e.set_item("79","yellow-left-arrow"),e.set_item("80","yellow-right-arrow"),e.set_item("81","yellow-solid-target"),e.set_item("82","yellow-sun"),e.set_item("83","yellow-target"),e.set_item("84","yellow-triangle"),e.set_item("85","yellow-umbrella"),e.set_item("86","yellow-up-arrow"),e.set_item("87","yellow-x-with-dots"),e.set_item("88","yellow-x"),e.set_item("94","to-do-blue-person"),e.set_item("95","to-do-yellow-person"),e.set_item("96","to-do-green-person"),e.set_item("97","to-do-blue-flag"),e.set_item("98","to-do-yellow-flag"),e.set_item("99","to-do-green-flag"),e.set_item("100","red-square-(project-a)"),e.set_item("101","yellow-square-(project-b)"),e.set_item("102","blue-square-(project-c)"),e.set_item("103","green-square"),e.set_item("104","orange-square"),e.set_item("105","pink-square"),e.set_item("106","email"),e.set_item("107","envelope-closed"),e.set_item("108","envelope-opened"),e.set_item("109","mobile-phone"),e.set_item("110","telephone-with-clock"),e.set_item("111","question-balloon"),e.set_item("112","paperclip"),e.set_item("113","frowning"),e.set_item("114","im-contact"),e.set_item("115","person"),e.set_item("116","two-people"),e.set_item("117","reminder-bell"),e.set_item("118","contact-outlook"),e.set_item("119","flowers-bouquet"),e.set_item("120","date"),e.set_item("121","music-note"),e.set_item("122","movie-clip"),e.set_item("123","quote-mark"),e.set_item("124","globe"),e.set_item("125","link-globe"),e.set_item("126","laptop"),e.set_item("127","plane"),e.set_item("128","car"),e.set_item("129","binoculars"),e.set_item("130","presentation"),e.set_item("131","padlock"),e.set_item("132","book-(open)"),e.set_item("133","notebook-icon"),e.set_item("134","paper-(blank-with-lines)"),e.set_item("135","research-icon"),e.set_item("136","marker"),e.set_item("137","dollar-sign"),e.set_item("138","coins-with-window-behind-it"),e.set_item("139","schedule-task"),e.set_item("140","lighting-bolt"),e.set_item("141","cloud"),e.set_item("142","heart"),e.set_item("143","flower"),e},e.get_noteTagsDictionary=function(){return e.noteTagsDictionaryLazy.get_value()},e.addNoteTagAttribute=function(t,n){if(t)if(n&&n.get_containingGraph()&&n.get_anchor()){var r=Da.GraphIterator.createFromNode(n);if(Hr.u(r)&&UA.q(r),PT.b.hasNoteTags(r))if(ET.u(r)){for(var i=new y.c(String),o=ET.s(r),a=function(){var t=e.retrieveNoteTagInfo(o);if(!EI(t)){var n,a=-1!==t.indexOf(":")?t.substr(0,t.indexOf(":")):t;if(e.get_noteTagSymbolGenericNameToRoundtrippableName().tryGetValue(a,(0,p.m)((function(){return n}),(function(e){return n=e})))){var s=-1!==t.indexOf(":")?t.substr(t.indexOf(":")+1,t.length-(t.indexOf(":")+1)):"";EI(s)||(n+=":"+s),i.add(n)}}o=ET.j(r)};o;)a();var s=PI(",",i.toArray());EI(s)||t.get_attributes().set_item("data-tag",s)}}else C.ULS.sendTraceTag(20248453,339,15,"node is null or not in a good state");else C.ULS.sendTraceTag(20248451,339,15,"htmlElement is null")},e.retrieveNoteTagInfo=function(t){var n=DT.c(t),r=null;if(e.get_noteTagsDictionary().tryGetValue(n.toString(),(0,p.m)((function(){return r}),(function(e){return r=e})))){if(!EI(r)){var i;if(i=t.getValueWithDefault(Number,qc.o.noteTag_Status,0)){for(var o=PT.b.get_preDefinedNoteTagStatus().getEnumerator();o.$$mn();){var a=o.$$cu();a.get_value()===i&&(r=a.get_key())}DT.q(t)&&!EI(null)?r+=":null":C.ULS.sendTraceTag(20248455,339,50,"{0} is not predefined NoteTag status",i)}}}else C.ULS.sendTraceTag(20248457,339,50,"{0} is not a predefined NoteTag Shape and therefore is not supported",n);return r},e.noteTagSymbolGenericNameToRoundtrippableNameLazy=new yt.q(Ma.e.$$(String,String),e.noteTagSymbolGenericNameToRoundtrippableNameInitialize),e.noteTagsDictionaryLazy=new yt.q(Ma.e.$$(String,String),e.noteTagsDictionaryInitialize),e}();(0,o.l)(tw,"NoteTagUtils",null,[]);var nw=function(e){function t(t,n,r){var i,o,a,s,l=e.call(this,t,n.get_currentINode())||this;return l._splitImageHelper=null,l.set_htmlElement(l._htmlView.createElement("img")),l._splitImageHelper=r,l.addCommonAttributes(),393233!==l._graphNode.get_runtimeClassId()?(C.ULS.sendTraceTag(20248406,339,10,"Expects ImageNode. Actual input node type was {0}",Object.getType(l._graphNode).toString()),l):(l.addId(l.get_htmlElement(),l._graphNode),l.addNonSrcAttributes(),l.getSrcAttributes(qc.o.webPictureContainer14,(0,p.m)((function(){return i}),(function(e){return i=e})),(0,p.m)((function(){return o}),(function(e){return o=e}))),l.getSrcAttributes(Kc.b.pictureContainer,(0,p.m)((function(){return a}),(function(e){return a=e})),(0,p.m)((function(){return s}),(function(e){return s=e}))),l.addSrcAttributes(i,o,a,s),l.addSplitImageAttributes(),tw.addNoteTagAttribute(l.get_htmlElement(),l._graphNode),l)}return(0,S.t)(t,e),t.prototype.addToHtmlDocument=function(t){if(this._graphNode.hasProperty(Kc.b.hyperlinkUrl)){var n=this._htmlView.createElement("a");n.get_attributes().set_item("href",this._graphNode.getValue(String,Kc.b.hyperlinkUrl)),t.addChild(n),t=n}e.prototype.addToHtmlDocument.call(this,t)},t.prototype.addNonSrcAttributes=function(){if(this._graphNode.hasProperty(Kc.b.imageAltText)){var e=this._graphNode.getValue(String,Kc.b.imageAltText);e&&""!==e&&this.get_htmlElement().get_attributes().add("alt",e)}var t=Hh.N(0);if(this._graphNode.hasProperty(Kc.b.layoutMaxWidth)){var n=this._graphNode.getValue(Number,Kc.b.layoutMaxWidth);try{var r=Jg.AF(Math.round(n*t));r>0?this.get_htmlElement().get_attributes().add("width",r.toString()):C.ULS.sendTraceTag(20248408,339,15,"Image width in inches '{0}' was less than equal to 0. Ignoring.",r)}catch(e){C.ULS.sendTraceTag(20248410,339,15,"Conversion of image width '{0}' * PixelsPerInch '{1}' to an int resulted in an overflow exception. Ignoring.",n,t)}}if(this._graphNode.hasProperty(Kc.b.layoutMaxHeight)){var i=this._graphNode.getValue(Number,Kc.b.layoutMaxHeight);try{var o=Jg.AF(Math.round(i*t));o>0?this.get_htmlElement().get_attributes().add("height",o.toString()):C.ULS.sendTraceTag(20248412,339,15,"Image height in inches '{0}' was less than equal to 0. Ignoring.",o)}catch(e){C.ULS.sendTraceTag(20248414,339,15,"Conversion of image height '{0}' * PixelsPerInch '{1}' to an int resulted in an overflow exception. Ignoring.",i,t)}}},t.prototype.addSrcAttributes=function(e,t,n,r){var i=null,o=null;e||n?(e&&e!==Dt.h.get_nil()?(o=this._htmlView.constructUrl(e,t),this.get_htmlElement().get_attributes().add("src",o),this.get_htmlElement().get_attributes().add("data-src-type",t)):(i=this._htmlView.constructUrl(n,r),this.get_htmlElement().get_attributes().add("src",i),this.get_htmlElement().get_attributes().add("data-src-type",r),o=i),n!==Dt.h.get_nil()&&n?(""!==i&&i||(i=this._htmlView.constructUrl(n,r)),this.get_htmlElement().get_attributes().add("data-fullres-src",i),this.get_htmlElement().get_attributes().add("data-fullres-src-type",r)):(C.ULS.sendTraceTag(20248418,339,50,"highResImageId is null."),i=o,this.get_htmlElement().get_attributes().add("data-fullres-src",o),this.get_htmlElement().get_attributes().add("data-fullres-src-type",t))):C.ULS.sendTraceTag(20248416,339,15,"There is no image blob.")},t.prototype.getSrcAttributes=function(e,t,n){t.val=null,n.val=null},t.prototype.isPrintOutImage=function(){return this._graphNode.getValueWithDefault(Boolean,Kc.b.isPrintoutPage,!1)},t.prototype.addSplitImageAttributes=function(){this.isSplitPiece()&&(this.get_htmlElement().get_attributes().add("data-index",this._splitImageHelper.get_pageOrder().toString()),this.addDataRenderOriginalSrcAttribute()),this.isPrintOutImage()&&this.get_htmlElement().get_attributes().add("data-options","printout")},t.prototype.addDataRenderOriginalSrcAttribute=function(){this._splitImageHelper.get_dataRenderOriginalSrc()&&this.get_htmlElement().get_attributes().add("data-render-original-src",this._splitImageHelper.get_dataRenderOriginalSrc())},t.prototype.isSplitPiece=function(){return this._splitImageHelper.isSplitImage()},t.prototype.get_srcGuid=function(){return this._splitImageHelper.get_srcGuid()},t}(OI);(0,o.l)(nw,"ImageViewElement$0",OI,[qI]);var rw=function(){function e(){}return e.get_listReaderInstance=function(){return e._listReader||(e._listReader=se.w.get_instance().resolve(ts.c))},e.getListInfoForBareContentInsideAList=function(t,n){if(!t||!t.get_containingGraph())return null;var r=new Da.GraphIterator;return r.set(t),r.tryToRootAtPageContent(),r.returnToParent()&&Ls.OutlineElementReader.isOutlineElement(r)&&1===r.getChildCount()&&r.returnToParent()?(n.setFrom(r),e.getListInfoForListContainer(r)):null},e.getListInfoForListContainer=function(t){var n=new Da.GraphIterator;n.setFrom(t);for(var r=n.goToFirstChildByRole(1);r;r=n.goToNextSiblingByRole(1))if(mc.ListReader.isListOutlineElement(n)){n.goToFirstChildByRole(4);var i=n.get_currentNode();return e.get_listReaderInstance().getListInfoNode(i)}return null},e.removeContentThatBelongsToAList=function(t){var n=t.get_children().get_item(t.get_children().get_count()-1);return!function(e,t){for(var n=0;n<t.length;n++){if(t[n]===e)return!0}return!1}(n.tagName,e.allowedListItems)?C.ULS.sendTraceTag(20248449,339,100,"Unexpected number list paragraph schema: {0}",n.tagName):t.get_children().remove(n),n},e._listReader=null,e.allowedListItems=["table","img","p","div"],e}();(0,o.l)(rw,"ListUtils",null,[]);var iw=function(e){function t(n,r){var i=e.call(this,n,r.get_currentNode())||this;i._listInfo=null,i.set_htmlElement(i._htmlView.createElement("li")),i.addId(i.get_htmlElement(),r.get_currentINode()),r.get_currentINode().hasProperty(Kc.b.listRestart)&&i.get_htmlElement().get_attributes().add("value",r.get_currentINode().getValue(Number,Kc.b.listRestart).toString()),i._listInfo=t.get_listReaderInstance().getListInfoNode(i.get_sourceNode());var o=t.listStyleType(i._listInfo);return EI(o)||i.get_htmlElement().get_styles().add("list-style-type",o),i}return(0,S.t)(t,e),t.prototype.addToHtmlDocument=function(e){var t=rw.removeContentThatBelongsToAList(e),n=this.moveListParent();this.getContainingList(n,this._listInfo,e).addChild(this.get_htmlElement()),this.get_htmlElement().addChild(t)},t.prototype.moveListParent=function(){var e=new Da.GraphIterator;return e.set(this._graphNode),e.tryToRootAtPageContent(),e.returnToParent(),e.returnToParent(),e},t.get_listReaderInstance=function(){return t._listReader||(t._listReader=se.w.get_instance().resolve(ts.c))},t.listStyleType=function(e){var t=null;if(e.get_isOrdered())switch(e.get_listStyle()){case 0:t="none";break;case 1:break;case 2:t="lower-alpha";break;case 3:t="lower-roman";break;case 4:t="upper-alpha";break;case 5:t="upper-roman"}else switch(e.get_listStyle()){case 0:t="none";break;case 1:break;case 2:t="circle";break;case 3:t="square"}return t},t._listReader=null,t}(OI);(0,o.l)(iw,"NumberListViewElement$0",OI,[]);var ow=function(e){function t(t,n){var r=e.call(this,t,n.get_currentNode())||this;return r.set_htmlElement(r._htmlView.createElement("div")),r.addId(r.get_htmlElement(),n.get_currentINode()),r.addCommonAttributes(),r.get_htmlElement().get_styles().add("width",wI(n.get_currentINode().getValueWithDefault(Number,Kc.b.layoutMaxWidth,0))+"px"),r}return(0,S.t)(t,e),t}(OI);(0,o.l)(ow,"OutlineViewElement$0",OI,[]);var aw=function(e){function t(t,n){var r=e.call(this,t,n.get_currentNode())||this;return r.set_htmlElement(r._htmlView.createElement("body")),r.get_htmlElement().get_attributes().add("data-absolute-enabled","true"),r}return(0,S.t)(t,e),t}(OI);(0,o.l)(aw,"PageContentViewElement",OI,[]);var sw,lw=function(){function e(){}return e.paragraphObjectSpecialCharacter="\ufffc",e}();(0,o.l)(lw,"ParagraphViewConstants",null,[]);var cw=function(e){function t(t,n){var r=e.call(this,t,n.get_currentNode())||this,i=r.get_sourceNode(),o=cs.ParagraphReader.text(i);if(EI(o)||o===lw.paragraphObjectSpecialCharacter&&!(i.get_characterProperties().get_length()>0&&i.get_characterProperties().get_item(0).get_blob()&&11===i.get_characterProperties().get_item(0).get_blob().get_blobType()))r.set_htmlElement(r._htmlView.createElement("br"));else if(i.get_characterProperties()&&i.get_characterProperties().get_length()){r.set_htmlElement(r.getParagraphElement(i));for(var a,s=function(e,t){if(i.get_characterProperties().get_item(e).get_isEndOfParagraph())return a=t,"continue";if(i.get_characterProperties().get_item(e).get_blob()&&11===i.get_characterProperties().get_item(e).get_blob().get_blobType()){var n=i.get_characterProperties().get_item(e).get_blob().get_renderedMathElement(),r=G.y.get_isFirefox()?n.getElementsByTagName("math"):n.getElementsByTagName("script");if(r&&r.length>0&&("math/mml"===r[0].getAttribute("type")||G.y.get_isFirefox())){var s=G.y.get_isFirefox()?r[0].parentNode.innerHTML:r[0].innerText,c=l._htmlView.createCommentElement("[if mathML]>"+s+"<![endif]");l.get_htmlElement().addChildAndSetParent(0,c)}}else{for(var u=l.getChildElement(i.get_characterProperties().get_item(e),o,(0,p.m)((function(){return t}),(function(e){return t=e})));u&&u.value&&u.value.endsWith(lw.paragraphObjectSpecialCharacter);)u.value=u.value.replace(lw.paragraphObjectSpecialCharacter,"");l.get_htmlElement().addChildAndSetParent(0,u)}a=t},l=this,c=i.get_characterProperties().get_length()-1,u=o.length;c>=0;c--)s(c,u),u=a}else r.set_htmlElement(r.getParagraphElement(i)),r.get_htmlElement().value=o;return r.addCommonAttributes(),r}return(0,S.t)(t,e),t.prototype.getParagraphElement=function(e){if(!e)return null;var n,r=Tc.StyleReader.getStyleFromParagraphNode(e);if(r){var i=Tc.StyleReader.getStyleId(r);t.paragraphTags.contains(i)?n=this._htmlView.createElement(i):(n=this._htmlView.createElement("p"),C.ULS.sendTraceTag(20248467,339,50,"Unsupported tag returned. Defaulting to p: {0}",i)),t.addStylesFromPropertySet(n.get_styles(),r)}else n=this._htmlView.createElement("p");this.addId(n,e);var o=xI(n.get_styles()),a=cs.ParagraphReader.fetchProperty(Number,e,qc.o.paragraphSpaceBefore,0),s=FI(a);s!==o&&n.get_styles().set_item("margin-top",String.format("{0}pt",s));var l=cs.ParagraphReader.fetchProperty(Number,e,qc.o.paragraphSpaceAfter,0),c=FI(l);if(c!==o&&n.get_styles().set_item("margin-bottom",String.format("{0}pt",c)),e.hasProperty(Kc.b.layoutAlignmentInParent))switch(e.getValueWithDefault(Number,Kc.b.layoutAlignmentInParent,0)){case 1:n.get_styles().set_item("text-align","left");break;case 2:n.get_styles().set_item("text-align","center");break;case 3:n.get_styles().set_item("text-align","right")}if(e.hasProperty(Kc.b.richTextLanguageId)){var u=e.getValue(Number,Kc.b.richTextLanguageId),g=JI(u);g?n.get_attributes().set_item("lang",g):C.ULS.sendTraceTag(20248469,339,50,"Invalid language id: {0}",u)}return tw.addNoteTagAttribute(n,e),n},t.prototype.getChildElementForNoFormatting=function(e,t){if(t===lw.paragraphObjectSpecialCharacter)return this._htmlView.createElement("br");var n=this._htmlView.createElement("span");return n.value=t,n},t.prototype.getChildElement=function(e,n,r){if(!e)return null;if(!n)return null;var i=t.getCurrentSubstring(e,n,r);if(t.hasNoFormatting(e))return this.getChildElementForNoFormatting(e,i);var o=this._htmlView.createElement("span"),a=o;if(e.get_formatting().get_formattingContainer().getValueWithDefault(Boolean,Kc.b.superscript,!1)&&(a.addChild(this._htmlView.createElement("sup")),a=a.get_children().get_count()>0?a.get_children().get_item(0):null),e.get_formatting().get_formattingContainer().getValueWithDefault(Boolean,Kc.b.subscript,!1)&&(a.addChild(this._htmlView.createElement("sub")),a=a.get_children().get_count()>0?a.get_children().get_item(0):null),e.get_hyperlink()&&(a.addChild(this._htmlView.createElement("a")),(a=a.get_children().get_count()>0?a.get_children().get_item(0):null).get_attributes().set_item("href",e.get_hyperlink().get_url())),e.get_formatting().get_formattingContainer().hasProperty(Kc.b.languageID)){var s=e.get_formatting().get_formattingContainer().getValue(Number,Kc.b.languageID),l=JI(s);l?a.get_attributes().set_item("lang",l):C.ULS.sendTraceTag(20248471,339,50,"Invalid language id: {0}",s)}return a.value=i,t.addStylesFromPropertySet(a.get_styles(),e.get_formatting().get_formattingContainer()),o},t.create=function(e,n){return new t(e,n)},t.hasNoFormatting=function(e){return!e.get_formatting()||!e.get_formatting().get_formattingContainer()},t.getCurrentSubstring=function(e,t,n){var r=t.substr(e.get_cp(),n.val-e.get_cp());return n.val=e.get_cp(),r},t.addStylesFromPropertySet=function(e,t){if(e&&t){if(t.hasProperty(Kc.b.font)&&e.set_item("font-family",t.getValueWithDefault(String,Kc.b.font,null)),t.hasProperty(Kc.b.fontSize)&&e.set_item("font-size",t.getValueWithDefault(Number,Kc.b.fontSize,0)/2+"pt"),t.hasProperty(Kc.b.fontColor)){var n=II(t.getValueWithDefault(Number,Kc.b.fontColor,0));EI(n)||e.set_item("color",n)}if(t.hasProperty(Kc.b.highlight)){var r=II(t.getValueWithDefault(Number,Kc.b.highlight,0));EI(r)||e.set_item("background-color",r)}t.getValueWithDefault(Boolean,Kc.b.bold,!1)&&e.set_item("font-weight","bold"),t.getValueWithDefault(Boolean,Kc.b.italic,!1)&&e.set_item("font-style","italic"),t.getValueWithDefault(Boolean,Kc.b.underline,!1)&&e.set_item("text-decoration","underline"),t.getValueWithDefault(Boolean,Kc.b.strikethrough,!1)&&e.set_item("text-decoration","line-through")}},t.paragraphTags=((sw=new y.c(String)).add("p"),sw.add("cite"),sw.add("h1"),sw.add("h2"),sw.add("h3"),sw.add("h4"),sw.add("h5"),sw.add("h6"),sw.add("br"),sw),t}(OI);(0,o.l)(cw,"ParagraphViewElement$0",OI,[]);var uw=(0,o.y)("ISplitImageNode"),gw=n(2634),pw=n(8457),dw=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.$$cctor=function(){t.ensureLoaded()},t.defineProperty$1=function(e,t,n){return gw.a.defineProperty(20,e,t,n)},t.ensureLoaded=function(){},t.appId=t.defineProperty$1(0,pw.y.string,0),t.deniedFileExt=t.defineProperty$1(1,pw.y.bool,0),t.fileMimeType=t.defineProperty$1(2,pw.y.string,0),t.imageSourceGuid=t.defineProperty$1(3,pw.y.string,0),t.imageFragmentDisplayIndex=t.defineProperty$1(4,pw.y.uInt_32,0),t.hierarchyOfIdentifiers=t.defineProperty$1(5,pw.y.string,512),t.ownerTagName=t.defineProperty$1(6,pw.y.string,512),t.dataRenderOriginalSrc=t.defineProperty$1(7,pw.y.string,0),t.dataGroupId=t.defineProperty$1(8,pw.y.string,0),t.classifierLabel=t.defineProperty$1(9,pw.y.string,0),t.ocrVersion=t.defineProperty$1(10,pw.y.uInt_32,0),t.classifierVersion=t.defineProperty$1(11,pw.y.uInt_32,0),t.userClassifierLabels=t.defineProperty$1(12,pw.y.arrayOfStrings,0),t.machineClassifierLabels=t.defineProperty$1(13,pw.y.arrayOfStrings,0),t.machineSentinelClassifierLabels=t.defineProperty$1(14,pw.y.arrayOfStrings,0),t.handwritingRecoVersion=t.defineProperty$1(15,pw.y.string,0),t.machineModifiedRevisionId=t.defineProperty$1(16,pw.y.extendedGuid,0),t.imageClassificationVersion=t.defineProperty$1(17,pw.y.uInt_32,0),t}(gw.a);(0,o.l)(dw,"OneNoteServiceProperties1",gw.a,[]),dw.$$cctor();var hw=function(){function e(e){if(this.type=0,this._srcGuid=null,this._pageOrder=0,this._dataRenderOriginalSrc=null,393233===e.get_runtimeClassId())if(this.type=0,e.hasProperty(dw.imageSourceGuid)&&e.hasProperty(dw.imageFragmentDisplayIndex)){var t=e.getValue(String,dw.imageSourceGuid);EI(t)?C.ULS.sendTraceTag(20248513,339,15,"GraphNode has the OneNoteServiceProperties1.ImageSourceGuid property but it's value is null or whitespace. Setting SplitType to None"):(this.type=1,this.set_srcGuid(ae.l.createFromString(t)),this.set_pageOrder(e.getValue(Number,dw.imageFragmentDisplayIndex)),e.hasProperty(dw.dataRenderOriginalSrc)&&this.set_dataRenderOriginalSrc(e.getValueWithDefault(String,dw.dataRenderOriginalSrc,null)))}else e.hasProperty(Kc.b.sourceDocumentGuid)&&e.hasProperty(Kc.b.originalPageNumber)&&(this.type=2,this.set_srcGuid(e.getValue(ae.l,Kc.b.sourceDocumentGuid)),this.set_pageOrder(e.getValue(Number,Kc.b.originalPageNumber)),e.hasProperty(dw.dataRenderOriginalSrc)&&this.set_dataRenderOriginalSrc(e.getValueWithDefault(String,dw.dataRenderOriginalSrc,null)))}return e.prototype.get_srcGuid=function(){return this.isSplitImage()?this._srcGuid:null},e.prototype.set_srcGuid=function(e){return this._srcGuid=e,e},e.prototype.get_pageOrder=function(){return this.isSplitImage()?this._pageOrder:0},e.prototype.set_pageOrder=function(e){return this._pageOrder=e,e},e.prototype.get_dataRenderOriginalSrc=function(){return this.isSplitImage()?this._dataRenderOriginalSrc:null},e.prototype.set_dataRenderOriginalSrc=function(e){return this._dataRenderOriginalSrc=e,e},e.prototype.isSplitImage=function(){return!!this.type},e}();(0,o.l)(hw,"SplitImageNode",null,[uw]);var _w=function(e){function t(n,r){var i=e.call(this,n,r.get_currentNode())||this;if(i._graphIterator=null,i.set_htmlElement(i._htmlView.createElement("td")),i.addId(i.get_htmlElement(),r.get_currentINode()),i.get_sourceNode().hasProperty(Kc.b.cellShadingColor)){var o=i.get_sourceNode().getValueWithDefault(Number,Kc.b.cellShadingColor,0);i.get_htmlElement().get_styles().add("background-color",II(o))}i._graphIterator=new Da.GraphIterator,i._graphIterator.setFrom(r);var a,s=sd.e(i._graphIterator);t.getColumnWidth(i._graphIterator,s,(0,p.m)((function(){return a}),(function(e){return a=e})))&&i.get_htmlElement().get_styles().add("width",a.toString());var l=t.doesTableHaveBorder(i.get_sourceNode());return i.get_htmlElement().get_styles().add("border",l?"1px solid":"0px"),i}return(0,S.t)(t,e),t.getColumnWidth=function(e,t,n){n.val=0;var r=ld.getContainingTable(e);return!(sd.t(r,t)<0)&&(n.val=wI(sd.t(r,t)),!0)},t.doesTableHaveBorder=function(e){var t=new Da.GraphIterator;return t.set(e),t.tryToRootAtAncestorOfType(14),ld.getContainingTable(t).getValueWithDefault(Boolean,Kc.b.tableBordersVisible,!0)},t}(OI);(0,o.l)(_w,"TableCellViewElement$0",OI,[]);var mw=function(e){function t(t,n){var r=e.call(this,t,n.get_currentNode())||this;return r.set_htmlElement(r._htmlView.createElement("tr")),r.addId(r.get_htmlElement(),n.get_currentINode()),r}return(0,S.t)(t,e),t}(OI);(0,o.l)(mw,"TableRowViewElement$0",OI,[]);var fw=function(e){function t(t,n){var r=e.call(this,t,n.get_currentNode())||this;r.set_htmlElement(r._htmlView.createElement("table")),r.addId(r.get_htmlElement(),n.get_currentINode());var i=r.get_sourceNode().getValueWithDefault(Boolean,Kc.b.tableBordersVisible,!0);return r.get_htmlElement().get_styles().add("border",i?"1px solid":"0px"),i&&r.get_htmlElement().get_styles().add("border-collapse","collapse"),r}return(0,S.t)(t,e),t}(OI);(0,o.l)(fw,"TableViewElement$0",OI,[]);var yw=function(e){function t(n,r){var i=e.call(this,n,r.get_currentNode())||this;i._titleElement=null;var o=r;try{i.set_htmlElement(i._htmlView.createElement("head")),i._titleElement=i._htmlView.createElement("title"),i._titleElement.canSelfEnd=!1,i.get_htmlElement().addChild(i._titleElement);var a=i._htmlView.createElement("meta");a.get_attributes().add("http-equiv","Content-Type"),a.get_attributes().add("content","text/html; charset=utf-8"),i.get_htmlElement().addChild(a),UA.q(o)&&(i._titleElement.value=cs.ParagraphReader.text(o.get_currentNode())),o.returnToNodeOfType(9);var s=UA.f(o);if(!s||12!==s.get_type()||!Hr.d(s))return C.ULS.sendTraceTag(20248517,339,50,"Did not find date under title node."),i;var l=cs.ParagraphReader.text(s);o.returnToNodeOfType(9);var c=UA.a(o);if(!c||12!==c.get_type()||!Hr.m(c))return C.ULS.sendTraceTag(20248519,339,50,"Did not find time under title node."),i;var u=cs.ParagraphReader.text(c);if(EI(l)||EI(u))return C.ULS.sendTraceTag(20248521,339,50,"Either date or time is empty."),i;o.returnToNodeOfType(9),tw.addNoteTagAttribute(i._titleElement,o.get_currentINode())}finally{t.skipToEndOfTitle(o)}return i}return(0,S.t)(t,e),t.prototype.addToHtmlDocument=function(e){for(;e.get_parent();)e=e.get_parent();e.addChildAndSetParent(0,this.get_htmlElement())},t.skipToEndOfTitle=function(e){for(;e.goToLastChild(););},t}(OI);(0,o.l)(yw,"TitleViewElement$1",OI,[]);var Cw=function(){function e(){}return e.prototype.createViewElementForGraphNode=function(e,t){if(!e)return null;if(!t)return null;var n;switch(C.ULS.sendTraceTag(20248349,339,50,"Creating ViewElement of type = {0}",t.get_currentNode().get_type()),t.get_currentNode().get_type()){case 32:n=new YI(e,t);break;case 1:n=null;break;case 19:n=new nw(e,t,new hw(t.get_currentINode()));break;case 59:this.isVideoMediaType(t.get_currentNode()),n=new ew(e,t);break;case 22:n=new iw(e,t);break;case 10:n=new ow(e,t);break;case 11:n=null;break;case 8:n=new aw(e,t);break;case 7:n=null;break;case 12:n=cw.create(e,t);break;case 14:n=new fw(e,t);break;case 16:n=new _w(e,t);break;case 15:n=new mw(e,t);break;case 9:n=new yw(e,t);break;default:C.ULS.sendTraceTag(20248351,339,15,"Unhandled node type during ViewElement creation: {0}",t.get_currentNode().get_type());var r=String.format("{0} is not supported",t.get_currentNode().get_runtimeClassId());n=new ZI(e,t.get_currentNode(),r)}return n},e.prototype.isVideoMediaType=function(e){return!e.hasProperty(qc.o.iFrameMediaType)||1===e.getValue(Number,qc.o.iFrameMediaType)},e}();(0,o.l)(Cw,"DefaultViewElementCreator",null,[XI]);var Sw=function(){function e(t){this.elementId=null,this.tagName=null,this.className=null,this.parent=null,this.children=null,this.attributes=null,this.styles=null,this.value=null,this.comment=null,this.canSelfEnd=!1,this.indent=0,this.isComment=!1,this.elementId=t,this.children=new y.c(e),this.attributes=new Ma.e(String,String),this.styles=new Ma.e(String,String),this.canSelfEnd=!0}return e.prototype.get_elementId=function(){return this.elementId},e.prototype.get_parent=function(){return this.parent},e.prototype.get_children=function(){return this.children},e.prototype.get_attributes=function(){return this.attributes},e.prototype.get_styles=function(){return this.styles},e.prototype.get_isComment=function(){return this.isComment},e.prototype.get_hasSemanticValue=function(){return"span"!==this.tagName&&"div"!==this.tagName},e.prototype.addChild=function(e){this.addChildAndSetParent(this.get_children().get_count(),e)},e.prototype.addChildAndSetParent=function(e,t){C.ULS.shipAssertTag(20248343,339,this!==t,"Attempting to add PCRDOMElement {0} as a child of itself",this.tagName),this.get_children().insert(e,t),t.parent=this},e.prototype.containsChild=function(e){return this.get_children().contains(e)},e.prototype.setParent=function(e){this.get_parent()&&this.get_parent().get_children().remove(this),e?e.addChild(this):this.parent=null},e.prototype.insertParent=function(e){if(this.get_parent()){var t=this.get_parent().get_children().indexOf(this);-1!==t&&(this.get_parent().get_children().remove(this),this.get_parent().containsChild(e)||this.get_parent()===e||this.get_parent().addChildAndSetParent(t,e))}e.addChild(this)},e.createCommentDomElement=function(t){return(0,O.m)(new e(Dt.h.create().toString()),{isComment:!0,comment:t,tagName:""})},e}();(0,o.l)(Sw,"PCRDOMElement",null,[]);var vw=function(e,t,n){var r=t.containsKey(e.get_elementId())?t.get_item(e.get_elementId()):new Th(t_),i=Aw(r,e.tagName);i&&r.removeAt(r.get_count()-1);for(var o=null,a=0,s=e.get_children().toArray();a<s.length;a++){var l=s[a],c=vw(l,t,n);bw(c,e,o,l,n);var u=Aw(c,e.tagName);if(u&&c.removeAt(c.get_count()-1),r=Tw(r,c),u){if(!i&&u.get_htmlIdentifier()&&""!==u.get_htmlIdentifier())i=u;else if(i.get_htmlIdentifier()&&""!==i.get_htmlIdentifier()&&u.get_htmlIdentifier()&&""!==u.get_htmlIdentifier()&&i.get_htmlIdentifier()!==u.get_htmlIdentifier())return null;o=l}else o=l}return i&&"_none"!==i.get_htmlIdentifier()&&e.get_attributes().add("data-id",i.get_htmlIdentifier()),r},bw=function(e,t,n,r,i){if(e){var o=new Y.d(String,Sw,0);if(n)for(var a=n.get_parent();a&&a!==t&&"div"===Jn.l.toLower(a.tagName);)a.get_attributes().containsKey("data-id")&&!o.containsKey(a.get_attributes().get_item("data-id"))&&o.set_item(a.get_attributes().get_item("data-id"),a),a=a.get_parent();for(var s=!1,l=r;e.get_count()>0;){var c=e.get_item(e.get_count()-1);if("div"!==Jn.l.toLower(c.get_htmlElementType()))break;if(s)e.remove(c);else{if(o.containsKey(c.get_htmlIdentifier()))l.setParent(o.get_item(c.get_htmlIdentifier())),s=!0;else if(c.get_htmlIdentifier()&&""!==c.get_htmlIdentifier()){var u=i("div");u.get_attributes().add("data-id",c.get_htmlIdentifier()),l.insertParent(u)}l=l.get_parent(),e.remove(c)}}}},Tw=function(e,t){if(!e)return t;if(!t)return e;for(var n=new Th(t_),r=e.get_count()-1,i=t.get_count()-1;r>=0&&i>=0;r--,i--){if(e.get_item(r).get_htmlElementType()!==t.get_item(i).get_htmlElementType()||e.get_item(r).get_htmlIdentifier()!==t.get_item(i).get_htmlIdentifier())return n;n.insert(0,e.get_item(r))}if(r>i)for(;r>=0;)n.insert(0,e.get_item(r)),r--;else for(;i>=0;)n.insert(0,t.get_item(i)),i--;return n},Aw=function(e,t){if(!e||!e.get_count())return null;var n=e.get_item(e.get_count()-1);return n&&(Jn.l.toLower(n.get_htmlElementType())===t||"img"===t&&"IFRAME"===n.get_htmlElementType())?n:null},Iw=function(){return function(){this.documentElement=null}}();(0,o.l)(Iw,"PCRDOMDocument",null,[]);var ww=n(3579),xw=function(e){function t(t,n,r){var i=e.call(this)||this;return i._traversalFinished=!1,i._renderRoleOrder=null,i._traversalCount=0,i._pcrUseSafeGoToFirstChildByRole=!1,i._pcrUseSafeGoToNextSiblingByRole=!1,i._pcrUseSafeGoToFirstSiblingByRole=!1,i._traversalCount=0,i.init(t,n),i._renderRoleOrder=r,i._pcrUseSafeGoToFirstChildByRole=!0,i._pcrUseSafeGoToNextSiblingByRole=!0,i._pcrUseSafeGoToFirstSiblingByRole=!0,i}return(0,S.t)(t,e),t.prototype.moveNext=function(){try{if(this._traversalCount=0,!this._traversalStarted)return this._traversalStarted=!0,!0;if(this._traversalFinished)return!1;if(!this.goToFirstChildInRenderOrder()){if(this._iterator.get_currentNode()===this._scope)return this._traversalFinished=!0,!1;for(var e=this._iterator.get_currentNode();!this.goToNextSiblingInRenderOrder();){if(this._traversalCount++,this._iterator.returnToParent(),e===this._iterator.get_currentNode())return C.ULS.sendTraceTag(20248477,339,10,"RenderOrderTraverser - traversal to parent did not move. quit traversing."),!1;if(this._iterator.get_currentNode()===this._scope)return this._traversalFinished=!0,!1;e=this._iterator.get_currentNode()}}return!0}finally{C.ULS.sendTraceTag(20248479,339,50,"RenderOrderTraverser:MoveNext ends with traverse count = {0}.",this._traversalCount)}},t.prototype.reset=function(){e.prototype.reset.call(this),this._traversalFinished=!1},t.prototype.goToFirstChildInRenderOrder=function(){for(var e=0;e<this._renderRoleOrder.length;e++){this._traversalCount++;var t=null;if(t=this._pcrUseSafeGoToFirstChildByRole?this.safeGoToFirstChildByRole(this._iterator,this._renderRoleOrder[e]):this._iterator.goToFirstChildByRole(this._renderRoleOrder[e]))return t}return null},t.prototype.goToNextSiblingInRenderOrder=function(){var e=null;if(e=this._pcrUseSafeGoToNextSiblingByRole?this.safeGoToNextSiblingByRole(this._iterator,this._iterator.get_role()):this._iterator.goToNextSiblingByRole(this._iterator.get_role()))return e;var t=Array.indexOf(this._renderRoleOrder,this._iterator.get_role());for(t++;t<this._renderRoleOrder.length;){if(this._traversalCount++,e=this._pcrUseSafeGoToFirstSiblingByRole?this.safeGoToFirstSiblingByRole(this._iterator,this._renderRoleOrder[t]):this._iterator.goToFirstSiblingByRole(this._renderRoleOrder[t]))return e;t++}return null},t.prototype.safeGoToNextSiblingByRole=function(e,t){if(!e)return null;if(!e.get_isValid())return C.ULS.sendTraceTag(20248481,339,10,"iterator is not valid."),null;var n=new Da.GraphIterator;n.setFrom(e);for(var r=e.goToNextSibling();r;r=e.goToNextSibling())if(e.get_role()===t)return r;return e.setFrom(n),null},t.prototype.safeGoToFirstChildByRole=function(e,t){if(!e)return null;if(!e.get_isValid())return C.ULS.sendTraceTag(20248483,339,10,"iterator is not valid."),null;var n=new Da.GraphIterator;n.setFrom(e);for(var r=e.goToFirstChild();r;r=e.goToNextSibling())if(e.get_role()===t)return r;return e.setFrom(n),null},t.prototype.safeGoToFirstSiblingByRole=function(e,t){if(!e)return null;var n=new Da.GraphIterator;n.setFrom(e),e.returnToParent();var r=this.safeGoToFirstChildByRole(e,t);return r||(e.setFrom(n),null)},t.createTraverser=function(e,n){var r=new Da.GraphIterator;return r.set(e),new t(r,e,n)},t}(ww.u);(0,o.l)(xw,"RenderOrderTraverser",ww.u,[]);var Fw=function(){function e(){this.printoutFileBySrcGuid=null,this.splitImagesBySrcGuid=null,this.printoutFileBySrcGuid=new Y.d(ae.l,jI,0),this.splitImagesBySrcGuid=new Y.d(ae.l,y.c.$$(qI),0)}return e.prototype.get_printoutFileBySrcGuid=function(){return this.printoutFileBySrcGuid},e.prototype.get_splitImagesBySrcGuid=function(){return this.splitImagesBySrcGuid},e.prototype.addImage=function(e){if(e.isSplitPiece())if(this.get_splitImagesBySrcGuid().containsKey(e.get_srcGuid()))this.get_splitImagesBySrcGuid().get_item(e.get_srcGuid()).add(e);else{var t=void 0;this.get_splitImagesBySrcGuid().set_item(e.get_srcGuid(),((t=new y.c(qI)).add(e),t))}},e.prototype.addFile=function(e){e.isPrintout()&&(this.get_printoutFileBySrcGuid().containsKey(e.get_srcGuid())&&C.ULS.sendTraceTag(20248515,339,10,"file with same source guid exist."),this.get_printoutFileBySrcGuid().set_item(e.get_srcGuid(),e))},e.prototype.build=function(){},e}();(0,o.l)(Fw,"SplitImageViewBuilder",null,[]);var Ew=function(){function e(e,t,n,r,i){void 0===n&&(n=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),this.ownerDocument=null,this.saveGraphNodePathInfo=!1,this.includeIds=!1,this.preAuthenticated=!1,this.toAddToPublicCacheDict=null,this.toAddToHtmlElementDict=null,this.listContainers=null,this.graphDomTree=null,this.graphNodePath=null,this.elementToGraphNode=null,this.domElementToHierarchy=null,this.splitImageViewBuilder=null,this._viewElementCreator=null,this._uriBuilder=null,this.saveGraphNodePathInfo=n,this.includeIds=r,this.ownerDocument=new Iw,this.graphDomTree=new Y.d(String,OI,ee.b.get_ordinalIgnoreCase()),this.graphNodePath=new Y.d(String,Da.GraphIterator,ee.b.get_ordinalIgnoreCase()),this.elementToGraphNode=new Y.d(String,Wf.k,ee.b.get_ordinalIgnoreCase()),this.domElementToHierarchy=new Y.d(String,Th.$$(t_),ee.b.get_ordinalIgnoreCase()),this.splitImageViewBuilder=new Fw,this.listContainers=new Y.d(String,Sw,ee.b.get_ordinalIgnoreCase()),this.toAddToPublicCacheDict=new Ma.e(String,String),this.toAddToHtmlElementDict=new Ma.e(String,String),this._viewElementCreator=e,this._uriBuilder=t}return e.prototype.get_viewId=function(){return 0},e.prototype.get_container=function(){return null},e.prototype.get_contentContainer=function(){return this.get_container()},e.prototype.get_ownerDocument=function(){return this.ownerDocument},e.prototype.get_saveGraphNodePathInfo=function(){return this.saveGraphNodePathInfo},e.prototype.get_includeIds=function(){return this.includeIds},e.prototype.get_preAuthenticated=function(){return this.preAuthenticated},e.prototype.get_toAddToPublicCacheDict=function(){return this.toAddToPublicCacheDict},e.prototype.get_toAddToHtmlElementDict=function(){return this.toAddToHtmlElementDict},e.prototype.get_listContainers=function(){return this.listContainers},e.prototype.get_graphDomTree=function(){return this.graphDomTree},e.prototype.get_graphNodePath=function(){return this.graphNodePath},e.prototype.get_elementToGraphNode=function(){return this.elementToGraphNode},e.prototype.get_domElementToHierarchy=function(){return this.domElementToHierarchy},e.prototype.createElement=function(e){return e?(0,O.m)(new Sw(Dt.h.create().toString()),{tagName:e}):null},e.prototype.createCommentElement=function(e){return Sw.createCommentDomElement(e)},e.prototype.bindToContainer=function(e){},e.prototype.bindToRoot=function(t,n){void 0===n&&(n=!1);var r=L.AFrameworkApplication.requestedLcid,i=JI(r),a=xw.createTraverser(t,e._roleOrder);if(n){var s=this._viewElementCreator.createViewElementForGraphNode(this,a.get_iterator());return i&&s.get_htmlElement().get_attributes().set_item("lang",i),void(this.get_ownerDocument().documentElement=s.get_htmlElement())}for(this.get_ownerDocument().documentElement=this.createElement("html"),i?this.get_ownerDocument().documentElement.get_attributes().set_item("lang",i):C.ULS.sendTraceTag(20248459,339,15,"Lang={0} is invalid.",r);a.moveNext();){var l=a.get_currentNode(),c=null;try{var u=e.getIdFromNode(l);if(!this.get_graphDomTree().containsKey(u)){c=a.get_iterator().get_parentNode();var g=a.get_iterator().getChildCount();if(19===l.get_type()&&1===g){var p=a.get_iterator().goToFirstChild();59===p.get_type()&&this._viewElementCreator.isVideoMediaType(p)?l=p:a.get_iterator().goToNextSiblingOrReturnToParent()}var d=this._viewElementCreator.createViewElementForGraphNode(this,a.get_iterator());if(d)this.addViewElementToHtmlDocument(l,c,d,a.get_iterator()),this.addSplitImage(d);else{var h=e.getIdFromNode(c),_=c?this.get_graphDomTree().get_item(h):null;this.get_graphDomTree().add(u,_)}}if(n)break}catch(e){C.ULS.sendTraceTag(20248461,339,15,"NodeType={0}, ParentNodeType={1}, Exception={2}",l.get_type(),c?c.get_type():-1,e);var m=String.format("Processing {0} failed",l.get_runtimeClassId()),f=new ZI(this,l,m);this.addViewElementToHtmlDocument(l,c,f,a.get_iterator())}}this.splitImageViewBuilder.build(),this.shouldIncludeMathJax()&&this.addMathJaxScriptElement(),e.shouldIncludePageMetadata()&&this.addPageMetadata(t),function(e,t,n){try{vw(e,t,n)}catch(e){C.ULS.sendTraceTag(20248392,339,10,"data-id attributes are not set successfully. {0}",e)}}(this.get_ownerDocument().documentElement,this.get_domElementToHierarchy(),o.i(this,this.createElement,"createElement"))},e.prototype.getGraphNodePath=function(e){return this.get_graphNodePath().containsKey(e)?this.get_graphNodePath().get_item(e):null},e.prototype.shouldIncludeMathJax=function(){return!1},e.prototype.addMathJaxScriptElement=function(){var e=this.getHeadElement();if(e){var t=this.createElement("script");t.get_attributes().set_item("type","text/javascript"),t.get_attributes().set_item("src",""),t.canSelfEnd=!1,e.addChild(t)}else C.ULS.sendTraceTag(20248463,339,15,"Could not add MathJax script, no head element found.")},e.prototype.getHeadElement=function(){for(var e=null,t=this.get_ownerDocument().documentElement.get_children().$$lge();t.$$mn();){var n=t.$$cu();"head"===Jn.l.toLower(n.tagName)&&(e=n)}return e},e.prototype.addSplitImage=function(e){var t=(0,f.e)(qI,e);t&&t.isSplitPiece()&&this.splitImageViewBuilder.addImage(t);var n=(0,f.e)(jI,e);n&&n.isPrintout()&&this.splitImageViewBuilder.addFile(n)},e.prototype.addPageMetadata=function(e){if(e){this.getHeadElement();Qc.PageReader.get_instance().isPageNode(e)||C.ULS.sendTraceTag(20248465,339,15,"Could not add PageMetadata, Page node was not given.")}},e.prototype.getHtmlElementForGraphNode=function(e){return this.get_graphDomTree().containsKey(e)&&this.get_graphDomTree().get_item(e)?this.get_graphDomTree().get_item(e).get_htmlElement():null},e.prototype.getOwnerGraphNode=function(e){return this.get_elementToGraphNode().containsKey(e.get_elementId())?this.get_elementToGraphNode().get_item(e.get_elementId()):null},e.prototype.addViewElementToHtmlDocument=function(t,n,r,i){var o=e.getIdFromNode(n),a=n?this.get_graphDomTree().get_item(o):null,s=a?a.get_htmlElement():this.get_ownerDocument().documentElement;r.addToHtmlDocument(s);var l=new Da.GraphIterator,c=rw.getListInfoForBareContentInsideAList(t,l);if(c){var u=rw.removeContentThatBelongsToAList(s);r.getContainingList(l,c,s).addChild(u)}var g=e.getIdFromNode(t);if(this.get_graphDomTree().add(g,r),this.get_saveGraphNodePathInfo()){var p=new Da.GraphIterator;p.setFrom(i),this.get_graphNodePath().containsKey(g)||this.get_graphNodePath().add(g,p),this.get_elementToGraphNode().containsKey(r.get_htmlElement().get_elementId())||this.get_elementToGraphNode().add(r.get_htmlElement().get_elementId(),t)}},e.prototype.constructUrl=function(e,t){return this._uriBuilder?this._uriBuilder.buildResourceUri(e,t):""},e.buildPageHtmlViewWithDefaultDependencies=function(){return new e(new Cw,null)},e.shouldIncludePageMetadata=function(){return!0},e.getIdFromNode=function(e){return(0,f.e)(Kr.n,e)?"GraphSpaceNode":e?e.get_id().toString():"NullNode"},e._roleOrder=[80,2,4,5,1],e}();(0,o.l)(Ew,"PageHtmlView",null,[$I,QI]);var Pw=function(){function e(){}return e.prototype.generateHtmlFromNode=function(e){var t=Ew.buildPageHtmlViewWithDefaultDependencies();return t.bindToRoot(e),VI(t.get_ownerDocument())},e.prototype.generateHtmlFromSingleNode=function(e){var t=Ew.buildPageHtmlViewWithDefaultDependencies();t.bindToRoot(e,!0);var n,r,i=VI(t.get_ownerDocument());do{n=i.length,r=(i=i.replace("![endif] --\x3e\r\n","![endif] --\x3e").replace("![endif] --\x3e\n","![endif] --\x3e").replace("![endif] --\x3e\r","![endif] --\x3e")).length}while(n!==r);var o=i.length;return o>0&&"\n"===i.charAt(o-1)?i.substr(0,o-1):i},e}();(0,o.l)(Pw,"PageHtmlGenerator",null,[AI.p]);var kw=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.PageHtmlRecall"},e.prototype.configure=function(e){e.register(Pw).as(AI.p).singleInstance().usingFactory((function(){return new Pw}))},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(kw,"OneNotePageHtmlRecallPackage",null,[l.u,c.s]);var Dw=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,S.t)(t,e),t.prototype.clearColumnWidth=function(e,t){var n=dc.TableReader.getColumnCount(e);qf.clearColumnWidth_TableLockedColumnsProperty(e,t,n)},t.prototype.setTableAltTextDescription=function(e,t){t&&e.setValue(Kc.b.imageAltText,t)},t.prototype.setTableAltTextTitle=function(e,t){t&&e.setValue(qc.o.imageTitle,t)},t}(qf);(0,o.l)(Dw,"TableEditor",qf,[]);var Mw=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.TableEditors"},e.prototype.configure=function(e){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TableEditorsDelayInitializationEnabled")&&function(e){e.register(Dw).as(cu.z).singleInstance().usingFactory((function(){return new Dw(e.resolve(rc.a),e.resolve(Es.p))}))}(e)},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Mw,"OneNoteTableEditorsPackage",null,[l.u,c.s]);var Rw=function(){function e(){}return e.prototype.get_name=function(){return"OneNote.TextLevelEditors"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(Rw,"OneNoteTextLevelEditorsPackage",null,[l.u,c.s]);window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]};var Lw=(0,o.y)("IInsightsSelection"),Nw=n(1645),Bw=function(){return function(){this.neighborhood=null,this.mentionStart=0,this.mentionLength=0}}();(0,o.l)(Bw,"InsightsParameters",null,[]);var Ow=function(){function e(e){void 0===e&&(e=2e3),this._maxLength=0,this._maxLength=e}return e.prototype.isCurrentSelectionValidForInsights=function(){var t=e.getCurrentSelection();return this.isValidForInsights(t)},e.prototype.isValidForInsights=function(e){return this.getSelectedTextFromSelection(e).mentionLength>0},e.prototype.getSelectedText=function(){var t=e.getCurrentSelection();return this.getSelectedTextFromSelection(t)},e.prototype.getSelectedTextFromSelection=function(e){if(e&&e.get_containsSingleContext()&&Pa.SelectionEditor.isInsertionPointContext(e.get_firstContext())&&Pa.SelectionEditor.isSelectionExpandableToWord(e.get_firstContext())&&(C.ULS.sendTraceTag(17944729,1303,50,"Selection was an insertion point, expanding to word"),e=Pa.SelectionEditor.expandSelectionToWordBoundary(e.get_firstContext(),!1)),!e)return(0,O.m)(new Bw,{neighborhood:"",mentionStart:0,mentionLength:0});for(var t=new Sys.StringBuilder,n=0,r=0,i=[],o=e.get_length(),a=0;a<o;a++){var s=e.get_item(a);if(cs.ParagraphReader.isParagraphNode(s.get_node())&&!Array.contains(i,s.get_node().get_uniqueKey())){i.push(s.get_node().get_uniqueKey());var l=cs.ParagraphReader.text(s.get_node()),c=a===o-1;a||-1===s.get_cpBegin()||(n=s.get_cpBegin()),r+=c&&-1!==s.get_cpEnd()?s.get_cpEnd():l.length,t.append(l),c||(t.append(" "),r++)}}for(var u=hc.AParagraphNode.removeObjectSymbols(t.toString()," ");n<r&&Jn.l.isWhitespace(u.charCodeAt(n));)n++;for(;r>n&&Jn.l.isWhitespace(u.charCodeAt(r-1));)r--;return this.adjustSelectionToMaxLength(u,n,r)},e.prototype.adjustSelectionToMaxLength=function(e,t,n){if(e.length>this._maxLength){var r=n-t;if(r>this._maxLength)e=e.substr(t,this._maxLength),n=this._maxLength,t=0;else{var i=this._maxLength-r,o=Math.max(t-Math.floor(i/2),0),a=Math.min(n+Math.floor(i/2),e.length);a=Math.min(o+this._maxLength,e.length),t-=o=Math.max(a-this._maxLength,0),n-=o,e=e.substring(o,a)}}return(0,O.m)(new Bw,{neighborhood:e,mentionStart:t,mentionLength:n-t})},e.getCurrentSelection=function(){var e=Br.App.get_activeAppFrame().workspace.get_contentView();if(!e)return C.ULS.sendTraceTag(38548897,1303,50,"ContentView is null"),null;var t=e.get_selectionManager();return t&&t.get_selectionCollection()&&t.get_selectionCollection().get_length()?t.get_selectionCollection().get_currentSelection():(C.ULS.sendTraceTag(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)},e}();(0,o.l)(Ow,"Box4InsightsSelection",null,[Nw.g,Lw]);var Uw=function(){function e(){}return e.prototype.get_name=function(){return"Box4.Insights"},e.prototype.init=function(){},e.prototype.dispose=function(){},e.prototype.configure=function(e){e.register(Ow).as(Lw).as(Nw.g).singleInstance().usingFactory((function(){return new Ow}))},e}();(0,o.l)(Uw,"Box4InsightsPackage",null,[l.u,c.s]);var Hw=(0,o.y)("IInsightsManager"),Gw=function(){function e(){}return e.paneLocation=2,e.panePosition=1,e.paneTitle=CommonUIStrings.L_SmartLookupPaneTitle,e.taskPaneID="InsightsTaskPane",e.taskPaneResourceID="InsightsTaskPaneData",e.iFrameElementID="InsightsContentFrame",e.width=400,e.messageApplicationPropertiesRequest="ApplicationPropertiesRequest",e.messageSelectionRequest="SelectionRequest",e.messagePageRendered="PageRendered",e.messageApplicationProperties="ApplicationProperties",e.messageSelection="Selection",e.messageNewInsightsRequest="NewInsightsRequest",e.messageTelemetry="Telemetry",e.messageTakeFocus="TakeFocus",e.messageLostFocus="LostFocus",e.messageKeyboard="Keyboard",e.messageLegalAgreed="LegalAgreed",e.wordWacAppName="WordWac",e.oneNoteWacAppName="OneNoteWAC",e.parentalControlYes="yes",e.telemetryFieldAppCorrelationId="appCorrelationId",e.telemetryFieldClientCorrelationId="clientCorrelationId",e.telemetryFieldMessage="message",e.legalAgreedStorageKey="Microsoft::Office::Insights::LegalAgreed",e}();(0,o.l)(Gw,"InsightsConstants",null,[]);var Vw=function(){return function(){this.landingTab=null,this.data=null}}();(0,o.l)(Vw,"LaunchData",null,[]);var Ww=n(4564),zw=n(4022),Kw=function(){function e(e,t,n,r){this._insightsManager=null,this._actionManager=null,this._focusManager=null,this._f6Manager=null,this._insightsManager=e,this._actionManager=t||L.AFrameworkApplication.get_theActionManager(),this._f6Manager=n,this._focusManager=r,this.initializeFocusScopesAndF6Management()}return e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(te.MN,nt.a,o.i(this,this.showInsights,"showInsights"),64),this._actionManager.addActionWithFlags(te.Nj,nt.a,o.i(this,this.showInsightsForTellMe,"showInsightsForTellMe"),64),this._actionManager.addActionWithFlags(te.AY,nt.a,o.i(this,this.showDefinitions,"showDefinitions"),64),this._actionManager.addActionWithFlags(te.SY,nt.a,o.i(this,this.showDefinitionsForTellMe,"showDefinitionsForTellMe"),64),this._actionManager.addActionWithFlags(te.Qx,nt.a,o.i(this,this.showInsightsForSuggestion,"showInsightsForSuggestion"),64),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableNativePane")&&(this._actionManager.addActionWithFlags(te.dw,nt.a,o.i(this,this.invokeSmartLookupPane,"invokeSmartLookupPane"),64),this._actionManager.addActionWithFlags(te.wy,nt.a,o.i(this,this.invokeFilesSerplet,"invokeFilesSerplet"),64))},e.prototype.showInsights=function(t,n,r,i,o){if(1===r)return this._insightsManager.get_value().isInsightsAvailableForSelection()?32:8;var a=e.getAppCorrelationId(),s=this._insightsManager.get_value().getInsightsSelection(),l=null;if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableNativePane")){var c=(0,O.m)(new zw.g,{neighborhood:s.neighborhood,mentionStart:s.mentionStart,mentionLength:s.mentionLength});return l=(0,O.m)(new Ww.o,{selection:c,userIntent:null,entryPoint:0,launchData:null}),this.executeShowInsights(o,null,l,a,0)}return this.executeShowInsights(o,s,null,a,0)},e.prototype.showDefinitions=function(t,n,r,i,o){if(1===r)return this._insightsManager.get_value().isInsightsAvailableForSelection()?32:8;var a=e.getAppCorrelationId(),s=this._insightsManager.get_value().getInsightsSelection();return this.executeShowInsights(o,s,null,a,1)},e.prototype.showInsightsForTellMe=function(e,t,n,r,i){return 1===n?32:this.executeShowInsightsForTellMe(i,0)},e.prototype.showDefinitionsForTellMe=function(e,t,n,r,i){return 1===n?32:this.executeShowInsightsForTellMe(i,1)},e.prototype.executeShowInsightsForTellMe=function(t,n){var r,i=e.getAppCorrelationId(),o=t.CommandValueId;try{r=w.d(o)}catch(t){return C.ULS.sendTraceTag(6295941,1303,15,e.formatTraceMessage(String.format("Insights parameters [{0}] is not in proper format.",o),i)),8}return this.executeShowInsights(t,r,null,i,n)},e.prototype.showInsightsForSuggestion=function(t,n,r,i,o){if(1===r)return 32;var a=o;if(!a)return 8;var s=a.query?a.query:"",l=e.getAppCorrelationId(),c=new Bw;return c.neighborhood=s,c.mentionStart=0,c.mentionLength=s.length,this.executeShowInsights(o,c,null,l,0)},e.prototype.executeShowInsights=function(t,n,r,i,o){var a=t?t.SourceControlId:"shortcut";return C.ULS.sendTraceTag(6403776,1303,50,e.formatTraceMessage("Show insights",i,{controlId:a})),n?this._insightsManager.get_value().showInsightsPane(n,i,o):r&&this._insightsManager.get_value().showInsightsPaneSerplet(r,i,o),32},e.prototype.invokeSmartLookupPane=function(t,n,r,i,o){if(1===r)return 32;var a=o;if(!a)return 8;var s=e.getAppCorrelationId(),l=a.CommandValueId;if(l)try{a=w.d(l)}catch(e){return C.ULS.sendTraceTag(51700099,1313,15,"SmartLookup application interface [{0}] is not in proper format",l),8}var c=a;if(!a.selection)if(a.neighborhood)c=(0,O.m)(new Ww.o,{selection:a});else{var u=this._insightsManager.get_value().getInsightsSelection();c.selection=(0,O.m)(new zw.g,{neighborhood:u.neighborhood,mentionStart:u.mentionStart,mentionLength:u.mentionLength})}return this.executeShowInsights(o,null,c,s,0)},e.prototype.invokeFilesSerplet=function(e,t,n,r,i){return this.invokeSmartLookupPane(e,t,n,r,(0,O.m)(new Ww.o,{selection:(0,O.m)(new zw.g,{neighborhood:"",mentionStart:0,mentionLength:0}),launchData:(0,O.m)(new Vw,{landingTab:"File"}),entryPoint:10}))},e.prototype.initializeFocusScopesAndF6Management=function(){var e=this._focusManager.getScope(Gw.taskPaneID);e.parent=$e.AFrame.mainAppFocusId,e.addSetFocus(o.i(this,this.sendIFrameTakeFocusMessage,"sendIFrameTakeFocusMessage")),this._f6Manager.addF6KeyBindings(Gw.taskPaneID)},e.prototype.sendIFrameTakeFocusMessage=function(e,t){document.activeElement.blur(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactTabbedTaskPaneInfrastructureEnabled()||(this._insightsManager.get_value().setFocusOnPane(),this._insightsManager.get_value().sendInsightsIFrameTakeFocusMessage())},e.prototype.dispose=function(){this._insightsManager.get_value()&&this._insightsManager.get_value().dispose()},e.formatTraceMessage=function(e,t,n){void 0===n&&(n=null);var r={appCorrelationId:t,message:e};if(n)for(var i in n){var o={key:i,value:n[i]};r[o.key]=o.value}return w.w(r)},e.getAppCorrelationId=function(){return ae.l.create().toString()},e}();(0,o.l)(Kw,"InsightsActor",null,[Sys.IDisposable]);var qw=n(1390),jw=function(){function e(){this._container=null,this._actor=null}return e.prototype.get_name=function(){return"Common.App.Insights"},e.prototype.configure=function(e){this._container=e,e.register(Kw).singleInstance().usingFactory((function(){return new Kw(e.resolveLazy(Hw),L.AFrameworkApplication.get_theActionManager(),qw.F6Manager.get_instance(),Nt.FocusManager.instance())}))},e.prototype.init=function(){L.AFrameworkApplication.insightsIsEnabled&&(this._actor=this._container.tryResolve(Kw),this._actor.registerActions())},e.prototype.dispose=function(){this._actor&&this._actor.dispose()},e}();(0,o.l)(jw,"InsightsPackage",null,[l.u,c.s]);var $w=function(){function e(){this._insightsPane=null}return e.prototype.showInsightsPane=function(e,t,n){this._insightsPane||(this._insightsPane=this.createInsightsPane()),this._insightsPane.showPane(e,t,n)},e.prototype.showInsightsPaneSerplet=function(e,t,n){this._insightsPane||(this._insightsPane=this.createInsightsPane()),this._insightsPane.showPaneSerplet(e,t,n)},e.prototype.sendInsightsIFrameTakeFocusMessage=function(){this._insightsPane&&this._insightsPane.sendIFrameTakeFocusMessage()},e.prototype.setFocusOnPane=function(){this._insightsPane&&this._insightsPane.setFocusOnIFrame()},e.prototype.dispose=function(){this._insightsPane&&(this._insightsPane.dispose(),this._insightsPane=null)},e}();(0,o.l)($w,"InsightsManager",null,[Hw,Sys.IDisposable]);var Qw=(0,o.y)("IInsightsPaneHandler"),Jw=n(7123),Xw=function(){function e(){}return e.prototype.createTaskPaneInstance=function(){var e=new Ct.CuiHelper(Za.f.box4ImageBase,Box4Intl.Box4Strings);return Jw.a.get_instance().createTaskPaneFromResource(Gw.taskPaneID,Gw.panePosition,Gw.width,Gw.taskPaneResourceID,e)},e.prototype.showTaskPane=function(e){Jw.a.get_instance().showTaskPane(e)},e.prototype.hideTaskPane=function(e){Jw.a.get_instance().hideTaskPane(e)},e.prototype.disposeTaskPane=function(e){Jw.a.get_instance().disposeTaskPane(Gw.taskPaneID,e)},e}();(0,o.l)(Xw,"OneNoteInsightsPaneHandler",null,[Qw]);var Yw=(0,o.y)("ISearchOAuthManager"),Zw=(0,o.y)("IExecutor"),ex=(0,o.y)("IInsightsPane"),tx=function(e){var t=e.split("-");return t[t.length-1]},nx=function(){var e,t;e=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableEdogSourceLocationOverride")?"EDOG":L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableProdSourceLocationOverride")?"PROD":L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableIntSourceLocationOverride")?"INT":rx(),t=3===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()?"wordwac":2===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()?"pptwac":"excelwac";var n=Kt.i.getCultureInfo(L.AFrameworkApplication.lcid),r=n?n.get_name():"en-us";switch(e){case"INT":return"https://uci.officeapps.live-int.com/OfficeInsights/Agave/Web/main_native_wac.cshtml?isBrowserPane&appName="+t+"&culture="+r;case"EDOG":return"https://uci.edog.officeapps.live.com/OfficeInsights/Agave/Web/main_native_wac.cshtml?isBrowserPane&appName="+t+"&culture="+r;case"PROD":default:return"https://uci.officeapps.live.com/OfficeInsights/Agave/Web/main_native_wac.cshtml?isBrowserPane&appName="+t+"&culture="+r}},rx=function(){switch((0,f.e)(String,L.AFrameworkApplication.sessionStartInfoSettings.AudienceGroup)||""){case"Dogfood":if(L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableSKITeamDogfood")){var e=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName");e=Jn.l.toLower(e);var t=L.AFrameworkApplication.appSettingsManager.containsAppSetting("SmartLookupINTEnabledForSKITeam")?L.AFrameworkApplication.appSettingsManager.getListAppSetting("SmartLookupINTEnabledForSKITeam"):new Array(0);return Array.indexOf(t,e)>=0?"INT":"EDOG"}return"EDOG";case"Microsoft":case"Production":default:return"PROD"}},ix=function(){switch(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IntentSvcEnableProdSourceLocationOverride")?"PROD":L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IntentSvcEnableIntSourceLocationOverride")?"INT":rx()){case"INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case"EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";case"PROD":default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}},ox=function(){return function(){}}();(0,o.l)(ox,"BrowserPaneDataField",null,[]);var ax=function(){return function(){}}();(0,o.l)(ax,"BrowserPaneTelemetryEvent",null,[]);var sx=n(9429),lx=n(616),cx=function(){function e(){}return e.sendLaunchActivity=function(t){var n=new ax;n.eventName="LaunchPane",n.isActivity=!0;var r=new Array(0),i=new ox;i.name="AppCorrelationId",i.dataType=0,i.value=t,Array.add(r,i),n.dataFields=r,e.sendTelemetryEvent(n)},e.sendTelemetryEvent=function(t){var n=e.telemetryEventNamePrefix+t.eventName,r=e.getDataFields(t.dataFields);if(t.isActivity){var i=(0,O.m)(new lx.z,{name:n,samplingPolicy:2,dataFields:r});Sl.k.sendActivityEvent(i)}else{var o=(0,O.m)(new Tl.y,{name:n,samplingPolicy:2,dataFields:r});Sl.k.sendTelemetryEvent(o)}},e.getDataFields=function(t){for(var n=new Array(0),r=0,i=t;r<i.length;r++){var o=i[r],a=sx.j.getDataField(o.name,o.value,e.convertTypeToOtelValueType(o.dataType));a&&Array.add(n,a)}return n},e.convertTypeToOtelValueType=function(e){switch(e){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}},e.telemetryEventNamePrefix="Office.Insights.SmartLookup.",e}();(0,o.l)(cx,"TelemetryUtils",null,[]);var ux=function(){return function(){}}();(0,o.l)(ux,"ApplicationProperties",null,[]);var gx=function(){return function(){}}();(0,o.l)(gx,"ConfigurationProvider",null,[]);var px=function(){return function(){}}();(0,o.l)(px,"EnterpriseUserInfo",null,[]);var dx=function(){return function(){}}();(0,o.l)(dx,"FeatureGates",null,[]);var hx=function(){function e(t,n,r,i,o){if(void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=!0),this._hostRuntime=null,this._insightsParameters=null,this._searchInterface=null,this._appCorrelationId=null,this._focusManager=null,this._m_oAuthManager=null,this.m_featureGates=null,this.m_isEnterpriseUser=!1,this.m_shredderServiceEndpoint=null,this.m_tenantRoot=null,this.m_upn=null,this._isSerpletPane=!1,this._focusManager=t,this._isSerpletPane=o,this._isSerpletPane){var a=(0,O.m)(new gx,{channelId:e.channelId,approvedOriginPattern:L.AFrameworkApplication.appSettingsManager.getStringAppSetting("SmartLookupApprovedOriginPattern")}),s=new y.c(Zw);n&&s.add(n),r&&s.add(r),i&&s.add(i),this._hostRuntime=SmartLookupHostRuntime.setup(a,s.toArray(),!0);var l=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SerpletEnableNewOAuthIsEnabled");this.m_featureGates=new dx,this.m_featureGates.EnableAllTabV2=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableAllTabV2"),this.m_featureGates.EnableIntentService=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableIntentService"),this.m_featureGates.EnableInDocumentSearch=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableInDocumentSearch"),this.m_featureGates.EnableLocalSearch=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SmartLookupEnableLocalSearch"),this.m_featureGates.IntentServiceEndpoint=ix(),this.m_featureGates.SmartLookupBrowserPaneActionsEnabled=!0,this.m_featureGates.DisableFilesTab=!l,this.m_featureGates.EnableNewOAuth=l,this._m_oAuthManager=se.w.get_instance().resolve(Yw),this.m_isEnterpriseUser=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsTellMeUpSellEnterpriseEnabled"),this.m_shredderServiceEndpoint=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("SmartLookupShredderServiceEndpoint"),this.m_tenantRoot=tt.n.getHostname(L.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppCatalogUrl")||""),this.m_upn=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName"),this.getShredderTokenSync()}}return e.prototype.onIFrameMessage=function(e){var t=this;if(this._isSerpletPane){var n,r=e.rawEvent;try{n=w.d(r.data)}catch(e){return void C.ULS.sendTraceTag(595161728,1303,15,this.formatTraceMessage("Message data from Serplet [{0}] failed to deserialize.",r.data))}switch(n.actionType){case 101:n.data=this.getSmartLookupApplicationProperties(),this.postMessageToIFrame(n);break;case 118:this._searchInterface?n.data=this._searchInterface:n.data=(0,O.m)(new Ww.o,{selection:(0,O.m)(new zw.g,{neighborhood:this._insightsParameters.neighborhood,mentionStart:this._insightsParameters.mentionStart,mentionLength:this._insightsParameters.mentionLength})}),this.postMessageToIFrame(n),this._searchInterface=null;break;case 103:var i=w.d((0,f.e)(String,n.data));cx.sendTelemetryEvent(i);break;case 206:var o=n.data;this.getTokenFor(o).then((function(e){n.data=e,t.postMessageToIFrame(n)}))}}},e.prototype.getSmartLookupApplicationProperties=function(){var e=new ux;e.anid="",3===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()?e.applicationName="WORD":e.applicationName="POWERPNT",e.applicationVersion=L.AFrameworkApplication.buildVersion,e.appCorrelationId=this._appCorrelationId,e.themePlatform="web",e.lcid=L.AFrameworkApplication.lcid,e.launchUtcTime=(new Date).toUTCString(),e.featureGates=this.m_featureGates;var t=Kt.i.getCultureInfo(L.AFrameworkApplication.lcid),n=t?t.get_name():null;e.market=tx(n),e.uiLanguage=n,e.sessionId=L.AFrameworkApplication.userSessionId,e.themeId=5,e.parentalControl="yes",e.accessToken=this.getShredderTokenSync();var r=new px;return r.CountryCode=tx(n),r.ServiceEndpoint=this.m_shredderServiceEndpoint,r.IsGoLocal=!1,r.IsEnabled=this.m_isEnterpriseUser,r.IsEnterpriseEnabled=this.m_isEnterpriseUser,r.TenantRoot=this.m_tenantRoot,r.Upn=this.m_upn,e.enterpriseUserInfo=r,e},e.prototype.getShredderTokenSync=function(){return this._m_oAuthManager?this._m_oAuthManager.getTokenIfAvailable("SmartLookup",this.m_shredderServiceEndpoint):""},e.prototype.getTokenFor=function(e){return this._m_oAuthManager?this._m_oAuthManager.getToken("SmartLookup",e):Promise.resolve("")},e.channelId="SmartLookup",e}();(0,o.l)(hx,"BaseSmartLookupPane",null,[ex,Sys.IDisposable]);var _x=function(){return function(e){this.messageType=null,this.messageType=e}}();(0,o.l)(_x,"InsightsMessage",null,[]);var mx=function(e){function t(n,r,i){var a=e.call(this,r)||this;return o.m(a,t.$$(n)),a.messageContent=o.c(o.f(a,"Common.App.Insights.InsightsMessageWithContent$1").T),a.messageContent=i,a}return(0,S.t)(t,e),t.$$=function(e){var n="InsightsMessageWithContent$1$"+e.getName(),r=o.x(n);return r||o.u(n,"Common.App.Insights.InsightsMessageWithContent$1",t,[{T:e}],_x,[])},t}(_x),fx=function(){return function(){}}();(0,o.l)(fx,"InsightsMessageContentAppProperties",null,[]);var yx=function(e){function t(t){return e.call(this,fx,Gw.messageApplicationProperties,t)||this}return(0,S.t)(t,e),t}(mx);(0,o.l)(yx,"InsightsMessageAppProperties",mx.$$(fx),[]);var Cx=function(e){function t(t){return e.call(this,Bw,Gw.messageSelection,t)||this}return(0,S.t)(t,e),t}(mx);(0,o.l)(Cx,"InsightsMessageSelection",mx.$$(Bw),[]);var Sx=function(e){function t(){return e.call(this,Gw.messageTakeFocus)||this}return(0,S.t)(t,e),t}(_x);(0,o.l)(Sx,"InsightsMessageTakeFocus",_x,[]);var vx=function(e){function t(t,n,r,i,o,a,s,l){void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=null),void 0===l&&(l=!0);var c=e.call(this,r,o,a,s,l)||this;return c._taskPane=null,c._insightsPaneHandler=null,c._innerIFrame=null,c._iFrameSrcInsights=null,c._clientCorrelationId=null,c._paneIsRendered=!1,c._f6Manager=null,c._ariaNotifier=null,c._defaultInsightsPane=0,c._insightsPaneHandler=t,c._iFrameSrcInsights=c._isSerpletPane?nx():L.AFrameworkApplication.insightsUrl,c.buildTaskPane(),c.registerIFrameEvents(),c._f6Manager=n,c._ariaNotifier=i,c._defaultInsightsPane=0,c}return(0,S.t)(t,e),t.prototype.buildTaskPane=function(){var e=this;this._taskPane=this._insightsPaneHandler.createTaskPaneInstance(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactTabbedTaskPaneInfrastructureEnabled()&&this._taskPane.registerOnTaskPaneShown((function(t){t===e._taskPane&&(e.setFocusOnIFrame(),e.sendIFrameTakeFocusMessage())}));var t=this._taskPane.get_stretchedGroup().get_bodyElement();this.initializeIFrame(t),this._taskPane.pollForStateAndUpdate()},t.prototype.initializeIFrame=function(e){e.style.overflow="hidden";var t=Bi.n.createElement("iframe");Sys.UI.DomElement.addCssClass(t,"InsightsPaneIFrame"),t.setAttribute("Unselectable","off"),this._innerIFrame=t,e.appendChild(this._innerIFrame),this._innerIFrame.id=Gw.iFrameElementID},t.prototype.registerIFrameEvents=function(){qo.n.addHandler(this._innerIFrame,"load",o.i(this,this.onIFrameLoad,"onIFrameLoad")),qo.n.addHandler(this._innerIFrame,"error",o.i(this,this.onIFrameError,"onIFrameError")),$addHandler(window,"message",o.i(this,this.onIFrameMessage,"onIFrameMessage"))},t.prototype.unregisterIFrameEvents=function(){qo.n.removeHandler(this._innerIFrame,"load",o.i(this,this.onIFrameLoad,"onIFrameLoad")),qo.n.removeHandler(this._innerIFrame,"error",o.i(this,this.onIFrameError,"onIFrameError")),$removeHandler(window,"message",o.i(this,this.onIFrameMessage,"onIFrameMessage"))},t.prototype.dispose=function(){this._innerIFrame&&(this.unregisterIFrameEvents(),this._innerIFrame.parentNode.removeChild(this._innerIFrame),this._innerIFrame=null),this._taskPane&&(this._insightsPaneHandler.disposeTaskPane(this._taskPane),this._taskPane=null)},t.prototype.showPane=function(e,n,r){this._appCorrelationId=n,this._clientCorrelationId=null,this._defaultInsightsPane=r,this._paneIsRendered=!1,C.ULS.sendTraceTag(6295947,1303,50,this.formatTraceMessage("Start to show Insights")),this._insightsParameters=e,this._iFrameSrcInsights&&this._iFrameSrcInsights.length?this._innerIFrame.src=this._iFrameSrcInsights:(this._innerIFrame.src=t.nullIFrameSrc,C.ULS.sendTraceTag(6295948,1303,15,this.formatTraceMessage("The Insights URL config setting is null or empty"))),this._ariaNotifier.sendNotification(CommonUIStrings.l_InsightsPaneNotification,!0),this._taskPane.get_isTaskPaneVisible()||this._taskPane.registerOnTaskPaneHidden(o.i(this,this.onInsightsTaskPaneHidden,"onInsightsTaskPaneHidden")),this._insightsPaneHandler.showTaskPane(this._taskPane),this._taskPane.pollForStateAndUpdate(),this._isSerpletPane&&cx.sendLaunchActivity(this._appCorrelationId)},t.prototype.showPaneSerplet=function(e,t,n){this._searchInterface=e,this.showPane((0,O.m)(new Bw,{neighborhood:e.selection.neighborhood,mentionStart:e.selection.mentionStart,mentionLength:e.selection.mentionLength}),t,n)},t.prototype.sendIFrameTakeFocusMessage=function(){this._innerIFrame.src===this._iFrameSrcInsights&&this._paneIsRendered&&(this._focusManager.setScope(Gw.taskPaneID),this.postMessageToIFrame(new Sx))},t.prototype.setFocusOnIFrame=function(){this._innerIFrame&&Nt.FocusManager.tryFocus(this._innerIFrame.contentWindow)},t.prototype.deallocateSpaceForPaneContents=function(){this._innerIFrame.src=t.nullIFrameSrc,this._taskPane.refreshInternal()},t.prototype.hidePane=function(){this._insightsPaneHandler.hideTaskPane(this._taskPane),this.deallocateSpaceForPaneContents()},t.prototype.onInsightsTaskPaneHidden=function(e){e===this._taskPane&&this.hidePane()},t.prototype.onIFrameLoad=function(e){C.ULS.sendTraceTag(6295951,1303,50,this.formatTraceMessage("The iframe is successfully loaded in Insights task pane"))},t.prototype.onIFrameError=function(e){C.ULS.sendTraceTag(6295952,1303,15,this.formatTraceMessage("The iframe failed to load in Insights task pane"))},t.prototype.onIFrameMessage=function(t){var n=t.rawEvent;if(n.source===this._innerIFrame.contentWindow)if(this._isSerpletPane)e.prototype.onIFrameMessage.call(this,t);else{var r=void 0;try{r=w.d(n.data)}catch(e){return void C.ULS.sendTraceTag(6295953,1303,15,this.formatTraceMessage("Message data [{0}] failed to deserialize.",n.data))}if(Li.x(r.messageType))return void C.ULS.sendTraceTag(6295954,1303,15,this.formatTraceMessage("Message data [{0}] is in wrong format.",n.data));switch(r.messageType){case Gw.messageApplicationPropertiesRequest:this.postMessageToIFrame(new yx(this.getInsightsApplicationProperties()));break;case Gw.messageSelectionRequest:this.postMessageToIFrame(new Cx(this._insightsParameters));break;case Gw.messagePageRendered:this._paneIsRendered=!0,this.setFocusOnIFrame(),this.sendIFrameTakeFocusMessage(),C.ULS.sendTraceTag(6295955,1303,50,this.formatTraceMessage("Insights pane rendering is completed"));break;case Gw.messageTelemetry:var i=r.messageContent;this._clientCorrelationId=i.clientCorrelationId,this._appCorrelationId!==i.appCorrelationId&&C.ULS.sendTraceTag(6403778,1303,15,this.formatTraceMessage("App correlation ID on client {0} does not match one on server {1}",this._appCorrelationId,i.appCorrelationId));break;case Gw.messageLostFocus:r.messageContent?(G.y.get_isFirefox()&&document.activeElement.blur(),this._f6Manager.handleF6Shift(0,null,2,null,null),C.ULS.sendTraceTag(6604741,1303,50,this.formatTraceMessage("Insights UX lost focus through Ctrl + Shift + F6"))):(this._f6Manager.handleF6(0,null,2,null,null),C.ULS.sendTraceTag(6604742,1303,50,this.formatTraceMessage("Insights UX lost focus through Ctrl + F6")));break;case Gw.messageKeyboard:(i=r.messageContent).keyCode===Je.v.vK_Esc&&this.hidePane();break;case Gw.messageLegalAgreed:try{this._paneIsRendered=!1,localStorage.setItem(Gw.legalAgreedStorageKey,"true")}catch(e){C.ULS.sendTraceTag(17961859,1303,10,this.formatTraceMessage("Failed to SetItem in LocalStorage for LegalAgreed"))}}}},t.prototype.getInsightsApplicationProperties=function(){var e={anid:"00000000-0000-0000-0000-000000000000"};e.appCorrelationId=this._appCorrelationId,3===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()?e.applicationName=Gw.wordWacAppName:4===L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()&&(e.applicationName=Gw.oneNoteWacAppName),e.applicationVersion=L.AFrameworkApplication.buildVersion;var t=Kt.i.getCultureInfo(L.AFrameworkApplication.lcid),n=t?t.get_name():null;return e.market=tx(n),e.uiLanguage=n,e.sessionId=L.AFrameworkApplication.userSessionId,e.parentalControl=Gw.parentalControlYes,e.clientType="user",e.legalAgreed=this.getLegalAgreed(),e.defaultDefineTab=1===this._defaultInsightsPane?"true":null,e},t.prototype.formatTraceMessage=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r={};return this._appCorrelationId&&(r[Gw.telemetryFieldAppCorrelationId]=this._appCorrelationId),this._clientCorrelationId&&(r[Gw.telemetryFieldClientCorrelationId]=this._clientCorrelationId),r[Gw.telemetryFieldMessage]=String.format.apply(null,[e].concat(t)),w.w(r)},t.prototype.getLegalAgreed=function(){try{var e=localStorage.getItem(Gw.legalAgreedStorageKey);return!!e&&"true"===e}catch(e){return C.ULS.sendTraceTag(17961860,1303,10,this.formatTraceMessage("Failed to GetItem in LocalStorage for LegalAgreed")),!1}},t.prototype.postMessageToIFrame=function(e){var t=w.w(e);this._innerIFrame.contentWindow.postMessage(t,tt.n.getOrigin(this._iFrameSrcInsights))},t.nullIFrameSrc="about:blank",t}(hx);(0,o.l)(vx,"InsightsPane",hx,[]);var bx=function(e){function t(t){var n=e.call(this)||this;return n._selection=null,n._selection=t,n}return(0,S.t)(t,e),t.prototype.createInsightsPane=function(){return new vx(new Xw,qw.F6Manager.get_instance(),Nt.FocusManager.instance(),se.w.get_instance().resolve(Ta.u),null,null,null,!1)},t.prototype.getInsightsSelection=function(){return this._selection.getSelectedText()},t.prototype.isInsightsAvailableForSelection=function(){return this._selection.isCurrentSelectionValidForInsights()},t}($w);(0,o.l)(bx,"OneNoteInsightsManager",$w,[]);var Tx=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.get_name=function(){return"OneNote.Insights"},t.prototype.configure=function(t){e.prototype.configure.call(this,t),t.register(Ow).as(Lw).as(Nw.g).singleInstance().usingFactory((function(){return new Ow})),t.register(bx).as(Hw).singleInstance().usingFactory((function(){return new bx(t.resolve(Lw))}))},t}(jw);(0,o.l)(Tx,"OneNoteInsightsPackage",jw,[]);window.OneNoteJewelRibbonData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"jewelOneNote",LabelText:"STR@L_JewelText",TextDirection:"STR@L_RibbonOptionTextDirection",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewel"},children:[{name:"MenuSection",attrs:{Id:"msJewel",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlJewels"},children:[{name:"Button",attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@one@CloseFileMenuOneNote_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"faInfo",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelInfo"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Info"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnjOpenInClient",LabelText:"STR@L_EditInOneNote",Description:"STR@L_OpenInRichClientDescription",Image48by48:"IMGMAP@one@OneNote_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInOneNoteKeytip"}},{name:"Button",attrs:{Id:"btnjCopyToCloud",LabelText:"STR@L_CopyNotebook",Description:"STR@L_CopyToCloudDescription",Image48by48:"IMGMAP@one@Copy_48x48x32",Command:"0x1DD19043",Keytip:"STR@l_CopyNotebookKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faPrint",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelPrint"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnPrint",LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@one@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faSaveAs",LabelText:"STR@L_SaveAs",Command:"0x2F9A3D80"},children:[{name:"Menu",attrs:{Id:"menuJewelSaveAs"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_SaveAs"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnONSaveToSharePoint",LabelText:"STR@L_SaveAs",Description:"STR@L_SaveACopyOnline",Image48by48:"IMGMAP@one@Copy_48x48x32",Command:"0x39DEAAC7"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faShare",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelShare"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnFileSharing",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",Image48by48:"IMGMAP@one@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faAbout",LabelText:"STR@L_About",Command:"0x2F9A3D80",Keytip:"STR@l_AboutKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelAbout"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_About"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnjTryOffice",LabelText:"STR@L_TryOffice",Description:"STR@L_TryOfficeDescription",Image48by48:"IMGMAP@one@TryOffice_48x48x32",Command:"0x69B75DF3",Keytip:"STR@l_TryOfficeKeytip"}},{name:"Button",attrs:{Id:"btnjTryMacOffice",LabelText:"STR@L_TryMacOffice",Description:"STR@L_TryMacOfficeDescription",Image48by48:"IMGMAP@one@TryOffice_48x48x32",Command:"0xE8879142",Keytip:"STR@l_TryMacOfficeKeytip"}},{name:"Button",attrs:{Id:"jbtnTermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@one@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"jbtnThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@one@Info_48x48x32",Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}},{name:"Button",attrs:{Id:"jbtnPrivacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",Image48by48:"IMGMAP@one@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"jbtnTrustCenter",LabelText:"STR@l_TrustCenter",Description:"STR@l_TrustCenterDescription",Image48by48:"IMGMAP@one@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"AboutInformationMenuSectionDiagnostics",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblDiagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},{name:"TextBox",attrs:{Id:"lblDiagnosticsSessionId",LabelText:"STR@L_DiagnosticsSessionId",QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"lblDiagnosticsBuildVersion",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faHelp",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelHelp"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnHelp",LabelText:"STR@L_HelpButtonTitle",Description:"STR@L_HelpButtonDescription",Image48by48:"IMGMAP@one@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpButtonTitleKeytip"}},{name:"Button",attrs:{Id:"jbtnGiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@one@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Id:"jbtnReportAbuse",LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@one@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"msJewelSecondary",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlJewelSecondary"},children:[{name:"Button",attrs:{Id:"btnjClose",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]}]},window.OneNoteRibbonData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Jewel",attrs:{Alt:"STR@L_JewelText",Id:"jewelOneNote",LabelText:"STR@L_JewelText",TextDirection:"STR@L_RibbonOptionTextDirection",Keytip:"STR@l_JewelTextKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewel"},children:[{name:"MenuSection",attrs:{Id:"msJewel",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlJewels"},children:[{name:"Button",attrs:{Alt:"STR@L_CloseMenu",Id:"jbtnBackArrow",Image32by32:"IMGMAP@one@CloseFileMenuOneNote_32x32x32",Command:"0x2F9A3D80"}},{name:"FlyoutAnchor",attrs:{Id:"faInfo",LabelText:"STR@L_Info",Command:"0x2F9A3D80",Keytip:"STR@l_InfoKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelInfo"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Info"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnjOpenInClient",LabelText:"STR@L_EditInOneNote",Description:"STR@L_OpenInRichClientDescription",Image48by48:"IMGMAP@one@OneNote_48x48x32",Command:"0xD5DF198A",Keytip:"STR@l_EditInOneNoteKeytip"}},{name:"Button",attrs:{Id:"btnjCopyToCloud",LabelText:"STR@L_CopyNotebook",Description:"STR@L_CopyToCloudDescription",Image48by48:"IMGMAP@one@Copy_48x48x32",Command:"0x1DD19043",Keytip:"STR@l_CopyNotebookKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faPrint",LabelText:"STR@L_Print",Command:"0x2F9A3D80",Keytip:"STR@l_PrintKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelPrint"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Print"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnPrint",LabelText:"STR@L_Print",Description:"STR@L_PrintDescription",Image48by48:"IMGMAP@one@Print_48x48x32",Command:"0x5EAF6CA5",Keytip:"STR@l_PrintKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faShare",LabelText:"STR@L_Share",Command:"0x2F9A3D80",Keytip:"STR@l_ShareKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelShare"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Share"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnFileSharing",LabelText:"STR@L_ShareWithPeople",Description:"STR@L_ShareWithPeopleDescription",Image48by48:"IMGMAP@one@ShareDoc_48x48x32",Command:"0x3A7DFAA4",Keytip:"STR@l_ShareWithPeopleKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faAbout",LabelText:"STR@L_About",Command:"0x2F9A3D80",Keytip:"STR@l_AboutKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelAbout"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_About"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnjTryOffice",LabelText:"STR@L_TryOffice",Description:"STR@L_TryOfficeDescription",Image48by48:"IMGMAP@one@TryOffice_48x48x32",Command:"0x69B75DF3",Keytip:"STR@l_TryOfficeKeytip"}},{name:"Button",attrs:{Id:"btnjTryMacOffice",LabelText:"STR@L_TryMacOffice",Description:"STR@L_TryMacOfficeDescription",Image48by48:"IMGMAP@one@TryOffice_48x48x32",Command:"0xE8879142",Keytip:"STR@l_TryMacOfficeKeytip"}},{name:"Button",attrs:{Id:"jbtnTermsOfUse",LabelText:"STR@L_TermsOfUse",Description:"STR@L_TermsOfUseDescription",Image48by48:"IMGMAP@one@Info_48x48x32",Command:"0x8C0EBBB3",Keytip:"STR@l_TermsOfUseKeytip"}},{name:"Button",attrs:{Id:"jbtnThirdPartyNotices",LabelText:"STR@l_ThirdPartyNotices",Description:"STR@l_ThirdPartyNoticesDescription",Image48by48:"IMGMAP@one@Info_48x48x32",Command:"0x8458E357",Keytip:"STR@l_ThirdPartyNoticesKeytip"}},{name:"Button",attrs:{Id:"jbtnPrivacy",LabelText:"STR@L_Privacy",Description:"STR@L_PrivacyDescription",Image48by48:"IMGMAP@one@ProtectForm_48x48x32",Command:"0x48091446",Keytip:"STR@l_PrivacyKeytip"}},{name:"Button",attrs:{Id:"jbtnTrustCenter",LabelText:"STR@l_TrustCenter",Description:"STR@l_TrustCenterDescription",Image48by48:"IMGMAP@one@ProtectForm_48x48x32",Command:"0x9A00EB4E",Keytip:"STR@l_TrustCenterKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"AboutInformationMenuSectionDiagnostics",ShowMenuSectionSeparator:"false",DisplayMode:"MenuDiagnostics"},children:[{name:"Controls",attrs:{},children:[{name:"Label",attrs:{Id:"lblDiagnostics",LabelText:"STR@L_Diagnostics",Description:"STR@L_DiagnosticsDescription",LabelCss:"padding-bottom: 12px; padding-top: 0px;"}},{name:"TextBox",attrs:{Id:"lblDiagnosticsSessionId",LabelText:"STR@L_DiagnosticsSessionId",QueryCommand:"0xA67B8E1D",ControlCss:"padding-top: 0px; padding-bottom: 0px;"}},{name:"TextBox",attrs:{Id:"lblDiagnosticsBuildVersion",LabelText:"STR@L_DiagnosticsBuild",QueryCommand:"0xE6F12176",ControlCss:"padding-top: 0px;"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"faHelp",LabelText:"STR@L_Help",Command:"0x2F9A3D80",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Menu",attrs:{Id:"menuJewelHelp"},children:[{name:"MenuSection",attrs:{DisplayMode:"Menu48",Title:"STR@L_Help"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"jbtnHelp",LabelText:"STR@L_HelpButtonTitle",Description:"STR@L_HelpButtonDescription",Image48by48:"IMGMAP@one@OfficeAssistant_48x48x32",Command:"0x56B04A51",Keytip:"STR@l_HelpButtonTitleKeytip"}},{name:"Button",attrs:{Id:"jbtnGiveFeedback",LabelText:"STR@L_GiveFeedback",Description:"STR@L_GiveFeedbackDescription",Image48by48:"IMGMAP@one@GiveFeedback_48x48x32",Command:"0x2FD6BDE0",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Id:"jbtnReportAbuse",LabelText:"STR@L_ReportAbuse",Description:"STR@L_ReportAbuseDescription",Image48by48:"IMGMAP@one@ReportAbuse_48x48x32",Command:"0xC0F351AE",Keytip:"STR@l_ReportAbuseKeytip"}}]}]}]}]}]}]},{name:"MenuSection",attrs:{Id:"msJewelSecondary",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlJewelSecondary"},children:[{name:"Button",attrs:{Id:"btnjClose",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Keytip:"STR@l_ExitKeytip"}}]}]}]}]},{name:"Ribbon",attrs:{Id:"OneNote",TeamId:"WAC",CommandStateChanged:"0x4DFA6613",CommandToggleRibbonState:"0xA463BFB3",ImageCheckMark:"IMGMAP@one@CheckboxChecked_16x16x32",ImageUncheckMark:"IMGMAP@one@CheckboxUnchecked_16x16x32",ImageDownArrow:"IMGMAP@one@SplitButtonArrow_5x3x32",ImageSideArrow:"IMGMAP@one@SubmenuFlyoutArrow_13x13x32",ImageUpArrow:"IMGMAP@one@RibbonUpArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@one@SplitButtonArrow_8x8x32",ImageUpArrow8by8:"IMGMAP@one@RibbonUpArrow_8x8x32",ImagePinButton:"IMGMAP@one@PushpinNormal_16x16x32",ImageUnpinButton:"IMGMAP@one@UpChevron_16x16x32",PinButtonCommand:"0xA463BFB3",PinButtonTooltip:"STR@L_PinRibbonTooltip",UnpinButtonTooltip:"STR@L_UnpinRibbonTooltip",TextDirection:"STR@L_RibbonOptionTextDirection",LabelText:"STR@L_RibbonLabel"},children:[{name:"Tabs",attrs:{Id:"tabs"},children:[{name:"Tab",attrs:{Id:"tabHome",Description:"",Title:"STR@L_TabHome",Keytip:"STR@l_TabHomeKeytip"},children:[{name:"Scaling",attrs:{},children:[{name:"MaxSize",attrs:{Id:"grpUndoRedo.Scaling.MaxSize",GroupId:"grpUndoRedo",Size:"Small"}},{name:"MaxSize",attrs:{Id:"grpClipboard.Scaling.MaxSize",Sequence:"10",GroupId:"grpClipboard",Size:"LargeMedium"}},{name:"MaxSize",attrs:{Id:"grpClipboardWithFormatPainter.Scaling.MaxSize",Sequence:"10",GroupId:"grpClipboardWithFormatPainter",Size:"LargeMedium"}},{name:"MaxSize",attrs:{Id:"grpBasicText.Scaling.MaxSize",Sequence:"20",GroupId:"grpBasicText",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpStyles.Scaling.MaxSize",Sequence:"30",GroupId:"grpStyles",Size:"5style"}},{name:"MaxSize",attrs:{Id:"grpNoteTags.Scaling.MaxSize",Sequence:"40",GroupId:"grpNoteTags",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpSpelling.Scaling.MaxSize",Sequence:"50",GroupId:"grpSpelling",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpFeedback.Scaling.MaxSize",Sequence:"60",GroupId:"grpFeedback",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpDictation.Scaling.MaxSize",Sequence:"110",GroupId:"grpDictation",Size:"Large"}},{name:"Scale",attrs:{Id:"grpClipboard.Scaling.LargeSmall",Sequence:"70",GroupId:"grpClipboard",Size:"LargeSmall"}},{name:"Scale",attrs:{Id:"grpClipboardWithFormatPainter.Scaling.LargeSmall",Sequence:"70",GroupId:"grpClipboardWithFormatPainter",Size:"LargeSmall"}},{name:"Scale",attrs:{Id:"grpStyles.Scaling.4style",Sequence:"80",GroupId:"grpStyles",Size:"4style"}},{name:"Scale",attrs:{Id:"grpStyles.Scaling.3style",Sequence:"90",GroupId:"grpStyles",Size:"3style"}},{name:"Scale",attrs:{Id:"grpStyles.Scaling.MoreOnly",Sequence:"100",GroupId:"grpStyles",Size:"MoreOnly"}}]},{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"grpUndoRedo",Title:"STR@L_GroupUndoRedo",Template:"tmpUndoRedo"},children:[{name:"Controls",attrs:{Id:"ctrlUndoRedo"},children:[{name:"Button",attrs:{Id:"btnUndo",Command:"0xA66C4568",Image16by16:"IMGMAP@one@Undo_16x16x32",LabelText:"STR@L_Undo",TemplateAlias:"undo",Keytip:"STR@l_UndoKeytip"}},{name:"Button",attrs:{Id:"btnRedo",Command:"0xF957BFBE",Image16by16:"IMGMAP@one@Redo_16x16x32",LabelText:"STR@L_Redo",TemplateAlias:"redo",Keytip:"STR@l_RedoKeytip"}}]}]},{name:"Group",attrs:{Id:"grpClipboard",Description:"",Title:"STR@L_GroupClipboard",Template:"tmpClipboard"},children:[{name:"Controls",attrs:{id:"ctrlClipboard"},children:[{name:"Button",attrs:{Id:"fseaPaste",Command:"0x0E249AB3",IsDefinitive:"true",Image16by16:"IMGMAP@one@Paste_16x16x32",Image32by32:"IMGMAP@one@Paste_32x32x32",LabelText:"STR@L_Paste",TemplateAlias:"paste",Keytip:"STR@l_PasteKeytip"}},{name:"Button",attrs:{Id:"fseaCopy",Command:"0xC9ADDC35",IsDefinitive:"true",Image16by16:"IMGMAP@one@Copy_16x16x32",LabelText:"STR@L_Copy",TemplateAlias:"copy",Keytip:"STR@l_CopyKeytip"}},{name:"Button",attrs:{Id:"fseaCut",Command:"0x89A31DE2",IsDefinitive:"true",Image16by16:"IMGMAP@one@Cut_16x16x32",LabelText:"STR@L_Cut",TemplateAlias:"cut",Keytip:"STR@l_CutKeytip"}}]}]},{name:"Group",attrs:{Id:"grpClipboardWithFormatPainter",Description:"",Title:"STR@L_GroupClipboard",Template:"tmpClipboardWithFormatPainter"},children:[{name:"Controls",attrs:{id:"ctrlClipboard"},children:[{name:"Button",attrs:{Id:"fseaPaste",Command:"0x0E249AB3",IsDefinitive:"true",Image16by16:"IMGMAP@one@Paste_16x16x32",Image32by32:"IMGMAP@one@Paste_32x32x32",LabelText:"STR@L_Paste",TemplateAlias:"paste",Keytip:"STR@l_PasteKeytip"}},{name:"Button",attrs:{Id:"fseaCopy",Command:"0xC9ADDC35",IsDefinitive:"true",Image16by16:"IMGMAP@one@Copy_16x16x32",LabelText:"STR@L_Copy",TemplateAlias:"copy",Keytip:"STR@l_CopyKeytip"}},{name:"Button",attrs:{Id:"fseaCut",Command:"0x89A31DE2",IsDefinitive:"true",Image16by16:"IMGMAP@one@Cut_16x16x32",LabelText:"STR@L_Cut",TemplateAlias:"cut",Keytip:"STR@l_CutKeytip"}},{name:"ToggleButton",attrs:{Id:"fseaFormatPainter",Command:"0x9289CA5F",IsDefinitive:"true",QueryCommand:"0x97A875DC",Image16by16:"IMGMAP@one@FormatPainter_16x16x32",Image32by32:"IMGMAP@one@FormatPainter_32x32x32",LabelText:"STR@L_FormatPainter",TemplateAlias:"formatPainter",Keytip:"STR@l_FormatPainterKeytip"}}]}]},{name:"Group",attrs:{Id:"grpBasicText",Description:"",Title:"STR@L_GroupBasicText",Template:"tmpBasicText"},children:[{name:"Controls",attrs:{},children:[{name:"ComboBox",attrs:{Alt:"STR@L_FontName",Id:"fontName",Command:"0xCC7BD8E3",QueryCommand:"0x48F327A5",Width:"100px",TemplateAlias:"font",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x0AB30E9C",AllowFreeForm:"true",Keytip:"STR@l_FontNameKeytip"}},{name:"ComboBox",attrs:{Alt:"STR@L_FontSize",Id:"fontSize",Command:"0xBFBF8D1A",QueryCommand:"0xE43EEA4E",Width:"30px",TemplateAlias:"fontSize",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0x580E32AF",AllowFreeForm:"true",Keytip:"STR@l_FontSizeKeytip"}},{name:"SplitButton",attrs:{Id:"sbBullets",Command:"0xD3C129A1",QueryCommand:"0xE41E1F87",IsToggleSplit:"true",LabelText:"STR@L_MenuBullets",Image16by16:"IMGMAP@one@Bullets_16x16x32",TemplateAlias:"bullets",Keytip:"STR@l_MenuBulletsKeytip"},children:[{name:"Menu",attrs:{Id:"menuBullets"},children:[{name:"MenuSection",attrs:{Id:"msAllBulletStyles",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlBulletStyles"},children:[{name:"ToggleButton",attrs:{Id:"buttonBulletStyle1",MenuItemId:"buttonBulletStyle1",Command:"0xD3C129A1",QueryCommand:"0xDAF74829",Image16by16:"IMGMAP@one@SolidBullet_16x16x32",LabelText:"STR@L_BulletStyle1",Keytip:"STR@l_BulletStyle1Keytip"}},{name:"ToggleButton",attrs:{Id:"buttonBulletStyle2",MenuItemId:"buttonBulletStyle2",Command:"0xD3C129A1",QueryCommand:"0xC2EDA5FA",Image16by16:"IMGMAP@one@HollowBullet_16x16x32",LabelText:"STR@L_BulletStyle2",Keytip:"STR@l_BulletStyle2Keytip"}},{name:"ToggleButton",attrs:{Id:"buttonBulletStyle3",MenuItemId:"buttonBulletStyle3",Command:"0xD3C129A1",QueryCommand:"0x2046315F",Image16by16:"IMGMAP@one@SquareBullet_16x16x32",LabelText:"STR@L_BulletStyle3",Keytip:"STR@l_BulletStyle3Keytip"}}]}]}]}]},{name:"SplitButton",attrs:{Id:"sbNumbering",Command:"0x83E875AA",QueryCommand:"0xCFEC4235",IsToggleSplit:"true",LabelText:"STR@L_MenuNumbering",Image16by16:"IMGMAP@one@Numbering_16x16x32",TemplateAlias:"numbering",Keytip:"STR@l_MenuNumberingKeytip"},children:[{name:"Menu",attrs:{Id:"menuNumbering"},children:[{name:"MenuSection",attrs:{Id:"msAllNumberStyles",DisplayMode:"Menu"},children:[{name:"Controls",attrs:{Id:"ctrlNumberStyles"},children:[{name:"ToggleButton",attrs:{Id:"buttonNumberStyle1",MenuItemId:"buttonNumberStyle1",Command:"0x83E875AA",QueryCommand:"0x028F909B",LabelText:"STR@L_NumberStyle1"}},{name:"ToggleButton",attrs:{Id:"buttonNumberStyle2",MenuItemId:"buttonNumberStyle2",Command:"0x83E875AA",QueryCommand:"0xEA85EE6C",LabelText:"STR@L_NumberStyle2"}},{name:"ToggleButton",attrs:{Id:"buttonNumberStyle3",MenuItemId:"buttonNumberStyle3",Command:"0x83E875AA",QueryCommand:"0x47DE79D1",LabelText:"STR@L_NumberStyle3"}},{name:"ToggleButton",attrs:{Id:"buttonNumberStyle4",MenuItemId:"buttonNumberStyle4",Command:"0x83E875AA",QueryCommand:"0x1A9932CA",LabelText:"STR@L_NumberStyle4"}},{name:"ToggleButton",attrs:{Id:"buttonNumberStyle5",MenuItemId:"buttonNumberStyle5",Command:"0x83E875AA",QueryCommand:"0x77F1BE2F",LabelText:"STR@L_NumberStyle5"}}]}]}]}]},{name:"Button",attrs:{Id:"fseaClearFormatting",Command:"0x8A46CCCC",Image16by16:"IMGMAP@one@ClearFormatting_16x16x32",LabelText:"STR@L_ClearFormatting",TemplateAlias:"clearformat",Keytip:"STR@l_ClearFormattingKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcBold",Alt:"STR@L_Bold",Command:"0xF6F32311",QueryCommand:"0x575E8BDF",Image16by16:"IMGMAP@one@Bold_16x16x32",TemplateAlias:"bold",Keytip:"STR@l_BoldKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcItalic",Alt:"STR@L_Italic",Command:"0xD4C1657E",QueryCommand:"0xFC350CA2",Image16by16:"IMGMAP@one@Italic_16x16x32",TemplateAlias:"italic",Keytip:"STR@l_ItalicKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcUnderline",Alt:"STR@L_Underline",Command:"0x6F0FAAC6",QueryCommand:"0x89383C62",Image16by16:"IMGMAP@one@Underline_16x16x32",TemplateAlias:"underline",Keytip:"STR@l_UnderlineKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcStrikethrough",Alt:"STR@L_Strikethrough",Command:"0xF87F5805",QueryCommand:"0xA3731E4F",Image16by16:"IMGMAP@one@Strikethrough2Server_16x16x32",LabelText:"STR@L_Strikethrough",TemplateAlias:"strikethrough",Keytip:"STR@l_StrikethroughKeytip"}},{name:"SplitButton",attrs:{Id:"sbSubscript",Alt:"STR@L_Subscript",Command:"0x56BFC40F",LabelText:"STR@L_Subscript",QueryCommand:"0x702E26CB",IsToggleSplit:"true",Image16by16:"IMGMAP@one@Subscript_16x16x32",TemplateAlias:"subscript",Keytip:"STR@l_SubscriptKeytip"},children:[{name:"Menu",attrs:{Id:"menuSubscript"},children:[{name:"MenuSection",attrs:{Id:"msSubscript",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msSubscript.Controls"},children:[{name:"ToggleButton",attrs:{Id:"fsbcSubscript",Command:"0x56BFC40F",QueryCommand:"0xEC0CB24D",Image16by16:"IMGMAP@one@Subscript_16x16x32",LabelText:"STR@L_Subscript",Keytip:"STR@l_SubscriptKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcSuperscript",Command:"0x0010E69E",QueryCommand:"0x294CD86A",Image16by16:"IMGMAP@one@Superscript_16x16x32",LabelText:"STR@L_Superscript",Keytip:"STR@l_SuperscriptKeytip"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"fontColor",Command:"0x568463EB",Image16by16:"IMGMAP@one@FontColorServer_16x16x32",LabelText:"STR@L_MenuFontColor",TemplateAlias:"fontColor",Keytip:"STR@l_MenuFontColorKeytip"},children:[{name:"Menu",attrs:{Id:"menuFontColor"},children:[{name:"MenuSection",attrs:{Id:"fontColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0xD0232D5B",LabelText:"STR@L_Automatic",Id:"automatic",Image16by16:"IMGMAP@one@Automatic_16x16x32",Keytip:"STR@l_AutomaticKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"Colors"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontColor",Command:"0x7577CA82",McuLayout:"true",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"FFFFFF",DisplayColor:"#FFFFFF",Alt:"STR@L_FontColorWhite"}},{name:"Color",attrs:{Color:"000000",DisplayColor:"#000000",Alt:"STR@L_FontColorBlack"}},{name:"Color",attrs:{Color:"E1ECEE",DisplayColor:"#EEECE1",Alt:"STR@L_FontColorTan"}},{name:"Color",attrs:{Color:"7D491F",DisplayColor:"#1F497D",Alt:"STR@L_FontColorDarkBlue"}},{name:"Color",attrs:{Color:"BD814F",DisplayColor:"#4F81BD",Alt:"STR@L_FontColorBlue"}},{name:"Color",attrs:{Color:"4D50C0",DisplayColor:"#C0504D",Alt:"STR@L_FontColorRed"}},{name:"Color",attrs:{Color:"59BB9B",DisplayColor:"#9BBB59",Alt:"STR@L_FontColorOliveGreen"}},{name:"Color",attrs:{Color:"A26480",DisplayColor:"#8064A2",Alt:"STR@L_FontColorPurple"}},{name:"Color",attrs:{Color:"C6AC4B",DisplayColor:"#4BACC6",Alt:"STR@L_FontColorAqua"}},{name:"Color",attrs:{Color:"4696F7",DisplayColor:"#F79646",Alt:"STR@L_FontColorOrange"}},{name:"Color",attrs:{Color:"F2F2F2",DisplayColor:"#F2F2F2",Alt:"STR@L_FontColorWhiteDarker5pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorBlackLighter50pct"}},{name:"Color",attrs:{Color:"C3D9DD",DisplayColor:"#DDD9C3",Alt:"STR@L_FontColorTanDarker10pct"}},{name:"Color",attrs:{Color:"F0D9C6",DisplayColor:"#C6D9F0",Alt:"STR@L_FontColorDarkBlueLighter80pct"}},{name:"Color",attrs:{Color:"F1E5DB",DisplayColor:"#DBE5F1",Alt:"STR@L_FontColorBlueLighter80pct"}},{name:"Color",attrs:{Color:"DBDCF2",DisplayColor:"#F2DCDB",Alt:"STR@L_FontColorRedLighter80pct"}},{name:"Color",attrs:{Color:"DDF1EB",DisplayColor:"#EBF1DD",Alt:"STR@L_FontColorOliveGreenLighter80pct"}},{name:"Color",attrs:{Color:"ECE0E5",DisplayColor:"#E5E0EC",Alt:"STR@L_FontColorPurpleLighter80pct"}},{name:"Color",attrs:{Color:"F3EEDB",DisplayColor:"#DBEEF3",Alt:"STR@L_FontColorAquaLighter80pct"}},{name:"Color",attrs:{Color:"DAEAFD",DisplayColor:"#FDEADA",Alt:"STR@L_FontColorOrangeLighter80pct"}},{name:"Color",attrs:{Color:"D8D8D8",DisplayColor:"#D8D8D8",Alt:"STR@L_FontColorWhiteDarker15pct"}},{name:"Color",attrs:{Color:"595959",DisplayColor:"#595959",Alt:"STR@L_FontColorBlackLighter35pct"}},{name:"Color",attrs:{Color:"97BDC4",DisplayColor:"#C4BD97",Alt:"STR@L_FontColorTanDarker25pct"}},{name:"Color",attrs:{Color:"E2B38D",DisplayColor:"#8DB3E2",Alt:"STR@L_FontColorDarkBlueLighter60pct"}},{name:"Color",attrs:{Color:"E4CCB8",DisplayColor:"#B8CCE4",Alt:"STR@L_FontColorBlueLighter60pct"}},{name:"Color",attrs:{Color:"B7B9E5",DisplayColor:"#E5B9B7",Alt:"STR@L_FontColorRedLighter60pct"}},{name:"Color",attrs:{Color:"BCE3D7",DisplayColor:"#D7E3BC",Alt:"STR@L_FontColorOliveGreenLighter60pct"}},{name:"Color",attrs:{Color:"D9C1CC",DisplayColor:"#CCC1D9",Alt:"STR@L_FontColorPurpleLighter60pct"}},{name:"Color",attrs:{Color:"E8DDB7",DisplayColor:"#B7DDE8",Alt:"STR@L_FontColorAquaLighter60pct"}},{name:"Color",attrs:{Color:"B5D5FB",DisplayColor:"#FBD5B5",Alt:"STR@L_FontColorOrangeLighter60pct"}},{name:"Color",attrs:{Color:"BFBFBF",DisplayColor:"#BFBFBF",Alt:"STR@L_FontColorWhiteDarker25pct"}},{name:"Color",attrs:{Color:"3F3F3F",DisplayColor:"#3F3F3F",Alt:"STR@L_FontColorBlackLighter25pct"}},{name:"Color",attrs:{Color:"538993",DisplayColor:"#938953",Alt:"STR@L_FontColorTanDarker50pct"}},{name:"Color",attrs:{Color:"D48D54",DisplayColor:"#548DD4",Alt:"STR@L_FontColorDarkBlueLighter40pct"}},{name:"Color",attrs:{Color:"D7B395",DisplayColor:"#95B3D7",Alt:"STR@L_FontColorBlueLighter40pct"}},{name:"Color",attrs:{Color:"9496D9",DisplayColor:"#D99694",Alt:"STR@L_FontColorRedLighter40pct"}},{name:"Color",attrs:{Color:"9BD6C3",DisplayColor:"#C3D69B",Alt:"STR@L_FontColorOliveGreenLighter40pct"}},{name:"Color",attrs:{Color:"C7A2B2",DisplayColor:"#B2A2C7",Alt:"STR@L_FontColorPurpleLighter40pct"}},{name:"Color",attrs:{Color:"DCCD92",DisplayColor:"#92CDDC",Alt:"STR@L_FontColorAquaLighter40pct"}},{name:"Color",attrs:{Color:"8FC0FA",DisplayColor:"#FAC08F",Alt:"STR@L_FontColorOrangeLighter40pct"}},{name:"Color",attrs:{Color:"A5A5A5",DisplayColor:"#A5A5A5",Alt:"STR@L_FontColorWhiteDarker35pct"}},{name:"Color",attrs:{Color:"262626",DisplayColor:"#262626",Alt:"STR@L_FontColorBlackLighter15pct"}},{name:"Color",attrs:{Color:"294449",DisplayColor:"#494429",Alt:"STR@L_FontColorTanDarker75pct"}},{name:"Color",attrs:{Color:"5D3617",DisplayColor:"#17365D",Alt:"STR@L_FontColorDarkBlueDarker25pct"}},{name:"Color",attrs:{Color:"926036",DisplayColor:"#366092",Alt:"STR@L_FontColorBlueDarker25pct"}},{name:"Color",attrs:{Color:"343795",DisplayColor:"#953734",Alt:"STR@L_FontColorRedDarker25pct"}},{name:"Color",attrs:{Color:"3C9276",DisplayColor:"#76923C",Alt:"STR@L_FontColorOliveGreenDarker25pct"}},{name:"Color",attrs:{Color:"7A495F",DisplayColor:"#5F497A",Alt:"STR@L_FontColorPurpleDarker25pct"}},{name:"Color",attrs:{Color:"9B8431",DisplayColor:"#31849B",Alt:"STR@L_FontColorAquaDarker25pct"}},{name:"Color",attrs:{Color:"096CE3",DisplayColor:"#E36C09",Alt:"STR@L_FontColorOrangeDarker25pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorWhiteDarker50pct"}},{name:"Color",attrs:{Color:"0C0C0C",DisplayColor:"#0C0C0C",Alt:"STR@L_FontColorBlackLighter5pct"}},{name:"Color",attrs:{Color:"101B1D",DisplayColor:"#1D1B10",Alt:"STR@L_FontColorTanDarker90pct"}},{name:"Color",attrs:{Color:"3E240F",DisplayColor:"#0F243E",Alt:"STR@L_FontColorDarkBlueDarker50pct"}},{name:"Color",attrs:{Color:"614024",DisplayColor:"#244061",Alt:"STR@L_FontColorBlueDarker50pct"}},{name:"Color",attrs:{Color:"232463",DisplayColor:"#632423",Alt:"STR@L_FontColorRedDarker50pct"}},{name:"Color",attrs:{Color:"28614F",DisplayColor:"#4F6128",Alt:"STR@L_FontColorOliveGreenDarker50pct"}},{name:"Color",attrs:{Color:"51313F",DisplayColor:"#3F3151",Alt:"STR@L_FontColorPurpleDarker50pct"}},{name:"Color",attrs:{Color:"675820",DisplayColor:"#205867",Alt:"STR@L_FontColorAquaDarker50pct"}},{name:"Color",attrs:{Color:"064898",DisplayColor:"#984806",Alt:"STR@L_FontColorOrangeDarker50pct"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"fontColor",Title:"STR@L_MenuStandardColors"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontColor",Command:"0x7577CA82",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"0000C0",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#C00000"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"00C0FF",Alt:"STR@L_FontColorOrange",DisplayColor:"#FFC000"}},{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"50D092",Alt:"STR@L_FontColorLightGreen",DisplayColor:"#92D050"}},{name:"Color",attrs:{Color:"50B000",Alt:"STR@L_FontColorDarkGreen",DisplayColor:"#00B050"}},{name:"Color",attrs:{Color:"F0B000",Alt:"STR@L_FontColorLightBlue",DisplayColor:"#00B0F0"}},{name:"Color",attrs:{Color:"C07000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0070C0"}},{name:"Color",attrs:{Color:"602000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#002060"}},{name:"Color",attrs:{Color:"A03070",Alt:"STR@L_FontColorPurple",DisplayColor:"#7030A0"}}]}]}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"fontBackgroundColor",Command:"0x568463EB",Image16by16:"IMGMAP@one@HighlightWithColor_16x16x32",LabelText:"STR@L_MenuHighlightColor",TemplateAlias:"fontBackgroundColor",Keytip:"STR@l_MenuHighlightColorKeytip"},children:[{name:"Menu",attrs:{Id:"menuFontBackgroundColor"},children:[{name:"MenuSection",attrs:{Id:"fontBackgroundColor"},children:[{name:"Controls",attrs:{Id:"Background.Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontBackgroundColor",Command:"0x6A55FB2A",Width:"5"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"00FF00",Alt:"STR@L_FontColorGreen",DisplayColor:"#00FF00"}},{name:"Color",attrs:{Color:"FFFF00",Alt:"STR@L_FontColorCyan",DisplayColor:"#00FFFF"}},{name:"Color",attrs:{Color:"FF00FF",Alt:"STR@L_FontColorMagenta",DisplayColor:"#FF00FF"}},{name:"Color",attrs:{Color:"FF0000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0000FF"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"800000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#000080"}},{name:"Color",attrs:{Color:"808000",Alt:"STR@L_FontColorDarkCyan",DisplayColor:"#008080"}},{name:"Color",attrs:{Color:"008000",Alt:"STR@L_FontColorDarkGreenHighlight",DisplayColor:"#008000"}},{name:"Color",attrs:{Color:"800080",Alt:"STR@L_FontColorDarkMagenta",DisplayColor:"#800080"}},{name:"Color",attrs:{Color:"000080",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#800000"}},{name:"Color",attrs:{Color:"008080",Alt:"STR@L_FontColorDarkYellow",DisplayColor:"#808000"}},{name:"Color",attrs:{Color:"808080",Alt:"STR@L_FontColorGrey",DisplayColor:"#808080"}},{name:"Color",attrs:{Color:"C0C0C0",Alt:"STR@L_FontColorLightGrey",DisplayColor:"#C0C0C0"}},{name:"Color",attrs:{Color:"000000",Alt:"STR@L_FontColorBlack",DisplayColor:"#000000"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"noFontBackgroundColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"No.Background.Font.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0x2184F4E5",Id:"none",LabelText:"STR@L_NoHighlight",Image16by16:"IMGMAP@one@NoHighlight_16x16x32",Keytip:"STR@l_NoHighlightKeytip"}}]}]}]}]},{name:"Button",attrs:{Id:"fseaOutdent",Command:"0xC93B4FD0",QueryCommand:"0x5F5719F6",Image16by16:"IMGMAP@one@Outdent_16x16x32",LabelText:"STR@L_DecreaseIndent",TemplateAlias:"outdent",Keytip:"STR@l_DecreaseIndentKeytip"}},{name:"Button",attrs:{Id:"fseaIndent",Command:"0xF2CCFEC4",QueryCommand:"0x9EFAB6C2",Image16by16:"IMGMAP@one@Indent_16x16x32",LabelText:"STR@L_IncreaseIndent",TemplateAlias:"indent",Keytip:"STR@l_IncreaseIndentKeytip"}},{name:"FlyoutAnchor",attrs:{Id:"faAlignment",Command:"0x568463EB",LabelText:"STR@L_MenuAlignment",Image16by16:"IMGMAP@one@LeftJustify_16x16x32",TemplateAlias:"alignment",Keytip:"STR@l_MenuAlignmentKeytip"},children:[{name:"Menu",attrs:{Id:"menuAlignment"},children:[{name:"MenuSection",attrs:{Id:"msAlignment",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msAlignment.Controls"},children:[{name:"ToggleButton",attrs:{Id:"LeftJustify",Command:"0x9757E6E5",QueryCommand:"0xE25D77A3",Image16by16:"IMGMAP@one@LeftJustify_16x16x32",LabelText:"STR@L_AlignTextLeft",Keytip:"STR@l_AlignTextLeftKeytip"}},{name:"ToggleButton",attrs:{Id:"CenterJustify",Command:"0xFF58B829",QueryCommand:"0xC27E85BB",Image16by16:"IMGMAP@one@Centered_16x16x32",LabelText:"STR@L_JustifyCenter",Keytip:"STR@l_JustifyCenterKeytip"}},{name:"ToggleButton",attrs:{Id:"RightJustify",Command:"0x17730524",QueryCommand:"0x776E8734",Image16by16:"IMGMAP@one@RightJustify_16x16x32",LabelText:"STR@L_AlignTextRight",Keytip:"STR@l_AlignTextRightKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"msAlignmentLTR",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msAlignmentLTR.Controls"},children:[{name:"ToggleButton",attrs:{Id:"TextDirLTR",Command:"0x374EAE00",QueryCommand:"0x44D4414A",Image16by16:"IMGMAP@one@Ltr_16x16x32",LabelText:"STR@L_TextDirLTR",Keytip:"STR@l_TextDirLTRKeytip"}},{name:"ToggleButton",attrs:{Id:"TextDirRTL",Command:"0x9CE9DEE0",QueryCommand:"0x44D43E8A",Image16by16:"IMGMAP@one@Rtl_16x16x32",LabelText:"STR@L_TextDirRTL",Keytip:"STR@l_TextDirRTLKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"msParagraphSpacing",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msParagraphSpacing.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyLineSpacing",Image16by16:"IMGMAP@one@LineSpacing_16x16x32",LabelText:"STR@L_ParagraphSpacing",Command:"0x84728D66",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0xA7F94AB4",TemplateAlias:"lineSpacing",Keytip:"STR@l_LineSpacingKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpStyles",Description:"",Title:"STR@L_GroupStyles",Template:"tmpStyles"},children:[{name:"Controls",attrs:{},children:[{name:"GalleryButton",attrs:{Id:"buttonStyle0",Command:"0x3E088D63",QueryCommand:"0xBA30CCB1",InnerHTML:"",ElementDimensions:"Size64by48",TemplateAlias:"style0"}},{name:"GalleryButton",attrs:{Id:"buttonStyle1",Command:"0x3E088D63",QueryCommand:"0xBA30CCB1",InnerHTML:"",ElementDimensions:"Size64by48",TemplateAlias:"style1"}},{name:"GalleryButton",attrs:{Id:"buttonStyle2",Command:"0x3E088D63",QueryCommand:"0xBA30CCB1",InnerHTML:"",ElementDimensions:"Size64by48",TemplateAlias:"style2"}},{name:"GalleryButton",attrs:{Id:"buttonStyle3",Command:"0x3E088D63",QueryCommand:"0xBA30CCB1",InnerHTML:"",ElementDimensions:"Size64by48",TemplateAlias:"style3"}},{name:"GalleryButton",attrs:{Id:"buttonStyle4",Command:"0x3E088D63",QueryCommand:"0xBA30CCB1",InnerHTML:"",ElementDimensions:"Size64by48",TemplateAlias:"style4"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_MenuMoreStyles",Id:"fsfaMoreStyles",Command:"0x3E088D63",LabelText:"STR@L_MenuMoreStyles",Image32by32:"IMGMAP@one@UxGalWordQuickFormats_32x32x32",TemplateAlias:"morestyles",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x289E9560",Keytip:"STR@l_MenuMoreStylesKeytip"}}]}]},{name:"Group",attrs:{Id:"grpNoteTags",Description:"",Title:"STR@L_GroupTags",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpNoteTags.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyNoteTags",Alt:"STR@L_NoteTags",Image32by32:"IMGMAP@one@NoteTagsServer_32x32x32",LabelText:"STR@L_NoteTags",Command:"0x6C71CE19",TemplateAlias:"button1",Keytip:"STR@l_NoteTagsKeytip"},children:[{name:"Menu",attrs:{Id:"menuNoteTags"},children:[{name:"MenuSection",attrs:{Id:"msNoteTagCommands",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlNoteTagCommands"},children:[{name:"Button",attrs:{Id:"buttonNoteTagRemoveAll",Command:"0x5C016681",Image16by16:"IMGMAP@one@JotActionItemRemoveAll_16x16x32",LabelText:"STR@L_NoteTagRemove",Keytip:"STR@l_NoteTagRemoveKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"msNoteTagInsert",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlNoteTagInsert"},children:[{name:"Button",attrs:{Id:"NT0",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@3_16_M_16x16x32",LabelText:"STR@l_NoteTag_0"}},{name:"Button",attrs:{Id:"NT1",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@13_16_N_16x16x32",LabelText:"STR@l_NoteTag_1"}},{name:"Button",attrs:{Id:"NT2",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@15_16_N_16x16x32",LabelText:"STR@l_NoteTag_2"}},{name:"Button",attrs:{Id:"NT3",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@NoteTagNoShape_16x16x32",LabelText:"STR@l_NoteTag_3"}},{name:"Button",attrs:{Id:"NT4",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@NoteTagNoShape_16x16x32",LabelText:"STR@l_NoteTag_4"}},{name:"Button",attrs:{Id:"NT5",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@136_16_N_16x16x32",LabelText:"STR@l_NoteTag_5"}},{name:"Button",attrs:{Id:"NT6",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@118_16_N_16x16x32",LabelText:"STR@l_NoteTag_6"}},{name:"Button",attrs:{Id:"NT7",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@23_16_N_16x16x32",LabelText:"STR@l_NoteTag_7"}},{name:"Button",attrs:{Id:"NT8",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@18_16_N_16x16x32",LabelText:"STR@l_NoteTag_8"}},{name:"Button",attrs:{Id:"NT9",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@125_16_N_16x16x32",LabelText:"STR@l_NoteTag_9"}},{name:"Button",attrs:{Id:"NT10",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@21_16_N_16x16x32",LabelText:"STR@l_NoteTag_10"}},{name:"Button",attrs:{Id:"NT11",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@131_16_N_16x16x32",LabelText:"STR@l_NoteTag_11"}},{name:"Button",attrs:{Id:"NT12",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@17_16_N_16x16x32",LabelText:"STR@l_NoteTag_12"}},{name:"Button",attrs:{Id:"NT13",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@100_16_N_16x16x32",LabelText:"STR@l_NoteTag_13"}},{name:"Button",attrs:{Id:"NT14",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@101_16_N_16x16x32",LabelText:"STR@l_NoteTag_14"}},{name:"Button",attrs:{Id:"NT15",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@122_16_N_16x16x32",LabelText:"STR@l_NoteTag_15"}},{name:"Button",attrs:{Id:"NT16",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@132_16_N_16x16x32",LabelText:"STR@l_NoteTag_16"}},{name:"Button",attrs:{Id:"NT17",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@121_16_N_16x16x32",LabelText:"STR@l_NoteTag_17"}},{name:"Button",attrs:{Id:"NT18",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@125_16_N_16x16x32",LabelText:"STR@l_NoteTag_18"}},{name:"Button",attrs:{Id:"NT19",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@24_16_N_16x16x32",LabelText:"STR@l_NoteTag_19"}},{name:"Button",attrs:{Id:"NT20",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@94_16_M_16x16x32",LabelText:"STR@l_NoteTag_20"}},{name:"Button",attrs:{Id:"NT21",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@94_16_M_16x16x32",LabelText:"STR@l_NoteTag_21"}},{name:"Button",attrs:{Id:"NT22",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@95_16_M_16x16x32",LabelText:"STR@l_NoteTag_22"}},{name:"Button",attrs:{Id:"NT23",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@106_16_N_16x16x32",LabelText:"STR@l_NoteTag_23"}},{name:"Button",attrs:{Id:"NT24",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@12_16_M_16x16x32",LabelText:"STR@l_NoteTag_24"}},{name:"Button",attrs:{Id:"NT25",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@12_16_M_16x16x32",LabelText:"STR@l_NoteTag_25"}},{name:"Button",attrs:{Id:"NT26",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@28_16_M_16x16x32",LabelText:"STR@l_NoteTag_26"}},{name:"Button",attrs:{Id:"NT27",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@71_16_M_16x16x32",LabelText:"STR@l_NoteTag_27"}},{name:"Button",attrs:{Id:"NT28",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@8_16_M_16x16x32",LabelText:"STR@l_NoteTag_28"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpSpelling",Description:"",Title:"STR@L_GroupSpelling",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpSpelling.Controls"},children:[{name:"SplitButton",attrs:{Id:"sbSpelling",Alt:"STR@L_NextSpellingError",LabelText:"STR@L_NextSpellingError",Command:"0x9DBB85E9",Image32by32:"IMGMAP@one@Spelling_32x32x32",TemplateAlias:"button1",Keytip:"STR@l_NextSpellingErrorKeytip"},children:[{name:"Menu",attrs:{Id:"menuSpelling"},children:[{name:"MenuSection",attrs:{Id:"msSpelling",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msSpelling.Controls"},children:[{name:"Button",attrs:{Id:"fseaNextSpellingError",Command:"0x9DBB85E9",Image16by16:"IMGMAP@one@Spelling_16x16x32",LabelText:"STR@L_NextSpellingError",Keytip:"STR@l_NextSpellingErrorKeytip"}},{name:"ToggleButton",attrs:{Alt:"STR@L_HideSpellingErrors",Id:"btnToggleHideSpellingErrors",Command:"0x0D738E90",QueryCommand:"0xC4216F96",LabelText:"STR@L_HideSpellingErrors",Image16by16:"IMGMAP@one@HideProofingErrors_16x16x32",TemplateAlias:"button1",Keytip:"STR@l_HideSpellingErrorsKeytip"}},{name:"Button",attrs:{Id:"fseaOpenLanguageDialog",Command:"0x1E6A53BC",Image16by16:"IMGMAP@one@Language_16x16x32",LabelText:"STR@L_SetLanguageMenu",Keytip:"STR@l_SetLanguageMenuKeytip"}}]}]},{name:"MenuSection",attrs:{Id:"msAutoCorrectOptions",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msAutoCorrectOptions.Controls"},children:[{name:"Button",attrs:{Id:"fseaOpenAutoCorrectOptionsDialog",Command:"0x34812765",Image16by16:"IMGMAP@one@AutoCorrect_16x16x32",LabelText:"STR@L_AutoCorrectOptionsMenu",Keytip:"STR@l_AutoCorrectOptionsKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpDictation",Description:"",Title:"STR@L_Dictation",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{id:"ctrlDictation"},children:[{name:"SplitButton",attrs:{Id:"btnStartDictation",Command:"0x5320AC21",QueryCommand:"0x9017ACFD",IsToggleSplit:"true",LabelText:"STR@L_DictationRibbonLabel",Image32by32:"IMGMAP@one@Insertaudio_32x32x32",Image16by16:"IMGMAP@one@Insertaudio_16x16x32",TemplateAlias:"button1",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0x5C29F6D4",Keytip:"STR@L_DictationKeytip"}}]}]}]}]},{name:"Tab",attrs:{Id:"tabInsert",Title:"STR@L_TabInsert",Keytip:"STR@l_TabInsertKeytip"}},{name:"Tab",attrs:{Id:"tabDraw",Title:"STR@L_TabDraw",Keytip:"STR@l_TabDrawKeytip"}},{name:"Tab",attrs:{Id:"tabView",Title:"STR@L_TabView",Keytip:"STR@l_TabViewKeytip"}},{name:"Tab",attrs:{Id:"tabHelp",Title:"STR@L_Help",Keytip:"STR@l_TabHelpKeytip"}}]},{name:"ContextualTabs",attrs:{Id:"ContextualTabs"},children:[{name:"ContextualGroup",attrs:{Color:"Orange",ContextualGroupId:"cgidAudioToolsGroup",Id:"ContextualTabs.Audio",Command:"0x7A85A4BA",Title:"STR@L_AudioTabTitle"},children:[{name:"Tab",attrs:{Id:"ContextualTabs.Audio.Tools",Title:"STR@L_TabAudio",CssClass:"ONAudioToolsTab",Keytip:"STR@l_TabAudioKeytip"}}]},{name:"ContextualGroup",attrs:{Color:"Magenta",ContextualGroupId:"cgidPictureToolsGroup",Id:"cgrpPictureToolsGroup",Command:"0xD2057E46",Title:"STR@L_TabPictureTools"},children:[{name:"Tab",attrs:{Id:"ctabPictureTools",Title:"STR@L_TabFormatPicture",Keytip:"STR@l_TabFormatPictureKeytip"}}]},{name:"ContextualGroup",attrs:{Color:"Yellow",ContextualGroupId:"cgidTableGroup",Id:"ContextualTabs.Tables",Command:"0x712E133C",Title:"STR@L_TabTableTools"},children:[{name:"Tab",attrs:{Id:"ContextualTabs.Tables.Layout",Title:"STR@L_TabLayout",Keytip:"STR@l_TabLayoutKeytip"}}]}]}]},{name:"Templates",attrs:{},children:[{name:"RibbonTemplates",attrs:{Id:"OneNote.Templates"},children:[{name:"GroupTemplate",attrs:{Id:"tmpAllLarge"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button4",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button5",DisplayMode:"Large"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpUndoRedo"},children:[{name:"Layout",attrs:{Title:"Small"},children:[{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"undo",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"redo",DisplayMode:"Small"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpClipboard"},children:[{name:"Layout",attrs:{Title:"LargeMedium"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"paste",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"cut",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"copy",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"LargeSmall"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"paste",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"cut",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"copy",DisplayMode:"Small"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpClipboardWithFormatPainter"},children:[{name:"Layout",attrs:{Title:"LargeMedium"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"paste",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"cut",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"copy",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"formatPainter",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"LargeSmall"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"paste",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"cut",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"copy",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"formatPainter",DisplayMode:"Small"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpBasicText"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"font",DisplayMode:"Medium"}},{name:"ControlRef",attrs:{TemplateAlias:"fontSize",DisplayMode:"Medium"}},{name:"ControlRef",attrs:{TemplateAlias:"bullets",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"numbering",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"clearformat",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"bold",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"italic",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"underline",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"strikethrough",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"subscript",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"fontBackgroundColor",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"fontColor",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"outdent",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"indent",DisplayMode:"Small"}},{name:"ControlRef",attrs:{TemplateAlias:"alignment",DisplayMode:"Small"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpStyles"},children:[{name:"Layout",attrs:{Title:"5style"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"style0",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style4",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"morestyles",DisplayMode:"Thin"}}]}]}]},{name:"Layout",attrs:{Title:"4style"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"style0",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"morestyles",DisplayMode:"Thin"}}]}]}]},{name:"Layout",attrs:{Title:"3style"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"style0",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"style2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"morestyles",DisplayMode:"Thin"}}]}]}]},{name:"Layout",attrs:{Title:"MoreOnly"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"morestyles",DisplayMode:"Large"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"Ribbon.Templates.AddInCommandsControlGroup"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"addinControl2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"addinControl3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"addinControl4",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"addinControl5",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"addinControl6",DisplayMode:"Large"}}]}]}]},{name:"Layout",attrs:{Title:"Medium"},children:[{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl1",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl3",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl5",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl2",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl4",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl6",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"Small"},children:[{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl1",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl3",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl5",DisplayMode:"Small"}}]}]},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl2",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl4",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl6",DisplayMode:"Small"}}]}]}]},{name:"Layout",attrs:{Title:"MediumTwoRow"},children:[{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl1",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl3",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl2",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl4",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"SmallTwoRow"},children:[{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl1",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl3",DisplayMode:"Small"}}]}]},{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl2",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"addinControl4",DisplayMode:"Small"}}]}]}]}]}]}]}]},window.OneNoteFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"OneNoteFloatie",ImageDownArrow:"IMGMAP@one@SplitButtonArrow_5x3x32",ImageDownArrow8by8:"IMGMAP@one@SplitButtonArrow_8x8x32",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{},children:[{name:"TouchGroup",attrs:{Id:"ClipboardGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"floatiefseaPaste",Command:"0x0E249AB3",IsDefinitive:"true",Image24by24:"IMGMAP@one@Paste_24x24x32",LabelText:"STR@L_Paste",DisplayMode:"FloatieLarge"}},{name:"Button",attrs:{Id:"floatiefseaCut",Command:"0x89A31DE2",IsDefinitive:"true",Image24by24:"IMGMAP@one@Cut_24x24x32",LabelText:"STR@L_Cut",DisplayMode:"FloatieLarge"}},{name:"Button",attrs:{Id:"floatiefseaCopy",Command:"0xC9ADDC35",IsDefinitive:"true",Image24by24:"IMGMAP@one@Copy_24x24x32",LabelText:"STR@L_Copy",DisplayMode:"FloatieLarge"}},{name:"Button",attrs:{Id:"floatiefseaDelete",Command:"0xAC189AA4",IsDefinitive:"true",Image24by24:"IMGMAP@one@Delete_24x24x32",LabelText:"STR@L_Delete",DisplayMode:"FloatieLarge"}}]}]}]}]},{name:"Group",attrs:{Id:"TextFormattingGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"ComboBox",attrs:{Alt:"STR@L_FontName",Id:"floatiefontName",Command:"0xCC7BD8E3",QueryCommand:"0x48F327A5",Width:"90px",DisplayMode:"Medium",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x0AB30E9C",AllowFreeForm:"true"}},{name:"ComboBox",attrs:{Alt:"STR@L_FontSize",Id:"floatiefontSize",Command:"0xBFBF8D1A",QueryCommand:"0xE43EEA4E",Width:"23px",DisplayMode:"Medium",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0x580E32AF",AllowFreeForm:"true"}},{name:"ToggleButton",attrs:{Id:"floatiefseaFormatPainter",Command:"0x9289CA5F",QueryCommand:"0x97A875DC",Image16by16:"IMGMAP@one@FormatPainter_16x16x32",LabelText:"STR@L_FormatPainter",DisplayMode:"Small"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_GroupStyles",Id:"floatiefsfaMoreStyles",Command:"0x3E088D63",Image16by16:"IMGMAP@one@UxGalWordQuickFormats_16x16x32",DisplayMode:"Small",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x289E9560"}},{name:"Button",attrs:{Id:"NT0",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@3_16_M_16x16x32",LabelText:"STR@l_NoteTag_0",DisplayMode:"Small"}},{name:"FlyoutAnchor",attrs:{Id:"floatieflyNoteTags",Alt:"STR@L_NoteTags",Image16by16:"IMGMAP@one@JotNoteTags_16x16x32",LabelText:"STR@L_NoteTags",DisplayMode:"Small",Command:"0x6C71CE19"},children:[{name:"Menu",attrs:{Id:"menuNoteTags"},children:[{name:"MenuSection",attrs:{Id:"floatiemsNoteTagCommands",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlNoteTagCommands"},children:[{name:"Button",attrs:{Id:"floatiebuttonNoteTagRemoveAll",Command:"0x5C016681",Image16by16:"IMGMAP@one@JotActionItemRemoveAll_16x16x32",LabelText:"STR@L_NoteTagRemove"}}]}]},{name:"MenuSection",attrs:{Id:"floatiemsNoteTagInsert",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlNoteTagInsert"},children:[{name:"Button",attrs:{Id:"NT0",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@3_16_M_16x16x32",LabelText:"STR@l_NoteTag_0"}},{name:"Button",attrs:{Id:"NT1",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@13_16_N_16x16x32",LabelText:"STR@l_NoteTag_1"}},{name:"Button",attrs:{Id:"NT2",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@15_16_N_16x16x32",LabelText:"STR@l_NoteTag_2"}},{name:"Button",attrs:{Id:"NT3",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@NoteTagNoShape_16x16x32",LabelText:"STR@l_NoteTag_3"}},{name:"Button",attrs:{Id:"NT4",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@NoteTagNoShape_16x16x32",LabelText:"STR@l_NoteTag_4"}},{name:"Button",attrs:{Id:"NT5",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@136_16_N_16x16x32",LabelText:"STR@l_NoteTag_5"}},{name:"Button",attrs:{Id:"NT6",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@118_16_N_16x16x32",LabelText:"STR@l_NoteTag_6"}},{name:"Button",attrs:{Id:"NT7",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@23_16_N_16x16x32",LabelText:"STR@l_NoteTag_7"}},{name:"Button",attrs:{Id:"NT8",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@18_16_N_16x16x32",LabelText:"STR@l_NoteTag_8"}},{name:"Button",attrs:{Id:"NT9",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@125_16_N_16x16x32",LabelText:"STR@l_NoteTag_9"}},{name:"Button",attrs:{Id:"NT10",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@21_16_N_16x16x32",LabelText:"STR@l_NoteTag_10"}},{name:"Button",attrs:{Id:"NT11",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@131_16_N_16x16x32",LabelText:"STR@l_NoteTag_11"}},{name:"Button",attrs:{Id:"NT12",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@17_16_N_16x16x32",LabelText:"STR@l_NoteTag_12"}},{name:"Button",attrs:{Id:"NT13",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@100_16_N_16x16x32",LabelText:"STR@l_NoteTag_13"}},{name:"Button",attrs:{Id:"NT14",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@101_16_N_16x16x32",LabelText:"STR@l_NoteTag_14"}},{name:"Button",attrs:{Id:"NT15",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@122_16_N_16x16x32",LabelText:"STR@l_NoteTag_15"}},{name:"Button",attrs:{Id:"NT16",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@132_16_N_16x16x32",LabelText:"STR@l_NoteTag_16"}},{name:"Button",attrs:{Id:"NT17",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@121_16_N_16x16x32",LabelText:"STR@l_NoteTag_17"}},{name:"Button",attrs:{Id:"NT18",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@125_16_N_16x16x32",LabelText:"STR@l_NoteTag_18"}},{name:"Button",attrs:{Id:"NT19",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@24_16_N_16x16x32",LabelText:"STR@l_NoteTag_19"}},{name:"Button",attrs:{Id:"NT20",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@94_16_M_16x16x32",LabelText:"STR@l_NoteTag_20"}},{name:"Button",attrs:{Id:"NT21",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@94_16_M_16x16x32",LabelText:"STR@l_NoteTag_21"}},{name:"Button",attrs:{Id:"NT22",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@95_16_M_16x16x32",LabelText:"STR@l_NoteTag_22"}},{name:"Button",attrs:{Id:"NT23",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@106_16_N_16x16x32",LabelText:"STR@l_NoteTag_23"}},{name:"Button",attrs:{Id:"NT24",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@12_16_M_16x16x32",LabelText:"STR@l_NoteTag_24"}},{name:"Button",attrs:{Id:"NT25",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@12_16_M_16x16x32",LabelText:"STR@l_NoteTag_25"}},{name:"Button",attrs:{Id:"NT26",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@28_16_M_16x16x32",LabelText:"STR@l_NoteTag_26"}},{name:"Button",attrs:{Id:"NT27",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@71_16_M_16x16x32",LabelText:"STR@l_NoteTag_27"}},{name:"Button",attrs:{Id:"NT28",Command:"0x1D7E44D9",Image16by16:"IMGMAP@one@8_16_M_16x16x32",LabelText:"STR@l_NoteTag_28"}}]}]}]}]}]}]},{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Id:"floatiefsbcBold",Alt:"STR@L_Bold",Command:"0xF6F32311",QueryCommand:"0x575E8BDF",Image16by16:"IMGMAP@one@Bold_16x16x32",DisplayMode:"Small"}},{name:"ToggleButton",attrs:{Id:"floatiefsbcItalic",Alt:"STR@L_Italic",Command:"0xD4C1657E",QueryCommand:"0xFC350CA2",Image16by16:"IMGMAP@one@Italic_16x16x32",DisplayMode:"Small"}},{name:"ToggleButton",attrs:{Id:"floatiefsbcUnderline",Alt:"STR@L_Underline",Command:"0x6F0FAAC6",QueryCommand:"0x89383C62",Image16by16:"IMGMAP@one@Underline_16x16x32",DisplayMode:"Small"}},{name:"FlyoutAnchor",attrs:{Id:"floatiefontBackgroundColor",Command:"0x568463EB",Image16by16:"IMGMAP@one@HighlightWithColor_16x16x32",LabelText:"STR@L_MenuHighlightColor",DisplayMode:"Small"},children:[{name:"Menu",attrs:{Id:"menuFontBackgroundColor"},children:[{name:"MenuSection",attrs:{Id:"fontBackgroundColor"},children:[{name:"Controls",attrs:{Id:"Background.Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontBackgroundColorTable",Command:"0x6A55FB2A",Width:"5"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"00FF00",Alt:"STR@L_FontColorGreen",DisplayColor:"#00FF00"}},{name:"Color",attrs:{Color:"FFFF00",Alt:"STR@L_FontColorCyan",DisplayColor:"#00FFFF"}},{name:"Color",attrs:{Color:"FF00FF",Alt:"STR@L_FontColorMagenta",DisplayColor:"#FF00FF"}},{name:"Color",attrs:{Color:"FF0000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0000FF"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"800000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#000080"}},{name:"Color",attrs:{Color:"808000",Alt:"STR@L_FontColorDarkCyan",DisplayColor:"#008080"}},{name:"Color",attrs:{Color:"008000",Alt:"STR@L_FontColorDarkGreen",DisplayColor:"#008000"}},{name:"Color",attrs:{Color:"800080",Alt:"STR@L_FontColorDarkMagenta",DisplayColor:"#800080"}},{name:"Color",attrs:{Color:"000080",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#800000"}},{name:"Color",attrs:{Color:"008080",Alt:"STR@L_FontColorDarkYellow",DisplayColor:"#808000"}},{name:"Color",attrs:{Color:"808080",Alt:"STR@L_FontColorGrey",DisplayColor:"#808080"}},{name:"Color",attrs:{Color:"C0C0C0",Alt:"STR@L_FontColorLightGrey",DisplayColor:"#C0C0C0"}},{name:"Color",attrs:{Color:"000000",Alt:"STR@L_FontColorBlack",DisplayColor:"#000000"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"noFontBackgroundColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"No.Background.Font.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0x2184F4E5",Id:"none",LabelText:"STR@L_NoHighlight",Image16by16:"IMGMAP@one@NoHighlight_16x16x32"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Id:"floatiefontColor",Command:"0x568463EB",Image16by16:"IMGMAP@one@FontColorServer_16x16x32",LabelText:"STR@L_MenuFontColor",DisplayMode:"Small"},children:[{name:"Menu",attrs:{Id:"menuFontColor"},children:[{name:"MenuSection",attrs:{Id:"fontColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0xD0232D5B",LabelText:"STR@L_Automatic",Id:"automatic",Image16by16:"IMGMAP@one@Automatic_16x16x32"}}]}]},{name:"MenuSection",attrs:{Id:"fontColor"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontColorTable",Command:"0x7577CA82",McuLayout:"true",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"FFFFFF",DisplayColor:"#FFFFFF",Alt:"STR@L_FontColorWhite"}},{name:"Color",attrs:{Color:"000000",DisplayColor:"#000000",Alt:"STR@L_FontColorBlack"}},{name:"Color",attrs:{Color:"E1ECEE",DisplayColor:"#EEECE1",Alt:"STR@L_FontColorTan"}},{name:"Color",attrs:{Color:"7D491F",DisplayColor:"#1F497D",Alt:"STR@L_FontColorDarkBlue"}},{name:"Color",attrs:{Color:"BD814F",DisplayColor:"#4F81BD",Alt:"STR@L_FontColorBlue"}},{name:"Color",attrs:{Color:"4D50C0",DisplayColor:"#C0504D",Alt:"STR@L_FontColorRed"}},{name:"Color",attrs:{Color:"59BB9B",DisplayColor:"#9BBB59",Alt:"STR@L_FontColorOliveGreen"}},{name:"Color",attrs:{Color:"A26480",DisplayColor:"#8064A2",Alt:"STR@L_FontColorPurple"}},{name:"Color",attrs:{Color:"C6AC4B",DisplayColor:"#4BACC6",Alt:"STR@L_FontColorAqua"}},{name:"Color",attrs:{Color:"4696F7",DisplayColor:"#F79646",Alt:"STR@L_FontColorOrange"}},{name:"Color",attrs:{Color:"F2F2F2",DisplayColor:"#F2F2F2",Alt:"STR@L_FontColorWhiteDarker5pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorBlackLighter50pct"}},{name:"Color",attrs:{Color:"C3D9DD",DisplayColor:"#DDD9C3",Alt:"STR@L_FontColorTanDarker10pct"}},{name:"Color",attrs:{Color:"F0D9C6",DisplayColor:"#C6D9F0",Alt:"STR@L_FontColorDarkBlueLighter80pct"}},{name:"Color",attrs:{Color:"F1E5DB",DisplayColor:"#DBE5F1",Alt:"STR@L_FontColorBlueLighter80pct"}},{name:"Color",attrs:{Color:"DBDCF2",DisplayColor:"#F2DCDB",Alt:"STR@L_FontColorRedLighter80pct"}},{name:"Color",attrs:{Color:"DDF1EB",DisplayColor:"#EBF1DD",Alt:"STR@L_FontColorOliveGreenLighter80pct"}},{name:"Color",attrs:{Color:"ECE0E5",DisplayColor:"#E5E0EC",Alt:"STR@L_FontColorPurpleLighter80pct"}},{name:"Color",attrs:{Color:"F3EEDB",DisplayColor:"#DBEEF3",Alt:"STR@L_FontColorAquaLighter80pct"}},{name:"Color",attrs:{Color:"DAEAFD",DisplayColor:"#FDEADA",Alt:"STR@L_FontColorOrangeLighter80pct"}},{name:"Color",attrs:{Color:"D8D8D8",DisplayColor:"#D8D8D8",Alt:"STR@L_FontColorWhiteDarker15pct"}},{name:"Color",attrs:{Color:"595959",DisplayColor:"#595959",Alt:"STR@L_FontColorBlackLighter35pct"}},{name:"Color",attrs:{Color:"97BDC4",DisplayColor:"#C4BD97",Alt:"STR@L_FontColorTanDarker25pct"}},{name:"Color",attrs:{Color:"E2B38D",DisplayColor:"#8DB3E2",Alt:"STR@L_FontColorDarkBlueLighter60pct"}},{name:"Color",attrs:{Color:"E4CCB8",DisplayColor:"#B8CCE4",Alt:"STR@L_FontColorBlueLighter60pct"}},{name:"Color",attrs:{Color:"B7B9E5",DisplayColor:"#E5B9B7",Alt:"STR@L_FontColorRedLighter60pct"}},{name:"Color",attrs:{Color:"BCE3D7",DisplayColor:"#D7E3BC",Alt:"STR@L_FontColorOliveGreenLighter60pct"}},{name:"Color",attrs:{Color:"D9C1CC",DisplayColor:"#CCC1D9",Alt:"STR@L_FontColorPurpleLighter60pct"}},{name:"Color",attrs:{Color:"E8DDB7",DisplayColor:"#B7DDE8",Alt:"STR@L_FontColorAquaLighter60pct"}},{name:"Color",attrs:{Color:"B5D5FB",DisplayColor:"#FBD5B5",Alt:"STR@L_FontColorOrangeLighter60pct"}},{name:"Color",attrs:{Color:"BFBFBF",DisplayColor:"#BFBFBF",Alt:"STR@L_FontColorWhiteDarker25pct"}},{name:"Color",attrs:{Color:"3F3F3F",DisplayColor:"#3F3F3F",Alt:"STR@L_FontColorBlackLighter25pct"}},{name:"Color",attrs:{Color:"538993",DisplayColor:"#938953",Alt:"STR@L_FontColorTanDarker50pct"}},{name:"Color",attrs:{Color:"D48D54",DisplayColor:"#548DD4",Alt:"STR@L_FontColorDarkBlueLighter40pct"}},{name:"Color",attrs:{Color:"D7B395",DisplayColor:"#95B3D7",Alt:"STR@L_FontColorBlueLighter40pct"}},{name:"Color",attrs:{Color:"9496D9",DisplayColor:"#D99694",Alt:"STR@L_FontColorRedLighter40pct"}},{name:"Color",attrs:{Color:"9BD6C3",DisplayColor:"#C3D69B",Alt:"STR@L_FontColorOliveGreenLighter40pct"}},{name:"Color",attrs:{Color:"C7A2B2",DisplayColor:"#B2A2C7",Alt:"STR@L_FontColorPurpleLighter40pct"}},{name:"Color",attrs:{Color:"DCCD92",DisplayColor:"#92CDDC",Alt:"STR@L_FontColorAquaLighter40pct"}},{name:"Color",attrs:{Color:"8FC0FA",DisplayColor:"#FAC08F",Alt:"STR@L_FontColorOrangeLighter40pct"}},{name:"Color",attrs:{Color:"A5A5A5",DisplayColor:"#A5A5A5",Alt:"STR@L_FontColorWhiteDarker35pct"}},{name:"Color",attrs:{Color:"262626",DisplayColor:"#262626",Alt:"STR@L_FontColorBlackLighter15pct"}},{name:"Color",attrs:{Color:"294449",DisplayColor:"#494429",Alt:"STR@L_FontColorTanDarker75pct"}},{name:"Color",attrs:{Color:"5D3617",DisplayColor:"#17365D",Alt:"STR@L_FontColorDarkBlueDarker25pct"}},{name:"Color",attrs:{Color:"926036",DisplayColor:"#366092",Alt:"STR@L_FontColorBlueDarker25pct"}},{name:"Color",attrs:{Color:"343795",DisplayColor:"#953734",Alt:"STR@L_FontColorRedDarker25pct"}},{name:"Color",attrs:{Color:"3C9276",DisplayColor:"#76923C",Alt:"STR@L_FontColorOliveGreenDarker25pct"}},{name:"Color",attrs:{Color:"7A495F",DisplayColor:"#5F497A",Alt:"STR@L_FontColorPurpleDarker25pct"}},{name:"Color",attrs:{Color:"9B8431",DisplayColor:"#31849B",Alt:"STR@L_FontColorAquaDarker25pct"}},{name:"Color",attrs:{Color:"096CE3",DisplayColor:"#E36C09",Alt:"STR@L_FontColorOrangeDarker25pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorWhiteDarker50pct"}},{name:"Color",attrs:{Color:"0C0C0C",DisplayColor:"#0C0C0C",Alt:"STR@L_FontColorBlackLighter5pct"}},{name:"Color",attrs:{Color:"101B1D",DisplayColor:"#1D1B10",Alt:"STR@L_FontColorTanDarker90pct"}},{name:"Color",attrs:{Color:"3E240F",DisplayColor:"#0F243E",Alt:"STR@L_FontColorDarkBlueDarker50pct"}},{name:"Color",attrs:{Color:"614024",DisplayColor:"#244061",Alt:"STR@L_FontColorBlueDarker50pct"}},{name:"Color",attrs:{Color:"232463",DisplayColor:"#632423",Alt:"STR@L_FontColorRedDarker50pct"}},{name:"Color",attrs:{Color:"28614F",DisplayColor:"#4F6128",Alt:"STR@L_FontColorOliveGreenDarker50pct"}},{name:"Color",attrs:{Color:"51313F",DisplayColor:"#3F3151",Alt:"STR@L_FontColorPurpleDarker50pct"}},{name:"Color",attrs:{Color:"675820",DisplayColor:"#205867",Alt:"STR@L_FontColorAquaDarker50pct"}},{name:"Color",attrs:{Color:"064898",DisplayColor:"#984806",Alt:"STR@L_FontColorOrangeDarker50pct"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"fontStandardColor",Title:"STR@L_MenuStandardColors"},children:[{name:"Controls",attrs:{Id:"Font.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"fontStandardColorTable",Command:"0x7577CA82",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"0000C0",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#C00000"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"00C0FF",Alt:"STR@L_FontColorOrange",DisplayColor:"#FFC000"}},{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"50D092",Alt:"STR@L_FontColorLightGreen",DisplayColor:"#92D050"}},{name:"Color",attrs:{Color:"50B000",Alt:"STR@L_FontColorDarkGreen",DisplayColor:"#00B050"}},{name:"Color",attrs:{Color:"F0B000",Alt:"STR@L_FontColorLightBlue",DisplayColor:"#00B0F0"}},{name:"Color",attrs:{Color:"C07000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0070C0"}},{name:"Color",attrs:{Color:"602000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#002060"}},{name:"Color",attrs:{Color:"A03070",Alt:"STR@L_FontColorPurple",DisplayColor:"#7030A0"}}]}]}]}]}]}]},{name:"SplitButton",attrs:{Id:"floatiesbBullets",Command:"0xD3C129A1",QueryCommand:"0xE41E1F87",IsToggleSplit:"true",LabelText:"STR@L_MenuBullets",Image16by16:"IMGMAP@one@Bullets_16x16x32",DisplayMode:"Small"},children:[{name:"Menu",attrs:{Id:"floatiemenuBullets"},children:[{name:"MenuSection",attrs:{Id:"floatiemsAllBulletStyles",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ctrlBulletStyles"},children:[{name:"ToggleButton",attrs:{Id:"floatiebuttonBulletStyle1",MenuItemId:"buttonBulletStyle1",Command:"0xD3C129A1",QueryCommand:"0xDAF74829",Image16by16:"IMGMAP@one@SolidBullet_16x16x32",LabelText:"STR@L_BulletStyle1"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonBulletStyle2",MenuItemId:"buttonBulletStyle2",Command:"0xD3C129A1",QueryCommand:"0xC2EDA5FA",Image16by16:"IMGMAP@one@HollowBullet_16x16x32",LabelText:"STR@L_BulletStyle2"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonBulletStyle3",MenuItemId:"buttonBulletStyle3",Command:"0xD3C129A1",QueryCommand:"0x2046315F",Image16by16:"IMGMAP@one@SquareBullet_16x16x32",LabelText:"STR@L_BulletStyle3"}}]}]}]}]},{name:"SplitButton",attrs:{Id:"floatiesbNumbering",Command:"0x83E875AA",QueryCommand:"0xCFEC4235",IsToggleSplit:"true",LabelText:"STR@L_MenuNumbering",Image16by16:"IMGMAP@one@Numbering_16x16x32",DisplayMode:"Small"},children:[{name:"Menu",attrs:{Id:"floatiemenuNumbering"},children:[{name:"MenuSection",attrs:{Id:"msAllNumberStyles",DisplayMode:"Menu"},children:[{name:"Controls",attrs:{Id:"floatiectrlNumberStyles"},children:[{name:"ToggleButton",attrs:{Id:"floatiebuttonNumberStyle1",MenuItemId:"buttonNumberStyle1",Command:"0x83E875AA",QueryCommand:"0x028F909B",LabelText:"STR@L_NumberStyle1"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonNumberStyle2",MenuItemId:"buttonNumberStyle2",Command:"0x83E875AA",QueryCommand:"0xEA85EE6C",LabelText:"STR@L_NumberStyle2"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonNumberStyle3",MenuItemId:"buttonNumberStyle3",Command:"0x83E875AA",QueryCommand:"0x47DE79D1",LabelText:"STR@L_NumberStyle3"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonNumberStyle4",MenuItemId:"buttonNumberStyle4",Command:"0x83E875AA",QueryCommand:"0x1A9932CA",LabelText:"STR@L_NumberStyle4"}},{name:"ToggleButton",attrs:{Id:"floatiebuttonNumberStyle5",MenuItemId:"buttonNumberStyle5",Command:"0x83E875AA",QueryCommand:"0x77F1BE2F",LabelText:"STR@L_NumberStyle5"}}]}]}]}]},{name:"Button",attrs:{Id:"floatiefseaOutdent",Command:"0xC93B4FD0",QueryCommand:"0x5F5719F6",Image16by16:"IMGMAP@one@Outdent_16x16x32",LabelText:"STR@L_DecreaseIndent",DisplayMode:"Small"}},{name:"Button",attrs:{Id:"floatiefseaIndent",Command:"0xF2CCFEC4",QueryCommand:"0x9EFAB6C2",Image16by16:"IMGMAP@one@Indent_16x16x32",LabelText:"STR@L_IncreaseIndent",DisplayMode:"Small"}}]}]}]}]},{name:"Group",attrs:{Id:"PictureToolsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"floatiebtnImageGrow",DisplayMode:"FloatieLarge",Command:"0x464C6D12",Image24by24:"IMGMAP@one@IncreaseSize_24x24x32",LabelText:"STR@L_Grow"}},{name:"Button",attrs:{Id:"floatiebtnImageShrink",DisplayMode:"FloatieLarge",Command:"0xF571A3C0",Image24by24:"IMGMAP@one@DecreaseSize_24x24x32",LabelText:"STR@L_Shrink"}},{name:"Button",attrs:{Id:"floatiebtnImageCropDialog",DisplayMode:"FloatieLarge",Command:"0xEF945B15",Image24by24:"IMGMAP@one@Crop_24x24x32",LabelText:"STR@L_Crop"}}]}]}]}]},{name:"Group",attrs:{Id:"TableToolsGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"floatieshadingColor",Command:"0x4DAC4430",Image24by24:"IMGMAP@one@FillColorSplitDropdown_24x24x32",LabelText:"STR@L_MenuShadingColor",DisplayMode:"FloatieLarge"},children:[{name:"Menu",attrs:{Id:"menuCellShadingColor"},children:[{name:"MenuSection",attrs:{Id:"cellShadingColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0xC33DA1AE",LabelText:"STR@L_BtnClearShading",Id:"clear",Image16by16:"IMGMAP@one@NoHighlight_16x16x32"}}]}]},{name:"MenuSection",attrs:{Id:"cellShadingColor"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"cellShadingColorTable",Command:"0xA4D47B93",McuLayout:"true",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"FFFFFF",DisplayColor:"#FFFFFF",Alt:"STR@L_FontColorWhite"}},{name:"Color",attrs:{Color:"000000",DisplayColor:"#000000",Alt:"STR@L_FontColorBlack"}},{name:"Color",attrs:{Color:"E1ECEE",DisplayColor:"#EEECE1",Alt:"STR@L_FontColorTan"}},{name:"Color",attrs:{Color:"7D491F",DisplayColor:"#1F497D",Alt:"STR@L_FontColorDarkBlue"}},{name:"Color",attrs:{Color:"BD814F",DisplayColor:"#4F81BD",Alt:"STR@L_FontColorBlue"}},{name:"Color",attrs:{Color:"4D50C0",DisplayColor:"#C0504D",Alt:"STR@L_FontColorRed"}},{name:"Color",attrs:{Color:"59BB9B",DisplayColor:"#9BBB59",Alt:"STR@L_FontColorOliveGreen"}},{name:"Color",attrs:{Color:"A26480",DisplayColor:"#8064A2",Alt:"STR@L_FontColorPurple"}},{name:"Color",attrs:{Color:"C6AC4B",DisplayColor:"#4BACC6",Alt:"STR@L_FontColorAqua"}},{name:"Color",attrs:{Color:"4696F7",DisplayColor:"#F79646",Alt:"STR@L_FontColorOrange"}},{name:"Color",attrs:{Color:"F2F2F2",DisplayColor:"#F2F2F2",Alt:"STR@L_FontColorWhiteDarker5pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorBlackLighter50pct"}},{name:"Color",attrs:{Color:"C3D9DD",DisplayColor:"#DDD9C3",Alt:"STR@L_FontColorTanDarker10pct"}},{name:"Color",attrs:{Color:"F0D9C6",DisplayColor:"#C6D9F0",Alt:"STR@L_FontColorDarkBlueLighter80pct"}},{name:"Color",attrs:{Color:"F1E5DB",DisplayColor:"#DBE5F1",Alt:"STR@L_FontColorBlueLighter80pct"}},{name:"Color",attrs:{Color:"DBDCF2",DisplayColor:"#F2DCDB",Alt:"STR@L_FontColorRedLighter80pct"}},{name:"Color",attrs:{Color:"DDF1EB",DisplayColor:"#EBF1DD",Alt:"STR@L_FontColorOliveGreenLighter80pct"}},{name:"Color",attrs:{Color:"ECE0E5",DisplayColor:"#E5E0EC",Alt:"STR@L_FontColorPurpleLighter80pct"}},{name:"Color",attrs:{Color:"F3EEDB",DisplayColor:"#DBEEF3",Alt:"STR@L_FontColorAquaLighter80pct"}},{name:"Color",attrs:{Color:"DAEAFD",DisplayColor:"#FDEADA",Alt:"STR@L_FontColorOrangeLighter80pct"}},{name:"Color",attrs:{Color:"D8D8D8",DisplayColor:"#D8D8D8",Alt:"STR@L_FontColorWhiteDarker15pct"}},{name:"Color",attrs:{Color:"595959",DisplayColor:"#595959",Alt:"STR@L_FontColorBlackLighter35pct"}},{name:"Color",attrs:{Color:"97BDC4",DisplayColor:"#C4BD97",Alt:"STR@L_FontColorTanDarker25pct"}},{name:"Color",attrs:{Color:"E2B38D",DisplayColor:"#8DB3E2",Alt:"STR@L_FontColorDarkBlueLighter60pct"}},{name:"Color",attrs:{Color:"E4CCB8",DisplayColor:"#B8CCE4",Alt:"STR@L_FontColorBlueLighter60pct"}},{name:"Color",attrs:{Color:"B7B9E5",DisplayColor:"#E5B9B7",Alt:"STR@L_FontColorRedLighter60pct"}},{name:"Color",attrs:{Color:"BCE3D7",DisplayColor:"#D7E3BC",Alt:"STR@L_FontColorOliveGreenLighter60pct"}},{name:"Color",attrs:{Color:"D9C1CC",DisplayColor:"#CCC1D9",Alt:"STR@L_FontColorPurpleLighter60pct"}},{name:"Color",attrs:{Color:"E8DDB7",DisplayColor:"#B7DDE8",Alt:"STR@L_FontColorAquaLighter60pct"}},{name:"Color",attrs:{Color:"B5D5FB",DisplayColor:"#FBD5B5",Alt:"STR@L_FontColorOrangeLighter60pct"}},{name:"Color",attrs:{Color:"BFBFBF",DisplayColor:"#BFBFBF",Alt:"STR@L_FontColorWhiteDarker25pct"}},{name:"Color",attrs:{Color:"3F3F3F",DisplayColor:"#3F3F3F",Alt:"STR@L_FontColorBlackLighter25pct"}},{name:"Color",attrs:{Color:"538993",DisplayColor:"#938953",Alt:"STR@L_FontColorTanDarker50pct"}},{name:"Color",attrs:{Color:"D48D54",DisplayColor:"#548DD4",Alt:"STR@L_FontColorDarkBlueLighter40pct"}},{name:"Color",attrs:{Color:"D7B395",DisplayColor:"#95B3D7",Alt:"STR@L_FontColorBlueLighter40pct"}},{name:"Color",attrs:{Color:"9496D9",DisplayColor:"#D99694",Alt:"STR@L_FontColorRedLighter40pct"}},{name:"Color",attrs:{Color:"9BD6C3",DisplayColor:"#C3D69B",Alt:"STR@L_FontColorOliveGreenLighter40pct"}},{name:"Color",attrs:{Color:"C7A2B2",DisplayColor:"#B2A2C7",Alt:"STR@L_FontColorPurpleLighter40pct"}},{name:"Color",attrs:{Color:"DCCD92",DisplayColor:"#92CDDC",Alt:"STR@L_FontColorAquaLighter40pct"}},{name:"Color",attrs:{Color:"8FC0FA",DisplayColor:"#FAC08F",Alt:"STR@L_FontColorOrangeLighter40pct"}},{name:"Color",attrs:{Color:"A5A5A5",DisplayColor:"#A5A5A5",Alt:"STR@L_FontColorWhiteDarker35pct"}},{name:"Color",attrs:{Color:"262626",DisplayColor:"#262626",Alt:"STR@L_FontColorBlackLighter15pct"}},{name:"Color",attrs:{Color:"294449",DisplayColor:"#494429",Alt:"STR@L_FontColorTanDarker75pct"}},{name:"Color",attrs:{Color:"5D3617",DisplayColor:"#17365D",Alt:"STR@L_FontColorDarkBlueDarker25pct"}},{name:"Color",attrs:{Color:"926036",DisplayColor:"#366092",Alt:"STR@L_FontColorBlueDarker25pct"}},{name:"Color",attrs:{Color:"343795",DisplayColor:"#953734",Alt:"STR@L_FontColorRedDarker25pct"}},{name:"Color",attrs:{Color:"3C9276",DisplayColor:"#76923C",Alt:"STR@L_FontColorOliveGreenDarker25pct"}},{name:"Color",attrs:{Color:"7A495F",DisplayColor:"#5F497A",Alt:"STR@L_FontColorPurpleDarker25pct"}},{name:"Color",attrs:{Color:"9B8431",DisplayColor:"#31849B",Alt:"STR@L_FontColorAquaDarker25pct"}},{name:"Color",attrs:{Color:"096CE3",DisplayColor:"#E36C09",Alt:"STR@L_FontColorOrangeDarker25pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorWhiteDarker50pct"}},{name:"Color",attrs:{Color:"0C0C0C",DisplayColor:"#0C0C0C",Alt:"STR@L_FontColorBlackLighter5pct"}},{name:"Color",attrs:{Color:"101B1D",DisplayColor:"#1D1B10",Alt:"STR@L_FontColorTanDarker90pct"}},{name:"Color",attrs:{Color:"3E240F",DisplayColor:"#0F243E",Alt:"STR@L_FontColorDarkBlueDarker50pct"}},{name:"Color",attrs:{Color:"614024",DisplayColor:"#244061",Alt:"STR@L_FontColorBlueDarker50pct"}},{name:"Color",attrs:{Color:"232463",DisplayColor:"#632423",Alt:"STR@L_FontColorRedDarker50pct"}},{name:"Color",attrs:{Color:"28614F",DisplayColor:"#4F6128",Alt:"STR@L_FontColorOliveGreenDarker50pct"}},{name:"Color",attrs:{Color:"51313F",DisplayColor:"#3F3151",Alt:"STR@L_FontColorPurpleDarker50pct"}},{name:"Color",attrs:{Color:"675820",DisplayColor:"#205867",Alt:"STR@L_FontColorAquaDarker50pct"}},{name:"Color",attrs:{Color:"064898",DisplayColor:"#984806",Alt:"STR@L_FontColorOrangeDarker50pct"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"cellShadingStandardColor",Title:"STR@L_MenuStandardColors"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"cellShadingStandardColorTable",Command:"0xA4D47B93",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"0000C0",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#C00000"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"00C0FF",Alt:"STR@L_FontColorOrange",DisplayColor:"#FFC000"}},{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"50D092",Alt:"STR@L_FontColorLightGreen",DisplayColor:"#92D050"}},{name:"Color",attrs:{Color:"50B000",Alt:"STR@L_FontColorDarkGreen",DisplayColor:"#00B050"}},{name:"Color",attrs:{Color:"F0B000",Alt:"STR@L_FontColorLightBlue",DisplayColor:"#00B0F0"}},{name:"Color",attrs:{Color:"C07000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0070C0"}},{name:"Color",attrs:{Color:"602000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#002060"}},{name:"Color",attrs:{Color:"A03070",Alt:"STR@L_FontColorPurple",DisplayColor:"#7030A0"}}]}]}]}]}]}]},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_GroupInsert",Id:"floatieidTableInsert",Command:"0x2F9A3D80",Image24by24:"IMGMAP@one@InsertRowsBelow_24x24x32",LabelText:"STR@L_GroupInsert",DisplayMode:"FloatieLarge"},children:[{name:"Menu",attrs:{Id:"floatiemenuTableInsert"},children:[{name:"MenuSection",attrs:{Id:"floatiemsTableInsert",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"floatiebtnInsertRowAbove",Command:"0x8138CF12",IsDefinitive:"true",Image16by16:"IMGMAP@one@InsertRowsAbove_16x16x32",LabelText:"STR@L_InsertAbove"}},{name:"Button",attrs:{Id:"floatiebtnInsertRowBelow",Image16by16:"IMGMAP@one@InsertRowsBelow_16x16x32",Command:"0xDD172B5E",IsDefinitive:"true",LabelText:"STR@L_InsertBelow"}},{name:"Button",attrs:{Id:"floatiebtnInsertColumnLeft",Command:"0x3C041B80",IsDefinitive:"true",Image16by16:"IMGMAP@one@InsertColumnsLeft_16x16x32",LabelText:"STR@L_InsertLeft"}},{name:"Button",attrs:{Id:"floatiebtnInsertColumnRight",Command:"0x6773C219",IsDefinitive:"true",Image16by16:"IMGMAP@one@InsertColumnsRight_16x16x32",LabelText:"STR@L_InsertRight"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_Delete",Id:"floatieidTableDelete",Command:"0x2F9A3D80",Image24by24:"IMGMAP@one@TableDeleteMenu_24x24x32",LabelText:"STR@L_Delete",DisplayMode:"FloatieLarge"},children:[{name:"Menu",attrs:{Id:"floatiemenuTableDelete"},children:[{name:"MenuSection",attrs:{Id:"floatiemsTableDelete",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"floatiebtnTableDelete",Command:"0x6C7624AB",IsDefinitive:"true",Image16by16:"IMGMAP@one@TableDeleteMenu_16x16x32",LabelText:"STR@L_DeleteTable"}},{name:"Button",attrs:{Id:"floatiebtnRowDelete",Command:"0x518E0B87",IsDefinitive:"true",Image16by16:"IMGMAP@one@DeleteRows_16x16x32",LabelText:"STR@L_DeleteRow"}},{name:"Button",attrs:{Id:"floatiebtnColumnDelete",Command:"0xB1CE5D9F",IsDefinitive:"true",Image16by16:"IMGMAP@one@DeleteColumns_16x16x32",LabelText:"STR@L_DeleteColumn"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_Select",Id:"floatieidTableSelect",Command:"0x2F9A3D80",Image24by24:"IMGMAP@one@SelectTable_24x24x32",LabelText:"STR@L_Select",DisplayMode:"FloatieLarge"},children:[{name:"Menu",attrs:{Id:"floatiemenuTableSelect"},children:[{name:"MenuSection",attrs:{Id:"floatiemsTableSelect",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.SelectMenu.Controls"},children:[{name:"Button",attrs:{Id:"floatiebtnSelectTable",Command:"0x8980B8D6",IsDefinitive:"true",Image16by16:"IMGMAP@one@SelectTable_16x16x32",LabelText:"STR@L_SelectTable"}},{name:"Button",attrs:{Id:"floatiebtnSelectColumn",Command:"0x8B95D5D4",IsDefinitive:"true",Image16by16:"IMGMAP@one@SelectColumn_16x16x32",LabelText:"STR@L_SelectColumn"}},{name:"Button",attrs:{Id:"floatiebtnSelectRow",Command:"0xD117E3D2",IsDefinitive:"true",Image16by16:"IMGMAP@one@SelectRow_16x16x32",LabelText:"STR@L_SelectRow"}},{name:"Button",attrs:{Id:"floatiebtnSelectCell",Command:"0x06A11EAE",IsDefinitive:"true",Image16by16:"IMGMAP@one@SelectCell_16x16x32",LabelText:"STR@L_SelectCell"}}]}]}]}]}]}]}]}]},{name:"TouchGroup",attrs:{Id:"ContextMenuGroup"},children:[{name:"Section",attrs:{},children:[{name:"Row",attrs:{},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"ContextMenuDropdownFloatie",Command:"0x2F9A3D80",FloatieContextMenuDropDown:"True",HideDefaultArrow:"True",Image24by24:"IMGMAP@one@DownArrow_24x24x32",DisplayMode:"FloatieLarge",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x9134611D"}}]}]}]}]}]}]}]},window.MathRecognizerAlternatesFloatieData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Floatie",attrs:{Id:"MathEducationFloatie",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Groups",attrs:{}}]}]},window.InsertTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"tabInsert",Description:"",Title:"STR@L_TabInsert",Keytip:"STR@l_TabInsertKeytip"},children:[{name:"Scaling",attrs:{Id:"Insert.Scaling"},children:[{name:"MaxSize",attrs:{Id:"grpInsertNotebook.Scaling.MaxSize",Sequence:"10",GroupId:"grpNotebook",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpInsertTables.Scaling.MaxSize",Sequence:"20",GroupId:"grpInsertTables",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpIllustrations.Scaling.MaxSize",Sequence:"30",GroupId:"grpIllustrations",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpFiles.Scaling.MaxSize",Sequence:"40",GroupId:"grpFiles",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpInsertApps.Scaling.MaxSize",Sequence:"50",GroupId:"grpInsertApps",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpInsertLinks.Scaling.MaxSize",Sequence:"60",GroupId:"grpInsertLinks",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpRecording.Scaling.MaxSize",Sequence:"70",GroupId:"grpRecording",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpInsertSymbols.Scaling.MaxSize",Sequence:"80",GroupId:"grpInsertSymbols",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpInsertEmojis.Scaling.MaxSize",Sequence:"90",GroupId:"grpInsertEmojis",Size:"Large"}}]},{name:"Groups",attrs:{Id:"Insert.Groups"},children:[{name:"Group",attrs:{Id:"grpNotebook",Description:"",Title:"STR@L_GroupNotebook",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpNotebook.Controls"},children:[{name:"Button",attrs:{Id:"fseaNew",Command:"0x1F15EF8B",IsDefinitive:"true",Image16by16:"IMGMAP@one@JotNewPageAtSectionEnd_16x16x32",Image32by32:"IMGMAP@box42@New_32x32x32",LabelText:"STR@L_NewPage",TemplateAlias:"button1",Keytip:"STR@l_NewPageKeytip"}},{name:"Button",attrs:{Id:"fseaNewSection",Command:"0xA20EA835",Image16by16:"IMGMAP@one@JotInsertSection_16x16x32",Image32by32:"IMGMAP@box42@JotInsertSection_32x32x32",LabelText:"STR@L_NewSection",TemplateAlias:"button2",Keytip:"STR@l_NewSectionKeytip"}}]}]},{name:"Group",attrs:{Id:"grpInsertTables",Description:"",Title:"STR@L_GroupTables",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"InsertTable.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyInsertTable",Alt:"STR@L_Table",Image32by32:"IMGMAP@box42@Table_32x32x32",Image16by16:"IMGMAP@box42@AddTablePlaceholder_16x16x32",LabelText:"STR@L_Table",Command:"0x01B68595",TemplateAlias:"button1",Keytip:"STR@l_TableKeytip"},children:[{name:"Menu",attrs:{Id:"menuInsertTable"},children:[{name:"MenuSection",attrs:{Id:"msInserTable",Title:"STR@L_MenuInsertTable"},children:[{name:"Controls",attrs:{Id:"Insert.Table.Menu.Controls"},children:[{name:"InsertTable",attrs:{Id:"insertTable",Alt:"STR@L_MenuInsertTableGrid",Command:"0x3A21CA91",IsDefinitive:"true",MenuSectionInitialTitle:"STR@L_MenuInsertTable",MenuSectionTitle:"STR@L_MenuInsertTableGrid"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpIllustrations",Description:"",Title:"STR@L_GroupMedia",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"fseaInsertPicture",Command:"0x9F2ED567",Image32by32:"IMGMAP@box42@InsertPicture_32x32x32",LabelText:"STR@L_Picture",TemplateAlias:"button1",Keytip:"STR@l_PictureKeytip"}},{name:"Button",attrs:{Id:"fseaInsertCameraPicture",Command:"0xAEFC9682",Image32by32:"IMGMAP@box42@Camera_32x32x32",LabelText:"STR@L_Camera",TemplateAlias:"button2",Keytip:"STR@l_CameraKeytip"}},{name:"Button",attrs:{Id:"fseaInsertClipart",Command:"0x91888286",Image32by32:"IMGMAP@box42@ClipArt_32x32x32",LabelText:"STR@L_ClipArt",TemplateAlias:"button3",Keytip:"STR@l_ClipArtKeytip"}},{name:"Button",attrs:{Id:"fseaInsertOnlinePicture",Command:"0x647E1FB6",Image32by32:"IMGMAP@box42@ClipArt_32x32x32",LabelText:"STR@L_OnlinePicture",TemplateAlias:"button4",Keytip:"STR@l_OneNoteOnlinePictureKeytip"}},{name:"Button",attrs:{Id:"fseaInsertOnlinePictureFromHost",Command:"0x2AEC2180",QueryCommand:"0xD7527DDC",Image32by32:"IMGMAP@box42@InsertFromHost_32x32x32",LabelText:"STR@L_OnlinePictureFromHost",TemplateAlias:"button4",Keytip:"STR@l_OnlinePictureFromHostKeytip"}},{name:"FlyoutAnchor",attrs:{Id:"flyOnlinePicture",Alt:"STR@L_OnlinePicture",Image32by32:"IMGMAP@box42@ClipArt_32x32x32",LabelText:"STR@L_OnlinePicture",Command:"0x568463EB",TemplateAlias:"button4",Keytip:"STR@l_OneNoteOnlinePictureKeytip"},children:[{name:"Menu",attrs:{Id:"menuOnlinePicture"},children:[{name:"MenuSection",attrs:{Id:"msAllOnlinePicture",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlOnlinePicture"},children:[{name:"Button",attrs:{Id:"fseaFlyInsertOnlinePictureFromSearch",Command:"0x647E1FB6",Image32by32:"IMGMAP@box42@SourceIcon_Bing_32x32x32",MenuItemId:"buttonOnlinePicture",LabelText:"STR@L_OnlinePictureFromBing",Keytip:"STR@l_OnlinePictureFromBingKeytip"}},{name:"Button",attrs:{Id:"fseaFlyInsertOnlinePictureFromHost",Command:"0x2AEC2180",QueryCommand:"0xD7527DDC",Image32by32:"IMGMAP@box42@InsertFromHost_32x32x32",MenuItemId:"buttonOnlinePictureFromHost",LabelText:"STR@L_OnlinePictureFromHost",Keytip:"STR@l_OnlinePictureFromHostKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpFiles",Description:"",Title:"STR@L_GroupFiles",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpFiles.Controls"},children:[{name:"Button",attrs:{Id:"fseaInsertPrintout",Command:"0x8E58173A",Image32by32:"IMGMAP@one@InsertFileAsPrintout_32x32x32",LabelText:"STR@L_FilePrintout",TemplateAlias:"button1",Keytip:"STR@l_FilePrintoutKeytip"}},{name:"Button",attrs:{Id:"fseaInsertFile",Command:"0xF0EEBC31",Image32by32:"IMGMAP@one@Attachment_32x32x32",LabelText:"STR@L_FileAttachment",TemplateAlias:"button2",Keytip:"STR@l_FileAttachmentKeytip"}}]}]},{name:"Group",attrs:{Id:"grpInsertApps",Title:"STR@L_GroupApps",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"0",Command:"0x73F24D27",Image32by32:"IMGMAP@box43@AppForOfficeLogo_32x32x32",LabelText:"STR@L_ButtonOfficeAddins",TemplateAlias:"button1",Keytip:"STR@l_OneNoteButtonOfficeAddinsKeytip"}}]}]},{name:"Group",attrs:{Id:"grpInsertLinks",Description:"",Title:"STR@L_GroupLinks",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"ctrlInsert"},children:[{name:"Button",attrs:{Id:"fseaInsertHyperlink",Command:"0xA19EE2D9",Image32by32:"IMGMAP@box42@WebInsertHyperlink_32x32x32",Image16by16:"IMGMAP@one@WebInsertHyperlink_16x16x32",LabelText:"STR@L_Hyperlink",TemplateAlias:"button1",Keytip:"STR@l_OneNoteHyperlinkKeytip"}}]}]},{name:"Group",attrs:{Id:"grpRecording",Description:"",Title:"STR@L_GroupRecording",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Audio.Tools.Recording.Controls"},children:[{name:"Button",attrs:{Id:"btnRecordAudio",Command:"0xFAD3C65F",Image32by32:"IMGMAP@one@JotAudioStartRecording_32x32x32",LabelText:"STR@L_RecordAudio",TemplateAlias:"button1",Keytip:"STR@l_RecordAudioKeytip"}}]}]},{name:"Group",attrs:{Id:"grpInsertSymbols",Description:"",Title:"STR@L_SymbolPlural",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"InsertSymbols.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyInsertSymbols",QueryCommand:"0x4B3AE448",Command:"0xCEF0A7DA",LabelText:"STR@L_SymbolSingle",Image32by32:"IMGMAP@box42@Symbol_32x32x32",TemplateAlias:"button1",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0x4AE49BE0",Keytip:"STR@l_SymbolSingleKeytip"}}]}]},{name:"Group",attrs:{Id:"grpInsertEmojis",Description:"",Title:"STR@L_EmojiPlural",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"InsertSymbols.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyInsertEmojis",QueryCommand:"0x02227030",Command:"0xB2763270",LabelText:"STR@L_EmojiSingle",Image32by32:"IMGMAP@box42@SendASmile_32x32x32",TemplateAlias:"button1",PopulateDynamically:"true",PopulateOnlyOnce:"true",PopulateQueryCommand:"0x4309CEC2",Keytip:"STR@l_EmojiSingleKeytip"}}]}]}]}]}]},window.DrawTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"tabDraw",Description:"",Title:"STR@L_TabDraw",Keytip:"STR@l_TabDrawKeytip"},children:[{name:"Scaling",attrs:{Id:"Draw.Scaling"},children:[{name:"MaxSize",attrs:{Id:"grpUndoRedo.Scaling.MaxSize",Sequence:"10",GroupId:"grpUndoRedo",Size:"Small"}},{name:"MaxSize",attrs:{Id:"grpTools.Scaling.MaxSize",Sequence:"20",GroupId:"grpTools",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpColor.Scaling.MaxSize",Sequence:"30",GroupId:"grpColor",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpStyle.Scaling.MaxSize",Sequence:"40",GroupId:"grpStyle",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpMath.Scaling.MaxSize",Sequence:"50",GroupId:"grpMath",Size:"Large"}}]},{name:"Groups",attrs:{Id:"Draw.Groups"},children:[{name:"Group",attrs:{Id:"grpUndoRedo",Title:"STR@L_GroupUndoRedo",Template:"tmpUndoRedo"},children:[{name:"Controls",attrs:{Id:"ctrlUndoRedo"},children:[{name:"Button",attrs:{Id:"btnUndo",Command:"0xA66C4568",Image16by16:"IMGMAP@one@Undo_16x16x32",LabelText:"STR@L_Undo",TemplateAlias:"undo",Keytip:"STR@l_UndoKeytip"}},{name:"Button",attrs:{Id:"btnRedo",Command:"0xF957BFBE",Image16by16:"IMGMAP@one@Redo_16x16x32",LabelText:"STR@L_Redo",TemplateAlias:"redo",Keytip:"STR@l_RedoKeytip"}}]}]},{name:"Group",attrs:{Id:"grpTools",Description:"",Title:"STR@L_GroupTools",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpTools.Controls"},children:[{name:"ToggleButton",attrs:{Id:"fseaExitInkingOrEraserMode",Alt:"STR@L_Type",Command:"0x744A45EC",Image32by32:"IMGMAP@one@JotPenSelect_32x32x32",LabelText:"STR@L_Type",QueryCommand:"0x672FDBC9",TogglesWhenExecuted:"false",TemplateAlias:"button1"}},{name:"ToggleButton",attrs:{Id:"fseaEnterMarqueeSelectMode",Alt:"STR@L_MarqueeSelect",Command:"0xCB8AD0E1",Image32by32:"IMGMAP@one@MarqueeSelect_32x32x32",LabelText:"STR@L_MarqueeSelect",QueryCommand:"0x9D14BE67",TogglesWhenExecuted:"false",TemplateAlias:"button2"}},{name:"ToggleButton",attrs:{Id:"fseaEnterEraserMode",Alt:"STR@L_Eraser",Command:"0x9272B25D",Image32by32:"IMGMAP@one@JotEraserStyle2_32x32x32",LabelText:"STR@L_Eraser",QueryCommand:"0xE3DE21AF",TogglesWhenExecuted:"false",TemplateAlias:"button3"}},{name:"ToggleButton",attrs:{Id:"fseaEnterInkingPenMode",Alt:"STR@L_Pen",Command:"0xFB0534D8",Image32by32:"IMGMAP@one@136_16_N_32x32x32",LabelText:"STR@L_Pen",QueryCommand:"0x3E2989A6",TogglesWhenExecuted:"false",TemplateAlias:"button4"}},{name:"ToggleButton",attrs:{Id:"fseaEnterInkingHighlighterMode",Alt:"STR@L_Highlighter",Command:"0x1DE51B1C",Image32by32:"IMGMAP@one@HighlightWithColor_32x32x32",LabelText:"STR@L_Highlighter",QueryCommand:"0x6177E3C2",TogglesWhenExecuted:"false",TemplateAlias:"button5"}}]}]},{name:"Group",attrs:{Id:"grpColor",Description:"",Title:"STR@L_GroupColor",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpColor.Controls"},children:[{name:"ToggleButton",attrs:{Id:"fseaInkShorthandColor_0",Alt:"STR@L_InkColor_Black",Command:"0x5414C929",Image32by32:"IMGMAP@one@InkColorCircle_Black_32x32x32",LabelText:"STR@L_InkColor_Black",QueryCommand:"0x04C600D0",TogglesWhenExecuted:"false",TemplateAlias:"button1"}},{name:"ToggleButton",attrs:{Id:"fseaInkShorthandColor_1",Alt:"STR@L_InkColor_Blue",Command:"0x5414C929",Image32by32:"IMGMAP@one@InkColorCircle_Blue_32x32x32",LabelText:"STR@L_InkColor_Blue",QueryCommand:"0x04C600D0",TogglesWhenExecuted:"false",TemplateAlias:"button2"}},{name:"ToggleButton",attrs:{Id:"fseaInkShorthandColor_2",Alt:"STR@L_InkColor_DarkGreen",Command:"0x5414C929",Image32by32:"IMGMAP@one@InkColorCircle_Green_32x32x32",LabelText:"STR@L_InkColor_DarkGreen",QueryCommand:"0x04C600D0",TogglesWhenExecuted:"false",TemplateAlias:"button3"}},{name:"ToggleButton",attrs:{Id:"fseaInkShorthandColor_3",Alt:"STR@L_InkColor_Red",Command:"0x5414C929",Image32by32:"IMGMAP@one@InkColorCircle_Red_32x32x32",LabelText:"STR@L_InkColor_Red",QueryCommand:"0x04C600D0",TogglesWhenExecuted:"false",TemplateAlias:"button4"}},{name:"FlyoutAnchor",attrs:{Id:"flyInkColor",Alt:"STR@L_InkColor",Image32by32:"IMGMAP@one@Color_32x32x32",LabelText:"STR@L_InkColor",Command:"0x568463EB",TemplateAlias:"button5"},children:[{name:"Menu",attrs:{Id:"menuInkColor"},children:[{name:"MenuSection",attrs:{Id:"inkColor"},children:[{name:"Controls",attrs:{Id:"Ink.Color.Controls"},children:[{name:"ColorPicker",attrs:{Id:"inkColor",Command:"0x8B75738B",Width:"4"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"C62938",Alt:"STR@L_InkColor_Red",DisplayColor:"#C62938"}},{name:"Color",attrs:{Color:"FA931E",Alt:"STR@L_InkColor_Orange",DisplayColor:"#FA931E"}},{name:"Color",attrs:{Color:"FFCE1F",Alt:"STR@L_InkColor_Gold",DisplayColor:"#FFCE1F"}},{name:"Color",attrs:{Color:"FAF320",Alt:"STR@L_InkColor_Yellow",DisplayColor:"#FAF320"}},{name:"Color",attrs:{Color:"A4E617",Alt:"STR@L_InkColor_Green",DisplayColor:"#A4E617"}},{name:"Color",attrs:{Color:"167D1D",Alt:"STR@L_InkColor_DarkGreen",DisplayColor:"#167D1D"}},{name:"Color",attrs:{Color:"86FF56",Alt:"STR@L_InkColor_LightGreen",DisplayColor:"#86FF56"}},{name:"Color",attrs:{Color:"3DB8FF",Alt:"STR@L_InkColor_SkyBlue",DisplayColor:"#3DB8FF"}},{name:"Color",attrs:{Color:"1353BA",Alt:"STR@L_InkColor_Blue",DisplayColor:"#1353BA"}},{name:"Color",attrs:{Color:"8252D1",Alt:"STR@L_InkColor_Purple",DisplayColor:"#8252D1"}},{name:"Color",attrs:{Color:"FF73A6",Alt:"STR@L_InkColor_Pink",DisplayColor:"#FF73A6"}},{name:"Color",attrs:{Color:"904C15",Alt:"STR@L_InkColor_Brown",DisplayColor:"#904C15"}},{name:"Color",attrs:{Color:"404040",Alt:"STR@L_InkColor_Black",DisplayColor:"#404040"}},{name:"Color",attrs:{Color:"808080",Alt:"STR@L_InkColor_DarkGray",DisplayColor:"#808080"}},{name:"Color",attrs:{Color:"BFBFBF",Alt:"STR@L_InkColor_LightGray",DisplayColor:"#BFBFBF"}},{name:"Color",attrs:{Color:"FFFFFF",Alt:"STR@L_InkColor_White",DisplayColor:"#FFFFFF"}}]}]}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpStyle",Description:"",Title:"STR@L_GroupStyle",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpStyle.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"flyChangeInkThickness",Alt:"STR@L_InkThickness",QueryCommand:"0x1AB6AD34",Command:"0xDC0605B1",LabelText:"STR@L_InkThickness",Image32by32:"IMGMAP@one@GalLineWidth_32x32x32",TemplateAlias:"button2",PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"0x73ABB39F"}}]}]},{name:"Group",attrs:{Id:"grpMath",Title:"STR@L_Math",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"ctrlMath"},children:[{name:"Button",attrs:{Id:"btnMath",Command:"0x65DFA73B",QueryCommand:"0x902360C5",Image32by32:"IMGMAP@one@Math_32x32x32",LabelText:"STR@L_Math",TemplateAlias:"button1",Keytip:"STR@l_EnterMathEducationModeKeytip"}},{name:"SplitButton",attrs:{Id:"sbMath",Alt:"STR@L_Math",LabelText:"STR@L_Math",Command:"0x65DFA73B",QueryCommand:"0xDF9CEBD4",Image32by32:"IMGMAP@one@Math_32x32x32",TemplateAlias:"button2",Visible:"false",Keytip:"STR@l_EnterMathEducationModeKeytip"},children:[{name:"Menu",attrs:{Id:"menuMath"},children:[{name:"MenuSection",attrs:{Id:"msMath",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msMath.Controls"},children:[{name:"Button",attrs:{Id:"fseaMathButton",Command:"0x65DFA73B",LabelText:"STR@L_Math",Keytip:"STR@l_EnterMathEducationModeKeytip"}},{name:"Button",attrs:{Id:"fseaOpenLanguageDialog",Command:"0x42CF620A",LabelText:"STR@L_MathSwitchTurnOnOff",Keytip:"STR@l_EnterMathEducationSwitchKeytip"}}]}]}]}]}]}]}]}]}]},window.HelpTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"tabHelp",Title:"STR@L_Help",Keytip:"STR@l_TabHelpKeytip"},children:[{name:"Scaling",attrs:{},children:[{name:"MaxSize",attrs:{Id:"grpHelp.Scaling.MaxSize",Sequence:"0",GroupId:"grpHelp",Size:"Large"}}]},{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"grpHelp",Description:"",Title:"STR@L_GroupHelp",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Alt:"STR@L_Help",Id:"jbtnHelp",Command:"0xADF0D73B",LabelText:"STR@L_Help",Image32by32:"IMGMAP@one@OfficeAssistant_32x32x32",TemplateAlias:"button1",Keytip:"STR@l_HelpButtonTitleKeytip"}},{name:"Button",attrs:{Alt:"STR@L_ContactSupport",Id:"btnContactSupport",Command:"0xADF0D73B",LabelText:"STR@L_ContactSupport",Image32by32:"IMGMAP@one@PSSHelp_32x32x32",TemplateAlias:"button2",Keytip:"STR@l_ContactSupportKeytip"}},{name:"Button",attrs:{Alt:"STR@L_GiveFeedbackShort",Id:"jbtnGiveFeedback",Command:"0x2FD6BDE0",LabelText:"STR@L_GiveFeedbackShort",Image32by32:"IMGMAP@box42@SendASmile_32x32x32",TemplateAlias:"button3",Keytip:"STR@l_GiveFeedbackKeytip"}},{name:"Button",attrs:{Alt:"STR@L_WhatsNew",Id:"btnWhatsNew",Command:"0xADF0D73B",LabelText:"STR@L_WhatsNew",Image32by32:"IMGMAP@one@WhatsNewRecentUpdates_32x32x32",TemplateAlias:"button4",Keytip:"STR@l_WhatsNewKeytip"}}]}]}]}]}]},window.AudioToolsTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"ContextualTabs.Audio.Tools",Description:"",Title:"STR@L_TabAudio",Keytip:"STR@l_TabAudioKeytip"},children:[{name:"Scaling",attrs:{Id:"ContextualTabs.Audio.Tools.Scaling"},children:[{name:"MaxSize",attrs:{Sequence:"10",GroupId:"ContextualTabs.Audio.Tools.Recording",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"20",GroupId:"ContextualTabs.Audio.Tools.Playback",Size:"Large"}}]},{name:"Groups",attrs:{Id:"ContextualTabs.Audio.Tools.Groups"},children:[{name:"Group",attrs:{Id:"ContextualTabs.Audio.Tools.Recording",Description:"",Title:"STR@L_GroupRecording",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Audio.Tools.Recording.Controls"},children:[{name:"Button",attrs:{Id:"btnRecordAudio",Command:"0xFAD3C65F",Image32by32:"IMGMAP@one@JotAudioStartRecording_32x32x32",LabelText:"STR@L_Record",TemplateAlias:"button1",Keytip:"STR@l_RecordKeytip"}},{name:"Button",attrs:{Id:"btnStopAudioRecording",Command:"0x91C5A363",Image32by32:"IMGMAP@one@StopRecording_32x32x32",LabelText:"STR@L_Stop",TemplateAlias:"button2",Keytip:"STR@l_StopKeytip"}}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Audio.Tools.Playback",Description:"",Title:"STR@L_GroupPlayback",Template:"tmpFourButtonSlider"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Audio.Tools.Playback.Controls"},children:[{name:"Button",attrs:{Id:"btnMediaPlay",Command:"0x29887428",Image32by32:"IMGMAP@one@AnimFxMediaPlay_32x32x32",LabelText:"STR@L_Play",TemplateAlias:"button1",Keytip:"STR@l_PlayKeytip"}},{name:"Button",attrs:{Id:"btnMediaPause",Command:"0x2E81B624",Image32by32:"IMGMAP@one@Pause_32x32x32",LabelText:"STR@L_Pause",TemplateAlias:"button2",Keytip:"STR@l_PauseKeytip"}},{name:"Slider",attrs:{Id:"sldrAudioRibbonSeekBar",LabelId:"sldrAudioRibbonTimeSpan",Command:"0x4783C8FE",QueryCommand:"0x2D4DCB76",LabelText:"0:00",Value:"0",TemplateAlias:"slider1"}},{name:"Button",attrs:{Id:"btnMediaSkipBack",Command:"0x4E9BD6BB",Image32by32:"IMGMAP@one@Skip15SecondsBack_32x32x32",LabelText:"STR@L_Back15Seconds",TemplateAlias:"button3",Keytip:"STR@l_Back15SecondsKeytip"}},{name:"Button",attrs:{Id:"btnMediaSkipForward",Command:"0x0174938B",Image32by32:"IMGMAP@one@Skip15SecondsForward_32x32x32",LabelText:"STR@L_Forward15Seconds",TemplateAlias:"button4",Keytip:"STR@l_Forward15SecondsKeytip"}}]}]}]}]},{name:"Templates",attrs:{},children:[{name:"RibbonTemplates",attrs:{},children:[{name:"GroupTemplate",attrs:{Id:"tmpFourButtonSlider"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"slider1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button4",DisplayMode:"Large"}}]}]}]}]}]}]}]},window.PictureToolsTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"ctabPictureTools",Description:"",Title:"STR@L_TabFormatPicture",Keytip:"STR@l_TabFormatPictureKeytip"},children:[{name:"Scaling",attrs:{},children:[{name:"MaxSize",attrs:{Id:"grpImageSize.Scaling.MaxSize",Sequence:"10",GroupId:"grpImageSize",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpImageSize.Scaling.MaxSize",Sequence:"20",GroupId:"grpImageManipulation",Size:"Large"}}]},{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"grpImageSize",Description:"",Title:"STR@L_GroupImageSize",Template:"tmpONImageSize"},children:[{name:"Controls",attrs:{},children:[{name:"Button",attrs:{Id:"btnImageGrow",Command:"0x464C6D12",Image16by16:"IMGMAP@box42@IncreaseSize_16x16x32",LabelText:"STR@L_Grow",TemplateAlias:"grow",Keytip:"STR@l_GrowKeytip"}},{name:"Button",attrs:{Id:"btnImageShrink",Command:"0xF571A3C0",Image16by16:"IMGMAP@box42@DecreaseSize_16x16x32",LabelText:"STR@L_Shrink",TemplateAlias:"shrink",Keytip:"STR@l_ShrinkKeytip"}},{name:"Label",attrs:{Id:"lblScale",LabelText:"STR@L_PictureScaleLabel",TemplateAlias:"scaleLabel"}},{name:"Spinner",attrs:{Id:"spnSize",Alt:"STR@L_PictureScaleTooltip",Command:"0x50D14FC5",QueryCommand:"0x3276C7D7",TemplateAlias:"spinner",Keytip:"STR@l_PictureScaleTooltipKeytip"},children:[{name:"Unit",attrs:{UnitType:"percent",MinimumValue:".1",MaximumValue:"128000",Step:"1"}}]},{name:"ToggleButton",attrs:{Id:"toggleBtnLockAspectRatio",Command:"0xC8D54EAD",UseCheckMark:"true",QueryCommand:"0xFA6A61DB",UseUncheckedImage:"true",LabelText:"STR@L_LockAspectRatio",TemplateAlias:"toggleButtonLockAspectRatio",Keytip:"STR@l_LockAspectRatioKeytip"}},{name:"Label",attrs:{Id:"lblAbsoluteHeight",Image16by16:"IMGMAP@box42@SizeToControlHeight_16x16x32",LabelText:"STR@L_PictureHeightLabel",TemplateAlias:"labelAbsoluteHeight"}},{name:"Label",attrs:{Id:"lblAbsoluteWidth",Image16by16:"IMGMAP@box42@SizeToControlWidth_16x16x32",LabelText:"STR@L_PictureWidthLabel",TemplateAlias:"labelAbsoluteWidth"}},{name:"Label",attrs:{Id:"lblDummyLabelForProperAlignmentOfImageSize",LabelText:"",TemplateAlias:"labelDummy"}},{name:"Spinner",attrs:{Id:"spnAbsoluteHeight",Alt:"STR@L_PictureHeightTooltip",Command:"0xA7600729",QueryCommand:"0x8204A835",TemplateAlias:"spinnerAbsoluteHeight",Keytip:"STR@l_PictureHeightTooltipKeytip"},children:[{name:"Unit",attrs:{UnitType:"inch",MinimumValue:"0.01",MaximumValue:"13.33",Step:"0.1"}},{name:"Unit",attrs:{UnitType:"centimeter",MinimumValue:"0.03",MaximumValue:"33.85",Step:"1"}},{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"1",MaximumValue:"1280",Step:"1"}}]},{name:"Spinner",attrs:{Id:"spnAbsoluteWidth",Alt:"STR@L_PictureWidthTooltip",Command:"0xB94B8FBA",QueryCommand:"0x74DFCD5E",TemplateAlias:"spinnerAbsoluteWidth",Keytip:"STR@l_PictureWidthTooltipKeytip"},children:[{name:"Unit",attrs:{UnitType:"inch",MinimumValue:"0.01",MaximumValue:"20",Step:"0.1"}},{name:"Unit",attrs:{UnitType:"centimeter",MinimumValue:"0.03",MaximumValue:"50.8",Step:"1"}},{name:"Unit",attrs:{UnitType:"pixels",MinimumValue:"0",MaximumValue:"1920",Step:"1"}}]},{name:"Button",attrs:{Id:"btnImageCropDialog",Command:"0xEF945B15",Image32by32:"IMGMAP@box42@Crop_32x32x32",LabelText:"STR@L_Crop",TemplateAlias:"crop",Keytip:"STR@l_CropKeytip"}}]}]}]}]},{name:"Templates",attrs:{},children:[{name:"RibbonTemplates",attrs:{},children:[{name:"GroupTemplate",attrs:{Id:"tmpONImageSize"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"TwoRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"grow",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"shrink",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"Divider"}},{name:"Section",attrs:{Type:"OneRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"scaleLabel",DisplayMode:"Medium"}},{name:"ControlRef",attrs:{TemplateAlias:"spinner",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"Divider"}},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"toggleButtonLockAspectRatio",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"labelAbsoluteHeight",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"labelAbsoluteWidth",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"Divider"}},{name:"Section",attrs:{Type:"ThreeRow",Alignment:"Middle"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"labelDummy",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"spinnerAbsoluteHeight",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"spinnerAbsoluteWidth",DisplayMode:"Medium"}}]}]},{name:"Section",attrs:{Type:"Divider"}},{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"crop",DisplayMode:"Large"}}]}]}]}]}]}]}]},window.TableLayoutTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"ContextualTabs.Tables.Layout",Description:"",Title:"STR@L_TabLayout",Keytip:"STR@l_TabLayoutKeytip"},children:[{name:"Scaling",attrs:{Id:"ContextualTabs.Tables.Layout.Scaling"},children:[{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Select",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Delete",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Insert",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Borders",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Alignment",Size:"Large"}},{name:"MaxSize",attrs:{Sequence:"0",GroupId:"ContextualTabs.Tables.Layout.Shading",Size:"Large"}},{name:"Scale",attrs:{Sequence:"10",GroupId:"ContextualTabs.Tables.Layout.Select",Size:"Medium"}},{name:"Scale",attrs:{Sequence:"15",GroupId:"ContextualTabs.Tables.Layout.Alignment",Size:"Medium"}},{name:"Scale",attrs:{Sequence:"20",GroupId:"ContextualTabs.Tables.Layout.Delete",Size:"Medium"}},{name:"Scale",attrs:{Sequence:"30",GroupId:"ContextualTabs.Tables.Layout.Insert",Size:"Medium"}},{name:"Scale",attrs:{Sequence:"40",GroupId:"ContextualTabs.Tables.Layout.Select",Size:"Small"}},{name:"Scale",attrs:{Sequence:"50",GroupId:"ContextualTabs.Tables.Layout.Insert",Size:"Small"}},{name:"Scale",attrs:{Sequence:"55",GroupId:"ContextualTabs.Tables.Layout.Alignment",Size:"Small"}},{name:"Scale",attrs:{Sequence:"60",GroupId:"ContextualTabs.Tables.Layout.Select",Size:"Collapsed"}},{name:"Scale",attrs:{Sequence:"70",GroupId:"ContextualTabs.Tables.Layout.Delete",Size:"Collapsed"}}]},{name:"Groups",attrs:{Id:"ContextualTabs.Tables.Layout.Groups"},children:[{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Select",Description:"",Title:"STR@L_GroupSelect",Template:"tmpFourButton"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.Select.Controls"},children:[{name:"Button",attrs:{Id:"btnSelectTable",Command:"0x8980B8D6",Image32by32:"IMGMAP@box42@TableSelectTable_32x32x32",Image16by16:"IMGMAP@one@SelectTable_16x16x32",LabelText:"STR@L_SelectTable",TemplateAlias:"button1",Keytip:"STR@l_OneNoteSelectTableKeytip"}},{name:"Button",attrs:{Id:"btnSelectColumn",Command:"0x8B95D5D4",Image32by32:"IMGMAP@box42@TableSelectColumn_32x32x32",Image16by16:"IMGMAP@one@SelectColumn_16x16x32",LabelText:"STR@L_SelectColumn",TemplateAlias:"button2",Keytip:"STR@l_OneNoteSelectColumnKeytip"}},{name:"Button",attrs:{Id:"btnSelectRow",Command:"0xD117E3D2",Image32by32:"IMGMAP@box42@TableSelectRow_32x32x32",Image16by16:"IMGMAP@one@SelectRow_16x16x32",LabelText:"STR@L_SelectRow",TemplateAlias:"button3",Keytip:"STR@l_OneNoteSelectRowKeytip"}},{name:"Button",attrs:{Id:"btnSelectCell",Command:"0x06A11EAE",Image32by32:"IMGMAP@box42@TableSelectCell_32x32x32",Image16by16:"IMGMAP@one@SelectCell_16x16x32",LabelText:"STR@L_SelectCell",TemplateAlias:"button4",Keytip:"STR@l_OneNoteSelectCellKeytip"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_Select",Command:"0x2F9A3D80",Id:"idTableSelect",Image32by32:"IMGMAP@box42@TableSelectTable_32x32x32",LabelText:"STR@L_Select",TemplateAlias:"flyout",Keytip:"STR@l_SelectKeytip"},children:[{name:"Menu",attrs:{Id:"menuTableSelect"},children:[{name:"MenuSection",attrs:{Id:"msTableSelect",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.SelectMenu.Controls"},children:[{name:"Button",attrs:{Id:"btnSelectTable",Command:"0x8980B8D6",Image32by32:"IMGMAP@box42@TableSelectTable_32x32x32",Image16by16:"IMGMAP@one@SelectTable_16x16x32",LabelText:"STR@L_SelectTable",Keytip:"STR@l_OneNoteSelectTableKeytip"}},{name:"Button",attrs:{Id:"btnSelectColumn",Command:"0x8B95D5D4",Image32by32:"IMGMAP@box42@TableSelectColumn_32x32x32",Image16by16:"IMGMAP@one@SelectColumn_16x16x32",LabelText:"STR@L_SelectColumn",Keytip:"STR@l_OneNoteSelectColumnKeytip"}},{name:"Button",attrs:{Id:"btnSelectRow",Command:"0xD117E3D2",Image32by32:"IMGMAP@box42@TableSelectRow_32x32x32",Image16by16:"IMGMAP@one@SelectRow_16x16x32",LabelText:"STR@L_SelectRow",Keytip:"STR@l_OneNoteSelectRowKeytip"}},{name:"Button",attrs:{Id:"btnSelectCell",Command:"0x06A11EAE",Image32by32:"IMGMAP@box42@TableSelectCell_32x32x32",Image16by16:"IMGMAP@one@SelectCell_16x16x32",LabelText:"STR@L_SelectCell",Keytip:"STR@l_OneNoteSelectCellKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Delete",Description:"",Title:"STR@L_GroupDelete",Template:"tmpThreeButton"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.Delete.Controls"},children:[{name:"Button",attrs:{Id:"btnTableDelete",Command:"0x6C7624AB",Image32by32:"IMGMAP@box42@TableDeleteMenu_32x32x32",Image16by16:"IMGMAP@one@TableDeleteMenu_16x16x32",LabelText:"STR@L_DeleteTable",TemplateAlias:"button1",Keytip:"STR@l_OneNoteDeleteTableKeytip"}},{name:"Button",attrs:{Id:"btnColumnDelete",Command:"0xB1CE5D9F",Image32by32:"IMGMAP@box42@TableDeleteColumn_32x32x32",Image16by16:"IMGMAP@one@DeleteColumns_16x16x32",LabelText:"STR@L_DeleteColumn",TemplateAlias:"button2",Keytip:"STR@l_OneNoteDeleteColumnKeytip"}},{name:"Button",attrs:{Id:"btnRowDelete",Command:"0x518E0B87",Image32by32:"IMGMAP@box42@TableDeleteRow_32x32x32",Image16by16:"IMGMAP@one@DeleteRows_16x16x32",LabelText:"STR@L_DeleteRow",TemplateAlias:"button3",Keytip:"STR@l_OneNoteDeleteRowKeytip"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_Delete",Command:"0x2F9A3D80",Id:"idTableDelete",Image32by32:"IMGMAP@box42@TableDeleteMenu_32x32x32",LabelText:"STR@L_Delete",TemplateAlias:"flyout",Keytip:"STR@l_DeleteKeytip"},children:[{name:"Menu",attrs:{Id:"menuTableDelete"},children:[{name:"MenuSection",attrs:{Id:"msTableDelete",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.DeleteMenu.Controls"},children:[{name:"Button",attrs:{Id:"btnTableDelete",Command:"0x6C7624AB",Image32by32:"IMGMAP@box42@TableDeleteMenu_32x32x32",Image16by16:"IMGMAP@one@TableDeleteMenu_16x16x32",LabelText:"STR@L_DeleteTable",Keytip:"STR@l_DeleteTableKeytip"}},{name:"Button",attrs:{Id:"btnColumnDelete",Command:"0xB1CE5D9F",Image32by32:"IMGMAP@box42@TableDeleteColumn_32x32x32",Image16by16:"IMGMAP@one@DeleteColumns_16x16x32",LabelText:"STR@L_DeleteColumn",Keytip:"STR@l_DeleteColumnKeytip"}},{name:"Button",attrs:{Id:"btnRowDelete",Command:"0x518E0B87",Image32by32:"IMGMAP@box42@TableDeleteRow_32x32x32",Image16by16:"IMGMAP@one@DeleteRows_16x16x32",LabelText:"STR@L_DeleteRow",Keytip:"STR@l_DeleteRowKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Insert",Description:"",Title:"STR@L_GroupInsert",Template:"tmpFourButton"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.Insert.Controls"},children:[{name:"Button",attrs:{Id:"btnInsertRowAbove",Command:"0x8138CF12",Image32by32:"IMGMAP@box42@InsertRowsAbove_32x32x32",Image16by16:"IMGMAP@one@InsertRowsAbove_16x16x32",LabelText:"STR@L_InsertAbove",TemplateAlias:"button1",Keytip:"STR@l_OneNoteInsertAboveKeytip"}},{name:"Button",attrs:{Id:"btnInsertRowBelow",Command:"0xDD172B5E",Image32by32:"IMGMAP@box42@InsertRowsBelow_32x32x32",Image16by16:"IMGMAP@one@InsertRowsBelow_16x16x32",LabelText:"STR@L_InsertBelow",TemplateAlias:"button2",Keytip:"STR@l_OneNoteInsertBelowKeytip"}},{name:"Button",attrs:{Id:"btnInsertColumnLeft",Command:"0x3C041B80",Image32by32:"IMGMAP@box42@InsertColumnsLeft_32x32x32",Image16by16:"IMGMAP@one@InsertColumnsLeft_16x16x32",LabelText:"STR@L_InsertLeft",TemplateAlias:"button3",Keytip:"STR@l_InsertLeftKeytip"}},{name:"Button",attrs:{Id:"btnInsertColumnRight",Command:"0x6773C219",Image32by32:"IMGMAP@box42@InsertColumnsRight_32x32x32",Image16by16:"IMGMAP@one@InsertColumnsRight_16x16x32",LabelText:"STR@L_InsertRight",TemplateAlias:"button4",Keytip:"STR@l_OneNoteInsertRightKeytip"}}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Borders",Description:"",Title:"STR@L_GroupBorders",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.Borders.Controls"},children:[{name:"ToggleButton",attrs:{Id:"btnHideBorders",Command:"0x6C020651",QueryCommand:"0x0B155E1B",Image32by32:"IMGMAP@box42@TableHideBorders_32x32x32",LabelText:"STR@L_HideBorders",Alt:"STR@L_HideBorders",TemplateAlias:"button1",Keytip:"STR@l_HideBordersKeytip"}}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Alignment",Description:"",Title:"STR@L_GroupAlignment",Template:"tmpThreeButton"},children:[{name:"Controls",attrs:{Id:"ContextualTabs.Tables.Layout.Alignment.Controls"},children:[{name:"ToggleButton",attrs:{Id:"LeftJustify",Command:"0x6F4BD314",QueryCommand:"0xE25D77A3",Image16by16:"IMGMAP@one@LeftJustify_16x16x32",Image32by32:"IMGMAP@box42@LeftJustify_32x32x32",LabelText:"STR@L_AlignLeft",TemplateAlias:"button1",Keytip:"STR@l_AlignLeftKeytip"}},{name:"ToggleButton",attrs:{Id:"CenterJustify",Command:"0xC6A376F8",QueryCommand:"0xC27E85BB",Image16by16:"IMGMAP@one@Centered_16x16x32",Image32by32:"IMGMAP@box42@Centered_32x32x32",LabelText:"STR@L_JustifyCenter",TemplateAlias:"button2",Keytip:"STR@l_JustifyCenterKeytip"}},{name:"ToggleButton",attrs:{Id:"RightJustify",Command:"0xD59F0217",QueryCommand:"0x776E8734",Image16by16:"IMGMAP@one@RightJustify_16x16x32",Image32by32:"IMGMAP@box42@RightJustify_32x32x32",LabelText:"STR@L_AlignRight",TemplateAlias:"button3",Keytip:"STR@l_AlignRightKeytip"}}]}]},{name:"Group",attrs:{Id:"ContextualTabs.Tables.Layout.Shading",Description:"",Title:"STR@L_GroupShading",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"cellShadingColor",Command:"0x4DAC4430",Image32by32:"IMGMAP@one@FillColorSplitDropdown_32x32x32",LabelText:"STR@L_MenuShadingColor",DisplayMode:"Large",TemplateAlias:"button1",Keytip:"STR@l_OneNoteMenuShadingColorKeytip"},children:[{name:"Menu",attrs:{Id:"menuCellShadingColor"},children:[{name:"MenuSection",attrs:{Id:"cellShadingColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0xC33DA1AE",LabelText:"STR@L_BtnClearShading",Id:"clear",Image16by16:"IMGMAP@one@NoHighlight_16x16x32"}}]}]},{name:"MenuSection",attrs:{Id:"cellShadingColor"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"cellShadingColorTable",Command:"0xA4D47B93",McuLayout:"true",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"FFFFFF",DisplayColor:"#FFFFFF",Alt:"STR@L_FontColorWhite"}},{name:"Color",attrs:{Color:"000000",DisplayColor:"#000000",Alt:"STR@L_FontColorBlack"}},{name:"Color",attrs:{Color:"E1ECEE",DisplayColor:"#EEECE1",Alt:"STR@L_FontColorTan"}},{name:"Color",attrs:{Color:"7D491F",DisplayColor:"#1F497D",Alt:"STR@L_FontColorDarkBlue"}},{name:"Color",attrs:{Color:"BD814F",DisplayColor:"#4F81BD",Alt:"STR@L_FontColorBlue"}},{name:"Color",attrs:{Color:"4D50C0",DisplayColor:"#C0504D",Alt:"STR@L_FontColorRed"}},{name:"Color",attrs:{Color:"59BB9B",DisplayColor:"#9BBB59",Alt:"STR@L_FontColorOliveGreen"}},{name:"Color",attrs:{Color:"A26480",DisplayColor:"#8064A2",Alt:"STR@L_FontColorPurple"}},{name:"Color",attrs:{Color:"C6AC4B",DisplayColor:"#4BACC6",Alt:"STR@L_FontColorAqua"}},{name:"Color",attrs:{Color:"4696F7",DisplayColor:"#F79646",Alt:"STR@L_FontColorOrange"}},{name:"Color",attrs:{Color:"F2F2F2",DisplayColor:"#F2F2F2",Alt:"STR@L_FontColorWhiteDarker5pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorBlackLighter50pct"}},{name:"Color",attrs:{Color:"C3D9DD",DisplayColor:"#DDD9C3",Alt:"STR@L_FontColorTanDarker10pct"}},{name:"Color",attrs:{Color:"F0D9C6",DisplayColor:"#C6D9F0",Alt:"STR@L_FontColorDarkBlueLighter80pct"}},{name:"Color",attrs:{Color:"F1E5DB",DisplayColor:"#DBE5F1",Alt:"STR@L_FontColorBlueLighter80pct"}},{name:"Color",attrs:{Color:"DBDCF2",DisplayColor:"#F2DCDB",Alt:"STR@L_FontColorRedLighter80pct"}},{name:"Color",attrs:{Color:"DDF1EB",DisplayColor:"#EBF1DD",Alt:"STR@L_FontColorOliveGreenLighter80pct"}},{name:"Color",attrs:{Color:"ECE0E5",DisplayColor:"#E5E0EC",Alt:"STR@L_FontColorPurpleLighter80pct"}},{name:"Color",attrs:{Color:"F3EEDB",DisplayColor:"#DBEEF3",Alt:"STR@L_FontColorAquaLighter80pct"}},{name:"Color",attrs:{Color:"DAEAFD",DisplayColor:"#FDEADA",Alt:"STR@L_FontColorOrangeLighter80pct"}},{name:"Color",attrs:{Color:"D8D8D8",DisplayColor:"#D8D8D8",Alt:"STR@L_FontColorWhiteDarker15pct"}},{name:"Color",attrs:{Color:"595959",DisplayColor:"#595959",Alt:"STR@L_FontColorBlackLighter35pct"}},{name:"Color",attrs:{Color:"97BDC4",DisplayColor:"#C4BD97",Alt:"STR@L_FontColorTanDarker25pct"}},{name:"Color",attrs:{Color:"E2B38D",DisplayColor:"#8DB3E2",Alt:"STR@L_FontColorDarkBlueLighter60pct"}},{name:"Color",attrs:{Color:"E4CCB8",DisplayColor:"#B8CCE4",Alt:"STR@L_FontColorBlueLighter60pct"}},{name:"Color",attrs:{Color:"B7B9E5",DisplayColor:"#E5B9B7",Alt:"STR@L_FontColorRedLighter60pct"}},{name:"Color",attrs:{Color:"BCE3D7",DisplayColor:"#D7E3BC",Alt:"STR@L_FontColorOliveGreenLighter60pct"}},{name:"Color",attrs:{Color:"D9C1CC",DisplayColor:"#CCC1D9",Alt:"STR@L_FontColorPurpleLighter60pct"}},{name:"Color",attrs:{Color:"E8DDB7",DisplayColor:"#B7DDE8",Alt:"STR@L_FontColorAquaLighter60pct"}},{name:"Color",attrs:{Color:"B5D5FB",DisplayColor:"#FBD5B5",Alt:"STR@L_FontColorOrangeLighter60pct"}},{name:"Color",attrs:{Color:"BFBFBF",DisplayColor:"#BFBFBF",Alt:"STR@L_FontColorWhiteDarker25pct"}},{name:"Color",attrs:{Color:"3F3F3F",DisplayColor:"#3F3F3F",Alt:"STR@L_FontColorBlackLighter25pct"}},{name:"Color",attrs:{Color:"538993",DisplayColor:"#938953",Alt:"STR@L_FontColorTanDarker50pct"}},{name:"Color",attrs:{Color:"D48D54",DisplayColor:"#548DD4",Alt:"STR@L_FontColorDarkBlueLighter40pct"}},{name:"Color",attrs:{Color:"D7B395",DisplayColor:"#95B3D7",Alt:"STR@L_FontColorBlueLighter40pct"}},{name:"Color",attrs:{Color:"9496D9",DisplayColor:"#D99694",Alt:"STR@L_FontColorRedLighter40pct"}},{name:"Color",attrs:{Color:"9BD6C3",DisplayColor:"#C3D69B",Alt:"STR@L_FontColorOliveGreenLighter40pct"}},{name:"Color",attrs:{Color:"C7A2B2",DisplayColor:"#B2A2C7",Alt:"STR@L_FontColorPurpleLighter40pct"}},{name:"Color",attrs:{Color:"DCCD92",DisplayColor:"#92CDDC",Alt:"STR@L_FontColorAquaLighter40pct"}},{name:"Color",attrs:{Color:"8FC0FA",DisplayColor:"#FAC08F",Alt:"STR@L_FontColorOrangeLighter40pct"}},{name:"Color",attrs:{Color:"A5A5A5",DisplayColor:"#A5A5A5",Alt:"STR@L_FontColorWhiteDarker35pct"}},{name:"Color",attrs:{Color:"262626",DisplayColor:"#262626",Alt:"STR@L_FontColorBlackLighter15pct"}},{name:"Color",attrs:{Color:"294449",DisplayColor:"#494429",Alt:"STR@L_FontColorTanDarker75pct"}},{name:"Color",attrs:{Color:"5D3617",DisplayColor:"#17365D",Alt:"STR@L_FontColorDarkBlueDarker25pct"}},{name:"Color",attrs:{Color:"926036",DisplayColor:"#366092",Alt:"STR@L_FontColorBlueDarker25pct"}},{name:"Color",attrs:{Color:"343795",DisplayColor:"#953734",Alt:"STR@L_FontColorRedDarker25pct"}},{name:"Color",attrs:{Color:"3C9276",DisplayColor:"#76923C",Alt:"STR@L_FontColorOliveGreenDarker25pct"}},{name:"Color",attrs:{Color:"7A495F",DisplayColor:"#5F497A",Alt:"STR@L_FontColorPurpleDarker25pct"}},{name:"Color",attrs:{Color:"9B8431",DisplayColor:"#31849B",Alt:"STR@L_FontColorAquaDarker25pct"}},{name:"Color",attrs:{Color:"096CE3",DisplayColor:"#E36C09",Alt:"STR@L_FontColorOrangeDarker25pct"}},{name:"Color",attrs:{Color:"7F7F7F",DisplayColor:"#7F7F7F",Alt:"STR@L_FontColorWhiteDarker50pct"}},{name:"Color",attrs:{Color:"0C0C0C",DisplayColor:"#0C0C0C",Alt:"STR@L_FontColorBlackLighter5pct"}},{name:"Color",attrs:{Color:"101B1D",DisplayColor:"#1D1B10",Alt:"STR@L_FontColorTanDarker90pct"}},{name:"Color",attrs:{Color:"3E240F",DisplayColor:"#0F243E",Alt:"STR@L_FontColorDarkBlueDarker50pct"}},{name:"Color",attrs:{Color:"614024",DisplayColor:"#244061",Alt:"STR@L_FontColorBlueDarker50pct"}},{name:"Color",attrs:{Color:"232463",DisplayColor:"#632423",Alt:"STR@L_FontColorRedDarker50pct"}},{name:"Color",attrs:{Color:"28614F",DisplayColor:"#4F6128",Alt:"STR@L_FontColorOliveGreenDarker50pct"}},{name:"Color",attrs:{Color:"51313F",DisplayColor:"#3F3151",Alt:"STR@L_FontColorPurpleDarker50pct"}},{name:"Color",attrs:{Color:"675820",DisplayColor:"#205867",Alt:"STR@L_FontColorAquaDarker50pct"}},{name:"Color",attrs:{Color:"064898",DisplayColor:"#984806",Alt:"STR@L_FontColorOrangeDarker50pct"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"cellShadingStandardColor",Title:"STR@L_MenuStandardColors"},children:[{name:"Controls",attrs:{Id:"CellShading.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"cellShadingStandardColorTable",Command:"0xA4D47B93",Width:"10"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"0000C0",Alt:"STR@L_FontColorDarkRed",DisplayColor:"#C00000"}},{name:"Color",attrs:{Color:"0000FF",Alt:"STR@L_FontColorRed",DisplayColor:"#FF0000"}},{name:"Color",attrs:{Color:"00C0FF",Alt:"STR@L_FontColorOrange",DisplayColor:"#FFC000"}},{name:"Color",attrs:{Color:"00FFFF",Alt:"STR@L_FontColorYellow",DisplayColor:"#FFFF00"}},{name:"Color",attrs:{Color:"50D092",Alt:"STR@L_FontColorLightGreen",DisplayColor:"#92D050"}},{name:"Color",attrs:{Color:"50B000",Alt:"STR@L_FontColorDarkGreen",DisplayColor:"#00B050"}},{name:"Color",attrs:{Color:"F0B000",Alt:"STR@L_FontColorLightBlue",DisplayColor:"#00B0F0"}},{name:"Color",attrs:{Color:"C07000",Alt:"STR@L_FontColorBlue",DisplayColor:"#0070C0"}},{name:"Color",attrs:{Color:"602000",Alt:"STR@L_FontColorDarkBlue",DisplayColor:"#002060"}},{name:"Color",attrs:{Color:"A03070",Alt:"STR@L_FontColorPurple",DisplayColor:"#7030A0"}}]}]}]}]}]}]}]}]}]}]},{name:"Templates",attrs:{},children:[{name:"RibbonTemplates",attrs:{},children:[{name:"GroupTemplate",attrs:{Id:"tmpThreeButton"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Large"}}]}]}]},{name:"Layout",attrs:{Title:"Medium"},children:[{name:"Section",attrs:{Type:"ThreeRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"Small"},children:[{name:"Section",attrs:{Type:"ThreeRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Small"}}]}]}]},{name:"Layout",attrs:{Title:"Collapsed"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"flyout",DisplayMode:"Large"}}]}]}]}]},{name:"GroupTemplate",attrs:{Id:"tmpFourButton"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Large"}},{name:"ControlRef",attrs:{TemplateAlias:"button4",DisplayMode:"Large"}}]}]}]},{name:"Layout",attrs:{Title:"Medium"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"ThreeRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Medium"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button4",DisplayMode:"Medium"}}]}]}]},{name:"Layout",attrs:{Title:"Small"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button1",DisplayMode:"Large"}}]}]},{name:"Section",attrs:{Type:"ThreeRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button2",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button3",DisplayMode:"Small"}}]},{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"button4",DisplayMode:"Small"}}]}]}]},{name:"Layout",attrs:{Title:"Collapsed"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"flyout",DisplayMode:"Large"}}]}]}]}]}]}]}]},window.ViewTabData={name:"CommandUI",attrs:{},children:[{name:"Tab",attrs:{Id:"tabView",Description:"",Title:"STR@L_TabView",Keytip:"STR@l_TabViewKeytip"},children:[{name:"Scaling",attrs:{},children:[{name:"MaxSize",attrs:{Id:"grpViews.Scaling.MaxSize",Sequence:"10",GroupId:"grpViews",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpPageSetup.Scaling.MaxSize",Sequence:"20",GroupId:"grpPageSetup",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpAuthors.Scaling.MaxSize",Sequence:"30",GroupId:"grpAuthors",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpVersions.Scaling.MaxSize",Sequence:"40",GroupId:"grpVersions",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpAccChecker.Scaling.MaxSize",Sequence:"50",GroupId:"grpAccChecker",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpNavigation.Scaling.MaxSize",Sequence:"60",GroupId:"grpNavigation",Size:"Large"}},{name:"MaxSize",attrs:{Id:"grpRibbon.Scaling.MaxSize",Sequence:"0",GroupId:"grpRibbon",Size:"Large"}}]},{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"grpViews",Description:"",Title:"STR@L_GroupNotebookViews",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Alt:"STR@L_EditView",Id:"btnEditOnWeb",Command:"0x13A057F4",QueryCommand:"0x0CC7A13D",TogglesWhenExecuted:"false",LabelText:"STR@L_EditView",Image32by32:"IMGMAP@box43@Edit_32x32x32",TemplateAlias:"button1",Keytip:"STR@l_EditViewKeytip"}},{name:"Button",attrs:{Alt:"STR@L_ReadView",Id:"btnReadingMode",Command:"0xE56FA2A1",IsDefinitive:"true",LabelText:"STR@L_ReadView",Image32by32:"IMGMAP@box43@ReadingMode_32x32x32",TemplateAlias:"button2",Keytip:"STR@l_ReadViewKeytip"}},{name:"Button",attrs:{Alt:"STR@L_ImmersiveView",Id:"btnImmersiveMode",Command:"0x72BE69D3",LabelText:"STR@L_ImmersiveView",Image32by32:"IMGMAP@box43@AudioReader_32x32x32",TemplateAlias:"button3",Keytip:"STR@l_ImmersiveReaderKeytip"}}]}]},{name:"Group",attrs:{Id:"grpPageSetup",Description:"",Title:"STR@L_GroupPageSetup",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"FlyoutAnchor",attrs:{Id:"flyPageColor",Alt:"STR@L_PageColor",Command:"0x568463EB",Image32by32:"IMGMAP@one@WebSetBackground_32x32x32",LabelText:"STR@L_PageColor",Keytip:"STR@l_PageColorKeytip",TemplateAlias:"button1"},children:[{name:"Menu",attrs:{Id:"menuPageColor"},children:[{name:"MenuSection",attrs:{Id:"msPageColor"},children:[{name:"Controls",attrs:{Id:"Background.Page.Color.Menu.Controls"},children:[{name:"ColorPicker",attrs:{Id:"pageColor",Command:"0xFF101154",Width:"4"},children:[{name:"Colors",attrs:{},children:[{name:"Color",attrs:{Color:"ECF3FA",Alt:"STR@L_PageColor_Blue",DisplayColor:"#ECF3FA"}},{name:"Color",attrs:{Color:"EEF8F6",Alt:"STR@L_PageColor_Teal",DisplayColor:"#EEF8F6"}},{name:"Color",attrs:{Color:"F1F9F3",Alt:"STR@L_PageColor_Green",DisplayColor:"#F1F9F3"}},{name:"Color",attrs:{Color:"FCEEEE",Alt:"STR@L_PageColor_Red",DisplayColor:"#FCEEEE"}},{name:"Color",attrs:{Color:"EEF1F9",Alt:"STR@L_PageColor_BlueMist",DisplayColor:"#EEF1F9"}},{name:"Color",attrs:{Color:"F0F8FA",Alt:"STR@L_PageColor_Cyan",DisplayColor:"#F0F8FA"}},{name:"Color",attrs:{Color:"F2F9ED",Alt:"STR@L_PageColor_Apple",DisplayColor:"#F2F9ED"}},{name:"Color",attrs:{Color:"FDF5F5",Alt:"STR@L_PageColor_RedChalk",DisplayColor:"#FDF5F5"}},{name:"Color",attrs:{Color:"F2F1F9",Alt:"STR@L_PageColor_PurpleMist",DisplayColor:"#F2F1F9"}},{name:"Color",attrs:{Color:"F5F7F9",Alt:"STR@L_PageColor_Silver",DisplayColor:"#F5F7F9"}},{name:"Color",attrs:{Color:"F5F9EB",Alt:"STR@L_PageColor_LemonLime",DisplayColor:"#F5F9EB"}},{name:"Color",attrs:{Color:"F6EDE6",Alt:"STR@L_PageColor_Tan",DisplayColor:"#F6EDE6"}},{name:"Color",attrs:{Color:"F9F1F8",Alt:"STR@L_PageColor_Purple",DisplayColor:"#F9F1F8"}},{name:"Color",attrs:{Color:"FDEFF7",Alt:"STR@L_PageColor_Magenta",DisplayColor:"#FDEFF7"}},{name:"Color",attrs:{Color:"FEF8E6",Alt:"STR@L_PageColor_Yellow",DisplayColor:"#FEF8E6"}},{name:"Color",attrs:{Color:"FCF3EA",Alt:"STR@L_PageColor_Orange",DisplayColor:"#FCF3EA"}}]}]}]}]},{name:"MenuSection",attrs:{Id:"msNoPageColor",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"No.Background.Page.Color.Menu.Controls"},children:[{name:"Button",attrs:{Command:"0xE87089DF",LabelText:"STR@L_NoPageColor",Image16by16:"IMGMAP@one@NoHighlight_16x16x32",Keytip:"STR@l_NoPageColorKeytip"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpAuthors",Description:"",Title:"STR@L_GroupAuthors",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Id:"fsbcShowAuthorInfo",Alt:"STR@L_ShowAuthors",Command:"0x8C3942AB",QueryCommand:"0x53A2D8A7",IsDefinitive:"true",Image32by32:"IMGMAP@box43@ShowAuthors_32x32x32",LabelText:"STR@L_ShowAuthors",TemplateAlias:"button1",Keytip:"STR@l_ShowAuthorsKeytip"}}]}]},{name:"Group",attrs:{Id:"grpVersions",Description:"",Title:"STR@L_GroupVersions",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Id:"fsbcShowVersions",Alt:"STR@L_ShowVersions",Command:"0xCCB576ED",QueryCommand:"0x3D948D71",IsDefinitive:"true",Image32by32:"IMGMAP@box43@Versions_32x32x32",LabelText:"STR@L_BrowseVersions",TemplateAlias:"button1",Keytip:"STR@l_BrowseVersionsKeytip"}},{name:"ToggleButton",attrs:{Id:"fsbcToggleRecycleBin",Command:"0x6CFC25BC",QueryCommand:"0x4E06403C",IsDefinitive:"true",Image32by32:"IMGMAP@one@EmptyTrash_32x32x32",LabelText:"STR@L_DeletedNotes",TemplateAlias:"button2",Keytip:"STR@l_DeletedNotesKeytip"}}]}]},{name:"Group",attrs:{Id:"grpAccChecker",Description:"",Title:"STR@L_Accessibility",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Alt:"STR@L_OpenAccessibilityCheckerPane",Id:"btnOpenAccCheckerPane",Command:"0x96C65FEE",QueryCommand:"0x742EBF5E",TogglesWhenExecuted:"true",LabelText:"STR@L_OpenAccessibilityCheckerPane",Image32by32:"IMGMAP@one@AccessibilityChecker_32x32x32",TemplateAlias:"button1",Keytip:"STR@l_OpenAccessibilityCheckerPaneKeytip"}}]}]},{name:"Group",attrs:{Id:"grpNavigation",Description:"",Title:"STR@L_GroupNavigation",Template:"tmpAllLarge"},children:[{name:"Controls",attrs:{Id:"grpSpelling.Controls"},children:[{name:"FlyoutAnchor",attrs:{Id:"fseaNavigationOptions",Alt:"STR@L_NavigationOptions",Command:"0x568463EB",Image32by32:"IMGMAP@one@FramesetTOC_32x32x32",LabelText:"STR@L_NavigationOptions",TemplateAlias:"button1"},children:[{name:"Menu",attrs:{Id:"menuNavigation"},children:[{name:"MenuSection",attrs:{Id:"msNavigation",DisplayMode:"Menu16"},children:[{name:"Controls",attrs:{Id:"msNavigation.Controls"},children:[{name:"ToggleButton",attrs:{Alt:"STR@L_ShowSectionsAndPages",Id:"btnShowSectionsAndPages",Command:"0xADEEADB9",QueryCommand:"0x67E7548B",LabelText:"STR@L_ShowSectionsAndPages",TemplateAlias:"button1"}},{name:"ToggleButton",attrs:{Alt:"STR@L_ShowOnlyPages",Id:"btnShowOnlyPages",Command:"0x383C677C",QueryCommand:"0xD2030858",LabelText:"STR@L_ShowOnlyPages",TemplateAlias:"button1"}},{name:"ToggleButton",attrs:{Alt:"STR@L_HideAll",Id:"btnHideAll",Command:"0xDFC30183",QueryCommand:"0xB95455A9",LabelText:"STR@L_HideAll",TemplateAlias:"button1"}}]}]}]}]}]}]},{name:"Group",attrs:{Id:"grpRibbon",Title:"STR@l_RibbonGroup",Template:"tmpRibbonGroup"},children:[{name:"Controls",attrs:{},children:[{name:"ToggleButton",attrs:{Id:"toggleBtnSimpleRibbon",Command:"0x4FFEF2CD",QueryCommand:"0x5B8DF0D7",IsChecked:"false",UseCheckMark:"true",UseUncheckedImage:"true",LabelText:"STR@l_ToggleRibbonText",Alt:"STR@l_ToggleRibbonText",TemplateAlias:"toggleButtonSimpleRibbon",Keytip:"STR@l_SingleLineRibbonKeyTip"}}]}]}]}]},{name:"Templates",attrs:{},children:[{name:"RibbonTemplates",attrs:{},children:[{name:"GroupTemplate",attrs:{Id:"tmpRibbonGroup"},children:[{name:"Layout",attrs:{Title:"Large"},children:[{name:"Section",attrs:{Type:"OneRow"},children:[{name:"Row",attrs:{},children:[{name:"ControlRef",attrs:{TemplateAlias:"toggleButtonSimpleRibbon",DisplayMode:"Medium"}}]}]}]}]}]}]}]};var Ax=n(3037),Ix=n(2488),wx=n(3149),xx=n(855),Fx=n(1764),Ex=n(5197),Px=n(28),kx=n(7178),Dx=n(4552),Mx=n(4532),Rx=(0,o.y)("IDialogViewFactory"),Lx=(0,o.y)("IBox4DialogFactory"),Nx="LanguageDialog",Bx=function(e){function t(t,n){var r=e.call(this)||this;return r._languageStrategy=null,r._languageListHelper=null,r._currentLcid=0,r._languageList=null,r.dialogHtmlFormat="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' for='LanguageList' >{0}</label> </div> <div class='LanguagesListDiv' id='LanguageListDiv'> <select class='UIFont WACDialogList' id='LanguageList' size='11'> </select> <label id='SpellingLabel' class='WACDialogLabel' >{1}</label> </div> <div class='WACDialogCheckBoxDiv' id='DoNotCheckSpellingBlock'> <input type='checkbox' id='DoNotCheckSpelling' class='WACDialogCheckBox' title='{2}'></input> <label id='\"\"' class='WACDialogLabel' for='DoNotCheckSpelling' >{2}</label> </div>",r._languageStrategy=t,r._languageListHelper=n,r.set_dialogId(Nx),r}return(0,S.t)(t,e),t.prototype.showLanguageDialog=function(){var e;this.set_dialogHtml(this.generateDialogHtml()),this._currentLcid=this._languageStrategy.getSelectedContextLanguage((0,p.m)((function(){return e}),(function(t){return e=t})));var t={LanguageList:10,DoNotCheckSpelling:!e};this.initializeAndShow(Box4Intl.Box4Strings.l_Language,o.i(this,this.setLanguageHandler,"setLanguageHandler"),t),this._languageList=document.getElementById("LanguageList"),this._languageListHelper.populateList(this._languageList,this._currentLcid)},t.prototype.generateDialogHtml=function(){return ri.o.formatHtml(this.dialogHtmlFormat,Box4Intl.Box4Strings.l_MarkSelectedText,Box4Intl.Box4Strings.l_SpellingWillUseLanguage,Box4Intl.Box4Strings.l_DoNotCheckSpelling)},t.prototype.setLanguageHandler=function(e,t){if(us.n.get_instance().get_item(70)){var n=ji.y.get_instance().startActivity(ii.Hj);if(1!==e)return n.get_properties().set_item("canceled","true"),void n.end();var r=t.LanguageList,i=t.DoNotCheckSpelling;if(r>=0){var o=parseInt(this._languageList.value);this._languageStrategy.setSelectedContextLanguage(o,i),n.get_properties().set_item("PreviousLCID",this._currentLcid.toString()),n.get_properties().set_item("ChangedLCID",o.toString()),n.get_properties().set_item("NoProof",i.toString()),this._languageListHelper.setLanguageAsMostRecentlyUsed(o,this._currentLcid)}Br.App.get_activeAppFrame().updateCommandUI(!0),n.end()}},t}(ri.o);(0,o.l)(Bx,"LanguageDialog",ri.o,[uh]);var Ox=function(){function e(e,t,n,r){this._businessBar=null,this._businessBarEntryFactory=null,this._actionManager=null,this._appSettingsManager=null,this._corruptPageEntry=null,this._dictationSilenceEntry=null,this._dictationDebugInfoEntry=null,this._oldBrowserBusinessBarEntry=null,this._fileAccessBusinessBarEntry=null,this._unsupportedObjEntry=null,this._unsupportedObjSquelched=!1,this._businessBar=e,this._businessBarEntryFactory=t,this._actionManager=n,this._appSettingsManager=r}return e.prototype.performInitChecks=function(){this.checkCorruptPageBusinessBar(),this.checkCurrentPageStatusBusinessBars(),this.checkDocumentStatusBusinessBars(),this.checkFileAccessBusinessBar(),this.checkUnsupportedBrowserBusinessBar()},e.prototype.checkCurrentPageStatusBusinessBars=function(){},e.prototype.checkDocumentStatusBusinessBars=function(){},e.prototype.checkSessionExpirationBusinessBar=function(e,t){},e.prototype.checkCorruptPageBusinessBar=function(){var e=this,t=Br.App.get_activeAppFrame().workspace.get_activePage();t&&this.updateTextEntryHelper((0,p.m)((function(){return e._corruptPageEntry}),(function(t){return e._corruptPageEntry=t})),1,2===Br.App.get_activeAppFrame().get_mode()&&t.get_isCorrupt(),Box4Intl.Box4Strings.l_BusinessBarReadonlyCorruptContent)},e.prototype.get_iE9SoftBlockIsEnabled=function(){return!!this._appSettingsManager&&this._appSettingsManager.getBooleanAppSetting("IE9SoftBlockIsEnabled")},e.prototype.get_iE10SoftBlockIsEnabled=function(){return!!this._appSettingsManager&&this._appSettingsManager.getBooleanAppSetting("IE10SoftBlockIsEnabled")},e.prototype.get_isUnsupportedBrowserBusinessBar=function(){return!!Br.App.unsupportedBrowserBusinessBarIsEnabled&&(this.get_iE10SoftBlockIsEnabled()?G.y.get_isInternetExplorerNonEdge()&&!G.y.get_isInternetExplorer11Up():this.get_iE9SoftBlockIsEnabled()?G.y.get_isInternetExplorerNonEdge()&&!G.y.get_isInternetExplorer10Up():G.y.get_isInternetExplorerNonEdge()&&!G.y.get_isInternetExplorer9Up())},e.prototype.checkUnsupportedBrowserBusinessBar=function(){this.get_isUnsupportedBrowserBusinessBar()&&!this._oldBrowserBusinessBarEntry&&(this._oldBrowserBusinessBarEntry=this._businessBarEntryFactory.create("",CommonUIStrings.l_UnsupportedBrowser,null),this._oldBrowserBusinessBarEntry.set_id(15),this._oldBrowserBusinessBarEntry.set_closeable(!0),gb.Redirect.isHelpAvailable()&&this._oldBrowserBusinessBarEntry.addButton(Box4Intl.Box4Strings.L_LearnMore,kg.u.unsupportedBrowserHandler,""),this._businessBar.addEntry(this._oldBrowserBusinessBarEntry,!1))},e.prototype.checkFileAccessBusinessBar=function(){var e=this,t=null,n=Br.App.get_activeAppFrame().workspace.get_activeSection();if(n){var r=n.get_outboundReplicationStatus();_T.c(r)?22===r?t=Box4Intl.Box4Strings.l_BusinessBarQuotaExceeded:19===r||20===r?t=G.y.get_isIPad()?Box4Intl.Box4Strings.l_BusinessBarVirusNoCopy:Box4Intl.Box4Strings.l_BusinessBarVirus:21===r?t=Box4Intl.Box4Strings.l_BusinessBarMinorVersionLimitExceeded:23===r?t=G.y.get_isIPad()?Box4Intl.Box4Strings.l_BusinessBarFileSizeExceededNoCopy:Box4Intl.Box4Strings.l_BusinessBarFileSizeExceeded:7===r&&(t=Box4Intl.Box4Strings.l_BusinessBarWriteAccessDenied):2!==Br.App.get_activeAppFrame().get_mode()||_T.a(n.get_accessRights())||Br.App.get_isReviewer()||(t=Box4Intl.Box4Strings.l_SectionLockedInfoText)}this.updateTextEntryHelper((0,p.m)((function(){return e._fileAccessBusinessBarEntry}),(function(t){return e._fileAccessBusinessBarEntry=t})),5,!!t,t)},e.prototype.setUnsupportedObjectBusinessBar=function(e){var t=this;!!this._unsupportedObjEntry===e||this._unsupportedObjSquelched||(e?(this._unsupportedObjEntry=this._businessBarEntryFactory.create("",Box4Intl.Box4Strings.l_BusinessBarUnsupportedObjectsOnPage,null),this._unsupportedObjEntry.set_id(13),this._unsupportedObjEntry.set_closeable(!0),this._unsupportedObjEntry.set_closeHandler((function(){t._unsupportedObjSquelched=!0,t._unsupportedObjEntry=null})),this._businessBar.addEntry(this._unsupportedObjEntry)):(this._businessBar.removeEntry(this._unsupportedObjEntry),this._unsupportedObjEntry=null))},e.prototype.showDocChatFailedBusinessBar=function(){var e=this._businessBarEntryFactory.create(null,CommonUIStrings.l_ChatIsNotAvailable,null);e.set_closeable(!0),e.set_id(17),this._businessBar.addEntry(e)},e.prototype.showGdprPrivacyNoticeWithCloseCallback=function(e,t,n,r){var i=this._businessBarEntryFactory.create(null,e,null);i.set_closeable(!0),i.set_id(23),i.set_image(3),i.addLinkWithHandler(t,(function(){Bt.g.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+n)})),r&&i.set_closeHandler(r),this._businessBar.addEntry(i,!0)},e.prototype.showGdprPrivacyNotice=function(e,t,n){this.showGdprPrivacyNoticeWithCloseCallback(e,t,n,null)},e.prototype.showDatacenterDecommissionWarning=function(e){var t=this._businessBarEntryFactory.create(null,e,null);t.set_closeable(!0),t.set_id(24),t.set_image(1),this._businessBar.addEntry(t,!0)},e.prototype.showIRMPolicyDescription=function(e){var t=this._businessBarEntryFactory.create(null,e,null);t.set_closeable(!0),t.set_id(20),this._businessBar.addEntry(t)},e.prototype.showDictationSilenceWarning=function(e,t){this._dictationSilenceEntry||(this._dictationSilenceEntry=this._businessBarEntryFactory.create(e,t,null),this._dictationSilenceEntry.set_closeable(!0),this._dictationSilenceEntry.set_id(27),this._businessBar.addEntry(this._dictationSilenceEntry))},e.prototype.hideDictationSilenceWarning=function(){var e=this;this._dictationSilenceEntry&&this.updateTextEntryHelper((0,p.m)((function(){return e._dictationSilenceEntry}),(function(t){return e._dictationSilenceEntry=t})),27,!1,"")},e.prototype.showDictationDebugInfo=function(e){var t=this;this.updateTextEntryHelper((0,p.m)((function(){return t._dictationDebugInfoEntry}),(function(e){return t._dictationDebugInfoEntry=e})),30,!0,e)},e.prototype.hideDictationDebugInfo=function(){var e=this;this.updateTextEntryHelper((0,p.m)((function(){return e._dictationDebugInfoEntry}),(function(t){return e._dictationDebugInfoEntry=t})),30,!1,"")},e.prototype.updateTextEntryHelper=function(e,t,n,r,i,o,a,s,l){void 0===i&&(i=!1),void 0===o&&(o=""),void 0===a&&(a=null),void 0===s&&(s=null),void 0===l&&(l=null),n?e.val?e.val.set_message(r):(e.val=this._businessBarEntryFactory.create(o,r,null),e.val.set_id(t),e.val.set_closeable(i),a&&e.val.addButton(a.text,a.invokeHandler,a.screenReaderText),s&&e.val.addLinkWithHandler(s.text,s.invokeHandler),l&&e.val.set_closeHandler(l),this._businessBar.addEntry(e.val,!1)):e.val&&(this._businessBar.removeEntry(e.val),e.val=null)},e.prototype.addBusinessBarEntry=function(e,t){this._businessBar.addEntry(e,t)},e}();(0,o.l)(Ox,"BusinessBarController$1",null,[wx.d]);var Ux=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r,i)||this;return o._kickoutWithDataLossEntry=null,o}return(0,S.t)(t,e),t.prototype.getKickoutBusinessBar=function(e,t,n,r,i,o,a){var s=this;if(void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=2),void 0===a&&(a=null),this._kickoutWithDataLossEntry)return null;this._kickoutWithDataLossEntry=this._businessBarEntryFactory.create(t,n||"",null),this._kickoutWithDataLossEntry.set_id(6),this._kickoutWithDataLossEntry.set_image(o),e&&this._kickoutWithDataLossEntry.set_errorCode(e),this._kickoutWithDataLossEntry.set_closeable(!1);var l=L.AFrameworkApplication.showFeedbackButton&&this._appSettingsManager.getBooleanAppSetting("ShowFeedbackButtonOnKickoutBusinessBar");return r?(this._kickoutWithDataLossEntry.addButton(r,i,""),l&&this._kickoutWithDataLossEntry.addSecondButton(WoncaIntl.WoncaStrings.L_GiveFeedback,(function(t){s.giveFeedbackButtonHandler(t,e)}),"")):l&&this._kickoutWithDataLossEntry.addButton(WoncaIntl.WoncaStrings.L_GiveFeedback,(function(t){s.giveFeedbackButtonHandler(t,e)}),""),this._businessBar.addEntry(this._kickoutWithDataLossEntry,void 0,a),this._kickoutWithDataLossEntry},t.prototype.giveFeedbackButtonHandler=function(e,t){C.ULS.sendTraceTag(36471966,338,15,"Feedback given after kickout: {0}",{ErrorCode:t}),this._actionManager.processActionWithData(te.KO,2,{ErrorCode:t})},t.get_pageReader=function(){return Qc.PageReader.get_instance()},t}(Ox);(0,o.l)(Ux,"BusinessBarController$0",Ox,[Ix.d,wx.d]);var Hx=function(){function e(){}return e.get_conflictPageBusinessBarContextMenu=function(){return e._conflictPageBusinessBarContextMenu||(e._conflictPageBusinessBarContextMenu=se.w.get_instance().tryResolve(Mx.b))},e.onInvokeConflictPageBusinessBar=function(t,n){var r=null;return r=1===n.get_inputSource()?t.get_getPointForContextMenu():n.get_clientPoint(),e.get_conflictPageBusinessBarContextMenu()&&e.get_conflictPageBusinessBarContextMenu().showAt(r,n.get_inputSource()),!0},e.onInvokeHasConflictsBusinessBar=function(e,t){var n=L.AFrameworkApplication.get_theActionManager();return n.set_commandLocation(10),n.set_invocationMethod(t.get_inputSource()),n.processAction(ii.lH,2),!0},e._conflictPageBusinessBarContextMenu=null,e}();(0,o.l)(Hx,"ConflictPageBusinessBar",null,[]);var Gx=function(e){function t(t,n,r,i){var o=e.call(this,t,n,r,i)||this;return o._canvasSizeExceededBusinessBarEntry=null,o._quotaExceededBusinessBarEntry=null,o._currentPageStatusEntry=null,o._currentSessionExpirationEntry=null,o}return(0,S.t)(t,e),t.prototype.setCanvasSizeExceededBusinessBar=function(e){e?this._canvasSizeExceededBusinessBarEntry||(this._canvasSizeExceededBusinessBarEntry=this._businessBarEntryFactory.create(Box4Intl.Box4Strings.l_CanvasSizeExceededTitle,Box4Intl.Box4Strings.l_CanvasSizeExceededMessage,null),this._canvasSizeExceededBusinessBarEntry.set_id(0),this._canvasSizeExceededBusinessBarEntry.set_closeable(!1),this._canvasSizeExceededBusinessBarEntry.set_image(2),this._businessBar.addEntry(this._canvasSizeExceededBusinessBarEntry,!1)):this._canvasSizeExceededBusinessBarEntry&&(this._businessBar.removeEntry(this._canvasSizeExceededBusinessBarEntry),this._canvasSizeExceededBusinessBarEntry=null)},t.prototype.checkFileAccessBusinessBar=function(){var t=this,n=Br.App.get_activeAppFrame().workspace.get_activeSection();if(n){var r=n.get_outboundReplicationStatus();if(_T.c(r)){if((22===r||7===r)&&Wr.App.get_instance().get_isSyncUxFeatureEnabled())return;if(22===r)return void this.updateQuotaExceededEntryHelper((0,p.m)((function(){return t._quotaExceededBusinessBarEntry}),(function(e){return t._quotaExceededBusinessBarEntry=e})),5,!0);this.updateQuotaExceededEntryHelper((0,p.m)((function(){return t._quotaExceededBusinessBarEntry}),(function(e){return t._quotaExceededBusinessBarEntry=e})),5,!1)}}e.prototype.checkFileAccessBusinessBar.call(this)},t.prototype.checkCurrentPageStatusBusinessBars=function(){var e=Br.App.get_activeAppFrame().workspace.get_activePage();e&&(Ux.get_pageReader().isConflictPageNode(e)?this.updateCurrentPageStatusEntryHelper(G.y.get_isIPad()?Box4Intl.Box4Strings.l_BusinessBarConflictPageInfoNoCopy:Box4Intl.Box4Strings.l_BusinessBarConflictPageInfo,Mv.t.conflictBusinessBarID,Hx.onInvokeConflictPageBusinessBar,!0):Ux.get_pageReader().isVersionNode(e)?this.updateCurrentPageStatusEntryHelper(String.format(G.y.get_isIPad()?Box4Intl.Box4Strings.l_BusinessBarVersionInfoNoCopy:Box4Intl.Box4Strings.l_BusinessBarVersionInfo,Ux.get_pageReader().getVersionNumber(e)+1),Mv.t.versionsBusinessBarID,o.i(t.get_versionBusinessBarContextMenu(),t.get_versionBusinessBarContextMenu().onInvokeVersionHistoryBusinessBar,"onInvokeVersionHistoryBusinessBar"),!0):2===Br.App.get_activeAppFrame().get_mode()&&(Ux.get_pageReader().isFromThePast(e)||_T.i(t.get_pageNavigator().getContainingSection(e)))?this.updateCurrentPageStatusEntryHelper(Box4Intl.Box4Strings.l_BusinessBarReadonlyOldContent):2===Br.App.get_activeAppFrame().get_mode()&&(Ux.get_pageReader().isFromTheFuture(e)||_T.S(t.get_pageNavigator().getContainingSection(e)))?this.updateCurrentPageStatusEntryHelper(Box4Intl.Box4Strings.l_BusinessBarReadonlyFutureContent):Ux.get_pageReader().hasConflictPages(e)?this.updateCurrentPageStatusEntryHelper(Ux.get_pageReader().areConflictPagesVisible(e)?Box4Intl.Box4Strings.l_BusinessBarMergeConflictPresentAndVisible:Box4Intl.Box4Strings.l_BusinessBarMergeConflictPresent,Mv.t.conflictBusinessBarID,Hx.onInvokeHasConflictsBusinessBar):L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteClassNotebookPageLockIsEnabled")&&Wr.App.get_isCurrentUserNotebookGuest()&&Ux.get_pageReader().isLockedPageNode(e)?this.updateCurrentPageStatusEntryHelper(Box4Intl.Box4Strings.l_BusinessBarReadonlyPageLocked):this._currentPageStatusEntry&&(this._businessBar.removeEntry(this._currentPageStatusEntry),this._currentPageStatusEntry=null))},t.prototype.checkSessionExpirationBusinessBar=function(e,t){var n=this;(ei.c.get_instance().checkAndTriggerSessionHasExpired()||t)&&this.showSessionExpirationEntry(OneNoteIntl.OneNoteStrings.l_SessionExpiredBusinessBarText,CommonUIStrings.l_SessionExpirationRefreshButton,(function(t){Br.App.get_activeAppFrame().set_mode(e),n.refreshPage(t)}))},t.prototype.refreshPage=function(e){Br.App.get_activeAppFrame().refreshDocument(null)},t.prototype.showSessionExpirationEntry=function(e,t,n){this._currentSessionExpirationEntry||(this._currentSessionExpirationEntry=this._businessBarEntryFactory.create("",e,null),this._currentSessionExpirationEntry.set_id(7),this._currentSessionExpirationEntry.addButton(t,n,""),this._businessBar.addEntry(this._currentSessionExpirationEntry,!1))},t.prototype.updateCurrentPageStatusEntryHelper=function(e,t,n,r){void 0===t&&(t=null),void 0===n&&(n=null),void 0===r&&(r=!1),this._currentPageStatusEntry?this._currentPageStatusEntry.set_message(e):(this._currentPageStatusEntry=this._businessBarEntryFactory.create("",e,n),this._currentPageStatusEntry.set_id(2),t&&this._currentPageStatusEntry.set_containerID(t),this._businessBar.addEntry(this._currentPageStatusEntry)),this._currentPageStatusEntry.set_invokeHandler(n),this._currentPageStatusEntry.set_invokeActionIsContextMenu(r)},t.prototype.updateQuotaExceededEntryHelper=function(e,t,n){n?e.val?e.val.set_message(L.AFrameworkApplication.get_isSkyDrive()?OneNoteIntl.OneNoteStrings.L_QuotaExceededInOneDrive:OneNoteIntl.OneNoteStrings.L_QuotaExceededInSPO):(e.val=this._businessBarEntryFactory.create("",L.AFrameworkApplication.get_isSkyDrive()?OneNoteIntl.OneNoteStrings.L_QuotaExceededInOneDrive:OneNoteIntl.OneNoteStrings.L_QuotaExceededInSPO,null),e.val.set_id(t),e.val.set_closeable(!1),this._businessBar.addEntry(e.val,!1)):e.val&&(this._businessBar.removeEntry(e.val),e.val=null)},t.get_versionBusinessBarContextMenu=function(){return t._versionBusinessBarContextMenu||(t._versionBusinessBarContextMenu=se.w.get_instance().resolve(Dx.x))},t.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},t._versionBusinessBarContextMenu=null,t}(Ux);(0,o.l)(Gx,"BusinessBarController",Ux,[ni.d,Ix.d,wx.d]);var Vx=n(2594),Wx=function(){function e(){}return e.get_pageClicked=function(){return e._pageClicked},e.set_pageClicked=function(t){return e._pageClicked=t,t&&e.set_versionClicked(null),t},e.get_versionClicked=function(){return e._versionClicked},e.set_versionClicked=function(t){return e._versionClicked=t,t&&e.set_pageClicked(null),t},e._pageClicked=null,e._versionClicked=null,e.sectionClicked=null,e.conflictPageClicked=null,e}();(0,o.l)(Wx,"ContextMenuData",null,[]);var zx=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.createContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+ii.hJ,e.Command=""+te.Hx,Vx.r.createContextMenuControl(e,"mnuConflictPage","NavPaneNotebookContextMenu","Navigation pane notebook context menu","Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(ii.hJ,cl.U,t.populateContextMenu,96)},t.prototype.show=function(e,n){t._inited||(this.createContextMenu(),t._inited=!0),Wx.conflictPageClicked=n,Vx.r.showContextMenu("mnuConflictPage",e)},t.prototype.showAt=function(e,n){t._inited||(this.createContextMenu(),t._inited=!0),Wx.conflictPageClicked=Br.App.get_activeAppFrame().workspace.get_activePage(),Vx.r.showContextMenuAt("mnuConflictPage",e,n)},t.get_pageReader=function(){return Qc.PageReader.get_instance()},t.populateContextMenu=function(e,t,n,r,i){if(1===n)return 32;var o=i,a=new Sys.StringBuilder;return a.append(String.format('<Menu Id="{0}">',"mnuConflictPage")),a.append('<MenuSection Id="msConflictPageActions" DisplayMode="Menu16"><Controls>'),a.append(Vx.r.generateButtonXml("fseaToggleConflictPagesVisibility",ii.lH,null,Box4Intl.Box4Strings.l_HideConflictPages)),a.append(Vx.r.generateButtonXml("fseaDeleteConflictPage",ii.to,"Delete_16x16x32",Box4Intl.Box4Strings.l_DeletePage)),a.append("</Controls></MenuSection></Menu>"),o.PopulationXML=a.toString(),32},t._inited=!1,t}(Vx.r);(0,o.l)(zx,"ConflictPageBusinessBarContextMenu",Vx.r,[Mx.b]);var Kx=n(3573),qx=function(e){function t(){var t=e.call(this)||this;return t.noteTagClicked=null,t}return(0,S.t)(t,e),t.prototype.get_noteTagClicked=function(){return this.noteTagClicked},t.prototype.createMenus=function(){this.createContextMenu(!0),this.createContextMenu(!1)},t.prototype.createContextMenu=function(e){var n={PopulateDynamically:"true",PopulateOnlyOnce:"false"};n.PopulateQueryCommand=""+(e?eb.Eh:eb.bJ),n.Command=""+te.Hx,Vx.r.createContextMenuControl(n,e?"mnuNoteTagMark":"mnuNoteTagClear",Jn.l.xmlEncode(OneNoteIntl.OneNoteStrings.L_NoteTags),Jn.l.xmlEncode(OneNoteIntl.OneNoteStrings.L_NoteTags),"Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(e?eb.Eh:eb.bJ,cl.U,e?t.populateContextMenuMark:t.populateContextMenuClear,100)},t.prototype.show=function(e,n){t._inited||(this.createMenus(),t._inited=!0),this.noteTagClicked=n,DT.q(n)&&DT.d(n)?Vx.r.showContextMenu("mnuNoteTagClear",e):Vx.r.showContextMenu("mnuNoteTagMark",e)},t.populateContextMenuClear=function(e,n,r,i,o){return 1===r?32:(o.PopulationXML=t.createMenuXml(!1),32)},t.populateContextMenuMark=function(e,n,r,i,o){return 1===r?32:(o.PopulationXML=t.createMenuXml(!0),32)},t.createMenuXml=function(e){var t=new Sys.StringBuilder;return t.append(String.format('<Menu Id="{0}" Title="{1}" Description="{2}">',"mnuNoteTagMark",OneNoteIntl.OneNoteStrings.L_NoteTags,OneNoteIntl.OneNoteStrings.L_NoteTags)),t.append('<MenuSection Id="msNoteTagCommands" DisplayMode="Menu16"><Controls>'),t.append(Vx.r.generateButtonXml("fseaNoteTagMark",eb.DQ,"1_16_M_16x16x32",e?OneNoteIntl.OneNoteStrings.L_NoteTagMark:OneNoteIntl.OneNoteStrings.L_NoteTagClear)),t.append(Vx.r.generateButtonXml("fseaNoteTagRemove",eb.nB,"JotActionItemRemoveAll_16x16x32",OneNoteIntl.OneNoteStrings.L_NoteTagRemove)),t.append("</Controls></MenuSection></Menu>"),t.toString()},t._inited=!1,t}(Vx.r);(0,o.l)(qx,"NoteTagContextMenu",Vx.r,[xx.v]);var jx=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.createContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+ii.aO,e.Command=""+te.Hx,Vx.r.createContextMenuControl(e,"mnuNavPaneNotebook","","","Menu16"),L.AFrameworkApplication.get_theActionManager().addAction(ii.aO,cl.U,t.populateContextMenu)},t.prototype.show=function(e){t._inited||(this.createContextMenu(),t._inited=!0),Vx.r.showContextMenu("mnuNavPaneNotebook",e)},t.populateContextMenu=function(e,t,n,r,i){if(1===n)return 32;var o=i,a=new Sys.StringBuilder;return a.append(String.format('<Menu Id="{0}">',"mnuNavPaneNotebook")),a.append('<MenuSection Id="msNotebook" DisplayMode="Menu16"><Controls>'),a.append(Vx.r.generateButtonXml("fseaNotebookNewPage",ii.lz,"JotNewPageAtSectionEnd_16x16x32",OneNoteIntl.OneNoteStrings.L_NewPage)),a.append(Vx.r.generateButtonXml("fseaNotebookNewSection",ii.NE,"JotInsertSection_16x16x32",OneNoteIntl.OneNoteStrings.L_NewSection)),a.append("</Controls></MenuSection></Menu>"),o.PopulationXML=a.toString(),32},t._inited=!1,t}(Vx.r);(0,o.l)(jx,"NotebookNavPaneContextMenu",Vx.r,[Fx.f]);var $x=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.createContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+ii.iK,e.Command=""+te.Hx,Vx.r.createContextMenuControl(e,"mnuOutline","","","Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(ii.iK,cl.U,t.populateContextMenu,100)},t.prototype.show=function(e,n){t._inited||(this.createContextMenu(),t._inited=!0),Vx.r.showContextMenuAt("mnuOutline",e,n)},t.populateContextMenu=function(e,n,r,i,o){if(1===r)return 32;var a=o,s=a.inputMethod,l=a.actionData,c=new Sys.StringBuilder;return c.append(String.format('<Menu Id="{0}">',"mnuOutline")),c.append('<MenuSection Id="msOutlineClipboard" DisplayMode="Menu16"><Controls>'),c.append(Vx.r.generateButtonXml("fseaCut",ii.pZ,"Cut_16x16x32",Box4Intl.Box4Strings.L_Cut)),c.append(Vx.r.generateButtonXml("fseaCopy",ii.xx,"Copy_16x16x32",Box4Intl.Box4Strings.L_Copy)),c.append(Vx.r.generateButtonXml("fseaPaste",ii.LS,"Paste_16x16x32",Box4Intl.Box4Strings.L_Paste)),3===s&&c.append(Vx.r.generateButtonXml("fseaDelete",ii.Dx,"Delete_16x16x32",Box4Intl.Box4Strings.L_Delete)),c.append("\r\n\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t</MenuSection>"),3===s||Br.App.get_activeAppFrame().workspace.get_contentView().get_isSingleOutlineLayout()||t.createMoveResizeSection(c),c.append("</Menu>"),l.PopulationXML=c.toString(),32},t.createMoveResizeSection=function(e){e.append('<MenuSection Id="msOutline" DisplayMode="Menu16">\r\n\t\t\t\t\t\t<Controls>'),e.append(Vx.r.generateButtonXml("fseaMoveOutline",ii.un,null,Box4Intl.Box4Strings.l_OutlineMove)),e.append(Vx.r.generateButtonXml("fseaResizeOutline",ii.Sr,null,Box4Intl.Box4Strings.l_OutlineResize)),e.append("\r\n\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t</MenuSection>")},t._inited=!1,t}(Vx.r);(0,o.l)($x,"OutlineContextMenu",Vx.r,[]);var Qx=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.show=function(e,n){t.showHelper(n),Vx.r.showContextMenu("mnuNavPanePage",e)},t.prototype.showAt=function(e,n,r){t.showHelper(n),Vx.r.showContextMenuAt("mnuNavPanePage",e,r)},t.get_pageReader=function(){return Qc.PageReader.get_instance()},t.createContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+ii.Ty,e.Command=""+te.Hx,Vx.r.createContextMenuControl(e,"mnuNavPanePage","","","Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(ii.Ty,cl.U,t.populateContextMenu,96)},t.populateContextMenu=function(e,n,r,i,o){if(1===r)return 32;var a=o;return t._floating?t.populateFloatingContextMenu(a):t.populatePageContextMenu(a),32},t.populatePageContextMenu=function(e){var n,r;L.AFrameworkApplication.get_isRtl()?(n="CustomFieldGraphicalIndicatorLeftArrow_16x16x32",r="CustomFieldGraphicalIndicatorRightArrow_16x16x32"):(n="CustomFieldGraphicalIndicatorRightArrow_16x16x32",r="CustomFieldGraphicalIndicatorLeftArrow_16x16x32");var i=Box4Intl.Box4Strings.L_ShowVersionsContextMenu;t.get_pageReader().areVersionsVisible(Wx.get_pageClicked())&&(i=Box4Intl.Box4Strings.l_HideVersions);var o=new Sys.StringBuilder;o.append(String.format('<Menu Id="{0}">',"mnuNavPanePage")),o.append('<MenuSection Id="msDelete" DisplayMode="Menu16"><Controls>'),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyPastePageIsEnabled")&&(o.append(Vx.r.generateButtonXml("fseaCopyPage",eb.JM,"Copy_16x16x32",Box4Intl.Box4Strings.L_Copy)),o.append(Vx.r.generateButtonXml("fseaPastePage",eb.Fq,"Paste_16x16x32",Box4Intl.Box4Strings.L_Paste))),o.append(Vx.r.generateButtonXml("fseaDeletePage",ii.El,"Delete_16x16x32",OneNoteIntl.OneNoteStrings.L_DeletePage)),o.append('"\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>\r\n\t\t\t\t<MenuSection Id="msMoveCopyPage" DisplayMode="Menu16">\r\n\t\t\t\t\t<Controls>'),o.append(Vx.r.generateButtonXml("fseaMoveCopyPage",eb.CH,"JotMovePages_16x16x32",OneNoteIntl.OneNoteStrings.L_MoveOrCopyContextualMenuItem)),o.append('"\r\n\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t<MenuSection Id="msNewPage" DisplayMode="Menu16">\r\n\t\t\t\t\t\t<Controls>'),o.append(Vx.r.generateButtonXml("fseaNewPageAfterThisPage",ii.UV,"JotNewPageAtSectionEnd_16x16x32",OneNoteIntl.OneNoteStrings.L_NewPage)),o.append('"\r\n\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t<MenuSection Id="msIndent" DisplayMode="Menu16">\r\n\t\t\t\t\t\t<Controls>'),o.append(Vx.r.generateButtonXml("fseaIncreaseIndent",ii.UY,n,OneNoteIntl.OneNoteStrings.L_MakeSubpage)),o.append(Vx.r.generateButtonXml("fseaDecreaseIndent",ii.oC,r,OneNoteIntl.OneNoteStrings.L_PromoteSubpage)),o.append('"\r\n\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t<MenuSection Id="msVersions" DisplayMode="Menu16">\r\n\t\t\t\t\t\t<Controls>'),o.append(Vx.r.generateButtonXml("fseaToggleVersionsVisibility",ii.iP,"Versions_16x16x32",i)),Br.App.hostUrl&&""!==Br.App.hostUrl&&(o.append('"\r\n\t\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t\t<MenuSection Id="msVersions" DisplayMode="Menu16">\r\n\t\t\t\t\t\t\t<Controls>'),o.append(Vx.r.generateButtonXml("fseaGetPageUrl",ii.XS,"WebInsertHyperlink_16x16x32",Box4Intl.Box4Strings.l_GetPageUrlOptionText))),o.append("</Controls></MenuSection></Menu>"),e.PopulationXML=o.toString()},t.populateFloatingContextMenu=function(e){var t=new Sys.StringBuilder;t.append(String.format('<Menu Id="{0}">',"mnuNavPanePage")),t.append('<MenuSection Id="msFloating" DisplayMode="Menu16"><Controls>'),t.append(Vx.r.generateButtonXml("fseaNewPage",ii.lz,"JotNewPageAtSectionEnd_16x16x32",OneNoteIntl.OneNoteStrings.L_NewPage)),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyPastePageIsEnabled")&&t.append(Vx.r.generateButtonXml("fseaPastePageInSection",eb.dg,"Paste_16x16x32",Box4Intl.Box4Strings.L_Paste)),t.append("</Controls></MenuSection></Menu>"),e.PopulationXML=t.toString()},t.showHelper=function(e){t._inited||(t.createContextMenu(),t._inited=!0),!e||_T.D(Da.GraphIterator.createFromNode(e))?(Wx.sectionClicked=e,t._floating=!0):(Wx.set_pageClicked(e),Wx.sectionClicked=ay.getSection(Wx.get_pageClicked()),t._floating=!1)},t._inited=!1,t._floating=!1,t}(Vx.r);(0,o.l)(Qx,"PageNavPaneContextMenu",Vx.r,[Ex.w]);var Jx=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.show=function(e,n){t.ensureContextMenuIsCreated(n),Vx.r.showContextMenu("mnuRecycleBinPageNavPanePage",e),Wx.set_pageClicked(n)},t.createContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+eb.zf,e.Command=""+te.Hx,Vx.r.createContextMenuControl(e,"mnuRecycleBinPageNavPanePage","","","Menu16"),L.AFrameworkApplication.get_theActionManager().addAction(eb.zf,cl.U,t.populateContextMenu)},t.populateContextMenu=function(e,n,r,i,o){if(1===r)return 32;var a=o;return t.populatePageContextMenu(a),32},t.populatePageContextMenu=function(e){var t=new Sys.StringBuilder;t.append(String.format('<Menu Id="{0}">',"mnuRecycleBinPageNavPanePage")),t.append('<MenuSection Id="msDelete" DisplayMode="Menu16"><Controls>'),t.append(Vx.r.generateButtonXml("fseaRestorePage",eb.ce,"JotMovePages_16x16x32",OneNoteIntl.OneNoteStrings.L_RestorePage)),t.append(Vx.r.generateButtonXml("fseaDeletePage",eb.PZ,"Delete_16x16x32",OneNoteIntl.OneNoteStrings.L_PermanentlyDeletePage)),t.append("</Controls></MenuSection></Menu>"),e.PopulationXML=t.toString()},t.ensureContextMenuIsCreated=function(e){t._inited||(t.createContextMenu(),t._inited=!0)},t._inited=!1,t}(Vx.r);(0,o.l)(Jx,"RecycleBinPageNavPaneContextMenu",Vx.r,[kx.d]);var Xx=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.createContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+ii.By,e.Command=""+te.Hx,Vx.r.createContextMenuControl(e,"mnuNavPaneSection","","","Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(ii.By,cl.U,2===Br.App.get_activeAppFrame().get_mode()?t.populateEditModeContextMenu:t.populateReadingModeContextMenu,96)},t.prototype.showHelper=function(e){Wx.sectionClicked=e,t._inited||(this.createContextMenu(),t._inited=!0)},t.prototype.show=function(e,t){this.showHelper(t),Vx.r.showContextMenu("mnuNavPaneSection",e)},t.prototype.showAt=function(e,t,n){this.showHelper(t),Vx.r.showContextMenuAt("mnuNavPaneSection",e,n)},t.populateEditModeContextMenu=function(e,n,r,i,o){if(1===r)return 32;var a=o,s=new Sys.StringBuilder;return s.append(String.format('<Menu Id="{0}">',"mnuNavPaneSection")),s.append('<MenuSection Id="msModify" DisplayMode="Menu16"><Controls>'),s.append(Vx.r.generateButtonXml("fseaRenameSection",ii.PQ,null,OneNoteIntl.OneNoteStrings.L_RenameSection)),s.append(Vx.r.generateButtonXml("fseaDeleteSection",ii.jS,"Delete_16x16x32",OneNoteIntl.OneNoteStrings.L_DeleteSection)),Wx.sectionClicked.get_isPasswordProtectedUnlockable()&&Wx.sectionClicked.get_encryptionSessionString()&&s.append(Vx.r.generateButtonXml("fseaLockSection",ii.hm,null,Box4Intl.Box4Strings.l_LockSection)),t.generateSectionColorMenu(s),s.append('"\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>\r\n\t\t\t\t<MenuSection Id="msNew" DisplayMode="Menu16">\r\n\t\t\t\t\t<Controls>'),s.append(Vx.r.generateButtonXml("fseaNewPageInSection",ii.TX,"JotNewPageAtSectionEnd_16x16x32",OneNoteIntl.OneNoteStrings.L_NewPage)),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyPastePageIsEnabled")&&s.append(Vx.r.generateButtonXml("fseaPastePageInSection",eb.dg,"Paste_16x16x32",Box4Intl.Box4Strings.L_Paste)),s.append(Vx.r.generateButtonXml("fseaNewSectionAfterSection",ii.yn,"JotInsertSection_16x16x32",OneNoteIntl.OneNoteStrings.L_NewSection)),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopySectionLinkIsEnabled")&&s.append(Vx.r.generateButtonXml("fseaGetSectionUrlSection",eb.op,"WebInsertHyperlink_16x16x32",OneNoteIntl.OneNoteStrings.L_GetSectionUrlOptionText)),s.append("</Controls></MenuSection></Menu>"),a.PopulationXML=s.toString(),32},t.populateReadingModeContextMenu=function(e,t,n,r,i){if(1===n)return 32;var o=i,a=new Sys.StringBuilder;return a.append(String.format('<Menu Id="{0}">',"mnuNavPaneSection")),a.append('<MenuSection Id="msModify" DisplayMode="Menu16"><Controls>'),Wx.sectionClicked.get_isPasswordProtectedUnlockable()&&Wx.sectionClicked.get_encryptionSessionString()&&a.append(Vx.r.generateButtonXml("fseaLockSection",ii.hm,null,Box4Intl.Box4Strings.l_LockSection)),a.append('"\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>\r\n\t\t\t</Menu>'),o.PopulationXML=a.toString(),32},t.generateSectionColorMenu=function(e){e.append('<FlyoutAnchor\r\n\t\t\t\t\tId="fsfaSectionColor"\r\n\t\t\t\t\tCommand="'),e.append("2373580415"),e.append('"\r\n\t\t\t\t\tLabelText="'),e.append(Jn.l.xmlEncode(Box4Intl.Box4Strings.l_SectionColor)),e.append('">\r\n\t\t\t\t\t<Menu Id="menuSectionColor">\r\n\t\t\t\t\t\t<MenuSection Id="msSectionColor" DisplayMode="Menu16">\r\n\t\t\t\t\t\t\t<Controls>');for(var n=1;n<=17;n++)if(17!==n){var r=Xy.o.nameForNotebookColor(n);e.append(Tu.Ff("fseaSectionColor"+n.toString(),n.toString(),"2858610352","2329507668",r,r,t.iconForNotebookColor(n)))}e.append('\t\t\t</Controls>\r\n\t\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t\t<MenuSection Id="msSectionColorNone" DisplayMode="Menu16">\r\n\t\t\t\t\t\t\t<Controls>'),e.append(Tu.Ff("fseaSectionColorNone","0","2858610352","2329507668",Box4Intl.Box4Strings.l_NotebookColorNone)),e.append("\r\n\t\t\t\t\t\t\t</Controls>\r\n\t\t\t\t\t\t</MenuSection>\r\n\t\t\t\t\t</Menu>\r\n\t\t\t\t</FlyoutAnchor>")},t.iconForNotebookColor=function(e){switch(e){case 1:return"JotNotebookColor4_16x16x32";case 4:return"JotNotebookColor7_16x16x32";case 12:return"JotNotebookColor12_16x16x32";case 13:return"JotNotebookColor13_16x16x32";case 9:return"JotNotebookColor9_16x16x32";case 8:return"JotNotebookColor1_16x16x32";case 2:return"JotNotebookColor2_16x16x32";case 3:return"JotNotebookColor3_16x16x32";case 16:return"JotNotebookColor16_16x16x32";case 5:return"JotNotebookColor5_16x16x32";case 11:return"JotNotebookColor11_16x16x32";case 6:return"JotNotebookColor8_16x16x32";case 10:return"JotNotebookColor10_16x16x32";case 15:return"JotNotebookColor15_16x16x32";case 7:return"JotNotebookColor6_16x16x32";case 14:return"JotNotebookColor14_16x16x32";default:return""}},t._inited=!1,t}(Vx.r);(0,o.l)(Xx,"SectionNavPaneContextMenu",Vx.r,[Px.c]);var Yx=function(){function e(){}return e.prototype.showContextMenuForSelection=function(t,n){this.get_canShowContextMenu()&&this.showContextMenuForType(t,n,e.get_menuTypeForCurrentSelection(),e.get_currentSelection())},e.prototype.showContextMenuForType=function(t,n,r,i){switch(r){case 1:case 6:case 2:case 3:case 4:e.get_editSurfaceContextMenu().show(i,t,n)}},e.prototype.menuForSelectionHasAssociatedFloatie=function(){switch(e.get_menuTypeForCurrentSelection()){case 5:case 1:return!0;default:return!1}},e.prototype.currentSelectionType=function(){return e.get_menuTypeForCurrentSelection()},e.prototype.get_canShowContextMenu=function(){return 1!==Br.App.get_activeAppFrame().get_state()},e.get_editSurfaceContextMenu=function(){return e._editSurfaceContextMenu||(e._editSurfaceContextMenu=se.w.get_instance().resolve(gg.n))},e.getMenuTypeForSelection=function(e){if(!e)return 0;if(2!==Br.App.get_activeAppFrame().get_mode())return 4;if(!(us.n.get_instance().get_item(17)&&1===e.get_length()&&vc.isOutlineContext(e.get_firstContext())&&Br.App.get_activeAppFrame().workspace.get_contentView()&&Br.App.get_activeAppFrame().workspace.get_contentView().get_isPageView())){var t=e.get_firstContext().get_node();return(n=Da.GraphIterator.createFromNode(t)).tryToRootAtPageContent(),gy.x(n.get_currentNode())?2:L.AFrameworkApplication.userNameUnknown||!af.EmbeddedFileReader.isEmbeddedFileNode(t)||af.EmbeddedFileReader.isInvalid(t)?kC.isIFrameContext(e.get_firstContext())||kC.isFloatingIFrameContext(e.get_firstContext())?6:1:3}var n;return(n=Da.GraphIterator.createFromNode(e.get_firstContext().get_node())).tryToRootAtPageContent(),Hr.b(n)?0:5},e.get_currentSelection=function(){return Oa.SelectionManager.get_instance().get_selectionCollection().get_currentSelection()},e.get_menuTypeForCurrentSelection=function(){return e.getMenuTypeForSelection(e.get_currentSelection())},e._editSurfaceContextMenu=null,e}();(0,o.l)(Yx,"SelectionContextMenuProvider$0",null,[cg.f]);var Zx=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.showContextMenuForType=function(n,r,i,o){5===i?t.get_outlineContextMenu().show(n,r):e.prototype.showContextMenuForType.call(this,n,r,i,o)},t.get_outlineContextMenu=function(){return t._outlineContextMenu||(t._outlineContextMenu=se.w.get_instance().resolve($x))},t._outlineContextMenu=null,t}(Yx);(0,o.l)(Zx,"SelectionContextMenuProvider",Yx,[]);var eF=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.createContextMenu=function(){var e={PopulateDynamically:"true",PopulateOnlyOnce:"false"};e.PopulateQueryCommand=""+ii.bt,e.Command=""+te.Hx,Vx.r.createContextMenuControl(e,"mnuVersion","","","Menu16"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(ii.bt,cl.U,t.populateContextMenu,96)},t.prototype.show=function(e,n){t._inited||(this.createContextMenu(),t._inited=!0),Wx.set_versionClicked(n),Vx.r.showContextMenu("mnuVersion",e)},t.prototype.showAt=function(e,n){t._inited||(this.createContextMenu(),t._inited=!0),Wx.set_versionClicked(Br.App.get_activeAppFrame().workspace.get_activePage()),Vx.r.showContextMenuAt("mnuVersion",e,n)},t.prototype.onInvokeVersionHistoryBusinessBar=function(e,t){var n=null;return n=1===t.get_inputSource()?e.get_getPointForContextMenu():t.get_clientPoint(),this.showAt(n,t.get_inputSource()),!0},t.get_pageReader=function(){return Qc.PageReader.get_instance()},t.populateContextMenu=function(e,t,n,r,i){if(1===n)return 32;var o=i,a=new Sys.StringBuilder;return a.append(String.format('<Menu Id="{0}">',"mnuVersion")),a.append('<MenuSection Id="msVersionActions" DisplayMode="Menu16"><Controls>'),a.append(Vx.r.generateButtonXml("fseaToggleVersionsVisibilityBusinessBar",ii.iP,"Versions_16x16x32",Box4Intl.Box4Strings.l_HideVersions)),a.append(Vx.r.generateButtonXml("fseaRestoreVersion",ii.QN,null,Box4Intl.Box4Strings.l_RestoreVersion)),a.append(Vx.r.generateButtonXml("fseaDeleteVersion",ii.Bm,"Delete_16x16x32",Box4Intl.Box4Strings.l_DeletePage)),a.append("</Controls></MenuSection></Menu>"),o.PopulationXML=a.toString(),32},t._inited=!1,t}(Vx.r);(0,o.l)(eF,"VersionBusinessBarContextMenu",Vx.r,[Dx.x]);var tF=function(){return function(){this.preExecCommand=null,this.postExecCommand=null,this.applyQueryResult=null,this.applySpinnerQueryResult=null}}();(0,o.l)(tF,"GeneralCuiUserHooks",null,[]);var nF=n(2760),rF=function(e){function t(t){var n=e.call(this)||this;return n.hasMultipleIndentTypes=!1,n.layoutAlignmentInParent=t.layoutAlignmentInParent,n.isRtl=t.isRtl,n.indentInfo=t.indentInfo,n.spacing=t.spacing,n.listInfo=t.listInfo,n.listType=t.listType,n}return(0,S.t)(t,e),t}(qu.n);(0,o.l)(rF,"CumulativeParagraphFormattingData",qu.n,[]);var iF=n(5854),oF=function(){return function(){this.unit=0,this.value=0}}();(0,o.l)(oF,"ParagraphSpacingCommandData",null,[]);var aF=function(e){function t(n){void 0===n&&(n=null);var r=e.call(this)||this;return t.appSettingsManager=n,r}return(0,S.t)(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.executeFunctions.set_item(ii.zV,o.i(this,this.applyStyleExecuteBridge,"applyStyleExecuteBridge")),this.executeFunctions.set_item(ii.Gk,t.bulletsExecuteBridge),this.executeFunctions.set_item(ii.EB,t.fontColorExecuteBridge),this.executeFunctions.set_item(ii.UM,t.fontColorExecuteBridge),this.executeFunctions.set_item(ii.WN,Yu.fontExecuteBridge),this.executeFunctions.set_item(ii.iX,t.fontColorExecuteBridge),this.executeFunctions.set_item(ii.pV,t.fontColorExecuteBridge),this.executeFunctions.set_item(ii.EN,t.fontColorExecuteBridge),this.executeFunctions.set_item(ii.xj,t.fontColorExecuteBridge),this.executeFunctions.set_item(ii.dK,t.imageResizeExecuteBridge),this.executeFunctions.set_item(ii.Lx,t.imageAbsoluteHeightExecuteBridge),this.executeFunctions.set_item(ii.Vx,t.imageAbsoluteWidthExecuteBridge),this.executeFunctions.set_item(ii.FW,t.imageAltTextTitleExecuteBridge),this.executeFunctions.set_item(ii.Tj,t.imageAltTextDescriptionExecuteBridge),this.executeFunctions.set_item(ii.Fk,t.imageLockAspectRatioExecuteBridge),this.executeFunctions.set_item(ii.EO,t.paraIndentExecuteBridge),this.executeFunctions.set_item(ii.Mm,t.paraIndentExecuteBridge),this.executeFunctions.set_item(ii.OY,t.paraIndentExecuteBridge),this.executeFunctions.set_item(ii.gH,t.insertTableExecuteBridge),this.executeFunctions.set_item(ii.w,t.lineSpacingExecuteBridge),this.executeFunctions.set_item(ii.nQ,t.numberingExecuteBridge),this.executeFunctions.set_item(ii.Ff,t.multilevelExecuteBridge),this.executeFunctions.set_item(ii.tr,t.orientationExecuteBridge),this.executeFunctions.set_item(ii.Cj,Yu.inputMethodExecuteBridge),this.executeFunctions.set_item(ii.kE,t.setPictureStyleExecuteBridge),this.executeFunctions.set_item(ii.UT,t.paraSpacingExecuteBridge),this.executeFunctions.set_item(ii.Fw,t.paraSpacingExecuteBridge),this.executeFunctions.set_item(ii.ot,Yu.executeBridgeWithNoData),this.executeFunctions.set_item(ii.lG,Yu.executeBridgeWithNoData),this.executeFunctions.set_item(ii.Jm,Yu.executeBridgeWithNoData),this.executeFunctions.set_item(ii.pZ,t.asyncActionExecuteBridge),this.executeFunctions.set_item(ii.xx,t.asyncActionExecuteBridge),this.executeFunctions.set_item(ii.LS,t.asyncActionExecuteBridge),this.executeFunctions.set_item(ii.Zp,t.asyncActionExecuteBridge),this.executeFunctions.set_item(ii.BI,t.asyncActionExecuteBridge),this.executeFunctions.set_item(ii.FP,t.asyncActionExecuteBridge),this.executeFunctions.set_item(ii.GA,t.formattingExecuteBridge),this.executeFunctions.set_item(ii.cx,Yu.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(ii.Nz,Yu.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(ii.Kp,Yu.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(ii.fM,Yu.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(ii.zU,Yu.queryTextRangeStyleDataExecuteBridge),this.executeFunctions.set_item(ii.KK,Yu.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(ii.sd,Yu.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(ii.Vi,Yu.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(ii.Po,t.genericSpinnerQueryExecuteBridge),this.executeFunctions.set_item(ii.hi,t.genericSpinnerQueryExecuteBridge),this.executeFunctions.set_item(ii.wW,t.genericSpinnerQueryExecuteBridge),this.executeFunctions.set_item(ii.sP,t.genericSpinnerQueryExecuteBridge),this.executeFunctions.set_item(ii.zj,t.genericTextBoxQueryExecuteBridge),this.executeFunctions.set_item(ii.JQ,t.genericTextBoxQueryExecuteBridge),this.executeFunctions.set_item(ii.xN,o.i(this,this.imageRotateExecuteBridge,"imageRotateExecuteBridge")),this.executeFunctions.set_item(ii.vp,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.kC,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.qR,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.YX,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.Dq,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.j,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.Hr,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.df,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.rf,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.PC,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.ng,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.En,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.mY,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.Os,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.lY,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.hO,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.bH,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.ex,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.QG,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.jf,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.cR,o.i(this,this.queryParaFormattingExecuteBridge,"queryParaFormattingExecuteBridge")),this.executeFunctions.set_item(ii.rv,o.i(this,this.queryParaFormattingSpinnersExecuteBridge,"queryParaFormattingSpinnersExecuteBridge")),this.executeFunctions.set_item(ii.Bu,o.i(this,this.queryParaFormattingSpinnersExecuteBridge,"queryParaFormattingSpinnersExecuteBridge")),this.executeFunctions.set_item(ii.Pb,o.i(this,this.queryParaFormattingSpinnersExecuteBridge,"queryParaFormattingSpinnersExecuteBridge")),this.executeFunctions.set_item(ii.Nk,o.i(this,this.queryParaFormattingSpinnersExecuteBridge,"queryParaFormattingSpinnersExecuteBridge")),this.enabledFunctions.set_item(ii.kc,Yu.dictionaryPropertySetEnabledBridge),this.enabledFunctions.set_item(ii.vp,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.kC,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.YX,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.Dq,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.j,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.Hr,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.df,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.rf,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.PC,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.ng,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.En,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.mY,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.Os,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.lY,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.hO,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.bH,Yu.remapToQueryParagraphFormattingEnabledBridge),this.enabledFunctions.set_item(ii.d,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.LT,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.Vb,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.Ee,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.rT,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.Tu,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.yT,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.oJ,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.KN,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.bK,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.kP,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.Ye,t.remapToQuerySectionPropertiesEnabledBridge),this.enabledFunctions.set_item(ii.rh,Yu.dictionaryPropertySetEnabledBridge)},t.prototype.getCuiUserHooks=function(){var e=new tF;return e.applyQueryResult=t.applyQueryResult,e.applySpinnerQueryResult=t.applySpinnerQueryResult,e.preExecCommand=null,e.postExecCommand=null,e},t.prototype.applyStyleExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=uC.StylePreviewGenerator.getStyleIdFromControlId(t.SourceControlId,Tc.StyleReader.getStyleSetFromActivePage()),us.n.get_instance().get_item(61)&&!Tc.StyleReader.hasQuickStyles()&&(r.earlyReturnBool=!1,Br.App.get_activeAppFrame().updateCommandUI()),r},t.prototype.queryParaFormattingSpinnersExecuteBridge=function(e,t,n){var r=new Vu;return r.haveCachedValue=this._hasCachedParagraphFormatting,this._hasCachedParagraphFormatting=!0,r.actionToRun=ii.RP,this._paragraphFormattingProperties=new rF(this._paragraphFormattingProperties),r.actionData=this._paragraphFormattingProperties,r.isQuerySpinnerCommand=!0,r},t.prototype.imageRotateExecuteBridge=function(e,t,n){var r=0,i=0;if(t.MenuItemId)switch(t.MenuItemId){case"buttonRotateRight90":r=1,i=90;break;case"buttonRotateLeft90":r=2,i=270;break;case"buttonFlipVertical":r=3;break;case"buttonFlipHorizontal":r=4}else r=0,i=t[Ho.Number];var o=new Vu;return o.actionData=new Kl.DictionaryPropertySet,o.actionData.setValue(zl.k.imageRotateActionType,r),o.actionData.setValue(zl.k.imageRotateAngle,i),o},t.get_listReader=function(){return se.w.get_instance().resolve(ts.c)},t.get_isHighlightStyleWhenDifferentFromSelectionEnabled=function(){return null==t._isHighlightStyleWhenDifferentFromSelectionEnabled&&(L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordHighlightStyleWhenDifferentFromSelectionSettings"),L.AFrameworkApplication.appSettingsManager?t._isHighlightStyleWhenDifferentFromSelectionEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HighlightStyleWhenDifferentFromSelectionIsEnabled"):t._isHighlightStyleWhenDifferentFromSelectionEnabled=!1),t._isHighlightStyleWhenDifferentFromSelectionEnabled},t.applyQueryResult=function(e,n){var r=(0,f.e)(U_.d,e.actionData),i=(0,f.e)(Ku,e.actionData),o=(0,f.e)(qu.n,e.actionData),a=(0,f.e)(Wu,e.actionData),s=!0;switch(e.originalActionId){default:s=Yu.applyQueryResult(e,n);break;case ii.Nz:n[Di.e.On]=r.getValueWithDefault(Boolean,zl.k.showAuthorInfo,!1);break;case ii.sd:n[Di.e.On]=r.getValueWithDefault(Boolean,zl.k.versionsVisible,!1);break;case ii.Kp:n[Di.e.On]=r.getValueWithDefault(Boolean,Kc.b.tableBordersVisible,!1);break;case ii.be:n[_o.g.IsFreeForm]=!0,void 0!==i.fontName&&null!==i.fontName?n[_o.g.Value]=Ps.FormattingReader.getDisplayFontNameWithTheme(i.fontName,i.themeFontIndex):n[_o.g.Value]="";break;case ii.YX:n[Wo.z.On]=t.getListToggleState(o.listInfo,1),n[Wo.z.Image16by16Class]=o.isRtl?Lt.getImageClass("BulletsRTL_16x16x32"):Lt.getImageClass("Bullets_16x16x32");break;case ii.Dq:n[Di.e.On]=t.getListStyleToggleState(o.listInfo,1,1);break;case ii.j:n[Di.e.On]=t.getListStyleToggleState(o.listInfo,1,2);break;case ii.Hr:n[Di.e.On]=t.getListStyleToggleState(o.listInfo,1,3);break;case ii.ng:n[Wo.z.On]=t.getListToggleState(o.listInfo,0),n[Wo.z.Image16by16Class]=o.isRtl?Lt.getImageClass("NumberingRTL_16x16x32"):Lt.getImageClass("Numbering_16x16x32");break;case ii.En:n[Di.e.On]=t.getListStyleToggleState(o.listInfo,0,1);break;case ii.mY:n[Di.e.On]=t.getListStyleToggleState(o.listInfo,0,2);break;case ii.Os:n[Di.e.On]=t.getListStyleToggleState(o.listInfo,0,3);break;case ii.lY:n[Di.e.On]=t.getListStyleToggleState(o.listInfo,0,4);break;case ii.hO:n[Di.e.On]=t.getListStyleToggleState(o.listInfo,0,5);break;case ii.bH:n[So.g.Image16by16Class]=o.isRtl?Lt.getImageClass("OutlineNumberingRTL_16x16x32"):Lt.getImageClass("OutlineNumbering_16x16x32");break;case ii.ex:n[ki.f.Image16by16Class]=o.isRtl?Lt.getImageClass("OutdentRTL_16x16x32"):Lt.getImageClass("Outdent_16x16x32");break;case ii.QG:n[ki.f.Image16by16Class]=o.isRtl?Lt.getImageClass("IndentRTL_16x16x32"):Lt.getImageClass("Indent_16x16x32");break;case ii.qR:n[Di.e.On]=t.shouldHighlightLineSpacing(n.MenuItemId,o);break;case ii.vp:n[Di.e.On]=!o.isRtl,t.registerHomeTabUpdateActionsForTextDirectionChange(o.isRtl,n);break;case ii.kC:n[Di.e.On]=o.isRtl;break;case ii.zU:t.applyQueryResultFontStyle(a,n);break;case ii.fM:n[bo.u.On]=!1;break;case ii.jf:n[Eo.i.Value]=o.isRtl?WoncaIntl.WoncaStrings.L_LabelIndentBeforeRtl:WoncaIntl.WoncaStrings.L_LabelIndentBeforeLtr,n[Eo.i.Image16by16Class]=o.isRtl?Lt.getImageClass("IndentRTL_16x16x32"):Lt.getImageClass("Indent_16x16x32");break;case ii.cR:n[Eo.i.Value]=o.isRtl?WoncaIntl.WoncaStrings.L_LabelIndentAfterRtl:WoncaIntl.WoncaStrings.L_LabelIndentAfterLtr,n[Eo.i.Image16by16Class]=o.isRtl?Lt.getImageClassWithCluster("we_pl","SpinnerIndentAfter_16x16x32"):Lt.getImageClassWithCluster("we_pl","SpinnerIndentRight_16x16x32");break;case ii.PC:n[bo.u.On]=!1,n[bo.u.IsRtl]=o.isRtl?2:1;break;case ii.df:t.performQueryListMarkerBullets(n,o);break;case ii.rf:t.performListMarkerQueryNumbering(n,o);break;case ii.Vi:var l=r.getValueWithDefault(Boolean,zl.k.imageLockAspectRatio,!0);n[Di.e.On]=l;break;case ii.zj:var c=r.getValueWithDefault(String,zl.k.imageAltTextTitle,"");n[jo.Text]=c;break;case ii.JQ:var u=r.getValueWithDefault(String,zl.k.imageAltTextDescription,"");n[jo.Text]=u}return s},t.addReduxActionsToDictionary=function(e,t){t&&t.length>0&&(e[Ni.b.reduxActions]=t)},t.registerHomeTabUpdateActionsForTextDirectionChange=function(e,n){if(er.isSimplifiedReactRibbonUxEnabled()&&er.apiExtensionExists("getHomeTabIconActionsForTextDirectionChange")){var r=appChrome.getHomeTabIconActionsForTextDirectionChange(e);t.addReduxActionsToDictionary(n,r)}},t.registerLayoutTabUpdateActionsForTextDirectionChange=function(e,n){if(er.isSimplifiedReactRibbonUxEnabled()&&er.apiExtensionExists("getLayoutTabIconActionsForTextDirectionChange")){var r=appChrome.getLayoutTabIconActionsForTextDirectionChange(e);t.addReduxActionsToDictionary(n,r)}},t.applyQueryResultFontStyle=function(e,n){if(e&&Tc.StyleReader.isValidStyleContainer(e.styleProperties)){var r=e.styleProperties,i=n.SourceControlId,o=uC.StylePreviewGenerator.styleButtonPrefix.length,a=parseInt(i.substr(o));n[bo.u.InnerHTML]=uC.StylePreviewGenerator.styleGalleryButtonInnerHtml(a);var s=uC.StylePreviewGenerator.styleGalleryButtonText(a),l=Tc.StyleReader.getStyleId(r),c=uC.StylePreviewGenerator.getStyleIdFromControlId(i,Tc.StyleReader.getStyleSetFromActivePage()),u=l===c||r.getValueWithDefault(String,ks.j.linkedStyle,null)===c;if(n[bo.u.On]=u,C.ULS.sendTraceTag(51220765,324,50,"Flag to match styles is : {0}",u),t.get_isHighlightStyleWhenDifferentFromSelectionEnabled()&&u?n[bo.u.InnerHTML]=uC.StylePreviewGenerator.styleGalleryButtonInnerHtml(a,e.isHighlightedStyleDiffFromSelection):n[bo.u.InnerHTML]=uC.StylePreviewGenerator.styleGalleryButtonInnerHtml(a),n[bo.u.Alt]=s,L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var g=(0,O.m)(new cT.n,{Id:i,ExternalId:i,Command:"1040747875",QueryCommand:"3123760305",LabelText:s,Style:uC.StylePreviewGenerator.getCssStyleDictionaryForGalleryButton(a,!0),PreviewStyleLabel:Box4Intl.Box4Strings.L_StylePreviewSampleText});n[bo.u.GalleryButtonProps]=g,t.get_isHighlightStyleWhenDifferentFromSelectionEnabled()&&u&&(n[bo.u.HighlightOn]=e.isHighlightedStyleDiffFromSelection)}}else n[bo.u.InnerHTML]="",n[bo.u.Alt]="",n[bo.u.On]=!1,n[bo.u.GalleryButtonProps]=null},t.performQueryListMarkerBullets=function(e,t){if(t){var n=null,r=null,i=!t.listInfo,o=i?null:t.listInfo.get_propertySet();if(o&&(i=!o.hasProperty(ks.j.listLevelText),1!==t.listInfo.get_listType()))e[bo.u.On]=!1;else{i||(n=o.getValueWithDefault(String,ks.j.listLevelText,null),r=o.getValueWithDefault(String,Kc.b.font,null));var a,s=e.SourceControlId,l="BulletStyleBulletsLibrary_",c=se.w.get_instance().tryResolve(ev),u=l.length,g=parseInt(s.substr(Math.min(s.length-1,u)));if(-1!==s.indexOf(l)){if(i)return void(e[bo.u.On]=!g);a=c.get_listMarkersDictionary().get_value()}else{if(i)return void(e[bo.u.On]=!1);u=(l="BulletStyleDocumentBullets_").length,g=parseInt(s.substr(u)),a=c.get_listMarkersInDocumentDictionary()}var p=of.f(a),d=p.length;if(d>0&&g>=p.length&&(g-=parseInt(p[0])),g<d){var h=a[p[g]];if(h){var _=h.get_levelText(),m=h.get_font();if(n&&r&&_&&m&&n===_&&r===m)return void(e[bo.u.On]=!0)}}e[bo.u.On]=!1}}else e[bo.u.On]=!1},t.performListMarkerQueryNumbering=function(e,n){if(n){var r,i=!1,o=!1,a=t.propertySetForNumbering(n,(0,p.m)((function(){return i}),(function(e){return i=e})),(0,p.m)((function(){return o}),(function(e){return o=e}))),s=e.SourceControlId,l="NumberingStyleNumberingLibrary_",c=se.w.get_instance().tryResolve(sv),u=l.length,g=parseInt(s.substr(Math.min(s.length-1,u))),d=null,h=null;if(-1!==s.indexOf(l)){if(i)return void(g?t.setGalleryButtonLookAndRtl(e,!1,n):e[bo.u.On]=!0);if(d=a.getValueWithDefault(String,ks.j.listLevelText,null),a.getValueWithDefault(String,Kc.b.font,null),h=n.listInfo.get_listStyle()+"",o)return g&&(e[bo.u.IsRtl]=n.isRtl?2:1),void(e[bo.u.On]=!1);r=c.get_listMarkersDictionary().get_value()}else{if(i||o)return void t.setGalleryButtonLookAndRtl(e,!1,n);d=a.getValueWithDefault(String,ks.j.listLevelText,null),a.getValueWithDefault(String,Kc.b.font,null),h=n.listInfo.get_listStyle()+"",u=(l="NumberingStyleDocumentNumbering_").length,g=parseInt(s.substr(u)),r=c.get_listMarkersInDocumentDictionary()}var _=of.f(r),m=_.length;if(m>0&&g>=m&&(g-=parseInt(_[0])),g<m){var f=r[_[g]];if(f){var y=f.get_levelText(),C=f.get_listStyle()+"";if(d&&y&&(d=ZS.generalizeLevelText(d))===(y=ZS.generalizeLevelText(y))&&h&&C&&h===C)return void t.setGalleryButtonLookAndRtl(e,!0,n)}}t.setGalleryButtonLookAndRtl(e,!1,n)}else e[bo.u.On]=!1},t.propertySetForNumbering=function(e,t,n){t.val=!e.listInfo;var r=t.val?null:e.listInfo.get_propertySet();return r&&(t.val=!r.hasProperty(ks.j.listLevelText),e.listInfo.get_listType()&&(n.val=!0)),r},t.setGalleryButtonLookAndRtl=function(e,t,n){e[bo.u.On]=t,e[bo.u.IsRtl]=n.isRtl?2:1},t.applySpinnerQueryResult=function(e,n){var r=e.originalActionId,i=e.actionData,o=!0;switch(r){case ii.Po:var a=e.actionData.getValueWithDefault(Number,zl.k.imageScale,-1);n[Ho.Number]=a,n[Ho.UnitType]=6;break;case ii.hi:var s=Br.App.get_localeMeasurementUnits(),l=e.actionData.getValueWithDefault(Number,zl.k.imageAbsoluteHeight,0),c=Jg.AF(l)*Jg.nk,u=Jg.iG(c,s);n[Ho.Number]=u,n[Ho.UnitType]=s;break;case ii.wW:s=Br.App.get_localeMeasurementUnits();var g=e.actionData.getValueWithDefault(Number,zl.k.imageAbsoluteWidth,0),p=(c=Jg.AF(g)*Jg.nk,Jg.iG(c,s));n[Ho.Number]=p,n[Ho.UnitType]=s;break;case ii.rv:case ii.Bu:var d=i.indentInfo;s=Br.App.get_localeMeasurementUnits();if(d){t.registerLayoutTabUpdateActionsForTextDirectionChange(i.isRtl,n);var h=r===ii.rv?d.indentLeftValue:d.indentRightValue,_=r===ii.rv?d.indentLeftMax:d.indentRightMax;if(2!==s&&(_=Jg.iG(_,s)),n[Ho.MaxValue]=_,h!==Number.MAX_VALUE){var m=r===ii.rv?d.indentLeftUnit:d.indentRightUnit;if(r===ii.rv&&2===d.specialIndentType)if(2===m)h-=Hh.h(d.specialIndentValueTwips);else h-=d.specialIndentValueTwips;h?2===m?s=2:h=Jg.iG(h,s):Br.App.get_isEastAsian()&&(s=2),n[Ho.Number]=h}else n[Ho.Text]="",n[Ho.Number]=Number.NaN,Br.App.get_isEastAsian()&&(s=2);n[Ho.UnitType]=s;var f=void 0,y=void 0;L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactMultilineRibbonEnabled()&&er.selectorExists("getRibbonMode")&&"Multiline"===appChrome.selectors.getRibbonMode()?(f=r===ii.rv?WoncaIntl.WoncaStrings.L_LabelIndentBeforeLtr:WoncaIntl.WoncaStrings.L_LabelIndentAfterLtr,y=r===ii.rv?WoncaIntl.WoncaStrings.L_LabelIndentBeforeRtl:WoncaIntl.WoncaStrings.L_LabelIndentAfterRtl):(f=r===ii.rv?WoncaIntl.WoncaStrings.L_SpinnerIndentBeforeLtr:WoncaIntl.WoncaStrings.L_SpinnerIndentAfterLtr,y=r===ii.rv?WoncaIntl.WoncaStrings.L_SpinnerIndentBeforeRtl:WoncaIntl.WoncaStrings.L_SpinnerIndentAfterRtl);var C=i.isRtl?y:f;n[Ho.Alt]=C}break;case ii.Pb:case ii.Nk:var S=i.spacing;if(S){var v=r===ii.Pb?S.beforeSpacing.value:S.afterSpacing.value;if(-1!==v){var b=r===ii.Pb?S.beforeSpacing.unit:S.afterSpacing.unit;if(1===b)n[Ho.Text]=Box4Intl.Box4Strings.L_SpinnerAuto,n[Ho.Number]=Number.NaN,n[Ho.UnitType]=5;else{s=2===b?4:5;n[Ho.Number]=v,n[Ho.UnitType]=s}}else n[Ho.Text]="",n[Ho.Number]=Number.NaN,n[Ho.UnitType]=Br.App.get_isEastAsian()?4:5}break;case ii.sP:var T=e.actionData.getValueWithDefault(Number,zl.k.imageRotateAngle,0);n[Ho.Number]=T,n[Ho.UnitType]=9;break;default:o=!1}return o},t.asyncActionExecuteBridge=function(e,n,r){var i=new Vu,o=!!t.appSettingsManager&&(G.y.get_isFirefox()&&t.appSettingsManager.getBooleanAppSetting("UseSyncCopyCutCommandOnFirefoxIsEnabled")||G.y.get_isInternetExplorerEdge()&&t.appSettingsManager.getBooleanAppSetting("UseSyncCopyCutCommandOnEdgeIsEnabled")),a=e===ii.pZ||e===ii.xx;return i.executeAsync=!(o&&a),i},t.updateMultilevelListActionProperties=function(e,n,r){var i=t.getListStyleIdFromControlId(r);e.setValue(zl.k.listStyleId,i),nF.p(1,e)},t.multilevelExecuteBridge=function(e,n,r){var i=new Vu;i.actionData=new Kl.DictionaryPropertySet;var o=n.MenuItemId||n.SourceControlId;return t.updateMultilevelListActionProperties(i.actionData,ii.Ff,o),i},t.bulletsExecuteBridge=function(e,n,r){var i=new Vu;i.actionData=new Kl.DictionaryPropertySet;var o=n.MenuItemId||n.SourceControlId;return L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&(o=n.CommandValueId||n.SourceControlId),t.updateListActionProperties(i.actionData,ii.Gk,o),i},t.updateListActionProperties=function(e,n,r){t.get_listReader().get_listSymbolsImprovementsEnabled()?t.updateListActionPropertiesFromControlId(e,n,r):t.updateListActionStyleAndTypeFromControlId(e,n,r)},t.updateListActionPropertiesFromControlId=function(e,n,r){var i=14;n===ii.Gk?i=1:n===ii.nQ&&(i=0);var o=t.getListStyleIdFromControlId(r);e.setValue(zl.k.listStyleId,o),e.setValue(zl.k.listSoftType,i),nF.p(2,e)},t.getListStyleIdFromControlId=function(e){if(!e)return-1;var t=e.split("_");return 2===t.length?parseInt(t[1]):-2},t.updateListActionStyleAndTypeFromControlId=function(e,t,n){var r=14,i=0;if(t===ii.Gk)switch(n){case"buttonBulletStyle1":r=1,i=1;break;case"buttonBulletStyle2":r=1,i=2;break;case"buttonBulletStyle3":r=1,i=3;break;default:r=1,i=0}else if(t===ii.nQ)switch(n){case"buttonNumberStyleDefault":r=0,i=0;break;case"buttonNumberStyle1":r=0,i=1;break;case"buttonNumberStyle2":r=0,i=2;break;case"buttonNumberStyle3":r=0,i=3;break;case"buttonNumberStyle4":r=0,i=4;break;case"buttonNumberStyle5":r=0,i=5;break;default:r=0,i=0}e.setValue(zl.k.listSoftType,r),e.setValue(zl.k.listSoftStyle,i)},t.fontColorExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=t.Color,r.executeAsync=!0,r},t.formattingExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new ju.b(2),r},t.genericSpinnerQueryExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new Kl.DictionaryPropertySet,r.isQuerySpinnerCommand=!0,r},t.genericTextBoxQueryExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new Kl.DictionaryPropertySet,r.isQueryCommand=!0,r},t.imageResizeExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new Kl.DictionaryPropertySet,r.actionData.setValue(zl.k.imageScale,t[Ho.Number]),r},t.imageAbsoluteHeightExecuteBridge=function(e,t,n){var r=new Vu;r.actionData=new Kl.DictionaryPropertySet;var i=t[Ho.Number],o=0;switch(t[Ho.UnitType]){case 7:var a=Hh.H(i,1);o=Jg.vE(a);break;case 3:o=Jg.vE(i);break;case 1:o=Jg.IB(i)}return r.actionData.setValue(zl.k.imageAbsoluteHeight,o),r},t.imageAbsoluteWidthExecuteBridge=function(e,t,n){var r=new Vu;r.actionData=new Kl.DictionaryPropertySet;var i=t[Ho.Number],o=0;switch(t[Ho.UnitType]){case 7:var a=Hh.H(i,0);o=Jg.vE(a);break;case 3:o=Jg.vE(i);break;case 1:o=Jg.IB(i)}return r.actionData.setValue(zl.k.imageAbsoluteWidth,o),r},t.imageAltTextTitleExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new Kl.DictionaryPropertySet,r.actionData.setValue(zl.k.imageAltTextTitle,t[jo.Text]),r},t.imageAltTextDescriptionExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new Kl.DictionaryPropertySet,r.actionData.setValue(zl.k.imageAltTextDescription,t[jo.Text]),r},t.imageLockAspectRatioExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new Kl.DictionaryPropertySet,r.actionData.setValue(zl.k.imageLockAspectRatio,t[Di.e.On]),r},t.insertTableExecuteBridge=function(e,t,n){var r=new Vu,i=new zu;return i.rows=t[Io.Rows],i.columns=t[Io.Columns],r.actionData=i,r},t.lineSpacingExecuteBridge=function(e,n,r){var i=new Vu,o=n.MenuItemId;return i.actionData=t.getLineSpacingMenuValue(o),i},t.numberingExecuteBridge=function(e,n,r){var i=new Vu;i.actionData=new Kl.DictionaryPropertySet;var o=n.MenuItemId||n.SourceControlId;return t.updateListActionProperties(i.actionData,ii.nQ,o),i},t.orientationExecuteBridge=function(e,t,n){var r=!1;switch(t.MenuItemId){case"buttonOrientationPortrait":r=!1;break;case"buttonOrientationLandscape":r=!0}var i=new Vu;return i.actionData=r,i},t.paraIndentExecuteBridge=function(e,t,n){var r=new Vu,i=t[Ho.Number],o=t[Ho.UnitType],a=new iF.b;return 2===o?(a.value=i,a.unit=2):(a.value=Jg.sE(i,o),a.unit=1),r.actionData=a,r},t.paraSpacingExecuteBridge=function(e,t,n){var r=new Vu,i=t[Ho.Text],o=t[Ho.Number],a=t[Ho.UnitType],s=new oF;return i===Box4Intl.Box4Strings.L_SpinnerAuto?(s.value=0,s.unit=1):(s.value=o,s.unit=4===a?2:4),r.actionData=s,r},t.setPictureStyleExecuteBridge=function(e,n,r){var i=new Vu,o=n.SourceControlId;return i.actionData=isNaN(parseInt(o))?t.getPictureStyleNumberId(o):o,i},t.getPictureStyleNumberId=function(e){switch(e){case"PictureStyleSimpleFrameWhite":return"15505";case"PictureStyleBeveledMatte":return"15506";case"PictureStyleMetalFrame":return"15507";case"PictureStyleDropShadow":return"15508";case"PictureStyleReflectedRounded":return"15509";case"PictureStyleSoftEdge":return"15510";case"PictureStyleDoubleFrame":return"15511";case"PictureStyleThickMatte":return"15512";case"PictureStyleSimpleFrameBlack":return"15513";case"PictureStyleBeveledOval":return"15514";case"PictureStyleCompoundFrame":return"15515";case"PictureStyleModerateFrameBlack":return"15516";case"PictureStyleCenterShadow":return"15517";case"PictureStyleRoundedDiagonalCorner":return"15518";case"PictureStyleSnipDiagonalCorner":return"15519";case"PictureStyleModerateFrameWhite":return"15520";case"PictureStyleRotatedWhite":return"15521";case"PictureStylePerspectiveShadow":return"15522";case"PictureStyleRelaxedPerspective":return"15523";case"PictureStyleSoftEdgeOval":return"15524";case"PictureStyleBevelRectangle":return"15525";case"PictureStyleBevelPerspective":return"15526";case"PictureStyleReflectedPerspective":return"15527";case"PictureStyleBevelPerspectiveLeft":return"15528";case"PictureStyleReflectedBevelBlack":return"15529";case"PictureStyleReflectedBevelWhite":return"15530";case"PictureStyleMetalRounded":return"15531";case"PictureStyleMetalOval":return"15532"}return null},t.remapToQuerySectionPropertiesEnabledBridge=function(e){var t=new Gu;return t.actionToRun=ii.Yg,t},t.getListToggleState=function(e,t){return!(null==e)&&e.get_listType()===t},t.getListStyleToggleState=function(e,t,n){return!(null==e)&&e.get_listType()===t&&e.get_listStyle()===n},t.getLineSpacingMenuValue=function(e){return parseFloat(e)},t.shouldHighlightLineSpacing=function(e,n){if(!n.spacing)return!1;if(2!==n.spacing.lineSpacing.unit)return!1;var r=t.getLineSpacingMenuValue(e);return jc.g(n.spacing.lineSpacing.value,r)},t.appSettingsManager=null,t._isHighlightStyleWhenDifferentFromSelectionEnabled=null,t}(Yu);(0,o.l)(aF,"CuiActionBridge$1",Yu,[]);var sF=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.initialize=function(){e.prototype.initialize.call(this),this.executeFunctions.set_item(eb.vw,t.noteTagInsertExecuteBridge),this.executeFunctions.set_item(ii.HA,t.changeSectionColorExecute),this.executeFunctions.set_item(ii.iK,Yu.inputMethodExecuteBridge),this.executeFunctions.set_item(eb.Iy,Yu.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(eb.st,Yu.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(eb.NJ,Yu.queryDictionaryPropertySetExecuteBridge),this.executeFunctions.set_item(eb.KM,Yu.queryDictionaryPropertySetExecuteBridge)},t.prototype.getCuiUserHooks=function(){var e=new tF;return e.applyQueryResult=t.applyQueryResult,e.applySpinnerQueryResult=aF.applySpinnerQueryResult,e.preExecCommand=null,e.postExecCommand=null,e},t.applyQueryResult=function(e,t){var n=!0;switch(e.originalActionId){default:n=aF.applyQueryResult(e,t);break;case eb.Iy:!Wr.App.get_isOneNoteEmbedded()&&Br.App.get_activeAppFrame().workspace.get_isFileAccessStatusKnown()&&(t[So.g.Visible]=Br.App.get_activeAppFrame().workspace.get_isEditingPermissible());break;case eb.st:if(!Wr.App.get_isOneNoteEmbedded()){var r=!1;L.AFrameworkApplication.limitedEdit?r=!1:Br.App.get_activeAppFrame().workspace.get_isFileAccessStatusKnown()&&(r=!Br.App.get_activeAppFrame().workspace.get_isEditingPermissible()),t[ki.f.Visible]=r}break;case eb.NJ:var i=!1;(Wr.App.get_instance().educationUserInfo.retrieved&&(Wr.App.get_instance().educationUserInfo.isO365Subscriber||Wr.App.get_instance().educationUserInfo.isEducation)||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteMathEducationDogfood"))&&(i=!0),Wr.App.get_instance().educationUserInfo.retrieved&&Wr.App.get_instance().educationUserInfo.isTeacher&&Wr.App.get_instance().notebookType&&Wr.App.get_instance().notebookType.retrieved&&Wr.App.get_instance().notebookType.isEduNotebook&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteMathEducationSwitchEnabled")&&(i=!1),t[ki.f.Visible]=i;break;case eb.KM:var o=!1;(Wr.App.get_instance().educationUserInfo.retrieved&&Wr.App.get_instance().educationUserInfo.isTeacher&&Wr.App.get_instance().notebookType&&Wr.App.get_instance().notebookType.retrieved&&Wr.App.get_instance().notebookType.isEduNotebook&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteMathEducationSwitchEnabled")||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteMathEducationSwitchOverride"))&&(o=!0),t[Wo.z.Visible]=o}return n},t.noteTagInsertExecuteBridge=function(e,t,n){var r=new Vu;return r.actionData=new Kl.DictionaryPropertySet,r.actionData.setValue(zl.k.controlId,t.SourceControlId),r},t.changeSectionColorExecute=function(e,t,n){var r=new Vu;return r.actionData=t.MenuItemId,r},t}(aF);(0,o.l)(sF,"CuiActionBridge",aF,[]);var lF=n(1168),cF=(0,o.y)("IDialogViewElement"),uF=n(5332),gF=n(205),pF=function(e){function t(t,n,r,i,o){var a=e.call(this,t,n,r,i,o)||this;return a._clickHandlerCallback=null,a}return(0,S.t)(t,e),t.prototype.onClick=function(e){var t=this;if(this._isLoading)return!0;var n=(0,f.e)(Kr.n,this.get_source());if(!n)return!1;if(this.get_isExpanded())this.set_isExpanded(!1),this.setChildrenVisibility(!1);else if(n.get_isContentPresent()){this.set_isExpanded(!0),this._sectionListUl.childNodes.length?this.setChildrenVisibility(!0):this._clickHandlerCallback&&this._clickHandlerCallback(this.get_sourceNode(),this._sectionListUl)}else{this.setIsLoading(!0);var r=Qb.c.get_instance().createGraphSpaceRootReplicator(n,"DialogSectionGroupLoad");r.forceInbound((function(e){t.set_isExpanded(!0),t.setIsLoading(!1),t._clickHandlerCallback&&t._clickHandlerCallback(t.get_sourceNode(),t._sectionListUl)}),null,null),r.set_shouldUpdateWorkspaceActivePageAfterReplication(!1)}return!0},t.prototype.attachClickEventHandler=function(e){this._clickHandlerCallback=e},t.prototype.setChildrenVisibility=function(e){for(var t=0;t<this._sectionListUl.childNodes.length;t++)this._sectionListUl.childNodes[t].style.display=e?"":"none"},t.prototype.addNavTab=function(e){var n=this.get_htmlViewInstance().createElement("div");n.className="NavSectionGroupTab",n.style.width=t.navSectionGroupTabWidth+"px",e.appendChild(n);var r=this.get_htmlViewInstance().createElement("div");r.className="NavSectionGroupChevronTab",Sys.UI.DomElement.addCssClass(r,"SectionPickerDialogGroupChevronTab"),n.appendChild(r);var i=document.createElement("div");i.className="DialogNavTab",i.style.width=t.dialogNavTabWidth+"px",n.appendChild(i),this.addIconDiv(i,"DialogSectionGroupSkewLeft",t.backIconLeft,t.backIconMarginTop,!1),this.addIconDiv(i,"DialogSectionGroupSkewRight",t.backIconRight,t.backIconMarginTop,!1),this.addIconDiv(i,"DialogSectionGroupSkewLeft",t.frontIconLeft,t.frontIconMarginTop,!0),this.addIconDiv(i,"DialogSectionGroupSkewRight",t.frontIconRight,t.frontIconMarginTop,!0)},t.prototype.addIconDiv=function(e,n,r,i,o){var a=document.createElement("div");a.className=n,a.style.left=r+"px",a.style.marginTop=i+"px",a.className+=" "+t.sectionGroupIconColor,o&&(a.style.borderTop=t.solidWhiteBorder,"DialogSkewLeft"===n?a.style.borderRight=t.solidWhiteBorder:a.style.borderLeft=t.solidWhiteBorder),e.appendChild(a)},t.createDialogGroupNavInstance=function(e,n){return t.createAnInstanceWithResolvedDependencies$5(e,n)},t.createAnInstanceWithResolvedDependencies$5=function(e,n){var r=new t(e,n,hn.s.get_instance(),Xe.KeyInputManager.get_instance(),(function(){return se.w.get_instance().tryResolve(lF.q)}));return r.initialize(),r},t.solidWhiteBorder="1px solid white",t.sectionGroupIconColor="DialogSectionColorUnknown",t.navSectionGroupTabWidth=49,t.dialogNavTabWidth=25,t.backIconMarginTop=10,t.backIconLeft=9,t.backIconRight=4,t.frontIconMarginTop=14,t.frontIconLeft=11,t.frontIconRight=6,t}(gF.MultiColumnSectionGroupNavViewElement);(0,o.l)(pF,"DialogSectionGroupNavViewElement",gF.MultiColumnSectionGroupNavViewElement,[cF,Ay.e,uF.b,Sys.IDisposable]);var dF=n(2334),hF=function(e){function t(t,n,r,i,o){var a=e.call(this,t,n,r,i,o)||this;return a._clickHandlerCallback=null,a}return(0,S.t)(t,e),t.prototype.get_sectionColorCssClass=function(){return null},t.prototype.addNavTab=function(){var e=document.createElement("div");e.className="DialogNavTab",this.addIconDiv(e,"DialogSectionSkewLeft"),this.addIconDiv(e,"DialogSectionSkewRight"),this.sectionHeader.appendChild(e)},t.prototype.addIconDiv=function(e,n){var r=document.createElement("div");r.className=n,r.className+=" "+t.cssDialogColorPrefix+Xy.o.sectionBGRValueToCssClass(this.currentSectionColor),e.appendChild(r)},t.prototype.attachClickEventHandler=function(e){this._clickHandlerCallback=e},t.prototype.onHeaderClick=function(e){return this._clickHandlerCallback&&this._clickHandlerCallback(this.get_sourceNode(),this.get_sectionHeaderContent()),!0},t.prototype.contextMenuHandler=function(e){return!0},t.createDialogSectionNavInstance=function(e,n,r){return t.createAnInstanceWithResolvedDependencies$4(e,n,r)},t.createAnInstanceWithResolvedDependencies$4=function(e,n,r){var i=new t(e,n,r,(function(){return se.w.get_instance().tryResolve(lF.q)}),(function(){return se.w.get_instance().resolve(ja.n)}));return i.expandIfActive(),i},t.cssDialogColorPrefix="Dialog",t}(dF.q);(0,o.l)(hF,"DialogSectionNavViewElement",dF.q,[cF,Ay.e,uF.b,Sys.IDisposable]);var _F=(0,o.y)("IIndentationCommands"),mF=(0,o.y)("IJustificationCommands"),fF=function(){return function(){this.paraSpacingBeforeHandled=!1,this.paraSpacingAfterHandled=!1,this.paraIndentLeftHandled=!1,this.paraIndentRightHandled=!1,this.specialParaIndentHandled=!1}}();(0,o.l)(fF,"Box4PropertySetChangedState",null,[]);var yF=function(){function e(){}return e.get_indentationCommands=function(){return e._indentationCommands||(e._indentationCommands=se.w.get_instance().tryResolve(_F))},e.get_justificationCommands=function(){return e._justificationCommands||(e._justificationCommands=se.w.get_instance().tryResolve(mF))},e.get_spacingCommands=function(){return e._spacingCommands||(e._spacingCommands=se.w.get_instance().tryResolve(Ig))},e.justificationChangedHandler=function(t,n,r,i){if(e.get_justificationCommands()&&r){var o=r;if(null!==n&&11===o){if(10===n||9===n)return}e.get_justificationCommands().setJustification(o)}},e.lineSpacingChangedHandler=function(t,n,r,i){e.get_spacingCommands()&&r&&e.get_spacingCommands().setLineSpacing(r)},e.paraSpacingBeforeChangedHandler=function(t,n,r,i){if(e.get_spacingCommands()&&null!=r){var o=e.getBox4PropertySetChangedState(i);if(!o.paraSpacingBeforeHandled){if(!i.finalPropertySet.hasProperty(zl.k.paraSpacingBeforeUnit)||!i.finalPropertySet.hasProperty(zl.k.paraSpacingBeforeValue))return;var a=i.finalPropertySet.getValue(Number,zl.k.paraSpacingBeforeValue),s=i.finalPropertySet.getValue(Number,zl.k.paraSpacingBeforeUnit);o.paraSpacingBeforeHandled=!0,e.get_spacingCommands().setParagraphSpacing(1,a,s)}}},e.paraSpacingAfterChangedHandler=function(t,n,r,i){if(e.get_spacingCommands()&&null!=r){var o=e.getBox4PropertySetChangedState(i);if(!o.paraSpacingAfterHandled){if(!i.finalPropertySet.hasProperty(zl.k.paraSpacingAfterUnit)||!i.finalPropertySet.hasProperty(zl.k.paraSpacingAfterValue))return;var a=i.finalPropertySet.getValue(Number,zl.k.paraSpacingAfterValue),s=i.finalPropertySet.getValue(Number,zl.k.paraSpacingAfterUnit);o.paraSpacingBeforeHandled=!0,e.get_spacingCommands().setParagraphSpacing(0,a,s)}}},e.paraIndentLeftChangedHandler=function(t,n,r,i){if(e.get_indentationCommands()&&null!=r){var o=e.getBox4PropertySetChangedState(i);if(!o.paraIndentLeftHandled){if(!i.finalPropertySet.hasProperty(zl.k.paraIndentLeftUnit)||!i.finalPropertySet.hasProperty(zl.k.paraIndentLeftValue))return;var a=i.finalPropertySet.getValue(Number,zl.k.paraIndentLeftValue),s=i.finalPropertySet.getValue(Number,zl.k.paraIndentLeftUnit);o.paraIndentLeftHandled=!0,e.get_indentationCommands().setParagraphIndent(1,a,s)}}},e.paraIndentRightChangedHandler=function(t,n,r,i){if(e.get_indentationCommands()&&null!=r){var o=e.getBox4PropertySetChangedState(i);if(!o.paraIndentRightHandled){if(!i.finalPropertySet.hasProperty(zl.k.paraIndentRightUnit)||!i.finalPropertySet.hasProperty(zl.k.paraIndentRightValue))return;var a=i.finalPropertySet.getValue(Number,zl.k.paraIndentRightValue),s=i.finalPropertySet.getValue(Number,zl.k.paraIndentRightUnit);o.paraIndentRightHandled=!0,e.get_indentationCommands().setParagraphIndent(0,a,s)}}},e.specialIndentChangeHandler=function(t,n,r,i){if(e.get_indentationCommands()&&null!=r){var o=e.getBox4PropertySetChangedState(i);if(!o.specialParaIndentHandled){if(!i.finalPropertySet.hasProperty(zl.k.specialIndentByUnit)||!i.finalPropertySet.hasProperty(zl.k.specialIndentByValue))return;var a=0;i.finalPropertySet.hasProperty(zl.k.specialIndent)&&(a=i.finalPropertySet.getValue(Number,zl.k.specialIndent));var s=i.finalPropertySet.getValue(Number,zl.k.specialIndentByValue),l=i.finalPropertySet.getValue(Number,zl.k.specialIndentByUnit);o.specialParaIndentHandled=!0,e.get_indentationCommands().setSpecialIndent(a,s,l)}}},e.getBox4PropertySetChangedState=function(e){return e.customData||(e.customData=new fF),e.customData},e._indentationCommands=null,e._justificationCommands=null,e._spacingCommands=null,e}();(0,o.l)(yF,"ParagraphLevelPropertyChangedHandlers",null,[]);var CF=n(3193),SF=function(){function e(e){this._propertyChangedHandlers=null,this._propertyChangedHandlers=e}return e.prototype.processChangedProperty=function(e,t,n,r){var i=this._propertyChangedHandlers[e.id.toString()];i&&i(e,t,n,r)},e}();(0,o.l)(SF,"PropertyChangedProcessor",null,[]);var vF=n(9768),bF=function(){return function(e){this.finalPropertySet=null,this.customData=null,this.finalPropertySet=e}}();(0,o.l)(bF,"PropertySetChangedState",null,[]);var TF=function(e,t,n){var r=CF.z.get_instance().get_firstNodeForCurrentSelection();if(r){var i=new as.GraphTransaction(15);i.setFromNode(r),function(e,t,n){if(e&&t){var r=new bF(t),i=function(e,t,i){n.processChangedProperty(e,t,i,r)},o=new vF.l(t,e);o.addedCallback=i,o.changedCallback=i,o.removedCallback=i,o.processChanges()}}(e,t,new SF(n)),i.dispose()}},AF=n(5008),IF="ParagraphDialog",wF=function(e){function t(n,r,i,o,a,s){var l=e.call(this)||this;return l._initialDialogProperties=null,l._liveDialogProperties=null,l._isTouch=!1,l._standaloneRoot=null,l._forceDropDownMultiple=!1,l._disposed$4=!1,l.set_dialogId(IF),t.spacingCommands=i,l._standaloneRoot=s,l._initialDialogProperties=n.clone(),l._liveDialogProperties=n.clone(),l._isTouch=r,r&&(l._customCssClass=AF.q),l.set_autoSize(!0),l}return(0,S.t)(t,e),t.prototype.onInnerHtmlSet=function(){t.buildParaSpacingSpinner(t.spinnerSpacingBeforeContainerId,t.spinnerSpacingBeforeControlId,ii.aS,ii.ju,ii.aF,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBeforeAlt,this._standaloneRoot),t.buildParaSpacingSpinner(t.spinnerSpacingAfterContainerId,t.spinnerSpacingAfterControlId,ii.R,ii.mI,ii.mN,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfterAlt,this._standaloneRoot),t.buildLineSpacingAtSpinner(t.spinnerLineSpacingAtContainerId,t.spinnerLineSpacingAtControlId,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAtAlt,this._standaloneRoot),t.buildLineSpacingDropDown(t.lineSpacingContainerId,t.lineSpacingControlId,this._standaloneRoot)},t.prototype.initializeCuiControls=function(){for(var e=0;e<t.spacingSpinnerCommandIds.length;e++)Zu.attachCommandHandlers(t.spacingSpinnerCommandIds[e],o.i(this,this.setAdvancedControlValue,"setAdvancedControlValue"),o.i(this,this.getAdvancedControlValue,"getAdvancedControlValue"));Zu.attachCommandHandlers(ii.cV,o.i(this,this.setDropDownValue,"setDropDownValue"),o.i(this,this.provideDropDownValue,"provideDropDownValue")),Zu.attachCommandHandlers(ii.bn,o.i(this,this.setDropDownValue,"setDropDownValue"),o.i(this,this.provideDropDownValue,"provideDropDownValue")),this._standaloneRoot.pollForStateAndUpdate()},t.prototype.dispose=function(){if(!this._disposed$4){for(var n=0;n<t.spacingSpinnerCommandIds.length;n++)Zu.detachCommandHandlers(t.spacingSpinnerCommandIds[n]);Zu.detachCommandHandlers(ii.cV),Zu.detachCommandHandlers(ii.bn),this._standaloneRoot.removeControl(t.spinnerSpacingBeforeControlId),this._standaloneRoot.removeControl(t.spinnerSpacingAfterControlId),this._standaloneRoot.removeControl(t.spinnerLineSpacingAtControlId),this._standaloneRoot.removeControl(t.lineSpacingControlId),e.prototype.dispose.call(this),this._disposed$4=!0}},t.prototype.getAdvancedControlValue=function(e,n){switch(e){case ii.ju:case ii.mI:var r=e===ii.ju?zl.k.paraSpacingBeforeValue:zl.k.paraSpacingAfterValue,i=e===ii.ju?zl.k.paraSpacingBeforeUnit:zl.k.paraSpacingAfterUnit;if(this._liveDialogProperties.hasProperty(r)&&this._liveDialogProperties.hasProperty(i)){var o=this._liveDialogProperties.getValue(Number,i);if(1===o)n[Ho.Text]=Box4Intl.Box4Strings.L_SpinnerAuto,n[Ho.Number]=Number.NaN,n[Ho.UnitType]=5;else{var a=this._liveDialogProperties.getValue(Number,r),s=2===o?4:5;n[Ho.Number]=a,n[Ho.UnitType]=s}}else n[Ho.Text]="",n[Ho.Number]=Number.NaN,n[Ho.UnitType]=Br.App.get_isEastAsian()?4:5;break;case ii.Er:var l=!1;if(this._liveDialogProperties.hasProperty(zl.k.lineSpacingValue)&&this._liveDialogProperties.hasProperty(zl.k.lineSpacingUnit)&&2===this._liveDialogProperties.getValue(Number,zl.k.lineSpacingUnit)&&(this.isLineSpacingMultiple()||this._forceDropDownMultiple)){var c=t.get_lineSpacingHelper().getLineSpacing(this._liveDialogProperties);c>=t.minLineSpacingAtValue&&(n[Ho.Number]=c,l=!0)}l||(n[Ho.Text]="",n[Ho.Number]=Number.NaN),n[Ho.UnitType]=0}},t.prototype.setAdvancedControlValue=function(e,n){var r=n[Ho.Text],i=n[Ho.Number],o=n[Ho.UnitType];switch(e){case ii.aS:case ii.R:var a=void 0,s=void 0;r===Box4Intl.Box4Strings.L_SpinnerAuto?(a=0,s=1):(a=i,s=4===o?2:4);var l=e===ii.aS?zl.k.paraSpacingBeforeValue:zl.k.paraSpacingAfterValue,c=e===ii.aS?zl.k.paraSpacingBeforeUnit:zl.k.paraSpacingAfterUnit;this._liveDialogProperties.setValue(l,a),this._liveDialogProperties.setValue(c,s);break;case ii.aF:case ii.mN:l=e===ii.aF?zl.k.paraSpacingBeforeValue:zl.k.paraSpacingAfterValue,c=e===ii.aF?zl.k.paraSpacingBeforeUnit:zl.k.paraSpacingAfterUnit;var u=n.Increment;""===r||u&&r===Box4Intl.Box4Strings.L_SpinnerAuto?(this._liveDialogProperties.setValue(l,0),this._liveDialogProperties.setValue(c,4)):i||u||(this._liveDialogProperties.setValue(l,0),this._liveDialogProperties.setValue(c,1));break;case ii.DH:this.setLineSpacingAtValue(i);break;case ii.Tz:""===r&&this.setLineSpacingAtValue(t.minLineSpacingAtValue)}this._standaloneRoot.pollForStateAndUpdate()},t.prototype.setLineSpacingAtValue=function(e){this._liveDialogProperties.setValue(zl.k.lineSpacingUnit,2),this._liveDialogProperties.setValue(zl.k.lineSpacingValue,t.get_lineSpacingHelper().getLineSpacingValueInPropertyUnit(this._liveDialogProperties,e)),this._forceDropDownMultiple=!0,this._standaloneRoot.pollForControlState(t.lineSpacingControlId)},t.prototype.provideDropDownValue=function(e,t){switch(e){case ii.bn:this.provideLineSpacingDropDownValue(t)}},t.prototype.provideLineSpacingDropDownValue=function(e){var n=0,r=!1;(this._liveDialogProperties.hasProperty(zl.k.lineSpacingValue)&&this._liveDialogProperties.hasProperty(zl.k.lineSpacingUnit)||(r=!0),r)||(2!==this._liveDialogProperties.getValue(Number,zl.k.lineSpacingUnit)&&(r=!0),(n=t.get_lineSpacingHelper().getLineSpacing(this._liveDialogProperties))<t.minLineSpacingAtValue&&(r=!0));if(!r){var i=t.lineSpacingMultipleMenuItemId;this._forceDropDownMultiple||this.isLineSpacingMultiple()||(jc.g(n,1)?i="1.00":jc.g(n,1.5)?i="1.50":jc.g(n,2)&&(i="2.00")),e[po.v.SelectedItemId]=i}},t.prototype.setDropDownValue=function(e,t){switch(e){case ii.cV:this.setDialogPropertiesFromLineSpacingDropDown(t)}},t.prototype.setDialogPropertiesFromLineSpacingDropDown=function(e){var n=e.MenuItemId;if(n===t.lineSpacingMultipleMenuItemId)this._liveDialogProperties.setValue(zl.k.lineSpacingUnit,2),this._liveDialogProperties.setValue(zl.k.lineSpacingValue,t.get_lineSpacingHelper().getLineSpacingValueInPropertyUnit(this._liveDialogProperties,3));else{var r=parseFloat(n);this._liveDialogProperties.setValue(zl.k.lineSpacingUnit,2),this._liveDialogProperties.setValue(zl.k.lineSpacingValue,t.get_lineSpacingHelper().getLineSpacingValueInPropertyUnit(this._liveDialogProperties,r))}this._forceDropDownMultiple=!1,this._standaloneRoot.pollForControlState(t.lineSpacingControlId),this._standaloneRoot.pollForControlState(t.spinnerLineSpacingAtControlId)},t.prototype.paragraphDialogResultHandler=function(e,n){1===e&&TF(this._initialDialogProperties,this._liveDialogProperties,t.getPropertyChangedHandlers()),this.dispose()},t.prototype.paragraphDialogCreator=function(e,t){se.w.get_instance().resolve(Lx).createParagraphDialog(this._initialDialogProperties,null,this._isTouch)},t.prototype.isLineSpacingMultiple=function(){if(!this._liveDialogProperties.hasProperty(zl.k.lineSpacingValue)||!this._liveDialogProperties.hasProperty(zl.k.lineSpacingUnit))return!1;if(2!==this._liveDialogProperties.getValue(Number,zl.k.lineSpacingUnit))return!1;var e=t.get_lineSpacingHelper().getLineSpacing(this._liveDialogProperties);return!jc.g(e,1)&&!jc.g(e,1.5)&&!jc.g(e,2)},t.get_lineSpacingHelper=function(){return t._lineSpacingHelper||(t._lineSpacingHelper=se.w.get_instance().resolve(TC.r))},t.getPropertyChangedHandlers=function(){return t._propertyChangedHandlers||(t._propertyChangedHandlers=t.createPropertyChangedHandlers())},t.createPropertyChangedHandlers=function(){var e={};return e[zl.k.lineSpacingValue.id.toString()]=yF.lineSpacingChangedHandler,e[zl.k.paraSpacingAfterValue.id.toString()]=yF.paraSpacingAfterChangedHandler,e[zl.k.paraSpacingAfterUnit.id.toString()]=yF.paraSpacingAfterChangedHandler,e[zl.k.paraSpacingBeforeValue.id.toString()]=yF.paraSpacingBeforeChangedHandler,e[zl.k.paraSpacingBeforeUnit.id.toString()]=yF.paraSpacingBeforeChangedHandler,e},t.buildParaSpacingSpinner=function(e,n,r,i,o,a,s){var l=t.buildParaSpacingSpinnerXml(n,r,i,o,a);t.attachCuiControl(l,e,n,s)},t.buildLineSpacingAtSpinner=function(e,n,r,i){var o=t.buildLineSpacingAtSpinnerXml(n,r);t.attachCuiControl(o,e,n,i)},t.buildLineSpacingDropDown=function(e,n,r){var i=t.buildLineSpacingDropDownXml(n);t.attachCuiControl(i,e,n,r)},t.attachCuiControl=function(e,t,n,r){var i=document.getElementById(t);r.addControl(n,e);var o=r.getDOMElementForControlDisplayMode(n,"Medium");i.appendChild(o)},t.buildParaSpacingSpinnerXml=function(e,n,r,i,o){return Tu.ws(e,n,r,o,[t.buildSpacingUnitPtXml(),t.buildSpacingUnitLineXml()],[Box4Intl.Box4Strings.L_SpinnerAuto],i,t.spinnerWidthPx)},t.buildLineSpacingAtSpinnerXml=function(e,n){return Tu.ws(e,ii.DH,ii.Er,n,[t.buildLineSpacingAtUnitXml()],null,ii.Tz,t.spinnerWidthPx)},t.buildLineSpacingAtUnitXml=function(){return Tu.nf("none","1","132",".5")},t.buildSpacingUnitPtXml=function(){return Tu.nf("point","0","1584","1")},t.buildSpacingUnitLineXml=function(){return Tu.nf("line","0","327","1")},t.buildLineSpacingDropDownXml=function(e){var n=Tu.CQ("DdlLineSpacing_Single","1.00","4294634675",Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingSingle),r=Tu.CQ("DdlLineSpacing_1.5","1.50","4294634675",Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingOneAndHalf),i=Tu.CQ("DdlLineSpacing_Double","2.00","4294634675",Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingDouble),o=Tu.CQ("DdlLineSpacing_Multiple",t.lineSpacingMultipleMenuItemId,"4294634675",Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingMultiple);return Tu.fT(e,ii.cV,ii.bn,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAlt,t.lineSpacingDropDownWidthPx,[n,r,i,o])},t.lineSpacingDropDownWidthPx=150,t.spinnerWidthPx=70,t.minLineSpacingAtValue=1,t.spinnerSpacingBeforeControlId="DialogSpacingBeforeSpinner",t.spinnerSpacingAfterControlId="DialogSpacingAfterSpinner",t.spinnerLineSpacingAtControlId="DialogLineSpacingAtSpinner",t.spinnerSpacingBeforeContainerId="ParagraphDialogSpacingBeforeSpinnerContainer",t.spinnerSpacingAfterContainerId="ParagraphDialogSpacingAfterSpinnerContainer",t.spinnerLineSpacingAtContainerId="ParagraphDialogLineSpacingAtSpinnerContainer",t.lineSpacingContainerId="ParagraphDialogLineSpacingContainer",t.lineSpacingControlId="ParagraphDialogLineSpacingSelect",t.lineSpacingMultipleMenuItemId="multiple",t.spacingSpinnerCommandIds=[ii.aS,ii.R,ii.DH,ii.ju,ii.mI,ii.Er,ii.Tz,ii.mN,ii.aF],t.spacingCommands=null,t._lineSpacingHelper=null,t._propertyChangedHandlers=null,t}(ri.o);(0,o.l)(wF,"ParagraphDialog$0",ri.o,[]);var xF=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,Box4Intl.Box4Strings.l_ParagraphDialogSpacingBefore,Box4Intl.Box4Strings.l_ParagraphDialogSpacingAfter,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacing,Box4Intl.Box4Strings.l_ParagraphDialogLineSpacingAt)},e.dialogHtmlFormat="<div class='WACDialogGroupBox' id='SpacingLabelBox'> <table cellpadding=5 cellspacing=5 role='presentation'> <tr> <td> <label id='ParagraphDialogSpacingBefore' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingBeforeSpinnerContainer' >{0}</label> </td> <td> <div id='ParagraphDialogSpacingBeforeSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingBefore' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogSpacingAfter' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogSpacingAfterSpinnerContainer' >{1}</label> </td> <td> <div id='ParagraphDialogSpacingAfterSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogSpacingAfter' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacing' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingContainer' >{2}</label> </td> <td> <div id='ParagraphDialogLineSpacingContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacing' role='presentation'></div> </td> </tr> <tr> <td> <label id='ParagraphDialogLineSpacingAt' class='DialogSpinnerLabel' aria-hidden='true' for='ParagraphDialogLineSpacingAtSpinnerContainer' >{3}</label> </td> <td> <div id='ParagraphDialogLineSpacingAtSpinnerContainer' class='WacSpinnerBox' aria-labelledby='ParagraphDialogLineSpacingAt' role='presentation'></div> </td> </tr> </table> </div>",e}();(0,o.l)(xF,"ParagraphDialogHtml",null,[]);var FF=function(e){function t(t,n,r,i,a,s){var l=e.call(this,t,n,r,i,a,s)||this;l.set_dialogHtml(xF.get_dialogHtml()),l.initializeAndShow(Box4Intl.Box4Strings.L_ParagraphSpacing,o.i(l,l.paragraphDialogResultHandler,"paragraphDialogResultHandler"),null),l.initializeCuiControls();var c=document.getElementById(wF.spinnerSpacingBeforeControlId);return l.setFocusOnElement(c),l}return(0,S.t)(t,e),t}(wF);(0,o.l)(FF,"ParagraphDialog",wF,[]);var EF=n(6043),PF=n(4336),kF=n(6155),DF=n(4601),MF=function(e){function t(){return e.call(this,new DF.n,eS.g.get_htmlViewRootFactory_DoNotUse(),Br.App.get_theViewManager())||this}return(0,S.t)(t,e),t}(eS.g);(0,o.l)(MF,"SectionPickerHtmlView",eS.g,[]);var RF=function(){function e(){}return e.dialogHtml=function(t){return ri.o.formatHtml(e.dialogHtmlFormat,t)},e.dialogHtmlFormat="<div class='WACDialogRow' id='IntroBlock'> <label id='IntroLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACMultiColumnNavigationPanel' id='NavigationPanel'> <div class='NavHierarchy' id='NavigationSection'> <ul id='NavigationList' class='WACDialogUList'> </ul> </div> </div>",e}();(0,o.l)(RF,"SectionPickerDialogHtml",null,[]);var LF=function(e){function t(){var t=e.call(this)||this;return t._viewFactory=null,t._recycleBinHelper=null,t._destinationGraphNode=null,t._currentSelectedElement=null,t._sectionPickerHtmlView=null,t._viewFactory=se.w.get_instance().resolve(Rx),t._recycleBinHelper=se.w.get_instance().resolve(JT.v),t}return(0,S.t)(t,e),t.prototype.get_destinationGraphNode=function(){return this._destinationGraphNode},t.prototype.getDialogTitle=function(){return""},t.prototype.getIntroLabel=function(){return"Section Picker"},t.prototype.showPickerDialog=function(){this.buildDialogHtmlView(),this.buildDialogViewElements(Br.App.theNotebookManager.get_defaultNotebookNode(),this._sectionPickerHtmlView.get_container())},t.prototype.buildDialogHtmlView=function(){this.set_dialogHtml(RF.dialogHtml(this.getIntroLabel()));this.initializeAndShow(this.getDialogTitle(),o.i(this,this.sectionPickerDialogHandler,"sectionPickerDialogHandler"),{})},t.prototype.onInnerHtmlSet=function(){var e=document.getElementById("WACDialogBodyPanel");e&&(e.style.height="290px");var t=document.getElementById("NavigationSection");t&&(t.setAttribute("role","presentation"),Sys.UI.DomElement.addCssClass(t,"SectionPickerDialogNavHierarchy"));var n=document.getElementById("NavigationList");n&&(n.setAttribute("Class","SectionPickerDialogList"),n.setAttribute("role","tree"),t.appendChild(n),this._sectionPickerHtmlView=new MF,this._sectionPickerHtmlView.bindToContainer(n))},t.prototype.buildDialogViewElements=function(e,t){var n=new vT.m;n.set(e);for(var r=n.goToFirstChild(),i=null,a=new y.c(pF);r;)if(this._recycleBinHelper.isRecycleBinSectionListNode(r))r=n.goToNextSibling();else{if(_T.d(r)){if((i=this._viewFactory.createDialogSectionViewElement(this._sectionPickerHtmlView,r,null)).attachClickEventHandler(o.i(this,this.onSectionClick,"onSectionClick")),!this._destinationGraphNode){this._destinationGraphNode=r;var s=(0,f.e)(EF.m,i);this._currentSelectedElement=s.get_htmlElement()}this.connectAndUpdateViewElement(i,t)}else if(hT.FolderReader.isFolderNode(r)){(i=this._viewFactory.createDialogSectionGroupViewElement(this._sectionPickerHtmlView,r)).attachClickEventHandler(o.i(this,this.onSectionListClick,"onSectionListClick"));var l=new kF.u(this._sectionPickerHtmlView.get_viewId());l.set(r),i.updateHtmlElementTopology(l),a.add(i)}r=n.goToNextSibling()}this._currentSelectedElement&&(this.setHighlight(this._currentSelectedElement,!0),this.setAriaSelectedOnSectionClick(this._currentSelectedElement,!0)),a.Sc(o.i(this,this.compareSectionGroupByName,"compareSectionGroupByName"));for(var c=a.$$lge();c.$$mn();){var u=c.$$cu();this.connectAndUpdateViewElement(u,t)}},t.prototype.connectAndUpdateViewElement=function(e,t){if(e){var n=(0,f.e)(PF.w,e.get_sourceNode());n&&n.connectViewElement(this._sectionPickerHtmlView.get_viewId(),e),e.updateHtmlElementContent(null),t.appendChild(e.get_htmlElement())}},t.prototype.compareSectionGroupByName=function(e,t){return Jn.l.localeCompare(e.getSectionGroupTitle(),t.getSectionGroupTitle())},t.prototype.disconnectViewElements=function(){var e=Br.App.theNotebookManager.get_defaultNotebookNode(),t=new vT.m;t.set(e);for(var n=t.goToFirstChild();n;){if(_T.d(n)||hT.FolderReader.isFolderNode(n)){var r=(0,f.e)(PF.w,n);if(r){var i=r.getHtmlViewElement(this._sectionPickerHtmlView.get_viewId());i&&i.dispose(),r.disconnectViewElement(this._sectionPickerHtmlView.get_viewId())}}n=t.goToNextSibling()}},t.prototype.onSectionClick=function(e,t){e!==this._destinationGraphNode&&(this.setHighlight(this._currentSelectedElement,!1),this.setAriaSelectedOnSectionClick(this._currentSelectedElement,!1),this._currentSelectedElement=t,this.setHighlight(this._currentSelectedElement,!0),this.setAriaSelectedOnSectionClick(this._currentSelectedElement,!0)),this._destinationGraphNode=e},t.prototype.onSectionListClick=function(e,t){var n=(0,f.e)(cA.e,e);n&&this.buildDialogViewElements(n,t)},t.prototype.sectionPickerDialogHandler=function(e,t){this.disconnectViewElements()},t.prototype.setHighlight=function(e,t){e.style.background=t?"rgb(238,238,238)":""},t.prototype.setAriaSelectedOnSectionClick=function(e,t){var n=e.querySelector("div.NavSectionName");if(n){n.setAttribute(Ot.t.ariaLabelAttribute,t?"Selected: Section":"Not Selected: Section");var r=n.querySelector("a[tabindex='0']");r&&r.setAttribute(Ot.t.ariaSelectedAttribute,t?Ot.t.ariaTrueValue:Ot.t.ariaFalseValue)}},t}(ri.o);(0,o.l)(LF,"SectionPickerDialog",ri.o,[]);var NF=function(e){function t(t){var n=e.call(this)||this;return n._sourceGraphNode=null,n._sourceGraphNode=t,n}return(0,S.t)(t,e),t.prototype.get_sourceGraphNode=function(){return this._sourceGraphNode},t.prototype.getDialogTitle=function(){return OneNoteIntl.OneNoteStrings.L_RestorePage},t.prototype.getIntroLabel=function(){return OneNoteIntl.OneNoteStrings.L_RestoreDialogTitle},t.prototype.sectionPickerDialogHandler=function(t,n){if(e.prototype.sectionPickerDialogHandler.call(this,t,n),1===t){var r={};r.source=this.get_sourceGraphNode(),r.destination=this.get_destinationGraphNode(),L.AFrameworkApplication.get_theActionManager().processActionWithData(eb.Io,2,r)}},t}(LF);(0,o.l)(NF,"RestorePageDialog",LF,[]);var BF=function(){function e(){}return e.prototype.createDialogSectionGroupViewElement=function(e,t){return pF.createDialogGroupNavInstance(e,t)},e.prototype.createDialogSectionViewElement=function(e,t,n){return hF.createDialogSectionNavInstance(e,t,n)},e.prototype.showRestorePageDialog=function(e){new NF(e).showPickerDialog()},e.prototype.createParagraphDialog=function(e,t,n){C.ULS.sendTraceTag(40186080,339,50,"ParagraphSpacing:CreateParagraphDialog");var r=se.w.get_instance();return new FF(e,n,r.resolve(Ig),r.resolveLazy($p.d),L.AFrameworkApplication.appSettingsManager,r.resolve(ou.r).get_sharedStandaloneRoot())},e}();(0,o.l)(BF,"DialogViewFactory",null,[Rx,Lx]);var OF=function(){return function(e,t,n,r){this._generalCuiUserFuture=null,this._actionManager=null,this._focusManager=null,this._theStandaloneRoot=null,this._generalCuiUserFuture=e,this._actionManager=t,this._focusManager=n,this._theStandaloneRoot=r}}();(0,o.l)(OF,"WoncaRibbonUserFactory",null,[Tv.x]);var UF=n(2848),HF=(0,o.y)("IRibbonUser$0"),GF=n(7607),VF=n(5376),WF=n(6367),zF=n(9952),KF=n(1026),qF=function(){return function(){this.commandId=0,this.externalUxCommand=null}}();(0,o.l)(qF,"CommandDefinition",null,[]);var jF=function(){return function(){this.getCommandByExternalUxId=null}}();(0,o.l)(jF,"CommandDefinitionMapping",null,[]);var $F=n(8279),QF=n(7398),JF=function(e,t){var n=new wt.z(Boolean);return e.CWo((function(r){if(e.get_isFaulted())n.trySetException(e.get_exception());else if(e.get_isCanceled())n.trySetCanceled();else try{var i=t();i?i.CWo((function(e){i.get_isFaulted()?n.trySetException(i.get_exception()):i.get_isCanceled()?n.trySetCanceled():n.trySetResult(!0)}),gr.d.executeSynchronously):n.trySetCanceled()}catch(e){n.trySetException(e)}}),gr.d.executeSynchronously),n.get_task()},XF=n(7346),YF=n(7120),ZF=n(8177),eE=n(2209),tE=n(8060),nE=function(){function e(e,t){this._elmModalDiv=null,this._modalContainer=null,this._focusManager=null,this._onMouseWheel=null,this._registeredHandlers=!1,this._menuStack=0,this._modalContainer=e,this._focusManager=t,this._onMouseWheel=o.i(this,this.onModalMouseWheel,"onModalMouseWheel")}return e.prototype.onMenuOpen=function(){var e=this;this._menuStack>0?this._menuStack++:(this._menuStack++,L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DelayMenuFocusActionsUntilNextFrameIsEnabled")?window.requestAnimationFrame((function(t){window.setTimeout(o.i(e,e.pushTransientFocusScope,"pushTransientFocusScope"),0)})):this.pushTransientFocusScope(),this.showModal())},e.prototype.pushTransientFocusScope=function(){this._focusManager&&this._focusManager.pushScope($e.AFrame.reactTransientUIFocusId,!0)},e.prototype.showModal=function(){this._elmModalDiv||(this._elmModalDiv=this.createElement("div"),this._elmModalDiv.setAttribute("id","ReactModalDiv"),this._elmModalDiv.style.position="absolute",this._elmModalDiv.style.top="0px",this._elmModalDiv.style.bottom="0px",this._elmModalDiv.style.left="0px",this._elmModalDiv.style.right="0px",this._elmModalDiv.style.backgroundColor="white",this._elmModalDiv.style.opacity="0.0",this._modalContainer.appendChild(this._elmModalDiv)),this._elmModalDiv.style.display="block",this._elmModalDiv.style.visibility="visible",this._elmModalDiv.style.zIndex=String(1e3),this._registeredHandlers||(window.addEventListener("wheel",this._onMouseWheel,!0),xi.z.get_instance().registerHandler(Le.d.pointerDown,this._elmModalDiv,o.i(this,this.onModalPointerDown,"onModalPointerDown")),this._registeredHandlers=!0)},e.prototype.onMenuClose=function(){this._menuStack--,this._menuStack>0||(this._menuStack<0?this._menuStack=0:this.hideModalAndPopScope())},e.prototype.onCloseAllMenus=function(){this._menuStack=0,this.dismissContextMenu(),this.hideModalAndPopScope()},e.prototype.createElement=function(e){var t=document.createElement(e);return t.setAttribute("unselectable","on"),t},e.prototype.hideModalAndPopScope=function(){this._focusManager&&this._focusManager.get_currentScope()&&this._focusManager.get_currentScope().name===$e.AFrame.reactTransientUIFocusId&&!L.AFrameworkApplication.get_theTaskManager().get_isYielding()&&this._focusManager.popScope($e.AFrame.reactTransientUIFocusId,!1),this._elmModalDiv&&(this._elmModalDiv.style.zIndex=String(-1),this._elmModalDiv.style.visibility="hidden",this._elmModalDiv.style.display="none"),this._registeredHandlers&&(window.removeEventListener("wheel",this._onMouseWheel,!0),xi.z.get_instance().unregisterHandler(Le.d.pointerDown,this._elmModalDiv,o.i(this,this.onModalPointerDown,"onModalPointerDown")),this._registeredHandlers=!1)},e.prototype.onModalPointerDown=function(e){return this.dismissContextualUI(),this.onCloseAllMenus(),this._focusManager.setScope($e.AFrame.documentFocusID),!0},e.prototype.onModalMouseWheel=function(e){e.stopPropagation()},e.prototype.dismissContextualUI=function(){var e=se.w.get_instance().tryResolve(au);e&&e.dismissContextualUI()},e.prototype.dismissContextMenu=function(){var e=se.w.get_instance().tryResolve(au);e&&e.dismissContextMenu()},e}();(0,o.l)(nE,"ReactModalDiv",null,[]);var rE=function(){function e(e,t,n,r,i,o,a,s,l){this._ribbonRoot=null,this._rootCommandHandler=null,this._externalUICommandDefinitionMapping=null,this._focusManager=null,this._modalDiv=null,this._ribbonSQMInformation=null,this._fileMenuSQMInformation=null,this._actionManager=null,this._reactRibbonRootPoller=null,this._lastPollTimes=null,this._appSettingsManager=null,this._ribbonRoot=e,this._reactRibbonRootPoller=t,this._rootCommandHandler=(0,f.e)(qg,e),this._externalUICommandDefinitionMapping=n,this._focusManager=r,i&&(this._modalDiv=new nE(i,r)),this._ribbonSQMInformation=o,this._fileMenuSQMInformation=a,this._actionManager=s,this._lastPollTimes={},this._appSettingsManager=l}return e.prototype.get_selectorsAreReady=function(){return!!window.appChrome&&!!appChrome.selectors},e.prototype.executeCommand=function(e,t){if((!Oe.y.get_instance().get_isYielding()||(C.ULS.sendTraceTag(38293640,207,15,"React.ExecuteCommandHandler.ExecuteCommand: TaskManager.Instance.IsYielding, simplifiedUxCommand: {0}, commandHandlerData.ModelType: {1}, commandHandlerData.ModelType.Payload: {2}",e,t.modelType,E.m(t.payload)),!this._appSettingsManager.getBooleanAppSetting("WordEditorReactExecuteYieldReturnIsEnabled")))&&t){var n=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e),r=t.modelType;n?this.executeCommandWithCommandMetadata(e,n,r,t):this.executeCommandWithNoCommandMetadata(e,r,t),this.manageAppFocus(e,t)}},e.prototype.executeCommandWithNoCommandMetadata=function(e,t,n){switch(t){case"GalleryModel":case"PreviewGalleryModel":this.executeGalleryButtonCommand(n,e);break;default:return}},e.prototype.updateParametersForButton=function(e,t,n,r,i){var o=i;if(n.payload)switch(n.payload.type){case"CoauthorMenuPayload":e.MenuItemId=n.payload.coauthorId;break;case"ButtonPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,this.closeAllMenus();break;case"ButtonPreviewPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,o=t.commandPreviewId;break;case"ButtonRevertPreviewPayload":e.MenuItemId=t.menuItemId,e.CommandValueId=n.payload.commandValueId,o=t.commandRevertId;break;default:e.MenuItemId=t.menuItemId}else e.MenuItemId=t.menuItemId;return e.SourceControlId=r,o},e.prototype.updateParametersForTellMe=function(e,t,n){if(t.payload)switch(t.payload.type){case"MenuOpenPayload":e=this._externalUICommandDefinitionMapping.getCommandByExternalUxId("TellMeLogMenuOpen").get_commandId();break;case"MenuClosePayload":e=this._externalUICommandDefinitionMapping.getCommandByExternalUxId("TellMeLogMenuClose").get_commandId();break;case"TellMeMenuItemExecuted":n.CommandId=t.payload.executedControl,n.ControlId=t.payload.executedControl,n.CloseAllMenus=!0,this.closeAllMenus();break;case"TellMeSearchResultChangePayload":n.Value=t.payload.searchText;break;case"SmartLookupPayload":n.CommandValueId=t.payload.selectionContextJson}return e},e.prototype.executeCommandWithCommandMetadata=function(e,t,n,r){var i=this;this.populateControlMenuOnExecute(r,n);var a=t.get_commandId(),s={};switch(n){case"SplitButtonModel":if(this.handleMenuOpenClosePayload(r.payload,o.i(this,this.updateSplitButtonMenuState,"updateSplitButtonMenuState")))return;s.MenuItemId=t.menuItemId,this.setToggledParameter(r,s);break;case"StatefulSplitButtonModel":if(this.handleMenuOpenClosePayload(r.payload,o.i(this,this.updateStatefulSplitButtonMenuState,"updateStatefulSplitButtonMenuState")))return;var l=r.payload.statefulData,c=r.payload.statefulMode;if("color"===c)s.Color=l;else if("icon"===c){var u=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(l);u&&(s.MenuItemId=u.menuItemId)}break;case"FileMenu":s.MenuItemId=t.menuItemId,s.SourceControlId=e,r.payload&&"FileMenuPageSwitchPayload"===r.payload.type&&this.handleFileMenuPageSwitch(a,r.payload,e);break;case"TellMe":a=this.updateParametersForTellMe(a,r,s),s.SourceControlId=e;break;case"ButtonModel":r.payload&&"TabSwitchPayload"===r.payload.type?this.handleTabSwitch(s,r):a=this.updateParametersForButton(s,t,r,e,a);break;case"CompoundButtonModel":s.MenuItemId=t.menuItemId,s.CommandValueId=r.payload.commandValueId,s.SourceControlId=e,this.setToggledParameter(r,s),this.closeAllMenus();break;case"ToggleButtonModel":s.MenuItemId=t.menuItemId,s.SourceControlId=e,this.setToggledParameter(r,s),this.closeAllMenus();break;case"ComboBoxModel":var g=r.payload.type;switch(g){case"MenuOpenPayload":case"MenuPopulatePayload":if(this.shouldPoll(e))(d={})[r.payload.launcherId]=n,this._reactRibbonRootPoller.pollForStateAndUpdateCommands(d),this._lastPollTimes[e]=new Date;return;case"MenuClosePayload":return;case"ComboBoxPayload":case"ComboBoxPreviewPayload":var p=r.payload.newValue;if(!p)return;p.value?(s[_o.g.Value]=p.value,s[_o.g.IsFreeForm]=!0):(s[_o.g.Value]=p.text,s.MenuItemId=p.key,s.CommandValueId=p.commandValueId),"ComboBoxPreviewPayload"===g&&(a=t.commandPreviewId);break;case"ComboBoxRevertPreviewPayload":a=t.commandRevertId;break;default:return}break;case"FlyoutAnchorModel":this.handleMenuOpenClosePayload(r.payload,o.i(this,this.updateFlyoutAnchorMenuState,"updateFlyoutAnchorMenuState")),s.launcherId=r.payload.launcherId;break;case"ColorPickerModel":switch(r.payload.type){case"ColorPickerPayload":s[Gi.Color]=r.payload.selectedColorId;break;case"ColorPickerPreviewPayload":a=t.commandPreviewId,s[Gi.Color]=r.payload.selectedColorId;break;case"ColorPickerRevertPreviewPayload":a=t.commandRevertId;break;default:return}break;case"SpinButtonModel":s[Ho.Number]=r.payload.value,s[Ho.UnitType]=Jg.kt(r.payload.unitType.toLowerCase()),s[Ho.Text]=r.payload.reservedValue;break;case"SliderModel":s[No.u.Value]=r.payload.value;break;case"InsertTableModel":s[Io.Rows]=r.payload.rows,s[Io.Columns]=r.payload.columns;break;case"CheckboxModel":s[Di.e.On]=r.payload.checked,s.MenuItemId=t.menuItemId;break;case"PreviewGalleryModel":if(this.handleMenuOpenClosePayload(r.payload,o.i(this,this.updatePreviewGalleryMenuState,"updatePreviewGalleryMenuState"))){s.launcherId=r.payload.launcherId;break}return void this.executeGalleryButtonCommand(r,e);case"DocumentTitleModel":switch(r.payload.type){case"DocumentTitleRenamePayload":s.newDocumentTitle=r.payload.newDocumentTitle,s.getNewDocumentTitle=r.payload.getNewDocumentTitle;break;case"MenuOpenPayload":var d;return(d={})[r.payload.launcherId]=n,this._reactRibbonRootPoller.pollForStateAndUpdateCommands(d),void(this._lastPollTimes[e]=new Date);case"MenuClosePayload":default:return}break;case"MRUCompoundButtonModel":s.MenuItemId=r.payload.url,this.logFileMenuMRUExecution(r.payload.pageId);break;case"NewBlankDocumentModel":case"CustomTemplateModel":s.MenuItemId=r.payload.assetId,s.SourceControlId=e,this.logFileMenuTemplateExecution(r.payload.pageId);break;case"CoauthorGallery":case"PeopleWell":s.RenderTime=r.triggerTime;break;case"SyncStatus":s.SourceControlId=e;break;case"InputBoxModel":s.Text=r.payload.newValue;break;default:return}if(a&&!this.isShadowMenuOpen(r.payload)){s.CommandValueId||(s.CommandValueId=s.MenuItemId),t.legacyControlId&&(s.LegacyId=t.legacyControlId),s.SourceControlId||(s.SqmControlId=e),r.payload&&!Li.x(r.payload.keepFocusInRibbon)&&(s[Ju.z.shouldCanvasTakeFocus]=!r.payload.keepFocusInRibbon),r.payload&&!Li.x(r.payload.shouldTakeFocus)&&(s[Ju.z.shouldCanvasTakeFocus]=r.payload.shouldTakeFocus);var h=2;r.payload&&"inputMethod"in r.payload&&r.payload.inputMethod&&(h=r.payload.inputMethod,s[Ju.z.inputMethod]=h),this._rootCommandHandler.executeCommand(a,s,this.getSelectedTabId(),h,!0,(function(t){i.moveFocusAfterCommandExecution(s,e)}),this.getTelemetryData(r),this.getUILocationFromPayload(r.payload))}},e.prototype.moveFocusAfterCommandExecution=function(e,t){if(this._focusManager&&this.shouldMoveFocus(e)&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MoveFocusAfterCommandIsEnabled")){var n=(0,f.e)($e.AFrame,L.AFrameworkApplication.get_activeFrame());if(!this._focusManager.get_currentScope()&&n){var r="null";if(e){var i=e.Value;delete e.Value,r=E.m(e),Li.x(i)||(e.Value=i)}C.ULS.sendTraceTag(39359317,207,50,"Excel React unexpectly calling the callback with, simplifiedUxCommand: {0}, commandHandlerData.ModelType.Payload: {1}, focus scope name: {2}",t,r,n.get_ribbonFocusScopeName())}this._focusManager.focusLastEditableSurface()}},e.prototype.shouldMoveFocus=function(e){return!!e&&!Li.x(e[Ju.z.shouldCanvasTakeFocus])&&e[Ju.z.shouldCanvasTakeFocus]},e.prototype.handleTabSwitch=function(e,t){if(this._ribbonRoot.pollForStateAndUpdate(),this._ribbonSQMInformation&&this._actionManager){var n={};n[tE.w.tabId]=t.payload.tabId,this._actionManager.processActionWithData(te.zq,2,n,this.getTelemetryData(t))}var r=t.payload.tabId;e.NewContextId=r,e.NewContextCommand=this._externalUICommandDefinitionMapping.getTabCommandByExternalUxId(r),C.ULS.sendTraceTag(39879004,340,50,"HandleTabSwitch tabId: "+r)},e.prototype.handleMenuOpenClosePayload=function(e,t){var n=e.type;return"MenuClosePayload"===n||"MenuOpenPayload"===n&&(t(e.launcherId),!0)},e.prototype.populateControlMenuOnExecute=function(e,t){if(e.payload&&e.payload.launcherId&&("MenuOpenPayload"===e.payload.type||"MenuPopulatePayload"===e.payload.type)){var n=e.payload.launcherId,r=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(n);if(r&&r.populationProps){var i=2;"inputMethod"in e.payload&&e.payload.inputMethod&&(i=e.payload.inputMethod),this._reactRibbonRootPoller.populateControlMenu(r,t,i)&&n in this._lastPollTimes&&delete this._lastPollTimes[n]}}},e.prototype.updateFlyoutAnchorMenuState=function(e){if(this.shouldPoll(e)){var t=appChrome.selectors.getFlyoutAnchorMenuItems(e);this.updateMenuItems(t,e)}},e.prototype.updatePreviewGalleryMenuState=function(e){if(this.shouldPoll(e)){var t=appChrome.selectors.getPreviewGalleryMenuItems(e);this.updateMenuItems(t,e)}},e.prototype.updateSplitButtonMenuState=function(e){if(this.shouldPoll(e)){var t=appChrome.selectors.getSplitButtonMenuItems(e);this.updateMenuItems(t,e)}},e.prototype.updateStatefulSplitButtonMenuState=function(e){if(this.shouldPoll(e)){var t=appChrome.selectors.getStatefulSplitButtonMenuItems(e);this.updateMenuItems(t,e)}},e.prototype.getSelectedTabId=function(){return this.get_selectorsAreReady()?appChrome.selectors.getSelectedTabId():null},e.prototype.updateMenuItems=function(e,t){this._reactRibbonRootPoller.pollForStateAndUpdateCommands(e),this._lastPollTimes[t]=new Date},e.prototype.shouldPoll=function(e){var t=!0;e in this._lastPollTimes&&(t=this._lastPollTimes[e].getTime()<this._ribbonRoot.get_lastPollTime().getTime());return t&&this.get_selectorsAreReady()},e.prototype.executeGalleryButtonCommand=function(e,t){var n=this,r={},i=e.payload.selectedGalleryId,o=this._externalUICommandDefinitionMapping.getCommandByExternalUxId(i);o&&(r.SourceControlId=i,r.MenuItemId=o.menuItemId,r.SqmControlId=t,o.legacyControlId&&(r.LegacyId=o.legacyControlId),e.payload&&!Li.x(e.payload.keepFocusInRibbon)&&(r[Ju.z.shouldCanvasTakeFocus]=!e.payload.keepFocusInRibbon),e.payload&&!Li.x(e.payload.shouldTakeFocus)&&(r[Ju.z.shouldCanvasTakeFocus]=e.payload.shouldTakeFocus),this.getParametersByGalleryPayloadType(e.payload,r),this._rootCommandHandler.executeCommand(o.get_commandId(),r,this.getSelectedTabId(),2,!0,(function(e){n.moveFocusAfterCommandExecution(r,t)}),this.getTelemetryData(e),this.getUILocationFromPayload(e.payload)))},e.prototype.getParametersByGalleryPayloadType=function(e,t){"CharacterGalleryPayload"===e.type&&(t.MenuItemId=e.character)},e.prototype.setToggledParameter=function(e,t){e.payload&&"toggled"in e.payload&&(t[Di.e.On]=e.payload.toggled)},e.prototype.manageAppFocus=function(e,t){"MenuOpen"===e?!this._modalDiv||"isShadowRendering"in t.payload&&t.payload.isShadowRendering||this._modalDiv.onMenuOpen():"MenuClose"===e&&this._modalDiv&&this._modalDiv.onMenuClose()},e.prototype.closeAllMenus=function(){this._modalDiv&&this._modalDiv.onCloseAllMenus()},e.prototype.getTelemetryData=function(e){var t=null;return Li.x(e.triggerTime)||((t={}).TriggerTime=e.triggerTime),t},e.prototype.handleFileMenuPageSwitch=function(e,t,n){if(this._fileMenuSQMInformation&&this._actionManager){var r={};r[eE.k.pageId]=n,this._actionManager.processActionWithData(te.FH,2,r)}this.updateMenuItems(t.pageControlIdMap,e)},e.prototype.logFileMenuTemplateExecution=function(e){if(this._actionManager)switch(e){case"FileHomePage":this._actionManager.processAction(te.Uu,2);break;case"FileNewPage":this._actionManager.processAction(te.qt,2)}},e.prototype.logFileMenuMRUExecution=function(e){if(this._actionManager)switch(e){case"FileHomePage":this._actionManager.processAction(te.cK,2);break;case"FileOpenPage":this._actionManager.processAction(te.zg,2)}},e.prototype.getUILocationFromPayload=function(e){if(e)switch(e.location){case"ContextMenu":return 19;case"Floatie":return 9;case"SingleLineRibbon":return 14;case"MultilineRibbon":return 15;case"Overflow":return 16;case"TellMe":return 17;case"FarPeripheralControls":return 18;case"Header":return 21;case"FileMenu":return 22;case"Ribbon":default:return 2}return 2},e.prototype.isShadowMenuOpen=function(e){return!!e&&"MenuOpenPayload"===e.type&&e.isShadowRendering},e}();(0,o.l)(rE,"ReactExecuteCommandHandler",null,[]);var iE=n(7453),oE=function(){function e(){this._jewel=null}return e.prototype.get_jewel=function(){return this._jewel},e.prototype.set_jewel=function(e){return this._jewel=e,e},e.prototype.get_upperRibbonHeight=function(){return 0},e.prototype.get_lowerRibbonHeight=function(){return 0},e.prototype.get_minimized=function(){return!1},e.prototype.scaleHeader=function(){},e.prototype.toggleMinimizedState=function(e){},e.prototype.dismissTabPopup=function(e,t){return void 0===e&&(e=!0),void 0===t&&(t=!0),!1},e.prototype.setFocusOnCurrentTabTitle=function(){},e.prototype.selectTabById=function(e,t){return void 0===t&&(t=!1),!1},e.prototype.dismissAllTransientUI=function(){return!1},e.prototype.updateOpenMenu=function(e){return!(!this._jewel||!this._jewel.refreshOpenMenu(e))},e.prototype.get_tabPoppedUp=function(){return!1},e.prototype.get_selectedTabId=function(){return null},e.prototype.setControlVisibility=function(e,t){},e.prototype.getControlVisibility=function(e){return!1},e.prototype.forceEnableControl=function(e,t){},e.prototype.isControlEnabled=function(e){return!1},e.prototype.get_controlIdPrefix=function(){return null},e.prototype.set_controlIdPrefix=function(e){return e},e.prototype.beginModal=function(e,t,n){void 0===n&&(n=!1)},e.prototype.endModal=function(e,t,n){void 0===n&&(n=!1)},e.prototype.endBlockingModeKeepModal=function(){},e.prototype.getValidControl=function(e){return null},e.prototype.ensureBehaviorAttached=function(){},e.prototype.refresh=function(){},e.prototype.get_controls=function(){return null},e.prototype.refreshOpenMenu=function(e){return!1},e.prototype.commitAnyPendingChange=function(){},e.prototype.pollForStateAndUpdate=function(){},e.prototype.get_rootUser=function(){return null},e.prototype.set_rootUser=function(e){return e},e.prototype.updateControl=function(e){},e.prototype.get_inKeytipMode=function(){return!1},e.prototype.enterKeytipMode=function(e){void 0===e&&(e=null)},e.prototype.exitKeytipMode=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0)},e}();(0,o.l)(oE,"ReactRibbonExternal",null,[iE.h,Ii.s,Kg.l]);var aE=function(){function e(e,t,n,r){this._focusManager=null,this._actionManager=null,this._wacRibbonPanel=null,this._ribbonFocusId=null,this._focusManager=e,this._actionManager=t,this._wacRibbonPanel=n,this._ribbonFocusId=r}return e.prototype.initialize=function(){this._actionManager.addAction(te.lX,nt.a,o.i(this,this.ribbonMoveForwardAction,"ribbonMoveForwardAction")),this._actionManager.addAction(te.NL,nt.a,o.i(this,this.ribbonMoveBackwardAction,"ribbonMoveBackwardAction")),this._actionManager.addAction(te.BC,nt.a,o.i(this,this.ribbonEscAction,"ribbonEscAction"));var e=AF.x(this._ribbonFocusId,null,this._wacRibbonPanel,!1,!0,!0);e.set_keyDownHandledExternally(!0),this.rebindTabHandlers(e,te.lX,te.NL),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_Esc,0),te.BC);var t=this._focusManager.getScope($e.AFrame.reactTransientUIFocusId);t.set_keyDownHandledExternally(!0),this.rebindTabHandlers(t,te.Ps,te.Ps),Be.p.get_instance().registerHandler(Le.d.mouseDown,this._wacRibbonPanel,o.i(this,this.onRibbonMouseDown,"onRibbonMouseDown"));var n=qw.F6Manager.get_instance();er.apiExists("enterKeytipMode")&&n.setOnPostF6(this._ribbonFocusId,(function(){appChrome.api.enterKeytipMode(!1)})),er.apiExists("exitKeytipMode")&&n.setOnBeforeF6(this._ribbonFocusId,(function(e){appChrome.api.exitKeytipMode()}))},e.prototype.ribbonMoveForwardAction=function(e,t,n,r,i){return 4},e.prototype.ribbonMoveBackwardAction=function(e,t,n,r,i){return 4},e.prototype.ribbonEscAction=function(e,t,n,r,i){return er.apiExists("inKeytipMode")&&!appChrome.api.inKeytipMode()&&this._focusManager.setScope($e.AFrame.documentFocusID),4},e.prototype.rebindTabHandlers=function(e,t,n){var r=Xe.KeyInputManager.hashKey(Je.v.vK_Tab,0),i=Xe.KeyInputManager.hashKey(Je.v.vK_Tab,4);e.unBindAction(r),e.unBindAction(i),e.bindAction(r,t),e.bindAction(i,n)},e.prototype.onRibbonMouseDown=function(e){return e.innerEvent&&e.innerEvent.target&&"input"!==e.innerEvent.target.tagName.toLowerCase()&&e.innerEvent.preventDefault(),!1},e.prototype.dispose=function(){this._actionManager.removeAction(te.lX,nt.a,o.i(this,this.ribbonMoveForwardAction,"ribbonMoveForwardAction")),this._actionManager.removeAction(te.NL,nt.a,o.i(this,this.ribbonMoveBackwardAction,"ribbonMoveBackwardAction")),this._actionManager.removeAction(te.BC,nt.a,o.i(this,this.ribbonEscAction,"ribbonEscAction"))},e}();(0,o.l)(aE,"ReactRibbonFocusManager",null,[Sys.IDisposable]);var sE=function(){function e(e,t,n,r,i,o,a,s,l,c){void 0===s&&(s=null),void 0===l&&(l=!0),void 0===c&&(c=null),this._ribbonRoot=null,this._ribbonPanel=null,this._actionManager=null,this._focusManager=null,this._shouldRenderRibbon=!1,this._ribbonFocusId=null,this._externalUICommandDefinitionMapping=null,this._commandHandler=null,this._unregisterBindCommandHandlerAction=null,this._ribbonExternal=null,this._jewel=null,this._elmJewelPlaceholder=null,this._modalContainer=null,this._jewelProperties=null,this._ribbonTrimmingProperties=null,this._ribbonFocusManager=null,this._setAppInitializationStatuses=[],this._ribbonPanel=e,this._modalContainer=t,this._ribbonFocusId=n,this._focusManager=r,this._actionManager=i,this._externalUICommandDefinitionMapping=o,this._ribbonRoot=c||new Pp(fa.f.get_instance(),this._externalUICommandDefinitionMapping),this._jewelProperties=a,this._ribbonExternal=new oE,this._ribbonTrimmingProperties=s,this._shouldRenderRibbon=l}return e.prototype.initialize=function(t,n,r){var i=this;void 0===r&&(r=null),this._shouldRenderRibbon||this.setAppInitializationStatus(5),r?r.then((function(){i.renderRibbon()})).catch((function(e){return C.ULS.sendTraceTag(35436050,340,10,"Failed to load the resources for the Ribbon")})):JF(JF(It.Task.WAA(this.loadRibbonLocalizedJSFileAsync(t),this.loadRibbonJSFileAsync(e._commonJSFile)),(function(){return i.loadRibbonJSFileAsync(e._appChromeJSFile)})),(function(){return i.loadRibbonLocalizedJSFileAsync(n)})).CWo((function(e){i.renderRibbon()}),gr.d.onlyOnRanToCompletion|gr.d.executeSynchronously),this.logRibbonLoaded()},e.prototype.dispose=function(){this._unregisterBindCommandHandlerAction&&this._unregisterBindCommandHandlerAction(),this._jewel&&this._jewel.dispose(),this._ribbonFocusManager&&this._ribbonFocusManager.dispose();for(var e=0,t=this._setAppInitializationStatuses;e<t.length;e++){var n=t[e];wi.r.get_instance().clearAppInitializationStatus(n)}L.AFrameworkApplication.get_theActionManager().removeAction(te.yx,nt.a,Ze.ActionManager.doNothingButReportHandler)},e.prototype.logRibbonLoaded=function(){C.ULS.sendTraceTag(34468252,340,50,"User is booting the Single Line Ribbon"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(te.yx,nt.a,Ze.ActionManager.doNothingButReportHandler,64),L.AFrameworkApplication.get_theActionManager().processAction(te.yx,2)},e.prototype.loadRibbonJSFileAsync=function(e){return se.w.get_instance().resolve(VF.n).loadSharedDependencyAsync(L.AFrameworkApplication.scriptUrlFromName(e,2))},e.prototype.loadRibbonLocalizedJSFileAsync=function(e){return""===e?It.Task.fromResult(Boolean,!0):se.w.get_instance().resolve(VF.n).loadSharedDependencyAsync(L.AFrameworkApplication.scriptUrlFromName(e,3))},e.prototype.initializeRibbonStore=function(){(this._ribbonTrimmingProperties||this._jewelProperties)&&appChrome.api.dispatch(this.getTrimmedIdsHideActions()),this.setUlsExternalLogger(),er.apiExists("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(L.AFrameworkApplication.get_staticContentScriptNameBase()),this._ribbonRoot.pollForStateAndUpdate()},e.prototype.renderRibbon=function(){this.initializeRibbonStore(),this._shouldRenderRibbon&&(appChrome.renderAppChrome(this._ribbonPanel,er.getRenderAppChromeSettings()),this.setAppInitializationStatus(10)),this.addBindCommandHandlerCallback(),this.buildAndSetJewel(),this._shouldRenderRibbon&&this.setAppInitializationStatus(5),this.initializeFocusManager()},e.prototype.initializeFocusManager=function(){this._focusManager&&this._actionManager&&this._ribbonFocusId&&(this._ribbonFocusManager=new aE(this._focusManager,this._actionManager,this._ribbonPanel,this._ribbonFocusId),this._ribbonFocusManager.initialize())},e.prototype.get_ribbonExternal=function(){return this._ribbonExternal},e.prototype.setCommandDefinitionMapping=function(){if(er.apiExists("setCommandDefinitionMapping")){var e=(t=this._externalUICommandDefinitionMapping,(0,O.m)(new jF,{getCommandByExternalUxId:function(e){var n=t.getCommandByExternalUxId(e);return(0,O.m)(new qF,{commandId:parseInt(n.get_commandId()),externalUxCommand:n.get_externalUxCommand()})}}));appChrome.api.setCommandDefinitionMapping(e)}var t},e.prototype.addBindCommandHandlerCallback=function(){var e=this;this.setCommandDefinitionMapping();var t=(0,f.e)(Pp,this._ribbonRoot);this._commandHandler=new rE(this._ribbonRoot,t.get_reactRibbonRootPoller(),this._externalUICommandDefinitionMapping,this._focusManager,this._modalContainer,se.w.get_instance().tryResolve(WF.f),se.w.get_instance().tryResolve(zF.l),L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager),this._unregisterBindCommandHandlerAction=appChrome.api.bindCommandHandler((function(t,n){e._commandHandler.executeCommand(t,n)}))},e.prototype.setUlsExternalLogger=function(){appChrome.api.initializeLogger(new QF.s)},e.prototype.getPollForStateAndUpdateActions=function(){return this._ribbonRoot?this._ribbonRoot.getPollForStateAndUpdateActions():new Array(0)},e.prototype.pollForStateUpdate=function(){var e=this;KF.r.get_instance().profileFunction((function(){var t=null;KF.r.get_instance().profileFunction((function(){t=e.getPollForStateAndUpdateActions()}),"ReactRibbon::PollForStateUpdate::GetActions"),t&&t.length>0&&(e._ribbonRoot.set_lastPollTime(new Date),KF.r.get_instance().profileFunction((function(){appChrome.api.dispatch(t)}),"ReactRibbon::PollForStateUpdate::DispatchActions")),e._jewel&&KF.r.get_instance().profileFunction((function(){e._jewel.pollForStateAndUpdate()}),"ReactRibbon::PollForStateUpdate::Jewel")}),"ReactRibbon::PollForStateUpdate")},e.prototype.updatePeopleWellControl=function(){this._ribbonRoot.updatePeopleWellControl()},e.prototype.updateDocChatControl=function(){this._ribbonRoot.updateDocChatControl()},e.prototype.onComponentBuilt=function(e,t){},e.prototype.activateAndSetCurrentContextualTab=function(e){var t=[appChrome.actions.activateDeactivateContextualTab(e,!0),appChrome.actions.setCurrentTab(e)];appChrome.api.dispatch(t)},e.prototype.getTrimmedIdsHideActions=function(){var e=L.AFrameworkApplication.appSettingsManager,t=new Array(0);e.getBooleanAppSetting("EnableTellMeForOneLineRibbonIsEnabled")?e.getBooleanAppSetting("OcpsIsEnabled")&&se.w.get_instance().resolveFuture(J.a).execute((function(e){e.isFeatureEnabled("ConnectedServices",!0).then((function(e){return e&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("TellMeControl",!1)),null}))})):t.push(appChrome.actions.updateControlHiddenState("TellMeControl",!0)),t.push.apply(t,this.getFileMenuTrimmingActions());var n=new $F.v(this._externalUICommandDefinitionMapping);if(this._ribbonTrimmingProperties.trimmedIds&&(XF.p.trimPeripheralControls(this._ribbonTrimmingProperties.trimmedIds),t.push.apply(t,n.getActionsForTrimmedIds(this._ribbonTrimmingProperties.trimmedIds))),this._ribbonTrimmingProperties.trimmedGallerySections)for(var r=0,i=this._ribbonTrimmingProperties.trimmedGallerySections;r<i.length;r++){var o=i[r];t.push(appChrome.actions.updateGallerySectionHiddenState(o.galleryId,o.sectionId,o.trimmedValue))}return t.push.apply(t,n.getActionsForTrimmedTabs(this._ribbonTrimmingProperties.trimmedTabs)),t},e.prototype.getFileMenuTrimmingActions=function(){var e=new Array(0);if(this._jewelProperties&&this._jewelProperties.trimmedIds){var t=this._jewelProperties.trimmedIds;for(var n in t){var r={key:n,value:t[n]},i=this._externalUICommandDefinitionMapping.getExternalUxIdsByLegacyControlId(r.key);if(i)for(var o=i.$$lge();o.$$mn();){var a=o.$$cu();e.push(appChrome.actions.updateControlHiddenState(a,r.value))}}}return e},e.prototype.updateControls=function(e){e&&this._ribbonRoot.get_reactRibbonRootPoller().pollForStateAndUpdateCommands(e)},e.prototype.populateControlMenu=function(e){this._ribbonRoot.get_reactRibbonRootPoller().populateControlMenu(this._externalUICommandDefinitionMapping.getCommandByExternalUxId(e),appChrome.selectors.getModelType(e))},e.prototype.showActionButton=function(e){var t=this;wi.r.get_instance().executeWhen(5,null).CW((function(n){appChrome.api.dispatch(t.getShowActionButtonStoreAction(e))}))},e.prototype.getShowActionButtonStoreAction=function(e){var t={};return t.actionButtonId=e,appChrome.actions.updatePeripheralControls(t)},e.prototype.getShowCopyLinkButtonStoreAction=function(e){var t={};return t.copyLinkButtonId=e,appChrome.actions.updatePeripheralControls(t)},e.prototype.setAppInitializationStatus=function(e){wi.r.get_instance().setAppInitializationStatus(e),this._setAppInitializationStatuses.push(e)},e.prototype.buildAndSetJewel=function(){if(this._jewelProperties){this.initializeJewelPlaceholder();var e=(0,O.m)(new YF.l,{trimmedIds:this._jewelProperties.trimmedIds}),t=new ZF.JewelBuilder(e,this._elmJewelPlaceholder,It.Task.fromResult(GF.j,(0,f.e)(GF.j,this)));if(t.set_dataSource(this._jewelProperties.dataSource),!t.buildJewel(this._jewelProperties.jewelId,null))throw Error.create("Jewel could not be built");this._jewel=t.get_jewel(),this._jewel&&(this._jewel.set_rootUser(this._ribbonRoot.get_rootUser()),this._jewel.pollForStateAndUpdate(),this._ribbonExternal.set_jewel(this._jewel),er.appChromeContainsAction("updateFileMenuDisabledValue")&&appChrome.api.dispatch(appChrome.actions.updateFileMenuDisabledValue(!1)))}},e.prototype.initializeJewelPlaceholder=function(){this._elmJewelPlaceholder=Bi.n.createElement("div"),this._elmJewelPlaceholder.id="jewelcontainer",this._elmJewelPlaceholder.className="cui-jewel-container",this._elmJewelPlaceholder.style.display="block"},e.prototype.launchJewelMenu=function(e,t){this._jewel&&this._jewel.get_jewelMenuLauncher().launchMenuWithSubmenu(e,t)},e._commonJSFile="common",e._appChromeJSFile="appChrome",e}();(0,o.l)(sE,"ReactRibbonUser$2",null,[HF,GF.j,Sys.IDisposable]);var lE=function(e){function t(t,n,r,i,o,a,s,l,c,u,g){void 0===c&&(c=null),void 0===u&&(u=!0),void 0===g&&(g=null);var p=e.call(this,t,n,i,o,a,s,l,c,u,g)||this;return p._generalCuiUserFuture=null,p._generalCuiUser=null,p._generalCuiUserFuture=r,p._generalCuiUserFuture.execute((function(e){p._generalCuiUser=e})),p._generalCuiUserFuture.execute((function(e){p._ribbonRoot.set_rootUser(e)})),p}return(0,S.t)(t,e),t.prototype.getPollForStateAndUpdateActions=function(){return this._generalCuiUser?(this._generalCuiUser.clearCache(),e.prototype.getPollForStateAndUpdateActions.call(this)):new Array(0)},t.prototype.onComponentBuilt=function(e,t){if(!e)throw Error.argumentNull();this._generalCuiUserFuture.execute((function(t){e.set_rootUser(t)}))},t}(sE);(0,o.l)(lE,"ReactRibbonUser$1",sE,[]);var cE=n(4843),uE=n(2847),gE=function(e){var t=!1,n=!0;if(us.n.get_instance().get_item(27)){uE.WoncaApp.get_instance().doOnBeforeAppCloseWork(null);var r=Br.App.onBeforeNavigateWebkitString();r&&2===Br.App.get_activeAppFrame().get_mode()&&(n=confirm(r))}return n?uE.WoncaApp.doOnAppCloseWork():t=!0,t},pE=n(7344),dE=n(372),hE=function(e){function t(t,n,r){return void 0===n&&(n=null),void 0===r&&(r=null),e.call(this,t,n,r)||this}return(0,S.t)(t,e),t.prototype.get_singleUserCollabGlyph16=function(){return 1===Br.App.get_mode()?"on_SingleCollabUserGlyph16":"we_SingleCollabUserGlyph16"},t.prototype.get_singleUserCollabGlyph32=function(){return 1===Br.App.get_mode()?"on_SingleCollabUserGlyph32":"we_SingleCollabUserGlyph32"},t.prototype.get_multipleUserCollabGlyph16=function(){return 1===Br.App.get_mode()?"on_MoreUsersGlyph16":"we_MoreUsersGlyph16"},t.prototype.getTopRightActionButtonInfo=function(){var e=null;return L.AFrameworkApplication.fileShareEnabled&&(e=(0,O.m)(new dE.i,{label:WoncaIntl.WoncaStrings.L_Share,command:"981334692",image:Ct.CuiHelper.shareButtonImg20,id:Ct.CuiHelper.shareButtonId})),e},t.prototype.getPeopleWellControlSettings=function(){var e=null;return L.AFrameworkApplication.peoplesWellIsEnabled&&(e=Ct.CuiHelper.getPeoplesWellDefaultControlSettings(L.AFrameworkApplication.get_imageClusterPath(),this.get_singleUserCollabGlyph16(),L.AFrameworkApplication.get_imageClusterPath(),this.get_singleUserCollabGlyph32(),L.AFrameworkApplication.get_imageClusterPath(),this.get_multipleUserCollabGlyph16())),e},t}(pE.b);(0,o.l)(hE,"TopRowPeripheralControlCreator$0",pE.b,[]);var _E=n(2547),mE=(0,o.y)("IWoncaAppChromeStateManager"),fE=function(e){er.appChromeAlreadyLoaded()?e():C.ULS.sendTraceTag(51393038,340,10,"appChrome is not defined.")},yE=function(e,t){var n=se.w.get_instance().tryResolve(mE);n?n.executeWhen(e,(function(){fE(t)})):fE(t)},CE=(0,o.y)("IReactSharedHeaderPropsHelper"),SE=n(6318),vE=n(4595),bE=function(){function e(){this._searchOauthManager=null,this._prefetchAuthToken=!0}return e.prototype.tryResolveSearchOAuthManager=function(){try{this._searchOauthManager||(this._searchOauthManager=se.w.get_instance().resolve(Yw))}catch(e){C.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+e)}},e.prototype.getLokiTokenPromise=function(){var e=this;return this.tryResolveSearchOAuthManager(),this._searchOauthManager?this._searchOauthManager.isConnectedServiceEnabled().then((function(t){return t?e._searchOauthManager.getToken("Search",L.AFrameworkApplication.lokiEndpointForSearch):null})):null},e.prototype.getSubstrateTokenPromise=function(){var e=this;return this.tryResolveSearchOAuthManager(),this._searchOauthManager?this._searchOauthManager.isConnectedServiceEnabled().then((function(t){return t?e._searchOauthManager.getToken("Search",L.AFrameworkApplication.substrateEndpointForSearch):null})):null},e.prototype.getLokiTokenPromiseFunc=function(){return o.i(this,this.getLokiTokenPromise,"getLokiTokenPromise")},e.prototype.getSubstrateTokenPromiseFunc=function(){return o.i(this,this.getSubstrateTokenPromise,"getSubstrateTokenPromise")},e.prototype.shouldFetchTokensForSearch=function(){return!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_shouldFetchTokensForSearch()},e.prototype.shouldPrefetchAuthTokensForSearch=function(){return!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_shouldPrefetchAuthTokensForSearch()},e.prototype.getTokenRequestDict=function(){var e={};return this.shouldFetchTokensForSearch()&&(e.Loki=this.getLokiTokenPromiseFunc(),e.Substrate=this.getSubstrateTokenPromiseFunc(),this._prefetchAuthToken&&this.shouldPrefetchAuthTokensForSearch()&&(this._prefetchAuthToken=!1,this.getLokiTokenPromise().then((function(){C.ULS.sendTraceTag(51500871,1300,50,"Cached Loki token")})))),e},e.prototype.loadTellMeStrings=function(){var e=se.w.get_instance().resolve(vE.d).getScriptLoader();e&&e.loadScript("tellme-strings").then((function(){appChrome.api.dispatch(appChrome.actions.updateHeaderSearchBoxVisibility(!0)),C.ULS.sendTraceTag(50376975,1300,50,"Loaded resource(s) for the TellMe providers")}))},e.isSearchEnabled=function(){return!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSharedHeaderSearchUxEnabled()},e}();(0,o.l)(bE,"ReactSharedHeaderSearchUtils",null,[]);var TE=n(4551),AE=function(){return function(){this.documentTitle=null,this.saveStatus=null,this.isVersionHistoryEnabled=!1,this.breadcrumbBrandName=null,this.breadcrumbBrandUrl=null,this.breadcrumbFolderName=null,this.breadcrumbFolderUrl=null,this.hideDocumentTitleInput=!1,this.documentExtension=null,this.onGetSuggestedTitle=null}}();(0,o.l)(AE,"DocumentTitleAppProps",null,[]);var IE=function(){return function(){this.appName=null,this.userDisplayName=null,this.emailAddress=null,this.userID=null,this.culture=null,this.language=null,this.isConsumer=!1,this.showAppLauncher=!1,this.showMeControl=!1,this.assetsContainerOverride=null,this.controls=null,this.documentTitleAppProps=null,this.showChatControl=!1,this.showSearchControl=!1,this.enableSearchControl=!1,this.showGoPremiumControl=!1,this.signInLink=null,this.getTokenRequestDictionary=null,this.onHeaderReducersReady=null,this.setCookie=null,this.getCookie=null,this.onFlexPaneOpen=null,this.onFlexPaneClose=null,this.enableTheming=!1,this.enableDelayLoading=!1,this.userRing=null,this.testTraffic=!1}}();(0,o.l)(IE,"HeaderAppProps",null,[]);var wE=function(){return function(){this.ribbonToggleId=null,this.workflowButton=null}}();(0,o.l)(wE,"HeaderControls",null,[]);var xE=function(){return function(){this.label=null,this.command=null}}();(0,o.l)(xE,"WorkflowButtonAppProps",null,[]);var FE=function(){function e(){}return e.prototype.shouldShowRibbonToggleButtonInHeader=function(){return!0},e.prototype.getReactCommand=function(e){var t=se.w.get_instance().tryResolve(su.u).getCommandById(e);return t&&t.length>0?t[0].get_externalUxCommand():(C.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",e)),null)},e.prototype.getWorkflowButtonAppProps=function(){var e=null,t=SE.g();if(t){var n=this.getReactCommand(t.command);n&&(e=(0,O.m)(new xE,{command:n,label:t.label}))}return e},e.prototype.getControls=function(){return(0,O.m)(new wE,{ribbonToggleId:SE.f(this.shouldShowRibbonToggleButtonInHeader())?"ToggleRibbonUXDialog":null,workflowButton:L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WorkflowButtonsInSharedHeaderIsEnabled")?this.getWorkflowButtonAppProps():null})},e.prototype.getDocumentTitleAppProps=function(){var e=L.AFrameworkApplication.docPropertiesProvider.get_breadcrumbDocName();return(0,O.m)(new AE,{documentTitle:L.AFrameworkApplication.get_documentIsFolder()?e:Jn.l.getFileNameWithoutExtension(e),isVersionHistoryEnabled:this.shouldShowVersionHistory(),breadcrumbBrandName:L.AFrameworkApplication.breadcrumbBrandName,breadcrumbBrandUrl:L.AFrameworkApplication.breadcrumbBrandUrl,breadcrumbFolderName:L.AFrameworkApplication.breadcrumbFolderName,breadcrumbFolderUrl:L.AFrameworkApplication.breadcrumbFolderUrl,hideDocumentTitleInput:!L.AFrameworkApplication.isRenameSupported(),documentExtension:Jn.l.getFileExtension(L.AFrameworkApplication.fileName)})},e.prototype.shouldShowVersionHistory=function(){return!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSharedHeaderVersionHistoryEnabled()},e.prototype.shouldEnableTheming=function(){return!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSharedHeaderThemingEnabled()},e.prototype.shouldShowChatControl=function(){return!SE.o()&&!L.AFrameworkApplication.hideHeader&&(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SkypeWebControlIsEnabled")||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TeamsChatIsEnabled"))},e.prototype.continueShellServiceDataAsync=function(e){var t=w.w(e.get_result());appChrome.api.dispatch(appChrome.actions.setHeaderNavBarData(t)),C.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")},e.prototype.onHeaderReducersReady=function(){var e=this;se.w.get_instance().resolveFuture(ct.u).execute((function(t){t.get_shellServiceDataAsync().CWo(o.i(e,e.continueShellServiceDataAsync,"continueShellServiceDataAsync"),gr.d.onlyOnRanToCompletion)})),se.w.get_instance().resolveFuture(gi.i).execute((function(e){e.updateSaveStatusDisplay(!1,L.AFrameworkApplication.get_theActionManager().get_mode())}))},e.prototype.getCookie=function(e){var t=ve.g(e);return null!=t&&t.length>0&&(t=decodeURIComponent(t)),t},e.prototype.getSuiteUxShellPath=function(){return TE.y.get_isAppChromeLocalhostScriptEnabled()?TE.y.getLocalhostPath("suiteux-shell",!1):kn.h.staticContentHost+L.AFrameworkApplication.get_scriptFolderPath()+"suiteux-shell"},e.prototype.getProps=function(e){void 0===e&&(e=!1);var t=Kt.i.getCultureInfo(L.AFrameworkApplication.lcid),n=t?t.get_name():"en-us",r=t?Kt.i.getCultureInfo(t.get_languageId()).get_name():"en",i=SE.k(),a=bE.isSearchEnabled(),s=se.w.get_instance().resolve(We),l=(0,O.m)(new IE,{appName:CommonUIStrings.l_AppNameShort,culture:n,language:r,isConsumer:!L.AFrameworkApplication.useO365ShellService,showAppLauncher:i,showMeControl:i,assetsContainerOverride:this.getSuiteUxShellPath(),controls:this.getControls(),documentTitleAppProps:e?null:this.getDocumentTitleAppProps(),showChatControl:this.shouldShowChatControl(),showGoPremiumControl:!e&&SE.u(),onHeaderReducersReady:o.i(this,this.onHeaderReducersReady,"onHeaderReducersReady"),showSearchControl:a,enableSearchControl:a,onFlexPaneOpen:o.i(s,s.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:o.i(s,s.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.shouldEnableTheming(),setCookie:ve.p,getCookie:o.i(this,this.getCookie,"getCookie"),enableDelayLoading:SE.d(),testTraffic:L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SharedHeaderTestTrafficIsEnabled")});if(!L.AFrameworkApplication.userNameUnknown||L.AFrameworkApplication.signoutUrl?(l.userDisplayName=L.AFrameworkApplication.userName,l.emailAddress=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName"),l.userID=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("Puid")||""):l.signInLink=L.AFrameworkApplication.signInUrl,a){var c=new bE;c.loadTellMeStrings(),l.getTokenRequestDictionary=o.i(c,c.getTokenRequestDict,"getTokenRequestDict");var u=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("Microsoft365Ring");u&&u.length||(u="generalAudience"),l.userRing=u}return l},e}();(0,o.l)(FE,"ReactSharedHeaderPropsHelper",null,[CE]);var EE=function(){return function(){this.value=null,this.label=null}}();(0,o.l)(EE,"TextInfoSectionField",null,[]);var PE=n(6990),kE=n(2263),DE=n(345),ME=function(){function e(e,t){this._clientId=null,this._resizableContainer=null,this._headerContainer=null,this._elmTopBar1=null,this._clientId=e,this._resizableContainer=t}return e.prototype.ensureTopBarDomElement=function(){return Li.x(this._elmTopBar1)?(this.ensureHeaderDom(),this._elmTopBar1.style.display="block",this._resizableContainer&&this._resizableContainer.add_onResize(o.i(this,this.onResize,"onResize")),this._elmTopBar1):this._elmTopBar1},e.prototype.appendTopBarPeripheralElements=function(){this.ensureTopBarDomElement();var e=document.getElementById(this._clientId+"-"+PE.r.topRowCenter),t=document.getElementById(this._clientId+"-"+PE.r.topRowRight),n=document.getElementById(this._clientId+"-"+PE.r.topRowLeft);this.appendTopBarChildControl(n),this.appendTopBarChildControl(e),this.appendTopBarChildControl(t),this.scaleHeader()},e.prototype.onResize=function(){this.scaleHeader()},e.prototype.scaleHeader=function(){this.enhancedMobileViewIsEnabled()?(document.getElementById("application").style.minWidth="0px",new DE.b(this._elmTopBar1,null,L.AFrameworkApplication.get_isRtl()).scaleNonCuiHeader(this._elmTopBar1)):kE.k.scaleNonCuiHeaders(this._elmTopBar1,L.AFrameworkApplication.get_isRtl())},e.prototype.enhancedMobileViewIsEnabled=function(){return!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EnhancedMobileViewIsEnabled")},e.prototype.ensureHeaderDom=function(){var e;Li.x(this._headerContainer)&&(AF.f((0,p.m)((function(){return e}),(function(t){return e=t})),!L.AFrameworkApplication.hideHeaderEmbedded)&&(this._headerContainer=Bi.n.createElement("div"),this._headerContainer.className=AF.w,this._headerContainer.id=Ct.CuiHelper.externalHeaderFullTopBarsId,e.appendChild(this._headerContainer),this.ensureExternalHeaderCss(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&!L.AFrameworkApplication.hideHeaderEmbedded&&this.ensureFlexBoxPositioningCss(),this.ensureTopBar1()))},e.prototype.appendTopBarChildControl=function(e){Li.x(e)||(e.parentNode!==this._elmTopBar1&&this._elmTopBar1.appendChild(e),e.style.display="inline-block",Bi.n.setUnselectable(e,!0,!1))},e.prototype.ensureTopBar1=function(){Li.x(this._elmTopBar1)&&(this._elmTopBar1=Bi.n.createElement("div"),this._elmTopBar1.className=AF.c(),this._elmTopBar1.style.display="none",this._headerContainer.appendChild(this._elmTopBar1))},e.prototype.ensureExternalHeaderCss=function(){Sys.UI.DomElement.addCssClass(this._headerContainer,AF.d),L.AFrameworkApplication.get_isRtl()&&Bi.n.ensureCSSClassOnElement(this._headerContainer,"cui-rtl")},e.prototype.ensureFlexBoxPositioningCss=function(){Sys.UI.DomElement.addCssClass(this._headerContainer,"FlexBoxLayout")},e}();(0,o.l)(ME,"HeaderSkeleton",null,[]);var RE=function(e){function t(t,n,r,i,o,a,s,l,c,u,g,p,d){void 0===g&&(g=null),void 0===p&&(p=!0),void 0===d&&(d=null);var h=e.call(this,n,t.get_documentPanel(),i,kg.u.ribbonFocusId,o.get_focusManager(),o.get_actionManager(),l,c,u,p,d)||this;if(h._hostingAppFrame=null,h._topRowPeripheralControlCreator=null,h._appSpecificStringsClass=null,h._resizableContainer=null,h._standaloneRoot=null,h._shouldShowActionButtonInRibbon=!1,null==t)throw Error.argumentNull("hostingAppFrame");return h._hostingAppFrame=t,h._standaloneRoot=s,h._appSpecificStringsClass=r,h._resizableContainer=a,h._topRowPeripheralControlCreator=g,h._shouldShowActionButtonInRibbon=g.shouldShowActionButtonInRibbon(),G.y.get_isIPad()&&Ct.CuiHelper.registerOnClickBreadcrumbLink(gE),o.waitForReady((function(){h.updateRibbonFlexboxLayout(),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()?h.createReactHeader():h.createHeader(),h.createFileMenu(),h.registerCommands()}),null),h}return(0,S.t)(t,e),t.prototype.get_isDeepLinkLoad=function(){return!!L.AFrameworkApplication.appSettingsManager.get_appSettings().BootActivityNavigationId},t.prototype.updateRibbonFlexboxLayout=function(){_i.s.ensureCSSClassOnElement(this._ribbonPanel,"FlexBoxLayout"),_i.s.ensureCSSClassOnElement(this._hostingAppFrame.getDOMElement(),"cui-exth"),_i.s.ensureCSSClassOnElement(this._hostingAppFrame.getDOMElement(),"FlexBoxLayout")},t.prototype.createReactHeader=function(){var e=this;if(!L.AFrameworkApplication.hideHeaderEmbedded){var n=new ME(t._ribbonClientID,this._resizableContainer).ensureTopBarDomElement(),r=AF.x(kg.u.headerUiFocusId,null,n,!0,!0,!0);r.set_keyDownHandledExternally(!0),this.rebindTabHandlers(r,te.lX,te.NL),r.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_Esc,0),te.BC),yE(1,(function(){e.renderSharedHeader(n)}))}},t.prototype.renderSharedHeader=function(e){var t=new FE;appChrome.renderSharedHeader(e,t.getProps()).then(o.i(this,this.onSharedHeaderRender,"onSharedHeaderRender"))},t.prototype.onSharedHeaderRender=function(){var e=this;if(this.dismissFastViewHeader(),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderDelayLoadingEnabled()){wi.r.get_instance().executeWhen(8,(function(){var t=new De.c(3,1,400,o.i(e,e.continueToLoadHeader,"continueToLoadHeader"),void 0,"ContinueToLoadHeader");Oe.y.get_instance().addTask(t)}),gr.d.onlyOnRanToCompletion|gr.d.executeSynchronously)}},t.prototype.continueToLoadHeader=function(e){appChrome.getHeaderApi().then((function(e){return e.continueToLoadHeader(),null}))},t.prototype.dismissFastViewHeader=function(){this.get_isDeepLinkLoad()&&L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordImprovedDeepLinkLoadSettings"),this.get_isDeepLinkLoad()&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ImprovedDeepLinkLoadIsEnabled")?(wi.r.get_instance().executeWhen(12,(function(){(new _E.d).dismissFastViewHeader()}),gr.d.onlyOnRanToCompletion|gr.d.executeSynchronously),C.ULS.sendTraceTag(42316515,338,50,"DismissFastViewHeader was delayed to AppInitializationStatus.CommentRendered phase")):(new _E.d).dismissFastViewHeader()},t.prototype.createHeader=function(){var e=window.performance.now(),n=new ME(t._ribbonClientID,this._resizableContainer),r=n.ensureTopBarDomElement(),i=[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings],o=new Ct.CuiHelper(Za.f.box4ImageBase,this._appSpecificStringsClass,null,null,i);if(this._topRowPeripheralControlCreator||(this._topRowPeripheralControlCreator=new hE(this._standaloneRoot)),this._topRowPeripheralControlCreator.createTopRowControls(r,o,t._ribbonClientID),n.appendTopBarPeripheralElements(),!L.AFrameworkApplication.hideHeaderEmbedded){C.ULS.sendTraceTag(595855182,338,50,"Header first render time: {0} ms",Math.round(window.performance.now()-e));AF.x(kg.u.headerUiFocusId,null,r,!0,!0,!0);(new _E.d).dismissFastViewHeader(),C.ULS.sendTraceTag(595732180,338,50,"Header first interactive time: {0} ms",Math.round(window.performance.now()-e))}},t.prototype.rebindTabHandlers=function(e,t,n){var r=Xe.KeyInputManager.hashKey(Je.v.vK_Tab,0),i=Xe.KeyInputManager.hashKey(Je.v.vK_Tab,4);e.unBindAction(r),e.unBindAction(i),e.bindAction(r,t),e.bindAction(i,n)},t.prototype.createFileMenu=function(){var e=!!this._ribbonTrimmingProperties&&"FileMenu"in this._ribbonTrimmingProperties.trimmedTabs;L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactFileMenuUxEnabled()&&!e&&yE(1,o.i(this,this.renderFileMenu,"renderFileMenu"))},t.prototype.renderFileMenu=function(){var e=new Array(0);if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DiagnosticsInfoInJewelAboutMenuIsEnabled")){var t=[(0,O.m)(new EE,{label:CommonUIStrings.L_DiagnosticsSessionId,value:L.AFrameworkApplication.userSessionId}),(0,O.m)(new EE,{label:CommonUIStrings.L_DiagnosticsBuild,value:L.AFrameworkApplication.buildVersion})];e.push(appChrome.actions.setFileMenuSessionDetails("AboutTextSection",t))}e.push.apply(e,this.getFileMenuTrimmingActions());var n=document.createElement("div");document.body.appendChild(n),appChrome.renderFileMenu(n,e)},t.prototype.registerCommands=function(){this._actionManager.addAction(te.Tm,cl.n,o.i(this,this.tabSwitch,"tabSwitch")),this._actionManager.addAction(te.vj,cl.n,o.i(this,this.ribbonModeToggled,"ribbonModeToggled")),this._actionManager.addAction(te.KA,cl.n,o.i(this,this.ribbonModeToggledToMLR,"ribbonModeToggledToMLR")),this._actionManager.addAction(te.MH,cl.n,o.i(this,this.ribbonModeToggledToSLR,"ribbonModeToggledToSLR"))},t.prototype.activateRibbonTab=function(e){this.activateAndSetCurrentContextualTab(e)},t.prototype.addTabData=function(e,t){},t.prototype.initializeRibbonStore=function(){var e=[];this._shouldShowActionButtonInRibbon&&e.push(this.getShowActionButtonStoreAction("Share")),this._ribbonTrimmingProperties&&(e.push.apply(e,this.getTrimmedIdsHideActions()),"FileMenu"in this._ribbonTrimmingProperties.trimmedTabs&&e.push(appChrome.actions.updateFileMenuHiddenValue(!0))),this.setUlsExternalLogger(),er.apiExists("setWebpackPublicPath")&&appChrome.api.setWebpackPublicPath(L.AFrameworkApplication.get_staticContentScriptNameBase()),e.push.apply(e,this.getPollForStateAndUpdateActions()),er.appChromeContainsAction("setControlBehaviorAttached")&&e.push(appChrome.actions.setControlBehaviorAttached(!0)),appChrome.api.dispatch(e),wi.r.get_instance().setAppInitializationStatus(7),An.e.get_instance().addDurationMetric(Tn.c.appInitStart,Tn.c.ribbonInteractiveReady,(new Date).getTime())},t.prototype.pollForStateUpdate=function(){wi.r.get_instance().isCompleted(7)&&this._generalCuiUser&&(Xi.t.mark(4893),uC.StylePreviewGenerator.updatePreviewCssWithCurrentStyleSet(),e.prototype.pollForStateUpdate.call(this),Xi.t.mark(4894))},t.prototype.saveMinimizedStateToCookie=function(){},t.prototype.tabSwitch=function(e,t,n,r,i){var o=i;if(2===o[Ju.z.inputMethod]){var a=(0,f.e)(z_.k,t),s=null;if(!a)return C.ULS.sendTraceTag(38549528,338,10,"Context is not a valid ViewContext. It is a {0}, the actionId is: {1}, the actionData is: {2}",Object.getTypeName(t),e,E.n(o," ",":")),8;if(!(s=(0,f.e)(cE.p,a.view))||""===s.get_focusScopeId())return C.ULS.sendTraceTag(38549529,338,10,"Context is not a valid InteractiveView. It is a {0}, the actionId is: {1}, the actionData is: {2}, it is a view type of: {3}",Object.getTypeName(a.view),e,E.n(o," ",":"),this.getInteractiveViewType(a.view)),8;this._focusManager.setScope(s.get_focusScopeId())}return 32},t.prototype.ribbonModeToggled=function(e,t,n,r,i){return 1===n?32:t.get_contextId()!==cl.n?2:(this.setRibbonPreferenceCookie("true"===i.On.toString()),this.pollForStateUpdate(),32)},t.prototype.ribbonModeToggledToMLR=function(e,t,n,r,i){return 1===n?32:t.get_contextId()!==cl.n?2:(this.setRibbonPreferenceCookie(!0),this.pollForStateUpdate(),32)},t.prototype.ribbonModeToggledToSLR=function(e,t,n,r,i){return 1===n?32:t.get_contextId()!==cl.n?2:(this.setRibbonPreferenceCookie(!1),this.setSLREnabledCookie(),this.pollForStateUpdate(),32)},t.prototype.setSLREnabledCookie=function(){var e=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("IsSimplifiedRibbonOnCookieName");ve.r(e,"true",ve.i)},t.prototype.setRibbonPreferenceCookie=function(e){var t=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("ReactRibbonMLRPreferenceCookieName");ve.r(t,e.toString(),ve.i)},t.prototype.getInteractiveViewType=function(e){return e?"is ContentEditableView: "+e.get_isContentEditableView()+" is Editing View: "+e.get_isEditingView()+" is FishbowlView: "+e.get_isFishbowlView()+" is HtmlView: "+e.get_isHtmlView()+" is InteractiveView: "+e.get_isInteractiveView()+" is NavigationPaneView: "+e.get_isNavigationPaneView()+" is PageView: "+e.get_isPageView()+" is WordNavigationPaneHeadingsView "+e.get_isWordNavigationPaneHeadingsView():"null view"},t._ribbonClientID="WACRibbon",t}(lE);(0,o.l)(RE,"ReactRibbonUser$0",lE,[UF.s,HF,GF.j,Sys.IDisposable]);var LE=function(e){function t(t,n,r,i,o,a,s,l,c,u,g,p){var d=e.call(this,t,n,r,i,o,a,s,l,c,u,g,!1,p)||this;return d._shouldShowActionButtonInRibbon$3=!1,d._shouldShowActionButtonInRibbon$3=g.shouldShowActionButtonInRibbon(),d.setupSimplifiedRibbonPlaceholderForRibbonPanel(),d.setupCssForAppFrameAndHeader(),d}return(0,S.t)(t,e),t.prototype.initializeRibbon=function(){wi.r.get_instance().setAppInitializationStatus(5),wi.r.get_instance().executeWhen(10,o.i(this,this.initializeFullRibbon,"initializeFullRibbon"),gr.d.onlyOnRanToCompletion|gr.d.executeSynchronously)},t.prototype.initializeFullRibbon=function(){var e=this;appChrome.getLazyRibbonInitializationActions().then((function(t){return e._shouldShowActionButtonInRibbon$3&&t.push(e.getShowActionButtonStoreAction("Share")),e._ribbonTrimmingProperties&&t.push.apply(t,e.getTrimmedIdsHideActions()),t.push.apply(t,e.getPollForStateAndUpdateActions()),t.push(appChrome.actions.setControlBehaviorAttached(!0)),appChrome.api.dispatch(t),e.addBindCommandHandlerCallback(),e.buildAndSetJewel(),e.initializeFocusManager(),wi.r.get_instance().setAppInitializationStatus(7),An.e.get_instance().addDurationMetric(Tn.c.appInitStart,Tn.c.ribbonInteractiveReady,(new Date).getTime()),e.logRibbonLoaded(),null}))},t.prototype.setupCssForAppFrameAndHeader=function(){var e=Br.App.get_activeAppFrame().getDOMElement();Sys.UI.DomElement.removeCssClass(e,"FlexBoxLayout"),Sys.UI.DomElement.addCssClass(e,"OneNoteAppSimplified");var t=document.getElementById("AppHeaderPanel");Sys.UI.DomElement.addCssClass(t,"SimplifiedHeader")},t.prototype.setupSimplifiedRibbonPlaceholderForRibbonPanel=function(){var e=document.getElementById("WACRibbonPlaceholder");if(e){e.style.height="73px";var t=document.createElement("div");t.id="oneLineRibbonUpper",t.className="oneLineRibbonUpper",e.appendChild(t);var n=document.createElement("div");n.id="oneLineRibbonLower",n.className="oneLineRibbonLower",e.appendChild(n)}},t}(RE);(0,o.l)(LE,"ReactRibbonUser",RE,[]);var NE=function(){function e(e,t,n){this._appFrame=null,this._ribbon=null,this._focusManager=null,this._appFrame=e,this._ribbon=t,this._focusManager=n}return e.prototype.initialize=function(e,t){var n=this;t.addAction(te.lX,nt.a,o.i(this,this.ribbonMoveForwardAction,"ribbonMoveForwardAction")),t.addAction(te.NL,nt.a,o.i(this,this.ribbonMoveBackwardAction,"ribbonMoveBackwardAction"));var r=AF.x(kg.u.ribbonFocusId,o.i(this,this.ribbonScopeSetFocus,"ribbonScopeSetFocus"),e,!1,!0,!0);this.rebindTabHandlers(r),r.addOnBlur(o.i(this,this.ribbonScopeOnBlur,"ribbonScopeOnBlur")),this._appFrame.get_theF6Manager().setOnBeforeF6(kg.u.ribbonFocusId,(function(e){n._ribbon.commitAnyPendingChange()})),AF.x(kg.u.headerUiFocusId,null,this._ribbon.get_peripheralContentContainer(),!0,!0,!0)},e.prototype.ribbonMoveForwardAction=function(e,t,n,r,i){var o=document.activeElement,a=this._focusManager.getCurrentRegion();return o&&!this._ribbon.get_tabShowing()&&o===a.listing.get_lastElement()?(a.listing.trySetCurrentElement(o),a.moveForward()?32:8):4},e.prototype.ribbonMoveBackwardAction=function(e,t,n,r,i){var o=document.activeElement,a=this._focusManager.getCurrentRegion();return o&&o===a.listing.get_firstElement()?(a.listing.trySetCurrentElement(o),a.moveBackward()?32:8):4},e.prototype.rebindTabHandlers=function(e){var t=Xe.KeyInputManager.hashKey(Je.v.vK_Tab,0),n=Xe.KeyInputManager.hashKey(Je.v.vK_Tab,4);e.unBindAction(t),e.unBindAction(n),e.bindAction(t,te.lX),e.bindAction(n,te.NL)},e.prototype.ribbonScopeSetFocus=function(e,t){this._appFrame&&(this._ribbon.setFocusOnCurrentTabTitle(),e.name===$e.AFrame.modalCommandUIFocusId||e.name.endsWith("/modal")||this._ribbon.enterKeytipMode(o.i(this,this.restoreFocusOnRibbonBlur,"restoreFocusOnRibbonBlur")))},e.prototype.ribbonScopeOnBlur=function(e,t){this._appFrame&&t&&t.name!==$e.AFrame.modalCommandUIFocusId&&(this._ribbon.exitKeytipMode(),this._ribbon.get_tabPoppedUp()&&this._ribbon.dismissTabPopup())},e.prototype.restoreFocusOnRibbonBlur=function(){Nt.FocusManager.instance().popScope(kg.u.ribbonFocusId)},e}();(0,o.l)(NE,"RibbonFocusManager",null,[]);var BE=n(5792),OE=function(){function e(e,t){this._commandTrimmer=null,this._wrappingTrimmer=null,this._commandTrimmer=e,this._wrappingTrimmer=t}return e.prototype.setTrimmedIds=function(e){this._commandTrimmer.setTrimmedIds(e),this._wrappingTrimmer&&this._wrappingTrimmer.setTrimmedIds(e)},e.prototype.setJewelTrimmedIds=function(e){this._commandTrimmer.setJewelTrimmedIds(e),this._wrappingTrimmer&&this._wrappingTrimmer.setJewelTrimmedIds(e)},e.prototype.updateTrimmedIds=function(e){this._commandTrimmer.updateTrimmedIds(e),this._wrappingTrimmer&&this._wrappingTrimmer.updateTrimmedIds(e)},e}();(0,o.l)(OE,"RibbonCommandTrimmer",null,[BE.r]);var UE=n(7833),HE=function(){function e(e,t){this._appSettingsManager=null,this._ribbonDependencies=null,this._appSettingsManager=e,this._ribbonDependencies=t}return e.prototype.setTrimmedIds=function(e){if(G.y.get_isIPad()&&G.y.get_iPadOsVersion()<6&&(e.fseaInsertPicture=!0),this._appSettingsManager.getBooleanAppSetting("InsertSymbolIsEnabled")||(e.grpInsertSymbols=!0),this._appSettingsManager.getBooleanAppSetting("ClipartInsertEnabled")||(e.fseaInsertClipart=!0),this._appSettingsManager.getBooleanAppSetting("UIDiscoverabilityEnabled")||(e.jbtnAccessibilityHelp=!0),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var t=this._appSettingsManager.getBooleanAppSetting("InsertOnlinePictureEnabled"),n=L.AFrameworkApplication.isInsertOnlinePictureFromHostSupported();t||(e.fseaInsertOnlinePicture=!0,e.fseaFlyInsertOnlinePictureFromSearch=!0),n||(e.fseaFlyInsertOnlinePictureFromHost=!0,e.fseaInsertOnlinePictureFromHost=!0),n&&t?(e.fseaInsertOnlinePicture=!0,e.fseaInsertOnlinePictureFromHost=!0):e.flyOnlinePicture=!0,L.AFrameworkApplication.get_trimOICButtons()&&(e.btnOpenInClient=!0)}else!function(e,t,n,r,i,o){e[t]=!0,e[n]=!0,e[r]=!0,o&&i?e[r]=!1:i?e[t]=!1:o&&(e[n]=!1)}(e,"fseaInsertOnlinePicture","fseaInsertOnlinePictureFromHost","flyOnlinePicture",this._appSettingsManager.getBooleanAppSetting("InsertOnlinePictureEnabled"),L.AFrameworkApplication.isInsertOnlinePictureFromHostSupported()),this.setJewelTrimmedIds(e)},e.prototype.setJewelTrimmedIds=function(e){e.menuJewel=!0,L.AFrameworkApplication.showFeedbackButton||(e.jbtnGiveFeedback=!0)},e.prototype.updateTrimmedIds=function(e){delete e.menuJewel,L.AFrameworkApplication.privacyUrl||(e.jbtnPrivacy=!0),L.AFrameworkApplication.reportAbuseUrl||(e.jbtnReportAbuse=!0),L.AFrameworkApplication.termsUrl||(e.jbtnTermsOfUse=!0),L.AFrameworkApplication.fileShareEnabled||(e.jbtnFileSharing=!0),us.n.get_instance().get_item(50)&&L.AFrameworkApplication.replyWithChangesUrl||(e.jbtnShareRWC=!0),us.n.get_instance().get_item(58)&&(L.AFrameworkApplication.fileVersionUrl||L.AFrameworkApplication.useFileVersionPostMessage)||(e.jbtnVersion=!0),this._ribbonDependencies.officeTrialExperience&&this._ribbonDependencies.officeTrialExperience.get_offerOfficeTrialInFileMenu()||(e.btnjTryOffice=!0,e.btnjTryOfficeForWordEditor=!0),this._ribbonDependencies.macOfficeOffer&&this._ribbonDependencies.macOfficeOffer.get_shouldOfferMacOfficeTrialInFileMenu()||(e.btnjTryMacOffice=!0,e.btnjTryMacOfficeForWordEditor=!0),L.AFrameworkApplication.get_trimOICButtons()?(e.btnjOpenInClient=!0,e.btnjEditInClient=!0):us.n.get_instance().get_item(58)&&(e[Br.App.get_canEdit()?"btnjOpenInClient":"btnjEditInClient"]=!0),L.AFrameworkApplication.get_trimDownloadACopy()&&(e.jbtnDownloadACopy=!0,e.jbtnDownloadAsPdf=!0,e.jbtnDownloadAsOdt=!0),!L.AFrameworkApplication.get_protectFile()&&us.n.get_instance().get_item(52)&&(L.AFrameworkApplication.hostEmbeddedViewUrl||L.AFrameworkApplication.fileEmbedCommandUrl||L.AFrameworkApplication.useFileEmbedCommandPostMessage)||(e.jbtnFileEmbed=!0),UE.f.includeCloseButton()||(e.btnjClose=!0),L.AFrameworkApplication.get_isSkyDrive()?L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordOneDriveConsumerSharedVersionHistoryIsEnabled")?(e.jbtnVersion=!0,L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Excel.Server.Flighting.WordOneDriveConsumerSharedVersionHistoryIsEnabled"),C.ULS.sendTraceTag(594629315,3005,15,"Word external version history menu item for OneDriveConsummer trimmed.")):(e.btnjVersionHistory=!0,C.ULS.sendTraceTag(594629314,3005,15,"Word shared version history menu item for OneDriveConsumer trimmed.")):L.AFrameworkApplication.isVersionHistorySupported()||(e.btnjVersionHistory=!0),us.n.get_instance().get_item(58)?e.jbtnVersion&&e.btnjVersionHistory&&e.btnjOpenInClient&&(!us.n.get_instance().get_item(58)||e.btnjEditInClient)&&(e.faInfo=!0):e.btnjOpenInClient&&(e.faInfo=!0),L.AFrameworkApplication.get_readFromMruIsEnabled()||(e.faOpen=!0),e.jbtnFileSharing&&e.jbtnFileEmbed&&e.jbtnShareRWC&&(e.faShare=!0),e.AboutInformationMenuSectionDiagnostics=!this._appSettingsManager.getBooleanAppSetting("DiagnosticsInfoInJewelAboutMenuIsEnabled"),e.btnjTryOffice&&e.btnjTryMacOffice&&e.jbtnTermsOfUse&&e.jbtnPrivacy&&e.AboutInformationMenuSectionDiagnostics&&(e.faAbout=!0),e.jbtnHelp&&e.jbtnGiveFeedback&&e.jbtnReportAbuse&&(e.faHelp=!0),e.btnjClose&&(e.msJewelSecondary=!0),e.faOpen&&e.faNew&&(e.faHome=!0)},e}();(0,o.l)(HE,"WoncaCommandTrimmer",null,[BE.r]);var GE=function(){return function(){this.accessibilityTextCommand=null,this.command=null,this.commandMenuClose=null,this.commandMenuOpen=null,this.menuControlExecutedCommand=null,this.onInteractionBegin=null,this.onRestoreFocus=null,this.onInputBoxFocus=null,this.onInputBoxBlur=null,this.populateQueryCommand=null,this.populateAsyncTriggerCommand=null,this.altText=null,this.placeHolderText=null,this.keytip=null}}();(0,o.l)(GE,"TellMeSearchBoxInfo",null,[]);var VE=n(7773),WE=n(3380),zE=function(e){function t(){var t=e.call(this)||this;return t.showJewelId=null,t.jewelBuildOptions=null,t.displayMinimized=!1,t.staticUiTouchMode=!1,t.isSingleRowLayoutRibbon=!1,t}return(0,S.t)(t,e),t}(WE.l);(0,o.l)(zE,"RibbonBuildOptions",WE.l,[]);var KE=n(931),qE=n(2880),jE=n(2437),$E=n(1532),QE=(0,o.y)("IKeytipManager"),JE=n(9139),XE=n(8768),YE=n(6463),ZE=function(){return function(e,t){this.component=null,this.next=null,this.component=e,this.next=t}}();(0,o.l)(ZE,"ComponentStackNode",null,[]);var eP=function(){function e(){this._top=null}return e.prototype.push=function(e){var t=new ZE(e,this._top);this._top=t},e.prototype.pop=function(){if(this.get_isEmpty())return null;var e=this._top.component;return this._top=this._top.next,e},e.prototype.peek=function(){return this.get_isEmpty()?null:this._top.component},e.prototype.clear=function(){this._top=null},e.prototype.get_isEmpty=function(){return!this._top},e}();(0,o.l)(eP,"ComponentStack",null,[]);var tP=n(3638),nP=n(454),rP=function(){function e(e,t,n){this._ribbon=null,this._keyInputManager=null,this._pointerInputManager=null,this._displayedKeytips=null,this._layerStack=null,this._launcherWithFocus=null,this._inKeytipMode=!1,this._isMenuOpen=!1,this._inputStringCache=null,this.$$pf_OnExitCallback=null,this._generatedKeytipCounter=1,this._ribbon=e,this._keyInputManager=t,this._pointerInputManager=n,this._displayedKeytips=new y.c(JE.s),this._layerStack=new eP,this._inKeytipMode=!1,this._inputStringCache="",this.set_onExitCallback(null)}return e.prototype.get_displayedKeytips=function(){return this._displayedKeytips},e.prototype.get_layerStack=function(){return this._layerStack},e.prototype.get_inputStringCache=function(){return this._inputStringCache},e.prototype.get_inKeytipMode=function(){return this._inKeytipMode},e.prototype.get_keytipZIndex=function(){return this._ribbon?this._ribbon.get_tabPoppedUp()?this._ribbon.get_activeModalUIZIndex()+2:this._ribbon.get_activeModalUIZIndex()-2:0},e.prototype.get_onExitCallback=function(){return this.$$pf_OnExitCallback},e.prototype.set_onExitCallback=function(e){return this.$$pf_OnExitCallback=e,e},e.prototype.enterKeytipMode=function(){this._inKeytipMode||(C.ULS.sendTraceTag(19961422,340,50,"Entering keytip mode"),this._inKeytipMode=!0,this._isMenuOpen=!1,this._ribbon.prepareToEnterKeytipMode(),this.showChildKeytipsForParent(this._ribbon),this.registerHandlers())},e.prototype.exitKeytipMode=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this._inKeytipMode&&(C.ULS.sendTraceTag(19961423,340,50,"Exiting keytip mode"),this._inKeytipMode=!1,this.hideKeytips(),this._layerStack.clear(),this._ribbon.prepareToExitKeytipMode(t),this.unregisterHandlers(),!e&&this.get_onExitCallback()&&this.get_onExitCallback()())},e.prototype.registerHandlers=function(){this._keyInputManager.registerHandlerWithCaptureOption(Le.d.keyDown,this._ribbon.get_elementInternal(),o.i(this,this.keyDownHandler,"keyDownHandler"),!0),this._pointerInputManager.registerHandlerWithCaptureOption(Le.d.pointerDown,this._ribbon.get_elementInternal(),o.i(this,this.pointerDownHandler,"pointerDownHandler"),!0),this._keyInputManager.registerHandler(Le.d.keyPress,this._ribbon.get_elementInternal(),o.i(this,this.keyPressHandler,"keyPressHandler"))},e.prototype.unregisterHandlers=function(){this._keyInputManager.unregisterHandlerWithCaptureOption(Le.d.keyDown,this._ribbon.get_elementInternal(),o.i(this,this.keyDownHandler,"keyDownHandler"),!0),this._pointerInputManager.unregisterHandlerWithCaptureOption(Le.d.pointerDown,this._ribbon.get_elementInternal(),o.i(this,this.pointerDownHandler,"pointerDownHandler"),!0),this._keyInputManager.unregisterHandler(Le.d.keyPress,this._ribbon.get_elementInternal(),o.i(this,this.keyPressHandler,"keyPressHandler"))},e.prototype.showChildKeytipsForParent=function(e){if(e){if(this.hideKeytips(),this._inputStringCache="",this._layerStack.push(e),this.isMenuComponent(e))this.showKeytipsForMenu(this.getMenuLauncherFromComponent(e));else{if(e.get_children())for(var t=e.get_children().getEnumerator();t.moveNext();){var n=t.get_current();if(o.r(tP.Group,n)){var r=n;this.showKeytipsForGroup(r)}else n.get_hasKeytip()&&this.showComponentKeytip(n)}e===this._ribbon&&(this._ribbon.setFocusOnCurrentTabTitle(),this._ribbon.dismissTabPopup(!1),this._ribbon.get_jewelDisplayedComponent()&&this.showComponentKeytip(this._ribbon.get_jewelDisplayedComponent()),this.showKeytipsForStandaloneRoot())}this._displayedKeytips.get_count()||this.isABacktrackingComponent(e)||this.exitKeytipMode()}},e.prototype.showKeytipsForStandaloneRoot=function(){var e=this._ribbon.get_theStandaloneRoot();if(e&&e.get_controls()){var t=e.get_controls();for(var n in t){var r={key:n,value:t[n]}.value;r.get_displayedComponent()&&this.showComponentKeytip(r.get_displayedComponent())}}},e.prototype.showKeytipsForGroup=function(e){if(e&&e.get_selectedLayout()){for(var t=e.get_selectedLayout().get_children().getEnumerator();t.moveNext();)for(var n=t.get_current().get_children().getEnumerator();n.moveNext();)for(var r=n.get_current().get_children().getEnumerator();r.moveNext();){var i=r.get_current();if(o.r(Mo.r,i)){var a=i;this.showComponentKeytip(a)}}e.get_hasElementDialogLauncherComponent()&&this.showComponentKeytip(e.get_elementDialogLauncherComponent())}},e.prototype.showKeytipsForMenu=function(e){if(e&&e.menuLaunched){for(var t=e.get_menu().get_children().getEnumerator();t.moveNext();)for(var n=t.get_current().get_children().getEnumerator();n.moveNext();){var r=n.get_current();this.showComponentKeytip(r)}this._isMenuOpen=!0}},e.prototype.showKeytipsFromList=function(e){for(var t=e.$$lge();t.$$mn();){var n=t.$$cu();this.showComponentKeytip(n)}},e.prototype.showComponentKeytip=function(e){e.showKeytip(this.get_keytipZIndex())&&this._displayedKeytips.add(e)},e.prototype.hideKeytips=function(){for(var e=this._displayedKeytips.$$lge();e.$$mn();){var t=e.$$cu();!o.r(nP.Tab,t)&&o.r(Mo.r,t),t.hideKeytip()}this._displayedKeytips.clear()},e.prototype.exitCurrentLayer=function(){if(this._layerStack.pop(),this._layerStack.get_isEmpty())this.exitKeytipMode(!1);else{this.hideKeytips();var e=this._layerStack.pop();this.isMenuComponent(e)?this._launcherWithFocus=this.getMenuLauncherFromComponent(e):this._isMenuOpen=!1,this.showChildKeytipsForParent(e)}},e.prototype.isMenuComponent=function(e){return o.r(Mo.r,e)&&!!e.get_control()&&o.r(Ri.MenuLauncher,e.get_control())},e.prototype.getMenuLauncherFromComponent=function(e){return e.get_control()},e.prototype.keyDownHandler=function(e){if(!this._inKeytipMode)return!1;var t=!1;if(!Li.x(e.innerEvent))switch(e.innerEvent.keyCode){case Je.v.vK_Esc:this.exitCurrentLayer(),t=!0;break;case Je.v.vK_Tab:this.exitKeytipMode(void 0,!1),t=!1;break;case Je.v.vK_Enter:case Je.v.vK_Space:this.exitKeytipMode(void 0,!1),t=!0}return t},e.prototype.keyPressHandler=function(e){if(!this._inKeytipMode)return!1;var t=!1;if(!Li.x(e.innerEvent)){var n=Xe.KeyInputManager.getFieldFromDomEvent(e.innerEvent,"charCode")||Xe.KeyInputManager.getKeyCodeFromDomEvent(e.innerEvent),r=String.fromCharCode(n).toUpperCase(),i=this.findComponentToActivate(r);t=(t=o.r(nP.Tab,i)?this.switchTab(i):o.r(Mo.r,i)?this.executeControlDefaultAction(i,e):this.filterKeytips(r))||this._isMenuOpen}return t},e.prototype.pointerDownHandler=function(e){return!!this._inKeytipMode&&(this.exitKeytipMode(void 0,!1),!0)},e.prototype.findComponentToActivate=function(e){for(var t=this._inputStringCache+e,n=this._displayedKeytips.$$lge();n.$$mn();){var r=n.$$cu();if(r.get_keytip()&&r.get_keytip().get_key()===t)return r}return null},e.prototype.filterKeytips=function(e){for(var t=new y.c(JE.s),n=this._displayedKeytips.$$lge();n.$$mn();){var r=n.$$cu(),i=r.get_keytip().get_key();r.get_enabled()&&e===i.substr(this._inputStringCache.length,1)&&t.add(r)}return t.get_count()>0&&(this.hideKeytips(),this.showKeytipsFromList(t),this._inputStringCache+=e,!0)},e.prototype.switchTab=function(e){return e.setFocusOnTitle(),this.logKeytipExecution(e.get_id(),"tab"),e.doTitleDefaultAction(1),this._ribbon.setFocusOnCurrentTabTitle(),this.showChildKeytipsForParent(e),!0},e.prototype.executeControlDefaultAction=function(e,t,n){if(void 0===n&&(n=!0),!e.get_enabled())return!1;if(e.get_control().setFocusOnControl(),n&&this.logKeytipExecution(e.get_control().get_id(),e.get_control().get_controlType()),this.isAnEditableComponent(e))this.exitKeytipMode(void 0,!1);else if(e.get_control().behavior.doDefaultAction(t.get_sourceElement(),t.get_inputSource(),t.innerEvent),this.isMenuComponent(e))if(this._launcherWithFocus=this.getMenuLauncherFromComponent(e),this._launcherWithFocus.get_menu()&&this._launcherWithFocus.get_menu().get_elementInternal()){for(var r=this._launcherWithFocus.get_menu().get_menuLauncherChildren().getEnumerator();r.moveNext();){r.get_current().onMenuLaunchCallback=o.i(this,this.onMenuLaunch,"onMenuLaunch")}this._launcherWithFocus.onMenuCloseCallback=o.i(this,this.onMenuClose,"onMenuClose"),this._keyInputManager.registerHandler(Le.d.keyDown,this._launcherWithFocus.get_menu().get_elementInternal(),o.i(this,this.keyDownHandler,"keyDownHandler")),this._keyInputManager.registerHandler(Le.d.keyPress,this._launcherWithFocus.get_menu().get_elementInternal(),o.i(this,this.keyPressHandler,"keyPressHandler")),this.showChildKeytipsForParent(e)}else{var i=this._launcherWithFocus.get_menu()?this._launcherWithFocus.get_menu().get_id():"";C.ULS.sendTraceTag(19797896,340,10,"Unexpected null menu (id: "+i+") element; cannot invoke keytip")}else this.exitKeytipMode(L.AFrameworkApplication.get_theTaskManager().get_isYielding());return!0},e.prototype.onMenuLaunch=function(e,t){this.executeControlDefaultAction(e,t,!1)},e.prototype.onMenuClose=function(e){void 0===e&&(e=!0),this._launcherWithFocus&&this._launcherWithFocus.get_menu()&&this._launcherWithFocus.get_menu().get_elementInternal()&&(this._keyInputManager.unregisterHandler(Le.d.keyDown,this._launcherWithFocus.get_menu().get_elementInternal(),o.i(this,this.keyDownHandler,"keyDownHandler")),this._keyInputManager.unregisterHandler(Le.d.keyPress,this._launcherWithFocus.get_menu().get_elementInternal(),o.i(this,this.keyPressHandler,"keyPressHandler")),e?(this._isMenuOpen=!1,this._launcherWithFocus=null,this.exitKeytipMode()):this.exitCurrentLayer())},e.prototype.isABacktrackingComponent=function(e){return this._isMenuOpen&&!this.isAnEditableComponent(e)},e.prototype.isAnEditableComponent=function(e){if(o.r(Mo.r,e)){var t=e.get_control();return o.r(XE.r,t)||o.r(io.y,t)||o.r(YE.p,t)}return!1},e.prototype.logKeytipExecution=function(e,t){C.ULS.sendTraceTag(19961424,340,50,"Executing keytip for {0} component (id: {1})",t,e)},e.prototype.getNewGeneratedKeytipString=function(){return this.getNewGeneratedKeytipStringInternal(this._generatedKeytipCounter++)},e.prototype.getNewGeneratedKeytipStringInternal=function(e){if(e<1)return null;for(var t=new Sys.StringBuilder,n=0;n<Math.ceil(e/9);n++)t.append(CommonUIStrings.l_AddInKeytip);return t.append(e%9?e%9:9),t.toString()},e}();(0,o.l)(rP,"KeytipManager",null,[QE]);var iP=n(3545),oP=function(){function e(e,t,n,r){if(this._groupId=null,this._layoutName=null,this._scaleWarningMessage=null,this._warnForScale=!1,this._scalingInfo=null,Li.x(e)||Li.x(t))throw Error.create("groupId, layoutName and message cannot be undefined or null");this._groupId=e,this._layoutName=t,this._scaleWarningMessage=n,this._warnForScale=r}return e.prototype.setParent=function(e){this._scalingInfo=e},e.prototype.get_groupId=function(){return this._groupId},e.prototype.get_layoutName=function(){return this._layoutName},e.prototype.get_scaleWarningMessage=function(){return this._scaleWarningMessage},e.prototype.get_hasScaleWarning=function(){return this._warnForScale},e.prototype.get_previousLayoutName=function(){if(Li.x(this._scalingInfo))return null;for(var e=this._scalingInfo.getGroupMaxSize(this._groupId),t=this._scalingInfo.get_stepsInternal(),n=0;n<t.length;n++){var r=t[n];if(r===this)break;r.get_groupId()===this._groupId&&(e=r.get_layoutName())}return e},e}();(0,o.l)(oP,"ScalingStep",null,[]);var aP=function(){return function(){}}();(0,o.l)(aP,"Template",null,[]);var sP=function(){return function(){this.ribbon=null,this.controls=null,this.parameters=null}}();(0,o.l)(sP,"DeclarativeTemplateBuildContext",null,[]);var lP=function(e){function t(t){var n=e.call(this)||this;return n._data=null,n._data=new KE.o(t),n}return(0,S.t)(t,e),t.prototype.createGroup=function(e,t,n,r,i,o,a,s,l){var c=new sP;c.ribbon=e,c.controls=a,c.parameters=s;for(var u=e.createGroup(t,n,r,i,o,l),g=0;g<this._data.get_children().length;g++){var p=this.createLayoutFromData(this._data.get_children()[g],u,c);Li.x(p)||u.addChild(p)}return u},t.prototype.createLayoutFromData=function(e,t,n){var r=e[KE.o.ATTRIBUTES][KE.o.TITLE],i=n.ribbon.createLayout(t.get_id()+"-"+r,r,t.get_visible());return i.setDelayedInitData(o.i(this,this.delayInitLayout,"delayInitLayout"),e,n),i},t.prototype.delayInitLayout=function(e,t,n){var r=e,i=n;return this.fillLayout(t,r,i),r.onDelayedInitFinished(!0),r},t.prototype.fillLayout=function(e,t,n){for(var r=e[KE.o.CHILDREN],i=0,o=0;o<r.length;o++){if(r[o][KE.o.NAME]===KE.o.SECTION){var a=this.createSectionFromData(r[o],n,t,i++);t.addChild(a)}}},t.prototype.createSectionFromData=function(e,t,n,r){var i,o=e[KE.o.ATTRIBUTES][KE.o.TYPE],a=e[KE.o.ATTRIBUTES][KE.o.ALIGNMENT],s=(e[KE.o.ATTRIBUTES][KE.o.HORIZONTALALIGNMENT],e[KE.o.ATTRIBUTES][KE.o.SHOWECTIONSEPERATOR]);switch(o){case KE.o.ONEROW:i=2;break;case KE.o.TWOROW:i=3;break;case KE.o.THREEROW:i=4;break;case KE.o.DIVIDER:i=1;break;default:throw Error.create('Invalid Section attribute "Type" found in XML: '+o)}var l=1;"Middle"===a&&(l=2);var c=!!s&&Boolean.parse(s),u=t.ribbon.createSection(n.get_id()+"-"+r,i,l,1,c,n.get_visible());return 1!==i&&(this.handleRow(u.getRow(1),e[KE.o.CHILDREN][0],t),3!==u.get_type()&&4!==u.get_type()||this.handleRow(u.getRow(2),e[KE.o.CHILDREN][1],t),4===u.get_type()&&this.handleRow(u.getRow(3),e[KE.o.CHILDREN][2],t)),u},t.prototype.handleRow=function(e,t,n){for(var r=t[KE.o.CHILDREN],i=0;i<r.length;i++){var o=null;r[i][KE.o.NAME]===KE.o.CONTROL&&(o=this.createControlComponentFromData(r[i],n)),Li.x(o)||e.addChild(o)}},t.prototype.createControlComponentFromData=function(e,t){var n=e[KE.o.ATTRIBUTES],r=n[KE.o.TEMPLATEALIAS],i=n[KE.o.DISPLAYMODE],a=t.controls[r],s=null;return!Li.x(a)&&o.r(Pi.Control,a)&&(s=a.createComponentForDisplayMode(i)),s},t}(aP);(0,o.l)(lP,"DeclarativeTemplate",aP,[]);var cP=function(){function e(){this._templates=null,this._templates={}}return e.prototype.addTemplate=function(e,t){this._templates[t]=e},e.prototype.removeTemplate=function(e){this._templates[e]=null},e.prototype.getTemplate=function(e){return this._templates[e]},e.prototype.loadTemplates=function(e){for(var t=KE.o.getFirstChildNodeWithName(e,KE.o.RIBBONTEMPLATES),n=KE.o.getNodeChildren(t),r=0;r<n.length;r++)this.loadGroupTemplate(n[r])},e.prototype.loadGroupTemplate=function(e){var t=new KE.o(e),n=t.get_attributes()[KE.o.id],r=t.get_attributes()[KE.o.CLASSNAME];Li.x(this._templates[n])&&Li.x(r)&&(this._templates[n]=new lP(e))},e.get_instance=function(){return Li.x(e._instance)&&(e._instance=new e),e._instance},e._instance=null,e}();(0,o.l)(cP,"TemplateManager",null,[]);var uP=function(e){function t(t,n,r,i){var o=e.call(this,t,n,It.Task.fromResult(GF.j,r),i)||this;if(o._keytipManager=null,Li.x(n))throw Error.create("Ribbon placeholder DOM element is null or undefined.");return C.ULS.sendTraceTag(34468253,340,50,"User is booting the Classic Ribbon"),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(te.fU,nt.a,Ze.ActionManager.doNothingButReportHandler,64),L.AFrameworkApplication.get_theActionManager().processAction(te.fU,2),o}return(0,S.t)(t,e),t.prototype.get_ribbon=function(){return this.get_root()},t.prototype.set_ribbon=function(e){return this.set_root(e),e},t.prototype.get_ribbonBuildOptions=function(){return this.get_options()},t.prototype.get_tableOfContentUpdateIsEnabled=function(){return!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordEditorTableOfContentUpdateIsEnabled")&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordEditorAutoSaveParametersIsEnabled")},t.prototype.buildRibbonAndInitialTab=function(e){if(Li.x(e))throw Error.create("Initial tab for ribbon is null or undefined");if(this.get_inQuery())return!1;var t=new iP.x;t.initialTabId=e,this.set_inQuery(!0);var n=new qE.v;return n.id=t.initialTabId,n.queryType=2,n.handler=o.i(this,this.onReturnRibbonAndInitialTab,"onReturnRibbonAndInitialTab"),n.data=t,this.get_dataSource().runQuery(n),wi.r.get_instance().setAppInitializationStatus(10),!0},t.prototype.buildRibbonFromData=function(e,t){var n=new iP.x;n.initialTabId=t;var r=new jE.r;r.success=!0,r.queryData=e,r.contextData=n,this.onReturnRibbonAndInitialTab(r)},t.prototype.rebuildGroupsInTab=function(e){var t=new qE.v,n=new jE.r;t.id=e,t.queryType=2,t.handler=function(e){n=e},this.get_dataSource().runQuery(t);var r=new iP.x;r.initialTabId=this.get_ribbon().get_homeTab().get_id(),r.initializedTab=this.get_ribbon().get_homeTab();for(var i=KE.o.getFirstChildNodeWithName(n.queryData,KE.o.RIBBON),o=new KE.o(i),a=KE.o.getNodeChildren(KE.o.getFirstChildNodeWithName(o.get_node(),KE.o.TABS)),s=0;s<a.length;s++){var l=a[s];if(new KE.o(l).get_attributes()[KE.o.id]===e){for(var c=KE.o.getFirstChildNodeWithName(l,KE.o.GROUPS),u=KE.o.getNodeChildren(c),g=this.get_ribbon().getChild(e),p=0;p<u.length;p++){var d=KE.o.getNodeAttribute(u[p],KE.o.id);Li.x(d)||Li.x(g.getChild(d))||(g.removeChild(d),g.get_scaling().removeGroupMaxSize(d),g.get_scaling().removeScalingStepWithGroupId(d))}this.addGroupToRibbon(e,l,r);break}}},t.prototype.rebuildJewel=function(){Li.t(this.get_ribbonBuildOptions().showJewelId)||this.get_ribbon().rebuildAndSetJewel(this.get_ribbonBuildOptions().showJewelId,this.get_dataSource())},t.prototype.addTabToRibbon=function(e,t,n){void 0===n&&(n=-1);var r=[];r[0]=e,this.addTabsToRibbon(r,null,t,!0,n)},t.prototype.addGroupToRibbon=function(e,t,n){var r=this.get_ribbon().getChild(e);this.fillTab(r,t,n,!0),r.refreshInternal()},t.prototype.removeGroupAndTabFromRibbon=function(e,t){var n=this.get_ribbon().getChild(e);if(n&&n.getChild(t)){n.removeChild(t),n.get_scaling().removeGroupMaxSize(t),n.get_scaling().removeScalingStepWithGroupId(t);for(var r=n.get_children().getEnumerator();r.moveNext();){r.get_current();return}this.get_ribbon().removeChild(e)}},t.prototype.onReturnRibbonAndInitialTab=function(e){var t=this,n=e.contextData;Bi.n.ensureCSSClassOnElement(this.get_placeholder(),"loaded");var r=KE.o.getFirstChildNodeWithName(e.queryData,KE.o.TEMPLATES);Li.x(r)||cP.get_instance().loadTemplates(r),this.set_ribbon(this.buildRibbon(e.queryData,n)),this.get_ribbon().set_ribbonBuilder(this);var i=this.get_ribbonBuildOptions().displayMinimized;this.get_ribbon().set_minimizedInternal(i);var o=this.get_ribbon().getChild(n.initialTabId);this.get_ribbon().set_homeTab(o),i||this.get_ribbon().makeTabSelectedInternal(o),this.get_ribbon().set_clientID(this.get_ribbonBuildOptions().clientID),this.get_ribbon().ensureDOMElement(),Li.t(this.get_ribbonBuildOptions().showJewelId)||this.get_ribbon().buildAndSetJewel(this.get_ribbonBuildOptions().showJewelId,this.get_dataSource()),Bi.n.removeChildNodesSlow(this.get_placeholder()),this.get_placeholder().appendChild(this.get_ribbon().get_elementInternal()),this.get_ribbon().scale(),this.get_buildClientTask().CWo((function(e){t.get_buildClientTask().get_result().onComponentBuilt(t.get_ribbon(),t.get_ribbon().get_id())}),gr.d.onlyOnRanToCompletion|gr.d.executeSynchronously)},t.prototype.onReturnTab=function(e){var t=e.contextData;if(e.success){var n=KE.o.getFirstChildNodeWithName(e.queryData,KE.o.TAB);if(!n)return;var r=KE.o.getFirstChildNodeWithName(e.queryData,KE.o.TEMPLATES);r&&cP.get_instance().loadTemplates(r),this.fillTab(t.initializedTab,n,t),t.initializedTab.onDelayedInitFinished(!0)}},t.prototype.buildRibbon=function(e,t){var n=KE.o.getFirstChildNodeWithName(e,KE.o.RIBBON);if(Li.x(n))throw Error.create("No ribbon element was present in the data");var r=new KE.o(n);this.set_ribbon(new mo.Ribbon(r.get_attributes().Id,r.get_attributes(),this.get_ribbonBuildOptions().staticUiTouchMode,this.get__resizableContainer(),this.get_ribbonBuildOptions().isSingleRowLayoutRibbon)),this._keytipManager=new rP(this.get_ribbon(),Xe.KeyInputManager.get_instance(),xi.z.get_instance()),this.get_ribbon().keytipManager=this._keytipManager,this.get_ribbon().set_useDataCookie(!0);var i=KE.o.getNodeChildren(KE.o.getFirstChildNodeWithName(r.get_node(),KE.o.TABS));this.addTabsToRibbon(i,null,t);var o=KE.o.getFirstChildNodeWithName(r.get_node(),KE.o.CONTEXTUALTABS);if(!Li.x(o))for(var a=KE.o.getNodeChildren(o),s=0;s<a.length;s++)this.addContextualGroup(a[s],t);return this.get_ribbon()},t.prototype.addContextualGroup=function(e,t){var n=KE.o.getNodeAttributes(e),r=0,i=n[KE.o.id];switch(n[KE.o.COLOR]){case KE.o.MAGENTA:r=3;break;case KE.o.GREEN:r=2;break;case KE.o.ORANGE:r=1;break;case KE.o.PURPLE:r=5;break;case KE.o.YELLOW:r=4;break;default:r=0}this.get_ribbon().addContextualGroup(i,n[KE.o.TITLE],r,n[KE.o.COMMAND]);var o=KE.o.getNodeChildren(e);this.addTabsToRibbon(o,n[KE.o.id],t)},t.prototype.addTabsToRibbon=function(e,t,n,r,i){void 0===r&&(r=!1),void 0===i&&(i=-1);for(var o=this.get_tableOfContentUpdateIsEnabled(),a=0;a<e.length;a++){var s=e[a],l=new KE.o(s).get_attributes()[KE.o.id];this.isIdTrimmed(l)?"tabReferences"!==l||-1===i||o||this.get_ribbon().addChildAtIndex(this.buildTab(s,n,t,r),i+a):-1!==i?this.get_ribbon().addChildAtIndex(this.buildTab(s,n,t,r),i+a):this.get_ribbon().addChild(this.buildTab(s,n,t,r))}},t.prototype.buildTab=function(e,t,n,r){var i,a=new KE.o(e),s=a.get_attributes()[KE.o.KEYTIP];return!s&&this._keytipManager&&(s=this._keytipManager.getNewGeneratedKeytipString()),i=Li.x(n)?this.get_ribbon().createTab(a.get_attributes()[KE.o.id],a.get_attributes()[KE.o.TITLE],a.get_attributes()[KE.o.DESCRIPTION],a.get_attributes()[KE.o.COMMAND],a.get_attributes()[KE.o.CSSCLASS],s):this.get_ribbon().createContextualTab(a.get_attributes()[KE.o.id],a.get_attributes()[KE.o.TITLE],a.get_attributes()[KE.o.DESCRIPTION],a.get_attributes()[KE.o.COMMAND],n,a.get_attributes()[KE.o.CSSCLASS],s),a.get_children().length?this.fillTab(i,e,t,r):i.setDelayedInitData(o.i(this,this.delayInitTab,"delayInitTab"),a.get_node(),t.clone()),i},t.prototype.fillTab=function(e,t,n,r){void 0===r&&(r=!1);for(var i=KE.o.getFirstChildNodeWithName(t,KE.o.GROUPS),o=KE.o.getNodeChildren(i),a={},s=0;s<o.length;s++)if(!this.isNodeTrimmed(o[s])){var l=this.buildGroup(o[s],n,e);if(Li.x(l)){var c=KE.o.getNodeAttribute(o[s],KE.o.id);Li.x(c)||(a[c]=c)}else e.addChild(l)}var u=KE.o.getFirstChildNodeWithName(t,KE.o.SCALING),g=KE.o.getNodeChildren(u),p=null,d=!1;for(s=0;s<g.length;s++){var h=KE.o.getNodeName(g[s]),_=KE.o.getNodeAttributes(g[s]),m=_[KE.o.GROUPID];if(h===KE.o.MAXSIZE){if(this.isIdTrimmed(m)||!Li.x(a[m]))continue;e.get_scaling().setGroupMaxSize(m,_[KE.o.SIZE])}else if(h===KE.o.SCALE){if(this.isIdTrimmed(m)||!Li.x(a[m]))continue;e.get_scaling().addScalingStep(new oP(m,_[KE.o.SIZE],p,d),r),p=null,d=!1}else{if(h!==KE.o.LOWSCALEWARNING)throw Error.create("Was expecting a node with name MaxSize or Scale.");p=_[KE.o.MESSAGE],d=!0}}e.scaleMax()},t.prototype.assertScaleHasMatchingGroup=function(e,t){for(var n=e.get_children().getEnumerator();n.moveNext();){if(n.get_current().get_id()===t){!0;break}}},t.prototype.delayInitTab=function(e,t,n){var r=n,i=e,a=new KE.o(t);if(r.initializedTab=e,!a.get_hasChildren()){var s=new qE.v;return s.id=r.initializedTab.get_id(),s.queryType=3,s.handler=o.i(this,this.onReturnTab,"onReturnTab"),s.data=r,this.get_dataSource().runQuery(s),null}return this.fillTab(i,t,r),i.onDelayedInitFinished(!0),this.get_ribbon().refresh(),i},t.prototype.buildGroup=function(e,t,n){var r=new KE.o(e),i=r.get_attributes()[KE.o.TEMPLATE],a=cP.get_instance().getTemplate(i);if(Li.x(a))throw Error.create("A template with name: "+i+" could not be loaded.");for(var s={},l=null,c=0;c<r.get_children().length;c++)if(r.get_children()[c][KE.o.NAME]===KE.o.CONTROLS){l=r.get_children()[c];break}if(Li.x(l))throw Error.create("No Controls node found in this Group tag.");var u=KE.o.getNodeChildren(l);for(c=0;c<u.length;c++)if(!this.isNodeTrimmed(u[c])){var g=this.buildControl(u[c],t);if(g){this._keytipManager&&g.get_needsAKeytip()&&!g.get_controlProperties().Keytip&&(g.get_controlProperties().Keytip=this._keytipManager.getNewGeneratedKeytipString()),g.parentKeytipsIds=String.format("{0} {1}{2}",$E.v.ribbonShortcutId,n.get_id(),$E.v.keytipId),g.parentKeytipsKeys=n.get_keytip().get_key().toLocaleLowerCase();var p=s[g.get_templateAlias()];Li.x(p)?s[g.get_templateAlias()]=g:o.r(Array,p)?Array.add(p,g):s[g.get_templateAlias()]=[p,g]}}var d=r.get_attributes()[KE.o.id],h=this.isIdTrimmed(tP.Group.getLauncherButtonId(d));return a.createGroup(this.get_ribbon(),d,r.get_attributes(),r.get_attributes()[KE.o.TITLE],r.get_attributes()[KE.o.DESCRIPTION],r.get_attributes()[KE.o.COMMAND],s,null,h)},t.prototype.clearGlobalAppState=function(){wi.r.get_instance().clearAppInitializationStatus(10),L.AFrameworkApplication.get_theActionManager().removeAction(te.fU,nt.a,Ze.ActionManager.doNothingButReportHandler)},t}(no.Builder);(0,o.l)(uP,"RibbonBuilder",no.Builder,[]);var gP="OneNoteRibbonData",pP="WordEditorRibbonData",dP=function(){function e(t,n,r,i,a,s,l,c,u,g){var p=this;if(void 0===g&&(g=null),this._hostingAppFrame=null,this._topRowPeripheralControlCreator=null,this._ribbonPanel=null,this._generalCuiUserFuture=null,this._generalCuiUser=null,this._theRibbon=null,this._standaloneRoot=null,this._ribbonCommandTrimmer=null,this._dataSource=null,this._ribbonMinimizedCookieName=null,this._ribbonDependencies=null,null==t)throw Error.argumentNull("hostingAppFrame");this._ribbonPanel=n,this._generalCuiUserFuture=i,this._hostingAppFrame=t,this._ribbonDependencies=a,this._standaloneRoot=l,this._ribbonCommandTrimmer=new OE(new HE(L.AFrameworkApplication.appSettingsManager,a),c),this._ribbonMinimizedCookieName=u,this._topRowPeripheralControlCreator=g,this._generalCuiUserFuture.execute((function(e){p._generalCuiUser=e})),Xi.t.mark(4891),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&Sys.UI.DomElement.addCssClass(this._ribbonPanel,"FlexBoxLayout"),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()&&Sys.UI.DomElement.addCssClass(this._ribbonPanel,"MLRVisualRefresh");var d=[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings],h=new Ct.CuiHelper(Za.f.box4ImageBase,r,null,null,d);G.y.get_isIPad()&&Ct.CuiHelper.registerOnClickBreadcrumbLink(gE),this._topRowPeripheralControlCreator||(this._topRowPeripheralControlCreator=new hE(this._standaloneRoot));var _=new zE;_.clientID=e._ribbonClientID,_.showJewelId=2===Br.App.get_mode()?"jewelWordEditor":"jewelOneNote",_.trimmedIds={},_.displayMinimized=this.getMinimizedStateFromCookie(this._hostingAppFrame.get_ribbonMinimizedByDefault()),_.staticUiTouchMode=this._hostingAppFrame.get_isStaticUiTouchMode(),_.jewelBuildOptions=new YF.l,_.jewelBuildOptions.trimmedIds=_.trimmedIds,this._ribbonCommandTrimmer.setTrimmedIds(_.trimmedIds),this.updateJewelBuildOptions(_.jewelBuildOptions);var m=a.areReady();m&&(this._ribbonCommandTrimmer.updateTrimmedIds(_.trimmedIds),this.createPeripheralSections(n,h)),no.Builder.enableInsertTable(),no.Builder.enableSpinner();var f=new uP(_,n,this,s);this._dataSource=new VE.p(2===Br.App.get_mode()?pP:gP,h),f.set_dataSource(this._dataSource),f.buildRibbonAndInitialTab("tabHome"),this._theRibbon=f.get_ribbon(),this._theRibbon.attachStandaloneRoot(this._standaloneRoot),i.execute((function(e){p.get_theRibbon().set_rootUser(e)})),new NE(this._hostingAppFrame,this.get_theRibbon(),this._ribbonDependencies.get_focusManager()).initialize(this._ribbonPanel,this._ribbonDependencies.get_actionManager()),Xi.t.mark(4892);var y=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BootPerfRibbonPollIsEnabled"),C=new De.c(y?0:2,1,y?0:100,o.i(this,this.initialRootRefresh,"initialRootRefresh"));L.AFrameworkApplication.get_theTaskManager().addTask(C);var S=new _E.d;m?(wi.r.get_instance().setAppInitializationStatus(5),S.dismissFastViewRibbonAndHeader()):a.waitForReady((function(){var e=p.get_theRibbon().get_builder();p._ribbonCommandTrimmer.updateTrimmedIds(e.get_options().trimmedIds),p.updateJewelBuildOptions(e.get_options().jewelBuildOptions),e.rebuildJewel(),p.createPeripheralSections(n,h),p.get_theRibbon().reloadPeripherals(),wi.r.get_instance().setAppInitializationStatus(5),S.dismissFastViewRibbonAndHeader()}),null)}return e.prototype.get_standaloneRootControlManager=function(){return this._standaloneRoot.get_cuiControlManager()},e.prototype.updateJewelBuildOptions=function(e){},e.prototype.getPrintButtonInfo=function(){return null},e.prototype.getSyncStatusLabelInfo=function(){return null},e.prototype.getGiveFeedbackButtonInfo=function(){return null},e.prototype.getOpenInClientButtonInfo=function(){var e=null;return L.AFrameworkApplication.get_trimOICButtons()||((e=new dE.i).command="3588168074",e.label=this._hostingAppFrame.get_applicationInstance().get_editInClientButtonText()),e},e.prototype.getTellMeSearchBoxInfo=function(){var e=null;return L.AFrameworkApplication.tellMeIsEnabled&&((e=new GE).accessibilityTextCommand="4054875485",e.command="2652476189",e.commandMenuClose="4266170064",e.commandMenuOpen="2480888384",e.menuControlExecutedCommand="878547493",e.onInteractionBegin="586156566",e.onRestoreFocus="3243793933",e.onInputBoxFocus="2303219627",e.onInputBoxBlur="1024534176",e.populateQueryCommand="2652476189",e.populateAsyncTriggerCommand="2751631965",e.altText=String.format(CommonUIStrings.l_LookupHotkeyText,CommonUIStrings.l_LookupAltText),e.placeHolderText=CommonUIStrings.l_LookupAltText,e.keytip=CommonUIStrings.l_LookupAltTextKeytip),e},e.prototype.createBottomRowCenterControls=function(t,n){n.createBottomRowCenterControls(e._ribbonClientID,t,this.getPrintButtonInfo(),this.getTellMeSearchBoxInfo(),this.getOpenInClientButtonInfo(),this.getGiveFeedbackButtonInfo(),this.get_standaloneRootControlManager())},e.prototype.createBottomRowRightControls=function(t,n){this._topRowPeripheralControlCreator.createRibbonPeripheralControls(t,n,e._ribbonClientID),this.createSyncStatusControl(this._standaloneRoot.get_cuiControlManager(),t.lastChild)},e.prototype.createSyncStatusControl=function(e,t){var n=this.getSyncStatusLabelInfo();if(n&&e){var r={};r.Id=n.id,r.LabelText=n.labelText,r.QueryCommand=n.queryCommand,r.Image16by16=L.AFrameworkApplication.get_imageClusterPath(),r.Image16by16Class=Lt.getImageClass("OLCalApptRecurI_16x16x32");var i=Tu.oH("Label",null,r),o=e.hostControl(n.id,i,"Medium");o&&t&&(Sys.UI.DomElement.addCssClass(o,"SyncStatusControl"),t.insertBefore(o,t.firstChild))}},e.prototype.createPeripheralSections=function(t,n){this._topRowPeripheralControlCreator.createTopRowControls(t,n,e._ribbonClientID),this.createBottomRowCenterControls(t,n),this.createBottomRowRightControls(t,n)},e.prototype.dispose=function(){null!==this._theRibbon&&(this._theRibbon.dispose(),this._theRibbon=null),this._hostingAppFrame.disposeAllFloaties(),this._topRowPeripheralControlCreator&&(this._topRowPeripheralControlCreator.disposeTopRowControls(),this._topRowPeripheralControlCreator=null),this._hostingAppFrame=null},e.prototype.get_theRibbon=function(){return this._theRibbon},e.prototype.get_ribbonExternal=function(){return this._theRibbon},e.prototype.activateRibbonTab=function(e){this.get_theRibbon().selectTabById(e,!0)},e.prototype.launchJewelMenu=function(e,t){this.get_theRibbon().launchJewel(e,t)},e.prototype.addTabData=function(e,t){this._dataSource.addTabData(e,t)},e.prototype.initialRootRefresh=function(e){this.get_theRibbon().refresh(),this.get_theRibbon().pollForStateAndUpdate()},e.prototype.pollForStateUpdate=function(){this._hostingAppFrame.workspace&&(2===this._hostingAppFrame.get_mode()||us.n.get_instance().get_item(7))&&(L.AFrameworkApplication.get_theTaskManager().get_isYielding()||this._generalCuiUser&&(Xi.t.mark(4893),this._generalCuiUser.clearCache(),uC.StylePreviewGenerator.updatePreviewCssWithCurrentStyleSet(),this.get_theRibbon().get_root().pollForStateAndUpdate(),Xi.t.mark(4894),wi.r.get_instance().isCompleted(7)||(wi.r.get_instance().setAppInitializationStatus(7),wi.r.get_instance().setAppInitializationStatus(11),An.e.get_instance().addDurationMetric(Tn.c.appInitStart,Tn.c.ribbonInteractiveReady,(new Date).getTime()))))},e.prototype.updatePeopleWellControl=function(){},e.prototype.updateDocChatControl=function(){},e.prototype.saveMinimizedStateToCookie=function(){ve.r(this._ribbonMinimizedCookieName,this.get_theRibbon().get_minimized()?"true":"false",$e.AFrame.uiCookieExpirationDays)},e.prototype.getMinimizedStateFromCookie=function(e){return ve.e(this._ribbonMinimizedCookieName,e)},e.prototype.updateControls=function(e){},e.prototype.onComponentBuilt=function(e,t){this._generalCuiUserFuture.execute((function(t){e.set_rootUser(t)}))},e._ribbonClientID="WACRibbon",e}();(0,o.l)(dP,"RibbonUser$0",null,[UF.s,HF,GF.j,Sys.IDisposable]);var hP=n(6844),_P=function(){function e(t,n,r,i){void 0===i&&(i=!1),this.theAppSettingsManager=null,this.officeTrialExperience=null,this.macOfficeOffer=null,this.isPasteOptionsEnable=!1,this._isFullAppSettingsReady=!1,this._actionManager=null,this._focusManager=null,this.theAppSettingsManager=t,this._isFullAppSettingsReady=this.theAppSettingsManager.get_isFullAppSettingsReady(),this.officeTrialExperience=se.w.get_instance().tryResolve($v.v),this.macOfficeOffer=se.w.get_instance().tryResolve(Qv.u),e._callbackExecuted=!1,this.isPasteOptionsEnable=i,this._actionManager=n,this._focusManager=r}return e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.get_focusManager=function(){return this._focusManager},e.prototype.areReady=function(){return this._isFullAppSettingsReady&&!!this.officeTrialExperience&&!!this.macOfficeOffer},e.prototype.waitForReady=function(e,t,n){var r=this;void 0===n&&(n=null),this.theAppSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){C.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready"),r._isFullAppSettingsReady=!0,r.executeCallbackWhenReady(e,t)})),se.w.get_instance().resolveFuture($v.v).execute((function(n){C.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready"),r.officeTrialExperience=n,r.executeCallbackWhenReady(e,t)})),se.w.get_instance().resolveFuture(Qv.u).execute((function(n){C.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready"),r.macOfficeOffer=n,r.executeCallbackWhenReady(e,t)}))},e.prototype.executeCallbackWhenReady=function(t,n){e._callbackExecuted||(this.areReady()?(C.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),t(this,n),e._callbackExecuted=!0):C.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))},e._callbackExecuted=!1,e}();(0,o.l)(_P,"RibbonDependencies",null,[hP.b]);var mP=function(){return function(){this.id=null,this.labelText=null,this.queryCommand=null}}();(0,o.l)(mP,"LabelInfo",null,[]);var fP=function(e){function t(t,n,r,i,o,a,s,l,c,u,g){return e.call(this,t,n,r,i,new _P(L.AFrameworkApplication.appSettingsManager,a,s),o,l,c,u,g)||this}return(0,S.t)(t,e),t.prototype.getSyncStatusLabelInfo=function(){return!L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxFlightEnabled()&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteSyncStatusEnabled")?(0,O.m)(new mP,{id:"lblSyncStatus",labelText:null,queryCommand:"894288409"}):null},t.prototype.getGiveFeedbackButtonInfo=function(){return L.AFrameworkApplication.showFeedbackButton?(0,O.m)(new dE.i,{command:"802602464",label:WoncaIntl.WoncaStrings.L_GiveFeedback}):null},t.prototype.getPrintButtonInfo=function(){return Wr.App.oneNotePrintIsEnabled?(0,O.m)(new dE.i,{command:"1588554917",label:OneNoteIntl.OneNoteStrings.L_Print}):null},t.prototype.createBottomRowCenterControls=function(t,n){if(Wr.App.get_isOneNoteEmbedded()&&Wr.App.oneNoteEmbedShowEditFlyout){var r=Ct.CuiHelper.createGenericPeripheralSection(dP._ribbonClientID,PE.r.bottomRowCenter);Ct.CuiHelper.addPrintButton(this.getPrintButtonInfo(),r,this.get_standaloneRootControlManager()),Ct.CuiHelper.addSeparator(r,this.get_standaloneRootControlManager()),this.addEmbedOpenInClientFlyout(r),Ct.CuiHelper.addFeedbackButton(this.getGiveFeedbackButtonInfo(),this.get_standaloneRootControlManager(),r),t.appendChild(r)}else e.prototype.createBottomRowCenterControls.call(this,t,n)},t.prototype.addEmbedOpenInClientFlyout=function(e){var t=this.get_standaloneRootControlManager().hostControl("OneNoteEmbedOpenInClientFlyoutAnchor_BottomRowCenter",this.buildEmbedOpenInClientFlyoutXml(),"Medium");e.appendChild(t)},t.prototype.buildEmbedOpenInClientFlyoutXml=function(){var e=[this.buildOpenInClientButtonXml("btnEditInClient",ii.AM,OneNoteIntl.OneNoteStrings.L_OpenInApp,"OneNote_32x32x32"),this.buildOpenInClientButtonXml("btnFlyoutEditOnWeb",eb.eK,OneNoteIntl.OneNoteStrings.L_OpenInWebApp,"EditInOneNoteWebApp_32x32x32")],t=Tu.OU("menuSectionEdit",Tu.IV("ctrlsEdit",e),"Menu32");return this.buildFlyoutXml("flyoutOneNoteEdit",OneNoteIntl.OneNoteStrings.L_OpenInApp,t)},t.prototype.buildOpenInClientButtonXml=function(e,t,n,r,i){return void 0===i&&(i=null),Tu.yL(e,t.toString(),n,r,null,null,n,"Menu32",null,null,i)},t.prototype.buildFlyoutXml=function(e,t,n){return Tu.sI(e,"798637440",null,null,!1,!0,null,null,"None",null,null,t,null,t,null,!1,!1,!0,[n])},t}(dP);(0,o.l)(fP,"RibbonUser",dP,[]);var yP=function(e){function t(t){return e.call(this,t,"SharingSet_Start_Glyph_OneNote_16x16x32")||this}return(0,S.t)(t,e),t.prototype.getTopRightActionButtonInfo=function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteDisableFileSharing")?null:e.prototype.getTopRightActionButtonInfo.call(this)},t.prototype.shouldShowActionButtonInRibbon=function(){var e=this.getActionButtonInfo();return!(!e||"981334692"!==e.command)&&(!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxFlightEnabled())},t.prototype.shouldShowRibbonToggleButtonInHeader=function(){return!1},t}(hE);(0,o.l)(yP,"TopRowPeripheralControlCreator",hE,[]);var CP=n(2484),SP=function(){return function(e,t,n){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),this.trimmedIds=null,this.trimmedGallerySections=null,this.trimmedTabs=null,this.trimmedIds=e||{},this.trimmedGallerySections=t||[],this.trimmedTabs=n||{}}}();(0,o.l)(SP,"RibbonTrimmingProperties",null,[]);var vP=function(){return function(e,t,n){this.dataSource=null,this.trimmedIds=null,this.jewelId=null,this.dataSource=e,this.trimmedIds=t,this.jewelId=n}}();(0,o.l)(vP,"ReactRibbonJewelProperties",null,[]);var bP=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n,r,i)||this;return s._externalUICommandDefinitionMapping=null,s._reactRoot=null,s._externalUICommandDefinitionMapping=o,s._reactRoot=a,s}return(0,S.t)(t,e),t.prototype.createRibbonUser=function(e,t,n){return L.AFrameworkApplication.hideRibbonEmbedded?null:L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?this.createSingleLineRibbon(e,t):this.createMultilineRibbon(e,t,n)},t.prototype.createSingleLineRibbon=function(e,t){var n=new _P(L.AFrameworkApplication.appSettingsManager,this._actionManager,this._focusManager),r=new OE(new HE(L.AFrameworkApplication.appSettingsManager,n),new CP.h),i=this.initializeSimplifiedRibbonJewelProperties(n,r),o={};r.setTrimmedIds(o);var a=new LE(e,t,OneNoteIntl.OneNoteStrings,this._generalCuiUserFuture,n,e,this._theStandaloneRoot,this._externalUICommandDefinitionMapping,i,new SP(o),new yP(this._theStandaloneRoot),this._reactRoot);return a.initializeRibbon(),a},t.prototype.createMultilineRibbon=function(e,t,n){return new fP(e,t,OneNoteIntl.OneNoteStrings,this._generalCuiUserFuture,e,this._actionManager,this._focusManager,this._theStandaloneRoot,new CP.h,n,new yP(this._theStandaloneRoot))},t.prototype.initializeSimplifiedRibbonJewelProperties=function(e,t){var n=[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings],r=new Ct.CuiHelper(Za.f.box4ImageBase,OneNoteIntl.OneNoteStrings,void 0,void 0,n),i=new VE.p("OneNoteJewelRibbonData",r),o={},a=new OE(new HE(L.AFrameworkApplication.appSettingsManager,e),t);return a.setTrimmedIds(o),a.updateTrimmedIds(o),new vP(i,o,"jewelOneNote")},t}(OF);(0,o.l)(bP,"OneNoteRibbonUserFactory",OF,[]);var TP=(0,o.y)("IToolbarInitializer"),AP=n(425),IP=n(4126),wP=n(8066),xP=function(e){function t(n,r,i){var o=e.call(this,n,r,"","")||this;return o._overflowFlyoutAnchor=null,o.heroDockControls=null,o._heroDockProperties=null,o.heroControlCount=t.defaultHeroControlCount,o.heroDockControls=new Array(0),o._heroDockProperties=i,o}return(0,S.t)(t,e),t.prototype.get_visibleInDOM=function(){return!0},t.prototype.get_cssClass=function(){return"cui-herodock"},t.prototype.refreshInternal=function(){this.refreshHeroDockVisuals(),e.prototype.refreshInternal.call(this)},t.prototype.ensureBehaviorAttached=function(){for(var t=0,n=this.heroDockControls;t<n.length;t++){n[t].ensureBehaviorAttachedIfAvailable()}e.prototype.ensureBehaviorAttached.call(this)},t.prototype.splitHeroDockControls=function(e,t,n){e.val=new Array(0),t.val=new Array(0),n.val=new Array(0);for(var r=0;r<this.heroDockControls.length;r++){var i=this.heroDockControls[r];i.get_visible()?e.val.length<this.heroControlCount?e.val.push(i):o.r(wP.FlyoutAnchor,i)?Array.addRange(t.val,i.getControlsInFlyoutAnchorMenu()):t.val.push(i):n.val.push(i)}},t.prototype.createOverflowMenu=function(e){if(!e||!e.length)return null;for(var t={DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},n=new Zi.Menu(this.get_root(),this.get_id()+"OverflowMenu",null,null,null),r=new wo.z(this.get_root(),this.get_id()+"OverflowMenuSection",null,null,t,n),i=0,o=e;i<o.length;i++){var a=o[i];r.addChild(a.createComponentForDisplayMode("Menu20"))}return n.addChild(r),n},t.prototype.refreshHeroDockVisuals=function(){var e,t,n;this.removeChildren(),this.set_elementInternal(Bi.n.removeChildNodes(this.get_elementInternal())),this.ensureDOMElement(),this.splitHeroDockControls((0,p.m)((function(){return e}),(function(t){return e=t})),(0,p.m)((function(){return t}),(function(e){return t=e})),(0,p.m)((function(){return n}),(function(e){return n=e})));for(var r=0,i=e;r<i.length;r++){(g=i[r].createComponentForDisplayMode("Medium20")).set_enabled(!0),this.addChildAtIndex(g,this.get_children().get_count()),this.get_elementInternal().appendChild(g.get_elementInternal()),g.ensureRefreshed()}var o=this.createOverflowMenu(t);if(o){if(this._overflowFlyoutAnchor)this._overflowFlyoutAnchor.set_menu(o);else{var a=this.get_id()+"OverflowMenuLauncher",s={};s.Image20by20=this._heroDockProperties.OverflowMenuImage20by20,s.Image20by20Class=this._heroDockProperties.OverflowMenuImage20by20Class,s.PopulateDynamically="false",s.HideDefaultArrow="true",s.Alt=this._heroDockProperties.OverflowMenuTooltip,s.Command="798637440",s.Id=a,this._overflowFlyoutAnchor=new wP.FlyoutAnchor(this.get_root(),a,s,o)}var l=this._overflowFlyoutAnchor.createComponentForDisplayMode("Small20");l.set_enabled(!0),this.addChildAtIndex(l,this.get_children().get_count()),this.get_elementInternal().appendChild(l.get_elementInternal()),l.ensureRefreshed()}if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(var c=0,u=n;c<u.length;c++){var g=u[c].createComponentForDisplayMode("Medium20");this.addChild(g),g.ensureRefreshed()}},t.prototype.dispose=function(){this._overflowFlyoutAnchor&&(this._overflowFlyoutAnchor.dispose(),this._overflowFlyoutAnchor=null);for(var t=0,n=this.heroDockControls;t<n.length;t++){n[t].dispose()}this.removeChildren(),e.prototype.dispose.call(this)},t.defaultHeroControlCount=4,t}(JE.s);(0,o.l)(xP,"HeroDock",JE.s,[]);var FP=function(e){function t(){var t=e.call(this)||this;return t.staticUiTouchMode=!1,t.isOneRowToolbar=!1,t.supportsEmphasizedControls=!1,t.maxElementsBeforeOverflow=L.AFrameworkApplication.isMobileMode?1:xP.defaultHeroControlCount,t}return(0,S.t)(t,e),t}(WE.l);(0,o.l)(FP,"ToolbarBuildOptions",WE.l,[]);var EP=(0,o.y)("IToolbar"),PP=n(6067),kP=function(e){function t(t,n,r){var i=e.call(this,t,n,"","")||this;return i._alignment=null,i._dropFromStart=!1,i._alignment=r.Alignment,i._dropFromStart=r.ScalingDirection===KE.o.FIRSTTOLAST,i}return(0,S.t)(t,e),t.prototype.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.get_elementInternal()),e.prototype.refreshInternal.call(this)},t.prototype.appendChildrenToElement=function(e){for(var t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();switch(n.ensureDOMElement(),this._alignment){case KE.o.LEFTALIGN:Bi.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-toolbar-button-left");break;case KE.o.CENTERALIGN:Bi.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-toolbar-button-center");break;case KE.o.RIGHTALIGN:Bi.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this._alignment)}n.get_visible()&&e.appendChild(n.get_elementInternal()),n.ensureRefreshed()}},t.prototype.ensureCorrectChildType=function(e){if(!o.r(Mo.r,e))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.")},t.prototype.get_cssClass=function(){switch(this._alignment){case KE.o.LEFTALIGN:return"cui-toolbar-buttondock alignleft";case KE.o.CENTERALIGN:return"cui-toolbar-buttondock aligncenter";case KE.o.RIGHTALIGN:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this._alignment)}},t.prototype.get_visibleInDOM=function(){return!0},t.prototype.get_alignment=function(){return this._alignment},t.prototype.getWidthPx=function(){var e=0;if(this.get_alignment()===KE.o.CENTERALIGN)for(var t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();n.get_visible()&&(e+=n.get_elementInternal().offsetWidth)}else e=this.get_elementInternal().offsetWidth;return e},t.prototype.getStartPoint=function(){var e=null;if(this.get_alignment()===KE.o.CENTERALIGN)for(var t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();if(n.get_visible()){e=Sys.UI.DomElement.getBounds(n.get_elementInternal());break}}else e=Sys.UI.DomElement.getBounds(this.get_elementInternal());return e?this.get_root().get_textDirection()?e.x+e.width:e.x:0},t.prototype.getEndPoint=function(){var e=null;if(this.get_alignment()===KE.o.CENTERALIGN){if(this.get_children().get_count()>0)for(var t=this.get_children().getEnumeratorAtPos(this.get_children().get_count()-1);t.movePrevious();){var n=t.get_current();if(n.get_visible()){e=Sys.UI.DomElement.getBounds(n.get_elementInternal());break}}}else e=Sys.UI.DomElement.getBounds(this.get_elementInternal());return e?this.get_root().get_textDirection()?e.x:e.x+e.width:0},t.prototype.ensureNoChildrenScaledAway=function(){for(var e=this.get_children().getEnumerator();e.moveNext();){var t=e.get_current();o.r(Mo.r,t)&&!t.get_control().get_visible()||t.set_visible(!0)}},t.prototype.scaleDownToFitSize=function(e){for(var t=this.get_children().toArray(),n=new PP.y,r=this._dropFromStart?0:t.length-1,i=this.get_children().get_count(),a=this.get_root().get_supportsInvisibleControls();this.getWidthPx()>=e&&!(r>=i||r<0);){var s=t[r];a&&o.r(Mo.r,s)&&s.get_control().get_visible()&&(n.add(s),s.applyHideElementOverride()),r+=this._dropFromStart?1:-1}for(var l=n.getEnumerator();l.moveNext();){(s=l.get_current()).removeHideElementOverride(),s.set_visible(!1)}},t}(JE.s);(0,o.l)(kP,"ButtonDock",JE.s,[]);var DP=function(e){function t(t,n,r,i,o,a,s){void 0===s&&(s=!1);var l=e.call(this,t,n,a)||this;return l._builder$3=null,l._startDock=null,l._centerDock=null,l._endDock=null,l._multipleDocksOfSameType=!1,l._toolbarScalingOptimizationsEnabled=!1,l._toolbarSize=0,l._builder$3=r,l.set_isStaticUiTouchMode(i),l.supportsEmphasizedControls=o,l._toolbarSize=0,Li.x(n.Size)||(n.Size===KE.o.ONEROW||r.get_options().isOneRowToolbar?l._toolbarSize=0:n.Size===KE.o.SINGLEDOCK&&(l._toolbarSize=1)),l._toolbarScalingOptimizationsEnabled=s,l}return(0,S.t)(t,e),t.prototype.get_supportsInvisibleControls=function(){return!0},t.prototype.addChild=function(t){if(e.prototype.addChild.call(this,t),o.r(kP,t)&&!this._multipleDocksOfSameType){var n=t;n.get_alignment()===KE.o.LEFTALIGN?(this._startDock&&this.setMultipleDocksOfSameType(),this._startDock=n):n.get_alignment()===KE.o.CENTERALIGN?(this._centerDock&&this.setMultipleDocksOfSameType(),this._centerDock=n):n.get_alignment()===KE.o.RIGHTALIGN&&(this._endDock&&this.setMultipleDocksOfSameType(),this._endDock=n)}},t.prototype.setMultipleDocksOfSameType=function(){this._multipleDocksOfSameType=!0,this._startDock=null,this._centerDock=null,this._endDock=null},t.prototype.setControlVisibility=function(e,t,n){void 0===n&&(n=!0);var r=this.getControlById(e);Li.x(r)||r.get_visible()===t||(r.set_visible(t),n&&this.refresh())},t.prototype.refreshInternal=function(){e.prototype.refreshInternal.call(this),this.refreshInternalCore(!0)},t.prototype.refreshInternalCore=function(e){var t=this.get_root().get_controlWithFocus();Li.x(this.get_elementInternal())&&this.createToolbarStructure(),this.set_elementInternal(Bi.n.removeChildNodes(this.get_elementInternal())),this.hiddenLabel&&this.get_elementInternal().appendChild(this.hiddenLabel);for(var n=this.get_children().getEnumerator();n.moveNext();){var r=n.get_current();r.get_visible()&&(r.ensureDOMElement(),this.get_elementInternal().appendChild(r.get_elementInternal()),r.ensureRefreshed())}this._centerDock&&e&&this.ensureCenterDockLayout(),t&&t.setFocusOnControl(),this.set_dirty(!1)},t.prototype.ensureCenterDockLayout=function(){if(this._centerDock.get_visible()&&this._centerDock.get_children().get_count()&&(this.applyMarginsToCenterDock(0,0),this.doesCenterDockCollide(this._startDock,this._centerDock,this._endDock))){var e=0,t=0,n=this._startDock?this._startDock.getWidthPx():0,r=this._endDock?this._endDock.getWidthPx():0;(r>0||n>0)&&(r>n?(e=0,t=r-n):(e=n-r,t=0)),this.applyMarginsToCenterDock(e,t)}},t.prototype.doesCenterDockCollide=function(e,t,n){var r=!1;return this.get_root().get_textDirection()?(e&&(r=e.getEndPoint()<t.getStartPoint()),!r&&n&&(r=t.getEndPoint()<n.getStartPoint())):(e&&(r=e.getEndPoint()>t.getStartPoint()),!r&&n&&(r=t.getEndPoint()>n.getStartPoint())),r},t.prototype.applyMarginsToCenterDock=function(e,t){this.get_textDirection()?(this._centerDock.get_elementInternal().style.marginRight=e+"px",this._centerDock.get_elementInternal().style.marginLeft=t+"px"):(this._centerDock.get_elementInternal().style.marginLeft=e+"px",this._centerDock.get_elementInternal().style.marginRight=t+"px")},t.prototype.createToolbarStructure=function(){this.ensureDOMElement()},t.prototype.pollForStateAndUpdateInternal=function(){var e=this;this.doPoll((function(){fg.z.prototype.pollForStateAndUpdateInternal.call(e)}))},t.prototype.pollForControlState=function(e){var t=this.getControlById(e);Li.x(t)||this.doPoll(o.i(t,t.pollForStateAndUpdate,"pollForStateAndUpdate"))},t.prototype.doPoll=function(e){this.needScaling=!1,this.needRefresh=!1,e(),(this.needScaling||this.needRefresh)&&(this._toolbarScalingOptimizationsEnabled||this.refresh(),this.scale())},t.prototype.ensureCorrectChildType=function(e){if(!o.r(xP,e)&&!o.r(kP,e))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(o.r(kP,e)&&e.get_alignment()===KE.o.CENTERALIGN)for(var t=this.get_children().getEnumerator();t.moveNext();){if(t.get_current().get_alignment()===KE.o.CENTERALIGN)throw Error.create("Can't add a centered buttondock because one is already present.")}},t.prototype.get_cssClass=function(){var t="cui-toolbar-toolbar ";return this._toolbarSize?1===this._toolbarSize&&(t+="cui-toolbar-singledock "):(t+="cui-toolbar-onerow ",L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()||(t+="UITextTranformUpperCase ")),t+e.prototype.get_cssClass.call(this)},t.prototype.get_domElementTagName=function(){return"div"},t.prototype.get_rootType=function(){return 26},t.prototype.get_toolbarBuilder=function(){return this.get_builder()},t.prototype.set_toolbarBuilder=function(e){return this.set_builder(e),e},t.prototype.createButtonDock=function(e,t){var n=e[KE.o.ATTRIBUTES];return new kP(this.get_root(),n.Id,n)},t.prototype.ensureDOMElement=function(){e.prototype.ensureDOMElement.call(this),this.get_elementInternal().setAttribute("role","toolbar"),this.get_properties().Title&&this.get_elementInternal().setAttribute("title",this.get_properties().Title)},t.prototype.updateOpenMenu=function(e){return!(!this.get_root()||!this.get_root().refreshOpenMenu(e))},t.prototype.setFocusOnToolbar=function(){return this.setFocusOnFirstControl()},t.prototype.scale=function(){if(e.prototype.scale.call(this),!Bi.n.isTrue(this.get_properties().Scale))return!1;if(this._multipleDocksOfSameType)return!1;Li.x(this._startDock)||(this._startDock.set_visible(!0),this._startDock.ensureNoChildrenScaledAway()),Li.x(this._centerDock)||(this._centerDock.set_visible(!0),this._centerDock.ensureNoChildrenScaledAway()),Li.x(this._endDock)||(this._endDock.set_visible(!0),this._endDock.ensureNoChildrenScaledAway()),this.refreshInternalCore(!1);var t=this.get_elementInternal().offsetWidth,n=Li.x(this._startDock)?0:this._startDock.getWidthPx(),r=Li.x(this._centerDock)?0:this._centerDock.getWidthPx(),i=Li.x(this._endDock)?0:this._endDock.getWidthPx();return i+r+n>=t&&(i+n>=t?(this.hideDockIfPresent(this._centerDock),i>=t?(this.hideDockIfPresent(this._startDock),this.scaleDockIfPresent(this._endDock,t)):this.scaleDockIfPresent(this._startDock,t-i)):this.scaleDockIfPresent(this._centerDock,t-i-n)),this.needScaling=!1,this.refreshInternal(),!1},t.prototype.hideDockIfPresent=function(e){e&&e.set_visible(!1)},t.prototype.scaleDockIfPresent=function(e,t){e&&e.scaleDownToFitSize(t)},t.oneRowToolbarHeightPx=26,t}(uo.b);(0,o.l)(DP,"Toolbar",uo.b,[EP]);var MP=function(e){function t(t,n,r,i,o){void 0===o&&(o=!1);var a=e.call(this,t,n,r,!1,!1,i,o)||this;return a._launchMenusUp=!0,a}return(0,S.t)(t,e),t.prototype.get_rootType=function(){return 7},t.prototype.get_cssClass=function(){return t.get_statusBarClassName()+" "+e.prototype.get_cssClass.call(this)},t.get_statusBarClassName=function(){var e="cui-statusbar";return L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()||(e+=" UISmallFont UITextTranformUpperCase"),e},t}(DP);(0,o.l)(MP,"StatusBar",DP,[]);var RP=n(3070),LP=function(e){function t(){var t=e.call(this)||this;return t.toolbar=null,t.isStatusBar=!1,t}return(0,S.t)(t,e),t}(RP.n);(0,o.l)(LP,"ToolbarBuildContext",RP.n,[]);var NP=function(e){function t(t,n,r,i){var o=e.call(this,t,n,It.Task.fromResult(GF.j,r),i)||this;if(Li.x(n))throw Error.create("Toolbar placeholder DOM element is null or undefined.");return o}return(0,S.t)(t,e),t.prototype.get_toolbar=function(){return this.get_root()},t.prototype.set_toolbar=function(e){return this.set_root(e),e},t.prototype.get_toolbarBuildOptions=function(){return this.get_options()},t.prototype.buildToolbar=function(){var e=new LP,t=new qE.v;t.id="toolbar",t.queryType=1,t.handler=o.i(this,this.onReturnToolbarData,"onReturnToolbarData"),t.data=e,this.get_dataSource().runQuery(t)},t.prototype.onReturnToolbarData=function(e){var t=this,n=e.contextData;this.set_toolbar(this.buildToolbarFromData(e.queryData,n)),this.get_toolbar().set_toolbarBuilder(this),this.get_toolbar().refreshInternal(),this.get_placeholder().appendChild(this.get_toolbar().get_elementInternal()),Bi.n.ensureCSSClassOnElement(this.get_placeholder(),"loaded"),this.get_buildClientTask().CWo((function(e){t.get_buildClientTask().get_result().onComponentBuilt(t.get_toolbar(),t.get_toolbar().get_id())}),gr.d.onlyOnRanToCompletion|gr.d.executeSynchronously)},t.prototype.buildToolbarFromData=function(e,t){var n=KE.o.getFirstChildNodeWithName(e,KE.o.TOOLBAR);if(Li.x(n)&&(n=KE.o.getFirstChildNodeWithName(e,KE.o.STATUSBAR),t.isStatusBar=!0),Li.x(n))throw Error.create("No toolbar element was present in the data");var r=new KE.o(n),i=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ToolbarScalingRedundancyEliminationIsEnabled");t.isStatusBar?this.set_toolbar(new MP(r.get_attributes()[KE.o.id],r.get_attributes(),this,this.get__resizableContainer(),i)):this.set_toolbar(new DP(r.get_attributes()[KE.o.id],r.get_attributes(),this,this.get_toolbarBuildOptions().staticUiTouchMode,this.get_toolbarBuildOptions().supportsEmphasizedControls,this.get__resizableContainer(),i)),this.get_toolbar().set_clientID(this.get_options().clientID),this.get_toolbar().set_useDataCookie(!0),this.get_toolbar().refreshInternal();for(var o=KE.o.getNodeChildren(KE.o.getFirstChildNodeWithName(r.get_node(),KE.o.DOCKS)),a=0,s=this.buildAllDocksFromData(o,t);a<s.length;a++){var l=s[a];this.get_toolbar().addChild(l)}return this.get_toolbar()},t.prototype.buildAllDocksFromData=function(e,t){for(var n=new Array(0),r=0;r<e.length;r++)this.isNodeTrimmed(e[r])||Array.add(n,this.buildDockFromData(e[r],t));return n},t.prototype.buildDockFromData=function(e,t){var n=KE.o.getNodeName(e),r=null;return n===KE.o.BUTTONDOCK?r=this.buildButtonDockFromData(e,t):n===KE.o.HERODOCK&&(r=this.buildHeroDockFromData(e,t)),r},t.prototype.buildHeroDockFromData=function(e,t){var n=new KE.o(e),r=e[KE.o.ATTRIBUTES],i=new xP(this.get_root(),n.get_attributes()[KE.o.id],r);i.heroControlCount=this.get_toolbarBuildOptions().maxElementsBeforeOverflow;for(var o=KE.o.getFirstChildNodeWithName(e,KE.o.CONTROLS),a=KE.o.getNodeChildren(o),s=new Array(0),l=0;l<a.length;l++){var c=a[l];if(!this.isNodeTrimmed(c)){var u=this.buildControl(c,t);Array.add(s,u)}}return i.heroDockControls=s,i},t.prototype.buildButtonDockFromData=function(e,t){new KE.o(e);for(var n=this.get_toolbar().createButtonDock(e,t),r=KE.o.getFirstChildNodeWithName(e,KE.o.CONTROLS),i=KE.o.getNodeChildren(r),o=0;o<i.length;o++)if(!this.isNodeTrimmed(i[o])){var a=this.buildToolbarControlComponent(i[o],t);n.addChild(a)}return n},t.prototype.buildToolbarControlComponent=function(e,t){var n,r=new KE.o(e),i=r.get_name(),o=r.get_attributes()[KE.o.DISPLAYMODE];switch(n=t.isStatusBar?"Small14":"Small",i){case KE.o.button:return this.buildControl(e,t).createComponentForDisplayMode(Li.t(o)?n:o);case KE.o.flyoutAnchor:return n=t.isStatusBar?"Medium14":"Medium",this.buildControl(e,t).createComponentForDisplayMode(Li.t(o)?n:o);case KE.o.label:return this.buildControl(e,t).createComponentForDisplayMode(Li.t(o)?n:o);case KE.o.separator:return this.buildControl(e,t).createComponentForDisplayMode("Small");case KE.o.toggleButton:return this.buildControl(e,t).createComponentForDisplayMode(Li.t(o)?n:o);default:throw Error.create("Invalid control type.")}},t}(no.Builder);(0,o.l)(NP,"ToolbarBuilder",no.Builder,[]);var BP="OneNoteToolbarData",OP=function(){function e(e,t,n,r,i,a,s,l){var c=this;if(this._toolbarClientIdOneNote="toolbar",this._theReadingBar=null,this._topRowControls=null,this._hostingAppFrame=null,this._cuiUserFuture=null,this._theViewerChrome=null,null==e)throw Error.argumentNull("hostingAppFrame");this._hostingAppFrame=e,this._cuiUserFuture=r,Xi.t.mark(4895);var u=[WoncaIntl.WoncaStrings,Box4Intl.Box4Strings],g=new Ct.CuiHelper(Za.f.box4ImageBase,n,null,null,u);this._topRowControls=g.createTopRowControls(this._toolbarClientIdOneNote,t,null,l.get_cuiControlManager(),!0,!0);var p=new FP;p.clientID=this._toolbarClientIdOneNote,p.staticUiTouchMode=e.get_isStaticUiTouchMode(),p.trimmedIds={},L.AFrameworkApplication.webEditingEnabled&&Br.App.get_canEdit()||(p.trimmedIds.btnEditOnWeb=!0,Wr.App.oneNoteMultipleAccessLevelsIsEnabled||(p.trimmedIds.btnjOpenInClient=!0,p.trimmedIds.jbtnEditOnWeb=!0,p.trimmedIds.jbtnCopyAndEdit=!0)),L.AFrameworkApplication.showFeedbackButton||(p.trimmedIds.jbtnGiveFeedback=!0),Wr.App.oneNotePrintIsEnabled||(p.trimmedIds.jbtnPrint=!0,p.trimmedIds.btnPrint=!0),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyToCloudIsEnabled")&&"SkyDrive"===L.AFrameworkApplication.appSettingsManager.get_appSettings().FileSource||(p.trimmedIds.jbtnCopyToCloud=!0),L.AFrameworkApplication.privacyUrl||(p.trimmedIds.jbtnPrivacy=!0),L.AFrameworkApplication.reportAbuseUrl||(p.trimmedIds.jbtnReportAbuse=!0),L.AFrameworkApplication.termsUrl||(p.trimmedIds.jbtnTermsOfUse=!0),L.AFrameworkApplication.fileShareEnabled&&!L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteDisableFileSharing")||(p.trimmedIds.jbtnFileSharing=!0,p.trimmedIds.btnFileSharing=!0),i&&i.get_offerOfficeTrialInFileMenu()||(p.trimmedIds.btnjTryOffice=!0),a&&a.get_shouldOfferMacOfficeTrialInFileMenu()||(p.trimmedIds.btnjTryMacOffice=!0),L.AFrameworkApplication.get_trimOICButtons()||L.AFrameworkApplication.limitedEdit?(p.trimmedIds.btnjOpenInClient=!0,p.trimmedIds.btnOpenInClient=!0,p.trimmedIds.sep1=!0,p.trimmedIds.flyoutOneNoteEdit=!0):L.AFrameworkApplication.webEditingEnabled&&!Wr.App.oneNoteMultipleAccessLevelsIsEnabled?(Br.App.get_canEdit()?p.trimmedIds.btnOpenInClient=!0:p.trimmedIds.flyoutOneNoteEdit=!0,p.trimmedIds.btnCopyAndEdit=!0,p.trimmedIds.btnEditOnWeb=!0):Wr.App.oneNoteMultipleAccessLevelsIsEnabled?p.trimmedIds.btnEditOnWeb=!0:p.trimmedIds.flyoutOneNoteEdit=!0,L.AFrameworkApplication.copyAndEditUrl?(p.trimmedIds.jbtnEditOnWeb=!0,p.trimmedIds.btnEditOnWeb=!0,p.trimmedIds.btnFlyoutEditOnWeb=!0):(p.trimmedIds.jbtnCopyAndEdit=!0,p.trimmedIds.btnCopyAndEdit=!0,p.trimmedIds.btnFlyoutCopyAndEdit=!0),UE.f.includeCloseButton()||(p.trimmedIds.btnjClose=!0),Wr.App.get_isOneNoteEmbedded()?(p.trimmedIds.flyoutEmbedOpenInApp=!Wr.App.oneNoteEmbedShowEditFlyout,p.trimmedIds.btnOpenInClient=Wr.App.oneNoteEmbedShowEditFlyout,p.trimmedIds.flyoutOneNoteEdit=!0,p.trimmedIds.btnEditOnWeb=!0,p.trimmedIds.btnFileSharing=!0,p.trimmedIds.btnShowAuthorInfo=!0):p.trimmedIds.flyoutEmbedOpenInApp=!0,this._theViewerChrome=new IP.k(t,this._toolbarClientIdOneNote,s,L.AFrameworkApplication.hideHeader),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEduUser")&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteViewImmersiveReaderInEduIsEnabled")?p.trimmedIds.btnImmersiveMode=!0:p.trimmedIds.btnImmersiveModeEdu=!0,L.AFrameworkApplication.mightNeedPrivacyDialog&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TrustCenterDialogIsEnabled")||(p.trimmedIds.jbtnTrustCenter=!0);var d=new NP(p,this._theViewerChrome.get_toolbarContainer(),this,s);d.set_dataSource(new VE.p(BP,g)),d.buildToolbar(),this._theReadingBar=d.get_toolbar(),this._cuiUserFuture.execute((function(e){c._theReadingBar.set_rootUser(e)})),this._theViewerChrome.scale(),AF.x(AP.AppFrame.readingBarFocusId,null,this._theViewerChrome.get_toolbarContentContainer(),!1,!0,!0),e.get_theF6Manager().setOnBeforeF6(AP.AppFrame.readingBarFocusId,(function(e){c._theReadingBar.commitAnyPendingChange()})),AF.x(AP.AppFrame.readingHeaderUiFocusId,null,this._theViewerChrome.get_peripheralContentContainer(),!1,!0,!0),Xi.t.mark(4896);var h=new De.c(2,1,100,o.i(this,this.initialRootRefresh,"initialRootRefresh"));L.AFrameworkApplication.get_theTaskManager().addTask(h)}return e.prototype.ribbonScopeSetFocus=function(e,t){e.name===$e.AFrame.appFocusId?Nt.FocusManager.tryFocus(this.get_theReadingBar().get_element()):this.get_theReadingBar().pollForStateAndUpdate()},e.prototype.dispose=function(){this._theViewerChrome&&(this._theViewerChrome.dispose(),this._theViewerChrome=null),this._theReadingBar&&(this._theReadingBar.dispose(),this._theReadingBar=null),Ct.CuiHelper.disposeTopRowControls(this._topRowControls),this._topRowControls=null},e.prototype.initialRootRefresh=function(e){this._theReadingBar.refresh(),this._theReadingBar.pollForStateAndUpdate()},e.prototype.get_theReadingBar=function(){return this._theReadingBar},e.prototype.get_theViewerChrome=function(){return this._theViewerChrome},e.prototype.onComponentBuilt=function(e,t){this._cuiUserFuture.execute((function(t){e.set_rootUser(t)}))},e}();(0,o.l)(OP,"ToolbarInitializer",null,[TP,GF.j,Sys.IDisposable]);var UP=function(){function e(e,t,n){this._generalCuiUser=null,this._officeTrialExperience=null,this._macOfficeOffer=null,this._generalCuiUser=e,this._officeTrialExperience=t,this._macOfficeOffer=n}return e.prototype.get_theStandaloneRoot=function(){return se.w.get_instance().resolve(ou.r).get_sharedStandaloneRoot()},e.prototype.createToolbarInitializer=function(e,t){return new OP(e,t,OneNoteIntl.OneNoteStrings,this._generalCuiUser,this._officeTrialExperience,this._macOfficeOffer,e,this.get_theStandaloneRoot())},e}();(0,o.l)(UP,"ToolbarInitializerFactory",null,[Ax.z]);var HP=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"OneNote.UI"},e.prototype.init=function(){this._container.resolve(Ax.z),this._container.resolve(Gx).performInitChecks();var e=Br.App.get_box4Bridge().get_commandUi(),t=Br.App.get_activeAppFrame(),n=new pg(t,e,se.w.get_instance().resolveFuture(lu.h)),r={};L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteFormatPainterIsEnabled")||(r.floatiefseaFormatPainter=!0),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteImageCropIsEnabled")||(r.floatiebtnImageCropDialog=!0),n.initializeFloatie("OneNoteFloatieData",[WoncaIntl.WoncaStrings,OneNoteIntl.OneNoteStrings],r),this._container.resolve(sF).initialize(),this._container.resolve(lu.h);var i={tabInsert:"InsertTabData",tabView:"ViewTabData",ctabPictureTools:"PictureToolsTabData","ContextualTabs.Tables.Layout":"TableLayoutTabData"};L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInkInputEnabled")&&(i.tabDraw="DrawTabData"),!L.AFrameworkApplication.suppressHelp&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HelpTabIsEnabled")&&(i.tabHelp="HelpTabData"),(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioRecordingIsEnabled"))&&(i["ContextualTabs.Audio.Tools"]="AudioToolsTabData"),!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()||(e.ribbonAddTabsContentAsync(i).CWo((function(e){var t=fa.f.get_instance().get_ribbon();t&&t.ensureTabsInitialized(),wi.r.get_instance().setAppInitializationStatus(7),wi.r.get_instance().isCompleted(11)||wi.r.get_instance().setAppInitializationStatus(11)}),gr.d.onlyOnRanToCompletion|gr.d.executeSynchronously),mo.Ribbon.add_onRibbonTabSwitchedEventHandler(o.i(this,this.onRibbonTabSwitched,"onRibbonTabSwitched")))},e.prototype.onRibbonTabSwitched=function(e,t){t.NewContextId},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,e.register(Gx).as(Ix.d).as(wx.d).as(ni.d).singleInstance().usingFactory((function(){return new Gx(e.resolve(Fr.c),e.resolve(Er),L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.appSettingsManager)})),e.register(Bx).as(uh).usingFactory((function(){return new Bx(e.resolve(uu),e.resolve(hu))})),e.register(xx.v).singleInstance().usingFactory((function(){return new qx})),e.register(Fx.f).singleInstance().usingFactory((function(){return new jx})),e.register($x).singleInstance().usingFactory((function(){return new $x})),e.register(Ex.w).singleInstance().usingFactory((function(){return new Qx})),e.register(Px.c).singleInstance().usingFactory((function(){return new Xx})),e.register(kx.d).singleInstance().usingFactory((function(){return new Jx})),e.register(Dx.x).singleInstance().usingFactory((function(){return new eF})),e.register(Mx.b).singleInstance().usingFactory((function(){return new zx})),e.register(Kx.q).as(gg.n).singleInstance().usingFactory((function(){return new Kx.q(L.AFrameworkApplication.get_theActionManager(),se.w.get_instance().resolve(mu),se.w.get_instance().resolve(oh.d))})),e.register(cg.f).singleInstance().usingFactory((function(){return new Zx})),e.register(sF).as(Yu).singleInstance(),e.register(Ax.z).singleInstance().usingFactory((function(){return new UP(se.w.get_instance().resolveFuture(lu.h),se.w.get_instance().resolve($v.v),se.w.get_instance().resolve(Qv.u))})),e.register(BF).as(Rx).as(Lx).singleInstance().usingFactory((function(){return new BF})),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&e.register(Pp).singleInstance().usingFactory((function(){return new Pp(fa.f.get_instance(),e.resolve(su.u),e.resolve(lu.h))})),e.register(bP).as(Tv.x).singleInstance().usingFactory((function(){return new bP(e.resolveFuture(lu.h),L.AFrameworkApplication.get_theActionManager(),Nt.FocusManager.instance(),e.resolve(ou.r).get_sharedStandaloneRoot(),e.resolve(su.u),e.tryResolve(Pp))}))},e.main=function(){var t=Xo.get_instance();t.enableInsertTable(),t.enableSpinner(),t.enableSlider(),N.o.get_instance().registerPackage(new e,6)},e}();(0,o.l)(HP,"OneNoteUIPackage",null,[l.u,c.s]);var GP=n(3386),VP=n(594),WP=(0,o.y)("IContextMenuDataProvider"),zP=n(6943),KP=n(2017),qP=n(5908),jP=n(7238),$P=n(9808),QP=(0,o.y)("IApplication"),JP=(0,o.y)("IBrowser"),XP=(0,o.y)("IDialogService"),YP=(0,o.y)("IEnterViewStrategy"),ZP=n(2203),ek=function(){function e(e,t,n,r,i){this._actionManager=null,this._browserCutCommand=0,this._browserCopiedCommand=0,this._browserPastedCommand=0,this._pasteGivenTextCommand=0,this._actionManager=e,this._browserCutCommand=t,this._browserCopiedCommand=n,this._browserPastedCommand=r,this._pasteGivenTextCommand=i}return e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.browserCutAsync=function(e,t){this.get_actionManager().processActionWithDataAsync(e,this._browserCutCommand,2,t,null,null)},e.prototype.browserCopiedAsync=function(e,t){this.get_actionManager().processActionWithDataAsync(e,this._browserCopiedCommand,2,t,null,null)},e.prototype.browserPasted=function(e,t,n){n?this.get_actionManager().processActionWithDataAsync(e,this._browserPastedCommand,2,t,null,null):this.get_actionManager().processActionWithData(this._browserPastedCommand,2,t)},e.prototype.pasteGivenTextSync=function(e,t,n){void 0===n&&(n=!1);var r=new Kl.DictionaryPropertySet;r.setValue(zl.k.pastedHtmlContent,e),r.setValue(zl.k.pastingForOvertype,t),r.setValue(zl.k.isEndOfParagraphLastContext,n),this.get_actionManager().processActionWithData(this._pasteGivenTextCommand,2,r)},e}();(0,o.l)(ek,"ClipboardCommands",null,[Qp.h]);var tk=function(){function e(){}return e.prototype.ensureSelection=function(){},e}();(0,o.l)(tk,"NoOpEdgeSystemClipboardSelectionEnsureStrategy",null,[Wy]);var nk=function(){function e(e,t,n,r,i,o){this._lockedRangeEditor=null,this._characterPropertiesEditor=null,this._autoCorrectScheduler=null,this._externalSelectionManagerFuture=null,this._trackChangeEditor=null,this._trackChangeManager=null,this._lockedRangeEditor=e,this._characterPropertiesEditor=t,this._autoCorrectScheduler=n,this._externalSelectionManagerFuture=r,this._trackChangeEditor=i,this._trackChangeManager=o}return e.prototype.insertLineBreakView=function(t,n,r,i,o){var a=n.view,s=n.get_nextContext();if(!s)return 2;if(us.n.get_instance().get_item(14)&&!this._lockedRangeEditor.isEnterAllowedForContextSet(s,!0))return 2;if(this._externalSelectionManagerFuture&&this._externalSelectionManagerFuture.get_instance()&&this._externalSelectionManagerFuture.get_instance().isExternalSelectionContext(s))return 2;var l=s,c=!e.get_splitHyperlinkFixWithEnterIsEnabled()||!e.get_hyperlinkStrategy().isIpInHyperlink(l);if(this._autoCorrectScheduler&&c&&this._autoCorrectScheduler.tryToAutocorrectAtTextBreak(l.get_node(),Je.v.vK_Enter,s.get_cpBegin()),this._characterPropertiesEditor.insertBlobAtIp(l,(function(e){return new uy.y(e,uy.y.defaultLineBreakText)}),hc.AParagraphNode.embeddedObjectText),this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeManager.get_changeTrackingDocumentSettingEnabled()){var u=new as.GraphTransaction(15);try{u.setFromNode(l.get_node()),this._trackChangeEditor.setTrackChangeOnParagraph(l.get_node(),l.get_cpBegin(),l.get_cpBegin()+1,1)}finally{u&&u.dispose()}}var g=l.get_node(),p=l.get_cpEnd()+1;if(" "===cs.ParagraphReader.text(g).charAt(p)){var d=_s.y.createTextRange(g,p,p+1);this._characterPropertiesEditor.replaceTextRange(d,"\xa0")}var h=_s.y.createIpContext(l.get_node(),p);return a.get_selectionManager().setSelection(ss.SelectionFactory.createSelectionFromContext(h)),32},e.get_hyperlinkStrategy=function(){return e._hyperlinkStrategy||(e._hyperlinkStrategy=se.w.get_instance().resolve(pS.n))},e.get_splitHyperlinkFixWithEnterIsEnabled=function(){return null==e._splitHyperlinkFixWithEnterIsEnabled&&(L.AFrameworkApplication.appSettingsManager?e._splitHyperlinkFixWithEnterIsEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SplitHyperlinkFixWithEnterIsEnabled"):e._splitHyperlinkFixWithEnterIsEnabled=!1),e._splitHyperlinkFixWithEnterIsEnabled},e._hyperlinkStrategy=null,e._splitHyperlinkFixWithEnterIsEnabled=null,e}();(0,o.l)(nk,"InsertLineBreakStrategy",null,[]);var rk=function(){function e(){}return e.get_outlineElementEditor=function(){return e._outlineElementEditor||(e._outlineElementEditor=se.w.get_instance().resolve(Es.p))},e.get_contextSetEditor=function(){return kf.ContextSetEditor.get_instance()},e.get_trackChangeEditor=function(){return e._trackChangeEditor||(e._trackChangeEditor=se.w.get_instance().resolve(cc.x).get_instance())},e.get_trackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},e.insertOutlineElementView=function(t,n,r,i,o){var a,s=o;if(s&&s.hasProperty(zl.k.targetObject)){var l=n.view.get_targetNode().get_containingObjectSpace().getObject(s.getValue(Dt.h,zl.k.targetObject));a=_s.y.create(l)}else a=e.get_contextSetEditor().attemptToGeneralizeToNodeContextOfType(n.get_nextContext(),11);if(!a)return 8;var c=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(a,t,r,!0,i,o);if(32===c&&2===r){var u=n;if(!u.view.get_isInteractiveView())return 2;var g=u.view,p=g.get_selectionManager().get_selectionContextForActionDispatch();if(p=e.get_contextSetEditor().attemptToGeneralizeToNodeContextOfType(p,11)){var d=new Pm.z;if(d.set(p.get_node()),d.tryToRootAtOutlineAncestor(),s&&s.hasProperty(zl.k.targetObject))for(var h=s.getProperty_Unchecked(zl.k.targetObject);!d.get_currentNode().get_id().equals(h);){if(!d.returnToParent())break;if(hs.OutlineElementNavigator.returnToOutlineElement(d),11!==d.get_currentNodeType())break}hs.OutlineElementNavigator.moveToPreviousOutlineElement(d,!1,!1);var _=Pa.SelectionEditor.findFirstOrLastSelectableContentNode(d,!0),m=void 0;m=cs.ParagraphReader.canContainIpOrTextRange(_)?ss.SelectionFactory.createIpSelection(_,0):ss.SelectionFactory.createSelectionFromNode(_),g.get_selectionManager().setSelection(m)}}return c},e.insertOutlineElement=function(t,n,r,i,o){var a=t===ii.Mc,s=n.get_node(),l=o;if(l&&l.hasProperty(zl.k.targetObject)&&!s.get_id().equals(l.getProperty_Unchecked(zl.k.targetObject)))return 2;if(1===r)return 32;var c=new Da.GraphIterator;c.set(s),c.tryToRootAtAncestorOfType(10);e.get_outlineElementEditor().insertOutlineElementAsSibling(c,a,!0);if(e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()){var u=hs.OutlineElementNavigator.moveToContent(c);e.get_trackChangeEditor().setTrackChangeEop(u,1)}return 32},e._outlineElementEditor=null,e._trackChangeEditor=null,e._trackChangeManager=null,e}();(0,o.l)(rk,"InsertOutlineElementStrategy",null,[]);var ik=function(){function e(e,t,n,r,i,o,a,s,l){this._autoCorrectScheduler=null,this._enterActor=null,this._insertionPointFormatting=null,this._listEditor=null,this._outlineElementEditor=null,this._lockedRangeEditor=null,this._selectionManager=null,this._selectionFactory=null,this._contentControlConverterFuture=null,this._autoCorrectScheduler=t,this._enterActor=e,this._insertionPointFormatting=i,this._listEditor=r,this._outlineElementEditor=n,this._lockedRangeEditor=o,this._selectionManager=a,this._selectionFactory=s,this._contentControlConverterFuture=l}return e.prototype.newLineView=function(e,t,n,r,i){var o=t;if(!o.view.get_isInteractiveView())return 2;var a=o.view,s=null;a.get_isPageView()&&(s=a);var l=a.get_selectionManager().get_selectionContextForActionDispatch(),c=!0,u=!1,g=!1,p=!1,d=!1,h=null;if(!l)return 2;var _=new as.GraphTransaction(15);_.setFromNode(a.get_targetNode());var m=null;if(2===n){(m=new Pm.z).set(l.get_node()),m.tryToRootAtOutlineAncestor(),h=new Em(m);var f=!!L.AFrameworkApplication.appSettingsManager&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EmptyListItemIndentIsEnabled");hs.OutlineElementNavigator.returnToOutlineElement(m),p=Ls.OutlineElementReader.isEmpty(m,!1),2===Br.App.get_mode()&&Pa.SelectionEditor.isInsertionPointContext(l)&&(g=mc.ListReader.isListOutlineElement(m)&&p,d=Ls.OutlineElementReader.isIpAtStartOrEnd(m,l,!1)&&!Ls.OutlineElementReader.isIpAtStartOrEnd(m,l,!0),g&&(f?yc.z.get_getOutlineElementIndentationEditor().canPromote(m,-1)&&(u=!0):c=!1),Br.App.get_theCoauthManager().get_isCoauthorable()&&(d||f&&g&&!u)&&(c=!1)),p&&(PT.b.isOutlineElementWithNoteTags(m)&&(c=!1),1===Br.App.get_mode()&&mc.ListReader.isListOutlineElement(m)&&(u=!0))}var y=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l,e,n,!1,r,i);if(c&&32===y&&2===n){if(!u){var C=!Pa.SelectionEditor.isInsertionPointContext(l);hs.OutlineElementNavigator.moveToNextOrPreviousOutlineElement(m,!1,C,!1)}u&&h&&h.restore(m),us.n.get_instance().get_item(101)&&this._insertionPointFormatting.freeze(),a.get_selectionManager().setSelection(ss.SelectionFactory.createCollapsedSelection(m.get_currentNode(),!0)),us.n.get_instance().get_item(101)&&this._insertionPointFormatting.thaw(),this._enterActor.get_undoManager().interruptUndoMerging()}return s&&(c||s.scrollSelectionIntoView()),FS.o.get_instance().updateVisibilityFromInputMethod(1),_.dispose(),y},e.prototype.newLine=function(e,t,n,r,i){var o=!1;(ka.ImageReader.isInlineImageContext(t)||ka.ImageReader.isAnchoredImageContext(t))&&(t=this.convertImageContextToIpContext(t),o=!0);var a=t,s=Pa.SelectionEditor.isInsertionPointContext(t);if(s&&this._lockedRangeEditor.get_isContentControlEditingEnabled()&&!this._lockedRangeEditor.isNewLineAllowedForIp(a))return 2;if(1===n)return 32;var l=a.get_node(),c=new Da.GraphIterator;c.set(l),c.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(c);var u=new as.GraphTransaction(15);if(u.setFromIterator(c),s){this._contentControlConverterFuture.get_instance()&&this._contentControlConverterFuture.get_instance().tryToConvertInlineContentControlToBlock(a);var g=!0;if(us.n.get_instance().get_item(101)&&cs.ParagraphReader.isParagraphNode(l)&&a.get_cpBegin()===cs.ParagraphReader.textLength(l)&&Xp.q(a)){9===cs.ParagraphReader.getOutlineLevel(l)&&this._insertionPointFormatting.copyRunFormatting(a)}if(1===Br.App.get_mode()&&Ls.OutlineElementReader.isEmpty(c,!1)&&mc.ListReader.isListOutlineElement(c)&&(g=!1),this._listEditor.setListInfoAndInsertNewOE(c,g,a,l),this._autoCorrectScheduler&&this._autoCorrectScheduler.tryToAutocorrectAtTextBreak(l,Je.v.vK_Enter,a.get_cpBegin()),o){hs.OutlineElementNavigator.moveToNextOutlineElement(c,!1,!1);var p=c.goToFirstChildByRole(2),d=this._selectionFactory.createIpSelection(p,0);d&&this._selectionManager.setSelection(d)}}else this._outlineElementEditor.insertOutlineElementAsSibling(c,!0,!0);return u.dispose(),Br.App.get_activeAppFrame()&&Br.App.get_activeAppFrame().updateCommandUI(),32},e.prototype.convertImageContextToIpContext=function(t){var n,r=t;if(ka.ImageReader.isInlineImageContext(t))n=_s.y.createIpContext(r.get_node(),r.get_cpBegin());else{var i=cs.ParagraphReader.containingParagraph(r.get_node()),o=i.get_properties().getProperty_Unchecked(ks.j.runIds),a=r.get_node().get_properties().getValue(Number,ks.j.runId),s=i.get_characterProperties(),l=e.getCpForRunId(a,o,s);n=_s.y.createIpContext(i,l)}return n},e.findRunIndexInRunIdsForRunId=function(e,t){for(var n=0;n<t.length&&!(e<t[n]);)n++;return n},e.getCpForRunId=function(t,n,r){var i=0,o=e.findRunIndexInRunIdsForRunId(t,n),a=0;if(o===n.length)a=r.get_length()-1;else for(;a<r.get_length();){var s=r.get_item(a);if(s.get_formatting()&&s.get_formatting().runIndex===o)break;a++}a<r.get_length()&&(i=r.get_item(a).get_cp());return i},e}();(0,o.l)(ik,"NewLineStrategy",null,[]);var ok=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g,p,d){this._undoManager=null,this._undoManagerFactory=null,this._enterViewStrategyLazy=null,this._newLineStrategy=null,this._insertLineBreakStrategy=null,this._undoManagerFactory=e,this._enterViewStrategyLazy=o,this._newLineStrategy=new ik(this,t,n,r,i,a,c,u,d),this._insertLineBreakStrategy=new nk(a,s,t,l,g,p)}return e.prototype.get_undoManager=function(){return this._undoManager||(this._undoManager=this._undoManagerFactory())},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager(),t=o.i(this._newLineStrategy,this._newLineStrategy.newLine,"newLine");e.addActionWithFlags(ii.UL,cl.n,o.i(this._enterViewStrategyLazy.get_value(),this._enterViewStrategyLazy.get_value().enterView,"enterView"),1124),e.addActionWithFlags(ii.Tv,cl.n,o.i(this._enterViewStrategyLazy.get_value(),this._enterViewStrategyLazy.get_value().shiftEnterView,"shiftEnterView"),1124),e.addAction(ii.qI,cl.n,o.i(this._newLineStrategy,this._newLineStrategy.newLineView,"newLineView")),e.addAction(ii.qI,cl.V,t),e.addAction(ii.qI,cl.H,t),e.addAction(ii.qI,cl.Z,t),e.addAction(ii.qI,cl.r,t),e.addAction(ii.qI,cl.I,t),e.addAction(ii.qI,cl.g,t),e.addAction(ii.qI,cl.K,t),e.addAction(ii.qI,cl.m,t),e.addAction(ii.qI,cl.k,t),e.setActionFlags(ii.qI,1124),e.addActionWithFlags(ii.lD,cl.n,o.i(this._insertLineBreakStrategy,this._insertLineBreakStrategy.insertLineBreakView,"insertLineBreakView"),1028),e.addAction(ii.Mc,cl.n,rk.insertOutlineElementView),e.addAction(ii.Mc,cl.z,rk.insertOutlineElement),e.setActionFlags(ii.Mc,1092)},e.get_instance=function(){return e._instance||(e._instance=e.getInstanceWithResolvedDependencies())},e.getInstanceWithResolvedDependencies=function(){return new e((function(){return se.w.get_instance().resolve(ja.n)}),se.w.get_instance().tryResolve(qa.g),se.w.get_instance().resolve(Es.p),se.w.get_instance().resolve(rs.v),se.w.get_instance().resolve(ah.c),se.w.get_instance().resolveLazy(YP),ls.k.get_instance(),se.w.get_instance().resolve(Va.x),se.w.get_instance().resolveFuture(gh.i),Oa.SelectionManager.get_instance(),se.w.get_instance().resolve(Ad),se.w.get_instance().resolve(cc.x).get_instance(),se.w.get_instance().resolve($a.b).get_instance(),se.w.get_instance().resolveFuture(lc.t))},e._instance=null,e}();(0,o.l)(ok,"EnterActor",null,[]);var ak=n(1558),sk=function(){function e(e,t,n){this._autoCorrectScheduler=null,this._undoManagerLazy=null,this._externalSelectionManagerFuture=null,this._autoCorrectScheduler=e,this._undoManagerLazy=t,this._externalSelectionManagerFuture=n}return e.prototype.get_undoManager=function(){return this._undoManagerLazy.get_value()},e.prototype.enterView=function(t,n,r,i,o){var a,s,l;if(!this.shouldProcessEnterView(n,r,!1,(0,p.m)((function(){return a}),(function(e){return a=e})),(0,p.m)((function(){return s}),(function(e){return s=e})),(0,p.m)((function(){return l}),(function(e){return l=e}))))return l;Xi.t.mark(5013);for(var c=e.get_contextSetEditor().breakDownContextSets(s),u=0;u<c.length;++u)if(c[u].get_isValid()){if((h=c[u].get_iterator()).tryToRootAtPageContent(),vc.isOutline(h))return this.enterAtOutlineHelper(a,h);if(Hr.b(h))return ak.f.get_instance().leaveTitle(t,s,a),this.get_undoManager().interruptUndoMerging(),Xi.t.mark(5014),32}var g=this.getEnterViewNextAction(s);if(s.get_isContextSet()||Pa.SelectionEditor.isTextRangeContext(s)||cs.ParagraphReader.isParagraphContext(s)&&!Pa.SelectionEditor.isBlockContext(s)){if(e.get_featureHelper()&&e.get_featureHelper().isFeatureEnabled(32)){var d=null;if(kf.ContextSetEditor.get_instance().shrinkContextSetForDeleteAction(s,(0,p.m)((function(){return d}),(function(e){return d=e}))))return 8}l=this.enterAtRangeSelectionHelper(n,a,t,i,o,g)}else if(Pa.SelectionEditor.isEndOfParagraphContext(s))l=this.enterAtEopHelper(n,a,t,i,o,g);else if(Pa.SelectionEditor.isInsertionPointContext(s)){var h;if((h=new Da.GraphIterator).set(s.get_node()),h.tryToRootAtAncestorOfType(10),this.needCheckHyperLink()){var _=s,m=Hs.HyperlinkReader.getHyperlinksInRange(_,!1);if(m.length>0)return m[0].hyperlink?(Br.App.followUrl(m[0].hyperlink.get_url()),32):(C.ULS.sendTraceTag(38835461,324,15,"Hyperlink is null. CpBegin: {0}, CpEnd: {1}",m[0].cpBegin,m[0].cpEnd),8)}if(Zc.isInTableCell(h)&&!us.n.get_instance().get_item(77)&&(ld.returnToContainingCell(h),us.n.get_instance().get_item(30)&&Zc.isLastCellInTable(h)&&!vc.hasMultipleOutlineElements(h)&&vc.isIpAtStartOrEnd(h,s,!0)&&(Sc.moveToFirstOutlineElement(h),mc.ListReader.isListOutlineElement(h)||(g=ii.QL),ld.returnToCell(h)),Zc.isFirstCellInRow(h))){var f=new Da.GraphIterator;if(f.setFrom(h),ld.returnToContainingRow(f),us.n.get_instance().get_item(30)&&cd.r(f)&&cd.x(f)&&dc.TableReader.getRowCount(ld.getContainingTable(f))>1)g=ii.ym;else if(vc.isIpAtStartOrEnd(h,s,!1)){var y=s;cd.h(f)&&y.get_ccBoundaryIdxAtCpBegin()<=0?(g=ii.Mc,ld.returnToContainingTable(h),hs.OutlineElementNavigator.returnToOutlineElement(h),o||(o=new Kl.DictionaryPropertySet),o.setProperty_Unchecked(zl.k.targetObject,h.get_currentNode().get_id())):us.n.get_instance().get_item(30)&&(g=ii.cb)}}l=this.enterProcessNextActionHelper(n,a,t,i,o,g)}else Pa.SelectionEditor.isBlockContext(s)&&(l=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,ii.qI,2,!1,i,o));return Xi.t.mark(5014),l},e.prototype.shouldProcessEnterView=function(t,n,r,i,o,a){if(i.val=null,o.val=null,1===n)return a.val=32,!1;var s=t;return s.view.get_isInteractiveView()?(i.val=s.view,o.val=i.val.get_selectionManager().get_selectionContextForActionDispatch(),o.val?us.n.get_instance().get_item(14)&&!e.get_lockedRangeEditor().isEnterAllowedForContextSet(o.val,r)?(a.val=2,!1):this._externalSelectionManagerFuture&&this._externalSelectionManagerFuture.get_instance()&&this._externalSelectionManagerFuture.get_instance().isExternalSelectionContext(o.val)?(a.val=4,!1):(a.val=2,!0):(a.val=2,!1)):(a.val=2,!1)},e.prototype.shiftEnterView=function(t,n,r,i,o){var a,s,l;if(!this.shouldProcessEnterView(n,r,!0,(0,p.m)((function(){return a}),(function(e){return a=e})),(0,p.m)((function(){return s}),(function(e){return s=e})),(0,p.m)((function(){return l}),(function(e){return l=e}))))return l;for(var c=e.get_contextSetEditor().breakDownContextSets(s),u=0;u<c.length;++u)if(c[u].get_isValid()){var g=c[u].get_iterator();if(g.tryToRootAtPageContent(),vc.isOutline(g))return this.enterAtOutlineHelper(a,g)}return s.get_isContextSet()||Pa.SelectionEditor.isTextRangeContext(s)?l=this.enterAtRangeSelectionHelper(n,a,t,i,o,ii.lD):Pa.SelectionEditor.isEndOfParagraphContext(s)?l=this.enterAtEopHelper(n,a,t,i,o,ii.lD):Pa.SelectionEditor.isInsertionPointContext(s)?l=this.enterProcessNextActionHelper(n,a,t,i,o,ii.lD):Pa.SelectionEditor.isBlockContext(s)&&(l=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,ii.qI,2,!1,i,o)),l},e.prototype.enterAtOutlineHelper=function(e,t){return e.get_selectionManager().setSelection(ss.SelectionFactory.createCollapsedSelection(t.get_currentNode(),!1)),32},e.prototype.enterAtRangeSelectionHelper=function(e,t,n,r,i,o){var a,s=new as.GraphTransaction(15);s.set_undoActionId(n),s.setFromNode(t.get_targetNode());var l=new Kl.DictionaryPropertySet;return l.setValue(zl.k.doNotDeleteTableSegments,!0),32===(a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(e,ii.Dx,2,!0,r,l))&&(a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(e,o,2,!1,r,i)),s.dispose(),a},e.prototype.enterAtEopHelper=function(e,t,n,r,i,o){var a,s=new as.GraphTransaction(15);return s.set_undoActionId(n),s.setFromNode(t.get_targetNode()),t.get_selectionManager().setSelection(Pa.SelectionEditor.collapseToIp(t.get_selectionManager().get_selectionCollection().get_item(0),!1,!1)),a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(e,o,2,!1,r,i),s.dispose(),a},e.prototype.enterProcessNextActionHelper=function(e,t,n,r,i,o){var a,s=new as.GraphTransaction(15,n);return s.set_undoActionId(n),s.setFromNode(t.get_targetNode()),a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(e,o,2,!1,r,i),s.dispose(),a},e.get_contextSetEditor=function(){return kf.ContextSetEditor.get_instance()},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_featureHelper=function(){return e._featureHelper||(e._featureHelper=se.w.get_instance().tryResolve($p.d))},e._featureHelper=null,e}();(0,o.l)(sk,"AEnterViewStrategy",null,[YP]);var lk=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}return(0,S.t)(t,e),t.prototype.getEnterViewNextAction=function(e){return ii.qI},t.prototype.needCheckHyperLink=function(){return!0},t}(sk);(0,o.l)(lk,"EnterViewStrategy",sk,[]);var ck=function(){function e(){}return e.prototype.setFontName=function(e,t){},e}();(0,o.l)(ck,"FontNameFormattingStrategyNoop",null,[lh]);var uk=n(1395),gk=function(){function e(e,t,n,r,i,o,a,s,l,c,u,g,p){this._styleEditor=null,this._insertionPointFormatting=null,this._formattingEditor=null,this._paragraphEditor=null,this._paragraphReader=null,this._listEditor=null,this._listReader=null,this._characterPropertiesEditor=null,this._lockedRangeEditor=null,this._featureHelper=null,this._trackChangeManager=null,this._trackChangeEditor=null,this._textFormattingHelper=null,this._characterFormattings=null,this._paragraphStyles=null,this._paragraphProperties=null,this._sourceContextId=0,this._isBrushActive=!1,this._formatPainterStrategy=null,this._eventSource=new bt.f,this._styleEditor=e,this._insertionPointFormatting=t,this._formattingEditor=n,this._paragraphEditor=r,this._paragraphReader=i,this._listEditor=o,this._listReader=a,this._characterPropertiesEditor=s,this._lockedRangeEditor=l,this._featureHelper=c,this._trackChangeManager=u,this._trackChangeEditor=g,this._textFormattingHelper=p}return e.prototype.get_endOfParagraphFormattingIsEnabled=function(){return!!us.n.get_instance().get_item(105)&&(this._featureHelper?this._featureHelper.isFeatureEnabled(56):L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Box4EndOfParagraphFormattingIsEnabled"))},e.prototype.get_formatPainterStrategy=function(){return this._formatPainterStrategy||(this._formatPainterStrategy=se.w.get_instance().resolve(uk.n))},e.prototype.get_isBrushActive=function(){return this._isBrushActive},e.prototype.set_isBrushActive=function(e){return this._isBrushActive!==e&&(this._isBrushActive=e,this._eventSource.raiseEvent("FormatPainterBrushActiveStatusChanged")),e},e.prototype.add_brushStatusChanged=function(e){this._eventSource.addHandler("FormatPainterBrushActiveStatusChanged",e)},e.prototype.remove_brushStatusChanged=function(e){this._eventSource.removeHandler("FormatPainterBrushActiveStatusChanged",e)},e.prototype.pickFormatFromSelection=function(e){var t=e.get_firstContext();C.ULS.sendTraceTag(22832028,354,50,"Picked format from context: {0}",t.get_contextId()),this.reset();var n=t.get_node(),r=this.isMultipleParagraphsSelected(e);if(this.get_formatPainterStrategy().shouldPickParaProps(t.get_contextId(),r))try{this._paragraphProperties=this._paragraphReader.getParagraphProperties(n)}catch(e){throw C.ULS.sendTraceTag(22832029,354,10,"GetParagraphProperties error: {0}",e.message),e}this._paragraphStyles=Tc.StyleReader.getStyleFromParagraphNode(n);var i=Ps.FormattingReader.getFormattingObject(t);i.get_formattingContainer()&&(this._characterFormattings=(0,f.e)(kc.t,i.get_formattingContainer().clone())),this._sourceContextId=r?cl.K:t.get_contextId(),this.get_formatPainterStrategy().adjustFormats(t.get_node(),this._paragraphProperties,this._characterFormattings)},e.prototype.applyFormatToSelection=function(e){for(var t=us.n.get_instance().get_item(14),n=this.isMultipleParagraphsSelected(e),r=0;r<e.get_length();r++){var i=e.get_item(r);if(i.get_isGraphNodeContext()){var o=i,a=!1;if(o.get_contextId()===cl.V||o.get_contextId()===cl.Z)a=t&&this._lockedRangeEditor.isIpOrTextRangeContextInLockedRange(o);else if(o.get_contextId()===cl.K)a=t&&this._lockedRangeEditor.isParaContextInLockedRange(o);else{if(o.get_contextId()!==cl.A){C.ULS.sendTraceTag(22832033,354,50,"Skipped applying format to context: {0}",o.get_contextId());continue}a=t&&this._lockedRangeEditor.isEopContextInLockedRange(o)}if(C.ULS.sendTraceTag(22832034,354,50,"Applied format to context: {0}",o.get_contextId()),a){C.ULS.sendTraceTag(22832035,354,50,"Tried format painting to locked context. Skipped.");continue}var s=(0,f.e)(hc.AParagraphNode,o.get_node()),l=!1;s&&(l=o.get_contextId()===cl.Z&&!!s&&!o.get_cpBegin()&&o.get_cpEnd()===this._paragraphReader.textLength(s));var c=this.get_formatPainterStrategy().shouldApplyParaProps(this._sourceContextId,o.get_contextId(),n,l);if(c)try{cs.ParagraphReader.isParagraphNode(s)?(this._paragraphStyles&&this._styleEditor.setStyleOnParagraphNode(this._paragraphStyles,s,!0),this._paragraphEditor.applyParagraphProperties(s,this._paragraphProperties)):C.ULS.sendTraceTag(22832064,354,50,"Tried to apply paragraph style and properties to non-paragraph node: {0}",o.get_node().get_type())}catch(e){throw C.ULS.sendTraceTag(22832065,354,10,"ApplyParagraphProperties error: {0}",e.message),e}var u=o;if(o.get_contextId()===cl.K)u=_s.y.createTextRange(s,0,cs.ParagraphReader.textLength(s));else if(o.get_contextId()===cl.V){var g=this._insertionPointFormatting.getSelectionForIpFormatting(o);u=Oa.SelectionManager.createMultiRangeOrGraphContext(g)}if(u&&u.get_contextId()===cl.Z)try{this.applyFormattingsToTextRange(u,this._characterFormattings,c?null:this._paragraphStyles)}catch(e){throw C.ULS.sendTraceTag(22832066,354,10,"ApplyFormattingsToTextRange error: {0}",e.message),e}if(o.get_contextId()===cl.K||o.get_contextId()===cl.A){var p=new Da.GraphIterator;p.set(s),p.tryToRootAtOutlineAncestor(),p.returnToAncestorOfType(11);var d=mc.ListReader.isListOutlineElement(p),h=!cs.ParagraphReader.textLength(s);if(C.ULS.sendTraceTag(22832067,354,50,"Applied format to EOP: InList - {0}, IsEmpty - {1}.",d,h),d){this._listReader.moveToList(p);var _=p.get_currentNode();this._listReader.isListNode(_)&&this._listEditor.setListFormatting(_,s,this._characterFormattings)}else this.get_endOfParagraphFormattingIsEnabled()&&this.applyFormattingsToEndOfParagraph(o,this._characterFormattings)}}else C.ULS.sendTraceTag(22832068,354,50,"Attempt to apply format to non-graph-node context: {0}",i.get_contextId())}},e.prototype.applyFormattingsToEndOfParagraph=function(e,t){if(t){var n=e.get_node(),r=n.get_characterProperties().get_last(),i=this._characterPropertiesEditor.ensureEndOfParagraphFormatting(n),o=i.cloneUnderDifferentChp(i.get_containingProperties());this.applyFormattingsToTextRangeCore(i,t,null),this._trackChangeManager.get_trackChangeFeatureIsEnabled()&&this._trackChangeEditor.setFormattingTrackChangeOnParagraph(n,r,e.get_cpBegin(),e.get_cpEnd(),o,i,this._trackChangeManager.get_changeTrackingDocumentSettingEnabled())}},e.prototype.applyFormattingsToTextRange=function(e,t,n){var r=this;(t||n)&&(Xp.t(e).length>0&&C.ULS.sendTraceTag(22832071,354,50,"User tried to apply format on Blob objects"),this._textFormattingHelper.applyCharacterFormattingOnTextRange(e,(function(e){r.applyFormattingsToTextRangeCore(e,t,n)})))},e.prototype.applyFormattingsToTextRangeCore=function(e,t,n){this._formattingEditor.clearCharacterFormatting(e),e.get_formattingContainer()&&e.get_formattingContainer().removeProperty(Kc.b.highlight),this._formattingEditor.clearCharacterStyle(e),this.copyProperties(e,n),this.copyProperties(e,t)},e.prototype.copyProperties=function(e,t){if(t){var n=e.get_paragraph().get_containingObjectSpace();if(n){var r,i=e.get_formattingContainer();i=i?(0,f.e)(Pc.b,i.clone()):kc.t.constructExtendedSharedPropertySet(1179725);for(var o=0,a=t.listProperties();o<a.length;o++){var s=a[o];if(s!==ks.j.atMentionBookmarkName&&s!==ks.j.fieldInstruction&&s!==Kc.b.isLink&&s!==Kc.b.isLinkProtected&&s!==ks.j.isDeadLink&&s!==Kc.b.languageID&&s!==ks.j.languageHint&&s!==ks.j.noProof){if(s===qc.o.characterStyle){var l=t.getValueWithDefault(Dt.h,qc.o.characterStyle,Dt.h.get_nil());if(l!==Dt.h.get_nil()){var c=(0,f.e)(kc.t,n.getObject(l)),u=Tc.StyleReader.getStyleName(c);if(u===Box4Intl.Box4Strings.L_StyleWordHyperlink){var g=Tc.StyleReader.getStyleSetFromParagraphNode(e.get_paragraph()).getStyleByName(u);i.copyProperties(g);continue}}}i.setValue(s,t.getProperty_Unchecked(s))}}i.get_isSharable()?r=n.registerSharedObject(i):(n.registerObject(i),r=i),e.set_formattingId(r.get_id())}}},e.prototype.isMultipleParagraphsSelected=function(e){return!e.get_containsSingleContext()&&e.get_lastContext().get_contextId()!==cl.A},e.prototype.reset=function(){this._characterFormattings=null,this._paragraphStyles=null,this._paragraphProperties=null,this._sourceContextId=cl.p},e}();(0,o.l)(gk,"FormatPainter",null,[Uu.w]);var pk=function(){function e(e,t,n,r,i,o,a){void 0===a&&(a=!1),this._appFrame=null,this._focusManager=null,this._actionManager=null,this._activityManager=null,this._selectionReader=null,this._formatPainter=null,this._isCtrlShiftVReserved=!1,this._isRegisteredOnChangingPageOrMode=!1,this._formatPainterCursorPages=new Th(Number),this._appFrame=e,this._focusManager=t,this._actionManager=n,this._activityManager=r,this._selectionReader=i,this._formatPainter=o,this._isCtrlShiftVReserved=a}return e.prototype.get__formatPainterCursorName=function(){return G.y.get_isInternetExplorerEdge()||G.y.get_isSafari9Up()?"url("+Za.f.box4Image("FormatPainterText.cur")+"), pointer":'url("'+Za.f.box4Image("FormatPainterText.cur")+'"), pointer'},e.prototype.registerActions=function(){var e=this,t=this._focusManager.getScope(kg.u.editingFocusID);t.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_Esc,0),ii.SB),t.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_C,6),ii.OU),this._isCtrlShiftVReserved||t.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_V,6),ii.PU),this._actionManager.addActionWithFlags(ii.OU,cl.n,o.i(this,this.handleFormatPainterPick,"handleFormatPainterPick"),1028),this._actionManager.addActionWithFlags(ii.PU,cl.n,o.i(this,this.handleFormatPainterApply,"handleFormatPainterApply"),1028),this._actionManager.addActionWithFlags(ii.SB,cl.n,o.i(this,this.handleFormatPainterCancel,"handleFormatPainterCancel"),1028),this._formatPainter.add_brushStatusChanged((function(t,n){e.updateUI(e._formatPainter.get_isBrushActive())}))},e.prototype.handleFormatPainterCancel=function(e,t,n,r,i){return this._formatPainter.set_isBrushActive(!1),32},e.prototype.handleFormatPainterPick=function(e,t,n,r,i){var a=!1,s=this._selectionReader.get_firstContextForCurrentSelection();if(s){switch(s.get_contextId()){case cl.Z:case cl.K:case cl.A:case cl.V:a=!0}a&&Pa.SelectionEditor.isTextRangeContext(s)&&Xp.n(s)&&(this._activityManager.recordEvent(D_.f.noApply,{Reason:M_.i.containsNonFormattableBlob}),a=!1)}if(1===n||!a)return a?32:8;if(6!==this._actionManager.get_commandLocation()){if(this._formatPainter.get_isBrushActive())C.ULS.sendTraceTag(22832076,354,50,"User deactivated the Format Painter button");else if(C.ULS.sendTraceTag(22832075,354,50,"User activated the Format Painter button"),this._formatPainter.pickFormatFromSelection(this._selectionReader.get_currentSelection()),!this._isRegisteredOnChangingPageOrMode){this._appFrame.add_modeSwitched(o.i(this,this.updateCursorOnModeSwitched,"updateCursorOnModeSwitched"));var l=this._appFrame.workspace.get_activeView();l&&l.get_isPageView()&&l.add_initialSelectionSet(o.i(this,this.updateCursorOnInitialSelection,"updateCursorOnInitialSelection")),this._isRegisteredOnChangingPageOrMode=!0}this._formatPainter.set_isBrushActive(!this._formatPainter.get_isBrushActive())}else C.ULS.sendTraceTag(22832077,354,50,"User picked format from keyboard shortcut"),this._formatPainter.pickFormatFromSelection(this._selectionReader.get_currentSelection()),this._formatPainter.set_isBrushActive(!1);return 32},e.prototype.handleFormatPainterApply=function(e,t,n,r,i){if(6===this._actionManager.get_commandLocation()||this._formatPainter.get_isBrushActive()){C.ULS.sendTraceTag(22832078,354,50,"User applied the Format Painter from command location: {0}",this._actionManager.get_commandLocation());var o=this._appFrame.get_theStopwatchBuilder().makeAndStartStopwatch("UserAction","FormatPainterApply"),a=new as.GraphTransaction(15);a.set(this._selectionReader.get_firstNodeForCurrentSelection().get_containingGraph()),this._formatPainter.applyFormatToSelection(this._selectionReader.get_currentSelection()),this._formatPainter.set_isBrushActive(!1),a.dispose(),o.stop()}return 32},e.prototype.updateUI=function(e){var t=this._appFrame.get_theStopwatchBuilder().makeAndStartStopwatch("UserAction","FormatPainterUpdateCursor");this.onUpdateCursor(e),this._appFrame.updateCommandUI(),t.stop()},e.prototype.updateCursorOnElementCollection=function(e,t){for(var n=0;n<e.length;n++)this.updateCursorOnElement(e[n],t);var r=this._appFrame.workspace.get_activeView();if(r&&r.get_isInteractiveView()){var i=r.get_editingDom().get_editingElement();this.updateCursorOnElement(i,t)}},e.prototype.updateCursorOnElement=function(e,t){e.style.cursor=t?this.get__formatPainterCursorName():""},e.prototype.updateCursorOnModeSwitched=function(e){this.onUpdateCursor(this._formatPainter.get_isBrushActive())},e.prototype.updateCursorOnInitialSelection=function(e,t){this.onUpdateCursor(this._formatPainter.get_isBrushActive())},e.prototype.onUpdateCursor=function(e){var t=document.querySelectorAll(".OutlineElement");if(t.length>1){var n=t[t.length-2].style.cursor===this.get__formatPainterCursorName();if(this._appFrame.workspace.get_isEditingAllowed()||this._appFrame.workspace.get_isReviewingAllowed()){if((e&&!n||!e&&n)&&(this.updateCursorOnElementCollection(t,e),this.updateFormatPainterCursorPages(e)),!e&&this._isRegisteredOnChangingPageOrMode&&!this._formatPainterCursorPages.get_count()){this._appFrame.remove_modeSwitched(o.i(this,this.updateCursorOnModeSwitched,"updateCursorOnModeSwitched"));var r=this._appFrame.workspace.get_activeView();r&&r.get_isPageView()&&r.remove_initialSelectionSet(o.i(this,this.updateCursorOnInitialSelection,"updateCursorOnInitialSelection")),this._isRegisteredOnChangingPageOrMode=!1}}else n&&(this.updateCursorOnElementCollection(t,!1),this.updateFormatPainterCursorPages(!1))}},e.prototype.updateFormatPainterCursorPages=function(e){var t=this._appFrame.workspace.get_activeView();t&&(e?this._formatPainterCursorPages.add(t.get_targetNode().get_uniqueKey()):this._formatPainterCursorPages.remove(t.get_targetNode().get_uniqueKey()))},e}();(0,o.l)(pk,"FormatPainterActor",null,[]);var dk=n(9651),hk=function(e){function t(t,n,r,i,o,a,s){var l=e.call(this,t,n,r,null,o,a,!1)||this;return l._droppedFile=null,l.isSuccessful=!1,l.dialogMode=!1,l.useFilePicker=!1,l.isSuccessful=!1,l._droppedFile=i,l}return(0,S.t)(t,e),t.prototype.get_uploadMode=function(){return"DragDropInsertImage"},t.prototype.submitForm=function(e){var t=new yI.w(this._droppedFile.name,this._droppedFile);e.submitFormWithBlob(t)},t.prototype.finalizeUpload=function(e,t){this.insertPlaceholder()&&(this.replicatePlaceholder(e),this.isSuccessful=!0)},t}(NS.e);(0,o.l)(hk,"DragDropInsertImageUploader",NS.e,[]);var _k=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,CommonUIStrings.l_AlternativeTextDialogLabel)},e.dialogHtmlFormat="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='titleText' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='500' autocomplete=\"off\"/> </div>",e}();(0,o.l)(_k,"AltTextDialogHtml",null,[]);var mk="AltTextDialog",fk=function(e){function t(t){var n=e.call(this)||this;n._containingNode=null,n._imageProperties=null,n._containingNode=t.get_node(),n._imageProperties=ka.ImageReader.getImagePropertiesFromContext(t),n.set_dialogHtml(_k.get_dialogHtml());var r={titleText:ka.ImageReader.getImageAltText(n._imageProperties)};n.set_dialogId(mk),n.initializeAndShow(CommonUIStrings.l_AlternativeTextDialogTitle,o.i(n,n.altTextDialogHandler,"altTextDialogHandler"),r);var i=document.getElementById("titleText");return i.focus(),i.select(),n}return(0,S.t)(t,e),t.prototype.altTextDialogHandler=function(e,n){if(1===e){this.hide();var r=new as.GraphTransaction(15);r.setFromNode(this._containingNode),t.get_imageEditor().setImageAltText(this._imageProperties,n.titleText),r.dispose()}us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(this._containingNode)},t.get_imageEditor=function(){return t._imageEditor||(t._imageEditor=se.w.get_instance().resolve(rl.w))},t._imageEditor=null,t}(ri.o);(0,o.l)(fk,"AltTextDialog",ri.o,[]);var yk=function(){function e(e,t,n,r,i){this.minImageWidthMu=0,this.minImageHeightMu=0,this.maxImageWidthMu=0,this.maxImageHeightMu=0,this._imageEditor=null,this._externalSelectionManagerFuture=null,this.trackChangeManager=null,this._undoManager=null,this._actionManager=null,this._selectionManager=null,this._isSupportImageDragDropExternalEnabled=!1,this._imageEditor=e,this._externalSelectionManagerFuture=t,this.trackChangeManager=n,this._undoManager=r,this._selectionManager=i,this._isSupportImageDragDropExternalEnabled=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SupportImageDragDropExternalIsEnabled")}return e.prototype.get_pageReader=function(){return Qc.PageReader.get_instance()},e.prototype.get_externalSelectionManager=function(){return this._externalSelectionManagerFuture.get_instance()},e.prototype.get_undoManager=function(){return this._undoManager},e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.initializeStatics=function(){this.minImageWidthMu=Hh.y(1,0),this.minImageHeightMu=Hh.y(1,1),this.maxImageWidthMu=Hh.y(1920,0),this.maxImageHeightMu=Hh.y(1280,1)},e.prototype.registerActions=function(e){this._actionManager=e;var t=o.i(this,this.pictureToolsTabViewHandler,"pictureToolsTabViewHandler"),n=o.i(this,this.insertPictureDialogView,"insertPictureDialogView"),r=o.i(this,this.insertPicture,"insertPicture"),i=o.i(this,this.growShrinkImage,"growShrinkImage");e.addActionWithFlags(ii.ot,cl.n,n,1284),e.addAction(ii.us,cl.V,r),e.addAction(ii.us,cl.H,r),e.setActionFlags(ii.us,1284),e.addActionWithFlags(ii.eM,cl.n,t,1028),this.addImageAction(e,ii.FQ,o.i(this,this.editAltText,"editAltText")),this.addImageAction(e,ii.hx,i),this.addImageAction(e,ii.xF,i),this.addImageAction(e,ii.Po,o.i(this,this.queryImageResize,"queryImageResize")),this.addImageAction(e,ii.hi,o.i(this,this.queryImageAbsoluteHeight,"queryImageAbsoluteHeight")),this.addImageAction(e,ii.wW,o.i(this,this.queryImageAbsoluteWidth,"queryImageAbsoluteWidth")),this.addImageAction(e,ii.zj,o.i(this,this.queryImageAltTextTitle,"queryImageAltTextTitle")),this.addImageAction(e,ii.JQ,o.i(this,this.queryImageAltTextDescription,"queryImageAltTextDescription")),this.addImageAction(e,ii.dK,o.i(this,this.imageResize,"imageResize")),this.addImageAction(e,ii.Lx,o.i(this,this.imageAbsoluteHeight,"imageAbsoluteHeight")),this.addImageAction(e,ii.Vx,o.i(this,this.imageAbsoluteWidth,"imageAbsoluteWidth")),this.addImageAction(e,ii.FW,o.i(this,this.imageAltTextTitle,"imageAltTextTitle")),this.addImageAction(e,ii.Tj,o.i(this,this.imageAltTextDescription,"imageAltTextDescription")),this.addImageAction(e,ii.Vi,o.i(this,this.queryImageLockAspectRatio,"queryImageLockAspectRatio")),this.addImageAction(e,ii.Fk,o.i(this,this.imageLockAspectRatio,"imageLockAspectRatio")),this.addImageAction(e,ii.cI,o.i(this,this.downloadImage,"downloadImage")),this._isSupportImageDragDropExternalEnabled&&e.addActionWithFlags(ii.IS,cl.n,o.i(this,this.dropLocalImagesContent,"dropLocalImagesContent"),4),e.setActionFlags(ii.FQ,4),e.setActionFlags(ii.hx,4),e.setActionFlags(ii.xF,4),e.setActionFlags(ii.Po,69),e.setActionFlags(ii.hi,69),e.setActionFlags(ii.wW,69),e.setActionFlags(ii.Vi,69),e.setActionFlags(ii.zj,69),e.setActionFlags(ii.JQ,69),e.setActionFlags(ii.Fk,4),e.setActionFlags(ii.dK,4),e.setActionFlags(ii.Lx,4),e.setActionFlags(ii.Vx,4),e.setActionFlags(ii.FW,4),e.setActionFlags(ii.Tj,4),this.initializeStatics()},e.prototype.addImageAction=function(e,t,n){e.addAction(t,cl.H,n),e.addAction(t,cl.X,n),e.addAction(t,cl.Z,n),e.addAction(t,cl.r,n)},e.prototype.downloadImage=function(e,t,n,r,i){if(Br.App.disableEmbedDownload)return 8;var o=t.get_node();if(1===n)return o?32:2;if(2===n){var a=ka.ImageReader.getImagePropertiesFromContext(t),s=ka.ImageReader.getOriginalImageUrl(a,t.get_node().getParentGraphSpace().get_contentObjectSpace(),L.AFrameworkApplication.appSettingsManager,L.AFrameworkApplication.get_activeFrame().get_highContrastDetector());return cS(s),32}return 2},e.prototype.insertPictureDialogView=function(e,t,n,r,i){var o=this._imageEditor.canInsertPictureInContext(t),a=i;return 2===n&&o?(ii.ot===e&&(L.AFrameworkApplication.limitedEdit?L.AFrameworkApplication.showRequiresSignInDialog():this.createPictureUploader(t,a)),32):1===n&&ii.ot===e&&o?32:2},e.prototype.createPictureUploader=function(e,t){return new NS.e(e,Oe.y.get_instance(),L.AFrameworkApplication.appSettingsManager,t,this._undoManager,this._actionManager)},e.prototype.insertPicture=function(e,t,n,r,i){return this._imageEditor.canInsertPictureInContext(t)?1===n?32:this._imageEditor.insertPictureInContext(t,i)?32:2:2},e.prototype.validateNonImageRelatedSettingsForEditActionsEnabled=function(t){return this.ifCompatMode()?(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.compatMode}),!1):us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().contextSetContainsLockedRange(t)?(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),!1):this.get_externalSelectionManager()&&this.get_externalSelectionManager().isExternalSelectionContext(t)?(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.externalSelection}),!1):!this._actionManager||3===this._actionManager.get_mode()||(e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.failedToReadOnly}),!1)},e.prototype.areEditActionsEnabled=function(t){this.validateNonImageRelatedSettingsForEditActionsEnabled(t);var n=ka.ImageReader.getImagePropertiesFromContext(t);if(!n)return!1;var r=!ka.ImageReader.getImageUploadState(n)&&!ka.ImageReader.isInvalidImage(n);return r||e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsUnmodifyableImage}),r},e.prototype.insertImageInContext=function(e,t){var n=new hk(t,Oe.y.get_instance(),L.AFrameworkApplication.appSettingsManager,e,this._undoManager,this._actionManager,this._selectionManager);new dk.h(document.body,o.i(n,n.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(n,n.uploadResponseReceived,"uploadResponseReceived"),L.AFrameworkApplication.appSettingsManager,!1);return n.isSuccessful},e.prototype.dropLocalImagesContent=function(e,t,n,r,i){C.ULS.sendTraceTag(42530333,307,50,"Drag and drop local content");var o=i.DataTransfer;if(o&&o.files&&o.files.length>0){for(var a=this._selectionManager.get_selectionCollection().get_currentSelection().get_firstContext(),s=a.get_node(),l=a.get_cpBegin(),c=0,u=0;u<o.files.length;u++){var g=o.files[u];Jn.l.toLower(g.type).indexOf("image")>=0&&this.insertImageInContext(g,t)&&(this._selectionManager.setSelection(ss.SelectionFactory.createIpSelection(s,l+c)),c++)}return 32}return C.ULS.sendTraceTag(42530334,307,15,"Drag and drop local content not handled"),2},e.prototype.arePictureActionsEnabled=function(e){return this.areEditActionsEnabled(e)&&5===ka.ImageReader.getImageType(ka.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areDrawingActionsEnabled=function(e){return this.areEditActionsEnabled(e)&&10===ka.ImageReader.getImageType(ka.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areGroupDrawingActionsEnabled=function(e){return this.areEditActionsEnabled(e)&&48===ka.ImageReader.getImageType(ka.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areTextBoxActionsEnabled=function(e){return this.areEditActionsEnabled(e)&&11===ka.ImageReader.getImageType(ka.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areInkActionsEnabled=function(e){return this.areEditActionsEnabled(e)&&4===ka.ImageReader.getImageType(ka.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areSmartArtEnabled=function(e){return this.areEditActionsEnabled(e)&&6===ka.ImageReader.getImageType(ka.ImageReader.getImagePropertiesFromContext(e))},e.prototype.areImageNodeActionsEnabled=function(e){var t=se.w.get_instance().tryResolve($p.d);return t&&t.isFeatureEnabled(53)?this.arePictureActionsEnabled(e)||this.areDrawingActionsEnabled(e)||this.areGroupDrawingActionsEnabled(e)||this.areTextBoxActionsEnabled(e):this.arePictureActionsEnabled(e)},e.prototype.pictureToolsTabViewHandler=function(t,n,r,i,o){if(2===r)return L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n.get_nextContext(),t,r,!0,i,o);var a=n;if(!a.view.get_isInteractiveView())return 8;var s=a.view;if(!s.get_selectionManager())return 8;var l=s.get_selectionManager().get_selectionContextForActionDispatch(),c=e.get_contextSetEditor().breakDownContextSets(l);return 1!==c.length?8:this.arePictureActionsEnabled(c[0])?(this.logPictureToolsTabEnabled(),32):8},e.prototype.editAltText=function(t,n,r,i,o){if(!this.arePictureActionsEnabled(n))return 8;if(1===r)return this.ifCompatMode()?2:32;if(us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()){var a=n.get_node().getValueWithDefault(Number,Oh.p.lockId,wh.z.lockIdNil);if(a!==wh.z.lockIdNil){var s=Br.App.get_theCoauthManager().get_theLockManager().getLock(a);if(os.CoauthLockEditor.getInstance().shouldLockBlockEditing(s))return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),2}}return this.getAltTextDialog(n),32},e.prototype.getAltTextDialog=function(e){return new fk(e)},e.prototype.growShrinkImage=function(e,t,n,r,i){if(!this.arePictureActionsEnabled(t))return 8;var o=ka.ImageReader.getImagePropertiesFromContext(t),a=ka.ImageReader.getImageWidthWithoutEffects(o),s=ka.ImageReader.getImageHeightWithoutEffects(o),l=e===ii.hx;if(C.ULS.sendTraceTag(20459936,322,50,"GrowShrinkImage: {0}",{IsGrow:l}),1===n)return this.ifCompatMode()||ka.ImageReader.isImageResizeLocked(o)?2:l&&a<this.maxImageWidthMu&&s<this.maxImageHeightMu?32:!l&&a>this.minImageWidthMu&&s>this.minImageHeightMu?32:2;var c=l?1.1:.9,u=a*c,g=s*c;return this.setSize(o,t,u,g,!0),32},e.prototype.setSize=function(e,t,n,r,i){if(void 0===i&&(i=!1),us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()){var o=t.get_node();Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(o)}var a=ka.ImageReader.isImageAspectRatioLocked(e),s=1;n>this.maxImageWidthMu?s=this.maxImageWidthMu/n:n<this.minImageWidthMu&&(s=this.minImageWidthMu/n);var l=1;r>this.maxImageHeightMu?l=this.maxImageHeightMu/r:r<this.minImageHeightMu&&(l=this.minImageHeightMu/r),(a||i)&&(s=Math.min(s,l),l=Math.min(s,l)),1!==s&&(n*=s),1!==l&&(r*=l),this.doSetSize(e,t,n,r)},e.prototype.doSetSize=function(e,t,n,r){this._imageEditor.setSizeHelper(e,t,n,r)},e.prototype.queryImageResize=function(e,t,n,r,i){if(!this.areImageNodeActionsEnabled(t))return 8;var o=ka.ImageReader.getImagePropertiesFromContext(t),a=ka.ImageReader.getOriginalImageWidth(o),s=ka.ImageReader.getOriginalImageHeight(o);if(a<=0||s<=0)return 2;var l=ka.ImageReader.getImageWidthWithoutEffects(o)/a*100;return i.setValue(zl.k.imageScale,l),32},e.prototype.imageResize=function(t,n,r,i,o){if(!this.areImageNodeActionsEnabled(n))return 8;var a=ka.ImageReader.getImagePropertiesFromContext(n);if(1===r)return this.ifCompatMode()||ka.ImageReader.isImageResizeLocked(a)?2:32;C.ULS.sendTraceTag(20459937,322,50,"Change image scale.");var s=o.getValueWithDefault(Number,zl.k.imageScale,-1)/100,l=o.getValueWithDefault(Boolean,zl.k.imageScaleFromCurrent,!1),c=o.getValueWithDefault(Boolean,zl.k.imageResizeIsHorizontal,!0),u=o.getValueWithDefault(Boolean,zl.k.imageResizeIsVertical,!0);if(s<=0)return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.invalidScale}),2;var g,p,d=ka.ImageReader.getOriginalImageWidth(a),h=ka.ImageReader.getOriginalImageHeight(a),_=ka.ImageReader.getImageWidthWithoutEffects(a),m=ka.ImageReader.getImageHeightWithoutEffects(a);return d<=0||h<=0?(e.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.invalidScale}),2):(l?(g=c?s*_:_,p=u?s*m:m):(g=c?s*d:_,p=u?s*h:m),this.setSize(a,n,g,p),us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(n.get_node()),32)},e.prototype.queryImageAbsoluteHeight=function(e,t,n,r,i){if(!this.arePictureActionsEnabled(t))return 8;var o=ka.ImageReader.getImagePropertiesFromContext(t),a=ka.ImageReader.getImageHeightWithoutEffects(o);return a<=0?2:(i.setValue(zl.k.imageAbsoluteHeight,a),32)},e.prototype.imageAbsoluteHeight=function(t,n,r,i,o){if(!this.areImageNodeActionsEnabled(n))return 8;var a=ka.ImageReader.getImagePropertiesFromContext(n);if(1===r)return this.ifCompatMode()||ka.ImageReader.isImageResizeLocked(a)?2:32;C.ULS.sendTraceTag(20459938,322,50,"Change image absolute height.");var s=o.getValueWithDefault(Number,zl.k.imageAbsoluteHeight,0),l=ka.ImageReader.isImageAspectRatioLocked(a);if(s<=0)return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.invalidScale}),2;var c,u,g=ka.ImageReader.getOriginalImageWidth(a),p=ka.ImageReader.getOriginalImageHeight(a),d=ka.ImageReader.getImageWidthWithoutEffects(a),h=d/ka.ImageReader.getImageHeightWithoutEffects(a);return g<=0||p<=0?(e.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.invalidScale}),2):(c=l?s*h:d,u=s,this.setSize(a,n,c,u),us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(n.get_node()),Br.App.get_activeAppFrame().updateCommandUI(),32)},e.prototype.queryImageAbsoluteWidth=function(e,t,n,r,i){if(!this.arePictureActionsEnabled(t))return 8;var o=ka.ImageReader.getImagePropertiesFromContext(t),a=ka.ImageReader.getImageWidthWithoutEffects(o);return a<=0?2:(i.setValue(zl.k.imageAbsoluteWidth,a),32)},e.prototype.imageAbsoluteWidth=function(t,n,r,i,o){if(!this.areImageNodeActionsEnabled(n))return 8;var a=ka.ImageReader.getImagePropertiesFromContext(n);if(1===r)return this.ifCompatMode()||ka.ImageReader.isImageResizeLocked(a)?2:32;C.ULS.sendTraceTag(20459939,322,50,"Change image absolute width.");var s=o.getValueWithDefault(Number,zl.k.imageAbsoluteWidth,0),l=ka.ImageReader.isImageAspectRatioLocked(a);if(s<=0)return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.invalidScale}),2;var c,u,g=ka.ImageReader.getOriginalImageWidth(a),p=ka.ImageReader.getOriginalImageHeight(a),d=ka.ImageReader.getImageWidthWithoutEffects(a),h=ka.ImageReader.getImageHeightWithoutEffects(a),_=h/d;return g<=0||p<=0?(e.get_activityManager().recordEvent(D_.f.unexpectedState,{Reason:M_.i.invalidScale}),2):(u=l?s*_:h,c=s,this.setSize(a,n,c,u),us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()&&Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(n.get_node()),Br.App.get_activeAppFrame().updateCommandUI(),32)},e.prototype.queryImageLockAspectRatio=function(e,t,n,r,i){if(!this.arePictureActionsEnabled(t))return 8;var o=ka.ImageReader.getImagePropertiesFromContext(t),a=ka.ImageReader.isImageAspectRatioLocked(o);return i.setValue(zl.k.imageLockAspectRatio,a),32},e.prototype.imageLockAspectRatio=function(e,t,n,r,i){if(!this.arePictureActionsEnabled(t))return 8;var o=ka.ImageReader.getImagePropertiesFromContext(t);if(1===n&&this.ifCompatMode())return 2;if(us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()){var a=t.get_node();Br.App.get_theCoauthManager().get_theLockManager().acquireAndApplyLock(a)}if(i){var s=i.getValueWithDefault(Boolean,zl.k.imageLockAspectRatio,!0);C.ULS.sendTraceTag(20459968,322,50,"Change image lock aspect ratio."),this._imageEditor.setImageLockAspectRatio(o,s),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&Br.App.get_activeAppFrame().updateCommandUI()}return 32},e.prototype.queryImageAltTextTitle=function(e,t,n,r,i){if(!this.arePictureActionsEnabled(t))return 8;var o=ka.ImageReader.getImagePropertiesFromContext(t),a=ka.ImageReader.getImageAltText(o);return i.setValue(zl.k.imageAltTextTitle,a),32},e.prototype.imageAltTextTitle=function(t,n,r,i,o){if(!this.arePictureActionsEnabled(n))return 8;if(1===r)return this.ifCompatMode()?2:32;if(us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()){var a=n.get_node().getValueWithDefault(Number,Oh.p.lockId,wh.z.lockIdNil);if(a!==wh.z.lockIdNil){var s=Br.App.get_theCoauthManager().get_theLockManager().getLock(a);if(os.CoauthLockEditor.getInstance().shouldLockBlockEditing(s))return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),2}}var l=ka.ImageReader.getImagePropertiesFromContext(n),c=o.getValueWithDefault(String,zl.k.imageAltTextTitle,null);return this._imageEditor.setImageAltTextHelper(l,n,c),C.ULS.sendTraceTag(21297027,322,50,"Change image alt text."),this.trackChangeManager.alertUntrackedChange(10),32},e.prototype.queryImageAltTextDescription=function(e,t,n,r,i){if(!this.arePictureActionsEnabled(t))return 8;var o=ka.ImageReader.getImagePropertiesFromContext(t),a=ka.ImageReader.getImageAltTextDescription(o);return i.setValue(zl.k.imageAltTextDescription,a),32},e.prototype.imageAltTextDescription=function(t,n,r,i,o){if(!this.arePictureActionsEnabled(n))return 8;if(1===r)return this.ifCompatMode()?2:32;if(us.n.get_instance().get_item(50)&&Br.App.get_theCoauthManager().get_isCoauthorable()){var a=n.get_node().getValueWithDefault(Number,Oh.p.lockId,wh.z.lockIdNil);if(a!==wh.z.lockIdNil){var s=Br.App.get_theCoauthManager().get_theLockManager().getLock(a);if(os.CoauthLockEditor.getInstance().shouldLockBlockEditing(s))return e.get_activityManager().recordEvent(D_.f.noApply,{Reason:M_.i.containsLockedRange}),2}}var l=ka.ImageReader.getImagePropertiesFromContext(n),c=o.getValueWithDefault(String,zl.k.imageAltTextDescription,null);return this._imageEditor.setImageAltTextDescriptionHelper(l,n,c),C.ULS.sendTraceTag(21297029,322,50,"Change image alt text description."),this.trackChangeManager.alertUntrackedChange(10),32},e.prototype.logPictureToolsTabEnabled=function(){C.ULS.sendTraceTag(20459969,322,50,"PictureTools Tab enabled.")},e.prototype.ifCompatMode=function(){return us.n.get_instance().get_item(51)&&this.get_pageReader().get_isCompatMode()},e.get_contextSetEditor=function(){return kf.ContextSetEditor.get_instance()},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_activityManager=function(){return ji.y.get_instance()},e.isMsSaveBlobSupported=function(){var e=!1;return null!=window.navigator.msSaveBlob&&(e=!0),e},e}();(0,o.l)(yk,"ImageActor",null,[]);var Ck=function(){function e(){}return e.prototype.get_key=function(){return"LIST"},e.prototype.get_contentTitle=function(){return Box4Intl.Box4Strings.l_ListContentTitle},e.prototype.tryGetDocumentStructureDetails=function(t,n){n.val=null;var r=e.get_listReader().getListInfo(t);if(!r)return!1;var i=this.getListItemInfo(t,r);return n.val=new Ea,n.val.set_providerKey(this.get_key()),n.val.contentId=i.listId,n.val.set_contentObject(i),!0},e.prototype.getContentIncrementalDetails=function(e,t){var n=e.get_contentObject(),r=this.getItemAnnotationFromListInfo(n.listInfo),i=new Ra.o(String);if(t){var o=t.get_contentObject();o.level!==n.level?(i.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,n.level)),i.add(r)):o.id.equals(n.id)&&o.listInfo.get_listType()===n.listInfo.get_listType()||i.add(r)}else i.add(String.format(Box4Intl.Box4Strings.l_ListContentTitle)),i.add(String.format(Box4Intl.Box4Strings.l_ListContentDetailsLevelFormat,n.level)),i.add(r);return i.toArray().join(" ")},e.prototype.getItemAnnotationFromListInfo=function(e){var t="",n=e.get_listStyle();if(e.get_listType()){if(1===e.get_listType())switch(n){case 1:t=this.get_bulletStyle1();break;case 2:t=this.get_bulletStyle2();break;case 3:t=this.get_bulletStyle3();break;default:t=this.get_bulletStyle1()}}else t=String.format(Box4Intl.Box4Strings.l_ListContentDetailsItemFormat,e.get_lastStartAt());return t},e.get_listReader=function(){return e._listReader||(e._listReader=se.w.get_instance().resolve(ts.c))},e._listReader=null,e}();(0,o.l)(Ck,"ListDetailsProvider",null,[wa,Jp.f]);var Sk=function(){return function(e){this.transaction=null,this.stage=0,this.newSelectionCollection=null,this.contiguousSelectionIndex=0,this.interactiveView=null,this.interactiveView=e,this.stage=0,this.contiguousSelectionIndex=0}}();(0,o.l)(Sk,"SelectAllArguments",null,[]);var vk=function(){function e(e,t,n,r,i){this._pageContentReader=null,this._lazyUndoManager=null,this._graphTransactionFactory=null,this._isExpandSelectionEnabled=!1,this._isTwoDimensionalOutlinesEnabled=!1,this._pageContentReader=e,this._lazyUndoManager=t,this._graphTransactionFactory=n,this._isExpandSelectionEnabled=r,this._isTwoDimensionalOutlinesEnabled=i}return e.prototype.get_pageContentReader=function(){return this._pageContentReader},e.prototype.get_undoManager=function(){return this._lazyUndoManager.get_value()},e.prototype.get_selectAllInOutlineHandler=function(){return this._isExpandSelectionEnabled?this._isTwoDimensionalOutlinesEnabled?o.i(this,this.expandSelectionOneNote,"expandSelectionOneNote"):o.i(this,this.expandSelectionWord,"expandSelectionWord"):o.i(this,this.selectAllInOutline,"selectAllInOutline")},e.prototype.get_selectAllOutlinesHandler=function(){return this._isTwoDimensionalOutlinesEnabled?o.i(this,this.selectAllOutlines,"selectAllOutlines"):null},e.prototype.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();this.get_selectAllOutlinesHandler()&&t.addActionWithFlags(ii.Tn,cl.n,this.get_selectAllOutlinesHandler(),2),t.addAction(ii.cJ,nt.a,e.showContextMenuAtSelection),t.addAction(ii.Qm,nt.a,e.showContextMenuAtSelection),t.addActionWithFlags(ii.vo,cl.n,this.get_selectAllInOutlineHandler(),2),t.addActionWithFlags(ii.bu,cl.n,$e.AFrame.doNothing,100),t.addActionWithFlags(ii.mp,cl.n,e.moveIpToPageStart,4)},e.prototype.expandSelectionOneNote=function(e,t,n,r,i){return this.expandSelection(t,n,null)},e.prototype.expandSelection=function(e,t,n){if(1===t)return 32;var r=e;if(!r.view.get_isInteractiveView())return 2;var i=r.view;if(!i.get_selectionManager())return 8;var a,s,l=i.get_selectionManager().get_selectionCollection();if(!l||!l.get_length())return 8;if(Xi.t.mark(5798),Br.App.get_activeAppFrame().workspace.get_isEditingAllowed()||Br.App.get_activeAppFrame().workspace.get_isReviewingAllowed())a=Pa.SelectionEditor.getNextSelectionExpansion(l);else{Nt.FocusManager.instance().scopeChanged($e.AFrame.documentFocusID);var c=i.get_targetNode();a=ss.SelectionFactory.selectAllNormalOutlinesOnPage(c)}if(!a)return 8;if(this._isExpandSelectionEnabled&&!l.currentExpansionState&&C.ULS.sendTraceTag(39098305,324,50,"Progress selection start"),n&&this.get_pageContentReader().isPageContentNode(Pa.SelectionEditor.getCurrentSelectionExpansionContainingNode(a)))s=n(i);else{var u=new Sk(i);u.newSelectionCollection=a,(s=new A_.a(null,o.i(this,this.processSetSelection,"processSetSelection"),u)).setDebugName("ExpandSelection"),s.run()}return s.get_inProgress()?1:32},e.prototype.expandSelectionWord=function(e,t,n,r,i){return t.view.get_isPageView()?this.expandSelection(t,n,o.i(this,this.startOperationOfSelectAllInOutline,"startOperationOfSelectAllInOutline")):this.selectAllInOutline(e,t,n,r,i)},e.prototype.processSetSelection=function(e,t){var n=t;return n.stage?1===n.stage?(n.interactiveView.get_selectionManager().setSelectionFromSelectionCollectionAsync(n.newSelectionCollection,e),n.stage=2,!0):2===n.stage&&(n.interactiveView.get_selectionManager().get_selectionCollection().currentExpansionState=n.newSelectionCollection.currentExpansionState,this.get_undoManager().interruptUndoMerging(),n.transaction.setAsyncOperation(e),n.stage=3,n.transaction.dispose(),Xi.t.mark(5799),!0):(n.transaction=this._graphTransactionFactory.getTransaction(2),n.transaction.setFromNode(n.interactiveView.get_targetNode()),n.stage=1,!0)},e.prototype.selectAllInOutline=function(e,t,n,r,i){if(1===n)return 32;var o=t;if(!o.view.get_isInteractiveView())return 2;var a=o.view;return a.get_selectionManager()&&a.get_selectionManager().get_selectionCollection()&&a.get_selectionManager().get_selectionCollection().get_currentSelection()?this.startOperationOfSelectAllInOutline(a).get_inProgress()?1:32:8},e.prototype.startOperationOfSelectAllInOutline=function(e){L.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IQoETinyWinsSelectAllSettings"),this._isExpandSelectionEnabled&&e.get_isPageView()&&C.ULS.sendTraceTag(39098306,324,50,"Progress select all reach top");var t=new A_.a(null,o.i(this,this.processSelectAllInOutline,"processSelectAllInOutline"),new Sk(e));return t.setDebugName("SelectAllInOutline"),t.run(),t},e.prototype.processSelectAllInOutline=function(e,t){var n=t;if(!n.stage)return n.newSelectionCollection=ss.SelectionFactory.selectAllOutlineElementsInOutline(n.interactiveView.get_selectionManager().get_selectionCollection().get_currentSelection()),n.transaction=this._graphTransactionFactory.getTransaction(2),n.transaction.setFromNode(n.interactiveView.get_targetNode()),n.stage=1,!0;if(1===n.stage){if(!n.contiguousSelectionIndex)return us.n.get_instance().get_item(77)&&us.n.get_instance().get_item(104)&&n.newSelectionCollection.get_isTableCellSelection()?(n.interactiveView.get_selectionManager().setSelectionFromSelectionCollectionAsync(n.newSelectionCollection,e),n.contiguousSelectionIndex=n.newSelectionCollection.get_length()):(n.interactiveView.get_selectionManager().setSelection(n.newSelectionCollection.get_item(0),e),++n.contiguousSelectionIndex),!0;if(n.contiguousSelectionIndex<n.newSelectionCollection.get_length())return n.interactiveView.get_selectionManager().addSelectionToCollectionAlternate(n.newSelectionCollection.get_item(n.contiguousSelectionIndex),e),++n.contiguousSelectionIndex,!0;n.stage=2}return 2===n.stage&&(n.interactiveView.get_selectionManager().get_selectionCollection().currentExpansionState=n.newSelectionCollection.currentExpansionState,this.get_undoManager().interruptUndoMerging(),n.transaction.setAsyncOperation(e),n.stage=3,n.transaction.dispose(),!0)},e.prototype.selectAllOutlines=function(e,t,n,r,i){if(1===n)return 32;var a=t;if(!a.view.get_isInteractiveView())return 2;var s=a.view,l=s.get_targetNode(),c=ss.SelectionFactory.selectAllNormalOutlinesOnPage(l);if(!c)return 8;var u=new Sk(s);u.newSelectionCollection=c;var g=new A_.a(null,o.i(this,this.processSetSelection,"processSetSelection"),u);return g.setDebugName("ExpandSelection"),g.run(),g.get_inProgress()?1:32},e.get_selectionContextMenuProvider=function(){return e._selectionContextMenuProvider||(e._selectionContextMenuProvider=se.w.get_instance().resolve(cg.f))},e.moveIpToPageStart=function(e,t,n,r,i){if(1===n)return 32;var o=t;if(!o.view.get_isInteractiveView())return 8;var a=o.view,s=ss.SelectionFactory.createCollapsedSelection(a.get_root().get_graphNode(),!0);return s?(a.get_selectionManager().setSelection(s),32):8},e.showContextMenuAtSelection=function(t,n,r,i,o){if(!us.n.get_instance().get_item(75))return 2;var a=Br.App.get_activeAppFrame().workspace.get_activeView();if(!a.get_isInteractiveView())return 2;if(a.get_isInteractiveView()&&1!==Br.App.get_activeAppFrame().get_state()){Xi.t.mark(4668);var s=a,l=s.get_selectionManager().get_selectionCollection().get_currentSelection();if(!l&&L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ContextMenuOnSelectionFixIsEnabled"))return 2;var c=Pa.SelectionEditor.boundsFromSelection(l),u=c.x,g=c.y+c.height;if(!s.get_container())return 8;var p=Sys.UI.DomElement.getBounds(s.get_container());(c.y<p.y||c.y>p.y+p.height||c.x<p.x||c.x>p.x+p.width)&&(u=p.x,g=p.y),e.get_selectionContextMenuProvider().showContextMenuForSelection(new Sys.UI.Point(u,g),1),Xi.t.mark(4669)}return 32},e._selectionContextMenuProvider=null,e}();(0,o.l)(vk,"SelectAllHandlers",null,[jp]);var bk=function(e){function t(t,n,r){void 0===r&&(r=null);var i,o=e.call(this)||this;return o.set_buttonsOption(1),n?(i=CommonUIStrings.l_GoToClassicRibbonDialogMesage,o.addFeedbackLink(CommonUIStrings.l_ToggleRibbonUXDialogTellUsWhy,r)):i=CommonUIStrings.l_GoToSingleLineRibbonDialogMessage,o.messageBoxImpl(CommonUIStrings.l_ToggleRibbonUXDialogTitle,i,null,null,t,null),o}return(0,S.t)(t,e),t}(ar.StandardDialog);(0,o.l)(bk,"ToggleRibbonUXDialog",ar.StandardDialog,[]);var Tk=function(e,t,n,r,i){if(1===n)return 32;if(t.get_contextId()!==nt.a)return 2;var o=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?"Single Line Ribbon":"Classic Ribbon";return C.ULS.sendTraceTag(25523336,340,50,"User opened the toggle Ribbon UX dialog from the {0}",o),new bk((function(e,t){1===e&&L.AFrameworkApplication.get_theActionManager().processAction(te.gO,2)}),L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()),32},Ak=function(e,t,n,r,i){return i[Di.e.On]=L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled(),32},Ik=n(1958),wk=function(){function e(){}return e.get_paragraphEditor=function(){return e._paragraphEditor||(e._paragraphEditor=se.w.get_instance().resolve(gc.g))},e.registerActions=function(){if(us.n.get_instance().get_item(54)||us.n.get_instance().get_item(84)){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(ii.FN,cl.n,DC.applyFormattingToView),t.setActionFlags(ii.FN,1028),t.addAction(ii.w,cl.n,DC.applyFormattingToView),t.addAction(ii.w,cl.K,e.applySpacingToText),t.setActionFlags(ii.w,1028),t.addAction(ii.Fw,cl.n,DC.applyFormattingToView),t.addAction(ii.Fw,cl.K,e.applySpacingToText),t.setActionFlags(ii.Fw,1028),t.addAction(ii.UT,cl.n,DC.applyFormattingToView),t.addAction(ii.UT,cl.K,e.applySpacingToText),t.setActionFlags(ii.UT,1028),t.addAction(ii.iD,cl.n,e.spinParaSpacing),t.addAction(ii.iD,cl.K,e.spinParaSpacing),t.setActionFlags(ii.iD,1028),t.addAction(ii.BK,cl.n,e.spinParaSpacing),t.addAction(ii.BK,cl.K,e.spinParaSpacing),t.setActionFlags(ii.BK,1028),t.addAction(ii.Ri,cl.n,DC.applyFormattingToView),t.addAction(ii.Ri,cl.K,e.applySpacingAsString),t.setActionFlags(ii.Ri,1028),t.addAction(ii.YG,cl.n,DC.applyFormattingToView),t.addAction(ii.YG,cl.K,e.applySpacingAsString),t.setActionFlags(ii.YG,1028)}},e.applySpacingAsString=function(t,n,r,i,o){return 1===r?32:(t===ii.Ri?t=ii.Fw:t===ii.YG&&(t=ii.UT),e.applySpacingToText(t,n,r,i,e.parseSpacingCommandData(o)))},e.parseSpacingCommandData=function(e){var t=e,n=t.indexOf(","),r=t.substring(0,n),i=t.substring(n+1,t.length),o=new oF;return o.value=parseFloat(r),o.unit=parseInt(i),o},e.spinParaSpacing=function(e,t,n,r,i){if(2===n){var o=i,a=o[Ho.Text],s=o[Ho.Number],l=o.Increment,c=new oF,u=!1;if(""===a||l&&a===Box4Intl.Box4Strings.L_SpinnerAuto?(c.value=0,c.unit=Br.App.get_isEastAsian()?2:4,u=!0):s||l||(c.value=0,c.unit=1,u=!0),u){var g=e===ii.iD?ii.Fw:ii.UT;L.AFrameworkApplication.get_theActionManager().processActionWithData(g,2,c),Br.App.get_activeAppFrame().updateCommandUI()}}return 32},e.applySpacingToText=function(t,n,r,i,o){var a;if(!DC.shouldExecuteParagraphAction(r,n,(0,p.m)((function(){return a}),(function(e){return a=e}))))return a;var s=n.get_node();switch(t){case ii.w:e.get_paragraphEditor().setLineSpacing(s,new Ik.o(2,o));break;case ii.Fw:var l=o,c=new Ik.o(l.unit,l.value);e.get_paragraphEditor().setBeforeSpacing(s,c);break;case ii.UT:var u=o,g=new Ik.o(u.unit,u.value);e.get_paragraphEditor().setAfterSpacing(s,g)}return 32},e._paragraphEditor=null,e}();(0,o.l)(wk,"SpacingActor",null,[]);var xk=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.setLineSpacing=function(e){this._actionManager.processActionWithData(ii.w,2,e)},e.prototype.setParagraphSpacing=function(e,t,n){this._actionManager.processActionWithData(e?ii.Fw:ii.UT,2,(0,O.m)(new oF,{value:t,unit:n}))},e}();(0,o.l)(xk,"SpacingCommands",null,[Ig]);var Fk=n(1778),Ek=function(){function e(){}return e.prototype.supportsListFormattingProperties=function(e){return e},e.prototype.isOnlySetEopFormatSupported=function(e){return!0},e}();(0,o.l)(Ek,"EopFormattingStrategy",null,[_h]);var Pk=function(){function e(){}return e.prototype.process=function(e,t,n,r){},e}();(0,o.l)(Pk,"NoOpFormattingViewOperationFinishedStageProcessor",null,[hh]);var kk=function(){function e(e){this._formattingEditor=null,this._formattingEditor=e}return e.prototype.setFormattingsWithExistingFormatting=function(e,t,n){this._formattingEditor.setFontFace(e,t.get_cache().get_fontFace()),this._formattingEditor.setFontSize(e,t.get_cache().get_fontSize())},e.prototype.setDefaultFormattings=function(e,t,n){},e.prototype.getLineSpacing=function(e){return null},e.prototype.getParagraphSpacing=function(e){return null},e.prototype.getSpecialIndent=function(e){return null},e.prototype.getLeftIndent=function(e){return null},e.prototype.shouldSkipHightlightAfterPaste=function(e){return!1},e}();(0,o.l)(kk,"FormattingStewardBridge",null,[Fk.u]);var Dk=function(){function e(){}return e.prototype.configure=function(e){e.register(hh).singleInstance().usingFactory((function(){return new Pk})),e.register(_h).singleInstance().usingFactory((function(){return new Ek})),e.register(Fk.u).singleInstance().usingFactory((function(){return new kk(e.resolve(xs.z))}))},e}();(0,o.l)(Dk,"WoncaActorsConfiguration",null,[c.s]);var Mk=function(){function e(){e.initializeParagraphStyleList()}return e.prototype.get_key=function(){return"FORMATTING_PARAGRAPH"},e.prototype.get_contentTitle=function(){return null},e.prototype.tryGetDocumentStructureDetails=function(t,n){if(n.val=null,!cs.ParagraphReader.isParagraph(t))return!1;var r=Tc.StyleReader.getStyleFromParagraphNode(t.get_currentNode());if(r&&2===Tc.StyleReader.getStyleTargetType(r)){var i=Tc.StyleReader.getStyleId(r);if(e._supportedParagraphStyles.contains(i)){var o=Tc.StyleReader.getStyleName(r);n.val=new Ea,n.val.set_providerKey(this.get_key()),n.val.contentId=r.get_id(),n.val.set_contentObject(o)}}return!!n.val},e.prototype.getContentIncrementalDetails=function(e,t){var n=null;return t&&e.contentId.equals(t.contentId)||(n=e.get_contentObject()),n},e.prototype.tryCollapseNestedContent=function(e,t,n){return n.val=null,!1},e.initializeParagraphStyleList=function(){e._supportedParagraphStyles=new bg.f(String),e._supportedParagraphStyles.add(Tc.StyleReader.styleIdHeading1),e._supportedParagraphStyles.add(Tc.StyleReader.styleIdHeading2),e._supportedParagraphStyles.add(Tc.StyleReader.styleIdHeading3),e._supportedParagraphStyles.add(Tc.StyleReader.styleIdHeading4),e._supportedParagraphStyles.add(Tc.StyleReader.styleIdHeading5),e._supportedParagraphStyles.add(Tc.StyleReader.styleIdHeading6),e._supportedParagraphStyles.add(Tc.StyleReader.styleIdTitle),e._supportedParagraphStyles.add(Tc.StyleReader.styleIdCitation),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdHeading1()),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdHeading2()),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdHeading3()),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdHeading4()),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdHeading5()),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdHeading6()),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdHeading7()),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdHeading8()),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdHeading9()),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdTitle()),e._supportedParagraphStyles.add(Tc.StyleReader.get_wordStyleIdSubtitle())},e._supportedParagraphStyles=null,e}();(0,o.l)(Mk,"ParagraphStyleDetailsProvider",null,[wa,Jp.f]);var Rk=function(){function e(e,t){this._futureAccessibilityContextManager=null,this._lazyListDetailsProvider=null,this._futureAccessibilityContextManager=e,this._lazyListDetailsProvider=t}return e.prototype.registerContentDetailsProviders=function(){var e=this;this._futureAccessibilityContextManager.execute((function(t){t.registerStructuralContentDetailsProvider(e._lazyListDetailsProvider.get_value()),t.registerStructuralContentDetailsProvider(new Mk)}))},e}();(0,o.l)(Rk,"AccessibilityActor",null,[]);var Lk=n(9354),Nk=n(6532),Bk=n(4784),Ok=function(e,t,n,r,i){return 1===n?32:(Br.App.get_activeAppFrame().forceUpdateCommandUI(),32)},Uk=function(){function e(){}return e.get_internalLinkManager=function(){return se.w.get_instance().resolve(dT.b)},e.registerActions=function(){L.AFrameworkApplication.get_theActionManager().addAction(ii.oO,cl.n,e.navToPage)},e.navToPage=function(t,n,r,i,o){if(!o)return 2;var a=o,s=e.parseClientUrlToInternalUrl(a);return s?(e.get_internalLinkManager().activatePage(s),32):2},e.parseClientUrlToInternalUrl=function(t){var n=unescape(decodeURI(t)),r=n.indexOf(e._sectionNameSuffix,0),i=n.lastIndexOf(e._sectionNamePrefix,r),o=t.indexOf(e._pageIdPrefix,0)+e._pageIdPrefix.length,a=t.indexOf(e._pageIdSuffix,o);if(!e.isValidId(i,r)||!e.isValidId(o,a))return null;var s=n.substring(i+1,r),l=t.substring(o,a);return e.isValidGuid(l)?String.format("onenote:{0}.one#&page-id={{{1}}}&end",s,l):null},e.isValidId=function(e,t){return-1!==e&&-1!==t&&!(e>=t)},e.isValidGuid=function(e){return!(!e||!e.length)&&ae.l.isValid(e)},e._sectionNamePrefix="/",e._sectionNameSuffix=".one",e._pageIdPrefix="&page-id=",e._pageIdSuffix="&end",e}();(0,o.l)(Uk,"CommandingNavActor",null,[]);var Hk=function(){function e(){}return e.get_pageEditor=function(){return e._pageEditor||(e._pageEditor=se.w.get_instance().resolve(eA.f))},e.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e.get_businessBarControllerFuture=function(){return e._businessBarControllerFuture||(e._businessBarControllerFuture=se.w.get_instance().resolveFuture(ni.d))},e.get_contextMenuDataProvider=function(){return e._contextMenuDataProvider||(e._contextMenuDataProvider=se.w.get_instance().resolve(WP))},e.registerActions=function(){if(us.n.get_instance().get_item(21)){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(ii.lH,cl.q,e.toggleVisibility),t.addAction(ii.to,cl.q,e.deleteConflict),t.addAction(ii.lH,cl.n,Br.App.get_activeAppFrame().workspace.currentPageActorHandler),t.addAction(ii.to,cl.n,Br.App.get_activeAppFrame().workspace.currentPageActorHandler)}},e.toggleVisibility=function(t,n,r,i,o){var a;if(a=o&&o.PageId?e.get_contextMenuDataProvider().clickedPage(o):n.get_node(),e.get_pageReader().isConflictPageNode(a)){var s=e.get_pageNavigator().getContainingPage(a),l=Br.App.get_activeAppFrame().workspace.get_activePage();l&&e.get_pageReader().isConflictPageNode(l)&&e.get_pageNavigator().getContainingPage(l)===s&&2===r&&Br.App.get_activeAppFrame().workspace.set_activePage(s),a=s}if(!e.get_pageReader().hasConflictPages(a))return 8;if(1===r)return 32;var c=new as.GraphTransaction(3);return c.setFromNode(a),e.get_pageEditor().setConflictPagesVisibility(a,!e.get_pageReader().areConflictPagesVisible(a)),c.dispose(),e.get_businessBarControllerFuture().execute((function(e){e.checkCurrentPageStatusBusinessBars()})),32},e.deleteConflict=function(t,n,r,i,o){var a,s=o;return a=s&&s.ConflictId&&s.PageId?e.getConflictPageFromActionData(o):Wx.conflictPageClicked||n.get_node(),e.get_pageReader().isConflictPageNode(a)?1===Br.App.get_activeAppFrame().get_mode()?8:1===r?32:(e.get_pageEditor().showDeletePageDialog(a),32):8},e.getConflictPageFromActionData=function(t){var n=t,r=e.get_contextMenuDataProvider().clickedPage(t),i=Dt.h.createFromString(n.ConflictId.toString());return r.getChildGraphSpaceNodeForObjectSpace(i)},e._pageEditor=null,e._businessBarControllerFuture=null,e._contextMenuDataProvider=null,e}();(0,o.l)(Hk,"ConflictPageActor",null,[]);var Gk=function(){function e(){}return e.prototype.registerActions=function(e){e.addAction(eb.IH,nt.a,o.i(this,this.onCopyNotebook,"onCopyNotebook"))},e.prototype.onCopyNotebook=function(e,t,n,r,i){if(1===n)return 32;var o=L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteCopyNotebookURL,a=L.AFrameworkApplication.appSettingsManager.get_appSettings().NotebookId,s=L.AFrameworkApplication.appSettingsManager.get_appSettings().NotebookName;if(o&&s&&a){C.ULS.sendTraceTag(8721284,339,50,"WAC initiated Copy Notebook Capture API"),a=Jn.l.urlKeyValueEncode(a),s=Jn.l.urlKeyValueEncode(s);var l=String.format("{0}?id={1}&name={2}",o,a,s);window.open(l,"_blank","width=800,height=600")}else C.ULS.sendTraceTag(8721285,339,50,"WAC unable to initiate Copy Notebook Capture API");return 32},e}();(0,o.l)(Gk,"CopyToCloudActor",null,[]);var Vk=n(9543),Wk=function(e,t,n,r,i){if(1===n)return 32;var o=t,a=o.get_node();return cs.ParagraphReader.isParagraphContext(o)&&!a.get_isBlockContent()?2:Vk.g.deleteOutlineElementContent(a,n)},zk=n(4054),Kk=function(){function e(){}return e.prototype.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.prototype.deleteParagraphContent=function(t,n,r,i,a){var s=n;if(1===r)return 32;var l=t===ii.WJ||t===ii.gG;if(this.get_lockedRangeEditor().get_isContentControlEditingEnabled()){if(this.get_lockedRangeEditor().isGraphNodeContextInEmptyContentControl(s)&&e.get_contentControlOperator()){var c=s.clone();if(c.set_ccBoundaryIdxAtCpEnd(c.get_ccBoundaryIdxAtCpEnd()+1),c.set_ccBoundaryIdxAtCpBegin(c.get_ccBoundaryIdxAtCpBegin()-1),this.get_lockedRangeEditor().isTextRangeContextDeletable(c)){var u=[c];return e.get_contentControlOperator().releaseContentControlsInContexts(u),32}}if(us.n.get_instance().get_item(14)&&this.get_lockedRangeEditor().isLockedForDeleteOrBackspaceKey(s,l))return 2}if(e.get_externalSelectionManagerFuture()&&e.get_externalSelectionManagerFuture().get_instance()&&e.get_externalSelectionManagerFuture().get_instance().isExternalSelectionContext(s))return 4;var g=s.get_node(),d=s.get_cpBegin(),h=s.get_cpEnd(),_=s.get_ccBoundaryIdxAtCpBegin(),m=s.get_ccBoundaryIdxAtCpEnd(),y=cs.ParagraphReader.text(g),C=y.length,S=t,v=!1;if(d===h){if(l&&!d||!l&&d===C)return 2;l?(us.n.get_instance().get_item(14)&&(v=this.get_lockedRangeEditor().moveIpToStartOfFieldRangeIfExists(g,(0,p.m)((function(){return d}),(function(e){return d=e})))),v||(v=this.get_lockedRangeEditor().moveIpToStartOfContentControlIfExists(s,(0,p.m)((function(){return d}),(function(e){return d=e})),(0,p.m)((function(){return _}),(function(e){return _=e})))),v||(d--,Jn.l.isLowSurrogateCharAt(y,d)&&d--),S=ii.Bc):(us.n.get_instance().get_item(14)&&(v=this.get_lockedRangeEditor().moveIpToEndOfFieldRangeIfExists(g,(0,p.m)((function(){return h}),(function(e){return h=e})))),v||(v=this.get_lockedRangeEditor().moveIpToEndOfContentControlIfExists(s,(0,p.m)((function(){return h}),(function(e){return h=e})),(0,p.m)((function(){return m}),(function(e){return m=e})))),v||(h++,Jn.l.isLowSurrogateCharAt(y,h)&&h++),S=ii.fE)}var b=d===h?_s.y.createIpContext(g,d):_s.y.createTextRange(g,d,h);if(v&&this.get_lockedRangeEditor().get_isContentControlEditingEnabled()&&(l?b.set_ccBoundaryIdxAtCpBegin(_):b.set_ccBoundaryIdxAtCpEnd(m)),us.n.get_instance().get_item(14)&&!this.get_lockedRangeEditor().isTextRangeContextDeletable(b))return 2;this.acquireLocksForGraphNode(g);var T=new as.GraphTransaction(15);T.set_undoActionId(S),T.setFromNode(g);var A=o.r(ty,a)&&a.forceDeletion;if(e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()&&!A){var I=e.get_trackChangeManager().beginUntrackedChangeCapture();try{var w,x=e.get_trackChangeReader().splitAndSortTrackableContexts(b);if(x.getUntrackedChangeType((0,p.m)((function(){return w}),(function(e){return w=e})))){var F=(0,f.e)(U_.d,a);!!F&&F.getValueWithDefault(Boolean,Oh.p.isDeleteFromOvertype,!1)||1===w?e.get_trackChangeManager().set_pendingUntrackedChangeAlert(w):e.get_trackChangeManager().alertUntrackedChange(w)}for(var E=0,P=function(t){var n,r=x.getContext(t,(0,p.m)((function(){return n}),(function(e){return n=e})));n?(e.get_hyperlinkEditor().normalizeHyperlinksinGraphNodeContext(r,null),E+=e.get_trackChangeEditor().setTrackChangeOnContext(r,2),e.get_trackChangeEditor().set_cpPositionAfterTrackChange(h+E)):k.deleteParagraphContentUsingReplaceTextRange(r)},k=this,D=x.get_length()-1;D>=0;--D)P(D)}finally{I&&I.dispose()}}else this.deleteParagraphContentUsingReplaceTextRange(b);return T.dispose(),32},e.prototype.acquireLocksForGraphNode=function(e){},e.get_trackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},e.get_trackChangeEditor=function(){return e._trackChangeEditor||(e._trackChangeEditor=se.w.get_instance().resolve(cc.x).get_instance())},e.get_trackChangeReader=function(){return e._trackChangeReader||(e._trackChangeReader=se.w.get_instance().resolve(za.p).get_instance())},e.get_hyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=se.w.get_instance().resolve(Ja.o))},e.get_externalSelectionManagerFuture=function(){return e._externalSelectionManagerFuture||(e._externalSelectionManagerFuture=se.w.get_instance().resolveFuture(gh.i))},e.get_contentControlOperator=function(){return e._futureCCOperator||(e._futureCCOperator=se.w.get_instance().resolveFuture(zk.r)),e._futureCCOperator.get_instance()},e._trackChangeManager=null,e._trackChangeEditor=null,e._trackChangeReader=null,e._hyperlinkEditor=null,e._externalSelectionManagerFuture=null,e._futureCCOperator=null,e}();(0,o.l)(Kk,"ADeleteParagraphContentStrategy",null,[]);var qk=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.deleteParagraphContentUsingReplaceTextRange=function(e){t.get_characterPropertiesEditor().replaceTextRange(_s.y.createTextRange(e.get_node(),e.get_cpBegin(),e.get_cpEnd()),"",void 0,void 0,ii.iv)},t.get_characterPropertiesEditor=function(){return t._characterPropertiesEditor||(t._characterPropertiesEditor=se.w.get_instance().resolve(Va.x))},t.get_unsupportedNodeEditor=function(){return wf.q.get_instance()},t._characterPropertiesEditor=null,t}(Kk);(0,o.l)(qk,"DeleteParagraphContentStrategy",Kk,[]);var jk=n(8687),$k=function(){return function(e,t,n,r){this.viewContext=null,this.reportingData=null,this.actionData=null,this.actionId=0,this.viewContext=e,this.reportingData=n,this.actionData=r,this.actionId=t}}();(0,o.l)($k,"DeleteActionData",null,[]);var Qk=function(){function e(){}return e.prototype.get_clipboardOperationCutStrategy=function(){return e._clipboardOperationCutStrategy||(e._clipboardOperationCutStrategy=se.w.get_instance().resolve(bd))},e.prototype.get_isContentControlEditingEnabled=function(){return e._ccConfigSettings||(e._ccConfigSettings=se.w.get_instance().tryResolve(Cf.i)),!!e._ccConfigSettings&&e._ccConfigSettings.get_isContentControlEditingEnabled()},e.prototype.trackContextForNonIpDelete=function(e){return!Pa.SelectionEditor.isTextRangeContext(e)},e.prototype.getSelectionToDelete=function(e,t,n){if(!e)return null;if(!n)return e;var r=Pa.SelectionEditor.findNextOrPreviousIp(e,!1,!t,!0,!0,!0);return ss.SelectionFactory.extendSelection(e,r.get_firstContext(),!1)},e.prototype.deleteView=function(t,n,r,i,o){if(1===r)return 32;var a=!1;if(L.AFrameworkApplication.appSettingsManager&&"OneNote"===L.AFrameworkApplication.appSettingsManager.getStringAppSetting("Application")&&t!==ii.Ed&&t!==ii.KY&&(a=CF.z.isIpInAtMentionLink(n)),t===ii.Ed&&(t=ii.Dx,a=!0),t===ii.KY&&(t=ii.WJ,a=!0),t===ii.Od&&(n=new z_.k(Br.App.get_activeAppFrame().workspace.get_contentView())),!n.view.get_isInteractiveView())return 2;FS.o.get_instance().setVisibility(!1);var s=t===ii.Dx,l=CF.z.getFirstSelectionFromContext(n);if(a&&this.get_isContentControlEditingEnabled()&&l&&Pa.SelectionEditor.isInsertionPointSelection(l)&&us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().isLockedForDeleteOrBackspaceKey(l.get_firstContext(),!s,!0))return 2;var c=this.getSelectionToDelete(l,s,a);return this.deleteViewInternal(t,n,r,i,o,c,s,a)},e.prototype.deleteViewInternal=function(t,n,r,i,o,a,s,l){var c=this,u=n,g=u.view,d=g.get_selectionManager(),h=o,_=o;if(t===ii.Od&&(h=null,_=null,a=new X_.Selection(o,!0)),!a)return 32;var m,f=new $k(u,t,i,_),y=this.shouldDeleteTableSegments(h,s,d),C=!1;if(this.shouldPerformDeleteRowColumnInComplexTable(t,y,d,(0,p.m)((function(){return C}),(function(e){return C=e}))))return t=C?ii.qS:ii.ym,L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,t,r,!1,i,o);if(this.get_isContentControlEditingEnabled()&&e.get_contentControlOperator()&&1===d.get_selectionCollection().get_length()&&Pa.SelectionEditor.isInsertionPointSelection(a)&&a.get_containsSingleContext()&&e.get_contentControlOperator().selectAdjacentContentControlIfExist(a.get_firstContext(),s))return 32;s?Xi.t.mark(m=5009):Xi.t.mark(m=5011);var S=new as.GraphTransaction(15);S.set_undoActionId(t),S.setFromNode(g.get_targetNode());var v=null,b=this.getContextToDelete(t,o,d,a,s,(0,p.m)((function(){return v}),(function(e){return v=e}))),T=null;if(kf.ContextSetEditor.get_instance().shrinkContextSetForDeleteAction(b,(0,p.m)((function(){return T}),(function(e){return T=e})))&&(b=T),!b)return S.dispose(),32;if(this.get_isContentControlEditingEnabled()&&e.get_contentControlOperator()){var A=kf.ContextSetEditor.get_instance().breakDownContextSets(b);e.get_contentControlOperator().releaseContentControlsInContexts(A)}this.trackIfNodeCanBeDisconnectedDuringDelete(b);var I=this.getAdjacentIp(b,a,s),w=null;s?w=new Xf(a):I&&(w=new Xf(I));var x=!1;if(Pa.SelectionEditor.isInsertionPointContext(b)){if(t===ii.gG)return 2;var F=Ef.getNormalizer(g.get_targetNode(),y);e.get_cpuMeter().profileFunction((function(){c.deleteAtInsertionPointContext(t,n,i,o,b,s,w,a,F,d,y,f,I)}),"DeleteViewStrategy:DeleteAtInsertionPointContext")}else e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()?(this.trackContentDeletionChange(t,g.get_targetNode(),b,s,a,d,y,l,f,w),x=!0):x=this.performUntrackedDelete(t,g.get_targetNode(),b,d,y,f,w,v);return e.fixConsecutiveSpaces(d),this.resetNodeCanBeDisconnectedDuringDeleteProperty(b),S.dispose(),Xi.t.mark(m+1),t===ii.Od?x?32:8:32},e.prototype.deleteFromInputEvent=function(e,t,n,r,i){return t.view.get_isInteractiveView()?this.deleteViewInternal(e,t,n,r,null,i,!1,!1):2},e.prototype.performUntrackedDelete=function(t,n,r,i,a,s,l,c){var u=Ef.getNormalizer(n,a);this.trackContextForNonIpDelete(r)&&u.trackContext(r);var g=e.get_activityManager().startActivity(t);g.get_properties().set_item("CountOfParagraphsDeleted",e.get_paragraphReader().countOfParagraphsInContext(r).toString());var p=e.dispatchDeleteConditional(e.shouldDispatchWithSpecialize,o.i(this,this.shouldDispatchNoSpecialize,"shouldDispatchNoSpecialize"),r,i,a,u,s,l,c);return g.end(),p},e.prototype.trackContentDeletionChange=function(t,n,r,i,o,a,s,l,c,u){var g=0,p=null,d=kf.ContextSetEditor.get_instance().breakDownContextSets(r),h=d[d.length-1];if(h.get_contextId()===cl.K||h.get_contextId()===cl.A){var _=Da.GraphIterator.createFromNode(h.get_node());_.tryToRootAtOutlineAncestor(),hs.OutlineElementNavigator.returnToOutlineElement(_),hs.OutlineElementNavigator.moveToNextOutlineElement(_,!0,!1)&&(p=hs.OutlineElementNavigator.moveToContent(_))&&(g=e.get_paragraphReader().textLength(p))}else g=e.get_paragraphReader().textLength(h.get_node())-h.get_cpEnd();var m=(0,f.e)(U_.d,c.actionData),y=!!m&&m.getValueWithDefault(Boolean,Oh.p.isDeleteFromOvertype,!1);if(y)this.performContextDeletion(t,n,r,a,s,c,u,!1,y);else{var C=e.get_trackChangeManager().beginUntrackedChangeCapture();try{this.performContextDeletion(t,n,r,a,s,c,u,!0)}finally{C&&C.dispose()}}var S=null;if(i){var v=void 0,b=null;if(r.get_isContextSet()){var T=d.length-1;do{b=d[T],T--}while(!b.get_node().get_isConnected()&&T>=0)}else b=r;if(!e.get_paragraphReader().isParagraphNode(b.get_node()))return;switch(h.get_contextId()){case cl.K:case cl.A:v=p&&p.get_isConnected()?0:g;break;case cl.V:case cl.Z:v=g;break;default:v=0}S=ss.SelectionFactory.createIpSelection(b.get_node(),e.get_paragraphReader().textLength(b.get_node())-v),b.get_actualCpBegin()===S.get_firstContext().get_cpBegin()&&S.get_firstContext().set_ccBoundaryIdxAtCpBegin(b.get_ccBoundaryIdxAtCpBegin())}else{var A=o.get_firstContext().get_node();if(!e.get_paragraphReader().isParagraphNode(A))return;var I=o.get_firstContext().get_contextId()===cl.K?0:o.get_firstContext().get_contextId()===cl.A?e.get_paragraphReader().textLength(A):o.get_firstContext().get_cpBegin();S=ss.SelectionFactory.createIpSelection(A,I)}Oa.SelectionManager.get_instance().setSelection(S)},e.prototype.performContextDeletion=function(t,n,r,i,o,a,s,l,c){void 0===c&&(c=!1),r=this.generalizeContext(i,r);var u,g=e.get_trackChangeReader().splitAndSortTrackableContexts(r);g.getUntrackedChangeType((0,p.m)((function(){return u}),(function(e){return u=e})))&&(l&&1!==u?e.get_trackChangeManager().alertUntrackedChange(u):e.get_trackChangeManager().set_pendingUntrackedChangeAlert(u));for(var d=function(r){var l,u=g.getContext(r,(0,p.m)((function(){return l}),(function(e){return l=e})));if(l){var d=c&&u.get_contextId()===cl.A&&r===g.get_length()-1;e.get_hyperlinkEditor().normalizeHyperlinksinGraphNodeContext(u,2),d||e.get_trackChangeEditor().setTrackChangeOnContext(u,2)}else h.performUntrackedDelete(t,n,u,i,o,a,s,null)},h=this,_=g.get_length()-1;_>=0;--_)d(_)},e.prototype.generalizeContext=function(e,t){if(o.r(Bb.u,t))for(var n=Tf.generalizeSelectionToOEs(e.get_selectionCollection(),!0),r=0;r<n.get_length();r++)if(n.getContext(r).get_contextId()===cl.i)return n;return t},e.prototype.getContextToDelete=function(e,t,n,r,i,o){var a=null;return e===ii.Od?(a=bf.x.createSet(t),o.val=Df.a.get_instance().createReferenceToCurrentSelection()):(o.val=null,a=1===n.get_selectionCollection().get_length()?Oa.SelectionManager.createMultiRangeOrGraphContext(r):n.get_selectionContextForActionDispatch()),a},e.prototype.canDisconnectNodeDuringDelete=function(t){return!!t.get_isGraphNodeContext()&&(t.get_contextId()===cl.K&&(!!e.get_paragraphReader().isParagraphNode(t.get_node())&&((!e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()||!e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled())&&(!us.n.get_instance().get_item(14)||!e.get_lockedRangeEditor().isParaContextInLockedRange(t)))))},e.prototype.trackIfNodeCanBeDisconnectedDuringDelete=function(e){if(e.get_isContextSet())for(var t=e,n=0;n<t.get_length();n++)this.trackIfNodeCanBeDisconnectedDuringDelete(t.getContext(n));else this.canDisconnectNodeDuringDelete(e)&&e.get_node().set_canBeDisconnectedDuringDelete(!0)},e.prototype.resetNodeCanBeDisconnectedDuringDeleteProperty=function(t){if(t.get_isContextSet())for(var n=t,r=0;r<n.get_length();r++)this.resetNodeCanBeDisconnectedDuringDeleteProperty(n.getContext(r));else if(t.get_isGraphNodeContext()){var i=t.get_node();i&&e.get_paragraphReader().isParagraphNode(i)&&i.set_canBeDisconnectedDuringDelete(!1)}},e.prototype.deleteAtInsertionPointContext=function(t,n,r,i,o,a,s,l,c,u,g,p,d){var h=new Da.GraphIterator,_=o.get_node();h.set(_),h.tryToRootAtOutlineAncestor(),!Pa.SelectionEditor.isIpAtStartOrEnd(h.get_currentNode(),o,a)||e.get_lockedRangeEditor().get_isContentControlEditingEnabled()&&e.get_lockedRangeEditor().isGraphNodeContextInEmptyContentControl(o)?e.deleteFromIpInMiddle(t,o,a,s,l,c,u,g,p):this.deleteFromIpAtStartOrEnd(n,r,i,o,a,s,l,c,u,p,d,h,_)},e.prototype.handleListOutlineElement=function(t,n,r,i){return!(t||!mc.ListReader.isListOutlineElement(n))&&(i.val=e.removeList(n,r),!0)},e.prototype.handleIndentOnDelete=function(e,t,n,r,i,o){return!!(us.n.get_instance().get_item(65)&&!e&&Ls.OutlineElementReader.getFirstLineIndentWithTabs(t)>0)&&(o.val=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,ii.tV,2,!1,r,i),!0)},e.prototype.handleWordParagraphFormatting=function(e,t,n,r,i,o){return!!(us.n.get_instance().get_item(54)&&!e&&Ls.OutlineElementReader.getHangingIndent(t)>0)&&(o.val=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,ii.qv,2,!1,r,i),!0)},e.prototype.handlePromoteOnBackspace=function(t,n,r,i,o,a){return!(!us.n.get_instance().get_item(80)||t||!e.get_indentationEditor().canPromote(n,-1))&&(a.val=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(r,ii.lN,2,!1,i,o),!0)},e.prototype.handleAdjacentOutlineElement=function(t,n,r,i,o,a,s,l,c,u,g){var p=new Pm.z;if(p.setFrom(n),hs.OutlineElementNavigator.moveToNextOrPreviousOutlineElement(p,!1,!t,!1)){g.val=!0,u.val=32;var d=new Da.GraphIterator;return d.setFrom(p),hs.OutlineElementNavigator.moveToContent(p),a&&i&&Pa.SelectionEditor.isBlockContext(i.get_firstContext())?(r.trackContext(o),e.get_outlineElementEditor().removeContainingOutlineElement(n.get_currentNode())):p.get_currentNode().get_isBlockContent()?(us.n.get_instance().get_item(68)&&r.trackContext(o),hs.OutlineElementNavigator.returnToOutlineElement(p),p.disconnectNodeAndReturnToParent()):us.n.get_instance().get_item(66)&&t&&a?e.get_lockedRangeEditor().isParagraphNodeDeletable(l)&&!this.processEopDeletionTrackChange(t,l,p.get_currentNode(),i,g)&&(r.trackContext(o),e.get_listEditor().removeList(n),this.get_deleteParagraphNodeStrategy()&&this.get_deleteParagraphNodeStrategy().prepareEmptyParagraphNodeForDelete(l),n.disconnectNodeAndReturnToParent()):dc.TableReader.isTable(p)?(r.trackContext(o),this.get_deleteTableStrategy()&&(g.val=this.get_deleteTableStrategy().deleteAtTable(t,d,n,p,s,c,u))):e.get_paragraphReader().isParagraphNode(p.get_currentNode())&&(this.processEopDeletionTrackChange(t,l,p.get_currentNode(),i,g)||this.get_deleteParagraphNodeStrategy()&&this.get_deleteParagraphNodeStrategy().deleteAtParagrahNode(t,r,o,n,l,p)),!0}return!1},e.prototype.processEopDeletionTrackChange=function(t,n,r,i,a){if(e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()){if(e.get_contentControlReader()){var s=!!o.r(hc.AParagraphNode,r)&&e.get_contentControlReader().isParagraphInBlockContentControl(r),l=!!o.r(hc.AParagraphNode,n)&&e.get_contentControlReader().isParagraphInBlockContentControl(n);if(s!==l)return!1;if(l)return this.get_isContentControlEditingEnabled()&&e.areParagraphsInSameBlockContentControl(n,r,t)&&e.get_trackChangeManager().alertUntrackedChange(1),!1}var c=t?n:r;if(!o.r(hc.AParagraphNode,c))return!1;var u=c.get_characterProperties().get_last(),g=L.AFrameworkApplication.userName;if(!u.get_trackChangeInsert()||u.get_trackChangeInsert().authorName!==g)return e.get_trackChangeEditor().setTrackChangeEop(c,2),i&&(Oa.SelectionManager.get_instance().setSelection(i),a.val=!1),!0}return!1},e.prototype.handleTableStructureModificationOnDelete=function(t,n,r,i,o,a,s,l){if(us.n.get_instance().get_item(67)&&Ls.OutlineElementReader.isFirstOrLastOutlineElementInOutline(n,t)){var c;if(Zc.isInTableCell(n))ld.returnToContainingCell(n),Zc.isEmpty(n)&&r.trackContext(i),l.val=e.modifyTableStructure(n,s,t,o,a,(0,p.m)((function(){return c}),(function(e){return c=e}))),c||(l.val=2);return!0}return!1},e.prototype.handleIsFirstOrLastOutlineElementInOutline=function(t,n,r,i,o,a,s,l){return!Ls.OutlineElementReader.isFirstOrLastOutlineElementInOutline(n,t)&&(e.doCrossNodeDelete(r,i,t,a,o,s,l),!1)},e.prototype.deleteFromIpAtStartOrEnd=function(t,n,r,i,o,a,s,l,c,u,g,d,h){var _=!1,m=2,f=e.get_paragraphReader().isEmpty(d),y=d.get_currentNode();hs.OutlineElementNavigator.returnToOutlineElement(d),this.handleListOutlineElement(o,d,u,(0,p.m)((function(){return m}),(function(e){return m=e})))||this.handleIndentOnDelete(o,d,t,n,r,(0,p.m)((function(){return m}),(function(e){return m=e})))||this.handleWordParagraphFormatting(o,d,t,n,r,(0,p.m)((function(){return m}),(function(e){return m=e})))||this.handlePromoteOnBackspace(o,d,t,n,r,(0,p.m)((function(){return m}),(function(e){return m=e})))||this.handleAdjacentOutlineElement(o,d,l,g,i,f,y,h,c,(0,p.m)((function(){return m}),(function(e){return m=e})),(0,p.m)((function(){return _}),(function(e){return _=e})))||this.handleTableStructureModificationOnDelete(o,d,l,i,c,u,y,(0,p.m)((function(){return m}),(function(e){return m=e})))||this.handleIsFirstOrLastOutlineElementInOutline(o,d,n,r,l,s,(0,p.m)((function(){return m}),(function(e){return m=e})),(0,p.m)((function(){return _}),(function(e){return _=e}))),e.normalizeOrCancel(l,32===m),_&&e.restoreSelection(c,a)},e.prototype.shouldDeleteTableSegments=function(e,t,n){return e&&e.hasProperty(zl.k.doNotDeleteTableSegments)?this.get_clipboardOperationCutStrategy().shouldDeleteTableForCut()||e.getValue(Boolean,zl.k.doNotDeleteTableSegments)?!e.getValueWithDefault(Boolean,zl.k.doNotDeleteTableSegments,!1):this.getDefaultShouldDeleteTableSegments(!1,n):this.getDefaultShouldDeleteTableSegments(t,n)},e.prototype.shouldPerformDeleteRowColumnInComplexTable=function(e,t,n,r){return r.val=!1,!1},e.get_characterPropertiesEditor=function(){return e._characterPropertiesEditor||(e._characterPropertiesEditor=se.w.get_instance().resolve(Va.x))},e.get_listReader=function(){return e._listReader||(e._listReader=se.w.get_instance().resolve(ts.c))},e.get_paragraphReader=function(){return e._paragraphReader||(e._paragraphReader=se.w.get_instance().resolve(Fd.s))},e.get_hyperlinkEditor=function(){return e._hyperlinkEditor||(e._hyperlinkEditor=se.w.get_instance().resolve(Ja.o))},e.get_listEditor=function(){return e._listEditor||(e._listEditor=se.w.get_instance().resolve(rs.v))},e.get_outlineElementEditor=function(){return e._oulineElementEditor||(e._oulineElementEditor=se.w.get_instance().resolve(Es.p))},e.get_unsupportedNodeEditor=function(){return wf.q.get_instance()},e.get_indentationEditor=function(){return yc.z.get_getOutlineElementIndentationEditor()},e.get_trackChangeManager=function(){return e._trackChangeManager||(e._trackChangeManager=se.w.get_instance().resolve($a.b).get_instance())},e.get_trackChangeEditor=function(){return e._trackChangeEditor||(e._trackChangeEditor=se.w.get_instance().resolve(cc.x).get_instance())},e.get_trackChangeReader=function(){return e._trackChangeReader||(e._trackChangeReader=se.w.get_instance().resolve(za.p).get_instance())},e.get_activityManager=function(){return ji.y.get_instance()},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_contentControlOperator=function(){return e._futureCCOperator||(e._futureCCOperator=se.w.get_instance().resolveFuture(zk.r)),e._futureCCOperator.get_instance()},e.get_contentControlReader=function(){return e._contentControlReader||(e._contentControlReader=se.w.get_instance().tryResolve(jk.c))},e.get_hyperlinkStrategy=function(){return e._hyperlinkStrategy||(e._hyperlinkStrategy=se.w.get_instance().resolve(pS.n))},e.get_cpuMeter=function(){return KF.r.get_instance()},e.fixConsecutiveSpaces=function(t){if(1===t.get_selectionCollection().get_length()){var n=t.get_selectionCollection().get_item(0);if(Pa.SelectionEditor.isInsertionPointSelection(n)){var r=n.get_firstContext(),i=r.get_node(),o=r.get_cpBegin(),a=e.get_paragraphReader().text(i);o<a.length&&o>0&&" "===a.charAt(o-1)&&" "===a.charAt(o)&&e.get_characterPropertiesEditor().replaceTextRange(_s.y.createTextRange(i,o-1,o),"\xa0")}}},e.backspaceHyperlink=function(t,n,r){if(!n.hyperlink.get_isInFieldRange()){var i=new as.GraphTransaction(15);try{i.setFromNode(t.get_node()),e.get_hyperlinkStrategy().removeHyperlink(t,n)}finally{i&&i.dispose()}}},e.removeList=function(t,n){var r=e.get_listReader().getListInfo(t).get_isOrdered()?ii.nQ:ii.Gk;return L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n.viewContext,r,2,!1,n.reportingData,n.actionData)},e.doCrossNodeDelete=function(e,t,n,r,i,o,a){var s=Pa.SelectionEditor.findNextOrPreviousIp(r,!1,!n,!1,!1,!0);if(s){var l=ss.SelectionFactory.extendSelection(r,s.get_firstContext());o.val=32;for(var c=0;c<l.get_length();++c){i.trackContext(l.get_item(c));var u=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l.get_item(c),ii.Dx,2,!0,e,t);2!==u&&(o.val=u)}32===o.val&&(a.val=!0)}},e.dispatchDeleteConditional=function(t,n,r,i,o,a,s,l,c){var u=!1;return t(r)?(u=e.dispatchDelete(r,!0,i,o,a,s))&&e.updateSelection(l,i,c):n(r)?(u=e.dispatchDelete(r,!1,i,o,a,s))&&e.updateSelection(l,i,c):(a.normalize(),e.updateSelection(l,i,c)),u},e.updateSelection=function(t,n,r){r&&r.restoreSelection()||e.restoreSelection(n,t)},e.dispatchDelete=function(t,n,r,i,o,a){if(!i&&!vc.isOutlineLevelContext(t)){var s=e.tryToGetFullSelectedTable(r);s&&o.setTableAsNotDeletable(s)}var l=32===L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(t,a.actionId,2,n,a.reportingData,a.actionData);return e.normalizeOrCancel(o,l),l},e.normalizeOrCancel=function(e,t){t?e.normalize():e.cancel()},e.restoreSelection=function(e,t){if(t){var n=t.restore();n&&e.setSelection(n)}},e.deleteFromIpInMiddle=function(t,n,r,i,o,a,s,l,c){var u,g=n;if(!r&&e.get_hyperlinkStrategy().isIpAtEndOfHyperlink(g,(0,p.m)((function(){return u}),(function(e){return u=e}))))i=new Xf(o),e.backspaceHyperlink(g,u,t),a.normalize(),e.restoreSelection(s,i);else if(e.dispatchDelete(n,!1,s,l,a,c))if(r&&e.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&e.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()){var d=e.get_trackChangeEditor().get_cpPositionAfterTrackChange();if(d){var h=n.get_node();s.setSelection(ss.SelectionFactory.createIpSelection(h,d)),e.get_trackChangeEditor().set_cpPositionAfterTrackChange(null)}else e.restoreSelection(s,i)}else e.restoreSelection(s,i)},e.areParagraphsInSameBlockContentControl=function(t,n,r){var i,o;r?(i=t,o=n):(i=n,o=t);var a=e.get_contentControlReader().isParagraphStartOrEndWithBlockContentControl(i,!1),s=e.get_contentControlReader().isParagraphStartOrEndWithBlockContentControl(o,!0);return!(a&&s)},e.modifyTableStructure=function(e,t,n,r,i,o){var a=2;if(o.val=!0,Zc.isEmpty(e)){var s=ld.getContainingTable(e),l=dc.TableReader.getRowCount(s),c=dc.TableReader.getColumnCount(s);if(1===l&&1===c)a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(_s.y.create(s),ii.ze,2,!1,i.reportingData,i.actionData),r.setSelection(ss.SelectionFactory.createIpSelection(t,0)),o.val=!1;else if(1===l)a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(i.viewContext,ii.qS,2,!1,i.reportingData,i.actionData);else{var u=Zc.isEmptyIncludingTheRestOfTheRow(e);if(Zc.isFirstCellInRow(e)&&u)a=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(i.viewContext,ii.ym,2,!1,i.reportingData,i.actionData);else if(!n&&u){a=32;var g=Pa.SelectionEditor.findPreviousIp(r.get_selectionCollection().get_currentSelection(),!1,!1,!1,!0);r.setSelection(g),o.val=!1}}}return a},e.shouldDispatchWithSpecialize=function(t){return t.get_isContextSet()||vc.isOutlineLevelContext(t)||e.get_paragraphReader().isParagraphContext(t)},e.tryToGetFullSelectedTable=function(e){var t=Tf.generalizeSelectionToOEs(e.get_selectionCollection(),!0);if(t&&1===t.get_length()){var n=t.getContext(0).get_node();if(dc.TableReader.isTableNode(n))return n}return null},e._listReader=null,e._characterPropertiesEditor=null,e._oulineElementEditor=null,e._paragraphReader=null,e._hyperlinkEditor=null,e._listEditor=null,e._trackChangeManager=null,e._trackChangeEditor=null,e._trackChangeReader=null,e._futureCCOperator=null,e._contentControlReader=null,e._clipboardOperationCutStrategy=null,e._ccConfigSettings=null,e._hyperlinkStrategy=null,e}();(0,o.l)(Qk,"ADeleteViewStrategy",null,[]);var Jk=(0,o.y)("IDeleteParagraphNodeStrategy"),Xk=function(){function e(){}return e.prototype.get_outlineElementEditor=function(){return e._oulineElementEditor||(e._oulineElementEditor=se.w.get_instance().resolve(Es.p))},e.prototype.deleteAtParagrahNode=function(e,t,n,r,i,o){e?(hs.OutlineElementNavigator.returnToOutlineElement(o),t.trackNode(o.get_currentNode()),this.get_outlineElementEditor().merge(r,o,!1,!1)):(hs.OutlineElementNavigator.returnToOutlineElement(o),t.trackContext(n),this.get_outlineElementEditor().merge(o,r,!1,!1))},e.prototype.prepareEmptyParagraphNodeForDelete=function(e){},e._oulineElementEditor=null,e}();(0,o.l)(Xk,"DeleteParagraphNodeStrategy",null,[Jk]);var Yk=(0,o.y)("IDeleteTableStrategy"),Zk=function(){function e(){}return e.prototype.deleteAtTable=function(t,n,r,i,o,a,s){return t?(e.ensureGraphSafeForDeleteIntoTable(r,i,n),Vk.g.deleteIntoTable(r,i,o),!0):e.backspaceIntoTable(r,i,o)},e.get_indentationEditor=function(){return yc.z.get_getOutlineElementIndentationEditor()},e.get_outlineElementEditor=function(){return e._oulineElementEditor||(e._oulineElementEditor=se.w.get_instance().resolve(Es.p))},e.ensureGraphSafeForDeleteIntoTable=function(t,n,r){if(r.hasAncestor(t.get_currentNode())){var i=new Em(n),o=new Em(r);e.get_indentationEditor().demote(t,Ls.OutlineElementReader.getAbsoluteOutlineLevel(r)-Ls.OutlineElementReader.getAbsoluteOutlineLevel(t),0),i.restore(n),o.restore(r)}},e.backspaceIntoTable=function(t,n,r){ld.moveToLastRow(n),ld.moveToLastColumn(n),Sc.moveToLastOutlineElement(n),hs.OutlineElementNavigator.moveToContent(n);var i=cs.ParagraphReader.canContainIpOrTextRange(n.get_currentNode());return hs.OutlineElementNavigator.returnToOutlineElement(n),i?(e.get_outlineElementEditor().merge(n,t,!1,!1),!0):(ld.returnToCell(n),n.addChild(t.get_currentNode(),t.get_role()),t.disconnectNodeAndReturnToParent(),r.get_anchor().invalidateViewChannelForAllViews(9),!1)},e._oulineElementEditor=null,e}();(0,o.l)(Zk,"DeleteTableStrategy",null,[Yk]);var eD=n(6447),tD=function(e){function t(){var t=e.call(this)||this;return t._deleteParagraphNodeStrategy=null,t._deleteTableStrategy=null,t._deleteTableStrategy=new Zk,t._deleteParagraphNodeStrategy=new Xk,t}return(0,S.t)(t,e),t.prototype.get_deleteTableStrategy=function(){return this._deleteTableStrategy},t.prototype.get_deleteParagraphNodeStrategy=function(){return this._deleteParagraphNodeStrategy},t.prototype.shouldDispatchNoSpecialize=function(e){return Pa.SelectionEditor.isTextRangeContext(e)||ka.ImageReader.isImageContext(e)||af.EmbeddedFileReader.isEmbeddedFileContext(e)||kC.isIFrameContext(e)||t.get_unsupportedNodeEditor$1().isUnsupportedContext(e)||eD.r.isBlockInkContext(e)},t.prototype.getDefaultShouldDeleteTableSegments=function(e,t){return!0},t.prototype.getAdjacentIp=function(e,t,n){return Pa.SelectionEditor.findNextOrPreviousIp(t,!0,!n,!1,!1,!0)},t.prototype.handleOutlineElementWithNoteTags=function(e,t,n,r,i,o){return!(!PT.b.isOutlineElementWithNoteTags(t)||(o.val=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,eb.Ms,2,!1,r,i),e))},t.prototype.deleteFromIpAtStartOrEnd=function(e,t,n,r,i,o,a,s,l,c,u,g,d){var h=!1,_=2,m=cs.ParagraphReader.isEmpty(g),f=g.get_currentNode();hs.OutlineElementNavigator.returnToOutlineElement(g),this.handleListOutlineElement(i,g,c,(0,p.m)((function(){return _}),(function(e){return _=e})))||this.handleOutlineElementWithNoteTags(i,g,e,t,n,(0,p.m)((function(){return _}),(function(e){return _=e})))||this.handlePromoteOnBackspace(i,g,e,t,n,(0,p.m)((function(){return _}),(function(e){return _=e})))||this.handleAdjacentOutlineElement(i,g,s,u,r,m,f,d,l,(0,p.m)((function(){return _}),(function(e){return _=e})),(0,p.m)((function(){return h}),(function(e){return h=e})))||this.handleTableStructureModificationOnDelete(i,g,s,r,l,c,f,(0,p.m)((function(){return _}),(function(e){return _=e})))||this.handleIsFirstOrLastOutlineElementInOutline(i,g,t,n,s,a,(0,p.m)((function(){return _}),(function(e){return _=e})),(0,p.m)((function(){return h}),(function(e){return h=e}))),Qk.normalizeOrCancel(s,32===_),h&&Qk.restoreSelection(l,o)},t.get_unsupportedNodeEditor$1=function(){return wf.q.get_instance()},t}(Qk);(0,o.l)(tD,"DeleteViewStrategy",Qk,[]);var nD=function(e){function t(){var t=e.call(this)||this;return t._deleteViewStrategy=null,t._deleteParagraphContentStrategy=null,t._deleteViewStrategy=new tD,t._deleteParagraphContentStrategy=new qk,t}return(0,S.t)(t,e),t.prototype.get_deleteViewStrategy=function(){return this._deleteViewStrategy},t.prototype.get_deleteParagraphContentStrategy=function(){return this._deleteParagraphContentStrategy},t.prototype.registerAppSpecificActions=function(t,n,r,i){var o=Wk;t.addAction(ii.WJ,cl.H,o),t.addAction(ii.WJ,cl.I,o),t.addAction(ii.WJ,cl.K,o),t.addAction(ii.WJ,cl.g,o),t.addAction(ii.WJ,cl.m,o),t.addAction(ii.WJ,cl.X,r),t.addAction(ii.WJ,cl.c,r),t.addAction(ii.WJ,cl.s,r),t.addAction(ii.WJ,cl.e,r),t.addAction(ii.WJ,cl.k,o),t.addActionWithFlags(ii.Uc,nt.a,Vk.g.backspaceKeyHandler,96),t.addAction(ii.Dx,cl.H,o),t.addAction(ii.Dx,cl.I,o),t.addAction(ii.Dx,cl.K,o),t.addAction(ii.Dx,cl.g,o),t.addAction(ii.Dx,cl.m,o),t.addAction(ii.Dx,cl.X,r),t.addAction(ii.Dx,cl.c,r),t.addAction(ii.Dx,cl.s,r),t.addAction(ii.Dx,cl.e,r),t.addAction(ii.Dx,cl.k,o),t.addAction(ii.Od,cl.H,o),t.addAction(ii.Od,cl.I,o),t.addAction(ii.Od,cl.K,o),t.addAction(ii.Od,cl.g,o),t.addAction(ii.Od,cl.m,o),t.setActionFlags(ii.Od,64),e.prototype.registerAppSpecificActions.call(this,t,n,r,i)},t.get_instance=function(){return t._instance||(t._instance=new t)},t._instance=null,t}(Vk.g);(0,o.l)(nD,"DeleteActor",Vk.g,[]);var rD=function(){function e(e,t){this._outlineElementReader=null,this._titleReader=null,this._outlineElementReader=e,this._titleReader=t}return e.prototype.isParentOfDeletedOutlineElements=function(e){return 10===e.get_currentNodeType()||16===e.get_currentNodeType()},e.prototype.canDeleteWithoutMerge=function(e){return this._outlineElementReader.isOutlineElement(e)&&this._outlineElementReader.isEmpty(e,!0)&&!this._titleReader.isInTitle(e)},e.prototype.shouldKeepOutlineElementAfterDelete=function(e,t){return this._outlineElementReader.isLastOutlineElementInOutline(e)},e.prototype.shouldFollowFirstSelectedOEAfterDelete=function(e,t){return!1},e}();(0,o.l)(rD,"DeleteOutlineElementNodeStrategy",null,[If.j]);var iD=function(){function e(){}return e.prototype.findPageInActiveSection=function(e){var t=Dt.h.createFromString(e);return L.AFrameworkApplication.get_activeFrame().workspace.get_activeSection().getChildGraphSpaceNodeForObjectSpace(t)},e.prototype.findGraphSpaceNode=function(e,t){for(var n=this.setUpTraverser(t);n.moveNext();){var r=(0,f.e)(Kr.n,n.get_currentNode());if(!r)return null;if(131120===t?r.get_hasPageMetadata()&&r.get_objectSpaceId().toString()===e:r.get_hasSectionMetadata()&&r.get_oneNoteLocalSectionId()===e)return r}return null},e.prototype.setUpTraverser=function(e){var t=131121===e||131122===e?Br.App.theNotebookManager.get_defaultNotebookNode():Br.App.theNotebookManager.get_notebookNode(),n=vf.z.createTraverser(t);return n.setFilter(o.i(this,this.graphSpaceNodeFilter,"graphSpaceNodeFilter"),null),n},e.prototype.graphSpaceNodeFilter=function(e,t){return e.get_currentNode().get_isGraphSpace()},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,o.l)(iD,"GraphHelper",null,[]);var oD=function(){function e(){}return e.prototype.clickedPage=function(e){var t=e,n=iD.get_instance().findPageInActiveSection(t.PageId);return n},e.prototype.clickedSection=function(e){var t=e,n=iD.get_instance().findGraphSpaceNode(t.SectionId,131121);return n},e.prototype.getColorFromActionData=function(e){var t=e.SectionBGRColor;return Xy.o.notebookBGRValueToColor[t.toString()]},e}();(0,o.l)(oD,"OreoContextMenuDataProvider",null,[WP]);var aD=function(){function e(t){e._contextMenuDataProvider=t}return e.prototype.isMultiplePages=function(t,n){void 0===n&&(n="PageId");var r=t;return o.r(oD,e._contextMenuDataProvider)&&!!r&&n in r&&r[n].indexOf(",")>0},e.prototype.getMultiplePagesAsActionData=function(e,t){void 0===t&&(t="PageId");for(var n=e[t].split(","),r=new y.c(Object),i=0,o=n;i<o.length;i++){var a=o[i],s={};s[t]=a,r.add(s)}return r},e.prototype.getMultiplePagesAsList=function(e,t){void 0===t&&(t="PageId");for(var n=new y.c(Kr.n),r=0,i=e[t].split(",");r<i.length;r++){var o=i[r],a=iD.get_instance().findPageInActiveSection(o);n.add(a)}return n},e.get_instance=function(){return e._instance||(e._instance=e.getInstanceWithResolvedDependencies())},e.getInstanceWithResolvedDependencies=function(){return new e(e.get_contextMenuDataProvider())},e.get_contextMenuDataProvider=function(){return e._contextMenuDataProvider||(e._contextMenuDataProvider=se.w.get_instance().resolve(WP))},e._contextMenuDataProvider=null,e._instance=null,e}();(0,o.l)(aD,"MultiPageHelper",null,[]);var sD,lD=function(){function e(){this._pageEditor=null,this._sectionEditor=null,this._folderEditor=null,this._contextMenuDataProvider=null}return e.prototype.get_pageEditor=function(){return this._pageEditor||(this._pageEditor=se.w.get_instance().resolve(eA.f))},e.prototype.get_sectionEditor=function(){return this._sectionEditor||(this._sectionEditor=se.w.get_instance().resolve(CT.f))},e.prototype.get_folderEditor=function(){return this._folderEditor||(this._folderEditor=se.w.get_instance().tryResolve($T.x))},e.prototype.get_contextMenuDataProvider=function(){return this._contextMenuDataProvider||(this._contextMenuDataProvider=se.w.get_instance().resolve(WP))},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager();e.addAction(eb.dm,cl.n,o.i(this,this.movePageInSection,"movePageInSection")),e.addAction(eb.am,cl.n,o.i(this,this.moveSectionInFolder,"moveSectionInFolder")),e.addAction(eb.Bc,cl.n,o.i(this,this.movePageToSection,"movePageToSection"))},e.prototype.movePageInSection=function(e,t,n,r,i){var o=i;if(aD.get_instance().isMultiplePages(i,"DragPageId")){for(var a=aD.get_instance().getMultiplePagesAsActionData(i,"DragPageId"),s=o.DropPageId,l=a.$$lge();l.$$mn();){var c=l.$$cu();c.DropPageId=s,this.movePageInSection(e,t,n,r,c),s=c.DragPageId}return 32}var u=iD.get_instance().findGraphSpaceNode(o.DragPageId,131120),g=iD.get_instance().findGraphSpaceNode(o.DropPageId,131120),p=u.getParentGraphSpace();return this.get_pageEditor().move(u,p,g,!1,!0),32},e.prototype.moveSectionInFolder=function(e,t,n,r,i){var o=i,a=iD.get_instance().findGraphSpaceNode(o.DragSectionId,131121),s=null,l=o.DropSectionId;return""!==l&&(s=iD.get_instance().findGraphSpaceNode(l,131121)),s=iD.get_instance().findGraphSpaceNode(o.DropSectionId,131121),this.get_folderEditor().moveSection(a,s),32},e.prototype.movePageToSection=function(e,t,n,r,i){var o=i;if(aD.get_instance().isMultiplePages(i,"DragPageId")){for(var a=aD.get_instance().getMultiplePagesAsActionData(i,"DragPageId"),s=o.DropSectionId,l=a.$$lge();l.$$mn();){var c=l.$$cu();c.DropSectionId=s,this.movePageToSection(e,t,n,r,c)}return 32}var u=iD.get_instance().findGraphSpaceNode(o.DragPageId,131120),g=iD.get_instance().findGraphSpaceNode(o.DropSectionId,131121);if(g)if(g.get_isContentPresent())this.get_pageEditor().move(u,g,null,!0,!0);else{var p=this.get_pageEditor().createDeferredPageMoveCallback(u,g,null,!0);this.get_sectionEditor().load(g,p,null,null)}return 32},e}();(0,o.l)(lD,"DragAndDropActor",null,[]),function(e){e[e.oneDrive=0]="oneDrive",e[e.local=1]="local"}(sD||(sD={})),(0,o.h)("FileInsertType",sD);var cD=function(){return function(){this.radioButtonDomElementId=null,this.imageCssClass=null,this.headerText=null,this.explanationText=null}}();(0,o.l)(cD,"InsertFileTypeRadioButtonData",null,[]);var uD=function(e){function t(n,r){var i=e.call(this)||this;return i._clickInputManager=null,i._keypressInputManager=null,i._oneDriveRadioElement=null,i._localRadioElement=null,i._oneDriveButtonData=null,i._localButtonData=null,i._hiddenInputElement=null,i._selectedInsertType=0,i._clickInputManager=n,i._keypressInputManager=r,i._oneDriveButtonData=(0,O.m)(new cD,{headerText:OneNoteIntl.OneNoteStrings.L_AttachAsOneDriveFile,explanationText:OneNoteIntl.OneNoteStrings.L_AttachAsOneDriveFileExplanation,imageCssClass:"one_FromOnlineServices_48x48x32",radioButtonDomElementId:"oneDriveFileInsert"}),i._localButtonData=(0,O.m)(new cD,{headerText:OneNoteIntl.OneNoteStrings.L_AttachACopy,explanationText:OneNoteIntl.OneNoteStrings.L_AttachACopyExplanation,imageCssClass:"one_Attachment_48x48x32",radioButtonDomElementId:"insertLocalFile"}),i.set_buttonsOption(0),i.set_dialogHtml(String.format('\r\n\t\t\t\t<div class="ChooseInsertFileTypeContainer" role="radiogroup" aria-labelledby="WACDialogTitleText">\r\n\t\t\t\t\t{0}{1}\r\n\t\t\t\t\t<input id="{2}" type="hidden"/>\r\n\t\t\t\t</div>',i.radioButtonHtml(i._oneDriveButtonData),i.radioButtonHtml(i._localButtonData),t.hiddenInputElementId)),i}return(0,S.t)(t,e),t.prototype.get_selectedInsertType=function(){return this._selectedInsertType},t.prototype.set_selectedInsertType=function(e){switch(this._selectedInsertType=e,this.updateHiddenControlValue(this._selectedInsertType),this._selectedInsertType){case 0:this.updateRadioButtonState(this._oneDriveRadioElement,!0),this.updateRadioButtonState(this._localRadioElement,!1);break;case 1:this.updateRadioButtonState(this._localRadioElement,!0),this.updateRadioButtonState(this._oneDriveRadioElement,!1)}return e},t.prototype.onInnerHtmlSet=function(){this._oneDriveRadioElement=document.getElementById(this._oneDriveButtonData.radioButtonDomElementId),this._localRadioElement=document.getElementById(this._localButtonData.radioButtonDomElementId),this._hiddenInputElement=document.getElementById(t.hiddenInputElementId)},t.prototype.attachDialogEvents=function(){var t=this;e.prototype.attachDialogEvents.call(this),this._clickInputManager.registerHandler(Le.d.click,this._oneDriveRadioElement,(function(e){return t.setSelectedInsertType(0),!0})),this._clickInputManager.registerHandler(Le.d.click,this._localRadioElement,(function(e){return t.setSelectedInsertType(1),!0})),this._keypressInputManager.registerHandler(Le.d.keyDown,this._oneDriveRadioElement,(function(e){return(e.innerEvent.keyCode===Sys.UI.Key.down||e.innerEvent.keyCode===Sys.UI.Key.up)&&(t.setSelectedInsertType(1),!0)})),this._keypressInputManager.registerHandler(Le.d.keyDown,this._localRadioElement,(function(e){return(e.innerEvent.keyCode===Sys.UI.Key.down||e.innerEvent.keyCode===Sys.UI.Key.up)&&(t.setSelectedInsertType(0),!0)})),this.set_selectedInsertType(0)},t.prototype.setSelectedInsertType=function(e){e!==this.get_selectedInsertType()&&(C.ULS.sendTraceTag(24261851,339,50,"User changed insert file type selection"),this.set_selectedInsertType(e))},t.prototype.updateRadioButtonState=function(e,t){e.setAttribute(Ot.t.ariaRoleAttribute,Ot.t.ariaRadioRole),e.setAttribute(Ot.t.ariaCheckedAttribute,t),e.tabIndex=t?0:-1,t&&e.focus(),e.children[0].className="radioContainer"+(t?" selected":"")},t.prototype.updateHiddenControlValue=function(e){this._hiddenInputElement.value=sD[e]},t.prototype.radioButtonHtml=function(e){return String.format('\r\n\t\t\t\t\t<div id="{0}" class="InsertFileTypeContainer">\r\n\t\t\t\t\t\t<div class="radioContainer">\r\n\t\t\t\t\t\t\t<div class="radioOuter">\r\n\t\t\t\t\t\t\t\t<div class="radioInner"></div>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class="InsertFileTypeIconOuterContainer">\r\n\t\t\t\t\t\t\t<div class="InsertFileTypeIconInnerContainer"> \r\n\t\t\t\t\t\t\t\t<div class="clip48x48"> \r\n\t\t\t\t\t\t\t\t\t<img class="{1}" role="presentation" src="{2}"> \r\n\t\t\t\t\t\t\t\t</div> \r\n\t\t\t\t\t\t\t</div> \r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div class="InsertFileTypeExplanationContainer">\r\n\t\t\t\t\t\t\t<span class="InsertFileTypeHeader">{3}</span>\r\n\t\t\t\t\t\t\t<br/>\r\n\t\t\t\t\t\t\t<span class="InsertFileTypeExplanation">{4}</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t',e.radioButtonDomElementId,e.imageCssClass,L.AFrameworkApplication.get_imageClusterPath(),e.headerText,e.explanationText)},t.hiddenInputElementId="selectedInsertType",t}(ri.o);(0,o.l)(uD,"EqualChoiceInsertFileTypeDialog",ri.o,[]);var gD=n(7720),pD=n(6649),dD=function(e){function t(t,n,r,i,o,a,s){return void 0===s&&(s=null),e.call(this,t,n,r,i,o,a,s,fI.w.onosFilePrintoutBaseRoute)||this}return(0,S.t)(t,e),t}(fI.w);(0,o.l)(dD,"OneNotePrintoutUploadFrame",fI.w,[]);var hD=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,OneNoteIntl.OneNoteStrings.L_InsertPrintoutPickerDialogBody,CommonUIStrings.l_FileUploadNoFileSpecified)},e.dialogHtmlFormat="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>",e}();(0,o.l)(hD,"InsertPrintoutDialogHtml",null,[]);var _D=function(e){function t(t,n){return e.call(this,t,n)||this}return(0,S.t)(t,e),t.prototype.get_titleText=function(){return OneNoteIntl.OneNoteStrings.L_InsertPrintoutPickerDialogHeader},t.prototype.get_dialogLayout=function(){return hD.get_dialogHtml()},t.prototype.setUpUploadFrame=function(e,t){return new dD(e,o.i(t,t.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(t,t.uploadResponseReceived,"uploadResponseReceived"),L.AFrameworkApplication.appSettingsManager,!0,null)},t}(pD.k);(0,o.l)(_D,"InsertPrintoutDialog",pD.k,[]);var mD=function(e){function t(t,n,r,i,o,a){var s=e.call(this,t,n,r,i,o,a)||this;return s._firstImagePlaceholderNode=null,s._containingOutlineNode=null,s._containingOutlineElementNode=null,s}return(0,S.t)(t,e),t.prototype.get_uploadMode=function(){return"InsertPrintout"},t.prototype.get_narrationText=function(){return OneNoteIntl.OneNoteStrings.L_FileAttachmentUploadingText},t.prototype.showDialog=function(){if(hI.j()||this.nativeFileOpenDialogIsEnabled&&G.y.get_isWebKit())this.dialogMode=!1,this.uploadFrame=new dD(document.body,o.i(this,this.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(this,this.uploadResponseReceived,"uploadResponseReceived"),this.get_appSettingsManager(),!1,null);else{this.dialogMode=!0;var e=new _D(this,this._fileEditor);this.uploadFrame=e.uploadFrame}},t.prototype.validateFileExtension=function(e){return!!this.isValidFileExtension(e)||(this._utils.showErrorDialog(OneNoteIntl.OneNoteStrings.L_InsertPrintoutUnsupportedDialogHeader,OneNoteIntl.OneNoteStrings.L_InsertPrintoutUnsupportedDialogBody),this.onUploadComplete(),!1)},t.prototype.isValidFileExtension=function(e){var t=this._utils.extractExtensionFromFilename(e);return"docx"===(t=t?Jn.l.toLower(t):null)||"pdf"===t?(C.ULS.sendTraceTag(18483163,339,50,"{0}:SupportedExtension:{1}",this.get_uploadMode(),t),!0):(C.ULS.sendTraceTag(18483164,339,50,"{0}:UnsupportedExtension",this.get_uploadMode()),!1)},t.prototype.insertPlaceholder=function(e){this.desiredRevisionId=ae.l.create();var t=this._fileEditor.insertPlaceholders(this.get_context(),null,this.desiredRevisionId,e);return this.fileNode=t.fileNode,this._firstImagePlaceholderNode=t.imageNode,this._containingOutlineElementNode=t.imageContainingOutlineElementNode,this._containingOutlineNode=t.imageContainingOutlineNode,!!this.fileNode&&!!this._firstImagePlaceholderNode},t.prototype.createUploadParametersDictionary=function(){var t=e.prototype.createUploadParametersDictionary.call(this);return t&&(t[Rh.h.isPrintout]="1",t[Rh.h.printoutImageNodeId]=this._firstImagePlaceholderNode.get_id().toString(),t[Rh.h.printoutImageContainingOutlineElementNodeId]=this._containingOutlineElementNode.get_id().toString(),t[Rh.h.printoutImageContainingOutlineNodeId]=this._containingOutlineNode.get_id().toString()),t},t.prototype.cleanUpAfterFailedPlaceholderUpload=function(){mI.r.setUploading(this.fileNode,!1),mI.r.setUploading(this._firstImagePlaceholderNode,!1)},t}(gD.f);(0,o.l)(mD,"InsertPrintoutUploader",gD.f,[]);var fD=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,OneNoteIntl.OneNoteStrings.l_EmbeddedFileAltTextDialogLabel)},e.dialogHtmlFormat="<div class='WACDialogRow' id='block2'> <label id='label2' class='WACDialogLabel' for='titleText' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <input type='text' id='titleText' class='WACAltTextInput' maxlength='500' autocomplete=\"off\"/> </div>",e}();(0,o.l)(fD,"EmbeddedFileAltTextDialogHtml",null,[]);var yD=function(e){function t(t){var n=e.call(this)||this;n._containingNode=null,n._containingNode=t.get_node(),n.set_dialogHtml(fD.get_dialogHtml());var r={titleText:af.EmbeddedFileReader.getEmbeddedFileAltText(n._containingNode)};n.initializeAndShow(CommonUIStrings.l_AlternativeTextDialogTitle,o.i(n,n.altTextDialogHandler,"altTextDialogHandler"),r);var i=document.getElementById("titleText");return i.focus(),i.select(),n}return(0,S.t)(t,e),t.prototype.altTextDialogHandler=function(e,t){if(1===e){this.hide();var n=new as.GraphTransaction(15);n.setFromNode(this._containingNode),this.setEmbeddedFileAltText(this._containingNode,t.titleText),n.dispose()}},t.prototype.setEmbeddedFileAltText=function(e,t){e.get_properties().setValue(qc.o.imageTitle,t)},t}(ri.o);(0,o.l)(yD,"EmbeddedFileAltTextDialog",ri.o,[]);var CD=function(){function e(e,t,n,r,i,o,a){this._clickInputManager=null,this._keyInputManager=null,this._actionManager=null,this._insertFileEditor=null,this._insertPrintoutEditor=null,this._utils=null,this._undoManager=null,this._clickInputManager=e,this._keyInputManager=t,this._actionManager=n,this._insertFileEditor=r,this._insertPrintoutEditor=i,this._utils=o,this._undoManager=a}return e.prototype.get_pageReader=function(){return Qc.PageReader.get_instance()},e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(eb.kn,cl.n,o.i(this,this.insertFileDialogView,"insertFileDialogView"),4),this._actionManager.addActionWithFlags(eb.Ou,cl.n,o.i(this,this.insertPrintoutDialogView,"insertPrintoutDialogView"),4),this._actionManager.addActionWithFlags(eb.cl,cl.n,o.i(this,this.insertFileDialogView,"insertFileDialogView"),4),this._actionManager.addActionWithFlags(eb.Xz,cl.I,o.i(this,this.editEmbeddedFileAltText,"editEmbeddedFileAltText"),4)},e.prototype.insertFileDialogView=function(e,t,n,r,i){var o=L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInsertOneDriveFileIsEnabled"),a=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("OneNoteInsertOneDriveFileTreatmentMode"),s=this.createShowInsertFileDialogAction(e,t,o,a);return s?this.showInsertDialogView(n,t,"InsertFile",s):2},e.prototype.createShowInsertFileDialogAction=function(e,t,n,r){var i=this;if(e===eb.cl||!n)return function(){new gD.f(t,Oe.y.get_instance(),L.AFrameworkApplication.appSettingsManager,i._utils,i._insertFileEditor,i._undoManager).showDialog()};if("EqualChoice"===r){var a={};return a[uD.hiddenInputElementId]="",function(){new uD(i._clickInputManager,i._keyInputManager).initializeAndShow(OneNoteIntl.OneNoteStrings.L_ChooseFileTypeDialogTitle,o.i(i,i.onFileTypeChosen,"onFileTypeChosen"),a)}}return null},e.prototype.onFileTypeChosen=function(e,t){if(1===e){var n=t[uD.hiddenInputElementId];"oneDrive"===n?(C.ULS.sendTraceTag(24261849,339,50,"Insert OneDrive file chosen"),this._actionManager.processAction(ii.qx,2)):"local"===n&&(C.ULS.sendTraceTag(24261850,339,50,"Insert local file chosen"),this._actionManager.processAction(eb.cl,2))}},e.prototype.insertPrintoutDialogView=function(e,t,n,r,i){var o=this;return this.showInsertDialogView(n,t,"InsertPrintout",(function(){new mD(t,Oe.y.get_instance(),L.AFrameworkApplication.appSettingsManager,o._utils,o._insertPrintoutEditor,o._undoManager).showDialog()}))},e.prototype.showInsertDialogView=function(e,t,n,r){return 1===e?this._insertFileEditor.canInsertFileInContext(t)?32:2:2===e?(C.ULS.sendTraceTag(18483139,339,50,"{0}:Click",n),L.AFrameworkApplication.limitedEdit?L.AFrameworkApplication.showRequiresSignInDialog():r(),32):2},e.prototype.editEmbeddedFileAltText=function(e,t,n,r,i){return 1===n?32:(this.showAltTextDialog(t),32)},e.prototype.showAltTextDialog=function(e){return new yD(e)},e}();(0,o.l)(CD,"EmbeddedFileActor",null,[]);var SD=function(){return function(){this.id=null,this.listId=null,this.listInfo=null,this.level=0}}();(0,o.l)(SD,"ListItemInfo",null,[]);var vD=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.get_bulletStyle1=function(){return WoncaIntl.WoncaStrings.L_BulletStyle1},t.prototype.get_bulletStyle2=function(){return WoncaIntl.WoncaStrings.L_BulletStyle2},t.prototype.get_bulletStyle3=function(){return WoncaIntl.WoncaStrings.L_BulletStyle3},t.prototype.getListItemInfo=function(e,t){var n=new Da.GraphIterator;n.setFrom(e),n.returnToParent();var r=n.get_currentNode().get_id();return(0,O.m)(new SD,{id:e.get_currentNode().get_id(),listId:r,listInfo:t,level:1})},t.prototype.tryCollapseNestedContent=function(e,t,n){var r=e.get_contentObject(),i=t.get_contentObject(),o=(0,O.m)(new SD,{id:i.id,listId:e.contentId,listInfo:i.listInfo,level:r.level+1});return n.val=new Ea,n.val.set_providerKey(this.get_key()),n.val.contentId=e.contentId,n.val.set_contentObject(o),!0},t}(Ck);(0,o.l)(vD,"HierarchicalListDetailsProvider",Ck,[]);var bD=n(8870),TD=n(7105),AD=function(e){function t(t){return e.call(this,t)||this}return(0,S.t)(t,e),t.prototype.setUpUploadFrame=function(e,t){return new bD.w(e,o.i(t,t.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(t,t.uploadResponseReceived,"uploadResponseReceived"),L.AFrameworkApplication.appSettingsManager,!0)},t}(TD.d);(0,o.l)(AD,"OneNoteInsertImageDialog",TD.d,[]);var ID=function(e){function t(t,n,r,i,a,s){var l=e.call(this,t,n,r,i,a,s,!1)||this;if(hI.j()||l.nativeFileOpenDialogIsEnabled&&G.y.get_isWebKit())l.dialogMode=!1,l.uploadFrame=new bD.w(document.body,o.i(l,l.onUploadFrameInitialized,"onUploadFrameInitialized"),o.i(l,l.uploadResponseReceived,"uploadResponseReceived"),l.get_appSettingsManager(),!1);else{l.dialogMode=!0;var c=new AD(l);l.uploadFrame=c.uploadFrame}return l}return(0,S.t)(t,e),t.prototype.submitForm=function(t){L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteContentSyncUploadAttachmentIsEnabled")&&Wr.App.get_instance().get_isContentSyncEnabled()?t.submitFormWithRequest():e.prototype.submitForm.call(this,t)},t}(NS.e);(0,o.l)(ID,"OneNoteImageUploader",NS.e,[]);var wD=n(6754),xD=n(9726),FD=function(e){function t(t,n,r,i,o){return e.call(this,t,n,r,i,o)||this}return(0,S.t)(t,e),t.prototype.arePictureActionsEnabled=function(t){return kC.isIFrameContext(t)||kC.isFloatingIFrameContext(t)?(yk.get_activityManager().recordEvent(wD.f.noApply,{Reason:xD.i.containsIFrame}),!1):e.prototype.arePictureActionsEnabled.call(this,t)},t.prototype.createPictureUploader=function(e,t){return new ID(e,Oe.y.get_instance(),L.AFrameworkApplication.appSettingsManager,t,this.get_undoManager(),this.get_actionManager())},t}(yk);(0,o.l)(FD,"ImageActor$0",yk,[]);var ED=function(){function e(){}return e.prototype.getCurrentPageUrl=function(){var e=Wx.get_pageClicked();return Wr.App.buildPageUrl(e)},e.prototype.getWebAppLink=function(e){return Wr.App.buildPageUrl(e)},e.prototype.getNativeAppLink=function(e){return Wr.App.buildClientUrl(e)},e}();(0,o.l)(ED,"Application",null,[QP]);var PD=function(){function e(){}return e.prototype.copyToClipboard=function(e){var t=document.createElement("textarea");t.innerText=e,document.body.appendChild(t),t.select();var n=window.document.execCommand("copy");return document.body.removeChild(t),n},e.prototype.copyHyperlinkToClipboard=function(e,t,n){var r=document.createElement("textarea"),i=OneNoteIntl.OneNoteStrings.L_HyperlinkWebViewText,o=String.format('<a href="{0}">{1}</a>&nbsp; (<a href="{2}&{3}">{4}</a>)',t,n,e,Yv.u.oneNotePreserveLink,i);return r.innerText=o,qo.n.addHandler(r,Le.d.copy,(function(t){var n=t.rawEvent;n.clipboardData?(n.clipboardData.setData("text/html",o),n.clipboardData.setData("text/plain",e)):window.clipboardData.setData("Text",e),n.preventDefault(),document.body.removeChild(r)})),document.body.appendChild(r),r.select(),window.document.execCommand("copy")},e}();(0,o.l)(PD,"Browser",null,[JP]);var kD=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,Box4Intl.Box4Strings.l_GetPageUrlTextPrompt)},e.dialogHtmlFormat="<div class='WACDialogRow' id='block1'> <label id='prompt' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='block1'> <div id='PageUrl' class='GetPageUrlDialog'></div> </div>",e}();(0,o.l)(kD,"GetPageUrlDialogHtml",null,[]);var DD=function(e){function t(t){var n=e.call(this)||this;return n._anchorPageUrl=null,n._pageUrl=null,n._pageUrlIFrame=null,n._pageUrl=t,n}return(0,S.t)(t,e),t.prototype.onInnerHtmlSet=function(){this._pageUrlIFrame=document.createElement("iframe"),this._pageUrlIFrame.className="ObjectInDialog CopyLinkToPageDialog",qo.n.addHandler(this._pageUrlIFrame,"load",o.i(this,this.onUrlFrameLoad,"onUrlFrameLoad")),document.getElementById("PageUrl").appendChild(this._pageUrlIFrame)},t.prototype.onUrlFrameLoad=function(e){L.AFrameworkApplication.get_isRtl()&&this._pageUrlIFrame.contentWindow.document.body.setAttribute("dir","rtl");var t=this._pageUrlIFrame.contentWindow.document.createElement("span");t.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName,t.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize,_i.s.setElementText(t,this._pageUrl),this._anchorPageUrl=this._pageUrlIFrame.contentWindow.document.createElement("a"),this._anchorPageUrl.href=this._pageUrl,this._anchorPageUrl.style.cursor="default",this._anchorPageUrl.style.textDecoration="none",this._anchorPageUrl.style.color="#3B3B3B",this._anchorPageUrl.tabIndex=-1,this._anchorPageUrl.appendChild(t),qo.n.addHandler(this._anchorPageUrl,"click",o.i(this,this.linkClickHandler,"linkClickHandler"));var n=this._pageUrlIFrame.contentWindow.document.createElement("div");n.style.wordWrap="break-word",n.style.wordBreak="break-all",n.appendChild(this._anchorPageUrl),this._pageUrlIFrame.contentWindow.document.body.appendChild(n),Br.App.get_activeAppFrame().get_theKeyInputManager().initializeForElement(this._pageUrlIFrame.contentWindow.document.body),G.y.get_isInternetExplorerNonEdge()?(qo.n.addHandler(this._pageUrlIFrame,"focus",o.i(this,this.onUrlFrameFocus,"onUrlFrameFocus")),qo.n.addHandler(this._pageUrlIFrame,"beforedeactivate",o.i(this,this.onUrlFrameLostFocus,"onUrlFrameLostFocus"))):(qo.n.addHandler(this._pageUrlIFrame.contentWindow,"focus",o.i(this,this.onUrlFrameFocus,"onUrlFrameFocus")),qo.n.addHandler(this._pageUrlIFrame.contentWindow,"blur",o.i(this,this.onUrlFrameLostFocus,"onUrlFrameLostFocus")))},t.prototype.onUrlFrameLostFocus=function(e){if(this._pageUrlIFrame.contentWindow)if(G.y.get_supportsDomL2Selection()){var t=this._pageUrlIFrame.contentWindow.getSelection();t&&t.removeAllRanges()}else this._pageUrlIFrame.contentWindow.document.execCommand("Unselect",!1,null)},t.prototype.onUrlFrameFocus=function(e){if(this._pageUrlIFrame.contentWindow)if(G.y.get_supportsDomL2Selection()){var t=this._pageUrlIFrame.contentWindow.getSelection();t&&(t.removeAllRanges(),t.selectAllChildren(this._pageUrlIFrame.contentWindow.document.body))}else this._pageUrlIFrame.contentWindow.document.execCommand("SelectAll",!1,null)},t.prototype.linkClickHandler=function(e){e.preventDefault(),e.stopPropagation()},t.prototype.getPageUrlDialogHandler=function(e,t){this.hide()},t.prototype.detachDialogEvents=function(){qo.n.removeHandler(this._anchorPageUrl,"click",o.i(this,this.linkClickHandler,"linkClickHandler")),this._pageUrlIFrame&&(qo.n.removeHandler(this._pageUrlIFrame,"load",o.i(this,this.onUrlFrameLoad,"onUrlFrameLoad")),G.y.get_isInternetExplorerNonEdge()?(qo.n.removeHandler(this._pageUrlIFrame,"focus",o.i(this,this.onUrlFrameFocus,"onUrlFrameFocus")),qo.n.removeHandler(this._pageUrlIFrame,"beforedeactivate",o.i(this,this.onUrlFrameLostFocus,"onUrlFrameLostFocus"))):(qo.n.removeHandler(this._pageUrlIFrame.contentWindow,"focus",o.i(this,this.onUrlFrameFocus,"onUrlFrameFocus")),qo.n.removeHandler(this._pageUrlIFrame.contentWindow,"blur",o.i(this,this.onUrlFrameLostFocus,"onUrlFrameLostFocus"))),this._pageUrlIFrame.contentWindow&&this._pageUrlIFrame.contentWindow.document&&this._pageUrlIFrame.contentWindow.document.body&&Br.App.get_activeAppFrame().get_theKeyInputManager().deinitializeForElement(this._pageUrlIFrame.contentWindow.document.body)),e.prototype.detachDialogEvents.call(this)},t.prototype.display=function(){this.set_dialogHtml(kD.get_dialogHtml()),this.set_buttonsOption(0),this.setButtonText(1,Box4Intl.Box4Strings.l_GetPageUrlCloseButton),this.showDialog(Box4Intl.Box4Strings.l_GetPageUrlTitle,o.i(this,this.getPageUrlDialogHandler,"getPageUrlDialogHandler")),this.setFocusOnElement(this._pageUrlIFrame)},t.get_pageReader=function(){return Qc.PageReader.get_instance()},t}(ri.o);(0,o.l)(DD,"GetPageUrlDialog",ri.o,[]);var MD=function(){function e(){}return e.prototype.displayPageUrlDialog=function(e){new DD(e).display()},e}();(0,o.l)(MD,"DialogService",null,[XP]);var RD=n(4947),LD=n(7260),ND=function(){function e(e,t,n){this.color=0,this.labelText=null,this.image32by32Class=null,this.color=e,this.labelText=t,this.image32by32Class=Lt.getImageClass("InkColorCircle_"+n+"_32x32x32")}return e.prototype.get_color=function(){return this.color},e.prototype.get_labelText=function(){return this.labelText},e.prototype.get_image32by32Class=function(){return this.image32by32Class},e.getShorthandInkColorInformation=function(t){return 3===lT.u.getModeForInkShorthandColor()?e._shorthandColorsForHighlighter[t]:e._shorthandColorsForPen[t]},e._shorthandColorsForPen=[new e(4210752,OneNoteIntl.OneNoteStrings.L_InkColor_Black,"Black"),new e(1266618,OneNoteIntl.OneNoteStrings.L_InkColor_Blue,"Blue"),new e(1473821,OneNoteIntl.OneNoteStrings.L_InkColor_DarkGreen,"Green"),new e(12986680,OneNoteIntl.OneNoteStrings.L_InkColor_Red,"Red")],e._shorthandColorsForHighlighter=[new e(16446240,OneNoteIntl.OneNoteStrings.L_InkColor_Yellow,"Yellow"),new e(16741286,OneNoteIntl.OneNoteStrings.L_InkColor_Pink,"Pink"),new e(4045055,OneNoteIntl.OneNoteStrings.L_InkColor_SkyBlue,"LightBlue"),new e(8847190,OneNoteIntl.OneNoteStrings.L_InkColor_LightGreen,"Lime")],e}();(0,o.l)(ND,"ShorthandColorInformation",null,[]);var BD=function(){return se.w.get_instance().resolve($b)},OD=function(e,t,n,r,i){return 32},UD=function(e,t,n,r,i){return 32},HD=function(e,t,n,r,i){if(1===n)return 32;var o=i,a=zD(o),s=lT.u.getCurrentInkThicknessIndex();return o[bo.u.On]=a===s,32},GD=function(e,t,n,r,i){if(1===n)return 32;var o=i;return L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?o.MenuItems=BD().buildInkThicknessProps():o.PopulationXML=BD().buildInkThicknessXml(),32},VD=function(e,t,n,r,i){if(1===n)return 32;if(2!==n)return 2;var o=(0,f.e)(Object,i);if(!o)return C.ULS.sendTraceTag(17897472,339,10,"ChangeInkThicknessHandler actionData was not a dictionary"),2;var a=zD(o);return C.ULS.sendTraceTag(17897473,339,50,"Changing ink thickness index to {0}",a),WD(a,t,n),32},WD=function(e,t,n){if(4===Wr.App.oneNoteInputMode||!Wr.App.oneNoteInputMode||1===Wr.App.oneNoteInputMode){var r=lT.u.getModeForInkShorthandColor();RD.o.handleEnterMode(t,n,r)}lT.u.setCurrentInkThicknessIndex(e),RD.o.updateCurrentDrawingAttributesInCanvas()},zD=function(e){var t=e.SourceControlId;if(!t||""===t)return C.ULS.sendTraceTag(17897474,339,10,"GetInkThicknessIndexFromActionData actionData dictionary contained empty or null controlId"),Number.NaN;var n=t.split("_");return parseInt(n[1])},KD=function(e,t,n,r,i){return jD(n,t,i)},qD=function(e,t,n,r,i){return $D(n,i)},jD=function(e,t,n){if(1===e)return 32;var r=zD(n),i=ND.getShorthandInkColorInformation(r);return JD(i.get_color(),t,e),C.ULS.sendTraceTag(17897440,339,50,"Switching to shorthand color: {0} in input mode {1}",r,Wr.App.oneNoteInputMode),32},$D=function(e,t){if(1===e)return 32;var n=t,r=zD(n),i=ND.getShorthandInkColorInformation(r);n[Di.e.Image32by32Class]=i.get_image32by32Class(),n[Di.e.LabelText]=i.get_labelText(),n[Ni.b.iconColor]="#"+LD.e(i.get_color());var o=lT.u.getCurrentInkColor()===i.get_color()&&(2===Wr.App.oneNoteInputMode||3===Wr.App.oneNoteInputMode);return n[Di.e.On]=o,32},QD=function(e,t,n,r,i){if(1===n)return 32;if(2!==n)return 2;var o=(0,f.e)(Object,i);if(!(o&&"Color"in o))return C.ULS.sendTraceTag(17897441,339,10,"ChangeInkColorHandler actionData was not a dictionary or did not contain Color"),2;var a=o.Color;if(!a||""===a)return C.ULS.sendTraceTag(17897442,339,10,"ChangeInkColorHandler actionData dictionary contained empty or null color"),2;C.ULS.sendTraceTag(17897443,339,50,"Changing ink color to {0} via color selector",a);var s=LD.k(a);return JD(s,t,n),32},JD=function(e,t,n){if(4===Wr.App.oneNoteInputMode||!Wr.App.oneNoteInputMode||1===Wr.App.oneNoteInputMode){var r=lT.u.getModeForInkShorthandColor();RD.o.handleEnterMode(t,n,r)}lT.u.setCurrentInkColor(e),RD.o.updateCurrentDrawingAttributesInCanvas()},XD=function(){function e(){}return e.prototype.clickedPage=function(e){return Wx.get_pageClicked()},e.prototype.clickedSection=function(e){return Wx.sectionClicked},e.prototype.getColorFromActionData=function(e){return e},e}();(0,o.l)(XD,"LegacyContextMenuDataProvider",null,[WP]);var YD=function(e,t,n,r,i){if(1!==n)return 2;if(t.get_contextId()!==nt.a)return 2;var o=t.frame;if(!o)return 16;switch(e){case ii.DU:return 1===o.get_mode()?32:8;case ii.vv:return 2===o.get_mode()?32:8;default:return 2}},ZD=function(e,t,n,r,i){if(t.get_contextId()!==nt.a)return 2;C.ULS.sendTraceTag(41263305,339,50,"OneNoteModeSwitchHandler mode {0}",e);var o=t.frame;switch(e){case ii.Tg:return 1===n?Br.App.get_activeAppFrame().workspace.isViewModeEnabled?32:8:o&&1===o.get_mode()?8:(L.AFrameworkApplication.get_theActionManager().processAction(eb.sz,2),o.switchToMode(1),tM(o.get_modeName()),o.updateCommandUI(),L.AFrameworkApplication.get_activeFrame().animateDocumentPanel(!0,!0),32);case ii.no:var a=Br.App.get_activeAppFrame().workspace.get_canSwitchToEditMode();return 1===n?a?32:8:!a||o&&2===o.get_mode()?8:(o.switchToMode(2),tM(o.get_modeName()),o.updateCommandUI(),Br.App.get_box4Bridge().get_commandUi().isRibbonMinimized((function(e){e||L.AFrameworkApplication.get_activeFrame().animateDocumentPanel(!1,!0)})),32);default:return 2}},eM=function(e,t,n,r,i){if(t.get_contextId()!==nt.a)return 2;var o=t.frame;return tM(o.get_modeName()),32},tM=function(e){var t={};t.mode=e,L.AFrameworkApplication.get_theActionManager().processActionWithData(eb.DL,2,t)},nM=n(9117),rM=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,Box4Intl.Box4Strings.l_EnterSectionName,Box4Intl.Box4Strings.l_BlankSectionNameAlert,Box4Intl.Box4Strings.l_SectionNameTooLongAlert,Box4Intl.Box4Strings.l_SectionNameInUseAlert,Box4Intl.Box4Strings.l_SectionNameInvalidCharactersAlert,Box4Intl.Box4Strings.l_ConsecutivePeriodsAlert,Box4Intl.Box4Strings.l_LeadingPeriodAlert,Box4Intl.Box4Strings.l_TrailingPeriodAlert,Box4Intl.Box4Strings.l_InvalidFileNameAlert)},e.dialogHtmlFormat="<div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='txtSectionName' >{0}</label> <input type='text' id='txtSectionName' class='WACDialogInput' autocomplete=\"off\"/> <div class='WACDialogError' id='blankSectionError' role='alert'>{1}</div> <div class='WACDialogError' id='nameTooLongError' role='alert'>{2}</div> <div class='WACDialogError' id='nameInUseError' role='alert'>{3}</div> <div class='WACDialogError' id='invalidCharactersError' role='alert'>{4}</div> <div class='WACDialogError' id='consecutivePeriodsError' role='alert'>{5}</div> <div class='WACDialogError' id='leadingPeriodError' role='alert'>{6}</div> <div class='WACDialogError' id='trailingPeriodError' role='alert'>{7}</div> <div class='WACDialogError' id='invalidFileNameError' role='alert'>{8}</div> </div>",e}();(0,o.l)(rM,"SectionNameEditDialogHtml",null,[]);var iM=function(e){function t(n,r,i,a){var s=e.call(this)||this;s._folderContentEditor=null,s._folderEditor=null,s._sectionEditor=null,s._sectionName="",s._creatingNewSection=!1,s._insertAfter=null,s._insertIn=null,s._textEntryBox=null,s._sectionName=n,s._creatingNewSection=a,s._insertAfter=r,s._insertIn=i,t._invalidFileNames||s.createInvalidFileNameList(),s.set_dialogHtml(rM.get_dialogHtml());var l={txtSectionName:n};return Nt.FocusManager.instance().get_currentScope()&&Nt.FocusManager.instance().get_currentScope().name===kg.u.fishbowlFocusId&&s.set_dismissFocusScope(Nt.FocusManager.instance().get_currentScope().name),a?s.initializeAndShow(Box4Intl.Box4Strings.l_NameSectionTitle,o.i(s,s.sectionNameDialogHandler,"sectionNameDialogHandler"),l):s.initializeAndShow(Box4Intl.Box4Strings.l_RenameSectionTitle,o.i(s,s.sectionNameDialogHandler,"sectionNameDialogHandler"),l),s._textEntryBox=document.getElementById("txtSectionName"),s._textEntryBox&&(s._keyInputManager.registerHandler(Le.d.keyPress,s._textEntryBox,o.i(s,s.onKeyEvent,"onKeyEvent")),s._keyInputManager.registerHandler(Le.d.keyUp,s._textEntryBox,o.i(s,s.onKeyEvent,"onKeyEvent")),s.setFocusOnElement(s._textEntryBox),s._textEntryBox.setAttribute("spellcheck","false")),s}return(0,S.t)(t,e),t.prototype.get_folderEditor=function(){return this._folderEditor||(this._folderEditor=se.w.get_instance().resolve($T.x))},t.prototype.get_folderContentEditor=function(){return this._folderContentEditor||(this._folderContentEditor=se.w.get_instance().resolve(QT.s))},t.prototype.get_sectionEditor=function(){return this._sectionEditor||(this._sectionEditor=se.w.get_instance().resolve(CT.f))},t.prototype.get_newName=function(){return this._sectionName},t.prototype.onKeyEvent=function(e){return e.innerEvent.keyCode===Je.v.vK_Enter&&(this._textEntryBox.value.length>0&&this.executeDismissButton(this.getButtonElement(1)),!0)},t.prototype.createInvalidFileNameList=function(){t._invalidFileNames=[],Array.add(t._invalidFileNames,"CON"),Array.add(t._invalidFileNames,"PRN"),Array.add(t._invalidFileNames,"AUX"),Array.add(t._invalidFileNames,"NUL"),Array.add(t._invalidFileNames,"COM"),Array.add(t._invalidFileNames,"COM1"),Array.add(t._invalidFileNames,"COM2"),Array.add(t._invalidFileNames,"COM3"),Array.add(t._invalidFileNames,"COM4"),Array.add(t._invalidFileNames,"COM5"),Array.add(t._invalidFileNames,"COM6"),Array.add(t._invalidFileNames,"COM7"),Array.add(t._invalidFileNames,"COM8"),Array.add(t._invalidFileNames,"COM9"),Array.add(t._invalidFileNames,"LPT"),Array.add(t._invalidFileNames,"LPT1"),Array.add(t._invalidFileNames,"LPT2"),Array.add(t._invalidFileNames,"LPT3"),Array.add(t._invalidFileNames,"LPT4"),Array.add(t._invalidFileNames,"LPT5"),Array.add(t._invalidFileNames,"LPT6"),Array.add(t._invalidFileNames,"LPT7"),Array.add(t._invalidFileNames,"LPT8"),Array.add(t._invalidFileNames,"LPT9")},t.prototype.sectionNameDialogHandler=function(e,t){if(0!==e)if(this._sectionName=t.txtSectionName.trim(),this._creatingNewSection){if(!this._sectionName)return;var n=Da.GraphIterator.createFromNode(this._insertIn);this.get_folderContentEditor().createSectionAfter(n,this._insertAfter,this._sectionName),nM.u.dispatchActionToOreoWithData(eb.LH,t)}else{if(!this._sectionName)return;var r=new as.GraphTransaction(7);r.setFromNode(this._insertAfter),this.get_sectionEditor().setTitleForRenameSection(this._insertAfter,this._sectionName),this.get_sectionEditor().setFileIdForSection(this._insertAfter),this._insertAfter.get_anchor().invalidateViewChannelForAllViews(4),r.dispose()}},t.prototype.validate=function(){var e=document.getElementById("txtSectionName");document.getElementById("blankSectionError").style.display="none",document.getElementById("nameTooLongError").style.display="none",document.getElementById("nameInUseError").style.display="none",document.getElementById("invalidCharactersError").style.display="none",document.getElementById("leadingPeriodError").style.display="none",document.getElementById("trailingPeriodError").style.display="none",document.getElementById("consecutivePeriodsError").style.display="none",document.getElementById("invalidFileNameError").style.display="none";var n=e.value.trim(),r=null;if(n&&""!==n){if(n.startsWith("."))r=document.getElementById("leadingPeriodError");else if(n.endsWith("."))r=document.getElementById("trailingPeriodError");else if(n.indexOf("..")>=0)r=document.getElementById("consecutivePeriodsError");else if(n.length>50)r=document.getElementById("nameTooLongError");else if(this.get_folderEditor().sectionNameInUse(n,this._insertIn)&&this._sectionName.toLowerCase()!==n.toLowerCase())r=document.getElementById("nameInUseError");else if(t._invalidFileNames&&Array.contains(t._invalidFileNames,n.toUpperCase()))r=document.getElementById("invalidFileNameError");else for(var i=0;i<'~#%&*{}|\\/:"<>?^'.length;++i)if(n.indexOf('~#%&*{}|\\/:"<>?^'.charAt(i))>=0){r=document.getElementById("invalidCharactersError");break}}else r=document.getElementById("blankSectionError");return!r||(r.style.display="inline-block",!1)},t.prototype.close=function(){this.hide()},t.prototype.hide=function(){e.prototype.hide.call(this),L.AFrameworkApplication.get_theActionManager().processActionAsync(null,eb.Sg,2,null,null)},t.prototype.dispose=function(){this._textEntryBox&&(this._keyInputManager.unregisterHandler(Le.d.keyPress,this._textEntryBox,o.i(this,this.onKeyEvent,"onKeyEvent")),this._keyInputManager.unregisterHandler(Le.d.keyUp,this._textEntryBox,o.i(this,this.onKeyEvent,"onKeyEvent")),this._textEntryBox=null),e.prototype.dispose.call(this)},t.show=function(e,n,r){var i="";r||(i=_T.k(e)),t.addDialogHiddenAction(),new t(i,e,n,r)},t.addDialogHiddenAction=function(){t._isDialogHiddenActionAdded||(L.AFrameworkApplication.get_theActionManager().addAction(eb.Sg,cl.n,Ze.ActionManager.doNothingButReportHandler),t._isDialogHiddenActionAdded=!0)},t._invalidFileNames=null,t._isDialogHiddenActionAdded=!1,t}(ri.o);(0,o.l)(iM,"SectionNameEditDialog",ri.o,[]);var oM=function(){function e(){}return e.get_pageEditor=function(){return e._pageEditor||(e._pageEditor=se.w.get_instance().resolve(eA.f))},e.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e.get_sectionContentEditor=function(){return e._sectionContentEditor||(e._sectionContentEditor=se.w.get_instance().resolve(YT.x))},e.get_folderContentEditor=function(){return e._folderContentEditor||(e._folderContentEditor=se.w.get_instance().resolve(QT.s))},e.get_folderEditor=function(){return e._folderEditor||(e._folderEditor=se.w.get_instance().resolve($T.x))},e.get_sectionNavPaneContextMenu=function(){return e._sectionNavPaneContextMenu||(e._sectionNavPaneContextMenu=se.w.get_instance().tryResolve(Px.c))},e.get_pageNavPaneContextMenu=function(){return e._pageNavPaneContextMenu||(e._pageNavPaneContextMenu=se.w.get_instance().tryResolve(Ex.w))},e.get_sectionEditor=function(){return e._sectionEditor||(e._sectionEditor=se.w.get_instance().resolve(CT.f))},e.get_contextMenuDataProvider=function(){return e._contextMenuDataProvider||(e._contextMenuDataProvider=se.w.get_instance().resolve(WP))},e.registerActions=function(){if(us.n.get_instance().get_item(18)){var t=L.AFrameworkApplication.get_theActionManager(),n=e.switchPage,r=e.movePage,i=e.moveSection,o=e.focusedSectionExpand,a=e.focusedSectionCollapse,s=e.focusedItemDelete,l=e.focusedSectionRename,c=e.focusedItemNextSection,u=e.focusedItemPreviousSection,g=e.focusedPageIncreaseIndent,p=e.focusedPageDecreaseIndent,d=e.shiftF10NavPane;t.addAction(ii.lz,cl.n,e.newPage),t.addAction(ii.pe,cl.W,e.newPageProtoButton),t.addAction(eb.Hv,cl.n,e.newPage),t.addAction(ii.NE,cl.n,e.newSection),t.addAction(eb.wg,cl.n,e.newSection),t.addAction(ii.Iy,cl.U,Ze.ActionManager.doNothingHandler),t.addActionWithFlags(ii.Qo,nt.a,n,64),t.addActionWithFlags(ii.Fs,nt.a,n,64),t.addActionWithFlags(ii.qt,nt.a,n,64),t.addActionWithFlags(ii.HE,nt.a,n,64),t.addActionWithFlags(ii.Tl,cl.n,n,64),t.addActionWithFlags(ii.Mv,cl.n,n,64),t.addActionWithFlags(ii.FR,cl.n,n,64),t.addActionWithFlags(ii.ck,cl.n,n,64),t.addActionWithFlags(ii.po,cl.n,r,68),t.addActionWithFlags(ii.tj,cl.n,r,68),t.addActionWithFlags(ii.ik,cl.n,i,68),t.addActionWithFlags(ii.mZ,cl.n,i,68),t.addAction(ii.xJ,nt.a,o),t.addAction(ii.lP,nt.a,a),t.addActionWithFlags(ii.PZ,nt.a,s,4),t.addActionWithFlags(ii.SA,nt.a,l,4),t.addAction(ii.Jg,nt.a,c),t.addAction(ii.oG,nt.a,u),t.addActionWithFlags(ii.Ek,nt.a,g,4),t.addActionWithFlags(ii.Wg,nt.a,p,4),t.addAction(ii.WW,nt.a,d),t.addAction(ii.pe,cl.n,Br.App.get_activeAppFrame().workspace.currentSectionActorHandler),t.addAction(ii.cm,cl.U,Ze.ActionManager.doNothingButReportHandler),t.addAction(ii.hQ,cl.U,Ze.ActionManager.doNothingButReportHandler),t.addAction(eb.gz,cl.n,e.refreshPageContent),Wr.App.get_isEmbedMessageEnabled()&&(e._embedMessageSender=new Wv(L.AFrameworkApplication.appSettingsManager.get_appSettings().OneNoteEmbedHostingApp,L.AFrameworkApplication.hostPostmessenger))}},e.registerShortcuts=function(){var t=Nt.FocusManager.instance(),n=t.getScope(kg.u.editingFocusID),r=t.getScope($e.AFrame.mainAppFocusId),i=t.getScope(kg.u.navigationFocusId);e.registerMainShortcuts(r),e.registerEditingShortcuts(n),e.sectionNavPaneFocusId=kg.u.navigationFocusId,e.pageNavPaneFocusId=kg.u.navigationFocusId,e.registerNavigationShortcuts(i)},e.registerMainShortcuts=function(e){us.n.get_instance().get_item(21)&&(e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_Home,5),ii.FR),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_End,5),ii.ck),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_PageUp,1),ii.Mv),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_PageDown,1),ii.Tl),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_PageUp,Xe.KeyInputManager.get_commandKeyModifier()),ii.Qo),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_PageUp,4|Xe.KeyInputManager.get_commandKeyModifier()),ii.Fs),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_PageDown,Xe.KeyInputManager.get_commandKeyModifier()),ii.qt),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_PageDown,4|Xe.KeyInputManager.get_commandKeyModifier()),ii.HE),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_UpArrow,5),ii.po),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_DownArrow,5),ii.tj))},e.registerEditingShortcuts=function(e){e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_UpArrow,5|Xe.KeyInputManager.get_commandKeyModifier()),ii.ik),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_DownArrow,5|Xe.KeyInputManager.get_commandKeyModifier()),ii.mZ)},e.registerNavigationShortcuts=function(e){e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_F10,4),ii.WW),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_F10,4|Xe.KeyInputManager.get_commandKeyModifier()),ii.WW),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_RightArrow,0),ii.xJ),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_LeftArrow,0),ii.lP),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_Backspace,0),te.xF),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_Delete,0),ii.PZ),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_R,Xe.KeyInputManager.get_commandKeyModifier()),ii.SA),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_Tab,Xe.KeyInputManager.get_commandKeyModifier()),ii.Jg),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_Tab,4|Xe.KeyInputManager.get_commandKeyModifier()),ii.oG),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_RightArrow,Xe.KeyInputManager.get_commandKeyModifier()),ii.Ek),e.bindAction(Xe.KeyInputManager.hashKey(Je.v.vK_LeftArrow,Xe.KeyInputManager.get_commandKeyModifier()),ii.Wg)},e.newPage=function(t,n,r,i,o){var a,s=Br.App.get_activeAppFrame().workspace;if(1===r)return!s.get_activeSection()||_T.Q(s.get_activeSection())?8:2===Br.App.get_activeAppFrame().get_mode()&&s.get_activeSection()&&s.get_contentView().get_isAttached()?32:8;var l=new as.GraphTransaction(7);if(l.setFromNode(s.get_navigationPaneView().get_targetNode()),!s.get_activeSection()||_T.Q(s.get_activeSection()))return 8;a=s.get_activeSection().getContentGraph();var c=new Da.GraphIterator;c.set(a);var u=null,g=(0,f.e)(Object,o);return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOreoOnboardingIsEnabled")&&g&&"PageTitle"in g&&(u=(u=g.PageTitle).trim()),s.set_activePage(e.get_sectionContentEditor().createPage(c,null,null,u)),l.dispose(),32},e.newPageProtoButton=function(t,n,r,i,o){if(2===r){var a=n.get_node();if(!a||_T.Q(a))return 8;a.ensureContentGraphConnection();var s=new Da.GraphIterator;s.set(a),qr.k(s);var l=new as.GraphTransaction(7);l.setFromIterator(s);var c=null,u=(0,f.e)(Object,o);L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOreoOnboardingIsEnabled")&&u&&"PageTitle"in u&&(c=(c=u.PageTitle).trim());var g=e.get_sectionContentEditor().createPage(s,null,null,c);return g&&Br.App.get_activeAppFrame().workspace.set_activePage(g),l.dispose(),e._embedMessageSender&&e.embeddedOneNoteNewPageCreated(a,g),32}return 8},e.newSection=function(t,n,r,i,o){if(1===r)return 2===Br.App.get_activeAppFrame().get_mode()&&Br.App.notebookMode&&Br.App.get_activeAppFrame().workspace.get_contentView().get_isAttached()?32:8;var a=null,s=null,l=(0,f.e)(Object,o);if(l&&"SectionId"in l)s=(a=e.get_contextMenuDataProvider().clickedSection(o)).getParentGraphSpace();else{var c=new Da.GraphIterator;for(c.set(Br.App.get_activeAppFrame().workspace.get_activeFolder()),s=c.get_currentNode(),a=c.goToLastChildByRole(79);a&&hT.FolderReader.isFolderNode(a);)a=c.goToPreviousSiblingByRole(79)}if(l&&"SectionName"in l){var u=l.SectionName;u=u.trim();var g=null;"PageTitle"in l&&(g=l.PageTitle);var p=Da.GraphIterator.createFromNode(s);e.get_folderContentEditor().createSectionAfter(p,a,u,!0,g)}else iM.show(a,s,!0);return 32},e.switchPage=function(t,n,r,i,o){if(!Br.App.get_activeAppFrame().workspace.get_activePage())return 32;var a,s=Br.App.get_activeAppFrame().workspace.get_activePage(),l=Br.App.get_activeAppFrame().workspace.get_activeSection(),c=l.getParentGraphSpace();if(t===ii.FR)a=ST.getFirstVisiblePageIfLoaded(c);else if(t===ii.ck)a=ST.getLastVisiblePageIfLoaded(c);else if(t===ii.Mv)a=_T.P(l);else if(t===ii.Tl)a=_T.L(l);else if(t===ii.Qo||t===ii.Fs)a=e.get_folderEditor().getPreviousPage(s,l);else{if(t!==ii.qt&&t!==ii.HE)return 8;a=e.get_folderEditor().getNextPage(s,l)}return a&&Br.App.get_activeAppFrame().workspace.set_activePage(a),32},e.movePage=function(t,n,r,i,o){var a=Br.App.get_activeAppFrame().workspace.get_activePage();if(!a)return 32;var s=t===ii.tj;return e.get_pageEditor().moveGivenPage(a,s),32},e.moveSection=function(t,n,r,i,o){var a=Br.App.get_activeAppFrame().workspace.get_activeSection();return a?(e.get_sectionEditor().moveGivenSection(a,t===ii.mZ),32):32},e.shiftF10NavPane=function(t,n,r,i,o){if(2===Br.App.get_activeAppFrame().get_mode()){var a=e.performActionOnFocusedPage((function(t){var n=t.get_sourceNode(),r=Sys.UI.DomElement.getBounds(t.get_label()),i=new Sys.UI.Point(r.x,r.y+r.height);return e.get_pageNavPaneContextMenu()&&e.get_pageNavPaneContextMenu().showAt(i,n,1),!0}));if(32===a)return a;e.performActionOnFocusedSection((function(t){var n=t.get_sourceNode(),r=Sys.UI.DomElement.getBounds(t.get_label()),i=new Sys.UI.Point(r.x,r.y+r.height);return e.get_sectionNavPaneContextMenu()&&e.get_sectionNavPaneContextMenu().showAt(i,n,1),!0}))}return 32},e.focusedItemDelete=function(t,n,r,i,o){var a=e.performActionOnFocusedPage((function(t){return e.get_pageEditor().showDeletePageDialog(t.get_sourceNode()),!0}));return 32===a?a:e.performActionOnFocusedSection((function(t){var n=t.get_sourceNode();return!(!n.get_isContentPresent()||_T.d(n)&&!_T.p(n))&&(e.get_sectionEditor().showDeleteSectionDialog(n),!0)}))},e.focusedSectionRename=function(t,n,r,i,o){return e.performActionOnFocusedSection((function(e){var t=e.get_sourceNode();if(!t.get_isContentPresent())return!1;var n=t.getParentGraphSpace();return iM.show(t,n,!1),!0}))},e.focusedSectionExpand=function(t,n,r,i,o){return e.performActionOnFocusedSection((function(e){return e.setExpanded(!0),!0}))},e.focusedSectionCollapse=function(t,n,r,i,o){return e.performActionOnFocusedSection((function(e){return e.setExpanded(!1),!0}))},e.focusedPageIncreaseIndent=function(t,n,r,i,o){return e.performActionOnFocusedPage((function(t){return e.get_pageEditor().increaseIndent(t.get_sourceNode(),2),!0}))},e.focusedPageDecreaseIndent=function(t,n,r,i,o){return e.performActionOnFocusedPage((function(t){return e.get_pageEditor().decreaseIndent(t.get_sourceNode(),2),!0}))},e.focusedItemNextSection=function(t,n,r,i,o){var a=e.performActionOnFocusedSection((function(t){var n=ay.getNextSection(t.get_sourceNode());return e.updateFocusedElement(n),!0}));return 32===a?a:e.performActionOnFocusedPage((function(t){var n=ay.getNextSection(e.get_pageNavigator().getContainingSection(t.get_sourceNode()));return e.updateFocusedElement(n),!0}))},e.focusedItemPreviousSection=function(t,n,r,i,o){var a=e.performActionOnFocusedSection((function(t){var n=ay.getPreviousSection(t.get_sourceNode());return e.updateFocusedElement(n),!0}));return 32===a?a:e.performActionOnFocusedPage((function(t){var n=e.get_pageNavigator().getContainingSection(t.get_sourceNode());return e.updateFocusedElement(n),!0}))},e.performActionOnFocusedSection=function(t){if(Nt.FocusManager.usable()){if(Nt.FocusManager.instance().getCurrentRegion()!==Nt.FocusManager.instance().getRegion(e.sectionNavPaneFocusId))return 8;var n=Nt.FocusManager.instance().getRegion(e.sectionNavPaneFocusId).listing.get_currentElement();if(!n)return 8;var r=e.getSectionViewIfSection(n);if(r&&t(r))return 32}return 8},e.performActionOnFocusedPage=function(t){if(Nt.FocusManager.usable()){if(Nt.FocusManager.instance().getCurrentRegion()!==Nt.FocusManager.instance().getRegion(e.pageNavPaneFocusId))return 8;var n=Nt.FocusManager.instance().getRegion(e.pageNavPaneFocusId).listing.get_currentElement();if(!n)return 8;var r=e.getPageViewIfPage(n);if(r&&t(r))return 32}return 8},e.getLinkElement=function(t){var n=null,r=null;for(t&&(r=t.firstChild);r&&!n;)n=1===_i.s.getTag(r)?r:e.getLinkElement(r),r=r.nextSibling;return n},e.getSectionViewIfSection=function(t){if(!t)return null;var n=e.focusedView(t);if(n&&_T.d(n.get_sourceNode())){var r=n;if(e.getLinkElement(r.get_protoButton())!==t)return r}return null},e.getPageViewIfPage=function(t){if(!t)return null;var n=e.focusedView(t);return n&&e.get_pageReader().isPageNode(n.get_sourceNode())?n:null},e.focusedView=function(t){var n=ms.x(t);return n||(t.parentNode?e.focusedView(t.parentNode):null)},e.updateFocusedElement=function(t){if(t){var n=new De.c(2,1,0,(function(n){var r=Br.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId(),i=e.getLinkElement(t.getHtmlViewElement(r).get_htmlElement());Nt.FocusManager.instance().getRegion(e.sectionNavPaneFocusId).listing.forceSetCurrentElement(i)}));L.AFrameworkApplication.get_theTaskManager().addTask(n)}},e.embeddedOneNoteNewPageCreated=function(t,n){if(!t||!n)return C.ULS.sendTraceTag(17691993,339,50,"New Page Node is Null"),!1;var r=_T.k(t).toLocaleLowerCase(),i=e.get_pageReader().getNotebookManagementEntityId(n).toString().toLowerCase();return e._embedMessageSender.sendNewPageMesssageToHostApp(r,i),!0},e.refreshPageContent=function(e,t,n,r,i){if(1===n)return 32;if(2===n){var o=Br.App.get_activeAppFrame().workspace.get_contentView();return o&&o.get_isPageView()&&o.onResize(),32}return 8},e.sectionNavPaneFocusId=null,e.pageNavPaneFocusId=null,e._folderContentEditor=null,e._folderEditor=null,e._pageEditor=null,e._sectionContentEditor=null,e._sectionEditor=null,e._contextMenuDataProvider=null,e._embedMessageSender=null,e._sectionNavPaneContextMenu=null,e._pageNavPaneContextMenu=null,e}();(0,o.l)(oM,"NavigationPaneActor",null,[]);var aM=function(e){function t(){var t=e.call(this)||this;return t.FileId=null,t.PageId=null,t.CellId=null,t.Operation=null,t}return(0,S.t)(t,e),t.prototype.getClassId=function(){return 58},t.construct=function(e,n,r,i){var o=new t;return o.FileId=n,o.PageId=e,o.CellId=Wb.w(r),o.Operation=i,o},t}(Ph.z);(0,o.l)(aM,"PageEventNotificationRequest",Ph.z,[]);var sM=function(){function e(){}return e.prototype.registerActions=function(e){e.addActionWithFlags(eb.hF,cl.n,o.i(this,this.onPageDeactivated,"onPageDeactivated"),64),e.addActionWithFlags(eb.KR,cl.n,o.i(this,this.onPageDeleted,"onPageDeleted"),64)},e.prototype.onPageDeactivated=function(e,t,n,r,i){var o=this.getRequest("navigation");if(!o)return 8;var a=Eb.y(o);return this.sendRequest(this.getHeaders(),a,o),32},e.prototype.onPageDeleted=function(e,t,n,r,i){var o=this.getRequest("delete");if(!o)return 8;var a=Eb.y(o);return this.sendRequest(this.getHeaders(),a,o),32},e.prototype.sendRequest=function(e,t,n){L.AFrameworkApplication.theClientRequestManager.addRequest(Br.App.webServiceBase+"OneNote.ashx",2,t,e,!1,2,o.i(this,this.requestSucceeded,"requestSucceeded"),o.i(this,this.onFailure,"onFailure"),n)},e.prototype.getRequest=function(e){var t=Br.App.get_activeAppFrame().workspace;if(!(t&&t.get_activePage()&&t.get_activePage().get_contentReplicator()&&t.get_activePage().get_contentReplicator().get_node()))return null;var n=Qc.PageReader.get_instance().getNotebookManagementEntityId(t.get_activePage().get_contentReplicator().get_node()).toString();return n?aM.construct(n,Br.App.get_activeAppFrame().workspace.get_activePage().get_fileQuerySignature(),Br.App.get_activeAppFrame().workspace.get_activePage().get_objectSpaceId(),e):null},e.prototype.getHeaders=function(){var e={"Content-Type":"application/json; charset=utf-8"};return e},e.prototype.requestSucceeded=function(e){},e.prototype.onFailure=function(e){},e}();(0,o.l)(sM,"NavigationEventsActor",null,[]);var lM=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.newPageProtoButton=function(e){e?this.get_actionManager().processActionAgainstContext(e,ii.pe,2,!1,null,null):this.get_actionManager().processAction(ii.pe,2)},e.prototype.newSection=function(){this.get_actionManager().processAction(ii.NE,2)},e}();(0,o.l)(lM,"NavigationPaneCommands",null,[GP.k]);var cM=n(310),uM=n(8424),gM=n(4113),pM=n(9821),dM=n(8374),hM=function(){function e(){}return e.get_noteTagContextMenu=function(){return e._noteTagContextMenu||(e._noteTagContextMenu=se.w.get_instance().tryResolve(xx.v))},e.get_noteTagEditor=function(){return kT.n.get_instance()},e.get_contextSetEditor=function(){return kf.ContextSetEditor.get_instance()},e.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(eb.Bw,cl.n,e.noteTagsFlyoutEnabled),t.setActionFlags(eb.Bw,100),t.addAction(eb.vw,cl.z,e.toggleNoteTag),t.addAction(eb.vw,cl.X,e.toggleNoteTag),t.addAction(eb.vw,cl.s,e.toggleNoteTag),t.addAction(eb.vw,cl.c,e.toggleNoteTag),t.addAction(eb.vw,cl.n,e.addRemoveNoteTagViewHandler),t.setActionFlags(eb.vw,12),t.addAction(eb.Ms,cl.z,e.removeNoteTags),t.addAction(eb.Ms,cl.X,e.removeNoteTags),t.addAction(eb.Ms,cl.s,e.removeNoteTags),t.addAction(eb.Ms,cl.c,e.removeNoteTags),t.addAction(eb.Ms,cl.n,e.addRemoveNoteTagViewHandler),t.setActionFlags(eb.Ms,4),t.addAction(eb.nB,cl.n,e.removeNoteTag),t.addAction(eb.nB,cl.Y,e.removeNoteTag),t.setActionFlags(eb.nB,4),t.addAction(eb.DQ,cl.n,e.markNoteTag),t.addAction(eb.DQ,cl.Y,e.markNoteTag),t.setActionFlags(eb.DQ,68)},e.noteTagsFlyoutEnabled=function(e,t,n,r,i){return 1===n?L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(t,eb.vw,n,!0,r,i):32},e.addRemoveNoteTagViewHandler=function(t,n,r,i,o){if(i.dataValue1=42,i.dataValue2=0,!n.view.get_isPageView())return 8;var a=n.view.get_selectionManager();if(!a)return 8;var s=a.get_selectionContextForActionDispatch();if(!s)return 8;var l=e.get_contextSetEditor().getOutlineElementsAndFloatingObjects(s);if(!l)return 8;var c=null;1!==r&&(c=new as.GraphTransaction(15)).setFromNode(n.view.get_targetNode());var u=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(l,t,r,!1,i,o);return c&&c.dispose(),u},e.toggleNoteTag=function(t,n,r,i,o){var a=n,s=new Da.GraphIterator;if(s.set(a.get_node()),Ls.OutlineElementReader.isOutlineElement(s)&&hs.OutlineElementNavigator.moveToContent(s),1===r)return 32;var l=pM.k.create(uM.t.noteTagActor,cM.m.insertNoteTag,!0);if(gM.ReportData.isLoggingEnabled()&&l.start(),!PT.b.supportsNoteTags(s.get_currentNode()))return gM.ReportData.isLoggingEnabled()&&l.fail("CurrentNodeDoesNotSupportNoteTags"),8;if("string"==typeof o&&!(o=e.parseAutomationNoteTagInput(o)))return gM.ReportData.isLoggingEnabled()&&l.fail("ActionDataIsEmpty"),8;var c,u,g=o,d=g.getValueWithDefault(String,zl.k.controlId,null),h=-1;if(d&&(h=parseInt(d.substring(2,d.length)),gM.ReportData.isLoggingEnabled()&&l.addToPayload("NoteTagType",h)),h<0||h>28)return gM.ReportData.isLoggingEnabled()&&l.fail("UnknownNoteTagType","apm3e"),8;DT.b(h,(0,p.m)((function(){return u}),(function(e){return u=e})),(0,p.m)((function(){return c}),(function(e){return c=e}))),gM.ReportData.isLoggingEnabled()&&(l.addToPayload("NoteTagShape",u),l.addToPayload("NoteTagLabel",c));var _=!1,m=new as.GraphTransaction(15);m.setFromNode(s.get_currentNode());var f=g.getValueWithDefault(Number,zl.k.noteTagToggleState,0);if(ET.u(s)&&(DT.g(s,h)||c&&DT.m(s,u,c))){var y=DT.i(s.get_currentNode()),C=DT.l(s.get_currentNode()),S=DT.c(s.get_currentNode());if(c&&h===y&&C!==c&&S!==u)ET.t(s),f=0;else{_=!0;var v=DT.d(s.get_currentNode());switch(f||(f=!v&&DT.q(s.get_currentNode())?2:3),f){case 1:v&&e.get_noteTagEditor().toggleNoteTagMark(s.get_currentNode());break;case 2:v||e.get_noteTagEditor().toggleNoteTagMark(s.get_currentNode());break;case 3:ET.t(s)}}}return _||(f||(f=1),3!==f&&(PT.b.isNoteTagContainer(s)&&ET.g(s),e.get_noteTagEditor().insertDefaultNoteTag(s,h),2===f&&e.get_noteTagEditor().toggleNoteTagMark(s.get_currentNode()))),g.setValue(zl.k.noteTagToggleState,f),m.dispose(),L.AFrameworkApplication.get_activeFrame().setFocusOnDocument(),i.dataValue1=h,i.dataValue2=f,gM.ReportData.isLoggingEnabled()&&l.stop(dM.t.success),32},e.parseAutomationNoteTagInput=function(e){if(null==e)return null;var t=e.split(",");if(2!==t.length)return null;var n=new Kl.DictionaryPropertySet;return n.setValue(zl.k.controlId,t[0]),n.setValue(zl.k.noteTagToggleState,parseInt(t[1])),n},e.removeNoteTags=function(e,t,n,r,i){var o=t,a=new Da.GraphIterator;if(a.set(o.get_node()),Ls.OutlineElementReader.isOutlineElement(a)&&hs.OutlineElementNavigator.moveToContent(a),!PT.b.hasNoteTags(a))return 8;if(1===n)return 32;var s=new as.GraphTransaction(15);return s.setFromNode(a.get_currentNode()),ET.e(a),s.dispose(),32},e.removeNoteTag=function(t,n,r,i,o){if(n.get_contextId()===cl.n)return e.handleViewLevelContextMenuAction(t,r,i,o);if(1===r)return 32;var a=n,s=new Da.GraphIterator;s.set(a.get_node());var l=new as.GraphTransaction(15);return l.setFromNode(s.get_currentNode()),s.tryToRootAtAncestorOfType(8)&&ET.t(s),l.dispose(),32},e.markNoteTag=function(t,n,r,i,o){if(n.get_contextId()===cl.n)return e.handleViewLevelContextMenuAction(t,r,i,o);var a=n;if(!DT.q(a.get_node()))return 2;if(1===r)return 32;var s=new Da.GraphIterator;s.set(a.get_node());var l=new as.GraphTransaction(15);return l.setFromNode(s.get_currentNode()),e.get_noteTagEditor().toggleNoteTagMark(s.get_currentNode()),l.dispose(),32},e.handleViewLevelContextMenuAction=function(t,n,r,i){if(!e.get_noteTagContextMenu()||!e.get_noteTagContextMenu().get_noteTagClicked()||!e.get_noteTagContextMenu().get_noteTagClicked().get_isConnected())return 2;var o=_s.y.create(e.get_noteTagContextMenu().get_noteTagClicked());return L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(o,t,n,!1,r,i)},e._noteTagContextMenu=null,e}();(0,o.l)(hM,"NoteTagActor",null,[]);var _M=function(){function e(e,t,n,r,i,o,a){this._contentView=null,this._graphSpaceEditor=null,this._pageReader=null,this._clipboardRoot=null,this._graphNodeFactory=null,this._graphTransactionFactory=null,this._undoManager=null,this._clipboardPages=null,this._contentView=r,this._pageReader=n,this._graphSpaceEditor=t,this._graphNodeFactory=i,this._graphTransactionFactory=o,this._undoManager=a,this._clipboardPages=null,this._clipboardRoot=i.create(2097162);var s=new Kr.n(-1);e.get_theGraph().addRoot(s);var l=new Da.GraphIterator;l.set(s);var c=this._graphTransactionFactory.getTransaction(3);c.setFromIterator(l),l.addChild(this._clipboardRoot,80),c.dispose()}return e.prototype.get_containsPages=function(){return!!this._clipboardPages&&this._clipboardPages.length>0},e.prototype.clearClipboard=function(){if(this._clipboardPages){var e=Da.GraphIterator.createFromNode(this._clipboardRoot),t=this._graphTransactionFactory.getTransaction(2);t.setFromIterator(e),e.goToFirstChild()&&e.disconnectNodeAndReturnToParent(),e.set(this._clipboardRoot.getGraphSpace());for(var n=0,r=this._clipboardPages;n<r.length;n++){var i=r[n];e.goToChild(i)&&e.disconnectNodeAndReturnToParent()}t.dispose(),this._clipboardPages=null}},e.prototype.copyPagesToOneNoteClipboard=function(e,t){void 0===t&&(t=null),this.clearClipboard(),this._clipboardPages=this.pagesClipboardCopy(e,this._clipboardRoot.getGraphSpace(),!0),this.logResult(e,this._clipboardPages,"OneNote.Actors.OneNoteClipboard.CopyPagesToOneNoteClipboard: {0}")},e.prototype.pastePagesFromOneNoteClipboard=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.registerSectionForUndo(e);var r=this.pagesClipboardCopy(this._clipboardPages,e,!1,t);e.ensureContentGraphConnection(),this.logResult(this._clipboardPages,r,"OneNote.Actors.OneNoteClipboard.PastePagesFromOneNoteClipboard: {0}")},e.prototype.cleanAndCacheNewPage=function(e,t){e.updateCachedMetadata(),this._pageReader.getMetadataForWrite(e).set_hasConflictPages(!1),this._pageReader.getMetadataForWrite(e).set_hasPageVersions(!1),this._pageReader.getMetadataForWrite(e).set_notebookManagementEntityId(t)},e.prototype.countChildren=function(e){for(var t=0,n=0,r=e;n<r.length;n++)for(var i=r[n],o=vf.z.createTraverser(i);o.moveNext();)o.get_currentNode().getGraphSpace()===i.getGraphSpace()&&t++;return t},e.prototype.prepareUndo=function(e){this._undoManager.addPageUndo(e)},e.prototype.registerSectionForUndo=function(e){this._undoManager.register(e),this._undoManager.setActive(e)},e.prototype.logResult=function(e,t,n){var r=this.countChildren(e),i=this.countChildren(t),o={};o.sourceObjectID=this.objectIdsToString(e),o.targetObjectID=this.objectIdsToString(t),o.PageSizeByChildrenCountSource=r.toString(),o.PageSizeByChildrenCountTarget=i.toString(),o.Success=(r===i).toString(),C.ULS.sendTraceTag(8246433,339,50,n,o)},e.prototype.objectIdsToString=function(e){var t=new Array(0);return e.forEach((function(e){t.push(e.get_objectSpaceId().toString())})),t.join(",")},e.prototype.pagesClipboardCopy=function(e,t,n,r){var i;void 0===r&&(r=null),n?(i=this._graphTransactionFactory.getTransaction(2)).setFromNode(e[0].getParentGraphSpace()):((i=this._graphTransactionFactory.getTransaction(15)).setFromNode(t),i.set_undoActionId(eb.Fq));var o=new Da.GraphIterator,a=new Array(0),s=e;r&&(s=e.slice(0,e.length).reverse());for(var l=r,c=0,u=s;c<u.length;c++){var g=u[c];o.set(t);var p=t.createChildGraphSpace(1,"Clipboard");n&&p.get_contentReplicator().set_enabled(0),l?o.insertChild(p,r,79):o.addChild(p,79),qr.k(o);var d=this._graphNodeFactory.create(393224),h=ae.l.create();if(d.setValue(Kc.b.notebookManagementEntityGuid,h),d.setValue(Kc.b.topologyCreationTimeStamp,new Date),r){var _=new Da.GraphIterator;_.set(r),_.tryToRootAtAncestorOfType(5),_.returnToAncestorOfType(6),o.insertChild(d,_.get_currentNode(),1)}else o.addChild(d,1);o.goToChild(d),o.addChild(p,75),this._graphSpaceEditor.copyContent(g,p),this.cleanAndCacheNewPage(p,h),a.push(p)}if(i.dispose(),!n)for(var m=0,f=a;m<f.length;m++){p=f[m];this.prepareUndo(p)}return a},e.prototype.readyForCopyClipboardOperation=function(e,t,n){if(t&&t.get_isContentPresent()&&!this._contentView.get_isFishbowlView()){for(var r=0,i=e;r<i.length;r++){if(!i[r].get_isContentPresent())return!1}return!0}return!1},e.prototype.readyForPasteClipboardOperation=function(e,t){return this.get_containsPages()&&e.get_isContentPresent()?this._contentView.get_isFishbowlView()?8:1===Br.App.get_activeAppFrame().get_mode()?8:32:8},e}();(0,o.l)(_M,"OneNoteClipboard",null,[]);var mM=n(7235),fM=function(){function e(){}return e.prototype.isCustomBaseUrlEnabled=function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteContentSyncUploadAttachmentIsEnabled")&&Wr.App.get_instance().get_isContentSyncEnabled()},e.prototype.getCustomBaseUrl=function(){var e="https://"+Wr.App.get_instance().get_oneNoteOnlineSyncAttachmentEndpoint()+"/OnlineImage";if(!Br.App.get_activeAppFrame().workspace.get_activeSection()||!Br.App.get_activeAppFrame().workspace.get_activePage())return e;var t=Br.App.get_activeAppFrame().workspace.get_activeSection().get_fileId(),n=decodeURIComponent(Wr.App.extractSiteUrl(t).toLowerCase());return e=tt.n.addParameterValue(e,Rh.h.webUrl,n),e=tt.n.addParameterValue(e,Rh.h.pageId,this.getPageId(t)),e=tt.n.addParameterValue(e,Rh.h.querySignature,L.AFrameworkApplication.get_rootQuerySignature())},e.prototype.getPageId=function(e){var t=mM.h.getHostResourceData(e);return t.HostId+"|"+Br.App.get_activeAppFrame().workspace.get_activePage().get_objectSpaceId()+"|"+t.HostResourceId},e}();(0,o.l)(fM,"OneNoteImageStewardBridge",null,[rh]);var yM=function(){function e(e,t){this._box4PasteStewardUtils=null,this._postHyperlinkAutoCorrectStrategy=null,this._box4PasteStewardUtils=e,this._postHyperlinkAutoCorrectStrategy=t}return e.prototype.tryHandlePageBreak=function(e,t,n){return this._box4PasteStewardUtils.isPageBreak(t)},e.prototype.handleParagraphEnd=function(e,t){return this._box4PasteStewardUtils.escapeTextOfParagraphEnd(e,t)},e.prototype.handleTabCharacter=function(e,t){},e.prototype.setParagraphProperties=function(e,t,n,r,i){void 0===r&&(r=null),void 0===i&&(i=null)},e.prototype.setListInfo=function(e,t,n){},e.prototype.isFormatless=function(e){return this._box4PasteStewardUtils.isFormatless(e)},e.prototype.get_isPasteBrAsNewParagraphEnabled=function(){return this._box4PasteStewardUtils.get_isPasteBrAsNewParagraphEnabled()},e.prototype.setLineSpacing=function(e,t){},e.prototype.setParagraphSpacing=function(e,t){},e.prototype.setSpecialIndent=function(e,t){},e.prototype.setLeftIndent=function(e,t){},e.prototype.get_shouldSkipSettingIndentation=function(){return!1},e.prototype.processExternalHyperlink=function(e,t){var n=cs.ParagraphReader.text(e.get_node());Hs.HyperlinkReader.isValidUrl(n)&&(n.startsWith(Hs.HyperlinkReader.protocolHttp)||n.startsWith(Hs.HyperlinkReader.protocolHttps)||n.startsWith(Hs.HyperlinkReader.protocolWWW))&&this._postHyperlinkAutoCorrectStrategy.postProcessHyperlink(e,t)},e}();(0,o.l)(yM,"OneNotePasteStewardBridge",null,[dd.n]);var CM=function(){function e(e){this._url=null,this._url=e}return e.prototype.registerActions=function(e){e.addActionWithFlags(eb.jT,cl.U,o.i(this,this.goToStickyNotesLink,"goToStickyNotesLink"),96)},e.prototype.goToStickyNotesLink=function(e,t,n,r,i){return 1===n?32:(Vl.k(37028113,306,50,"User is going to Sticky Notes Experience"),window.open(this._url),32)},e}();(0,o.l)(CM,"OneNoteStickyNotesLinkActor",null,[]);var SM=n(6385),vM=n(7337),bM=n(7945),TM=function(){function e(t){this._undoManager=null,this._undoManagerFactory=null,this._undoManagerFactory=t,e._verticalUnit=Hh.L(.1,1),e._horizontalUnit=Hh.L(.1,0)}return e.prototype.get_undoManager=function(){return this._undoManager||(this._undoManager=this._undoManagerFactory())},e.prototype.registerActions=function(){var t=L.AFrameworkApplication.get_theActionManager();us.n.get_instance().get_item(17)&&(t.addAction(ii.dh,cl.n,o.i(this,this.createOutlineBelowView,"createOutlineBelowView")),t.addAction(ii.dh,cl.v,e.createOutlineBelow),t.setActionFlags(ii.dh,4)),t.addActionWithFlags(ii.un,cl.n,e.moveOutline,4),t.addActionWithFlags(ii.Sr,cl.n,e.resizeOutline,4),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteTraverseOutlinesIsEnabled")&&(t.addAction(eb.Pg,cl.n,o.i(this,this.navigateToPreviousOutline,"navigateToPreviousOutline")),t.addAction(eb.JQ,cl.n,o.i(this,this.navigateToNextOutline,"navigateToNextOutline")))},e.prototype.navigateToPreviousOutline=function(e,t,n,r,i){var o=this.getSiblingOutline(t,!0);return o?(this.setSelectionToFirstCPOrElement(o),32):8},e.prototype.navigateToNextOutline=function(e,t,n,r,i){var o=this.getSiblingOutline(t,!1);return o?(this.setSelectionToFirstCPOrElement(o),32):8},e.prototype.createOutlineBelowView=function(t,n,r,i,o){Xi.t.mark(4672);var a=n.view,s=a.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext(),l=Da.GraphIterator.createFromNode(s.get_node());if(l.tryToRootAtPageContent(),Hr.b(l))return 8;if(Sc.returnToOutline(l)&&vc.isEphemeral(l))return 8;var c=new as.GraphTransaction(15);c.setFromNode(s.get_node());var u=e.get_contextSetEditor().attemptToGeneralizeToNodeContextOfType(a.get_selectionManager().get_selectionContextForActionDispatch(),10),g=u?L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(u,t,r,!1,i,o):8,p=null;if(32===g&&2===r){var d=Da.GraphIterator.createFromNode(a.get_targetNode());p=e.get_pageNavigator().moveToFirstOrLastContentOutline(d,!0),a.get_selectionManager().setSelection(ss.SelectionFactory.createSelectionFromNode(d.get_currentNode())),this.get_undoManager().interruptUndoMerging()}if(c.dispose(),p){var h=p.getHtmlViewElement(a.get_viewId());h&&h.get_htmlElement().scrollIntoView()}return Xi.t.mark(4673),g},e.prototype.getSiblingOutline=function(e,t){var n=e.view.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext();if(!n)return null;var r=Da.GraphIterator.createFromNode(n.get_node());return r.tryToRootAtPageContent(),r.returnToOutlineNode(),Sc.moveToNextOrPreviousSelectableOutline(r,t),r.get_currentNode()},e.prototype.setSelectionToFirstCPOrElement=function(e){var t=new Da.GraphIterator;t.set(e),t.tryToRootAtOutlineAncestor(),Sc.moveToFirstOutlineElement(t),hs.OutlineElementNavigator.moveToContent(t);for(var n=t.get_currentNode();t.goToFirstChild();){var r=t.get_currentNode();if(26===r.get_type())break;n=r}var i=null;if(12===n.get_type()){var o=(0,f.e)(bM.q,n);i=ss.SelectionFactory.createIpSelection(o,0)}else i=ss.SelectionFactory.createSelectionFromNode(n);Oa.SelectionManager.get_instance().setSelection(i)},e.get_instance=function(){return e._instance||(e._instance=e.getInstanceWithResolvedDependencies())},e.getInstanceWithResolvedDependencies=function(){return new e((function(){return se.w.get_instance().resolve(ja.n)}))},e.get_contextSetEditor=function(){return kf.ContextSetEditor.get_instance()},e.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e.get_pageContentEditor=function(){return e._pageContentEditor||(e._pageContentEditor=se.w.get_instance().resolve(bm.m))},e.get_outlineEditor=function(){return e._outlineEditor||(e._outlineEditor=se.w.get_instance().resolve(rc.a))},e.createOutlineBelow=function(t,n,r,i,o){var a=new Da.GraphIterator;a.set(Br.App.get_activeAppFrame().workspace.get_activePage());var s=new as.GraphTransaction(7);s.setFromIterator(a),qr.k(a),e.get_pageNavigator().moveToPageContent(a);var l=e.get_pageReader().getOutlineCount(a),c=e.get_pageReader().isRtl(a.get_currentNode());return e.get_pageContentEditor().createOutline(a),Yc.m(a.get_currentNode(),c?-1*l:l,l+2),e.get_outlineEditor().appendOutlineElement(a,!0),s.dispose(),32},e.moveOutline=function(t,n,r,i,a){if(1===r)return 32;var s=n.view,l=s.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext();Br.App.get_activeAppFrame().get_theCursorManager().setCursor(3),e._incrementHorz=0,e._incrementVert=0;l.get_node().getHtmlViewElement(Br.App.get_activeAppFrame().workspace.get_contentView().get_viewId());e._movingElements=new Array(0),e._oldPointPixels=new Array(0);for(var c=s.get_selectionManager().get_selectionCollection(),u=0;u<c.get_length();++u){var g=c.get_item(u).get_firstContext().get_node().getHtmlViewElement(s.get_viewId());g&&o.r(SM.f,g)&&(Array.add(e._movingElements,g),Array.add(e._oldPointPixels,g.get_currentDisplayedLocation()))}return s.get_selectionManager().get_theDelayedSelectionTask().forcePendingTasks(),L.AFrameworkApplication.get_theTaskManager().pause(),e._commitHandler=e._commitMoveHandler,Br.App.get_activeAppFrame().get_theKeyInputManager().capture(e.moveOutlineKeyTrap,null),Br.App.get_activeAppFrame().get_theMouseInputManager().capture(e.cancelTrapMouseTrap,null),Br.App.get_activeAppFrame().get_theClickInputManager().capture(e.cancelTrapMouseTrap,null),Br.App.get_activeAppFrame().get_theContextMenuInputManager().set_isSuppressingMenus(!0),32},e.resizeOutline=function(t,n,r,i,o){if(1===r)return 32;var a=n.view,s=a.get_selectionManager().get_selectionCollection().get_currentSelection().get_firstContext();return Br.App.get_activeAppFrame().get_theCursorManager().setCursor(11),e._incrementHorz=0,e._resizingElement=s.get_node().getHtmlViewElement(Br.App.get_activeAppFrame().workspace.get_contentView().get_viewId()),e._oldWidthPixels=e._resizingElement.get_currentDisplayedWidth(),a.get_selectionManager().get_theDelayedSelectionTask().forcePendingTasks(),L.AFrameworkApplication.get_theTaskManager().pause(),e._commitHandler=e._commitResizeHandler,Br.App.get_activeAppFrame().get_theKeyInputManager().capture(e.resizeOutlineKeyTrap,null),Br.App.get_activeAppFrame().get_theMouseInputManager().capture(e.cancelTrapMouseTrap,null),Br.App.get_activeAppFrame().get_theClickInputManager().capture(e.cancelTrapMouseTrap,null),Br.App.get_activeAppFrame().get_theContextMenuInputManager().set_isSuppressingMenus(!0),32},e.moveOutlineKeyTrap=function(t){if(t.eventName!==Le.d.keyDown)return!0;if(t.innerEvent.keyCode===Je.v.vK_Esc)e.cancel();else if(t.innerEvent.keyCode===Je.v.vK_Enter)e.commit();else if(t.innerEvent.keyCode===Je.v.vK_Left||t.innerEvent.keyCode===Je.v.vK_Right){t.innerEvent.keyCode===Je.v.vK_Right?e._incrementHorz++:e._incrementHorz--;for(var n=0;n<e._movingElements.length;++n)e._movingElements[n].set_currentDisplayedLocation(new Sys.UI.Point(e._oldPointPixels[n].x+e._incrementHorz*e._horizontalUnit,e._movingElements[n].get_currentDisplayedLocation().y))}else if(t.innerEvent.keyCode===Je.v.vK_Up||t.innerEvent.keyCode===Je.v.vK_Down){t.innerEvent.keyCode===Je.v.vK_Up?e._incrementVert--:e._incrementVert++;for(n=0;n<e._movingElements.length;++n)e._movingElements[n].set_currentDisplayedLocation(new Sys.UI.Point(e._movingElements[n].get_currentDisplayedLocation().x,e._oldPointPixels[n].y+e._incrementVert*e._verticalUnit))}return!0},e.commitMove=function(){var t=new as.GraphTransaction(15);t.setFromNode(e._movingElements[0].get_sourceNode());for(var n=0;n<e._movingElements.length;++n){var r=0;if(10===e._movingElements[n].get_sourceNode().get_type())r=e._movingElements[n].get_outlineTitleHeight();Yc.o(e._movingElements[n].get_sourceNode(),e._oldPointPixels[n].x+e._incrementHorz*e._horizontalUnit,e._oldPointPixels[n].y+e._incrementVert*e._verticalUnit+r),e._movingElements[n].resumeNormalRender()}Br.App.get_theViewManager().getView(e._movingElements[0].get_viewId()).get_selectionManager().setSelection(ss.SelectionFactory.createCollapsedSelection(e._movingElements[0].get_sourceNode(),!1)),t.dispose()},e.resizeOutlineKeyTrap=function(t){if(t.eventName!==Le.d.keyDown)return!0;if(t.innerEvent.keyCode===Je.v.vK_Esc)e.cancel();else if(t.innerEvent.keyCode===Je.v.vK_Enter)e.commit();else if(t.innerEvent.keyCode===Je.v.vK_Left||t.innerEvent.keyCode===Je.v.vK_Right){var n=e._resizingElement.get_isRtl()?-1:1;t.innerEvent.keyCode===Je.v.vK_Right?e._incrementHorz+=n:e._incrementHorz-=n,e._incrementHorz=Math.max(e._incrementHorz,(110-e._oldWidthPixels)/e._horizontalUnit),e._resizingElement.set_currentDisplayedWidth(e._oldWidthPixels+e._incrementHorz*e._horizontalUnit)}return!0},e.commitResize=function(){var t=new as.GraphTransaction(15);t.setFromNode(e._resizingElement.get_sourceNode());var n=e._resizingElement.get_currentDisplayedWidth();(new vM.c).setOutlineWidthInPixels(e._resizingElement.get_sourceNode(),n),e._resizingElement.resumeNormalRender(),Br.App.get_theViewManager().getView(e._resizingElement.get_viewId()).get_selectionManager().setSelection(ss.SelectionFactory.createCollapsedSelection(e._resizingElement.get_sourceNode(),!1)),t.dispose()},e.cancel=function(){var t=e._resizingElement||e._movingElements[0],n=new as.GraphTransaction(3);if(n.setFromNode(t.get_sourceNode()),e._resizingElement&&e._resizingElement.resumeNormalRender(),e._movingElements)for(var r=0;r<e._movingElements.length;++r)e._movingElements[r].resumeNormalRender();t.get_source().invalidateViewElements(4,!0),t.get_sourceNode().get_anchor().invalidateViewChannelForAllViews(128),n.dispose(),e.endTrap()},e.commit=function(){e._commitHandler(),e.endTrap()},e.cancelTrapMouseTrap=function(t){return t.eventName===Le.d.click&&e.endTrap(),!0},e.endTrap=function(){L.AFrameworkApplication.get_theTaskManager().resume(),Br.App.get_activeAppFrame().get_theCursorManager().resetCursor(),Br.App.get_activeAppFrame().get_theMouseInputManager().releaseCapture(),Br.App.get_activeAppFrame().get_theClickInputManager().releaseCapture(),Br.App.get_activeAppFrame().get_theKeyInputManager().releaseCapture(),Br.App.get_activeAppFrame().get_theContextMenuInputManager().set_isSuppressingMenus(!1),e._commitHandler=null,e._resizingElement=null,e._movingElements=null},e._pageContentEditor=null,e._movingElements=null,e._resizingElement=null,e._oldPointPixels=null,e._oldWidthPixels=0,e._incrementHorz=0,e._incrementVert=0,e._commitMoveHandler=e.commitMove,e._commitResizeHandler=e.commitResize,e._commitHandler=null,e._verticalUnit=0,e._horizontalUnit=0,e._instance=null,e._outlineEditor=null,e}();(0,o.l)(TM,"OutlineActor",null,[]);var AM=n(8404),IM=function(e){function t(t){var n=e.call(this)||this;return n._sourceGraphNode=null,n._sourceGraphNode=t,n.set_buttonsOption(2),n.setButtonText(1,OneNoteIntl.OneNoteStrings.L_Move),n.setButtonText(2,Box4Intl.Box4Strings.L_Copy),n}return(0,S.t)(t,e),t.prototype.get_sourceGraphNode=function(){return this._sourceGraphNode},t.prototype.getDialogTitle=function(){return OneNoteIntl.OneNoteStrings.L_MoveOrCopyDialogTitle},t.prototype.getIntroLabel=function(){return OneNoteIntl.OneNoteStrings.L_MoveOrCopyIntroLabel},t.prototype.sectionPickerDialogHandler=function(t,n){if(e.prototype.sectionPickerDialogHandler.call(this,t,n),1===t||2===t){var r={};r.source=this.get_sourceGraphNode(),r.destination=this.get_destinationGraphNode(),r.shouldCopy=1!==t,L.AFrameworkApplication.get_theActionManager().processActionWithData(eb.Nx,2,r)}},t}(LF);(0,o.l)(IM,"MoveOrCopyPageDialog",LF,[]);var wM=function(){function e(e,t){void 0===e&&(e=null),void 0===t&&(t=null),this._contextMenuDataProvider=null,this._pageEditor=null,this._sectionEditor=null,this._sectionContentEditor=null,this._pageSeriesEditor=null,this._multiPageHelper=null,this._contextMenuDataProvider=e,this._multiPageHelper=t}return e.prototype.get_workspace=function(){return Br.App.get_activeAppFrame().workspace},e.prototype.get_contextMenuDataProvider=function(){return this._contextMenuDataProvider||(this._contextMenuDataProvider=se.w.get_instance().resolve(WP))},e.prototype.get_pageEditor=function(){return this._pageEditor||(this._pageEditor=se.w.get_instance().resolve(eA.f))},e.prototype.get_sectionEditor=function(){return this._sectionEditor||(this._sectionEditor=se.w.get_instance().resolve(CT.f))},e.prototype.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.prototype.get_pageReader=function(){return Qc.PageReader.get_instance()},e.prototype.get_pageSeriesEditor=function(){return this._pageSeriesEditor||(this._pageSeriesEditor=se.w.get_instance().resolve(ZT))},e.prototype.get_multiPageHelper=function(){return this._multiPageHelper||(this._multiPageHelper=aD.get_instance())},e.prototype.get_sectionContentEditor=function(){return this._sectionContentEditor||(this._sectionContentEditor=se.w.get_instance().resolve(YT.x))},e.prototype.get_clipboard=function(){return se.w.get_instance().resolve(_M)},e.prototype.get_browser=function(){return se.w.get_instance().resolve(JP)},e.prototype.get_application=function(){return se.w.get_instance().resolve(QP)},e.prototype.get_dialogService=function(){return se.w.get_instance().resolve(XP)},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager();e.addAction(ii.El,cl.n,o.i(this,this.deletePage,"deletePage")),e.addAction(ii.UV,cl.n,o.i(this,this.newPage,"newPage")),e.addAction(ii.UY,cl.n,o.i(this,this.increaseIndent,"increaseIndent")),e.addAction(ii.oC,cl.n,o.i(this,this.decreaseIndent,"decreaseIndent")),e.addAction(ii.XS,cl.n,o.i(this,this.getPageUrl,"getPageUrl")),e.addAction(eb.JM,cl.n,o.i(this,this.copyPage,"copyPage")),e.addAction(eb.Fq,cl.n,o.i(this,this.pastePage,"pastePage")),e.addAction(eb.rO,cl.n,o.i(this,this.showVersions,"showVersions")),e.addAction(eb.IY,cl.n,o.i(this,this.hideVersions,"hideVersions")),e.addAction(eb.Lc,cl.n,o.i(this,this.showConflicts,"showConflicts")),e.addAction(eb.Vk,cl.n,o.i(this,this.hideConflicts,"hideConflicts")),e.addAction(eb.Ct,cl.n,o.i(this,this.openPageInNewTab,"openPageInNewTab")),e.addAction(eb.CH,cl.n,o.i(this,this.showMoveOrCopyPageDialog,"showMoveOrCopyPageDialog")),e.addAction(eb.Nx,cl.n,o.i(this,this.moveOrCopyPage,"moveOrCopyPage"))},e.prototype.deletePage=function(e,t,n,r,i){if(this.get_multiPageHelper().isMultiplePages(i))return this.deleteMultiplePages(n,i);var o=this.get_contextMenuDataProvider().clickedPage(i);return 1===Br.App.get_activeAppFrame().get_mode()||_T.Q(this.get_workspace().get_activeSection())?8:this.get_pageReader().hasLockOnPageNode(o)&&Wr.App.get_isCurrentUserNotebookGuest()?8:(2===n&&(!Br.App.theNotebookManager.get_isRecycleBinEnabled()||o.get_isPasswordProtectedUnlockable()||!Wr.App.get_instance().notebookType.retrieved||Wr.App.get_instance().notebookType.isEduNotebook||this.get_pageReader().hasLockOnPageNode(o)?this.get_pageEditor().showDeletePageDialog(o):this.get_pageEditor().deletePage(o,!1)),32)},e.prototype.deleteMultiplePages=function(e,t){for(var n=this.get_multiPageHelper().getMultiplePagesAsList(t),r=n.get_item(0),i=n.$$lge();i.$$mn();){var o=i.$$cu();if(this.get_pageReader().hasLockOnPageNode(o)&&Wr.App.get_isCurrentUserNotebookGuest())return 8}if(1===Br.App.get_activeAppFrame().get_mode()||_T.Q(this.get_workspace().get_activeSection()))return 8;if(2===e)if(Br.App.theNotebookManager.get_isRecycleBinEnabled()&&!r.get_isPasswordProtectedUnlockable())for(var a=n.$$lge();a.$$mn();){var s=a.$$cu();this.get_pageEditor().deletePage(s,!1)}else this.get_pageEditor().showDeleteMultiplePagesDialog(n);return 32},e.prototype.newPage=function(t,n,r,i,o){if(this.get_multiPageHelper().isMultiplePages(o))return 8;var a=this.get_contextMenuDataProvider().clickedPage(o);if(1===Br.App.get_activeAppFrame().get_mode()||_T.Q(this.get_workspace().get_activeSection()))return 8;if(2===r){var s=new Da.GraphIterator;s.set(a),s.tryToRootAtAncestorOfType(5),s.returnToAncestorOfType(6);var l=s.get_currentNode(),c=s.getChildCount();s.returnToAncestorOfType(5);var u=new as.GraphTransaction(7);u.setFromIterator(s);var g=void 0;this.get_pageReader().getLevel(a)===Qc.PageReader.minPageLevel&&1===c?(this.get_sectionContentEditor().insertPageSeries(s,l),g=this.get_pageSeriesEditor().createPage(s)):g=this.get_pageSeriesEditor().createPageAfterSubpage(a),this.get_workspace().set_activePage(g),u.dispose(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteTemplatesAddInIsEnabled")&&Wr.App.oneNoteUserSettingsRetrieved&&!Wr.App.oneNoteUserSettings.DisablePageTemplates&&Wr.App.activatedAddins.contains("Templates")&&e.get_futureAddinInstaller().execute((function(e){e.activateTemplatesAddin()}))}return 32},e.prototype.increaseIndent=function(e,t,n,r,i){if(this.get_multiPageHelper().isMultiplePages(i)){for(var o=this.get_multiPageHelper().getMultiplePagesAsActionData(i).$$lge();o.$$mn();){var a=o.$$cu(),s=this.increaseIndent(e,t,n,r,a);if(1===n&&8===s)return 8}return 32}var l=this.get_contextMenuDataProvider().clickedPage(i);return 1===Br.App.get_activeAppFrame().get_mode()||_T.Q(this.get_workspace().get_activeSection())?8:this.get_pageEditor().increaseIndent(l,n)},e.prototype.decreaseIndent=function(e,t,n,r,i){if(this.get_multiPageHelper().isMultiplePages(i)){for(var o=this.get_multiPageHelper().getMultiplePagesAsActionData(i).$$lge();o.$$mn();){var a=o.$$cu(),s=this.decreaseIndent(e,t,n,r,a);if(1===n&&8===s)return 8}return 32}var l=this.get_contextMenuDataProvider().clickedPage(i);return 1===Br.App.get_activeAppFrame().get_mode()||_T.Q(this.get_workspace().get_activeSection())?8:this.get_pageEditor().decreaseIndent(l,n)},e.prototype.getPageUrl=function(e,t,n,r,i){if(this.get_multiPageHelper().isMultiplePages(i))return 8;if(2===n){var o=this.get_contextMenuDataProvider().clickedPage(i);this.copyPageLinkToClipboard(o)}return 32},e.prototype.oreoIsCopyPageLinkToClipboardAllowed=function(e){return!this.get_multiPageHelper().isMultiplePages(e)},e.prototype.oreoCopyPageLinkToClipboard=function(e){var t=iD.get_instance().findPageInActiveSection(e);this.copyPageLinkToClipboard(t)},e.prototype.copyPageLinkToClipboard=function(t){var n,r=this.get_application().getWebAppLink(t);r=e.formatUrlStringToIncludeEntryPoint(r,e.navPaneGetCopyLinkUrlEntryPointParam);try{if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteHyperlinkIsEnabled")){var i=this.get_application().getNativeAppLink(t),o=this.get_pageReader().getTitle(t);n=this.get_browser().copyHyperlinkToClipboard(r,i,o)}else n=this.get_browser().copyToClipboard(r)}catch(e){n=!1}n||this.get_dialogService().displayPageUrlDialog(r)},e.prototype.copyPage=function(e,t,n,r,i){var o=this.get_multiPageHelper().isMultiplePages(i)?this.get_multiPageHelper().getMultiplePagesAsList(i).toArray():[this.get_contextMenuDataProvider().clickedPage(i)];return this.get_clipboard()&&this.get_clipboard().readyForCopyClipboardOperation(o,this.get_workspace().get_activeSection(),this.get_clipboard())?(2===n&&this.get_clipboard().copyPagesToOneNoteClipboard(o),32):8},e.prototype.pastePage=function(e,t,n,r,i){var o=null;if(this.get_multiPageHelper().isMultiplePages(i)){var a=this.get_multiPageHelper().getMultiplePagesAsList(i);o=a.get_item(a.get_count()-1)}else o=this.get_contextMenuDataProvider().clickedPage(i);var s=this.get_workspace().get_activeSection();return 1===n?this.get_clipboard()?this.get_clipboard().readyForPasteClipboardOperation(s,this.get_clipboard()):8:2===n?(this.get_clipboard().pastePagesFromOneNoteClipboard(s,o),32):2},e.prototype.showMoveOrCopyPageDialog=function(e,t,n,r,i){if(this.get_multiPageHelper().isMultiplePages(i))return 8;var o=this._contextMenuDataProvider.clickedPage(i);return 1===n?1===Br.App.get_activeAppFrame().get_mode()||_T.Q(this.get_pageNavigator().getContainingSection(o))||this.get_pageReader().hasLockOnPageNode(o)&&Wr.App.get_isCurrentUserNotebookGuest()?8:32:2===n?this.get_pageReader().hasLockOnPageNode(o)&&Wr.App.get_isCurrentUserNotebookGuest()?8:(C.ULS.sendTraceTag(21807104,339,50,"Show Move or Copy Page Dialog for page {0}",o.get_objectSpaceId().toString()),new IM(o).showPickerDialog(),32):2},e.prototype.moveOrCopyPage=function(e,t,n,r,i){if(this.get_multiPageHelper().isMultiplePages(i))return 8;if(1===n)return 32;if(2===n){var o=i,a=o.source,s=o.destination,l=o.shouldCopy;return this.moveOrCopyPageToSection(a,s,l),32}return 2},e.prototype.moveOrCopyPageToSection=function(e,t,n){var r=this;C.ULS.sendTraceTag(21353692,339,50,"Move or copy page start for page {0}.",e.get_objectSpaceId().toString());var i=this.get_pageReader().getTitle(e),o=_T.k(t);if(t.get_isContentPresent())if(n){this.get_pageEditor().copy(e,t,null,!0,!1);var a=String.format(OneNoteIntl.OneNoteStrings.L_CopyPageSucceedToastMessage,i,o);this.showToast(a)}else this.get_pageEditor().move(e,t,null,!0,!1),this.get_workspace().onGraphSpaceShutdown(e);else{var s=null;s=n?this.get_pageEditor().createDeferredPageCopyCallback(e,t,null,!0):this.get_pageEditor().createDeferredPageMoveCallback(e,t,null,!0,!1);var l=String.format(OneNoteIntl.OneNoteStrings.L_MoveOrCopyPageFailureToastMessage,i,o);this.get_sectionEditor().load(t,s,(function(e,t){C.ULS.sendTraceTag(38105924,339,15,l),r.showToast(l)}),null)}},e.prototype.showToast=function(e){var t=Br.App.get_activeAppFrame().get_notificationBar().createEntry(e,!1);Br.App.get_activeAppFrame().get_notificationBar().addEntry(t)},e.prototype.showVersions=function(e,t,n,r,i){if(this.get_multiPageHelper().isMultiplePages(i))return 8;var o=this.get_contextMenuDataProvider().clickedPage(i);return 1===n?this.get_pageReader().areVersionsVisible(o)?8:32:2},e.prototype.hideVersions=function(e,t,n,r,i){if(this.get_multiPageHelper().isMultiplePages(i))return 8;var o=this.get_contextMenuDataProvider().clickedPage(i);return 1===n?this.get_pageReader().areVersionsVisible(o)?32:8:2},e.prototype.showConflicts=function(e,t,n,r,i){if(this.get_multiPageHelper().isMultiplePages(i))return 8;var o=this.get_contextMenuDataProvider().clickedPage(i);return 1===n?this.get_pageReader().hasConflictPages(o)&&!this.get_pageReader().areConflictPagesVisible(o)?32:8:2},e.prototype.hideConflicts=function(e,t,n,r,i){if(this.get_multiPageHelper().isMultiplePages(i))return 8;var o=this.get_contextMenuDataProvider().clickedPage(i);return 1===n?this.get_pageReader().hasConflictPages(o)&&this.get_pageReader().areConflictPagesVisible(o)?32:8:2},e.prototype.openPageInNewTab=function(t,n,r,i,o){if(aD.get_instance().isMultiplePages(o))return 8;if(2===r){var a=this.get_contextMenuDataProvider().clickedPage(o),s=this.get_application().getWebAppLink(a),l=e.formatUrlStringToIncludeEntryPoint(s,e.navPaneGetOpenInNewTabUrlEntryPointParam);window.open(l,"_blank"),C.ULS.sendTraceTag(23459852,1600,50,"Open page in new tab")}return 32},e.get_futureAddinInstaller=function(){return e._futureAddinInstaller||(e._futureAddinInstaller=se.w.get_instance().resolveFuture(AM.p)),e._futureAddinInstaller},e.formatUrlStringToIncludeEntryPoint=function(e,t){var n="?";return e.indexOf(n)>=0&&(n="&"),String.format("{0}{1}{2}",e,n,t)},e.navPaneGetCopyLinkUrlEntryPointParam="wdorigin=703",e.navPaneGetOpenInNewTabUrlEntryPointParam="wdorigin=716",e._futureAddinInstaller=null,e}();(0,o.l)(wM,"PageNavPaneContextMenuActor",null,[zP.o]);var xM=function(){function e(){this._pageEditor=null,this._pageContentEditor=null}return e.prototype.get_pageEditor=function(){return this._pageEditor||(this._pageEditor=se.w.get_instance().resolve(eA.f))},e.prototype.get_pageReader=function(){return Qc.PageReader.get_instance()},e.prototype.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.prototype.get_pageContentEditor=function(){return this._pageContentEditor||(this._pageContentEditor=se.w.get_instance().resolve(AA.m))},e.prototype.registerActions=function(e){e.addAction(eb.jm,cl.q,o.i(this,this.changePageColor,"changePageColor")),e.addAction(eb.Q,cl.q,o.i(this,this.clearPageColor,"clearPageColor")),e.addAction(eb.jm,cl.n,Br.App.get_activeAppFrame().workspace.currentPageActorHandler),e.addAction(eb.Q,cl.n,Br.App.get_activeAppFrame().workspace.currentPageActorHandler)},e.prototype.changePageColor=function(e,t,n,r,i){var o=t.get_node();if(!this.get_pageReader().isPageNode(o))return 8;var a=this.get_pageNavigator().getPageContentNodeIfLoaded(o);if(!this.get_pageReader().isPageContentNode(a))return 8;if(1===n)return 32;if(2===n){var s=(0,f.e)(Object,i);if(!(s&&"Color"in s))return 8;var l=s.Color;if(!l||""===l)return 8;var c=parseInt(l,16);if(isNaN(c))return 8;var u=Xy.o.rgbToBgr(c),g=new as.GraphTransaction(15);return g.setFromNode(a),this.get_pageContentEditor().setPageColor(a,u),g.dispose(),32}return 2},e.prototype.clearPageColor=function(e,t,n,r,i){var o=t.get_node();if(!this.get_pageReader().isPageNode(o))return 8;var a=this.get_pageNavigator().getPageContentNodeIfLoaded(o);if(!this.get_pageReader().isPageContentNode(a))return 8;if(1===n)return 32;if(2===n){var s=new as.GraphTransaction(15);return s.setFromNode(a),this.get_pageContentEditor().setPageColor(a,Xy.o.nil),s.dispose(),32}return 2},e}();(0,o.l)(xM,"PageSetupActor",null,[]);var FM=n(1323),EM=function(){function e(t,n,r,i,o){this._actionManager=null,this._dialogFactoryLazy=null,this._featureHelper=null,this._appSettingsManager=null,this._actionManager=t,this._dialogFactoryLazy=n,e._lineSpacingHelper=r,this._featureHelper=i,this._appSettingsManager=o}return e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(ii.Rc,cl.n,o.i(this,this.paragraphDialogViewHandler,"paragraphDialogViewHandler"),1028),this._actionManager.addAction(ii.Rc,cl.K,o.i(this,this.paragraphDialogHandler,"paragraphDialogHandler")),this._actionManager.addActionWithFlags(ii.mI,cl.n,Zu.queryDialogControl,96),this._actionManager.addActionWithFlags(ii.ju,cl.n,Zu.queryDialogControl,96),this._actionManager.addActionWithFlags(ii.Er,cl.n,Zu.queryDialogControl,96),this._actionManager.addActionWithFlags(ii.bn,cl.n,Zu.queryDialogControl,96),this._actionManager.addActionWithFlags(ii.aF,cl.n,Zu.handleDialogControl,96),this._actionManager.addActionWithFlags(ii.mN,cl.n,Zu.handleDialogControl,96),this._actionManager.addActionWithFlags(ii.R,cl.n,Zu.handleDialogControl,96),this._actionManager.addActionWithFlags(ii.aS,cl.n,Zu.handleDialogControl,96),this._actionManager.addActionWithFlags(ii.DH,cl.n,Zu.handleDialogControl,96),this._actionManager.addActionWithFlags(ii.Tz,cl.n,Zu.handleDialogControl,96),this._actionManager.addActionWithFlags(ii.cV,cl.n,Zu.handleDialogControl,96)},e.prototype.paragraphDialogHandler=function(e,t,n,r,i){if(1===n)return 3===this._actionManager.get_mode()||2===this._actionManager.get_mode()?32:8;var o=t.get_node(),a=this.tryGetSectionNode(t),s=3===i.inputMethod;return this._dialogFactoryLazy.get_value().createParagraphDialog(this.getPropertiesForParagraphDialog(o),this.getValiditiyCheckConstants(a),s),32},e.prototype.paragraphDialogViewHandler=function(t,n,r,i,o){var a=n.view.get_selectionManager();if(!a)return 8;if(us.n.get_instance().get_item(54)&&e.get_lockedRangeEditor().isContextSetInLockedParagraphs(a.get_selectionContextForActionDispatch()))return 8;if(1===r)return 3===this._actionManager.get_mode()||2===this._actionManager.get_mode()?32:8;var s=a.get_selectionCollection().get_currentSelection(),l=this.tryGetSectionNode(n),c=3===o.inputMethod;if(1===s.get_length()&&Pa.SelectionEditor.isInsertionPointContext(s.get_item(0))){var u=s.get_item(0).get_node();return this._dialogFactoryLazy.get_value().createParagraphDialog(this.getPropertiesForParagraphDialog(u),this.getValiditiyCheckConstants(l),c),32}for(var g=[],p=0;p<s.get_length();p++){var d=s.get_item(p);if(!p&&Pa.SelectionEditor.isEndOfParagraphContext(d)||cs.ParagraphReader.isParagraphContext(d)||Pa.SelectionEditor.isTextRangeContext(d)){var h=d;Array.add(g,h.get_node())}}if(!g.length)return 8;var _=new Array(g.length);for(p=0;p<g.length;p++)_[p]=this.getPropertiesForParagraphDialog(g[p]);var m=FM.APropertySet.getIntersection(_);return this._dialogFactoryLazy.get_value().createParagraphDialog(m,this.getValiditiyCheckConstants(l),c),32},e.prototype.getPropertiesForParagraphDialog=function(t){var n=t,r=new Kl.DictionaryPropertySet;r.setValue(zl.k.justification,cs.ParagraphReader.getJustification(n));var i=e._lineSpacingHelper.getParagraphSpacing(n),o=i.lineSpacing;r.setValue(zl.k.lineSpacingUnit,o.unit),r.setValue(zl.k.lineSpacingValue,o.value);var a=i.beforeSpacing;r.setValue(zl.k.paraSpacingBeforeUnit,a.unit),r.setValue(zl.k.paraSpacingBeforeValue,a.value);var s=i.afterSpacing;return r.setValue(zl.k.paraSpacingAfterUnit,s.unit),r.setValue(zl.k.paraSpacingAfterValue,s.value),r},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e._lineSpacingHelper=null,e}();(0,o.l)(EM,"ParagraphDialogActor$0",null,[]);var PM=function(e){function t(t,n,r,i,o){return e.call(this,t,n,r,i,o)||this}return(0,S.t)(t,e),t.prototype.getValiditiyCheckConstants=function(e){return null},t.prototype.tryGetSectionNode=function(e){return null},t.prototype.getPropertiesForParagraphDialog=function(t){var n=e.prototype.getPropertiesForParagraphDialog.call(this,t);return n.setValue(Kc.b.fontSize,t.get_characterProperties().get_first().get_formatting().get_cache().get_fontSize()),n.setValue(Kc.b.font,t.get_characterProperties().get_first().get_formatting().get_cache().get_fontFace()),n},t}(EM);(0,o.l)(PM,"ParagraphDialogActor",EM,[]);var kM=function(){function e(){e._refCount++,fi.EventHandlerManager.get_instance().enableEventHandling(!1)}return e.prototype.dispose=function(){--e._refCount||fi.EventHandlerManager.get_instance().enableEventHandling(!0)},e._refCount=0,e}();(0,o.l)(kM,"DisabledEventHandler",null,[Sys.IDisposable]);var DM=function(){function e(){}return e.registerActions=function(){Wr.App.oneNotePrintIsEnabled&&L.AFrameworkApplication.get_theActionManager().addAction(ii.mo,nt.a,e.requestPrintPreview)},e.requestPrintPreview=function(t,n,r,i,o){if(!Br.App.get_activeAppFrame().workspace.get_contentView()||!Br.App.get_activeAppFrame().workspace.get_contentView().get_isPageView()||!Br.App.get_activeAppFrame().workspace.get_contentView().get_targetNode())return 8;if(1===r)return 32;var a=new Date;if(Math.abs(a.getTime()-e._lastPrintRequestStamp.getTime())<1500)return 8;e._lastPrintRequestStamp=a;var s=new kM;try{var l=Br.App.get_activeAppFrame().workspace.get_contentView(),c=L.AFrameworkApplication.get_isRtl(),u=l.get_isSingleOutlineLayout(),g=l.getViewWidth(),p="",d="",h=document.getElementById("BottomRightPin");null!=h&&(p=h.style.left,d=h.style.top);var _=!1,m=!1,f=document.getElementById("PageContentContainer");if(f){for(var y=f.children,S=0;S<y.length;S++){if(y[S].className.indexOf("WACImageContainer")>-1){_=!0;break}}m=f.getElementsByTagName("svg").length>0}return C.ULS.sendTraceTag(4813469,330,50,"OneNote.PrintActor.RequestPrintPreview {0}",{isSingleOutlineLayout:u,viewWidth:g,contentWidth:p,contentHeight:d,hasPageLevelImages:_,containsInk:m,isRtl:c}),Nt.FocusManager.tryFocus(window.self)?(G.y.get_isInternetExplorerNonEdge()||G.y.get_isInternetExplorerEdge()?window.document.execCommand("print",!1,null):window.print(),C.ULS.sendTraceTag(4813470,330,50,"OneNote.PrintActor.RequestPrintPreview: SUCCESS"),32):(C.ULS.sendTraceTag(4813471,330,50,"OneNote.PrintActor.RequestPrintPreview: FAILURE"),8)}finally{s&&s.dispose()}},e._lastPrintRequestStamp=new Date,e}();(0,o.l)(DM,"PrintActor",null,[]);var MM=function(){function e(e,t){this._actionManager=null,this._proofingManager=null,this.hideSpellingErrorsToggle=!1,this._actionManager=e,this._proofingManager=t}return e.prototype.get_hideSpellingErrorsCookie=function(){var t=ve.g(e.hideSpellingErrorsCookieValue);return!!t&&"true"===t.toLowerCase()},e.prototype.set_hideSpellingErrorsCookie=function(t){return ve.r(e.hideSpellingErrorsCookieValue,t.toString(),e.hideSpellingErrorsCookieExpirationDays)||C.ULS.sendTraceTag(6824535,339,50,"Failed to set cookie for hide spelling errors to {0}",t.toString()),t},e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(eb.cZ,cl.n,o.i(this,this.hideSpellingErrorsButtonQueryCommand,"hideSpellingErrorsButtonQueryCommand"),100),this._actionManager.addActionWithFlags(eb.dT,cl.n,o.i(this,this.hideSpellingErrorsButtonCommand,"hideSpellingErrorsButtonCommand"),4)},e.prototype.initializeHideSpellingErrorsToggleFromCookie=function(){this.hideSpellingErrorsToggle=this.get_hideSpellingErrorsCookie(),this.hideSpellingErrorsToggle?(C.ULS.sendTraceTag(6685903,339,50,"HideProofingErrors:Initialized:On"),this.hideOrShowSpellingErrors()):C.ULS.sendTraceTag(6685905,339,50,"HideProofingErrors:Initialized:Off")},e.prototype.hideOrShowSpellingErrors=function(){this.hideSpellingErrorsToggle?C.ULS.sendTraceTag(6685906,339,50,"HideProofingErrors:Toggled:Off"):C.ULS.sendTraceTag(6685904,339,50,"HideProofingErrors:Toggled:On"),this._proofingManager.set_shouldHideSpellingErrors(this.hideSpellingErrorsToggle)},e.prototype.hideSpellingErrorsButtonQueryCommand=function(e,t,n,r,i){return 1===n?32:(i[Di.e.On]=this.hideSpellingErrorsToggle,32)},e.prototype.hideSpellingErrorsButtonCommand=function(e,t,n,r,i){return 1===n?32:(this.hideSpellingErrorsToggle=!this.hideSpellingErrorsToggle,this.hideOrShowSpellingErrors(),this.set_hideSpellingErrorsCookie(this.hideSpellingErrorsToggle),32)},e.getHideSpellingActorWithResolvedDependencies=function(){var t=new e(L.AFrameworkApplication.get_theActionManager(),Br.App.theProofingManager);return t.initializeHideSpellingErrorsToggleFromCookie(),t},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=e.getHideSpellingActorWithResolvedDependencies())},e.hideSpellingErrorsCookieValue="OneNoteHideSpellingErrors",e.hideSpellingErrorsCookieExpirationDays=30,e._singletonInstance=null,e}();(0,o.l)(MM,"ProofingActor",null,[]);var RM=n(7342),LM=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionDialogDescription,OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionDialogEnterPassword,OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionRequestFailedText)},e.dialogHtmlFormat="<div class='WACDialogRow' id='description'> {0} </div> <div class='WACDialogRow' id='block1'> <label id='label1' class='WACDialogLabel' for='password' >{1}</label> <input type='password' id='password' class='WACDialogInput' autocomplete=\"off\"/> <div class='WACDialogError' id='errorText' role='alert'>{2}</div> </div>",e}();(0,o.l)(LM,"EnterPasswordDialogHtml",null,[]);var NM=function(e){function t(t){var n=e.call(this)||this;n.set_dialogHtml(LM.get_dialogHtml()),n.setButtonText(1,CommonUIStrings.l_DialogOk);Nt.FocusManager.instance().get_currentScope()&&Nt.FocusManager.instance().get_currentScope().name===kg.u.fishbowlFocusId&&n.set_dismissFocusScope(Nt.FocusManager.instance().get_currentScope().name),n.initializeAndShow(OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionDialogTitle,o.i(n,n.enterPasswordDialogHandler,"enterPasswordDialogHandler"),{password:""}),n.setDescribedByForDialog("description");var r=document.getElementById("errorText");return r&&(r.style.display="none",76===t?(r.style.display="inline-block",r.innerText=OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionWrongPasswordText,L.AFrameworkApplication.get_theActionManager().processAction(ii.EI,2)):-1!==t&&t&&(r.style.display="inline-block",r.innerText=OneNoteIntl.OneNoteStrings.l_PasswordProtectedSectionRequestFailedText,L.AFrameworkApplication.get_theActionManager().processAction(ii.HN,2))),document.getElementById("password").focus(),n}return(0,S.t)(t,e),t.prototype.detachDialogEvents=function(){L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().unregisterHandler(Le.d.keyDown,document.getElementById("password"),o.i(this,this.enterPasswordDialogKeyHandler,"enterPasswordDialogKeyHandler")),L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().unregisterHandler(Le.d.keyPress,document.getElementById("password"),o.i(this,this.enterPasswordDialogKeyHandler,"enterPasswordDialogKeyHandler")),L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().unregisterHandler(Le.d.keyUp,document.getElementById("password"),o.i(this,this.enterPasswordDialogKeyHandler,"enterPasswordDialogKeyHandler")),e.prototype.detachDialogEvents.call(this)},t.prototype.attachDialogEvents=function(){L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().registerHandler(Le.d.keyDown,document.getElementById("password"),o.i(this,this.enterPasswordDialogKeyHandler,"enterPasswordDialogKeyHandler")),L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().registerHandler(Le.d.keyPress,document.getElementById("password"),o.i(this,this.enterPasswordDialogKeyHandler,"enterPasswordDialogKeyHandler")),L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().registerHandler(Le.d.keyUp,document.getElementById("password"),o.i(this,this.enterPasswordDialogKeyHandler,"enterPasswordDialogKeyHandler")),e.prototype.attachDialogEvents.call(this)},t.prototype.enterPasswordDialogKeyHandler=function(e){return e.innerEvent.keyCode===Sys.UI.Key.enter&&(e.eventName===Le.d.keyUp&&this.getButtonElement(1).click(),!0)},t.prototype.enterPasswordDialogHandler=function(e,t){0!==e&&L.AFrameworkApplication.get_theActionManager().processActionWithData(ii.Gj,2,t.password)},t}(ri.o);(0,o.l)(NM,"EnterPasswordDialog",ri.o,[]);var BM=function(e){function t(){var t=e.call(this)||this;return t.FileQuerySignature=null,t.Password=null,t}return(0,S.t)(t,e),t.prototype.getClassId=function(){return 30},t.constructUnlockSectionRequest=function(e,n){var r=new t;return r.FileQuerySignature=e,r.Password=n,r},t}(Ph.z);(0,o.l)(BM,"UnlockSectionRequest",Ph.z,[]);var OM=function(e,t,n,r,i){return new NM(-1),32},UM=function(e,t,n,r,i){if(!(!((new Date).getTime()-L.AFrameworkApplication.get_latestActivityTime().getTime()>RM.h.lockInterval)||GM()))return 32;var o=new De.c(2,1,RM.h.lockInterval,$M);return L.AFrameworkApplication.get_theTaskManager().addTask(o),32},HM=function(e,t,n,r,i){return GM(),32},GM=function(){var e=!1,t=Wr.App.get_activeOneNoteFrame().workspace.get_unlockedSections();for(var n in t){var r={key:n,value:t[n]};r.value.get_isConnected()&&(r.value.tryLockSection()||(e=!0))}return e},VM=function(e,t,n,r,i){return WM(i)?32:8},WM=function(e){if(!e)return!1;var t=Wr.App.get_activeOneNoteFrame().workspace.get_activeSection();if(Wr.App.get_instance().get_isCSEncryptedSectionEnabled()&&(t.get_contentReplicator()||C.ULS.sendTraceTag(41011233,395,10,"Unlock Encrypted section: IsContentSyncSocketConnected is true but the active section:{0} does not have a content replicator associated with it.",t.get_objectSpaceId()),t.get_contentReplicator()&&t.get_contentReplicator().get_isUsingOneNoteContentSync()))return t.get_contentReplicator().startWithPassword(e,zM,KM),!0;C.ULS.sendTraceTag(42014680,339,15,"Falling back to wac sync for encrypted sections.");var n=BM.constructUnlockSectionRequest(t.get_fileQuerySignature(),e),r=Eb.y(n),i={"Content-Type":"application/json; charset=utf-8"};return L.AFrameworkApplication.theClientRequestManager.addRequest(Br.App.webServiceBase+"OneNote.ashx",2,r,i,!1,2,qM,jM,n),!0},zM=function(){C.ULS.sendTraceTag(40739596,339,15,"Unlocking the encrypted section with the given password succeeded."),Wr.App.get_activeOneNoteFrame().workspace.onAfterSectionUnlock();var e=new De.c(2,1,RM.h.lockInterval,$M);L.AFrameworkApplication.get_theTaskManager().addTask(e)},KM=function(e){C.ULS.sendTraceTag(40739597,339,15,"Unlocking the encrypted section with the given password failed with status code:{0}. Prompting password dialog again.",e),new NM(e)},qM=function(e){var t,n;if(Bh.j.tryDeserializeServerResponse(e.get_data().responseData,(0,p.m)((function(){return n}),(function(e){return n=e}))))if((t=n.Responses[0]).StatusCode)new NM(t.StatusCode);else{var r=Wr.App.get_activeOneNoteFrame().workspace;r.get_activeSection().set_encryptionSessionString(t.EncryptionSessionString),r.onAfterSectionUnlock();var i=new De.c(2,1,RM.h.lockInterval,$M);L.AFrameworkApplication.get_theTaskManager().addTask(i)}else new NM(14)},jM=function(e){var t,n=14;Bh.j.tryDeserializeServerResponse(e.get_data().responseData,(0,p.m)((function(){return t}),(function(e){return t=e})))&&(n=t.Responses[0].StatusCode),new NM(n)},$M=function(e){L.AFrameworkApplication.get_theActionManager().processAction(ii.Ai,2)},QM=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.showPasswordDialog=function(){this.get_actionManager().processAction(ii.aA,2)},e}();(0,o.l)(QM,"ProtectedSectionCommands",null,[VP.c]);var JM=function(){function e(e,t,n){this._recycleBinManager=null,this._contextMenuDataProvider=null,this._pageEditor=null,this._recycleBinManager=e,this._pageEditor=t,this._contextMenuDataProvider=n}return e.prototype.registerActions=function(e){e.addAction(eb.uN,cl.n,o.i(this,this.toggleRecycleBinVisibility,"toggleRecycleBinVisibility")),e.addAction(eb.uN,cl.q,o.i(this,this.toggleRecycleBinVisibility,"toggleRecycleBinVisibility")),e.addActionWithFlags(eb.FS,cl.n,o.i(this,this.queryRecycleBinVisibility,"queryRecycleBinVisibility"),96),e.addActionWithFlags(eb.FS,cl.q,o.i(this,this.queryRecycleBinVisibility,"queryRecycleBinVisibility"),96),e.setActionFlags(eb.FS,64),e.addAction(eb.ce,cl.n,o.i(this,this.showRestorePageDialog,"showRestorePageDialog")),e.addAction(eb.Io,cl.n,o.i(this,this.restorePage,"restorePage")),e.addAction(eb.PZ,cl.n,o.i(this,this.permanentlyDeletePage,"permanentlyDeletePage"))},e.prototype.toggleRecycleBinVisibility=function(e,t,n,r,i){return!Wr.App.get_instance().notebookType.retrieved||Wr.App.get_instance().notebookType.isEduNotebook||this._recycleBinManager.isRecycleBinLoading()?8:1===n?32:2===n?(this._recycleBinManager&&this._recycleBinManager.setRecycleBinVisibility(!this._recycleBinManager.isRecycleBinVisible()),Br.App.get_activeAppFrame().updateCommandUI(),32):2},e.prototype.queryRecycleBinVisibility=function(e,t,n,r,i){this._recycleBinManager&&(i[Di.e.On]=this._recycleBinManager.isRecycleBinVisible());return 32},e.prototype.showRestorePageDialog=function(e,t,n,r,i){if(1===Br.App.get_activeAppFrame().get_mode())return 8;if(1===n)return 32;if(2===n){var o=this._contextMenuDataProvider.clickedPage(i),a=se.w.get_instance().tryResolve(Rx);return a&&a.showRestorePageDialog(o),32}return 2},e.prototype.restorePage=function(e,t,n,r,i){if(1===Br.App.get_activeAppFrame().get_mode())return 8;if(1===n)return 32;if(2===n){var o=i,a=o.source,s=o.destination;return this._pageEditor.restorePage(a,s),32}return 2},e.prototype.permanentlyDeletePage=function(e,t,n,r,i){if(1===Br.App.get_activeAppFrame().get_mode())return 8;if(1===n)return 32;if(2===n){var o=this._contextMenuDataProvider.clickedPage(i);return this._pageEditor.deletePage(o,!0),32}return 2},e}();(0,o.l)(JM,"RecycleBinActor",null,[]);var XM=function(){function e(){}return e.get_dialogHtml=function(){return ri.o.formatHtml(e.dialogHtmlFormat,Box4Intl.Box4Strings.l_PasswordProtectedSectionLockWarningMessage)},e.dialogHtmlFormat="<div class='WACDialogRow' id='description'> {0} </div>",e}();(0,o.l)(XM,"LockFailedDialogHtml",null,[]);var YM=function(e){function t(t){var n=e.call(this)||this;n.setButtonText(1,CommonUIStrings.l_DialogOk),n.set_buttonsOption(4),n.set_dialogHtml(XM.get_dialogHtml()),n.setButtonText(1,Box4Intl.Box4Strings.l_PasswordProtectedSectionLockButton),n.setButtonText(2,Box4Intl.Box4Strings.l_PasswordProtectedSectionNoLockButton);var r={section:t};return n.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,o.i(n,n.lockFailedDialogHandler,"lockFailedDialogHandler"),r),n.setDescribedByForDialog("description"),n}return(0,S.t)(t,e),t.prototype.lockFailedDialogHandler=function(e,t){1===e&&t.section.forceLockSection()},t.showDialogForSingleSection=function(e){var n=e;n.getHtmlViewElement(Br.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId()).setIsLoading(!1),new t(n)},t}(ri.o);(0,o.l)(YM,"LockFailedDialog",ri.o,[]);var ZM=function(){function e(){}return e.prototype.get_application=function(){return se.w.get_instance().resolve(QP)},e.prototype.get_browser=function(){return se.w.get_instance().resolve(JP)},e.prototype.get_dialogService=function(){return se.w.get_instance().resolve(XP)},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager();e.addAction(ii.PQ,cl.n,o.i(this,this.renameSection,"renameSection")),e.addAction(ii.jS,cl.n,o.i(this,this.deleteSection,"deleteSection")),e.addAction(ii.hm,cl.n,o.i(this,this.lockSection,"lockSection")),e.addAction(ii.TX,cl.n,o.i(this,this.newPage,"newPage")),e.addAction(ii.yn,cl.n,o.i(this,this.newSection,"newSection")),e.addAction(ii.HA,cl.U,o.i(this,this.changeSectionColor,"changeSectionColor")),e.addAction(ii.tS,cl.n,o.i(this,this.sectionColorMenu,"sectionColorMenu")),e.addActionWithFlags(ii.Vw,cl.n,o.i(this,this.querySectionColor,"querySectionColor"),97),e.addAction(eb.dg,cl.n,o.i(this,this.pastePage,"pastePage")),e.addAction(eb.op,cl.n,o.i(this,this.getSectionUrl,"getSectionUrl"))},e.prototype.getSectionUrl=function(t,n,r,i,o){var a=e.get_contextMenuDataProvider().clickedSection(o);return this.isCopySectionLinkAllowed(a)?(2===r&&this.copySectionLinkToClipboard(a),32):8},e.prototype.oreoCopySectionLinkToClipboard=function(e){var t=iD.get_instance().findGraphSpaceNode(e,131121);this.copySectionLinkToClipboard(t)},e.prototype.copySectionLinkToClipboard=function(t){var n,r=this.get_application().getWebAppLink(t);r=wM.formatUrlStringToIncludeEntryPoint(r,e.navPaneCopyLinkToSectionEntryPointParam);try{if(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteHyperlinkIsEnabled")){var i=this.get_application().getNativeAppLink(t),o=_T.k(t);n=this.get_browser().copyHyperlinkToClipboard(r,i,o)}else n=this.get_browser().copyToClipboard(r)}catch(e){n=!1}n||this.get_dialogService().displayPageUrlDialog(r)},e.prototype.oreoIsCopySectionLinkAllowed=function(t){var n=e.get_contextMenuDataProvider().clickedSection(t);return this.isCopySectionLinkAllowed(n)},e.prototype.isCopySectionLinkAllowed=function(e){return!!e&&e.get_isContentPresent()},e.prototype.renameSection=function(t,n,r,i,o){var a=e.get_contextMenuDataProvider().clickedSection(o);if(!(a&&1!==Br.App.get_activeAppFrame().get_mode()&&Br.App.notebookMode&&this.userHasFullAccessToSection(a)&&a.get_isContentPresent()))return 8;if(1===r&&!_T.p(a))return 8;if(2===r){var s=(0,f.e)(Object,o);if(s&&"NewTitle"in s){e.get_contextMenuDataProvider().clickedSection(o);var l=s.NewTitle;if(!l)return 8;var c=new as.GraphTransaction(7);c.setFromNode(a),e.get_sectionEditor().setTitleForRenameSection(a,l),e.get_sectionEditor().setFileIdForSection(a),a.get_anchor().invalidateViewChannelForAllViews(4),c.dispose()}else{var u=a.getParentGraphSpace();iM.show(a,u,!1)}}return 32},e.prototype.deleteSection=function(t,n,r,i,o){var a=e.get_contextMenuDataProvider().clickedSection(o);return a&&1!==Br.App.get_activeAppFrame().get_mode()&&Br.App.notebookMode&&this.userHasAccessToDeleteSection(a)&&a.get_isContentPresent()&&(1!==r||_T.p(a))?(2===r&&("boolean"==typeof o&&o?e.get_sectionEditor().deleteSection(a):e.get_sectionEditor().showDeleteSectionDialog(a)),32):8},e.prototype.lockSection=function(t,n,r,i,a){var s=e.get_contextMenuDataProvider().clickedSection(a);if(2===r)if(s.isSectionLockable()){if(!s.tryLockSection())return 8}else s.getHtmlViewElement(Br.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId()).setIsLoading(!0),Br.App.theNotebookManager.saveNotebook(o.i(this,this.lockSaveSucceeded,"lockSaveSucceeded"),YM.showDialogForSingleSection,s,!1);return 32},e.prototype.lockSaveSucceeded=function(e){var t=e;t.getHtmlViewElement(Br.App.get_activeAppFrame().workspace.get_navigationPaneView().get_viewId()).setIsLoading(!1),t.tryLockSection()},e.prototype.newPage=function(t,n,r,i,o){var a=e.get_contextMenuDataProvider().clickedSection(o);if(!a||1===Br.App.get_activeAppFrame().get_mode()||!this.userHasFullAccessToSection(a))return 8;if(2===r){var s=new Da.GraphIterator;s.set(a),qr.k(s);var l=new as.GraphTransaction(7);l.setFromIterator(s),a.ensureContentGraphConnection(),Br.App.get_activeAppFrame().workspace.set_activePage(e.get_sectionContentEditor().createPage(s)),l.dispose()}return 32},e.prototype.newSection=function(t,n,r,i,o){if(1===Br.App.get_activeAppFrame().get_mode()||!Br.App.notebookMode)return 8;var a=e.get_contextMenuDataProvider().clickedSection(o);if(2===r){var s=a,l=a.getParentGraphSpace();iM.show(s,l,!0)}return 32},e.prototype.changeSectionColor=function(t,n,r,i,o){var a=e.get_contextMenuDataProvider().clickedSection(o);return a&&1!==Br.App.get_activeAppFrame().get_mode()&&Br.App.notebookMode&&this.userHasFullAccessToSection(a)&&a.get_isContentPresent()?(2===r&&e.get_sectionEditor().setSectionColor(a,e.get_contextMenuDataProvider().getColorFromActionData(o)),32):8},e.prototype.sectionColorMenu=function(t,n,r,i,o){var a=e.get_contextMenuDataProvider().clickedSection(o);return a&&1!==Br.App.get_activeAppFrame().get_mode()&&Br.App.notebookMode&&this.userHasFullAccessToSection(a)&&a.get_isContentPresent()?32:8},e.prototype.querySectionColor=function(t,n,r,i,o){var a=o,s=e.get_contextMenuDataProvider().clickedSection(o),l=parseInt(a.MenuItemId);if(isNaN(l))return 8;var c=l,u=_T.R(s),g=Xy.o.notebookBGRValueToColor[u.toString()];return a.On=c===g,32},e.prototype.pastePage=function(t,n,r,i,o){var a=e.get_contextMenuDataProvider().clickedSection(o);return a&&this.userHasFullAccessToSection(a)?1===r?e.get_clipboard()?e.get_clipboard().readyForPasteClipboardOperation(a,e.get_clipboard()):8:2===r?(e.get_clipboard().pastePagesFromOneNoteClipboard(a),32):2:8},e.prototype.userHasFullAccessToSection=function(e){return!_T.Q(e)&&1===e.get_accessRights()},e.prototype.userHasAccessToDeleteSection=function(e){return!!e&&1===e.get_accessRights()&&(!_T.Q(e)||_T.n(e))},e.get_contextMenuDataProvider=function(){return e._contextMenuDataProvider||(e._contextMenuDataProvider=se.w.get_instance().resolve(WP))},e.get_sectionContentEditor=function(){return e._sectionContentEditor||(e._sectionContentEditor=se.w.get_instance().resolve(YT.x))},e.get_sectionEditor=function(){return e._sectionEditor||(e._sectionEditor=se.w.get_instance().resolve(CT.f))},e.get_clipboard=function(){return e._clipboard||(e._clipboard=se.w.get_instance().resolve(_M))},e._contextMenuDataProvider=null,e._sectionContentEditor=null,e._sectionEditor=null,e._clipboard=null,e.navPaneCopyLinkToSectionEntryPointParam="wdorigin=717",e}();(0,o.l)(ZM,"SectionNavPaneContextMenuActor",null,[KP.y]);var eR=function(){function e(){}return e.prototype.registerActions=function(e){e.addAction(eb.JP,cl.U,o.i(this,this.updateCustomHeaderButtonBadge,"updateCustomHeaderButtonBadge")),e.addAction(eb.Qr,cl.U,o.i(this,this.updateCustomHeaderButtonState,"updateCustomHeaderButtonState"))},e.prototype.updateCustomHeaderButtonBadge=function(e,t,n,r,i){if(1===n)return 32;var o=i,a=o.id.toString(),s=o.badge;return appChrome.api.dispatch(appChrome.actions.setCustomHeaderButtonBadge(a,s)),32},e.prototype.updateCustomHeaderButtonState=function(e,t,n,r,i){if(1===n)return 32;var o=i,a=o.id.toString(),s=o.state;return appChrome.api.dispatch(appChrome.actions.setCustomHeaderButtonState(a,s)),32},e}();(0,o.l)(eR,"SharedHeaderNotificationActor",null,[]);var tR=n(7816),nR=function(){function e(e,t,n,r,i,o,a,s,l){void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=null),void 0===l&&(l=null),this._autoCorrectRules=null,this._autoCorrectScheduler=null,this._undoManager=null,this._undoManagerFactory=null,this._tabActorPromoteDemoteStrategy=null,this._externalSelectionManagerFuture=null,this._tabPresenterFactory=null,this._blobEditor=null,this._featureHelper=null,this._graphTransactionFactory=null,this._userHasTriedInsertingInlineTab=!1,this._undoManagerFactory=e,this._tabActorPromoteDemoteStrategy=t,this._externalSelectionManagerFuture=n,this._autoCorrectRules=r,this._autoCorrectScheduler=i,this._tabPresenterFactory=o,this._blobEditor=a,this._featureHelper=s,this._graphTransactionFactory=l}return e.prototype.get_undoManager=function(){return this._undoManager||(this._undoManager=this._undoManagerFactory())},e.prototype.registerActions=function(){var e=L.AFrameworkApplication.get_theActionManager(),t=o.i(this,this.tabView,"tabView");e.addActionWithFlags(ii.Mf,cl.n,t,1124),e.addActionWithFlags(ii.vb,cl.n,t,1124),e.addAction(ii.eU,cl.n,Ze.ActionManager.doNothingButReportHandler)},e.prototype.tabView=function(t,n,r,i,o){var a=this;if(1===r)return 32;var s,l=t===ii.vb;if(!n.view.get_isInteractiveView())return 2;var c=n.view,u=c.get_selectionManager(),g=u.get_selectionContextForActionDispatch();if(!g)return 2;if(us.n.get_instance().get_item(14)&&e.get_lockedRangeEditor().contextSetContainsLockedRange(g))return 2;if(this._externalSelectionManagerFuture&&this._externalSelectionManagerFuture.get_instance()&&this._externalSelectionManagerFuture.get_instance().isExternalSelectionContext(g))return 4;var p=null,d=Ze.ActionManager.nullAction,h=!1,_=Pa.SelectionEditor.isInsertionPointContext(g);if(g.get_isContextSet()){if(u.get_selectionCollection().isOutlineLevelSelection){var m=g.getContext(0);(p=new Da.GraphIterator).set(m.get_node()),p.tryToRootAtPageContent(),d=l?ii.Rl:ii.Xg}if((d=this._tabActorPromoteDemoteStrategy.priorityPromoteDemote(n,i,o,d,l?ii.lN:ii.Hm))===Ze.ActionManager.nullAction){var f=e.get_contextSetEditor().attemptToGeneralizeToNodeContextOfType(g,16);if(f)l&&(d=ii.Bd),(p=new Da.GraphIterator).set(f.get_node()),p.tryToRootAtOutlineAncestor();else{if(us.n.get_instance().get_item(77))return 2;if(e.isContextInTitle(g)){if(l)return 2;d=ii.ob}else d=l?ii.lN:ii.Hm}}}else{if(!g.get_isGraphNodeContext())return 2;if((p=new Da.GraphIterator).set(g.get_node()),Pa.SelectionEditor.tryToRootIteratorAtTopmostSelectableContentContainer(p),vc.isOutlineLevelContext(g))d=l?ii.Rl:ii.Xg;else{d=l?this._tabActorPromoteDemoteStrategy.graphNodePlanPromote(p,g,d,n):this._tabActorPromoteDemoteStrategy.graphNodePlanDemote(p,g,d,n),Ls.OutlineElementReader.isOutlineElement(p)&&g.get_contextId()===cl.V&&(h=Ls.OutlineElementReader.isIpAtStartOrEnd(p,g,!1));var y=mc.ListReader.isListOutlineElement(p)&&h;d!==Ze.ActionManager.nullAction||Zc.isTableCellOrInside(p)||y||(this._userHasTriedInsertingInlineTab||(C.ULS.sendTraceTag(39662619,383,50,"User tried to insert inline tabs"),this._userHasTriedInsertingInlineTab=!0),L.AFrameworkApplication.get_theActionManager().processAction(ii.eU,2),L.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordWordEditorInlineTabInsertionSettings"),this._featureHelper&&this._featureHelper.isFeatureEnabled(81)&&this._featureHelper.isFeatureEnabled(80)&&this.insertInlineTab(n))}}if(!l&&d===Ze.ActionManager.nullAction&&Zc.isTableCellOrInside(p))if(ld.returnToCell(p),Zc.isLastCellInTable(p)||dc.TableReader.isInComplexTable(p)&&Zc.isLastCellInTableIgnoringGhostCells(p)){if(!(d=this.actionWhenTabAtLastCell(p,g)))return 2}else d=ii.kp;if(d===Ze.ActionManager.nullAction)return 2;switch(d){case ii.ob:ak.f.get_instance().leaveTitle(t,g,n.view),s=32;break;case ii.Is:ak.f.get_instance().enterTitle(t,g,n.view),s=32;break;case ii.kp:case ii.Bd:var S=d===ii.Bd;if(_&&this._autoCorrectRules&&this._autoCorrectScheduler){var v=this._autoCorrectRules.findGraphAutoCorrectMatch(g,-1,!0,Je.v.vK_Tab);v&&this._autoCorrectScheduler.scheduleAction(v)}if(s=32,ld.returnToCell(p),ld.moveToNextOrPreviousCell(p,S)){var b=!0,T=!1;vc.hasMultipleOutlineElements(p)||(Sc.moveToFirstOrLastOutlineElement(p,!1),hs.OutlineElementNavigator.moveToContent(p),cs.ParagraphReader.canContainIpOrTextRange(p.get_currentNode())&&(b=!1,cs.ParagraphReader.textLength(p.get_currentNode())||(T=!0)),T||ld.returnToCell(p));var A=void 0;if(T)A=ss.SelectionFactory.createIpSelection(p.get_currentNode(),0);else if(A=ss.SelectionFactory.createSelectionFromNode(p.get_currentNode()),!b&&Pa.SelectionEditor.isEndOfParagraphContext(A.get_lastContext())){var I=A.toArray();Array.removeAt(I,I.length-1),A=new X_.Selection(I,A.isForward)}u.setSelection(A)}break;case ii.Rl:case ii.Xg:d===ii.Xg?Sc.moveToNextOrPreviousSelectableOutline(p,!1):Sc.moveToNextOrPreviousSelectableOutline(p,!0),u.setSelection(ss.SelectionFactory.createSelectionFromNode(p.get_currentNode())),s=32;break;case ii.wz:if(s=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,d,r,!0,i,o),1===Br.App.get_mode()&&ld.moveToNextOrPreviousCell(p,!1)){ld.returnToCell(p);A=ss.SelectionFactory.createCollapsedSelection(p.get_currentNode(),!0);if(Pa.SelectionEditor.isEndOfParagraphContext(A.get_lastContext())){I=A.toArray();Array.removeAt(I,I.length-1),A=new X_.Selection(I,A.isForward)}u.setSelection(A)}break;default:if(s=L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(n,d,r,!0,i,o),!h&&_&&(d===ii.lN||d===ii.Hm)){var w=u.get_selectionCollection().get_currentSelection(),x=Pa.SelectionEditor.boundsFromSelection(w).y;Br.App.registerAfterActionCallback((function(){a.moveIpToStartOfLine(u,c,x)}))}}return 32===s&&n.view.get_isInteractiveView()&&this.get_undoManager().interruptUndoMerging(),s},e.prototype.moveIpToStartOfLine=function(e,t,n){if(e&&t){var r,i=e.get_selectionCollection().get_currentSelection();Pa.SelectionEditor.boundsFromSelection(i).y<n?(r=Pa.SelectionEditor.findLineEndIp(t,i,!1),r=Pa.SelectionEditor.findNextIp(r,!1,!1,!1,!0)):r=Pa.SelectionEditor.findLineFirstIp(t,i,!1),e.setSelection(r)}},e.prototype.actionWhenTabAtLastCell=function(e,t){return ii.QL},e.prototype.insertInlineTab=function(e){},e.prototype.moveIp=function(e,t,n){if(e&&t){var r,i=e.get_selectionCollection().get_currentSelection();Pa.SelectionEditor.boundsFromSelection(i).y<n?(r=Pa.SelectionEditor.findLineEndIp(t,i,!1),r=Pa.SelectionEditor.findNextIp(r,!1,!1,!1,!0)):r=Pa.SelectionEditor.findNextIp(i,!1,!1,!1,!0),e.setSelection(r)}},e.get_lockedRangeEditor=function(){return ls.k.get_instance()},e.get_contextSetEditor=function(){return kf.ContextSetEditor.get_instance()},e.isContextInTitle=function(t){var n=e.get_contextSetEditor().attemptToGeneralizeToNodeContextOfType(t,10);return!!n&&Hr.l(n)},e}();(0,o.l)(nR,"TabActor$0",null,[]);var rR=(0,o.y)("ITabActorPromoteDemoteStrategy"),iR=function(){function e(e){this._indentationEditor=null,this._indentationEditor=e}return e.prototype.get_indentationEditor=function(){return this._indentationEditor},e.prototype.priorityPromoteDemote=function(e,t,n,r,i){r===Ze.ActionManager.nullAction&&(32===L.AFrameworkApplication.get_theActionManager().processActionAgainstContext(e,i,1,!0,t,n)&&(r=i));return r},e.prototype.graphNodePlanPromote=function(e,t,n,r){return Hr.b(e)?cs.ParagraphReader.isParagraphContext(t)?(n=ii.Rl,Sc.returnToOutline(e)):n=Ze.ActionManager.nullAction:(hs.OutlineElementNavigator.returnToOutlineElement(e),n=this.get_indentationEditor().canPromote(e,-1)?ii.lN:Zc.isTableCellOrInside(e)?ii.Bd:this.isFirstOutlineInPage(e)?ii.Is:ii.lN),n},e.prototype.graphNodePlanDemote=function(e,t,n,r){return Hr.b(e)?cs.ParagraphReader.isParagraphContext(t)?(n=ii.Xg,Sc.returnToOutline(e)):n=ii.ob:Pa.SelectionEditor.isInsertionPointContext(t)?Pa.SelectionEditor.isIpAtStartOrEnd(e.get_currentNode(),t,!1)?(hs.OutlineElementNavigator.returnToOutlineElement(e),this.get_indentationEditor().canDemote(e,1)&&(n=ii.Hm)):Zc.isInTableCell(e)||(n=ii.eK):(hs.OutlineElementNavigator.returnToOutlineElement(e),this.get_indentationEditor().canDemote(e,1)&&(n=ii.Hm)),n},e.prototype.isFirstOutlineInPage=function(e){return Cc.k.first===Ls.OutlineElementReader.getAbsoluteOutlineLevel(e)&&(Sc.returnToOutline(e),!e.goToPreviousSiblingByRole(1))},e.getAnInstanceWithResolvedDependencies=function(){return new e(yc.z.get_getOutlineElementIndentationEditor())},e}();(0,o.l)(iR,"TabActorPromoteDemoteStrategy",null,[rR]);var oR=function(e){function t(t,n,r,i,o){return e.call(this,t,n,r,i,o)||this}return(0,S.t)(t,e),t.prototype.actionWhenTabAtLastCell=function(e,t){return 1===dc.TableReader.getRowCount(ld.getContainingTable(e))?Pa.SelectionEditor.isInsertionPointContext(t)?ii.wz:ii.fB:Pa.SelectionEditor.isInsertionPointContext(t)?ii.Jy:ii.QL},t.get_instance=function(){return t._instance||(t._instance=t.getInstanceWithResolvedDependencies())},t.getInstanceWithResolvedDependencies=function(){return new t((function(){return se.w.get_instance().resolve(ja.n)}),iR.getAnInstanceWithResolvedDependencies(),se.w.get_instance().resolveFuture(gh.i),se.w.get_instance().resolve(Ha.r),se.w.get_instance().resolve(qa.g))},t._instance=null,t}(nR);(0,o.l)(oR,"TabActor",nR,[]);var aR=function(e,t,n,r,i){if(t.get_contextId()!==nt.a)return 2;var o=L.AFrameworkApplication.get_activeFrame();return o?(o.beforeRefreshDocument(),sR(o),32):8},sR=function(e){var t=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled();t?C.ULS.sendTraceTag(36717077,340,50,"User is switching to Classic Ribbon from Single Line Ribbon in OneNote"):C.ULS.sendTraceTag(36717078,340,50,"User is switching to Single Line Ribbon from Classic Ribbon in OneNote");var n=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("IsSimplifiedRibbonOnCookieName");ve.r(n,(!t).toString(),ve.i),e.refreshDocument(null)},lR=function(){function e(){}return e.get_pageEditor=function(){return e._pageEditor||(e._pageEditor=se.w.get_instance().resolve(eA.f))},e.get_pageNavigator=function(){return zr.PageNavigator.get_instance()},e.get_pageReader=function(){return Qc.PageReader.get_instance()},e.get_versionHistoryEditor=function(){return e._versionHistoryEditor||(e._versionHistoryEditor=se.w.get_instance().tryResolve(tA.e))},e.get_businessBarControllerFuture=function(){return e._businessBarControllerFuture||(e._businessBarControllerFuture=se.w.get_instance().resolveFuture(ni.d))},e.get_contextMenuDataProvider=function(){return e._contextMenuDataProvider||(e._contextMenuDataProvider=se.w.get_instance().resolve(WP))},e.registerActions=function(){if(us.n.get_instance().get_item(47)){var t=L.AFrameworkApplication.get_theActionManager();t.addAction(ii.iP,cl.q,e.toggleVisibility),t.addAction(ii.sd,cl.q,e.queryVisibility),t.addAction(ii.QN,cl.q,e.restoreVersion),t.addAction(ii.Bm,cl.q,e.deleteVersion),t.addAction(ii.iP,cl.n,Br.App.get_activeAppFrame().workspace.currentPageActorHandler),t.addAction(ii.sd,cl.n,Br.App.get_activeAppFrame().workspace.currentPageActorHandler),t.addAction(ii.QN,cl.n,Br.App.get_activeAppFrame().workspace.currentPageActorHandler),t.addAction(ii.Bm,cl.n,Br.App.get_activeAppFrame().workspace.currentPageActorHandler),t.setActionFlags(ii.sd,1)}},e.toggleVisibility=function(t,n,r,i,o){var a=n.get_node();if(o){var s=o;if(s.PageId)a=e.get_contextMenuDataProvider().clickedPage(o);else{var l=e.getToggleVersionsSourceControl(s);3!==l&&l?1===l&&(a=Wx.get_versionClicked()||Wx.get_pageClicked()):a=n.get_node()}}if(!e.get_pageReader().isVersioningEnabled())return 8;if(1===r)return e.get_pageReader().isConflictPageNode(a)?8:32;if(e.get_pageReader().isVersionNode(a)){var c=e.get_pageNavigator().getContainingPageFromVersion(a),u=Br.App.get_activeAppFrame().workspace.get_activePage();u&&e.get_pageReader().isVersionNode(u)&&e.get_pageNavigator().getContainingPageFromVersion(u)===c&&Br.App.get_activeAppFrame().workspace.set_activePage(c),a=c}else if(e.get_pageReader().isConflictPageNode(a))return 8;var g=new as.GraphTransaction(3);g.setFromNode(a);var p=!e.get_pageReader().areVersionsVisible(a);e.get_pageEditor().setVersionsVisibility(a,p);var d=e.get_pageNavigator().getVersionHistoryNode(a);return d&&p&&(d.get_contentReplicator()||(d.attachContentReplicator("VersionHistory"),d.get_contentReplicator().forceInbound(null,null,null))),Br.App.get_activeAppFrame().updateCommandUI(),g.dispose(),Wx.set_versionClicked(null),32},e.getToggleVersionsSourceControl=function(e){switch(e.SourceControlId){case"fsbcShowVersions":return 3;case"fseaToggleVersionsVisibilityBusinessBar":return 0;case"fseaToggleVersionsVisibility":return 1;default:return 2}},e.queryVisibility=function(t,n,r,i,o){var a=n.get_node(),s=e.get_pageReader().isVersionNode(a)||e.get_pageReader().isConflictPageNode(a)&&e.get_pageReader().areVersionsVisible(e.get_pageNavigator().getContainingPage(a))||e.get_pageReader().areVersionsVisible(a);return o.setValue(zl.k.versionsVisible,s),32},e.restoreVersion=function(t,n,r,i,o){var a,s=o;if(a=s&&s.VersionId&&s.PageId?e.getVersionPageFromActionData(o):Wx.get_versionClicked()||n.get_node(),!e.get_pageReader().isVersionNode(a))return 8;if(1===Br.App.get_activeAppFrame().get_mode())return 8;if(!e.get_pageReader().isVersioningEnabled())return 8;if(1===r)return 32;var l=new as.GraphTransaction(7);return l.setFromNode(a),e.get_versionHistoryEditor().restoreVersion(a),l.dispose(),e.get_businessBarControllerFuture().execute((function(e){e.checkCurrentPageStatusBusinessBars()})),Wx.set_versionClicked(null),32},e.deleteVersion=function(t,n,r,i,o){var a,s=o;if(a=s&&s.VersionId&&s.PageId?e.getVersionPageFromActionData(o):Wx.get_versionClicked()||n.get_node(),!e.get_pageReader().isVersionNode(a))return 8;if(1===Br.App.get_activeAppFrame().get_mode())return 8;if(!e.get_pageReader().isVersioningEnabled())return 8;if(1===r)return 32;var l=new as.GraphTransaction(7);return l.setFromNode(a),e.get_pageEditor().showDeletePageDialog(a),l.dispose(),e.get_businessBarControllerFuture().execute((function(e){e.checkCurrentPageStatusBusinessBars()})),Wx.set_versionClicked(null),32},e.getVersionPageFromActionData=function(t){var n=t,r=e.get_contextMenuDataProvider().clickedPage(t),i=Dt.h.createFromString(n.VersionId.toString());return e.get_pageNavigator().getVersionHistoryNode(r).getChildGraphSpaceNodeForContext(i,!1)},e._pageEditor=null,e._versionHistoryEditor=null,e._businessBarControllerFuture=null,e._contextMenuDataProvider=null,e}();(0,o.l)(lR,"VersionHistoryActor",null,[]);var cR=n(138),uR=function(){function e(){this._container=null,this._businessBarControllerFuture=null}return e.prototype.get_businessBarControllerFuture=function(){return this._businessBarControllerFuture||(this._businessBarControllerFuture=se.w.get_instance().resolveFuture(ni.d))},e.prototype.get_name=function(){return"OneNote.Actors"},e.prototype.init=function(){var e,t,n,r,i,o;if(us.n.get_instance().get_item(3)&&Hk.registerActions(),Ur.InteractiveViewManager.get_instance().get_editingView().set_deleteActionsEnabled(!0),nD.get_instance().registerActions(L.AFrameworkApplication.get_theActionManager()),ok.get_instance().registerActions(),this._container.resolve(FD).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteParagraphSpacingIsEnabled")&&(wk.registerActions(),this._container.resolve(PM).registerActions()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAutoCorrectOptionSettingIsEnabled")&&this._container.resolve(fh).registerActions(),(L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")||L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioRecordingIsEnabled"))&&this._container.resolve(Bk.c).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")&&this._container.resolve(Lk.AudioPlaybackActor).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioRecordingIsEnabled")&&this._container.resolve(Nk.h).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInsertFileIsEnabled")&&this._container.resolve(CD).registerActions(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteSyncStatusEnabled")&&!L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSyncUxFeatureEnabled()&&this._container.resolve(tR.n).registerActions(L.AFrameworkApplication.get_theActionManager()),Wr.App.oneNoteMultiColumnNavPaneIsEnabled?(oM.registerActions(),e=Nt.FocusManager.instance(),t=e.getScope(kg.u.editingFocusID),n=e.getScope($e.AFrame.mainAppFocusId),r=e.getScope(AP.AppFrame.navSectionListFocusId),i=e.getScope(AP.AppFrame.navPageListFocusId),oM.registerMainShortcuts(n),oM.registerEditingShortcuts(t),oM.sectionNavPaneFocusId=AP.AppFrame.navSectionListFocusId,oM.registerNavigationShortcuts(r),oM.pageNavPaneFocusId=AP.AppFrame.navPageListFocusId,oM.registerNavigationShortcuts(i)):(oM.registerActions(),oM.registerShortcuts()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyToCloudIsEnabled")&&this._container.resolve(Gk).registerActions(L.AFrameworkApplication.get_theActionManager()),this._container.resolve(xM).registerActions(L.AFrameworkApplication.get_theActionManager()),(o=L.AFrameworkApplication.get_theActionManager()).addAction(ii.Tg,nt.a,ZD),o.addAction(ii.no,nt.a,ZD),o.addActionWithFlags(eb.CF,nt.a,eM,64),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteModeIsEnabled")&&function(e){e.addAction(ii.DU,nt.a,YD),e.addAction(ii.vv,nt.a,YD)}(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxFlightEnabled()&&function(e){e.addActionWithFlags(te.gO,nt.a,aR,128)}(L.AFrameworkApplication.get_theActionManager()),hM.registerActions(),TM.get_instance().registerActions(),function(){var e=L.AFrameworkApplication.get_theActionManager();e.addActionWithFlags(ii.aA,cl.n,OM,64),e.addAction(ii.TP,cl.U,HM),e.addAction(ii.Ai,cl.U,UM),e.addAction(ii.Gj,cl.U,VM),e.addActionWithFlags(ii.HN,cl.U,Ze.ActionManager.doNothingButReportHandler,64),e.addActionWithFlags(ii.EI,cl.U,Ze.ActionManager.doNothingButReportHandler,64)}(),L.AFrameworkApplication.get_theActionManager().addActionWithFlags(eb.Xr,cl.n,Ok,64),Wr.App.oneNoteHideSpellingIsEnabled&&MM.get_instance().registerActions(),Wr.App.oneNotePrintIsEnabled)DM.registerActions();else{var a=L.AFrameworkApplication.appSettingsManager.getStringAppSetting("IrmPolicyDescription");a&&this.get_businessBarControllerFuture().execute((function(e){e.showIRMPolicyDescription(a)}))}oR.get_instance().registerActions(),us.n.get_instance().get_item(47)&&lR.registerActions(),this._container.resolve(ZM).registerActions(),this._container.resolve(wM).registerActions(),Wr.App.get_isEmbedMessageEnabled()&&Uk.registerActions(),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInkInputEnabled")&&(RD.o.registerActions(),function(){var e=L.AFrameworkApplication.get_theActionManager();e.addActionWithFlags(eb.GL,cl.U,UD,96),e.addActionWithFlags(eb.uM,cl.n,HD,96),e.addActionWithFlags(eb.SI,cl.n,GD,100),e.addActionWithFlags(eb.DE,cl.n,OD,68),e.addAction(eb.Jm,cl.n,VD)}(),function(){var e=L.AFrameworkApplication.get_theActionManager();e.addActionWithFlags(eb.NI,cl.n,KD,4),e.addActionWithFlags(eb.PG,cl.n,qD,96),e.addAction(eb.aj,cl.n,QD)}()),Wr.App.oneNoteRecycleBinIsEnabled&&this._container.resolve(JM).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteUpdatePageCacheIsEnabled")&&!L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteContentSyncIsEnabled")&&this._container.resolve(sM).registerActions(L.AFrameworkApplication.get_theActionManager()),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteFormatPainterIsEnabled")&&this._container.resolve(pk).registerActions(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxFlightEnabled()&&function(){var e=L.AFrameworkApplication.get_theActionManager();e.addActionWithFlags(te.rO,nt.a,Ak,101),e.addAction(te.Ct,nt.a,Tk)}(),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()&&this._container.resolve(eR).registerActions(L.AFrameworkApplication.get_theActionManager()),this._container.resolve(GP.k),this._container.resolve(VP.c),this._container.resolve(Rk).registerContentDetailsProviders(),Br.App.get_activeAppFrame().updateCommandUI(),this._container.resolve(lD).registerActions()},e.prototype.dispose=function(){},e.prototype.configure=function(e){var t=this;this._container=e,(new Dk).configure(e),e.register(Qp.h).singleInstance().usingFactory((function(){return new ek(L.AFrameworkApplication.get_theActionManager(),ii.je,ii.zh,ii.VS,ii.Ox)})),e.register(Xd).singleInstance().usingFactory((function(){return new Xm(!1,e.resolve(Dd.x).getBooleanAppSetting("SplitHyperlinkFixWithEnterIsEnabled"))})),e.register($d).singleInstance().usingFactory((function(){return new h_(e.resolve(Dd.x).getBooleanAppSetting("ExternalPasteImprovementsEnabled")&&e.resolve(Dd.x).getBooleanAppSetting("ListMarkerIsEnabled"),void 0,void 0,void 0,void 0,!0)})),e.register(PM).singleInstance().usingFactory((function(){return new PM(L.AFrameworkApplication.get_theActionManager(),e.resolveLazy(Lx),e.resolve(cR.d),e.resolveLazy($p.d),L.AFrameworkApplication.appSettingsManager)})),e.register(Ig).singleInstance().usingFactory((function(){return new xk(L.AFrameworkApplication.get_theActionManager())})),e.register(fM).as(rh).singleInstance().usingFactory((function(){return new fM})),e.register(yM).as(dd.n).singleInstance().usingFactory((function(){return new yM(e.resolve(hd),e.resolve(js))})),e.register(tk).as(Wy).singleInstance().usingFactory((function(){return new tk})),e.register(GP.k).singleInstance().usingFactory((function(){return new lM(L.AFrameworkApplication.get_theActionManager())})),e.register(VP.c).singleInstance().usingFactory((function(){return new QM(L.AFrameworkApplication.get_theActionManager())})),e.register(vD).as(Ck),e.register(Rk).singleInstance().usingFactory((function(){return new Rk(e.resolveFuture(va.t),e.resolveLazy(vD))})),e.register(FD).as(yk).singleInstance().usingFactory((function(){return new FD(e.resolve(Fb.w),e.resolveFuture(gh.i),e.resolve($a.b).get_instance(),e.resolve(ja.n),e.resolve(Nb.l))})),e.register(WP).singleInstance().usingFactory((function(){return L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteOreoNavPaneIsEnabled")?new oD:new XD})),e.register(wM).as(zP.o).singleInstance().usingFactory((function(){return new wM})),e.register(ZM).as(KP.y).singleInstance().usingFactory((function(){return new ZM})),e.register(xM).singleInstance().usingFactory((function(){return new xM})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteInsertFileIsEnabled")&&e.register(CD).singleInstance().usingFactory((function(){return new CD(hn.s.get_instance(),L.AFrameworkApplication.get_activeFrame().get_theKeyInputManager(),L.AFrameworkApplication.get_theActionManager(),e.resolve(mI.r),e.resolve(bI),e.resolve(SI.c),e.resolve(ja.n))})),e.register(Bk.c).singleInstance().usingFactory((function(){return new Bk.c})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")&&e.register(Lk.AudioPlaybackActor).singleInstance().usingFactory((function(){return new Lk.AudioPlaybackActor})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteCopyToCloudIsEnabled")&&e.register(Gk).singleInstance().usingFactory((function(){return new Gk})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioRecordingIsEnabled")&&e.register(Nk.h).singleInstance().usingFactory((function(){return new Nk.h(e.resolve(gI),e.resolve(mI.r))})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteSyncStatusEnabled")&&!L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSyncUxFeatureEnabled()&&e.register(tR.n).singleInstance().usingFactory((function(){return new tR.n(e.resolve(ou.r),e.resolve(qP.i),e.resolve(jP.l),e.resolve(gi.i))})),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()&&e.register(eR).singleInstance().usingFactory((function(){return new eR})),Wr.App.oneNoteRecycleBinIsEnabled&&e.register(JM).singleInstance().usingFactory((function(){return new JM(e.resolve($P.t),e.resolve(eA.f),e.resolve(WP))})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteUpdatePageCacheIsEnabled")&&!L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteContentSyncIsEnabled")&&e.register(sM).singleInstance().usingFactory((function(){return new sM})),e.register(_M).singleInstance().usingFactory((function(){return new _M(Br.App.theNotebookManager,e.resolve(XT.e),Qc.PageReader.get_instance(),Wr.App.get_activeOneNoteFrame().workspace.get_contentView(),e.resolve(Zd.u),e.resolve(Vd.c),e.resolve(ja.n))})),L.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteFormatPainterIsEnabled")&&(this._container.register(gk).as(Uu.w).singleInstance().usingFactory((function(){return new gk(t._container.resolve(uc.e),t._container.resolve(ah.c),t._container.resolve(xs.z),t._container.resolve(gc.g),t._container.resolve(Fd.s),t._container.resolve(rs.v),t._container.resolve(ts.c),t._container.resolve(Va.x),ls.k.get_instance(),null,t._container.resolve($a.b).get_instance(),t._container.resolve(cc.x).get_instance(),t._container.resolve(RC.d))})),this._container.register(pk).singleInstance().usingFactory((function(){return new pk(Br.App.get_activeAppFrame(),Nt.FocusManager.instance(),L.AFrameworkApplication.get_theActionManager(),ji.y.get_instance(),CF.z.get_instance(),t._container.resolve(Uu.w))}))),e.register(QP).usingFactory((function(){return new ED})),e.register(JP).usingFactory((function(){return new PD})),e.register(XP).usingFactory((function(){return new MD})),e.register(YP).singleInstance().usingFactory((function(){return new lk(e.tryResolve(qa.g),e.resolveLazy(ja.n),e.resolveFuture(gh.i))})),e.register(jp).singleInstance().usingFactory((function(){return new vk(Qc.PageReader.get_instance(),e.resolveLazy(ja.n),e.resolve(Vd.c),!0,!0)})),e.register(If.j).singleInstance().usingFactory((function(){return new rD(e.resolve(Ud.x),e.resolve(ZP.d))})),e.register(ck).as(lh).singleInstance().usingFactory((function(){return new ck})),e.register(lD).singleInstance().usingFactory((function(){return new lD})),e.register(CM).singleInstance().usingFactory((function(){return new CM(L.AFrameworkApplication.appSettingsManager.getStringAppSetting("OneNoteStickyNotesLinkValue"))}))},e.main=function(){N.o.get_instance().registerPackage(new e)},e}();(0,o.l)(uR,"OneNoteActorsPackage",null,[l.u,c.s]);var gR=n(5406),pR=(0,o.y)("ITaskPaneManager"),dR=function(){return function(){this.entry=null,this.show=!1}}();(0,o.l)(dR,"AnimationBatchEntry",null,[]);var hR=n(7006),_R=function(){function e(){this._containerLeft=null,this._containerRight=null,this._taskPaneDomLoaded=!1,this._modalDiv=null,this._leftTaskPaneVisibleCount=0,this._rightTaskPaneVisibleCount=0,this._isRegionComposerEnabled=!1,this._paneOrderPreferenceLeft=[],this._paneOrderPreferenceRight=[],this._taskPaneEntries={},this._animationQueue=[],this._isReactTaskPaneInfraEnabled=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactTabbedTaskPaneInfrastructureEnabled()}return e.prototype.initialize=function(){this._taskPaneDomLoaded=!1,this._isRegionComposerEnabled=!!L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRegionComposerEnabled(),this._isRegionComposerEnabled&&this.createTaskPaneContainers()},e.prototype.get_taskPaneEntries=function(){return this._taskPaneEntries},e.prototype.createTaskPaneEntry=function(t,n,r,i){var o=this.getTaskPaneEntryId(n);C.ULS.sendTraceTag(4290588,320,50,"Create new task pane."),this.createTaskPaneContainers();var a=document.createElement("div");return a.id=o,a.className=e.wacTaskPaneEntryClass,a.style.width="0",this._isReactTaskPaneInfraEnabled||(this.addEntryToContainer(r,o,a),this._taskPaneEntries[o]=t.createTaskPaneEntry(o,r,i,a)),a},e.prototype.createTaskPaneContainers=function(){this._taskPaneDomLoaded||this.setupTaskPaneContainers()},e.prototype.addEntryToContainer=function(e,t,n){var r=null,i=null;if(e?1===e&&(r=this._containerRight,i=this._paneOrderPreferenceRight):(r=this._containerLeft,i=this._paneOrderPreferenceLeft),r){for(var o=!1,a=0;a<i.length;a++)if(o){if(i[a]in this._taskPaneEntries)return void this.insertTaskPaneEntryBefore(r,n,this._taskPaneEntries[i[a]])}else i[a]===t&&(o=!0);r.appendChild(n)}},e.prototype.insertTaskPaneEntryBefore=function(e,t,n){e.insertBefore(t,n.get_element())},e.prototype.disposeTaskPaneEntry=function(e){var t=this.getTaskPaneEntryId(e);if(t in this._taskPaneEntries){var n=this._taskPaneEntries[t];n.get_element().parentNode.removeChild(n.get_element()),delete this._taskPaneEntries[t]}},e.prototype.showTaskPaneEntry=function(e){var t=this.getTaskPaneEntryId(e);if(t in this._taskPaneEntries){var n=this._taskPaneEntries[t];if(n&&!n.get_isVisible()){this.showHideTaskPaneEntry(n,!0);var r=this.calculateAdjustWidthSize(n,!0);this.adjustAppSize(n.get_position(),!0,r),1===n.get_position()&&E.k(this._taskPaneEntries)>1&&this.logVisibleTaskPanes()}}},e.prototype.hideTaskPaneEntry=function(e){var t=this.getTaskPaneEntryId(e);if(t in this._taskPaneEntries){var n=this._taskPaneEntries[t];if(n&&n.get_isVisible()){this.showHideTaskPaneEntry(n,!1);var r=this.calculateAdjustWidthSize(n,!1);this.adjustAppSize(n.get_position(),!1,r)}}},e.prototype.createTaskPaneModalDiv=function(e){if(this._modalDiv)return this._modalDiv;var t=document.createElement("div");return document.body.appendChild(t),t&&(this._modalDiv=new nE(t,e)),this._modalDiv},e.prototype.showHideTaskPaneEntry=function(e,t){if(e.get_element()&&(e.set_isVisible(t),this._animationQueue.push((0,O.m)(new dR,{entry:e,show:t}))),e.get_position()?this._rightTaskPaneVisibleCount+=t?1:-1:this._leftTaskPaneVisibleCount+=t?1:-1,1===this._animationQueue.length&&window.setTimeout(o.i(this,this.startPaneAnimation,"startPaneAnimation"),0),this._isRegionComposerEnabled){if(!e.get_element()||!e.get_element().parentNode)return;!e.get_position()&&!this._leftTaskPaneVisibleCount||1===e.get_position()&&!this._rightTaskPaneVisibleCount?(e.get_element().parentNode.style.minHeight="0px",e.get_element().parentNode.style.height="0px",e.get_element().parentNode.style.overflow="hidden"):(e.get_element().parentNode.style.minHeight="",e.get_element().parentNode.style.height="",e.get_element().parentNode.style.overflow="")}},e.prototype.startPaneAnimation=function(){this.onPaneAnimation();var e=vg.where(dR,vg.asEnumerable(dR,this._animationQueue),(function(e){return!e.entry.get_position()})),t=vg.where(dR,e,(function(e){return!e.show}));if(vg.any(dR,t)&&vg.Ct(dR,t)!==vg.Ct(dR,e)){for(var n=t.$$ge();n.$$mn();){n.$$cu().entry.get_element().style.width="0"}e=vg.where(dR,e,(function(e){return e.show}))}var r=vg.where(dR,vg.asEnumerable(dR,this._animationQueue),(function(e){return 1===e.entry.get_position()})),i=vg.where(dR,r,(function(e){return!e.show}));if(vg.any(dR,i)&&vg.Ct(dR,i)!==vg.Ct(dR,r)){for(var o=i.$$ge();o.$$mn();){o.$$cu().entry.get_element().style.width="0"}r=vg.where(dR,r,(function(e){return e.show}))}for(var a=vg.concat(dR,e,r).$$ge();a.$$mn();){var s=a.$$cu(),l=s.entry;kv.WacAirSpace.setAnimationClass(l.get_element(),$i.n);var c=new hR.f(l.get_element());s.show?c.animateWidth(0,l.get_width()):c.animateWidth(l.get_width(),0),kv.WacAirSpace.animate(c,null,null)}this._animationQueue.length=0},e.prototype.onPaneAnimation=function(){},e.prototype.calculateAdjustWidthSize=function(e,t){var n=e.get_width(),r=e.get_position()?this._rightTaskPaneVisibleCount:this._leftTaskPaneVisibleCount;return(t&&1===r||!t&&!r)&&(n+=1),n},e.prototype.setupTaskPaneContainers=function(){this._taskPaneDomLoaded||(this._containerLeft||(this._containerLeft=document.createElement("div"),this._containerLeft.id=e.wacTaskPaneContainerLeftId,this._containerLeft.className=e.wacTaskPaneContainerClass,Sys.UI.DomElement.addCssClass(this._containerLeft,"alignLeft"),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&Sys.UI.DomElement.addCssClass(this._containerLeft,"FlexBoxLayout"),this._isReactTaskPaneInfraEnabled&&Sys.UI.DomElement.addCssClass(this._containerLeft,e.wacReactTaskPaneContainerClass),this.addTaskPaneContainer(0,this._containerLeft)),this._containerRight||(this._containerRight=document.createElement("div"),this._containerRight.id=e.wacTaskPaneContainerRightId,this._containerRight.className=e.wacTaskPaneContainerClass,Sys.UI.DomElement.addCssClass(this._containerRight,"alignRight"),L.AFrameworkApplication.get_activeFrame()&&L.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&Sys.UI.DomElement.addCssClass(this._containerRight,"FlexBoxLayout"),this._isReactTaskPaneInfraEnabled&&Sys.UI.DomElement.addCssClass(this._containerRight,e.wacReactTaskPaneContainerClass),this.addTaskPaneContainer(1,this._containerRight)),this.onTaskPaneContainersAdded(this._containerLeft,this._containerRight),this._taskPaneDomLoaded=!0)},e.prototype.onTaskPaneContainersAdded=function(e,t){},e.prototype.addTaskPaneToPreferredList=function(e,t){Array.add(1===e?this._paneOrderPreferenceRight:this._paneOrderPreferenceLeft,t)},e.prototype.getTaskPaneEntryId=function(e){return e+"-Entry"},e.prototype.logVisibleTaskPanes=function(){for(var e=0,t=0,n=E.f(this._taskPaneEntries);t<n.length;t++){var r=n[t],i=(0,f.e)(gR.u,this._taskPaneEntries[r]);i&&i.get_isVisible()&&1===i.get_position()&&e++}2===e?C.ULS.sendTraceTag(595179606,320,50,"2 simultaneous panes open"):e>2&&C.ULS.sendTraceTag(595179605,320,50,e+" simultaneous panes open")},e.wacTaskPaneContainerLeftId="WACTaskPaneContainerLeft",e.wacTaskPaneContainerRightId="WACTaskPaneContainerRight",e.wacTaskPaneContainerClass="WACTaskPaneContainer",e.wacTaskPaneEntryClass="WACTaskPaneEntry",e.wacReactTaskPaneContainerClass="WACReactTaskPaneContainer",e}();(0,o.l)(_R,"BaseTaskPaneManager",null,[pR]);var mR=function(e){function t(t,n){var r=e.call(this)||this;return r._actionManager=null,r._isAppRtl=!1,r._viewPanelLeft=0,r._viewPanelRight=0,r._newViewPanelLeft=0,r._newViewPanelRight=0,r._actionManager=t,r._isAppRtl=n,r}return(0,S.t)(t,e),t.prototype.addTaskPaneContainer=function(e,t){var n=Br.App.get_activeAppFrame().get_viewPanelContainer();if(n.parentNode)if(e){if(1===e){var r;if(this._isRegionComposerEnabled)(r=Br.App.get_activeAppFrame().get_adaptiveLayoutInstance().getRegion(Br.App.get_activeAppFrame().get_adaptiveLayoutInstance().get_regionNames().get_item("FarPane")))&&r.appendChild(t),Sys.UI.DomElement.addCssClass(t,"regionComposer"),Br.App.get_activeAppFrame().get_adaptiveLayoutInstance().registerBoundingWindowRectsChanged("farPane",(function(e,n){"DP"===n||3===n?Sys.UI.DomElement.addCssClass(t,"DL"):Sys.UI.DomElement.removeCssClass(t,"DL")}));else n.parentNode.insertBefore(t,n.nextSibling)}}else this._isRegionComposerEnabled?((r=Br.App.get_activeAppFrame().get_adaptiveLayoutInstance().getRegion(Br.App.get_activeAppFrame().get_adaptiveLayoutInstance().get_regionNames().get_item("NearPane")))&&r.appendChild(t),Sys.UI.DomElement.addCssClass(t,"regionComposer")):n.parentNode.insertBefore(t,n)},t.prototype.adjustAppSize=function(e,t,n){if(!this._isRegionComposerEnabled){var r=t?n:-n;e?this._newViewPanelRight+=r:this._newViewPanelLeft+=r}},t.prototype.onPaneAnimation=function(){if(!this._isRegionComposerEnabled){var e=Br.App.get_activeAppFrame().get_viewPanelContainer();if(kv.WacAirSpace.setAnimationClass(e,$i.n),this._viewPanelLeft!==this._newViewPanelLeft){var t=new Ev.r(e);t.animateX(this._viewPanelLeft,this._newViewPanelLeft,this._isAppRtl),kv.WacAirSpace.animate(t,null,o.i(this,this.forceInteractiveViewRefreshOutline,"forceInteractiveViewRefreshOutline")),this._viewPanelLeft=this._newViewPanelLeft}if(this._viewPanelRight!==this._newViewPanelRight){var n=new Ev.r(e);n.animateXRight(this._viewPanelRight,this._newViewPanelRight,this._isAppRtl),kv.WacAirSpace.animate(n,null,o.i(this,this.forceInteractiveViewRefreshOutline,"forceInteractiveViewRefreshOutline")),this._viewPanelRight=this._newViewPanelRight}}},t.prototype.forceInteractiveViewRefreshOutline=function(e){Ur.InteractiveViewManager.get_instance().forEach((function(e){e.forceResize()}))},t.prototype.getOwnerDOMDocument=function(){return Br.App.get_activeAppFrame().get_viewPanelContainer().ownerDocument},t}(_R);(0,o.l)(mR,"TaskPaneManager$0",_R,[]);var fR=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.initialize(),r}return(0,S.t)(t,e),t.prototype.registerActions=function(){},t.getTaskPaneManagerWithResolvedDependencies=function(){return new t(L.AFrameworkApplication.get_theActionManager(),L.AFrameworkApplication.get_isRtl())},t}(mR);(0,o.l)(fR,"TaskPaneManager",mR,[]);var yR=function(){function e(){this._taskPaneManager=null}return e.prototype.get_name=function(){return"OneNote.TaskPaneManager"},e.prototype.configure=function(e){},e.prototype.init=function(){this._taskPaneManager=fR.getTaskPaneManagerWithResolvedDependencies(),this._taskPaneManager.registerActions(),Br.App.get_activeAppFrame().set_taskPaneManager(this._taskPaneManager)},e.prototype.dispose=function(){},e}();(0,o.l)(yR,"OneNoteTaskPaneManagerPackage",null,[l.u,c.s]);Type.registerNamespace("AppRealtimeChannel"),Type.registerNamespace("B4A11Y"),Type.registerNamespace("B4Ac"),Type.registerNamespace("B4AuC"),Type.registerNamespace("B4CS"),Type.registerNamespace("B4IE"),Type.registerNamespace("B4Im"),Type.registerNamespace("B4LE"),Type.registerNamespace("B4NLE"),Type.registerNamespace("B4OLE"),Type.registerNamespace("B4TLE"),Type.registerNamespace("B4TaE"),Type.registerNamespace("B4UI"),Type.registerNamespace("B4Up"),Type.registerNamespace("BasicChat"),Type.registerNamespace("Box3"),Type.registerNamespace("Box4.AtMentions"),Type.registerNamespace("Box4.ClipArt"),Type.registerNamespace("Box4.Clipboard"),Type.registerNamespace("Box4.Insights"),Type.registerNamespace("Box4.ListMarker"),Type.registerNamespace("Box4.ListMarkerGallery"),Type.registerNamespace("Box4.Media"),Type.registerNamespace("Box4.TaskPaneManager"),Type.registerNamespace("CAUI"),Type.registerNamespace("CNT"),Type.registerNamespace("CUIB"),Type.registerNamespace("CommandUI"),Type.registerNamespace("CommandUI.Controls"),Type.registerNamespace("CommandUI.Controls.SearchBoxComponents"),Type.registerNamespace("CommandUI.TaskPane"),Type.registerNamespace("Common"),Type.registerNamespace("Common.App.ActivityAggregator"),Type.registerNamespace("Common.App.AltTextDialog"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),Type.registerNamespace("Common.App.BrowserInfoLogger"),Type.registerNamespace("Common.App.ChromeExtensionHelper"),Type.registerNamespace("Common.App.CommandUIActors"),Type.registerNamespace("Common.App.EventsCacheManager"),Type.registerNamespace("Common.App.HostNotification"),Type.registerNamespace("Common.App.InsertFile"),Type.registerNamespace("Common.App.InsertPicture"),Type.registerNamespace("Common.App.Insights"),Type.registerNamespace("Common.App.NewAndOpen.Core"),Type.registerNamespace("Common.App.OneDriveFilePickerApi"),Type.registerNamespace("Common.App.OpenInClient"),Type.registerNamespace("Common.App.SafeLinks"),Type.registerNamespace("Common.App.SaveStatus"),Type.registerNamespace("Common.App.SessionExpiration"),Type.registerNamespace("Common.App.TaskPaneManager"),Type.registerNamespace("ONAc"),Type.registerNamespace("ONEF"),Type.registerNamespace("ONIE"),Type.registerNamespace("ONIL"),Type.registerNamespace("ONLE"),Type.registerNamespace("ONNE"),Type.registerNamespace("ONNLE"),Type.registerNamespace("ONOLE"),Type.registerNamespace("ONTLE"),Type.registerNamespace("ONTaE"),Type.registerNamespace("ONUI"),Type.registerNamespace("ONUp"),Type.registerNamespace("OneNote.CommandUIActors"),Type.registerNamespace("OneNote.CommandingEditors"),Type.registerNamespace("OneNote.FasterOutbound"),Type.registerNamespace("OneNote.Insights"),Type.registerNamespace("OneNote.Navigation"),Type.registerNamespace("OneNote.PageHtmlRecall"),Type.registerNamespace("OneNote.SessionExpiration"),Type.registerNamespace("OneNote.SyncUX"),Type.registerNamespace("OneNote.TaskPaneManager"),Type.registerNamespace("Wonca.UI"),B.main(),q.main(),we.main(),He.main(),it.main(),fn.main(),Dn.main(),N.o.get_instance().registerPackage(new nr),Cr.main(),xr.main(),Mr.main(),Vr.main(),Jr.main(),ui.main(),N.o.get_instance().registerPackage(new yi),Si.main(),ya.main(),Ua.main(),Js.main(),Xs.main(),Ys.main(),Zs.main(),N.o.get_instance().registerPackage(new tc),nc.main(),tu.main(),nu.main(),ru.main(),Mp.main(),qp.main(),DS.main(),N.o.get_instance().registerPackage(new RS),N.o.get_instance().registerPackage(new qS),cv.main(),Cv.main(),Uv.main(),jv.main();wb.main(),Lb.main(),qb.main(),gT.main(),AT.main(),NT.main(),KT.main(),EA.main(),zA.main(),uI.main(),TI.main(),kw.main(),Mw.main(),Rw.main(),N.o.get_instance().registerPackage(new Uw),N.o.get_instance().registerPackage(new Tx),HP.main(),uR.main(),N.o.get_instance().registerPackage(new yR)},4126:function(e,t,n){"use strict";var r=n(2185),i=(0,r.y)("IViewerChrome"),o=n(7015),a=n(8075),s=n(6990),l=n(2263),c=n(345),u=n(6049),g=n(1210),p=function(){function e(e,t,n,r,i){this._elmTopBar1=null,this._elmTopBar2=null,this._breadcrumb=null,this._documentTitle=null,this._toolbarContainer=null,this._elmTopBar1=e,this._elmTopBar2=t,this._breadcrumb=n,this._documentTitle=r,this._toolbarContainer=i}return e.prototype.adjustBreadcrumbDisplay=function(){var e=!!u.AFrameworkApplication.breadcrumbBrandName,t=!!u.AFrameworkApplication.breadcrumbFolderName;if(!u.AFrameworkApplication.get_isEmbedded()&&e&&t){var n=this._breadcrumb.getBreadcrumbItem(a.CuiHelper.breadcrumbFolderId),r=this._breadcrumb.getBreadcrumbItem(a.CuiHelper.folderSeparatorId);n&&r&&l.k.adjustBreadcrumbDisplay(r,n)}},e.prototype.scaleHerobar=function(){var t=this,n=[function(){e.trimLongestElement(t._breadcrumb,t._documentTitle,200)},function(){e.trimBreadcrumbAndDocumentTitle(t._breadcrumb,t._documentTitle,200)},function(){e.hideDocumentTitleAndUntruncateBreadcrumb(t._breadcrumb,t._documentTitle)},function(){t._breadcrumb.truncateWidth(200)},r.i(this._breadcrumb,this._breadcrumb.hide,"hide")];e.showAndUntruncateAllElements(this._breadcrumb,this._documentTitle),e.invokeScalingSteps(n,(function(){return e.herobarElementBoundsOverlap(t._breadcrumb,t._documentTitle,t._toolbarContainer,u.AFrameworkApplication.get_isRtl())}))},e.prototype.scaleHeader=function(){this.enhancedMobileViewIsEnabled()?(document.getElementById("application").style.minWidth="0px",new c.b(this._elmTopBar1,this._elmTopBar2,u.AFrameworkApplication.get_isRtl()).scaleHeader()):l.k.scaleHeaderUsingContainers(this._elmTopBar1,this._elmTopBar2,u.AFrameworkApplication.get_isRtl())},e.prototype.enhancedMobileViewIsEnabled=function(){return!!u.AFrameworkApplication.appSettingsManager&&u.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EnhancedMobileViewIsEnabled")},e.prototype.scaleViewerChrome=function(){this.scaleHeader(),this.adjustBreadcrumbDisplay(),this.scaleHerobar()},e.showAndUntruncateAllElements=function(e,t){e&&e.undoScaling(),t&&t.undoScaling()},e.herobarElementBoundsOverlap=function(t,n,r,i){return e.viewerChromeItemsOverlap(t,n,i)||e.viewerChromeItemsOverlap(n,r,i)||e.viewerChromeItemsOverlap(t,r,i)},e.viewerChromeItemsOverlap=function(e,t,n){return!(!e||!t)&&(!(!e.get_isVisible()||!t.get_isVisible())&&g.g.leftBoundsOverlapsRightBounds(e.get_containerBounds(),t.get_containerBounds(),n))},e.trimLongestElement=function(e,t,n){e&&t&&(e.get_containerBounds().width>t.get_containerBounds().width?e.truncateWidth(n):t.truncateWidth(n))},e.trimBreadcrumbAndDocumentTitle=function(e,t,n){e&&e.truncateWidth(n),t&&t.truncateWidth(n)},e.hideDocumentTitleAndUntruncateBreadcrumb=function(e,t){t.hide(),e.undoScaling()},e.invokeScalingSteps=function(e,t){for(var n=0;t()&&n<e.length;)e[n](),n++},e}();(0,r.l)(p,"ViewerChromeScalingManager",null,[]);var d=n(5008),h=n(5518),_=n(3721);n.d(t,{k:function(){return m}});var m=function(){function e(e,t,n,i){var a=this;void 0===i&&(i=!1),this._elmViewerChromeContainer=null,this._elmToolbarTopBars=null,this._elmHeaderContainer=null,this._elmTopBar1=null,this._elmTopBar2=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._breadcrumbContainer=null,this._documentTitleContainer=null,this._toolbarContainer=null,this.viewerChromeScalingManager=null,this._resizableContainer=null,this._headerIsHidden=!1,this._appHasExternalHeader=!1,this._appExternalHeaderPanel=null,this._appHasExternalHeader=d.f((0,o.m)((function(){return a._appExternalHeaderPanel}),(function(e){return a._appExternalHeaderPanel=e})),!i),this._headerIsHidden=i,this.createViewerChromeStructure(),e.appendChild(this._elmViewerChromeContainer),this._headerIsHidden||this.populateHeader(t),this.populateHerobarContainers(),this.viewerChromeScalingManager=new p(this._elmTopBar1,this._elmTopBar2,this._breadcrumbContainer,this._documentTitleContainer,this._toolbarContainer),this._resizableContainer=n||new h.o,this._resizableContainer.add_onResize(r.i(this,this.scale,"scale")),this.scale()}return e.prototype.get_toolbarWithTopbarHeight=function(){return e.calculateToolbarWithTopBarHeight(this._headerIsHidden,this._appHasExternalHeader)},e.prototype.get_viewerChromeCssClass=function(){return"cui-viewerchrome"},e.prototype.get_toolbarContainer=function(){return this._toolbarContainer.get_elmContainer()},e.prototype.get_peripheralContentContainer=function(){return this._elmTopBar1},e.prototype.get_toolbarContentContainer=function(){return this._elmTopBar2},e.prototype.createViewerChromeStructure=function(){this._elmViewerChromeContainer=e.createUnselectableElement("div"),this._elmViewerChromeContainer.className=this.get_viewerChromeCssClass(),this.ensureTopBars(),this.ensureTopBars1And2()},e.prototype.ensureTopBars=function(){this._elmToolbarTopBars=e.createUnselectableElement("div"),this._elmToolbarTopBars.id=a.CuiHelper.headerTopBarsId,this._elmToolbarTopBars.className="cui-ribbonTopBars",this._elmViewerChromeContainer.appendChild(this._elmToolbarTopBars),this.ensureHeaderDom()},e.prototype.ensureHeaderDom=function(){this._appHasExternalHeader?(this._elmHeaderContainer=e.createUnselectableElement("div"),this._elmHeaderContainer.className="cui-ribbonTopBars",this._elmHeaderContainer.id=a.CuiHelper.externalHeaderViewerChromeTopBarsId,this._appExternalHeaderPanel.appendChild(this._elmHeaderContainer),Sys.UI.DomElement.addCssClass(this._elmHeaderContainer,this.get_viewerChromeCssClass()),Sys.UI.DomElement.addCssClass(this._elmViewerChromeContainer,"cui-exth")):this._elmHeaderContainer=this._elmToolbarTopBars},e.prototype.ensureTopBars1And2=function(){this._elmTopBar1=e.createUnselectableElement("div"),this._elmTopBar1.className="cui-topBar1";var t=u.AFrameworkApplication.appSettingsManager.get_appSettings();"TransitionalHeaderUIInViewEnabled"in t&&Boolean.parse(t.TransitionalHeaderUIInViewEnabled)&&u.AFrameworkApplication.get_activeFrame()&&u.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isTransistionalHeaderUIEnabled()&&(this._elmTopBar1.className+=" cui-topBar1-transistionalHeaderUI"),u.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LegacyHeaderAppColorIsEnabled")&&(this._elmTopBar1.className+=" cui-topBar1-transistionalHeaderUI"),this._headerIsHidden&&(this._elmTopBar1.style.display="none"),this._elmHeaderContainer.appendChild(this._elmTopBar1),this._elmTopBar2=e.createUnselectableElement("div"),u.AFrameworkApplication.isMobileMode||(this._elmTopBar2.className="cui-topBar2"),this._elmToolbarTopBars.appendChild(this._elmTopBar2)},e.prototype.populateHeader=function(t){this._elmTopRowLeft=document.getElementById(t+"-"+s.r.topRowLeft),this._elmTopRowCenter=document.getElementById(t+"-"+s.r.topRowCenter),this._elmTopRowRight=document.getElementById(t+"-"+s.r.topRowRight),this._elmTopRowLeft&&(this._elmTopRowLeft.parentNode.removeChild(this._elmTopRowLeft),this._elmTopBar1.appendChild(this._elmTopRowLeft),this._elmTopRowLeft.style.display="inline-block",e.setUnselectable(this._elmTopRowLeft)),this._elmTopRowCenter&&(this._elmTopRowCenter.parentNode.removeChild(this._elmTopRowCenter),this._elmTopBar1.appendChild(this._elmTopRowCenter),this._elmTopRowCenter.style.display="inline-block",e.setUnselectable(this._elmTopRowCenter)),this._elmTopRowRight&&(this._elmTopRowRight.parentNode.removeChild(this._elmTopRowRight),this._elmTopBar1.appendChild(this._elmTopRowRight),this._elmTopRowRight.style.display="inline-block",e.setUnselectable(this._elmTopRowRight))},e.prototype.populateHerobarContainers=function(){u.AFrameworkApplication.isMobileMode||(this._breadcrumbContainer=new(n(2021).BreadcrumbContainer),this._elmTopBar2.appendChild(this._breadcrumbContainer.get_elmContainer())),this._documentTitleContainer=new(n(1501).DocumentTitleContainer),this._toolbarContainer=new(n(8803).ToolbarContainer),this._elmTopBar2.appendChild(this._documentTitleContainer.get_elmContainer()),this._elmTopBar2.appendChild(this._toolbarContainer.get_elmContainer())},e.prototype.scale=function(){u.AFrameworkApplication.isMobileMode||this.viewerChromeScalingManager.scaleViewerChrome()},e.prototype.dispose=function(){this._documentTitleContainer&&(this._documentTitleContainer.dispose(),this._documentTitleContainer=null),this._breadcrumbContainer&&(this._breadcrumbContainer.dispose(),this._breadcrumbContainer=null),this._elmToolbarTopBars=null,this._elmTopBar1=null,this._elmTopBar2=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._resizableContainer.remove_onResize(r.i(this,this.scale,"scale")),this._resizableContainer=null,this._appExternalHeaderPanel&&_.s.clearElementHtml(this._appExternalHeaderPanel)},e.calculateToolbarWithTopBarHeight=function(e,t){return 40+(e||t?0:48)},e.createUnselectableElement=function(t){var n=document.createElement(t);return e.setUnselectable(n),n},e.setUnselectable=function(e){e.setAttribute("unselectable","on")},e}();(0,r.l)(m,"ViewerChrome",null,[Sys.IDisposable,i])},4784:function(e,t,n){"use strict";n.d(t,{c:function(){return h}});var r=n(2185),i=n(5793),o=n(4120),a=n(6627),s=n(2133),l=n(4594),c=n(6532),u=n(2919),g=n(3079),p=n(6049),d=n(6342),h=function(){function e(){}return e.prototype.registerActions=function(e){e.addActionWithFlags(g.Ax,s.n,r.i(this,this.queryAudioTabGroup,"queryAudioTabGroup"),96)},e.prototype.queryAudioTabGroup=function(t,n,r,i,o){return e.get_isRecordingAudio()||this.isRibbonEnabledForAudioPlayback(n)?32:8},e.prototype.isRibbonEnabledForAudioPlayback=function(e){return p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")&&this.isPlayableAudioOnPage(e)},e.prototype.isPlayableAudioOnPage=function(e){var t=e;if(!t.view.get_isInteractiveView())return!1;var n=t.view;if(!n.get_selectionManager())return!1;var r=a.PageNavigator.get_instance().navigateToPageContentNode(n.get_targetNode());if(!r||!r.get_properties().hasProperty(u.b.audioRecordingGuids))return!1;for(var s=l.z.createTraverser(r);s.moveNext();)if(s.get_currentNode()){if(o.EmbeddedFileReader.isPlayableAudio(s.get_currentNode()))return!0}else i.ULS.sendTraceTag(39987159,324,15,"traverser node is null");return!1},e.get_isRecordingAudio=function(){return p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioRecordingIsEnabled")&&d.w.get_instance().resolve(c.h).get_isRecording()},e}();(0,r.l)(h,"AudioToolsActor",null,[])},4901:function(e,t,n){"use strict";n.d(t,{n:function(){return r}});var r=(0,n(2185).y)("IBox4PasteStewardBridge")},5309:function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var r=(0,n(2185).y)("IViewerChromeItemContainer")},5323:function(e,t,n){"use strict";n.r(t);var r=n(2185),i=n(1607),o=n(9965),a=n(1515),s=n(3311),l=n(5793),c=n(8261),u=n(565),g=n(4548),p=n(7089),d=n(6049),h=function(e){function t(t,n,r,i,o,a){var s=e.call(this)||this;return s._context=null,s.init(t),s.setDebugName("DummyClipboardOperation"),s.initAction(d.AFrameworkApplication.get_theActionManager(),n,i,o,a),s._context=r,s.set_response(8),s.setIsCompleted(),s}return(0,g.t)(t,e),t.prototype.run=function(){this._isCompleted=!0,this.setCurrentOperationFromContext(this._context),this.processCurrentOperation(),this.set_response(32)},t}(p.g);(0,r.l)(h,"DummyClipboardOperation",p.g,[]);var _=n(1660),m=n(9836),f=function(e){function t(t,n,r,i,o){var a=e.call(this,t,n,o)||this;return a._shouldGetHtmlFromClipboardData=!1,a._clipboardDataHelper=null,a._clipboardDataHelper=r,a._shouldGetHtmlFromClipboardData=i,a}return(0,g.t)(t,e),t.prototype.tryParseFromString=function(e,t){if(this._shouldDisallowBrowserPaste&&!e)return l.ULS.sendTraceTag(594408836,307,10,"No htmlDomContent and htmlClipboardDataContent"),t.val=null,!1;if(t.val=null,this._shouldDisallowBrowserPaste)return t.val=this._clipboardDataHelper.parseHtmlUsingDomParser(e),!0;if(this._shouldGetHtmlFromClipboardData){var r=this.properties.getValueWithDefault(String,m.k.pastedHtmlContentFromClipboardData,"");r&&(t.val=this._clipboardDataHelper.parseHtmlUsingDomParser(r))}return t.val||(t.val=n(5323).ClipboardActor.get_pasteScratchPad(),t.val.innerHTML=e),!0},t}(_.e);(0,r.l)(f,"HtmlStringImportStrategy",_.e,[]);var y=n(9490),C=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}return(0,g.t)(t,e),t.prototype.getPastedString=function(){return this.properties.getValueWithDefault(String,m.k.pastedPlainTextContent,"")},t.prototype.lineToInnerText=function(t){var n=e.prototype.lineToInnerText.call(this,t);return n.length&&" "!==n?n:"\xa0"},t}(y.b);(0,r.l)(C,"MultiLinePlainTextImportStrategy",y.b,[]);var S=function(e){function t(t,n,r){return e.call(this,t,n,r)||this}return(0,g.t)(t,e),t.prototype.tryParseFromString=function(e,t){return this._shouldDisallowBrowserPaste&&!e?(l.ULS.sendTraceTag(594408834,307,10,"No htmlDomContent"),t.val=null,!1):(t.val=n(5323).ClipboardActor.get_pasteScratchPad(),t.val.innerText=e,!0)},t}(_.e);(0,r.l)(S,"PlainTextImportStrategy",_.e,[]);var v=n(9911),b=n(8960),T=n(876),A=function(){function e(e){this.isPreparing=!1,this.isReady=!1,this._systemClipboard=null,this._systemClipboard=e}return e.prototype.prepare=function(){var e=this;return this.isPreparing||(this.isPreparing=!0,this.isReady=!1,this._systemClipboard.prepareForPaste((function(){e.isReady=!0}))),this.isReady},e.prototype.tryGetContentDom=function(t){return this.isPreparing=!1,t.val=this._systemClipboard.paste(),t.val?!!t.val.hasChildNodes()||(l.ULS.sendTraceTag(7891019,307,50,"DOM innerText empty."),e.get_activityManager().recordEvent(v.f.unexpectedState,{Reason:b.i.expectedData}),!1):(l.ULS.sendTraceTag(6305676,307,50,"SystemClipboard didn't paste"),e.get_activityManager().recordEvent(v.f.failedResult,{Reason:b.i.systemClipboardFailed}),!1)},e.get_activityManager=function(){return T.y.get_instance()},e}();(0,r.l)(A,"SystemClipboardImportStrategy",null,[i.v]);var I=n(4342),w=n(8158),x=n(3286),F=n(2133),E=n(7138),P=n(12),k=n(3722),D=n(613),M=n(4889);n.d(t,{ClipboardActor:function(){return R}});var R=function(){function e(e,t,n,r,i,o,s,l){this._clipboardOperationFactory=null,this._systemClipboard=null,this._activityManager=null,this._clipboardDataHelper=null,this._selectionManager=null,this._actionManager=null,this._undoManager=null,this._flagLookupTable=null,this._cachedActionData=null,this._lastPasteCommand=0,this._isSupportImageDragDropExternalEnabled=!1,this._clipboardOperationFactory=e,this._systemClipboard=t,this._activityManager=n,this._clipboardDataHelper=r,this._selectionManager=i,this._actionManager=o,this._undoManager=s,this._isSupportImageDragDropExternalEnabled=!!l&&l.getBooleanAppSetting("SupportImageDragDropExternalIsEnabled"),this._flagLookupTable=new a.w(u.u),this._flagLookupTable.set_item(E.LS,257),this._flagLookupTable.set_item(E.Zp,8449),this._flagLookupTable.set_item(E.VS,1),this._flagLookupTable.set_item(E.Qh,513),this._flagLookupTable.set_item(E.BI,4097),this._flagLookupTable.set_item(E.FP,12289),this._flagLookupTable.set_item(E.Ox,7),this._flagLookupTable.set_item(E.Do,1),this._flagLookupTable.set_item(E.jn,8193),this._flagLookupTable.set_item(E.xx,272),this._flagLookupTable.set_item(E.zh,16),this._flagLookupTable.set_item(E.pZ,304),this._flagLookupTable.set_item(E.je,48),this._flagLookupTable.set_item(E.hw,64),this._flagLookupTable.set_item(E.DC,64),this._flagLookupTable.set_item(E.wA,65536),this._isSupportImageDragDropExternalEnabled&&this._flagLookupTable.set_item(E.Nh,1)}return e.prototype.get_clipboardOperationFactory=function(){return this._clipboardOperationFactory.get_value()},e.prototype.get_systemClipboard=function(){return this._systemClipboard},e.prototype.registerActions=function(){this._actionManager.addActionWithFlags(E.Mj,F.U,r.i(this,this.queryPasteOptions,"queryPasteOptions"),97),this._actionManager.addActionWithFlags(E.rc,F.U,r.i(this,this.queryPasteOptions,"queryPasteOptions"),97),this._actionManager.addActionWithFlags(E.FX,F.U,r.i(this,this.queryReformatPasteOptions,"queryReformatPasteOptions"),97),this._actionManager.addActionWithFlags(E.Kh,F.U,r.i(this,this.queryReformatPasteOptions,"queryReformatPasteOptions"),97),this._actionManager.addAsyncActionWithFlags(E.je,F.n,r.i(this,this.clipboardAction,"clipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(E.pZ,F.n,r.i(this,this.clipboardAction,"clipboardAction"),1028),this._actionManager.addAsyncAction(E.zh,F.n,r.i(this,this.clipboardAction,"clipboardAction")),this._actionManager.addAsyncAction(E.xx,F.n,r.i(this,this.clipboardAction,"clipboardAction")),this._isSupportImageDragDropExternalEnabled&&this._actionManager.addAsyncActionWithFlags(E.Nh,F.n,r.i(this,this.dropBrowserContent,"dropBrowserContent"),1028),this._actionManager.addAsyncActionWithFlags(E.VS,F.n,r.i(this,this.clipboardAction,"clipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(E.LS,F.n,r.i(this,this.clipboardAction,"clipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(E.Zp,F.n,r.i(this,this.clipboardAction,"clipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(E.jn,F.n,r.i(this,this.clipboardAction,"clipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(E.Do,F.n,r.i(this,this.clipboardAction,"clipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(E.Ox,F.n,r.i(this,this.clipboardAction,"clipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(E.BI,F.n,r.i(this,this.clipboardAction,"clipboardAction"),1028),this._actionManager.addAsyncActionWithFlags(E.FP,F.n,r.i(this,this.clipboardAction,"clipboardAction"),1028),this._actionManager.addAction(E.PS,F.n,P.ActionManager.doNothingButReportHandler),this._actionManager.addAction(E.ZR,F.n,P.ActionManager.doNothingButReportHandler),this._actionManager.addAction(E.SD,F.n,P.ActionManager.doNothingButReportHandler),this._actionManager.addAction(E.Td,F.n,P.ActionManager.doNothingButReportHandler),this._actionManager.addAction(E.Tq,F.n,P.ActionManager.doNothingButReportHandler),this._actionManager.addAction(E.tP,F.n,P.ActionManager.doNothingButReportHandler),this._actionManager.addAsyncAction(E.hw,F.n,r.i(this,this.clipboardAction,"clipboardAction")),this._actionManager.addAsyncAction(E.DC,F.n,r.i(this,this.moveSelectedContentWithinCurrentParagraph,"moveSelectedContentWithinCurrentParagraph")),this._actionManager.addAsyncAction(E.Qh,F.n,r.i(this,this.clipboardAction,"clipboardAction")),this._actionManager.addAsyncAction(E.wA,F.n,r.i(this,this.clipboardAction,"clipboardAction")),this._actionManager.addAction(E.jF,F.n,P.ActionManager.doNothingButReportHandler),this._actionManager.addAction(E.vY,F.n,P.ActionManager.doNothingButReportHandler)},e.prototype.queryPasteOptions=function(e,t,n,r,i){return 1===n?32:(i[M.u.On]=!1,32)},e.prototype.dropBrowserContent=function(e,t,n,r,o,a){var c=this;l.ULS.sendTraceTag(42530335,307,50,"Drag and drop browser content");var u=a.DataTransfer,g=u.getData("text/html"),p=u.getData("text/plain"),d=!1,h=new D.DictionaryPropertySet;if(g.length>0?(l.ULS.sendTraceTag(42530336,307,50,"Drag and drop browser content with HTML"),h.setValue(m.k.pastedHtmlContent,g),d=!0):p.length>0&&(l.ULS.sendTraceTag(42530337,307,50,"Drag and drop browser content with plain text"),h.setValue(m.k.pastedPlainTextContent,p),d=!0),d){var _=this._flagLookupTable.get_item(t);return this.get_clipboardOperationFactory().create(e,t,_,new s.q(i.v,(function(){return c.determineGetHtmlImportDomProvider(_,h)})),n,r,o,h)}return null},e.prototype.queryReformatPasteOptions=function(e,t,n,r,i){var a=(0,o.e)(Object,i);if(a)if(e===E.FX){var s=this._lastPasteCommand!==E.BI&&this._lastPasteCommand!==E.FP;a[M.u.On]=this._lastPasteCommand===E.BI||s}else e===E.Kh&&(a[M.u.On]=this._lastPasteCommand===E.FP);return 32},e.prototype.clipboardAction=function(e,t,n,r,o,a){var l=this;if(d.AFrameworkApplication.get_protectFile()||w.n.get_instance().get_item(83))return new h(e,t,n,r,o,a);var c=this._flagLookupTable.get_item(t);return 1!==r&&1&c&&(this._lastPasteCommand=t),1!==r&&a&&1&c&&(this._cachedActionData=a),1!==r&&!a&&4096&c&&(a=this._cachedActionData),this.get_clipboardOperationFactory().create(e,t,c,new s.q(i.v,(function(){return l.determineGetHtmlImportDomProvider(c,a)})),n,r,o,a)},e.prototype.moveSelectedContentWithinCurrentParagraph=function(e,t,n,r,i,o){var a=o,s=I.SelectionManager.get_instance().get_selectionCollection().get_currentSelection().get_firstContext().get_node(),l=x.y.createIpContext(s,a);return this.clipboardAction(e,t,n,r,i,l)},e.prototype.determineGetHtmlImportDomProvider=function(e,t){if(256&e)return new A(this.get_systemClipboard());var n=t;return 2&e?4096&e?new f(n,this._activityManager,this._clipboardDataHelper,c.App.get_instance().get_isHtmlImportFromClipboardDataEnable(),c.App.get_instance().get_shouldDisallowBrowserPaste()):new S(n,this._activityManager,c.App.get_instance().get_shouldDisallowBrowserPaste()):n.hasProperty(m.k.pastedPlainTextContent)?new C(n,this._activityManager,c.App.get_instance().get_shouldDisallowBrowserPaste()):new f(n,this._activityManager,this._clipboardDataHelper,c.App.get_instance().get_isHtmlImportFromClipboardDataEnable(),c.App.get_instance().get_shouldDisallowBrowserPaste())},e.get_pasteScratchPad=function(){return k.q.getScratchPad("Box4PasteScratchPad")},e}();(0,r.l)(R,"ClipboardActor",null,[])},6410:function(e,t,n){"use strict";var r=n(4548),i=n(2185),o=(0,i.y)("IScalableViewerChromeItemContainer"),a=n(5309),s=n(362);n.d(t,{m:function(){return l}});var l=function(e){function t(){var t=e.call(this)||this;return t._elementToTruncate=null,t}return(0,r.t)(t,e),t.prototype.hide=function(){this.get_elmContainer()&&(this._isVisible=!1,this.get_elmContainer().style.display="none")},t.prototype.undoScaling=function(){this._elementToTruncate&&(this._elementToTruncate.style.width="auto",this._elementToTruncate.style.maxWidth="none"),this.get_elmContainer()&&(this._isVisible=!0,this.get_elmContainer().style.display="inline-block")},t.prototype.truncateWidth=function(e){this._elementToTruncate&&(this._elementToTruncate.style.maxWidth=e+"px")},t}(s.x);(0,i.l)(l,"ScalableViewerChromeItemContainer",s.x,[o,a.m])},6532:function(e,t,n){"use strict";n.d(t,{h:function(){return b}});var r=n(2185),i=n(9965),o=n(7015),a=n(5793),s=n(8261),l=n(1085),c=n(6371),u=n(2133),g=n(1879),p=n(7577),d=n(3745),h=n(3079),_=n(6049),m=n(4248),f=n(4609),y=n(366),C=n(7573),S=n(6342),v=n(103),b=function(){function e(e,t){this._recordingGlyph=null,this._recordingWillStopWarning=null,this._audioFileUploader=null,this._fileEditor=null,this._permissionDeniedDialog=null,this._deviceNotFoundDialog=null,this._isRecordingPromptShowing=!1,this._isRecording=!1,this._isLibraryLoaded=!1,this._startTime=0,this._workerScriptText=null,this._maxDuration=0,this._audioRecorder=S.w.get_instance().tryResolve(d.h),this._recordingLengthTimer=-1,this._audioFileUploader=e,this._fileEditor=t}return e.prototype.get_maxDuration=function(){if(!this._maxDuration){var e=_.AFrameworkApplication.appSettingsManager.getIntAppSetting("OneNoteAudioRecordingMaxDuration",207);this._audioRecorder?this._maxDuration=Math.max(e,Math.floor(this._audioRecorder.getSupportedMaxDuration())):this._maxDuration=e,this._maxDuration-=1}return this._maxDuration},e.prototype.get_isRecording=function(){return this._isRecording||!!this._audioFileUploader.get_uploadState()},e.prototype.get_recordingDuration=function(){return this._startTime?((new Date).getTime()-this._startTime)/1e3:0},e.prototype.get_isPermissionDeniedDialogShowing=function(){return!!this._permissionDeniedDialog&&this._permissionDeniedDialog.get_isShowing()},e.prototype.get_isDeviceNotFoundDialogShowing=function(){return!!this._deviceNotFoundDialog&&this._deviceNotFoundDialog.get_isShowing()},e.prototype.registerActions=function(e){e.addAction(h.qc,u.n,r.i(this,this.recordAudio,"recordAudio")),e.addAction(h.qc,u.V,r.i(this,this.recordAudio,"recordAudio")),e.setActionFlags(h.qc,4),e.addAction(h.fw,u.n,r.i(this,this.stopAudioRecording,"stopAudioRecording")),e.setActionFlags(h.fw,4),e.addAction(h.YH,u.n,r.i(this,this.cancelAudioRecording,"cancelAudioRecording")),e.setActionFlags(h.YH,4)},e.prototype.recordAudio=function(e,t,n,r,i){var o=this;if(1===n){var s=t.get_nextContext();if(!s||!c.SelectionEditor.isInsertionPointContext(s))return 2;var l=this._fileEditor.canInsertFileInContext(t);return this.get_isRecording()||!l||this._isRecordingPromptShowing||this.get_isPermissionDeniedDialogShowing()||this.get_isDeviceNotFoundDialogShowing()?8:32}if(2===n){if(a.ULS.sendTraceTag(9213704,339,50,"AudioRecording:Start:Click"),_.AFrameworkApplication.limitedEdit)return _.AFrameworkApplication.showRequiresSignInDialog(),32;if(this._isLibraryLoaded)this.startRecording(t);else{var u=_.AFrameworkApplication.scriptUrlFromName("recorder.min.js",5),g=C.v.create(u);g.add_loadFinished((function(e,n){o.startRecording(t,e,n)})),y.z.enqueueResourceWithoutEnabling(g)}return 32}return 8},e.prototype.startRecording=function(e,t,n){var i=this;void 0===t&&(t=null),void 0===n&&(n=null),this._isLibraryLoaded=!0,this._workerScriptText?(this._isRecordingPromptShowing=!0,a.ULS.sendTraceTag(9213705,339,50,"AudioRecording:Start:Start"),this._audioRecorder.startRecording(r.i(this,this.audioRecordingStartedCallback,"audioRecordingStartedCallback"),this._workerScriptText),this._audioFileUploader.createPlaceholder(e)):this.requestWorkerScriptAndInvoke((function(){i.startRecording(e,t,n)}))},e.prototype.stopAudioRecording=function(t,n,r,i,o){if(1===r)return this._isRecording&&this._startTime>0?32:8;if(2===r){a.ULS.sendTraceTag(9213706,339,50,"AudioRecording:Stop:Click"),this._audioRecorder.stopRecording();var s=((new Date).getTime()-this._startTime)/1e3;return s>this.get_maxDuration()-15&&e.showRecordingLengthWarning(this.get_maxDuration()),this.resetRecordingUI(),a.ULS.sendTraceTag(9213707,339,50,"AudioRecording:Duration:{0}",s),32}return 8},e.prototype.cancelAudioRecording=function(e,t,n,r,o){return 2===n?(0,i.e)(g.k,o)!==this._audioFileUploader.get_placeholder()?8:(this._audioFileUploader.reset(),this._audioRecorder.clearRecording(),this.resetRecordingUI(),a.ULS.sendTraceTag(9246720,339,50,"AudioRecording:Cancel"),32):8},e.prototype.addAudioRecordingGlyphToRibbonTab=function(){var e=document.getElementById("ContextualTabs.Audio.Tools-title");if(e){var t=e.getElementsByTagName("a")[0];if(!this._recordingGlyph){this._recordingGlyph=t.ownerDocument.createElement("span"),this._recordingGlyph.className="clip16x16 RibbonRecordingGlyph";var n=t.ownerDocument.createElement("img");n.className=m.getImageClassWithCluster(_.AFrameworkApplication.get_imageClusterName(),"JotAudioStartRecording_16x16x32"),n.src=_.AFrameworkApplication.get_imageClusterPath(),this._recordingGlyph.appendChild(n)}t.insertBefore(this._recordingGlyph,t.firstChild)}},e.prototype.removeAudioRecordingGlyphFromRibbonTab=function(){var e=document.getElementById("ContextualTabs.Audio.Tools-title");if(e&&this._recordingGlyph){var t=e.getElementsByTagName("a")[0];t&&t.contains(this._recordingGlyph)&&t.removeChild(this._recordingGlyph)}},e.prototype.recordingLengthTick=function(){if(this.get_recordingDuration()<this.get_maxDuration()){var e=Math.round(this.get_maxDuration()-this.get_recordingDuration());e<=15&&(this._recordingWillStopWarning?this._recordingWillStopWarning.set_message(String.format(OneNoteIntl.OneNoteStrings.L_RecordingWillStop,e)):(this._recordingWillStopWarning=s.App.get_activeAppFrame().get_notificationBar().createEntry(String.format(OneNoteIntl.OneNoteStrings.L_RecordingWillStop,e),!0),this._recordingWillStopWarning.set_image(5),this._recordingWillStopWarning.set_imagePath("JotAudioStartRecording_16x16x32"),s.App.get_activeAppFrame().get_notificationBar().addEntry(this._recordingWillStopWarning))),s.App.get_activeAppFrame().updateCommandUI(),this._recordingLengthTimer=window.setTimeout(r.i(this,this.recordingLengthTick,"recordingLengthTick"),1e3)}else this.cancelRecordingLengthTimer(),a.ULS.sendTraceTag(9213708,339,50,"AudioRecording:Timeout"),_.AFrameworkApplication.get_theActionManager().processAction(h.fw,2)},e.prototype.cancelRecordingLengthTimer=function(){var e=this;this._recordingWillStopWarning&&(s.App.get_activeAppFrame().get_notificationBar().removeEntry(this._recordingWillStopWarning),this._recordingWillStopWarning=null),v.n.cancelPendingTimeout((0,o.m)((function(){return e._recordingLengthTimer}),(function(t){return e._recordingLengthTimer=t})))},e.prototype.showRecordingPermissionsDeniedError=function(){this._permissionDeniedDialog=new f.StandardDialog,this._permissionDeniedDialog.set_buttonsOption(0),this._permissionDeniedDialog.showError(l.o.recordingDeniedPermissions,OneNoteIntl.OneNoteStrings.L_RecordingDeniedPermissionsTitle,OneNoteIntl.OneNoteStrings.L_RecordingDeniedPermissions,null,!0)},e.prototype.showRecordingDeviceNotFoundError=function(){this._deviceNotFoundDialog=new f.StandardDialog,this._deviceNotFoundDialog.set_buttonsOption(0),this._deviceNotFoundDialog.showError(l.o.recordingDeviceNotFound,OneNoteIntl.OneNoteStrings.L_RecordingDeniedPermissionsTitle,OneNoteIntl.OneNoteStrings.L_RecordingDeviceNotFound,null,!0)},e.prototype.audioRecordingStartedCallback=function(t,r){if(this._isRecordingPromptShowing=!1,this._audioFileUploader.get_uploadState())if(t)this._isRecording=!0,e.activateAudioToolsRibbonTab(),this.addAudioRecordingGlyphToRibbonTab(),_.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteAudioPlaybackIsEnabled")&&S.w.get_instance().resolve(n(9354).AudioPlaybackActor).unattachAudioPlaybackControls(),a.ULS.sendTraceTag(9213710,339,50,"AudioRecording:Start:Success"),this._startTime=(new Date).getTime(),this.recordingLengthTick(),s.App.get_activeAppFrame().forceUpdateCommandUI();else{var i=r.name;a.ULS.sendTraceTag(9213709,339,50,"AudioRecording:Start:Failed:{0}",i),"PermissionDeniedError"===i||"NotAllowedError"===i?this.showRecordingPermissionsDeniedError():"NotFoundError"===i&&this.showRecordingDeviceNotFoundError(),this._audioFileUploader.reset(),this._audioRecorder.clearRecording(),this.resetRecordingUI()}else this._audioRecorder.clearRecording(),s.App.get_activeAppFrame().forceUpdateCommandUI()},e.prototype.resetRecordingUI=function(){this.removeAudioRecordingGlyphFromRibbonTab(),this.cancelRecordingLengthTimer(),this._isRecording=!1,this._startTime=0,s.App.get_activeAppFrame().forceUpdateCommandUI()},e.prototype.requestWorkerScriptAndInvoke=function(e){var t=this,n=_.AFrameworkApplication.scriptUrlFromName("recorderWorker.min.js",5),r=new XMLHttpRequest;r.open("GET",n,!0),r.onreadystatechange=function(){4===r.readyState&&200===r.status?(t._workerScriptText=r.responseText,e()):a.ULS.sendTraceTag(17584719,339,15,"AudioRecording:RequestWorkerScriptAndInvoke:Fail")},r.send()},e.activateAudioToolsRibbonTab=function(){var e=p.n.getOneNoteBox4BridgeCommandUi();e.isRibbonMinimized((function(t){t&&e.ribbonToggleMinimizedState(2)})),e.ribbonActivateTab("ContextualTabs.Audio.Tools")},e.showRecordingLengthWarning=function(e){var t=s.App.get_activeAppFrame().get_notificationBar().createEntry(String.format(OneNoteIntl.OneNoteStrings.L_RecordingTimeLimit,e),!1);t.set_image(3),s.App.get_activeAppFrame().get_notificationBar().addEntry(t)},e}();(0,r.l)(b,"AudioRecordingActor",null,[])},6776:function(e,t,n){"use strict";n.r(t),n.d(t,{Box4PasteSteward:function(){return U}});var r=n(4548),i=n(7513),o=n(6158),a=n(9513),s=n(8504),l=n(9965),c=n(7015),u=n(1489),g=n(7093),p=n(8244),d=n(5793),h=n(8261),_=n(8025),m=n(7384),f=n(397),y=n(8158),C=n(1458),S=n(7685),v=n(2759),b=n(3803),T=n(8370),A=n(2591),I=n(9631),w=n(3286),x=n(3205),F=n(4519),E=n(4257),P=n(1879),k=n(8234),D=n(7138),M=n(6049),R=n(6342),L=n(6129),N=n(5866),B=n(6365),O=n(2185),U=function(e){function t(n,r,i,o,a,s,l,c,u){void 0===c&&(c=null),void 0===u&&(u=null);var d=e.call(this,n,l,c,u)||this;return d._internalLinkManager=null,d._formatting=null,d._formattingInvalidated=!1,d._href=null,d._pastingIntoList=!1,d._nestedListCount=0,d._imageSteward=null,d._tableSteward=null,d.indentationEditor=null,d.listEditor=null,d.lstReader=null,d._hrefStartCp=-1,d._tablesToDelist=new g.c(P.k),p.x(4223754,307,T.OutlineElementReader.isOutlineElement(n)),d._imageSteward=r,d._imageSteward.bindToOwnerSteward(d),d._tableSteward=i,d._tableSteward.bindToOwnerSteward(d),d.indentationEditor=o,d.listEditor=a,d.lstReader=s,d._pastingIntoList=C.ListReader.isListOutlineElement(d._iterator),t.initializeParagraphStyleStrings(),t.initializeListStyles(),t.initializeSupportedStyleSet(),d}return(0,r.t)(t,e),t.prototype.get_internalLinkManager=function(){return this._internalLinkManager||(this._internalLinkManager=R.w.get_instance().tryResolve(i.v))},t.prototype.get_currentFormatting=function(){return this._formatting},t.prototype.get_continuingExistingList=function(){return this._pastingIntoList&&!this._tableSteward.get_currentlyInsidePastedTable()},t.prototype.get_currentlyUnderPastedList=function(){return this._nestedListCount>0},t.prototype.get_indentationEditor=function(){return this.indentationEditor},t.prototype.get_listEditor=function(){return this.listEditor},t.prototype.get_lstReader=function(){return this.lstReader},t.prototype.reset=function(){e.prototype.reset.call(this),this._formatting=this.getDefaultFormatting(!1)},t.prototype.appendNewParagraph=function(e){p.x(4223762,307,T.OutlineElementReader.isOutlineElement(this._iterator)||b.isOutline(this._iterator)),this.moveToNextOutlineElementForHtmlImport(!1);var n=new E.GraphIterator;n.setFrom(this._iterator);var r=u.a.get_outlineElementEditor().createParagraph(this._iterator,this.getNewOutlineElementInfo(e));if(this.applyPendingListAndIndentationInfo(n,!1),p.x(4223763,307,r===this._iterator.get_currentNode()),p.x(4223764,307,f.ParagraphReader.isParagraphNode(r)),-1!==this._formatting.get_justification()&&t.get_paragraphEditor().setJustification(r,this._formatting.get_justification()),t.get_paragraphEditor().getIndentationEditor()&&!this._box4PasteStewardBridge.get_shouldSkipSettingIndentation()){if(this._formatting.get_textIndent()){var i=0,o=void 0,a=!1;if((o=t.parseCssValue(this._formatting.get_textIndent(),(0,c.m)((function(){return i}),(function(e){return i=e}))))||!C.ListReader.get_externalPasteImprovementsEnabled()){o<0&&(a=!0,o*=-1);var s=t.convertToTwips(o,i);a?t.get_paragraphEditor().getIndentationEditor().setHangingIndent(r,s):t.get_paragraphEditor().getIndentationEditor().setFirstLineIndent(r,s)}}if(this._formatting.get_marginLeft()&&!t.get_listSettings().isQoEListExternalPasteImprovementIsEnabled&&!C.ListReader.isListOutlineElement(n)){var l,g=0;l=t.parseCssValue(this._formatting.get_marginLeft(),(0,c.m)((function(){return g}),(function(e){return g=e})));s=t.convertToTwips(l,g);t.get_paragraphEditor().getIndentationEditor().setIndentLeftOnNode(r,1,s)}}(t.get_trackChangeManager().get_trackChangeFeatureIsEnabled()&&t.get_trackChangeManager().get_changeTrackingDocumentSettingEnabled()||y.n.get_instance().get_item(45)&&h.App.get_box4Bridge().get_trackedChangesEnabled())&&r.setValue(k.j.isNewEop,!0),this._formatting.get_lineSpacing()&&t.get_paragraphEditor().setLineSpacing(r,this._formatting.get_lineSpacing()),this._formatting.set_paragraph(r),this._formattingInvalidated=!0},t.prototype.applyPendingListAndIndentationInfo=function(e,t){p.x(8128518,307,!t),this.get_pendingIndentationLevel()&&!y.n.get_instance().get_item(76)&&(this.get_pendingIndentationLevel()>0&&this.get_indentationEditor().demote(e,this.get_pendingIndentationLevel(),0),this.get_pendingIndentationLevel()<0&&this.get_indentationEditor().promote(e,this.get_pendingIndentationLevel(),0)),y.n.get_instance().get_item(29)&&(this._iterator.setFrom(e),v.OutlineElementNavigator.moveToContent(this._iterator)),!this.get_continuingExistingList()||2===h.App.get_mode()&&this.get_lstReader().get_qoEListInternalCCPImprovementIsEnabled()?e&&this.get_listEditor().setListInfoAndIndentAfterPaste(e,this.get_currentlyUnderPastedList()):this.get_listEditor().setProperPendingListInfoAfterPaste(e),this.set_pendingIndentationLevel(0)},t.prototype.trackTableToDelist=function(e){this._tablesToDelist.add(e)},t.prototype.clearPendingIndentation=function(){this.set_pendingIndentationLevel(0)},t.prototype.onText=function(e,t){void 0===t&&(t=null),p.x(4223772,307,f.ParagraphReader.isParagraph(this._iterator));var n=this._iterator.get_currentNode();if(this._formatting.tryApplyCharacterStyle(n),!this._box4PasteStewardBridge.tryHandlePageBreak(this._iterator,t,!1)){var r=n.get_characterProperties().get_last(),i=w.y.createIpContextAtEndOfParagraph(n);if(this._formattingInvalidated&&(r.set_formatting(this._formatting.get_formattingObject().cloneUnderDifferentChp(r)),y.n.get_instance().get_item(57)&&n.updateRunIndices(),this._formattingInvalidated=!1),e=this._box4PasteStewardBridge.handleParagraphEnd(e,t),this._box4PasteStewardBridge.setParagraphProperties(this._iterator.get_currentNode(),this._formatting.get_paragraphProperties(),t),this.get_characterPropertiesEditor().replaceTextRange(i,e,void 0,void 0,D.LS),y.n.get_instance().get_item(2)){var o=i.get_node();o.canChangeIdOnTextChange()&&o.get_anchor().changeNodeId()}}},t.prototype.onLineBreak=function(e){if(this._box4PasteStewardBridge.get_isPasteBrAsNewParagraphEnabled()&&this._box4PasteStewardBridge.isFormatless(e))this.onParagraphEnd(),this.onParagraphStart(e);else{p.x(4223773,307,f.ParagraphReader.isParagraph(this._iterator));var t=this._iterator.get_currentNode(),n=w.y.createIpContextAtEndOfParagraph(t);this.get_characterPropertiesEditor().insertBlobAtIp(n,(function(e){return new x.y(e,x.y.defaultLineBreakText)}),_.AParagraphNode.embeddedObjectText)}},t.prototype.onTab=function(e){this._box4PasteStewardBridge.handleTabCharacter(this._iterator,e)},t.prototype.onImage=function(e){this._imageSteward.onImage(e)},t.prototype.onFile=function(e){this._imageSteward.onFile(e)},t.prototype.onFormattingChange=function(e){this._formatting=e,this._formattingInvalidated=!0},t.prototype.onAnchorStart=function(e,t){p.x(4223774,307,f.ParagraphReader.isParagraph(this._iterator)),p.x(4223775,307,!this._href),p.x(4223776,307,this._hrefStartCp<0),this._href=e,this._hrefStartCp=f.ParagraphReader.textLength(this._iterator.get_currentNode())},t.prototype.onAnchorEnd=function(){p.x(4223777,307,f.ParagraphReader.isParagraph(this._iterator)),p.x(4223778,307,!!this._href),p.x(4223779,307,this._hrefStartCp>=0);var e=w.y.createTextRange(this._iterator.get_currentNode(),this._hrefStartCp,f.ParagraphReader.textLength(this._iterator.get_currentNode())),n=!1,r="",i="";this.get_internalLinkManager()&&this.get_internalLinkManager().tryConvertToRelativeLink(m.HyperlinkReader.getSanitizedUrl(this._href),(0,c.m)((function(){return r}),(function(e){return r=e})),!0,(0,c.m)((function(){return i}),(function(e){return i=e})))&&(this._href=r,n=!0,i&&(this.get_characterPropertiesEditor().replaceTextRange(e,i),e=w.y.createTextRange(this._iterator.get_currentNode(),this._hrefStartCp,f.ParagraphReader.textLength(this._iterator.get_currentNode())))),t.get_hyperlinkEditor().createHyperlink(e,this._href,!1),n||this._box4PasteStewardBridge.processExternalHyperlink(e,this._href),this._formattingInvalidated=!0,this._href=null,this._hrefStartCp=-1},t.prototype.onParagraphStart=function(e){this.appendNewParagraph(e),this._formatting.tryApplyParagraphStyle(this._iterator.get_currentNode()),e&&"P"===e.get_ownerHtmlElementInfo().get_htmlElementType()&&t.get_paragraphEditor().setParagraphSpacing(this._iterator.get_currentNode(),this._formatting.get_paragraphSpacing()),this._box4PasteStewardBridge.setParagraphProperties(this._iterator.get_currentNode(),this._formatting.get_paragraphProperties(),e,this._formatting.get_marginLeft(),this._formatting.get_textIndent())},t.prototype.onParagraphEnd=function(){p.x(4223808,307,f.ParagraphReader.isParagraph(this._iterator)),t.get_hyperlinkEditor().ensureHyperlinkObjectsCreatedInParagraph(this._iterator.get_currentNode()),v.OutlineElementNavigator.returnToOutlineElement(this._iterator)},t.prototype.onPreFormattedTextStart=function(){},t.prototype.onPreFormattedTextEnd=function(){},t.prototype.onMathStart=function(e,t){},t.prototype.onMathEnd=function(){},t.prototype.processMath=function(e,t,n,r,i){var o=this._iterator.get_currentNode(),a=o.get_characterProperties().get_last(),s=w.y.createIpContextAtEndOfParagraph(o);this._formattingInvalidated&&(a.set_formatting(this._formatting.get_formattingObject().cloneUnderDifferentChp(a)),y.n.get_instance().get_item(57)&&o.updateRunIndices(),this._formattingInvalidated=!1);var c=new F.r(t,n,r,this._formatting.get_formattingObject().get_formattingId(),i);I.t((0,l.e)(_.AParagraphNode,s.get_node()),c)},t.prototype.onListStart=function(e){p.x(4223809,307,T.OutlineElementReader.isOutlineElement(this._iterator)||b.isOutline(this._iterator));var t=!1;this.get_currentlyUnderPastedList()||(t=this.get_continuingExistingList()||this.get_lstReader().doListItemsAutoIndent()),t||this.set_pendingIndentationLevel(this.get_pendingIndentationLevel()+1),this._nestedListCount++},t.prototype.onListEnd=function(){this._nestedListCount--;var e=!1;this.get_currentlyUnderPastedList()||(e=this.get_continuingExistingList()||this.get_lstReader().doListItemsAutoIndent(),this.get_listEditor().removeListsFromTablesIfNecessary(this._tablesToDelist)),e||(this.set_pendingIndentationLevel(this.get_pendingIndentationLevel()-1),this.get_pendingIndentationLevel())},t.prototype.onListItemStart=function(e){p.x(4223810,307,T.OutlineElementReader.isOutlineElement(this._iterator)||b.isOutline(this._iterator)),p.x(4223811,307,!!e.get_listStyleType());var t=e;this.get_listEditor().setListInfo(this.listInfoFromListSemanticArgs(t))},t.prototype.onListItemEnd=function(){if(p.x(4223813,307,T.OutlineElementReader.isOutlineElement(this._iterator)),M.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordQoEListExternalPasteImprovementSettings"),t.get_listSettings().isQoEListExternalPasteImprovementIsEnabled&&C.ListReader.isListOutlineElement(this._iterator)){var e=f.ParagraphReader.getFirstParagraphUnderNode(this._iterator.get_currentNode()),n=this.get_lstReader().getListNodeFromOE(this._iterator);this.get_listEditor().setListFormatting(n,e,null)}},t.prototype.onRenderAugmentation=function(e){this._imageSteward.onRenderAugmentation(e)},t.prototype.onSpanStart=function(){},t.prototype.onSpanEnd=function(){},t.prototype.onTableStart=function(e){this._tableSteward.onTableStart(e)},t.prototype.onTableEnd=function(){this._tableSteward.onTableEnd()},t.prototype.onTableRowStart=function(e){this._tableSteward.onTableRowStart(e)},t.prototype.onTableRowEnd=function(){this._tableSteward.onTableRowEnd()},t.prototype.onTableCellStart=function(e){this._tableSteward.onTableCellStart(e)},t.prototype.onTableCellEnd=function(){this._tableSteward.onTableCellEnd()},t.prototype.onTablePartStart=function(e){this._tableSteward.onTablePartStart(e)},t.prototype.onTablePartEnd=function(){this._tableSteward.onTablePartEnd()},t.get_paragraphEditor=function(){return t._paragraphEditor||(t._paragraphEditor=R.w.get_instance().resolve(o.g))},t.get_hyperlinkEditor=function(){return t._hyperlinkEditor||(t._hyperlinkEditor=R.w.get_instance().resolve(a.o))},t.get_trackChangeManager=function(){return t._trackChangeManager||(t._trackChangeManager=R.w.get_instance().resolve(s.b).get_instance())},t.get_supportedStyleSet=function(){return t._supportedStyleSet},t.get_listSettings=function(){return t._listSettings||(t._listSettings=R.w.get_instance().tryResolve(S.r))},t.initializeParagraphStyleStrings=function(){var e=y.n.get_instance().get_item(61);t.paragraphStyleStrings[1]=e?A.StyleReader.get_wordStyleIdHeading1():A.StyleReader.styleIdHeading1,t.paragraphStyleStrings[2]=e?A.StyleReader.get_wordStyleIdHeading2():A.StyleReader.styleIdHeading2,t.paragraphStyleStrings[3]=e?A.StyleReader.get_wordStyleIdHeading3():A.StyleReader.styleIdHeading3,t.paragraphStyleStrings[4]=e?A.StyleReader.get_wordStyleIdHeading4():A.StyleReader.styleIdHeading4,t.paragraphStyleStrings[5]=e?A.StyleReader.get_wordStyleIdHeading5():A.StyleReader.styleIdHeading5,t.paragraphStyleStrings[6]=e?A.StyleReader.get_wordStyleIdHeading6():A.StyleReader.styleIdHeading6,t.paragraphStyleStrings[7]=e?null:A.StyleReader.styleIdCitation},t.initializeListStyles=function(){t.listStyleMap.unspecified=0,t.listStyleMap.defaultUnordered=1,t.listStyleMap.defaultOrdered=1,t.listStyleMap.none=0,t.listStyleMap.disc=1,t.listStyleMap.circle=2,t.listStyleMap.square=3,t.listStyleMap.decimal=1,t.listStyleMap.lowerAlpha=2,t.listStyleMap.lowerRoman=3,t.listStyleMap.upperAlpha=4,t.listStyleMap.upperRoman=5},t.initializeSupportedStyleSet=function(){t._supportedStyleSet=A.StyleReader.getStyleSetFromActivePage()},t.convertRgbToBgr=function(e){var t=N.l.substring(e,0,2),n=N.l.substring(e,2,4);return N.l.substring(e,4,6)+n+t},t.parseCssValue=function(e,t){var n=0;t.val=0;var r=e.length,i=N.l.substring(e,0,r-2);n=parseFloat(i);var o=N.l.substr(e,r-2,2);switch(o){case"in":t.val=3;break;case"px":t.val=7;break;case"cm":t.val=1;break;case"pt":t.val=5;break;default:d.ULS.sendTraceTag(8208450,307,50,"Pasted DOM with unrecognized css length unit {0}, will default to UnitType.None and value 0",o),n=0}return n},t.convertToTwips=function(e,t){var n=0;switch(t){case 3:n=B.AP(e);break;case 7:n=L.o(e,0);break;case 1:n=B.cm(e);break;case 5:var r=B.We(e);n=B.AP(r);break;default:d.ULS.sendTraceTag(8208451,307,50,"ConvertToTwips unable to convert inputValue {0} and inputUnit {1} to twips, returning 0",e,t)}return n},t._paragraphEditor=null,t._hyperlinkEditor=null,t._trackChangeManager=null,t.paragraphStyleStrings=new Array(8),t.listStyleMap={},t._supportedStyleSet=null,t._listSettings=null,t}(u.a);(0,O.l)(U,"Box4PasteSteward",u.a,[])},6983:function(e,t,n){"use strict";var r=n(2185),i=(0,r.y)("IOICErrorDialogFactory"),o=n(4548),a=n(1681),s=n(5793),l=n(6049),c=n(5396),u=n(8058),g=n(6342),p=function(){function e(e,t,n,r){this._dialogCause=0,this._onLaunchDownload=null,this._onDialogDismissed=null,this._callbackData=null,this._shouldOfferMacOfficeTrial=!1,this._macOfficeOffer=null,this.macOfficePreLinkText=null,this.macOfficePostLinkText=null,this._dialogCause=r,this._onDialogDismissed=e,this._onLaunchDownload=t,this._callbackData=n,this._shouldOfferMacOfficeTrial=this.get_macOfficeOffer().get_shouldOfferMacOfficeTrialInErrorDialog();var i=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.macOfficePreLinkText=i[0],this.macOfficePostLinkText=i[1]}return e.prototype.get_macOfficeOffer=function(){return this._macOfficeOffer||(this._macOfficeOffer=g.w.get_instance().resolve(a.u))},e.prototype.get_id=function(){return"OICErrorDialog"},e.prototype.get_errorMessage=function(){return CommonUIStrings.l_OICErrorMessage},e.prototype.get_helpLinkText=function(){return CommonUIStrings.l_OICErrorHelpLink},e.prototype.get_shouldOfferMacOfficeTrial=function(){return this._shouldOfferMacOfficeTrial},e.prototype.get_macOfficePreLinkText=function(){return this.macOfficePreLinkText},e.prototype.get_macOfficePostLinkText=function(){return this.macOfficePostLinkText},e.prototype.get_macOfficeLinkText=function(){return CommonUIStrings.l_OICErrorMacOFficeLink},e.prototype.get_icon=function(){return this._shouldOfferMacOfficeTrial?3:2},e.prototype.get_errorFileDownloadOffer=function(){return CommonUIStrings.l_OICErrorFileDownloadOffer},e.prototype.get_containsOnLaunchDownload=function(){return!!this._onLaunchDownload},e.prototype.get_errorNoOfficeDownloadButtonText=function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton},e.prototype.get_dialogTitle=function(){return CommonUIStrings.l_DefaultDialogTitle},e.prototype.reactOICErrorDialogHandler=function(e,t){this.oicErrorDialogHandler(e)},e.prototype.legacyOICErrorDialogHandler=function(e,t){this.oicErrorDialogHandler(e)},e.prototype.oicErrorDialogHandler=function(e){var t=10;this._onLaunchDownload&&1===e&&(this._onLaunchDownload(this._callbackData),t=1),this._onDialogDismissed&&this._onDialogDismissed(this._callbackData),this.reportError(t)},e.prototype.oicErrorHelpLinkHandler=function(e){u.Redirect.showHelp("OICFailure"),this.reportError(2)},e.prototype.oicErrorMacOfferLinkHandler=function(e){this.get_macOfficeOffer().launchMacOfficeTrialWindow(),this.reportError(4)},e.prototype.reportError=function(e){s.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this._dialogCause,e),l.AFrameworkApplication.reportErrorWithCauseAndResolution(c.p.openInClientFailed,this._dialogCause,e)},e.prototype.dispose=function(){this._onLaunchDownload=null,this._onDialogDismissed=null,this._callbackData=null},e}();(0,r.l)(p,"AOICErrorDialog",null,[Sys.IDisposable]);var d=n(7979),h=n(4609),_="errorMessageText",m=function(e){function t(t,n,i,o){var a=e.call(this,t,n,i,o)||this;a._helpLink=null,a._macOfferLink=null;var s=document.createElement("span");s.id=_,s.innerText=a.get_errorMessage(),u.Redirect.isHelpAvailable()&&(s.appendChild(document.createElement("br")),s.appendChild(document.createElement("br")),a._helpLink=document.createElement("a"),a._helpLink.href="#",a._helpLink.innerText=a.get_helpLinkText(),s.appendChild(a._helpLink),d.n.addHandler(a._helpLink,"click",r.i(a,a.oicErrorHelpLinkHandler,"oicErrorHelpLinkHandler")));var l=new h.StandardDialog;if(l.set_dialogId(a.get_id()),a.get_shouldOfferMacOfficeTrial()){var c=document.createElement("span"),g=document.createElement("span");c.innerText=a.get_macOfficePreLinkText(),g.innerText=a.get_macOfficePostLinkText(),a._macOfferLink=document.createElement("a"),a._macOfferLink.href="#",a._macOfferLink.innerText=a.get_macOfficeLinkText(),s.appendChild(document.createElement("br")),s.appendChild(c),s.appendChild(a._macOfferLink),s.appendChild(g),d.n.addHandler(a._macOfferLink,"click",r.i(a,a.oicErrorMacOfferLinkHandler,"oicErrorMacOfferLinkHandler"))}else if(a.get_containsOnLaunchDownload()){s.appendChild(document.createElement("br")),s.appendChild(document.createElement("br"));var p=document.createElement("span");p.innerText=a.get_errorFileDownloadOffer(),s.appendChild(p)}return a.get_containsOnLaunchDownload()?(l.set_buttonsOption(1),l.setButtonText(1,a.get_errorNoOfficeDownloadButtonText())):l.set_buttonsOption(0),l.messageBox(a.get_dialogTitle(),null,a.get_icon(),r.i(a,a.legacyOICErrorDialogHandler,"legacyOICErrorDialogHandler"),s),l.setDescribedByForDialog(_),a}return(0,o.t)(t,e),t.prototype.dispose=function(){this._helpLink&&(d.n.removeHandler(this._helpLink,"click",r.i(this,this.oicErrorHelpLinkHandler,"oicErrorHelpLinkHandler")),this._helpLink=null),this._macOfferLink&&(d.n.removeHandler(this._macOfferLink,"click",r.i(this,this.oicErrorMacOfferLinkHandler,"oicErrorMacOfferLinkHandler")),this._macOfferLink=null),e.prototype.dispose.call(this)},t}(p);(0,r.l)(m,"OICErrorDialog",p,[]);var f=function(){function e(e,t,n){this._onDialogDismissed=null,this._onLaunchDownload=null,this._callbackData=null,this._onDialogDismissed=t,this._onLaunchDownload=e,this._callbackData=n}return e.prototype.get_id=function(){return"OICErrorDialogWithDownload"},e.prototype.get_errorMessageNoOfficeDetected=function(){return CommonUIStrings.l_OICErrorNoOfficeDetected},e.prototype.get_helpLinkText=function(){return CommonUIStrings.l_OICErrorHelpLink},e.prototype.get_errorFileDownloadOffer=function(){return CommonUIStrings.l_OICErrorFileDownloadOffer},e.prototype.get_errorNoOfficeDownloadButtonText=function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton},e.prototype.get_icon=function(){return 2},e.prototype.get_dialogTitle=function(){return CommonUIStrings.l_DefaultDialogTitle},e.prototype.reactOICErrorDialogHandler=function(e,t){this.oicErrorDialogHandler(e)},e.prototype.legacyOICErrorDialogHandler=function(e,t){this.oicErrorDialogHandler(e)},e.prototype.oicErrorDialogHandler=function(e){var t=10;1===e&&(this._onLaunchDownload(this._callbackData),t=1),this._onDialogDismissed&&this._onDialogDismissed(this._callbackData),this.reportError(t)},e.prototype.oicErrorHelpLinkHandler=function(e){u.Redirect.showHelp("OICFailure"),this.reportError(2)},e.prototype.reportError=function(e){l.AFrameworkApplication.reportErrorWithCauseAndResolution(c.p.openInClientSecondaryFailed,3,e)},e.prototype.dispose=function(){this._onDialogDismissed=null,this._onLaunchDownload=null,this._callbackData=null},e}();(0,r.l)(f,"AOICErrorDialogWithDownload",null,[Sys.IDisposable]);var y="errorMessageText",C=function(e){function t(t,n,i){var o=e.call(this,t,n,i)||this;o._helpLink=null;var a=document.createElement("span");a.id=y,a.innerText=o.get_errorMessageNoOfficeDetected(),u.Redirect.isHelpAvailable()&&(a.appendChild(document.createElement("br")),a.appendChild(document.createElement("br")),o._helpLink=document.createElement("a"),o._helpLink.href="#",o._helpLink.innerText=o.get_helpLinkText(),a.appendChild(o._helpLink),d.n.addHandler(o._helpLink,"click",r.i(o,o.oicErrorHelpLinkHandler,"oicErrorHelpLinkHandler"))),a.appendChild(document.createElement("br")),a.appendChild(document.createElement("br"));var s=document.createElement("span");s.innerText=o.get_errorFileDownloadOffer(),a.appendChild(s);var l=new h.StandardDialog;return l.set_dialogId(o.get_id()),l.set_buttonsOption(1),l.setButtonText(1,o.get_errorNoOfficeDownloadButtonText()),l.messageBox(o.get_dialogTitle(),null,o.get_icon(),r.i(o,o.legacyOICErrorDialogHandler,"legacyOICErrorDialogHandler"),a),l.setDescribedByForDialog(y),o}return(0,o.t)(t,e),t.prototype.dispose=function(){this._helpLink&&(d.n.removeHandler(this._helpLink,"click",r.i(this,this.oicErrorHelpLinkHandler,"oicErrorHelpLinkHandler")),this._helpLink=null),e.prototype.dispose.call(this)},t}(f);(0,r.l)(C,"OICErrorDialogWithDownload",f,[]);var S=n(6500),v=function(e){function t(t,n,i,o){var a=e.call(this,t,n,i,o)||this,s={errorMessage:a.get_errorMessage()};if(u.Redirect.isHelpAvailable()){s.helpLink={type:"AppLinkProps",id:"helpLink",text:a.get_helpLinkText(),handler:function(e){a.oicErrorHelpLinkHandler(e)}}}if(a.get_shouldOfferMacOfficeTrial()){s.macOfficePreLinkText=a.get_macOfficePreLinkText();s.macOfficeLink={type:"AppLinkProps",id:"macOfficeLink",text:a.get_macOfficeLinkText(),handler:function(e){a.oicErrorMacOfferLinkHandler(e)}},s.macOfficePostText=a.get_macOfficePostLinkText()}else a.get_containsOnLaunchDownload()&&(s.errorFileDownloadOffer=a.get_errorFileDownloadOffer());var l=new S.o(!1,!1,!0);a.get_containsOnLaunchDownload()?(l.set_buttonsOption(1),l.setButtonText(1,a.get_errorNoOfficeDownloadButtonText())):l.set_buttonsOption(0),l.set_dialogId(a.get_id());var c={id:a.get_id(),dialogIcon:a.get_icon(),bodyControls:s};return l.initializeAndShow(a.get_dialogTitle(),r.i(a,a.reactOICErrorDialogHandler,"reactOICErrorDialogHandler"),c),a}return(0,o.t)(t,e),t}(p);(0,r.l)(v,"ReactOICErrorDialog",p,[]);var b=function(e){function t(t,n,i){var o=e.call(this,t,n,i)||this,a={errorMessage:o.get_errorMessageNoOfficeDetected(),errorFileDownloadOffer:o.get_errorFileDownloadOffer()};if(u.Redirect.isHelpAvailable()){a.helpLink={type:"AppLinkProps",id:"helpLink",text:o.get_helpLinkText(),handler:function(e){o.oicErrorHelpLinkHandler(e)}}}var s=new S.o(!1,!1,!0);s.set_buttonsOption(1),s.setButtonText(1,o.get_errorNoOfficeDownloadButtonText()),s.set_dialogId(o.get_id());var l={id:o.get_id(),dialogIcon:o.get_icon(),bodyControls:a};return s.initializeAndShow(o.get_dialogTitle(),r.i(o,o.reactOICErrorDialogHandler,"reactOICErrorDialogHandler"),l),o}return(0,o.t)(t,e),t}(f);(0,r.l)(b,"ReactOICErrorDialogWithDownload",f,[]),n.d(t,{p:function(){return T}});var T=function(){function e(){this._isReactDialogEnabled=!1,this._isReactDialogEnabled=!!l.AFrameworkApplication.get_activeFrame()&&l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactDialogEnabled()}return e.prototype.createOICErrorDialog=function(e,t,n,r){return this._isReactDialogEnabled?new v(e,t,n,r):new m(e,t,n,r)},e.prototype.createOICErrorDialogWithDownload=function(e,t,n){return this._isReactDialogEnabled?new b(e,t,n):new C(e,t,n)},e.prototype.createOICErrorDialogWithTrial=function(e,t,r,i,o,a){return this._isReactDialogEnabled?new(n(520).ReactOICErrorDialogWithTrial)(e,t,r,i,o,a):new(n(566).OICErrorDialogWithTrial)(e,t,r,i,o,a)},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,r.l)(T,"OICErrorDialogFactory",null,[i])},7441:function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var r=n(2185),i=function(){return function(){this.label=null,this.onExecute=null,this.ariaDescription=null}}();(0,r.l)(i,"CalloutButtonProps",null,[])},7732:function(e,t,n){"use strict";n.d(t,{p:function(){return r}});var r=(0,n(2185).y)("ISemanticTableEventAcceptor")},8803:function(e,t,n){"use strict";n.r(t),n.d(t,{ToolbarContainer:function(){return s}});var r=n(4548),i=n(362),o=n(4126),a=n(2185),s=function(e){function t(){var t=e.call(this)||this;return t.set_elmContainer(o.k.createUnselectableElement("span")),t.get_elmContainer().className="cui-herobar-toolbarContainer",t.get_elmContainer().id="viewerChrome-ToolbarContainer",t}return(0,r.t)(t,e),t}(i.x);(0,a.l)(s,"ToolbarContainer",i.x,[])},9354:function(e,t,n){"use strict";n.r(t),n.d(t,{AudioPlaybackActor:function(){return _}});var r=n(2185),i=n(5793),o=n(8261),a=n(4120),s=n(2133),l=n(7577),c=n(6532),u=n(4784),g=n(3079),p=n(6049),d=n(6342),h=n(2852),_=function(){function e(){this._attachedAudioNode=null}return e.prototype.get_isAudioAttached=function(){return!!this._attachedAudioNode&&!!this._attachedAudioNode.audioElement},e.prototype.get_isAttachedAudioSeekable=function(){return this.get_attachedAudioElement().get_readyState()>0&&!this.get_attachedAudioElement().get_error()},e.prototype.get_attachedAudioElement=function(){return this._attachedAudioNode.audioElement},e.prototype.registerActions=function(e){var t=this;o.App.get_activeAppFrame().workspace.add_activePageChanged((function(e,n){t.unattachAudioPlaybackControls()})),e.addAction(g.FG,s.n,r.i(this,this.seekMedia,"seekMedia")),e.addActionWithFlags(g.wj,s.n,r.i(this,this.querySeekMedia,"querySeekMedia"),96),e.addAction(g.EA,s.I,r.i(this,this.playEmbeddedMedia,"playEmbeddedMedia")),e.addAction(g.EA,s.c,r.i(this,this.playEmbeddedMedia,"playEmbeddedMedia")),e.addAction(g.EA,s.n,r.i(this,this.resumeEmbeddedMedia,"resumeEmbeddedMedia")),e.addAction(g.Rj,s.I,r.i(this,this.pauseEmbeddedMedia,"pauseEmbeddedMedia")),e.addAction(g.Rj,s.c,r.i(this,this.pauseEmbeddedMedia,"pauseEmbeddedMedia")),e.addAction(g.Rj,s.n,r.i(this,this.pauseEmbeddedMedia,"pauseEmbeddedMedia")),e.addAction(g.GK,s.I,r.i(this,this.skipForwardOnEmbeddedMedia,"skipForwardOnEmbeddedMedia")),e.addAction(g.GK,s.c,r.i(this,this.skipForwardOnEmbeddedMedia,"skipForwardOnEmbeddedMedia")),e.addAction(g.GK,s.n,r.i(this,this.skipForwardOnEmbeddedMedia,"skipForwardOnEmbeddedMedia")),e.addAction(g.Ch,s.I,r.i(this,this.skipBackwardOnEmbeddedMedia,"skipBackwardOnEmbeddedMedia")),e.addAction(g.Ch,s.c,r.i(this,this.skipBackwardOnEmbeddedMedia,"skipBackwardOnEmbeddedMedia")),e.addAction(g.Ch,s.n,r.i(this,this.skipBackwardOnEmbeddedMedia,"skipBackwardOnEmbeddedMedia"))},e.prototype.unattachAudioPlaybackControls=function(){this._attachedAudioNode=null},e.prototype.playEmbeddedMedia=function(e,t,n,r,o){if(a.EmbeddedFileReader.isEmbeddedFileOrFloatingEmbeddedFileContext(t)&&a.EmbeddedFileReader.isPlayableAudio(t.get_node())){var s=t.get_node();if(1===n)return!s.audioElement.get_paused()||this.get_isAudioAttached()&&!this.get_attachedAudioElement().get_paused()?8:32;if(2===n){if(this.get_isAudioAttached()&&!this.get_attachedAudioElement().get_error()&&this._attachedAudioNode!==s&&(this.get_attachedAudioElement().pause(),this.get_attachedAudioElement().set_currentTime(0)),this._attachedAudioNode=s,this.get_attachedAudioElement().play(),o){var c=l.n.getOneNoteBox4BridgeCommandUi();p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()||c.isRibbonMinimized((function(e){e&&c.ribbonToggleMinimizedState(2)})),c.ribbonActivateTab("ContextualTabs.Audio.Tools")}return i.ULS.sendTraceTag(8725076,339,50,"AudioPlayback:Play"),32}}return 8},e.prototype.pauseEmbeddedMedia=function(e,t,n,r,o){if(this.get_isAudioAttached()){if(1===n)return this.get_attachedAudioElement().get_paused()||this.get_attachedAudioElement().get_error()?8:32;if(2===n)return this.get_attachedAudioElement().pause(),i.ULS.sendTraceTag(8725077,339,50,"AudioPlayback:Pause"),32}return 8},e.prototype.skipForwardOnEmbeddedMedia=function(e,t,n,r,o){if(this.get_isAudioAttached()&&this.get_isAttachedAudioSeekable()){if(1===n)return 32;if(2===n){var a=this.get_attachedAudioElement().get_currentTime()+15;return a>=this.get_attachedAudioElement().get_duration()&&(a=0,this.get_attachedAudioElement().pause()),this.get_attachedAudioElement().set_currentTime(a),i.ULS.sendTraceTag(8725078,339,50,"AudioPlayback:SkipForward"),32}}return 8},e.prototype.skipBackwardOnEmbeddedMedia=function(e,t,n,r,o){if(this.get_isAudioAttached()&&this.get_isAttachedAudioSeekable()){if(1===n)return 32;if(2===n)return this.get_attachedAudioElement().set_currentTime(Math.max(this.get_attachedAudioElement().get_currentTime()-15,0)),i.ULS.sendTraceTag(8725079,339,50,"AudioPlayback:SkipBack"),32}return 8},e.prototype.seekMedia=function(e,t,n,r,o){if(this.get_isAudioAttached()&&this.get_isAttachedAudioSeekable()){if(1===n)return 32;if(2===n){var a=o[h.u.Value];return this.get_attachedAudioElement().set_currentTime(a),i.ULS.sendTraceTag(8725080,339,50,"AudioPlayback:Seek"),32}}return 8},e.prototype.querySeekMedia=function(t,n,r,i,o){if(1===r){if(this.get_isAudioAttached()||u.c.get_isRecordingAudio())return 32}else if(2===r){var a=0,s=0,l="00:00 / 00:00",g=o;return this.get_isAudioAttached()?(a=this.get_attachedAudioElement().get_currentTime(),s=this.get_attachedAudioElement().get_duration(),l=this.get_attachedAudioElement().get_error()?OneNoteIntl.OneNoteStrings.L_FileUnplayable:e.formatProgressString(a,s)):u.c.get_isRecordingAudio()&&(a=d.w.get_instance().resolve(c.h).get_recordingDuration(),s=d.w.get_instance().resolve(c.h).get_maxDuration(),l=e.formatProgressString(a,s)),g[h.u.Value]=a,g[h.u.MaxValue]=s,g[h.u.Text]=l,32}return 8},e.prototype.resumeEmbeddedMedia=function(e,t,n,r,o){var a="boolean"==typeof o&&o;if(this.get_isAudioAttached()&&this.get_attachedAudioElement().get_paused()&&!a){if(1===n)return 32;if(2===n)return this.get_attachedAudioElement().play(),i.ULS.sendTraceTag(9217553,339,50,"AudioPlayback:Resume"),32}return 2},e.formatProgressString=function(t,n){if(isNaN(n))return OneNoteIntl.OneNoteStrings.L_Loading;var r=e.getTimeSpanStringFromSeconds(t),i=e.getTimeSpanStringFromSeconds(n);return i.startsWith("00:")&&(r=r.substr(3),i=i.substr(3)),r+" / "+i},e.getTimeSpanStringFromSeconds=function(e){var t=new Date(1e3*e);return t.setMinutes(t.getMinutes()+t.getTimezoneOffset()),t.format("HH:mm:ss")},e}();(0,r.l)(_,"AudioPlaybackActor",null,[])},9407:function(e,t,n){"use strict";n.d(t,{q:function(){return r}});var r=(0,n(2185).y)("IFormattingSteward")}}]);
//# sourceMappingURL=https://onenotewebclientbuilds.blob.core.windows.net/official/16.0.12619.32725/OneNoteDS.box4.dll2.js.map