function wac_AFc(a,b){a.tG(b,Date.now())}wac_JS.prototype.I0=wac_5(-2024655713,function(){wac_7k()&&wac_CS(wac_KS(this),{PeopleWell:"PeopleWell"})});wac_MS.prototype.I0=wac_5(1241399318,function(){this.pK.I0()});wac_JX.prototype.I0=wac_5(316896117,function(){});wac_40b.prototype.I0=wac_5(-1223737966,function(){this.Mt.I0()});wac_Nu.prototype.s7e=wac_5(-1606213440,function(){return this.TWf.oj()});wac_Spb.prototype.s7e=wac_5(1521642731,function(){return this.QEf.oj()});
function wac_o1c(a,b,c){return a.fHe?a.fHe.REd(new Date(b),new Date(c)):-1}function wac_Guc(a,b){return b&&b in a.nAe?a.nAe[b]:null}function wac_p1c(a){wac_1Yc(a);return a.WWc}function wac_q1c(a,b){a.Qr=b}function wac_swb(a){return new wac_T_(new wac_wF(a.slideId),a.shapes,a.sn)}window.g_hermesPresenceJS=new Date;Type.registerNamespace("Common.App.CoauthTelemetry");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.b9e=wac_d.Qa.b9e||{};
function wac_r1c(a){this.zGf=Function.createDelegate(this,this.NNf);this.RYe=Function.createDelegate(this,this.C0e);this.Hef={};this.tff={};this.q4e=a}
wac_r1c.prototype={bWe:null,q4e:null,n$e:null,Y5e:wac_a(-1999828422),tb:function(){if(this.n$e)return this.n$e.oj();this.n$e=new (wac_Rb.$$(Object));var a=this;this.q4e.CW(function(){a.bWe=wac_Qb(a.q4e);wac_s1c(a.bWe,a.RYe);wac_t1c(a);a.n$e.Ze(null)});return this.n$e.oj()},C0e:function(){wac_t1c(this)},NNf:function(a,b){return a.dye>b.dye?1:a.dye<b.dye?-1:0}};
function wac_t1c(a){var b=a.bWe.J3e();b.sort(a.zGf);a.Hef={};for(var c=0;c<b.length&&b[c]&&b[c].dye;c++){var d=a,e=b[c].iS(),f=c;a.Hef[e]=f;e in d.tff&&(wac_W1a(d.tff[e],f),delete d.tff[e])}}
function wac_u1c(a,b,c,d,e,f,g,h,k){this.Xhf=Function.createDelegate(this,this.blf);this.otf=Function.createDelegate(this,this.zTf);this.ZSa=a;this.e7e=new (wac_Rb.$$(wac_d.qdf));this.Dc=c;this.Ief=b;this.Uea=d;this.tn=e;this.uff=f;this.q4e=g;this.kAf=h;this.gnf=this.fnf=!1;this.aaf=0;this.Bmf=1;this.iwe=k;this.k7e=wac_q(this.Dc,"PeoplesWellExtraButtonInfoIsEnabled")}
wac_u1c.prototype={ZSa:null,e7e:null,Ief:null,Dc:null,Uea:null,tn:null,uff:null,q4e:null,kAf:null,k7e:!1,bWe:null,sAf:null,oCf:null,Bmf:0,gnf:!1,fnf:!1,aaf:0,iwe:null,tb:function(){var a=this;wac_Db.WAA.call(null,this.q4e,this.Ief,this.uff).CW(function(){a.bWe=wac_Qb(a.q4e);a.sAf=wac_Qb(a.Ief);a.oCf=wac_Qb(a.uff);wac_Db.WAA.call(null,wac_Qb(a.Ief).aDe(),wac_Qb(a.uff).g7e.oj()).CW(function(){a.Bmf=wac_Qb(a.sAf.aDe());a.aaf=wac_Qb(a.oCf.g7e.oj());wac_s1c(a.bWe,a.otf);a.bWe.J3e().length&&a.C0e()})})},
zTf:function(){this.C0e()},C0e:function(){this.kAf(this.bWe.J3e())?(wac_v1c(this.bWe,this.otf),wac_w1c(this,this.fnf)):wac_W1a(this.e7e,1);this.fnf=!0},blf:function(){var a=this.tn.$jc("AppInitStatus_"+wac_d.Qa.Y8a.toString(4));wac_c(42259235,325,!!this.aaf,null);var b=this.aaf-a,c={};c.InteractiveTime=a;c.ReactRenderComplete=this.aaf;c.HadTabSwitch=this.iwe();c.IsModernGallery=this.k7e;wac_b(594883104,325,50,wac_Mgc(c));this.k7e?(wac_b(42062997,325,15,b.toString()),a=this.e7e,c=wac_Lg(this.Dc,"CoauthorGalleryTimeToRenderDurationMs",
1E4),c=b>c,this.iwe()?(wac_b(50455714,325,50,c.toString()),b=!1):(c&&(wac_b(42062998,325,15,b.toString()),wac_B().recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,null)),b=c),wac_W1a(a,b?3:2)):wac_b(594883103,325,15,b.toString())}};function wac_x1c(a,b){b?wac_Zg(a.Uea,4,a.Xhf,3):wac_W1a(a.e7e,1)}
function wac_w1c(a,b){a.gnf?a.e7e.oj().CW(function(){wac_b(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",wac_d.qdf.toString(wac_Qb(a.e7e.oj())))}):(a.gnf=!0,wac_x1c(a,!a.Bmf&&!b))}function wac_y1c(a,b){this.RYe=Function.createDelegate(this,this.C0e);this.Vnf=a;this.pCf=b}function wac_z1c(a){for(var b,c=null,d=a.length,e=0;e<d;++e)if(b=a[e])if(b=b.dmc||!b.wI?b.iS():b.wI.toUpperCase(),!c)c=b;else if(c!==b)return!0;return!1}
wac_y1c.prototype={xff:null,pCf:null,Vnf:null,tb:function(){var a=this;this.Vnf.CW(function(){a.xff=wac_Qb(a.Vnf);wac_s1c(a.xff,a.RYe)})},C0e:function(){wac_z1c(this.xff.J3e())&&(wac_v1c(this.xff,this.RYe),this.pCf.IsRealCoauthSession=!0)}};function wac_A1c(){}
wac_A1c.prototype={Ub:function(){return"Common.App.CoauthTelemetry"},gc:function(a){wac_m(wac_n(wac_o(a.fa(wac_y1c),wac_lwc)),function(){return new wac_y1c(wac_rP(wac__Ga,wac_l(a,wac__Ga)),wac_.Gn)});wac_m(wac_n(wac_o(a.fa(wac_u1c),wac_6Aa)),function(){return new wac_u1c(wac_z(),wac_rP(wac_4Aa,wac_l(a,wac_4Aa)),wac_.pa,window.Common.App.AppLifecycleManager.get_instance(),wac_Fd(),wac_rP(wac_$Ha,wac_l(a,wac_$Ha)),wac_rP(wac__Ga,wac_l(a,wac__Ga)),wac_z1c,function(){return wac_B1c()})});wac_m(wac_n(wac_o(a.fa(wac_C1c),
wac_nwc)),function(){return new wac_C1c(wac_rP(wac_4Aa,wac_l(a,wac_4Aa)),window.Common.App.AppLifecycleManager.get_instance(),a.H(wac_kwc),wac_Fd(),function(){return wac_B1c()},wac_.pa,null,wac_B())});wac_m(wac_n(wac_o(a.fa(wac_r1c),wac_kwc)),function(){return new wac_r1c(wac_rP(wac__Ga,wac_l(a,wac__Ga)))})},tb:function(){wac_.pa.Ok(function(){wac_j().H(wac_y1c).tb();wac_q(wac_.pa,"CoauthorGalleryTelemetryIsEnabled")&&wac_j().H(wac_6Aa).tb();wac_q(wac_.pa,"CashTelemetryIsEnabled")&&(wac_j().H(wac_nwc),
wac_j().H(wac_kwc))})},O:function(){}};function wac_B1c(){return wac_oda()&&wac_0Za(wac_Fd(),"UserActions")?0<wac_Fd().$jc("UserActions").VisiToggled:!1}function wac_C1c(a,b,c,d,e,f,g,h){this.uCf={};this.l7e=new (wac_f.$$(Number))(function(){return wac_Cg(f,"PresenceBootLatencyThreshold",1E4)});this.A6e=new (wac_f.$$(Number))(function(){return wac_Cg(f,"PresenceBootLatencyCutoffThreshold",6E4)});this.Uea=b;this.qCf=c;this.Cmf=a;this.tn=d;this.bCf=g;this.iwe=e;this.jH=h;this.tb()}
wac_C1c.prototype={Cmf:null,bCf:null,o$e:null,Uea:null,qCf:null,W9e:null,tn:null,QCf:0,RCf:0,l7e:null,A6e:null,iwe:null,jH:null,tb:function(){if(this.o$e)return this.o$e.oj();this.o$e=new (wac_Rb.$$(Object));this.iwe()&&wac_b(50951700,302,15,"TabSwitched Session");var a=this;this.Cmf.CW(function(){var b=wac_Qb(a.Cmf),c=b.aDe(),d=b.s7e();d.CW(function(){c.CW(function(){a.jH&&a.jH.addQosPillar(window.Common.QosPillarName.toString(6));var b=wac_Qb(c),f=wac_Qb(d);a.QCf=b;a.RCf=f?f:(new Date).getTime();
a.o$e.Ze(null)})})});return this.o$e.oj()},Y5e:wac_a(-300453624)};function wac_D1c(a,b,c,d,e,f,g,h,k){this._id=a;this.sof=b;this.SJ=c;this.lff=d;this.Off=e;this.l7e=f;this.A6e=g;this.rAf=h;this.iwe=k}wac_D1c.prototype={Ww:0,sof:null,l7e:null,A6e:null,ICf:!1,SJ:0,lff:null,Off:null,rAf:0,_id:null,iwe:null};window.Common.App.CoauthTelemetry.PL=wac_d.Qa.b9e.ETf=function(){};wac_d.Qa.b9e.ETf.prototype={id:null,et:0,st:0,mp:0,tp:0,d:0,ct:null,vc:!1};
wac_r1c.registerClass("Common.App.CoauthTelemetry.CoauthorPositionFinder",null,wac_kwc);wac_u1c.registerClass("Common.App.CoauthTelemetry.CoauthorGalleryTelemetry",null,wac_6Aa);wac_y1c.registerClass("Common.App.CoauthTelemetry.CoauthTelemetry",null,wac_lwc);wac_A1c.registerClass("Common.App.CoauthTelemetry.CoauthTelemetryPackage",null,wac_I,wac_i);wac_C1c.registerClass("Common.App.CoauthTelemetry.PresenceBootTelemetry",null,wac_nwc);wac_D1c.registerClass("Common.App.CoauthTelemetry.PresenceLatencyActivityLogger");
window.Common.App.CoauthTelemetry.PL.registerClass("Common.App.CoauthTelemetry.PL");wac_J(wac_C(),new wac_A1c,0,!1);Type.registerNamespace("RealtimePresenceUI");function wac_Nvb(){}wac_Nvb.registerInterface("RealtimePresenceUI.IUserTracker");
function wac_Ovb(a,b,c,d){this.PIf=Function.createDelegate(this,this.KRf);this.RYe=Function.createDelegate(this,this.C0e);this.g7e=new (wac_Rb.$$(Number));this.dispose=this.O;this.Ml=a;this.FWd=b;if(c){var e=this;c.CW(function(){e.bWe=wac_Qb(c);wac_s1c(e.bWe,e.RYe);wac_E1c(e)})}if(d){var f=this;d.CW(function(){f.d4e=wac_Qb(d);f.d4e.bXf(f.RYe);wac_E1c(f)})}this.m6d=new wac_Il(this.Ml.sg,"Anonymous user","#cccccc",new wac_Jl(7),null,null,null,null,!1,!1,!1,0,null,0);this.J6a=this.mkb=!0;this.Tef=this.Wnf=
!1;this.ZM=wac_nFc(this.Ml.sg,this.Ml.Uyb,a.Fkc)}function wac_Rvb(a,b){return a.lr.lr&1&&b.lr.lr&1||!(a.lr.lr&1||b.lr.lr&1)?a.Qr.localeCompare(b.Qr)-wac_uea:a.lr.lr&1?-1:1}
wac_Ovb.prototype={m6d:null,mkb:!1,Wnf:!1,Tef:!1,Ml:null,ZM:null,FWd:null,bWe:null,d4e:null,J6a:!1,xJb:function(){return 0<wac_O9(this.ZM)},C0e:function(){if(!this.Tef){var a=this;window.setTimeout(function(){wac_E1c(a);a.Tef=!1},3E3);this.Tef=!0}},KRf:function(a,b,c,d,e){wac_W1a(this.g7e,e.RenderTime);return 32},O:function(){this.bWe&&(wac_v1c(this.bWe,this.RYe),this.bWe=null);this.d4e&&(this.d4e.aYf(this.RYe),this.d4e=null)}};
function wac_E1c(a){a.Wnf||(wac_W1a(a.g7e,(new Date).getTime()),wac_b(42567504,325,50,"We are trying to render the coauthor gallery before we are ready to record the render time"));var b;wac_q(wac_.pa,wac_2(1056))?a.irf?b=a.irf.J3e(!0):(wac_Y(50440411,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - PeopleInfoProvider is null."),b=wac_F1c(a),0<b.length&&wac_Y(50942294,814,50,"PowerPointPeoplesWell::GetAllUsersInfo - non-empy editor count {0}.",b.length)):b=wac_F1c(a);b=b||[];for(var c=b.length,d=
0;d<c;++d){var e=b[d];if(!e.iS()){var f=wac_5k().toString();e.sg=f}e.tpb()||wac_q1c(e,"Anonymous user");e.lr||(e.lr=new wac_Jl(0));e.ltc()||e.QTc("#cccccc");e.dye||(e.dye=0)}c=a.ZM;c.fR=new (wac_rb.$$(Array));d=b.length;for(e=0;e<d;++e)if(f=b[e],f.iS()===c.eFb){c.VFb=f;break}d=b.length;for(e=0;e<d;++e)f=b[e],f.iS()!==c.eFb&&c.suc(f);a.J6a&&1<=wac_O9(a.ZM)&&(wac_b(6092429,325,50,"PeoplesWell: User is no longer forever alone."),a.J6a=!1);a.mkb=!0;wac_Uvb(a)}
function wac_Svb(a){wac_q(wac_.pa,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_q(wac_.pa,"CoauthorGalleryTelemetryIsEnabled")&&wac_z().ja(691867605,2147483648,a.PIf);a.Ia.ja(a.Ml.Nf.cxb,1,a.Fdd);a.Ia.jf(a.Ml.Nf.gxb,1,a.Eod,96);a.Ia.jf(a.Ml.Nf.exb,1,a.d7c,96);a.Ia.jf(a.Ml.Nf.dxb,1,a.c7c,96);a.Ia.jf(a.Ml.Nf.fxb,1,a.Cmd,96);a.Ia.ja(a.Ml.Nf.hxb,1,a.gtd);a.Ia.jf(a.Ml.Nf.hjc,1,a.qmd,96);a.Wnf=!0;wac_E1c(a)}
function wac_Yvb(){return wac_.pa&&wac_q(wac_.pa,"ColorPresenceHashIsEnabled")?"Initials":"Menu32"}function wac_mmc(){var a;return a=new wac_2l,a.Id="BasicChat",a.Command="2288458806",a.LabelText=CommonUIStrings.l_StartGroupChat,a.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word",a}
function wac_Zvb(a,b){if(!(b.lr.lr&1))return b.dy()?CommonUIStrings.l_PeoplesWellUserStatusIsViewingOffline:CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;var c=b.dy(),d=a.Ml.Uyb(b.iS());b=a.Ml.Tyb(b.iS());if(!d)return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;switch(d.Sd){case 1:if(b)if(c)a=CommonUIStrings.l_PeoplesWellUserStatusIsViewingOnline;else{var d=null,c=" ",e,f;(f=wac__vb(a,b,e={val:d}),d=e.val,f)&&d&&d.mg&&(a=wac_DI(a.Cc,d.mg))&&(c=String.format(ResourceStrings.l_PeoplesWellUserStatusIsEditingSlide,
a.En+1));a=c||CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}else a=CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown;return a;case 2:return CommonUIStrings.l_PeoplesWellUserStatusIsInactive;default:return CommonUIStrings.l_PeoplesWellUserStatusLocationUnknown}}
function wac_oFc(a,b,c,d){if(!c)return d&&wac_b(4482393,325,50,"User does not have any presence data"),!1;var e=null,f,g;return(g=wac__vb(a,c,f={val:e}),e=f.val,g)&&e&&e.mg?(a=a.Ml.Uyb(b))&&2===a.Sd?!1:!0:(d&&wac_b(4482394,325,50,"User has presence data but app can't use it"),!1)}function wac_0vb(a,b,c,d,e){this.Nf=a;this.sg=b;this.Fkc=e;this.Tyb=c||function(){return null};this.Uyb=d||function(){return null}}function wac_1vb(a,b,c,d){return new wac_0vb(a,b,c,d,!0)}
wac_0vb.prototype={Nf:null,ia:function(){return this.Nf.Ab},sg:null,Tyb:null,Uyb:null,Fkc:!1};function wac_2vb(a){this.fR=new (wac_rb.$$(Array));this.eFb=a}wac_2vb.prototype={eFb:null,VFb:null};function wac_3vb(a,b,c){b=b.toUpperCase();var d,e,f;(f=a.fR.qg(b,e={val:d}),d=e.val,f)||(d=[],a.fR.vf(b,d));Array.add(d,c)}function wac_O9(a){return a.fR.Ma()}function wac_4vb(a){for(var b=[],c=a.fR.uB().$$ge();c.$$mn();){var d=c.$$cu(),d=a.oDc(d);Array.add(b,d)}return b}
function wac_nFc(a,b,c){return c?new wac_Pvb(a,b):new wac_Qvb(a)}function wac_Pvb(a,b){wac_Pvb.initializeBase(this,[a]);this.pKc=b}wac_Pvb.prototype={pKc:null,suc:function(a){a.dmc||!a.wI?wac_3vb(this,a.iS(),a):this.VFb&&wac_$a().Ka(this.VFb.wI,a.wI)||wac_3vb(this,a.wI,a)},oDc:function(a){for(var b=new Date(0),c=0<a.length?a[0]:null,d=a.length,e=0;e<d;++e){var f=a[e],g=this.pKc(f.sg);g&&b.getTime()<g.fKb.getTime()&&(b=g.fKb,c=f)}return c}};function wac_Qvb(a){wac_Qvb.initializeBase(this,[a])}
wac_Qvb.prototype={suc:function(a){wac_3vb(this,a.iS(),a)},oDc:function(a){return a[0]}};wac_Ovb.registerClass("RealtimePresenceUI.APeoplesWell",null,wac_$Ha,Sys.IDisposable);wac_0vb.registerClass("RealtimePresenceUI.PeoplesWellSettings");wac_2vb.registerClass("RealtimePresenceUI.UserTracker",null,wac_Nvb);(function(){}).registerClass("RealtimePresenceUI.UserTrackerFactory");wac_Pvb.registerClass("RealtimePresenceUI.UniqueUserTracker",wac_2vb);
wac_Qvb.registerClass("RealtimePresenceUI.UserInstanceTracker",wac_2vb);Type.registerNamespace("RealtimePresenceUI");
function wac_L_(a,b,c,d){this.qmd=Function.createDelegate(this,this.GWd);this.gtd=Function.createDelegate(this,this.h5d);this.Cmd=Function.createDelegate(this,this.VWd);this.c7c=Function.createDelegate(this,this.Pzd);this.d7c=Function.createDelegate(this,this.Qzd);this.Eod=Function.createDelegate(this,this.iZd);this.Fdd=Function.createDelegate(this,this.xKd);this.htd=Function.createDelegate(this,this.i5d);this.Dmd=Function.createDelegate(this,this.WWd);this.Fod=Function.createDelegate(this,this.jZd);
wac_L_.initializeBase(this,[a,c,d,null]);this.g1=function(){return!0};this.Ia=b}
wac_L_.prototype={g1:null,Ia:null,jZd:function(a){if(this.mkb){this.J6a||(a[wac_IS.Visible]=!0);var b,c,d,e,f,g=b={val:b},h=c={val:c},k=d={val:d},l=e={val:e},m=f={val:f},n,p,q,r;2<=wac_O9(this.ZM)?r=[String.format(CommonUIStrings.l_PeoplesWellStateNumberOfOtherPeopleEditingHere,wac_O9(this.ZM))]:1===wac_O9(this.ZM)?(n=wac_4vb(this.ZM)[0],r=(p=this.Ml.Uyb(n.iS()))&&2===p.Sd?[CommonUIStrings.l_PeoplesWellStateUserIsInactive,n.tpb()]:[n.dy()?CommonUIStrings.l_PeoplesWellStateUserIsAlsoViewing:CommonUIStrings.l_PeoplesWellStateUserIsAlsoEditing,
n.tpb()]):r=[CommonUIStrings.l_PeoplesWellStateYouAreAllByYourself];wac_O9(this.ZM)?1===wac_O9(this.ZM)?(n=!0,p=this.Ml.Nf.f8a.iKa,q=wac_4vb(this.ZM)[0].ltc()):(n=!0,p=this.Ml.Nf.Apc.iKa,q=""):(n=!1,q=p="");g.val=r[0];h.val=r.slice(1);k.val=n;l.val=p;m.val=q;b=b.val;c=c.val;d=d.val;e=e.val;f=f.val;a[wac_IS.LabelText]=b;c&&c.length&&(a[wac_IS.LabelTextUserGeneratedPlaceholderReplacements]=c);a.ImageIsVisible=d;a[wac_IS.Image16by16Class]=e;a.ImageBackColor=f;this.mkb=!1}return!0},WWd:function(a){if(0>=
wac_O9(this.ZM))a=!1;else{var b=wac_4vb(this.ZM),c=[];Array.addRange(c,b);c.sort(wac_Rvb);for(var b=[],d=c.length,e=0;e<d;++e){var f=c[e],g=String.format("buttonPeoplesWellUser-{0}",f.iS()),h=f.iS(),k=wac_Zvb(this,f),l=f.tpb(),m=f.ltc(),n;n=new wac_w9a;n.Id=g;n.Command=this.Ml.Nf.hxb.toString();n.LabelText="{0}";n.Image32by32=this.Ml.Nf.RCb.Wxb;n.Image32by32Class=this.Ml.Nf.RCb.iKa;n.MenuItemId=h;n.CommandValueId=h;n.Alt=l;n.DisplayMode=wac_Yvb();n.LabelCss="display:block; max-width:160px; padding:0px; white-space:normal; word-wrap:break-word";
n.Description=k;n.ImageBackColor=m;n.IsAnonymous=f.dmc;g=n;if(l=[l],l.length){h=new Sys.StringBuilder("STRARRY@");k=l.length;for(m=0;m<k;++m){var p=l[m];h.append(p?p.length:0);h.append(",");h.append(p);h.append(",")}l=h.toString().slice(0,-1)}else l=null;n=(g.LabelTextUserGeneratedPlaceholderReplacements=l,n.Upn=f.wI,n);wac_q(wac_.pa,"PeoplesWellExtraButtonInfoIsEnabled")&&this.FWd&&(g=this.FWd.vdf(f.wI,"O365",wac_.eo,0),l=this.Ml.Uyb(f.iS()),l=!l||l&&1===l.Sd?!0:!1,n.ImageUrl=g,n.ActiveStatus=l,
n.JoinTimeInMS=f.dye,l=wac_oFc(this,f.iS(),this.Ml.Tyb(f.iS()),!1),f=this.d4e?this.d4e.xyf(f.iS()):!!(f.lr.lr&4),n.CanJump=l,n.ChatCapable=f,""===g&&wac_b(40969413,302,50,"ImageURL collection failed"));Array.add(b,n)}var q,c=(q=new wac_if,q.Id="menuCoauthors",q.MaxWidth="220px",q.MenuSectionList=[],q),r;q=(r=new wac_jf,r.Id="msCoauthors",r.ControlsId="msCoauthorsControls",r.DisplayMode=wac_Yvb(),r.ControlList=b,r);wac_q(wac_.pa,"WordEditorDisplayPeoplesWellLabelIsEnabled")&&this.FWd&&(q.Title=CommonUIStrings.l_PeoplesWellFlyoutLabel,
q.TitleId="menuCoauthorsTitle",q.Theme="Light");Array.add(c.MenuSectionList,q);if(wac_q(wac_.pa,"DocChatIsEnabled")&&wac_q(wac_.pa,"PeoplesWellExtraButtonInfoIsEnabled")&&wac_r()&&wac_r().Hd().Bg()){r=[];Array.add(r,wac_mmc());var t;r=(t=new wac_jf,t.Id="msGroupChat",t.ControlsId="msGroupChatControl",t.ControlList=r,t);Array.add(c.MenuSectionList,r)}wac_r()&&wac_r().Hd().Bg()?a.MenuItems=c:a.PopulationXML=wac_hm(c);a=!0}return a},i5d:function(a){wac_b(4482395,325,50,"PeoplesWell: Received user button click");
var b=a.MenuItemId;if(b){var c=this.Ml.Tyb(b);if(wac_oFc(this,b,c,!0)){a=null;var d,e;(e=wac__vb(this,c,d={val:a}),a=d.val,e)&&a&&a.mg&&(wac_Y(8958488,814,50,"PowerPointPeoplesWell : JumpToUserLocation; clientId: {0}; slideId: {1}; MyClientId: {2};",b,a.mg,this.hl.Zv),(d=wac_DI(this.Cc,a.mg))?this.Kf.vte(d.En):wac_Y(19191178,814,15,"PowerPointPeoplesWell : JumpToUserLocation; failed to find slide by id: {0}; ",a.mg));a=!0}else a=!1}else a=!1;return a},cE:function(a,b,c,d,e,f,g){a=!1;switch(c){case 1:a=
f(e);break;case 2:a=g(e)}return a?32:8},xKd:function(a,b,c,d,e){var f=this;return this.cE(a,b,c,d,e,function(){return f.xJb()},this.g1)},iZd:function(a,b,c,d,e){return this.cE(a,b,c,d,e,this.Fod,this.g1)},VWd:function(a,b,c,d,e){return this.cE(a,b,c,d,e,this.g1,this.Dmd)},Qzd:function(a,b,c,d,e){return this.cE(a,b,c,d,e,this.g1,this.g1)},Pzd:function(a,b,c,d,e){return this.cE(a,b,c,d,e,this.g1,this.g1)},h5d:function(a,b,c,d,e){return this.cE(a,b,c,d,e,this.g1,this.htd)},GWd:function(a,b,c,d,e){var f=
this;return this.cE(a,b,c,d,e,this.g1,function(){wac_E1c(f);return!0})},O:function(){wac_Ovb.prototype.O.call(this)}};wac_L_.registerClass("RealtimePresenceUI.ABox4PeoplesWell",wac_Ovb);Type.registerNamespace("PowerPointWebEditor");wac_Z=window.PowerPointWebEditor||{};function wac_G1c(a){var b=this;a.uc(function(a){b.jbf=a})}wac_G1c.prototype={jbf:null,pFd:function(a){return this.jbf?this.jbf.pFd(a):null},rFd:function(a){return this.jbf?this.jbf.rFd(a):null}};Type.registerNamespace("PowerpointPresence");
wac_2K=window.PowerpointPresence||{};function wac_H1c(a){this.hl=a}wac_H1c.prototype={hl:null,aDe:function(){return this.hl.aDe()},s7e:function(){return this.hl.s7e()}};function wac_I1c(a,b,c,d,e){this.Egd=Function.createDelegate(this,this.nPd);this.Irf=new wac_Re;this.hl=a;this.y1c=c;this.gy=d;wac_jqb(this.gy,this.Egd);this.ODf=wac_q(wac_.pa,"PeoplesWellExtraButtonInfoIsEnabled");this.ibf=e;if(b){var f=this;b.uc(function(a){f.qL=a})}}
wac_I1c.prototype={gy:null,hl:null,y1c:null,ibf:null,qL:null,ODf:!1,J3e:function(){return this.J3e(!1)},J3e:function(a){var b=[],c;(c=wac_Tpb(this.hl,this.hl.Zv,{val:void 0}),c)||wac_Y(50440398,814,50,"PeopleInfoProvider::GetAllUsers - current editor({0}) missing in editortable",this.hl.Zv);var d=null;this.qL&&(d=this.qL.wHb());var e=wac_p1c(this.ibf);c=!1;for(var f=this.hl.u2(),g=f.length,h=0;h<g;++h){var k=f[h],l;if(l=a)l=k.EmailAddress,l=!!e&&!!l&&e.toLowerCase()===l.toLowerCase();l?c=!0:Array.add(b,
wac_J1c(this,k,d))}d={};d.fExcludeCurrent=a;d.fCurrentExcluded=c;d.CurrentID=this.hl.Zv;d.EditorCount=this.hl.u2().length;d.IsRtcNull=!this.qL;d.UserCount=b.length;wac_Y(50642948,814,50,"PeopleInfoProvider::GetAllUsers:{0}",wac_ai(d));return b},nPd:function(){wac_Y(50440406,814,50,"PeopleInfoProvider::OnEditorTableUpdate");this.Irf.wa("UsersUpdatedEvent",this,null)}};
function wac_J1c(a,b,c){var d=a.y1c.YEc(new wac__Hb(b.EmailAddress,null,b.Name,null,!1,null),b.ColorIndex,b.ID,1),e=new wac_Jl(0);wac_PRc(e,0);var f=0,g=!1;if(c&&b.ID in c){wac_PRc(e,1);if(a.ODf){var h=c[b.ID];h&&h.capabilities&4&&wac_PRc(e,4);g=!0;h&&(f=h.capabilities)}delete c[b.ID]}wac_Y(50440404,814,50,"PeopleInfoProvider::GetAllUsers; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",
b.ID,d,!!(e.lr&1),!!(e.lr&4),a.hl.Zv,!b.EmailAddress,f,g);return new wac_Il(b.ID,b.Name,d,e,null,b.EmailAddress,null,null,!1,!1,!1,b.JoinCoauthTime,null,0)}function wac_v1c(a,b){a.Irf.sb("UsersUpdatedEvent",b)}function wac_s1c(a,b){a.Irf.xa("UsersUpdatedEvent",b)}
function wac_rwb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w){this.Obd=Function.createDelegate(this,this.EHd);this.Umd=Function.createDelegate(this,this.pXd);wac_rwb.initializeBase(this,[a,b,v,w?wac_sP(wac__Ga,w):null]);if(!e)throw Error.argumentNull("coauthStateGetter");if(!f)throw Error.argumentNull("appFrame");if(!g)throw Error.argumentNull("taskManager");this.hl=e;this.Ob=f;this.pb=g;if(d){var x=this;d.uc(function(a){x.qL=a})}if(c){var z=this;c.uc(function(a){a.gXf(z.Umd)})}this.Cc=h;this.Kf=k;this.he=
l;this.ne=p;this.Eqe=q;this.O_a=m;this.y1c=n;this.$sd=r;this.Tob=t;this.ibf=u;this.irf=w;var y=this;this.g7e.oj().CW(function(){var a=wac_Qb(y.g7e.oj()),b=y.Tob;try{b.OMd||(b.OMd=a,b.tG(17,b.OMd),b.tG(13,wac_o1c(b,wac_aZc(b),b.OMd)),wac_W1a(b.eFf,!0))}catch(c){wac_b(594879176,814,10,c.toString())}})}function wac_K1c(a,b){return!!a&&!!b&&a.toLowerCase()===b.toLowerCase()}
wac_rwb.prototype={hl:null,qL:null,Ob:null,pb:null,t6b:!1,Cc:null,Kf:null,he:null,ne:!1,Eqe:!1,O_a:null,y1c:null,$sd:null,Tob:null,ibf:null,irf:null,pXd:function(){this.Ob.ys().hq?this.t6b||(this.pb.Hb(new wac_D(2,1,0,this.Obd,90,"70",!1)),this.t6b=!0):this.Ia.yw(2052777571,2,null)},EHd:function(){this.t6b=!1;this.Ia.yw(2052777571,2,null)},O:function(){wac_L_.prototype.O.call(this)}};
function wac_Uvb(a){wac_H0a(a.he,new wac_YL(a.Ml.ia(),!0));var b=1<wac_O9(a.ZM)||1===wac_O9(a.ZM)&&wac_4vb(a.ZM)[0].iS()!==a.Ml.sg;a.ne&&a.O_a.uc(function(c){if(b&&a.Tob){var d=a.Tob;wac_AFc(d,15);0<wac_9Yc(d)&&wac_AFc(d,16)}c.I0()});b&&a.Tob.tG(14,Date.now())}
function wac_F1c(a){var b=[],c=wac_p1c(a.ibf),d;(d=wac_Tpb(a.hl,a.hl.Zv,{val:void 0}),d)||wac_Y(38589792,814,50,"PowerPointPeoplesWell : GetAllUsersInfo, there is no current editorId:{0} in the editortable",a.hl.Zv);var e=null;a.qL&&(e=a.qL.wHb());for(var f=wac_q(wac_.pa,"PeoplesWellExtraButtonInfoIsEnabled"),g=a.hl.u2(),h=g.length,k=0;k<h;++k){var l=g[k];d=a.y1c.YEc(new wac__Hb(l.EmailAddress,null,l.Name,null,!1,null),l.ColorIndex,l.ID,1);var m=new wac_Jl(0);wac_PRc(m,0);var n=0,p=!1;if(e&&l.ID in
e){wac_PRc(m,1);if(f){var q=e[l.ID];q&&(n=q.capabilities);p=!0;q&&q.capabilities&4&&wac_PRc(m,4)}delete e[l.ID]}wac_K1c(c,l.EmailAddress)||(Array.add(b,new wac_Il(l.ID,l.Name,d,m,null,l.EmailAddress,null,null,!1,!1,!1,0,null,0)),wac_Y(8958496,814,50,"PowePointPeoplesWell : GetAllUsersInfo; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcCapabilities:{6}; fIssuserinrtc{7};",l.ID,d,!!(m.lr&
1),!!(m.lr&4),a.hl.Zv,!l.EmailAddress,n,p))}if(!f&&a.Eqe&&e)for(var r in e)q=e[r],!wac_K1c(c,q.email)&&q&&q.userName&&(m=new wac_Jl(0),wac_PRc(m,1),q.capabilities&4&&wac_PRc(m,4),f=wac_Guc(a.$sd,q.email)||q.email,d=a.y1c.YEc(new wac__Hb(f,null,q.userName,null,!1,null),null,q.clientId,1),Array.add(b,new wac_Il(q.clientId,q.userName,d,m,null,f,null,null,!1,!1,!1,0,null,0)),wac_Y(38897818,814,50,"PowePointPeoplesWell : GetAllUsersInfo; Get info from RTC when user is not in editor table and username is provided; ClientId: {0}; Color: {1}; PresenceCapabilityHasFlagRealTimeChannel: {2}; PresenceCapabilityHasFlagSupportsChat: {3}; MyClientId: {4}; IsEmailAddressEmpty: {5}; rtcPresenceCapabilities: {6};",
q.clientId,d,!!(m.lr&1),!!(m.lr&4),a.qL.iS(),!q.email,q.capabilities));return b}function wac__vb(a,b,c){c.val=null;if(!b)throw wac_Y(8958490,814,10,"PowerPointPeoplesWell : TryGetPresenceData; Presence was null; MyClientId: {0};",a.hl.Zv),Error.argumentNull("presence");if(!b)return!1;c.val=wac_swb(b.data);return c.val?!0:!1}Type.registerNamespace("PowerPointWebEditor.PeoplesWell");wac_Z.KTf=wac_Z.KTf||{};function wac_L1c(){this.xEe=Function.createDelegate(this,this.rMe)}
wac_L1c.prototype={J:null,ZV:null,gy:null,Q8d:null,Ub:function(){return"PowerPointWebEditor.PeoplesWell"},gc:function(a){wac_M1c=Date.now();this.J=a;this.Q8d=this.J.H(wac_hF);this.ZV=this.Q8d.d5c(6,this.Ub());var b=this;wac_m(wac_n(this.J.fa(wac_MYc)),function(){return new wac_G1c(wac_l(b.J,wac_NYc))});if(wac_q(wac_.pa,wac_2(1056))){var c=this;wac_m(wac_n(this.J.fa(wac_4Aa)),function(){return new wac_H1c(c.J.H(wac_7D))});var d=this;wac_m(wac_n(wac_o(this.J.fa(wac_I1c),wac__Ga)),function(){return new wac_I1c(d.J.H(wac_7D),
wac_l(d.J,wac_yc),d.J.H(wac_omc),d.J.H(wac_MY),d.J.H(wac_VYc))})}wac_Y(50943688,814,50,"PPTWebEditorPeoplesWellPackage:Configure")},tb:function(){wac_q(wac_.pa,wac_2(1056))&&(this.J.H(wac_4Aa),this.J.H(wac__Ga));wac_.Q9a.dO()?(this.gy=this.J.H(wac_MY),this.gy.la.xa("CSC",this.xEe)):wac_Swb(this)},rMe:function(){try{wac_.Q9a.dO()||(wac_Swb(this),this.gy.la.sb("CSC",this.xEe))}catch(a){wac_Y(8958610,814,10,"PresencePackage::Init; Loading presence and peoples well failed: {0}",a)}},O:function(){}};
function wac_N1c(a,b,c,d,e,f,g){var h=a.J.H(wac_Q9);h.tG(10,wac_M1c);h.tG(9,wac_O1c);h.tG(11,(new Date).getTime());h=Date.now();b=wac_1vb(new wac_xla("PeoplesWellControl",929022654,3798167515,1285265560,250882013,3236517055,4033456482,2052777571,wac_5h,"per_SingleCollabUserGlyph_16x16x32",wac_5h,"per_SingleCollabUserGlyph_32x32x32",wac_5h,"per_MoreUsersGlyph_16x16x32",null,null),g,b.W$c||(b.W$c=Function.createDelegate(b,b.pFd)),b.Y$c||(b.Y$c=Function.createDelegate(b,b.rFd)));g=null;var k=wac_q(wac_.pa,
wac_2(1056));k&&((g=a.J.H(wac_I1c))||wac_Y(50642959,814,10,"InitializePeoplesWellInternal; null PeopleInfoProvider"));wac_Y(50943691,814,50,"InitializePeoplesWellInternal; creating peopleswell");var l=new wac_rwb(b,c,wac_l(a.J,wac_SY),wac_l(a.J,wac_yc),a.J.H(wac_7D),d,e,a.J.H(wac_Mt),a.J.H(wac_hK),a.J.H(wac_Qt),wac_l(a.J,wac_mr),a.J.H(wac_omc),f.ao,f.sne,a.J.H(wac_Huc),a.J.H(wac_Q9),a.J.H(wac_42),a.J.H(wac_VYc),g);wac_Svb(l);k&&(wac_m(wac_n(wac_o(a.J.fa(wac_rwb),wac_$Ha)),function(){return l}),a.J.H(wac_$Ha));
f.ao&&wac_l(a.J,wac_mr).uc(function(a){a.I0()});wac_Y(8958615,814,50,"PresencePackage::InitializePeoplesWell; People's Well loaded and initialized. Time cost: {0}",Date.now()-h);wac_AFc(a.J.H(wac_Q9),12)}function wac_Swb(a){var b=a.ZV.saa("peoplewell");wac_N1c(a,a.J.H(wac_MYc),a.J.H(wac_Oc),a.J.H(wac_xM),a.J.H(wac_dd),a.J.H(wac_R),a.J.H(wac_X_).sg);a.ZV.zaa(b)}wac_G1c.registerClass("PowerPointWebEditor.PresenceUserInfoGetterProxy",null,wac_MYc);
wac_H1c.registerClass("PowerpointPresence.CoauthoringTelemetryInfoProvider",null,wac_4Aa);wac_I1c.registerClass("PowerpointPresence.PeopleInfoProvider",null,wac__Ga);wac_rwb.registerClass("PowerpointPresence.PowerPointPeoplesWell",wac_L_);wac_L1c.registerClass("PowerPointWebEditor.PeoplesWell.PPTWebEditorPeoplesWellPackage",null,wac_I,wac_i);var wac_O1c=0,wac_M1c=0,wac_O1c=Date.now();
if(wac_.pa&&wac_q(wac_.pa,"IsSyncConfigPresenceEnabled")){var wac_P1c=new wac_L1c;wac_P1c.gc(wac_j());wac_P1c.tb()}else wac_J(wac_C(),new wac_L1c,0,!1);
