!function(e,t){for(var n in t)e[n]=t[n]}(window,function(){var __webpack_modules__=[function(e,t,n){"use strict";n.d(t,{g:function(){return r}});var i=n(208),r=function(){return function(e,t){this.type=null,this.label=null,this.onExecute=null,this.label=e,this.type="AppButtonProps",this.onExecute=t}}();(0,i.l)(r,"AppButtonProps",null,[])},,function(e,t,n){"use strict";n.d(t,{x:function(){return o}});var i=n(254),r=n(208),o=function(){function e(){}return e.setExecuteState=function(t){e._notifyStateElement||(e._notifyStateElement=document.createElement("div"),e._notifyStateElement.id="WacExecuteState",e._notifyStateElement.style.display="none",document.body.appendChild(e._notifyStateElement)),e._notifyStateElement.innerText=t},e.verifyExecuteState=function(){return i.AFrameworkApplication.get_theTaskManager().get_isYielding()?(e.setExecuteState("Blocked"),!1):(e.setExecuteState("Allowed"),!0)},e.ignoreExecuteState=function(){e.setExecuteState("Ignore")},e.getExecuteState=function(){i.AFrameworkApplication.get_theTaskManager().get_isYielding()?e.setExecuteState("InProgress"):e.setExecuteState("Complete")},e.calcActionId=function(e){for(var t=5381,n=t,i=e.length,r=0;r<i&&(t=4294967295&((t<<5)+t^e.charCodeAt(r)),r!==i-1);r+=2)n=4294967295&((n<<5)+n^e.charCodeAt(r+1));var o=t+35685*n+(23896*n<<16)&4294967295;return o<0&&(o+=4294967296),o},e._notifyStateElement=null,e}();(0,r.l)(o,"ObjectModelUtils",null,[])},function(e,t,n){"use strict";var i=n(508),r=n(208),o=(0,r.y)("IScalableViewerChromeItemContainer"),a=n(854),s=n(10);n.d(t,{m:function(){return l}});var l=function(e){function t(){var t=e.call(this)||this;return t._elementToTruncate=null,t}return(0,i.t)(t,e),t.prototype.hide=function(){this.get_elmContainer()&&(this._isVisible=!1,this.get_elmContainer().style.display="none")},t.prototype.undoScaling=function(){this._elementToTruncate&&(this._elementToTruncate.style.width="auto",this._elementToTruncate.style.maxWidth="none"),this.get_elmContainer()&&(this._isVisible=!0,this.get_elmContainer().style.display="inline-block")},t.prototype.truncateWidth=function(e){this._elementToTruncate&&(this._elementToTruncate.style.maxWidth=e+"px")},t}(s.x);(0,r.l)(l,"ScalableViewerChromeItemContainer",s.x,[o,a.m])},,function(e,t,n){"use strict";n.d(t,{w:function(){return i}});var i=(0,n(208).y)("IZoomManager")},,function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var i=(0,n(208).y)("ISendUsYourFileController")},,function(e,t){"use strict";var n={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,r=i&&!n.call({1:2},1);t.f=r?function(e){var t=i(this,e);return!!t&&t.enumerable}:n},function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var i=n(854),r=n(154),o=n(208),a=function(){function e(){this.elmContainer=null,this._isVisible=!0}return e.prototype.get_elmContainer=function(){return this.elmContainer},e.prototype.set_elmContainer=function(e){return this.elmContainer=e,e},e.prototype.get_containerBounds=function(){return r.g.getElementBounds(this.get_elmContainer())},e.prototype.get_isVisible=function(){return this._isVisible},e.prototype.dispose=function(){},e}();(0,o.l)(a,"ViewerChromeItemContainer",null,[i.m])},,function(e,t,n){var i=n(57),r=n(557),o=n(287),a=n(985),s=Object.defineProperty;t.f=i?s:function(e,t,n){if(o(e),t=a(t,!0),o(n),r)try{return s(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported");return"value"in n&&(e[t]=n.value),e}},,function(e,t,n){var i=n(786)("iterator"),r=!1;try{var o=0,a={next:function(){return{done:!!o++}},return:function(){r=!0}};a[i]=function(){return this},Array.from(a,(function(){throw 2}))}catch(e){}e.exports=function(e,t){if(!t&&!r)return!1;var n=!1;try{var o={};o[i]=function(){return{next:function(){return{done:n=!0}}}},e(o)}catch(e){}return n}},function(e,t,n){"use strict";n.d(t,{v:function(){return i}});var i=(0,n(208).y)("IActionManagerExtended")},,function(e,t,n){"use strict";var i=n(208),r=n(543),o=n(592),a=(0,i.y)("IMessageEventHandler"),s=n(978),l=n(254),u=n(574),c=n(478),p=function(){return function(e,t,n,i){void 0===i&&(i=null),this.origin=null,this.data=null,this.source=null,this.innerEvent=null,this.origin=e,this.data=t,this.source=n,this.innerEvent=i}}();(0,i.l)(p,"MessageEventArgs",null,[]),n.d(t,{i:function(){return d}});var d=function(){function e(e,t){this._windowEventManager=null,this._taskManager=null,this._messageHandler=null,this._windowEventHandler=null,this._windowEventManager=e,this._taskManager=t,this._messageHandler=null}return e.prototype.get_theWindowEventManager=function(){return this._windowEventManager.get_value()},e.prototype.get_taskManager=function(){return this._taskManager.get_value()},e.prototype.attachHandler=function(e,t){this._messageHandler=e,this._windowEventHandler=i.i(this,this.postMessageEventHandler,"postMessageEventHandler"),this.get_theWindowEventManager().addHandler(u.d.message,this._windowEventHandler,t)},e.prototype.detachHandler=function(e){this._messageHandler=null,this.get_theWindowEventManager().removeHandler(u.d.message,this._windowEventHandler)},e.prototype.invokeCallback=function(e,t){var n=new c.c(0,1,1,(function(n){e(t)}),7);this.get_taskManager().addTask(n)},e.prototype.invokeEventCallback=function(e,t){var n=new c.c(0,1,1,(function(n){e(t)}),7);this.get_taskManager().addTask(n)},e.prototype.postMessageEventHandler=function(e){return!!this._messageHandler&&this._messageHandler(new p(e.origin,e.data,e.source,e.innerEvent))},e.get_instance=function(){return e.getAnInstanceWithResolvedDependecies()},e.getAnInstanceWithResolvedDependecies=function(){return new e(new s.q(r.k,(function(){return l.AFrameworkApplication.theWindowEventManager})),new s.q(o.h,(function(){return l.AFrameworkApplication.get_theTaskManager()})))},e}();(0,i.l)(d,"MessageEventHandler",null,[a])},function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("ISignOutResponse"),o=n(255),a=n(254),s=n(344),l=n(684),u=n(586);n.d(t,{t:function(){return c}});var c=function(){function e(){this._hadCookie=!1,this._eventSource=new u.f,e._instance=this,this._hadCookie=this.hasCookie()}return e.prototype.add_authenticationLost=function(e){this._eventSource.addHandler("L",e)},e.prototype.remove_authenticationLost=function(e){this._eventSource.removeHandler("L",e)},e.prototype.add_authenticationRestored=function(e){this._eventSource.addHandler("R",e)},e.prototype.remove_authenticationRestored=function(e){this._eventSource.removeHandler("R",e)},e.prototype.get_hasSubscribers=function(){return this._eventSource.get_hasSubscribers()},e.prototype.get_isAuthenticated=function(){return this.hasCookie()},e.prototype.hasCookie=function(){return!!s.g("PPLState")},e.prototype.authenticationCheck=function(){var e,t=this.hasCookie();t!==this._hadCookie&&(this._hadCookie?(e="L",o.ULS.sendTraceTag(5822149,200,50,"Authentication: Lost")):(e="R",o.ULS.sendTraceTag(5822150,200,50,"Authentication: Restored")),this._eventSource.raiseEvent(e,Sys.EventArgs.Empty,this),this._hadCookie=t)},e.get_instance=function(){return e._instance||(e._instance=new e)},e.performSignIn=function(){var e=new l.QueryStringBuilder("Signin.aspx");e.addParam("prompt","1"),a.AFrameworkApplication.addCommonUrlParameters(e),window.open(e.toString(),"LoginWindow")},e._instance=null,e}();(0,i.l)(c,"SignOutResponse",null,[r])},,function(e,t,n){var i=n(531),r=n(541),o=i.WeakMap;e.exports="function"==typeof o&&/native code/.test(r.call(o))},function(e,t,n){var i=n(165),r=n(145).values;i({target:"Object",stat:!0},{values:function(e){return r(e)}})},function(e,t,n){"use strict";n.d(t,{v:function(){return r}});var i=n(208),r=function(){return function(e,t,n){this.page=0,this.data=null,this.source=0,this.page=e,this.data=t,this.source=n}}();(0,i.l)(r,"BroadcastActionArgs",null,[])},function(e,t,n){"use strict";var i=n(208),r=n(64),o=(0,i.y)("IDefaultErrorHandler"),a=n(255),s=n(614),l=function(){function e(){this._members=[]}return e.prototype.shouldSuppressError=function(e,t,n,i,r,o,s){for(var l=0;l<this._members.length;l++){var u=this._members[l];if(u.shouldSuppressError(e,t,n,i,r,o,s))return a.ULS.sendTraceTag(39978438,306,50,"Error is suppressed by {0}",Object.getType(u).getName()),!0}return!1},e.prototype.register=function(e){a.ULS.sendTraceTag(39978439,306,50,"Register {0} as IAppStateConsistencyManager",Object.getType(e).getName()),Array.add(this._members,e)},e.prototype.dispose=function(){Array.clear(this._members)},e.get_instance=function(){return e._instance||(e._instance=new e),e._instance},e._instance=null,e}();(0,i.l)(l,"AppStateConsistencyHandler",null,[Sys.IDisposable]);var u=n(758),c=n(238),p=n(873),d=n(675),h=n(657),g=n(550),m=n(508),_=n(841),f=function(e){function t(){return e.call(this)||this}return(0,m.t)(t,e),t.prototype.prepareDialog=function(){this.set_overlayCss(this.get_overlayCss()+" WACDialogOverlayUnhandledError"),e.prototype.prepareDialog.call(this),Sys.UI.DomElement.addCssClass(this._divMessageBox,"WACDialogUnhandledError")},t}(_.StandardDialog);(0,i.l)(f,"CrashDialog",_.StandardDialog,[]);var y=n(643),v=n(851),S=n(154),C=n(235),b=n(743),A=n(556),T=n(586);n.d(t,{p:function(){return w}});var w=function(){function e(){this.callStack=null,this._pageManager=null,this._seenOtelError=!1,this._seenSkypeError=!1,this._seenResizeObserverError=!1,this._seenError=!1,this._knownHostnamesRegExp=null,this._additionalErrorsRegExp=null,this._ignoreInCallstackRegExp=null,this._otelErrorsSuppressionEnabled=!1,this._otelErrorsRegExp=null,this._skypeErrorsRegExp=null,this._pagePath=null,this._onErrorDelegate=null,this._javascriptErrorReporter=null,this._javascriptErrorReporterFactory=null,this._suppressedErrorsReported=[]}return e.prototype.get_seenError=function(){return this._seenError},e.prototype.get_javascriptErrorReporterFactory=function(){return this._javascriptErrorReporterFactory||(this._javascriptErrorReporterFactory=C.w.get_instance().resolve(r.z))},e.prototype.init=function(t,n,i,r){void 0===n&&(n=0),void 0===i&&(i=0),void 0===r&&(r=!1),this.initSuppressRegularExpressions(t,b.h.get_pagePath());var o=t.WebServiceBase,s=t.BrowserWatsonUrl;s&&(this._javascriptErrorReporter=this.initializeJavascriptErrorReporter(s,o,n,i,r)),a.ULS.sendTraceTag(38401684,306,50,"Suppress ResizeObserverError: {0}",e.get_suppressResizeObserverErrorIsEnabled())},e.prototype.initializeJavascriptErrorReporter=function(e,t,i,r,o){return t&&-1===e.indexOf("/")&&(e=t+e),this.get_javascriptErrorReporterFactory().build(e,n(254).AFrameworkApplication.buildVersion,i,r,o)},e.prototype.initSuppressRegularExpressions=function(e,t){this._pagePath=t.toLowerCase(),this._ignoreInCallstackRegExp=e.BrowserWatsonCallstackErrorsToIgnoreRegExp,this.appendHostNameRuleToRegExp(v.n.getHostname(e.StaticContentHost)),this.appendHostNameRuleToRegExp(v.n.getHostname(e.SharedStaticContentHost)),this.appendHostNameRuleToRegExp(v.n.getHostname(e.OneNoteOreoCDNUrl)),this.appendHostNameRuleToRegExp(v.n.getHostname(t)),this._additionalErrorsRegExp=e.BrowserWatsonAdditionalErrorsToReportRegExp,this._otelErrorsSuppressionEnabled=Boolean.parse(e.OtelLibraryCrashSupressionIsEnabled||"false"),this._otelErrorsRegExp=e.BrowserWatsonOtelErrorsToIgnoreRegExp,this._skypeErrorsRegExp=e.BrowserWatsonSkypeErrorsToIgnoreRegExp},e.prototype.appendHostNameRuleToRegExp=function(e){e&&(this._knownHostnamesRegExp=this._knownHostnamesRegExp?this._knownHostnamesRegExp+"|":"",this._knownHostnamesRegExp+="^https?://"+e+"[/:]")},e.prototype.setExceptionCallStack=function(e){this.callStack=e.stack},e.prototype.onError=function(t){if(t){var i=t.eventObject;try{window.console.error(i.stack)}catch(e){}try{if(this.suppressError(i))return void this.processSuppressedError(i)}catch(e){a.ULS.sendTraceTag(38401685,306,15,"Error while trying to determine if we shuld suppress error or not. Exception: {0}",e)}this._seenError=!0;if(!n(254).AFrameworkApplication.suppressCrashReportingToWatson&&this._javascriptErrorReporter){var r="Unknown errorEvent",o="Unable to generate callstack.";try{r=i.message||"No error message",o=this.getCallStackToReport(i,!1)}catch(e){i.message=String.format("Unable to generate callstack. Original message: {0}. New message: {1}.",r,e.message),o=e.stack}a.ULS.sendTraceTag(38081179,306,15,"About to send error report to the server. Error: {0}",r),this._javascriptErrorReporter.sendReport(i,o)}if(n(254).AFrameworkApplication.tryReportErrorToTestHarness("null  (no crash messages available in ship)"))this.callStack=null;else{n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DontStopTaskManagerOnCrashIsEnabled")||n(254).AFrameworkApplication.get_theTaskManager().stop(),n(254).AFrameworkApplication.get_activeFrame()&&n(254).AFrameworkApplication.get_activeFrame().get_thePageManager()&&(n(254).AFrameworkApplication.get_activeFrame().get_thePageManager().unregisterDomEvents(),h.FocusManager.usable()&&h.FocusManager.instance().set_delegatesEnabled(!1)),n(254).AFrameworkApplication.isShuttingDown=!0,this.extraOnError(t),this.callStack=null,e._eventSource.raiseEvent("OnAfterError");var s=p.p.applicationCrashed;e.get_browserFeatureDetectionWarningIsEnabled()&&!u.n.get_instance().get_areBrowserFeaturesSupported()&&(s=p.p.unsupportedBrowserCrashed),n(254).AFrameworkApplication.suppressCrashReportingToBSqm||n(254).AFrameworkApplication.reportError(s),n(254).AFrameworkApplication.theWsaClient&&n(254).AFrameworkApplication.theWsaClient.uploadWsaData(),n(254).AFrameworkApplication.suppressCrashDialog||this.showCrashDialog()}}},e.prototype.disableApplication=function(){g.n.removeAllHandlers(window)},e.prototype.extraOnError=function(e){},e.prototype.suppressError=function(e){if(n(254).AFrameworkApplication.isShuttingDown)return a.ULS.sendTraceTag(39978440,306,15,"Error is suppressed due to the app is shutting down"),!0;if(!this._knownHostnamesRegExp&&!this._additionalErrorsRegExp)return!1;var t=e.source,i=this.callStack||e.stack,r=e.message||"",o=this.infoMatchesOurServers(t),s=this.infoMatchesOurServers(i),u=!1;this._otelErrorsSuppressionEnabled&&(u=this.infoMatchesOtel(t));var c=this.infoMatchesSkype(t),p=this.infoMatchesSkype(i),d=!o&&!s,h=c||p,g=this.shouldSuppressAdditionalErrors(r),m=this.shouldSuppressErrorFromCallstack(t,i),_=d||u||h||g||m,f=l.get_instance().shouldSuppressError(t,i,r,_,this._knownHostnamesRegExp,this._additionalErrorsRegExp,this._ignoreInCallstackRegExp);return _||f},e.prototype.infoMatchesOurServers=function(e){return!e||this.stringMatchesRegExp(e,this._knownHostnamesRegExp)||this.stringMatchesRegExp(e,this._additionalErrorsRegExp)},e.prototype.infoMatchesOtel=function(e){var t=!!e&&this.stringMatchesRegExp(e.toLowerCase(),this._otelErrorsRegExp);return t&&!this._seenOtelError&&(a.ULS.sendTraceTag(40150101,306,15,"Ignored script error for Otel"),this._seenOtelError=!0),t},e.prototype.infoMatchesSkype=function(e){var t=!!e&&this.stringMatchesRegExp(e.toLowerCase(),this._skypeErrorsRegExp);return t&&!this._seenSkypeError&&(a.ULS.sendTraceTag(17659039,306,15,"Ignored script error for Skype."),this._seenSkypeError=!0),t},e.prototype.shouldSuppressAdditionalErrors=function(t){return!(!e.get_suppressResizeObserverErrorIsEnabled()||!this.shouldSuppressFromErrorMessage(t,"ResizeObserver loop limit exceeded"))&&(this._seenResizeObserverError||(a.ULS.sendTraceTag(38290114,306,15,"Ignored script error of ResizeObserver."),this._seenResizeObserverError=!0),!0)},e.prototype.shouldSuppressFromErrorMessage=function(e,t){return!!e&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},e.prototype.shouldSuppressErrorFromCallstack=function(e,t){return(!e||e.toLowerCase().startsWith(this._pagePath))&&!!t&&this.stringMatchesRegExp(t,this._ignoreInCallstackRegExp)},e.prototype.stringMatchesRegExp=function(e,t){return!!t&&!!e.match(new RegExp(t,"i"))},e.prototype.processSuppressedError=function(t){try{if(t.message||"No error message",this._suppressedErrorsReported.length>=10)return;for(var n=0;n<this._suppressedErrorsReported.length;n++)if(t.isSameError(this._suppressedErrorsReported[n]))return;a.ULS.sendTraceTag(5904476,306,15,"Ignored script error. Browser session data: {0}",e.getTraceData(t)),Array.add(this._suppressedErrorsReported,t)}catch(e){a.ULS.sendTraceTag(38401689,306,15,"Exception in ProcessSuppressedError. Exception: {0}",e)}},e.prototype.register=function(e){e&&(n(254).AFrameworkApplication.theDefaultErrorHandler=this,this._onErrorDelegate=i.i(this,this.onError,"onError"),e.registerHandler(3,this._onErrorDelegate,null),this._pageManager=e)},e.prototype.unregister=function(){this._pageManager&&(this._pageManager.unregisterHandler(3,this._onErrorDelegate),this._pageManager=null,this._onErrorDelegate=null)},e.prototype.getCallStackToReport=function(e,t){var n=this.callStack||e.stack;return n?t?n:A.l.xmlEncode(n):d.Debug.generateCallstack(e.stackReference,t,!0)},e.prototype.showCrashDialog=function(){try{y.h.get_currentDialog()&&(y.h.get_currentDialog().hide(),y.h.get_currentDialog().dispose())}catch(e){}var t=new f,r=p.p.applicationCrashed,o="Microsoft Office",l="Sorry, we ran into a problem.",c="Something went wrong",d="Sorry, we ran into a problem. Please try refreshing the page.",h="You can't use Office because your browser isn't supported. Please switch to a supported browser.",g="Exit",m="Restart",_="Refresh";try{o=CommonUIStrings.l_DefaultDialogTitle,c=CommonUIStrings.l_CrashDialogTitle,d=CommonUIStrings.l_CrashDialogMessage,l=CommonUIStrings.l_ErrorDialogMessage,g=CommonUIStrings.l_ErrorDialogExitName,m=CommonUIStrings.l_ErrorDialogRestartName,_=CommonUIStrings.l_ErrorDialogRefreshName,h=CommonUIStrings.l_UnsupportedBrowserCrashed}catch(e){a.ULS.sendTraceTag(39321885,306,15,"Failed to get CommonUIStrings. Exception: {0}",e)}n(254).AFrameworkApplication.get_theActionManager().getActionMetadata(s.bT)?n(254).AFrameworkApplication.suppressRetryFromCrashDialog?(n(254).AFrameworkApplication.suppressRetryFromCrashDialogMessage&&n(254).AFrameworkApplication.suppressRetryFromCrashDialogMessage.length>0&&(l=n(254).AFrameworkApplication.suppressRetryFromCrashDialogMessage),t.set_buttonsOption(6),t.setButtonText(0,g)):n(254).AFrameworkApplication.get_isEmbedded()?t.set_buttonsOption(0):(t.set_buttonsOption(1),t.setButtonText(0,g)):(a.ULS.sendTraceTag(39125970,306,50,"ShowCrashDialog: Crash shown before Close command loaded."),t.set_buttonsOption(5),t.set_hasCloseGlyph(!1)),t.setButtonText(1,m),n(254).AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.Common.Flighting.IPPTCrashDialogImprovementSettings"),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsCrashDialogImprovementEnabled")&&(t.set_buttonsOption(0),t.setButtonText(1,_),t.set_hasCloseGlyph(!1),o=c,l=d);var v=i.i(this,this.crashDialogHandler,"crashDialogHandler");e.get_browserFeatureDetectionWarningIsEnabled()&&!u.n.get_instance().get_areBrowserFeaturesSupported()&&(r=p.p.unsupportedBrowserCrashed,l=h),t.showError(r,o,l,v,!1,!1,!1)},e.prototype.crashDialogHandler=function(t,i){1===t?window.self.g_instantApp&&n(254).AFrameworkApplication.get_activeFrame()?n(254).AFrameworkApplication.get_activeFrame().refreshDocument(null):S.g.openWindow(1,window.location.href):e.closeAppOnErrorWithFailoverToBlank(),this.disableApplication(),n(254).AFrameworkApplication.theUlsHost&&n(254).AFrameworkApplication.theUlsHost.dispose()},e.get_suppressResizeObserverErrorIsEnabled=function(){return null==e._suppressResizeObserverErrorIsEnabled&&(e._suppressResizeObserverErrorIsEnabled=!!n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SuppressResizeObserverErrorIsEnabled")),e._suppressResizeObserverErrorIsEnabled},e.get_browserFeatureDetectionWarningIsEnabled=function(){return null==e._browserFeatureDetectionWarningIsEnabled&&(e._browserFeatureDetectionWarningIsEnabled=!!n(254).AFrameworkApplication.appSettingsManager&&(n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BrowserFeatureDetectionIsEnabled")&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BrowserFeatureDetectionWarningIsEnabled"))),e._browserFeatureDetectionWarningIsEnabled},e.add_onAfterError=function(t){e._eventSource.addHandler("OnAfterError",t)},e.remove_onAfterError=function(t){e._eventSource.removeHandler("OnAfterError",t)},e.getTraceData=function(e){var t={};return t.message=e.message,t.line=e.line,e.source&&(t.file=v.n.addOrReplaceParameterValue(e.source,"fileName","DWITHDRAWN")),e.stack&&(t.stack=e.stack),t},e.closeAppOnErrorWithFailoverToBlank=function(){32!==n(254).AFrameworkApplication.get_theActionManager().processActionWithData(s.bT,2,c.j)&&(a.ULS.sendTraceTag(5878498,201,50,"Failed to execute Close action."),window.location="about:blank")},e._eventSource=new T.f,e._suppressResizeObserverErrorIsEnabled=null,e._browserFeatureDetectionWarningIsEnabled=null,e}();(0,i.l)(w,"DefaultErrorHandler",null,[o])},,function(e,t,n){"use strict";var i=n(508),r=n(208),o=n(550),a=n(255),s=n(614),l=n(574),u=n(979),c=function(){function e(e){this.target=null,this.touchAdapters=null,this.touchAdapters=new u.m,this.target=e}return e.prototype.canHandleEvent=function(e){for(var t=0;t<this.touchAdapters.get_length();t++){if(this.touchAdapters.get_item(t).canHandleEvent(e))return!0}return!1},e.prototype.getFirstAdapter=function(e){for(var t=0;t<this.touchAdapters.get_length();t++){var n=this.touchAdapters.get_item(t);if(n.canHandleEvent(e))return n}return null},e.prototype.addAdapter=function(e,t){this.touchAdapters.add(e,t)},e.prototype.removeAdapter=function(e){this.touchAdapters.remove(e)},e.prototype.isEmpty=function(){return!this.touchAdapters.get_length()},e}();(0,r.l)(c,"TouchAdapterRegister",null,[]);var p=n(445),d=n(124),h=n(810),g=n(101),m=n(154),_=n(425),f=n(296);n.d(t,{v:function(){return y}});var y=function(e){function t(){var t=e.call(this)||this;return t._touchAdapter=null,t._firstDownEvent=null,t._focusManager=null,t._eventHandlerManager=null,t._touchRegions=[],t._eventHandlerManager=n(306).EventHandlerManager.get_instance(),t._focusManager=n(657).FocusManager.instance(),n(254).AFrameworkApplication.subscribeToBeforeAppShutDown((function(e,n){t.logNoTouchStart()})),t}return(0,i.t)(t,e),t.prototype.logNoTouchStart=function(){n(254).AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordLogNoTouchStartSettings"),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LogNoTouchStartIsEnabled")&&!t._haveLoggedTouchStart&&d.b(s.Ht)},t.prototype.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeListForElement(l.d.get_touchEvents(),t,0,r.i(this,this.onTouchEvent,"onTouchEvent"))},t.prototype.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeListForElement(t,l.d.get_touchEvents())},t.prototype.registerHandler=function(e,t,n,i){this._eventHandlerManager.registerHandler(p.f,e,t,2,r.i(this,this.onTouchEvent,"onTouchEvent"),n,i)},t.prototype.unregisterHandler=function(e,t,n){this._eventHandlerManager.unregisterHandler(p.f,e,t,n)},t.prototype.onTouchEvent=function(e,i,s){if(!this.get_isEnabled())return!1;if(h.y.get_instance().get_isYielding())return a.ULS.sendTraceTag(24699484,324,50,"Touch event dropped."),!1;if(this._supressEvents)return o.n.cancelEvent(s),!0;if(t.isMultiTouch(s)&&(n(256).TouchAndHoldAdapter.cancelAnyPendingTouchAndHold(),!this._touchRegions.length))return!1;var u=p.f.create(e,i,null,s);if(this._touchRegions.length>0&&this.canHandleEvent(u)&&!this.onHandleEvent(u))return!1;var c=n(256).TouchAndHoldAdapter.getTouchAndHoldAdapter(u.get_sourceElement());c.cancelTouchAndHoldIfNecessary(u),e===l.d.touchStart&&(c.beginTouchAndHold(u,r.i(this,this.onTouchAndHold,"onTouchAndHold")),t.logTouchStartIfNeeded()),e===l.d.touchEnd&&_.y.get_isIPad()&&(_.y.get_iPadOsVersion()<=6||6!==f.s.getTag(m.g.getActiveElement(window.document)))&&window.focus(),this._touchAdapter&&e===l.d.touchEnd&&(this._touchAdapter.onTouchEnd(u),this._touchAdapter=null,o.n.cancelEvent(s));var d=this._eventHandlerManager.processEvent(p.f,e,i,u);return d&&o.n.cancelEvent(s),d},t.prototype.canHandleEvent=function(e){if(this._touchAdapter&&(l.d.touchEnd===e.get_action()||l.d.touchMove===e.get_action()))return!0;for(var t=e.innerEvent.target;t;t=t.parentNode){var n=this.getRegisterEntry(t);if(n&&n.canHandleEvent(e))return!0}return!1},t.prototype.onHandleEvent=function(e){var t=!1;if(this._touchAdapter)return l.d.touchEnd===e.get_action()?(t=this._touchAdapter.onTouchEnd(e),this._touchAdapter=null,o.n.cancelEvent(e.innerEvent)):e.get_action()===l.d.touchMove&&(t=this._touchAdapter.onTouchMove(e),o.n.cancelEvent(e.innerEvent)),t;if(l.d.touchStart===e.get_action()){for(var n=e.innerEvent.target;n;n=n.parentNode){this._firstDownEvent=e;var i=this.getRegisterEntry(e.get_caughtElement());if(i){var r=i.getFirstAdapter(e);if(r)return this._touchAdapter=r,r.onTouchStart(e)}}return t}return t},t.prototype.onTouchAndHold=function(e){this.fireTouchContextMenuEvent(e.innerEvent.rawEvent)},t.prototype.fireTouchContextMenuEvent=function(e){var t=e.srcElement||e.target,n=new Sys.UI.DomEvent(e);this._eventHandlerManager.simulateBubblingEvent(l.d.touchContextMenu,t,n)},t.prototype.addControlFocus=function(e,t,n,i){var r=this;void 0===n&&(n=!1),void 0===i&&(i=!1);var o=function(t){return r._focusManager.tryChangeScopeOnStealingFocusEvent(e,i,n,t),!1};this.registerHandler(l.d.touchStart,t,o,null),this._focusManager.getScope(e).addDispose((function(){r.unregisterHandler(l.d.touchStart,t,o)}))},t.prototype.registerTouchRegion=function(e){Array.add(this._touchRegions,e),this._eventHandlerManager.initializeListForElement(l.d.get_touchEvents(),e.target,0,r.i(this,this.onTouchEvent,"onTouchEvent"))},t.prototype.unregisterTouchRegion=function(e){Array.remove(this._touchRegions,e),this._eventHandlerManager.deinitializeListForElement(e.target,l.d.get_touchEvents())},t.prototype.registerTouchAdapterWithPriority=function(e,t,n){var i=this.getRegisterEntry(e);i||(i=new c(e)),i.isEmpty()&&this.registerTouchRegion(i),i.addAdapter(n,t)},t.prototype.unregisterTouchAdapter=function(e,t){var n=this.getRegisterEntry(e);n&&(n.removeAdapter(t),n.isEmpty()&&this.unregisterTouchRegion(n))},t.prototype.getRegisterEntry=function(e){for(var t=0;t<this._touchRegions.length;t++)if(this._touchRegions[t].target===e)return this._touchRegions[t];return null},t.get_instance=function(){return t._instance||(t._instance=new t)},t.disposeInputManager=function(){g.b(t._instance)},t.logTouchStartIfNeeded=function(){t._haveLoggedTouchStart||(a.ULS.sendTraceTag(42821152,324,15,"Touch input used in session"),n(254).AFrameworkApplication.get_theActionManager().processActionWithData(s.BO,2,null),n(254).AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordMultiTouchGestureWordSettings"),t._haveLoggedTouchStart=!0)},t.isMultiTouch=function(e){var n=t.getTouchArrayFromEvent(e);return!!n&&n.length>1},t.isWebkitStyleTouchEvent=function(e){return!!t.getTouchArrayFromEvent(e)},t.getTouchArrayFromEvent=function(e){var t=e.rawEvent;return t?t.touches:null},t._haveLoggedTouchStart=!1,t.touchAndHoldTimeThreshold=400,t.touchAndHoldDistanceThreshold=10,t._instance=null,t}(o.n);(0,r.l)(y,"TouchInputManager",o.n,[])},function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var i=n(208),r=function(){return function(){this.expirationOptions=null,this.onShow=null,this.telemetryId=null}}();(0,i.l)(r,"NotificationOptions",null,[])},function(e,t,n){e.exports=n(436)},,,,function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var i=(0,n(208).y)("IModalController")},,,function(e,t,n){"use strict";var i=n(508),r=n(50),o=n(134),a=n(951),s=n(268),l=n(609),u=n(920),c=n(208),p=function(e){function t(t){var n=e.call(this,t)||this;return n.elmInput=null,n.elmBtnA=null,n.elmArwImg=null,n}return(0,i.t)(t,e),t}(u.d);(0,c.l)(p,"ComboBoxComponentDom",u.d,[]);var d=n(513),h=n(946);n.d(t,{y:function(){return m}});var g=100,m=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;if(o.comboBoxDom=null,o.allowFreeForm=!1,o.autoCompleteDelay=0,o._menuItems=null,d.x(o.get_cbProperties().AllowFreeForm)?o.allowFreeForm=!1:o.allowFreeForm="true"===o.get_cbProperties().AllowFreeForm.toLowerCase(),d.t(o.get_cbProperties().AutoComplete)&&(o.get_cbProperties().AutoComplete="true"),!d.t(o.get_cbProperties().AutoCompleteDelay))try{o.autoCompleteDelay=parseInt(o.get_cbProperties().AutoCompleteDelay)}catch(e){o.autoCompleteDelay=g}return o}return(0,i.t)(t,e),t.prototype.get_comboBoxDom=function(){return this.comboBoxDom},t.prototype.get_allowFreeForm=function(){return this.allowFreeForm},t.prototype.get_autoCompleteDelay=function(){return this.autoCompleteDelay},t.prototype.createComponentDomForDisplayMode=function(e){var t,n,i,r,o,a=d.x(this.get_cbProperties().Alt)?"":this.get_cbProperties().Alt;return(t=h.n.createElement("span")).className="cui-cb",t.setAttribute("mscui:controltype",this.get_controlType()),(n=h.n.createSelectableElement("input")).type="text",n.style.width=this.isSmallWidth(e)?this.get_cbProperties().SmallWidth:this.get_cbProperties().Width,n.className="cui-cb-input",n.setAttribute("autocomplete","off"),n.setAttribute("data-lpignore","true"),n.setAttribute("data-lpignore","true"),n.id=this.get_cbProperties().Id,n.title=a,this.inMenu=s.r.isDisplayModeMenu(e),this.setInitialAriaMenuLauncherAttributes(n),"true"===this.get_cbProperties().FillContainer&&(h.n.ensureCSSClassOnElement(n,"cui-cb-fill-input"),h.n.ensureCSSClassOnElement(t,"cui-cb-fill-container")),h.n.addToTabLoop(n),i=h.n.createElement("a"),h.n.ensureCSSClassOnElement(i,"cui-dd-arrow-button"),i.tabIndex=-1,i.setAttribute("role","presentation"),r=h.n.createElement("img"),o=this.get_isVisualRefreshEnabled()?h.n.createClusteredImageContainerNew(2,this.get_root().get_properties().ImageDownArrow8by8,this.get_root().get_properties().ImageDownArrow8by8Class,r,!0,!1):h.n.createClusteredImageContainerNew(1,this.get_root().get_properties().ImageDownArrow,this.get_root().get_properties().ImageDownArrowClass,r,!0,!1),r.alt=a,i.title=a,t.appendChild(n),t.appendChild(i),i.appendChild(o),this.comboBoxDom=new p(e),this.get_comboBoxDom().elmControl=t,this.get_comboBoxDom().elmInput=n,this.get_comboBoxDom().elmBtnA=i,this.get_comboBoxDom().elmArwImg=r,this.get_comboBoxDom().elmIconContainer=o,this.get_comboBoxDom()},t.prototype.ensureKeytipForControl=function(e,t){e.ensureKeytip(t,this.get_comboBoxDom().elmInput,this.parentKeytipsIds,this.parentKeytipsKeys)},t.prototype.get_controlType=function(){return a.Control.comboBoxControlType},t.prototype.get_ariaRole=function(){return o.t.ariaComboboxRole},t.prototype.get_menuItems=function(){return d.x(this._menuItems)&&(this._menuItems={}),this._menuItems},t.prototype.set_menuItems=function(e){return this._menuItems=e,e},t.prototype.get_focusableElement=function(){return this.get_comboBoxDom()?this.get_comboBoxDom().elmInput:null},t.prototype.selectDropdownItem=function(e){this.get_selectedControl()!==e&&(this._selectedControl=e,this.get_comboBoxDom().elmInput.value=e.getTextValue(),this.behavior.get_isCommitChangeFixEnabled()&&!this.get_allowFreeForm()&&(this.get_stateProperties()[l.g.Value]=e.getTextValue()))},t.prototype.commitPendingChange=function(){this.behavior.commitPendingChange()},t.prototype.get_cbProperties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t.prototype.get_isEditable=function(){return!0},t}(r.p);(0,c.l)(m,"ComboBox",r.p,[])},,function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var i=n(508),r=n(208),o=n(550),a=n(446),s=n(306),l=n(101),u=function(e){function t(){var t=e.call(this)||this;return t._eventHandlerManager=null,t._eventHandlerManager=s.EventHandlerManager.get_instance(),t}return(0,i.t)(t,e),t.prototype.registerHandler=function(e,t,n){this._eventHandlerManager.registerHandler(a.a,e,t,2,r.i(this,this.onEvent,"onEvent"),n,null)},t.prototype.unregisterHandler=function(e,t,n){this._eventHandlerManager.unregisterHandler(a.a,e,t,n)},t.prototype.onEvent=function(e,t,n){var i=a.a.getSourceElement(n),r=new a.a(e,i,n,0),s=this._eventHandlerManager.processEvent(a.a,e,t,r);return s&&o.n.cancelEvent(n),s},t.get_instance=function(){return t._instance||(t._instance=new t),t._instance},t.disposeInputManager=function(){l.b(t._instance)},t._instance=null,t}(o.n);(0,r.l)(u,"BasicInputManager",o.n,[])},function(e,t,n){"use strict";n.r(t),n.d(t,{CompletableTask$1:function(){return s}});var i=n(508),r=n(208),o=n(473),a=n(594),s=function(e){function t(n){var i=e.call(this,n)||this;return r.m(i,t.$$(n)),i}return(0,i.t)(t,e),t.prototype.SEsE=function(e){this.set_exception(a.C(e))},t.prototype.SEsA=function(e){this.set_exception(a.s(e))},t.prototype.SE=function(e){this.set_exception(e)},t.prototype.setResult=function(e){this.set_result(e),this.setCompleted(!0)},t.$$=function(e){var n="CompletableTask$1$"+e.getName(),i=r.x(n);return i||r.u(n,"$$sc.CompletableTask$1",t,[{TResult:e}],o.Task$1.$$(e),[])},t}(o.Task$1)},function(e,t,n){var i=n(287),r=n(765),o=n(780),a=n(227),s=n(601),l=n(875),u=n(919)("IE_PROTO"),c=function(){},p=function(){var e,t=l("iframe"),n=o.length;for(t.style.display="none",s.appendChild(t),t.src=String("javascript:"),(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),p=e.F;n--;)delete p.prototype[o[n]];return p()};e.exports=Object.create||function(e,t){var n;return null!==e?(c.prototype=i(e),n=new c,c.prototype=null,n[u]=e):n=p(),void 0===t?n:r(n,t)},a[u]=!0},,,function(e,t,n){var i=n(165),r=n(371),o=n(318);i({target:"Object",stat:!0},{fromEntries:function(e){var t={};return r(e,(function(e,n){o(t,e,n)}),void 0,!0),t}})},,,,function(e,t,n){"use strict";n.d(t,{z:function(){return s}});var i=n(508),r=n(208),o=n(267),a=n(268),s=function(e){function t(t,n){return e.call(this,t,n,"","")||this}return(0,i.t)(t,e),t.prototype.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.get_elementInternal()),e.prototype.refreshInternal.call(this)},t.prototype.ensureCorrectChildType=function(e){if(!r.r(a.r,e))throw Error.create("Only children of type Control can be added to StandaloneDocks.")},t.prototype.get_visibleInDOM=function(){return!0},t}(o.s);(0,r.l)(s,"StandaloneDock",o.s,[])},,function(e,t,n){"use strict";var i=n(508),r=n(208),o=n(600),a=n(550),s=n(929),l=n(644),u=n(979),c=function(){return function(){this.dragAdapters=null,this.dragAdapters=new u.m}}();(0,r.l)(c,"DragAdapterCache",null,[]);var p=function(e){function t(t){var n=e.call(this)||this;return n._triggeredExternally=!1,n._triggeredExternally=t,n}return(0,i.t)(t,e),t.prototype.get_triggeredExternally=function(){return this._triggeredExternally},t}(Sys.EventArgs);(0,r.l)(p,"DragCancelEventArgs",Sys.EventArgs,[]);var d=n(446),h=function(e){function t(t,n,i,r,o,a,s,l,u,c,p){var d=e.call(this,t,n,r,p)||this;return d._caught=null,d._button=0,d._shiftKey=!1,d._ctrlKey=!1,d._elementPoint=null,d._screen=null,d._client=null,d._beginMouseCapture=!1,d.preventEventDefaultOnDragPossible=!0,d._caught=i,d._elementPoint=o,d._screen=a,d._client=s,d._button=l,d._shiftKey=u,d._ctrlKey=c,d}return(0,i.t)(t,e),t.prototype.get_beginMouseCapture=function(){return this._beginMouseCapture},t.prototype.set_beginMouseCapture=function(e){return this._beginMouseCapture=e,e},t.prototype.get_caughtElement=function(){return this._caught},t.prototype.get_mouseButton=function(){return this._button},t.prototype.get_shiftKey=function(){return this._shiftKey},t.prototype.get_ctrlKey=function(){return this._ctrlKey},t.prototype.get_elementPoint=function(){return this._elementPoint||(this._elementPoint=d.a.getElementPoint(this._client,this.get_sourceElement())),this._elementPoint},t.prototype.get_screenPoint=function(){return this._screen},t.prototype.get_clientPoint=function(){return this._client},t.createFromMouseEvent=function(e,n,i,r){if(i.rawEvent){var o=i.rawEvent;return new t(e,d.a.getSourceElement(i),n,i,null,new Sys.UI.Point(o.screenX,o.screenY),new Sys.UI.Point(o.clientX,o.clientY),d.a.getMouseButton(o),o.shiftKey,o.ctrlKey,r)}return new t(e,i.target,n,i,null,new Sys.UI.Point(i.screenX,i.screenY),new Sys.UI.Point(i.clientX,i.clientY),i.button,i.shiftKey,i.ctrlKey,r)},t.createFromTouchArgs=function(e){var n=e.innerEvent.rawEvent,i=n.shiftKey,r=n.ctrlKey;return new t(e.eventName,e.get_sourceElement(),e.get_caughtElement(),e.innerEvent,e.get_elementPoint(),e.get_screenPoint(),e.get_clientPoint(),Sys.UI.MouseButton.leftButton,i,r,3)},t}(d.a);(0,r.l)(h,"DragEventArgs",d.a,[]);var g=n(306),m=n(574),_=n(657),f=n(635),y=n(733),v=n(256),S=n(445),C=n(25),b=n(810),A=n(101),T=n(154),w=n(425),I=n(579),E=n(296);n.d(t,{p:function(){return k}});var k=function(e){function t(){var t=e.call(this)||this;t._eventHandlerManager=null,t._dragAdapter=null,t._endingDrag=!1,t._callingDragAdapterDragEnd=!1,t._lastDownEvent=null,t._downDetected=!1,t._lastDownX=0,t._lastDownY=0,t._taskManagerPauseCount=0,t._isMultiTouchGestureEnabled=!1,t._capturedElement=null,t._isFromIE10Touch=!1,t._inTouchDrag=!1,t._outOfWindowDraggableAdapters=null,t._inputDataName=f.z.dragAdapterCache,t._dragRegions=[],t._dragCandidates=[],t._cursorPinningTool=[],t._pointerEventsCached=new l.c(Number),t._eventProcessorPriority=0,t._eventHandlerManager=g.EventHandlerManager.get_instance(),t._outOfWindowDraggableAdapters=[],g.EventHandlerManager.get_instance().registerOnBeforeEventProcessed(m.d.msPointerDown,r.i(t,t.onMsPointerDownEventHeard,"onMsPointerDownEventHeard")),g.EventHandlerManager.get_instance().registerOnBeforeEventProcessed(m.d.browserPointerDown,r.i(t,t.onMsPointerDownEventHeard,"onMsPointerDownEventHeard"));n(254).AFrameworkApplication.appSettingsManager;return t._isMultiTouchGestureEnabled=n(254).AFrameworkApplication.isMultiTouchGestureEnabled(),t._isMultiTouchGestureEnabled&&(t._eventProcessorPriority=1,g.EventHandlerManager.get_instance().registerOnBeforeEventProcessed(m.d.msPointerUp,r.i(t,t.onMsPointerUpOrCancelEventHeard,"onMsPointerUpOrCancelEventHeard")),g.EventHandlerManager.get_instance().registerOnBeforeEventProcessed(m.d.browserPointerUp,r.i(t,t.onMsPointerUpOrCancelEventHeard,"onMsPointerUpOrCancelEventHeard")),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MultiTouchRegisterForPointerCancelIsEnabled")&&(g.EventHandlerManager.get_instance().registerOnBeforeEventProcessed(m.d.msPointerCancel,r.i(t,t.onMsPointerUpOrCancelEventHeard,"onMsPointerUpOrCancelEventHeard")),g.EventHandlerManager.get_instance().registerOnBeforeEventProcessed(m.d.browserPointerCancel,r.i(t,t.onMsPointerUpOrCancelEventHeard,"onMsPointerUpOrCancelEventHeard")))),t}return(0,i.t)(t,e),t.prototype.get_isMouseCaptured=function(){return!!this._capturedElement},t.prototype.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeListForElement(m.d.get_dragEvents(),t,this._eventProcessorPriority,r.i(this,this.onDragEvent,"onDragEvent"))},t.prototype.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeListForElement(t,m.d.get_dragEvents())},t.prototype.suspend=function(){this.cancelDragInternal(),e.prototype.suspend.call(this)},t.prototype.registerCursorPinningTool=function(e){Array.add(this._cursorPinningTool,e)},t.prototype.registerDragAdapter=function(e,t,n){void 0===n&&(n=!1),this.registerDragAdapterWithPriority(e,t,1,n)},t.prototype.registerDragAdapterWithPriority=function(e,t,n,i){void 0===i&&(i=!1);var r=this.getAdapterCache(e);r||(r=new c,this.setAdapterCache(e,r)),r.dragAdapters.get_length()||this.registerDragRegion(e),r.dragAdapters.add(n,t),i&&Array.add(this._outOfWindowDraggableAdapters,t)},t.prototype.unregisterDragAdapter=function(e,t){var n=this.getAdapterCache(e);n&&(n.dragAdapters.remove(t),Array.remove(this._outOfWindowDraggableAdapters,t),n.dragAdapters.get_length()||this.unregisterDragRegion(e))},t.prototype.isFakeClick=function(e){if("undefined"==typeof e||!e)return!1;if(e.Visibility)return this._downDetected;if(this._downDetected){var t=e.screenX,n=e.screenY,i=this._lastDownX-t,r=this._lastDownY-n;if(i<-4||i>4||r<-4||r>4)return!0}return!1},t.prototype.get_isInDrag=function(){return!!this._dragAdapter},t.prototype.startDrag=function(e,t){(b.y.get_instance().pause(),this._taskManagerPauseCount++,3===t.get_inputSource())&&(v.TouchAndHoldAdapter.getTouchAndHoldAdapter(t.get_sourceElement()).cancelTouchAndHold(),this._inTouchDrag=!0);this._dragAdapter=e,this._lastDownEvent=null,this._eventHandlerManager.set_isDragging(!0),Array.clear(this._dragCandidates)},t.prototype.cancelDrag=function(e){void 0===e&&(e=!1),(this.get_isInDrag()||e)&&this.cancelDragInternal(!0)},t.prototype.cancelDragInternal=function(e){void 0===e&&(e=!1),this._endingDrag||this._callingDragAdapterDragEnd||(this._dragAdapter&&this._dragAdapter.onDragCancel(new p(e)),this._downDetected=!1,this.endDrag())},t.prototype.endDrag=function(){var e=this;this._endingDrag||(this._endingDrag=!0,this._dragAdapter=null,Array.clear(this._dragCandidates),this._lastDownEvent=null,this._inTouchDrag&&(this._isFromIE10Touch||this._eventHandlerManager.temporarilyDisableBrowserClicks(),this._inTouchDrag=!1),this._isFromIE10Touch=!1,this.browserReleaseCapture(),this._taskManagerPauseCount>0&&(b.y.get_instance().resume(),this._taskManagerPauseCount--),this._endingDrag=!1,this.resetCursor(),window.setTimeout((function(){e._eventHandlerManager.set_isDragging(!1)}),0))},t.prototype.shouldCancelDrag=function(e,t){if(e===m.d.mouseOut&&d.a.getSourceElement(t).ownerDocument===window.document){if(this._dragAdapter&&Array.contains(this._outOfWindowDraggableAdapters,this._dragAdapter))return!1;var n=new Sys.UI.Point(t.clientX,t.clientY);if(!T.g.isPointInElement(window.document.body,n))return!0}return!1},t.prototype.shouldEndDrag=function(e){return e===m.d.mouseUp||e===m.d.touchEnd},t.prototype.browserCapture=function(e){e.setCapture&&e.releaseCapture&&(this.get_isMouseCaptured()&&this.browserReleaseCapture(),this._eventHandlerManager.initializeEventForElement(m.d.loseCapture,e,this._eventProcessorPriority,r.i(this,this.onLoseCapture,"onLoseCapture")),e.setCapture(),this._capturedElement=e)},t.prototype.browserReleaseCapture=function(){this.get_isMouseCaptured()&&(this._eventHandlerManager.deinitializeEventForElement(this._capturedElement,m.d.loseCapture),this._capturedElement.releaseCapture(),this._capturedElement=null)},t.prototype.onLoseCapture=function(e,t,n){return this.cancelDragInternal(),!0},t.prototype.getAdapterCache=function(e){return I.j(e,this._inputDataName)},t.prototype.setAdapterCache=function(e,t){I.v(e,this._inputDataName,t)},t.prototype.isEventLandedBeyondSourceElement=function(e){return a.n.eventLandedBeyondSourceElement(e)},t.prototype.registerDragRegion=function(e){Array.add(this._dragRegions,e),e.nodeType===s.o.document?this._eventHandlerManager.initializeListForElement(m.d.get_dragEvents(),e,this._eventProcessorPriority,r.i(this,this.onDocumentDragEvent,"onDocumentDragEvent")):this._eventHandlerManager.initializeListForElement(m.d.get_dragEvents(),e,this._eventProcessorPriority,r.i(this,this.onDragEvent,"onDragEvent"))},t.prototype.unregisterDragRegion=function(e){Array.remove(this._dragRegions,e),e.nodeType,s.o.document,this._eventHandlerManager.deinitializeListForElement(e,m.d.get_dragEvents())},t.prototype.onDragEvent=function(e,t,n){return this.onDragEventInternal(e,t,n,!0)},t.prototype.onDocumentDragEvent=function(e,t,n){return this.onDragEventInternal(e,t,n,w.y.get_isFirefox()),!1},t.prototype.onDragEventInternal=function(e,t,n,i){var r,l=Array.contains(m.d.get_touchEvents(),e)||this._isFromIE10Touch;if(l&&C.v.isMultiTouch(n))return this.cancelDragInternal(),!1;if(this._isMultiTouchGestureEnabled&&this._pointerEventsCached.get_count()>1)return this.cancelDragInternal(),!1;if(t.nodeType!==s.o.document&&!this.shouldProcessEvent(e,n,(0,o.m)((function(){return r}),(function(e){return r=e}))))return r;if(this._dragAdapter){var u=!1;if(this.shouldCancelDrag(e,n))this._dragAdapter.onDragCancel(new p(!1)),u=!0;else if(this.shouldEndDrag(e)){if(!(c=this.createDragEventArgs(e,t,n,l)))return!1;this._callingDragAdapterDragEnd=!0,this._dragAdapter.onDragEnd(c),this._callingDragAdapterDragEnd=!1,u=!0}else if(e===m.d.touchMove||e===m.d.mouseMove){var c;if(!(c=this.createDragEventArgs(e,t,n,l)))return!1;this._dragAdapter.onDragMove(c)?c.get_beginMouseCapture()&&!this.get_isMouseCaptured()&&this.browserCapture(t):(this._dragAdapter.onDragCancel(new p(!1)),u=!0)}return u&&this.endDrag(),a.n.cancelEvent(n),!0}if(this._lastDownEvent&&(this.shouldCancelDrag(e,n)||this.shouldEndDrag(e))&&this.cancelDragInternal(),e===m.d.mouseDown||e===m.d.touchStart){Array.add(this._dragCandidates,t);for(var d=n.target;d;d=d.parentNode)if(Array.contains(this._dragRegions,d)){var h=this.createDragEventArgs(e,t,n,l);if(this._lastDownEvent=h,E=this.getAdapterCache(t)){for(var g=!1,f=!0,y=0;y<E.dragAdapters.get_length();++y){var v=E.dragAdapters.get_item(y);if(h.set_beginMouseCapture(!0),v.isDragPossible(h)){g=!0,f=h.get_beginMouseCapture();break}}return g&&(f&&this.browserCapture(t),l||this.pinCursor(n),h.preventEventDefaultOnDragPossible&&(i&&n.preventDefault(),w.y.get_isFirefox()&&_.FocusManager.tryFocus(document.defaultView))),!1}}return!1}if((e===m.d.mouseMove||e===m.d.touchMove)&&this._lastDownEvent){var S=this.createDragEventArgs(e,t,n,l),b=S.get_screenPoint().x-this._lastDownEvent.get_screenPoint().x,A=S.get_screenPoint().y-this._lastDownEvent.get_screenPoint().y,T=this.getDragThreshHold(n,l);if(b<-T||b>T||A<-T||A>T){for(var I=0;I<this._dragCandidates.length;++I){var E,k=this._dragCandidates[I];if(E=this.getAdapterCache(k))for(y=0;y<E.dragAdapters.get_length();++y){if((v=E.dragAdapters.get_item(y)).onDragStart(this._lastDownEvent))return v.onDragMove(S)?(this.startDrag(v,this._lastDownEvent),a.n.cancelEvent(n),!0):(v.onDragCancel(new p(!1)),this.cancelDragInternal(),!1)}}return this.cancelDragInternal(),!1}return!1}return!(!this.shouldEndDrag(e)&&!this.shouldCancelDrag(e,n))&&(this.cancelDragInternal(),!1)},t.prototype.shouldProcessEvent=function(e,t,n){if(!this._dragAdapter&&e===m.d.mouseDown&&this.isEventLandedBeyondSourceElement(t))return n.val=!1,!1;if(!this.get_isEnabled())return n.val=!1,!1;if(!E.s.isValidElement(t.target)&&t.target.nodeType!==s.o.document)return n.val=!1,!1;if(b.y.get_instance().get_isYielding())return n.val=!1,!1;if(e===m.d.mouseDown&&(this._downDetected=!0,this._lastDownX=t.screenX,this._lastDownY=t.screenY),e===m.d.click&&this._downDetected){if(this.isFakeClick(t.rawEvent))return this._downDetected=!1,a.n.cancelEvent(t),n.val=!0,!1;this._downDetected=!1}return e!==m.d.mouseMove&&e!==m.d.touchMove||a.n.ensureAppAwakeIfAsleep(),this._supressEvents?(a.n.cancelEvent(t),n.val=!0,!1):(n.val=!0,!0)},t.prototype.createDragEventArgs=function(e,t,n,i){var r;if(i&&C.v.isWebkitStyleTouchEvent(n)){var o=S.f.create(e,t,null,n);r=h.createFromTouchArgs(o)}else{var a=i?3:2;r=h.createFromMouseEvent(e,t,n,a)}return r},t.prototype.cancelPendingPointerEvents=function(){this._pointerEventsCached.clear()},t.prototype.onMsPointerUpOrCancelEventHeard=function(e){var t=e.rawEvent;if(null!=t){var n=t.pointerId;null!=n&&this._pointerEventsCached.remove(n)}},t.prototype.onMsPointerDownEventHeard=function(e){this._isFromIE10Touch=3===y.z.getIeInputMethod(e);var t=e.rawEvent;if(null!=t){var n=t.pointerId;null==n||this._pointerEventsCached.contains(n)||this._pointerEventsCached.add(n)}},t.prototype.pinCursor=function(e){for(var t=0;t<this._cursorPinningTool.length;++t){this._cursorPinningTool[t].pinCursor(e.target)}},t.prototype.resetCursor=function(){for(var e=0;e<this._cursorPinningTool.length;++e){this._cursorPinningTool[e].resetCursor()}},t.prototype.getDragThreshHold=function(e,t){return Sys.UI.DomElement.containsCssClass(e.target,"ewawebex")||w.y.get_isIPad()?0:t?10:4},t.get_instance=function(){if(!t._instance){var e=t.dragInputManagerFactory||t.createDragInputManager;t._instance=e()}return t._instance},t.createDragInputManager=function(){return new t},t.disposeInputManager=function(){A.b(t._instance)},t._instance=null,t.dragInputManagerFactory=null,t}(a.n);(0,r.l)(k,"DragInputManager",a.n,[])},function(e,t,n){"use strict";n.d(t,{k:function(){return h}});var i=n(600),r=n(547),o=n(704),a=n(520),s=n(254),l=n(928),u=n(773),c=n(154),p=n(296),d=n(208),h=function(){function e(){}return e.scaleHeader=function(t){var n,r;e.findDefaultRibbonTopBars((0,i.m)((function(){return n}),(function(e){return n=e})),(0,i.m)((function(){return r}),(function(e){return r=e}))),e.scaleHeaderUsingContainers(n,r,t)},e.findDefaultRibbonTopBars=function(e,t){var n;l.f((0,i.m)((function(){return n}),(function(e){return n=e})),!s.AFrameworkApplication.hideHeaderEmbedded);var o=$get(r.CuiHelper.headerTopBarsId);n?(e.val=document.getElementById(r.CuiHelper.externalHeaderFullTopBarsId),t.val=o):(e.val=o.childNodes[0],t.val=o.childNodes[1])},e.scaleHeaderUsingContainers=function(t,n,i){if(t&&n&&n.clientHeight>0){var r=-1!==n.parentNode.parentNode.className.indexOf("cui-ribbon");e.scaleHeaderCore(t,n,i,r)}},e.scaleHeaderCore=function(t,n,r,o){var a=null,s=null,l=null,u=null,c=null,p=null,d=null,h=null,g=null,m=null,_=null,f=null,y=null,v=null,S=null,C=null,b=null,A=null,T=null,w=null;e.findHeaderItems(t,(0,i.m)((function(){return a}),(function(e){return a=e})),(0,i.m)((function(){return s}),(function(e){return s=e})),(0,i.m)((function(){return l}),(function(e){return l=e})),(0,i.m)((function(){return u}),(function(e){return u=e})),(0,i.m)((function(){return c}),(function(e){return c=e})),(0,i.m)((function(){return p}),(function(e){return p=e})),(0,i.m)((function(){return d}),(function(e){return d=e})),(0,i.m)((function(){return h}),(function(e){return h=e})),(0,i.m)((function(){return g}),(function(e){return g=e})),(0,i.m)((function(){return m}),(function(e){return m=e})),(0,i.m)((function(){return _}),(function(e){return _=e})),(0,i.m)((function(){return w}),(function(e){return w=e}))),e.findTopBar2Items(n,(0,i.m)((function(){return f}),(function(e){return f=e})),(0,i.m)((function(){return y}),(function(e){return y=e})),(0,i.m)((function(){return v}),(function(e){return v=e})),(0,i.m)((function(){return S}),(function(e){return S=e})),(0,i.m)((function(){return C}),(function(e){return C=e})),(0,i.m)((function(){return b}),(function(e){return b=e})),(0,i.m)((function(){return A}),(function(e){return A=e})),(0,i.m)((function(){return T}),(function(e){return T=e})));for(var I=0,E=[a,s,l,u,c,p,d,h,g,m,_,v,S,C,b,A,T,w];I<E.length;I++){var k=E[I];e.showElement(k)}for(var D=0,M=[a,s,l,c,d,h,m,_,S,b,A,T];D<M.length;D++){k=M[D];e.untruncateElement(k)}e.resetPosition(s),e.setHeaderScaleIndex(y,0),e.ensureNoHeaderItemsOverlap(a,s,l,u,c,p,d,h,g,m,_,f,y,v,S,C,b,A,T,w,o,r),e.adjustBreadcrumbDisplay(p,d)},e.scaleNonCuiHeaders=function(t,n){e.scaleHeaderCore(t,null,n,!1)},e.adjustBreadcrumbDisplay=function(e,t){e&&t&&(e.style.marginTop=(t.offsetHeight-e.offsetHeight)/2+"px")},e.findHeaderItems=function(t,n,i,o,a,s,l,u,c,d,h,g,m){for(var _=0;t&&_<t.childNodes.length;_++){var f=t.childNodes[_],y=p.s.getDOMElementClassName(f),v=!!f.id;-1!==y.indexOf("cui-QATRowLeft")?n.val=f:-1!==y.indexOf("cui-QATRowCenter")?i.val=f:-1!==y.indexOf("cui-QATRowRight")?o.val=f:-1!==y.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?a.val=f:f.id===r.CuiHelper.breadcrumbBrandId?s.val=f:f.id===r.CuiHelper.folderSeparatorId?l.val=f:f.id===r.CuiHelper.breadcrumbFolderId?u.val=f:f.id===r.CuiHelper.breadcrumbTitleId?c.val=f:v&&e.isElementTopRightActionButton(f)?d.val=f:-1!==y.indexOf("UsernameNameContainer")?h.val=f:-1!==y.indexOf("UsernameNameItem")?g.val=f:-1!==y.indexOf("FreemiumUpsellButton")&&(m.val=f),e.findHeaderItems(f,n,i,o,a,s,l,u,c,d,h,g,m)}},e.findTopBar2Items=function(t,n,i,o,a,s,l,u,c){for(var d=0;t&&d<t.childNodes.length;d++){var h=t.childNodes[d],g=p.s.getDOMElementClassName(h),m=!!h.id;-1!==g.indexOf("cui-jewel-container")?n.val=h:-1!==g.indexOf("cui-tts")?i.val=h:-1!==g.indexOf("cui-TabRowInline")?a.val=h:-1!==g.indexOf("cui-TabRowRight")?c.val=h:-1!==g.indexOf("cui-separator")?o.val=h:m&&h.id.startsWith(r.CuiHelper.openInClientButtonId)&&!s.val?s.val=h:m&&h.id.startsWith(r.CuiHelper.feedbackButtonId)?l.val=h:m&&h.id.startsWith(r.CuiHelper.peoplesWellControlId)&&(u.val=h),e.findTopBar2Items(h,n,i,o,a,s,l,u,c)}},e.scaleBottomRowItems=function(t,n,i,r,o,a,s,l,u){e.relativeLayoutAwry(t,n,u)&&(e.headerScaleDown(n),e.relativeLayoutAwry(t,n,u)&&e.headerScaleDown(n)),e.relativeLayoutAwry(n,r,u)&&(e.hideElement(i),e.hideElement(o),e.relativeLayoutAwry(n,r,u)&&(e.headerScaleDown(n),e.relativeLayoutAwry(n,r,u)&&(e.headerScaleDown(n),e.relativeLayoutAwry(n,r,u)&&e.hideElement(r)))),e.relativeLayoutAwry(r,l,u)&&(e.hideElement(i),e.hideElement(o));var c=[a,s,l];e.hideElementsIfContainerControlsOverlap(r,l,c,u),e.hideElementsIfContainerControlsOverlap(n,l,c,u)},e.hideElementsIfContainerControlsOverlap=function(t,n,i,r){for(var o=0;o<i.length&&e.relativeLayoutAwry(t,n,r);)e.hideElement(i[o]),o++},e.getScaleStep=function(e){if(!e)return 0;if(void 0===e._scaleStep||null===e._scaleStep){var t=0;-1!==e.className.indexOf("cui-tts-scale1")?t=1:-1!==e.className.indexOf("cui-tts-scale2")&&(t=2),e._scaleStep=t}return parseInt(e._scaleStep)},e.headerScaleDown=function(t){var n=e.getScaleStep(t);n<2&&e.setHeaderScaleIndex(t,++n)},e.headerScaleUp=function(t){var n=e.getScaleStep(t);n>0&&e.setHeaderScaleIndex(t,--n)},e.setHeaderScaleIndex=function(t,n){t&&(t.className=e.ribbonHeaderScaleClasses[n],t._scaleStep=n)},e.relativeLayoutAwry=function(e,t,n){return!(!e||!t)&&c.g.leftBoundsOverlapsRightBounds(c.g.getElementBounds(e),c.g.getElementBounds(t),n)},e.overlapAmount=function(e,t,n){var i=0;return e&&t&&(i=c.g.leftBoundsOverlapsRightBoundsByAmount(c.g.getElementBounds(e),c.g.getElementBounds(t),n)),i},e.contextualTabsVisible=function(e){for(var t=0;e&&t<e.childNodes.length;t++){if(-1!==e.childNodes[t].className.indexOf("cui-cg"))return!0}return!1},e.getFirstContextualTabSet=function(e){for(var t=null,n=e.childNodes.length-1;e&&n>=0;n--){var i=e.childNodes[n];if(-1===i.className.indexOf("cui-cg"))break;t=i}return t},e.truncateElement=function(t,n,i){if(t&&!e.isHidden(t)){for(var r=u.o.getCurrentStyle(t),o=p.s.parseCssSize(r.paddingLeft)+p.s.parseCssSize(r.paddingRight),a=t.offsetWidth-i-o,s=n,l=0;s&&s!==t;)(r=u.o.getCurrentStyle(s))&&(l+=p.s.parseCssSize(r.paddingLeft)+p.s.parseCssSize(r.paddingRight)),s=s.parentNode;a=Math.max(a,75+l),t.style.width=a+"px"}},e.repositionElement=function(t,n,r){if(t&&n){var o=0,a=0;c.g.getElementAbsolutePosition(n,(0,i.m)((function(){return o}),(function(e){return o=e})),(0,i.m)((function(){return a}),(function(e){return a=e})));var s=r?o-t.offsetWidth:o+n.offsetWidth;e.moveElement(t,s)}},e.ensureNoHeaderItemsOverlap=function(t,n,i,r,o,a,s,l,u,c,p,d,h,g,m,_,f,y,v,S,C,b){C&&e.scaleBottomRowItems(d,h,g,m,_,f,y,v,b),e.contextualTabsVisible(h)?e.scaleTopRowItemsAroundContextualTabs(h,t,n,i,r,o,a,s,l,u,c,p,S,b):e.scaleTopRowItems(t,n,i,r,o,a,s,l,u,c,p,S,b)},e.scaleTopRowItems=function(t,n,i,r,o,a,s,l,u,c,p,d,h){var g=!!o,m=!!s,_=!!l,f=0;if((m||_)&&(f=e.overlapAmount(t,n,h))>0){var y=m;_&&(!m||l.offsetWidth>s.offsetWidth)&&(y=!1),e.truncateElement(y?s:l,y?s:l,y?f:2*f),m&&_&&(f=e.overlapAmount(t,n,h))>0&&e.truncateElement(y?s:l,y?s:l,y?f:2*f)}(m&&e.relativeLayoutAwry(s,n,h)||g&&e.relativeLayoutAwry(o,n,h))&&(e.hideElement(r),e.hideElement(o),e.hideElement(a),e.hideElement(s),_&&(e.untruncateElement(n),e.untruncateElement(l))),e.remedyCenterAndRightOverlap(n,i,l,u,c,p,d,h),_&&e.capElementWidth(l,t,i,h)},e.scaleTopRowItemsAroundContextualTabs=function(t,n,i,r,o,a,s,l,u,c,p,d,h,g){var m=!!l,_=!!u,f=!!c,y=!!h,v=e.getFirstContextualTabSet(t),S=0;(S=e.overlapAmount(n,v,g))>0&&(m&&e.truncateElement(l,l,S),m&&!e.relativeLayoutAwry(l,v,g)||(e.hideElement(o),e.hideElement(a),e.hideElement(s),e.hideElement(l))),e.relativeLayoutAwry(t,i,g)&&e.repositionElement(i,t,g),e.remedyCenterAndRightOverlap(i,r,u,c,p,d,h,g),(S=e.overlapAmount(t,r,g))>0&&(e.truncateElement(p,d,S),y&&e.relativeLayoutAwry(t,r,g)&&e.hideElement(h),f&&e.relativeLayoutAwry(t,r,g)&&e.hideElement(c)),_&&!e.isHidden(i)&&e.capElementWidth(u,t,r,g)},e.remedyCenterAndRightOverlap=function(t,n,i,r,o,a,s,l){var u=!!i,c=!!r,p=!!o,d=!!s,h=0;if((u||p)&&(h=e.overlapAmount(t,n,l))>0){var g=!!t&&"absolute"!==t.style.position,m=u;p&&(!u||o.offsetWidth>i.offsetWidth)&&(m=!1),e.truncateElement(m?i:o,m?i:a,m&&g?2*h:h),u&&p?((h=e.overlapAmount(t,o,l))>0&&(m=!m,e.truncateElement(m?i:o,m?i:a,m&&g?2*h:h)),e.relativeLayoutAwry(t,o,l)&&e.hideElement(t)):u&&e.relativeLayoutAwry(t,n,l)&&e.hideElement(t)}d&&e.relativeLayoutAwry(t,n,l)&&e.hideElement(s),c&&e.relativeLayoutAwry(t,n,l)&&e.hideElement(r)},e.isHidden=function(e){if(!e)return!0;var t=e._isHidden;return!(null==t||"0"===t)},e.hideElement=function(t){t&&!e.isHidden(t)&&(t.style.display="none",t._isHidden="1")},e.showElement=function(t){t&&e.isHidden(t)&&(t.style.display="",t._isHidden="0")},e.untruncateElement=function(e){e&&(e.style.width="auto",e.style.maxWidth="none")},e.moveElement=function(e,t){e&&(e.style.position="absolute",e.style.left=t+"px")},e.resetPosition=function(e){e&&(e.style.position="static",e.style.left="auto")},e.capElementWidth=function(t,n,i,r){if(t&&t.parentNode&&t.parentNode.parentNode){var o=e.peripheralOffsetWithElement(t);if("auto"!==t.parentNode.style.width){var a=t.parentNode.offsetWidth-o;t.style.width=a+"px"}var s=r?i:n,l=r?n:i,u=c.g.getElementBounds(t.parentNode.parentNode),p=s?c.g.getElementBounds(s):new Sys.UI.Bounds(u.x,0,0,0),d=l?c.g.getElementLocation(l):new Sys.UI.Point(u.x+u.width,0),h=0;if("absolute"===t.parentNode.style.position)h=d.x-(p.x+p.width)-o-1;else{var g=c.g.getElementBounds(t.nextSibling?t.parentNode:t),m=g.x+g.width/2;h=2*Math.min(m-(p.x+p.width),d.x-m)-o-1}t.style.maxWidth=h+"px"}},e.peripheralOffsetWithElement=function(e){for(var t=u.o.getCurrentStyle(e),n=t?p.s.parseCssSize(t.paddingLeft)+p.s.parseCssSize(t.paddingRight):0,i=u.o.getCurrentStyle(e.parentNode),r=i?p.s.parseCssSize(i.paddingLeft)+p.s.parseCssSize(i.paddingRight):0,o=0,a=e;a.nextSibling;)o+=(a=a.nextSibling).offsetWidth;return n+r+o},e.isElementTopRightActionButton=function(e){return!!e.id&&(e.id.startsWith(r.CuiHelper.shareButtonId)||e.id.startsWith(o.s)||e.id.startsWith(r.CuiHelper.replyWithChangesButtonId)||e.id.startsWith(a.b.workflowButtonId))},e.ribbonHeaderScaleClasses=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"],e}();(0,d.l)(h,"RibbonTabScalingActor",null,[])},,function(e,t,n){"use strict";var i=n(508),r=n(208),o=n(160),a=n(488),s=n(134),l=n(951),u=n(268),c=n(184),p=n(920),d=function(e){function t(t,n,i){var r=e.call(this,t,n)||this;return r.elmSelectedItem=null,r.elmSelectedItem=i,r}return(0,i.t)(t,e),t}(p.d);(0,r.l)(d,"DropDownComponentDom",p.d,[]);var h=n(697),g=n(513),m=n(946);n.d(t,{p:function(){return _}});var _=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.dropDownDom=null,o._selectedControl=null,o.addDisplayMode("Medium"),o.addDisplayMode("MenuTellMe"),o.addDisplayMode("Small"),o.get_stateProperties()[c.v.SelectedItemId]=null,o}return(0,i.t)(t,e),t.prototype.get_dropDownDom=function(){return this.dropDownDom},t.prototype.get_additionalMenuCssClass=function(){return"cui-dd-menu"},t.prototype.get_propertiesAlt=function(){return g.x(this.get_properties$2().Alt)?g.d:this.get_properties$2().Alt},t.prototype.createComponentDomForDisplayMode=function(e){var t,n,i,r,o;(t=m.n.createElement("span")).className="cui-dd",t.setAttribute("mscui:controltype",this.get_controlType()),m.n.addToTabLoop(t),(n=m.n.createElement("span")).className="cui-dd-text",n.style.width=this.isSmallWidth(e)?this.get_properties$2().SmallWidth:this.get_properties$2().Width,n.setAttribute(s.t.ariaHiddenAttribute,s.t.ariaTrueValue);var a=this.get_stateProperties()[c.v.SelectedItemId];if(!g.x(a))this.selectDropdownItemById(a);return(i=m.n.createElement("a")).setAttribute(s.t.ariaHiddenAttribute,s.t.ariaTrueValue),m.n.ensureCSSClassOnElement(i,"cui-dd-arrow-button"),i.id=this.get_id(),r=m.n.createElement("img"),o=this.get_isVisualRefreshEnabled()?m.n.createClusteredImageContainerNew(2,this.get_root().get_properties().ImageDownArrow8by8,this.get_root().get_properties().ImageDownArrow8by8Class,r,!0,!1):m.n.createClusteredImageContainerNew(1,this.get_root().get_properties().ImageDownArrow,this.get_root().get_properties().ImageDownArrowClass,r,!0,!1),i.setAttribute("title",this.get_propertiesAlt()),n.title=this.get_propertiesAlt(),r.alt=this.get_propertiesAlt(),t.appendChild(n),t.appendChild(i),i.appendChild(o),this.dropDownDom=new d(e,t,n),this.get_dropDownDom()},t.prototype.setInitialAriaMenuLauncherAttributes=function(t){s.t.setAriaAttribute(t,s.t.ariaRoleAttribute,this.get_ariaRole()),e.prototype.setInitialAriaMenuLauncherAttributes.call(this,t)},t.prototype.get_controlType=function(){return l.Control.dropDownControlType},t.prototype.get_selectedControl=function(){return this._selectedControl},t.prototype.selectDropdownItem=function(e){if(this.get_selectedControl()!==e){this._selectedControl=e,this.get_stateProperties()[c.v.SelectedItemId]=e.getMenuItemId();var t=e.getTextValue(),n=m.n.createElement("a");if(n.innerText=t,this.get_dropDownDom()&&this.get_dropDownDom().elmSelectedItem){var i=this.get_dropDownDom().elmSelectedItem;if(i.hasChildNodes()){var r=i.firstChild;i.replaceChild(n,r)}else i.appendChild(n);s.t.setAriaAttribute(this.get_dropDownDom().elmControl,s.t.ariaLabelAttribute,this.get_propertiesAlt()+" "+t)}}},t.prototype.getItemById=function(e,t){var n;if(r.r(u.r,e)){var i=e;if(r.r(o.a,i.get_control())){var a=i.get_control();if(a.getMenuItemId()===t)return a}}var s=e.get_children();if(!g.x(s))for(var l=s.getEnumerator();l.moveNext();){var c=l.get_current();if(n=this.getItemById(c,t))return n}return null},t.prototype.executeDropdownItem=function(e,t,n,i,r){return!1},t.prototype.selectDropdownItemById=function(e){var t=!1;if(!g.x(e)&&!g.x(this.get_menu())){var n=this.getItemById(this.get_menu(),e);g.x(n)||(this.selectDropdownItem(n),t=!0)}return t},t.prototype.get_properties$2=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t.prototype.constructClonedMenuLauncherForMenu=function(e,t,n){return new h.FlyoutAnchor(e,this.get_id(),t,n)},t.prototype.isSmallWidth=function(e){return!g.x(this.get_properties$2().SmallWidth)&&e.startsWith("Small")},t}(a.MenuLauncher);(0,r.l)(_,"DropDown",a.MenuLauncher,[])},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,{UISurfaces:function(){return l}});var i=n(568),r=n(254),o=n(327),a=n(235),s=n(208),l=function(){function e(){}return e.setAppChromeProvider=function(t){e._appChromeProvider=t},e.setAppChromeProviderDelegate=function(t){e._appChromeProviderDelegate=t},e.isLoaded=function(){return!!e._uiSurfacesAPI},e.isDialogAPILoaded=function(){return!!e._dialogAPI},e.getUISurfacesAPI=function(){return appChrome.loadUISlice20().then((function(t){return e._uiSurfacesAPI=t,t}))},e.loadScripts=function(){if(e.isLoaded())return Promise.resolve(e._uiSurfacesAPI);if(e._appChromeProvider)return e._appChromeProvider.then((function(t){return e.getUISurfacesAPI()}));if(e._appChromeProviderDelegate)return e._appChromeProviderDelegate().then((function(t){return e.getUISurfacesAPI()}));var t=a.w.get_instance().resolve(i.d).getScriptLoader();return t.loadScript("appChrome").then((function(n){return r.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()||o.initializeAppChrome(t),e.getUISurfacesAPI()}))},e.getContextualAPIAsync=function(){return e.loadScripts().then((function(t){return e._uiSurfacesAPI.contextualUI}))},e.getTaskPaneAPIAsync=function(){return e.loadScripts().then((function(t){return e._uiSurfacesAPI.taskPane}))},e.getDialogAPIAsync=function(){return e.loadScripts().then((function(t){return e._dialogAPI=e._uiSurfacesAPI.dialog,e._dialogAPI}))},e.getStatusBarAPIAsync=function(){return e.loadScripts().then((function(t){return e._statusBarAPI=e._uiSurfacesAPI.statusBar,e._statusBarAPI}))},e.getMessageBarAPIAsync=function(){return e.loadScripts().then((function(t){return e._messageBarAPI=e._uiSurfacesAPI.messageBar,e._messageBarAPI}))},e.getDictationFloatieUIAsync=function(){return e.loadScripts().then((function(t){return e._uiSurfacesAPI.dictationFloatieUI}))},e.getNotificationsAPIAsync=function(){return e.notificationsApi||(e.notificationsApi=e.loadScripts().then((function(t){var n=document.createElement("div");return r.AFrameworkApplication.get_activeFrame().get_element().appendChild(n),t.notifications.initializeCalloutNotifications(n),e._uiSurfacesAPI.notifications}))),e.notificationsApi},e.getRulerAPI=function(){return e.loadScripts().then((function(t){return e._rulerAPI=e._uiSurfacesAPI.ruler,e._rulerAPI}))},e._uiSurfacesAPI=null,e._dialogAPI=null,e._statusBarAPI=null,e._messageBarAPI=null,e._appChromeProvider=null,e._appChromeProviderDelegate=null,e._rulerAPI=null,e.notificationsApi=null,e}();(0,s.l)(l,"UISurfaces",null,[])},function(e,t,n){"use strict";n.d(t,{d:function(){return a}});var i=n(508),r=n(208),o=n(255),a=function(e){function t(){var t=e.call(this)||this;return t._responseAvailable=!1,t._timer=0,t._timedOut=!1,t._aborted=!1,t._started=!1,t._xmlHttpRequest=null,t}return(0,i.t)(t,e),t.prototype.clearTimer=function(){this._timer&&(window.clearTimeout(this._timer),this._timer=0)},t.prototype.onTimeout=function(){this.get_responseAvailable()||(this.clearTimer(),this._timedOut=!0,this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest.abort(),this.get_webRequest().completed(Sys.EventArgs.Empty),this._xmlHttpRequest=null)},t.prototype.debugSendTraceTag=function(e,t,n,i){for(var r=[],a=4;a<arguments.length;a++)r[a-4]=arguments[a];o.ULS.sendTraceTag.apply(null,[e,t,n,i].concat(r))},t.prototype.onReadyStateChange=function(){if(4===this._xmlHttpRequest.readyState){try{if(void 0===this._xmlHttpRequest.status)return}catch(e){return}this.clearTimer(),this._responseAvailable=!0,this.get_webRequest().completed(Sys.EventArgs.Empty),this._xmlHttpRequest&&(this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest=null)}},t.prototype.verifyRequestValidity=function(e){if(this._started)throw Error.invalidOperation(String.format(Sys.Res.cannotCallOnceStarted,"executeRequest"));if(!e)throw Error.argumentNull("webRequest",Sys.Res.nullWebRequest)},t.prototype.setResponseType=function(e){(e&&window.navigator.userAgent.indexOf("IEMobile/11")>=0||Sys.Browser.agent===Sys.Browser.InternetExplorer&&"undefined"!=typeof window.document.documentMode&&window.document.documentMode>=10)&&(this._xmlHttpRequest.responseType="msxml-document",this._xmlHttpRequest.responseType||o.ULS.sendTraceTag(50406866,200,10,"BaseXMLHttpExecutor.SetResponseType: Failed to set to msxml-document."))},t.prototype.processXMLHttpRequest=function(e){var t=e.get_body(),n=e.get_headers();if(n)for(var i in n){var o={key:i,value:n[i]};"function"!=typeof o.value&&this._xmlHttpRequest.setRequestHeader(o.key,o.value)}"post"===e.get_httpVerb().toLowerCase()&&(n&&n["Content-Type"]||this._xmlHttpRequest.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),t=t||"");var a=e.get_timeout();a>0&&(this._timer=window.setTimeout(r.i(this,this.onTimeout,"onTimeout"),a)),this._xmlHttpRequest.send(t),this._started=!0},t.prototype.get_aborted=function(){return this._aborted},t.prototype.get_responseAvailable=function(){return this._responseAvailable},t.prototype.get_started=function(){return this._started},t.prototype.get_timedOut=function(){return this._timedOut},t.prototype.getResponseHeader=function(e){var t=null;try{t=this._xmlHttpRequest.getResponseHeader(e)}catch(e){}return t=t||""},t.prototype.getAllResponseHeaders=function(){return this._xmlHttpRequest.getAllResponseHeaders()},t.prototype.get_responseData=function(){return this._xmlHttpRequest.responseText},t.prototype.get_statusCode=function(){try{return this._xmlHttpRequest.status}catch(e){return 0}},t.prototype.get_statusText=function(){return this._xmlHttpRequest.statusText},t.prototype.get_xml=function(){var e=this._xmlHttpRequest.responseXML;if(e&&e.documentElement)-1!==window.navigator.userAgent.indexOf("MSIE")&&"undefined"!=typeof e.setProperty&&e.setProperty("SelectionLanguage","XPath");else if(!(e=Sys.Net.XMLDOM(this._xmlHttpRequest.responseText))||!e.documentElement)return null;return"http://www.mozilla.org/newlayout/xml/parsererror.xml"===e.documentElement.namespaceURI&&"parsererror"===e.documentElement.tagName?null:e.documentElement.firstChild&&"parsererror"===e.documentElement.firstChild.tagName?null:e},t.prototype.abort=function(){this._aborted||this._responseAvailable||this._timedOut||(this._aborted=!0,this.clearTimer(),this._xmlHttpRequest&&!this._responseAvailable&&(this._xmlHttpRequest.onreadystatechange=Function.emptyFunction,this._xmlHttpRequest.abort(),this._xmlHttpRequest=null,this.get_webRequest().completed(Sys.EventArgs.Empty)))},t}(Sys.Net.WebRequestExecutor);(0,r.l)(a,"BaseXMLHttpExecutor",Sys.Net.WebRequestExecutor,[])},function(e,t,n){var i=n(950);e.exports=!i((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var i=(0,n(208).y)("IStopwatchBuilder")},function(e,t,n){"use strict";n.d(t,{h:function(){return i},r:function(){return r},o:function(){return o}});var i=function(e,t,n){return e.endsWith(t)},r=function(e,t,n){return e.startsWith(t)},o=function(e){return e.toUpperCase()}},,,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(273),o=n(164),a=n(825),s=n(495),l=n(208),u=function(){function e(){}return e.defineProperty=function(e,t,n,i){var l=new o.t(a.u(e,t,s.y.getStorageType(n)),n,i);return r.h.get_instance().registerProperty(l),l},e}();(0,l.l)(u,"APropertySpace",null,[]),n.d(t,{CommonProperties:function(){return c}});var c=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.$$cctor=function(){},t.ensureLoaded=function(){},t.defineProperty$1=function(e,t){return u.defineProperty(2,e,t,0)},t.nil=t.defineProperty$1(0,s.y.nil),t.noData=t.defineProperty$1(1,s.y.noData),t.bool=t.defineProperty$1(2,s.y.bool),t.oneByteOfData=t.defineProperty$1(3,s.y.oneByte),t.twoBytesOfData=t.defineProperty$1(4,s.y.twoBytes),t.fourBytesOfData=t.defineProperty$1(5,s.y.fourBytes),t.eightBytesOfData=t.defineProperty$1(6,s.y.eightBytes),t.fourBytesOfLengthFollowedByData=t.defineProperty$1(7,s.y.byteArray),t.objectId=t.defineProperty$1(8,s.y.objectId),t.arrayOfObjectIds=t.defineProperty$1(9,s.y.arrayOfObjectIds),t.objectSpaceId=t.defineProperty$1(10,s.y.objectSpaceId),t.arrayOfObjectSpaceIds=t.defineProperty$1(11,s.y.arrayOfObjectSpaceIds),t.contextId=t.defineProperty$1(12,s.y.contextId),t.arrayOfContextIds=t.defineProperty$1(13,s.y.arrayOfContextIds),t.reserved14=t.defineProperty$1(14,s.y.reserved14),t.reserved15=t.defineProperty$1(15,s.y.reserved15),t.arrayOfPropertyValues=t.defineProperty$1(16,s.y.arrayOfPropertyValues),t.propertySet=t.defineProperty$1(17,s.y.propertySet),t.iUnknown=t.defineProperty$1(18,s.y.iUnknown),t.iUnknownInPropertySet=t.defineProperty$1(19,s.y.iUnknownInPropertySet),t.reserved20=t.defineProperty$1(20,s.y.reserved20),t.reserved21=t.defineProperty$1(21,s.y.reserved21),t.reserved22=t.defineProperty$1(22,s.y.reserved22),t.reserved23=t.defineProperty$1(23,s.y.reserved23),t.reserved24=t.defineProperty$1(24,s.y.reserved24),t.reserved25=t.defineProperty$1(25,s.y.reserved25),t.reserved26=t.defineProperty$1(26,s.y.reserved26),t.reserved27=t.defineProperty$1(27,s.y.reserved27),t.reserved28=t.defineProperty$1(28,s.y.reserved28),t.reserved29=t.defineProperty$1(29,s.y.reserved29),t.reserved30=t.defineProperty$1(30,s.y.reserved30),t.conflict=t.defineProperty$1(31,s.y.conflict),t.reportingCustomData1=t.defineProperty$1(32,s.y.uInt_32),t.reportingCustomData2=t.defineProperty$1(33,s.y.uInt_32),t.maxPropertyIndex=33,t}(u);(0,l.l)(c,"CommonProperties",u,[]),c.$$cctor()},,function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var i=(0,n(208).y)("IJavascriptErrorReporterFactory")},,function(e,t,n){"use strict";n.d(t,{v:function(){return o}});var i=n(425),r=n(208),o=function(){function e(){}return e.get_vK_SemiColon=function(){return i.y.get_isFirefox()?59:186},e.get_vK_EqualSign=function(){return i.y.get_isFirefox()?61:187},e.get_vK_Hyphen=function(){return i.y.get_isFirefox()?173:189},e.get_keyCodePairs=function(){return e._keyCodePairs||(e._keyCodePairs={undefined:e.vK_UNDEFINED,backspace:e.vK_Backspace,tab:e.vK_Tab,enter:e.vK_Enter,shift:e.vK_Shift,control:e.vK_Control,ctrl:e.vK_Ctrl,alt:e.vK_Alt,pause:e.vK_Pause,capslock:e.vK_CapsLock,esc:e.vK_Esc,escape:e.vK_Escape,space:e.vK_Space,spacebar:e.vK_Spacebar,pageup:e.vK_PageUp,pagedown:e.vK_PageDown,end:e.vK_End,home:e.vK_Home,left:e.vK_Left,leftarrow:e.vK_LeftArrow,up:e.vK_Up,uparrow:e.vK_UpArrow,right:e.vK_Right,rightarrow:e.vK_RightArrow,down:e.vK_Down,downarrow:e.vK_DownArrow,ins:e.vK_Ins,insert:e.vK_Insert,0:e.vK_0,1:e.vK_1,2:e.vK_2,3:e.vK_3,4:e.vK_4,5:e.vK_5,6:e.vK_6,7:e.vK_7,8:e.vK_8,9:e.vK_9,a:e.vK_A,b:e.vK_B,c:e.vK_C,d:e.vK_D,e:e.vK_E,f:e.vK_F,g:e.vK_G,h:e.vK_H,i:e.vK_I,j:e.vK_J,k:e.vK_K,l:e.vK_L,m:e.vK_M,n:e.vK_N,o:e.vK_O,p:e.vK_P,q:e.vK_Q,r:e.vK_R,s:e.vK_S,t:e.vK_T,u:e.vK_U,v:e.vK_V,w:e.vK_W,x:e.vK_X,y:e.vK_Y,z:e.vK_Z,windows:e.vK_Windows,openapple:e.vK_OpenApple,meta:e.vK_Meta,contextmenu:e.vK_ContextMenu,numpad0:e.vK_NumPad0,numpad1:e.vK_NumPad1,numpad2:e.vK_NumPad2,numpad3:e.vK_NumPad3,numpad4:e.vK_NumPad4,numpad5:e.vK_NumPad5,numpad6:e.vK_NumPad6,numpad7:e.vK_NumPad7,numpad8:e.vK_NumPad8,numpad9:e.vK_NumPad9,numpadmultiply:e.vK_NumPadMultiply,numpadplus:e.vK_NumPadPlus,numpadminus:e.vK_NumPadMinus,numpaddot:e.vK_NumPadDot,numpaddivide:e.vK_NumPadDivide,f1:e.vK_F1,f2:e.vK_F2,f3:e.vK_F3,f4:e.vK_F4,f5:e.vK_F5,f6:e.vK_F6,f7:e.vK_F7,f8:e.vK_F8,f9:e.vK_F9,f10:e.vK_F10,f11:e.vK_F11,f12:e.vK_F12,del:e.vK_Del,delete:e.vK_Delete,numlock:e.vK_NumLock,scrolllock:e.vK_ScrollLock,printscreen:e.vK_PrintScreen,semicolon:e.get_vK_SemiColon(),equalsign:e.get_vK_EqualSign(),comma:e.vK_Comma,dash:e.vK_Dash,hyphen:e.get_vK_Hyphen(),period:e.vK_Period,slash:e.vK_Slash,backquote:e.vK_BackQuote,leftbracket:e.vK_LeftBracket,backslash:e.vK_BackSlash,rightbracket:e.vK_RightBracket,singlequote:e.vK_SingleQuote,f13:e.vK_F13,f14:e.vK_F14,f15:e.vK_F15,f16:e.vK_F16,f17:e.vK_F17,f18:e.vK_F18,f19:e.vK_F19,f20:e.vK_F20,f21:e.vK_F21,f22:e.vK_F22,f23:e.vK_F23,f24:e.vK_F24})},e.fromString=function(t){var n=e.get_keyCodePairs()[t];return n||0},e.isAlphanumericKeyCode=function(e){return e>=48&&e<=57||e>=65&&e<=90},e.vK_UNDEFINED=0,e.vK_Backspace=8,e.vK_Tab=9,e.vK_Enter=13,e.vK_Shift=16,e.vK_Control=17,e.vK_Ctrl=17,e.vK_Alt=18,e.vK_Pause=19,e.vK_CapsLock=20,e.vK_RightCtrl=25,e.vK_Esc=27,e.vK_Escape=27,e.vK_Space=32,e.vK_Spacebar=32,e.vK_PageUp=33,e.vK_PageDown=34,e.vK_End=35,e.vK_Home=36,e.vK_Left=37,e.vK_LeftArrow=37,e.vK_Up=38,e.vK_UpArrow=38,e.vK_Right=39,e.vK_RightArrow=39,e.vK_Down=40,e.vK_DownArrow=40,e.vK_Ins=45,e.vK_Insert=45,e.vK_0=48,e.vK_1=49,e.vK_2=50,e.vK_3=51,e.vK_4=52,e.vK_5=53,e.vK_6=54,e.vK_7=55,e.vK_8=56,e.vK_9=57,e.vK_A=65,e.vK_B=66,e.vK_C=67,e.vK_D=68,e.vK_E=69,e.vK_F=70,e.vK_G=71,e.vK_H=72,e.vK_I=73,e.vK_J=74,e.vK_K=75,e.vK_L=76,e.vK_M=77,e.vK_N=78,e.vK_O=79,e.vK_P=80,e.vK_Q=81,e.vK_R=82,e.vK_S=83,e.vK_T=84,e.vK_U=85,e.vK_V=86,e.vK_W=87,e.vK_X=88,e.vK_Y=89,e.vK_Z=90,e.vK_Windows=91,e.vK_OpenApple=91,e.vK_Meta=91,e.vK_ContextMenu=93,e.vK_NumPad0=96,e.vK_NumPad1=97,e.vK_NumPad2=98,e.vK_NumPad3=99,e.vK_NumPad4=100,e.vK_NumPad5=101,e.vK_NumPad6=102,e.vK_NumPad7=103,e.vK_NumPad8=104,e.vK_NumPad9=105,e.vK_NumPadMultiply=106,e.vK_NumPadPlus=107,e.vK_NumPadMinus=109,e.vK_NumPadDot=110,e.vK_NumPadDivide=111,e.vK_F1=112,e.vK_F2=113,e.vK_F3=114,e.vK_F4=115,e.vK_F5=116,e.vK_F6=117,e.vK_F7=118,e.vK_F8=119,e.vK_F9=120,e.vK_F10=121,e.vK_F11=122,e.vK_F12=123,e.vK_Del=127,e.vK_Delete=127,e.vK_NumLock=144,e.vK_ScrollLock=145,e.vK_PrintScreen=154,e.vK_Comma=188,e.vK_Dash=189,e.vK_Period=190,e.vK_Slash=191,e.vK_BackQuote=192,e.vK_LeftBracket=219,e.vK_BackSlash=220,e.vK_RightBracket=221,e.vK_SingleQuote=222,e.vK_IME=229,e.vK_INVALID_BEGIN=256,e.vK_INVALID_END=61439,e.vK_F13=61440,e.vK_F14=61441,e.vK_F15=61442,e.vK_F16=61443,e.vK_F17=61444,e.vK_F18=61445,e.vK_F19=61446,e.vK_F20=61447,e.vK_F21=61448,e.vK_F22=61449,e.vK_F23=61450,e.vK_F24=61451,e._keyCodePairs=null,e}();(0,r.l)(o,"KeyCode",null,[])},,,function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var i=n(208),r=function(){function e(){}return e.searchFocusID="search",e}();(0,i.l)(r,"SearchManagerConstants",null,[])},function(e,t,n){"use strict";n.d(t,{l:function(){return i}});var i=(0,n(208).y)("IRoot")},,,function(e,t,n){"use strict";n.d(t,{TF:function(){return i},Fc:function(){return r},dH:function(){return o},o:function(){return a},eN:function(){return s},Vu:function(){return l},MO:function(){return u},ts:function(){return c},CD:function(){return p}});var i=201,r=403,o=406,a=404,s=200,l=412,u=408,c=function(e){return e>=400&&e<=499},p=function(e){return e>=500&&e<=599}},,,function(e,t,n){var i=n(57),r=n(12),o=n(560);e.exports=i?function(e,t,n){return r.f(e,t,o(1,n))}:function(e,t,n){return e[t]=n,e}},function(e,t,n){"use strict";n.d(t,{k:function(){return a}});var i=n(508),r=n(23),o=n(208),a=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.suppressError=function(t){return!t.source||e.prototype.suppressError.call(this,t)},t}(r.p);(0,o.l)(a,"WordViewerErrorHandler",r.p,[])},function(e,t,n){"use strict";n.d(t,{r:function(){return r}});var i=n(208),r=function(){function e(){}return e.meControlFlexPaneFocusId="ReactSharedHeaderMeControlFlexPane",e.headerUiFocusId="headerui",e.chatFocusId="chat_wrapper_pane",e}();(0,i.l)(r,"ReactSharedHeaderConstants",null,[])},function(e){e.exports=function(e,t,n){if(!(e instanceof t))throw TypeError("Incorrect "+(n?n+" ":"")+"invocation");return e}},,,function(e,t,n){var i=n(950),r=/#|\.prototype\./,o=function(e,t){var n=s[a(e)];return n==u||n!=l&&("function"==typeof t?i(t):!!t)},a=o.normalize=function(e){return String(e).replace(r,".").toLowerCase()},s=o.data={},l=o.NATIVE="N",u=o.POLYFILL="P";e.exports=o},,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=(0,r.y)("IRibbonSQMInformation"),a=n(600),s=n(779),l=n(255),u=n(614),c=n(254),p=function(){function e(){}return e.tabId="TabId",e}();(0,r.l)(p,"RibbonSQMProperties",null,[]);var d=n(427),h=n(574),g=n(749),m=n(733),_=n(713),f=n(154),y=n(235),v=n(296),S=n(134),C=n(966),b=n(360),A=n(554),T=n(513),w=function(){function e(){this._maxGroupSizes=null,this._dirty=!0,this._steps=[],this._maxGroupSizes={}}return e.prototype.setGroupMaxSize=function(e,t){this._maxGroupSizes[e]=t,this._dirty=!0},e.prototype.removeGroupMaxSize=function(e){delete this._maxGroupSizes[e],this._dirty=!0},e.prototype.getGroupMaxSize=function(e){return this._maxGroupSizes[e]},e.prototype.addScalingStep=function(e,t){if(T.x(e))throw Error.create("step must be definined and not null");if(T.x(this._maxGroupSizes[e.get_groupId()]))throw Error.create("You must set the GroupMaxSize of Group: "+e.get_groupId()+" before you add ScalingSteps for it");this.addScalingStepAtIndex(e,t?0:this._steps.length)},e.prototype.addScalingStepAtIndex=function(e,t){if(Array.contains(this._steps,e))throw Error.create("This ScalingInfo already contains this ScaleStep");Array.insert(this._steps,t,e),e.setParent(this),this._dirty=!0},e.prototype.removeScalingStep=function(e){Array.remove(this._steps,e),e.setParent(null),this._dirty=!0},e.prototype.removeScalingStepWithGroupId=function(e){if(!T.x(e))for(var t=0,n=this._steps;t<n.length;t++){var i=n[t];if(i.get_groupId()===e){this.removeScalingStep(i);break}}},e.prototype.get_steps=function(){return Array.clone(this._steps)},e.prototype.get_stepsInternal=function(){return this._steps},e.prototype.get_dirty=function(){return this._dirty},e.prototype.set_dirty=function(e){return this._dirty=e,e},e}();(0,r.l)(w,"Scaling",null,[]);var I=n(946);n.d(t,{Tab:function(){return E}});var E=function(e){function t(t,n,i,r,o,a,s,l,u){var c=e.call(this,t,n,i,r,u)||this;return c._selected=!1,c._elmTitle=null,c._elmTitleA=null,c._elmTitleSpan=null,c._elmATText=null,c._lastScalingIndex=0,c._cssClass=null,c._contextual=!1,c._contextualGroupId=null,c._scalingInfo=null,c._lastScaleWidthHeight=null,c._scaledByCookie=!1,c._tabBodyMinWidth=0,c._lastTabDisplayTime=null,c._popupInvocationMethod=0,c._firstControl=null,c._lastControl=null,c._command=null,c._pendingDisplayTabTimeoutId=-1,c._pendingDismissTabTimeoutId=-1,c._lastScalingIndex=-1,c._scalingInfo=new w,c._contextual=a,c._contextualGroupId=s,c._command=o,c._cssClass=T.x(l)?"":l,a&&c.set_visibleInternal(!1),c}return(0,i.t)(t,e),t.prototype.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.ensureTitleRefreshed(),this.appendChildrenToElement(this.get_elementInternal()),e.prototype.refreshInternal.call(this)},t.prototype.attachTitleEvents=function(){d.s.get_instance().registerHandler(h.d.doubleClick,this._elmTitleA,r.i(this,this.onTitleDblClick,"onTitleDblClick")),m.z.get_instance().registerHandler(h.d.pointerDown,this._elmTitleA,r.i(this,this.onTitlePointerDown,"onTitlePointerDown")),g.KeyInputManager.get_instance().registerHandler(h.d.keyUp,this._elmTitleA,r.i(this,this.onTitleKeyUp,"onTitleKeyUp")),g.KeyInputManager.get_instance().registerHandler(h.d.keyPress,this._elmTitleA,r.i(this,this.onTitleKeyPress,"onTitleKeyPress"))},t.prototype.ensureDOMElement=function(){T.x(this.get_elementInternal())&&(e.prototype.ensureDOMElement.call(this),this.get_elementInternal().setAttribute("role","tabpanel"),S.t.setAriaAttribute(this.get_elementInternal(),"aria-labelledby",this.get_id()+"-title"))},t.prototype.addChildAtIndexInternal=function(t,n,i){n||(this._firstControl=null),n!==this.get_children().get_count()&&-1!==n||(this._lastControl=null),e.prototype.addChildAtIndexInternal.call(this,t,n,i)},t.prototype.removeChild=function(t){T.x(this.get_children().get_item(0))||this.get_children().get_item(0).get_id()!==t||(this._firstControl=null),T.x(this.get_children().get_item(this.get_children().get_count()-1))||this.get_children().get_item(this.get_children().get_count()-1).get_id()!==t||(this._lastControl=null),e.prototype.removeChild.call(this,t)},t.prototype.removeChildren=function(){this._firstControl=null,this._lastControl=null,e.prototype.removeChildren.call(this)},t.prototype.get_domElementTagName=function(){return"ul"},t.prototype.get_titleDOMElement=function(){return this._elmTitle},t.prototype.ensureTitleDOMElement=function(){T.x(this._elmTitle)&&(this._elmTitle=I.n.createElement("li"))},t.prototype.ensureHiddenATDOMElement=function(){T.x(this._elmATText)&&(this._elmATText=I.n.createElement("span"))},t.prototype.onTitleScale=function(e){T.x(this._elmTitle)||(this._elmTitle.title=e>=2?this.get_title():"")},t.prototype.onTabAttachedToRibbon=function(){for(var e=this.get_children().getEnumerator();e.moveNext();){e.get_current().onGroupAttachedToRibbon()}},t.prototype.ensureTitleRefreshed=function(){var e=" ";T.x(this._elmTitleA)?(this.ensureTitleDOMElement(),this._elmTitleA=I.n.createElement("a"),I.n.addToTabLoop(this._elmTitleA),this._elmTitleA.className="cui-tt-a",this._elmTitleA.setAttribute("role","tab"),this._elmTitle.appendChild(this._elmTitleA),this._elmTitleSpan=I.n.createElement("span"),this._elmTitleSpan.className="cui-tt-span",this._elmTitleA.appendChild(this._elmTitleSpan),this.attachTitleEvents()):(e+=this._elmTitle.className.indexOf("cui-ct-first")>-1?"cui-ct-first ":"",e=(e+=this._elmTitle.className.indexOf("cui-ct-last")>-1?"cui-ct-last":"").trimEnd()),this._elmTitle.className=this.getTitleCSSClassName()+e,this._elmTitle.id=this.get_id()+"-title",this._elmTitle.setAttribute("role","presentation"),S.t.setAriaAttribute(this._elmTitleA,S.t.ariaSelectedAttribute,this._selected?S.t.ariaTrueValue:S.t.ariaFalseValue),S.t.setAriaAttribute(this._elmTitleA,S.t.ariaExpandedAttribute,this._selected&&this.get_ribbon().get_tabShowing()?S.t.ariaTrueValue:S.t.ariaFalseValue),this._elmTitleSpan.innerText=this.get_title(),T.t(this.get_description())||this._elmTitleA.setAttribute("title",this.get_description()),this.ensureKeytip(this.get_keytipDomContainer(),this.get_keytipDomContainer(),C.v.ribbonShortcutId,"")},t.prototype.get_keytipDomContainer=function(){return this._elmTitleA},t.prototype.setContextualText=function(e,t,n,i,r){T.x(this._elmATText)&&this.ensureHiddenATDOMElement(),t=this.get_contextual()?String.format(t,n,i,r):String.format(e,i,r),this._elmATText.innerText=t,I.n.ensureCSSClassOnElement(this._elmATText,"cui-hidden"),this._elmTitleA.appendChild(this._elmATText)},t.prototype.resetTitleCSSClasses=function(){this._elmTitle.className=this.getTitleCSSClassName()},t.prototype.get_cssClass=function(){return this.getBodyCSSClassName()},t.prototype.get_selected=function(){return this._selected},t.prototype.set_selected=function(e){if(!this.get_visible())throw Error.create(String.format("Tabs must be visible and enabled in order to be selected. Id:{0}. Contextual:{1}. ContextualGroupId:{2}",this.get_id(),this._contextual,this._contextualGroupId));if(!e)throw Error.create("Selected cannot be set to false explicitly.\nSelecting another Tab will do this implicitly.");return this.get_needsDelayIniting()?(l.ULS.sendTraceTag(5256331,207,50,"Tab not available"),e):(this.get_ribbon().makeTabSelectedInternal(this),this.get_ribbon().refreshInternal(),this.get_lastScaleWidthHeight()!==this.get_ribbon().get_lastResizeWidthHeight()&&this.get_ribbon().scale(),this.pollIfRootPolledSinceLastPoll(),this.get_ribbon().get_tabPoppedUp()&&(1===this.get_popupInvocationMethod()?this.setFocusOnFirstControl():this.get_ribbon().setFocusOnTabContainer()),e)},t.prototype.rememberActiveTabId=function(){if(!T.x(this.get_ribbon().get_ribbonBuilder())&&!T.x(this.get_ribbon().get_ribbonBuilder().get_ribbonBuildOptions())&&!T.t(this.get_ribbon().get_ribbonBuilder().get_ribbonBuildOptions().clientID)){var e=document.getElementById(this.get_ribbon().get_ribbonBuilder().get_ribbonBuildOptions().clientID+"_activeTabId");e&&(e.value=this.get_id())}},t.prototype.setSelectedInternal=function(e,t){e&&this.rememberActiveTabId(),this._selected=e,this.onDirtyingChange(),t&&this.ensureTitleRefreshed()},t.prototype.ensureTabInitialized=function(){this.get_needsDelayIniting()&&this.doDelayedInit()},t.prototype.ensureCorrectChildType=function(e){if(!r.r(A.Group,e))throw Error.create("Only children of type Group can be added to Tab Components")},t.prototype.get_scaling=function(){return T.x(this._scalingInfo)&&(this._scalingInfo=new w),this._scalingInfo},t.prototype.get_currentScalingIndex=function(){return this._lastScalingIndex},t.prototype.get_lastScaleWidthHeight=function(){return this._lastScaleWidthHeight},t.prototype.set_lastScaleWidthHeight=function(e){return this._lastScaleWidthHeight=e,e},t.prototype.scaleMax=function(){this.scaleMaxInternal(),this.onDirtyingChange()},t.prototype.scaleMaxInternal=function(){for(var e=this.get_children().getEnumerator();e.moveNext();){var t=e.get_current(),n=this._scalingInfo.getGroupMaxSize(t.get_id());T.x(n)||t.selectLayout(n)}this._lastScalingIndex=-1},t.prototype.scaleIndex=function(e){this.scaleIndexInternal(e),this.onDirtyingChange()},t.prototype.scaleIndexInternal=function(e){for(this.scaleMaxInternal();e>this._lastScalingIndex&&this.scaleDownInternal(););},t.prototype.scaleUpInternal=function(){if(-2===this._lastScalingIndex)return this.scaleMaxInternal(),!0;if(-1===this._lastScalingIndex)return!1;var e=this._scalingInfo.get_stepsInternal()[this._lastScalingIndex];return this.getChild(e.get_groupId()).selectLayout(e.get_previousLayoutName()),this._lastScalingIndex--,!0},t.prototype.scaleUp=function(){var e=this.scaleUpInternal();return e&&this.onDirtyingChange(),e},t.prototype.scaleDownInternal=function(){if(-2===this._lastScalingIndex)return this.scaleMax(),!0;var e=this._scalingInfo.get_stepsInternal();if(e.length<=this._lastScalingIndex+1)return!1;this._lastScalingIndex++;var t=e[this._lastScalingIndex],n=this.getChild(t.get_groupId());return n&&n.selectLayout(t.get_layoutName()),!0},t.prototype.scaleDown=function(){var e=this.scaleDownInternal();return e&&this.onDirtyingChange(),e},t.prototype.get_scaledByCookie=function(){return this._scaledByCookie},t.prototype.set_scaledByCookie=function(e){return this._scaledByCookie=e,e},t.prototype.get_width=function(){var e=0,t=this.get_elementInternal();return T.x(t)||(e=t.offsetWidth),e},t.prototype.get_contentsCurScaleWidth=function(){for(var e=0,t=this.get_elementInternal().childNodes,n=0;n<t.length;n++)e+=t[n].offsetWidth+.5;return Math.ceil(e)},t.prototype.get_minWidth=function(){return this._tabBodyMinWidth},t.prototype.set_minWidth=function(e){var t=this.get_elementInternal();return T.x(t)||(t.style.minWidth=e+"px",this._tabBodyMinWidth=e),e},t.prototype.get_contextual=function(){return this._contextual},t.prototype.get_contextualGroupId=function(){return this._contextualGroupId},t.prototype.get_lastTabDisplayTime=function(){return T.x(this._lastTabDisplayTime)&&(this._lastTabDisplayTime=new Date,this._lastTabDisplayTime.setTime(0)),this._lastTabDisplayTime},t.prototype.set_lastTabDisplayTime=function(e){return this._lastTabDisplayTime=e,e},t.prototype.get_popupInvocationMethod=function(){return this._popupInvocationMethod},t.prototype.set_popupInvocationMethod=function(e){return this._popupInvocationMethod=e,e},t.prototype.onTitleKeyPress=function(e){return e.innerEvent&&e.innerEvent.preventDefault(),!1},t.prototype.onTitleKeyUp=function(e){var t=!1;if(!T.x(e.innerEvent)){var n=e.innerEvent.keyCode;n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||(this.doTitleDefaultAction(1),this.get_ribbon().get_minimized()||this.setFocusOnFirstControl(),t=!0)}return t},t.prototype.onTitlePointerDown=function(e){var t=!1;return 2===e.get_inputSource()&&e.get_mouseButton()||(this.doTitleDefaultAction(e.get_inputSource()),t=!0),t},t.prototype.doTitleDefaultAction=function(e){(this.set_popupInvocationMethod(e),this.cancelPendingDisplayTab(),this.get_selected())?this.get_ribbon().get_tabPoppedUp()?(new Date).getTime()-this.get_lastTabDisplayTime().getTime()>500&&this.delayDismissRibbon(500):this.delayDisplayTab(500):(this.get_ribbon().get_minimized()&&!this.get_ribbon().get_tabPoppedUp()&&(2!==e&&3!==e||this.get_ribbon().set_isLowerRibbonTouchMode(3===e)),this.displayTab())},t.prototype.onTitleDblClick=function(e){return this.get_selected()&&(this.get_ribbon().get_minimized()&&!this.get_ribbon().get_tabPoppedUp()&&this.get_ribbon().set_isLowerRibbonTouchMode(!1),this.cancelPendingDisplayTab(),this.cancelPendingDismissRibbonPopup(),this.get_ribbon().toggleMinimizedState(2)),!0},t.prototype.displayTab=function(){_.t.mark(10334),f.g.measureTimeToNextFrame(this.get_id(),"TabSwitch"),this.cancelPendingDisplayTab();var e=!this.get_ribbon().get_minimized()&&f.g.isActiveElement(this._elmTitleA);if(this.set_selected(!0),e&&this.setFocusOnTitle(),this.set_lastTabDisplayTime(new Date),_.t.mark(10335),l.ULS.sendTraceTag(20459935,340,50,"DisplayTab: {0}",{Title:this.get_title()}),y.w.get_instance().tryResolve(o)){var t={};t[p.tabId]=this.get_id(),c.AFrameworkApplication.get_theActionManager().processActionWithData(u.zq,2,t)}},t.prototype.dismissRibbonPopup=function(){this.cancelPendingDismissRibbonPopup(),this.get_ribbon().dismissTabPopup()},t.prototype.delayDisplayTab=function(e){-1===this._pendingDisplayTabTimeoutId&&(this._pendingDisplayTabTimeoutId=window.setTimeout(r.i(this,this.displayTab,"displayTab"),e))},t.prototype.cancelPendingDisplayTab=function(){var e=this;I.n.cancelPendingTimeout((0,a.m)((function(){return e._pendingDisplayTabTimeoutId}),(function(t){return e._pendingDisplayTabTimeoutId=t})))},t.prototype.delayDismissRibbon=function(e){-1===this._pendingDismissTabTimeoutId&&(this._pendingDismissTabTimeoutId=window.setTimeout(r.i(this,this.dismissRibbonPopup,"dismissRibbonPopup"),e))},t.prototype.cancelPendingDismissRibbonPopup=function(){var e=this;I.n.cancelPendingTimeout((0,a.m)((function(){return e._pendingDismissTabTimeoutId}),(function(t){return e._pendingDismissTabTimeoutId=t})))},t.prototype.moveGroupFocus=function(e,t){var n=f.g.getActiveElement(this.get_elementInternal().ownerDocument),i=this.get_children().get_count(),r=0,o=0;if(e)r=-1,o=t?0:i-1;else{for(var a=this.findGroupId(n),s=this.get_children().getEnumerator();s.moveNext();){if(s.get_current().get_id()===a)break;r++}(o=t?(r+1)%i:r-1)<0&&(o=i+o)}for(o!==r&&3===v.s.getTag(n)&&f.g.clearSelectionInInput(n);o!==r;){if(this.get_children().get_item(o).setFocusOnFirstControl())return;t?o=(o+1)%i:o-=1,o<0&&(o=i+o)}},t.prototype.findGroupId=function(e){return"LI"===e.nodeName?e.id:this.findGroupId(e.parentNode)},t.prototype.get_firstControl=function(){if(T.x(this._firstControl))for(var e=this.get_children().get_item(0),t=e.get_selectedLayout().get_children().get_count(),n=0;n<t&&T.x(this._firstControl);){var i=e.get_selectedLayout().get_children().get_item(n);if(i.get_children().get_count()>0){var r=i.get_children().get_item(0);r.get_children().get_count()>0&&(this._firstControl=r.get_children().get_item(0).get_control())}n++}return this._firstControl},t.prototype.get_lastControl=function(){if(T.x(this._lastControl)){var e=this.get_children().get_count(),t=this.get_children().get_item(e-1);t.get_hasElementDialogLauncherComponent()&&(this._lastControl=t.get_elementDialogLauncherComponent().get_control());for(var n=t.get_selectedLayout().get_children(),i=n.get_count()-1;i>=0&&T.x(this._lastControl);){var r=n.get_item(i),o=r.get_children().get_count();if(o>0){var a=r.get_children().get_item(o-1),s=a.get_children().get_count();s>0&&(this._lastControl=a.get_children().get_item(s-1).get_control())}i--}}return this._lastControl},t.prototype.setFocusOnFirstControl=function(){for(var e=this.get_children().getEnumerator();e.moveNext();){if(e.get_current().setFocusOnFirstControl())return!0}return!1},t.prototype.setFocusOnTitle=function(){T.x(this._elmTitleA)||this._elmTitleA.focus()},t.prototype.getTitleCSSClassName=function(){var e="cui-tt "+this._cssClass;return c.AFrameworkApplication.get_activeFrame()&&c.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()||(e+=" UITextTranformUpperCase"),this._selected&&(e+=" cui-tt-s"),e},t.prototype.getBodyCSSClassName=function(){var e=t.tabBodyCssClassName;return this.get_contextual()&&(e+=" cui-tabBody-"+b.z.getColorNameForContextualTabColor(this.get_ribbon().getContextualGroup(this.get_contextualGroupId()).get_color())),e},t.prototype.getContainerCSSClassName=function(){var e="cui-tabContainer";return this.get_contextual()&&(e+=" cui-tabContainer-"+b.z.getColorNameForContextualTabColor(this.get_ribbon().getContextualGroup(this.get_contextualGroupId()).get_color())),e},t.prototype.get_visible=function(){return e.prototype.get_visible.call(this)},t.prototype.set_visible=function(t){if(this.get_contextual())throw Error.create("Visibility of Contextual Tabs cannot be set explicitly.");return e.prototype.set_visible.call(this,t),t},t.prototype.get_command=function(){return this._command},t.prototype.pollForStateAndUpdateInternal=function(){if(T.x(this.get_command()))this.set_enabled(!0);else{var t=this.get_ribbon().pollForCommandState(this.get_command(),null,null);this.set_enabled((1&t)>0)}this.get_enabled()&&(this.set_lastPollTime(new Date),e.prototype.pollForStateAndUpdateInternal.call(this)),this.get_ribbon().ensureTabContainerGlobalDisablingRemoved()},t.prototype.dispose=function(){T.x(this._elmTitleA)||I.n.unregisterAllHandlers(this._elmTitleA),e.prototype.dispose.call(this),I.n.releaseEventHandlersRecursively(this._elmTitle),this._elmATText=null,this._elmTitle=null,this._elmTitleA=null,this._elmTitleSpan=null},t.tabBodyCssClassName="cui-tabBody",t}(s.p);(0,r.l)(E,"Tab",s.p,[])},function(e,t,n){"use strict";n.d(t,{k:function(){return i}});var i=(0,n(208).y)("IFocusManager")},,,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IStopwatchEx"),o=(0,i.y)("IStopwatch"),a=n(809),s=n(255),l=n(532),u=function(){return function(){}}();(0,i.l)(u,"PerfOperation",null,[]),n.d(t,{q:function(){return c}});var c=function(){function e(e,t){this._startTime=null,this._endTime=null,this._operation="DOMUpdate",this._target=null,this._operation=e,this._target=t}return e.prototype.get_isRunning=function(){return!!this._startTime},e.prototype.get_ageInMilliseconds=function(){return this._startTime?(new Date).getTime()-this._startTime.getTime():0},e.prototype.get_id=function(){throw Error.notImplemented()},e.prototype.start=function(){return this._startTime=new Date,this._endTime=null,null},e.prototype.stop=function(){this._startTime&&s.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",{Operation:this._operation,Target:this._target,StartTime:this._startTime.toUTCString(),DurationInMilliseconds:this.get_ageInMilliseconds()})},e.prototype.reset=function(){this.stop(),this._startTime=null,this._endTime=null},e.prototype.isNullOrEmpty=function(e){return!e||""===e},e.prototype.logPerfOperation=function(e){var t=Sys.Serialization.JavaScriptSerializer.serialize(e);s.ULS.sendTraceTag(4257028,200,50,"Stopwatch stopped: {0}",t)},e.prototype.stopEx=function(e,t){if(void 0===t&&(t=!1),this._endTime||(this._endTime=new Date),this._startTime){var n=this._endTime.getTime()-this._startTime.getTime();if(!e)return void this.logPerfOperation(this.createPivotedPerfOperation(this._target,n,null));var i=this.createPivotedExtraInfo("All","All",e),r=this.createPivotedExtraInfo(e.PivotName,"All",e);t||this.logPerfOperation(this.createPivotedPerfOperation(this._target,n,i)),this.isNullOrEmpty(e.PivotName)||this.isNullOrEmpty(e.PivotValue)||(this.logPerfOperation(this.createPivotedPerfOperation(this._target+"_"+e.PivotName+e.PivotValue,n,e)),this.logPerfOperation(this.createPivotedPerfOperation(this._target+"_"+e.PivotName+r.PivotValue,n,r))),this.isNullOrEmpty(e.CompositeName)||(t||this.logPerfOperation(this.createPivotedPerfOperation(e.CompositeName,n+e.CompositeDurationInMilliseconds,i)),this.isNullOrEmpty(e.PivotName)||this.isNullOrEmpty(e.PivotValue)||(this.logPerfOperation(this.createPivotedPerfOperation(e.CompositeName+"_"+e.PivotName+e.PivotValue,n+e.CompositeDurationInMilliseconds,e)),this.logPerfOperation(this.createPivotedPerfOperation(e.CompositeName+"_"+e.PivotName+"All",n+e.CompositeDurationInMilliseconds,r))))}},e.prototype.createPivotedExtraInfo=function(e,t,n){return(0,a.m)(new l.y,{PivotName:e,PivotValue:t,CompositeDurationInMilliseconds:n.CompositeDurationInMilliseconds,CompositeName:n.CompositeName,ExtraInfoContext:n.ExtraInfoContext})},e.prototype.createPivotedPerfOperation=function(e,t,n){return(0,a.m)(new u,{Operation:this._operation,Target:e,StartTime:this._startTime.toUTCString(),DurationInMilliseconds:t,ExtraInfo:n})},e}();(0,i.l)(c,"Stopwatch",null,[r,o])},function(e,t,n){var i=n(714),r=n(975),o=n(240).indexOf,a=n(227);e.exports=function(e,t){var n,s=r(e),l=0,u=[];for(n in s)!i(a,n)&&i(s,n)&&u.push(n);for(;t.length>l;)i(s,n=t[l++])&&(~o(u,n)||u.push(n));return u}},,,function(e,t,n){"use strict";n.d(t,{o:function(){return c}});var i=n(508),r=n(208),o=n(643),a=n(244),s=n(841),l=n(337),u=n(556),c=function(e){function t(t,n,i,r){void 0===t&&(t=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===r&&(r=!1);var o=e.call(this,t,n,i,r)||this;return o._textElement=null,o._customDialogHandler=null,o._reactDialogHandler=null,o._dialogHtml=null,o._autoSize=!1,o._controlValues=null,o._customCssClass="",o}return(0,i.t)(t,e),t.prototype.get_dialogHtml=function(){return this._dialogHtml},t.prototype.set_dialogHtml=function(e){return this._dialogHtml=e,e},t.prototype.get_autoSize=function(){return this._autoSize},t.prototype.set_autoSize=function(e){return this._autoSize=e,e},t.prototype.get_canBePreempted=function(){return!0},t.prototype.baseDialogHandler=function(e){var t=this._controlValues;for(var n in t){var i={key:n,value:t[n]},r=document.getElementById(i.key);r&&(this._controlValues[i.key]=this.getControlValue(r))}this._hideOnButtonClick&&this.hide(),this._customDialogHandler&&this._customDialogHandler(e,this._controlValues),this._hideOnButtonClick&&(this._customDialogHandler=null)},t.prototype.reactBaseDialogHandler=function(e,t){this._hideOnButtonClick&&this.hide(),this._customDialogHandler&&this._customDialogHandler(e,t),this._hideOnButtonClick&&(this._customDialogHandler=null)},t.prototype.setControlValue=function(e,t){switch(u.l.toLower(e.tagName)){case"input":switch(u.l.toLower(e.type)){case"text":case"hidden":case"password":case"number":e.value=t;break;case"checkbox":case"radio":e.checked=t;break;default:e.innerText=t}break;case"textarea":e.value=t;break;case"select":e.selectedIndex=t;break;case"img":e.src=t;break;default:e.innerText=t}},t.prototype.getControlValue=function(e){var t;switch(u.l.toLower(e.tagName)){case"input":switch(u.l.toLower(e.type)){case"text":case"hidden":case"password":t=e.value;break;case"checkbox":case"radio":t=e.checked;break;case"number":t=e.value;break;default:t=e.innerText}break;case"textarea":t=e.value;break;case"select":t=e.selectedIndex;break;case"img":t=e.src;break;default:t=e.innerText}return t},t.prototype.setInnerHtml=function(){this._textElement.innerHTML=this.get_dialogHtml(),this.onInnerHtmlSet()},t.prototype.setDialogProperties=function(e){this.prepareDialog(),this.sizeAndPositionDialog(),this.setInnerHtml(),this._titleText.innerText=e},t.prototype.prepareDialog=function(){e.prototype.prepareDialog.call(this),Sys.UI.DomElement.addCssClass(this._divMessageBox,this._customCssClass);var t=document.createElement("div");t.id=this.myId("WACDialogHtmlPanel"),t.className="WACDialogHtmlPanel",this._body.appendChild(t),this._textElement=document.createElement("div"),this._textElement.id=this.myId("WACDialogText"),t.appendChild(this._textElement)},t.prototype.sizeAndPositionDialog=function(){var e=o.h.get_posTop()+(this.getPageHeight()-t._defaultHeight)/2-12,n=o.h.get_posLeft()+(this.getPageWidth()-t._defaultWidth)/2-12;this.sizeAndPositionDialogWorker(e,n)},t.prototype.sizeAndPositionDialogWorker=function(e,t){var i=e,r=t;"DL"!==this._windowMode&&(this._divMessageBox.style.top=(i<0?0:i)+"px"),"DP"!==this._windowMode&&(n(254).AFrameworkApplication.get_isRtl()?this._divMessageBox.style.right=(r<0?0:r)+"px":this._divMessageBox.style.left=(r<0?0:r)+"px",this.get_autoSize()||n(254).AFrameworkApplication.appSettingsManager&&!n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacDialogSizingChanges")&&(this._divMessageBox.style.width=String.format("{0}em",this.get_width()))),this._divMessageBox.style.display="Block"},t.prototype.onInnerHtmlSet=function(){},t.prototype.showDialog=function(e,t){this.initializeAndShow(e,t,null)},t.prototype.initializeAndShow=function(e,t,n){this.set_dialogId(void 0===this.get_dialogId()||null===this.get_dialogId()?l.s(0,Number.MAX_VALUE).toString():this.get_dialogId()),this._useReactDialog?this.reactInitializeAndShow(e,t,n):this.legacyInitializeAndShow(e,t,n)},t.prototype.reactInitializeAndShow=function(t,n,i){null!=i&&(this._customDialogHandler=n,this._reactDialogHandler=r.i(this,this.reactBaseDialogHandler,"reactBaseDialogHandler"),i.headerText=i.headerText||t,i.type="CustomDialogProps",i.id=i.id||this.get_dialogId(),i.resultHandler=this._reactDialogHandler,e.prototype.show.call(this,i))},t.prototype.legacyInitializeAndShow=function(e,t,n){if(this._messageBoxHandler=r.i(this,this.baseDialogHandler,"baseDialogHandler"),this._customDialogHandler=t,this._controlValues=n,this.setDialogProperties(e),n)for(var i in n){var o={key:i,value:n[i]},a=document.getElementById(o.key);a&&this.setControlValue(a,o.value)}this.show()},t.prototype.dispose=function(){this._textElement=null,e.prototype.dispose.call(this)},t.prototype.setFailed=function(e,t){var n=new s.StandardDialog;n.set_buttonsOption(0),n.showWarning(CommonUIStrings.l_DefaultDialogTitle,e,t)},t.formatHtml=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return String.format.apply(null,[e].concat(a.toArray(String,a.select(String,String,a.asEnumerable(String,t),u.l.htmlEncode))))},t._defaultWidth=350,t._defaultHeight=200,t}(o.h);(0,r.l)(c,"CustomDialog",o.h,[])},function(e,t,n){"use strict";n.r(t),n.d(t,{ContinuableTask:function(){return a}});var i=n(508),r=n(742),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t._action$1=null,t._actionWithData$1=null,t._parent=null,t}return(0,i.t)(t,e),t.prototype.execute=function(){return this._action$1?this._action$1(this._parent):this._actionWithData$1(this._parent,this._data),!0},t.C=function(e,n){var i=new t;return i._action$1=e,i._parent=n,i},t.CO=function(e,n,i){var r=new t;return r._actionWithData$1=e,r._data=n,r._parent=i,r},t}(r.Task);(0,o.l)(a,"ContinuableTask",r.Task,[])},,,,,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IViewerChrome"),o=n(600),a=n(547),s=n(363),l=n(48),u=n(763),c=n(254),p=n(154),d=function(){function e(e,t,n,i,r){this._elmTopBar1=null,this._elmTopBar2=null,this._breadcrumb=null,this._documentTitle=null,this._toolbarContainer=null,this._elmTopBar1=e,this._elmTopBar2=t,this._breadcrumb=n,this._documentTitle=i,this._toolbarContainer=r}return e.prototype.adjustBreadcrumbDisplay=function(){var e=!!c.AFrameworkApplication.breadcrumbBrandName,t=!!c.AFrameworkApplication.breadcrumbFolderName;if(!c.AFrameworkApplication.get_isEmbedded()&&e&&t){var n=this._breadcrumb.getBreadcrumbItem(a.CuiHelper.breadcrumbFolderId),i=this._breadcrumb.getBreadcrumbItem(a.CuiHelper.folderSeparatorId);n&&i&&l.k.adjustBreadcrumbDisplay(i,n)}},e.prototype.scaleHerobar=function(){var t=this,n=[function(){e.trimLongestElement(t._breadcrumb,t._documentTitle,200)},function(){e.trimBreadcrumbAndDocumentTitle(t._breadcrumb,t._documentTitle,200)},function(){e.hideDocumentTitleAndUntruncateBreadcrumb(t._breadcrumb,t._documentTitle)},function(){t._breadcrumb.truncateWidth(200)},i.i(this._breadcrumb,this._breadcrumb.hide,"hide")];e.showAndUntruncateAllElements(this._breadcrumb,this._documentTitle),e.invokeScalingSteps(n,(function(){return e.herobarElementBoundsOverlap(t._breadcrumb,t._documentTitle,t._toolbarContainer,c.AFrameworkApplication.get_isRtl())}))},e.prototype.scaleHeader=function(){this.enhancedMobileViewIsEnabled()?(document.getElementById("application").style.minWidth="0px",new u.b(this._elmTopBar1,this._elmTopBar2,c.AFrameworkApplication.get_isRtl()).scaleHeader()):l.k.scaleHeaderUsingContainers(this._elmTopBar1,this._elmTopBar2,c.AFrameworkApplication.get_isRtl())},e.prototype.enhancedMobileViewIsEnabled=function(){return!!c.AFrameworkApplication.appSettingsManager&&c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EnhancedMobileViewIsEnabled")},e.prototype.scaleViewerChrome=function(){this.scaleHeader(),this.adjustBreadcrumbDisplay(),this.scaleHerobar()},e.showAndUntruncateAllElements=function(e,t){e&&e.undoScaling(),t&&t.undoScaling()},e.herobarElementBoundsOverlap=function(t,n,i,r){return e.viewerChromeItemsOverlap(t,n,r)||e.viewerChromeItemsOverlap(n,i,r)||e.viewerChromeItemsOverlap(t,i,r)},e.viewerChromeItemsOverlap=function(e,t,n){return!(!e||!t)&&(!(!e.get_isVisible()||!t.get_isVisible())&&p.g.leftBoundsOverlapsRightBounds(e.get_containerBounds(),t.get_containerBounds(),n))},e.trimLongestElement=function(e,t,n){e&&t&&(e.get_containerBounds().width>t.get_containerBounds().width?e.truncateWidth(n):t.truncateWidth(n))},e.trimBreadcrumbAndDocumentTitle=function(e,t,n){e&&e.truncateWidth(n),t&&t.truncateWidth(n)},e.hideDocumentTitleAndUntruncateBreadcrumb=function(e,t){t.hide(),e.undoScaling()},e.invokeScalingSteps=function(e,t){for(var n=0;t()&&n<e.length;)e[n](),n++},e}();(0,i.l)(d,"ViewerChromeScalingManager",null,[]);var h=n(928),g=n(925),m=n(296);n.d(t,{k:function(){return _}});var _=function(){function e(e,t,n,r){var a=this;void 0===r&&(r=!1),this._elmViewerChromeContainer=null,this._elmToolbarTopBars=null,this._elmHeaderContainer=null,this._elmTopBar1=null,this._elmTopBar2=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._breadcrumbContainer=null,this._documentTitleContainer=null,this._toolbarContainer=null,this.viewerChromeScalingManager=null,this._resizableContainer=null,this._headerIsHidden=!1,this._appHasExternalHeader=!1,this._appExternalHeaderPanel=null,this._appHasExternalHeader=h.f((0,o.m)((function(){return a._appExternalHeaderPanel}),(function(e){return a._appExternalHeaderPanel=e})),!r),this._headerIsHidden=r,this.createViewerChromeStructure(),e.appendChild(this._elmViewerChromeContainer),this._headerIsHidden||this.populateHeader(t),this.populateHerobarContainers(),this.viewerChromeScalingManager=new d(this._elmTopBar1,this._elmTopBar2,this._breadcrumbContainer,this._documentTitleContainer,this._toolbarContainer),this._resizableContainer=n||new g.o,this._resizableContainer.add_onResize(i.i(this,this.scale,"scale")),this.scale()}return e.prototype.get_toolbarWithTopbarHeight=function(){return e.calculateToolbarWithTopBarHeight(this._headerIsHidden,this._appHasExternalHeader)},e.prototype.get_viewerChromeCssClass=function(){return"cui-viewerchrome"},e.prototype.get_toolbarContainer=function(){return this._toolbarContainer.get_elmContainer()},e.prototype.get_peripheralContentContainer=function(){return this._elmTopBar1},e.prototype.get_toolbarContentContainer=function(){return this._elmTopBar2},e.prototype.createViewerChromeStructure=function(){this._elmViewerChromeContainer=e.createUnselectableElement("div"),this._elmViewerChromeContainer.className=this.get_viewerChromeCssClass(),this.ensureTopBars(),this.ensureTopBars1And2()},e.prototype.ensureTopBars=function(){this._elmToolbarTopBars=e.createUnselectableElement("div"),this._elmToolbarTopBars.id=a.CuiHelper.headerTopBarsId,this._elmToolbarTopBars.className="cui-ribbonTopBars",this._elmViewerChromeContainer.appendChild(this._elmToolbarTopBars),this.ensureHeaderDom()},e.prototype.ensureHeaderDom=function(){this._appHasExternalHeader?(this._elmHeaderContainer=e.createUnselectableElement("div"),this._elmHeaderContainer.className="cui-ribbonTopBars",this._elmHeaderContainer.id=a.CuiHelper.externalHeaderViewerChromeTopBarsId,this._appExternalHeaderPanel.appendChild(this._elmHeaderContainer),Sys.UI.DomElement.addCssClass(this._elmHeaderContainer,this.get_viewerChromeCssClass()),Sys.UI.DomElement.addCssClass(this._elmViewerChromeContainer,"cui-exth")):this._elmHeaderContainer=this._elmToolbarTopBars},e.prototype.ensureTopBars1And2=function(){this._elmTopBar1=e.createUnselectableElement("div"),this._elmTopBar1.className="cui-topBar1";var t=c.AFrameworkApplication.appSettingsManager.get_appSettings();"TransitionalHeaderUIInViewEnabled"in t&&Boolean.parse(t.TransitionalHeaderUIInViewEnabled)&&c.AFrameworkApplication.get_activeFrame()&&c.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isTransistionalHeaderUIEnabled()&&(this._elmTopBar1.className+=" cui-topBar1-transistionalHeaderUI"),c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LegacyHeaderAppColorIsEnabled")&&(this._elmTopBar1.className+=" cui-topBar1-transistionalHeaderUI"),this._headerIsHidden&&(this._elmTopBar1.style.display="none"),this._elmHeaderContainer.appendChild(this._elmTopBar1),this._elmTopBar2=e.createUnselectableElement("div"),c.AFrameworkApplication.isMobileMode||(this._elmTopBar2.className="cui-topBar2"),this._elmToolbarTopBars.appendChild(this._elmTopBar2)},e.prototype.populateHeader=function(t){this._elmTopRowLeft=document.getElementById(t+"-"+s.r.topRowLeft),this._elmTopRowCenter=document.getElementById(t+"-"+s.r.topRowCenter),this._elmTopRowRight=document.getElementById(t+"-"+s.r.topRowRight),this._elmTopRowLeft&&(this._elmTopRowLeft.parentNode.removeChild(this._elmTopRowLeft),this._elmTopBar1.appendChild(this._elmTopRowLeft),this._elmTopRowLeft.style.display="inline-block",e.setUnselectable(this._elmTopRowLeft)),this._elmTopRowCenter&&(this._elmTopRowCenter.parentNode.removeChild(this._elmTopRowCenter),this._elmTopBar1.appendChild(this._elmTopRowCenter),this._elmTopRowCenter.style.display="inline-block",e.setUnselectable(this._elmTopRowCenter)),this._elmTopRowRight&&(this._elmTopRowRight.parentNode.removeChild(this._elmTopRowRight),this._elmTopBar1.appendChild(this._elmTopRowRight),this._elmTopRowRight.style.display="inline-block",e.setUnselectable(this._elmTopRowRight))},e.prototype.populateHerobarContainers=function(){c.AFrameworkApplication.isMobileMode||(this._breadcrumbContainer=new(n(275).BreadcrumbContainer),this._elmTopBar2.appendChild(this._breadcrumbContainer.get_elmContainer())),this._documentTitleContainer=new(n(626).DocumentTitleContainer),this._toolbarContainer=new(n(365).ToolbarContainer),this._elmTopBar2.appendChild(this._documentTitleContainer.get_elmContainer()),this._elmTopBar2.appendChild(this._toolbarContainer.get_elmContainer())},e.prototype.scale=function(){c.AFrameworkApplication.isMobileMode||this.viewerChromeScalingManager.scaleViewerChrome()},e.prototype.dispose=function(){this._documentTitleContainer&&(this._documentTitleContainer.dispose(),this._documentTitleContainer=null),this._breadcrumbContainer&&(this._breadcrumbContainer.dispose(),this._breadcrumbContainer=null),this._elmToolbarTopBars=null,this._elmTopBar1=null,this._elmTopBar2=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._resizableContainer.remove_onResize(i.i(this,this.scale,"scale")),this._resizableContainer=null,this._appExternalHeaderPanel&&m.s.clearElementHtml(this._appExternalHeaderPanel)},e.calculateToolbarWithTopBarHeight=function(e,t){return 40+(e||t?0:48)},e.createUnselectableElement=function(t){var n=document.createElement(t);return e.setUnselectable(n),n},e.setUnselectable=function(e){e.setAttribute("unselectable","on")},e}();(0,i.l)(_,"ViewerChrome",null,[Sys.IDisposable,r])},,,function(e,t,n){"use strict";n.d(t,{q:function(){return i},b:function(){return r}});n(255);var i=function(e){if(e)for(var t=0,n=e.length;t<n;t++)r(e[t])},r=function(e){if(e)try{e.dispose()}catch(e){n(262).setExceptionCallStack(e)}}},,,,,,function(e,t,n){"use strict";n.d(t,{q:function(){return i}});var i=(0,n(208).y)("IDragAdapter")},,,,function(e,t,n){"use strict";n.d(t,{n:function(){return a}});var i=n(508),r=n(255),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t._responseAvailable=!1,t._started=!1,t._response=null,t._data=null,t}return(0,i.t)(t,e),t.prototype.debugSendTraceTag=function(e,t,n,i){for(var o=[],a=4;a<arguments.length;a++)o[a-4]=arguments[a];r.ULS.sendTraceTag.apply(null,[e,t,n,i].concat(o))},t.prototype.verifyRequestValidity=function(e){if(this._started)throw Error.invalidOperation(String.format(Sys.Res.cannotCallOnceStarted,"executeRequest"));if(!e)throw Error.argumentNull("webRequest",Sys.Res.nullWebRequest)},t.prototype.get_aborted=function(){return!1},t.prototype.get_responseAvailable=function(){return this._responseAvailable},t.prototype.get_started=function(){return this._started},t.prototype.get_timedOut=function(){return!1},t.prototype.executeRequest=function(){var e=this,t=this.get_webRequest();this.verifyRequestValidity(t);var n=t.get_body(),i={};if(t.get_headers()){var r=t.get_headers();for(var o in r){var a={key:o,value:r[o]};"function"!=typeof a.value&&(i[a.key]=a.value)}}"post"===t.get_httpVerb().toLowerCase()&&(i["Content-Type"]||(i["Content-Type"]="application/x-www-form-urlencoded"),n=n||""),i["X-Requested-With"]="Fetch";var s={};s.body=n,s.headers=i,s.keepalive=!0,s.method=t.get_httpVerb(),s.mode="same-origin",window.fetch(t.getResolvedUrl(),s).then((function(t){return e._response=t,t.text()}),(function(e){return null})).then((function(t){return e._responseAvailable=!0,e.get_webRequest().completed(Sys.EventArgs.Empty),e._data=t,null}),(function(e){return null})),this._started=!0},t.prototype.getResponseHeader=function(e){var t="";return this._response.headers.has(e)&&(t=this._response.headers.get(e)),t},t.prototype.getAllResponseHeaders=function(){var e={};return this._response.headers.forEach((function(t,n,i){e[t]=n})),this._response.headers.toString(),JSON.stringify(e)},t.prototype.get_responseData=function(){return this._data},t.prototype.get_statusCode=function(){return this._response.status},t.prototype.get_statusText=function(){return this._response.statusText},t.prototype.get_xml=function(){return null},t.prototype.abort=function(){},t}(Sys.Net.WebRequestExecutor);(0,o.l)(a,"FetchKeepAliveExecutor",Sys.Net.WebRequestExecutor,[])},,,,,,function(e,t,n){"use strict";n.r(t);var i=n(208),r=(0,i.y)("ICustomerFeedbackResourceDownloadManager"),o=(0,i.y)("ICustomerFeedbackUiWrapper"),a=(0,i.y)("ICustomerFeedbackFormManager"),s=n(842),l=(0,i.y)("IAppSpecificFeedbackData"),u=(0,i.y)("ISystemInitiatedFeedbackWithTimeLapse"),c=n(536),p=n(397),d=n(255),h=n(254),g=function(e,t){var n=null;if(e&&e.length>0&&t&&t.length>0){var i=window[t];if(i){i&&e in i?n=i[e]:d.ULS.sendTraceTag(38605909,356,10,"Couldnt find survey json for survey "+e+" from dictionary "+t)}else d.ULS.sendTraceTag(38605910,356,10,"Couldnt find survey dictionary "+t)}return n},m=function(){var e=!1,t=h.AFrameworkApplication.appSettingsManager.getStringAppSetting("FlightId"),n=t?t.toLowerCase():"",i=-1!==n.indexOf("floodgatelatestversion");return i?(e=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateLatestVersionIsEnabled"))||(e=-1!==n.indexOf("floodgateflight")):e=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateUseRecentVersion"),e?d.ULS.sendTraceTag(50668111,356,50,"Using floodgate latest version "+i):d.ULS.sendTraceTag(595342404,356,50,"Using floodgate stable version"),e},_=n(867),f=function(){function e(){}return e.prototype.getAppData=function(e){return null},e.prototype.getNPSBrsForApp=function(){return"ExcelNPSFloodgateEnabled"},e.prototype.getNPSDelayInMsBrsForApp=function(){return"ExcelNPSDelayInMilliseconds"},e.prototype.getNPSUsageActivityName=function(){return"AppUsageNPS"},e.prototype.getNPSFollowupActivityName=function(){return"AppUsageTimeSatisfiedNPS"},e.prototype.getCampaignDefinitions=function(){return _.w(window.ExcelCampaignsObj)},e.prototype.getUserInitiatedSurvey=function(e){return g(e,"ExcelUserInitiatedSurveysDictionary")},e}();(0,i.l)(f,"ExcelFeedbackAppData",null,[l]);var y=function(){function e(){}return e.prototype.getAppData=function(e){return null},e.prototype.getNPSBrsForApp=function(){return"OneNoteNPSFloodgateEnabled"},e.prototype.getNPSDelayInMsBrsForApp=function(){return"OneNoteNPSDelayInMilliseconds"},e.prototype.getNPSUsageActivityName=function(){return"AppUsageNPS"},e.prototype.getNPSFollowupActivityName=function(){return"AppUsageTimeSatisfiedNPS"},e.prototype.getCampaignDefinitions=function(){return _.w(window.OneNoteCampaignsObj)},e.prototype.getUserInitiatedSurvey=function(e){return g(e,"OneNoteUserInitiatedSurveysDictionary")},e}();(0,i.l)(y,"OneNoteFeedbackAppData",null,[l]);var v=function(){function e(){}return e.prototype.getAppData=function(e){return null},e.prototype.getNPSBrsForApp=function(){return"PPTNPSFloodgateEnabled"},e.prototype.getNPSDelayInMsBrsForApp=function(){return"PPTNPSDelayInMilliseconds"},e.prototype.getNPSUsageActivityName=function(){return"AppUsageNPS"},e.prototype.getNPSFollowupActivityName=function(){return"AppUsageTimeSatisfiedNPS"},e.prototype.getCampaignDefinitions=function(){return _.w(window.PPTCampaignsObj)},e.prototype.getUserInitiatedSurvey=function(e){return g(e,"PPTUserInitiatedSurveysDictionary")},e}();(0,i.l)(v,"PPTFeedbackAppData",null,[l]);var S=function(){function e(){}return e.prototype.getAppData=function(e){return null},e.prototype.getNPSBrsForApp=function(){return"VisioNPSFloodgateEnabled"},e.prototype.getNPSDelayInMsBrsForApp=function(){return"VisioNPSDelayInMilliseconds"},e.prototype.getNPSUsageActivityName=function(){return"AppUsageNPS"},e.prototype.getNPSFollowupActivityName=function(){return"AppUsageTimeSatisfiedNPS"},e.prototype.getCampaignDefinitions=function(){return _.w(window.VisioCampaignsObj)},e.prototype.getUserInitiatedSurvey=function(e){return g(e,"VisioUserInitiatedSurveysDictionary")},e}();(0,i.l)(S,"VisioFeedbackAppData",null,[l]);var C=function(){function e(){}return e.prototype.getAppData=function(e){return null},e.prototype.getNPSBrsForApp=function(){return"WordNPSFloodgateEnabled"},e.prototype.getNPSDelayInMsBrsForApp=function(){return"WordNPSDelayInMilliseconds"},e.prototype.getNPSUsageActivityName=function(){return"AppUsageNPS"},e.prototype.getNPSFollowupActivityName=function(){return"AppUsageTimeSatisfiedNPS"},e.prototype.getCampaignDefinitions=function(){return _.w(window.WordCampaignsObj)},e.prototype.getUserInitiatedSurvey=function(e){return g(e,"WordUserInitiatedSurveysDictionary")},e}();(0,i.l)(C,"WordFeedbackAppData",null,[l]);var b=n(351),A=n(614),T=n(299),w=n(882),I=n(235),E=n(984),k=function(){function e(e,t,n,r,o){this._actionManager=null,this._activeFrame=null,this._customerFeedbackFormManager=null,this._settingsManager=null,this._mostRecentError=null,this._dataPlumber=null,this._actionManager=e,this._activeFrame=t,this._customerFeedbackFormManager=n,this._settingsManager=r,this.set_dataPlumber(o),h.AFrameworkApplication.add_errorDialogDisplayed(i.i(this,this.updateLastError,"updateLastError"))}return e.prototype.get_dataPlumber=function(){return this._dataPlumber||(h.AFrameworkApplication.dataPlumber||(h.AFrameworkApplication.dataPlumber=new T.b),this._dataPlumber=h.AFrameworkApplication.dataPlumber),this._dataPlumber},e.prototype.set_dataPlumber=function(e){return this._dataPlumber=e,e},e.prototype.updateLastError=function(e,t){if(null!=t){var n=t;n&&(this._mostRecentError=n.errorCode)}},e.prototype.registerActions=function(){this._actionManager.addAction(A.KO,E.a,i.i(this,this.giveFeedbackHandler,"giveFeedbackHandler")),this._actionManager.addAction(A.Sd,E.a,e.triggerFloodgateSurvey),this._activeFrame.updateCommandUI()},e.prototype.giveFeedbackHandler=function(e,t,n,i,r){if(1===n)return 32;if(2===n){d.ULS.sendTraceTag(8405838,356,50,""),this.get_dataPlumber().Feedback|=w.u.feedback_Attempted;var o=r||{};void 0!==o.ErrorCode&&null!==o.ErrorCode||null==this._mostRecentError||(o.ErrorCode=this._mostRecentError),h.AFrameworkApplication.appSettingsManager.addInfoForULS(o),this._customerFeedbackFormManager.launchFeedbackFormWhenAvailable(o)}return 32},e.triggerFloodgateSurvey=function(e,t,n,i,r){if(1===n)return 32;if(2===n&&!r)return 8;var o=r;return I.w.get_instance().resolveFuture(s.t).execute((function(e){e.logActivity((0,b.e)(String,o.ActivityName),(0,b.e)(String,o.BRSName))})),32},e}();(0,i.l)(k,"CustomerFeedbackActor",null,[]);var D=function(){function e(e,t,n){this._loadingJs=!1,this._jsDownloaded=!1,this._contextData=null,this._uiWrapper=null,this._resourceDownloadManager=null,this._dataPlumber=null,this._uiWrapper=e,this._resourceDownloadManager=t,this.set_dataPlumber(n)}return e.prototype.get_dataPlumber=function(){return this._dataPlumber||(h.AFrameworkApplication.dataPlumber||(h.AFrameworkApplication.dataPlumber=new T.b),this._dataPlumber=h.AFrameworkApplication.dataPlumber),this._dataPlumber},e.prototype.set_dataPlumber=function(e){return this._dataPlumber=e,e},e.prototype.launchFeedbackFormWhenAvailable=function(e){this._contextData=e,this.initOFeedbackIfDepsReady()||this.loadResources()},e.prototype.loadResources=function(){this._loadingJs||(this._loadingJs=!0,this._resourceDownloadManager.downloadJsResource(i.i(this,this.oFeedbackJsDownloadFinished,"oFeedbackJsDownloadFinished")))},e.prototype.oFeedbackJsDownloadFinished=function(e,t){e?(this._jsDownloaded=!0,this.get_dataPlumber().Feedback|=w.u.feedback_ResourcesDownloadSuccessful,this.initOFeedbackIfDepsReady(),d.ULS.sendTraceTag(7611924,356,100,"CF - JS downloaded")):(this.get_dataPlumber().Feedback|=w.u.feedback_ResourcesDownloadFailed,d.ULS.sendTraceTag(7611925,356,100,"CF - JS download failed")),this._loadingJs=!1},e.prototype.initOFeedbackIfDepsReady=function(){return!!this._jsDownloaded&&(this._uiWrapper.showUi(this._contextData),!0)},e.prototype.jsDownloaded=function(e){this._jsDownloaded=e},e.prototype.getJSDownloaded=function(){return this._jsDownloaded},e}();(0,i.l)(D,"CustomerFeedbackC3FormManager",null,[a]);var M=n(218),P=n(265),F=n(743),x=function(){function e(e){void 0===e&&(e=null),this._onJsDownloadFinished=null,this._callbackData=null,this._callbackData=e}return e.prototype.downloadJsResource=function(e){this._onJsDownloadFinished=e;var t="Feedback/officebrowserfeedback_floodgate.js";m()&&(t="Feedback/latest/officebrowserfeedback_floodgate.js");var n=F.h.commonScripts(t),r=(F.h.commonScriptsLocalized("OFeedbackIntl.js"),P.v.create(n));r.add_loadFinished(i.i(this,this.onJsDownloadFinished,"onJsDownloadFinished")),M.z.enqueueResourceWithoutEnabling(r),d.ULS.sendTraceTag(7611929,356,100,"CF - Downloading JS from: {0}",n)},e.prototype.setCallerData=function(e){this._callbackData?e&&this._callbackData.add(e):this._callbackData=e},e.prototype.onJsDownloadFinished=function(e,t){this._onJsDownloadFinished(t.get_succeeded(),this._callbackData)},e}();(0,i.l)(x,"CustomerFeedbackResourceDownloadManager",null,[r]);var R=n(600),B=function(){function e(){this.audienceGroup=null,this.ringId=0,this.ocvEnvironment=0}return e.prototype.isProd=function(){return!this.ocvEnvironment},e}();(0,i.l)(B,"OCVData",null,[]);var L=n(751),N=n(197),U=n(124),O=n(508),H=function(e){function t(t){var n=e.call(this)||this;return n.submitted=!1,n.submitted=t,n}return(0,O.t)(t,e),t.prototype.get_submitted=function(){return this.submitted},t}(Sys.EventArgs);(0,i.l)(H,"OnFeedbackUiDismisedArgs",Sys.EventArgs,[]);var W=n(806),V=n(327),$=n(246),K=n(484),z=n(809),q=n(577),Q=n(657),G=n(830),j=n(25),Z=function(){return function(){this.target=null,this.content=null,this.title=null,this.primaryButtonProps=null,this.secondaryButtonProps=null,this.showCloseIcon=null,this.calloutProps=null,this.hasFocusableControls=null,this.useTeachingStyles=null}}();(0,i.l)(Z,"CalloutParameters",null,[]);var X=n(575),J=n(26),Y=n(0),ee=function(){return function(e,t){this.id=null,this.customProps=null,this.id=e,this.customProps=t}}();(0,i.l)(ee,"CustomContentProps",null,[]);var te=function(){return function(){this.isBeakVisible=null,this.directionalHint=null,this.gapSpace=null,this.setInitialFocus=null,this.onDismiss=null,this.preventDismissOnScroll=null,this.preventDismissOnResize=null,this.preventDismissOnLostFocus=null}}();(0,i.l)(te,"ICalloutProps",null,[]);var ne=n(55),ie=function(){function e(){}return e.prototype.get_type=function(){return"CustomControlProps"},e}();(0,i.l)(ie,"CustomProps",null,[]);var re=function(e){function t(t,n,i,r){var o=e.call(this)||this;return o.prompt=null,o.question=null,o.buttonPropsList=null,o.maxWidth=0,o.privacyStatement=null,o.privacyStatementLink=null,o.prompt=t,o.question=n,o.buttonPropsList=i,o.maxWidth=r,o.privacyStatement=CommonUIStrings.l_WAC_NPS_PrivacyPolicy,o.privacyStatementLink="http://go.microsoft.com/fwlink/?LinkID=390004",o}return(0,O.t)(t,e),t}(ie);(0,i.l)(re,"NpsOneClickCustomProps",ie,[]);var oe=function(){function e(){}return e.init=function(e,t,n,i,r){r.onDismiss=e,r.onError=t;var o=null;OfficeBrowserFeedback.initOptions?o=r:OfficeBrowserFeedback.initOptions=r,OfficeBrowserFeedback.multiFeedback(o).then((function(){d.ULS.sendTraceTag(36300302,356,100,"BFCOCV Success calling OCV Feedback")})).catch((function(e){return d.ULS.sendTraceTag(36300303,356,10,"BFCOCV Error:"+e.toString())}))},e.initSIFeedback=function(t,n,i,r){if(d.ULS.sendTraceTag(36546398,356,50,"BFCOCV.Entered InitSIFeedback"),e._initState===e.initialized)return Promise.resolve(1);if(e._initState===e.initializing)return e.initializingMsgLogged||(e.initializingMsgLogged=!0,d.ULS.sendTraceTag(36546399,356,15,"BFCOCV.InitSIFeedback:Initializing")),Promise.resolve(0);if(e._initState!==e.error){if(e._initState=e.initializing,d.ULS.sendTraceTag(36546400,356,50,"BFCOCV.InitSIFeedback:past init check"),e.initSIContext(t,n,i,r))return e.initFloodgate();e._initState=e.error,Promise.reject(e.ofbUndefinedMsg)}return Promise.reject(0)},e.initFloodgate=function(){return OfficeBrowserFeedback.floodgate.initialize().then((function(t){return e.startFloodgate()})).catch((function(e){d.ULS.sendTraceTag(36546402,356,10,"BFCOCV Floodgate initialize error:"+e.toString())}))},e.startFloodgate=function(){return OfficeBrowserFeedback.floodgate.start().then((function(){e.floodgateInitCompleted()})).catch((function(e){d.ULS.sendTraceTag(36546401,356,10,"BFCOCV Floodgate start error:"+e.toString())}))},e.floodgateInitCompleted=function(){e._initState=e.initialized,d.ULS.sendTraceTag(36546403,356,50,"BFCOCV.Started floodgate")},e.officeBrowserFeedbackIsUndefined=function(){return"undefined"==typeof OfficeBrowserFeedback},e.initSIContext=function(t,n,i,r){var o=!0;try{if(e.officeBrowserFeedbackIsUndefined())return d.ULS.sendTraceTag(39900617,356,15,e.ofbUndefinedMsg),!1;OfficeBrowserFeedback.initOptions||(i.onDismiss=r,i.onError=n,OfficeBrowserFeedback.initOptions=i);var a=e.onSurveyActivated,s={},l={};l.onSurveyActivated=a,l.onTeachingCampaignRender=i.onTeachingCampaignRender,s.onSurveyActivatedCallback=l,s.onDismiss=t,s.autoDismiss=i.FloodgateUIAutoDismissTimeEnum,s.uIStringGetter=i.uIStringGetter,s.authTokenCallback=i.authTokenCallback,s.campaignFlights="";var u=e.getCurrentFlights(i),c=e.getFloodgateFlightParameters(u),p=e.getDefaultCampaignQueryParameters(i);for(var h in c){var g={key:h,value:c[h]};-1!==g.key.toLowerCase().indexOf("flight")?s.campaignFlights+=g.value+";":p=p+g.key+"="+g.value+"&"}d.ULS.sendTraceTag(50422099,356,50,"campaignFlights: "+s.campaignFlights+" campaignQueryParameters: "+p),s.campaignQueryParameters=p,OfficeBrowserFeedback.floodgate.initOptions=s}catch(e){o=!1,d.ULS.sendTraceTag(39900618,356,15,e.toString())}return o},e.getCurrentFlights=function(e){var t=(0,b.e)(Array,e.Flights);if(!t){var n=h.AFrameworkApplication.appSettingsManager.getStringAppSetting("FlightId");t=n?n.toString().split(";"):null}return t},e.getFloodgateFlightParameters=function(t){var n={SelfTriggerActivity:""};try{for(var i=0;i<=e.maxFloodgateFlightIndex;i++){var r="FloodgateFlight"+i,o=e.getMatchingFlight(t,r+"-Treatment"),a=o?r+"Treatment":null;if(a||(a=(o=e.getMatchingFlight(t,r+"-Control"))?r+"Control":null),a){"AppFlights"in n?n.AppFlights+=";"+o:n.AppFlights=o;var s=h.AFrameworkApplication.appSettingsManager.getStringAppSetting(a);if(s)try{var l=_.d(s);if((l?l.SelfTriggerActivity:null)||(n.SelfTriggerActivity+=";"+a),l)for(var u in l){var c={key:u,value:l[u]};c.key in n?n[c.key]!==c.value&&(n[c.key]=n[c.key]+";"+c.value):n[c.key]=c.value}}catch(e){d.ULS.sendTraceTag(50422101,356,10,"Failed to parse the "+a+" json data",e.toString())}else n.SelfTriggerActivity+=";"+a,d.ULS.sendTraceTag(50422100,356,50,"settings for "+a+" is null")}}}catch(e){d.ULS.sendTraceTag(50422102,356,10,"Failed to get floodgate flight parameters for floodgateContext",e.toString())}return n},e.getMatchingFlight=function(e,t){if(e)for(var n=t.toLowerCase(),i=0;i<e.length;i++)if(e[i].toLowerCase().indexOf(n)>-1)return e[i];return null},e.getDefaultCampaignQueryParameters=function(e){var t="",n={OFC_Audience:"AudienceGroup",AppHostName:"Host",Datacenter:"WACDatacenter",UpsellMode:"FreemiumUpsellMode",TenantId:"TenantId"};for(var i in n){var r={key:i,value:n[i]},o=e[(0,b.e)(String,r.value)];o||(o=h.AFrameworkApplication.appSettingsManager.getStringAppSetting((0,b.e)(String,r.value))),o&&(t+=r.key+"="+encodeURIComponent(o)+"&")}return t},e.onSurveyActivated=function(t,n){if(t)if(d.ULS.sendTraceTag(36706399,356,50,"BFCOCV.onSurveyActivated"),h.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactNotificationsEnabled()&&h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NPS1ClickSurveyIsEnabled")&&n&&"customux"===n.getLauncherType()){h.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordNPS1ClickSurveySettings"),d.ULS.sendTraceTag(51197718,356,50,"BFCOCV.CustomLauncherType");var i=h.AFrameworkApplication.appSettingsManager.getStringAppSetting("NpsUxType");"npsoneclick1"===i?(d.ULS.sendTraceTag(51197719,356,50,"BFCOCV.ShowNPSOneClick1"),e.showNPSSurvey(n,"NPSOneClick1")):"npsoneclick2"===i?(d.ULS.sendTraceTag(51197720,356,50,"BFCOCV.ShowNPSOneClick2"),e.showNPSSurvey(n,"NPSOneClick2")):d.ULS.sendTraceTag(51197721,356,10,"BFCOCV.ShowNPSOneClickError")}else t.launch(),e.setupEventHandlersOnSurveyUI();else d.ULS.sendTraceTag(36706400,356,10,"BFCOCV.onSurveyActivated given a null launcher")},e.logActivity=function(t){if(e.checkParams(t,"LogActivity")){var n=e.getFloodgateListener();n&&(d.ULS.sendTraceTag(37856259,356,50,"BFCOCV.Calling OCV's logActivity "+t),n.logActivity(t))}},e.showUserInitiatedSurvey=function(t){t?(d.ULS.sendTraceTag(38605915,356,50,"BFCOCV.Calling OCV's showCustomSurvey"),OfficeBrowserFeedback.floodgate.showCustomSurvey(t),e.setupEventHandlersOnSurveyUI()):d.ULS.sendTraceTag(38605914,356,10,"BFCOCV.surveyJsonObject null:")},e.setupEventHandlersOnSurveyUI=function(){d.ULS.sendTraceTag(36706401,356,50,"BFCOCV.SetupEventHandlersOnSurveyUI"),e.addFocusScope(e.floodgateContainerID)},e.initializeFocusSettings=function(e,t,n,i,r,o,a,s,l,u,c,p){void 0===u&&(u=!0),void 0===c&&(c=!1),void 0===p&&(p=!1);var d=Q.FocusManager.instance(),h=d.getScope(e);if(h.parent=L.AFrame.mainAppFocusId,h.set_keyDownHandledExternally(p),q.F6Manager.get_instance().addF6(e,u),t&&h.addSetFocus(t),n&&h.addOnFocus(n),i&&h.addOnBlur(i),r&&(G.p.get_instance().addControlFocus(e,r,o,c),j.v.get_instance().addControlFocus(e,r,o,c),a)){for(var g=new N.DOMFocusListing((function(){return r})),m=0;m<s.length;++m)g.addValidTag(s[m]);d.buildRegionWithDelegate((function(){return r}),h,g).looped=l}return h},e.addFocusScope=function(t){var n=document.getElementById(t);if(n)e.initializeFocusSettings(t,null,e.onFocusAction,null,n,!1,!0,[3,2,5,1],!0,!0,!0,!0);else d.ULS.sendTraceTag(36706402,356,10,"BFCOCV.Could not find container "+t)},e.onFocusAction=function(e,t){if(d.ULS.sendTraceTag(37107265,356,100,"BFCOCV.OnFocusAction. PrevScopeName "+(e?e.name:"")+" NextScopeName "+(t?t.name:"")),t){var n=Q.FocusManager.instance().getRegion(t.name);n&&n.moveIntoFromTop()}},e.logActivityStart=function(t){if(e.checkParams(t,"LogActivityStart")){var n=e.getFloodgateListener();n&&(d.ULS.sendTraceTag(37856260,356,50,"BFCOCV.Calling OCV's logActivityStartTime "+t),n.logActivityStartTime(t))}},e.logActivityEnd=function(t){if(e.checkParams(t,"LogActivityEnd")){var n=e.getFloodgateListener();n&&(d.ULS.sendTraceTag(37856262,356,50,"BFCOCV.Calling OCV's logActivityStopTime "+t),n.logActivityStopTime(t,new Date))}},e.floodgateStart=function(){OfficeBrowserFeedback.floodgate.start()},e.floodgateStop=function(){OfficeBrowserFeedback.floodgate.stop()},e.checkParams=function(e,t){return e||d.ULS.sendTraceTag(36546433,356,10,"BFCOCV.Error. null 'name' in method "+t),!!e},e.getFloodgateListener=function(){var t=null,n=OfficeBrowserFeedback.floodgate.getEngine();return n?(t=n.getActivityListener())||d.ULS.sendTraceTag(36546434,356,10,"BFCOCV.Error floodgate listener null"):e.nullFloodgateEngineMsgLogged||(e.nullFloodgateEngineMsgLogged=!0,d.ULS.sendTraceTag(36546435,356,15,"BFCOCV.Error floodgate engine null")),t},e.submitRating=function(e,t,n){n.setSelectedRatingIndex(e),t.submit(),d.ULS.sendTraceTag(51197722,356,50,"BFCOCV.NPS1ClickResponse_Submitted")},e.showNPSSurvey=function(t,n){return ne.UISurfaces.getNotificationsAPIAsync().then((function(i){for(var r=null,o=t.getComponent("Rating"),a=t.getComponent("Prompt"),s=o.getQuestion(),l=a.getQuestion(),u=o.getRatingValuesAscending(),c=function(n){return function(){r&&(e.submitRating(n,t,o),i.removeNotification(r))}},p=new Array(u.length),h=0;h<p.length;h++)p[h]=new Y.g(u[h],c(h));var g=(0,z.m)(new J.t,{telemetryId:String.format("NPSSurvey-{0}",n),expirationOptions:(0,z.m)(new X.t,{displayTimeoutSeconds:e.customUxAutoDismiss,onExpire:function(){r&&(i.removeNotification(r),d.ULS.sendTraceTag(51197723,356,50,"BFCOCV.NPS1ClickResponse_Expired"))}})}),m=document.getElementById("WACStatusBarContainer"),_=new ee(n,new re(l,s,p,e.customUxMaxWidth)),f=(0,z.m)(new Z,{target:m,content:_,showCloseIcon:!0,calloutProps:(0,z.m)(new te,{directionalHint:2,isBeakVisible:!1,preventDismissOnResize:!0})}),y=i.callout(f);return r=i.addNotification(y,g),null})).catch((function(e){d.ULS.sendTraceTag(51197724,356,10,"BFCOCV React Notification Error:"+e.toString())}))},e.floodgateContainerID="obf-ToastContainer",e.notInitialized=0,e.initializing=1,e.initialized=2,e.error=-1,e.maxFloodgateFlightIndex=10,e._initState=e.notInitialized,e.nullFloodgateEngineMsgLogged=!1,e.initializingMsgLogged=!1,e.ofbUndefinedMsg="OFB still undefined",e.customUxMaxWidth=1200,e.customUxAutoDismiss=20,e}();(0,i.l)(oe,"BrowserFeedbackControlOCV",null,[]);var ae=n(586),se=n(556),le=function(){function e(t,n){this._focusManager=null,this.mainContentHolderId="obf-MainContentHolder",this.likeButtonId="obf-OverallSmileAnchor",this.privacyStatementLinkId="obf-PrivacyStatementLink",this.contactFormContainerId="obf-MiddleFormContainer",this.commentBoxId="obf-BasicFormComment",this.submitButtonId="obf-BasicFormSubmitButton",this.suggestionButtonId="officeBrowserFeedbackOverallSuggestDiv",this.userVoicePrivacyStatementLinkId="officeBrowserFeedbackUservoiceLinkFormAnchor",this.goToUserVoiceButtonId="officeBrowserFeedbackUservoiceLinkFormCloseButton",this.userVoiceFormContainerId="officeBrowserFeedbackUservoiceLinkFormContainer",this.visibleClassName="obf-visible",this._appSpecificFeedbackData=null,this._eventSource=null,this._dataPlumber=null,this._submitButton=null,this._gotoUserVoiceButton=null,this._userVoiceFormContainer=null,this._likeButton=null,this._commentBox=null,this._suggestionButton=null,this._userVoicePrivacyStatementLink=null,this._contactFormContainer=null,this._privacyStatementLink=null,this._mainContentHolder=null,this._feedbackTabHandlerEnabled=!1,this._checkLikeButtonIntervalId=e.resetIntervalId,this._checkMainContentHolderIntervalId=e.resetIntervalId,this._feedbackTabHandlerEnabled=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FeedbackTabHandlerEnabled"),this._focusManager=t,this.set_dataPlumber(n),this._eventSource=new ae.f}return e.prototype.get_dataPlumber=function(){return this._dataPlumber||(h.AFrameworkApplication.dataPlumber||(h.AFrameworkApplication.dataPlumber=new T.b),this._dataPlumber=h.AFrameworkApplication.dataPlumber),this._dataPlumber},e.prototype.set_dataPlumber=function(e){return this._dataPlumber=e,e},e.prototype.get_submitButton=function(){return this._submitButton||(this._submitButton=document.getElementById(this.submitButtonId))},e.prototype.get_goToUserVoiceButton=function(){return this._gotoUserVoiceButton||(this._gotoUserVoiceButton=document.getElementById(this.goToUserVoiceButtonId))},e.prototype.get_userVoiceFormContainer=function(){return this._userVoiceFormContainer||(this._userVoiceFormContainer=document.getElementById(this.userVoiceFormContainerId))},e.prototype.get_likeButton=function(){return this._likeButton||(this._likeButton=document.getElementById(this.likeButtonId))},e.prototype.get_commentBox=function(){return this._commentBox||(this._commentBox=document.getElementById(this.commentBoxId))},e.prototype.get_suggestionButton=function(){return this._suggestionButton||(this._suggestionButton=document.getElementById(this.suggestionButtonId))},e.prototype.get_userVoicePrivacyStatementLink=function(){return this._userVoicePrivacyStatementLink||(this._userVoicePrivacyStatementLink=document.getElementById(this.userVoicePrivacyStatementLinkId))},e.prototype.get_contactFormContainer=function(){return this._contactFormContainer||(this._contactFormContainer=document.getElementById(this.contactFormContainerId))},e.prototype.get_privacyStatementLink=function(){return this._privacyStatementLink||(this._privacyStatementLink=document.getElementById(this.privacyStatementLinkId))},e.prototype.get_mainContentHolder=function(){return this._mainContentHolder||(this._mainContentHolder=document.getElementById(this.mainContentHolderId))},e.prototype.add_onFeedbackUiDismissed=function(t){this._eventSource.addHandler(e.onFeedbackUiDismissedEventId,t)},e.prototype.remove_onFeedbackUiDismissed=function(t){this._eventSource.removeHandler(e.onFeedbackUiDismissedEventId,t)},e.prototype.clearCachedElements=function(){this._submitButton=null,this._gotoUserVoiceButton=null,this._userVoiceFormContainer=null,this._likeButton=null,this._commentBox=null,this._suggestionButton=null,this._userVoicePrivacyStatementLink=null,this._contactFormContainer=null,this._privacyStatementLink=null,this._mainContentHolder=null},e.prototype.get_appSpecificFeedbackData=function(){return this._appSpecificFeedbackData||(this._appSpecificFeedbackData=I.w.get_instance().resolve(l))},e.prototype.isElementVisible=function(e){return!!e&&e.className.toLowerCase().indexOf(this.visibleClassName.toLowerCase())>=0},e.prototype.showUi=function(t){if(h.AFrameworkApplication.showFeedbackButton){var n=t||{};this.getContext(n);var r=e.determineFeedbackUlsCategory(n.AppMode||"Unknown");oe.init(i.i(this,this.onDismiss,"onDismiss"),i.i(this,this.onError,"onError"),356,r,n),this.initializeFocus(),e.allowKeytips(!1),d.ULS.sendTraceTag(7948385,356,50,"Successfully opened feedback form and set focus."),this.get_dataPlumber().Feedback|=w.u.feedback_Opened}else d.ULS.sendTraceTag(37856257,356,15,"ShowFeedbackButton is false, but ShowUi got called, some feedback entry point is still visible")},e.prototype.copyApplicationSpecificData=function(e,t){var n=this.get_appSpecificFeedbackData().getAppData(t);if(n&&e)for(var i in n){var r={key:i,value:n[i]};r.key in e?d.ULS.sendTraceTag(37234574,356,15,"appdata key "+r.key+" exists, not overwriting"):e[r.key]=n[r.key]}},e.prototype.fillUserEmail=function(e,t){if(t&&t.ringId<=2){var n=h.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName");n&&n.length>0&&(e.userEmail=n),e.userEmailConsentDefault=!0}else e.userEmail=""},e.prototype.getAppData=function(e){var t={App:e.Application||"",AppMode:e.AppMode||"",AppModeExt:e.ApplicationMode||"",Host:e.Host||"",Language:e.locale,IsError:e.Error||!1,IsCrash:e.Crash||!1,ServerDocId:e.ServerDocId||""};e.ErrorCode&&""!==e.ErrorCode.toString()&&(t.IsError=!0),"Origin"in e&&(t.Origin=e.Origin),this.copyApplicationSpecificData(t,e);var n=null;try{n=_.w(t),n=se.l.encodeString(n,se.l.jsonEscapedCharacters)}catch(e){n="",d.ULS.sendTraceTag(39077268,356,10,"Exception trying to serialize appData:"+e.message)}return{appData:n||""}},e.prototype.getCommonContext=function(t,n){if(!t||!n)return null;t.LanguageID?t.locale=K.i.getCultureInfo(t.LanguageID).get_name()||"":t.ApplicationLCID&&(t.locale=t.ApplicationLCID),t.applicationGroup=this.getAppData(t),e.determineOCVData(n,t),t.appId=e.determineOCVFeedbackAppId(),t.environment=n.ocvEnvironment,m()?(t.stylesUrl=F.h.commonScripts("Feedback/latest/officebrowserfeedback.css"),t.intlUrl=F.h.commonScriptsPath("Feedback/latest/Intl/")):(t.stylesUrl=F.h.commonScripts("Feedback/officebrowserfeedback.css"),t.intlUrl=F.h.commonScriptsPath("Feedback/Intl/")),t.rtl=h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("Rtl")?"rtl":"ltr";var i=e.determineOCVFeedbackAppColor();t.primaryColour=i.primaryColour,t.secondaryColour=i.secondaryColour,t.sessionId=t.SessionID||t.WACSessionID||"",t.build=t.ApplicationVersion||t.WFEVersion||"";var r=t.FlightIDs?t.FlightIDs.toString():t.Flights?t.Flights.toString():"",o="";t.ErrorCode&&(o=t.ErrorCode.toString());var a=this.getPlatform(t),s=n.isProd()?h.AFrameworkApplication.appSettingsManager.getStringAppSetting("TenantId"):"";s||(s="");var l={audienceGroup:n.audienceGroup,flights:r,platform:a,ringId:n.ringId,officeUILang:h.AFrameworkApplication.lcid,errorCode:o};if(s.length>0&&"84df9e7f-e9f6-40af-b435-aaaaaaaaaaaa"!==s&&(l.tenantId=s),t.telemetryGroup=l,t.webGroup={browser:t.Browser||"",browserVersion:(t.BrowserMajorVersion||"")+"."+(t.BrowserMinorVersion||""),dataCenter:t.Datacenter||t.WACDatacenter||""},"Production"===n.audienceGroup){var u=e.determineUserVoiceUrls();u&&(t.userVoice=u)}return this.fillUserEmail(t,n),t},e.prototype.getContext=function(e){var t=e||this.getContextFromAppSettings(),n=new B;return this.getCommonContext(t,n),t},e.prototype.getPlatform=function(e){var t="";return e.Platform&&(t=e.Platform.toString()),e.PlatformMajorVersion&&(t.length>0&&(t+=" "),t+=e.PlatformMajorVersion.toString()+"."),e.PlatformMinorVersion&&(t+=e.PlatformMinorVersion.toString()),t},e.prototype.standardizeKeyNames=function(e){e.ApplicationMode&&(e.AppMode=e.ApplicationMode),e.ApplicationModeExtended&&(e.ApplicationMode=e.ApplicationModeExtended)},e.prototype.getContextFromAppSettings=function(){var e;try{e=_.b(h.AFrameworkApplication.appSettingsManager.get_appSettings().SessionStartInfoJson.toString()),this.standardizeKeyNames(e)}catch(t){d.ULS.sendTraceTag(36794389,356,10,"Could not deserialize SessionStartInfoJson"),e={}}return e},e.prototype.onError=function(t){d.ULS.sendTraceTag(37259477,356,10,"FB submit error: "+t),this.get_dataPlumber().Feedback|=w.u.feedback_Error,e.allowKeytips(!0)},e.prototype.doNPSTestAction=function(){if(e.isNPSLocalizationTestingSession()){d.ULS.sendTraceTag(40112215,356,50,e.npsTestActivityFlightBRS);var t=I.w.get_instance().resolve(s.t);t&&t.logActivity("AppUsageNPSLocalizationTest",null)}},e.prototype.onDismiss=function(t){this.removeFocus(),this.clearCachedElements(),W.j.oldActionsPipelineIsEnabled()&&d.ULS.sendTraceTag(34936718,356,50,"FB dismiss"),W.j.isUserActionLoggingToOtelEnabled()&&U.b(t?A.cp:A.fd,!0,null,2,8),t?(W.j.oldActionsPipelineIsEnabled()&&d.ULS.sendTraceTag(34936719,356,15,"FB submit"),this.get_dataPlumber().Feedback|=w.u.feedback_Submitted):(this.get_dataPlumber().Feedback|=w.u.feedback_Cancelled,this.doNPSTestAction()),this._eventSource.raiseEvent(e.onFeedbackUiDismissedEventId,new H(t)),e.allowKeytips(!0)},e.prototype.initializeFocus=function(){var t=this;if(this._focusManager){var n=!1,i=5,r=!1;this.clearInterval((0,R.m)((function(){return t._checkMainContentHolderIntervalId}),(function(e){return t._checkMainContentHolderIntervalId=e}))),this.clearInterval((0,R.m)((function(){return t._checkLikeButtonIntervalId}),(function(e){return t._checkLikeButtonIntervalId=e}))),this._checkLikeButtonIntervalId=window.setInterval((function(){if(t.get_likeButton()){r=!0;var o=t._focusManager.getScope(e.customerFeedbackFocusId);if(o.set_keyDownHandledExternally(!0),o.parent=L.AFrame.mainAppFocusId,o.addDispose(e.customerFeedbackScopeDispose),o.addSetFocus((function(){var n=t._focusManager.getRegion(e.customerFeedbackFocusId),i=null,r=5,o=!1;t._checkMainContentHolderIntervalId=window.setInterval((function(){t.isElementVisible(t.get_mainContentHolder())&&(o=!0,t.get_likeButton().focus(),n||(n=t._focusManager.getRegion(e.customerFeedbackFocusId)),n&&!i&&(i=n.listing),i&&i.trySetCurrentElement(t.get_likeButton())),r--,!o&&r||t.clearInterval((0,R.m)((function(){return t._checkMainContentHolderIntervalId}),(function(e){return t._checkMainContentHolderIntervalId=e})))}),1e3)})),n||(t._focusManager.pushScope(e.customerFeedbackFocusId,!0),n=!0),t._feedbackTabHandlerEnabled&&t.get_mainContentHolder()){var a=new N.DOMFocusListing((function(){return t.get_mainContentHolder()}));a.addValidTag(1),a.addValidTag(2),a.addValidTag(3),a.addValidTag(5);var s=t._focusManager.buildRegionWithDelegate((function(){return t.get_mainContentHolder()}),t._focusManager.getScope(e.customerFeedbackFocusId),a);s.rememberFocusStealers(),s.looped=!0,s.contained=!0,s.moveIntoRestore()}}i--,!r&&i||t.clearInterval((0,R.m)((function(){return t._checkLikeButtonIntervalId}),(function(e){return t._checkLikeButtonIntervalId=e})))}),1e3)}},e.prototype.clearInterval=function(t){t.val!==e.resetIntervalId&&(window.clearInterval(t.val),t.val=e.resetIntervalId)},e.prototype.removeFocus=function(){this._focusManager&&(this._focusManager.popScope(e.customerFeedbackFocusId),this._focusManager.removeScope(e.customerFeedbackFocusId))},e.allowKeytips=function(e){h.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&V.apiExists("allowKeytips")&&appChrome.api.allowKeytips(e)},e.determineOCVData=function(e,t){if(t){if(e.ringId=parseInt(t.Ring),isNaN(e.ringId))e.audienceGroup="Unknown",e.ringId=-2;else switch(e.ringId){case 0:case 1:e.audienceGroup="Dogfood";break;case 2:e.audienceGroup="Microsoft";break;case 3:case 4:case 5:case 6:e.audienceGroup="Production";break;default:e.audienceGroup="Unknown"}var n=!0;t.Host&&(n="MsInternal"!==t.Host&&"Blue Chicken"!==t.Host),e.ocvEnvironment=n?0:1}},e.determineOCVFeedbackAppId=function(){var e=0;switch($.Redirect.application){case 2:e=2155;break;case 4:e=2158;break;case 3:e=2157;break;case 1:e=2156;break;case 5:e=2159;break;default:d.ULS.sendTraceTag(34723679,356,10,"Unexpected Application: {0}",$.Redirect.application.toString())}return e},e.determineOCVFeedbackAppColor=function(){var e={},t="#2B579A",n="#3C65A4";switch($.Redirect.application){case 2:t="#2B579A",n="#3C65A4";break;case 4:t="#7719AA",n="#9953C0";break;case 3:t="#B7472A",n="#C75033";break;case 1:t="#217346",n="#3F8159";break;case 5:t="#3955A3",n="#4D6AB8";break;default:d.ULS.sendTraceTag(36230303,356,10,"Unexpected Application: {0}",$.Redirect.application.toString())}return e.primaryColour=t,e.secondaryColour=n,e},e.determineUserVoiceUrls=function(){var e=null,t=null,n=null;switch($.Redirect.application){case 2:e="https://word.uservoice.com/forums/271331-word-online",t="https://word.uservoice.com/tos",n="https://word.uservoice.com/tos#privacy-policy";break;case 4:e=" https://onenote.uservoice.com/forums/327183-onenote-online",t="https://onenote.uservoice.com/tos",n="https://onenote.uservoice.com/tos#privacy-policy";break;case 3:e="https://powerpoint.uservoice.com/forums/270149-powerpoint-online",t="https://powerpoint.uservoice.com/tos",n="https://powerpoint.uservoice.com/tos#privacy-policy";break;case 1:e="https://excel.uservoice.com/forums/274580-excel-online",t="https://excel.uservoice.com/tos",n="https://excel.uservoice.com/tos#privacy-policy";break;case 5:e="https://visio.uservoice.com/forums/368199-visio-online",t="https://visio.uservoice.com/tos",n="https://visio.uservoice.com/tos#privacy-policy";break;default:d.ULS.sendTraceTag(36718029,356,10,"Unexpected Application: {0}",$.Redirect.application.toString())}var i=null;return e&&t&&n&&((i={}).url=e,i.termsOfServiceUrl=t,i.privacyPolicyUrl=n),i},e.determineFeedbackUlsCategory=function(e){var t=356;switch($.Redirect.application){case 2:switch(e){case"Edit":t=364;break;case"View":case"Attendee":case"Presenter":t=363;break;default:d.ULS.sendTraceTag(7652195,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Word Online View Mode",h.AFrameworkApplication.get_activeFrame().get_modeName()),t=363}break;case 4:t=362;break;case 3:switch(e){case"Edit":t=361;break;case"View":case"Attendee":case"Presenter":case"Outline":case"":t=360;break;default:d.ULS.sendTraceTag(7652224,356,15,"Unexpected ModeName: {0}. Setting ULSCat to PowerPoint Online View Mode",h.AFrameworkApplication.get_activeFrame().get_modeName()),t=360}break;case 1:switch(e){case"Edit":t=358;break;case"View":t=357;break;case"Survey":t=359;break;default:d.ULS.sendTraceTag(7652225,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Excel Online View Mode",h.AFrameworkApplication.get_activeFrame().get_modeName()),t=357}break;case 5:switch(e){case"View":t=373;break;case"Edit":t=374;break;default:d.ULS.sendTraceTag(18158298,356,15,"Unexpected ModeName: {0}. Setting ULSCat to Visio Online View Mode",h.AFrameworkApplication.get_activeFrame().get_modeName()),t=373}break;default:d.ULS.sendTraceTag(7652226,356,10,"Unexpected Application: {0}",$.Redirect.application.toString())}return t},e.customerFeedbackScopeDispose=function(){d.ULS.sendTraceTag(38572302,356,50,"CustomerFeedbackScope is disposed")},e.isNPSLocalizationTestingSession=function(){if(!e.npsLocalizationTestingSession){var t=!!h.AFrameworkApplication.appSettingsManager&&h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e.npsTestActivityFlightBRS);e.npsLocalizationTestingSession=t?2:1}return 2===e.npsLocalizationTestingSession},e.customerFeedbackFocusId="CustomerFeedbackFocusId",e.onFeedbackUiDismissedEventId="FUID",e.resetIntervalId=-1,e.npsLocalizationTestingSession=0,e.npsTestActivityFlightBRS="NPSLocalizationTestingIsEnabled",e}();(0,i.l)(le,"CustomerFeedbackUiWrapper",null,[o]);var ue=n(790),ce=n(201),pe=function(){function e(e,t,n,i){this._callbackWithString=null,this._activityName=null,this._callbackWithObject=null,this._obj=null,this._callbackWithString=e,this._activityName=t,this._callbackWithObject=n,this._obj=i}return e.prototype.callBackWithString=function(){return this._callbackWithString},e.prototype.callBackWithObject=function(){return this._callbackWithObject},e.prototype.activityName=function(){return this._activityName},e.prototype.object=function(){return this._obj},e}();(0,i.l)(pe,"OneCallBackData",null,[]);var de=function(){function e(e,t,n,i){this._callbacksData=[],Array.add(this._callbacksData,new pe(e,t,n,i))}return e.prototype.add=function(e){e&&Array.addRange(this._callbacksData,e._callbacksData)},e.prototype.getCallbacksData=function(){return this._callbacksData},e.prototype.clearCallbacksData=function(){Array.clear(this._callbacksData)},e}();(0,i.l)(de,"CallBackData",null,[]);var he=function(e){function t(t){return e.call(this,"FloodgateTeachingCallout",t)||this}return(0,O.t)(t,e),t}(ee);(0,i.l)(he,"FloodgateCalloutContent",ee,[]);var ge=function(e){function t(){var t=e.call(this)||this;return t.smallHeadline=null,t.message=null,t.footer=null,t.image=null,t.positionImageAtLeft=!1,t}return(0,O.t)(t,e),t}(ie);(0,i.l)(ge,"FloodgateCalloutContentCustomProps",ie,[]);var me=function(){return function(){this.options=null,this.props=null}}();(0,i.l)(me,"Notification",null,[]);var _e=function(){return function(){this.label=null,this.onExecute=null,this.ariaDescription=null}}();(0,i.l)(_e,"CalloutButtonProps",null,[]);var fe=function(){return function(e){this.src=null,this.ariaLabel=null,this.alt=null,this.src=e}}();(0,i.l)(fe,"ImageProps",null,[]);var ye=function(){function e(){}return e.convertAndShowTeachingUx=function(t){return e.getReactFloodgateNotificationsEnabled().then((function(n){try{for(var i=new Array(0),r=0;r<t.length;r++){var o=t[r],a="coachmark"!==o.surfaceType,s=new me;s.options=e.getNotificationOptions(o,!a),s.props=a?n.callout(e.makeOneCallout(t[r])):n.externalNotification(),i.push(s)}return e.showFloodgateTeachingUx(n,i)}catch(e){throw Error.create("Failed to convert and show teaching UX using WAC notifications: "+e.message)}}))},e.getNotificationOptions=function(e,t){var n=new J.t;return t&&(n.onShow=e.onUnsupportedSurfaceType),null!=e.timeout&&(n.expirationOptions=(0,z.m)(new X.t,{displayTimeoutSeconds:e.timeout/1e3,onExpire:function(){e.onClosed&&e.onClosed("auto dismiss")}})),n},e.makeOneCallout=function(t){var n=new he((0,z.m)(new ge,{footer:t.footer,image:t.illustrationImage?(0,z.m)(new fe(t.illustrationImage),{ariaLabel:t.imageAriaLabel}):null,message:t.description,positionImageAtLeft:"left"===t.position,smallHeadline:t.smallHeadline}));return(0,z.m)(new Z,{target:t.selector,title:t.title,primaryButtonProps:e.getCalloutButton(t.primaryButtonText,t.primaryButtonAction),secondaryButtonProps:e.getCalloutButton(t.secondaryButtonText,t.secondaryButtonAction),content:n,showCloseIcon:!0,useTeachingStyles:!0,calloutProps:(0,z.m)(new te,{onDismiss:function(){t.onClosed&&t.onClosed("close")},directionalHint:t.anchorHint})})},e.getCalloutButton=function(e,t){return e&&""!==e&&t?(0,z.m)(new _e,{label:e,onExecute:t}):(d.ULS.shipAssertTag(594569111,356,!(e&&""!==e||t),"A callout button needs both a caption and an action."),null)},e.getReactFloodgateNotificationsEnabled=function(){return e.floodgateUxEnabledPromise||(h.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactNotificationsEnabled()&&h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacFloodgateNotificationsIntegrationIsEnabled")?e.floodgateUxEnabledPromise=ne.UISurfaces.getNotificationsAPIAsync().then((function(e){var t=new he(new ge);if(e.isCustomContentSupported&&e.isCustomContentSupported(t))return e;throw Error.create("Custom Content not supported: "+t.customProps.get_type())})):e.floodgateUxEnabledPromise=Promise.reject("React Notifications not enabled")),e.floodgateUxEnabledPromise},e.showFloodgateTeachingUx=function(t,n){if(!n||!n.length)return new Array(0);for(var i=new Array(0),r=0;r<n.length;r++){var o=n[r],a=e.showOneNotification(t,o);i.push(a)}return i},e.showOneNotification=function(e,t){var n=e.addNotification(t.props,t.options);return function(){e.removeNotification(n)}},e.floodgateUxEnabledPromise=null,e}();(0,i.l)(ye,"FloodgateNotifications",null,[]);var ve=function(e,t){var n=h.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName");return!!t.ocvData&&2===t.ocvData.ringId&&Se(n)},Se=function(e){return!!(e=e.toLowerCase())&&(e.indexOf("linkedin.com")>0||e.indexOf("linkedin.biz")>0)},Ce=function(){return function(e,t){this.ocvData=null,this.context=null,this.ocvData=e,this.context=t}}();(0,i.l)(Ce,"SurveyMetadata",null,[]);var be=n(574),Ae=n(550),Te=function(){function e(e){this.isInitialized=!1,this.isError=!1,this.floodgateEnabledInEnvironment=0,this._appSpecificFeedbackData=null,this.timeBasedSurveyActivityNames=null,this.floodgateUIStringMap=null,this.currentLocaleLowerCase=null,this.attemptedGettingCurrentLocale=!1,this.customerFeedbackUiWrapperObject=null,this.restrictedSurveyActivityMap=null,this.surveyMetadata=null,this.isEventListenerAdded=!1,this.postDownloadJsInitPromise=null,this.haveAccessToLocalStorage=!0,this.customerFeedbackUiWrapperObject=e,this.timeBasedSurveyActivityNames={},this.attemptedGettingCurrentLocale=!1,this.floodgateUIStringMap=null,this.restrictedSurveyActivityMap=null,this.floodgateEnabledInEnvironment=0}return e.prototype.initializeWACAppParameters=function(e){if(this.isInitialized||this.isError)return d.ULS.sendTraceTag(595142230,356,10,"SIFB: InitializeWACAppParameters called too late, its already initialized or in err state."),!1;if(null===e)return d.ULS.sendTraceTag(595142229,356,15,"SIFB: InitializeWACAppParameters was passed null param"),!1;var t=e.getAppSpecificFeedbackData();return null===t?(d.ULS.sendTraceTag(595142228,356,10,"SIFB: GetAppSpecificFeedbackData returned null"),!1):this._appSpecificFeedbackData?(d.ULS.sendTraceTag(595142227,356,10,"SIFB: _appSpecificFeedbackData was already set. Not setting it again"),!1):(this._appSpecificFeedbackData=t,d.ULS.sendTraceTag(595142226,356,50,"SIFB: _appSpecificFeedbackData successfully set via call to InitializeWACAppParameters"),!0)},e.prototype.initializeSurveyRestrictions=function(){var e=this.customerFeedbackUiWrapperObject.getContext(null),t=new B;le.determineOCVData(t,e),this.surveyMetadata=new Ce(t,e),this.restrictedSurveyActivityMap=new ue.d(String,Function,ce.b.get_ordinal()),this.restrictedSurveyActivityMap.set_item("LinkedInWACUsage",ve)},e.prototype.get_appSpecificFeedbackData=function(){return this._appSpecificFeedbackData||(this._appSpecificFeedbackData=I.w.get_instance().resolve(l))},e.prototype.logActivity=function(t,n){t&&this.floodgateEnabled(t,e.mainSIFBBrs,n)&&(this.isInitialized?(d.ULS.sendTraceTag(37754499,356,50,"SIFB: LogActivity "+t),oe.logActivity(t)):(d.ULS.sendTraceTag(37754500,356,50,"SIFB: LogActivity (initializing first) "+t),this.initializeFloodgateThenDoAction(new de(oe.logActivity,t,null,null))))},e.prototype.logActivityStart=function(t,n){t&&this.floodgateEnabled(t,e.mainSIFBBrs,n)&&(this.logActivityStartInternal(t,n),this.timeBasedSurveyActivityNames[t]=n)},e.prototype.logActivityStartInternal=function(t,n){this.floodgateEnabled(t,e.mainSIFBBrs,n)&&(this.isInitialized?(d.ULS.sendTraceTag(37754501,356,50,"SIFB: LogActivityStartInternal "+t),oe.logActivityStart(t)):(d.ULS.sendTraceTag(37754502,356,50,"SIFB: LogActivityStartInternal (initializing first) "+t),this.initializeFloodgateThenDoAction(new de(oe.logActivityStart,t,null,null))))},e.prototype.logActivityEnd=function(t,n){t&&this.isInitialized&&this.floodgateEnabled(t,e.mainSIFBBrs,n)&&(t in this.timeBasedSurveyActivityNames&&delete this.timeBasedSurveyActivityNames[t],this.logActivityEndInternal(t,n))},e.prototype.logActivityEndInternal=function(t,n){this.isInitialized&&this.floodgateEnabled(t,e.mainSIFBBrs,n)&&(d.ULS.sendTraceTag(37754503,356,50,"SIFB: LogActivityEndInternal "+t),oe.logActivityEnd(t))},e.prototype.showUserInitiatedSurvey=function(t,n){if(this.floodgateEnabled(t,e.mainSIFBBrs,n)){var i=this.get_appSpecificFeedbackData().getUserInitiatedSurvey(t);i&&(this.isInitialized?(d.ULS.sendTraceTag(38605911,356,50,"SIFB:ShowUserInitiatedSurvey "+t),oe.showUserInitiatedSurvey(i)):(d.ULS.sendTraceTag(38605912,356,50,"SIFB:ShowUserInitiatedSurvey (initializing first) "+t),this.initializeFloodgateThenDoAction(new de(null,null,oe.showUserInitiatedSurvey,i))))}},e.prototype.floodgateEnabled=function(e,t,n){return!this.isError&&(h.AFrameworkApplication.showFeedbackButton?!!this.isFloodgateEnabledInEnvironment()&&((this.currentLanguageEnabled(e)||this.isDynamicWebCampaignActivity(e))&&this.brSesEnabled(t,n)&&this.surveyRestrictionsSatisfied(e)):(d.ULS.sendTraceTag(37601796,356,50,"SIFB: All feedback/floodgate is disabled"),!1))},e.prototype.isFloodgateEnabledInRing=function(e){return 6!==e},e.prototype.isFloodgateEnabledInEnvironment=function(){if(0===this.floodgateEnabledInEnvironment){var e=this.customerFeedbackUiWrapperObject.getContext(null);this.floodgateEnabledInEnvironment=this.isFloodgateEnabledInRing(parseInt(e.Ring))?1:2,2===this.floodgateEnabledInEnvironment&&d.ULS.sendTraceTag(50389538,356,15,"SIFB: floodgate disabled in this environment")}return 1===this.floodgateEnabledInEnvironment},e.prototype.surveyRestrictionsSatisfied=function(e){return null===this.restrictedSurveyActivityMap&&this.initializeSurveyRestrictions(),!(e&&this.restrictedSurveyActivityMap&&this.restrictedSurveyActivityMap.containsKey(e))||this.restrictedSurveyActivityMap.get_item(e)(e,this.surveyMetadata)},e.prototype.getCurrentLocaleLowerCase=function(){if(!this.currentLocaleLowerCase&&!this.attemptedGettingCurrentLocale){this.attemptedGettingCurrentLocale=!0;var e=this.customerFeedbackUiWrapperObject.getContext(null);this.currentLocaleLowerCase="locale"in e?e.locale:"",this.currentLocaleLowerCase=this.currentLocaleLowerCase.toLowerCase()}return this.currentLocaleLowerCase},e.prototype.currentLanguageEnabled=function(e){if(this.currentLocaleLowerCase||(this.currentLocaleLowerCase=this.getCurrentLocaleLowerCase()),!(this.currentLocaleLowerCase&&this.currentLocaleLowerCase.length&&e&&e.length))return!1;var t="en-us"===this.currentLocaleLowerCase||le.isNPSLocalizationTestingSession();return!t&&this.isNPSActivity(e)&&(t=this.isNPSSupportedLanguage(this.currentLocaleLowerCase)),t},e.prototype.isNPSActivity=function(t){return t===this.get_appSpecificFeedbackData().getNPSUsageActivityName()||t===this.get_appSpecificFeedbackData().getNPSFollowupActivityName()||t===e.appUsageNPSOneClick||t===e.appUsageNPSOneClickTimeSatisfied},e.prototype.isDynamicWebCampaignActivity=function(e){return!!e&&-1!==e.toLowerCase().indexOf("floodgateflight")},e.prototype.isNPSSupportedLanguage=function(e){if(!e||!e.length)return!1;if(!h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacNPSLocalizedLanguagesEnabled"))return"en-us"===e;var t=!1;switch(e){case"en-us":case"es-es":case"ja-jp":case"en-gb":case"pt-br":case"nl-nl":case"de-de":case"fr-fr":case"sv-se":case"fi-fi":case"nb-no":case"da-dk":case"ru-ru":case"es-mx":case"pl-pl":case"zh-cn":case"zh-tw":case"it-it":case"ko-kr":t=!0}return t},e.prototype.brSesEnabled=function(e,t){return h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e)?!(t&&!h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting(t))||(d.ULS.sendTraceTag(36767233,356,50,"SIFB: FC BRS("+t+") is off"),!1):(d.ULS.sendTraceTag(36546386,356,50,"SIFB: Main SIF BRS("+e+") is off"),!1)},e.prototype.initializeFloodgateThenDoAction=function(e){try{this.downloadResources(e)}catch(e){d.ULS.sendTraceTag(50357646,356,10,"SIFB.Error:Download and initialize failed "+e)}},e.prototype.trySetCampaignTriggerData=function(e,t){var n=this.getLocalStorage();if(n)try{n.setItem(this.constructKey(e),t)}catch(e){}else d.ULS.sendTraceTag(36546387,356,10,"SIFB.Error:Trigger data !set, Storage.Local null");return!!n},e.prototype.getCampaignTriggerData=function(e){var t=this.getLocalStorage();if(t)try{return t.getItem(this.constructKey(e))}catch(e){}return null},e.prototype.removeCampaignTriggerData=function(e){var t=this.getLocalStorage();if(t)try{t.removeItem(this.constructKey(e))}catch(e){}},e.prototype.start=function(e){d.ULS.sendTraceTag(37623952,356,100,"SIFB: Start called "+this.isInitialized),this.isInitialized&&(oe.floodgateStart(),this.timeBasedSurveysStart())},e.prototype.stop=function(e){d.ULS.sendTraceTag(37623953,356,100,"SIFB: Stop called "+this.isInitialized),this.isInitialized&&(this.timeBasedSurveysEnd(),oe.floodgateStop())},e.prototype.timeBasedSurveysStart=function(){var e=this.timeBasedSurveyActivityNames;for(var t in e){var n={key:t,value:e[t]};this.logActivityStartInternal(n.key,n.value)}},e.prototype.timeBasedSurveysEnd=function(){var e=this.timeBasedSurveyActivityNames;for(var t in e){var n={key:t,value:e[t]};this.logActivityEndInternal(n.key,n.value)}},e.prototype.constructKey=function(e){return $.Redirect.application.toString()+e},e.prototype.downloadResources=function(e){d.ULS.sendTraceTag(36546388,356,100,"SIFB: Entered DownloadResources");var t=I.w.get_instance().resolve(a);if(t)if(t.getJSDownloaded())this.floodgateJsDownloadFinished(!0,e);else{var n=I.w.get_instance().resolve(r);n.setCallerData(e),n.downloadJsResource(i.i(this,this.floodgateJsDownloadFinished,"floodgateJsDownloadFinished"))}},e.prototype.floodgateJsDownloadFinished=function(e,t){var n=this;d.ULS.sendTraceTag(36546389,356,100,"SIFB: Entered FloodgateJsDownloadFinished. succeeded is "+e);var i="";if(t&&t.getCallbacksData()&&t.getCallbacksData().length>0&&(i=t.getCallbacksData()[0].activityName()),e)if(m()){if(this.isInitialized)return void this.doPostInitializationWork(t);!this.isError&&this.postDownloadJsInitPromise||(this.postDownloadJsInitPromise=this.postDownloadJsInit()),this.postDownloadJsInitPromise.then((function(){n.doPostInitializationWork(t)})).catch((function(e){return n.postDownloadJsInitFailure(i,e)}))}else this.postDownloadJsInit().then((function(){n.doPostInitializationWork(t)})).catch((function(e){return n.postDownloadJsInitFailure(i,e)}));else this.isError=!0,d.ULS.sendTraceTag(36546391,356,10,"SIFB Error:JS download failed. Activity name "+i)},e.prototype.postDownloadJsInitFailure=function(e,t){this.isError=!0,d.ULS.sendTraceTag(36546390,356,10,"SIFB Error: in post download init. Activity name "+e+". "+t.toString())},e.prototype.floodgateUIStringGetter=function(e){this.floodgateUIStringMap||this.initializeUIStringGetter();var t=e;return e&&e.length>0&&(t=this.floodgateUIStringMap.containsKey(e)?this.floodgateUIStringMap.get_item(e):e),t||""},e.prototype.postDownloadJsInit=function(){var t=I.w.get_instance().resolve(a);t&&t.jsDownloaded(!0),this.setupCampaigns(),this.setWindowEvents(),this.initOptions();var n=this.customerFeedbackUiWrapperObject.getContext(null);return n.FloodgateUIAutoDismissTimeEnum=e.getAutoDismissTimeEnum(),n.uIStringGetter=i.i(this,this.floodgateUIStringGetter,"floodgateUIStringGetter"),n.authTokenCallback=e.createAuthTokenHandler((0,b.e)(String,n.AudienceGroup)),n.onTeachingCampaignRender=ye.convertAndShowTeachingUx,oe.initSIFeedback(i.i(this,this.onSIFeedbackDismiss,"onSIFeedbackDismiss"),i.i(this.customerFeedbackUiWrapperObject,this.customerFeedbackUiWrapperObject.onError,"onError"),n,i.i(this.customerFeedbackUiWrapperObject,this.customerFeedbackUiWrapperObject.onDismiss,"onDismiss"))},e.prototype.doPostInitializationWork=function(e){if(this.isInitialized=!0,this.addWebCampaignUIEventListener(),e){for(var t=0,n=e.getCallbacksData();t<n.length;t++){var i=n[t];i.callBackWithString()?i.callBackWithString()(i.activityName()):i.callBackWithObject()?i.callBackWithObject()(i.object()):d.ULS.sendTraceTag(38605913,356,10,"SIFB Error:callerData callback actions were null")}e.clearCallbacksData()}else d.ULS.sendTraceTag(37623954,356,10,"SIFB Error:callerData was null");try{var r=this.customerFeedbackUiWrapperObject.getContext(null),o=oe.getFloodgateFlightParameters((0,b.e)(Array,r.Flights)),a=o?(0,b.e)(String,o.SelfTriggerActivity):null;if(a)for(var s=0,l=a.split(";");s<l.length;s++){var u=l[s];u&&""!==u&&this.logActivity(u,null)}}catch(e){d.ULS.sendTraceTag(51131788,356,10,"SIFB Error:error posting webactivities "+(e?e.toString():""))}},e.prototype.addWebCampaignUIEventListener=function(){if(!this.isEventListenerAdded&&window.addEventListener){var e=i.i(this,this.onWebCampaignEvent,"onWebCampaignEvent");window.addEventListener("FGWebSurfaceEvent",e,!0),this.isEventListenerAdded=!0}},e.prototype.onWebCampaignEvent=function(e){var t=e?e.detail:null;if(t){var n=(t.action||"").toLowerCase();switch(n){case"dismissed":q.F6Manager.get_instance().deactivateFocus("obf-DynamicWebSurfaces");break;case"updated":oe.addFocusScope("obf-DynamicWebSurfaces");break;case"opened":case"":var i=t.telemetryEventName,r=void 0;try{r=JSON.stringify(t)}catch(e){r="id : "+t.id+" telemetryEventName: "+i,d.ULS.sendTraceTag(51131789,341,50,"Error serializing campaign event. "+r+" Error: "+(e?e.toString():""))}t.success?(i&&h.AFrameworkApplication.logUniqueFlightedSettingUsage(i),d.ULS.sendTraceTag(50704975,341,50,"Web Campaign UI launched. "+r)):d.ULS.sendTraceTag(50422098,341,10,"Error launching Web Campaign UI."+r),oe.addFocusScope("obf-DynamicWebSurfaces");break;default:d.ULS.sendTraceTag(594626399,341,50,"Unrecognized action "+n)}}},e.prototype.setupCampaigns=function(){var t=!1,n=null,i=this.getLocalStorage();if(i)try{var r=this.get_appSpecificFeedbackData().getCampaignDefinitions();r?(i.setItem(e.campaignDefinitionKey,r),t=!0):(n="SIFB.campaign str was null",d.ULS.sendTraceTag(594143442,356,10,n))}catch(e){n="SIFB.Floodgate surveys !available. Exception writing to localStorage:SetupCampaigns: "+e,d.ULS.sendTraceTag(594143441,356,50,n)}else n="SIFB.Floodgate surveys !available. Campaign !set.Storage.Local was null",d.ULS.sendTraceTag(594143440,356,50,n);return d.ULS.sendTraceTag(37856258,356,50,"SIFB:Exiting SetupCampaigns "+t+" errorString: "+(n||"null")),t},e.prototype.onSIFeedbackDismiss=function(e,t){W.j.oldActionsPipelineIsEnabled()&&d.ULS.sendTraceTag(36546397,356,50,"SIFB.Floodgate dismissed, submitted:{0}, campaingId:{1}",t,e),W.j.isUserActionLoggingToOtelEnabled()&&U.b(t?A.qr:A.Ut,!0,null,2,8),q.F6Manager.get_instance().deactivateFocus(oe.floodgateContainerID)},e.prototype.initOptions=function(){},e.prototype.setWindowEvents=function(){Ae.n.addHandler(window.self,be.d.focus,i.i(this,this.start,"start")),Ae.n.addHandler(window.self,be.d.blur,i.i(this,this.stop,"stop"))},e.prototype.getLocalStorage=function(){if(!this.haveAccessToLocalStorage)return null;var e=null;try{e=localStorage}catch(t){this.haveAccessToLocalStorage=!1,e=null}return e},e.prototype.initializeUIStringGetter=function(){d.ULS.sendTraceTag(39077269,356,50,"inside InitializeUIStringGetter"),this.floodgateUIStringMap=new ue.d(String,String,ce.b.get_ordinalIgnoreCase()),this.floodgateUIStringMap.set_item("nps_Title",CommonUIStrings.l_WAC_NPS_Title),this.floodgateUIStringMap.set_item("nps_PromptQuestion",CommonUIStrings.l_WAC_NPS_PromptQuestion),this.floodgateUIStringMap.set_item("nps_RatingQuestion",CommonUIStrings.l_WAC_NPS_RatingQuestion),this.floodgateUIStringMap.set_item("nps_RatingQuestion_Word",CommonUIStrings.l_WAC_NPS_RatingQuestion_Word),this.floodgateUIStringMap.set_item("nps_RatingQuestion_OneNote",CommonUIStrings.l_WAC_NPS_RatingQuestion_OneNote),this.floodgateUIStringMap.set_item("nps_OneClickPromptQuestion_PPT",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_PPT),this.floodgateUIStringMap.set_item("nps_RatingQuestion_PowerPoint",CommonUIStrings.l_WAC_NPS_RatingQuestion_PowerPoint),this.floodgateUIStringMap.set_item("nps_RatingQuestion_Excel",CommonUIStrings.l_WAC_NPS_RatingQuestion_Excel),this.floodgateUIStringMap.set_item("nps_RatingQuestion_Visio",CommonUIStrings.l_WAC_NPS_RatingQuestion_Visio),this.floodgateUIStringMap.set_item("nps_Rating_Values_1",CommonUIStrings.l_WAC_NPS_Rating_Values_1),this.floodgateUIStringMap.set_item("nps_Rating_Values_2",CommonUIStrings.l_WAC_NPS_Rating_Values_2),this.floodgateUIStringMap.set_item("nps_Rating_Values_3",CommonUIStrings.l_WAC_NPS_Rating_Values_3),this.floodgateUIStringMap.set_item("nps_Rating_Values_4",CommonUIStrings.l_WAC_NPS_Rating_Values_4),this.floodgateUIStringMap.set_item("nps_Rating_Values_5",CommonUIStrings.l_WAC_NPS_Rating_Values_5),this.floodgateUIStringMap.set_item("nps_QuestionQuestion",CommonUIStrings.l_WAC_NPS_Rating_QuestionQuestion),this.floodgateUIStringMap.set_item("nps_OneClickPromptQuestion_Word",CommonUIStrings.l_WAC_NPS_OneClickPromptQuestion_Word),this.floodgateUIStringMap.set_item("nps_OneClickRatingQuestion_Word",CommonUIStrings.l_WAC_NPS_OneClickRatingQuestion_Word),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_1",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_1),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_2",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_2),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_3",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_3),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_4",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_4),this.floodgateUIStringMap.set_item("nps_OneClickRating_Values_5",CommonUIStrings.l_WAC_NPS_OneClickRating_Values_5),this.floodgateUIStringMap.set_item("AtMentionFS_PromptTitle",CommonUIStrings.l_WAC_AtMentionFS_PromptTitle),this.floodgateUIStringMap.set_item("AtMentionFS_PromptQuestion",CommonUIStrings.l_WAC_AtMentionFS_PromptQuestion),this.floodgateUIStringMap.set_item("AtMentionFS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFS_RatingQuestion),this.floodgateUIStringMap.set_item("AtMentionFS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.floodgateUIStringMap.set_item("AtMentionFS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.floodgateUIStringMap.set_item("AtMentionFS_RaitingValue_1",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyNegative),this.floodgateUIStringMap.set_item("AtMentionFS_RaitingValue_2",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatNegative),this.floodgateUIStringMap.set_item("AtMentionFS_RaitingValue_3",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_NeitherNegativeNorPositive),this.floodgateUIStringMap.set_item("AtMentionFS_RaitingValue_4",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_SomewhatPositive),this.floodgateUIStringMap.set_item("AtMentionFS_RaitingValue_5",CommonUIStrings.l_WAC_GenericSurvey_RaitingValue_ExtremelyPositive),this.floodgateUIStringMap.set_item("AtMentionFS_Question",CommonUIStrings.l_WAC_GenericSurvey_WhyQuestion),this.floodgateUIStringMap.set_item("SearchFPS_Title",CommonUIStrings.l_OneNote_Search_FPS_Title),this.floodgateUIStringMap.set_item("SearchFPS_PromptQuestion",CommonUIStrings.l_OneNote_Search_FPS_PromptQuestion),this.floodgateUIStringMap.set_item("SearchFPS_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.floodgateUIStringMap.set_item("SearchFPS_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.floodgateUIStringMap.set_item("SearchFPS_RatingQuestion",CommonUIStrings.l_OneNote_Search_FPS_RatingQuestion),this.floodgateUIStringMap.set_item("SearchFPS_Rating_Values_1",CommonUIStrings.l_OneNote_Search_FPS_Rating_Values_1),this.floodgateUIStringMap.set_item("SearchFPS_Rating_Values_2",CommonUIStrings.l_OneNote_Search_FPS_Rating_Values_2),this.floodgateUIStringMap.set_item("SearchFPS_Rating_Values_3",CommonUIStrings.l_OneNote_Search_FPS_Rating_Values_3),this.floodgateUIStringMap.set_item("SearchFPS_Rating_Values_4",CommonUIStrings.l_OneNote_Search_FPS_Rating_Values_4),this.floodgateUIStringMap.set_item("SearchFPS_Rating_Values_5",CommonUIStrings.l_OneNote_Search_FPS_Rating_Values_5),this.floodgateUIStringMap.set_item("SearchFPS_WhyQuestion",CommonUIStrings.l_OneNote_Search_FPS_WhyQuestion),this.floodgateUIStringMap.set_item("NSVPromptTitle",CommonUIStrings.l_Excel_NSV_Prompt),this.floodgateUIStringMap.set_item("NSVTimedSurvey_Question",CommonUIStrings.l_Excel_NSV_Overview_Question),this.floodgateUIStringMap.set_item("SatisfactionRating_1",CommonUIStrings.l_Excel_Rating_1_Satisfied),this.floodgateUIStringMap.set_item("SatisfactionRating_2",CommonUIStrings.l_Excel_Rating_2_Satisfied),this.floodgateUIStringMap.set_item("SatisfactionRating_3",CommonUIStrings.l_Excel_Rating_3_Satisfied),this.floodgateUIStringMap.set_item("SatisfactionRating_4",CommonUIStrings.l_Excel_Rating_4_Satisfied),this.floodgateUIStringMap.set_item("SatisfactionRating_5",CommonUIStrings.l_Excel_Rating_5_Satisfied),this.floodgateUIStringMap.set_item("NSV_Timed_Feedback_Freeform_Question",CommonUIStrings.l_Excel_NSV_Timed_Feedback_Freeform_Question),this.floodgateUIStringMap.set_item("NSV_Prompt_Title_Feedback",CommonUIStrings.l_Title_For_NSV_Floodgate_Prompt),this.floodgateUIStringMap.set_item("NSVDidntCreateSheetViewQuestion",CommonUIStrings.l_NSV_Didnt_Create_NSV_Survey_Question),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_1",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_1),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_2",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_2),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_3",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_3),this.floodgateUIStringMap.set_item("NSVDidntCreateNSVOption_4",CommonUIStrings.l_NSV_Didnt_Create_NSV_Option_4),this.floodgateUIStringMap.set_item("NSVFreeformDidntCreateSheetView",CommonUIStrings.l_NSV_Freeform_Reason_Didnt_Create_SheetView),this.floodgateUIStringMap.set_item("NSVDidntCreatePrompt",CommonUIStrings.l_NSV_Didnt_Create_SheetView_Prompt),this.floodgateUIStringMap.set_item("NSVPromptQuestion",CommonUIStrings.l_NSV_PromptQuestion),this.floodgateUIStringMap.set_item("CatchUpFPS_Title",CommonUIStrings.l_WAC_CatchUpFPS_Title),this.floodgateUIStringMap.set_item("CatchUpFPS_Question",CommonUIStrings.l_WAC_CatchUpFPS_Question),this.floodgateUIStringMap.set_item("CatchUpFPS_YesLabel",CommonUIStrings.l_WAC_CatchUpFPS_YesLabel),this.floodgateUIStringMap.set_item("CatchUpFPS_NoLabel",CommonUIStrings.l_WAC_CatchUpFPS_NoLabel),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingQuestion",CommonUIStrings.l_WAC_CatchUpFPS_RatingQuestion),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_1",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_1),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_2",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_2),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_3",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_3),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_4",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_4),this.floodgateUIStringMap.set_item("CatchUpFPS_RatingValue_5",CommonUIStrings.l_WAC_CatchUpFPS_RatingValue_5),this.floodgateUIStringMap.set_item("CatchUpFPS_WhyQuestion",CommonUIStrings.l_WAC_CatchUpFPS_WhyQuestion),this.floodgateUIStringMap.set_item("AtMentionFPS_Title",CommonUIStrings.l_WAC_AtMentionFPS_Title),this.floodgateUIStringMap.set_item("AtMentionFPS_Question",CommonUIStrings.l_WAC_AtMentionFPS_Question),this.floodgateUIStringMap.set_item("AtMentionFPS_YesLabel",CommonUIStrings.l_WAC_AtMentionFPS_YesLabel),this.floodgateUIStringMap.set_item("AtMentionFPS_NoLabel",CommonUIStrings.l_WAC_AtMentionFPS_NoLabel),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingQuestion",CommonUIStrings.l_WAC_AtMentionFPS_RatingQuestion),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingValue_1",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_1),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingValue_2",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_2),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingValue_3",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_3),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingValue_4",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_4),this.floodgateUIStringMap.set_item("AtMentionFPS_RatingValue_5",CommonUIStrings.l_WAC_AtMentionFPS_RatingValue_5),this.floodgateUIStringMap.set_item("AtMentionFPS_WhyQuestion",CommonUIStrings.l_WAC_AtMentionFPS_WhyQuestion),this.floodgateUIStringMap.set_item("UndoExperience_PromptTitle",CommonUIStrings.l_UndoExperienceFloodgatePromptTitle),this.floodgateUIStringMap.set_item("UndoExperience_PromptQuestion",CommonUIStrings.l_UndoExperienceFloodgatePromptQuestion),this.floodgateUIStringMap.set_item("UndoExperience_PromptLabel_Sure",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.floodgateUIStringMap.set_item("UndoExperience_PromptLabel_No",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.floodgateUIStringMap.set_item("UndoExperience_RatingQuestion",CommonUIStrings.l_UndoExperienceFloodgateRatingQuestion),this.floodgateUIStringMap.set_item("UndoExperience_Rating1",CommonUIStrings.l_UndoExperienceFloodgateRating_1),this.floodgateUIStringMap.set_item("UndoExperience_Rating2",CommonUIStrings.l_UndoExperienceFloodgateRating_2),this.floodgateUIStringMap.set_item("UndoExperience_Rating3",CommonUIStrings.l_UndoExperienceFloodgateRating_3),this.floodgateUIStringMap.set_item("UndoExperience_Rating4",CommonUIStrings.l_UndoExperienceFloodgateRating_4),this.floodgateUIStringMap.set_item("UndoExperience_Rating5",CommonUIStrings.l_UndoExperienceFloodgateRating_5),this.floodgateUIStringMap.set_item("UndoExperience_WhyQuestion",CommonUIStrings.l_UndoExperienceFloodgateQuestion),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_PromptTitle",CommonUIStrings.l_WAC_CoauthLatencySurvey_PromptTitle),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_PromptQuestion",CommonUIStrings.l_WAC_CoauthLatencySurvey_PromptQuestion),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_YesLabel",CommonUIStrings.l_WAC_GenericSurvey_SureLabel),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_NoLabel",CommonUIStrings.l_WAC_GenericSurvey_NoLabel),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_RatingQuestion",CommonUIStrings.l_WAC_CoauthLatencySurvey_RatingQuestion),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_Rating_Values_1",CommonUIStrings.l_WAC_CoauthLatencySurvey_Rating_Values_1),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_Rating_Values_2",CommonUIStrings.l_WAC_CoauthLatencySurvey_Rating_Values_2),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_Rating_Values_3",CommonUIStrings.l_WAC_CoauthLatencySurvey_Rating_Values_3),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_Rating_Values_4",CommonUIStrings.l_WAC_CoauthLatencySurvey_Rating_Values_4),this.floodgateUIStringMap.set_item("CoauthLatencySurvey_QuestionQuestion",CommonUIStrings.l_WAC_CoauthLatencySurvey_QuestionQuestion),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePromptTitle",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptTitle),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePromptQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgatePromptQuestion),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePrompt_YesLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_YesLabel),this.floodgateUIStringMap.set_item("ReviewMode_FloodgatePrompt_NoLabel",CommonUIStrings.l_WAC_ReviewMode_FloodgatePrompt_NoLabel),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRatingQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateRatingQuestion),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_1",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_1),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_2",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_2),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_3",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_3),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_4",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_4),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateRating_5",CommonUIStrings.l_WAC_ReviewMode_FloodgateRating_5),this.floodgateUIStringMap.set_item("ReviewMode_FloodgateQuestion",CommonUIStrings.l_WAC_ReviewMode_FloodgateQuestion),this.floodgateUIStringMap.set_item("collab_RatingQuestion_Visio",CommonUIStrings.l_Visio_Collab_RatingQuestion),this.floodgateUIStringMap.set_item("collab_Title_Visio",CommonUIStrings.l_Visio_Collab_Title),this.floodgateUIStringMap.set_item("collab_Prompt_Question_Visio",CommonUIStrings.l_Visio_Collab_Prompt_Question),this.floodgateUIStringMap.set_item("collab_Rating_Values_1",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_1),this.floodgateUIStringMap.set_item("collab_Rating_Values_2",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_2),this.floodgateUIStringMap.set_item("collab_Rating_Values_3",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_3),this.floodgateUIStringMap.set_item("collab_Rating_Values_4",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_4),this.floodgateUIStringMap.set_item("collab_Rating_Values_5",CommonUIStrings.l_Visio_Collab_FPS_Rating_Values_5),this.floodgateUIStringMap.set_item("collab_Question_Visio",CommonUIStrings.l_Visio_Collab_Question),this.floodgateUIStringMap.set_item("connector_campaign_Survey_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Survey_Question),this.floodgateUIStringMap.set_item("connector_campaign_Title",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Title),this.floodgateUIStringMap.set_item("connector_campaign_Prompt_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Prompt_Question),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_1",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_1),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_2",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_2),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_3",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_3),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_4",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_4),this.floodgateUIStringMap.set_item("connector_campaign_Rating_Values_5",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Rating_Values_5),this.floodgateUIStringMap.set_item("connector_campaign_Verbatim_Question",CommonUIStrings.l_VisioWeb_ConnectorCampaign_Verbatim_Question)},e.createAuthTokenHandler=function(t){if("Unknown"===t||"Automation"===t||!h.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FloodgateAuthCallbackIsEnabled"))return d.ULS.sendTraceTag(50423047,356,50,"SIFB Info:Floodgate authCallback not enabled "+t),null;var n={};return n.getUserPuid=e.getUserPuid,n},e.getAutoDismissTimeEnum=function(){return h.AFrameworkApplication.appSettingsManager.getIntAppSetting("FloodgateUIAutoDismissTimeEnum",2)},e.getUserPuid=function(){return h.AFrameworkApplication.appSettingsManager.getStringAppSetting("Puid")},e.mainSIFBBrs="SystemInitiatedFeedbackIsEnabled",e.campaignDefinitionKey="obf-CampaignDefinitions",e.appUsageNPSOneClick="AppUsageNPSOneClick",e.appUsageNPSOneClickTimeSatisfied="AppUsageNPSOneClickTimeSatisfied",e}();(0,i.l)(Te,"SystemInitiatedFeedback",null,[s.t]);var we=function(){function e(e){if(this._sif=null,this._activityTimestamps=null,this._activitySkipCounts=null,this._activityLoggedCounts=null,!e)throw Error.argumentNull("SystemInitiatedFeedback is null");this._sif=e,this._activityTimestamps={},this._activitySkipCounts={},this._activityLoggedCounts={}}return e.prototype.logActivityWithThreshold=function(e,t,n,i){return this.getActivityLoggedCount(e)<i&&this.logActivity(e,t,n)},e.prototype.logActivity=function(e,t,n){var i=new Date;if(!e||!this._sif.floodgateEnabled(e,Te.mainSIFBBrs,t))return!1;var r=null;e in this._activityTimestamps&&(r=this._activityTimestamps[e]);var o=this.getActivitySkipCount(e),a=this.getActivityLoggedCount(e);return this.enoughTimeHasLapsed(r,i,n)?(d.ULS.sendTraceTag(39924675,356,50,"SIFB with time lapse: skipped {0} {1} log(s)",o,e),this._sif.logActivity(e,t),this._activityTimestamps[e]=i,this._activitySkipCounts[e]=0,this._activityLoggedCounts[e]=a+1,!0):(this._activitySkipCounts[e]=o+1,!1)},e.prototype.enoughTimeHasLapsed=function(e,t,n){return!e||t.getTime()-e.getTime()>=1e3*n},e.prototype.getActivitySkipCount=function(e){var t=0;return e in this._activitySkipCounts&&(t=this._activitySkipCounts[e]),t},e.prototype.getActivityLoggedCount=function(e){var t=0;return e in this._activityLoggedCounts&&(t=this._activityLoggedCounts[e]),t},e}();(0,i.l)(we,"SystemInitiatedFeedbackWithTimeLapse",null,[u]);var Ie=n(564);n.d(t,{CustomerFeedbackPackage:function(){return Ee}});var Ee=function(){function e(){this._container=null,this._customerFeedbackActor=null}return e.prototype.get_name=function(){return"Common.App.CustomerFeedback"},e.prototype.configure=function(e){var t=this;h.AFrameworkApplication.dataPlumber||(d.ULS.sendTraceTag(51385996,356,15,"DataPlumber is null. Recreate it"),h.AFrameworkApplication.dataPlumber=new T.b),e.register(x).as(r).singleInstance(),e.register(le).as(o).singleInstance().usingFactory((function(){return new le(Q.FocusManager.instance(),h.AFrameworkApplication.dataPlumber)})),e.register(D).as(a).singleInstance().usingFactory((function(){return new D(e.resolve(o),e.resolve(r),h.AFrameworkApplication.dataPlumber)})),e.register(k).singleInstance().usingFactory((function(){return new k(h.AFrameworkApplication.get_theActionManager(),h.AFrameworkApplication.get_activeFrame(),e.resolve(a),h.AFrameworkApplication.appSettingsManager,h.AFrameworkApplication.dataPlumber)})),e.register(Te).as(s.t).singleInstance().usingFactory((function(){return new Te(e.resolve(o))})),e.register(l).singleInstance().usingFactory((function(){return t.createAppSpecificFeedbackData()})),e.register(we).as(u).singleInstance().usingFactory((function(){return new we(e.resolve(s.t))})),this._container=e},e.prototype.createAppSpecificFeedbackData=function(){var e=null;switch($.Redirect.application){case 2:e=new C;break;case 4:e=new y;break;case 3:e=new v;break;case 1:e=new f;break;case 5:e=new S;break;default:d.ULS.sendTraceTag(37234573,356,10,"Unexpected Application: {0}",$.Redirect.application.toString())}return e},e.prototype.init=function(){e._initialized||(this._customerFeedbackActor=this._container.resolve(k),this._customerFeedbackActor.registerActions(),this._container.resolve(Te),this._container.resolve(we),e._initialized=!0)},e.prototype.dispose=function(){},e.main=function(){Ie.o.get_instance().registerPackage(new e)},e._initialized=!1,e}();(0,i.l)(Ee,"CustomerFeedbackPackage",null,[c.u,p.s])},,,,function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var i=(0,n(208).y)("IClientRequestManager")},function(e,t,n){var i=n(165),r=n(57),o=n(760),a=n(975),s=n(537),l=n(318);i({target:"Object",stat:!0,sham:!r},{getOwnPropertyDescriptors:function(e){for(var t,n,i=a(e),r=s.f,u=o(i),c={},p=0;u.length>p;)void 0!==(n=r(i,t=u[p++]))&&l(c,t,n);return c}})},,function(e,t,n){"use strict";n.d(t,{u:function(){return u},b:function(){return c},a:function(){return p},o:function(){return d}});var i=n(150),r=n(236),o=n(255),a=n(722),s=n(806),l=n(699),u="Unknown",c=function(e,t,n,c,p,d,h){void 0===t&&(t=!0),void 0===n&&(n=u),void 0===c&&(c=0),void 0===p&&(p=0),void 0===d&&(d=0),void 0===h&&(h=null);var g=a.ActionManager.actionIdResolver(e)||"";g.length>0?l.k.sendUserActionEvent(s.j.createUserActionCustomData(g,n,i.s[c],r.i[p],h,e,null,t,d)):o.ULS.sendTraceTag(51500117,383,15,"Could not determine action name for actionId: "+e+". Dropping this action")},p=function(e,t,n,c,p,d,h){void 0===t&&(t=!0),void 0===n&&(n=u),void 0===c&&(c=0),void 0===p&&(p=0),void 0===d&&(d=0),void 0===h&&(h=null);var g=a.ActionManager.actionIdResolver(e)||"";g.length>0?l.k.sendUserActionEvent(s.j.createUserActionEvent(g,n,i.s[c],r.i[p],h,e,null,t,d)):o.ULS.sendTraceTag(51500118,383,15,"Could not determine action name for actionId: "+e+". Dropping this action")},d=function(e,t,n,i){void 0===t&&(t=!0),void 0===n&&(n=0),void 0===i&&(i=null),e&&e.length>0&&l.k.sendActivityEvent(s.j.createActivityEvent(e,t,n,i))}},,,function(e,t,n){"use strict";n.d(t,{r:function(){return r}});var i=n(208),r=function(){function e(){}return e.prototype.get_focusableElement=function(){return null},e.prototype.updateLabel=function(e,t){return!1},e}();(0,i.l)(r,"IControlDomStrategy",null,[])},function(e,t,n){var i=n(12).f,r=n(714),o=n(786)("toStringTag");e.exports=function(e,t,n){e&&!r(e=n?e:e.prototype,o)&&i(e,o,{configurable:!0,value:t})}},,,function(e,t,n){n(122);var i=n(908);e.exports=i.Object.getOwnPropertyDescriptors},function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var i=function(e){var t;t=window.g_badCastCallback,window.g_badCastCallback=null;try{e()}finally{window.g_badCastCallback=t}}},,function(e,t,n){"use strict";var i,r=n(600),o=n(255),a=n(614),s=n(657),l=n(66),u=n(749),c=n(208);!function(e){e[e.title=0]="title",e[e.content=1]="content",e[e.notes=2]="notes",e[e.unknown=3]="unknown"}(i||(i={})),(0,c.h)("AccessibilityItemType",i);var p=n(154),d=n(425);n.d(t,{t:function(){return h}});var h=function(){function e(){}return e.setAriaAttribute=function(e,t,n){e&&(d.y.get_isIPad()||e.setAttribute(t,n))},e.addNotificationCallback=function(t){e.get_readyForNotifications()?t():(e._notificationCallbacks||(e._notificationCallbacks=[]),Array.add(e._notificationCallbacks,t))},e.get_readyForNotifications=function(){return e._readyForNotifications},e.set_readyForNotifications=function(t){if(e._readyForNotifications=t,e._readyForNotifications&&e._notificationCallbacks){for(var n=0;n<e._notificationCallbacks.length;n++)e._notificationCallbacks[n]();e._notificationCallbacks=null}return t},e.appendSpanWithHiddenContext=function(t){var n=t.ownerDocument.createElement("span");e.hideElementFromSight(n),t.appendChild(n);var i=t.ownerDocument.createElement("span");t.appendChild(i);var r=t.ownerDocument.createElement("span");return e.hideElementFromSight(r),t.appendChild(r),i},e.getTextWithHiddenContext=function(e){return e.children[1].innerText},e.setTextWithHiddenContext=function(e,t,n){var i=n.indexOf("{0}"),r=n.substring(0,i);e.children[0].innerText=r,e.children[1].innerText=t;var o=n.substring(i+"{0}".length,n.length);e.children[2].innerText=o},e.appendHiddenLabel=function(t,n,i){var r=document.createElement("div");return e.hideElementFromSight(r),r.id=n,""!==i&&(r.innerText=i),r.setAttribute(e.ariaRoleAttribute,e.ariaPresentationRole),r.setAttribute(e.ariaHiddenAttribute,e.ariaTrueValue),t.appendChild(r),t.setAttribute(e.ariaLabelledByAttribute,n),r},e.appendHiddenDescribedBy=function(t,n,i,r){var o=document.createElement("div");return e.hideElementFromSight(o),o.id=i,""!==r&&(o.innerText=r),o.setAttribute(e.ariaRoleAttribute,e.ariaDescriptionRole),o.setAttribute(e.ariaHiddenAttribute,e.ariaTrueValue),t.appendChild(o),n.setAttribute(e.ariaDescribedByAttribute,o.id),o},e.hideElementFromSight=function(e){e.style.visibility="hidden",e.style.position="absolute",e.style.zIndex="-100"},e.registerHelpActionAndShortcut=function(t,i){void 0===i&&(i=null),n(246).Redirect.registerAction(t,a.GG),s.FocusManager.instance().getScope(n(751).AFrame.documentFocusID).bindAction(u.KeyInputManager.hashKey(l.v.vK_A,5),a.GG),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UIDiscoverabilityEnabled")&&i&&e.createLiveRegionAnnouncement(i,CommonUIStrings.l_AccHelpShortcutAnnouncement)},e.createLiveRegionAnnouncement=function(t,i){var r=document.createElement("div");r.setAttribute(e.ariaRoleAttribute,e.ariaMarqueeRole),r.setAttribute(e.ariaLiveAttribute,e.ariaPoliteLiveLevel),r.setAttribute(e.ariaAtomicAttribute,e.ariaTrueValue),r.className="WACAriaLiveRegion",t.appendChild(r),n(254).AFrameworkApplication.registerOnAfterSplashScreenDismissed((function(){r.appendChild(document.createTextNode(i))}))},e.getAccessiblityInfoForScreenReader=function(t,n,i,r,o,a,s){if(!(t&&n&&i&&r&&o&&a&&o))throw Error.argumentNull("rawAccessibilityInfo, allTitlePromptDic, allTitlesDic, allContentPromptDic, allContentsDic, allNotePromptDic or allNotesDic");e.parseoutAccessibilityInfo(t,n,i,r,o,a,s)},e.getAccessibilityInfoForAccessibilityMode=function(t){if(!t)throw Error.argumentNull("rawAccessibilityInfo");return e.insertHeadingTagsInAccessibilityInfo(t)},e.parseoutAccessibilityInfo=function(t,n,i,o,a,s,l){for(var u=0,c=function(){var c=t.childNodes[u];if("BR"===c.tagName){var p=e.getItemType(c);if(3!==p){var d,h,g=c.getAttribute("id").toString().split("_")[1];p?1===p?(e.getContentOrNoteInfoForReader(t.childNodes[u-1],1,(0,r.m)((function(){return d}),(function(e){return d=e})),(0,r.m)((function(){return h}),(function(e){return h=e}))),o[g]=d,a[g]=h):2===p&&(e.getContentOrNoteInfoForReader(t.childNodes[u-1],2,(0,r.m)((function(){return d}),(function(e){return d=e})),(0,r.m)((function(){return h}),(function(e){return h=e}))),s[g]=d,l[g]=h):(e.getTitleInfoForReader(t.childNodes[u-1],(0,r.m)((function(){return d}),(function(e){return d=e})),(0,r.m)((function(){return h}),(function(e){return h=e}))),n[g]=d,i[g]=h)}}u++};u<t.childNodes.length;)c()},e.insertHeadingTagsInAccessibilityInfo=function(t){for(var n=0,i=new Array(t.childNodes.length);n<t.childNodes.length;){var r=t.childNodes[n];if(r.innerHTML&&""!==r.innerHTML?i[n]=e.getOuterHTML(r):i[n]="","BR"===r.tagName){var o=e.getItemType(r);o?1===o?i[n-1]=e.attachHeadingTagForSpecifiedItem(i[n-1],1):2===o&&(i[n-1]=e.attachHeadingTagForSpecifiedItem(i[n-1],2)):i[n-1]=e.attachHeadingTagForSpecifiedItem(i[n-1],0)}n++}return i.join("")},e.getItemType=function(e){var t=new RegExp("^Title_[0-9]+$"),n=new RegExp("^Content_[0-9]+$"),i=new RegExp("^Notes_[0-9]+$"),r=e.getAttribute("id");return r?t.test(r.toString())?0:n.test(r.toString())?1:i.test(r.toString())?2:(o.ULS.sendTraceTag(7422981,1900,10,"current BR ID of '{0}' doesn't not match any of Title, Content or Notes",r.toString()),3):(o.ULS.sendTraceTag(7422980,1900,10,"Failed to find attribute of ID from BR Node!"),3)},e.getOuterHTML=function(e){var t=document.createElement("P");return t.appendChild(e.cloneNode(!0)),t.innerHTML},e.getItemPromptPattern=function(e){switch(e){case 0:return String.format("\\[{0} [0-9]+ {1}\\]",CommonUIStrings.l_ScreenReader_PatternWord_Slide,CommonUIStrings.l_ScreenReader_PatternWord_Title);case 1:return String.format("\\[{0} [0-9]+ {1}\\]",CommonUIStrings.l_ScreenReader_PatternWord_Slide,CommonUIStrings.l_ScreenReader_PatternWord_Content);case 2:return String.format("\\[{0} [0-9]+ {1}\\]",CommonUIStrings.l_ScreenReader_PatternWord_Slide,CommonUIStrings.l_ScreenReader_PatternWord_Notes);default:throw Error.invalidOperation(String.format("Unsupported item type of {0}",i[e]))}},e.getTitleInfoForReader=function(t,n,i){n.val=CommonUIStrings.l_ScreenReader_UnknowSlideTitlePrompt,i.val=CommonUIStrings.l_ScreenReader_UnknowSlideTitle;try{if(2!==t.childNodes.length)o.ULS.sendTraceTag(7422982,1900,10,"Expect 2 Children which contains Slide # and Slide Title, but acutal content is {0}",p.g.dumpHtmlWithoutText(t));else{var r=t.childNodes[0].nodeValue;new RegExp(String.format("^{0}$",e.getItemPromptPattern(0)),"i").test(r)&&(n.val=r,"LI"!==t.childNodes[1].tagName||1!==t.childNodes[1].childNodes.length||"DIV"!==t.childNodes[1].childNodes[0].tagName||1!==t.childNodes[1].childNodes[0].childNodes.length?o.ULS.sendTraceTag(7422983,1900,10,"Expect TAG of LI and 1 Child Slide Title Info, but acutal Tag is {0} and content is {1}",t.childNodes[1].tagName,p.g.dumpHtmlWithoutText(t.childNodes[1])):(i.val=t.childNodes[1].childNodes[0].childNodes[0].nodeValue,i.val&&i.val.length||(i.val=CommonUIStrings.l_ScreenReader_NoSlideTitle)))}}catch(e){o.ULS.sendTraceTag(7422984,1900,10,"Failed to parse the slide # and title because of {0}, the acutal raw data is {1}",e.toString(),p.g.dumpHtmlWithoutText(t))}},e.getContentOrNoteInfoForReader=function(t,n,r,a){r.val=null,a.val=null;var s=null,l=null,u=null,c=null;switch(n){case 1:r.val=CommonUIStrings.l_ScreenReader_UnknowSlideContentPrompt,s=e.getItemPromptPattern(1),l="LI",u=CommonUIStrings.l_ScreenReader_NoSlideContent,c=CommonUIStrings.l_ScreenReader_UnknowSlideContent;break;case 2:r.val=CommonUIStrings.l_ScreenReader_UnknowSlideNotePrompt,s=e.getItemPromptPattern(2),l="P",u=CommonUIStrings.l_ScreenReader_NoSlideNote,c=CommonUIStrings.l_ScreenReader_UnknowSlideNote;break;default:throw Error.create(String.format("Don't support the type of {0} in GetContentOrNoteInfoForReader",i[n]))}var d=t.childNodes[0].nodeValue,h=new RegExp("^"+s+"$","i");if(h.test(d)){if(r.val=d,t.childNodes.length>1)for(var g=e.extractAllListItems(t),m=0;m<g.length;m++){var _=g[m].tagName;_===l?a.val?a.val=String.format("{0} {1}",a.val,e.extractInnerText(g[m])):a.val=e.extractInnerText(g[m]):o.ULS.sendTraceTag(7476291,1900,10,"Expect Tag is {0} but got Tag of {1}.",l,_||"null")}a.val&&a.val.length||(a.val=u)}else o.ULS.sendTraceTag(7476292,1900,10,"Cannot find the Prompt by Pattern of {0} from {1}",h.toString(),p.g.dumpHtmlWithoutText(t.childNodes[0])),a.val=c},e.attachHeadingTagForSpecifiedItem=function(t,n){var r=t,a=null,s=null,l=null;switch(n){case 0:s="h1",l="<ul>";break;case 1:s="h2",l="<ul>";break;case 2:s="h3",l="<ul>"}a=new RegExp(String.format("^{0}{1}",l,e.getItemPromptPattern(n)),"i");var u=t.match(a);u&&1===u.length?r=t.substring(0,l.length)+("<"+s+">"+t.substring(l.length,u[0].length)+"</"+s+">")+t.substring(u[0].length,t.length):o.ULS.sendTraceTag(7422985,1900,10,"Failed to find expected Slide {0} by pattern of {1}",i[n],a.toString());return r},e.extractAllListItems=function(e){var t=e.childNodes;return"UL"===e.childNodes[1].tagName&&(t=e.childNodes[1].childNodes),t},e.extractInnerText=function(e){var t=null;if(e.innerText)t=e.innerText;else if(e.innerHTML&&e.innerHTML.length>0){for(var n=e,i=1e3;i>=0;i--){if(!n.childNodes.length){t=n.nodeValue;break}if(!n.childNodes[0].tagName||"SPAN"===n.childNodes[0].tagName){t=n.innerHTML;break}if(1!==n.childNodes.length){o.ULS.sendTraceTag(7476293,1900,15,"Unsupported Item format: {0}",p.g.dumpHtmlWithoutText(e));break}n=n.childNodes[0]}i<=0&&o.ULS.sendTraceTag(8263566,1900,15,"more than 1000 Nested level HTML object is NOT supported")}return t},e.ariaAtomicAttribute="aria-atomic",e.ariaBusyAttribute="aria-busy",e.ariaCheckedAttribute="aria-checked",e.ariaControlsAttribute="aria-controls",e.ariaDescribedByAttribute="aria-describedby",e.ariaDisabledAttribute="aria-disabled",e.ariaExpandedAttribute="aria-expanded",e.ariaHasPopupAttribute="aria-haspopup",e.ariaHiddenAttribute="aria-hidden",e.ariaLabelAttribute="aria-label",e.ariaLabelledByAttribute="aria-labelledby",e.ariaLevelAttribute="aria-level",e.ariaLiveAttribute="aria-live",e.ariaMultilineAttribute="aria-multiline",e.ariaOwnsAttribute="aria-owns",e.ariaPressedAttribute="aria-pressed",e.ariaPosInSetAttribute="aria-posinset",e.ariaReadOnlyAttribute="aria-readonly",e.ariaRoleDescription="aria-roledescription",e.ariaSelectedAttribute="aria-selected",e.ariaSetSizeAttribute="aria-setsize",e.ariaValueMaxAttribute="aria-valuemax",e.ariaValueMinAttribute="aria-valuemin",e.ariaValueNowAttribute="aria-valuenow",e.ariaAlertRole="alert",e.ariaApplicationRole="application",e.ariaButtonRole="button",e.ariaCheckBoxRole="checkbox",e.ariaComboboxRole="combobox",e.ariaComplementaryRole="complementary",e.ariaDialogRole="dialog",e.ariaDescriptionRole="description",e.ariaDocumentRole="document",e.ariaGridCellRole="gridcell",e.ariaGridRole="grid",e.ariaGroupRole="group",e.ariaHeadingRole="heading",e.ariaImageRole="img",e.ariaLinkRole="link",e.ariaListboxRole="listbox",e.ariaListRole="list",e.ariaListItemRole="listitem",e.ariaMainRole="main",e.ariaMarqueeRole="marquee",e.ariaMenuItemCheckBoxRole="menuitemcheckbox",e.ariaMenuItemRadioRole="menuitemradio",e.ariaMenuItemRole="menuitem",e.ariaMenuRole="menu",e.ariaNavigationRole="navigation",e.ariaNoteRole="note",e.ariaOptionRole="option",e.ariaPresentationRole="presentation",e.ariaProgressBarRole="progressbar",e.ariaRadioRole="radio",e.ariaRegionRole="region",e.ariaRoleAttribute="role",e.ariaRowRole="row",e.ariaStatusRole="status",e.ariaTabRole="tab",e.ariaTabListRole="tablist",e.ariaTextboxAttribute="textbox",e.ariaTreeItemRole="treeitem",e.ariaTreeRole="tree",e.ariaToggleButtonRole="toggle",e.ariaFalseValue="false",e.ariaTrueValue="true",e.ariaUndefinedValue="undefined",e.ariaAssertiveLiveLevel="assertive",e.ariaOffLiveLevel="off",e.ariaPoliteLiveLevel="polite",e.str_TitleValueID="TitleValueID",e.str_ContentValueID="ContentValueID",e.str_NoteValueID="NoteValueID",e._readyForNotifications=!0,e._notificationCallbacks=null,e}();(0,c.l)(h,"AccessibilityUtils",null,[])},,,,,,function(e,t,n){"use strict";var i=n(165),r=n(531),o=n(82),a=n(382),s=n(764),l=n(371),u=n(79),c=n(247),p=n(950),d=n(14),h=n(128),g=n(847);e.exports=function(e,t,n,m,_){var f=r[e],y=f&&f.prototype,v=f,S=m?"set":"add",C={},b=function(e){var t=y[e];a(y,e,"add"==e?function(e){return t.call(this,0===e?0:e),this}:"delete"==e?function(e){return!(_&&!c(e))&&t.call(this,0===e?0:e)}:"get"==e?function(e){return _&&!c(e)?void 0:t.call(this,0===e?0:e)}:"has"==e?function(e){return!(_&&!c(e))&&t.call(this,0===e?0:e)}:function(e,n){return t.call(this,0===e?0:e,n),this})};if(o(e,"function"!=typeof f||!(_||y.forEach&&!p((function(){(new f).entries().next()})))))v=n.getConstructor(t,e,m,S),s.REQUIRED=!0;else if(o(e,!0)){var A=new v,T=A[S](_?{}:-0,1)!=A,w=p((function(){A.has(1)})),I=d((function(e){new f(e)})),E=!_&&p((function(){for(var e=new f,t=5;t--;)e[S](t,t);return!e.has(-0)}));I||((v=t((function(t,n){u(t,v,e);var i=g(new f,t,v);return null!=n&&l(n,i[S],i,m),i}))).prototype=y,y.constructor=v),(w||E)&&(b("delete"),b("has"),m&&b("get")),(E||T)&&b(S),_&&y.clear&&delete y.clear}return C[e]=v,i({global:!0,forced:v!=f},C),h(v,e),_||n.setStrong(v,e,m),v}},function(e,t,n){"use strict";n.r(t),n.d(t,{XDomainCrossDomainRequest:function(){return a}});var i=n(508),r=n(208),o=n(798),a=function(e){function t(){var t=e.call(this)||this;return t._request=null,t._statusCode=0,t._request=new XDomainRequest,t._request.onload=r.i(t,t.onLoad,"onLoad"),t._request.onerror=r.i(t,t.onError,"onError"),t._request.ontimeout=r.i(t,t.onTimeout,"onTimeout"),t}return(0,i.t)(t,e),t.prototype.get_contentType=function(){return this._request.contentType},t.prototype.get_responseText=function(){return this._request.responseText},t.prototype.get_statusCode=function(){return this._statusCode},t.prototype.abort=function(){this._statusCode=-1,this._request.abort()},t.prototype.send=function(e){this._request.send(e)},t.prototype.open=function(e,t){this._request.open(e,t)},t.prototype.onLoad=function(){this.safeSetStatusCode(200),this.onRequestCompleted()},t.prototype.onError=function(){this.safeSetStatusCode(400),this.onRequestCompleted()},t.prototype.onTimeout=function(){this.safeSetStatusCode(408),this.onRequestCompleted()},t.prototype.getResponseHeader=function(e){return"Content-Type"===e?this._request.contentType:null},t.prototype.safeSetStatusCode=function(e){this._statusCode||(this._statusCode=e)},t}(o.u);(0,r.l)(a,"XDomainCrossDomainRequest",o.u,[])},function(e){e.exports={}},,function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var i=n(208),r=function(){function e(){}return e.pageInfoLabel="PageInfoLabel",e.giveFeedbackButton="GiveFeedback",e.presenterPageLabel="PresenterPageLabel",e.buttonShowZoomDialog="buttonShowZoomDialog",e.zoomFlyout="ZoomFlyout",e}();(0,i.l)(r,"Id",null,[])},function(e,t,n){var i=n(57),r=n(147),o=n(975),a=n(9).f,s=function(e){return function(t){for(var n,s=o(t),l=r(s),u=l.length,c=0,p=[];u>c;)n=l[c++],i&&!a.call(s,n)||p.push(e?[n,s[n]]:s[n]);return p}};e.exports={entries:s(!0),values:s(!1)}},,function(e,t,n){var i=n(89),r=n(780);e.exports=Object.keys||function(e){return i(e,r)}},,function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var i=n(208),r={$$:function(e,t){var n="IDictionary$2$"+e.getName()+"$"+t.getName();return(0,i.g)(n)}}},function(e,t,n){"use strict";n.d(t,{s:function(){return i}});var i,r=n(208);!function(e){e[e.notDefined=-1]="notDefined",e[e.unknown=0]="unknown",e[e.keyboard=1]="keyboard",e[e.mouse=2]="mouse",e[e.touch=3]="touch",e[e.pen=4]="pen",e[e.crossSlide=9]="crossSlide"}(i||(i={})),(0,r.h)("InputMethod",i)},function(e,t,n){"use strict";n.d(t,{i:function(){return o}});var i=n(912),r=n(208),o=function(){function e(){}return e.Value="Value",e.Image16by16Class="Image16by16Class",e.Alt="Alt",e.Visible=i.b.visible,e}();(0,r.l)(o,"LabelCommandProperties",null,[])},,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=(0,r.y)("IRibbon"),a=(0,r.y)("IRibbonExternal"),s=n(813),l=n(70),u=n(31),c=n(809),p=n(600),d=n(435),h=n(614),g=n(547),m=n(363),_=n(48),f=n(763),y=n(254),v=n(928),S=function(){function e(){}return e.unifiedHeaderHeightPx=48,e.tabRowHeightPx=30,e.singleRowLayoutTabRowHeightPx=24,e}();(0,r.l)(S,"RootSize",null,[]);var C=n(574),b=n(749),A=n(713),T=n(773),w=n(154),I=n(425),E=n(296),k=n(134),D=n(176),M=n(926),P=n(257),F=function(e){function t(){var t=e.call(this)||this;return t.defaultSelectionOverride=null,t}return(0,i.t)(t,e),t}(P.l);(0,r.l)(F,"JewelBuildOptions",P.l,[]);var x=n(966),R=n(836),B=function(e){function t(){var t=e.call(this)||this;return t.OldContextId=null,t.OldContextCommand=null,t.NewContextId=null,t.NewContextCommand=null,t}return(0,i.t)(t,e),t}(Sys.EventArgs);(0,r.l)(B,"CommandContextSwitchCommandProperties",Sys.EventArgs,[]);var L=n(360),N=n(554),U=n(696),O=n(597),H=n(222),W=n(333),V=n(876),$=function(){function e(){}return e.get_ribbonCollapsedTop=function(){return-y.AFrameworkApplication.get_activeFrame().get_lowerRibbonHeight()},e.animateRibbonExpandCollapse=function(t,i,r){I.y.get_isInternetExplorer8()&&V.WacAirSpace.temporarilyDisableAnimation(1e3);var o=t.get_element(),a=E.s.getChildById(o,n(153).Ribbon.tabContainerOverflowId);if(a){var s=a.firstChild;if(s&&V.WacAirSpace.setAnimationClass(s,"Wac_RibbonClass"),i&&s){s.id.endsWith("_clone")&&(a.removeChild(s),(s=a.firstChild)&&V.WacAirSpace.setAnimationClass(s,"Wac_RibbonClass")),(u=new H.r(s)).animateY(r?0:e.get_ribbonCollapsedTop(),0);var l=new W.g(s);l.animateOpacity(r?1:0,1),V.WacAirSpace.animate(u,null,e.onAfterRibbonMoveDown),V.WacAirSpace.animate(l,null,e.onAfterShowRibbon)}else if(!i&&s){var u,c=V.WacAirSpace.cloneElement(s,!1,!0);(u=new H.r(c)).animateY(0,e.get_ribbonCollapsedTop());var p=new O.y(c);p.animateOpacity(r?0:1,0),e._animatingContextualGroupsAfterRibbonCollapse=Array.clone(e._animatingContextualGroups),V.WacAirSpace.animate(u,null,e.onAfterCloneAnimation),V.WacAirSpace.animate(p,null,e.onAfterHideRibbon)}}},e.animateContextualGroup=function(t){if(t){var n=$get(t);if(n){Array.contains(e._animatingContextualGroups,t)||Array.add(e._animatingContextualGroups,t);var i=n.children[0];V.WacAirSpace.setAnimationClass(i,"UEX_UpperContextualTabDramatic");var r=new W.g(i);r.animateOpacity(0,1),V.WacAirSpace.animate(r,null,null);var o=n.children[1];V.WacAirSpace.setAnimationClass(o,"UEX_ContextualTabMovement");var a=new H.r(o);a.animateY(24,0),V.WacAirSpace.animate(a,null,e.onAfterContextualGroupAnimation)}}},e.onAfterContextualGroupAnimation=function(t){e._animatingContextualGroups.length>=1&&Array.removeAt(e._animatingContextualGroups,0)},e.onAfterRibbonMoveDown=function(e){e.get_element().style.top="0px"},e.onAfterShowRibbon=function(e){var t=e.get_element();I.y.setOpacity(t,1)},e.onAfterHideRibbon=function(e){var t=e.get_element();I.y.setOpacity(t,0)},e.onAfterCloneAnimation=function(t){var n=t.get_element();n&&n.parentNode&&n.parentNode.removeChild(n);for(var i=0;i<e._animatingContextualGroupsAfterRibbonCollapse.length;i++){var r=e._animatingContextualGroupsAfterRibbonCollapse[i];e.animateContextualGroup(r)}e._animatingContextualGroups=[],e._animatingContextualGroupsAfterRibbonCollapse=[]},e._animatingContextualGroups=[],e._animatingContextualGroupsAfterRibbonCollapse=[],e}();(0,r.l)($,"RibbonAnimator",null,[]);var K=n(899),z=n(84),q=n(513),Q=n(912),G=n(946),j=n(586);n.d(t,{Ribbon:function(){return Z}});var Z=function(e){function t(t,n,i,r,o){void 0===o&&(o=!1);var a=e.call(this,t,n,r)||this;return a._selectedTab=null,a._previousTab=null,a._elmRibbonTopBars=null,a._elmTopBar1=null,a._elmTopBar2=null,a._elmTabTitles=null,a._elmJewelPlaceholder=null,a._elmRibbonShortcut=null,a._elmTabContainer=null,a._elmTabContainerOverflowContainer=null,a._elmNavigationInstructions=null,a._elmTopRowLeft=null,a._elmTopRowCenter=null,a._elmTopRowRight=null,a._elmBottomRowLeft=null,a._elmBottomRowCenter=null,a._elmBottomRowRight=null,a._peripheralContentsLoaded=!1,a._headerContainer=null,a._ribbonStateChanged=!1,a._ribbonPinButton=null,a._isLowerRibbonTouchMode=!1,a.keytipManager=null,a._standaloneRoot=null,a._eventsAttached=!1,a._contextualGroups=null,a._jewel=null,a._currentCtxCss=null,a._minimized=!1,a._minimizedEverSet=!1,a._homeTab=null,a._lastSelectedTab=null,a._tabPoppedUp=!1,a._elmHadFocus=null,a._tabPopupInvocationMethod=0,a._dismissingTabPopup=!1,a._pendingDismissRibbonTimeoutId=-1,a._lastScaleTime=new Date(0),a._contextualGroups={},a.set_isStaticUiTouchMode(i),a.set_isLowerRibbonTouchMode(i),a.set_isSingleRowLayoutRibbon(o),y.AFrameworkApplication.reportInitialUi(a.get_isLowerRibbonTouchMode()),a}return(0,i.t)(t,e),t.prototype.get_activeModalUIZIndex=function(){return y.AFrameworkApplication.get_activeFrame().get_activeModalUIZIndex()},t.prototype.get_keytipModeRibbonHeadersZIndex=function(){return this.get_activeModalUIZIndex()-3},t.prototype.get_upperRibbonHeight=function(){return this.get_isSingleRowLayoutRibbon()?S.singleRowLayoutTabRowHeightPx:y.AFrameworkApplication.hideRibbonEmbedded?0:S.tabRowHeightPx+(y.AFrameworkApplication.hasExternalHeader?0:S.unifiedHeaderHeightPx)},t.prototype.get_lowerRibbonHeight=function(){return e=this.get_isLowerRibbonTouchMode(),void 0===(t=this.get_isSingleRowLayoutRibbon())&&(t=!1),y.AFrameworkApplication.hideRibbonEmbedded?0:t?48:e?108:94;var e,t},t.prototype.get_peripheralContentContainer=function(){return this._elmTopBar1},t.prototype.get_elmRibbonTopBars=function(){return this._elmRibbonTopBars},t.prototype.get_isLowerRibbonTouchMode=function(){return this._isLowerRibbonTouchMode||this.get_touchModeForcedOn()},t.prototype.set_isLowerRibbonTouchMode=function(e){return this._isLowerRibbonTouchMode=e,e},t.prototype.get_theStandaloneRoot=function(){return this._standaloneRoot},t.prototype.get_inKeytipMode=function(){return!!this.keytipManager&&this.keytipManager.get_inKeytipMode()},t.prototype.attachStandaloneRoot=function(e){this._standaloneRoot=e},t.prototype.forEachTab=function(e){for(var t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();r.r(z.Tab,n)&&e(n)}},t.prototype.get_supportsInvisibleControls=function(){return y.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RibbonSupportsInvisibleControlsIsEnabled")},t.prototype.refreshInternal=function(){e.prototype.refreshInternal.call(this);var t=this.get_root().get_controlWithFocus();this.ensureDOMElement(),this.reparentPeripheralsAndCreateTabTitlesContainer(),G.n.toggleCSSClassOnElement(this._elmRibbonTopBars,v.q,this.get_isStaticUiTouchMode()),this._elmRibbonTopBars!==this._headerContainer&&G.n.toggleCSSClassOnElement(this._headerContainer,v.q,this.get_isStaticUiTouchMode()),G.n.toggleCSSClassOnElement(this._elmRibbonTopBars,"cui-ribbon-visible",this.get_tabShowing()),this._elmRibbonTopBars!==this._headerContainer&&G.n.toggleCSSClassOnElement(this._headerContainer,"cui-ribbon-visible",this.get_tabShowing());var n=null,i=null,r=null,o=null;G.n.removeChildNodesSlow(this._elmTabTitles);var a=this._contextualGroups;for(var s in a){(S={key:s,value:a[s]}.value).ensureTabTitlesCleared()}var l=0,u=new R.y;this.forEachTab((function(e){e.get_visible()&&(u.add(e),l++)}));for(var c=0,p=u.get_count(),d=!(q.t(this.get_ribbonProperties().ATTabPositionText)||q.t(this.get_ribbonProperties().ATContextualTabText)),h=u.getEnumerator();h.moveNext();){(_=h.get_current()).ensureTitleRefreshed(),_.resetTitleCSSClasses(),_.get_contextual()?(r&&_.get_contextualGroupId()===r||(_.get_contextualGroupId()!==r&&!q.x(i)&&i.get_contextual()&&G.n.ensureCSSClassOnElement(i.get_titleDOMElement(),"cui-ct-last"),r=_.get_contextualGroupId(),o=this._contextualGroups[_.get_contextualGroupId()],G.n.removeCSSClassFromElement(o.get_elementInternal(),"cui-cg-s"),this.setContextualColor(0),this._elmTabTitles.appendChild(o.get_elementInternal()),G.n.ensureCSSClassOnElement(_.get_titleDOMElement(),"cui-ct-first")),o.addTabTitleDOMElement(_.get_titleDOMElement())):(r&&(G.n.ensureCSSClassOnElement(i.get_titleDOMElement(),"cui-ct-last"),r=null,o=null),d&&(c++,_.setContextualText(this.get_ribbonProperties().ATTabPositionText,null,null,c,p)),this._elmTabTitles.appendChild(_.get_titleDOMElement())),_===this._selectedTab&&(n=_),i=_}r&&(G.n.ensureCSSClassOnElement(i.get_titleDOMElement(),"cui-ct-last"),i=null,r=null,o=null);var g=1;if(d)for(var m=0;m<l;m++){var _;(_=u.get_item(m)).get_contextual()&&(_.get_contextualGroupId()!==r&&(r=_.get_contextualGroupId(),o=this._contextualGroups[_.get_contextualGroupId()],g=1),_.ensureHiddenATDOMElement(),_.setContextualText(this.get_ribbonProperties().ATTabPositionText,this.get_ribbonProperties().ATContextualTabText,o.get_title(),g,o.get_count()),g++)}if(this.get_tabShowing()){if(q.x(n))if(this._minimized)this.get_tabPoppedUp()&&this.delayDismissTabPopup(0);else{var f=this.get_lastSelectedTab(),y=this.get_homeTab();!q.x(f)&&f.get_visible()?n=f:!q.x(y)&&y.get_visible()&&(n=y),this.makeTabSelectedInternal(n),this._elmTabContainer.tabIndex=-1}}else n=null;if(!q.x(n)&&n.get_contextual()){var S=this.getContextualGroup(n.get_contextualGroupId());G.n.ensureCSSClassOnElement(S.get_elementInternal(),"cui-cg-s"),this.setContextualColor(S.get_color())}if(this.updateDOMForSelectedTab(),!q.x(n)){n.get_rootPolledSinceLastPoll()&&G.n.setEnabledOnElement(this._elmTabContainer,!1);var C=-1!==this._elmTabContainer.className.indexOf("cui-disabled"),b="";this.get_isSingleRowLayoutRibbon()?b=" cui-singlerowlayout":this.get_isLowerRibbonTouchMode()&&(b=" cui-touch"),this._elmTabContainer.className=n.getContainerCSSClassName()+b+(C?" cui-disabled":"")}t&&t.setFocusOnControl();var A=this._contextualGroups;for(var T in A){({key:T,value:A[T]}).value.ensureTabTitleWidths()}if(this.set_dirty(!1),this._ribbonStateChanged){var w=this.get_ribbonProperties().CommandStateChanged;q.x(w)||this.executeCommand(w,null,this,0,!1),this._ribbonStateChanged=!1}},t.prototype.attachEvents=function(){this._eventsAttached||(b.KeyInputManager.get_instance().registerHandler(C.d.keyDown,this._elmTabContainer,r.i(this,this.onTabContainerKeyDown,"onTabContainerKeyDown")),b.KeyInputManager.get_instance().registerHandler(C.d.keyUp,this._elmTabContainer,r.i(this,this.onTabContainerKeyUp,"onTabContainerKeyUp")),this._eventsAttached=!0)},t.prototype.onTabContainerKeyDown=function(e){var t=!1;if(!q.x(e.innerEvent)&&!q.x(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode,r=n.shiftKey,o=!1,a=!1;if(i===Sys.UI.Key.tab)this.wrapKeyboardFocus(e.get_sourceElement(),!r)&&(o=e.get_sourceElement()===this._elmTabContainer,t=!0),a=!0;else if(!e.innerEvent.ctrlKey||i!==Sys.UI.Key.left&&i!==Sys.UI.Key.right)i===Sys.UI.Key.esc?this.get_tabPoppedUp()&&(this.dismissTabPopup(),t=!0):(e.innerEvent.ctrlKey||i>=112&&i<=123)&&this.get_tabPoppedUp()&&(e.innerEvent.ctrlKey&&117===i?this.dismissAllTransientUI():t=!0);else{var s=!this.get_root().get_textDirection(),l=i===Sys.UI.Key.right;this._selectedTab.moveGroupFocus(e.get_sourceElement()===this._elmTabContainer,s&&l||!s&&!l),o=!0,a=!0,t=!0}o&&(this._elmTabContainer.tabIndex=-1),a&&this.exitKeytipMode(void 0,!1)}return t},t.prototype.onTabContainerKeyUp=function(e){var t=!1;q.x(e.innerEvent)||q.x(e.innerEvent.rawEvent)||e.innerEvent.rawEvent.altKey&&this.get_tabPoppedUp()&&(this.dismissTabPopup(),t=!0);return t},t.prototype.wrapKeyboardFocus=function(e,t){var n=!1,i=this._selectedTab.get_firstControl(),r=this._selectedTab.get_lastControl();if(this.get_tabPoppedUp()){var o=this.nextControlToFocusTabPoppedUp(e,t,i,r);q.x(o)||(this.clearSelectionOnElement(e),o.get_focusableElement()&&(o.setFocusOnControl(),n=!0))}else if(t&&e===this._ribbonPinButton.get_focusableElement()||!t&&e===i.get_focusableElement())this.clearSelectionOnElement(e),this.setFocusOnCurrentTabTitle(),n=!0;else if(t&&e===r.get_focusableElement()||!t&&e===this._ribbonPinButton.get_focusableElement()){o=e===r.get_focusableElement()?this._ribbonPinButton:r;this.clearSelectionOnElement(e),o.get_focusableElement()&&(o.setFocusOnControl(),n=!0)}return n},t.prototype.nextControlToFocusTabPoppedUp=function(e,t,n,i){var r=e===this._elmTabContainer,o=null;return t?r||e===this._ribbonPinButton.get_focusableElement()?o=n:e===i.get_focusableElement()&&(o=this._ribbonPinButton):r||e===n.get_focusableElement()?o=this._ribbonPinButton:e===this._ribbonPinButton.get_focusableElement()&&(o=i),o},t.prototype.clearSelectionOnElement=function(e){3===E.s.getTag(e)&&w.g.clearSelectionInInput(e)},t.prototype.updateOpenMenu=function(e){return!(!this.get_root()||!this.get_root().refreshOpenMenu(e))||!(!this.get_jewel()||!this.get_jewel().refreshOpenMenu(e))},t.prototype.setFocusOnCurrentTabTitle=function(){var e=q.x(this._selectedTab)?this.get_homeTab():this._selectedTab;q.x(e)||e.setFocusOnTitle()},t.prototype.prepareToEnterKeytipMode=function(){this.beginModal(this,!1,!0),this.get_elmRibbonTopBars().style.zIndex=String(this.get_keytipModeRibbonHeadersZIndex()),this.setTabContainerOverflow("visible")},t.prototype.enterKeytipMode=function(e){void 0===e&&(e=null),this.keytipManager&&(this.keytipManager.enterKeytipMode(),this.keytipManager.set_onExitCallback(e))},t.prototype.prepareToExitKeytipMode=function(e){this.closeAllMenus(),e&&this.get_tabPoppedUp()&&this.dismissTabPopup(void 0,!1),this.get_tabPoppedUp()||(this.get_elmRibbonTopBars().style.zIndex=String(1)),this.get_inModalMode()&&!this.get_tabPoppedUp()?this.endModal(this,!1,!0):this.endBlockingModeKeepModal(),this.setTabContainerOverflow("hidden")},t.prototype.exitKeytipMode=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0),this.keytipManager&&this.keytipManager.exitKeytipMode(e,t)},t.prototype.setTabContainerOverflow=function(e){this._elmTabContainerOverflowContainer.style.overflow=e,this._elmTabContainer.style.overflow=e},t.prototype.get_isRibbonCurrentModalController=function(){return this.get_inModalMode()&&this.isCurrentModalController(this)},t.prototype.setFocusOnTabContainer=function(){q.x(this._elmTabContainer)||(this._elmTabContainer.tabIndex=0,this._elmTabContainer.focus())},t.prototype.addContextualGroup=function(e,t,n,i){var r=this._contextualGroups[e];if(!q.x(r))throw Error.create("A contextual group with id: "+e+" has already been added to this ribbon.");r=new L.z(e,t,n,i),this._contextualGroups[e]=r},t.prototype.get_contextualGroupIds=function(){var e=[],t=this._contextualGroups;for(var n in t){var i={key:n,value:t[n]};Array.add(e,i.key)}return e},t.prototype.removeContextualGroup=function(e){var t=this._contextualGroups[e];q.x(t)||(this.forEachTab((function(t){if(t.get_contextual()&&t.get_contextualGroupId()===e)throw Error.create("You cannot remove a contextual group when there are Tabs that refer to it.")})),delete this._contextualGroups[e])},t.prototype.setVisibilityForContextualGroup=function(e,t,n){var i=this._contextualGroups[e];if(q.x(i))throw Error.create("This ribbon does not contain a contextual group with id: "+e);var r=!1;return this.forEachTab((function(n){n.get_contextualGroupId()===e&&(n.get_visible()!==t&&(r=!0),n.set_visibleInternal(t))})),r&&(this.onDirtyingChange(),this.refreshInternal(),n&&this.scaleHeader(),t&&$.animateContextualGroup(e)),r},t.prototype.getContextualGroup=function(e){return this._contextualGroups[e]},t.prototype.addChildAtIndex=function(t,n){if(!q.x(t)){if(this.ensureCorrectChildType(t),r.r(z.Tab,t)){var i=t;if(i.get_contextual()){var o=this._contextualGroups[i.get_contextualGroupId()];if(q.x(o))throw Error.create("A contextual tab with contextual group id: "+i.get_contextualGroupId()+" cannot be added because  the ribbon does not have a contextual group with this id.")}}e.prototype.addChildAtIndex.call(this,t,n)}},t.prototype.ensureCorrectChildType=function(e){if(!r.r(z.Tab,e)&&!this.isPinButtonElement(e.get_elementInternal()))throw Error.create("Only children of type Tab or Pin button can be added to a Ribbon")},t.prototype.get_cssClass=function(){return"cui-ribbon"},t.prototype.get_cssClassMarker=function(){return"cui-ribbon-marker"},t.prototype.get_rootType=function(){return 2},t.prototype.ensureJewelPlaceholder=function(){q.x(this._elmJewelPlaceholder)&&(this._elmJewelPlaceholder=G.n.createElement("div"),this._elmJewelPlaceholder.id="jewelcontainer",this._elmJewelPlaceholder.className="cui-jewel-container",this._elmJewelPlaceholder.style.display="none",this._elmTopBar2.appendChild(this._elmJewelPlaceholder))},t.prototype.buildAndSetJewel=function(e,t){this._elmJewelPlaceholder.style.display="block";var i=this.get_ribbonBuilder().get_ribbonBuildOptions().jewelBuildOptions||(0,c.m)(new F,{trimmedIds:this.get_ribbonBuilder().get_options().trimmedIds}),r=new(n(518).JewelBuilder)(i,this._elmJewelPlaceholder,this.get_ribbonBuilder().get_buildClientTask());if(r.set_dataSource(t),!r.buildJewel(e,this))throw Error.create("Jewel could not be built");this.set_jewel(r.get_jewel())},t.prototype.rebuildAndSetJewel=function(e,t){this.get_jewel()&&this.get_jewel().dispose(),this._elmJewelPlaceholder.innerText="",this.buildAndSetJewel(e,t),this.get_jewel()&&this.get_jewel().pollForStateAndUpdate()},t.prototype.get_jewel=function(){return this._jewel},t.prototype.set_jewel=function(e){return this._jewel=e,e},t.prototype.get_jewelDisplayedComponent=function(){return this._jewel&&this._jewel.get_jewelMenuLauncher()?this._jewel.get_jewelMenuLauncher().get_displayedComponent():null},t.prototype.createTab=function(e,t,n,i,r,o){return new z.Tab(this,e,t,n,i,!1,null,r,o)},t.prototype.createContextualTab=function(e,t,n,i,r,o,a){return new z.Tab(this,e,t,n,i,!0,r,o,a)},t.prototype.createGroup=function(e,t,n,i,r,o){return new N.Group(this,e,n,i,r,!0,!1,!1,t,o)},t.prototype.createLayout=function(e,t,n){return new U.g(this,e,t,n)},t.prototype.createSection=function(e,t,n,i,r,o){return new K.l(this,e,t,n,i,!1,r,void 0,void 0,void 0,o)},t.prototype.updateDOMForSelectedTab=function(){if(q.x(this._selectedTab)||(this._selectedTab.ensureDOMElement(),this.set_lastSelectedTab(this._selectedTab)),q.x(this._selectedTab)||!this._selectedTab.get_children().get_count()?q.x(this.get_elementInternal())||q.x(this._elmTabContainerOverflowContainer)||this.get_elementInternal().lastChild!==this._elmTabContainerOverflowContainer||this.get_elementInternal().removeChild(this._elmTabContainerOverflowContainer):q.x(this._elmTabContainerOverflowContainer)||this.get_elementInternal().appendChild(this._elmTabContainerOverflowContainer),!q.x(this._selectedTab)){this._selectedTab.get_dirty();if(this._selectedTab.ensureRefreshed(),this._selectedTab.get_children().get_count()>0&&!q.x(this._elmTabContainer)){var e=this._elmTabContainer.firstChild;e?this.isPinButtonElement(e)?this._elmTabContainer.insertBefore(this._selectedTab.get_elementInternal(),e):e!==this._selectedTab.get_elementInternal()&&this._elmTabContainer.replaceChild(this._selectedTab.get_elementInternal(),e):this._elmTabContainer.appendChild(this._selectedTab.get_elementInternal()),this._selectedTab.onTabAttachedToRibbon()}if(this._previousTab!==this._selectedTab){var n=this.get_ribbonProperties().CommandTabSwitched,i=new B;q.x(this._previousTab)||(i.OldContextId=this._previousTab.get_id(),i.OldContextCommand=this._previousTab.get_command()),q.x(this._selectedTab)||(i.NewContextId=this._selectedTab.get_id(),i.NewContextCommand=this._selectedTab.get_command()),q.x(n)||this.executeCommand(n,i,this,0,!1),t._ribbonTabSwitchedEventSource.raiseEvent("RTSE",i),this.updatePreviousSelectedTab(this._selectedTab)}}},t.prototype.makeTabSelectedInternal=function(e){q.x(e)||(this.onDirtyingChange(),e.setSelectedInternal(!0,!1),e.get_contextual()||this.setContextualColor(0),q.x(this._selectedTab)||this._selectedTab===e||this._selectedTab.setSelectedInternal(!1,!1),this._selectedTab=e,this.get_minimized()&&this.displayTabPopup())},t.prototype.updatePreviousSelectedTab=function(e){this._previousTab=e},t.prototype.selectTabById=function(e,t){if(void 0===t&&(t=!1),A.t.mark(10332),!t&&!this.get_tabShowing())return A.t.mark(10333),!1;var n=this.getChild(e);if(!q.x(n)){if(n.get_selected()&&n.get_visible())return A.t.mark(10333),!0;if(n.get_contextual()&&!n.get_visible()&&this.setVisibilityForContextualGroup(n.get_contextualGroupId(),!0,!0),n.get_visible())return n.set_selected(!0),A.t.mark(10333),!0}return A.t.mark(10333),!1},t.prototype.getTabTitleDOMElementBounds=function(e){var t=this.getChild(e);return q.x(t)?null:w.g.getElementBounds(t.get_titleDOMElement())},t.prototype.getGroupTitleDOMElementBounds=function(e,t){var n=this.getChild(e);if(!q.x(n)&&!q.x(n.getChild(t))){var i=n.getChild(t);return w.g.getElementBounds(i.get_titleDOMElement())}return null},t.prototype.scaleRibbon=function(){this.scale()},t.prototype.isSelectedTab=function(e){return e===this.get_selectedTabId()},t.prototype.launchJewel=function(e,t){this.get_jewel().get_jewelMenuLauncher().launchMenuWithSubmenu(e,t)},t.prototype.setContextualColor=function(e){var t=L.z.getColorNameForContextualTabColor(e);t===q.d?(G.n.removeCSSClassFromElement(this._elmTopBar2,this._currentCtxCss),this._currentCtxCss=null):(this._currentCtxCss||G.n.removeCSSClassFromElement(this._elmTopBar2,this._currentCtxCss),this._currentCtxCss="cui-ct-topBar-"+t,G.n.ensureCSSClassOnElement(this._elmTopBar2,this._currentCtxCss))},t.prototype.get_selectedTabId=function(){return this._selectedTab?this._selectedTab.get_id():null},t.prototype.scaleInternal=function(){if(q.x(this.get_elementInternal())||q.x(this._selectedTab))return!1;var e=0;if(!this._selectedTab.get_scaledByCookie()){var t=null;this.get_useDataCookie()&&(t=this.getDataCookieValue(this._selectedTab.get_id()));var n=this._lastResizeWidthHeight;if(!q.x(t)&&t.startsWith(n)){var i=t.split("|");if(!q.x(i)&&4===i.length){var r=parseInt(i[1]),o=parseInt(i[2]);if(e=o>e?o:e,!isNaN(r)&&r>=0&&r>=0&&r<this._selectedTab.get_scaling().get_stepsInternal().length)return this._selectedTab.scaleIndex(r),this._selectedTab.set_scaledByCookie(!0),this.refreshInternal(),this._selectedTab.set_lastScaleWidthHeight(this._lastResizeWidthHeight),!0}}}this._selectedTab.get_dirty()&&this.refreshInternal();for(var a=0,s=this._selectedTab.get_width(),l=this._selectedTab.get_contentsCurScaleWidth();l>s&&a<25;){if(!this._selectedTab.scaleDown()){if(this._selectedTab.set_minWidth(l),this._elmTabContainer&&this._ribbonPinButton&&this._ribbonPinButton.get_displayedComponent()&&this._ribbonPinButton.get_displayedComponent().get_elementInternal()){var u=l+this._ribbonPinButton.get_displayedComponent().get_elementInternal().offsetWidth;this._elmTabContainer.style.minWidth=u+"px"}break}this.refreshInternal(),l=this._selectedTab.get_contentsCurScaleWidth(),a++}var c=0,p=0;if(a<=0&&s-l>e)for(;c<25&&this._selectedTab.scaleUp();)if(this.refreshInternal(),c++,this._selectedTab.get_contentsCurScaleWidth()>s){this._selectedTab.scaleDown(),this.refreshInternal(),p++;break}return this.get_useDataCookie()&&this._selectedTab.get_currentScalingIndex()>=-1&&this.storeTabScaleCookie(),this._selectedTab.set_lastScaleWidthHeight(this._lastResizeWidthHeight),this.scaleHeader(),a>0||c-p>0},t.prototype.scaleHeader=function(){this.enhancedMobileViewIsEnabled()?(document.getElementById("application").style.minWidth="0px",q.x(this._elmTopBar1)||new f.b(this._elmTopBar1,this._elmTopBar2,1===this.get_root().get_textDirection()).scaleHeader()):q.x(this._elmTopBar1)||_.k.scaleHeaderUsingContainers(this._elmTopBar1,this._elmTopBar2,1===this.get_root().get_textDirection());if(!q.x(this._elmTabTitles)){var e=this._elmTabTitles.className,t=0;-1!==e.indexOf("cui-tts-scale-1")?t=1:-1!==e.indexOf("cui-tts-scale-2")&&(t=2),this.forEachTab((function(e){e.onTitleScale(t)}))}},t.prototype.enhancedMobileViewIsEnabled=function(){return!!y.AFrameworkApplication.appSettingsManager&&y.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EnhancedMobileViewIsEnabled")},t.prototype.scale=function(){if(e.prototype.scale.call(this),!this.get_tabShowing())return this.scaleHeader(),this.refreshInternal(),!1;var t=this.scaleInternal();return this._lastScaleTime=new Date,t},t.prototype.scaleIndex=function(e){q.x(this._selectedTab)||this._selectedTab.scaleIndexInternal(e)},t.prototype.get_lastScaleTime=function(){return this._lastScaleTime.getTime()},t.prototype.storeTabScaleCookie=function(){var e=this._selectedTab.get_width()-this._selectedTab.get_contentsCurScaleWidth();this.storeDataCookie(this._selectedTab.get_id(),this.get_elementInternal().clientWidth.toString()+this.get_elementInternal().clientHeight.toString()+"|"+this._selectedTab.get_currentScalingIndex().toString()+"|"+e.toString())},t.prototype.get_minimized=function(){return this._minimized},t.prototype.set_minimized=function(e){return this._minimized!==e&&(this.set_minimizedInternal(e),!e&&this.get_pollForState()&&this.pollForStateAndUpdate()),e},t.prototype.get_minimizedInternal=function(){return this._minimized},t.prototype.set_minimizedInternal=function(e){return this._minimized===e&&this._minimizedEverSet||(this.onDirtyingChange(),this._minimized=e,this._minimizedEverSet=!0,e&&!q.x(this._selectedTab)&&(this._selectedTab.setSelectedInternal(!1,!1),this._selectedTab=null),this._ribbonStateChanged=!0),e},t.prototype.get_tabShowing=function(){return!this._minimized||this._tabPoppedUp},t.prototype.toggleMinimizedState=function(e){A.t.mark(10330),y.AFrameworkApplication.get_theActionManager().processAction(h.yT,2),3===e?this.set_isLowerRibbonTouchMode(!0):2===e&&this.set_isLowerRibbonTouchMode(!1);var t=this.get_minimized(),n=this.get_tabPoppedUp();this.dismissTabPopup(),this.set_minimized(!this.get_minimized()),y.AFrameworkApplication.get_activeFrame()&&y.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&t&&(this._elmTabContainerOverflowContainer.style.position="relative",this._elmTabContainerOverflowContainer.style.width="",T.o.removeStyle(this._elmTabContainerOverflowContainer,"zIndex")),t&&n?($.animateRibbonExpandCollapse(this,!0,!0),y.AFrameworkApplication.get_activeFrame().animateDocumentPanel(!1,!0)):t?($.animateRibbonExpandCollapse(this,!0,!1),y.AFrameworkApplication.get_activeFrame().animateDocumentPanel(!1,!1)):($.animateRibbonExpandCollapse(this,!1,!1),y.AFrameworkApplication.get_activeFrame().animateDocumentPanel(!0,!1)),this.updatePinButtonProperties(),this.refresh(),A.t.mark(10331)},t.prototype.pollForStateAndUpdateInternal=function(){if(this.get_rootUser()){this.set_lastPollTime(new Date),this.needScaling=!1;var e={},t=!1,n=this._contextualGroups;for(var i in n){var r={key:i,value:n[i]},o=r.value,a=!1;q.x(o.get_command())||(a=this.get_rootUser().isRootCommandEnabled(o.get_command())),a&&(e[r.key]=!0),this.setVisibilityForContextualGroup(r.key,a,!1)&&(t=!0)}t&&this.scaleHeader(),this.get_jewel()&&this.get_jewel().pollForStateAndUpdate(),this.ensureRefreshed(),q.x(this._selectedTab)||this._selectedTab.pollForStateAndUpdateInternal(),this.needScaling?(this.scale(),this.needScaling=!1,this.needRefresh=!1):this.needRefresh&&(this.refreshInternal(),this.needRefresh=!1),this.ensureGlobalDisablingRemoved()}},t.prototype.get_jewelElement=function(){return this._elmJewelPlaceholder},t.prototype.set_jewelElement=function(e){return this._elmJewelPlaceholder=e,e},t.prototype.get_ribbonProperties=function(){return this.get_properties()},t.prototype.get_ribbonBuilder=function(){return this.get_builder()},t.prototype.set_ribbonBuilder=function(e){return this.set_builder(e),e},t.prototype.ensureTabsInitialized=function(){this.forEachTab((function(e){e.ensureTabInitialized()}))},t.prototype.get_homeTab=function(){return this._homeTab},t.prototype.set_homeTab=function(e){return this._homeTab=e,e},t.prototype.get_lastSelectedTab=function(){return this._lastSelectedTab},t.prototype.set_lastSelectedTab=function(e){return this._lastSelectedTab=e,e},t.prototype.get_domElementTagName=function(){return"div"},t.prototype.ensureDOMElement=function(){e.prototype.ensureDOMElement.call(this),k.t.setAriaAttribute(this.get_elementInternal(),"aria-describedby","ribboninstructions"),this.get_elementInternal().setAttribute("role","toolbar"),Sys.UI.DomElement.addCssClass(this.get_elementInternal(),this.get_cssClassMarker()),this.ensureElementForRibbonShortcut(),this.ensureTopBars(),this.ensureTopBars1And2(),this.ensureJewelPlaceholder(),this.ensureTabContainer(),this.ensureJewelPlaceholder(),this.findPeripherals(),this.attachEvents()},t.prototype.ensureElementForRibbonShortcut=function(){q.x(this._elmRibbonShortcut)&&(this._elmRibbonShortcut=G.n.createElement("div"),this._elmRibbonShortcut.id=x.v.ribbonShortcutId,this._elmRibbonShortcut.innerText=I.y.get_isMac()?"Alt Ctrl":"Alt Windows",Sys.UI.DomElement.addCssClass(this._elmRibbonShortcut,"WACAltTextDescribedBy"),k.t.setAriaAttribute(this._elmRibbonShortcut,k.t.ariaRoleAttribute,k.t.ariaPresentationRole),k.t.setAriaAttribute(this._elmRibbonShortcut,k.t.ariaHiddenAttribute,k.t.ariaTrueValue),this.get_elementInternal().appendChild(this._elmRibbonShortcut))},t.prototype.ensureTopBars1And2=function(){var e=y.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UseExternalHeaderDiv")&&document.getElementsByClassName(v.c()).length>0;q.x(this._elmTopBar1)&&!e&&(this._elmTopBar1=G.n.createElement("div"),this._elmTopBar1.className=v.c(),this._elmTopBar1.style.display="none",this._headerContainer.appendChild(this._elmTopBar1)),q.x(this._elmTopBar2)&&(this._elmTopBar2=G.n.createElement("div"),this._elmTopBar2.className="cui-topBar2",this._elmRibbonTopBars.appendChild(this._elmTopBar2))},t.prototype.ensureTopBars=function(){this.get_properties().NavigationHelpText&&q.x(this._elmNavigationInstructions)&&(this._elmNavigationInstructions=G.n.createElement("span"),this._elmNavigationInstructions.className="cui-hidden",this._elmNavigationInstructions.id="ribboninstruction",this._elmNavigationInstructions.innerText=this.get_properties().NavigationHelpText,this.get_elementInternal().appendChild(this._elmNavigationInstructions)),q.x(this._elmRibbonTopBars)&&(this._elmRibbonTopBars=G.n.createElement("div"),this._elmRibbonTopBars.id=g.CuiHelper.headerTopBarsId,this._elmRibbonTopBars.className="cui-ribbonTopBars"+(this.get_isSingleRowLayoutRibbon()?" cui-singlerowlayout":""),this._elmRibbonTopBars.style.zIndex=String(1),this.get_elementInternal().appendChild(this._elmRibbonTopBars)),this.ensureHeaderDom()},t.prototype.ensureHeaderDom=function(){var e;v.f((0,p.m)((function(){return e}),(function(t){return e=t})))?(q.x(this._headerContainer)&&(this._headerContainer=G.n.createElement("div"),this._headerContainer.className="cui-ribbonTopBars",this._headerContainer.id=g.CuiHelper.externalHeaderFullTopBarsId,e.appendChild(this._headerContainer)),this.ensureExternalHeaderCss(),Sys.UI.DomElement.addCssClass(this.get_elementInternal(),"cui-exth"),y.AFrameworkApplication.get_activeFrame()&&y.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&!y.AFrameworkApplication.hideHeaderEmbedded&&this.ensureFlexBoxPositioningCss()):this._headerContainer=this._elmRibbonTopBars},t.prototype.ensureExternalHeaderCss=function(){Sys.UI.DomElement.addCssClass(this._headerContainer,this.get_cssClass()),1===this.get_textDirection()&&G.n.ensureCSSClassOnElement(this._headerContainer,"cui-rtl")},t.prototype.ensureFlexBoxPositioningCss=function(){Sys.UI.DomElement.addCssClass(this._headerContainer,"FlexBoxLayout")},t.prototype.ensureTabContainer=function(){q.x(this._elmTabContainer)&&(this._elmTabContainerOverflowContainer=G.n.createElement("div"),this._elmTabContainerOverflowContainer.id=t.tabContainerOverflowId,this._elmTabContainerOverflowContainer.setAttribute("role","presentation"),this._elmTabContainerOverflowContainer.style.overflow="hidden",this._elmTabContainer=G.n.createElement("div"),this._elmTabContainer.setAttribute("role","presentation"),G.n.setEnabledOnElement(this._elmTabContainer,!1),this._elmTabContainerOverflowContainer.appendChild(this._elmTabContainer),this.ensurePinButton())},t.prototype.getPinButtonProperties=function(){var e={};return e.Command=this.get_ribbonProperties().CommandToggleRibbonState,this.get_minimized()?(e.Image16by16=this.get_ribbonProperties().ImagePinButton,e.Image16by16Class=this.get_ribbonProperties().ImagePinButtonClass,e.Alt=this.get_ribbonProperties().PinButtonTooltip):(e.Image16by16=this.get_ribbonProperties().ImageUnpinButton,e.Image16by16Class=this.get_ribbonProperties().ImageUnpinButtonClass,e.Alt=this.get_ribbonProperties().UnpinButtonTooltip),e},t.prototype.updatePinButtonProperties=function(){var e=this._ribbonPinButton.behavior;if(e){var t=this.getPinButtonProperties();this._ribbonPinButton.get_stateProperties()[M.f.Image16by16Class]=t.Image16by16Class,this._ribbonPinButton.get_stateProperties()[Q.b.alt]=t.Alt,e.updateImage(),e.updateTooltip()}},t.prototype.ensurePinButton=function(){if(this._ribbonPinButton=new D.d(this,"RibbonPinButton",this.getPinButtonProperties()),this._ribbonPinButton){var e=this._ribbonPinButton.createComponentForDisplayMode("Small");G.n.ensureCSSClassOnElement(e.get_elementInternal(),"cui-pinButton"),e.set_enabled(!0),this.addChildAtIndex(e,this.get_children().get_count()),this._elmTabContainer.appendChild(e.get_elementInternal())}},t.prototype.isPinButtonElement=function(e){return!!e&&!!e.id&&e.id.startsWith("RibbonPinButton")},t.prototype.isTabBodyElement=function(e){return!!e.className&&-1!==e.className.indexOf(z.Tab.tabBodyCssClassName)},t.prototype.findPeripherals=function(){q.x(this._elmTopRowCenter)&&(this._elmTopRowCenter=document.getElementById(this.get_clientID()+"-"+m.r.topRowCenter)),q.x(this._elmTopRowRight)&&(this._elmTopRowRight=document.getElementById(this.get_clientID()+"-"+m.r.topRowRight)),q.x(this._elmTopRowLeft)&&(this._elmTopRowLeft=document.getElementById(this.get_clientID()+"-"+m.r.topRowLeft)),q.x(this._elmBottomRowLeft)&&(this._elmBottomRowLeft=document.getElementById(this.get_clientID()+"-"+m.r.bottomRowLeft)),q.x(this._elmBottomRowCenter)&&(this._elmBottomRowCenter=document.getElementById(this.get_clientID()+"-"+m.r.bottomRowCenter),y.AFrameworkApplication.get_activeFrame()&&y.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()||G.n.ensureCSSClassOnElement(this._elmBottomRowCenter,"UITextTranformUpperCase")),q.x(this._elmBottomRowRight)&&(this._elmBottomRowRight=document.getElementById(this.get_clientID()+"-"+m.r.bottomRowRight))},t.prototype.reloadPeripherals=function(){this.findPeripherals(),this.reparentPeripheralsAndCreateTabTitlesContainer(!0),this.scale()},t.prototype.reparentPeripheralsAndCreateTabTitlesContainer=function(e){if(void 0===e&&(e=!1),!this._peripheralContentsLoaded||e){q.x(this._elmTopBar1)||(this._elmTopBar1.style.display="block");var t=this._elmTopBar1;this.reparentPeripheral(this._elmTopRowLeft,t,"inline-block"),this.reparentPeripheral(this._elmTopRowCenter,this._elmTopBar1,"inline-block"),this.reparentPeripheral(this._elmTopRowRight,this._elmTopBar1,"inline-block"),this.reparentPeripheral(this._elmBottomRowLeft,this._elmTopBar2,"block"),q.x(this._elmTabTitles)&&(this._elmTabTitles=G.n.createElement("ul"),this._elmTabTitles.setAttribute("role","tablist"),this._elmTabTitles.className="cui-tts",this._elmTopBar2.appendChild(this._elmTabTitles)),this.reparentPeripheral(this._elmBottomRowCenter,this._elmTopBar2,"inline-block"),this.reparentPeripheral(this._elmBottomRowRight,this._elmTopBar2,"flex"),this._peripheralContentsLoaded=!0}},t.prototype.reparentPeripheral=function(e,t,n){q.x(e)||q.x(t)||e.parentNode===t||(t.appendChild(e),e.style.display=n,G.n.setUnselectable(e,!0,!1))},t.prototype.ensureGlobalDisablingRemoved=function(){G.n.setEnabledOnElement(this._elmTabTitles,!0),this.ensureTabContainerGlobalDisablingRemoved()},t.prototype.ensureTabContainerGlobalDisablingRemoved=function(){G.n.setEnabledOnElement(this._elmTabContainer,!0)},t.prototype.get_rootUser=function(){return e.prototype.get_rootUser.call(this)},t.prototype.set_rootUser=function(t){return e.prototype.set_rootUser.call(this,t),q.x(this._jewel)||this._jewel.set_rootUser(t),t},t.prototype.get_visibleInDOM=function(){return!0},t.prototype.dispose=function(){q.x(this._elmTabContainer)||G.n.unregisterAllHandlers(this._elmTabContainer),e.prototype.dispose.call(this),this.get_jewel()&&this.get_jewel().dispose(),this._previousTab=null,this._selectedTab=null,this._elmRibbonTopBars=null,this._elmTabTitles=null,this._elmJewelPlaceholder=null,this._elmTabContainer=null,this._elmTabContainerOverflowContainer=null,this._elmTopRowLeft=null,this._elmTopRowCenter=null,this._elmTopRowRight=null,this._elmBottomRowLeft=null,this._elmBottomRowCenter=null,this._elmBottomRowRight=null,this._elmTopBar1=null,this._elmTopBar2=null;var t=this._contextualGroups;for(var n in t){({key:n,value:t[n]}).value.dispose()}this._contextualGroups=null,this._ribbonPinButton&&(this._ribbonPinButton.dispose(),this._ribbonPinButton=null),this.set_disposed(!0)},t.prototype.get_tabPoppedUp=function(){return this._tabPoppedUp},t.prototype.onModalBodyPointerDown=function(e){var t=!1;return this.get_inKeytipMode()&&(this.exitKeytipMode(!1),t=!0),3!==e.get_inputSource()&&(this.dismissTabPopup(),t=!0),t},t.prototype.onModalBodyPointerUp=function(e){var t=!1;return window.navigator.msPointerEnabled&&3===e.get_inputSource()&&(this.dismissTabPopup(),t=!0),t},t.prototype.onModalBodyPointerMove=function(e){return!1},t.prototype.onModalBodyPointerOut=function(e){return!1},t.prototype.onModalBodyClick=function(e){var t=!1;return window.navigator.msPointerEnabled||3!==e.get_inputSource()||(this.dismissTabPopup(),t=!0),t},t.prototype.onModalBodyMouseWheel=function(e){return!1},t.prototype.displayTabPopup=function(){if(!this.get_tabPoppedUp()){A.t.mark(10328),this._elmHadFocus=w.g.getActiveElement(this.get_elementInternal().ownerDocument),this.beginModal(this,!0),this.get_elementInternal().parentNode.style.zIndex=String(this.get_activeModalUIZIndex());var e=this.get_activeModalUIZIndex()+1;this._elmRibbonTopBars.style.zIndex=String(e),this._tabPoppedUp=!0,this._tabPopupInvocationMethod=this._selectedTab.get_popupInvocationMethod(),y.AFrameworkApplication.get_activeFrame()&&y.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&(this._elmTabContainerOverflowContainer.style.position="absolute",this._elmTabContainerOverflowContainer.style.width="100%",this._elmTabContainerOverflowContainer.style.zIndex=String(e)),this._ribbonStateChanged=!0,this.refresh(),$.animateRibbonExpandCollapse(this,!0,this.get_inKeytipMode()),A.t.mark(10329)}},t.prototype.dismissTabPopup=function(e,t){if(void 0===e&&(e=!0),void 0===t&&(t=!0),this.cancelPendingDismissTabPopup(),this.get_tabPoppedUp()&&!this._dismissingTabPopup&&this.isCurrentModalController(this)){$.animateRibbonExpandCollapse(this,!1,!1),this._dismissingTabPopup=!0,this.commitAnyPendingChange(),this.endModal(this,t,e),T.o.removeStyle(this.get_elementInternal().parentNode,"zIndex");var n=this.get_inKeytipMode()?this.get_keytipModeRibbonHeadersZIndex():1;return this._elmRibbonTopBars.style.zIndex=String(n),y.AFrameworkApplication.get_activeFrame()&&y.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled()&&(this._elmTabContainerOverflowContainer.style.zIndex=String(n)),q.x(this._selectedTab)||(this._selectedTab.setSelectedInternal(!1,!1),this._selectedTab=null),this._previousTab=null,this._tabPoppedUp=!1,this._ribbonStateChanged=!0,this.refreshInternal(),y.AFrameworkApplication.get_activeFrame().restoreFocusAfterDismissingPopup(this._elmHadFocus,this._tabPopupInvocationMethod),this._elmHadFocus=null,this._dismissingTabPopup=!1,!0}return!1},t.prototype.delayDismissTabPopup=function(e){var t=this;-1!==this._pendingDismissRibbonTimeoutId||this._dismissingTabPopup||(this._pendingDismissRibbonTimeoutId=window.setTimeout((function(){t.dismissTabPopup()}),e))},t.prototype.cancelPendingDismissTabPopup=function(){var e=this;G.n.cancelPendingTimeout((0,p.m)((function(){return e._pendingDismissRibbonTimeoutId}),(function(t){return e._pendingDismissRibbonTimeoutId=t})))},t.prototype.dismissAllTransientUI=function(){var t=e.prototype.dismissAllTransientUI.call(this);return this.dismissTabPopup()&&(t=!0),this.get_inKeytipMode()&&(this.exitKeytipMode(),t=!0),t},t.prototype.getControlVisibility=function(e){var t=this.getControlById(e);return!!t&&t.get_visible()},t.prototype.setControlVisibility=function(e,t){var n=this.getControlById(e);n&&(n.set_visible(t),this.get_dirty()&&this.refreshInternal())},t.prototype.isControlEnabled=function(e){var t=this.getControlById(e);return!!t&&t.get_enabled()},t.prototype.forceEnableControl=function(e,t){var n=this.getControlById(e);n&&(n.forceSetEnabledState(t),this.get_dirty()&&this.refreshInternal())},t.add_onRibbonTabSwitchedEventHandler=function(e){t._ribbonTabSwitchedEventSource.addHandler("RTSE",e)},t.remove_onRibbonTabSwitchedEventHandler=function(e){t._ribbonTabSwitchedEventSource.removeHandler("RTSE",e)},t.tabContainerOverflowId="TabContainerOverflow",t._ribbonTabSwitchedEventSource=new j.f,t}(d.b);(0,r.l)(Z,"Ribbon",d.b,[o,a,s.s,l.l,u.o])},function(e,t,n){"use strict";var i=n(929),r=n(255),o=n(344),a=n(773),s=n(914),l=n(337),u=n(208),c=function(){return function(e,t){this.x=0,this.y=0,this.x=e,this.y=t}}();(0,u.l)(c,"UnroundedPoint",null,[]);var p=n(851),d=n(425),h=n(896),g=n(296),m=n(556);n.d(t,{g:function(){return _}});var _=function(){function e(){}return e.isPointInElement=function(t,n){return e.isPointInBounds(e.getElementBounds(t),n)},e.isPointInBounds=function(e,t){return t.x>=e.x&&t.y>=e.y&&t.x<e.x+e.width&&t.y<e.y+e.height},e.isBoundsEqual=function(e,t){return e.width===t.width&&e.height===t.height&&e.x===t.x&&e.y===t.y},e.getBoundingWidth=function(t){return e.getElementBounds(t).width},e.getBoundingTop=function(t){return e.getElementBounds(t).y},e.getBoundingLeft=function(t){return e.getElementBounds(t).x},e.getBoundingBottom=function(t){var n=e.getElementBounds(t);return n.y+n.height},e.getBoundingRight=function(t){var n=e.getElementBounds(t);return n.x+n.width},e.getElementBounds=function(e){if(e)try{var t=e.getBoundingClientRect(),n=t.left,i=t.top,o=t.right,a=t.bottom;return new Sys.UI.Bounds(n,i,o-n,a-i)}catch(e){if(r.ULS.sendTraceTag(40138062,306,50,"Failed to get element bounds {0}",e),!d.y.get_isInternetExplorer())throw e;return new Sys.UI.Bounds(0,0,0,0)}return new Sys.UI.Bounds(0,0,0,0)},e.getElementUnroundedPointWidthAndHeight=function(e,t,n){if(e){var i=e.getBoundingClientRect(),r=i.left,o=i.top,a=i.right,s=i.bottom;return t.val=a-r,n.val=s-o,new c(r,o)}return t.val=-1,n.val=-1,new c(-1,-1)},e.getElementOffsetWidth=function(e){return e?e.offsetWidth:0},e.getElementLocation=function(t){var n=e.getElementBounds(t);return new Sys.UI.Point(n.x,n.y)},e.getElementAbsolutePosition=function(e,t,n){for(t.val=0,n.val=0;e;)t.val+=e.offsetLeft,n.val+=e.offsetTop,e=e.offsetParent},e.getElementAtPoint=function(e){return document.elementFromPoint(e.x,e.y)},e.getOpacity=function(e){if(e){var t=a.o.getCurrentStyle(e);if(t){var n=t.filter;if(d.y.get_isNonStandardsCompliantIE()&&n){if(-1!==n.indexOf("opacity"))return parseInt(n.substring(n.indexOf("=")+1,n.indexOf(")")))}else if(t.opacity)return 100*parseFloat(t.opacity)}}return 100},e.setOpacity=function(e,t){d.y.get_isNonStandardsCompliantIE()?e.style.filter="alpha(opacity="+t+")":e.style.opacity=100===t?"1":(.01*t).toString()},e.clearOpacity=function(e){d.y.get_isNonStandardsCompliantIE()?e.style.filter="":e.style.opacity=""},e.addWhitespace=function(e,t,n){var i=t.ownerDocument.createTextNode(e),r=t.firstChild;n||!r?t.appendChild(i):t.insertBefore(i,r)},e.dumpHtmlWithoutText=function(t){var n=t.nodeName;if(t.nodeType===i.o.text)n+=" ("+t.nodeValue.length+")";else if(""!==t.className&&(n+="."+t.className),t.childNodes.length>0){n+=" (";for(var r=0;r<t.childNodes.length;r++)n+=e.dumpHtmlWithoutText(t.childNodes[r])+(r===t.childNodes.length-1?")":",")}return n},e.getParentWindow=function(e){return e.parentWindow||e.defaultView},e.getWindowLocation=function(e){return"undefined"!=typeof e.screenLeft?new Sys.UI.Point(e.screenLeft,e.screenTop):new Sys.UI.Point(e.screen.left,e.screen.top)},e.getRelativeLocation=function(e,t){var n=Sys.UI.DomElement.getLocation(e),i=Sys.UI.DomElement.getLocation(t),o=0,a=0,s=t;do{if(s=s.parentNode,!g.s.isValidElement(s))return r.ULS.sendTraceTag(24975303,306,10,String.format("Invalid walker element in GetRelativeLocation. Caller may have input a target (id:{0} type:{1} class:{2}) that is not a child of parent (id:{3} type:{4} class:{5}).",t.id,t.nodeType,t.className,e.id,e.nodeType,e.className)),new Sys.UI.Point(0,0);o+=s.scrollTop,a+=s.scrollLeft}while(s!==e);return new Sys.UI.Point(i.x-n.x+a,i.y-n.y+o)},e.getRelativePoint=function(t,n,i){var r=e.getRelativeLocation(t,n);return new Sys.UI.Point(i.x-r.x+n.scrollLeft,i.y-r.y+n.scrollTop)},e.getRelativeBounds=function(t,n,i){var r=new Sys.UI.Point(i.x,i.y),o=e.getRelativePoint(t,n,r);return new Sys.UI.Bounds(o.x,o.y,i.width,i.height)},e.getInputTypeFromElement=function(e){if(!e||3!==g.s.getTag(e))return null;var t=e,n=t.type;return null==n?null:m.l.toLower(t.type)},e.isRadioInputElement=function(t){return"radio"===e.getInputTypeFromElement(t)},e.isSupportedInputType=function(e){return"text"===e||"password"===e||"search"===e||"url"===e},e.isTextField=function(t){if(!t||t.nodeType!==i.o.element)return!1;var n=e.getInputTypeFromElement(t);return e.isSupportedInputType(n)||5===g.s.getTag(t)||"true"===t.getAttribute("contenteditable")},e.selectAllTextInInput=function(e){if(void 0!==e.select&&null!==e.select)try{e.select()}catch(t){window.setTimeout((function(){e.select()}),0)}},e.clearSelectionInInput=function(e){if(void 0!==e.setSelectionRange&&null!==e.setSelectionRange){var t=e.value.length;e.setSelectionRange(t,t)}},e.selectAllTextInElement=function(e){try{if(d.y.get_supportsDomL2Selection()){var t=window.self.getSelection();t.removeAllRanges(),(n=e.ownerDocument.createRange()).setStart(e.firstChild,0),n.setEnd(e.firstChild,s.q(e).length),t.addRange(n)}else if(d.y.get_isNonStandardsCompliantIE()){var n;(n=document.body.createTextRange()).moveToElementText(e),n.select()}}catch(e){r.ULS.sendTraceTag(38835597,306,10,"Exception caught in SelectAllTextInElement: {0}",e)}},e.clearSelectionInElement=function(e){var t=!1;if(d.y.get_supportsDomL2Selection())try{return void window.self.getSelection().removeAllRanges()}catch(e){t=!0}if(d.y.get_isNonStandardsCompliantIE()||t)try{var n=document.body.createTextRange();return n.moveToElementText(e),n.setEndPoint("EndToStart",n),void n.select()}catch(e){}},e.clearSelectionIfNecessary=function(){var t=document.activeElement;t&&t.nodeType===i.o.element&&(3===g.s.getTag(t)&&"text"===t.getAttribute("type")||5===g.s.getTag(t))&&e.clearSelectionInInput(t)},e.isFieldNullOrUndefined=function(e,t){return void 0===e[t]||null===e[t]},e.executeDocumentCommand=function(e,t,i,r){void 0===i&&(i=!1),void 0===r&&(r=null);var o=new(n(492).IgnoreTaskManagerRunningScope);try{return e.execCommand(t,i,r)}finally{o&&o.dispose()}},e.getActiveElement=function(e){var t=null;try{t=e.activeElement}catch(e){}return t},e.isActiveElement=function(t){return!!t&&t===e.getActiveElement(t.ownerDocument)},e.hasFocusableTabIndex=function(t,n){void 0===n&&(n=!1);var i=e.getAttributeValue(t,"tabIndex");if(null!=i){var r=parseInt(i);return!isNaN(r)&&r>=0}return!!n},e.getAttributeValue=function(e,t){return null!=e?e.getAttribute(t):null},e.getCurrentSelectionRange=function(e){if(d.y.get_supportsDomL2Selection()){var t=e.getSelection();if(t)if(t.rangeCount)try{return t.getRangeAt(0)}catch(e){return r.ULS.sendTraceTag(36491728,306,15,"Exception when calling getRangeAt."),null}}return null},e.isRangeAnIp=function(t){var n=t.startContainer,i=t.endContainer,r=t.startOffset,o=t.endOffset;if(n!==i){if(n.parentNode!==i.parentNode)return!1;var a=e.getOffsetInParent(n,r),s=e.getOffsetInParent(i,o);return-1===a||-1===s||a===s}return r===o},e.getOffsetInParent=function(e,t){var n=e.parentNode;if(!n||!n.childNodes)return-1;for(var i=0,r=0;r<n.childNodes.length;r++){var o=n.childNodes[r];if((o=n.childNodes[r])===e)return i+t;i+=o.nodeValue.length}return-1},e.isRangeAtStartOfFrame=function(e){var t=e.startContainer;if(e.startOffset)return!1;for(var n=t;n.parentNode&&(!n.tagName||"body"!==n.tagName.toLowerCase());){var i=n.parentNode;if(i.childNodes[0]!==n)return!1;n=i}return!0},e.isRangeAtEndOfFrame=function(e){var t=e.endContainer;if(e.endOffset!==g.s.getElementTextLength(t))return!1;for(var n=t;n.parentNode&&(!n.tagName||"body"!==n.tagName.toLowerCase());){var i=n.parentNode,r=i.childNodes.length-1;if(i.childNodes[r]!==n)return!1;n=i}return!0},e.getCommonDataToPost=function(t){var i=n(254).AFrameworkApplication.appSettingsManager.get_appSettings(),r={};(n(254).AFrameworkApplication.get_accessToken()&&(r[n(254).AFrameworkApplication.accessTokenParamName]=n(254).AFrameworkApplication.get_accessToken()),n(254).AFrameworkApplication.get_accessTokenTtl()&&(r[n(254).AFrameworkApplication.accessTokenTtlParamName]=n(254).AFrameworkApplication.accessTokenServerExpirationTime.toString()),t&&i[e.miniCheckTtlParamName])&&(Number.parseInvariant(i[e.miniCheckTtlParamName])>(new Date).getTime()&&(r[e.miniCheckDataInfoParamName]=i[e.miniCheckDataInfoParamName],r[e.miniCheckSignatureInfoParamName]=i[e.miniCheckSignatureInfoParamName],r[e.miniCheckTtlParamName]=i[e.miniCheckTtlParamName]));n(254).AFrameworkApplication.hostCanary&&(r[e.hostCanaryParamname]=n(254).AFrameworkApplication.hostCanary),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e.isJsApiParamName)&&(r.jsApi="1"),n(254).AFrameworkApplication.get_isUIEmbedMode()&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PassUIEmbedThroughRedirectsIsEnabled")&&(r.uiembed="1"),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PassUserIdOwnerIdViaPdcCookieIsEnabled")&&(e.loggableUserIdAppSettingName in i&&(r[e.loggableUserIdViaPdcParamName]=i[e.loggableUserIdAppSettingName]),e.loggableOwnerIdAppSettingName in i&&(r[e.loggableOwnerIdViaPdcParamName]=i[e.loggableOwnerIdAppSettingName]));var o=n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting(n(254).AFrameworkApplication.hostUIControlSettingName);return o&&(r.huictrls=o),n(254).AFrameworkApplication.get_isControllerServicesQueryParamNeeded()&&(r[n(254).AFrameworkApplication.controllerServicesParamName]="1"),r},e.removePostParamsFromUrl=function(e,t){for(var n in t){var i={key:n,value:t[n]};e=p.n.removeParameter(e,i.key)}return e},e.openWindow=function(t,i,r,a,s){void 0===r&&(r=!0),void 0===a&&(a=36e5),void 0===s&&(s=null);var u=e.getCommonDataToPost(r);if(!h.k(u))return!!window.open(i,e.windowTargetToString(t));var c=e.removePostParamsFromUrl(i,u);if(1===t){var d="pdc"+l.s(0,32767).toString(16);c=p.n.addOrReplaceParameterValue(c,"pdcn",d),s&&(n(254).AFrameworkApplication.dataPlumber.RenavigationReason=s,c=p.n.addOrReplaceParameterValue(c,n(254).AFrameworkApplication.sessionOriginParamName,s,!0));var g=new Date;return g.setTime(g.getTime()+a),o.l(d,u,g,"/",c)?window.location.replace(c):e.postToWindow(e.windowTargetToString(t),c,u),!0}return e.postToWindow(e.windowTargetToString(t),c,u),!0},e.openWindowWithAttributes=function(t,i,r,o,a,s,l){void 0===l&&(l=!0);var u=s?e.getCommonDataToPost(l):null;if(!s||!u||!h.k(u))return window.open(i,e.windowTargetToString(t),o,a);e._accessTokenHash||(e._accessTokenHash=m.l.calcHashCode(n(254).AFrameworkApplication.get_accessToken())),e._openWindowCount++;var c=(r||"wacwindow")+e._accessTokenHash+e._openWindowCount,p=e.removePostParamsFromUrl(i,u);return e.postToWindowWithAttributes(p,c,o,a,u)},e.postToWindowWithAttributes=function(t,n,i,r,o){var a;return a=window.open("",n,i,r),e.postToWindow(n,t,o),a},e.postToWindow=function(t,n,i){for(var r in void 0===i&&(i=null),i=i||{},e._postWindowForm&&(document.body.removeChild(e._postWindowForm),e._postWindowForm=null),e._postWindowForm=document.createElement("form"),e._postWindowForm.action=n,e._postWindowForm.method="post",e._postWindowForm.target=t,i){var o={key:r,value:i[r]},a=document.createElement("input");a.type="hidden",a.name=o.key,a.value=o.value,e._postWindowForm.appendChild(a)}document.body.appendChild(e._postWindowForm),e._postWindowForm.submit()},e.windowTargetToString=function(e){switch(e){case 1:return"_self";case 2:return"_parent";case 3:return"_top";case 4:return"_blank";default:return""}},e.setButtonEnabledState=function(e,t){null!=e&&e.disabled!==!t&&(e.disabled=!t,t?Sys.UI.DomElement.removeCssClass(e,"DisabledButton"):Sys.UI.DomElement.addCssClass(e,"DisabledButton"))},e.getWindowPerformanceTimingObject=function(){var e=window.self.performance||null;return e&&e.timing||null},e.isVisible=function(t){return 7!==g.s.getTag(t)&&"hidden"!==e.getInputTypeFromElement(t)&&e.styleVisible(a.o.getCurrentStyle(t)||t.style)},e.styleVisible=function(e){return!("none"===m.l.toLower(e.display)||"hidden"===m.l.toLower(e.visibility)||"collapse"===m.l.toLower(e.visibility))},e.setOuterEdge=function(e,t,n){n?e.style.right=t+"px":e.style.left=t+"px"},e.rtlInvertIfNecessary=function(e){return n(254).AFrameworkApplication.get_isRtl()?-e:e},e.followHyperlinkWithNoReferrer=function(e){if(d.y.supportsNoReferrer()){var t=document.createElement("a");t.target="_blank",t.href=e,t.setAttribute("rel","noreferrer"),document.body.appendChild(t),t.click(),document.body.removeChild(t)}else window.open(e)},e.leftBoundsOverlapsRightBounds=function(t,n,i){return e.leftBoundsOverlapsRightBoundsByAmount(t,n,i)>=1},e.leftBoundsOverlapsRightBoundsByAmount=function(e,t,n){var i=n?t:e,r=n?e:t,o=new Sys.UI.Point(r.x,r.y);return i.x+i.width-o.x},e.getTickCount=function(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(e){r.ULS.sendTraceTag(50677923,306,15,"Calling Window.Performance.Now() failed with exception: {0}",e.toString())}return(new Date).getTime()},e.getLinkAroundElement=function(t){return t&&t.nodeType===i.o.element?"A"===t.tagName.toUpperCase()?t:e.getLinkAroundElement(t.parentNode):null},e.downloadFile=function(t){e._downloadFrame||(e._downloadFrame=document.createElement("iframe"),e._downloadFrame.id="DownloadFileFrame",e._downloadFrame.style.cssText="height:0;width:0;display:none",document.body.appendChild(e._downloadFrame)),e._downloadFrame.src=t},e.measureTimeToNextFrame=function(t,n){var i=e.getTickCount();window.requestAnimationFrame((function(o){window.setTimeout((function(){var o=e.getTickCount()-i;r.ULS.sendTraceTag(40637981,340,50,"Action: {0}, ControlId: {1}, TimeToFirstFrame: {2}",n,t,o)}),0)}))},e.requestIdleCallbackExists=function(){return!!window.requestIdleCallback},e.cancelIdleCallbackExists=function(){return!!window.cancelIdleCallback},e.miniCheckDataInfoParamName="mci",e.miniCheckTtlParamName="mcttl",e.miniCheckSignatureInfoParamName="mcsi",e.hostCanaryParamname="cy",e.loggableUserIdViaPdcParamName="loggable_user_id",e.loggableOwnerIdViaPdcParamName="loggable_owner_id",e.loggableUserIdAppSettingName="LoggableUserId",e.loggableOwnerIdAppSettingName="LoggableOwnerId",e.isJsApiParamName="IsJsApi",e._openWindowCount=0,e._accessTokenHash=0,e._postWindowForm=null,e._downloadFrame=null,e}();(0,u.l)(_,"WindowUtils",null,[])},,,,,,function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var i=(0,n(208).y)("ISelectableControl")},,function(e,t,n){"use strict";n.d(t,{o:function(){return o}});var i=n(743),r=n(208),o=function(){function e(){}return e.isBrowserUnderWebToadRun=function(t,n){t=t.toLowerCase();var i=String.format("[?&]{0}=",e.runIdParam),r=String.format("[?&]{0}=",e.scenarioIdParam),o=String.format("[?&]{0}=",e.userSessionDataParam);return(t.search(new RegExp(i))>-1||!!n(e.runIdParam))&&(t.search(new RegExp(r))>-1||!!n(e.scenarioIdParam))||t.search(new RegExp(o))>-1},e.loadTestHarness=function(){var t=document.createElement("script");t.type="text/javascript",n(254).AFrameworkApplication.useCrossOriginStaticScripts&&t.setAttribute("crossorigin","anonymous"),t.src=e.webToadHostName+"/Scripts/TestHarness.js",document.body.appendChild(t)},e.getStaticScriptPath=function(){return i.h.staticContentHost+n(254).AFrameworkApplication.get_scriptFolderPath()},e.getStaticContentQueryParameter=function(){return i.h.get_staticContentQueryParameter()},e.AssertStringTag=function(e,t,n){},e.RegisterErrorHandler=function(e){n(254).AFrameworkApplication.registerTestHarnessErrorHandler(e)},e.LogThroughClient=function(e){},e.runIdParam="wdrunid",e.scenarioIdParam="wdscenarioid",e.webToadHostName=null,e.userSessionDataParam="wdusersessiondata",e.userSessionData=null,e}();(0,r.l)(o,"TestHarnessInterface",null,[])},function(e,t,n){"use strict";n.d(t,{z:function(){return a}});var i=n(508),r=n(527),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t.durationMs=null,t.succeeded=null,t.count=null,t.aggMode=null,t.CV=null,t}return(0,i.t)(t,e),t}(r.y);(0,o.l)(a,"ActivityEvent",r.y,[])},function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var i=n(208),r=function(){return function(e,t,n){this.id=0,this.type=0,this.flags=0,this.id=e,this.type=t,this.flags=n}}();(0,i.l)(r,"PropertyDefinition",null,[])},function(e,t,n){var i=n(531),r=n(537).f,o=n(76),a=n(382),s=n(578),l=n(525),u=n(82);e.exports=function(e,t){var n,c,p,d,h,g=e.target,m=e.global,_=e.stat;if(n=m?i:_?i[g]||s(g,{}):(i[g]||{}).prototype)for(c in t){if(d=t[c],p=e.noTargetGet?(h=r(n,c))&&h.value:n[c],!u(m?c:g+(_?".":"#")+c,e.forced)&&void 0!==p){if(typeof d==typeof p)continue;l(d,p)}(e.sham||p&&p.sham)&&o(d,"sham",!0),a(n,c,d,e)}}},function(e,t,n){"use strict";n.d(t,{f:function(){return r}});var i=n(208),r=function(){function e(e,t,n){this._actionId=0,this._contextId=0,this._flags=0,this._actionId=e,this._contextId=t,this._flags=n}return e.prototype.get_actionId=function(){return this._actionId},e.prototype.get_contextId=function(){return this._contextId},e.prototype.get_flags=function(){return this._flags},e}();(0,i.l)(r,"CommandInfo",null,[])},function(e,t,n){"use strict";n.d(t,{x:function(){return a}});var i=n(508),r=n(216),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t.ControlsId=null,t.Title=null,t.TitleId=null,t.Theme=null,t.DisplayMode=null,t.ShowMenuSectionSeparator=!0,t.ShowMenuSectionTitleIcon=!0,t.ShowMenuSectionTitleBackground=!0,t.MenuSectionTitleFocusable=!0,t.Lang=null,t.ControlList=null,t}return(0,i.t)(t,e),t}(r.i);(0,o.l)(a,"MenuSectionProps",r.i,[])},function(e,t,n){"use strict";n.d(t,{k:function(){return r}});var i=n(208),r=function(){function e(){}return e.wordIcon="WordIcon",e.fullScreenButton="fseaFullScreen",e.controlMenu="ControlMenu",e.controlMenuSectionOne="msControlMenu1",e.downloadACopyButton="DownloadACopy",e.printButton="PrintPDF",e.accessibleModeButton="AccessibleMode",e.controlMenuSectionTwo="msControlMenu2",e.documentInformationButton="DocumentInformation",e.controlMenuSectionThree="msControlMenu3",e.privacyButton="Privacy",e.termsOfUseButton="TermsOfUse",e.giveFeedbackButtonEmbed="msControlMenu.Controls.GiveFeedback",e}();(0,i.l)(r,"Embed",null,[])},,,,,,,function(e,t,n){var i=n(974);e.exports=function(e,t,n){if(i(e),void 0===t)return e;switch(n){case 0:return function(){return e.call(t)};case 1:return function(n){return e.call(t,n)};case 2:return function(n,i){return e.call(t,n,i)};case 3:return function(n,i,r){return e.call(t,n,i,r)}}return function(){return e.apply(t,arguments)}}},function(e,t,n){"use strict";var i=n(508),r=n(208),o=n(530),a=n(160),s=n(951),l=n(134),u=n(926),c=n(127),p=n(920),d=n(946),h=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.buildControlDom=function(e,t){var n=e.get_controlProperties(),i=s.Control.createOuterElement("cui-footerbutton",e),r=d.n.createElement("span");return r.appendChild(document.createTextNode(n.LabelText)),i.title=n.Description,i.appendChild(r),new p.d(t,i)},t}(c.r);(0,r.l)(h,"MenuFooterButtonDomStrategy",c.r,[]);var g=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.buildControlDom=function(e,n){var i=e.get_controlProperties(),r=d.n.createElement("img"),o=d.n.createClusteredImageContainerNew(5,i.Image32by32,i.Image32by32Class,r,!0,!1);d.n.ensureCSSClassOnElement(o,"cui-img-32by32"),d.n.ensureCSSClassOnElement(o,"cui-headerbutton-img");var a=t.createLabelDomElement(i.LabelText),l=s.Control.createOuterElement("cui-ctl-medium cui-headerbutton",e);return l.title=i.Description,o.appendChild(r),l.appendChild(o),l.appendChild(a),new p.d(n,l)},t.createLabelDomElement=function(e){var t=d.n.createElement("span");return t.className="cui-ctl-mediumlabel",t.appendChild(document.createTextNode(e)),t},t}(c.r);(0,r.l)(g,"MenuHeaderButtonDomStrategy",c.r,[]);var m=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.buildControlDom=function(e,n){var i=e.get_controlProperties(),r=d.n.createElement("img"),o=d.n.createClusteredImageContainerNew(5,i.Image32by32,i.Image32by32Class,r,!0,!1);d.n.ensureCSSClassOnElement(o,"cui-img-32by32");var a=null;(a=d.n.createElement("span")).className="cui-ctl-menulabel cui-mrubutton-textcontainer",a.appendChild(t.createLabelDomElement(i.LabelText)),a.appendChild(t.createDescriptionDomElement(i.Description));var l=s.Control.createOuterElement("cui-ctl-medium cui-mrubutton",e);return l.title=i.LabelText,l.appendChild(o),l.appendChild(a),new p.d(n,l)},t.createDescriptionDomElement=function(e){var t=d.n.createElement("span");return t.className="UIFont cui-mrubutton-description",t.appendChild(document.createTextNode(e)),t},t.createLabelDomElement=function(e){var t=d.n.createElement("span");return t.className="cui-mrubutton-title",t.appendChild(document.createTextNode(e)),t},t}(c.r);(0,r.l)(m,"MruButtonDomStrategy",c.r,[]);var _=n(659),f=n(255),y=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.buildControlDom=function(e,n){var i=e.get_controlProperties(),r="cui-ctl-medium",o=!1,a=!1,l=d.n.createElement("img");void 0!==i.Image95by123&&null!==i.Image95by123?(l.src=i.Image95by123,l.className="cui-img-95by123",r+=" cui-templatebutton-portrait",o=!0):void 0!==i.Image123by95&&null!==i.Image123by95?(l.src=i.Image123by95,l.className="cui-img-123by95",r+=" cui-templatebutton-landscape"):void 0!==i.Image123by69&&null!==i.Image123by69?(l.src=i.Image123by69,l.className="cui-img-123by69",r+=" cui-templatebutton-shortlandscape"):void 0!==i.Image100by100&&null!==i.Image100by100&&(l.src=i.Image100by100,l.className="cui-img-100by100",r+=" cui-templatebutton-square",a=!0),$addHandler(l,"load",(function(){t.logThumbnailPerfAndRetryIfNecessary(l,!0)})),$addHandler(l,"error",(function(){t.logThumbnailPerfAndRetryIfNecessary(l,!1)}));var u=d.n.createElement("div"),c=t.createLabelDomElement(i.LabelText,o,a),h=s.Control.createOuterElement(r,e);return h.title=i.LabelText,u.appendChild(l),h.appendChild(u),h.appendChild(c),new p.d(n,h)},t.createLabelDomElement=function(e,t,n){var i=d.n.createElement("span");return i.className="UIFont cui-templatebutton-label-"+(t?"portrait":n?"square":"landscape"),i.appendChild(document.createTextNode(e)),i},t.logThumbnailPerfAndRetryIfNecessary=function(e,t){var n=e.getAttribute("retry");if("l"!==n){var i="r"===n,r=e.src,o={ThumbnailUrl:r,CompletedSuccessfully:t,IsRetry:i},a=window.performance;if(a&&"undefined"!=typeof a.getEntriesByName){var s=a.getEntriesByName(r);if(s&&s.length>0){var l=s[0];o.Duration=parseInt(String(l.duration)),o.FetchStart=parseInt(String(l.fetchStart)),o.ResponseEnd=parseInt(String(l.responseEnd))}}if(f.ULS.sendTraceTag(4515987,202,t?50:15,"Template thumbnail download finished {0}",o),!t)if(i)e.setAttribute("retry","l");else{var u=e.src;e.src=null,e.src=u,e.setAttribute("retry","r")}}},t}(c.r);(0,r.l)(y,"TemplateButtonDomStrategy",c.r,[]);var v=n(866),S=n(513);n.d(t,{d:function(){return C}});var C=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.addDisplayMode("Small"),r.addDisplayMode("Small14"),r.addDisplayMode("Small20"),r.addDisplayMode("Small24"),r.addDisplayMode("Medium"),r.addDisplayMode("Medium14"),r.addDisplayMode("Medium20"),r.addDisplayMode("MediumCompact"),r.addDisplayMode("Large"),r.addDisplayMode("Large16"),r.addDisplayMode("Large30"),r.addDisplayMode("LargeNoText"),r.addDisplayMode("Menu"),r.addDisplayMode("Menu16"),r.addDisplayMode("Menu16DescriptionEnabled"),r.addDisplayMode("MenuTellMe"),r.addDisplayMode("MenuTellMeExtended"),r.addDisplayMode("Menu20"),r.addDisplayMode("Menu32"),r.addDisplayMode("Menu48"),r.addDisplayMode("MenuFooter"),r.addDisplayMode("MenuHeader"),r.addDisplayMode("MenuMru"),r.addDisplayMode("MenuTemplate"),r.addDisplayMode("FloatieLarge"),r.addDisplayMode("Initials"),r.get_stateProperties()[u.f.LabelText]=r.labelText=r.get_properties().LabelText,r.get_stateProperties()[u.f.Visible]=r.get_visible(),r.get_stateProperties()[u.f.HasPopup]=d.n.isTrue(i.HasPopup),r.get_stateProperties()[u.f.Alt]=S.t(r.get_properties().Alt)?r.get_properties().LabelText:r.get_properties().Alt,r}return(0,i.t)(t,e),t.prototype.createComponentDomForDisplayMode=function(e){var t=null,n=this.getDomElementCreationStrategy(e);if(n){if(t=n.buildControlDom(this,e),this.get_hasPopup()&&l.t.setAriaAttribute(t.elmControl,l.t.ariaHasPopupAttribute,l.t.ariaTrueValue),12===this.get_root().get_rootType()){var i=!S.t(this.get_properties().Image16by16);(!i&&"Medium"===e||i&&"Small"===e)&&(Sys.UI.DomElement.addCssClass(t.elmControl,"showBorder"),"Medium"===e&&Sys.UI.DomElement.addCssClass(t.elmLabel,"showBorder"))}if(19===this.get_root().get_rootType()&&!S.t(this.get_properties().ShortcutHint)){d.n.ensureCSSClassOnElement(t.elmControl,"cui-shortcut-container");var r=d.n.createElement("span");r.innerText=this.get_properties().ShortcutHint,r.className=t.elmLabel.className,d.n.ensureCSSClassOnElement(r,"cui-shortcut-hint"),t.elmControl.appendChild(r)}var o="Initials"===t.get_displayMode()?t.elmIconContainer:t.elmImage;this.setIconBackgroundColor(o)}return t},t.prototype.getDomElementCreationStrategy=function(e){switch(e){case"MenuMru":return new m;case"MenuTemplate":return new y;case"MenuHeader":return new g;case"MenuFooter":return new h;default:return new _.f}},t.prototype.get_controlType=function(){return r.r(v.Jewel,this.get_root())?s.Control.fileMenuButtonControlType:s.Control.buttonControlType},t.prototype.get_needsAKeytip=function(){return!0},t.prototype.getTextValue=function(){return this.labelText},t.prototype.get_focusableElement=function(){return this.getDisplayedComponentElement()},t.prototype.get_activatesOnPress=function(){return!this.isStandardMenuItem()},t.prototype.get_properties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.setImageBackgroundColor=function(e){this.setIconBackgroundColor(e)},t.prototype.setIconBackgroundColor=function(e){e&&""!==this.get_properties().ImageBackColor&&(e.style.backgroundColor=this.get_properties().ImageBackColor)},t.prototype.get_hasPopup=function(){return this.get_stateProperties()[u.f.HasPopup]},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n)},t}(s.Control);(0,r.l)(C,"Button",s.Control,[o.x,a.a])},,,function(e,t,n){"use strict";n.r(t);var i=n(254),r=n(539),o=n(556),a=n(208),s=function(){function e(e,t){this._isEndedNormal=!1,this._hasBeenProcessed=!1,this.duration=0,this.title=null,this.serverMeasurements=null,this.beginTime=null,this.endTime=null,this.parent=null,this.isFromServer=!1,this.attributes=null,this.children=[],t?(this.serverMeasurements=e,this.isFromServer=!0):(this.title=e,this.isFromServer=!1),this._hasBeenProcessed=!1}return e.prototype.process=function(){return this._hasBeenProcessed?this.duration.toString():(this.endTime?this._isEndedNormal=!0:(this.endTime=new Date,this._isEndedNormal=!1),this.duration=this.endTime.getTime()-this.beginTime.getTime(),this._hasBeenProcessed=!0,this.duration.toString())},e.prototype.addChild=function(e){Array.add(this.children,e),e.parent=this},e.prototype.removeChild=function(e){Array.remove(this.children,e)},e.prototype.addAttribute=function(e,t){this.attributes||(this.attributes={}),this.attributes[e]=t},e.prototype.toFixedLengthString=function(e,t){for(var n=e.toString(),i=t-n.length,r=0;r<i;r++)n="0"+n;return n},e.prototype.toFormatedTimeString=function(e){var t=e.getUTCFullYear(),n=e.getUTCMonth()+1,i=e.getUTCDate(),r=e.getUTCHours(),o=e.getUTCMinutes(),a=e.getUTCSeconds(),s=e.getUTCMilliseconds();return String.format("{0}-{1}-{2} {3}:{4}:{5}.{6}",this.toFixedLengthString(t,4),this.toFixedLengthString(n,2),this.toFixedLengthString(i,2),this.toFixedLengthString(r,2),this.toFixedLengthString(o,2),this.toFixedLengthString(a,2),this.toFixedLengthString(s,3))},e.prototype.toStatistics=function(e,t,n){for(var i="",a=0;a<e;a++)i+=r.a.indent;if(this.isFromServer)return i+this.serverMeasurements+"\n";var s=n;s||(s=this.beginTime);var l=this.beginTime.getTime()-s.getTime(),u=i+String.format('<{0} {1}="{2}" {3}="{4}" {5}="{6}"',r.a.measurementTag,r.a.titleAttr,o.l.xmlEncode(this.title),r.a.beginTimeAttr,o.l.xmlEncode(l.toString()),r.a.spendTimeAttr,o.l.xmlEncode(this.process()));if(n||(u+=String.format(' {0}="{1}" {2}="{3}"',r.a.machineAttr,o.l.xmlEncode(t),r.a.timeStampeAttr,o.l.xmlEncode(this.toFormatedTimeString(s)))),this.attributes){var c=this.attributes;for(var p in c){var d,h={key:p,value:c[p]};d=h.value.toString(),u+=String.format(' {0}="{1}"',h.key,d)}}var g="";if(this._isEndedNormal||(g+=String.format("<{0}>{1}</{0}>\n",r.a.errorTag,"Inaccurate")),this.children&&this.children.length>0)for(var m=0;m<this.children.length;m++)g+=this.children[m].toStatistics(e+1,t,s);return""===g?u+=" />\n":(u+=">\n",u+=g,u+=i+String.format("</{0}>\n",r.a.measurementTag)),u},e}();(0,a.l)(s,"Measurement",null,[]);var l=function(){function e(){this._currentSize=0,this._isStopWriting=!1,this._buffer=[],this._currentSize=0,this._isStopWriting=!1}return e.prototype.write=function(e){i.AFrameworkApplication.collectPageStats&&(this._isStopWriting||(this._currentSize+e.length>1048576&&(this._isStopWriting=!0,e="ShowPageStats message size reaches 1MB. Stop writing."),Array.add(this._buffer,e),this._currentSize+=e.length,n(179).PageStats.get_pageStatsControl()&&n(179).PageStats.get_pageStatsControl().isDialogDisplayed()&&n(179).PageStats.get_pageStatsControl().displayStatisticIncremental(e)))},e.prototype.read=function(){return i.AFrameworkApplication.collectPageStats?this._buffer.join(""):null},e}();(0,a.l)(l,"PageStatsBuffer",null,[]);var u=n(508),c=n(574),p=n(92),d=function(){function e(){}return e.dialogHtml="<div class='WACDialogRow' id='PageStatsResultBlock'> <textarea id='PageStatsResult' class='PageStatsResult' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>",e}();(0,a.l)(d,"PageStatsDialogHtml",null,[]);var h=n(643),g=n(344),m=n(773),_="PageStatsDialog",f="ShowPageStats",y="PageStatsResultBlock",v=function(e){function t(t,n){var i=e.call(this)||this;i._pageStatsControl=null,i._textAreaElement=null,i.set_dialogHtml(d.dialogHtml),i.set_dialogId(_),i.set_buttonsOption(0),i.setButtonText(1,CommonUIStrings.l_DialogClose);var r={PageStatsResult:n};return i.initializeAndShow(f,a.i(i,i.pageStatsDialogHandler,"pageStatsDialogHandler"),r),i.setDescribedByForDialog(i.myId(y)),i._textAreaElement=document.getElementById("PageStatsResult"),i._textAreaElement.focus(),i._pageStatsControl=t,i}return(0,u.t)(t,e),t.prototype.initCheckBox=function(e){var t=n(179).PageStats.showPageStatsQueryParam,i=!1,r=g.g(t);r&&(i="1"===r),e.PageStatsAutoApplyCheckBox=i},t.prototype.pageStatsDialogHandler=function(e,t){this._pageStatsControl.dialogClosed()},t.prototype.checkBoxHandler=function(e){var t=n(179).PageStats.showPageStatsQueryParam;if(e.PageStatsAutoApplyCheckBox){var i=window.location.pathname.lastIndexOf("/"),r="";i>=0&&(r=window.location.pathname.substring(0,i+1)),g.q(t,"1",1,r)}else g.w(t)},t.prototype.appendText=function(e){i.AFrameworkApplication.showPageStats&&(this._textAreaElement.value=this._textAreaElement.value+e)},t.prototype.getHeightMinusPadding=function(e,t){var n=m.o.getCurrentStyle(t),i=e-Number.parseInvariant(n.paddingTop.replace("px",""))-Number.parseInvariant(n.paddingBottom.replace("px",""));return i<0?0:i},t.prototype.getWidthMinusOffset=function(e,t){var n=e-t.offsetLeft;return n<0?0:n},t.prototype.getWidthMinusPadding=function(e,t){var n=m.o.getCurrentStyle(t),i=e-Number.parseInvariant(n.paddingLeft.replace("px",""))-Number.parseInvariant(n.paddingRight.replace("px",""));return i<0?0:i},t.prototype.setDialogProperties=function(t){e.prototype.setDialogProperties.call(this,t),this.setPageStatsDialogProperties()},t.prototype.setPageStatsDialogProperties=function(){var e=2*h.h.get_pageWidth()/3;e=(e=e>600?600:e)<50?50:e;var t=Number.parseInvariant(this._divMessageBox.style.top.replace("px","")),n=h.h.get_pageHeight()-(t<0?0:t)-50;n=n<50?50:n,this._divMessageBox.style.width=String.format("{0}px",e),this._divMessageBox.style.height=String.format("{0}px",n);var i=this._body.parentNode,r=this._textElement.children[0],o=r.children[0],a=new Sys.UI.Bounds(0,0,0,0);a.height=this._divMessageBox.clientHeight-i.offsetTop-this._buttonPanel.offsetHeight,a.width=this.getWidthMinusOffset(this._divMessageBox.clientWidth,i),a.height=this.getHeightMinusPadding(a.height,i),a.height=this.getHeightMinusPadding(a.height,r),a.width=this.getWidthMinusPadding(a.width,i),o.style.height=String.format("{0}px",a.height),o.style.width=String.format("{0}px",a.width)},t.prototype.setPageStatsDialogPropertiesInDebug=function(e){var t=this._textElement.children[1];e.height=e.height-t.offsetHeight},t.prototype.sizeFix=function(t){this.setPageStatsDialogProperties(),e.prototype.sizeFix.call(this,t)},t}(p.o);(0,a.l)(v,"PageStatsDialog",p.o,[]);var S=function(){function e(e){this._target=null,this._controlElement=null,this._pageStatsDialog=null,this._initialized=!1,i.AFrameworkApplication.showPageStats&&(this._pageStatsDialog=null,this._target=e,this._initialized=!1)}return e.prototype.init=function(){i.AFrameworkApplication.showPageStats&&(this._initialized||(n(179).PageStats.get_activeFrame().get_theClickInputManager().registerHandlerWithData(c.d.click,this._controlElement,a.i(this,this.pageStatsControlClickHandler,"pageStatsControlClickHandler"),this),n(179).PageStats.get_activeFrame().add_onResize(a.i(this,this.resizeHandler,"resizeHandler")),n(179).PageStats.registerControl(this),this._initialized=!0))},e.prototype.resizeHandler=function(){},e.prototype.dispose=function(){i.AFrameworkApplication.showPageStats&&(this._initialized&&(n(179).PageStats.get_activeFrame().get_theMouseInputManager()&&n(179).PageStats.get_activeFrame().get_theClickInputManager().unregisterHandler(c.d.click,this._controlElement,a.i(this,this.pageStatsControlClickHandler,"pageStatsControlClickHandler")),n(179).PageStats.get_activeFrame().remove_onResize(a.i(this,this.resizeHandler,"resizeHandler")),n(179).PageStats.unregisterControl()),this._target.removeChild(this._controlElement),this._controlElement=null)},e.prototype.isDialogDisplayed=function(){return!!i.AFrameworkApplication.showPageStats&&!!this._pageStatsDialog},e.prototype.displayStatisticIncremental=function(e){i.AFrameworkApplication.showPageStats&&this._pageStatsDialog&&this._pageStatsDialog.appendText(e)},e.prototype.pageStatsControlClickHandler=function(e){return!!i.AFrameworkApplication.showPageStats&&(this._pageStatsDialog=new v(this,n(179).PageStats.bufferedStats()),!0)},e.prototype.dialogClosed=function(){i.AFrameworkApplication.showPageStats&&(this._pageStatsDialog=null)},e}();(0,a.l)(S,"PageStatsControl",null,[Sys.IDisposable]);var C="WACPageStatsButton",b="",A=function(e){function t(t){var r=e.call(this,t)||this;if(!i.AFrameworkApplication.showPageStats)return r;var o=t.ownerDocument;r._controlElement=o.createElement("div"),r._controlElement.id=C,r._controlElement.className=C,r._controlElement.style.display="block",r._controlElement.innerText=b,r._controlElement.style.zIndex="500";var a=n(179).PageStats.get_activeFrame().get_element().clientWidth-200,s=n(179).PageStats.get_activeFrame().get_element().clientHeight-180;return r._controlElement.style.top=s.toString()+"px",r._controlElement.style.left=a.toString()+"px",t.appendChild(r._controlElement),e.prototype.init.call(r),r}return(0,u.t)(t,e),t.prototype.resizeHandler=function(){var e=n(179).PageStats.get_activeFrame().get_element().clientWidth-200,t=n(179).PageStats.get_activeFrame().get_element().clientHeight-180;this._controlElement.style.top=t.toString()+"px",this._controlElement.style.left=e.toString()+"px"},t}(S);(0,a.l)(A,"PageStatsFloatingButton",S,[]);var T=n(101);n.d(t,{PageStats:function(){return w}});var w=function(){function e(){}return e.get_pageStatsControl=function(){return e._pageStatsControl},e.get_activeFrame=function(){return e._activeFrame},e.start=function(t){i.AFrameworkApplication.collectPageStats&&(e._activeFrame=t,e._isStarted=!0)},e.stop=function(){T.b(e._pageStatsControl),e._pageStatsControl=null,e._pageStatsBuffer=null,e._inProgressMeasurement=null,e._rootMeasurement=null,e._activeFrame=null,e._isStarted=!1},e.bufferedStats=function(){return e._pageStatsBuffer.read()},e.isEnabled=function(){return!!i.AFrameworkApplication.collectPageStats&&(!!e._isStarted&&(e._pageStatsBuffer||(e._pageStatsBuffer=new l),!e._pageStatsControl&&i.AFrameworkApplication.showPageStats&&(e._pageStatsControl=new A(document.getElementsByTagName("body")[0])),!0))},e.beginRootMeasurement=function(t,n){if(e.isEnabled()){if(n||(n=new Date),e._inProgressMeasurement){for(var i=e._inProgressMeasurement;i.parent;)i=i.parent;e._pageStatsBuffer.write(i.toStatistics(0,"Client",null)),e._inProgressMeasurement=null,e._rootMeasurement=null}e.beginMeasurement(t,n)}},e.beginMeasurement=function(t,n){if(e.isEnabled()){n||(n=new Date);var i=new s(t,!1);i.beginTime=n,e._inProgressMeasurement?(e._inProgressMeasurement.addChild(i),e._inProgressMeasurement=i):(e._inProgressMeasurement=i,e._rootMeasurement=i)}},e.beginChildMeasurement=function(t,n){e.isEnabled()&&(n||(n=new Date),e._inProgressMeasurement&&e.beginMeasurement(t,n))},e.endRootMeasurement=function(t){e.isEnabled()&&e._inProgressMeasurement&&(e._inProgressMeasurement.parent&&(e._inProgressMeasurement=e._rootMeasurement),e.endMeasurement(t))},e.endMeasurement=function(t,n){if(e.isEnabled()&&e._inProgressMeasurement)if(n||(n=new Date),e._inProgressMeasurement.title,e._inProgressMeasurement.endTime=n,e._inProgressMeasurement.process(),e._inProgressMeasurement.parent){e._inProgressMeasurement;e._inProgressMeasurement=e._inProgressMeasurement.parent}else e._pageStatsBuffer.write(e._inProgressMeasurement.toStatistics(0,"Client",null)),e._inProgressMeasurement=null,e._rootMeasurement=null},e.endChildMeasurement=function(t,n){e.isEnabled()&&e.endMeasurement(t,n)},e.addServerMeasurements=function(t){if(e.isEnabled()&&""!==t)if(e._inProgressMeasurement){var n=new s(t,!0);e._inProgressMeasurement.addChild(n)}else e._pageStatsBuffer.write(t+"\n")},e.addAttribute=function(t,n){e.isEnabled()&&e._inProgressMeasurement&&e._inProgressMeasurement.addAttribute(t,n)},e.registerControl=function(t){e._pageStatsControl=t},e.unregisterControl=function(){e._pageStatsControl=null},e._inProgressMeasurement=null,e._rootMeasurement=null,e._pageStatsBuffer=null,e._isStarted=!1,e._pageStatsControl=null,e._activeFrame=null,e.showPageStatsQueryParam="showpagestats",e.showPageStatsXHRHeader="X-ShowPageStats",e.pageStatsResponseXHRHeader="X-PageStats",e}();(0,a.l)(w,"PageStats",null,[])},,,,function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var i=function(e){if(e<=65535)return e.toString();if(e>>>24>=36)return String.fromCharCode.call(null,e>>>24&255,e>>>16&255,e>>>8&255,255&e);var t="abcdefghijklmnopqrstuvwxyz0123456789";return""+t.charAt(e>>>24&63)+t.charAt(e>>>18&63)+t.charAt(e>>>12&63)+t.charAt(e>>>6&63)+t.charAt(63&e)}},function(e,t,n){"use strict";n.d(t,{v:function(){return r}});var i=n(208),r=function(){function e(){}return e.SelectedItemId="SelectedItemId",e}();(0,i.l)(r,"DropDownCommandProperties",null,[])},function(e,t,n){var i=n(950);e.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())}))},,function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var i=n(208),r=(i.y("Sys.IEnumerator$1"),{$$:function(e){var t="IEnumerator$1$"+e.getName();return(0,i.g)(t)}})},,,,function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var i=n(208),r=function(){return function(e,t,n){this.retryCount=0,this.messageId=null,this.payload=null,this.callback=null,this.retryCount=0,this.messageId=e,this.payload=t,this.callback=n}}();(0,i.l)(r,"PostMessageRequest",null,[])},function(e,t,n){"use strict";n.d(t,{o:function(){return o}});var i=n(513),r=n(208),o=function(){function e(e){this._node=null,this._node=e}return e.prototype.get_node=function(){return this._node},e.prototype.set_node=function(e){return this._node=e,e},e.prototype.get_name=function(){return e.getNodeName(this._node)},e.prototype.get_children=function(){return e.getNodeChildren(this._node)},e.prototype.get_attributes=function(){return e.getNodeAttributes(this._node)},e.prototype.get_hasChildren=function(){return e.getNodeChildren(this._node).length>0},e.getFirstChildNodeWithName=function(t,n){for(var i=e.getNodeChildren(t),r=i.length,o=null,a=0;a<r;a++){if((o=i[a])[e.NAME]===n)return o}return null},e.getNodeName=function(t){return t[e.NAME]},e.getNodeChildren=function(t){var n=t[e.CHILDREN];return i.x(n)?e.get_emptyArray():n},e.get_emptyArray=function(){return i.x(e.s_emptyArray)&&(e.s_emptyArray=[]),e.s_emptyArray},e.getNodeAttributes=function(t){return t[e.ATTRIBUTES]},e.getNodeAttribute=function(t,n){return t[e.ATTRIBUTES][n]},e.ATTRIBUTES="attrs",e.CHILDREN="children",e.NAME="name",e.ALIGNMENT="Alignment",e.ALT="Alt",e.ARIALABELLEDBYID="ariaLabelledById",e.ARRANGEMENT="Arrangement",e.ARRANGEMENTVERTICAL="Vertical",e.CLASSNAME="Classname",e.COLOR="Color",e.COMMAND="Command",e.CONTEXTUALGROUPID="ContextualGroupId",e.CSSCLASS="CssClass",e.DESCRIPTION="Description",e.DISPLAYCOLOR="DisplayColor",e.DISPLAYMODE="DisplayMode",e.DIVIDER="Divider",e.ELEMENTDIMENSIONS="ElementDimensions",e.GREEN="Green",e.GROUPID="GroupId",e.HEIGHT="Height",e.HORIZONTALALIGNMENT="HorizontalAlignment",e.id="Id",e.IMAGE="Image",e.IMAGECLASS="ImageClass",e.imagE16BY16="Image16by16",e.imagE32BY32="Image32by32",e.INDEX="Index",e.ISSTRETCHED="IsStretched",e.KEYTIP="Keytip",e.LABELTEXT="LabelText",e.LANGUAGE="Language",e.LAYOUTTITLE="LayoutTitle",e.LOADING="Loading",e.LOWSCALEWARNING="LowScaleWarning",e.MAGENTA="Magenta",e.MAXHEIGHT="MaxHeight",e.MAXIMUMVALUE="MaximumValue",e.MAXWIDTH="MaxWidth",e.MENUITEMID="MenuItemId",e.MESSAGE="Message",e.MINHEIGHT="MinHeight",e.MINIMUMVALUE="MinimumValue",e.ONEROW="OneRow",e.ORANGE="Orange",e.OVERFLOW="Overflow",e.PURPLE="Purple",e.SCROLLABLE="Scrollable",e.SEQUENCE="Sequence",e.SHOWMENUSECTIONSEPERATOR="ShowMenuSectionSeparator",e.SHOWMENUSECTIONTITLEICON="ShowMenuSectionTitleIcon",e.SHOWMENUSECTIONTITLEBACKGROUND="ShowMenuSectionTitleBackground",e.MENUSECTIONTITLEFOCUSABLE="MenuSectionTitleFocusable",e.SHOWECTIONSEPERATOR="ShowSectionSeparator",e.SINGLEDOCK="SingleDock",e.SIZE="Size",e.STEP="Step",e.STYLE="Style",e.TEMPLATEALIAS="TemplateAlias",e.TEXTALIGN="TextAlign",e.THEME="Theme",e.THREEROW="ThreeRow",e.TITLE="Title",e.TITLEID="TitleId",e.TWOROW="TwoRow",e.TYPE="Type",e.UNITTYPE="UnitType",e.VALUE="Value",e.WIDTH="Width",e.YELLOW="Yellow",e.RIBBON="Ribbon",e.JEWEL="Jewel",e.TABS="Tabs",e.CONTEXTUALTABS="ContextualTabs",e.CONTEXTUALGROUP="ContextualGroup",e.TAB="Tab",e.SCALING="Scaling",e.MAXSIZE="MaxSize",e.SCALE="Scale",e.GROUP="Group",e.GROUPS="Groups",e.LAYOUT="Layout",e.COLLAPSIBLESECTION="CollapsibleSection",e.SECTION="Section",e.OVERFLOWSECTION="OverflowSection",e.ROW="Row",e.CONTROL="ControlRef",e.CONTROLS="Controls",e.MENU="Menu",e.MENUSECTION="MenuSection",e.TEMPLATE="Template",e.TEMPLATES="Templates",e.RIBBONTEMPLATES="RibbonTemplates",e.GROUPTEMPLATE="GroupTemplate",e.GALLERY="Gallery",e.SPECIALTEXTSTRINGS="SpecialTextStrings",e.UNIT="Unit",e.FLOATIE="Floatie",e.TOUCHGROUP="TouchGroup",e.TASKPANE="TaskPane",e.colors="Colors",e.color="Color",e.toggleButton="ToggleButton",e.comboBox="ComboBox",e.dropDown="DropDown",e.button="Button",e.splitButton="SplitButton",e.statefulColorSplitButton="StatefulColorSplitButton",e.statefulImageSplitButton="StatefulImageSplitButton",e.flyoutAnchor="FlyoutAnchor",e.statefulColorFlyoutAnchor="StatefulColorFlyoutAnchor",e.galleryButton="GalleryButton",e.insertTable="InsertTable",e.label="Label",e.searchBox="SearchBox",e.slider="Slider",e.spinner="Spinner",e.textBox="TextBox",e.colorPicker="ColorPicker",e.separator="Separator",e.placeholder="Placeholder",e.clonedControl="ClonedControl",e.jewelMenuLauncher="JewelMenuLauncher",e.BUTTONDOCK="ButtonDock",e.CENTERALIGN="Center",e.DOCKS="Docks",e.HERODOCK="HeroDock",e.LEFTALIGN="Left",e.RIGHTALIGN="Right",e.FIRSTTOLAST="Begin",e.LASTTOFIRST="End",e.TOOLBAR="Toolbar",e.STATUSBAR="StatusBar",e.LARGE="Large",e.MEDIUM="Medium",e.SMALL="Small",e.DIVIDERAFTER="DividerAfter",e.DIVIDERBEFORE="DividerBefore",e.s_emptyArray=null,e}();(0,r.l)(o,"DataNodeWrapper",null,[])},,,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IWacCookieCompliance"),o=n(255),a=n(882),s=n(586);n.d(t,{v:function(){return l}});var l=function(){function e(){this._isCookieComplianceEnabled=!1,this._eventSource=null,this._isCookieComplianceEnabled=!!window.WacCookieCompliance,this._eventSource=new s.f,this.add_onConsentReceived(i.i(this,this.logConsentReceived,"logConsentReceived"))}return e.prototype.get_isConsentNeeded=function(){return this._isCookieComplianceEnabled&&n(254).AFrameworkApplication.get_isCookieBannerVisible()},e.prototype.get_isCookieComplianceEnabled=function(){return this._isCookieComplianceEnabled},e.prototype.add_onConsentReceived=function(e){this._eventSource.addHandler("ConsentReceived",e)},e.prototype.remove_onConsentReceived=function(e){this._eventSource.removeHandler("ConsentReceived",e)},e.prototype.ensureF6BindingIfNeeded=function(){if(this.get_isConsentNeeded()){var e=n(657).FocusManager.instance().getScope(n(751).AFrame.cookieConsentBannerFocusId);e.parent=n(751).AFrame.mainAppFocusId,e.addSetFocus((function(e,t){var n=document.getElementById("msccLearnMore");n&&n.focus()})),n(577).F6Manager.get_instance().addF6(n(751).AFrame.cookieConsentBannerFocusId)}},e.prototype.requestConsentWithSettings=function(e){this._isCookieComplianceEnabled&&(WacCookieCompliance.requestConsentWithSettings(e()),this.add_onConsentReceived((function(){n(577).F6Manager.get_instance().deactivateFocus(n(751).AFrame.cookieConsentBannerFocusId)})),this.logConsentRequested())},e.prototype.checkConsentWithSettings=function(e){return!(!this.get_isConsentNeeded()||!WacCookieCompliance.checkConsentWithSettings(e()))&&(this._eventSource.raiseEvent("ConsentReceived"),!0)},e.prototype.setAllowConsent=function(e){this._isCookieComplianceEnabled&&WacCookieCompliance.setAllowConsent(e)},e.prototype.consentGiven=function(){this.get_isConsentNeeded()&&(WacCookieCompliance.consentGiven(),this._eventSource.raiseEvent("ConsentReceived"))},e.prototype.logConsentRequested=function(){o.ULS.sendTraceTag(24686626,221,50,"CookieBarVisible:{0}",n(254).AFrameworkApplication.get_isCookieBannerVisible()),n(254).AFrameworkApplication.dataPlumber.CookieComplianceBanner|=a.u.cookieComplianceBanner_Shown},e.prototype.logConsentReceived=function(){o.ULS.sendTraceTag(24686627,221,50,"Received Consent"),n(254).AFrameworkApplication.dataPlumber.CookieComplianceBanner|=a.u.cookieComplianceBanner_ConsentedReceived},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,i.l)(l,"WacCookieComplianceWrapper",null,[r])},function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IAppLifecycleManager"),o=n(502),a=n(508),s=n(943),l=function(e){function t(n,r){var o=e.call(this,n,r)||this;return i.m(o,t.$$(n,r)),o}return(0,a.t)(t,e),t.$$=function(e,n){var r="EnumDictionary$2$"+e.getName()+"$"+n.getName(),o=i.x(r);return o||i.u(r,"$$sc.EnumDictionary$2",t,[{TKey:e},{TValue:n}],s.i.$$(e,n),[])},t}(s.i),u=n(795),c=n(242),p=n(255),d=n(461),h=n(266),g=n(667),m=n(478),_=n(810),f=function(e){function t(t){var n=e.call(this)||this;return n._taskManager=null,n._taskManager=t,n}return(0,a.t)(t,e),t.prototype.queueTask=function(e){var t=this;this._taskManager.addTask(new m.c(2,1,0,(function(n){t.tryExecuteTask(e)}),78))},t.get_instance=function(){return t._singletonInstance||(t._singletonInstance=new t(_.y.get_instance()))},t._singletonInstance=null,t}(g.a);(0,i.l)(f,"TaskManagerExecutionScheduler",g.a,[]),n.d(t,{r:function(){return y}});var y=function(){function e(e){this._appStateTasks=null,this._taskScheduler=null,this._appCtorStarted=!1,this._taskScheduler=e,this._appStateTasks=new l(d.w,c.z.$$(Boolean)),this._appStateTasks.add(1,new c.z(Boolean)),this._appStateTasks.add(2,new c.z(Boolean)),this._appStateTasks.add(3,new c.z(Boolean)),this._appStateTasks.add(4,new c.z(Boolean)),this._appStateTasks.add(5,new c.z(Boolean)),this._appStateTasks.add(6,new c.z(Boolean)),this._appStateTasks.add(7,new c.z(Boolean)),this._appStateTasks.add(8,new c.z(Boolean)),this._appStateTasks.add(9,new c.z(Boolean)),this._appStateTasks.add(10,new c.z(Boolean)),this._appStateTasks.add(11,new c.z(Boolean)),this._appStateTasks.add(12,new c.z(Boolean)),this._appStateTasks.add(13,new c.z(Boolean))}return e.prototype.getInitStatusName=function(e){return e.toString()},e.prototype.setAppInitializationStatus=function(e){p.ULS.sendTraceTag(20025679,306,50,"SetAppInitializationStatus: {0}",d.w[e]),h.e.get_instance().addMetric("AppInitStatus_"+d.w[e],(new Date).getTime());try{window.performance&&window.performance.mark&&(window.performance.mark(this.getInitStatusName(e)),1===e&&(this._appCtorStarted=!0),this._appCtorStarted&&1!==e&&window.performance.measure(this.getInitStatusName(e),this.getInitStatusName(1),this.getInitStatusName(e)))}catch(e){}this._appStateTasks.get_item(e).setResult(!0)},e.prototype.clearAppInitializationStatus=function(e){this._appStateTasks.set_item(e,new c.z(Boolean))},e.prototype.isCompleted=function(e){return this._appStateTasks.get_item(e).get_task().get_isCompleted()},e.prototype.executeWhen=function(e,t,n){return void 0===n&&(n=o.d.onlyOnRanToCompletion),this._appStateTasks.get_item(e).get_task().CWCT((function(e){t&&t()}),u.r.get_none(),n,this._taskScheduler)},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=new e(f.get_instance()))},e._singletonInstance=null,e}();(0,i.l)(y,"AppLifecycleManager",null,[r])},function(e,t,n){"use strict";n.r(t),n.d(t,{DOMFocusListing:function(){return p}});var i=n(225),r=n(929),o=n(254),a=n(657),s=n(154),l=n(296),u=n(556),c=n(208),p=function(){function e(e){this._currentElement=null,this._root=null,this._cachedFirstElement=null,this._cachedLastElement=null,this.rememberFirstElement=!1,this.rememberLastElement=!1,this._validTags=[],this._root=e}return e.prototype.dispose=function(){this._currentElement=null,Array.clear(this._validTags),this._validTags=null,this._root=null,this._cachedFirstElement=null,this._cachedLastElement=null},e.prototype.addValidTag=function(e){Array.add(this._validTags,e)},e.prototype.get_currentElement=function(){return this._currentElement},e.prototype.trySetCurrentElement=function(e){return this.setCurrentElement(e,!1)},e.prototype.forceSetCurrentElement=function(e){this.setCurrentElement(e,!0)},e.prototype.setCurrentElement=function(e,t){var n=!0;if(e&&(this._currentElement!==e||t)){if(!this.isFileInputElement(e)&&!a.FocusManager.tryFocus(e))return this._currentElement=null,!0;if(e.nodeType===r.o.element&&3===l.s.getTag(e)){var i=s.g.getAttributeValue(e,"type");switch(null==i?"text":u.l.toLower(i)){case"password":case"text":e.select();break;case"file":n=!1}}}return this.handleTabIndexOnSetCurrentElement(e),this._currentElement=e,!e&&o.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isFocusManagerBugFixEnabled()&&(n=!1),n},e.prototype.isFileInputElement=function(e){if(e.nodeType!==r.o.element)return!1;if(3!==l.s.getTag(e))return!1;var t=s.g.getAttributeValue(e,"type");return null!=t&&"file"===u.l.toLower(t)},e.prototype.get_previousElement=function(){return e.findPreviousElement(this._currentElement,this._root(),this._validTags)},e.prototype.get_nextElement=function(){return e.findNextElement(this._currentElement,this._root(),this._validTags)},e.prototype.get_firstElement=function(){if(this._cachedFirstElement){if(this.rememberFirstElement)return this._cachedFirstElement;this._cachedFirstElement=null}var t=e.firstInElement(this._root(),this._validTags);return this.rememberFirstElement&&(this._cachedFirstElement=t),t},e.prototype.get_lastElement=function(){if(this._cachedLastElement){if(this.rememberLastElement)return this._cachedLastElement;this._cachedLastElement=null}var t=e.lastInElement(this._root(),this._validTags);return this.rememberLastElement&&(this._cachedLastElement=t),t},e.prototype.handleTabIndexOnSetCurrentElement=function(t){s.g.isRadioInputElement(t)&&(s.g.hasFocusableTabIndex(t)||(e.setElementAsFocusable(t),this.setAllOtherRadioButtonInRadioGroupToNonFocusable(t)))},e.prototype.setAllOtherRadioButtonInRadioGroupToNonFocusable=function(t){for(var n=this.get_firstElement();n;)e.shouldSetRadioButtonElementAsNonFocusableDueToOtherRadioButtonFocus(n,t)&&e.setElementAsNonFocusableDueToOtherRadioButtonFocus(n),n=e.findNextElement(n,this._root(),this._validTags)},e.findNextElement=function(t,n,i){return e.findAdjacentElement(t,n,i,!0)},e.findPreviousElement=function(t,n,i){return e.findAdjacentElement(t,n,i,!1)},e.findAdjacentElement=function(t,n,i,r){if(!t)return null;var o=e.highestInvalidElement(t,n);if(!o){var a=l.s.getTag(t);if(!Array.contains(i,a)){var s=e.getFirstOrLastInElement(t,i,r);if(s&&s!==t)return s}o=t}return e.adjacentElementFromCurrent(o,n,i,r)},e.highestInvalidElement=function(t,n){if(t===n||!t||t.nodeType!==r.o.element)return null;var i=e.highestInvalidElement(t.parentNode,n);return i||e.elementFocusable(t)||(i=t),i},e.adjacentElementFromCurrent=function(t,n,i,r){for(var o=null,a=r?t.nextSibling:t.previousSibling;a&&!o;)o=e.getFirstOrLastInElement(a,i,r),a=r?a.nextSibling:a.previousSibling;var s=t.parentNode;return!o&&s!==n&&s?e.adjacentElementFromCurrent(s,n,i,r):o},e.firstInElement=function(t,n){return e.getFirstOrLastInElement(t,n,!0)},e.lastInElement=function(t,n){return e.getFirstOrLastInElement(t,n,!1)},e.getFirstOrLastInElement=function(t,n,i){var o=null;if(t&&t.nodeType===r.o.element&&e.elementFocusable(t)){var a=l.s.getTag(t);(Array.contains(n,a)||s.g.hasFocusableTabIndex(t))&&(o=t);for(var u=i?t.firstChild:t.lastChild;u&&!o;)o=e.getFirstOrLastInElement(u,n,i),u=i?u.nextSibling:u.previousSibling}return o},e.elementFocusable=function(e){var t=!0;if(1===l.s.getTag(e))try{s.g.hasFocusableTabIndex(e)||void 0!==s.g.getAttributeValue(e,"href")&&null!==s.g.getAttributeValue(e,"href")||(t=!1)}catch(e){}else 8===l.s.getTag(e)?s.g.hasFocusableTabIndex(e)||(t=!1):s.g.isRadioInputElement(e)&&!s.g.hasFocusableTabIndex(e,!0)&&(t=!1);return t&&!e.disabled&&s.g.isVisible(e)},e.shouldSetRadioButtonElementAsNonFocusableDueToOtherRadioButtonFocus=function(e,t){var n=s.g.getAttributeValue(t,"name");return e.id!==t.id&&s.g.isRadioInputElement(e)&&s.g.getAttributeValue(e,"name")===n},e.setElementAsNonFocusableDueToOtherRadioButtonFocus=function(e){e.setAttribute("tabIndex","-1")},e.setElementAsFocusable=function(e){e.setAttribute("tabIndex","0")},e}();(0,c.l)(p,"DOMFocusListing",null,[i.x])},function(e,t,n){"use strict";n.d(t,{v:function(){return i}});var i=(0,n(208).y)("IOfficeTrialExperience")},,,function(e,t,n){"use strict";n.d(t,{b:function(){return o}});var i=n(870),r=n(208),o=function(){function e(e){this._ignoreCase=!1,this._ignoreCase=e}return e.prototype.equals=function(e,t){return e&&t?(this._ignoreCase&&(e=e.toUpperCase(),t=t.toUpperCase()),e===t):e===t},e.prototype.getHashCode=function(e){if(!e)return 0;this._ignoreCase&&(e=e.toUpperCase());for(var t=352654597,n=0;n<e.length;n+=2)t=(t<<5)+t+(t>>27)^(e.charCodeAt(n)|e.charCodeAt(n+1)<<16|0);return t},e.get_ordinal=function(){return e._ordinal||(e._ordinal=new e(!1))},e.get_ordinalIgnoreCase=function(){return e._ordinalIgnoreCase||(e._ordinalIgnoreCase=new e(!0))},e._ordinal=null,e._ordinalIgnoreCase=null,e}();(0,r.l)(o,"StringComparer",null,[i.v.$$(String)])},,,function(e,t,n){"use strict";n.d(t,{c:function(){return o},x:function(){return a},i:function(){return s}});var i=n(254),r=n(391),o=function(){var e=i.AFrameworkApplication.get_freemiumUpsellMode(),t=i.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType();return(3===t||1===t||2===t||4===t)&&1===e&&i.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PremiumUpsellIsEnabled")},a=function(e,t){void 0===t&&(t=!1);var n=i.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType(),o=i.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppMode();return String.format("PROD_OfficeOnline-{0}_{1}_{2}_{3}",r.k[n],1===o?"Editor":"Viewer",t?"Dime":"Unknown",e||"dimedefault")},s=function(){switch(i.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";case 5:default:return null}}},function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var i=(0,n(208).y)("IFloatie")},,,function(e,t,n){"use strict";n.d(t,{l:function(){return r},h:function(){return o},i:function(){return a},y:function(){return s},g:function(){return u},r:function(){return c},x:function(){return h},u:function(){return g},m:function(){return m},f:function(){return _},c:function(){return f}});var i=new Map;Type.prototype.implementsInterface=function(e){this.resolveInheritance();var t=e.getName();i.has(this.__typeName)||i.set(this.__typeName,new Map);var n=i.get(this.__typeName);if(n.has(t))return n.get(t);for(var r=this;r;){var o=r.__interfaces;if(o&&-1!==Array.indexOf(o,e))return n.set(t,!0),!0;r=r.__baseType}return n.set(t,!1),!1},Object.getType=function(e){var t=e.constructor;return null!=t&&!t.__typeName&&e.$$genericConstructor&&(t=e.$$genericConstructor),t&&"function"==typeof t&&t.__typeName&&"Object"!==t.__typeName?t:Object},Boolean.parse=function(e){return"false"!==e&&"False"!==e&&("true"===e||"True"===e||"false"!==(e=e.trim().toLowerCase())&&("true"===e||void 0))};var r=function(e,t,n,i){e.prototype.constructor=e,e.__typeName=t,e.__class=!0,e.__class$0=!0,n&&(e.__baseType=n,e.__baseType$0=n,e.__basePrototypePending=!1,e.__basePrototypePending$0=!1),null!=Sys.__upperCaseType&&(Sys.__upperCaseTypes[t.toUpperCase()]=e),i.length>0&&(e.__interfaces=i,e.__interfaces$0=i)},o=function(e,t,n){void 0===n&&(n=!1),null!=Sys.__upperCaseType&&(Sys.__upperCaseTypes[e.toUpperCase()]=t),t.__typeName=e,t.__string=e,t.__flags=n,t.__enum=!0,t.parse=function(e){return t[e]},t.toString=function(e){return t[e]},t.getName=function(){return e}},a=function(e,t,n){var i="$$d_"+n;return null==e[i]&&(e[i]=t.bind(e)),e[i]},s=function(e){var t=function(){};return null!=Sys.__upperCaseType&&(Sys.__upperCaseTypes[e.toUpperCase()]=t),null==t.prototype&&(t.prototype={}),t.prototype.constructor=t,t.__typeName=e,t.__interface=!0,t},l=new Map,u=function(e){return l.has(e)||l.set(e,s(e)),l.get(e)},c=function(e,t){return void 0!==e&&void 0!==t&&e.isInstanceOfType(t)},p=new Set(["$$","length","name","prototype","caller","arguments"]),d=new Map,h=function(e){return d.has(e)?d.get(e):null},g=function(e,t,n,i,o,a,s){var l;if(void 0===o&&(o=void 0),void 0===a&&(a=[]),void 0===s&&(s=void 0),d.has(e))return d.get(e);var u=function(){};r(u,e,o=o||null,a=a||[]);for(var c=((l={})[t]={},l.ctor=n,l),h=0,g=i;h<g.length;h++){var m=g[h],_=Object.keys(m)[0],f=Object.values(m)[0];c[t][_]=f}for(var y=o;y&&!y.hasOwnProperty("$$genericTypeArgs");)y=y.getBaseType();if(y){var v=y.$$genericTypeArgs;for(var S in v)c[S]=v[S]}for(var C=0,b=Object.getOwnPropertyNames(n);C<b.length;C++){var A=b[C];p.has(A)||(u[A]=n[A])}if(u.$$genericTypeArgs=c,u.$$orderedTypeArgs=i.map((function(e){return Object.values(e)[0]})),s)for(var T=0,w=Object.entries(s);T<w.length;T++){var I=w[T],E=I[0],k=I[1];u[E]="function"==typeof k?k():k}return d.set(e,u),u},m=function(e,t){e.$$genericConstructor=t},_=function(e,t){var n=e.$$genericTypeArgs?e:e.$$genericConstructor;if(!n)throw new Error("Template type requested for non-generic type");t||(t=n.__typeName);var i=n.$$genericTypeArgs[t];if(!i)throw new Error("Template type requested for unknown type");return i};function f(e){return e===Number||Type.isEnum(e)?0:e!==Boolean&&null}},function(e,t,n){"use strict";n.d(t,{f:function(){return s}});var i=n(208),r=n(813),o=n(703),a=n(351),s=function(){function e(){this.ribbon=null,this._roots=[]}return e.prototype.get_roots=function(){return this._roots},e.prototype.get_ribbon=function(){return this.ribbon},e.prototype.get_inKeytipMode=function(){return!!this.get_ribbon()&&this.get_ribbon().get_inKeytipMode()},e.prototype.addRoot=function(e){e&&!Array.contains(this._roots,e)&&Array.add(this._roots,e),i.r(n(153).Ribbon,e)&&(this.ribbon=e)},e.prototype.removeRoot=function(e){var t=Array.remove(this._roots,e);return i.r(n(153).Ribbon,e)&&(this.ribbon=null),t},e.prototype.getFirstValidControl=function(e){for(var t=0,n=this.get_roots();t<n.length;t++){var i=n[t],o=(0,a.e)(r.s,i);if(o){var s=e.startsWith(o.get_controlIdPrefix())?e:o.get_controlIdPrefix()+e,l=o.getValidControl(s);if(l)return l}}return null},e.prototype.commitAnyPendingChange=function(){for(var e=0,t=this._roots;e<t.length;e++){t[e].commitAnyPendingChange()}},e.prototype.dispose=function(){this._roots=null},e.get_instance=function(){return e._instance||e.initializeRootManager()},e.initializeRootManager=function(){return e.initializeComponents(),e._instance=new e,e._instance},e.initializeComponents=function(){},e._instance=null,e}();(0,i.l)(s,"RootManager",null,[o.b,Sys.IDisposable])},,,function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var i=n(508),r=n(581),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t.QueryCommand=null,t.Menu=null,t.PopulateOnlyOnce=!1,t.PopulateQueryCommand=null,t.MenuOpenCommand=null,t.MenuCloseCommand=null,t.ImageIsVisible=!1,t.ImageUsesSpaceWhileInvisible=!1,t.AriaLabel=null,t}return(0,i.t)(t,e),t.prototype.get_ControlType=function(){return 9},t}(r.s);(0,o.l)(a,"FlyoutAnchorProps",r.s,[])},,function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var i=(0,n(208).y)("IKeyMoveAdapter")},,function(e,t,n){"use strict";n.d(t,{i:function(){return r}});var i=n(208),r=function(){function e(){this.Id=null,this.ExternalId=null}return e.prototype.get_ControlType=function(){return 0},e}();(0,i.l)(r,"CommonControlProps",null,[])},function(e,t,n){e.exports=n(260)},function(e,t,n){"use strict";var i=n(208),r=n(614),o=n(254),a=n(478),s=n(508),l=n(377),u=function(e){function t(t){return e.call(this,t)||this}return(0,s.t)(t,e),t.prototype.get_couldGenerateLayout=function(){return!0},t.prototype.createElement=function(){var e=document.createElement("img");return e.setAttribute("src",this.get_resourceUrl()),e},t.prototype.createHighPriorityResourceElement=function(){return null},t.prototype.reloadReference=function(){this.element.setAttribute("src",""),this.element.setAttribute("src",this.get_resourceUrl())},t}(l.s);(0,i.l)(u,"ImageResource",l.s,[]);var c=n(265),p=n(984);n.d(t,{z:function(){return d}});var d=function(){function e(){this._paused=!1,this._downloadQueueTask=null,this._taskSet=!1,this._actionsToSlices={},this._queue=[],this._handlers=[],this._scriptsAdded={},this._statusListeners=[];var t=o.AFrameworkApplication.get_theActionManager();t.addAction(r.FC,p.a,e.onDemandLoadDialogDismissed),t.addAction(r.yl,p.a,e.onDemandLoadDialogDismissed),o.AFrameworkApplication.appSettingsManager&&o.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PreloadDll1IsEnabled")?this._downloadQueueTask=new a.c(1,2,10,i.i(this,this.downloadQueueTask,"downloadQueueTask"),20):this._downloadQueueTask=new a.c(3,2,100,i.i(this,this.downloadQueueTask,"downloadQueueTask"),20),this.ensureTaskSet()}return e.prototype.addStatusCallback=function(e){Array.contains(this._statusListeners,e)||Array.add(this._statusListeners,e)},e.prototype.removeStatusCallback=function(e){Array.contains(this._statusListeners,e)&&Array.remove(this._statusListeners,e)},e.prototype.downloadQueueTask=function(e){if(this.updateQueueStatus(String.format("Queue contains {0} elements",this._queue.length)),!this._paused){var t=Array.dequeue(this._queue);t&&(this.updateQueueStatus(String.format("Retrieving {0}",t.get_resourceUrl())),this.addScriptReference(t)),this._queue.length<=0&&this._taskSet&&(o.AFrameworkApplication.get_theTaskManager().deleteTask(this._downloadQueueTask),this._taskSet=!1)}},e.prototype.updateQueueStatus=function(e){for(var t=[],n=[];this._queue.length>0;){var i=Array.dequeue(this._queue);Array.enqueue(n,i),Array.add(t,i.get_resourceUrl())}this._queue=n;for(var r=0;r<this._statusListeners.length;r++){(0,this._statusListeners[r])(e,t)}},e.prototype.ensureTaskSet=function(){this._taskSet||(o.AFrameworkApplication.get_theTaskManager().addTask(this._downloadQueueTask),this._taskSet=!0)},e.prototype.add=function(e,t,n,r){var a=o.AFrameworkApplication.get_theActionManager();n?a.addActionWithFlags(e,t,i.i(this,this.actionHandlerStub,"actionHandlerStub"),n):a.addAction(e,t,i.i(this,this.actionHandlerStub,"actionHandlerStub"));var s=e.toString()+t.toString();this._actionsToSlices[s]=r,Array.enqueue(this._queue,r),this.ensureTaskSet()},e.prototype.addImage=function(e){var t=new u(e);return Array.enqueue(this._queue,t),this.ensureTaskSet(),t},e.prototype.addResource=function(e){Array.enqueue(this._queue,e),this.downloadQueueTask(null),this._queue.length>0&&this.ensureTaskSet()},e.prototype.addHandler=function(e){Array.add(this._handlers,e)},e.prototype.addScriptReference=function(e){e.get_resourceUrl()in this._scriptsAdded?e.get_TCS().setResult(!0):(e.loadResource(),this._scriptsAdded[e.get_resourceUrl()]=e)},e.prototype.removeScriptReference=function(e){e in this._scriptsAdded&&delete this._scriptsAdded[e]},e.prototype.actionHandlerStub=function(e,t,n,r,o){if(this._handlers.length>0)for(var a=0;a<this._handlers.length;a++){var s=(0,this._handlers[a])(e,t,n,r,o);if(2!==s)return s}if(2===n){var l=e.toString()+t.get_contextId().toString(),u=this._actionsToSlices[l],p=u.get_resourceUrl(),d=[];this._scriptsAdded[p]&&this._scriptsAdded[p].promote(e,t,n,r,o,i.i(this,this.actionHandlerStub,"actionHandlerStub"));var h=new c.v(p,u.get_dependencies(),u.get_cdn(),u.get_loadValidationDelegate(),e,t,n,r,o,i.i(this,this.actionHandlerStub,"actionHandlerStub"));Array.enqueue(d,h);for(var g=void 0;g=Array.dequeue(this._queue);)g.get_resourceUrl()!==p&&Array.enqueue(d,g);return this._queue=d,this.downloadQueueTask(null),64}return 1===n?32:2},e.onDemandLoadDialogDismissed=function(e,t,n,i,r){return 32},e.get_instance=function(){return e._instance||(e._instance=new e)},e.enqueueActions=function(t,n){if(t&&n)for(var i=0;i<t.length;i++){var r=t[i];e.get_instance().add(r.get_actionId(),r.get_contextId(),r.get_flags(),n)}},e.enqueueMultipleActions=function(t,n){var i=c.v.create(o.AFrameworkApplication.scriptUrlFromName(n,0));e.enqueueActions(t,i)},e.enqueueImage=function(t){return e.get_instance().addImage(t)},e.registerDispatchHandler=function(t){e.get_instance().addHandler(t)},e.enqueueWithoutEnabling=function(t,n,i,r,a,s,l){void 0===n&&(n=null),void 0===i&&(i=0),void 0===r&&(r=!1),void 0===a&&(a=!1),void 0===s&&(s=null),void 0===l&&(l=!0);var u=c.v.create(o.AFrameworkApplication.scriptUrlFromName(t,i),null,null,null,r,a,s,l);u.add_loadFinished((function(e,t){n&&n(e,t)})),e.get_instance().addResource(u)},e.enqueueResourceWithoutEnabling=function(t){t.get_isDownloading()||t.get_loadFinishedTask().get_isCompleted()||e.get_instance().addResource(t)},e.removeReferenceForRetryDownload=function(t){e.get_instance().removeScriptReference(t)},e._instance=null,e}();(0,i.l)(d,"DownloadQueue",null,[])},function(e,t,n){"use strict";n.d(t,{c:function(){return r}});var i=n(208),r=function(){function e(){}return e.startWacBoot="StartWacBoot",e.userClickedHostUI="UserClickedHostUI",e.hostDuration="HostDuration",e.hostPageFetchStart="HostPageFetchStart",e.serverDiagnostics="ServerDiagnostics",e.bootDiagnostics="BootDiagnostics",e.bootResourceStart="BootResourceStart",e.bootResourceForContentEditableEnd="BootResourceForContentEditableEnd",e.bootResourceForContentViewableStart="BootResourceForContentViewableStart",e.bootResourceForContentViewableEnd="BootResourceForContentViewableEnd",e.additionalBootResourceStart="AdditionalBootResourceStart",e.additionalBootResourceEnd="AdditionalBootResourceEnd",e.resourceDownload="ResourceDownload",e.resourceDownloadStart="ResourceDownloadStart",e.resourceDownloadDuration="ResourceDownloadDuration",e.firstSliceLoad="FirstSliceLoad",e.firstSliceLoadStart="FirstSliceLoadStart",e.firstSliceLoadDuration="FirstSliceLoadDuration",e.secondSliceLoadStart="SecondSliceLoadStart",e.secondSliceLoadDuration="SecondSliceLoadDuration",e.collabSliceLoad="CollabSliceLoad",e.collabSliceLoadStart="CollabSliceLoadStart",e.collabSliceLoadDuration="CollabSliceLoadDuration",e.contentFetch="ContentFetch",e.contentFetchStart="ContentFetchStart",e.contentRequestStartToFirstByteDuration="ContentRequestStartToFirstByteDuration",e.contentResponseStart="ContentResponseStart",e.contentDownloadDuration="ContentDownloadDuration",e.serverContentResponseStart="ServerContentResponseStart",e.checkFileInfoStartTime="CheckFileInfoStartTime",e.checkFileInfoEndTime="CheckFileInfoEndTime",e.getFlightedAppSettingsStartTime="GetFlightedAppSettingsStartTime",e.getFlightedAppSettingsEndTime="GetFlightedAppSettingsEndTime",e.acquireLockStartTime="AcquireLockStartTime",e.acquireLockEndTime="AcquireLockEndTime",e.getDocumentStartTime="GetDocumentStartTime",e.getDocumentEndTime="GetDocumentEndTime",e.initialRequestInvokedTime="InitialRequestInvokedTime",e.initialResponseReceivedTime="InitialResponseReceivedTime",e.initialResponseReadyTime="InitialResponseReadyTime",e.skeletalDismissStart="SkeletalDismissStart",e.skeletalDismissDuration="SkeletalDismissDuration",e.fastViewOpenTime="FastViewOpenTime",e.fastViewEntryPoint="FastViewEntryPoint",e.fastViewDismissStart="FastViewDismissStart",e.fastViewDismissDuration="FastViewDismissDuration",e.contentViewable="ContentViewable",e.contentViewableHiddenSSR="ContentViewableHiddenSSR",e.contentEditableEnd="ContentEditableEnd",e.editable="Editable",e.contentEditable="ContentEditable",e.coreEditingStart="CoreEditingStart",e.coreEditingDuration="CoreEditingDuration",e.browserFetchStartToContentViewableDuration="StartToContentViewableDuration",e.browserFetchStartToContentEditableDuration="StartToContentEditableDuration",e.documentLoadedTime="DocumentLoadedTime",e.appInit="AppInit",e.appInitStart="AppInitStart",e.appInitDuration="AppInitDuration",e.wopiPendingInitialize="WopiPendingInitialize",e.wopiPendingComplete="WopiPendingComplete",e.startSessionStart="StartSessionStart",e.startSessionComplete="StartSessionComplete",e.readyMessageReceiveTime="ReadyMessageReceiveTime",e.completeMessageCreateTime="CompleteMessageCreateTime",e.completeMessageSendTime="CompleteMessageSendTime",e.isStartSessionFromWac="IsStartSessionFromWac",e.appSettingsFetched="AppSettingsFetched",e.frameNavigationStart="FrameNavigationStart",e.frameFetchStart="FrameFetchStart",e.frameDomainLookupStart="FrameDomainLookupStart",e.frameDomainLookupEnd="FrameDomainLookupEnd",e.frameConnect="FrameConnect",e.frameConnectStart="FrameConnectStart",e.frameSecureConnectionStart="FrameSecureConnectionStart",e.frameConnectEnd="FrameConnectEnd",e.frameRequest="FrameRequest",e.frameRequestStart="FrameRequestStart",e.frameResponse="FrameResponse",e.frameResponseStart="FrameResponseStart",e.frameDownloadDuration="FrameDownloadDuration",e.frameRequestStartToFirstByteDuration="FrameRequestStartToFirstByteDuration",e.frameTransferSize="FrameTransferSize",e.frameDecodedSize="FrameDecodedSize",e.frameEncodedSize="FrameEncodedSize",e.inbound="Inbound",e.inboundStart="InboundStart",e.inboundEnd="InboundEnd",e.parseResponse="ParseResponse",e.parseResponseStart="ParseResponseStart",e.parseResponseDuration="ParseResponseDuration",e.parseResponseDeserialization="ParseResponseDeserialization",e.parseResponseDeserializationStart="ParseResponseDeserializationStart",e.parseResponseDeserializationDuration="ParseResponseDeserializationDuration",e.pageViewSize="PageViewSize",e.pageViewValidationStart="PageViewValidationStart",e.pageViewValidationEnd="PageViewValidationEnd",e.pageViewValidationDuration="PageViewValidationDuration",e.pageViewValidation="PageViewValidation",e.validationPhaseDurations="ValidationPhaseDurations",e.renderDuration="RenderDuration",e.navPaneValidation="NavPaneValidation",e.navPaneValidationStart="NavPaneValidationStart",e.navPaneValidationDuration="NavPaneValidationDuration",e.navPaneValidationPhaseDurations="NavPaneValidationPhaseDurations",e.navPaneRenderDuration="NavPaneRenderDuration",e.pageViewInitSelection="PageViewInitSelection",e.pageViewInitSelectionStart="PageViewInitSelectionStart",e.scrollDuration="Scroll Duration",e.scrollDurationStart=":Scroll:Start",e.scrollDurationEnd=":Scroll:End",e.getCellsStartToClientGetCellsFetchStartDuration="GetCellsStartToClientGetCellsFetchStartDuration",e.graphObjectUsage="GraphObjectUsage",e.paragraphUsage="ParagraphUsage",e.metadataContentBytes="ContentBytes",e.metadataEmptyDoc="EmptyDoc",e.userActions="UserActions",e.visiToggled="VisiToggled",e.pageTargetSource="PageTargetSource",e.isNewFile="IsNewFile",e.newFileTemplateName="TemplateName",e.newFileTemplateLcid="TemplateLcid",e.indexedDBErrorMessage="IndexedDBErrorMessage",e.indexedDBOpenStart="IndexedDBOpenStart",e.indexedDBOpenDuration="IndexedDBOpenDuration",e.indexedDBUpgradeDuration="IndexedDBUpgradeDuration",e.indexedDBOpenErrorDuration="IndexedDBOpenErrorDuration",e.indexedDBGetDuration="IndexedDBGetDuration",e.indexedDBGetErrorDuration="IndexedDBGetErrorDuration",e.indexedDBPutStart="IndexedDBPutStart",e.indexedDBPutDuration="IndexedDBPutDuration",e.indexedDBPutErrorDuration="IndexedDBPutErrorDuration",e.indexedDBCacheHitState="IndexedDBCacheHitState",e.isContentSync="IsContentSync",e.socketInitStart="SocketInitStart",e.socketConnectDuration="SocketConnectDuration",e.socketOpenDuration="SocketOpenDuration",e.socketOpenTimeout="SocketOpenTimeout",e.socketCloseBeforeOpen="SocketCloseBeforeOpen",e.tenantId="OneNoteTenantId",e.isEduUser="IsEduUser",e.contentSyncFallbackMessage="ContentSyncFallbackMessage",e.hierarchyFetch="HierarchyFetch",e.hierarchyTransformation="HierarchyTransformation",e.isDullScript="IsDullScript",e.isWacBootNewJS="IsWacBootNewJS",e.officeInitializationTime="OfficeInitializationTime",e.modeSwitchTime="ModeSwitchTime",e.isFallback="IsFallback",e.isInstant="IsInstant",e.hostInitDiagnostics="HostInitializeDiagnostics",e.jsApiDiagnostics="JsApiDiagnostics",e.digitalPrintSaveDuration="DigitalPrintSaveDuration",e.digitalPrintTimeSpent="DigitalPrintTimeSpent",e.swayPreviewRequestDuration="SwayPreviewRequestDuration",e.swayPreviewFailedRequestDuration="SwayPreviewFailedRequestDuration",e.swayCheckSwayLicenseRequestDuration="SwayCheckSwayLicenseRequestDuration",e.swayCheckSwayLicenseFailedRequestDuration="SwayCheckSwayLicenseRequestFailedDuration",e.ribbonInteractiveReady="RibbonInteractiveReady",e.deepLinkingCommentSelected="SharedCommentsDeepLinkComplete",e.navigationViewableCacheUsed="NavigationViewableCacheUsed",e.navigationEditableCacheUsed="NavigationEditableCacheUsed",e.bootSSRHtmlStringLength="BootSSRHtmlStringLength",e.networkType="NetworkType",e.appStaticResourceMetrics="AppStaticResources",e.onPollHitWhenResponseWasReadyButWasNotParsedCount="OnPollHitWhenResponseWasReadyButWasNotParsedCount",e.onPollHitWhenResponseWasReadyStart="OnPollHitWhenResponseWasReadyStart",e.eupl="EUPL",e.timeToInteractive="TimeToInteractive",e.splashScreenShown="SplashScreenShown",e.firstPaint="FirstPaint",e.firstContentfulPaint="FirstContentfulPaint",e.cloudFontFetchStart="CloudFontFetchStart",e.cloudFontRequestStartToFirstByteDuration="CloudFontRequestStartToFirstByteDuration",e.cloudFontResponseStart="CloudFontResponseStart",e.cloudFontDownloadDuration="CloudFontDownloadDuration",e}();(0,i.l)(r,"Metrics",null,[])},function(e,t,n){"use strict";var i=n(254),r=n(597),o=n(222),a=n(508),s=n(562),l=n(208),u=function(e){function t(t){return e.call(this,5,t)||this}return(0,a.t)(t,e),t}(s.w);(0,l.l)(u,"ResizeAnimationEvent",s.w,[]);var c=function(e){function t(t){return e.call(this,7,t)||this}return(0,a.t)(t,e),t}(s.w);(0,l.l)(c,"ScrollAnimationEvent",s.w,[]);var p=n(333),d=n(876),h=n(154),g=n(425),m=n(296);n.d(t,{r:function(){return _}});var _=function(){function e(){}return e.get_ribbonPanelId=function(){return i.AFrameworkApplication.get_activeFrame()?n(752).AppFrame.ribbonPanelId:null},e.get_statusBarPanel=function(){return i.AFrameworkApplication.get_activeFrame()?i.AFrameworkApplication.get_activeFrame().get_statusBarPanel():null},e.animateSize=function(e,t,n,i){var r=e.style.height,o=e.style.width,a=m.s.parseCssSize(r),s=m.s.parseCssSize(o);""===r.trim()&&(a=t),""===o.trim()&&(s=n),d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var l=new u(e);l.animateHeight(a,t),l.animateWidth(s,n),d.WacAirSpace.animate(l,null,i)},e.animateScroll=function(e,t,n,i){var r=e.scrollLeft,o=e.scrollTop;d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var a=new c(e);return isNaN(t)||a.animateScrollLeft(r,t),isNaN(n)||a.animateScrollTop(o,n),d.WacAirSpace.animate(a,null,i)},e.animatePosition=function(e,t,n){var r;r=i.AFrameworkApplication.get_isRtl()?e.style.right:e.style.left;var a=e.style.top,s=m.s.parseCssSize(r),l=m.s.parseCssSize(a);""===r.trim()&&(s=t),""===a.trim()&&(l=n),d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var u=new o.r(e);u.animateX(s,t,i.AFrameworkApplication.get_isRtl()),u.animateY(l,n),d.WacAirSpace.animate(u,null,null)},e.animateYPosition=function(e,t){var n=e.style.top,i=m.s.parseCssSize(n);""===n.trim()&&(i=t),d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var r=new o.r(e);r.animateY(i,t),d.WacAirSpace.animate(r,null,null)},e.animateFoundCurrentResultHighlight=function(t,n){d.WacAirSpace.setAnimationClass(n,"Shared_QuickClass");var i=new p.g(n);i.animateOpacity(0,.4),d.WacAirSpace.animate(i,null,null),d.WacAirSpace.setAnimationClass(t,"Shared_QuickClass");var o=new r.y(t);o.animateOpacity(.4,0),d.WacAirSpace.animate(o,null,e.onAfterCloneFadeOut)},e.animateClearCurrentResultHighlight=function(t,n){d.WacAirSpace.setAnimationClass(n,"Shared_QuickClass");var i=new p.g(n);i.animateOpacity(0,.4),d.WacAirSpace.animate(i,null,null),d.WacAirSpace.setAnimationClass(t,"Shared_QuickClass");var o=new r.y(t);o.animateOpacity(.4,0),d.WacAirSpace.animate(o,null,e.onAfterCloneFadeOut)},e.animateFindPane=function(e,t,n){d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var r,a=new o.r(e);r=i.AFrameworkApplication.get_isRtl()?e.style.right:e.style.left;var s=m.s.parseCssSize(r);t?a.animateX(s,0,i.AFrameworkApplication.get_isRtl()):(i.AFrameworkApplication.get_isRtl()?""===e.style.right.trim()&&(s=-1*e.clientWidth):""===e.style.left.trim()&&(s=-1*e.clientWidth),a.animateX(s,-1*e.clientWidth,i.AFrameworkApplication.get_isRtl())),d.WacAirSpace.animate(a,null,n)},e.animateCommentPane=function(e,t,n){d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var r,a=new o.r(e);r=i.AFrameworkApplication.get_isRtl()?e.style.left:e.style.right;var s=m.s.parseCssSize(r);if(t)a.animateXRight(s,0,i.AFrameworkApplication.get_isRtl());else{var l=-1*e.clientWidth;i.AFrameworkApplication.get_isRtl()?""===e.style.left.trim()&&(s=l):""===e.style.right.trim()&&(s=l),a.animateXRight(s,-1*e.clientWidth,i.AFrameworkApplication.get_isRtl())}d.WacAirSpace.animate(a,null,n)},e.resizeContainerAnimation=function(t,n,i,r){d.WacAirSpace.setAnimationClass(t,"Shared_BasicClass");var a=m.s.parseCssSize(t.style.left);""===t.style.left.trim()&&(a=n);var s=new o.r(t);s.animateX(a,n,!1),(g.y.get_isInternetExplorer8()||e._firstContainerAnimation)&&d.WacAirSpace.temporarilyDisableAnimation(1e3),e._firstContainerAnimation=!1,d.WacAirSpace.animate(s,null,null);var l=m.s.parseCssSize(t.style.width);""===t.style.width.trim()&&(l=i);var c=new u(t);c.animateWidth(l,i),d.WacAirSpace.animate(c,null,r)},e.animateChromeInWordViewer=function(t,n){var i=document.getElementById(e.get_ribbonPanelId());if(i){d.WacAirSpace.setAnimationClass(i,"Shared_BasicClass");var r=new o.r(i);r.animateY(-t,0),d.WacAirSpace.animate(r,null,null)}var a=e.get_statusBarPanel();if(a){d.WacAirSpace.setAnimationClass(a,"Shared_BasicClass");var s=new u(a);s.animateHeight(0,n),d.WacAirSpace.animate(s,null,null),d.WacAirSpace.setAnimationClass(a,"Shared_BasicClass");var l=new p.g(a);l.animateOpacity(0,1),d.WacAirSpace.animate(l,null,null)}},e.animateCommentHintPosition=function(e,t,n){var i=m.s.parseCssSize(e.style.top),r=m.s.parseCssSize(e.style.left);d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var a=new o.r(e);a.animateY(i||t,t),a.animateX(r||n,n,!1),d.WacAirSpace.animate(a,null,null)},e.animateHideHighlight=function(e){h.g.setOpacity(e,0)},e.animateShowHighlight=function(e){var t=h.g.getOpacity(e)/100;d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var n=new p.g(e);n.animateOpacity(t,.4),d.WacAirSpace.animate(n,null,null)},e.onAfterCloneFadeOut=function(e){var t=e.get_element();t&&t.parentNode&&t.parentNode.removeChild(t)},e._firstContainerAnimation=!0,e}();(0,l.l)(_,"WordViewerAnimator",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,{MoveDragAdapter:function(){return s}});var i=n(107),r=n(254),o=n(773),a=n(208),s=function(){function e(e){this._moveElement=null,this._cursorOffsetX=0,this._cursorOffsetY=0,this._moveElementMargin=null,this._moveElementMarginSet=!1,this._moveElement=e}return e.prototype.isDragPossible=function(e){return!0},e.prototype.onDragStart=function(e){var t=e.get_clientPoint().x,n=e.get_clientPoint().y,i=this._moveElement.offsetLeft,r=this._moveElement.offsetTop,o=this.getMargin(this._moveElement);return this._cursorOffsetX=t-i+o.x,this._cursorOffsetY=n-r+o.y,!0},e.prototype.onDragMove=function(e){var t=e.get_clientPoint().x-this._cursorOffsetX,n=e.get_clientPoint().y-this._cursorOffsetY,i=r.AFrameworkApplication.get_activeFrame().getDOMElement();if(this._moveElementMarginSet||(this._moveElementMargin=this.getMargin(this._moveElement),this._moveElementMarginSet=!0),t+this._moveElementMargin.x<0)t=-this._moveElementMargin.x;else{var o=i.offsetWidth-this._moveElement.offsetWidth-this._moveElementMargin.x;t>o&&(t=o)}if(n+this._moveElementMargin.y<0)n=-this._moveElementMargin.y;else{var a=i.offsetHeight-this._moveElement.offsetHeight-this._moveElementMargin.y;n>a&&(n=a)}return r.AFrameworkApplication.get_isRtl()?this._moveElement.style.right=i.offsetWidth-t-this._moveElement.offsetWidth+"px":this._moveElement.style.left=t+"px",this._moveElement.style.top=n+"px",!0},e.prototype.onDragEnd=function(e){},e.prototype.onDragCancel=function(e){},e.prototype.getMargin=function(e){var t=o.o.getCurrentStyle(e);if(!t)return new Sys.UI.Point(0,0);var n=t.marginTop,i=t.marginLeft,a=parseInt(n),s=parseInt(i);if(r.AFrameworkApplication.get_isRtl()){var l=t.marginRight;s-=parseInt(l)}return new Sys.UI.Point(isNaN(s)?0:s,isNaN(a)?0:a)},e}();(0,a.l)(s,"MoveDragAdapter",null,[i.q])},function(e,t,n){"use strict";n.d(t,{r:function(){return a}});var i=n(508),r=n(562),o=n(208),a=function(e){function t(t){return e.call(this,3,t)||this}return(0,i.t)(t,e),t}(r.w);(0,o.l)(a,"MoveAnimationEvent",r.w,[])},function(e,t,n){"use strict";n.d(t,{v:function(){return g}});var i=n(508),r=n(208),o=n(841),a=n(349),s=n(751),l=n(254),u=n(574),c=n(851),p=n(425),d="message",h="LearnMoreLinkId",g=function(e){function t(t,n,i,o,g){void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===o&&(o=null),void 0===g&&(g=null);var m=e.call(this)||this;m._downloadLink$4=null,m._learnMoreLink=null,m._downloadBehavior=null,m._printPreviewPostForm=null,m._formSubmitClickHandler=null,m._formSubmitKeyHandler=null,m._downloadBehavior=o||new a.r(t,!0),m._downloadBehavior.attachDialog(m),n?i?(m.set_buttonsOption(4),m.setButtonText(1,m.get_buttonText()),m.setButtonText(2,CommonUIStrings.l_DialogClose)):(m.set_buttonsOption(6),m.setButtonText(0,CommonUIStrings.l_DialogClose)):m.set_buttonsOption(5);var _=document.createElement("span");m.get_cssClassName()&&(_.className=m.get_cssClassName());var f=document.createElement("a");if(f.innerText=m.get_linkString(),f.href=t,f.target="_blank",f.id=m.get_linkId(),f.className=s.AFrame.allowBrowserClickClassname,!p.y.get_isElectron()&&g&&g.get_count()>0){var y=c.n.getParametersFromUrl(t,g),v=c.n.removeParameters(t,g);f.href="#",f.target="_self",m._printPreviewPostForm=document.createElement("form"),m._printPreviewPostForm.id="printPreviewPostForm1",m._printPreviewPostForm.method="post",m._printPreviewPostForm.target="_blank",m._printPreviewPostForm.action=v;for(var S=y.getEnumerator();S.$$mn();){var C=S.$$cu(),b=document.createElement("input");b.type="hidden",b.name=C.get_key(),b.value=C.get_value(),m._printPreviewPostForm.appendChild(b)}}else m._printPreviewPostForm=null;if(i)(E=document.createElement("span")).innerText=m.get_messageString().replace("{0}",""),_.appendChild(E);else if(m.get_messageAndLinkOnOneLine()){var A=document.createElement("span");A.id=m.myId(d);var T=document.createElement("span"),w=document.createElement("span"),I=m.get_messageString().split("{0}");T.innerText=I[0],w.innerText=I[1],A.appendChild(T),A.appendChild(f),A.appendChild(w),_.appendChild(A)}else{var E;(E=document.createElement("span")).innerText=m.get_messageString(),_.appendChild(E),_.appendChild(document.createElement("br")),_.appendChild(document.createElement("br")),_.appendChild(f)}m._printPreviewPostForm&&_.appendChild(m._printPreviewPostForm),m.messageBoxImpl(CommonUIStrings.l_DefaultDialogTitle,null,m.get_iconString(),null,r.i(m,m.dialogHandler,"dialogHandler"),_),m.setDescribedByForDialog(m.myId(d));var k=m.get_learnMoreLinkUrl(),D=m.get_learnMoreLinkText();if(k&&D){var M=document.createElement("div");M.className="WACDialogLearnMoreLinkContainer",m._learnMoreLink=document.createElement("a"),m._learnMoreLink.innerText=D,m._learnMoreLink.href=k,m._learnMoreLink.target="_blank",m._learnMoreLink.id=m.myId(h),m._learnMoreLink.className=s.AFrame.allowBrowserClickClassname,M.appendChild(m._learnMoreLink),n?m._divMessageBox.insertBefore(M,m._divMessageBox.lastChild):m._divMessageBox.appendChild(M),m.setDescribedByForDialog(String.format("{0} {1}",m.myId(d),m.myId(h)))}return m._downloadLink$4=f,i?m.setFocusOnElement(m._btnAction):m.setFocusOnElement(m._downloadLink$4),m.logDialogDisplayed(),l.AFrameworkApplication.get_activeFrame().get_theMouseInputManager().registerHandler(u.d.click,m._downloadLink$4,r.i(m,m.downloadLinkClicked,"downloadLinkClicked"),null),m._learnMoreLink&&l.AFrameworkApplication.get_activeFrame().get_theMouseInputManager().registerHandler(u.d.click,m._learnMoreLink,r.i(m,m.learnMoreLinkClicked,"learnMoreLinkClicked"),null),m._disposeOnHide=!1,m}return(0,i.t)(t,e),t.prototype.get_iconString=function(){return null},t.prototype.get_learnMoreLinkUrl=function(){return null},t.prototype.get_learnMoreLinkText=function(){return null},t.prototype.get_messageAndLinkOnOneLine=function(){return!1},t.prototype.get_buttonText=function(){return CommonUIStrings.l_Open},t.prototype.get_cssClassName=function(){return null},t.prototype.attachDialogEvents=function(){this._printPreviewPostForm&&(this._formSubmitClickHandler||(this._formSubmitClickHandler=r.i(this,this.onActionButtonClicked,"onActionButtonClicked"),this._clickManager.registerHandler(u.d.click,this._btnAction,this._formSubmitClickHandler)),this._formSubmitKeyHandler||(this._formSubmitKeyHandler=r.i(this,this.onActionButtonKeyUp,"onActionButtonKeyUp"),this._keyInputManager.registerHandler(u.d.keyUp,this._btnAction,this._formSubmitKeyHandler))),e.prototype.attachDialogEvents.call(this)},t.prototype.onActionButtonClicked=function(e){return this.executeDismissActionButtonFromArgs(e),!0},t.prototype.onActionButtonKeyUp=function(e){return this.keyHandlerWithAction(e,r.i(this,this.executeDismissActionButtonFromArgs,"executeDismissActionButtonFromArgs"))},t.prototype.executeDismissActionButtonFromArgs=function(e){this._printPreviewPostForm&&this._printPreviewPostForm.submit(),this.executeDismissButton(e.get_sourceElement())},t.prototype.logDownloadButtonClicked=function(){},t.prototype.downloadLinkClicked=function(e){return this.logDownloadLinkClicked(),this._printPreviewPostForm?this._printPreviewPostForm.submit():this._downloadBehavior.doDownload(),!0},t.prototype.learnMoreLinkClicked=function(e){return!1},t.prototype.dispose=function(){this._downloadBehavior.dispose(),this._downloadLink$4&&(l.AFrameworkApplication.get_activeFrame().get_theMouseInputManager().unregisterHandler(u.d.click,this._downloadLink$4,r.i(this,this.downloadLinkClicked,"downloadLinkClicked")),this._downloadLink$4=null),this._learnMoreLink&&(l.AFrameworkApplication.get_activeFrame().get_theMouseInputManager().unregisterHandler(u.d.click,this._learnMoreLink,r.i(this,this.learnMoreLinkClicked,"learnMoreLinkClicked")),this._learnMoreLink=null),this._clickManager&&this._formSubmitClickHandler&&(this._clickManager.unregisterHandler(u.d.click,this._btnAction,this._formSubmitClickHandler),this._formSubmitClickHandler=null),this._keyInputManager&&this._formSubmitKeyHandler&&(this._keyInputManager.unregisterHandler(u.d.keyUp,this._btnAction,this._formSubmitKeyHandler),this._formSubmitKeyHandler=null),e.prototype.dispose.call(this)},t.prototype.dialogHandler=function(e,t){1===e&&(this.logDownloadButtonClicked(),this._printPreviewPostForm||this._downloadBehavior.doDownload()),this.dispose()},t}(o.StandardDialog);(0,r.l)(g,"ADialogWithLinkToResource",o.StandardDialog,[])},function(e,t,n){"use strict";n.d(t,{h:function(){return h}});var i=n(208),r=n(837),o=n(665),a=n(980),s=n(645),l=n(751),u=n(254),c=n(657),p=n(66),d=n(749),h=function(){function e(e,t,n,i,r){this._getFirstPage=null,this._getLastPage=null,this._searchActive=null,this._appBase=null,this._appBaseClientHeight=0,this._isAppBaseHeightDirty=!0,this._theDisplayManager=null,this._theSelectionManager=null,this._theSearchManager=null,this._thePrintManager=null,this._theCommentManager=null,this._theFocusManager=null,this._scrollControl=null,this._navigationControl=null,this._zoomControl=null,this._lazyZoomControl=null,this._lazyNavigationControl=null,this._lazyDisplayManagerFactory=null,this._lazyScrollControl=null,this._heightAboveAppBase=0,this._heightBelowAppBase=0,this._initialized=!1,this._theFocusManager=e,this._lazyDisplayManagerFactory=t,this._lazyZoomControl=n,this._lazyNavigationControl=i,this._lazyScrollControl=r}return e.prototype.get_appBaseDom=function(){return this._appBase},e.prototype.get_heightAboveAppBase=function(){return this._heightAboveAppBase},e.prototype.get_theSearchManager=function(){return this._theSearchManager},e.prototype.get_theDisplayManager=function(){return this._theDisplayManager},e.prototype.get_theSelectionManager=function(){return this._theSelectionManager},e.prototype.get_theZoomControl=function(){return this._zoomControl||(this._zoomControl=this._lazyZoomControl.get_value())},e.prototype.get_theNavigationControl=function(){return this._navigationControl||(this._navigationControl=this._lazyNavigationControl.get_value())},e.prototype.get_theScrollControl=function(){return this._scrollControl||(this._scrollControl=this._lazyScrollControl.get_value())},e.prototype.get_initialized=function(){return this._initialized},e.prototype.init=function(e){n(941).App.get_activeAppFrame().add_onResize(i.i(this,this.resizeAppBase,"resizeAppBase")),this._appBase=document.createElement("div"),this._appBase.id="WACAppBase";var t="WACAppBase";u.AFrameworkApplication.get_protectFile()&&(t+=" Protected"),this._appBase.className=t,e.appendChild(this._appBase),this._thePrintManager=o.i.getPrintManagerInstance(),this.get_theScrollControl().init();var r=c.FocusManager.instance().getScope(l.AFrame.documentFocusID);r.bindAction(d.KeyInputManager.hashKey(p.v.vK_F10,4),s.di),r.bindAction(d.KeyInputManager.hashKey(p.v.vK_ContextMenu,0),s.di),this.get_theZoomControl().initializeActor(),this.get_theNavigationControl().init(),a.s(),n(941).App.get_instance().get_isAccessiblePdfMode()?(this._theDisplayManager=this._lazyDisplayManagerFactory.get_value().create(1,this._appBase),n(941).App.hideFirstPageImage()):(this._appBase.appendChild(this.get_theScrollControl().get_container()),this._theDisplayManager=this._lazyDisplayManagerFactory.get_value().create(0,this.get_theScrollControl().get_scroller())),n(941).App.get_activeAppFrame().get_ribbonPanel()&&(this._heightAboveAppBase=n(941).App.get_activeAppFrame().get_ribbonPanel().clientHeight),n(941).App.get_activeAppFrame().get_statusBarUser()&&(this._heightBelowAppBase=l.AFrame.statusBarHeight),this._initialized=!0},e.prototype.setCommentManagerDisposable=function(e){this._theCommentManager=e},e.prototype.setSelectionManagerDisposable=function(e,t,n){this._theSelectionManager=e,this._getFirstPage=t,this._getLastPage=n},e.prototype.setSearchManagerDisposable=function(e,t){this._theSearchManager=e,this._searchActive=t},e.prototype.getCurrentPage=function(){return this._theDisplayManager.get_currentPage()},e.prototype.getHeight=function(){return this._isAppBaseHeightDirty&&(this._appBaseClientHeight=this._appBase.clientHeight,this._isAppBaseHeightDirty=!1),this._appBaseClientHeight},e.prototype.getFirstCachedPage=function(){return this._theDisplayManager?this._theDisplayManager.get_startPage():0},e.prototype.getFirstSelectedPage=function(){return this._theDisplayManager&&this._getFirstPage?this._getFirstPage():0},e.prototype.getLastCachedPage=function(){return this._theDisplayManager?this._theDisplayManager.get_endPage():0},e.prototype.getLastSelectedPage=function(){return this._theDisplayManager&&this._getLastPage?this._getLastPage():0},e.prototype.pageCacheChanged=function(e,t){u.AFrameworkApplication.get_theActionManager().processActionWithData(s.AG,2,[e,t])},e.prototype.searchActive=function(){return!!this._searchActive&&this._searchActive()},e.prototype.dispose=function(){n(941).App.get_activeAppFrame().remove_onResize(i.i(this,this.resizeAppBase,"resizeAppBase")),this._theSearchManager&&(this._theSearchManager.dispose(),this._theSearchManager=null),this._theCommentManager&&(this._theCommentManager.dispose(),this._theCommentManager=null),this._navigationControl&&(this._navigationControl.dispose(),this._navigationControl=null),this._theDisplayManager&&(this._theDisplayManager.dispose(),this._theDisplayManager=null),this._thePrintManager&&(this._thePrintManager.dispose(),this._thePrintManager=null),this._zoomControl&&(this._zoomControl.dispose(),this._zoomControl=null),this._theSelectionManager&&(this._theSelectionManager.dispose(),this._theSelectionManager=null),this._scrollControl&&(this._scrollControl.dispose(),this._scrollControl=null),this._appBase=null,this._getFirstPage=null,this._getLastPage=null,this._searchActive=null},e.prototype.onResize=function(){this.resizeAppBase()},e.prototype.resizeAppBase=function(){var e=this._heightAboveAppBase,t=n(941).App.get_activeAppFrame().get_businessBar();t&&t.get_visible()&&(e+=t.get_htmlElement().offsetHeight),this._appBase?(this._appBase.style.width=n(941).App.get_activeAppFrame().getDOMElement().clientWidth+"px",this._appBase.style.top=e+"px",this._appBase.style.bottom=this._heightBelowAppBase+"px"):r.x(4331590,301,!1,"We didn't expect the _appBase to be null");var i=document.getElementById("FirstPageContainer");i&&(i.style.top=e+"px"),this._isAppBaseHeightDirty=!0},e}();(0,i.l)(h,"Workspace",null,[Sys.IDisposable])},function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var i=(0,n(208).y)("IFocusRegionListing")},,function(e){e.exports={}},,function(e,t,n){"use strict";var i,r=n(965),o=n(208),a=(0,o.y)("IReactBusinessBar"),s=n(255),l=(0,o.y)("IBusinessBarDom"),u=n(597),c=n(222),p=n(333),d=n(876),h=n(296),g=function(e){e.get_element().style.top=""},m=n(751),_=n(254),f=n(197),y=n(574),v=n(657),S=n(550),C=n(573),b=n(425),A="WACBusinessBar",T=function(){function e(e,t,n){this._businessBar=null,this._visible=!1,this._element=null,this._target=null,this._targetOffset=0,this._currentHeight=0,this._originalTargetTop=null,this._contextMenuHandler=null,this._isRegionComposerEnabled=!1,this._target=e,this._targetOffset=t,this._businessBar=n;var i=e.ownerDocument;this._element=i.createElement("div"),this._element.className=A,this._isRegionComposerEnabled=!!_.AFrameworkApplication.get_activeFrame()&&_.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRegionComposerEnabled(),this._isRegionComposerEnabled&&!this._businessBar.get_displayOverTarget()&&Sys.UI.DomElement.addCssClass(this._element,"regionComposer"),this._element.id=A,b.y.get_isFirefox()&&Sys.UI.DomElement.addCssClass(this._element,"FireFox")}return e.prototype.get_htmlElement=function(){return this._element},e.prototype.get_visible=function(){return this._visible},e.prototype.set_visible=function(e){return this._visible===e?e:(this._visible=e,e?this.attachToTarget():this.detachFromTarget(),e)},e.prototype.dispose=function(){this.get_visible()&&this.detachFromTarget(),h.s.clearElementHtml(this._element),this._element=null,this._target=null},e.prototype.showEntry=function(e,t){var n=e.get_htmlElement()||e.createElement();t===this._element.childNodes.length?this._element.appendChild(n):this._element.insertBefore(n,this._element.childNodes[t]),e.resizeToFit(),this._currentHeight+=e.get_htmlElement().clientHeight,function(e,t,n,i){d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var r=new p.g(e);r.animateOpacity(0,1),d.WacAirSpace.animate(r,null,null);var o=new c.r(e);o.animateY(e.clientTop-30,e.clientTop),d.WacAirSpace.animate(o,null,i);for(var a=n+1;a<t.length;a++){var s=t[a];d.WacAirSpace.setAnimationClass(s,"Shared_BasicClass");var l=new c.r(s);l.animateY(s.clientTop-e.clientHeight,s.clientTop),d.WacAirSpace.animate(l,null,null)}}(n,this._element.childNodes,t,o.i(this,this.onAfterShowEntry,"onAfterShowEntry")),e.showEntryForScreenReader(),this.set_visible(!0)},e.prototype.hideEntry=function(e){var t=e.get_htmlElement();h.s.isInDocument(t)&&(this._currentHeight-=e.get_htmlElement().clientHeight,function(e,t,n,i){d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var r=new u.y(e);r.animateOpacity(1,0),d.WacAirSpace.animate(r,n,i);for(var o=!1,a=0;a<t.length;a++){if(o){var s=t[a];d.WacAirSpace.setAnimationClass(s,"Shared_BasicClass");var l=new c.r(s);l.animateY(s.clientTop,-e.clientHeight),d.WacAirSpace.animate(l,null,g)}o||t[a]!==e||(o=!0)}}(t,t.parentNode.children,null,o.i(this,this.onAfterHideEntry,"onAfterHideEntry")))},e.prototype.onAfterShowEntry=function(e){e.get_element().style.top="",_.AFrameworkApplication.get_activeFrame().notifyResize()},e.prototype.onAfterHideEntry=function(e){e.get_element().parentNode.removeChild(e.get_element()),this._element.hasChildNodes()||this.set_visible(!1),_.AFrameworkApplication.get_activeFrame().notifyResize()},e.prototype.attachToTarget=function(){var e=this;""===this._target.style.top.trim()&&(this._target.style.top=this._target.offsetTop+"px"),this._element.style.left=this._target.style.left,this._element.style.top=this._target.style.top,this._element.style.height="auto",this._element.style.visibility="visible";var t=Sys.UI.DomElement.getBounds(this._element);if(this._originalTargetTop=this._target.style.top,this._currentHeight=t.height,this.updateTarget(),_.AFrameworkApplication.get_activeFrame().add_onResize(o.i(this,this.onResize,"onResize")),S.n.addHandler(this._element,y.d.selectStart,S.n.cancelEventHandler),this._contextMenuHandler=o.i(this,this.contextMenuHandler,"contextMenuHandler"),_.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().registerHandler(this._element,this._contextMenuHandler,null),v.FocusManager.usable()){var n=v.FocusManager.instance(),i=n.getScope(C.t.businessBarFocusID);i.parent=m.AFrame.mainAppFocusId;var r=new f.DOMFocusListing((function(){return e._element}));r.addValidTag(1),r.addValidTag(2),r.addValidTag(8),n.buildRegionWithDelegate((function(){return e._element}),i,r);var a=n.getRegion(C.t.businessBarFocusID);a.rememberFocusStealers(),a.looped=!0,a.contained=!0;var s=_.AFrameworkApplication.get_activeFrame().get_theF6Manager();i.addDispose((function(){s.deactivateFocus(C.t.businessBarFocusID)})),s.addF6KeyBindings(C.t.businessBarFocusID),r.get_firstElement()&&s.activateFocus(C.t.businessBarFocusID)}},e.prototype.detachFromTarget=function(){if(this.shouldUpdateTargetTop()&&(this._target.style.top=this._originalTargetTop),this._element.style.visibility="hidden",_.AFrameworkApplication.get_activeFrame()){if(v.FocusManager.usable())v.FocusManager.instance().removeScope(C.t.businessBarFocusID);this._contextMenuHandler&&(_.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().unregisterHandler(this._element,this._contextMenuHandler),this._contextMenuHandler=null)}S.n.removeHandler(this._element,y.d.selectStart,S.n.cancelEventHandler)},e.prototype.updateTarget=function(){this.shouldUpdateTargetTop()&&this.get_visible()&&function(e,t,n,i){var r=h.s.parseCssSize(e.style.top);d.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var o=new c.r(e);o.animateY(r,t),d.WacAirSpace.animate(o,n,i)}(this._target,this._currentHeight+this._targetOffset,null,null)},e.prototype.shouldUpdateTargetTop=function(){return!this._isRegionComposerEnabled&&!this._businessBar.get_displayOverTarget()},e.prototype.onResize=function(){for(var e,t=this._businessBar.get_entries().length,n=Sys.UI.DomElement.getBounds(this._element).height,i=0;i<t;++i)(e=this._businessBar.get_entries()[i]).get_htmlElement()&&e.resizeToFit();this._currentHeight=Sys.UI.DomElement.getBounds(this._element).height,n!==this._currentHeight&&this.updateTarget()},e.prototype.contextMenuHandler=function(e){return!0},e}();(0,o.l)(T,"BusinessBarDom",null,[l,Sys.IDisposable]),function(e){e[e.none=0]="none",e[e.corruptPage=1]="corruptPage",e[e.currentPageStatus=2]="currentPageStatus",e[e.documentMarkedAsFinal=3]="documentMarkedAsFinal",e[e.documentSigned=4]="documentSigned",e[e.fileAccess=5]="fileAccess",e[e.kickoutWithDataLoss=6]="kickoutWithDataLoss",e[e.lostSession=7]="lostSession",e[e.malformedHyperlinkUris=8]="malformedHyperlinkUris",e[e.odt=9]="odt",e[e.readonlyRecommended=10]="readonlyRecommended",e[e.saveReplaySuccess=11]="saveReplaySuccess",e[e.saveReplayFailed=12]="saveReplayFailed",e[e.unsupportedObjects=13]="unsupportedObjects",e[e.word11Compat=14]="word11Compat",e[e.unsupportedBrowser=15]="unsupportedBrowser",e[e.applicationNotification=16]="applicationNotification",e[e.skypeDocChatFailed=17]="skypeDocChatFailed",e[e.showDialogInNewWindowInfo=18]="showDialogInNewWindowInfo",e[e.sessionExpired=19]="sessionExpired",e[e.irmPolicyDescription=20]="irmPolicyDescription",e[e.policyWarningMessage=21]="policyWarningMessage",e[e.thirdPartyAddinDisabled=22]="thirdPartyAddinDisabled",e[e.gdprPrivacyNotice=23]="gdprPrivacyNotice",e[e.datacenterDecommissionWarning=24]="datacenterDecommissionWarning",e[e.graphMergePrompt=25]="graphMergePrompt",e[e.readOnlyDocument=26]="readOnlyDocument",e[e.dictationSilence=27]="dictationSilence",e[e.autoSensitivityLabel=28]="autoSensitivityLabel",e[e.recommendedSensitivityLabel=29]="recommendedSensitivityLabel",e[e.dictationDebugInfo=30]="dictationDebugInfo",e[e.testEntry1=31]="testEntry1",e[e.testEntry2=32]="testEntry2",e[e.testEntry3=33]="testEntry3",e[e.testEntry4=34]="testEntry4",e[e.testEntry5=35]="testEntry5",e[e.testEntry6=36]="testEntry6",e[e.testEntry7=37]="testEntry7"}(i||(i={})),(0,o.h)("BusinessBarId",i);var w=n(101);n.d(t,{f:function(){return I}});var I=function(){function e(e,t,n,i){void 0===t&&(t=0),void 0===n&&(n=null),void 0===i&&(i=null),this._displayOverTarget=!1,this._isReactBusinessBarStoreInitialized=!1,this._priorityMap=null,this._businessBarDom=null,this._entries=[],this._businessBarDom=i||new T(e,t,this),this.initializePriorityMap(n)}return e.prototype.initializePriorityMap=function(e){if(e){this._priorityMap={};for(var t=e.get_ranking(),n=0;n<t.length;n++)this._priorityMap[i[t[n]]]=n}},e.prototype.dispose=function(){this._businessBarDom.dispose(),w.q(this._entries),this._entries=null},e.prototype.get_htmlElement=function(){return this._businessBarDom.get_htmlElement()},e.prototype.get_visible=function(){return this._businessBarDom.get_visible()},e.prototype.get_displayOverTarget=function(){return this._displayOverTarget},e.prototype.set_displayOverTarget=function(e){return this._displayOverTarget=e,e},e.prototype.get_isReactBusinessBarStoreInitialized=function(){return this._isReactBusinessBarStoreInitialized},e.prototype.set_isReactBusinessBarStoreInitialized=function(e){return this._isReactBusinessBarStoreInitialized=e,e},e.prototype.get_entries=function(){return this._entries},e.prototype.set_entries=function(e){return this._entries=e,e},e.prototype.isEntryExistent=function(e){for(var t=0;t<this._entries.length;t++)if(this._entries[t].get_id()===e)return!0;return!1},e.prototype.addEntry=function(t,n,r){void 0===n&&(n=!1),void 0===r&&(r=null),t.set_businessBar(this);var o=this.getIndexForNewEntry(t.get_id());n&&!this._priorityMap&&(o=0),o<e.maxBarsVisible&&(this._businessBarDom.showEntry(t,o),this._entries.length>=e.maxBarsVisible&&this._businessBarDom.hideEntry(this._entries[e.maxBarsVisible-1]),this._businessBarDom.updateTarget()),Array.insert(this._entries,o,t),s.ULS.sendTraceTag(38111390,207,50,"Add BusinessBar Entry. Id: {0}, ContainerID: {1}.",i[t.get_id()],void 0===t.get_containerID()||null===t.get_containerID()?"":t.get_containerID()),t.get_errorCode()&&_.AFrameworkApplication.reportError(t.get_errorCode(),r)},e.prototype.removeEntry=function(t){var n=Array.indexOf(this._entries,t);-1!==n&&n<e.maxBarsVisible&&(this._entries.length>e.maxBarsVisible&&this._businessBarDom.showEntry(this._entries[e.maxBarsVisible],e.maxBarsVisible),this._businessBarDom.hideEntry(t),this._businessBarDom.updateTarget()),Array.remove(this._entries,t),t.set_businessBar(null),t.dispose()},e.prototype.getIndexForNewEntry=function(e){if(!this._priorityMap)return this._entries.length;if(!e)return this._entries.length;var t=this._priorityMap[i[e]];if(null==t)return this._entries.length;for(var n=0;n<this._entries.length;n++)if(t<this._priorityMap[i[this._entries[n].get_id()]])return n;return this._entries.length},e.maxBarsVisible=2,e}();(0,o.l)(I,"BusinessBar",null,[r.c,Sys.IDisposable,a])},function(e,t,n){"use strict";var i=n(508),r=n(801),o=n(951),a=n(134),s=n(920),l=n(208),u=function(e){function t(t){var n=e.call(this,t)||this;return n.elmTBody=null,n.cellATags=null,n.cells=null,n.innerDivs=null,n.outerDivs=null,n}return(0,i.t)(t,e),t}(s.d);(0,l.l)(u,"InsertTableComponentDom",s.d,[]);var c=n(946);n.d(t,{o:function(){return p}});var p=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.insertTableDom=null,r.addDisplayMode("Menu"),r}return(0,i.t)(t,e),t.prototype.get_insertTableDom=function(){return this.insertTableDom},t.prototype.createComponentDomForDisplayMode=function(e){return this.insertTableDom=this.createInsertTableDom(e),this.get_insertTableDom()},t.prototype.createInsertTableDom=function(e){var n=c.n.createElement("table");n.setAttribute(a.t.ariaRoleAttribute,a.t.ariaGridRole),n.setAttribute("mscui:controltype",this.get_controlType());var i,r,o,s,l,p=c.n.createElement("tbody");p.className="cui-it",n.setAttribute("cellspacing","0"),n.setAttribute("cellpadding","0"),p.setAttribute("cellspacing","0"),p.setAttribute("cellpadding","0");for(var d=new Array(t.numCells),h=new Array(t.numCells),g=new Array(t.numCells),m=new Array(t.numCells),_=0,f=0;f<t.numRows;f++){(i=c.n.createElement("tr")).setAttribute(a.t.ariaRoleAttribute,a.t.ariaRowRole),p.appendChild(i),f||c.n.ensureCSSClassOnElement(i,"cui-it-firstrow"),f>=t.numRowsInTouch&&c.n.ensureCSSClassOnElement(i,"cui-hideInTouch");for(var y=0;y<t.numCols;y++)r=c.n.createElement("td"),y||c.n.ensureCSSClassOnElement(r,"cui-it-firstcol"),y>=t.numColsInTouch&&f<=t.numRowsInTouch&&c.n.ensureCSSClassOnElement(r,"cui-hideInTouch"),r.setAttribute(a.t.ariaRoleAttribute,a.t.ariaPresentationRole),i.appendChild(r),(o=c.n.createElement("a")).setAttribute(a.t.ariaRoleAttribute,a.t.ariaGridCellRole),c.n.addToTabLoop(o),(s=c.n.createElement("div")).className="cui-it-inactiveCell",(l=c.n.createElement("div")).id=this.get_id()+"-"+_,l.className="cui-it-inactiveCellOuter",r.appendChild(l),l.appendChild(s),s.appendChild(o),d[_]=r,m[_]=o,h[_]=s,g[_]=l,_++}n.appendChild(p);var v=new u(e);return v.elmControl=n,v.elmTBody=p,v.cells=d,v.cellATags=m,v.innerDivs=h,v.outerDivs=g,this.insertTableDom=v,v},t.prototype.get_controlType=function(){return o.Control.insertTableControlType},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n)},t.numCols=10,t.numRows=8,t.numCells=80,t.maxIdx=79,t.numColsInTouch=8,t.numRowsInTouch=6,t}(o.Control);(0,l.l)(p,"InsertTable",o.Control,[r.y])},function(e,t,n){var i=n(950);e.exports=!i((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},,function(e,t,n){"use strict";n.d(t,{a:function(){return i}});var i=(0,n(208).y)("IApplicationFeatureHelper")},,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IContainer"),o=n(600),a=n(978),s=n(936),l=(0,i.y)("IContainerRegistrationInternal"),u=function(e){var t="IContainerRegistration$1$"+e.getName();return(0,i.g)(t)},c=function(){function e(t,n,r){var a;this._container=null,this._registrationCache=null,this._instance=null,this._factory=null,this._factoryBeingCalled=!1,this.isSingleton=!1,this.get_instance=this.get_instance$p,i.m(this,e.$$(t)),this._futures=[],this._container=n,this._registrationCache=r,this._factory=null,this._registrationCache.storeRegistration(i.f(this,"Common.Utils.ContainerRegistration$1").TService,this),this._registrationCache.tryLookupFuture(i.f(this,"Common.Utils.ContainerRegistration$1").TService,(0,o.m)((function(){return a}),(function(e){return a=e})))&&this.linkFuture(a)}return e.prototype.get_isSingleton=function(){return this.isSingleton},e.prototype.get_instance$p=function(){return this._instance},e.prototype.as=function(e){return this.asWithOptionalTypeCheck(e,!1)},e.prototype.asExtern=function(e){return this.asWithOptionalTypeCheck(e,!1)},e.prototype.linkFuture=function(e){Array.add(this._futures,e)},e.prototype.singleInstance=function(){return this.isSingleton=!0,this},e.prototype.usingFactory=function(e){return this._factory=e,this},e.prototype.usingTypeResolver=function(e){return this.usingResolveCallback(i.i(e,e.createInstance,"createInstance"))},e.prototype.usingResolveCallback=function(e){var t=this;return this.usingFactory((function(){return e(t._container,!1)}))},e.prototype.internalCreate=function(){if(this.get_isSingleton()){if(!this._instance){this._instance=this.createInstance();for(var e=0;e<this._futures.length;e++)this._futures[e].setInstance(this._instance)}return this._instance}return this.createInstance()},e.prototype.createInstance=function(){if(this._futures.length>0&&!this.get_isSingleton())throw s.b("Futures can only be used for singleton types");var e;if(this._factory){if(this._factoryBeingCalled){var t=String.format("Type '{0}' contains a circular reference in the IoC container.",i.f(this,"Common.Utils.ContainerRegistration$1").TService.getName());throw s.b(t)}this._factoryBeingCalled=!0;try{e=this._factory()}finally{this._factoryBeingCalled=!1}}else e=new(0,i.f(this,"Common.Utils.ContainerRegistration$1").TService);return e},e.prototype.asWithOptionalTypeCheck=function(t,n){var r;return n&&e.$$(i.f(this,"Common.Utils.ContainerRegistration$1").TService).validateImplementsOrExtends(t),this._registrationCache.storeRegistration(t,this),this._registrationCache.tryLookupFuture(t,(0,o.m)((function(){return r}),(function(e){return r=e})))&&this.linkFuture(r),this},e.validateImplementsOrExtends=function(e){var t,n,r,o,a,l=i.f(this,"Common.Utils.ContainerRegistration$1").TService,u=e;if(n=l,r=(t=u).getName()===n.getName(),o=n.implementsInterface(t),a=n.inheritsFrom(t),!(r||o||a)){var c=String.format("Type '{0}' does not implement interface or derive from type '{1}'",l.getName(),u.getName());throw s.s(c,"T")}},e.$$=function(t){var n="ContainerRegistration$1$"+t.getName(),r=i.x(n);return r||i.u(n,"Common.Utils.ContainerRegistration$1",e,[{TService:t}],null,[l,u(t)])},e}(),p=function(){function e(e){void 0===e&&(e=null),this._cache={},this._futureCache={}}return e.prototype.storeFuture=function(e,t){this._futureCache[e.getName()]=t},e.prototype.storeRegistration=function(e,t){var n=e.getName();this._cache[n]=t},e.prototype.tryLookupFuture=function(e,t){var n=e.getName();return n in this._futureCache?(t.val=this._futureCache[n],!0):(t.val=null,!1)},e.prototype.tryLookupRegistration=function(e,t){var n=e.getName();return n in this._cache?(t.val=this._cache[n],!0):(t.val=null,!1)},e}();(0,i.l)(p,"ContainerRegistrationCache",null,[]);var d=(0,i.y)("IFutureRegistration"),h=function(e){var t="IFuture$1$"+e.getName();return(0,i.g)(t)},g=n(795),m=n(242),_=n(502),f=function(){function e(t){this._tcs=null,i.m(this,e.$$(t))}return e.prototype.get_instance=function(){return this._tcs&&this._tcs.get_task().get_isCompleted()?this._tcs.get_task().get_result():null},e.prototype.set_instance=function(e){return this.get_taskCompletionSource().setResult(e),e},e.prototype.get_taskCompletionSource=function(){return this._tcs||(this._tcs=new m.z(i.f(this,"Common.Utils.Future$1").T))},e.prototype.execute=function(e){this.get_taskCompletionSource().get_task().CWOo((function(t,n){e(t.get_result())}),g.r.get_none(),_.d.executeSynchronously)},e.create=function(){return new e(i.f(this,"Common.Utils.Future$1").T)},e.$$=function(t){var n="Future$1$"+t.getName(),r=i.x(n);return r||i.u(n,"Common.Utils.Future$1",e,[{T:t}],null,[h(t)])},e}(),y=function(){function e(t,n){var r;if(this.future=null,i.m(this,e.$$(t)),this.future=f.$$(i.f(this,"Common.Utils.FutureRegistration$1").T).create(),n.tryLookupRegistration(i.f(this,"Common.Utils.FutureRegistration$1").T,(0,o.m)((function(){return r}),(function(e){return r=e})))){if(!r.get_isSingleton())throw s.b("Futures can only be used for singleton types");r.get_instance()?this.setInstance(r.get_instance()):r.linkFuture(this)}}return e.prototype.get_future=function(){return this.future},e.prototype.setInstance=function(e){this.get_future().set_instance(e)},e.$$=function(t){var n="FutureRegistration$1$"+t.getName(),r=i.x(n);return r||i.u(n,"Common.Utils.FutureRegistration$1",e,[{T:t}],null,[d])},e}();n.d(t,{w:function(){return v}});var v=function(){function e(){this._registractionCache=null,this._registractionCache=new p}return e.prototype.register=function(e){return new c(e,this,this._registractionCache)},e.prototype.registerUsingResolveCallback=function(e,t){return this.register(e).usingResolveCallback(t)},e.prototype.registerUsingTypeResolver=function(e,t){return this.register(e).usingTypeResolver(t)},e.prototype.resolve=function(e){var t;if(!this._registractionCache.tryLookupRegistration(e,(0,o.m)((function(){return t}),(function(e){return t=e})))){var n=String.format("Type '{0}' is not registered in the IoC container. Make sure you have registered the type.",e.getName());throw s.s(n,"T")}return t.internalCreate()},e.prototype.resolveFuture=function(e){var t;return this._registractionCache.tryLookupFuture(e,(0,o.m)((function(){return t}),(function(e){return t=e})))||(t=new y(e,this._registractionCache),this._registractionCache.storeFuture(e,t)),t.get_future()},e.prototype.resolveLazy=function(e){var t=this;return new a.q(e,(function(){return t.resolve(e)}))},e.prototype.tryResolve=function(e){var t;return this._registractionCache.tryLookupRegistration(e,(0,o.m)((function(){return t}),(function(e){return t=e})))?t.internalCreate():null},e.prototype.testCouldResolve=function(e){return this.testCouldResolveType(e)},e.prototype.testCouldResolveType=function(e){var t;return this._registractionCache.tryLookupRegistration(e,(0,o.m)((function(){return t}),(function(e){return t=e})))},e.getAnInstance=function(){return new a.q(r,(function(){return new e}))},e.get_instance=function(){return e._instance.get_value()},e._instance=e.getAnInstance(),e}();(0,i.l)(v,"Container",null,[r])},function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var i,r=n(208);!function(e){e[e.unknown=0]="unknown",e[e.upperRibbon=1]="upperRibbon",e[e.ribbon=2]="ribbon",e[e.QAT=3]="QAT",e[e.jewel=4]="jewel",e[e.navigationPane=5]="navigationPane",e[e.keyboardShortcut=6]="keyboardShortcut",e[e.statusBar=7]="statusBar",e[e.dialog=8]="dialog",e[e.floatie=9]="floatie",e[e.notificationBar=10]="notificationBar",e[e.standaloneCuiRoot=11]="standaloneCuiRoot",e[e.taskPane=12]="taskPane",e[e.heroDock=13]="heroDock",e[e.singleLineRibbon=14]="singleLineRibbon",e[e.multilineRibbon=15]="multilineRibbon",e[e.overflow=16]="overflow",e[e.tellMe=17]="tellMe",e[e.farPeripheralControls=18]="farPeripheralControls",e[e.contextMenu=19]="contextMenu",e[e.dialogMenu=20]="dialogMenu",e[e.header=21]="header",e[e.fileMenu=22]="fileMenu",e[e.toolbar=26]="toolbar",e[e.canvas=30]="canvas"}(i||(i={})),(0,r.h)("UILocation",i)},,function(e,t,n){"use strict";n.d(t,{x:function(){return i},l:function(){return r},e:function(){return o},k:function(){return a},p:function(){return s},j:function(){return l},d:function(){return u},f:function(){return c}});var i="event_source",r="CloseButton",o="OIC",a="FileMenu",s="",l="Error",u="ReportAbuse",c="SessionExpiration"},function(e,t,n){"use strict";var i=n(508),r=n(208),o=(0,r.y)("ICuiControlManager"),a=(0,r.y)("IStandaloneRoot"),s=n(813),l=n(70),u=n(700),c=n(808),p=n(257),d=n(619),h=n(513),g=n(45);n.d(t,{w:function(){return m}});var m=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i._createdControls={},i.shouldHandleElementResize=!0,i}return(0,i.t)(t,e),t.prototype.get_createdControls=function(){return this._createdControls},t.prototype.get_rootType=function(){return 11},t.prototype.get_supportsInvisibleControls=function(){return!0},t.prototype.get_supportsDynamicDisplayMode=function(){return!0},t.prototype.dispose=function(){var t=this._createdControls;for(var n in t){({key:n,value:t[n]}).value.dispose()}this.shouldHandleElementResize=!1,e.prototype.dispose.call(this)},t.prototype.get_builder=function(){if(!e.prototype.get_builder.call(this)){var t=new p.l;e.prototype.set_builder.call(this,new d.Builder(t,null,null,null)),e.prototype.get_builder.call(this).set_root(this)}return e.prototype.get_builder.call(this)},t.prototype.set_builder=function(t){return e.prototype.set_builder.call(this,t),t},t.prototype.setBuilder=function(e){this.set_builder(e),e.set_root(this)},t.prototype.get_standaloneRootProperties=function(){return this.get_properties()},t.prototype.addControl=function(e,t){if(h.x(t))return!1;var n=d.Builder.convertXMLStringToJSON(t);return this.addControlFromDeserializedData(e,n)},t.prototype.addControlFromDeserializedData=function(e,t){if(h.x(t))return!1;if(!h.x(this._createdControls[e]))throw Error.create(String.format("Control id {0} already exists in this root.",e));var n=this.get_builder().buildControl(t,new c.n);return n&&(n.setEnabledAndForceUpdate(!0),this._createdControls[e]=n),!0},t.prototype.removeControl=function(e){var t=this._createdControls[e];if(h.x(t))throw Error.create(String.format("Control with id '{0}' not found in root.",e));for(var n=this.getDockIdsForControlId(e),i=0;i<n.length;i++)this.removeChild(n[i]);delete this._createdControls[e],t.dispose()},t.prototype.getDOMElementForControlDisplayMode=function(e,n){var i=this._createdControls[e];if(h.x(i))throw Error.create(String.format("Control with id '{0}' not found in root.",e));var r=this.getDockId(e,n),o=this.getChild(r);h.x(o)&&(o=new g.z(this,r),this.addChild(o)),h.x(o.getChild(e))&&o.addChild(i.createComponentForDisplayMode(n));var a=i.getDOMElementForDisplayMode(n,i.get_displayedComponent());return t.updateControlVisibility(i),a},t.prototype.hostControl=function(e,t,n){return this.addControl(e,t)?this.getDOMElementForControlDisplayMode(e,n):null},t.prototype.pollForControlState=function(e){var n=this._createdControls[e];h.x(n)||(n.pollForStateAndUpdate(),t.updateControlVisibility(n))},t.prototype.getDockId=function(e,t){return String.format("dock_{0}-{1}",e,t)},t.prototype.getDockIdsForControlId=function(e){for(var t=[],n=this.get_children().getEnumerator();n.moveNext();){var i=n.get_current();i.get_id().startsWith("dock_"+e)&&Array.add(t,i.get_id())}return t},t.prototype.get_trimmedIds=function(){return this.get_builder().get_options().trimmedIds},t.prototype.get_cuiControlManager=function(){return this},t.createStandaloneRoot=function(e,n){return new t(e,n)},t.updateControlVisibility=function(e){for(var t=0,n=e.get_components();t<n.length;t++){var i=n[t],r=e.get_visible()&&i===e.get_activeComponentWhenVisible();i.get_elementInternal().style.display=r?"":"none",i.set_visibleInDOM(r)}},t}(u.z);(0,r.l)(m,"StandaloneRoot",u.z,[o,a,s.s,l.l])},function(e,t,n){var i=n(975),r=n(329),o=n(869),a=function(e){return function(t,n,a){var s,l=i(t),u=r(l.length),c=o(a,u);if(e&&n!=n){for(;u>c;)if((s=l[c++])!=s)return!0}else for(;u>c;c++)if((e||c in l)&&l[c]===n)return e||c||0;return!e&&-1}};e.exports={includes:a(!0),indexOf:a(!1)}},,function(e,t,n){"use strict";n.d(t,{z:function(){return a}});var i=n(208),r=n(594),o=n(473),a=function(){function e(t,n){this._task=null,this._exception=null,i.m(this,e.$$(t)),this._result=i.c(i.f(this,"$$sc.TaskCompletionSource$1").TResult),this._task=o.Task$1.$$(i.f(this,"$$sc.TaskCompletionSource$1").TResult).CO(i.i(this,this.Execute,"Execute"),n)}return e.prototype.Execute=function(e){if(this._exception)throw this._exception;return this._result},e.prototype.get_task=function(){return this._task},e.prototype.SXs=function(e){this._exception=r.C(e),this._task.runSynchronously()},e.prototype.SX=function(e){this._exception=e,this._task.runSynchronously()},e.prototype.trySetException=function(e){return!this._task.get_isCompleted()&&(this.SX(e),!0)},e.prototype.setResult=function(e){this._result=e,this._task.runSynchronously()},e.prototype.trySetResult=function(e){return!this._task.get_isCompleted()&&(this.setResult(e),!0)},e.prototype.setCanceled=function(){this._task.setCanceled()},e.prototype.trySetCanceled=function(){return this._task.TrySetCanceled(!1)},e.$$=function(t){var n="TaskCompletionSource$1$"+t.getName(),r=i.x(n);return r||i.u(n,"$$sc.TaskCompletionSource$1",e,[{TResult:t}],null,[])},e}()},,function(e,t,n){"use strict";n.r(t);var i=n(208),r=n(572),o=n(602),a=function(){function e(t,n){this._array=null,this.$$ge=this.getEnumerator,i.m(this,e.$$(t)),this._array=n}return e.prototype.getEnumerator=function(){return new o.l(i.f(this,"$$sc.ArrayEnumerable$1").T,this._array)},e.$$=function(t){var n="ArrayEnumerable$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.ArrayEnumerable$1",e,[{T:t}],null,[r.i])},e}(),s=n(790),l=n(644),u=n(870),c=function(){function e(t){i.m(this,e.$$(t))}return e.prototype.equals=function(e,t){return e===t},e.prototype.getHashCode=function(e){if(!e)return 0;var t=e.$$hashCode;if(null!=t)return t;t=Math.random()*Number.MAX_VALUE|0;try{return Object.defineProperty(e,"$$hashCode",{value:t}),t}catch(e){return 0}},e.$$=function(t){var n="AssigningComparer$1$"+t.getName(),r=i.x(n);return r||i.u(n,"$$sc.AssigningComparer$1",e,[{T:t}],null,[u.v.$$(t)])},e}(),p=n(877),d=n(201),h=function(){function e(t){i.m(this,e.$$(t))}return e.prototype.equals=function(e,t){return e===t},e.prototype.getHashCode=function(e){return 0},e.$$=function(t){var n="ZeroComparer$1$"+t.getName(),r=i.x(n);return r||i.u(n,"$$sc.ZeroComparer$1",e,[{T:t}],null,[u.v.$$(t)])},e}(),g=function(){function e(t){i.m(this,e.$$(t))}return e.get_default=function(){return e.$$(i.f(this,"$$sc.EqualityComparer$1").T)._default||(e.$$(i.f(this,"$$sc.EqualityComparer$1").T)._default=e.$$(i.f(this,"$$sc.EqualityComparer$1").T).GetComparer())},e.GetComparer=function(){return i.f(this,"$$sc.EqualityComparer$1").T===String?d.b.get_ordinal():i.f(this,"$$sc.EqualityComparer$1").T===Number?p.g.get_default():Object.defineProperty?new c(i.f(this,"$$sc.EqualityComparer$1").T):new h(i.f(this,"$$sc.EqualityComparer$1").T)},e.$$=function(t){var n="EqualityComparer$1$"+t.getName(),r=i.x(n);return r||i.u(n,"$$sc.EqualityComparer$1",e,[{T:t}],null,[],e.$$Properties)},e.$$Properties={_default:function(){return null}},e}(),m=n(187),_=function(){function e(t,n){this._source=null,this._sourceEnumerator=null,this._createdEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t)),this._source=n}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.CastEnumerable$1").T,this._source):(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._sourceEnumerator.get_current()},e.prototype.moveNext=function(){return this._sourceEnumerator||(this._sourceEnumerator=this._source.getEnumerator()),this._sourceEnumerator.moveNext()},e.prototype.reset=function(){this._sourceEnumerator=null},e.$$=function(t){var n="CastEnumerable$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.CastEnumerable$1",e,[{T:t}],null,[r.i,m.m])},e}(),f=function(){function e(t,n,r){this._first=null,this._second=null,this._firstComplete=!1,this._enumerator=null,this._createdEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t)),this._first=n,this._second=r}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.ConcatEnumerable$1").T,this._first,this._second):(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._enumerator.$$cu()},e.prototype.moveNext=function(){return this._enumerator||(this._enumerator=this._first.$$ge()),!!this._enumerator.$$mn()||!this._firstComplete&&(this._firstComplete=!0,this._enumerator=this._second.$$ge(),this._enumerator.$$mn())},e.prototype.reset=function(){this._firstComplete=!1,this._enumerator=null},e.$$=function(t){var n="ConcatEnumerable$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.ConcatEnumerable$1",e,[{T:t}],null,[r.i,m.m])},e}(),y=function(){function e(t){this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t))}return e.prototype.getEnumerator=function(){return this},e.prototype.get_current=function(){throw Error.invalidOperation()},e.prototype.moveNext=function(){return!1},e.prototype.reset=function(){},e.$$=function(t){var n="EmptyEnumerator$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.EmptyEnumerator$1",e,[{T:t}],null,[r.i,m.m])},e}(),v=function(){function e(t,n){this._getIterator=null,this._iterator=null,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t)),this._defaultValue=i.c(i.f(this,"$$sc.Enumerable.IteratorEnumerator$1").T),this.$$pf_Current=e.T===Number||Type.isEnum(e.T)?0:e.T!==Boolean&&null,this._getIterator=n}return e.prototype.get_current=function(){return this.$$pf_Current},e.prototype.set_current=function(e){return this.$$pf_Current=e,e},e.prototype.moveNext=function(){this._iterator||(this._iterator=this._getIterator());var e=this._iterator.next();return this.set_current(e.value),!e.done},e.prototype.reset=function(){this._iterator=null,this.set_current(this._defaultValue)},e.$$=function(t){var n="IteratorEnumerator$1$"+t.getName(),r=i.x(n);return r||i.u(n,"$$sc.Enumerable.IteratorEnumerator$1",e,[{T:t}],null,[m.m])},e}(),S=function(){function e(t,n){this._getIterator=null,this.$$ge=this.getEnumerator,i.m(this,e.$$(t)),this._getIterator=n}return e.prototype.getEnumerator=function(){return new v(i.f(this,"$$sc.Enumerable.IteratorEnumerable$1").T,this._getIterator)},e.$$=function(t){var n="IteratorEnumerable$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.IteratorEnumerable$1",e,[{T:t}],null,[r.i])},e}(),C=function(){function e(t,n){this._source=null,this._sourceEnumerator=null,this._createdEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t)),this._source=n}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.OfTypeEnumerable$1").T,this._source):(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._sourceEnumerator.get_current()},e.prototype.moveNext=function(){for(this._sourceEnumerator||(this._sourceEnumerator=this._source.getEnumerator());this._sourceEnumerator.moveNext();)if(i.r(i.f(this,"$$sc.Enumerable.OfTypeEnumerable$1").T,this._sourceEnumerator.get_current()))return!0;return!1},e.prototype.reset=function(){this._sourceEnumerator=null},e.$$=function(t){var n="OfTypeEnumerable$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.OfTypeEnumerable$1",e,[{T:t}],null,[r.i,m.m])},e}(),b=function(e){var t="IOrderedEnumerable$1$"+e.getName();return(0,i.g)(t)},A=function(){function e(t,n,r,o,a,s,l){this._compare=null,this._comparisonSelector=null,this._mult=0,this._parent=null,this._source=null,this.$$ge=this.getEnumerator,i.m(this,e.$$(t,n)),this._source=r,this._comparisonSelector=o,this._parent=s,this._compare=a?function(e,t){return a.compare(e,t)}:e.$$(i.f(this,"$$sc.Enumerable.OrderByEnumerable$2").TKey,i.f(this,"$$sc.Enumerable.OrderByEnumerable$2").TValue).CompareValues.bind(e.$$(i.f(this,"$$sc.Enumerable.OrderByEnumerable$2").TKey,i.f(this,"$$sc.Enumerable.OrderByEnumerable$2").TValue)),this._mult=l?-1:1}return e.prototype.getEnumerator=function(){var e=this,t=n(244).toArray(i.f(this,"$$sc.Enumerable.OrderByEnumerable$2").TValue,this._source);return t.sort((function(t,n){return e.doCompare(t,n)})),new o.l(i.f(this,"$$sc.Enumerable.OrderByEnumerable$2").TValue,t)},e.prototype.doCompare=function(e,t){if(this._parent){var n=this._parent.doCompare(e,t);if(n)return n}return this._compare(this._comparisonSelector(e),this._comparisonSelector(t))*this._mult},e.CompareValues=function(e,t){return e<t?-1:e>t?1:0},e.$$=function(t,n){var o="OrderByEnumerable$2$"+t.getName()+"$"+n.getName(),a=i.x(o);return a||i.u(o,"$$sc.Enumerable.OrderByEnumerable$2",e,[{TKey:t},{TValue:n}],null,[b(n),r.i])},e}(),T=function(){function e(t,n,r){this._count=0,this._index=0,this._createdEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t)),this._element=i.c(i.f(this,"$$sc.Enumerable.RepeatEnumerator$1").T),this._element=n,this._count=r}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.RepeatEnumerator$1").T,this._element,this._count).getEnumerator():(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._element},e.prototype.moveNext=function(){return!(this._index>=this._count)&&(this._index++,!0)},e.prototype.reset=function(){this._index=0},e.$$=function(t){var n="RepeatEnumerator$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.RepeatEnumerator$1",e,[{T:t}],null,[r.i,m.m])},e}(),w=function(){function e(t,n,r,o,a){this._indexedSelector=null,this._simpleSelector=null,this._source=null,this._createdEnumerator=!1,this._index=0,this._sourceEnumerator=null,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t,n)),this._current=i.c(i.f(this,"$$sc.Enumerable.SelectEnumerator$2").TResult),this._source=r,this._indexedSelector=a,this._simpleSelector=o}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.SelectEnumerator$2").TSource,i.f(this,"$$sc.Enumerable.SelectEnumerator$2").TResult,this._source,this._simpleSelector,this._indexedSelector).getEnumerator():(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._current},e.prototype.moveNext=function(){return this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),!!this._sourceEnumerator.$$mn()&&(this._current=this.RunSelector(this._sourceEnumerator.$$cu()),this._index++,!0)},e.prototype.reset=function(){this._sourceEnumerator=null,this._index=-1},e.prototype.RunSelector=function(e){return this._indexedSelector?this._indexedSelector(e,this._index):this._simpleSelector(e)},e.$$=function(t,n){var o="SelectEnumerator$2$"+t.getName()+"$"+n.getName(),a=i.x(o);return a||i.u(o,"$$sc.Enumerable.SelectEnumerator$2",e,[{TSource:t},{TResult:n}],null,[r.i,m.m])},e}(),I=function(){function e(t,n,r,o,a){this._indexedSelector=null,this._simpleSelector=null,this._source=null,this._createdEnumerator=!1,this._index=0,this._resultEnumerator=null,this._sourceEnumerator=null,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t,n)),this._source=r,this._simpleSelector=o,this._indexedSelector=a}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.SelectManyEnumerator$2").TSource,i.f(this,"$$sc.Enumerable.SelectManyEnumerator$2").TResult,this._source,this._simpleSelector,this._indexedSelector).getEnumerator():(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._resultEnumerator.$$cu()},e.prototype.moveNext=function(){if(this._resultEnumerator&&this._resultEnumerator.$$mn())return!0;do{if(this._resultEnumerator=null,this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),!this._sourceEnumerator.$$mn())return!1;this._resultEnumerator=this.RunSelector(this._sourceEnumerator.$$cu()).$$ge(),this._index++}while(!this._resultEnumerator.$$mn());return!0},e.prototype.reset=function(){this._sourceEnumerator=null,this._resultEnumerator=null,this._index=0},e.prototype.RunSelector=function(e){return this._indexedSelector?this._indexedSelector(e,this._index):this._simpleSelector(e)},e.$$=function(t,n){var o="SelectManyEnumerator$2$"+t.getName()+"$"+n.getName(),a=i.x(o);return a||i.u(o,"$$sc.Enumerable.SelectManyEnumerator$2",e,[{TSource:t},{TResult:n}],null,[r.i,m.m])},e}(),E=function(){function e(t,n,r){this._source=null,this._count=0,this._sourceEnumerator=null,this._createdEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t)),this._source=n,this._count=r}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.SkipEnumerator$1").T,this._source,this._count).getEnumerator():(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._sourceEnumerator.$$cu()},e.prototype.moveNext=function(){if(!this._sourceEnumerator){this._sourceEnumerator=this._source.$$ge();for(var e=0;e<this._count;e++)if(!this._sourceEnumerator.$$mn())return!1}return this._sourceEnumerator.$$mn()},e.prototype.reset=function(){this._sourceEnumerator=null},e.$$=function(t){var n="SkipEnumerator$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.SkipEnumerator$1",e,[{T:t}],null,[r.i,m.m])},e}(),k=function(){function e(t,n,r,o){this._indexedPreciate=null,this._simplePredicate=null,this._source=null,this._createdEnumerator=!1,this._index=0,this._sourceEnumerator=null,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t)),this._source=n,this._simplePredicate=r,this._indexedPreciate=o}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.SkipWhileEnumerator$1").T,this._source,this._simplePredicate,this._indexedPreciate).getEnumerator():(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._sourceEnumerator.$$cu()},e.prototype.moveNext=function(){if(this._sourceEnumerator)return this._sourceEnumerator.$$mn();for(this._sourceEnumerator=this._source.$$ge();this._sourceEnumerator.$$mn();){if(!this.EvaluatePredicate(this._sourceEnumerator.$$cu()))return!0;this._index++}return!1},e.prototype.reset=function(){this._sourceEnumerator=null,this._index=0},e.prototype.EvaluatePredicate=function(e){return this._indexedPreciate?this._indexedPreciate(e,this._index):this._simplePredicate(e)},e.$$=function(t){var n="SkipWhileEnumerator$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.SkipWhileEnumerator$1",e,[{T:t}],null,[r.i,m.m])},e}(),D=function(){function e(t,n,r){this._source=null,this._count=0,this._index=0,this._sourceEnumerator=null,this._createdEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t)),this._source=n,this._count=r}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.TakeEnumerator$1").T,this._source,this._count).getEnumerator():(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._sourceEnumerator.$$cu()},e.prototype.moveNext=function(){return this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),!(this._index>=this._count)&&(this._index++,this._sourceEnumerator.$$mn())},e.prototype.reset=function(){this._sourceEnumerator=null},e.$$=function(t){var n="TakeEnumerator$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.TakeEnumerator$1",e,[{T:t}],null,[r.i,m.m])},e}(),M=function(){function e(t,n,r,o){this._indexedPreciate=null,this._simplePredicate=null,this._source=null,this._createdEnumerator=!1,this._index=0,this._sourceEnumerator=null,this._complete=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t)),this._source=n,this._simplePredicate=r,this._indexedPreciate=o}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.TakeWhileEnumerator$1").T,this._source,this._simplePredicate,this._indexedPreciate).getEnumerator():(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._sourceEnumerator.$$cu()},e.prototype.moveNext=function(){return!this._complete&&(this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge()),this._sourceEnumerator.$$mn()&&this.EvaluatePredicate(this._sourceEnumerator.$$cu())?(this._index++,!0):(this._complete=!0,this._sourceEnumerator=null,!1))},e.prototype.reset=function(){this._sourceEnumerator=null,this._index=0},e.prototype.EvaluatePredicate=function(e){return this._indexedPreciate?this._indexedPreciate(e,this._index):this._simplePredicate(e)},e.$$=function(t){var n="TakeWhileEnumerator$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.TakeWhileEnumerator$1",e,[{T:t}],null,[r.i,m.m])},e}(),P=function(){function e(t,n,r){this._source=null,this._test=null,this._sourceEnumerator=null,this._createdEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t)),this._source=n,this._test=r}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.WhereEnumerator$1").T,this._source,this._test).getEnumerator():(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._sourceEnumerator.$$cu()},e.prototype.moveNext=function(){for(this._sourceEnumerator||(this._sourceEnumerator=this._source.$$ge());this._sourceEnumerator.$$mn();)if(this._test(this._sourceEnumerator.$$cu()))return!0;return!1},e.prototype.reset=function(){this._sourceEnumerator=null},e.$$=function(t){var n="WhereEnumerator$1$"+t.getName(),o=i.x(n);return o||i.u(n,"$$sc.Enumerable.WhereEnumerator$1",e,[{T:t}],null,[r.i,m.m])},e}(),F=function(){function e(t,n,r,o,a,s){this._first=null,this._second=null,this._resultSelector=null,this._firstEnumerator=null,this._secondEnumerator=null,this._createdEnumerator=!1,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,i.m(this,e.$$(t,n,r)),this._current=i.c(i.f(this,"$$sc.Enumerable.ZipEnmerator$3").TResult),this._first=o,this._second=a,this._resultSelector=s}return e.prototype.getEnumerator=function(){return this._createdEnumerator?new e(i.f(this,"$$sc.Enumerable.ZipEnmerator$3").TFirst,i.f(this,"$$sc.Enumerable.ZipEnmerator$3").TSecond,i.f(this,"$$sc.Enumerable.ZipEnmerator$3").TResult,this._first,this._second,this._resultSelector).getEnumerator():(this._createdEnumerator=!0,this)},e.prototype.get_current=function(){return this._current},e.prototype.moveNext=function(){return this._firstEnumerator||(this._firstEnumerator=this._first.$$ge(),this._secondEnumerator=this._second.$$ge()),!(!this._firstEnumerator.$$mn()||!this._secondEnumerator.$$mn())&&(this._current=this._resultSelector(this._firstEnumerator.$$cu(),this._secondEnumerator.$$cu()),!0)},e.prototype.reset=function(){this._firstEnumerator=null,this._secondEnumerator=null},e.$$=function(t,n,o){var a="ZipEnmerator$3$"+t.getName()+"$"+n.getName()+"$"+o.getName(),s=i.x(a);return s||i.u(a,"$$sc.Enumerable.ZipEnmerator$3",e,[{TFirst:t},{TSecond:n},{TResult:o}],null,[r.i,m.m])},e}();n.d(t,{asEnumerable:function(){return x},fromIterator:function(){return R},select:function(){return B},Si:function(){return L},SMi:function(){return N},selectMany:function(){return U},skip:function(){return O},skipWhile:function(){return H},SWI:function(){return W},take:function(){return V},takeWhile:function(){return $},TW:function(){return K},where:function(){return z},first:function(){return q},FT:function(){return Q},firstOrDefault:function(){return G},FDT:function(){return j},last:function(){return Z},LT:function(){return X},lastOrDefault:function(){return J},LDT:function(){return Y},ofType:function(){return ee},cast:function(){return te},any:function(){return ne},AT:function(){return ie},all:function(){return re},count:function(){return oe},Ct:function(){return ae},CT:function(){return se},aggregate:function(){return le},AgS:function(){return ue},AgSS:function(){return ce},concat:function(){return pe},repeat:function(){return de},zip:function(){return he},orderBy:function(){return ge},OBc:function(){return me},orderByDescending:function(){return _e},OBdc:function(){return fe},thenBy:function(){return ye},TBc:function(){return ve},thenByDescending:function(){return Se},TBDc:function(){return Ce},toList:function(){return be},toArray:function(){return Ae},toDictionary:function(){return Te},TD:function(){return we},SumS:function(){return Ie},MinS:function(){return Ee},MaxS:function(){return ke},empty:function(){return De}});var x=function(e,t){return new a(e,t)},R=function(e,t){return new S(e,t)},B=function(e,t,n,i){return new w(e,t,n,i,null)},L=function(e,t,n,i){return new w(e,t,n,null,i)},N=function(e,t,n,i){return new I(e,t,n,null,i)},U=function(e,t,n,i){return new I(e,t,n,i,null)},O=function(e,t,n){return new E(e,t,n)},H=function(e,t,n){return new k(e,t,n,null)},W=function(e,t,n){return new k(e,t,null,n)},V=function(e,t,n){return new D(e,t,n)},$=function(e,t,n){return new M(e,t,n,null)},K=function(e,t,n){return new M(e,t,null,n)},z=function(e,t,n){return new P(e,t,n)},q=function(e,t){var n=t.$$ge();if(!n.$$mn())throw Error.argumentNull("source");return n.$$cu()},Q=function(e,t,n){var i=t.$$ge();do{if(!i.$$mn())throw Error.argumentNull("source")}while(!n(i.$$cu()));return i.$$cu()},G=function(e,t){var n=t.$$ge();return n.$$mn()?n.$$cu():i.c(e)},j=function(e,t,n){var r=t.$$ge();do{if(!r.$$mn())return i.c(e)}while(!n(r.$$cu()));return r.$$cu()},Z=function(e,t){var n,i=t.$$ge();if(!i.$$mn())throw Error.argumentNull("source");do{n=i.$$cu()}while(i.$$mn());return n},X=function(e,t,n){for(var i,r=t.$$ge();(i=r.$$mn())&&!n(r.$$cu()););if(!i)throw Error.argumentNull("source");for(var o=r.$$cu();r.$$mn();)n(r.$$cu())&&(o=r.$$cu());return o},J=function(e,t){var n,r=t.$$ge();if(!r.$$mn())return i.c(e);do{n=r.$$cu()}while(r.$$mn());return n},Y=function(e,t,n){for(var r,o=t.$$ge();(r=o.$$mn())&&!n(o.$$cu()););if(!r)return i.c(e);for(var a=o.$$cu();o.$$mn();)n(o.$$cu())&&(a=o.$$cu());return a},ee=function(e,t){return new C(e,t)},te=function(e,t){return new _(e,t)},ne=function(e,t){return t.$$ge().$$mn()},ie=function(e,t,n){for(var i=t.$$ge();i.$$mn();){if(n(i.$$cu()))return!0}return!1},re=function(e,t,n){for(var i=t.$$ge();i.$$mn();){if(!n(i.$$cu()))return!1}return!0},oe=function(e){for(var t=0,n=e.getEnumerator();n.moveNext();){n.get_current();t++}return t},ae=function(e,t){for(var n=0,i=t.$$ge();i.$$mn();){i.$$cu();n++}return n},se=function(e,t,n){for(var i=t.$$ge(),r=0;i.$$mn();)n(i.$$cu())&&r++;return r},le=function(e,t,n){var i=t.$$ge();if(!i.$$mn())throw Error.invalidOperation("source contains no elements");for(var r=i.$$cu();i.$$mn();)r=n(r,i.$$cu());return r},ue=function(e,t,n,i,r){for(var o=n.$$ge();o.$$mn();){i=r(i,o.$$cu())}return i},ce=function(e,t,n,i,r,o,a){for(var s=i.$$ge();s.$$mn();){r=o(r,s.$$cu())}return a(r)},pe=function(e,t,n){return new f(e,t,n)},de=function(e,t,n){return new T(e,t,n)},he=function(e,t,n,i,r,o){return new F(e,t,n,i,r,o)},ge=function(e,t,n,i){return new A(t,e,n,i,null,null,!1)},me=function(e,t,n,i,r){return new A(t,e,n,i,r,null,!1)},_e=function(e,t,n,i){return new A(t,e,n,i,null,null,!0)},fe=function(e,t,n,i,r){return new A(t,e,n,i,r,null,!0)},ye=function(e,t,n,i){return new A(t,e,n,i,null,n,!1)},ve=function(e,t,n,i,r){return new A(t,e,n,i,r,n,!1)},Se=function(e,t,n,i){return new A(t,e,n,i,null,n,!0)},Ce=function(e,t,n,i,r){return new A(t,e,n,i,r,n,!0)},be=function(e,t){for(var n=new l.c(e),i=t.$$ge();i.$$mn();){var r=i.$$cu();n.add(r)}return n},Ae=function(e,t){return be(e,t).toArray()},Te=function(e,t,n,i){for(var r=new s.d(t,e,g.$$(t).get_default()),o=n.$$ge();o.$$mn();){var a=o.$$cu();r.add(i(a),a)}return r},we=function(e,t,n,i,r,o){for(var a=new s.d(t,n,g.$$(t).get_default()),l=i.$$ge();l.$$mn();){var u=l.$$cu();a.add(r(u),o(u))}return a},Ie=function(e,t,n){for(var i=0,r=t.$$ge();r.$$mn();){i+=n(r.$$cu())}return i},Ee=function(e,t,n){for(var i=Number.POSITIVE_INFINITY,r=t.$$ge();r.$$mn();){var o=n(r.$$cu());o<i&&(i=o)}return i},ke=function(e,t,n){for(var i=Number.NEGATIVE_INFINITY,r=t.$$ge();r.$$mn();){var o=n(r.$$cu());o>i&&(i=o)}return i},De=function(e){return new y(e)}},,function(e,t,n){"use strict";n.r(t);var i=n(614),r=n(254),o=n(515),a=n(556),s="height=500,width=400,channelmode=no,directories=no,fullscreen=no,location=no,menubar=no,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=no",l=function(e,t,n,i){var r=h(e)+"WAEndUser";if(i){var o=n.indexOf("_")>0?n:r+"_"+n;n?window.parent.HelpWindowKey(o):window.parent.HelpWindow()}else{if(n.indexOf("_")>0){var a=n.split("_");if(2!==a.length)return;r=a[0],n=a[1]}n&&"home"===n.toLowerCase()&&(n="");var l="&p1="+r+"&apps=WDWAENDUSER%2CXLWAENDUSER%2CPPWAENDUSER%2CONWAENDUSER";n&&(l+="&HelpID="+n),u(!0,"rlidOfficeWebHelp",t,l,s)}},u=function(e,t,n,i,r){var o=e?c(t,n):p(t,n);i&&(o+=i),r?window.open(o,"_blank",r):window.open(o)},c=function(e,t){return"https://r.office.microsoft.com/r/"+e+"?clid="+t.toString()+"&ver=15"},p=function(e,t){return"https://go.microsoft.com/fwlink/?LinkID="+e+"&clcid="+a.l.convertToHex(t,4)},d=function(e){switch(e){case 1:return"Excel";case 2:return"Word";case 3:return"PowerPoint";case 4:return"OneNote";case 5:return"Visio";default:return""}},h=function(e){switch(e){case 1:return"XL";case 2:return"WD";case 3:return"PP";case 4:return"ON";case 5:return"VI";default:return""}},g=n(743),m=n(208);n.d(t,{Redirect:function(){return _}});var _=function(){function e(){}return e.registerActions=function(t){var n=r.AFrameworkApplication.get_theActionManager(),o=e.redirectAction;n.addAction(i.dd,t,o),n.addAction(i.ue,t,o),n.addAction(i.Lt,t,o),n.addAction(i.BB,t,o),n.addAction(i.rI,t,o)},e.registerAction=function(t,n){var i=r.AFrameworkApplication.get_theActionManager(),o=e.redirectAction;i.addAction(n,t,o)},e.showHelp=function(t){l(e.application,r.AFrameworkApplication.lcid,t,r.AFrameworkApplication.useParentHelpFunction)},e.toFwlink=function(e){u(!1,e,r.AFrameworkApplication.lcid,null,null)},e.isHelpAvailable=function(){return!0},e.redirectAction=function(t,n,a,c,p){var h=4;switch(t){case i.GG:h=7;break;case i.dd:case i.ue:case i.Lt:case i.BB:case i.rI:break;default:return 2}if(1===a)return 32;switch(t){case i.ue:r.AFrameworkApplication.privacyUrl&&window.open(r.AFrameworkApplication.privacyUrl);break;case i.Lt:r.AFrameworkApplication.termsUrl&&window.open(r.AFrameworkApplication.termsUrl);break;case i.dd:e.showHelp("");break;case i.BB:window.open(g.h.staticContentHost+r.AFrameworkApplication.get_scriptFolderPath()+"TPN\\thirdPartyNotices.html","_blank",s);break;case i.rI:o.PrivacyDialogManager.showCommercialTrustCenterDialog();break;default:!function(e,t,n){d(e);switch(n){case 4:l(e,t,null,!1);break;case 7:2===e?u(!1,"325036",t,"",s):4===e&&u(!1,"864324",t,"",s)}}(e.application,r.AFrameworkApplication.lcid,h)}return 32},e.application=0,e}();(0,m.l)(_,"Redirect",null,[])},function(e){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,n){"use strict";var i=n(508),r=n(743),o=n(208),a=function(){function e(){this._text="",this._progressSpan=null,this._textSpan=null,this._imageElement=null}return e.prototype.get_text=function(){return this._text},e.prototype.set_text=function(e){return this._text!==e&&(this._text=e,this._textSpan&&(this._textSpan.innerText=this._text,this.setImageAltText(this._text))),e},e.prototype.get_element=function(){return this._progressSpan},e.prototype.createAndAttach=function(e,t){this._progressSpan=document.createElement("span"),this._progressSpan.setAttribute("Unselectable","on"),this._imageElement=this.createImageElement(t,e),this._imageElement.setAttribute("Unselectable","on"),this._textSpan=this.createTextElement(),this._textSpan.setAttribute("Unselectable","on"),this.setCssClasses(),this._progressSpan.appendChild(this._textSpan),this._progressSpan.appendChild(this._imageElement),this.set_text(e)},e.prototype.setCssClasses=function(){},e.prototype.createTextElement=function(){return document.createElement("span")},e.prototype.createImageElement=function(e,t){var n=document.createElement("img");return n.src=r.h.commonImage(e),n},e.prototype.setImageAltText=function(e){this._imageElement.alt=e},e.prototype.setTitle=function(e){this._imageElement.title=e},e.prototype.setVisibility=function(e,t){this._imageElement.style.display=e?"inline":"none",this._textSpan.style.display=t?"inline":"none"},e.prototype.dispose=function(){this._progressSpan=null,this._textSpan=null,this._imageElement=null},e}();(0,o.l)(a,"ImageAndTextControl",null,[Sys.IDisposable]),n.d(t,{k:function(){return l}});var s="progress.gif",l=function(e){function t(t){var n=e.call(this)||this;return n._isSmall=!1,n.createAndAttach(t,s),n}return(0,i.t)(t,e),t.prototype.get_isSmall=function(){return this._isSmall},t.prototype.set_isSmall=function(e){return this._isSmall!==e&&(this._isSmall=e,this.setImageCss(this._isSmall)),e},t.prototype.setCssClasses=function(){this._progressSpan.className="WACProgress",this._imageElement.className="WACProgressImage",this._textSpan.className="WACProgressText"},t.prototype.setImageCss=function(e){e?(this._imageElement.className="WACProgressSmallImage",this._imageElement.src=r.h.commonImage("progress16.gif"),this._textSpan.className="WACProgressSmallText"):(this._imageElement.className="WACProgressImage",this._imageElement.src=r.h.commonImage(s),this._textSpan.className="WACProgressText")},t}(a);(0,o.l)(l,"Progress",a,[])},function(e,t,n){"use strict";var i=n(394),r=n(12),o=n(786),a=n(57),s=o("species");e.exports=function(e){var t=i(e),n=r.f;a&&t&&!t[s]&&n(t,s,{configurable:!0,get:function(){return this}})}},function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var i=n(208),r=function(){function e(){}return e.hostPerfTiming_Click="Click",e.hostPerfTiming_FetchStart="FetchStart",e.hostPerfTiming_FetchStartAlt="HostFrameFetchStart",e.hostPerfTiming_Iframe="Iframe",e.hostPerfTiming_RedirectCount="RedirectCount",e.appLoadingStatus_DocumentLoadedTime="DocumentLoadedTime",e.surveyTitle="SurveyTitle",e.fileRename_NewName="NewName",e.fileRename_FailureMessage="FailureMessage",e.shareCorrelation="ShareCorrelation",e.shareNavId="nav",e.shareMode="mode",e.addinControlId="AddinControlId",e.addinApplicationResource="AddinApplicationResource",e.accessToken="AccessToken",e.addinSSOError="AddinSSOError",e.addinSSOAuthChallenge="AddinSSOAuthChallenge",e.addinIsFirstParty="AddinIsFirstParty",e.allowConsentPrompt="AllowConsentPrompt",e.hostApplicationType="HostApplicationType",e.userName="UserName",e.userEmail="UserEmail",e.federationProvider="FederationProvider",e.ssoRequestId="SsoRequestId",e.ssoResource="SsoResource",e.ssoScope="SsoScope",e.ssoAuthChallenge="SsoAuthChallenge",e.ssoSilentLogin="SsoSilentLogin",e.ssoOptions="SsoOptions",e.ssoAccessToken="SsoAccessToken",e.ssoTokenExpiration="SsoTokenExpiration",e.ssoAuthority="SsoAuthority",e.ssoUserDisplayName="SsoUserDisplayName",e.ssoUserEmail="SsoUserEmail",e.ssoError="SsoError",e.diagnostics="Diagnostics",e.officeFrameRequestStartTime="officeFrameRequestStartTime",e.officeFrameFirstFlushTime="officeFrameFirstFlushTime",e.officeFrameBootResourcesStartTime="officeFrameBootResourcesStartTime",e.officeFrameBootResourcesEndTime="officeFrameBootResourcesEndTime",e.officeFrameBootScriptsStartTime="officeFrameBootScriptsStartTime",e.officeFrameBootScriptsEndTime="officeFrameBootScriptsEndTime",e.officeFrameDocumentFlushTime="officeFrameDocumentFlushTime",e.documentLoadedFromWopiPrecheckInfo="documentLoadedFromWopiPrecheckInfo",e.cacheHit="cacheHit",e.cacheAboutToExpire="cacheAboutToExpire",e.cacheInvalid="cacheInvalid",e.officeFrameServerStartTime="officeFrameServerStartTime",e.officeFrameServerFirstFlushTime="officeFrameServerFirstFlushTime",e.officeFrameServerFirstFlushEndTime="officeFrameServerFirstFlushEndTime",e.bundleRequestsData="bundleRequestsData",e.fileRequestsData="fileRequestsData",e.officeServerDocumentProcessStartTime="officeServerDocumentProcessStartTime",e.officeServerDocumentProcessEndTime="officeServerDocumentProcessEndTime",e.officeFrameServerDocumentFlushTime="officeFrameServerDocumentFlushTime",e.officeServerSsrFlushTime="officeServerSsrFlushTime",e.checkFileInfoStartTime="CheckFileInfoStartTime",e.checkFileInfoEndTime="CheckFileInfoEndTime",e.getFlightedAppSettingsStartTime="GetFlightedAppSettingsStartTime",e.getFlightedAppSettingsEndTime="GetFlightedAppSettingsEndTime",e.acquireLockStartTime="AcquireLockStartTime",e.acquireLockEndTime="AcquireLockEndTime",e.acquireLockRequestStatus="AcquireLockRequestStatus",e.getDocumentStartTime="GetDocumentStartTime",e.getDocumentEndTime="GetDocumentEndTime",e.getDocumentRequestStatus="GetDocumentRequestStatus",e.documentLoadedTime="documentLoadedTime",e.appCompletedTime="appCompletedTime",e.wopiCheckLastModifiedTime="wopiCheckLastModifiedTime",e.officeAppEndpoint="officeAppEndpoint",e.officeServerVersion="officeServerVersion",e.hostInitializeDiagnostics="HostInitializeDiagnostics",e.jsApiDiagnostics="JsApiDiagnostics",e.wacAction="Action",e.ackExpected="ackExpected",e.hostCacheLoadTime="HostCacheLoadTime",e.oAuthToken="access_token",e.oAuthError="error",e.oAuthResource="resource",e.newZoomLevel="newLevel",e.oldZoomLevel="oldLevel",e.newPage="newPage",e.oldPage="oldPage",e.pageCount="pageCount",e.isDisabled="isDisabled",e.type="type",e.keyCode="keyCode",e.altKey="altKey",e.ctrlKey="ctrlKey",e.metaKey="metaKey",e.shiftKey="shiftKey",e.direction="Direction",e.sessionInfo_TokenName="Name",e.sessionInfo_TokenExpiry="Expiry",e.sessionInfo_TokenValue="Value",e.sessionInfo_TokenNamesField="Tokens",e.sessionInfo_ErrorId="Id",e.sessionInfo_ErrorDetails="Details",e.sessionInfo_AccessToken="AccessToken",e.sessionInfo_FileGetUrl="FileGetUrl",e.newMode="NewMode",e.editable="Editable",e.wopiInfo_Url="Url",e.wopiInfo_WopiSrc="WopiSrc",e.wopiInfo_AccessToken="AccessToken",e.wopiInfo_AccessTokenExpiry="AccessTokenExpiry",e.wopiInfo_Error="Error",e.isTopFrameTrusted="isTopFrameTrusted",e.ignoreForEUPL="ignoreForEUPL",e.errorObject="errorObject",e.documentUrl="documentUrl",e.rebootMode="rebootMode",e.mode="mode",e.queryOverrides="queryOverrides",e.isNewSession="isNewSession",e.template="template",e.appID="appID",e.lcid="lcid",e.overlayContent="overlayContent",e}();(0,i.l)(r,"CrossDocumentMessageFields",null,[])},,function(e,t,n){"use strict";var i=n(208),r=n(867),o=function(){function e(){this.classId=0}return e.deserializeResponse=function(e){try{return r.d(e)}catch(e){}return null},e}();(0,i.l)(o,"ARoamingAppsResponse",null,[]);var a=function(){return function(){this.callback=null,this.state=null,this.isFirstTry=!1}}();(0,i.l)(a,"GetRoamingAppsLauncherContext",null,[]);var s=n(254),l=n(478);n.d(t,{x:function(){return u}});var u=function(){function e(t){this._roamingRightsAreChecked=!1,this._checkingRoamingRights=!1,this._userHasRoamingRights=!1,this._numberOfRetries=0,this._roamingApp=0,this._roamingAppsAreEnabled=!1,this._roamingAppsLauncher=null,this._lastTimeLauncherGet=null,this.platform=null,this.applicationExe=null,this.officeVersion=null,this._retryInterval=e.initialRetryInterval,this._roamingAppsAreEnabled=t,this._roamingRightsAreChecked=!1,this._userHasRoamingRights=!1}return e.prototype.get_roamingAppsLauncher=function(){var t=new Date;return this._lastTimeLauncherGet&&t.getTime()-this._lastTimeLauncherGet.getTime()<e.roamingAppsLauncherExpirationTime?this._roamingAppsLauncher:null},e.prototype.get_roamingAppsAreEnabled=function(){return this._roamingAppsAreEnabled},e.prototype.get_userHasRoamingRights=function(){return!(!this.get_roamingAppsAreEnabled()||!this._roamingRightsAreChecked)&&this._userHasRoamingRights},e.prototype.checkUserRoamingRights=function(e){s.AFrameworkApplication.isOpenInClientEnabled&&this.get_roamingAppsAreEnabled()&&!this._roamingRightsAreChecked&&!this._checkingRoamingRights&&(this._roamingApp=e,this._checkingRoamingRights=!0,this.resetRetryNumbers(),this.executeCheckUserRoamingRights())},e.prototype.resetRetryNumbers=function(){this._retryInterval=e.initialRetryInterval,this._numberOfRetries=0},e.prototype.getRoamingAppsLauncher=function(e,t,n){if(this.get_userHasRoamingRights()){var i=new a;i.callback=t,i.state=n,i.isFirstTry=!0,this.executeGetRoamingAppsLauncher(i)}else t(!1,"",n)},e.prototype.executeCheckUserRoamingRights=function(){var e=new(n(328).CheckRoamingRightsRequest);e.RoamingApp=this._roamingApp,e.BaseDocQuerySignature=s.AFrameworkApplication.baseDocQuerySignatureWithoutVersion,e.execute(i.i(this,this.checkUserRoamingRightsSucceeded,"checkUserRoamingRightsSucceeded"),i.i(this,this.checkUserRoamingRightsFailed,"checkUserRoamingRightsFailed"),null)},e.prototype.checkUserRoamingRightsSucceeded=function(e){if(!s.AFrameworkApplication.isShuttingDown){var t=e.get_data().responseData,n=o.deserializeResponse(t);n?this.setUserHasRoamingRights(n.HasRights):this.setUserHasRoamingRights(!1)}},e.prototype.checkUserRoamingRightsFailed=function(t){if(!s.AFrameworkApplication.isShuttingDown)if(this._numberOfRetries>=e.maxNumberOfRetries)this.setUserHasRoamingRights(!1);else{var n=new l.c(2,1,this._retryInterval,i.i(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);s.AFrameworkApplication.get_theTaskManager().addTask(n),this._numberOfRetries++,this._retryInterval*=e.retryBackoffFactor,this._retryInterval>e.maxRetryInterval&&(this._retryInterval=e.maxRetryInterval)}},e.prototype.setUserHasRoamingRights=function(e){this._userHasRoamingRights=e,this._roamingRightsAreChecked=!0,this._checkingRoamingRights=!1},e.prototype.retryCheckUserRoamingRights=function(e){this.executeCheckUserRoamingRights()},e.prototype.executeGetRoamingAppsLauncher=function(e){var t=new(n(991).GetRoamingLauncherRequest);t.RoamingApp=this._roamingApp,t.BaseDocQuerySignature=s.AFrameworkApplication.baseDocQuerySignatureWithoutVersion,t.execute(i.i(this,this.getRoamingAppsLauncherSucceeded,"getRoamingAppsLauncherSucceeded"),i.i(this,this.getRoamingAppsLauncherFailed,"getRoamingAppsLauncherFailed"),e)},e.prototype.getRoamingAppsLauncherSucceeded=function(e){if(!s.AFrameworkApplication.isShuttingDown){var t=e.get_data().responseData,n=o.deserializeResponse(t),i=e.get_data().state;n?(this._roamingAppsLauncher=n.Launcher,this.platform=n.Platform,this.officeVersion=n.OfficeVersion,this.applicationExe=n.Application,this._lastTimeLauncherGet=new Date,i.callback(!0,n.Launcher,i.state)):i.callback(!1,"",i.state)}},e.prototype.getRoamingAppsLauncherFailed=function(e){if(!s.AFrameworkApplication.isShuttingDown){var t=e.get_data().state;if(5===e.get_data().status&&t.isFirstTry)return t.isFirstTry=!1,void this.executeGetRoamingAppsLauncher(t);t.callback(!1,"",t.state)}},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=new e(s.AFrameworkApplication.get_areRoamingAppsEnabled()))},e.initialRetryInterval=1e3,e.retryBackoffFactor=5,e.maxRetryInterval=12e5,e.maxNumberOfRetries=5,e.roamingAppsLauncherExpirationTime=3e5,e._singletonInstance=null,e}();(0,i.l)(u,"RoamingAppsManager",null,[])},,function(e,t,n){"use strict";n.r(t);var i,r=n(208),o=n(233),a=n(430),s=n(809),l=n(448),u=n(837),c=n(255),p=n(614),d=n(722),h=(0,r.y)("IOtelActionListener"),g=(0,r.y)("IActionManagerListener"),m=n(600),_=n(236),f=n(23);!function(e){e[e.none=0]="none",e[e.reading=1]="reading",e[e.edit=2]="edit"}(i||(i={})),(0,r.h)("FrameMode",i);var y=n(150),v=n(124),S=n(806),C=n(699),b=n(163),A=n(540),T=function(){function e(){this.otelNonUserActionEventTableName=null,this.otelNonUserActionEventTableNamePrefix=null,this.oneTablePerActivityEnabled=!1,this._unprocessedActionOperations=[],this.otelNonUserActionEventTableName=S.j.getOtelNonUserActionEventTableName(),this.otelNonUserActionEventTableNamePrefix=S.j.getOtelNonUserActionEventTablePrefix(),f.p.add_onAfterError(r.i(this,this.closeUnprocessedActions,"closeUnprocessedActions")),this.oneTablePerActivityEnabled=n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneTablePerUserActionEnabled")}return e.prototype.onBeforeAction=function(e){this.addUnprocessedActionOperation(e)},e.prototype.onAfterAction=function(e){this.removeLastUnprocessedActionOperation(e)&&this.canRecordToOtel(e)&&this.recordToOtel(e)},e.prototype.addUnprocessedActionOperation=function(e){Array.add(this._unprocessedActionOperations,e)},e.prototype.removeLastUnprocessedActionOperation=function(e){var t=this._unprocessedActionOperations.length-1;return this._unprocessedActionOperations[t]!==e?(Array.clear(this._unprocessedActionOperations),!1):(Array.removeAt(this._unprocessedActionOperations,t),!0)},e.prototype.closeUnprocessedActions=function(){this._unprocessedActionOperations.length>0&&c.ULS.sendTraceTag(40109205,383,50,"Count of unprocessed action operations: "+this._unprocessedActionOperations.length.toString());for(var e=0;e<this._unprocessedActionOperations.length;e++){var t=this._unprocessedActionOperations[e];this.recordToOtel(t)}Array.clear(this._unprocessedActionOperations)},e.prototype.canRecordToOtel=function(e){return!0},e.prototype.recordToOtel=function(t){if(S.j.isUserActionLoggingToOtelEnabled()){var r=n(254).AFrameworkApplication.get_theActionManager().getActionMetadata(t.get_actionId()),o=!!r&&r.flags[32]&&r.flags[64];if(!(2!==t.get_behavior()||t.get_response()<1||!n(254).AFrameworkApplication.theWsaClient||o)){var a=t.get_actionId(),l=d.ActionManager.actionIdResolver(a)||"",u=t.get_startTime().getTime(),p=t.get_endTime().getTime()-u;p=p<0?0:p;var h=t.get_commandTabName()||S.j.unknownValueString,g=y.s[t.get_invocationMethod()],f=_.i[t.get_commandLocation()],T=i[t.get_beginMode()],w=t.get_telemetryData()&&"TriggerTime"in t.get_telemetryData()?t.get_telemetryData().TriggerTime:0,I=parseInt(String(Math.round(w)));I>S.j.get_maX_SAFE_INTEGER()&&(c.ULS.sendTraceTag(42567431,383,50,"timeOffsetMs ("+I+") was > "+S.j.get_maX_SAFE_INTEGER()),I=S.j.get_maX_SAFE_INTEGER());var E=n(254).AFrameworkApplication.theWsaClient.getActiveDocKey(),k=32===t.get_response(),D=0,M=0;if(!!r&&r.flags[8]){var P=t.get_reportingData(),F=(65535&a^a>>>16)<<16;F<0&&(F+=4294967296),D=void 0===P.dataValue1||null===P.dataValue1?0:P.dataValue1,M=void 0===P.dataValue2||null===P.dataValue2?0:P.dataValue2,D+=F,M+=F}64===t.get_response()||e.componentNameNotUsed;if(r&&r.flags[64])S.j.sanitizeValues((0,m.m)((function(){return h}),(function(e){return h=e})),(0,m.m)((function(){return g}),(function(e){return g=e})),(0,m.m)((function(){return f}),(function(e){return f=e}))),C.k.sendActivityEvent((0,s.m)(new b.z,{name:this.oneTablePerActivityEnabled&&l&&l.length>0?this.otelNonUserActionEventTableNamePrefix+l:this.otelNonUserActionEventTableName,durationMs:p,dataFields:[(0,s.m)(new A.b,{name:"ActionId",int64:t.get_actionId()}),(0,s.m)(new A.b,{name:"ActionName",string:l}),(0,s.m)(new A.b,{name:"CommandSurface",string:f}),(0,s.m)(new A.b,{name:"ParentName",string:h}),(0,s.m)(new A.b,{name:"TriggerMethod",string:g}),(0,s.m)(new A.b,{name:"TimeOffsetMs",int64:I}),(0,s.m)(new A.b,{name:"StartTime",date:u}),(0,s.m)(new A.b,{name:"Succeeded",bool:k}),(0,s.m)(new A.b,{name:"Mode",string:T}),(0,s.m)(new A.b,{name:"CustomData1",int64:D}),(0,s.m)(new A.b,{name:"CustomData2",int64:M}),(0,s.m)(new A.b,{name:"ActiveDocKey",int64:E})]})),c.ULS.sendTraceTag(40915043,383,50,"OtelActionListener activity:"+l);else{var x=[(0,s.m)(new A.b,{name:"Mode",string:T}),(0,s.m)(new A.b,{name:"CustomData1",int64:D}),(0,s.m)(new A.b,{name:"CustomData2",int64:M}),(0,s.m)(new A.b,{name:"ActiveDocKey",int64:E})];v.a(a,k,h,t.get_invocationMethod(),t.get_commandLocation(),p,x),c.ULS.sendTraceTag(40915072,383,50,"OtelActionListener action:"+l)}}}},e.getInstance=function(){return e._instance||(e._instance=new e)},e._instance=null,e.componentNameNotUsed=2,e}();(0,r.l)(T,"OtelActionListener",null,[h,g]);var w=(0,r.y)("IWsaListener"),I=n(556),E=function(){function e(e){void 0===e&&(e=!0),this._logActiveDocKey=!0,this._unprocessedActionOperations=[],f.p.add_onAfterError(r.i(this,this.closeUnprocessedActions,"closeUnprocessedActions")),this._logActiveDocKey=e}return e.prototype.onBeforeAction=function(e){this.addUnprocessedActionOperation(e)},e.prototype.onAfterAction=function(e){this.removeLastUnprocessedActionOperation(e)&&this.canRecordToSqm(e)&&this.recordToSqm(e)},e.prototype.addUnprocessedActionOperation=function(e){Array.add(this._unprocessedActionOperations,e)},e.prototype.removeLastUnprocessedActionOperation=function(e){var t=this._unprocessedActionOperations.length-1;return this._unprocessedActionOperations[t]!==e?(Array.clear(this._unprocessedActionOperations),!1):(Array.removeAt(this._unprocessedActionOperations,t),!0)},e.prototype.closeUnprocessedActions=function(){for(var e=0;e<this._unprocessedActionOperations.length;e++){var t=this._unprocessedActionOperations[e];this.recordToSqm(t)}Array.clear(this._unprocessedActionOperations)},e.prototype.canRecordToSqm=function(e){return S.j.oldActionsPipelineIsEnabled()},e.prototype.recordToSqm=function(t){var i=n(254).AFrameworkApplication.get_theActionManager().getActionMetadata(t.get_actionId()),r=!!i&&i.flags[64];if(!(2!==t.get_behavior()||t.get_response()<1||!n(254).AFrameworkApplication.theWsaClient||r)){var o=t.get_actionId(),a=t.get_startTime().getTime(),s=t.get_endTime().getTime()-a;(a&=4294967295)<0&&(a+=4294967296),s<0&&(s=0);var l=t.get_invocationMethod()+(t.get_beginMode()<<5)+(t.get_commandLocation()<<9)+(e.commandUIActionComponentTypeNotUsed<<16)+(e.actionResponseToResponseCode(t.get_response())<<21),u=I.l.calcHashCode(t.get_commandTabName()),c=0,p=0;if(!!i&&i.flags[8]){var d=t.get_reportingData(),h=(65535&o^o>>>16)<<16;h<0&&(h+=4294967296),c=void 0===d.dataValue1||null===d.dataValue1?0:d.dataValue1,p=void 0===d.dataValue2||null===d.dataValue2?0:d.dataValue2,c+=h,p+=h}var g,m=[l,u,o,64===t.get_response()?1:e.componentNameNotUsed,a,s,c,p];this._logActiveDocKey&&m.push(n(254).AFrameworkApplication.theWsaClient.getActiveDocKey()),(g=n(254).AFrameworkApplication.theWsaClient).addToStreamDw.apply(g,[e.ribbonStreamId].concat(m))}},e.getInstance=function(t){return void 0===t&&(t=!0),e._instance||(e._instance=new e(t))},e.actionResponseToResponseCode=function(e){switch(e){case 0:return 0;case 1:return 1;case 2:return 2;case 4:return 3;case 8:return 4;case 16:return 5;case 32:return 6;case 64:return 7;default:return 8}},e._instance=null,e.ribbonStreamId=8327,e.ribbonStreamWidth=9,e.commandUIActionComponentTypeNotUsed=31,e.componentNameNotUsed=2,e}();(0,r.l)(E,"WsaListener",null,[w,g]);var k=n(196),D=n(889),M=n(758),P=n(400),F=n(873),x=n(675),R=function(){return function(){this.errorCode=0,this.errorCause=0,this.errorResolution=0}}();(0,r.l)(R,"ErrorWithCauseAndResolution",null,[]);var B=n(399),L=n(36),N=n(427),U=n(648),O=n(47),H=n(306),W=n(657),V=n(550),$=n(749),K=n(830),z=n(733),q=n(25),Q=n(508),G=(0,r.y)("IMsoBWsaClient"),j=(0,r.y)("IBWsaClient"),Z=(0,r.y)("IMsoBWsaClientExternal"),X=18e5,J=65536,Y=1e3,ee=function(){function e(){this.m_UploadUrl=null,this.m_IsOptedIn=!1,this.m_SqmQoSEnabled=!1,this.m_QoSDataPoints=null,this.m_MaxSessionMs=0,this.m_MaxDataSize=0,this.m_MaxSqmId=0,this.m_MinTimeBetweenUploads=0,this.m_MaxStreamRows=0,this.m_MaxStreamWidth=0,this.defaultCommonDatapointIds=[60,7982,7993,7994,8047,8048,8049,9411,9412],this.m_UploadUrl="",this.m_IsOptedIn=!1,this.m_SqmQoSEnabled=!1,this.m_QoSDataPoints=null,this.m_MaxSessionMs=X,this.m_MaxDataSize=J,this.m_MaxSqmId=2147483647,this.m_MaxStreamWidth=9,this.m_MinTimeBetweenUploads=Y,this.m_MaxStreamRows=e.defaultMaxStreamRows}return e.prototype.get_maxSessionMs=function(){return this.m_MaxSessionMs},e.prototype.set_maxSessionMs=function(e){return this.m_MaxSessionMs=e,e},e.prototype.get_uploadUrl=function(){return this.m_UploadUrl},e.defaultMaxStreamRows=1e3,e.defaultMaxInt32=4294967295,e.defaultRibbonStreamWidth=8,e}();(0,r.l)(ee,"BWsaConfig",null,[]);var te=function(){function e(){}return e.getTicks32=function(){var t=(new Date).getTime();return e.startTicks||(e.startTicks=t),1+t-e.startTicks&2147483647},e.getTicks64=function(){var e=(new Date).getTime();return e+=116444736e5,e*=1e4},e.startTicks=0,e}();(0,r.l)(te,"Ticks",null,[]);var ne=function(){return function(){this.m_StartTime=0,this.m_EndTime=0,this.m_CorrelationId=null,this.m_FlightId=null,this.m_StartTime=te.getTicks64(),this.m_EndTime=0}}();(0,r.l)(ne,"BWsaHeader",null,[]);var ie=function(){return function(){this.m_cDataPoints=0,this.m_cStreams=0,this.m_cbStreams=0,this.m_wsaHeader=null,this.m_wsaDatapoints=null,this.m_wsaStreams=null,this.m_cDataPoints=0,this.m_cStreams=0,this.m_cbStreams=0,this.m_wsaHeader=new ne,this.m_wsaDatapoints={},this.m_wsaStreams={}}}();(0,r.l)(ie,"BWsaData",null,[]);var re=function(){return function(e){this.m_WsaId=0,this.m_Value=0,this.m_Ticks=0,this.m_Count=0,this.m_Sum=0,this.m_WsaId=e,this.m_Value=0,this.m_Ticks=te.getTicks32(),this.m_Count=0,this.m_Sum=0}}();(0,r.l)(re,"BWsaDatapoint",null,[]);var oe=function(){return function(e,t,n,i){this.m_WsaId=0,this.m_StreamType=0,this.m_Width=0,this.m_MaxRows=0,this.m_RowCount=0,this.m_RowsOverwritten=0,this.m_Rows=null,(i<1||i>ee.defaultMaxStreamRows)&&(i=ee.defaultMaxStreamRows),this.m_WsaId=e,this.m_StreamType=t,this.m_Width=n,this.m_MaxRows=i,this.m_RowCount=0,this.m_RowsOverwritten=0,this.m_Rows={}}}();(0,r.l)(oe,"BWsaStream",null,[]);var ae=function(){function e(){}return e.maxRowCount=0,e.maxOverwritten=0,e}();(0,r.l)(ae,"StreamRowCounters",null,[]);var se=function(){function e(){}return e.isTimerResetNeeded=function(){var t=!1,n=(new Date).getTime();return(!e.lastResetTicks||n-e.lastResetTicks>6e4)&&(t=!0,e.lastResetTicks=n),t},e.lastResetTicks=0,e}();(0,r.l)(se,"TimerResetCheck",null,[]);var le=function(){return function(e){this.m_Ticks=0,this.m_Values=null,this.m_Ticks=te.getTicks32(),this.m_Values=new Array(e)}}();(0,r.l)(le,"WsaStreamRow",null,[]);var ue=function(){function e(e,t,n,i){this.m_BWsaData=null,this.m_BWsaConfig=null,this.m_Continuation=!1,this.m_LastUpload=0,this.m_TimerId=0,this.m_DataAvailableForUpload=!1,this.m_CommonDatapoints=null,this.c_request=null,this.docKey=0,this.persistentDocHash=null,this.bWsaClientInit(e,t,n,i)}return e.prototype.bWsaClientInit=function(e,t,n,i){this.m_BWsaData=new ie,this.m_BWsaConfig=new ee,this.m_Continuation=!1,this.m_LastUpload=0,this.m_TimerId=0,this.m_DataAvailableForUpload=!1,this.m_CommonDatapoints={};for(var r=0;r<this.m_BWsaConfig.defaultCommonDatapointIds.length;r++)this.m_CommonDatapoints[""+this.m_BWsaConfig.defaultCommonDatapointIds[r]]=!0;this.m_BWsaConfig.m_UploadUrl=e,this.m_BWsaConfig.m_IsOptedIn=""!==e&&t,this.m_BWsaConfig.m_SqmQoSEnabled=n&&!!i,this.m_BWsaConfig.m_QoSDataPoints=i},e.prototype.get_wsaConfig=function(){return this.m_BWsaConfig},e.prototype.get_isContinuation=function(){return this.m_Continuation},e.prototype.disableSqmQos=function(){this.m_BWsaConfig.m_SqmQoSEnabled=!1},e.prototype.initContinuationSession=function(){var e=new ie,t=this.m_CommonDatapoints;for(var n in t){var i={key:n,value:t[n]}.key,r=this.m_BWsaData.m_wsaDatapoints[i];if(r){var o=new re(parseInt(i));o.m_Value=r.m_Value,o.m_Count=r.m_Count,o.m_Sum=r.m_Sum,e.m_wsaDatapoints[i]=o,e.m_cDataPoints++}}e.m_wsaHeader.m_CorrelationId=this.m_BWsaData.m_wsaHeader.m_CorrelationId,e.m_wsaHeader.m_FlightId=this.m_BWsaData.m_wsaHeader.m_FlightId,this.m_BWsaData=e,this.m_DataAvailableForUpload=!1},e.prototype.maxSizeReachedCheck=function(){var e=12*this.m_BWsaData.m_cDataPoints+this.m_BWsaData.m_cbStreams;return e>=this.m_BWsaConfig.m_MaxDataSize&&(this.uploadWsaData(),(e=12*this.m_BWsaData.m_cDataPoints+this.m_BWsaData.m_cbStreams)>=this.m_BWsaConfig.m_MaxDataSize)},e.prototype.setInitialDatapoints=function(t){try{if(this.m_DataAvailableForUpload||this.m_CommonDatapoints[""+t])return;this.m_DataAvailableForUpload=!0,this.addCommonDataPointInternal(7982,e.getBrowserInfo()),this.addCommonDataPointInternal(8049,e.getOsInfo()),this.addCommonDataPointInternal(8814,3),this.addCommonDataPointInternal(9411,e.getScreenResolution()),this.addCommonDataPointInternal(9412,e.getDeviceType())}catch(e){e.message}},e.prototype.isQoSDataPoint=function(e){if(this.m_BWsaConfig.m_IsOptedIn)return!0;if(!this.m_BWsaConfig.m_SqmQoSEnabled)return!1;var t=this.m_BWsaConfig.m_QoSDataPoints;for(var n in t){if({key:n,value:t[n]}.value===e)return!0}return!1},e.prototype.setDw=function(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(e<1||e>this.m_BWsaConfig.m_MaxSqmId)return;if(t<0||t>ee.defaultMaxInt32)return void this.setDw(8763,e);if(this.maxSizeReachedCheck())return;this.setInitialDatapoints(e),this.resetTimer();var n=this.m_BWsaData.m_wsaDatapoints[""+e];n||(n=new re(e),this.m_BWsaData.m_wsaDatapoints[""+e]=n,this.m_BWsaData.m_cDataPoints++),n.m_Value=t,n.m_Count++,n.m_Sum=t+n.m_Sum}catch(e){}},e.prototype.setBool=function(e,t){t&&(t=1),this.setDw(e,t)},e.prototype.setBitsOrAnd=function(e,t,n){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(t<0||t>ee.defaultMaxInt32||n<0||n>ee.defaultMaxInt32)return void this.setDw(8763,e);var i=this.m_BWsaData.m_wsaDatapoints[""+e];i?(this.resetTimer(),i.m_Value&=n,i.m_Value|=t,i.m_Count++):this.setDw(e,t)}catch(e){}},e.prototype.setBitsOr=function(e,t){this.setBitsOrAnd(e,t,4294967295)},e.prototype.setBitsAnd=function(e,t){this.setBitsOrAnd(e,0,t)},e.prototype.setIfMax=function(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;var n=this.m_BWsaData.m_wsaDatapoints[""+e];!n||n.m_Value<t?this.setDw(e,t):this.resetTimer()}catch(e){}},e.prototype.setIfMin=function(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;var n=this.m_BWsaData.m_wsaDatapoints[""+e];!n||n.m_Value>t?this.setDw(e,t):this.resetTimer()}catch(e){}},e.prototype.incrementDw=function(e,t){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(!t)return void this.resetTimer();var n=0,i=this.m_BWsaData.m_wsaDatapoints[""+e];i&&(n=i.m_Value),this.setDw(e,n+t)}catch(e){}},e.prototype.addToAverage=function(e,t,n){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;this.setDw(e,t);var i=this.m_BWsaData.m_wsaDatapoints[""+e];i&&(n>1&&(i.m_Count+=n-1),i.m_Value=Math.floor(i.m_Sum/i.m_Count))}catch(e){}},e.prototype.createStream=function(e,t,n,i){try{if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(e<1||e>this.m_BWsaConfig.m_MaxSqmId)return;if(1!==t&&2!==t)return;if(n<1||n>this.m_BWsaConfig.m_MaxStreamWidth)return;if(this.maxSizeReachedCheck())return;if((i<1||i>this.m_BWsaConfig.m_MaxStreamRows)&&(i=this.m_BWsaConfig.m_MaxStreamRows),!this.m_BWsaData.m_wsaStreams[""+e]){var r=new oe(e,t,n,i);this.m_BWsaData.m_wsaStreams[""+e]=r,this.m_BWsaData.m_cStreams++,this.m_BWsaData.m_cbStreams+=12}}catch(e){}},e.prototype.createStreamUnobfuscated=function(e,t,n,i){this.createStream(e,t,n,i)},e.prototype.removeOldestStreamRow=function(e){delete e.m_Rows[""+e.m_RowsOverwritten],this.m_BWsaData.m_cbStreams-=4*(e.m_Width+1),e.m_RowCount--,e.m_RowsOverwritten++,e.m_RowsOverwritten>ae.maxOverwritten&&(ae.maxOverwritten=e.m_RowsOverwritten,this.setDw(7994,e.m_RowsOverwritten),this.setDw(8047,e.m_WsaId))},e.prototype.addToStreamDw=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(t.length)try{for(var i=new le(t.length),r=0;r<t.length;r++)i.m_Values[r]=t[r];this.addToStreamInternal(e,i)}catch(e){}},e.prototype.addToStreamDwUnobfuscated=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];this.addToStreamDw.apply(this,[e].concat(t))},e.prototype.addToStreamInternal=function(e,t){if((this.m_BWsaConfig.m_IsOptedIn||this.m_BWsaConfig.m_SqmQoSEnabled)&&!(e<1||e>this.m_BWsaConfig.m_MaxSqmId||this.maxSizeReachedCheck())){this.setInitialDatapoints(e);for(var n=0;n<t.m_Values.length;n++){var i=t.m_Values[n];if(i<0||i>ee.defaultMaxInt32)return void this.setDw(8763,e)}var r=this.m_BWsaData.m_wsaStreams[""+e];if(r){if(this.resetTimer(),r.m_Width!==t.m_Values.length)return;if(r.m_RowCount>=r.m_MaxRows&&2===r.m_StreamType&&this.removeOldestStreamRow(r),r.m_RowCount<r.m_MaxRows){var o=r.m_RowCount+r.m_RowsOverwritten;r.m_Rows[""+o]=t,r.m_RowCount++,this.m_BWsaData.m_cbStreams+=4*(r.m_Width+1),r.m_RowCount>ae.maxRowCount&&(ae.maxRowCount=r.m_RowCount,this.setDw(7993,r.m_RowCount),this.setDw(8048,r.m_WsaId))}else r.m_RowsOverwritten++,r.m_RowsOverwritten>ae.maxOverwritten&&(ae.maxOverwritten=r.m_RowsOverwritten,this.setDw(7994,r.m_RowsOverwritten),this.setDw(8047,r.m_WsaId))}}},e.prototype.terminate=function(){this.uploadWsaData()},e.prototype.uploadWsaData=function(){try{if(this.clearTimer(),!this.m_BWsaData||!this.m_BWsaConfig)return;if(!this.m_BWsaConfig.m_IsOptedIn&&!this.m_BWsaConfig.m_SqmQoSEnabled)return;if(""===this.m_BWsaConfig.m_UploadUrl)return void(this.m_BWsaConfig.m_IsOptedIn=!1);var e=te.getTicks32();if(this.m_LastUpload>0&&e<=this.m_LastUpload+this.m_BWsaConfig.m_MinTimeBetweenUploads)return;this.m_LastUpload=e;var t=new Array(0),n=this.m_BWsaData.m_wsaStreams;for(var i in n){var r={key:i,value:n[i]};r.value.m_RowCount||(t[t.length]=r.key)}for(var o=0;o<t.length;o++)delete this.m_BWsaData.m_wsaStreams[t[o]],this.m_BWsaData.m_cStreams--,this.m_BWsaData.m_cbStreams-=12;if(this.m_DataAvailableForUpload){this.m_Continuation?this.setDw(60,1):(this.setDw(60,0),this.m_Continuation=!0),this.writeDocIdStream(),this.m_BWsaData.m_wsaHeader.m_EndTime=te.getTicks64();var a=this.serialize(this.m_BWsaData,this.m_BWsaConfig);this.initContinuationSession(),a&&a.length>0&&this.uploadWsaDataRequest(a)}}catch(e){}},e.prototype.uploadWsaDataRequest=function(e){if(this.c_request||(this.c_request=new XMLHttpRequest),!this.c_request.readyState||4===this.c_request.readyState){var t=!0;Sys.Browser.agent===Sys.Browser.InternetExplorer&&Sys.Browser.version>=10&&(t=!1),this.c_request.open("POST",this.m_BWsaConfig.m_UploadUrl,t),this.c_request.setRequestHeader("Content-Type","application/json"),this.c_request.send(e)}},e.prototype.escape=function(e){return e.replace(new RegExp("[\\\\]","g"),"\\\\").replace(new RegExp('[\\"]',"g"),'\\\\\\"').replace(new RegExp("[\\/]","g"),"\\\\/").replace(new RegExp("[\\b]","g"),"\\\\b").replace(new RegExp("[\\f]","g"),"\\\\f").replace(new RegExp("[\\n]","g"),"\\\\n").replace(new RegExp("[\\r]","g"),"\\\\r").replace(new RegExp("[\\t]","g"),"\\\\t")},e.prototype.serialize=function(e,t){var n=new Sys.StringBuilder,i=!0,r=!1,o=0;t.m_IsOptedIn&&(o=16),t.m_SqmQoSEnabled&&(o|=32),n.append("{"),n.append('"StartTime":'+e.m_wsaHeader.m_StartTime+","),n.append('"EndTime":'+e.m_wsaHeader.m_EndTime+","),n.append('"Flags":'+o+","),e.m_wsaHeader.m_CorrelationId&&n.append('"CorrelationId":"'+e.m_wsaHeader.m_CorrelationId+'",'),e.m_wsaHeader.m_FlightId&&n.append('"FlightId":"'+e.m_wsaHeader.m_FlightId+'",'),n.append('"wsaDatapoints":[');var a=e.m_wsaDatapoints;for(var s in a){var l={key:s,value:a[s]}.value;this.isQoSDataPoint(l.m_WsaId)&&(r=!0,i||n.append(","),n.append('{"Id":'+l.m_WsaId+","),n.append('"Val":'+l.m_Value+","),n.append('"Tic":'+l.m_Ticks+"}"),i=!1)}n.append('],"wsaStreams":['),i=!0;var u=e.m_wsaStreams;for(var c in u){var p={key:c,value:u[c]}.value;if(this.isQoSDataPoint(p.m_WsaId)){r=!0;var d=!0;i||n.append(","),n.append('{"Id":'+p.m_WsaId+","),n.append('"Width":'+p.m_Width+","),n.append('"Rows":[');var h=p.m_Rows;for(var g in h){var m={key:g,value:h[g]}.value;d||n.append(","),n.append('{"Tic":'+m.m_Ticks+","),n.append('"Vals":[');for(var _=0;_<m.m_Values.length;_++)_>0&&n.append(","),n.append(""+m.m_Values[_]);n.append("]}"),d=!1}n.append("]}"),i=!1}}return n.append("]}"),r?n.toString():null},e.prototype.isUserOptedIn=function(){return this.m_BWsaConfig.m_IsOptedIn},e.prototype.disable=function(){try{this.clearTimer(),this.m_BWsaConfig.m_IsOptedIn=!1}catch(e){}},e.prototype.addCommonDataPointInternal=function(e,t){if(!this.m_BWsaData.m_wsaDatapoints[""+e]){var n=new re(e);n.m_Value=t,this.m_BWsaData.m_wsaDatapoints[""+e]=n,this.m_BWsaData.m_cDataPoints++}},e.prototype.clearTimer=function(){this.m_TimerId&&(window.clearTimeout(this.m_TimerId),this.m_TimerId=0)},e.prototype.resetTimer=function(){se.isTimerResetNeeded()&&(this.clearTimer(),this.m_TimerId=window.setTimeout(r.i(this,this.bWsaOnTimer,"bWsaOnTimer"),this.m_BWsaConfig.m_MaxSessionMs))},e.prototype.bWsaOnTimer=function(){this.m_TimerId=0,this.clearTimer(),this.uploadWsaData(),this.resetTimer()},e.prototype.addCommonDatapoint=function(e){this.m_CommonDatapoints[""+e]=!0},e.prototype.registerPersistentDocId=function(e){return!(!e||4!==e.length||!(e[0]||e[1]||e[2]||e[3]))&&(this.docKey=1,this.persistentDocHash=e,!0)},e.prototype.getActiveDocKey=function(){return this.docKey},e.prototype.writeDocIdStream=function(){return!(!this.docKey||!this.persistentDocHash)&&(this.createStream(9797,1,5,1),this.addToStreamDw(9797,this.docKey,this.persistentDocHash[0],this.persistentDocHash[1],this.persistentDocHash[2],this.persistentDocHash[3]),this.setDw(10273,this.persistentDocHash[0]),!0)},e.prototype.getStreamById=function(e){return this.m_BWsaData.m_wsaStreams[e.toString()]},e.prototype.getRowsById=function(e,t){if(!e)return null;var n=new Array(0),i=0,r=e.m_Rows;for(var o in r){var a={key:o,value:r[o]}.value;a.m_Values.length>0&&a.m_Values[0]===t&&(n[i++]=a)}return n},e.prototype.updateStartTime=function(e){e&&(this.m_BWsaData.m_wsaHeader.m_StartTime=e)},e.prototype.setCorrelationId=function(e){this.m_BWsaData.m_wsaHeader.m_CorrelationId=e},e.prototype.setFlightId=function(e){this.m_BWsaData.m_wsaHeader.m_FlightId=e},e.getBrowserInfo=function(){var t=0,n=window.navigator.userAgent,i=-1;if((i=n.indexOf(" MSIE "))>-1?(i+=6,t=2<<24):n.indexOf(" Trident/")>-1&&(i=n.indexOf(" rv:"))>-1?(i+=4,t=2<<24):(i=n.indexOf(" Edge/"))>-1?(i+=6,t=2<<24):(i=n.indexOf(" Firefox/"))>-1?(i+=9,t=3<<24):(i=n.indexOf(" Chrome/"))>-1?(i+=8,t=6<<24):(i=n.indexOf(" Safari/"))>-1&&(i=n.indexOf(" Version/"))>-1?(i+=9,t=4<<24):(i=n.indexOf("Opera/"))>-1?(i+=6,t=5<<24):(t=1<<24,i=-1),i>=0){var r=e.getVersionFromString(n.substr(i));Sys.Browser.agent===Sys.Browser.InternetExplorer&&7===r[0]&&n.indexOf("Trident/4.0")>=0&&(r[0]=8),t|=(r[0]<<16)+r[1]}try{window.navigator.cookieEnabled?t|=2<<29:t|=3<<29}catch(e){}return t=t},e.getVersionFromString=function(t){var n=[0,0];e.isDigit(t.charAt(0))&&(n[0]=parseInt(t));for(var i=0;i<t.length;i++)if(!e.isDigit(t.charAt(i))){t=t.substr(i+1);break}return e.isDigit(t.charAt(0))&&(n[1]=parseInt(t)),(n[0]<0||n[0]>255||n[1]<0||n[1]>65535)&&(n[0]=0,n[1]=0),n},e.getOsInfo=function(){var t=0,n=1,i=window.navigator.userAgent;i.indexOf("Windows CE")>=0?n=3:i.indexOf("Windows")>=0?n=2:i.indexOf("PPC")>=0||i.indexOf("Macintosh")>=0?n=4:i.indexOf("iPhone;")>=0||i.indexOf("iPad;")>=0||i.indexOf("iPod;")>=0?n=7:i.indexOf("SunOS")>=0?n=5:i.indexOf("Linux")>=0&&(n=6),t=n<<24;var r="Windows NT ";7===n&&(r=" OS ");var o=i.indexOf(r);if(o<0&&(r="Mac OS X ",o=i.indexOf(r)),o>=0){var a=e.getVersionFromString(i.substr(o+r.length));t+=(a[0]<<16)+a[1]}var s=0;try{var l=window.navigator.platform;-1!==i.indexOf("WOW64")?s=2:"Win64"===l?s=3:"Win32"!==l&&"Linux i686"!==l||(s=1)}catch(e){}return t|=s<<29},e.getScreenResolution=function(){var e=65535&window.screen.width;return((65535&window.screen.height)<<16)+e},e.getDeviceType=function(){var e=window.navigator.userAgent,t=0;return e.indexOf("iPhone;")>=0?t=1:e.indexOf("iPad;")>=0?t=2:e.indexOf("iPod;")>=0&&(t=3),t},e.isNullOrUndefined=function(e){return null===e||"undefined"==typeof e},e.isDigit=function(e){return e>="0"&&e<="9"},e.getSQMLocationFromCUICommandInfo=function(e){var t=0;if(e){var n=e.RootType;if("Ribbon"===n){var i=e.RootLocation;"LowerRibbon"===i?t=2:"UpperRibbon"===i&&(t=1)}else"QAT"===n?t=3:"Jewel"===n?t=4:"ContextMenu"===n&&(t=19)}return t},e.calcActionId=function(e){for(var t=5381,n=t,i=e.length,r=0;r<i&&(t=4294967295&((t<<5)+t^e.charCodeAt(r)),r!==i-1);r+=2)n=4294967295&((n<<5)+n^e.charCodeAt(r+1));var o=t+35685*n+(23896*n<<16)&4294967295;return o<0&&(o+=4294967296),o},e}();(0,r.l)(ue,"BWsaClient",null,[j]);var ce=n(867),pe=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.uploadUrl=null,o.$$pf_IsSynchronous=!1,o.$$pf_TaskItemPriority=0,o.uploadUrl=t,o.set_taskItemPriority(3),o.get_wsaConfig().m_MaxSessionMs=864e5,o}return(0,Q.t)(t,e),t.prototype.get_uploadUrl=function(){return this.uploadUrl},t.prototype.get_isSynchronous=function(){return this.$$pf_IsSynchronous},t.prototype.set_isSynchronous=function(e){return this.$$pf_IsSynchronous=e,e},t.prototype.get_taskItemPriority=function(){return this.$$pf_TaskItemPriority},t.prototype.set_taskItemPriority=function(e){return this.$$pf_TaskItemPriority=e,e},t.prototype.uploadWsaDataRequest=function(e){if(n(254).AFrameworkApplication.theClientRequestManager){var t=n(254).AFrameworkApplication.appSettingsManager.get_appSettings().SessionStartInfoJson||"";if(n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BSqmAddFlightsToSessionStartInfoJsonIfMissing")&&(!n(254).AFrameworkApplication.sessionStartInfoSettings.Flights||""===n(254).AFrameworkApplication.sessionStartInfoSettings.Flights)&&n(254).AFrameworkApplication.flightId&&""!==n(254).AFrameworkApplication.flightId)try{n(254).AFrameworkApplication.sessionStartInfoSettings.Flights=n(254).AFrameworkApplication.flightId.split(";"),t=ce.w(n(254).AFrameworkApplication.sessionStartInfoSettings)}catch(e){c.ULS.sendTraceTag(595083586,201,10,"Failed to updated SessionStartInfo settings with FlightId: {0}",e)}var r="";if(n(254).AFrameworkApplication.dataPlumber){var o=n(254).AFrameworkApplication.get_activeFrame()?n(254).AFrameworkApplication.get_activeFrame().get_mode():0;n(254).AFrameworkApplication.dataPlumber.FrameMode=i[o],r=ce.w(n(254).AFrameworkApplication.dataPlumber)}var a=n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SendWsaHeadersInBody"),s="",l={};if(a){var u=void 0;if((u=e&&e.length>0?new Sys.StringBuilder(e.slice(0,-1)+","):new Sys.StringBuilder("{")).append('"SessionStartInfo":"'+I.l.encodeString(t,I.l.jsonEscapedCharacters)+'"'),u.append(',"DataPlumber":"'+I.l.encodeString(r,I.l.jsonEscapedCharacters)+'"'),u.append("}"),s=u.toString(),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SendBeaconOnShuttingDownRequestsEnabled")||n(254).AFrameworkApplication.isShuttingDownFromPostMessage)return void n(254).AFrameworkApplication.theClientRequestManager.sendShuttingDownRequest(this.get_uploadUrl(),s)}else l["X-SessionStartInfo-Json"]=t,l["X-DataPlumber-Json"]=r;n(254).AFrameworkApplication.theClientRequestManager.addRequest(this.get_uploadUrl(),2,a?s:e,l,!1,this.get_taskItemPriority(),(function(e){}),(function(e){}),null,null,this.get_isSynchronous(),void 0,void 0,"13",void 0,void 0,void 0,!0)}},t}(ue);(0,r.l)(pe,"MsoBWsaClientBase",ue,[G,j,Z]);var de=function(e){function t(t,n,i,r){return e.call(this,t,n,i,r)||this}return(0,Q.t)(t,e),t}(pe);(0,r.l)(de,"MsoBWsaClient",pe,[]);var he=function(){return function(){this.negativeSign=null,this.numberDecimalDigits=0,this.numberDecimalSeparator=null,this.numberGroupSeparator=null,this.numberGroupSizes=null,this.numberNegativePattern=0,this.percentDecimalDigits=0,this.percentDecimalSeparator=null,this.percentGroupSeparator=null,this.percentGroupSizes=null,this.percentNegativePattern=0,this.percentPositivePattern=0,this.percentSymbol=null}}();(0,r.l)(he,"NumberFormatInfo",null,[]);var ge=n(425),me=n(564),_e=n(219),fe=n(266),ye=n(515),ve=function(e,t,n,i,r,o){if(4===t)return e;var a,s=i,l=".js"+o,u=e+l;switch(t){case 0:s+=(a=n,String.format(a,"")+u);break;case 1:s+=n+u;break;case 2:s+=String.format("{0}{1}{2}",e,".min",l);break;case 3:s+=String.format("{0}\\{1}",r,u);break;case 5:var c=o;e.indexOf("?")>=0&&(c=o.replace("?","&")),s+=String.format("{0}{1}",e,c)}return s},Se=n(620),Ce=n(527),be=function(){function e(e,t){var n=this;this.sessionData=null,this.startInfoDataFields=null,this.serverStartTime=null,this.sessionFinishedDataPlumber=null,this.sessionStartNameSpace="Office.Online.SessionStart",this.sessionEndNameSpace="Office.Online.SessionEnd",this.automationMetadataNameSpace="Office.Online.AutomationMetadata",this.startTimeOnClient=new Date,u.k(38844105,200,100,"SSED:Entered SessionStartEndData"),this.sessionFinishedDataPlumber=t,ce.t(Object,e,(0,m.m)((function(){return n.sessionData}),(function(e){return n.sessionData=e})))?(this.fixUpLoggingDataIfNeeded(),this.initMiscStartData()):c.ULS.sendTraceTag(38844106,201,10,"SSED:Unable to deserialize SessionStartInfoJson"),this.sessionData&&"StartTimeUtc"in this.sessionData&&(this.serverStartTime=new Date(this.sessionData.StartTimeUtc))}return e.prototype.logSessionStartData=function(){this.sessionData&&S.j.isEnabledLogSessionStartAndEndDataFromClientToOTel(this.sessionData.Application)&&this.logStartSession(this.sessionStartNameSpace)},e.prototype.logSessionEndData=function(){this.sessionData&&S.j.isEnabledLogSessionStartAndEndDataFromClientToOTel(this.sessionData.Application)&&(this.initMiscEndData(),this.logEndSession(this.sessionEndNameSpace))},e.prototype.logAutomationMetadata=function(){S.j.isEnabledLogSessionStartAndEndDataFromClientToOTel(this.sessionData.Application)&&this.sessionData&&this.doLogAutomationMetadata(this.automationMetadataNameSpace)},e.prototype.initMiscStartData=function(){this.fixUpLoggingDataIfNeeded(),this.sessionData.ClientVersion=this.sessionFinishedDataPlumber.ApplicationVersion},e.prototype.initDataFromPlumber=function(e){this.sessionData.FrameMode=e.FrameMode,this.sessionData.Feedback=e.Feedback,this.sessionData.IsCoauthSession=e.IsCoauthSession,this.sessionData.IsRealEdit=e.IsRealEdit,this.sessionData.PrivacyNotice=e.PrivacyNotice,this.sessionData.RenavigationReason=e.RenavigationReason,this.sessionData.CookieComplianceBanner=e.CookieComplianceBanner},e.prototype.computeSessionEndTime=function(e){if(!e)return u.k(38844107,200,10,"endTimeOnClient was null"),null;var t=null;if(this.serverStartTime){var n=e.getTime()-this.startTimeOnClient.getTime();t=new Date(n+this.serverStartTime.getTime()),this.sessionData.SessionDurationMs=n}else u.k(38844108,200,10,"serverStartTime on client was null");return t},e.prototype.fixUpLoggingDataIfNeeded=function(){"Application"in this.sessionData&&("Excel"===this.sessionData.Application&&this.fixUpModeForExcel())},e.prototype.fixUpModeForExcel=function(){if("Excel"===this.sessionData.Application&&"ApplicationModeExtended"in this.sessionData){var e=this.sessionData.ApplicationModeExtended.toUpperCase();"VIEW"===e||"UNIFIED"===e?this.sessionData.ApplicationModeExtended="EDIT":"EDIT"!==e&&"UNIFIED"!==e||(this.sessionData.ApplicationModeExtended="VIEW")}},e.prototype.initMiscEndData=function(){this.initDataFromPlumber(this.sessionFinishedDataPlumber);var e=this.computeSessionEndTime(new Date);e&&(this.sessionData.EndTime=e.toString())},e.prototype.getDataField=function(e,t,n){if(!e||!t)return null;var i=null;switch(n){case 1:i=(0,s.m)(new A.b,{name:t,bool:Boolean.parse(e.toString())});break;case 0:var r=parseInt(e);isNaN(r)||(i=(0,s.m)(new A.b,{name:t,int64:r}));break;case 2:r=parseFloat(e);isNaN(r)||(i=(0,s.m)(new A.b,{name:t,double:r}));break;case 3:i=(0,s.m)(new A.b,{name:t,string:e});break;case 4:var o=Date.parse(e);isNaN(o)||(i=(0,s.m)(new A.b,{name:t,date:new Date(o).getTime()}))}return i},e.prototype.logStartSession=function(e){if(this.startInfoDataFields=new Array(0),this.addDataIfAvailable("AccessTokenLength","AccessTokenLength",0,this.startInfoDataFields),this.addDataIfAvailable("AccessTokenTtl","AccessTokenTtl",3,this.startInfoDataFields),this.addDataIfAvailable("AllowEarlyFeatures","AllowEarlyFeatures",3,this.startInfoDataFields),this.addDataIfAvailable("ApplicationLCID","ApplicationLcid",3,this.startInfoDataFields),this.addDataIfAvailable("ARRVersion","ArrVersion",3,this.startInfoDataFields),this.addDataIfAvailable("BrowserLCID","BrowserLcid",3,this.startInfoDataFields),this.addDataIfAvailable("CacheId","CacheId",3,this.startInfoDataFields),this.addDataIfAvailable("ClientVersion","ClientVersion",3,this.startInfoDataFields),this.addDataIfAvailable("CookieComplianceBanner","CookieComplianceBanner",0,this.startInfoDataFields),this.addDataIfAvailable("CookieConsentRequired","CookieConsentRequired",1,this.startInfoDataFields),this.addDataIfAvailable("DeviceName","DeviceName",3,this.startInfoDataFields),this.addDataIfAvailable("EdgeEnvironmentName","EdgeEnvironmentName",3,this.startInfoDataFields),this.addDataIfAvailable("EdgeEventId","EdgeEventId",3,this.startInfoDataFields),this.addDataIfAvailable("EdgeFeatures","EdgeFeatures",3,this.startInfoDataFields),this.addDataIfAvailable("FileExtension","FileExtension",3,this.startInfoDataFields),this.addDataIfAvailable("FileSizeBytes","FileSizeBytes",0,this.startInfoDataFields),this.addDataIfAvailable("HostDatacenterHint","HostDatacenterHint",3,this.startInfoDataFields),this.addDataIfAvailable("HostSessionId","HostSessionId",3,this.startInfoDataFields),this.addDataIfAvailable("LocationCity","LocationCity",3,this.startInfoDataFields),this.addDataIfAvailable("LocationCountry","LocationCountry",3,this.startInfoDataFields),this.addDataIfAvailable("LocationState","LocationState",3,this.startInfoDataFields),this.addDataIfAvailable("PLT","Plt",3,this.startInfoDataFields),this.addDataIfAvailable("PreviousSession","PreviousSession",3,this.startInfoDataFields),this.addDataIfAvailable("RoutedVia","RoutedVia",3,this.startInfoDataFields),this.addDataIfAvailable("SessionOrigin","SessionOrigin",3,this.startInfoDataFields),this.addDataIfAvailable("StartTimeUtc","StartTime",4,this.startInfoDataFields),this.addDataIfAvailable("UserAgent","UserAgent",3,this.startInfoDataFields),this.addDataIfAvailable("WfeVersion","WfeVersion",3,this.startInfoDataFields),C.k.sendTelemetryEvent((0,s.m)(new Ce.y,{name:e,dataFields:this.startInfoDataFields})),S.j.isUserActionLoggingToOtelEnabled(this.sessionData.Application)){var t=p.GV;"ApplicationModeExtended"in this.sessionData&&this.sessionData.ApplicationModeExtended&&this.sessionData.ApplicationModeExtended.toLowerCase().indexOf("new")>=0&&(t=p.WV),v.b(t)}c.ULS.sendTraceTag(39089113,306,50,"SSED:startsession info sent to Otel")},e.prototype.logEndSession=function(e){var t=new Array(0);Array.addRange(t,this.startInfoDataFields),this.addDataIfAvailable("EndTime","EndTime",4,t),this.addDataIfAvailable("Feedback","Feedback",0,t),this.addDataIfAvailable("FrameMode","FrameMode",3,t),this.addDataIfAvailable("IsCoauthSession","IsCoauthSession",1,t),this.addDataIfAvailable("IsRealEdit","IsRealEdit",1,t),this.addDataIfAvailable("PrivacyNotice","PrivacyNotice",0,t),this.addDataIfAvailable("RenavigationReason","RenavigationReason",3,t),this.addDataIfAvailable("SessionDurationMs","SessionDurationMs",0,t),C.k.sendTelemetryEvent((0,s.m)(new Ce.y,{name:e,dataFields:t})),S.j.isUserActionLoggingToOtelEnabled(this.sessionData.Application)&&"IsRealEdit"in this.sessionData&&this.sessionData.IsRealEdit&&this.sessionData.IsRealEdit&&v.b(p.kY),c.ULS.sendTraceTag(39089114,306,50,"SSED:endsession info sent to Otel")},e.prototype.doLogAutomationMetadata=function(e){var t,n=new Array(0);ce.t(Object,this.sessionData.OfficeAutomationMetadata.toString(),(0,m.m)((function(){return t}),(function(e){return t=e})))?(this.addAutomationItemIfAvailable("JobId","JobId",3,n,t),this.addAutomationItemIfAvailable("JobClassification","JobClassificationId",3,n,t),this.addAutomationItemIfAvailable("TaskId","TaskId",3,n,t),this.addAutomationItemIfAvailable("TaskExecutionId","TaskExecutionId",3,n,t),this.addAutomationItemIfAvailable("ExecutionNumber","ExecutionNumber",3,n,t),this.addAutomationItemIfAvailable("JobProperties","JobProperties",3,n,t),this.addAutomationItemIfAvailable("ScenarioId","TestId",3,n,t),this.addAutomationItemIfAvailable("ConfigName","ConfigName",3,n,t),C.k.sendTelemetryEvent((0,s.m)(new Ce.y,{name:e,dataFields:n})),c.ULS.sendTraceTag(41302225,306,50,"SSED:automation metadata sent to Otel")):c.ULS.sendTraceTag(41302224,201,10,"SSED:Unable to deserialize OfficeAutomationMetadata")},e.prototype.addAutomationItemIfAvailable=function(e,t,n,i,r){var o=this.getDataField(r[e],t,n);o&&Array.add(i,o)},e.prototype.addDataIfAvailable=function(e,t,n,i){if(e in this.sessionData&&this.sessionData[e]){var r=this.getDataField(this.sessionData[e],t,n);r&&Array.add(i,r)}},e}();(0,r.l)(be,"SessionStartEndData",null,[]);var Ae=n(478),Te=n(810),we=n(162),Ie=function(){function e(){}return e.get_openInAppDialogHtmlTemplate=function(){return e.dialogHtmlFormat},e.dialogHtmlFormat="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='WACDialogLabel' >{1}</label> <br/> <br/> <label id='InfoMessageAreaLine2' class='WACDialogLabel' >{2}</label> </div> <br/> <div class='WACDialogRow' id='LinkToInstall'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block;' role='img'> <img id='BottomIconInfo' class='{4}' role='presentation' src={3} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:8px; vertical-align:top;'> <a id='Link' class='AppstoreLink' href={6} target='_blank' style='text-decoration: none;color: #217346;'>{5}</a> </div> </div> </div>",e}();(0,r.l)(Ie,"OpenInAppDialogHtml",null,[]);var Ee=n(92),ke=function(){function e(){}return e.prototype.initializeAndShowDialog=function(){var e=new Ee.o,t=n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting("Application");e.set_dialogHtml(Ee.o.formatHtml(Ie.get_openInAppDialogHtmlTemplate(),CommonUIStrings.l_OpenInMobileAppHeader,CommonUIStrings.l_OpenInMobileDialogText_1,String.format(CommonUIStrings.l_OpenInMobileDialogText_2,t),n(254).AFrameworkApplication.get_imageClusterPath(),n(973).getImageClass(n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting("AppIcon")),String.format(CommonUIStrings.l_OpenInMobileAppStoreDisplayText,t),this.getStoreURL())),e.set_dialogId("OpenInAppDialog"),e.set_buttonsOption(5),e.initializeAndShow("",null,null)},e.prototype.getStoreURL=function(){if(1!==n(254).AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType())return"";var e=n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting("AppUrl");return ge.y.get_isIPhone()?(e="itms-apps://"+n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting("WildFireUrlExceliOS"),c.ULS.sendTraceTag(595079325,306,50,"Opened Edit dialog in iOS phone")):ge.y.get_isAndroid()?ge.y.get_isLocaleChina()?(e=n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting("WildFireUrlChinaStoreAndroid"),c.ULS.sendTraceTag(595079324,207,50,"Opened Edit dialog in Android phone in China Locale")):ge.y.get_androidVersion().get_majorVersion()>4&&(e=n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting("WildFireUrlExcelAndroid"),c.ULS.sendTraceTag(595079323,207,50,"Opened Edit dialog in Android phone")):c.ULS.sendTraceTag(595079322,207,50,"Opened Edit dialog from non iOS and Android phone"),e},e}();(0,r.l)(ke,"OpenInAppDialog",null,[]);var De=n(841),Me=n(876),Pe=n(728),Fe=n(344),xe=n(101),Re=n(684),Be=n(132),Le=n(851),Ne=n(154),Ue=n(723),Oe=n(798),He=n(195),We=n(250),Ve=n(355),$e=n(902),Ke=n(235),ze=n(984),qe=n(796),Qe=n(273),Ge=n(134),je=n(743),Ze=n(299),Xe=n(586);n.d(t,{AFrameworkApplication:function(){return Je}});var Je=function(){function e(t,n){void 0===n&&(n=!0),this.isFocusManagerBugFixEnabled=!1,this.isHttp2Enabled=!1,e._instance=this}return e.prototype.updateOpenInClientDocumentUrl=function(e){return null},e.prototype.get_irmPolicyTitle=function(){return e._irmPolicyTitle},e.prototype.get_irmPolicyDescription=function(){return e._irmPolicyDescription},e.prototype.bodyID=function(){return"MainApp"},e.prototype.get_isActivityTaskPaneWithNewInfrastructureEnabled=function(){return!1},e.prototype.get_isRibbonFlexBoxLayoutEnabled=function(){return!1},e.prototype.get_isSimplifiedReactRibbonUxEnabled=function(){return!1},e.prototype.get_isReactMultilineRibbonEnabled=function(){return!1},e.prototype.get_shouldRenderReactMultilineRibbon=function(){return!1},e.prototype.get_isReactSharedHeaderUxEnabled=function(){return!1},e.prototype.get_isReactSharedHeaderDelayLoadingEnabled=function(){return!1},e.prototype.get_isSharedHeaderSearchUxEnabled=function(){return!1},e.prototype.get_isSharedHeaderVersionHistoryEnabled=function(){return!1},e.prototype.get_isSharedHeaderThemingEnabled=function(){return!1},e.prototype.get_isReactFileMenuUxEnabled=function(){return!1},e.prototype.get_isReactRibbonTabRefreshEnabled=function(){return!1},e.prototype.get_isReactFloatieEnabled=function(){return!1},e.prototype.get_isReactTabbedTaskPaneInfrastructureEnabled=function(){return!1},e.prototype.get_isTaskPaneResizingEnabled=function(){return!1},e.prototype.get_isFirstPartyTaskPaneResizeEnabled=function(){return!1},e.prototype.get_isReactDialogEnabled=function(){return!1},e.prototype.get_isReactAccCheckerPaneEnabled=function(){return!1},e.prototype.get_isReactNotificationsEnabled=function(){return!1},e.prototype.get_isReactSmartLookupTaskPaneEnabled=function(){return!1},e.prototype.get_isRegionComposerEnabled=function(){return!1},e.prototype.get_isExperimentalBundleEnabled=function(){return!1},e.prototype.get_isRibbonVisualRefreshEnabled=function(){return!1},e.prototype.get_isChangesButtonEnabled=function(){return!1},e.prototype.get_isTellMeServiceEdogEndpointOverrideEnabled=function(){return!1},e.prototype.get_isTellMeServiceProdEndpointOverrideEnabled=function(){return!1},e.prototype.get_isTellMeServiceResultsForSearchEnabled=function(){return!1},e.prototype.get_isFindInDocumentWithMatchesEnabled=function(){return!1},e.prototype.get_shouldFetchTokensForSearch=function(){return!1},e.prototype.get_shouldShowEntitySearchResults=function(){return!1},e.prototype.get_shouldShowAnswerAndDefinitionSearchResults=function(){return!1},e.prototype.get_shouldPrefetchAuthTokensForSearch=function(){return!1},e.prototype.get_shouldFindInDocWithMatchesOpenSerplet=function(){return!1},e.prototype.get_shouldHelpShowNumberOfMatches=function(){return!1},e.prototype.get_shouldHelpShowTopSearchResult=function(){return!1},e.prototype.get_shouldHideChangesButtonInitially=function(){return!1},e.prototype.get_wywaNotificationTimeout=function(){return 10},e.prototype.get_isCommentsButtonInCollabCornerEnabled=function(){return!1},e.prototype.get_isSimplifiedReactRibbonUxFlightEnabled=function(){return this.get_isSimplifiedReactRibbonUxEnabled()},e.prototype.get_isSimplifiedUXOptOutInViewTabFlightEnabled=function(){return!1},e.prototype.get_isTransistionalHeaderUIEnabled=function(){return!1},e.prototype.get_officeAppType=function(){return 0},e.prototype.get_officeAppMode=function(){return 0},e.prototype.get_clientUrl=function(){return""},e.prototype.get_commandsToHostControlIdsMap=function(){return{}},e.prototype.shouldCommandBeHostControlled=function(t){if(t in this.get_commandsToHostControlIdsMap()&&e.appSettingsManager.containsAppSetting(e.hostUIControlSettingName)&&e.appSettingsManager.getStringAppSetting(e.hostUIControlSettingName))for(var n=this.get_commandsToHostControlIdsMap()[t],i=e.appSettingsManager.getListAppSetting(e.hostUIControlSettingName),r=0;r<i.length;r++){var o=i[r];if(o.id===n&&1===o.visibility)return!0}return!1},e.prototype.isEntryExistent=function(e){return!1},e.prototype.addEntryToBusinessBar=function(e,t){return!1},e.prototype.addGdprBusinessBar=function(e,t,n){},e.prototype.addGdprBusinessBarWithCloseCallback=function(e,t,n,i){this.addGdprBusinessBar(e,t,n)},e.prototype.privacyRefreshRequested=function(){e.get_activeFrame().refreshDocument(null)},e.prototype.addDatacenterDecommissionWarning=function(e){},e.prototype.saveAction=function(){return function(){}},e.prototype.get_isSyncUxFeatureEnabled=function(){return!1},e.prototype.get_newAndOpenHandlerUrlPrefix=function(){return""},e.prototype.get_isFocusManagerBugFixEnabled=function(){return this.isFocusManagerBugFixEnabled},e.prototype.getFileOpenProperties=function(){return null},e.prototype.get_catchUpFlyoutEnabled=function(){return!1},e.prototype.get_diagnosticsBuildVersion=function(){return e.buildVersion},e.prototype.get_diagnosticsSessionId=function(){return e.userSessionId},e.prototype.get_isHttp2Enabled=function(){return this.isHttp2Enabled},e.prototype.createMinimumSessionStartInfoSettingsAfterJsonException=function(e){var t={};return null!==e&&(t.Application=e.Application||"",t.WACSessionID=e.SessionId||""),t},e.prototype.initialize=function(t){var n=this;e._isUpdateFullSessionStartInfoCalled=!1,qe.m.get_instance().addMark(_e.c.appInitStart),this.isHttp2Enabled=Boolean.parse(t.StaticContentPrefetchUsingHttp2IsEnabled||"false");var i=new Date;if(e.bootTime=i.getTime(),k.r.get_instance().setAppInitializationStatus(1),e.appSettingsManager=this.createAppSettingsManager(t),e.appSettingsManager.getBooleanAppSetting("OneNoteHardBlockBrowsersEnabled")&&(M.n.get_instance().runFeatureChecks(e.appSettingsManager),!M.n.get_instance().get_areBrowserFeaturesSupported())){var o=window.navigator.userLanguage||window.navigator.browserLanguage||window.navigator.language,a=window.location.protocol+"/"+"0".replace("0","")+"/"+window.location.host+"/o/UpgradeBrowser.htm?llcc="+o;this.redirectOutside(a,F.p.unsupportedBrowserWarning)}this.initSessionStartInfoSettings(t.SessionStartInfoJson||""),this.initializeOtel(),e.appSettingsManager.getBooleanAppSetting("MSCCEnabled")&&e.requestCookieConsent(),me.o.get_instance().notifyReadyToConfigure(Ke.w.get_instance()),window.g_logMSAjaxErrorCallback=e.logMSAjaxError,e.showPageStats=Boolean.parse(t.ShowPageStats||"false"),e.collectPageStats=Boolean.parse(t.CollectPageStats||"false"),e.collectPageStats&&t.PageStats&&""!==t.PageStats&&(e.appPreloadStatistics=t.PageStats),Qe.h.get_instance().start(),d.ActionManager.actionIdResolverDelegate=r.i(this,this.resolveActionId,"resolveActionId"),d.ActionManager.contextIdResolverDelegate=r.i(this,this.resolveContextId,"resolveContextId"),H.EventHandlerManager.get_instance().setOnEventInterruptedTask(r.i(this,this.reportEventInterruptedJavascript,"reportEventInterruptedJavascript")),Me.WacAirSpace.registerDomEvents(),e.buildVersion=t.BuildVersion||"0.0.0.0",e.firstRunExperienceIsEnabled=Boolean.parse(t.FirstRunExperienceIsEnabled||"false"),e.firstRunExperienceUiVariation=parseInt(t.FirstRunExperienceUiVariation||"0"),e.lcid=parseInt(t.Lcid||"1033"),e.uiCulture=t.UICulture||"en-US",e.dataCulture=t.DataCulture||e.uiCulture,e.requestedLcid=parseInt(t.RequestedLcid||e.lcid.toString()),e.canary=t.Canary,e.hostCanary=t.HostCanary,e._isEmbedded=Boolean.parse(t.IsEmbedded||"false"),e.isUIEmbedMode=Boolean.parse(t.IsUIEmbedMode||"false"),e.isNoChrome=Boolean.parse(t.IsNoChrome||"false"),e._requiresCheckout=Boolean.parse(t.RequiresCheckout||"false"),e.useParentHelpFunction=Boolean.parse(t.UseParentHelpFunction||"false"),e.feedbackStringId=parseInt(t.CfString||"0"),e.showRtcConnectionStatus=Boolean.parse(t.ShowRtcConnectionStatus||"false"),e._sleepIntervalInMsec=1e3*parseInt(t.SleepInterval),e._trimOICButtonsIfUnavailable=Boolean.parse(t.TrimOICButtonsIfUnavailable||"false"),e.isCrossDocumentMessengerDisabled=Boolean.parse(t.CrossDocumentMessengerDisabled||"false"),e.isOpenInClientEnabled=!0,e.userSessionId=t.SessionId,e.isLoggingHostRequests=Boolean.parse(t.LogHostRequests||"false"),e.set_isRtl(Boolean.parse(t.Rtl||"false")),e.shortDateFormat=t.ShortDateFormat,e.shortTimeFormat=t.ShortTimeFormat,e.set_accessToken(t.AccessToken||""),e.userType=t.UserType||"UNKNOWN",e.tellMeIsEnabled=Boolean.parse(t.TellMeIsEnabled||"false"),e.dataPlumber.ApplicationVersion=t.BuildVersion||"0.0.0.0",e.initializeBulsProperties(t),window.g_sid=e.userSessionId,e.rtcTransportProtocol=t.RtcTransportProtocol,e.newMenuMoreTemplatesUrl=t.NewMenuMoreTemplatesUrl,e.documentIsFolder=Boolean.parse(t.DocumentIsFolder||"false"),e.appSupportsFileRename=Boolean.parse(t.AppSupportsFileRename||"false"),e.appSupportsVersionHistory=Boolean.parse(t.AppSupportsVersionHistory||"false"),e.appSupportsInsertOnlinePictureFromHost=Boolean.parse(t.AppSupportsInsertOnlinePictureFromHost||"false"),e.appSupportsInsertOnlinePictureFromSharePoint=Boolean.parse(t.AppSupportsInsertOnlinePictureFromSharePoint||"false"),e.insertOnlinePictureFromHostEnabled=Boolean.parse(t.InsertOnlinePictureFromHostEnabled||"false"),e.appSupportsMultiInsertOnlinePictureFromHost=Boolean.parse(t.AppSupportsMultiInsertOnlinePictureFromHost||"false"),this.isFocusManagerBugFixEnabled=Boolean.parse(t.FocusManagerBugFixEnabled||"false"),e.mruPollingIntervalInMs=parseInt(t.MruPollingIntervalInMs||"1200000"),e.timeUntilInactiveInMs=parseInt(t.TimeUntilInactiveInMs||"420000"),e.isCustomerFeedbackExternal=Boolean.parse(t.CfExternal||"false"),e.getMoreInfoRetryIntervalsInMs=t.GetMoreInfoRetryIntervalsInMs,e.wacCopyPasteShortcutDialogIsEnabled=Boolean.parse(t.WacCopyPasteShortcutDialogIsEnabled||"false"),e.isDogfoodEnvironment=Boolean.parse(t.IsDogfoodEnvironment||"false"),e.useO365ShellService=Boolean.parse(t.UseO365ShellService||"false");try{var s=(new Date).getTime(),l=e.appSettingsManager.getLongAppSetting("AccessTokenExpirationInMs",0);l<0&&c.ULS.sendTraceTag(19789440,201,50,l.toString()),e.set_accessTokenTtl(l?s+l:0),e.accessTokenServerExpirationTime=e.appSettingsManager.getLongAppSetting("AccessTokenTtl",0)}catch(t){e.set_accessTokenTtl(0)}try{e.accessTokenExpirationPromptSeconds=Number.parseInvariant(t.AccessTokenExpirationPromptSeconds)}catch(t){e.accessTokenExpirationPromptSeconds=0}e.roamingAppsX86RootUrl=t.RoamingAppsX86RootUrl||"",e.roamingAppsControlInstallerUrl=Le.n.addParameterValue(t.RoamingAppsControlInstallerUrl||"","clid",e.lcid.toString()),e.roamingAppsFirefoxExtensionUrl=Le.n.addParameterValue(t.RoamingAppsFirefoxExtensionUrl||"","clid",e.lcid.toString()),e.hideHeader=Boolean.parse(t.HideHeader||"false"),e.isMobileMode=Boolean.parse(t.IsMobileMode||"false"),e.hasExternalHeader=!Boolean.parse(t.HeaderInsideRibbonIsEnabled||"false"),e.forceTouchRibbon=Boolean.parse(t.ForceTouchRibbon||"false"),e.useCrossOriginStaticScripts=Boolean.parse(t.UseCrossOriginStaticScripts||"false"),Pe.k.applicationNameLong=t.WebAppLongName,Pe.k.applicationNameShort=t.WebAppShortName,document.body.id=this.bodyID(),e._splashscreenElement=document.getElementById("load_img"),e._splashscreenOverlay=document.getElementById("load_back"),e._isSplashScreenUp=!!e._splashscreenElement&&!!e._splashscreenOverlay,we.o.webToadHostName=t.WebToadHostName,e.appSettingsManager.get_isFullAppSettingsReady()&&this.updateFullAppSettings(t),this.updateMiniCheckBasedAppSettings(t),e.ensureAwake(),V.n.setEnsureAppAwakeCallback(e.ensureAwake),V.n.setEnsureAppAwakeIfAsleepCallback(e.ensureAwakeIfAsleep),e.endSessionHeaderReceivedCallback=r.i(this,this.crashApplication,"crashApplication"),e.assistanceIsEnabled="true"===t.AssistanceIsEnabled,e.assistancePaneIsEnabled="true"===t.AssistancePaneIsEnabled,e.assistanceSearchUrl=t.AssistanceSearchUrl,e.lokiEndpointForSearch=t.LokiEndpointForSearch,e.substrateEndpointForSearch=t.SubstrateEndpointForSearch,e.tellMeServiceEndpointForSearch=t.TellMeServiceEndpointForSearch,e.insightsUrl=t.InsightsUrl||"",e.smartLookupIsEnabled="true"===t.SmartLookupIsEnabled,e.insightsIsEnabled=Boolean.parse(t.InsightsIsEnabled||"false"),e.environment=e.appSettingsManager.getIntAppSetting("Environment",0),this.initSessionStartAndEndData(),B.m.initialize(),e.cursorPinningIsEnabled=Boolean.parse(t.CursorPinningIsEnabled||"true"),e.removeWacDialogKeyUpHandler=Boolean.parse(t.RemoveWacDialogKeyUpHandler||"false"),e.hostOperationHttpStatusCode=e.appSettingsManager.getIntAppSetting("HostOperationHttpStatusCode",0),e.enrichmentPaneUrl=t.EnrichmentPaneUrl||"",e.enrichmentIsEnabled=Boolean.parse(t.EnrichmentIsEnabled||"false"),e.isNewFile=Boolean.parse(t.CreateNew||"false"),e.isNewFile&&(e.newFileTemplateName=t.CreateNewTemplateName,e.newFileTemplateLcid=t.CreateNewTemplateLcid),e.hideHeaderEmbedded=Boolean.parse(t.HideHeaderEmbedded||"false"),e.hideRibbonEmbedded=Boolean.parse(t.HideRibbonEmbedded||"false"),e.wopiIdentityWhitelist=(t.WopiIdentityWhitelist||"").split(","),e.wacFrameImplicitAuthAADApplications=ce.b(t.WacFrameImplicitAuthAADApplications||"{}"),e.wacFrameImplicitAuthMSAApplications=ce.b(t.WacFrameImplicitAuthMSAApplications||"{}"),e.wacFrameImplicitAuthTestInformation=ce.b(t.WacFrameImplicitAuthTestInformation||"{}"),e.isWopiTokenRefreshEnabled=e.appSettingsManager.getBooleanAppSetting("WOPITokenRefreshIsEnabled"),e.isWopiTokenRefreshWhenSessionExpiredEnabled=e.appSettingsManager.getBooleanAppSetting("WOPITokenRefreshWhenSessionExpiredIsEnabled"),e.isWopiTokenRefreshCancelExpirationEnabled=e.appSettingsManager.getBooleanAppSetting("WOPITokenRefreshCancelExpirationIsEnabled"),e.wopiTokenLastRefreshTime=e.bootTime,e.wopiTokenExpiresAfterMinutes=e.appSettingsManager.getIntAppSetting("WOPITokenExpiresAfterMinutes",0),e.wopiTokenRefreshMaxRetryAttempts=e.appSettingsManager.getIntAppSetting("WopiTokenRefreshMaxRetryAttempts",3),e.wopiTokenRefreshRetryeInterval=e.appSettingsManager.getIntAppSetting("WopiTokenRefreshRetryeInterval",1e4),e.wopiTokenRefreshRetryIntervalForClientNetworkIssue=e.appSettingsManager.getIntAppSetting("WopiTokenRefreshRetryIntervalForClientNetworkIssue",2e3),e.wopiTokenRefreshPermanentHostErrorIdList=(t.WopiTokenRefreshPermanentHostErrorIdList||"").split(","),e.wopiTokenRefreshNetworkErrorIdList=(t.WopiTokenRefreshNetworkErrorIdList||"").split(",");var u=(t.WopiTokensToRefresh||"").split(",");switch(e.wopiTokensToRefresh=u.length>0&&""!==u[0]?u:[We.t.sessionInfo_AccessToken],e.wopiTokenTaskItemPriority=e.appSettingsManager.getIntAppSetting("WopiTokenTaskItemPriority",2),e._rootQuerySignature=e.appSettingsManager.getStringAppSetting("RootQuerySignature")||e.baseDocQuerySignatureWithoutVersion,e.appSettingsManager.getStringAppSetting("SessionExpirationPolicy")){case"NullManager":e.wopiTokenExpirationPolicy=1;break;case"RefreshToken":e.wopiTokenExpirationPolicy=2;break;default:e.wopiTokenExpirationPolicy=0}Boolean.parse(t.ShowDogfoodDecommissionWarningForHost||"false")&&this.addDatacenterDecommissionWarning("You are currently on an unsupported SPOPPE site. For a fully supported Office Online experience, we encourage all users to migrate your material to SPDF. If you observe any unexpected behavior, please contact wacfastfood."),e.subscribeToBeforeAppShutDown((function(e,t){n.shutdownOtel()}))},e.prototype.redirectOutside=function(t,n){var i=new Re.QueryStringBuilder(t);throw i.addParam(e.previousSessionParamName,e.userSessionId),i.addParam(e.invalidHostCanaryRedirectParamName,"1"),window.top.location.replace(i.toString()),e.suppressCrashDialog=!0,e.suppressCrashReportingToBSqm=!0,e.suppressCrashReportingToWatson=!0,e.reportError(n),Error.invalidOperation()},e.prototype.updateFullSessionStartInfo=function(t){e._isUpdateFullSessionStartInfoCalled||(e._isUpdateFullSessionStartInfoCalled=!0,null==t&&(t=""),e.appSettingsManager.get_appSettings().SessionStartInfoJson=t,this.initSessionStartInfoSettings(t),this.initializeOtel(),this.initSessionStartAndEndData(),this.initializeBrowserSqm(e.appSettingsManager.get_appSettings()))},e.prototype.initSessionStartAndEndData=function(){S.j.isEnabledLogSessionStartAndEndDataFromClientToOTel(e.sessionStartInfoSettings.Application||"unknownApp")&&(e.sessionStartAndEndData=new be(e.sessionStartInfoJson,e.dataPlumber),e.sessionStartAndEndData.logSessionStartData(),"OfficeAutomationMetadata"in e.sessionStartInfoSettings&&e.sessionStartInfoSettings.OfficeAutomationMetadata&&e.sessionStartAndEndData.logAutomationMetadata())},e.prototype.initSessionStartInfoSettings=function(t){e.sessionStartInfoJson=t;try{e.sessionStartInfoSettings=ce.b(e.sessionStartInfoJson)}catch(t){c.ULS.sendTraceTag(35992024,201,10,"Exception thrown from JsonSerializer.SecureDeserialize for sessionStartInfo:{0}. Exception:{1}",e.sessionStartInfoJson,t),e.sessionStartInfoSettings=this.createMinimumSessionStartInfoSettingsAfterJsonException(e.appSettingsManager.get_appSettings())}},e.prototype.initializeOtel=function(){Be.d((function(){C.k.getInstance(e.sessionStartInfoSettings.Application,e.appSettingsManager.getBooleanAppSetting("OneTablePerUserActionEnabled"))})),C.k.setEnabledState(e.appSettingsManager.getBooleanAppSetting("OtelPipelineIsEnabled"))},e.prototype.shutdownOtel=function(){if(!e._otelShutdownTriggered){e._otelShutdownTriggered=!0,this.logSessionEndData();var t=C.k.shutdown();t>0&&(c.ULS.sendTraceTag(40464538,383,50,"Otel telemetry queue contains events at shutdown: {0}",t),t>e.appSettingsManager.getIntAppSetting("OtelDroppedEventsThreshold",10)&&c.ULS.sendTraceTag(40994567,383,15,"Otel telemetry queue contains events at shutdown (data loss):{0}",t))}},e.prototype.updateFullAppSettings=function(t){e.closeUrl=t.CloseUrl||"",e.useClosePostMessage=Boolean.parse(t.ClosePostMessage||"false"),e.privacyUrl=t.PrivacyUrl||"",e.termsUrl=t.TermsUrl||"",e.filePropertiesUrl=t.FilePropertiesUrl||"",e.useFilePropertiesPostMessage=Boolean.parse(t.FilePropertiesPostMessage||"false"),e.fileSharingUrl=t.FileSharingUrl||"",e.useFileSharingPostMessage=Boolean.parse(t.FileSharingPostMessage||"false"),e.fileShareEnabled=!!e.fileSharingUrl||$e.m()&&e.useFileSharingPostMessage,e.workflowTypeString=t.WorkflowType||"None",e.workflowUrl=t.WorkflowUrl||"",e.useWorkflowPostMessage=$e.m()&&Boolean.parse(t.WorkflowPostMessage||"false"),e.workflowEnabled=Boolean.parse(t.WorkflowEnabled||"false")&&"None"!==e.workflowTypeString&&(""!==e.workflowUrl||$e.m()&&e.useWorkflowPostMessage),e.copyAndEditUrl=t.CopyAndEditUrl||"",e.useCopyAndEditPostMessage=Boolean.parse(t.CopyAndEditPostMessage||"false"),e.useEditModePostMessage=Boolean.parse(t.EditModePostMessage||"false"),e.useRedeemForCommentingPostMessage=Boolean.parse(t.RedeemForCommentingPostMessage||"false"),e.useSignInCommandPostMessage=Boolean.parse(t.SignInCommandPostMessage||"false"),e.appCatalogUrl=t.AppCatalogUrl||"",e.downloadACopyUrl=t.DownloadACopyUrl||"",e.directReadUrl=t.DirectReadUrl||"",e.directInvokeDAVUrl=t.DirectInvokeDAVUrl||"",e.fileEmbedCommandUrl=t.FileEmbedCommandUrl||"",e.hostEmbeddedViewUrl=t.HostEmbeddedViewUrl||"",e.hostEmbeddedEditUrl=t.HostEmbeddedEditUrl||"",e.useFileEmbedCommandPostMessage=Boolean.parse(t.FileEmbedCommandPostMessage||"false"),e.replyWithChangesUrl=t.ReplyWithChangesUrl||"",e.useReplyWithChangesPostMessage=Boolean.parse(t.ReplyWithChangesPostMessage||"false"),e.isReplyWithChangesWorkFlow=!e.get_isNoChrome()&&(Fe.g("BP")||"").startsWith("FR=WC.Hotmail%2AWACCopy"),e.useOpenInClientPostMessage=Boolean.parse(t.OpenInClientPostMessage||"false"),e.preferPostMessageOverCommandUrlForOpenInClient=Boolean.parse(t.PreferPostMessageOverCommandUrlForOpenInClient||"false"),e.addSessionIdToClientUrl=Boolean.parse(t.AddSessionIdToClientUrl||"false"),e.fileVersionUrl=t.FileVersionUrl||"",e.useFileVersionPostMessage=Boolean.parse(t.FileVersionPostMessage||"false"),e.reportAbuseUrl=t.ReportAbuseUrl||"",e.closeButtonClosesWindow=Boolean.parse(t.CloseButtonClosesWindow||"false"),e.openInClientEditOnly=Boolean.parse(t.OpenInClientEditOnly||"false"),e.isOfficeTrialOfferEnabled=Boolean.parse(t.OfficeTrialOfferEnabled||"false"),e.isMacOfficeTrialOfferEnabled=Boolean.parse(t.MacOfficeTrialOfferEnabled||"false"),e.dialogClearerStringsIsEnabled=Boolean.parse(t.DialogClearerStringsIsEnabled||"false"),e.dialogDefaultEnterBehaviorIsEnabled=Boolean.parse(t.DialogDefaultEnterBehaviorIsEnabled||"false"),e.downloadCopyOnOpenInClient=Boolean.parse(t.DownloadCopyOnOpenInClient||"false"),e.postMessageOrigin=t.PostMessageOrigin||"",e.hostSupportsFileRename=Boolean.parse(t.HostSupportsFileRename||"false"),e.hostSupportsVersionHistory=Boolean.parse(t.HostSupportsVersionHistory||"false"),e.hostSupportsInsertOnlinePictureFromHost=Boolean.parse(t.HostSupportsInsertOnlinePictureFromHost||"false"),e.userCanRename=Boolean.parse(t.UserCanRenameFile||"false"),e.fileNameMaxLength=parseInt(t.FileNameMaxLength||"250"),e.breadcrumbBrandName=t.BreadcrumbBrandName||"",e.breadcrumbBrandUrl=t.BreadcrumbBrandUrl||"",e.breadcrumbFolderName=t.BreadcrumbFolderName||"",e.breadcrumbFolderUrl=t.BreadcrumbFolderUrl||"",e.signoutUrl=t.SignoutUrl||"",e.signInUrl=t.SignInUrl||"",e.privacyDialogText=t.PrivacyDialogText||"",e.privacyDialogLinkText=t.PrivacyDialogLinkText||"",e.privacyDialogTitleText=t.PrivacyDialogTitleText||"",e.privacyDialogFwlinkId=t.PrivacyDialogFwlinkId||"",e.privacyCookieDomain=t.PrivacyCookieDomain||"",e.mightNeedPrivacyDialog=Boolean.parse(t.ShowPrivacyDialog||"false"),e.privacyDialogShouldCheckRoaming=Boolean.parse(t.PrivacyDialogShouldCheckRoaming||"false"),e.privacyDialogCanWriteServerSettings=Boolean.parse(t.PrivacyDialogCanWriteServerSettings||"false"),e.privacyDialogCurrentVersion=parseInt(t.PrivacyDialogCurrentVersion||"1"),e.privacyDialogAlreadySeen=Boolean.parse(t.PrivacyDialogAlreadySeen||"false"),e._irmPolicyTitle=t.IrmPolicyTitle,e._irmPolicyDescription=t.IrmPolicyDescription,e.hostNameToIncludeInSavedStatus=t.HostNameToIncludeInSavedStatus||"",e.sessionContext=t.SessionContext||"",e.isCloseable=!e.get_isEmbedded()&&(e.closeButtonClosesWindow||!!e.closeUrl||e.useClosePostMessage),e.isAppsForOfficeSingleSignOnSupportedOnHost=Boolean.parse(t.IsAppsForOfficeSingleSignOnSupportedOnHost||"false"),e._hostFrameTrustCheckIsEnabled=Boolean.parse(t.HostFrameTrustCheckIsEnabled||"false"),e._hostFrameTrustCheckIsEnabled&&(e.set_isHostFrameTrusted(Boolean.parse(t.HostExemptedFromFrameTrustCheck||"false")?1:0),e.get_isHostFrameTrusted()||e.sendIsFrameTrustedMessage()),this.addSwitcherHtmlToDom(t),e.disableWholeAppsForOfficeFeature=Boolean.parse(t.DisableWholeAppsForOfficeFeature||"false"),e.smartLookupIsEnabled=Boolean.parse(t.SmartLookupIsEnabled||"false"),e.insightsIsEnabled=Boolean.parse(t.InsightsIsEnabled||"false"),e.mightNeedPrivacyDialog&&k.r.get_instance().executeWhen(8,ye.PrivacyDialogManager.showPrivacyDialogIfNecessary),e.wopiIdentityWhitelist=(t.WopiIdentityWhitelist||"").split(",")},e.prototype.updateMiniCheckBasedAppSettings=function(t){e.areRoamingAppsEnabled=Boolean.parse(t.RoamingAppsAreEnabled||"false"),e.baseDocQuerySignatureWithoutVersion=t.BaseDocQuerySignatureWithoutVersion||"",e._requiresCheckout=Boolean.parse(t.RequiresCheckout||"false"),e.suppressHelp=Boolean.parse(t.SuppressHelp||"false"),e.showFeedbackButton=Boolean.parse(t.ShowFeedback||"false"),e.feedbackDescription=t.FeedbackDescription||"",e.webEditingEnabled=Boolean.parse(t.WebEditingEnabled||"true"),e.needsSignOutChecking=Boolean.parse(t.NeedsSignOutChecking||"false"),e.accessTokenParamName=t.AccessTokenParam||"access_token",e.limitedEdit=Boolean.parse(t.LimitedEdit||"false"),e.hostAuthenticatesUsersDuringOpenInClient=Boolean.parse(t.HostAuthenticatesUsersDuringOpenInClient||"false"),e.fileName=t.FileName||"",e.isSkyDrive=Boolean.parse(t.IsSkyDrive||"false"),e.isTellMeUpSellEnterpriseEnabled=Boolean.parse(t.IsTellMeUpSellEnterpriseEnabled||"false"),e.flightId=t.FlightId||"",e.userName=t.UserName||"",e.userNameUnknown=Boolean.parse(t.UserNameUnknown||"false"),e.newDocumentDestinationHost=t.NewDocumentDestinationHost,e.isNewDocumentTemplateUIEnabled=Boolean.parse(t.IsNewDocumentTemplateUIEnabled||"false"),e.readFromMruIsEnabled=Boolean.parse(t.ReadFromMruIsEnabled||"false"),e.openMenuBrowseMoreHostUrl=t.OpenMenuBrowseMoreHostUrl,e.openMenuBrowseMoreHostName=t.OpenMenuBrowseMoreHostName,e.updateMruIsEnabled=Boolean.parse(t.UpdateMruIsEnabled||"false"),e.supportsGetMoreInfoForPersonalStorage=Boolean.parse(t.SupportsGetMoreInfoForPersonalStorage||"false"),e._protectFile="true"===t.ProtectInClient,e._protectedFile="true"===t.ProtectedFile,e.shouldShowSwitcher=Boolean.parse(t.ShouldShowSwitcher||"false"),e.bootAppFromMiniCheck=Boolean.parse(t.BootAppFromMiniCheck||"false"),e.useMiniCheckedDocumentParam=t.UseMiniCheckedDocumentParam||"",e.hideAppsExtensionUrl=t.HideAppsExtensionUrl||"",e.wopiIdentityWhitelist=(t.WopiIdentityWhitelist||"").split(",")},e.prototype.crashApplication=function(){null.crash()},e.prototype.getSignInParams=function(){return{}},e.prototype.getCopyAndEditParams=function(){return{}},e.prototype.getFileNewProperties=function(){return null},e.prototype.addSwitcherHtmlToDom=function(t){if(!document.getElementById("sw_bar")){var n=t.SwitcherHtml,i=t.SwitcherLocalizedCss;if(n&&i){var r=document.getElementById(e.applicationOuterContainerId),o=document.createElement("div");for(o.innerHTML=n;o.firstChild;)r.appendChild(o.removeChild(o.firstChild));var a=document.createElement("div");for(a.innerHTML=i;a.firstChild;)r.appendChild(a.removeChild(a.firstChild))}}},e.prototype.initializeBrowserSqm=function(t){var n,i=!1,r=t.WsaData,o=(n=r?(0,l.v)("("+r+")"):{}).Dispatcher;o&&(i=n.Enabled);var a=n.SqmQoSEnabled,s=n.SqmQoSDataPoints;if(e.theWsaClient=new de(o,i,a,s),i||a){var u=n.StartTime;e.theWsaClient.updateStartTime(u),e.theWsaClient.createStream(E.ribbonStreamId,1,E.ribbonStreamWidth,ee.defaultMaxStreamRows),e.theWsaClient.createStream(9134,1,3,ee.defaultMaxStreamRows),e.theWsaClient.createStream(e.documentStreamId,1,e.documentStreamWidth,ee.defaultMaxStreamRows),S.j.shouldRegisterOtelListener(e.sessionStartInfoSettings.Application||"unknownApp")&&e.get_theActionManager().registerListener(this.getOtelActionListener()),e.get_theActionManager().registerListener(this.getWsaListener());var c=parseInt(t.OfficeApplicationId||"0");e.theWsaClient.addCommonDatapoint(59),e.theWsaClient.addCommonDatapoint(e.officeApplicationModeDatapointId),e.theWsaClient.addCommonDatapoint(8491),e.theWsaClient.addCommonDatapoint(11030),e.theWsaClient.addCommonDatapoint(9104),e.theWsaClient.addCommonDatapoint(9902),e.theWsaClient.setDw(59,c),e.theWsaClient.setDw(8491,e.lcid);for(var p=n.InitialDP,d=0;d<p.length;d+=2)e.theWsaClient.setDw(p[d],p[d+1]);if("undefined"!=typeof window.__startTime){var h=window.__startTime;e.theWsaClient.setDw(9085,e.bootTime-h.getTime())}e.theWsaClient.setDw(11030,1440-(new Date).getTimezoneOffset());var g=n.FlightId;e.theWsaClient.setFlightId(g)}},e.prototype.initializeDefaultErrorHandler=function(e,t,n){void 0===n&&(n=!1),e&&e.init(t,this.get_officeAppType(),this.get_officeAppMode(),n)},e.prototype.getWsaListener=function(){return E.getInstance()},e.prototype.getOtelActionListener=function(){return T.getInstance()},e.prototype.reportEventInterruptedJavascript=function(e){},e.prototype.onAuthenticationLost=function(t,n,i,r,o){return e.wasAuthenticationLostDuringSession=!0,32},e.prototype.onAuthenticationRestored=function(e,t,n,i,r){return 32},e.prototype.logSessionEndData=function(){e._logSessionEndDataCalled||(e._logSessionEndDataCalled=!0,S.j.isEnabledLogSessionStartAndEndDataFromClientToOTel(e.sessionStartInfoSettings.Application||"unknownApp")&&e.sessionStartAndEndData.logSessionEndData())},e.prototype.dispose=function(){c.ULS.sendTraceTag(40207748,306,50,"In Dispose"),e.appSettingsManager.getBooleanAppSetting("LogBootPerfMetricsOnAppDisposeIsEnabled")&&fe.e.get_instance().log(),this.logSessionEndData(),e.isShuttingDown=!0,e.eventSource.raiseEvent(e.shuttingDownEventKey),e.appSettingsManager.getBooleanAppSetting("KeepCrossDocumentMessengerOnAppDispose")||e.get_theActionManager().processAction(p.Rr,2),e.theWsaClient&&(e.theWsaClient.terminate(),e.theWsaClient=null),xe.b(e._activeFrame),e._activeFrame=null,e._splashscreenElement=null,e._splashscreenOverlay=null,e.theClientRequestManager=null,this.shutdownOtel(),xe.b(e.theUlsHost),W.FocusManager.disposeInputManager(),O.p.disposeInputManager(),N.s.disposeInputManager(),U.r.disposeInputManager(),q.v.disposeInputManager(),K.p.disposeInputManager(),z.z.disposeInputManager(),$.KeyInputManager.disposeInputManager(),L.z.disposeInputManager(),H.EventHandlerManager.disposeInputManager(),Te.y.dispose(),Se.c.get_instance().dispose(),Qe.h.get_instance().stop(),e.set_theActionManager(null),e.theWacAirSpaceEngine=null,e.theUlsHost=null},e.prototype.resolveActionId=function(e){return p.rG(e)},e.prototype.resolveContextId=function(e){return ze.r(e)},e.prototype.get_editMode=function(){return 0},e.prototype.get_giveFeedbackOnOpenClient=function(){return!1},e.prototype.handleEditInBrowser=function(){},e.prototype.handleGiveFeedback=function(){},e.prototype.getSliceForCommand=function(e){return null},e.prototype.createAppSettingsManager=function(e){return new D.p(e)},e.prototype.getAppChromePromise=function(e){return void 0===e&&(e=!0),Promise.reject("getAppChromeLoadedPromise not overridden")},e.get_documentLoadedTime=function(){return e._documentLoadedTime},e.set_documentLoadedTime=function(t){return e._documentLoadedTime=t,e.get_theActionManager().processAction(p.uU,2),t},e.get_rootQuerySignature=function(){return e._rootQuerySignature},e.set_rootQuerySignature=function(t){return e._rootQuerySignature=t,t},e.get_disableEditIfAndroid=function(){return 2===e.get_activeFrame().get_applicationInstance().get_officeAppType()?!!ge.y.get_isAndroid()&&(!!e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("EnablePowerPointOnlineEditorForAndroid")):!!ge.y.get_isAndroid()&&(!!e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting("DisableEditEntryPointsFromViewerForAndroid"))},e.get_numberFormat=function(){return e._numberFormat||(e._numberFormat=e.createNumberFormat())},e.get_theActionManager=function(){return e._theActionManager||(e._theActionManager=new d.ActionManager(Ke.w.get_instance().resolveFuture(o.a)))},e.set_theActionManager=function(t){return e._theActionManager=t,t},e.get_theTaskManager=function(){return Te.y.get_instance()},e.get_extraErrorInfoFromHost=function(){return e._extraErrorInfoFromHost},e.get_latestActivityTime=function(){return e._latestActivityTime},e.set_latestActivityTime=function(t){return e._latestActivityTime=t,t},e.get_activeFrame=function(){if(!e._activeFrame){var t=e.getRegisteredFrames();e._activeFrame=t[0]}return e._activeFrame},e.set_activeFrame=function(t){return e._activeFrame=t,t},e.get_canExecuteCloseAction=function(){return e.isCloseable&&!!e.get_theActionManager()&&32===e.get_theActionManager().processAction(p.bT,1)},e.get_isRtl=function(){return e._isRtl},e.set_isRtl=function(t){return e._isRtl===t?t:(e._isRtl=t,e.updatePageRtl(e._isRtl),t)},e.updatePageRtl=function(t){var n;if(t?(Sys.UI.DomElement.addCssClass(document.body,"AppRtl"),n="rtl"):(Sys.UI.DomElement.removeCssClass(document.body,"AppRtl"),n="ltr"),e.isDivSyndicated)for(var i=e.getRegisteredFrames(),r=0,o=i.length;r<o;r++)i[r].getDOMElement().dir=n;else document.body.dir=n,document.documentElement.dir=n},e.get_areRoamingAppsEnabled=function(){return e.areRoamingAppsEnabled},e.get_wopiIdentityWhitelist=function(){return e.wopiIdentityWhitelist},e.get_wacFrameImplicitAuthTestInformation=function(){return e.wacFrameImplicitAuthTestInformation},e.get_isWopiTokenRefreshWhenSessionExpiredEnabled=function(){return e.isWopiTokenRefreshWhenSessionExpiredEnabled},e.get_isWopiTokenRefreshEnabled=function(){return e.isWopiTokenRefreshEnabled},e.get_isWopiTokenRefreshCancelExpirationEnabled=function(){return e.isWopiTokenRefreshCancelExpirationEnabled},e.get_wopiTokenExpiresAfterMinutes=function(){return e.wopiTokenExpiresAfterMinutes},e.get_wopiTokenRefreshRetryeInterval=function(){return e.wopiTokenRefreshRetryeInterval},e.get_wopiTokenRefreshRetryIntervalForClientNetworkIssue=function(){return e.wopiTokenRefreshRetryIntervalForClientNetworkIssue},e.get_wopiTokenRefreshNetworkErrorIdList=function(){return e.wopiTokenRefreshNetworkErrorIdList},e.get_wopiTokenRefreshPermanentHostErrorIdList=function(){return e.wopiTokenRefreshPermanentHostErrorIdList},e.get_wopiTokenRefreshMaxRetryAttempts=function(){return e.wopiTokenRefreshMaxRetryAttempts},e.get_wopiTokensToRefresh=function(){return e.wopiTokensToRefresh},e.get_wopiTokenExpirationPolicy=function(){return e.wopiTokenExpirationPolicy},e.get_wopiTokenTaskItemPriority=function(){return e.wopiTokenTaskItemPriority},e.registerFrame=function(t){var n=t.get_element().id;e._registeredFrames[n]||(e._registeredFrames[n]=t,Array.add(e._registeredFramesArray,t)),M.n.get_instance().runFeatureChecks(e.appSettingsManager)},e.unRegisterFrame=function(t){t&&(e._registeredFrames[t],Array.remove(e._registeredFramesArray,e._registeredFrames[t]),delete e._registeredFrames[t])},e.getRegisteredFrames=function(){return e._registeredFramesArray},e.get_wasAuthenticationLostDuringSession=function(){return e.wasAuthenticationLostDuringSession},e.get_isCustomerFeedbackExternal=function(){return e.isCustomerFeedbackExternal},e.get_closeWindowOnAppClose=function(){return e.closeButtonClosesWindow},e.get_trimDownloadACopy=function(){return!e.downloadACopyUrl||ge.y.get_isIPad()||e.get_protectFile()},e.get_isDogfoodEnvironment=function(){return e.isDogfoodEnvironment},e.get_environment=function(){return e.environment},e.get_trimOICButtons=function(){return(!e.isOpenInClientEnabled||e.appSettingsManager.getBooleanAppSetting("OICAllowListIsEnabled")&&!(ge.y.get_isWindows()||ge.y.get_isMac()||ge.y.get_isAndroid()||ge.y.get_isIPad()||ge.y.get_isIPhone()))&&(void 0===e.docPropertiesProvider.get_openInClientCommandUrl()||null===e.docPropertiesProvider.get_openInClientCommandUrl()||""===e.docPropertiesProvider.get_openInClientCommandUrl())&&!e.useOpenInClientPostMessage&&e._trimOICButtonsIfUnavailable},e.get_isEmbedded=function(){return e._isEmbedded},e.get_isUIEmbedMode=function(){return e.isUIEmbedMode},e.get_isNoChrome=function(){return e.isNoChrome},e.get_protectFile=function(){return e._protectFile},e.set_protectFile=function(t){return e._protectFile=t,t},e.get_protectedFile=function(){return e._protectedFile},e.set_protectedFile=function(t){return e._protectedFile=t,t},e.get_isSleeping=function(){return e._isSleeping},e.set_isSleeping=function(t){return e._isSleeping!==t&&(e._isSleeping=t,e._isSleeping?e.eventSource.raiseEvent("ASEK"):e.eventSource.raiseEvent("AWEK")),t},e.get_isHostFrameTrusted=function(){return e._isHostFrameTrusted},e.set_isHostFrameTrusted=function(t){if(e._isHostFrameTrusted!==t){e._isHostFrameTrusted=t,2===e._isHostFrameTrusted&&c.ULS.sendTraceTag(51180616,306,15,"Host_IsFrameTrusted is NotTrusted");try{e.eventSource.raiseEvent("IHFTSEK",e._isHostFrameTrusted)}catch(e){c.ULS.sendTraceTag(595150338,306,10,"Exception while setting IsHostFrameTrusted:{0}",e)}}return t},e.get_requiresCheckout=function(){return e._requiresCheckout},e.get_imageClusterName=function(){return e._imageClusterName},e.set_imageClusterName=function(t){return e._imageClusterName=t,t},e.get_imageClusterPath=function(){return e._imageClusterPath},e.set_imageClusterPath=function(t){return e._imageClusterPath=t,t},e.get_scriptFolderPath=function(){return e._scriptFolderPath},e.set_scriptFolderPath=function(t){return e._scriptFolderPath=t,t},e.get_scriptBase=function(){return e._scriptBase},e.set_scriptBase=function(t){return e._scriptBase=t,t},e.get_currentBrowserSupportsCrossDomainAjax=function(){return Oe.u.get_browserSupportsCrossDomainRequests()},e.get_accessToken=function(){return e._accessToken},e.set_accessToken=function(t){return e.get_isWopiTokenRefreshEnabled()&&(e.baseDocQuerySignatureWithoutVersion&&(e.baseDocQuerySignatureWithoutVersion=Le.n.addOrReplaceParameterValueInQueryParams(e.baseDocQuerySignatureWithoutVersion,e.accessTokenParamName,encodeURIComponent(t))),e.currentFileBaseDocQuerySignatureWithoutVersion&&(e.currentFileBaseDocQuerySignatureWithoutVersion=Le.n.addOrReplaceParameterValueInQueryParams(e.currentFileBaseDocQuerySignatureWithoutVersion,e.accessTokenParamName,encodeURIComponent(t))),e.get_rootQuerySignature()&&e.set_rootQuerySignature(Le.n.addOrReplaceParameterValueInQueryParams(e.get_rootQuerySignature(),e.accessTokenParamName,encodeURIComponent(t)))),e._accessToken=t,t},e.get_accessTokenTtl=function(){return e._accessTokenTtl},e.set_accessTokenTtl=function(t){return e.get_isWopiTokenRefreshEnabled()&&(e.baseDocQuerySignatureWithoutVersion&&(e.baseDocQuerySignatureWithoutVersion=Le.n.addOrReplaceParameterValueInQueryParams(e.baseDocQuerySignatureWithoutVersion,e.accessTokenTtlParamName,t.toString())),e.currentFileBaseDocQuerySignatureWithoutVersion&&(e.currentFileBaseDocQuerySignatureWithoutVersion=Le.n.addOrReplaceParameterValueInQueryParams(e.currentFileBaseDocQuerySignatureWithoutVersion,e.accessTokenTtlParamName,t.toString())),e.get_rootQuerySignature()&&e.set_rootQuerySignature(Le.n.addOrReplaceParameterValueInQueryParams(e.get_rootQuerySignature(),e.accessTokenTtlParamName,t.toString()))),e._accessTokenTtl=t,t},e.get_isSkyDrive=function(){return e.isSkyDrive},e.get_hostNameToIncludeInSavedStatus=function(){return e.hostNameToIncludeInSavedStatus},e.get_logHostRequestsQueryValue=function(){return e.isLoggingHostRequests?"1":"0"},e.get_unifiedHeaderOfficeOnlineLogoWidth=function(){return e.unifiedHeaderOfficeOnlineLogoWidth},e.set_unifiedHeaderOfficeOnlineLogoWidth=function(t){return e.unifiedHeaderOfficeOnlineLogoWidth=t,t},e.get_newDocumentDestinationHost=function(){return e.newDocumentDestinationHost},e.get_isNewDocumentTemplateUIEnabled=function(){return e.isNewDocumentTemplateUIEnabled},e.get_isTellMeUpSellEnterpriseEnabled=function(){return e.isTellMeUpSellEnterpriseEnabled},e.get_newMenuMoreTemplatesUrl=function(){return e.newMenuMoreTemplatesUrl},e.get_isAppsForOfficeSingleSignOnSupportedOnHost=function(){return e.isAppsForOfficeSingleSignOnSupportedOnHost},e.get_hideAppsExtensionUrl=function(){return e.hideAppsExtensionUrl},e.get_isControllerServicesQueryParamNeeded=function(){return e.isControllerServicesQueryParamNeeded},e.get_disableWholeAppsForOfficeFeature=function(){return e.disableWholeAppsForOfficeFeature},e.get_documentIsFolder=function(){return e.documentIsFolder},e.get_readFromMruIsEnabled=function(){return e.readFromMruIsEnabled},e.get_mruPollingIntervalInMs=function(){return e.mruPollingIntervalInMs},e.get_timeUntilInactiveInMs=function(){return e.timeUntilInactiveInMs},e.get_openMenuBrowseMoreHostUrl=function(){return e.openMenuBrowseMoreHostUrl},e.get_openMenuBrowseMoreHostName=function(){return e.openMenuBrowseMoreHostName},e.get_supportsGetMoreInfoForPersonalStorage=function(){return e.supportsGetMoreInfoForPersonalStorage},e.get_getMoreInfoRetryIntervalsInMs=function(){return e.getMoreInfoRetryIntervalsInMs},e.get_cursorPinningIsEnabled=function(){return e.cursorPinningIsEnabled},e.isInsertOnlinePictureFromHostSupported=function(){return e.insertOnlinePictureFromHostEnabled&&(e.hostSupportsInsertOnlinePictureFromHost||e.get_isSkyDrive())&&e.appSupportsInsertOnlinePictureFromHost||e.appSupportsInsertOnlinePictureFromSharePoint},e.shouldUseEmulatedOneDriveHostForInsertOnlinePicture=function(){return!!e.get_activeFrame()&&!!e.get_activeFrame().get_applicationInstance()&&4===e.get_activeFrame().get_applicationInstance().get_officeAppType()||e.appSupportsInsertOnlinePictureFromSharePoint||e.insertOnlinePictureFromHostEnabled&&e.appSupportsInsertOnlinePictureFromHost&&e.appSettingsManager.getBooleanAppSetting("InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled")&&e.get_isSkyDrive()&&!e.hostSupportsInsertOnlinePictureFromHost},e.isRenameSupported=function(){return e.hostSupportsFileRename&&e.appSupportsFileRename},e.isVersionHistorySupported=function(){return e.hostSupportsVersionHistory&&e.appSupportsVersionHistory&&!e.get_protectFile()},e.get_freemiumUpsellMode=function(){if(!e.appSettingsManager.getBooleanAppSetting("FreemiumUpsellHeaderUIIsEnabled"))return 0;var t=3;switch(e.appSettingsManager.getStringAppSetting("FreemiumUpsellMode")){case"ShowUpsell":t=1;break;case"ShowBadge":t=2;break;case"ShowNothing":default:e.appSettingsManager.getBooleanAppSetting("FreemiumUpsellShowWhenPremiumStatusIsUnknown")&&(c.ULS.sendTraceTag(40739805,324,50,"Premium Status unknown. Defaulting to app setting"),t=1)}return t},e.get_updateMruIsEnabled=function(){return e.updateMruIsEnabled},e.get_wacCopyPasteShortcutDialogIsEnabled=function(){return e.wacCopyPasteShortcutDialogIsEnabled},e.get_removeWacDialogKeyUpHandler=function(){return e.removeWacDialogKeyUpHandler},e.get_isCookieBannerVisible=function(){return!!window.self.g_cookieBannerVisible},e.get_newFileTemplateName=function(){return e.newFileTemplateName},e.get_newFileTemplateLcid=function(){return e.newFileTemplateLcid},e.get_instance=function(){return e._instance},e.initializeBulsProperties=function(t){e.browserUlsIsEnabled=Boolean.parse(t.BrowserUlsIsEnabled||"false"),e.bulsUploadMaxSize=parseInt(t.BulsUploadMaxSize||"0"),e.browserUlsTraceLevel=parseInt(t.BrowserUlsTraceLevel||"0"),e.logCanaryInBrowser=Boolean.parse(t.LogCanaryInBrowser||"false")},e.requestCookieConsent=function(){He.v.get_instance().requestConsentWithSettings((function(){var t=document.getElementById(e.externalHeaderPanelId);return(0,s.m)(new CookieComplianceSettings(e.appSettingsManager.getListAppSetting("MSCCCookies")),{markup:e.appSettingsManager.getStringAppSetting("MSCCMarkup"),bannerParent:t?t.parentNode:document.body,addHandler:V.n.addHandler,onConsentRequested:function(){var t=document.getElementById(e.applicationOuterContainerId);t&&(t.style.position="relative",t.style.width="100%",t.style.height="100%")},rootDomain:e.appSettingsManager.getStringAppSetting("WacRootDomain")})}))},e.logFunctionWithBadCast=function(e){c.ULS.sendTraceTag(5256782,201,50,"Bad cast in "+e)},e.logMSAjaxError=function(e){c.ULS.sendTraceTag(594342682,201,10,e)},e.scriptUrlFromName=function(t,n){var i=ve(t,n,e.get_scriptBase(),e.get_staticContentScriptNameBase(),e.lcid,je.h.get_staticContentQueryParameter());return i=e.getBrotliResourceUrl(i),u.k(51225436,200,100,"ScriptUrlFromName for {0} is {1}",t,i),i},e.get_staticContentScriptNameBase=function(){return je.h.staticContentHost+e.get_scriptFolderPath()},e.getBrotliResourceUrl=function(t){return e.appSettingsManager&&e.appSettingsManager.getBooleanAppSetting(e.isBrotliSupportedSettingName)&&(t.endsWith(e.cssExtension)?t.replace(e.cssExtension,e.brotliExtension+e.cssExtension):t.endsWith(e.jsExtension)&&t.replace(e.cssExtension,e.brotliExtension+e.jsExtension),u.k(51389006,200,50,"Returning brotli compressed url {0}",t)),t},e.createNumberFormat=function(){var t=new he;return void 0!==e.appSettingsManager.get_appSettings().NegativeSign&&null!==e.appSettingsManager.get_appSettings().NegativeSign&&(t.negativeSign=e.appSettingsManager.get_appSettings().NegativeSign,t.numberDecimalDigits=parseInt(e.appSettingsManager.get_appSettings().NumberDecimalDigits),t.numberDecimalSeparator=e.appSettingsManager.get_appSettings().NumberDecimalSeparator,t.numberGroupSeparator=e.appSettingsManager.get_appSettings().NumberGroupSeparator,t.numberGroupSizes=e.getGroupSizesArrayFromString(e.appSettingsManager.get_appSettings().NumberGroupSizes),t.numberNegativePattern=parseInt(e.appSettingsManager.get_appSettings().NumberNegativePattern),t.percentDecimalDigits=parseInt(e.appSettingsManager.get_appSettings().PercentDecimalDigits),t.percentDecimalSeparator=e.appSettingsManager.get_appSettings().PercentDecimalSeparator,t.percentGroupSeparator=e.appSettingsManager.get_appSettings().PercentGroupSeparator,t.percentGroupSizes=e.getGroupSizesArrayFromString(e.appSettingsManager.get_appSettings().PercentGroupSizes),t.percentNegativePattern=parseInt(e.appSettingsManager.get_appSettings().PercentNegativePattern),t.percentPositivePattern=parseInt(e.appSettingsManager.get_appSettings().PercentPositivePattern),t.percentSymbol=e.appSettingsManager.get_appSettings().PercentSymbol),t},e.getGroupSizesArrayFromString=function(e){for(var t=e.split(","),n=t.length,i=new Array(n),r=0;r<n;r++)i[r]=parseInt(t[r]);return i},e.add_appSleep=function(t){e.eventSource.addHandler("ASEK",t)},e.remove_appSleep=function(t){e.eventSource.removeHandler("ASEK",t)},e.add_appWakeup=function(t){e.eventSource.addHandler("AWEK",t)},e.remove_appWakeup=function(t){e.eventSource.removeHandler("AWEK",t)},e.add_isHostFrameTrustedSet=function(t){e.eventSource.addHandler("IHFTSEK",t)},e.remove_isHostFrameTrustedSet=function(t){e.eventSource.removeHandler("IHFTSEK",t)},e.ensureAwakeIfAsleep=function(){e.get_isSleeping()&&e.ensureAwake()},e.ensureAwake=function(){if(isFinite(e._sleepIntervalInMsec)){var t=e._theAppSleepTask;e._theAppSleepTask=null,e.set_isSleeping(!1),t&&e.get_theTaskManager().deleteTask(t),e._theAppSleepTask=new Ae.c(3,1,e._sleepIntervalInMsec,e.putApplicationToSleep,21),e.get_theTaskManager().addTask(e._theAppSleepTask)}},e.putApplicationToSleep=function(t){e.set_isSleeping(!0),e._theAppSleepTask=null},e.isSplashScreenUp=function(){return e._isSplashScreenUp},e.dismissSplashScreen=function(){e._isSplashScreenUp&&(P.q(e._splashscreenElement,null,e.onAfterDismissSplashScreen),P.q(e._splashscreenOverlay,null,e.onAfterDismissSplashScreenOverlay))},e.dismissSplashScreenImmediately=function(){e.setSplashScreenInvisible(),e.setSplashScreenOverlayInvisible()},e.dismissSplashScreenOverlay=function(){e._isSplashScreenUp&&P.q(e._splashscreenOverlay,null,e.onAfterDismissSplashScreenOverlay)},e.registerOnAfterSplashScreenDismissed=function(t){Array.add(e._splashScreenDismissedCallbacks,t)},e.runSplashScreenDismissedCallbacks=function(){for(var t=0;t<e._splashScreenDismissedCallbacks.length;++t){(0,e._splashScreenDismissedCallbacks[t])()}},e.showSplashScreen=function(t){void 0===t&&(t=!1),(!e._isSplashScreenUp||t)&&e._splashscreenElement&&e._splashscreenOverlay&&(e._isSplashScreenUp=!0,e._splashscreenElement.style.display="flex",e._splashscreenOverlay.style.display="block",e._splashscreenOverlay.setAttribute(Ge.t.ariaHiddenAttribute,Ge.t.ariaFalseValue),Ne.g.setOpacity(e._splashscreenElement,100),Ne.g.setOpacity(e._splashscreenOverlay,70))},e.onAfterDismissSplashScreen=function(t){e.setSplashScreenInvisible()},e.onAfterDismissSplashScreenOverlay=function(t){e.setSplashScreenOverlayInvisible()},e.setSplashScreenInvisible=function(){e._splashscreenElement&&(e._splashscreenElement.style.display="none"),e._isSplashScreenUp&&(e.clearAriaLoadingAttributes(),e.runSplashScreenDismissedCallbacks()),e._isSplashScreenUp=!1},e.clearAriaLoadingAttributes=function(){var t=document.getElementById(e.applicationOuterContainerId);t&&(t.removeAttribute(Ge.t.ariaHiddenAttribute),t.removeAttribute(Ge.t.ariaBusyAttribute))},e.setSplashScreenOverlayInvisible=function(){e._splashscreenOverlay&&(e._splashscreenOverlay.style.display="none",e._splashscreenOverlay.setAttribute(Ge.t.ariaHiddenAttribute,Ge.t.ariaTrueValue))},e.reportError=function(t,n){void 0===n&&(n=null),e.reportErrorWithCauseAndResolution(t,F.p.unknownCause,F.p.unknownResolution,n)},e.add_errorDialogDisplayed=function(t){e.eventSource.addHandler(e.errorDialogDisplayedEventKey,t)},e.remove_errorDialogDisplayed=function(t){e.eventSource.removeHandler(e.errorDialogDisplayedEventKey,t)},e.reportErrorWithCauseAndResolution=function(t,n,i,r){void 0===r&&(r=null),e._appEncounteredFirstError||(e._appEncounteredFirstError=!0,k.r.get_instance().isCompleted(13)||(k.r.get_instance().setAppInitializationStatus(13),c.ULS.sendTraceTag(42000463,306,50,"App encountered its first error so updating app init status")));var o=(0,s.m)(new R,{errorCode:t,errorCause:F.p.unknownCause,errorResolution:F.p.unknownResolution});if(e.eventSource.raiseEvent(e.errorDialogDisplayedEventKey,o),e.theWsaClient&&(e.theWsaClient.addToStreamDw(9134,t,n,i),!e._checkedForBootError&&t!==F.p.openInClientFailed&&t!==F.p.openInClientOffice14Required&&t!==F.p.openInClientWithC2RFailed&&t!==F.p.openInClientSecondaryFailed&&t!==F.p.downloadFailed&&t!==F.p.unexpectedPostMessage&&t!==F.p.roamingControlMissing)){var a=new Date;(!e._reportedRenderTime||a.getTime()-e._renderTime.getTime()<1e3)&&e.theWsaClient.setDw(10459,t),e._checkedForBootError=!0}B.m.recordBSqmQosError(t.toString(),r)},e.subscribeToBeforeAppShutDown=function(t){e.add_beforeAppShutDown((function(e,n){try{t(e,n)}catch(e){c.ULS.shipAssertTag(7448661,201,!1,e.toString())}}))},e.add_beforeAppShutDown=function(t){e.eventSource.addHandler(e.shuttingDownEventKey,t)},e.remove_beforeAppShutDown=function(t){e.eventSource.removeHandler(e.shuttingDownEventKey,t)},e.logFlightedSettingUsage=function(t){var n=String.format('The flighted setting has impacted the experience: {{"SettingType":"{0}"}}',t);c.ULS.sendTraceTag(5566927,306,50,n),e.get_loggedFligtingTypes()[t]=!0},e.reportRenderTime=function(t,n){if(void 0===t&&(t=null),void 0===n&&(n=!0),!e._reportedRenderTime){var i;if(e._reportedRenderTime=!0,e._renderTime=t||new Date,"undefined"!=typeof window.__startTime){var r=window.__startTime;i=e._renderTime.getTime()-r.getTime()}else i=1e9;n&&e.theWsaClient.setDw(9086,i),c.ULS.sendTraceTag(6320966,345,50,"Legacy RenderTime (ms): {0}",i)}},e.sendIsFrameTrustedMessage=function(){!e._hostFrameTrustCheckIsEnabled||e._isFrameTrustedMessageInitiated||e.get_isHostFrameTrusted()||(e.get_hostPostmessengerFuture().execute((function(t){t.addAllowedReceivingMessage(Ve.a.host_IsFrameTrusted),t.registerCallback(Ve.a.host_IsFrameTrusted,e.receivedIsFrameTrustedMessage),t.sendMessage(Ve.a.app_IsFrameTrusted,null)})),e._isFrameTrustedMessageInitiated=!0)},e.receivedIsFrameTrustedMessage=function(t){if(e._hostFrameTrustCheckIsEnabled&&1!==e.get_isHostFrameTrusted()){var n=t.Values[We.t.isTopFrameTrusted];e.set_isHostFrameTrusted(n&&Boolean.parse(n.toString()||"false")?3:2)}},e.sendSetOverlayContentMessage=function(t){e._successfullySetOverlayContent||e.get_hostPostmessengerFuture().execute((function(n){n.addAllowedReceivingMessage(Ve.a.setOverlayContent),n.registerCallback(Ve.a.setOverlayContent,e.receivedSetOverlayContentMessage),n.sendMessage(Ve.a.setOverlayContent,{overlayContent:t})}))},e.receivedSetOverlayContentMessage=function(t){e._successfullySetOverlayContent=!0},e.reportDocumentLoadedTime=function(t,n){void 0===t&&(t=null),void 0===n&&(n=!1),e._reportedLoadTime||(e._reportedLoadTime=!0,k.r.get_instance().setAppInitializationStatus(n?9:8)),e.set_documentLoadedTime(t||new Date),qe.m.get_instance().recordDocumentLoadedTime(e.get_documentLoadedTime().getTime()),e.get_hostPostmessengerFuture().execute((function(t){t.reportDocumentLoadedTime(e.get_documentLoadedTime().getTime())}))},e.get_hostPostmessengerFuture=function(){return e._hostPostmessengerFuture||(e._hostPostmessengerFuture=Ke.w.get_instance().resolveFuture(a.i))},e.set_hostPostmessengerFuture=function(t){return e._hostPostmessengerFuture=t,t},e.reportInitialUi=function(t){var n;e._reportedInitialUi||(e._reportedInitialUi=!0,n=t?1:2,e.theWsaClient.setDw(10309,n))},e.getSessionIdQueryParam=function(){return e.userSessionIdQueryParam+"="+I.l.urlKeyValueEncode(e.userSessionId)},e.getLogHostRequestQueryParam=function(){return e.logHostRequestsQueryParam+"="+e.get_logHostRequestsQueryValue()},e.getBrowserBuildRequestQueryParam=function(){return e.browserBuildQueryParam+"="+I.l.urlKeyValueEncode(e.buildVersion)},e.getWacClusterQueryParam=function(){return e.theClientRequestManager&&e.theClientRequestManager.get_wacClusterId()?Ue.h.wacClusterQsName+"="+e.theClientRequestManager.get_wacClusterId():null},e.getWacUserAgentQueryParam=function(){return e.theClientRequestManager&&e.theClientRequestManager.get_wacUserAgent()?Ue.h.wacUserAgentQsName+"="+e.theClientRequestManager.get_wacUserAgent():null},e.addCommonUrlParameters=function(t){e.ensureCommonUrlParameters(r.i(t,t.addFullParam,"addFullParam"))},e.addOrReplaceCommonUrlParameters=function(t){e.ensureCommonUrlParameters(r.i(t,t.addOrReplaceFullParam,"addOrReplaceFullParam"))},e.ensureCommonUrlParameters=function(t){e.userSessionId&&t(e.getSessionIdQueryParam()),e.isLoggingHostRequests&&t(e.getLogHostRequestQueryParam()),e.buildVersion&&t(e.getBrowserBuildRequestQueryParam());var n=e.getWacClusterQueryParam();n&&t(n);var i=e.getWacUserAgentQueryParam();i&&t(i)},e.showRequiresSignInDialog=function(){var e=new De.StandardDialog;e.set_buttonsOption(0),e.setButtonText(1,CommonUIStrings.l_DialogClose),e.messageBox(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NeedToSignIn,3,null)},e.showOpenInAppDialog=function(){e.isMobileMode&&(new ke).initializeAndShowDialog()},e.disableControllerServicesViaQueryParam=function(){e.isControllerServicesQueryParamNeeded=!0},e.enableControllerServicesViaQueryParam=function(){e.isControllerServicesQueryParamNeeded=!1},e.loadTestFrameworkIfRequested=function(){e.shouldDownloadTestFramework()&&(we.o.loadTestHarness(),e.suppressCrashDialog=!0,x.Debug.get_debugSettings().assertHandler=x.Debug.reportAssertToTestHarness)},e.shouldDownloadTestFramework=function(){var e=function(e){try{return sessionStorage.getItem(e)}catch(e){return null}};return""!==we.o.webToadHostName&&we.o.isBrowserUnderWebToadRun(window.location.href,e)},e.registerTestHarnessErrorHandler=function(t){e._testHarnessOnErrorCallback=t},e.tryReportErrorToTestHarness=function(t){return!!e._testHarnessOnErrorCallback&&(e._testHarnessOnErrorCallback(t),!0)},e.get_loggedFligtingTypes=function(){return e._loggedFlightingTypes||(e._loggedFlightingTypes={})},e.logUniqueFlightedSettingUsage=function(t){t in e.get_loggedFligtingTypes()||e.logFlightedSettingUsage(t)},e.isMultiTouchGestureEnabled=function(){return!!e.appSettingsManager&&(e.appSettingsManager.getBooleanAppSetting("MultiTouchGestureIsEnabledForVisio")||e.appSettingsManager.getBooleanAppSetting("MultiTouchGestureIsEnabledForWord")&&ge.y.get_isChrome()||e.appSettingsManager.getBooleanAppSetting("MultiTouchGestureNonChromeIsEnabledForWord")&&!ge.y.get_isChrome())},e.isPinchToZoomEnabled=function(){return!!e.appSettingsManager&&(e.appSettingsManager.getBooleanAppSetting("PinchZoomIsEnabled")||e.appSettingsManager.getBooleanAppSetting("MultiTouchGestureIsEnabledForWord")&&ge.y.get_isChrome()||e.appSettingsManager.getBooleanAppSetting("MultiTouchGestureNonChromeIsEnabledForWord")&&!ge.y.get_isChrome())},e.shouldUseChromeExtension=function(){return!!e.appSettingsManager&&((!ge.y.get_isChromiumEdge()||(e.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordChromiumEdgeUIPasteForWordSettings"),!e.appSettingsManager.getBooleanAppSetting("ChromiumEdgeUIPasteForWordIsEnabled")&&!e.appSettingsManager.getBooleanAppSetting("ChromiumEdgeUIPasteForPPTIsEnabled")||!document.queryCommandSupported("paste")))&&e.appSettingsManager.getBooleanAppSetting("ChromeClipboardAccessIsEnabled"))},e.documentStreamId=2096,e.documentStreamWidth=9,e.supportsViewingFlag="V",e.supportsEditingFlag="E",e.supportsCobaltFlag="C",e.supportsPublishingFlag="P",e.supportsEditingWithLocksFlag="L",e.supportsReviewingFlag="R",e.userSessionIdQueryParam="usid",e.logHostRequestsQueryParam="loghostrequests",e.browserBuildQueryParam="build",e.officeApplicationModeDatapointId=8721,e.modeSwitchTimeParamName="wdModeSwitchTime",e.previousSessionParamName="wdPreviousSession",e.sessionOriginParamName="wdOrigin",e.correlationIdQueryParam="corrid",e.uiHostParamName="uih",e.invalidHostCanaryRedirectParamName="wdHCRedir",e.controllerServicesParamName="wdccsoff",e.hostUIControlSettingName="HostDefinedUIControls",e.uiHostSettingName="UiHost",e.isBrotliSupportedSettingName="IsBrotliSupported",e.cssExtension=".css",e.jsExtension=".js",e.brotliExtension=".br",e.postmessageFocusId="HostIntegrationMessaging",e._renderTime=null,e._latestActivityTime=new Date,e._reportedRenderTime=!1,e._checkedForBootError=!1,e._reportedInitialUi=!1,e._reportedLoadTime=!1,e._appEncounteredFirstError=!1,e._isUpdateFullSessionStartInfoCalled=!1,e._documentLoadedTime=null,e._rootQuerySignature=null,e._registeredFrames={},e._registeredFramesArray=[],e._splashscreenElement=null,e._splashscreenOverlay=null,e._isSplashScreenUp=!0,e._splashScreenDismissedCallbacks=[],e._testHarnessOnErrorCallback=null,e._numberFormat=null,e.endSessionHeaderReceivedCallback=null,e.theUlsHost=null,e._theActionManager=null,e.theClientRequestManager=null,e.theWindowEventManager=null,e.hostPostmessenger=null,e.theWacAirSpaceEngine=null,e.appSettingsManager=null,e.theOfflineLogger=null,e._extraErrorInfoFromHost=null,e._activeFrame=null,e.areRoamingAppsEnabled=!1,e.privacyDialogText=null,e.privacyDialogLinkText=null,e.privacyDialogTitleText=null,e.privacyDialogFwlinkId=null,e.privacyCookieDomain=null,e.mightNeedPrivacyDialog=!1,e.privacyDialogShouldCheckRoaming=!1,e.privacyDialogCanWriteServerSettings=!1,e.privacyDialogCurrentVersion=0,e.privacyDialogAlreadySeen=!1,e.wopiIdentityWhitelist=null,e.wacFrameImplicitAuthAADApplications=null,e.wacFrameImplicitAuthMSAApplications=null,e.wacFrameImplicitAuthTestInformation=null,e.wopiTokenLastRefreshTime=0,e.isWopiTokenRefreshWhenSessionExpiredEnabled=!1,e.isWopiTokenRefreshEnabled=!1,e.isWopiTokenRefreshCancelExpirationEnabled=!1,e.wopiTokenExpiresAfterMinutes=0,e.wopiTokenRefreshRetryeInterval=0,e.wopiTokenRefreshRetryIntervalForClientNetworkIssue=0,e.wopiTokenRefreshNetworkErrorIdList=null,e.wopiTokenRefreshPermanentHostErrorIdList=null,e.wopiTokenRefreshMaxRetryAttempts=0,e.wopiTokensToRefresh=null,e.wopiTokenExpirationPolicy=0,e.wopiTokenTaskItemPriority=0,e.wopiHostOriginFromPostMessage=null,e.docPropertiesProvider=null,e._isRtl=!1,e.baseDocQuerySignatureWithoutVersion=null,e.currentFileBaseDocQuerySignatureWithoutVersion=null,e.buildVersion=null,e.collectPageStats=!1,e.showPageStats=!1,e.suppressCrashDialog=!1,e.suppressRetryFromCrashDialog=!1,e.suppressRetryFromCrashDialogMessage=null,e.wasAuthenticationLostDuringSession=!1,e.suppressCrashReportingToBSqm=!1,e.suppressCrashReportingToWatson=!1,e.appInitTime=new Date,e.appPreloadStatistics="",e.forceTouchRibbon=!1,e.isReadOnlyRecommended=!1,e.hostOperationHttpStatusCode=0,e.closeUrl=null,e.useClosePostMessage=!1,e.privacyUrl=null,e.termsUrl=null,e.filePropertiesUrl=null,e.useFilePropertiesPostMessage=!1,e.fileSharingUrl=null,e.useFileSharingPostMessage=!1,e.fileShareEnabled=!1,e.workflowTypeString=null,e.workflowUrl=null,e.useWorkflowPostMessage=!1,e.workflowEnabled=!1,e.copyAndEditUrl=null,e.useCopyAndEditPostMessage=!1,e.useEditModePostMessage=!1,e.useRedeemForCommentingPostMessage=!1,e.useSignInCommandPostMessage=!1,e.appCatalogUrl=null,e.downloadACopyUrl=null,e.directReadUrl=null,e.directInvokeDAVUrl=null,e.fileEmbedCommandUrl=null,e.hostEmbeddedViewUrl=null,e.hostEmbeddedEditUrl=null,e.useFileEmbedCommandPostMessage=!1,e.replyWithChangesUrl=null,e.useReplyWithChangesPostMessage=!1,e.isReplyWithChangesWorkFlow=!1,e.fileVersionUrl=null,e.useFileVersionPostMessage=!1,e.useOpenInClientPostMessage=!1,e.preferPostMessageOverCommandUrlForOpenInClient=!1,e.addSessionIdToClientUrl=!1,e.fileName=null,e.sessionContext=null,e.reportAbuseUrl=null,e.limitedEdit=!1,e.hostAuthenticatesUsersDuringOpenInClient=!1,e.breadcrumbBrandName=null,e.breadcrumbBrandUrl=null,e.breadcrumbFolderName=null,e.breadcrumbFolderUrl=null,e.userName=null,e.userNameUnknown=!1,e.signoutUrl=null,e.signInUrl=null,e.hideHeader=!1,e.isMobileMode=!1,e.closeButtonClosesWindow=!1,e.isCloseable=!1,e.useParentHelpFunction=!1,e.suppressHelp=!1,e.showFeedbackButton=!1,e.feedbackDescription=null,e.hideHeaderEmbedded=!1,e.hideRibbonEmbedded=!1,e.feedbackStringId=0,e.isCustomerFeedbackExternal=!1,e.showRtcConnectionStatus=!1,e.openInClientEditOnly=!1,e.webEditingEnabled=!1,e.downloadCopyOnOpenInClient=!1,e.needsSignOutChecking=!1,e.shortDateFormat=null,e.shortTimeFormat=null,e.roamingAppsX86RootUrl=null,e.roamingAppsControlInstallerUrl=null,e.roamingAppsFirefoxExtensionUrl=null,e.isOpenInClientEnabled=!1,e.userSessionId=null,e.isLoggingHostRequests=!1,e.firstRunExperienceIsEnabled=!1,e.firstRunExperienceUiVariation=0,e.assistanceIsEnabled=!1,e.assistancePaneIsEnabled=!1,e.assistanceSearchUrl=null,e.tellMeIsEnabled=!1,e.smartLookupIsEnabled=!1,e.insightsIsEnabled=!1,e.insightsUrl=null,e.enrichmentIsEnabled=!1,e.enrichmentPaneUrl=null,e.hostSupportsFileRename=!1,e.hostSupportsVersionHistory=!1,e.appSupportsFileRename=!1,e.appSupportsVersionHistory=!1,e.insertOnlinePictureFromHostEnabled=!1,e.hostSupportsInsertOnlinePictureFromHost=!1,e.appSupportsInsertOnlinePictureFromHost=!1,e.appSupportsMultiInsertOnlinePictureFromHost=!1,e.appSupportsInsertOnlinePictureFromSharePoint=!1,e.userCanRename=!1,e.renameInCoauthSessionWithRenameCapableClientsIsEnabled=!1,e.documentTitleInputElement=null,e.fileNameMaxLength=0,e.renameFileTooltip=null,e.rtcTransportProtocol=null,e.peoplesWellIsEnabled=!1,e.isDogfoodEnvironment=!1,e.environment=0,e.browserUlsIsEnabled=!1,e.bulsUploadMaxSize=0,e.browserUlsTraceLevel=0,e._trimOICButtonsIfUnavailable=!1,e.suppressAppCloseOnNavigate=!1,e.isOfficeTrialOfferEnabled=!1,e.isMacOfficeTrialOfferEnabled=!1,e.dialogClearerStringsIsEnabled=!1,e.dialogDefaultEnterBehaviorIsEnabled=!1,e.isShuttingDown=!1,e.isShuttingDownFromPostMessage=!1,e.requestedLcid=0,e.lcid=0,e.uiCulture=null,e.dataCulture=null,e.bootTime=0,e.canary=null,e.hostCanary=null,e._isEmbedded=!1,e.isUIEmbedMode=!1,e.isNoChrome=!1,e.isDivSyndicated=!1,e.shouldShowSwitcher=!1,e.hasExternalHeader=!1,e.lokiEndpointForSearch=null,e.substrateEndpointForSearch=null,e.tellMeServiceEndpointForSearch=null,e._protectFile=!1,e._protectedFile=!1,e._irmPolicyTitle=null,e._irmPolicyDescription=null,e._isSleeping=!1,e._isHostFrameTrusted=0,e._hostFrameTrustCheckIsEnabled=!1,e._isFrameTrustedMessageInitiated=!1,e._requiresCheckout=!1,e._theAppSleepTask=null,e._sleepIntervalInMsec=0,e.isCrossDocumentMessengerDisabled=!1,e.postMessageOrigin="",e._imageClusterName=null,e._imageClusterPath=null,e._scriptFolderPath=null,e._scriptBase=null,e.requiresCrossDomainAjax=!1,e._accessToken=null,e.accessTokenParamName=null,e._accessTokenTtl=0,e.accessTokenTtlParamName="access_token_ttl",e.accessTokenServerExpirationTime=0,e.accessTokenExpirationPromptSeconds=0,e.userType=null,e.theDefaultErrorHandler=null,e.isSkyDrive=!1,e.hostNameToIncludeInSavedStatus=null,e.unifiedHeaderOfficeOnlineLogoWidth=0,e.newDocumentDestinationHost=null,e.isNewDocumentTemplateUIEnabled=!1,e.isTellMeUpSellEnterpriseEnabled=!1,e.newMenuMoreTemplatesUrl=null,e.isAppsForOfficeSingleSignOnSupportedOnHost=!1,e.hideAppsExtensionUrl=null,e.isControllerServicesQueryParamNeeded=!1,e.disableWholeAppsForOfficeFeature=!1,e.documentIsFolder=!1,e.readFromMruIsEnabled=!1,e.mruPollingIntervalInMs=0,e.timeUntilInactiveInMs=0,e.openMenuBrowseMoreHostUrl=null,e.openMenuBrowseMoreHostName=null,e.supportsGetMoreInfoForPersonalStorage=!1,e.getMoreInfoRetryIntervalsInMs=null,e.cursorPinningIsEnabled=!1,e.executeRenameFile=null,e.executeVersionHistory=null,e.executeRefreshFilename=null,e.useCrossOriginStaticScripts=!1,e.updateMruIsEnabled=!1,e.wacCopyPasteShortcutDialogIsEnabled=!1,e.flightId=null,e.bootAppFromMiniCheck=!1,e.useMiniCheckedDocumentParam=null,e.logCanaryInBrowser=!1,e.useO365ShellService=!1,e.applicationDivId="application",e.externalHeaderPanelId="AppHeaderPanel",e.externalHeaderPanelClassName="AppHeaderPanel",e.applicationOuterContainerId="applicationOuterContainer",e.externalHeaderLabel=null,e.sessionStartInfoJson=null,e.sessionStartInfoSettings=null,e.dataPlumber=new Ze.b,e.sessionStartAndEndData=null,e.removeWacDialogKeyUpHandler=!1,e.isNewFile=!1,e.newFileTemplateName=null,e.newFileTemplateLcid=null,e._instance=null,e._otelShutdownTriggered=!1,e.errorDialogDisplayedEventKey="ErrorDialogDisplayedEvent",e.shuttingDownEventKey="ShuttingDownEvent",e.eventSource=new Xe.f,e._logSessionEndDataCalled=!1,e._successfullySetOverlayContent=!1,e._hostPostmessengerFuture=null,e.theWsaClient=null,e.coauthManager=null,e._loggedFlightingTypes=null,e}();(0,r.l)(Je,"AFrameworkApplication",null,[Sys.IDisposable])},function(e,t,n){"use strict";n.r(t);var i=n(208),r=(0,i.y)("IUlsImpl"),o=n(929),a=function(){return function(e,t,n,i,r,o){this.timestamp=0,this.category=0,this.tag=0,this.level=0,this.message=null,this.logType=0,this.timestamp=e,this.category=t,this.tag=n,this.level=i,this.message=r||"",this.logType=o}}();(0,i.l)(a,"LoggingArgs",null,[]);var s=n(782),l=function(){function e(){}return e.prototype.handleTrace=function(e){},e.prototype.showAssertDialog=function(e){},e.prototype.handoffToNewHost=function(e){},e.prototype.flushAsynchronous=function(){},e.prototype.add_onUlsTrace=function(e){},e.prototype.remove_onUlsTrace=function(e){},e.prototype.dispose=function(){},e}();(0,i.l)(l,"UlsHostStub",null,[s.x,Sys.IDisposable]);var u=function(){function e(){this._ulsCallDepth=0,this._inHostTransition=!1,this.currentLevel=50,this._blockedTags=new Array(0),this._host=new l}return e.prototype.get_ulsCallDepth=function(){return this._ulsCallDepth},e.prototype.get_host=function(){return this._host},e.prototype.set_host=function(e){return e===this._host?e:this._inHostTransition?e:(this._inHostTransition=!0,e?(this._host.handoffToNewHost(e),this._host.dispose(),this._host=e):(this._host.dispose(),this._host=new l),this._inHostTransition=!1,e)},e.prototype.logImpl=function(t,n,i,r,o,s,l){if((r||this.shouldTrace(n,i)&&this.shouldTraceTag(t))&&!(this._ulsCallDepth>1)){o||this._ulsCallDepth++;try{var u=new Date,c=new a(u.getTime(),n,t,i,e.buildMessageString(s,l),r);this._host.handleTrace(c)}finally{o||this._ulsCallDepth--}}},e.prototype.assertImpl=function(t,n,i,r,o){if(!i&&this._ulsCallDepth<=1){this._ulsCallDepth++;try{var a=e.buildMessageString(r,o);this.logImpl(t,n,10,1,!0,a,null)}finally{this._ulsCallDepth--}}},e.prototype.shouldTrace=function(e,t){return t<=this.currentLevel},e.prototype.setTraceLevel=function(e){this.currentLevel=e},e.prototype.shouldTraceTag=function(e){return!this._blockedTags[e]},e.prototype.clearSuppressedTags=function(){this._blockedTags=new Array(0)},e.prototype.addSuppressedTag=function(e){this._blockedTags[e]=!0},e.buildMessageString=function(t,i){if(!i||!i.length)return t||"";for(var r=0,a=i.length;r<a;++r){var s=i[r];if(s&&"object"==typeof s){var l=Object.getType(s).prototype.toString;if(l===e.objectToStringPrototype||!l)if(s.nodeType===o.o.element)i[r]=n(255).ULS.concatArray([s.tagName,"#",s.id,".",s.className]);else try{i[r]=n(255).ULS.jsonSerialize(s)}catch(e){i[r]=e}}}return t?String.format.apply(null,[t].concat(i)):i.join(", ")},e.objectToStringPrototype=Object.prototype.toString,e}();(0,i.l)(u,"UlsImpl",null,[r]);var c=function(){function e(){this._host=new l}return e.prototype.get_host=function(){return this._host},e.prototype.set_host=function(e){return e},e.prototype.logImpl=function(e,t,n,i,r,o,a){},e.prototype.assertImpl=function(e,t,n,i,r){},e.prototype.shouldTrace=function(e,t){return!1},e.prototype.shouldTraceTag=function(e){return!1},e.prototype.setTraceLevel=function(e){},e.prototype.get_ulsCallDepth=function(){return 0},e.prototype.clearSuppressedTags=function(){},e.prototype.addSuppressedTag=function(e){},e}();(0,i.l)(c,"UlsImplStub",null,[r]),n.d(t,{ULS:function(){return p}});var p=function(){function e(){}return e.setUlsHost=function(t){e._isDisabled&&(e._impl=new u),e._impl.set_host(t),e._isDisabled=!1},e.get_host=function(){return e._impl.get_host()},e.disable=function(){e._impl=new c,e._isDisabled=!0},e.sendTraceTag=function(t,n,i,r){for(var o=[],a=4;a<arguments.length;a++)o[a-4]=arguments[a];e._impl.logImpl(t,n,i,0,!1,r,o)},e.shipAssertTag=function(t,n,i,r){void 0===r&&(r=null);for(var o=[],a=4;a<arguments.length;a++)o[a-4]=arguments[a];e._impl.assertImpl(t,n,i,r,o)},e.debugAssertTag=function(e,t,n,i){void 0===i&&(i=null);for(var r=[],o=4;o<arguments.length;o++)r[o-4]=arguments[o]},e.shouldTrace=function(t,n){return e._impl.shouldTrace(t,n)},e.shouldTraceTag=function(t){return e._impl.shouldTraceTag(t)},e.clearSuppressedTags=function(){e._impl.clearSuppressedTags()},e.addSuppressedTag=function(t){e._impl.addSuppressedTag(t)},e.setTraceLevel=function(t){e._impl.setTraceLevel(t)},e.get_ulsCallDepth=function(){return e._impl.get_ulsCallDepth()},e.concatArray=function(e){var t;return(t=[]).concat.apply(t,e).join("")},e.jsonSerialize=function(e){return window.JSON?JSON.stringify(e):Sys.Serialization.JavaScriptSerializer.serialize(e)},e.get_impl=function(){return e._impl},e.get_isDisabled=function(){return e._isDisabled},e._impl=new u,e._isDisabled=!1,e}();(0,i.l)(p,"ULS",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,{TouchAndHoldAdapter:function(){return c}});var i=n(208),r=n(574),o=n(25),a=n(478),s=n(810),l=n(579),u=n(635),c=function(){function e(){this._beginTouchAndHoldEvent=null,this._touchAndHoldTask=null,Array.add(e._constructedAdapters,this)}return e.prototype.beginTouchAndHold=function(e,t){this._touchAndHoldTask?s.y.get_instance().resetInterval(this._touchAndHoldTask,o.v.touchAndHoldTimeThreshold):(this._touchAndHoldTask=new a.c(0,1,o.v.touchAndHoldTimeThreshold,i.i(this,this.onTouchAndHold,"onTouchAndHold"),14),this._touchAndHoldTask.customData=t,s.y.get_instance().addTask(this._touchAndHoldTask)),this._beginTouchAndHoldEvent=e},e.prototype.cancelTouchAndHoldIfNecessary=function(e){if(e.eventName===r.d.touchStart||e.eventName===r.d.touchEnd||e.eventName===r.d.touchCancel)this.cancelTouchAndHold();else if(e.eventName===r.d.touchMove&&this._beginTouchAndHoldEvent){var t=Math.abs(e.get_screenPoint().x-this._beginTouchAndHoldEvent.get_screenPoint().x),n=Math.abs(e.get_screenPoint().y-this._beginTouchAndHoldEvent.get_screenPoint().y),i=t>o.v.touchAndHoldDistanceThreshold,a=n>o.v.touchAndHoldDistanceThreshold;(i||a)&&this.cancelTouchAndHold()}},e.prototype.cancelTouchAndHold=function(){this._touchAndHoldTask&&(s.y.get_instance().deleteTask(this._touchAndHoldTask),this._touchAndHoldTask=null),this._beginTouchAndHoldEvent=null},e.prototype.onTouchAndHold=function(e){(0,e.customData)(this._beginTouchAndHoldEvent),this._beginTouchAndHoldEvent=null,this._touchAndHoldTask=null},e.getTouchAndHoldAdapter=function(t){var n=l.j(t,e.touchAndHoldAdapterDataName);return n||(n=new e,l.v(t,e.touchAndHoldAdapterDataName,n)),n},e.cancelAnyPendingTouchAndHold=function(){for(var t=0;t<e._constructedAdapters.length;++t)e._constructedAdapters[t].cancelTouchAndHold()},e.touchAndHoldAdapterDataName=u.z.touchAndHoldAdapterCache,e._constructedAdapters=[],e}();(0,i.l)(c,"TouchAndHoldAdapter",null,[])},function(e,t,n){"use strict";n.d(t,{l:function(){return r}});var i=n(208),r=function(){return function(){this.trimmedIds=null,this.clientID=null}}();(0,i.l)(r,"BuildOptions",null,[])},,,function(e,t,n){n(426);var i=n(908);e.exports=i.Object.assign},,function(e,t,n){"use strict";n.r(t),n.d(t,{setExceptionCallStack:function(){return r}});var i=n(254),r=function(e){i.AFrameworkApplication.theDefaultErrorHandler&&i.AFrameworkApplication.theDefaultErrorHandler.setExceptionCallStack(e)}},function(e,t,n){"use strict";var i=n(57),r=n(950),o=n(147),a=n(789),s=n(9),l=n(947),u=n(777),c=Object.assign;e.exports=!c||r((function(){var e={},t={},n=Symbol();return e[n]=7,"abcdefghijklmnopqrst".split("").forEach((function(e){t[e]=e})),7!=c({},e)[n]||"abcdefghijklmnopqrst"!=o(c({},t)).join("")}))?function(e,t){for(var n=l(e),r=arguments.length,c=1,p=a.f,d=s.f;r>c;)for(var h,g=u(arguments[c++]),m=p?o(g).concat(p(g)):o(g),_=m.length,f=0;_>f;)h=m[f++],i&&!d.call(g,h)||(n[h]=g[h]);return n}:c},function(e,t,n){n(454),n(41);var i=n(908);e.exports=i.Object.fromEntries},function(e,t,n){"use strict";var i=n(508),r=n(208),o=n(377),a=n(644),s=n(614),l=n(254),u=n(841),c=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.get_instance=function(){return t._instance||(t._instance=new t,t._instance.set_buttonsOption(6),t._instance.setDefaultButton(0)),t._instance},t.display=function(e){t._displayCount||t.get_instance().showInformation(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_DialogLoading,e),t._displayCount++},t.stopDisplay=function(){t._displayCount--,t._displayCount||(t.get_instance().hide(),t.get_instance().dispose(),t._instance=null)},t._instance=null,t._displayCount=0,t}(u.StandardDialog);(0,r.l)(c,"LoadingDialog",u.StandardDialog,[]);var p=n(851);n.d(t,{v:function(){return d}});var d=function(e){function t(t,n,i,r,o,a,s,l,u,c,p,d,h,g,m){void 0===p&&(p=!1),void 0===d&&(d=!1),void 0===h&&(h=null),void 0===g&&(g=!0),void 0===m&&(m=!1);var _=e.call(this,t,n,i,h,m)||this;return _._actionId=0,_._context=null,_._behavior=0,_._reportingData=null,_._actionData=null,_._actionHandler=null,_._loadValidationDelegate=null,_._loadingDialogNeeded=!1,_._ignoreCrossOriginResourceSharing=!1,_._defer=!1,_._async=!0,_._loadValidationDelegate=r,_._actionId=o,_._context=a,_._behavior=s,_._reportingData=l,_._actionData=u,_._actionHandler=c,_._ignoreCrossOriginResourceSharing=p,_._defer=d,_._async=g,_}return(0,i.t)(t,e),t.prototype.get_loadValidationDelegate=function(){return this._loadValidationDelegate},t.prototype.get_couldGenerateLayout=function(){return!1},t.prototype.createElement=function(){return this.createElementWithLocation(this.get_resourceUrl())},t.prototype.reloadReference=function(){this.removeEventHandlers();var e=this.element.parentNode;e.removeChild(this.element),this.element=this.createElementWithLocation(p.n.addOrReplaceParameterValue(this.get_resourceUrl(),"retries",this.get_retryBehavior().get_failures().toString())),this.addEventHandlers(),e.appendChild(this.element)},t.prototype.createHighPriorityResourceElement=function(){var e=document.createElement("link");return e.setAttribute("as","script"),e.setAttribute("rel","preload"),l.AFrameworkApplication.useCrossOriginStaticScripts&&!this._ignoreCrossOriginResourceSharing&&e.setAttribute("crossorigin","anonymous"),e.setAttribute("href",this.get_resourceUrl()),e},t.prototype.createElementWithLocation=function(e){var t=document.createElement("script");return t.setAttribute("type","text/javascript"),l.AFrameworkApplication.useCrossOriginStaticScripts&&!this._ignoreCrossOriginResourceSharing&&t.setAttribute("crossorigin","anonymous"),this._defer&&t.setAttribute("defer",""),this._async||(t.async=!1),t.setAttribute("src",e),this._actionId&&window.setTimeout(r.i(this,this.onLoadTimer,"onLoadTimer"),500),t},t.prototype.finishedLoadingResource=function(t){var n=t&&this._loadValidationDelegate?this._loadValidationDelegate():t;e.prototype.finishedLoadingResource.call(this,n),n&&(this._loadingDialogNeeded&&(c.stopDisplay(),this._loadingDialogNeeded=!1,l.AFrameworkApplication.get_theActionManager().processAction(s.FC,2)),this._actionId&&this._actionHandler&&this._actionHandler(this._actionId,this._context,this._behavior,this._reportingData,this._actionData)),this._actionId=0},t.prototype.onLoadTimer=function(){2!==this.get_status()&&(this._loadingDialogNeeded||(c.display(r.i(this,this.loadingDialogHandler,"loadingDialogHandler")),this._loadingDialogNeeded=!0))},t.prototype.loadingDialogHandler=function(e,t){this._actionId=0,this._loadingDialogNeeded&&(this._loadingDialogNeeded=!1,c.stopDisplay(),l.AFrameworkApplication.get_theActionManager().processAction(s.yl,2))},t.prototype.promote=function(e,t,n,i,o,a){!this._actionId&&e&&(this._actionId=e,this._context=t,this._behavior=n,this._reportingData=i,this._actionData=o,this._actionHandler=a,window.setTimeout(r.i(this,this.onLoadTimer,"onLoadTimer"),500))},t.get_scriptResourceWithActions=function(){return t._scriptResourceWithActions},t.create=function(e,n,i,r,o,s,l,u,c){void 0===o&&(o=!1),void 0===s&&(s=!1),void 0===l&&(l=null),void 0===u&&(u=!0),void 0===c&&(c=!1);var p=new t(e,n,i,r,0,null,1,null,null,null,o,s,l,u,c);return t._scriptResourceWithActions||(t._scriptResourceWithActions=new a.c(t)),t._scriptResourceWithActions.add(p),p},t._scriptResourceWithActions=null,t}(o.s);(0,r.l)(d,"ScriptResourceWithAction",o.s,[])},function(e,t,n){"use strict";var i=n(302),r=n(208),o=(0,r.y)("IPageLoadPerfRecorder"),a=n(351),s=n(255),l=n(219),u=(0,r.y)("IPerfTelemetryLoggerFactory"),c=function(){function e(){}return e.prototype.createPerfTelemetryLogger=function(e){var t=null;switch(e){case 0:t=new(n(832).EuplTelemetryLogger);break;case 1:t=new(n(595).HostCallsTelemetryLogger);break;default:t=null}return t},e}();(0,r.l)(c,"PerfTelemetryLoggerFactory",null,[u]);var p=n(867),d=n(235);n.d(t,{e:function(){return h}});var h=function(){function e(){this._metadataDict=null,this._logged=!1,this._resourceTimingLoggerFuture=null,this._pageLoadPerfMetrics={}}return e.prototype.get_pageLoadPerfMetrics=function(){return this._pageLoadPerfMetrics},e.prototype.get_resourceTimingLoggerFuture=function(){return this._resourceTimingLoggerFuture||(this._resourceTimingLoggerFuture=d.w.get_instance().resolveFuture(i.t))},e.prototype.addMetrics=function(e,t){this.isValid(e)&&(this._pageLoadPerfMetrics[e]=t)},e.prototype.addMetadata=function(e,t){this._logged||(this._metadataDict||(this._metadataDict={}),this.isValidInDictionary(e,this._metadataDict)&&(this._metadataDict[e]=t))},e.prototype.isValid=function(e){return this.isValidInDictionary(e,this._pageLoadPerfMetrics)},e.prototype.isValidInDictionary=function(e,t){return!(this._logged||e in t)},e.prototype.addMetric=function(e,t){this.isValid(e)&&(this._pageLoadPerfMetrics[e]=t)},e.prototype.addDurationMetric=function(e,t,n){if(this.isValid(t)&&e in this._pageLoadPerfMetrics){var i=this._pageLoadPerfMetrics[e];this._pageLoadPerfMetrics[t]=n-i}},e.prototype.getMetric=function(e){return this._pageLoadPerfMetrics?this._pageLoadPerfMetrics[e]:null},e.prototype.containsMetric=function(e){return!this._logged&&e in this._pageLoadPerfMetrics},e.prototype.get_hasLogged=function(){return this._logged},e.prototype.clearMetric=function(e){this._logged||delete this._pageLoadPerfMetrics[e]},e.prototype.log=function(){var e=this;this._logged?s.ULS.shipAssertTag(19214609,324,!0,"Attempt to log after object is logged."):(this.get_resourceTimingLoggerFuture().execute((function(t){t.flush(),e.logImpl()})),this._logged=!0)},e.prototype.logImpl=function(){this.computeAndAddDurationMetrics();for(var t=p.w(this._pageLoadPerfMetrics),i=e.zeroPad(Math.ceil(t.length/3e3).toString(),3),r=1;t.length>0;r++)s.ULS.sendTraceTag(19214611,324,50,"Chunk {0} of {1} PageLoadPerfRecorder: {2}",e.zeroPad(r.toString(),3),i,t.substr(0,3e3)),t=t.substr(3e3);this._pageLoadPerfMetrics=null,n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AppStaticResourceMonitorIsEnabled")&&this.get_resourceTimingLoggerFuture().execute((function(t){for(var n=p.w(t.getAppResourceTimingMetrics()),i=e.zeroPad(Math.ceil(n.length/3e3).toString(),3),r=1;n.length>0;r++)s.ULS.sendTraceTag(51652514,324,50,"Chunk {0} of {1} StaticContent: {2}",e.zeroPad(r.toString(),3),i,n.substr(0,3e3)),n=n.substr(3e3)}))},e.prototype.logTelemetry=function(){n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PerfEuplRemoteTelemetryProcessorIsEnabled")&&this.sendEuplToMdm(),n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PerfHostCallsRemoteTelemetryProcessorIsEnabled")&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AcquireLockHostCallLoggingIsEnabled")&&this.sendAcquireLockToMdm(),n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PerfHostCallsRemoteTelemetryProcessorIsEnabled")&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("GetDocumentHostCallLoggingIsEnabled")&&this.sendGetDocumentToMdm(),n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PerfHostCallsRemoteTelemetryProcessorIsEnabled")&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("GetContentBundleHostCallLoggingIsEnabled")&&this.sendGetContentBundleToMdm()},e.prototype.sendGetContentBundleToMdm=function(){this.logMetricValue("bundleRequestsData","GetContentBundle")},e.prototype.sendGetDocumentToMdm=function(){this.logMetricValue("fileRequestsData","GetDocument")},e.prototype.sendAcquireLockToMdm=function(){this.logMetricValue("fileRequestsData","AcquireLock")},e.prototype.logMetricValue=function(e,t){var n=this.getDictionaryFromDiagnostics(e,t);if(n){var i=n.endTime,r=n.startTime,o="";"requestStatus"in n&&(o=n.requestStatus);var a=i-r,s=this.getDimensions();s.HostCallName=t,s.RequestStatus=o;var l=(new c).createPerfTelemetryLogger(1);l&&l.logToMdm(a,s)}},e.prototype.getDictionaryFromDiagnostics=function(e,t){var n=null;try{var i=this._pageLoadPerfMetrics[l.c.bootDiagnostics];if(!(e in i))return s.ULS.sendTraceTag(594626787,324,100,"Category {0} does not exist in BootDiagnostics",e),null;var r=i[e];if(!(t in r))return s.ULS.sendTraceTag(594626786,324,100,"Metric {0} does not exist under category {1} in BootDiagnostics",t,e),null;n=r[t]}catch(e){s.ULS.sendTraceTag(594626785,324,10,"Encountered the following exception when trying to get metric from boot diagnostics dictionary {0}",e)}return n},e.prototype.sendEuplToMdm=function(){var e=this._pageLoadPerfMetrics[l.c.eupl],t=this.getDimensions(),n=(new c).createPerfTelemetryLogger(0);n&&n.logToMdm(e,t)},e.prototype.getDimensions=function(){var e={};e.Application=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.Application)||"",e.ApplicationMode=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.ApplicationMode)||"";var t=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.UserSessionApplicationMode)||"";return e.AppAndMode=e.Application+"-"+t,e.Browser=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.Browser)||"",e.BrowserMajorVersion=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.BrowserMajorVersion)||"",e.BrowserVersion=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.BrowserVersion)||"",e.Build=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.WFEVersion)||"",e.Datacenter=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)||"",e.Host=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.Host)||"",e.Ring=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.Ring)||"-1",e.IsSynthetic=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.IsSynthetic)||"",e.OS=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.OS)||"",e.RoutedVia=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.RoutedVia)||"",e.SessionOrigin=(0,a.e)(String,n(254).AFrameworkApplication.sessionOriginParamName)||"",e.UiHost=(0,a.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.UiHost)||"",e},e.prototype.computeAndAddDurationMetrics=function(){this._metadataDict&&(this._pageLoadPerfMetrics.Metadata=this._metadataDict),this.addDuration(l.c.userClickedHostUI,l.c.frameFetchStart,l.c.hostDuration);var e=l.c.userClickedHostUI in this._pageLoadPerfMetrics?l.c.userClickedHostUI:l.c.frameFetchStart;this.addDuration(e,l.c.contentViewable,l.c.eupl),this.addDuration(e,l.c.contentEditable,l.c.timeToInteractive),this.addDuration(l.c.frameFetchStart,l.c.contentViewable,l.c.browserFetchStartToContentViewableDuration),this.addDuration(l.c.frameFetchStart,l.c.contentEditable,l.c.browserFetchStartToContentEditableDuration),this.addGetCellsStartToClientGetCellsFetchStartDuration()},e.prototype.addGetCellsStartToClientGetCellsFetchStartDuration=function(){if(l.c.contentFetchStart in this._pageLoadPerfMetrics&&l.c.frameResponseStart in this._pageLoadPerfMetrics&&l.c.frameFetchStart in this._pageLoadPerfMetrics){var e=this._pageLoadPerfMetrics[l.c.contentFetchStart],t=this._pageLoadPerfMetrics[l.c.frameResponseStart],n=this._pageLoadPerfMetrics[l.c.frameFetchStart];this._pageLoadPerfMetrics[l.c.getCellsStartToClientGetCellsFetchStartDuration]=e-(t-n)}},e.prototype.addDuration=function(e,t,n){if(t in this._pageLoadPerfMetrics){var i=this._pageLoadPerfMetrics[t];this.addDurationMetric(e,n,i)}},e.get_instance=function(){return e._instance||(e._instance=new e)},e.zeroPad=function(e,t){for(var n="",i=e.length;i<t;i++)n+="0";return n+e},e._instance=null,e}();(0,r.l)(h,"PageLoadPerfRecorder",null,[o])},function(e,t,n){"use strict";n.d(t,{s:function(){return d}});var i=n(208),r=n(530),o=n(255),a=n(254),s=n(134),l=n(966),u=n(836),c=n(513),p=n(946),d=function(){function e(e,t,n,i,r,o,a){void 0===r&&(r=null),void 0===o&&(o=!0),void 0===a&&(a=!0),this._id=null,this._elmDOM=null,this._parent=null,this._root=null,this._children=null,this._dirty=!0,this._visible=!0,this._enabled=!0,this._disposed=!1,this._enabledHasBeenSet=!1,this._description=null,this._title=null,this._keytip=null,this._originalCssDisplay="",this._visibleInDOM=!0,this._ignoreDirtyingEvents=!1,this._delayedInitHandler=null,this._delayedInitData=null,this._delayedInitOptions=null,this._delayedInitInProgress=!1,this._lastPollTime=null,this._id=t,this._root=e,this._title=n,this._description=i,this._visible=o,a&&this.ensureChildren(),r&&(this._keytip=new l.v(r,this._id))}return e.prototype.ensureChildren=function(){c.x(this._children)&&(this._children=new u.y)},e.prototype.get_id=function(){return this._id},e.prototype.set_id=function(e){return this._id=e,e},e.prototype.get_elementInternal=function(){return this._elmDOM},e.prototype.set_elementInternal=function(e){return this._elmDOM=e,e},e.prototype.get_root=function(){return this._root},e.prototype.get_parent=function(){return this._parent},e.prototype.set_parent=function(e){return this._parent=e,e},e.prototype.get_children=function(){return this._children},e.prototype.set_children=function(e){return this._children=e,e},e.prototype.updateFocusedIndex=function(e){return this===e},e.prototype.resetFocusedIndex=function(){},e.prototype.focusNext=function(e){return!1},e.prototype.getChildInternal=function(e){for(var t=this._children.getEnumerator();t.moveNext();){var n=t.get_current();if(n.get_id()===e)return n}return null},e.prototype.getChild=function(e){return this.getChildInternal(e)},e.prototype.getChildByTitle=function(e){for(var t=this._children.getEnumerator();t.moveNext();){var n=t.get_current();if(n.get_title()===e)return n}return null},e.prototype.addChild=function(e){this.addChildInternal(e,!0)},e.prototype.addChildInternal=function(e,t){this.addChildAtIndexInternal(e,-1,t)},e.prototype.addChildAtIndex=function(e,t){this.addChildAtIndexInternal(e,t,!0)},e.prototype.addChildAtIndexInternal=function(t,n,i){if(i&&this.ensureCorrectChildType(t),!c.x(t.get_parent())){var r=String.format(e.addChildAlreadyAddedExcpetionMessage,t.get_id(),this.get_id(),t.get_parent().get_id());throw o.ULS.shipAssertTag(4334035,201,!1,r),Error.create(r)}-1===n?this._children.add(t):this._children.insert(n,t),t.set_parent(this),this.onDirtyingChange()},e.prototype.removeChild=function(e){var t=this.getChildInternal(e);if(c.x(t))throw Error.create("The child with id: "+e+" is not as child of this Component");this._children.remove(t),t.set_parent(null),this.onDirtyingChange()},e.prototype.removeChildren=function(){for(var e=this._children.getEnumerator();e.moveNext();){var t=e.get_current();t&&t.set_parent(null)}this._children.clear(),this.onDirtyingChange()},e.prototype.ensureCorrectChildType=function(e){},e.prototype.initRootMember=function(e){if(!c.x(this._root))throw Error.create("Root member has already been set for this Component.");this._root=e},e.prototype.get_visible=function(){return this._visible},e.prototype.set_visible=function(e){return this.set_visibleInternal(e),e},e.prototype.get_visibleInternal=function(){return this.get_visible()},e.prototype.set_visibleInternal=function(e){var t=this._visible;return this._visible=e,t!==this._visible&&(this.onDirtyingChange(),c.x(this._parent)||this._parent.onChildrenVisibleChanged()),e},e.prototype.onChildrenVisibleChanged=function(){if(this._children&&this._children.get_count()>0){for(var e=!1,t=this._children.getEnumerator();t.moveNext();){if(t.get_current().get_visible()){e=!0;break}}this.set_visible(e)}},e.prototype.get_enabled=function(){return this._enabled},e.prototype.set_enabled=function(e){if(this._enabled===e&&this._enabledHasBeenSet)return e;if(!c.x(this.get_parent())&&!this.get_parent().get_enabled()&&e)throw Error.create("This Component with id: "+this.get_id()+" cannot be Enabled because its parent is Disabled");this._enabled=e,this._enabledHasBeenSet=!0;for(var t=this._children.getEnumerator();t.moveNext();){t.get_current().set_enabled(e)}return this.onEnabledChanged(e),e},e.prototype.onEnabledChanged=function(e){},e.prototype.get_title=function(){return this.get_titleInternal()},e.prototype.set_title=function(e){return this.set_titleInternal(e),this.onDirtyingChange(),e},e.prototype.get_titleInternal=function(){return this._title},e.prototype.set_titleInternal=function(e){return this._title=e,e},e.prototype.get_description=function(){return this._description},e.prototype.set_description=function(e){return this._description=e,this.onDirtyingChange(),e},e.prototype.get_dirty=function(){return this._dirty},e.prototype.set_dirty=function(e){return this._dirty=e,e},e.prototype.setDirtyRecursively=function(e){if(this.set_dirty(e),!c.x(this._children))for(var t=this._children.getEnumerator();t.moveNext();){t.get_current().setDirtyRecursively(e)}},e.prototype.onDirtyingChange=function(){this.get_dirty()||this._ignoreDirtyingEvents||(this.set_dirty(!0),c.x(this._parent)||this._parent.onDirtyingChange())},e.prototype.get_ignoreDirtyingEvents=function(){return this._ignoreDirtyingEvents},e.prototype.set_ignoreDirtyingEvents=function(e){return this._ignoreDirtyingEvents=e,e},e.prototype.refreshInternal=function(){this.set_dirty(!1)},e.prototype.ensureRefreshed=function(){this.get_dirty()&&this.refreshInternal()},e.prototype.ensureDOMElement=function(){this._elmDOM||(this._elmDOM=p.n.createElement(this.get_domElementTagName()),this._elmDOM.className=this.get_cssClass(),this.get_id()&&(this._elmDOM.id=this.get_id()))},e.prototype.get_domElementTagName=function(){return"span"},e.prototype.get_cssClass=function(){return""},e.prototype.get_visibleInDOM=function(){return!c.x(this.get_parent())&&(this._visibleInDOM&&this.get_parent().get_visibleInDOM())},e.prototype.set_visibleInDOM=function(e){return this.get_root().get_supportsDynamicDisplayMode()&&(this._visibleInDOM=e,this._visibleInDOM?this.removeHideElementOverride():this.applyHideElementOverride()),e},e.prototype.setFocusOnFirstControl=function(){if(!this.get_visible())return!1;for(var e=this.get_children().getEnumerator();e.moveNext();){if(e.get_current().setFocusOnFirstControl())return!0}return!1},e.prototype.ensureDOMElementAndEmpty=function(){c.x(this.get_elementInternal())?this.ensureDOMElement():this.set_elementInternal(p.n.removeChildNodes(this.get_elementInternal()))},e.prototype.appendChildrenToElement=function(e){for(var t=this.get_root().get_supportsInvisibleControls(),n=document.createDocumentFragment(),i=this._children.getEnumerator();i.moveNext();){var r=i.get_current();r.ensureDOMElement(),t&&!r.get_visible()||n.appendChild(r.get_elementInternal()),r.ensureRefreshed()}e.appendChild(n)},e.prototype.getTextValue=function(){return null},e.prototype.onMenuClosed=function(){if(!c.x(this._children))for(var e=this._children.getEnumerator();e.moveNext();){e.get_current().onMenuClosed()}},e.prototype.setDelayedInitData=function(e,t,n){this._delayedInitHandler=e,this._delayedInitData=t,this._delayedInitOptions=n},e.prototype.doDelayedInit=function(){if(!this._delayedInitInProgress){if(c.x(this._delayedInitHandler))throw Error.create("No delayedinit handler present in this component: "+this.get_id());this._delayedInitInProgress=!0,this._delayedInitHandler(this,this._delayedInitData,this._delayedInitOptions)}},e.prototype.onDelayedInitFinished=function(e){e&&(this._delayedInitHandler=null,this._delayedInitData=null,this._delayedInitOptions=null,this.onDirtyingChange()),this._delayedInitInProgress=!1},e.prototype.get_needsDelayIniting=function(){return!c.x(this._delayedInitHandler)},e.prototype.pollForStateAndUpdateInternal=function(){if(this._children)for(var e=this._children.getEnumerator();e.moveNext();){e.get_current().pollForStateAndUpdateInternal()}else this._disposed?o.ULS.sendTraceTag(35129304,220,15,"PollForStateAndUpdateInternal is called after component is disposed"):o.ULS.sendTraceTag(35129305,220,50,"PollForStateAndUpdateInternal is called and children is null")},e.prototype.ensureBehaviorAttached=function(){for(var e=this._children.getEnumerator();e.moveNext();){e.get_current().ensureBehaviorAttached()}},e.prototype.get_lastPollTime=function(){return c.x(this._lastPollTime)&&(this._lastPollTime=new Date,this._lastPollTime.setTime(0)),this._lastPollTime},e.prototype.set_lastPollTime=function(e){return this._lastPollTime=e,e},e.prototype.get_rootPolledSinceLastPoll=function(){return this.get_lastPollTime().getTime()<this.get_root().get_lastPollTime().getTime()||!this.get_lastPollTime().getTime()},e.prototype.pollIfRootPolledSinceLastPoll=function(){this.get_rootPolledSinceLastPoll()&&this.pollForStateAndUpdateInternal()},e.prototype.applyHideElementOverride=function(){"none"!==this.get_elementInternal().style.display&&(this._originalCssDisplay=this.get_elementInternal().style.display),this.get_elementInternal().style.display="none"},e.prototype.removeHideElementOverride=function(){this.get_elementInternal().style.display=this._originalCssDisplay},e.prototype.dispose=function(){if(!c.x(this._children)){for(var e=this._children.getEnumerator();e.moveNext();){e.get_current().dispose()}this._children=null}this._parent=null,this._root=null,this._delayedInitData=null,this._delayedInitHandler=null,this._delayedInitOptions=null,this._elmDOM=null,this._disposed=!0},e.prototype.get_keytip=function(){return this._keytip},e.prototype.get_hasKeytip=function(){return!!this._keytip},e.prototype.get_keytipDomContainer=function(){return this._elmDOM},e.prototype.ensureKeytip=function(e,t,r,o){if(this.get_hasKeytip()&&c.x(this.get_keytip().get_element())&&!c.x(e)&&!c.x(t)){e.appendChild(this.get_keytip().createKeytipElement());var u="";if(i.r(n(866).Jewel,this.get_root())&&a.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()){var p=this.get_keytip().get_key().toLocaleLowerCase(),d=o?String.format("ktp-{0}-{1}",o,p):String.format("ktp-{0}",p);u=String.format("ktp-layer-id {0}",d),t.setAttribute("data-ktp-target",d),t.setAttribute("data-ktp-execute-target",d)}else u=r?String.format("{0} {1}",r,this.get_keytip().get_elementId()):String.format("{0} {1}",l.v.ribbonShortcutId,this.get_keytip().get_elementId());s.t.setAriaAttribute(t,s.t.ariaDescribedByAttribute,u)}},e.prototype.showKeytip=function(e){return!(!this.get_visible()||!this.get_hasKeytip())&&(!this.get_keytip().get_element()&&this.get_keytipDomContainer()&&this.get_keytipDomContainer().appendChild(this.get_keytip().createKeytipElement()),this.get_keytip().show(e),!0)},e.prototype.hideKeytip=function(){this.get_hasKeytip()&&this.get_keytip().hide()},e.addChildAlreadyAddedExcpetionMessage="Child with id '{0}' cannot be added to component id '{1}', already been added to component id '{2}'.",e}();(0,i.l)(d,"Component",null,[r.x,Sys.IDisposable])},function(e,t,n){"use strict";n.d(t,{r:function(){return a}});var i=n(508),r=n(267),o=n(208),a=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,"",r.get_controlProperties().Keytip,void 0,!1)||this;return o._control=null,o._control=r,o.set_visible(o._control.get_visible()),o}return(0,i.t)(t,e),t.prototype.get_displayMode=function(){return this.get_title()},t.prototype.isMenuItem=function(){return t.isDisplayModeMenu(this.get_displayMode())},t.prototype.refreshInternal=function(){this.set_dirty(!1)},t.prototype.get_elementInternal=function(){return this._control.getDOMElementForDisplayMode(this.get_title(),this)},t.prototype.set_elementInternal=function(e){throw Error.create("Cannot set the DOM Element of ControlComponents.  They get their DOM Elements from the Control.")},t.prototype.get_componentElement=function(){return e.prototype.get_elementInternal.call(this)},t.prototype.get_control=function(){return this._control},t.prototype.get_enabled=function(){return this._control.get_enabled()},t.prototype.set_enabled=function(e){return this._control.set_enabled(e),e},t.prototype.get_visible=function(){return!(this.get_root().get_supportsInvisibleControls()&&!this._control.get_visible())&&e.prototype.get_visible.call(this)},t.prototype.set_visible=function(t){return e.prototype.set_visible.call(this,t),t},t.prototype.get_keytipDomContainer=function(){return this._control.get_displayedComponent().get_elementInternal()},t.prototype.onEnabledChanged=function(e){this._control.onEnabledChanged(e)},t.prototype.ensureCorrectChildType=function(e){this._control.ensureCorrectChildType(e)},t.prototype.get_textValue=function(){return this.get_control().getTextValue()},t.prototype.pollForStateAndUpdateInternal=function(){this.get_control().pollForStateAndUpdate()},t.prototype.ensureBehaviorAttached=function(){this.get_control().ensureBehaviorAttachedIfAvailable()},t.prototype.onMenuClosed=function(){this.get_control().onMenuClosed()},t.prototype.setFocusOnFirstControl=function(){return this.get_control().setFocusOnControl()},t.prototype.dispose=function(){this.get_control().dispose(),this._control=null,e.prototype.dispose.call(this)},t.isDisplayModeMenu=function(e){return e.startsWith("Menu")||"Initials"===e},t}(r.s);(0,o.l)(a,"ControlComponent",r.s,[])},,,,function(e,t,n){"use strict";n.r(t),n.d(t,{ContinuableTask$1:function(){return a}});var i=n(508),r=n(208),o=n(473),a=function(e){function t(n){var i=e.call(this,n)||this;return i._action$2=null,i._actionWithData$2=null,i._parent=null,r.m(i,t.$$(n)),i}return(0,i.t)(t,e),t.prototype.execute=function(){return this._action$2?this.set_result(this._action$2(this._parent)):this.set_result(this._actionWithData$2(this._parent,this._data)),!0},t.C=function(e,n){var i=new t(r.f(this,"$$sc.Task.ContinuableTask$1").TResult);return i._action$2=e,i._parent=n,i},t.CO=function(e,n,i){var o=new t(r.f(this,"$$sc.Task.ContinuableTask$1").TResult);return o._actionWithData$2=e,o._data=n,o._parent=i,o},t.$$=function(e){var n="ContinuableTask$1$"+e.getName(),i=r.x(n);return i||r.u(n,"$$sc.Task.ContinuableTask$1",t,[{TResult:e}],o.Task$1.$$(e),[])},t}(o.Task$1)},function(e,t,n){"use strict";var i=n(936),r=n(208),o=function(){function e(e){this.properties=null,this.properties=e}return e.prototype.get_properties=function(){return this.properties},e.prototype.dispose=function(){},e}();(0,r.l)(o,"RegisteredObjectProperties",null,[Sys.IDisposable]);var a=n(164),s=n(825),l=n(495);n.d(t,{h:function(){return u}});var u=function(){function e(){this._refCount=0,this._properties={},this._unregisteredProperties={},this._registeredObjectProperties=[]}return e.prototype.start=function(){++this._refCount},e.prototype.stop=function(){--this._refCount||(this._properties={},this._unregisteredProperties={})},e.prototype.registerProperty=function(e){this._properties[e.id.toString()]=e,this.addRegisteredObjectProperty(e)},e.prototype.unregisteredPropertiesRead=function(e){return this._unregisteredProperties[e]},e.prototype.unregisteredPropertiesAdd=function(e,t){this._unregisteredProperties[e]=t},e.prototype.addRegisteredObjectProperty=function(e){e.type!==l.y.objectId&&e.type!==l.y.arrayOfObjectIds||Array.add(this._registeredObjectProperties,e)},e.prototype.readRegisteredObjectProperties=function(){return new o(this._registeredObjectProperties)},e.prototype.findPropertyByStringId=function(e){var t=this._properties[e];return t||(t=this.unregisteredPropertiesRead(e)),t},e.prototype.lookupProperty=function(e){var t=e.toString(),r=this._properties[t];if(r||(r=this.unregisteredPropertiesRead(t)),!r){var o=s.d(e);if(!n(62).CommonProperties.nil)throw i.b("Cannot find the common property definitions");var l=this._properties[s.u(2,o,s.d(e)).toString()],u=new a.t(e,l.type,0);this.unregisteredPropertiesAdd(t,u),this.addRegisteredObjectProperty(u),r=u}return r},e.prototype.isPersistedProperty=function(e){switch(s.c(e)){case 8:case 0:case 6:case 16:case 17:case 26:return!1;default:return!0}},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,r.l)(u,"PropertiesManager",null,[])},,function(e,t,n){"use strict";n.r(t),n.d(t,{BreadcrumbContainer:function(){return c}});var i=n(508),r=n(3),o=n(547),a=n(98),s=n(254),l=n(306),u=n(208),c=function(e){function t(){var t=e.call(this)||this;return t._breadcrumbItems=null,t.set_elmContainer(a.k.createUnselectableElement("span")),t.get_elmContainer().className="cui-herobar-breadcrumbContainer",t.get_elmContainer().id="viewerChrome-breadcrumbContainer",s.AFrameworkApplication.hideHeader&&(o.CuiHelper.createAppBrandElement(t.get_elmContainer()),(s.AFrameworkApplication.breadcrumbBrandName||s.AFrameworkApplication.breadcrumbFolderName)&&o.CuiHelper.createAppBrandSeparatorElement(t.get_elmContainer())),t._breadcrumbItems=o.CuiHelper.createHostBrandAndFolderElements(t.get_elmContainer(),o.CuiHelper.breadcrumbAlternateSeparatorImageName),t}return(0,i.t)(t,e),t.prototype.getBreadcrumbItem=function(e){if(!this._breadcrumbItems)return null;for(var t=0;t<this._breadcrumbItems.length;t++)if(this._breadcrumbItems[t].id===e)return this._breadcrumbItems[t];return null},t.prototype.truncateWidth=function(n){if(this._elementToTruncate=this.getBreadcrumbItem(o.CuiHelper.breadcrumbFolderId),this._elementToTruncate){var i=t.calculateBreadcrumbFolderNameMaxWidth(this.get_elmContainer().offsetWidth,this._elementToTruncate.offsetWidth,n);i>0&&e.prototype.truncateWidth.call(this,i)}},t.prototype.dispose=function(){l.EventHandlerManager.get_instance().unregisterAllHandlersForDOMArray(this._breadcrumbItems)},t.calculateBreadcrumbFolderNameMaxWidth=function(e,t,n){return t-(e-n)},t}(r.m);(0,u.l)(c,"BreadcrumbContainer",r.m,[])},,,,,function(e,t,n){"use strict";n.d(t,{n:function(){return l}});var i=n(252),r=n(254),o=n(867),a=n(851),s=n(208),l=function(){function e(){this.BaseDocQuerySignature=null,this.RoamingApp=0}return e.prototype.serialization=function(){return o.w([this.getClassId(),this])},e.prototype.execute=function(e,t,n){var o={"Content-Type":"application/json; charset=utf-8"},s="RoamingAppsHandler.ashx";i.x.get_instance().get_roamingAppsAreEnabled()&&document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")>0&&(s=a.n.addOrReplaceParameterValue(s,"wdEnableRoaming","1")),r.AFrameworkApplication.theClientRequestManager.addRequest(s,2,this.serialization(),o,!1,this.getPriority(),e,t,n,void 0,void 0,void 0,void 0,"6")},e}();(0,s.l)(l,"ARoamingAppsRequest",null,[])},,function(e,t,n){"use strict";n.r(t),n.d(t,{PDFConvertFailureDialog:function(){return p}});var i=n(508),r=n(223),o=n(255),a=n(941),s=n(980),l=n(254),u=n(23),c=n(208),p=function(e){function t(t){var n=e.call(this,t,l.AFrameworkApplication.isCloseable)||this;return n._isDisposed=!1,s.s(),n}return(0,i.t)(t,e),t.prototype.get_hasBeenDisposed=function(){return this._isDisposed},t.prototype.set_hasBeenDisposed=function(e){return this._isDisposed=e,e},t.prototype.get_messageString=function(){return CommonUIStrings.l_PdfConvertFailureDialogMessage},t.prototype.get_linkString=function(){return CommonUIStrings.l_PdfConvertFailureDialogLinkSuggestion},t.prototype.get_linkId=function(){return"DownloadPDFCopyLink"},t.prototype.prepareDialog=function(){this.set_hasCloseGlyph(l.AFrameworkApplication.isCloseable),e.prototype.prepareDialog.call(this)},t.prototype.logDialogDisplayed=function(){o.ULS.sendTraceTag(7660227,301,50,"Download a PDF copy dialog displayed after PDF converter error")},t.prototype.logDownloadLinkClicked=function(){o.ULS.sendTraceTag(7660228,301,50,"Download a PDF copy dialog clicked after PDF converter error")},t.prototype.dispose=function(){this.get_hasBeenDisposed()||(e.prototype.dispose.call(this),a.App.get_activeAppFrame().get_ribbonUser()&&a.App.get_activeAppFrame().get_ribbonUser().poll(),u.p.closeAppOnErrorWithFailoverToBlank(),a.App.get_activeAppFrame().get_workspace().dispose(),this.set_hasBeenDisposed(!0))},t}(r.v);(0,c.l)(p,"PDFConvertFailureDialog",r.v,[])},,,,function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var i=n(208),r=function(){function e(){}return e.blur="Blur",e.click="Click",e.focus="Focus",e.keyUp="KeyUp",e.keyDown="KeyDown",e.menuChanged="MenuChanged",e.interactionBegin="InteractionBegin",e.interactionEnd="InteractionEnd",e.mouseOver="MouseOver",e.mouseOut="MouseOut",e}();(0,i.l)(r,"EventKeys",null,[])},function(e,t,n){var i=n(247);e.exports=function(e){if(!i(e))throw TypeError(String(e)+" is not an object");return e}},function(e,t,n){"use strict";n.d(t,{p:function(){return u}});var i=n(508),r=n(208),o=n(267),a=n(134),s=n(268),l=n(946),u=function(e){function t(n,i,r,o,a){var s=e.call(this,n,i,r,o)||this;return s.prop=null,s._elmDim=0,s._width=0,s._focusedIndex=-1,s.set_properties(a),s.set_width(parseInt(s.get_properties().Width)),s.set_elementDimensions(t.convertStringToGalleryElementDimensions(s.get_properties().ElementDimensions)),s}return(0,i.t)(t,e),t.prototype.get_domElementTagName=function(){return"table"},t.prototype.get_cssClass=function(){return"cui-gallery"},t.prototype.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.get_elementInternal().setAttribute(a.t.ariaRoleAttribute,a.t.ariaGridRole);var e=l.n.createElement("tbody");this.get_elementInternal().appendChild(e),this.appendChildrenToElement(e)},t.prototype.appendChildrenToElement=function(e){for(var t,n,i,r=Math.ceil(this.get_children().get_count()/this.get_width()),o=0,s=0;s<r;s++){(t=l.n.createElement("tr")).setAttribute(a.t.ariaRoleAttribute,a.t.ariaRowRole),t.setAttribute(a.t.ariaLabelAttribute,String.format(CommonUIStrings.l_GalleryRowAccessibleLabelFormat,s+1));for(var u=0;u<this.get_width();u++)(n=l.n.createElement("td")).setAttribute(a.t.ariaRoleAttribute,a.t.ariaPresentationRole),n.className="cui-gallery-td cui-gallery-element-"+l.n.galleryElementDimensionsToSizeString[this.get_elementDimensions()],o<this.get_children().get_count()&&((i=this.get_children().get_item(o++)).ensureDOMElement(),n.appendChild(i.get_elementInternal()),i.ensureRefreshed()),t.appendChild(n);e.appendChild(t)}},t.prototype.updateFocusedIndex=function(e){for(var t=0,n=this.get_children().getEnumerator();n.moveNext();){if(n.get_current().updateFocusedIndex(e))return this._focusedIndex=t,!0;t++}return!1},t.prototype.resetFocusedIndex=function(){if(this.get_children().get_count()){this._focusedIndex=-1;for(var e=this.get_children().getEnumerator();e.moveNext();){e.get_current().resetFocusedIndex()}}},t.prototype.focusNext=function(e){var t=this.get_children().get_count(),i=n(951).Control.focusNextIndexInGrid(this._focusedIndex,this.get_width(),t,e);if((this._focusedIndex>=0&&this._focusedIndex<t&&this.get_children().get_item(this._focusedIndex).resetFocusedIndex(),i!==this._focusedIndex)&&this.get_children().get_item(i).get_control().setFocusOnControl())return this._focusedIndex=i,!0;return this._focusedIndex=-1,!1},t.prototype.ensureCorrectChildType=function(e){if(!r.r(s.r,e))throw Error.create("Galleries can only have children controls of type GalleryButton");var t=e;if(!r.r(n(317).GalleryButton,t.get_control()))throw Error.create("Galleries can only have children of type GalleryButton")},t.prototype.get_tableElementInternal=function(){return this.get_elementInternal()},t.prototype.set_tableElementInternal=function(e){return this.set_elementInternal(e),e},t.prototype.get_elementDimensions=function(){return this._elmDim},t.prototype.set_elementDimensions=function(e){return this._elmDim=e,e},t.prototype.get_width=function(){return this._width},t.prototype.set_width=function(e){return this._width=e,e},t.prototype.get_properties=function(){return this.prop},t.prototype.set_properties=function(e){return this.prop=e,e},t.prototype.clone=function(e){for(var t=e.createGallery(this.get_id(),this.get_title(),this.get_description(),this.get_properties()),n=this.get_children().getEnumerator();n.moveNext();){var i=n.get_current(),r=i.get_control().clone(e);t.addChild(r.createComponentForDisplayMode(i.get_displayMode()))}return t},t.convertStringToGalleryElementDimensions=function(e){switch(e){case"Size16by16":return 1;case"Size40by40":return 2;case"Size48by48":return 3;case"Size61by75":return 4;case"Size64by48":return 5;case"Size85by48":return 6;case"Size110by75":return 7;case"Size85by16":return 8;case"Size32by32":return 9;case"Size120by20":return 10;case"Size20by20":return 11;case"Size24by24":return 12;case"Size84by21":return 13;case"Size90by21":return 14;default:throw Error.argument("s","The parameter s is not a valid GalleryElementDimension")}},t}(o.s);(0,r.l)(u,"Gallery",o.s,[])},,,,,,,function(e){e.exports=!1},function(e,t,n){"use strict";n.d(t,{s:function(){return u}});var i=n(929),r=n(644),o=n(59),a=n(425),s=n(556),l=n(208),u=function(){function e(){}return e.getChildById=function(e,t){if(!e||!t)return null;for(var n=e.firstChild;n&&n.id!==t;)n=n.nextSibling;return n},e.getChildByIdEndsWith=function(e,t){if(!e||!t)return null;for(var n=e.firstChild;n&&!o.h(n.id,t,0);)n=n.nextSibling;return n},e.addAsFirstChild=function(e,t){if(e&&t){var n=e.firstChild;n?e.insertBefore(t,n):e.appendChild(t)}},e.removeElement=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},e.getLeafElements=function(t){var n=new r.c(Object);if(t){var i=t.children;if(!i||!i.length)return n.add(t),n;for(var o=0,a=i.length;o<a;o++)n.addRange(e.getLeafElements(i[o]))}return n},e.getAllElements=function(t,n){var o=new r.c(Object);if(!t)return o;for(var a=t.childNodes.length,s=0;s<a;++s)o.addRange(e.getAllElements(t.childNodes[s],n));return(n||t.nodeType===i.o.element)&&o.add(t),o},e.getAllElementsCount=function(t,n){var r=0;if(!t)return r;for(var o=t.childNodes.length,a=0;a<o;++a)r+=e.getAllElementsCount(t.childNodes[a],n);return(n||t.nodeType===i.o.element)&&r++,r},e.getFirstChildByTagName=function(e,t){if(!e||!t)return null;t=s.l.toUpper(t);for(var n=0,r=e.childNodes.length;n<r;n++){var o=e.childNodes[n];if(o.nodeType===i.o.element&&s.l.toUpper(o.tagName)===t)return o}return null},e.clearElement=function(e){if(e)try{for(;e.hasChildNodes();)e.removeChild(e.firstChild)}catch(e){}},e.isDescendantOf=function(e,t){return!!e&&e.contains(t)},e.setElementText=function(e,t){e&&(e.innerText="",t&&t.length>0&&(1===e.childNodes.length?e.replaceChild(e.ownerDocument.createTextNode(t),e.firstChild):e.appendChild(e.ownerDocument.createTextNode(t))))},e.getDOMElementClassName=function(e){return e?e.className&&Object.getType(e.className)===String?e.className:e.nodeType===i.o.element&&e.getAttribute("class")?e.getAttribute("class").toString():"":""},e.getFirstNodeValueByTagNameOrDefault=function(e,t){if(!e||!t)return null;var n=e.getElementsByTagName(t);return n&&n[0]&&n[0].firstChild?n[0].firstChild.nodeValue:null},e.domTagToString=function(e){var t=null;switch(e){case 1:t="a";break;case 2:t="button";break;case 10:t="canvas";break;case 8:t="div";break;case 6:t="iframe";break;case 3:t="input";break;case 11:t="object";break;case 13:t="p";break;case 7:t="param";break;case 4:t="select";break;case 12:t="span";break;case 15:t="td";break;case 14:t="th";break;case 5:t="textarea"}return t},e.get_tagStrings=function(){return e._tagStrings||(e._tagStrings={},e._tagStrings.a=1,e._tagStrings.button=2,e._tagStrings.input=3,e._tagStrings.select=4,e._tagStrings.textarea=5,e._tagStrings.iframe=6,e._tagStrings.param=7,e._tagStrings.body=9,e._tagStrings.canvas=10),e._tagStrings},e.createElementWithInnerTextSafe=function(t,n){var i=null,r=e.domTagToString(t);return r&&((i=document.createElement(r)).innerText=n),i},e.createElementWithInnerText=function(e,t){var n=document.createElement(e);return n.innerText=t,n},e.getAncestorContainingCssClass=function(e,t){if(!e||!t)return null;for(var n=e.parentNode;n&&!Sys.UI.DomElement.containsCssClass(n,t);)n=n.parentNode;return n},e.getAncestorByClassName=function(e,t){if(!e||!t)return null;for(var n=e.parentNode;n&&n.className!==t;)n=n.parentNode;return n},e.getFirstAncestorElement=function(e){if(!e)return null;for(var t=e;t&&t.nodeType!==i.o.element;)t=t.parentNode;return t},e.getChildByClassNameNonExclusive=function(e,t){if(!e||!t)return null;for(var n=e.firstChild;n&&!Sys.UI.DomElement.containsCssClass(n,t);)n=n.nextSibling;return n},e.getChildByClassName=function(e,t){if(!e||!t)return null;for(var n=e.firstChild;n&&n.className!==t;)n=n.nextSibling;return n},e.getChildByClassNameStartWith=function(t,n){if(!t||!n)return null;for(var i=t.firstChild;i&&!o.r(e.getDOMElementClassName(i),n,0);)i=i.nextSibling;return i},e.getChildByClassNameStartWithRecursively=function(t,n){if(!t||!n)return null;var i=e.getChildByClassNameStartWith(t,n);if(!i)for(var r=0;r<t.childNodes.length&&!i;r++)i=e.getChildByClassNameStartWithRecursively(t.childNodes[r],n);return i},e.getChildByIdStartWith=function(e,t){if(!e||!t)return null;for(var n=e.firstChild;n&&!o.r(n.id,t,0);)n=n.nextSibling;return n},e.getChildrenByClassName=function(e,t){for(var n=e.firstChild,i=new r.c(Object);n;)n.className&&n.className.trim()===t&&i.add(n),n=n.nextSibling;return i.toArray()},e.parseCssSize=function(e){return!e||o.h(e,"%",0)||isNaN(parseInt(e))?0:parseInt(e)},e.parseCssSizeDouble=function(e){return!e||o.h(e,"%",0)||isNaN(parseFloat(e))?0:parseFloat(e)},e.setElementCssFloat=function(t,n){if(t)for(var i=0,r=e._cssFloatValues;i<r.length;i++){if(r[i]===n){var o=String.format("float: {0};",n),a=e._cssFloatRegex.exec(t.style.cssText);if(a){var s=a.toString();s!==o&&(t.style.cssText=t.style.cssText.replace(s,o));break}t.style.cssText+=o;break}}},e.setElementStyleTopInPixels=function(t,n){if(e.isValidElement(t)){var i=n+"px";t.style.top=i}},e.setElementStyleLeftInPixels=function(t,n){if(e.isValidElement(t)){var i=n+"px";t.style.left=i}},e.setElementStyleWidthInPixels=function(t,n){if(e.isValidElement(t)){var i=n+"px";t.style.width=i}},e.setElementStyleHeightInPixels=function(t,n){if(e.isValidElement(t)){var i=n+"px";t.style.height=i}},e.getElementStyleTopInPixels=function(t){return e.isValidElement(t)?e.getPixelSize(t.style.top):0},e.getElementStyleLeftInPixels=function(t){return e.isValidElement(t)?e.getPixelSize(t.style.left):0},e.getElementStyleWidthInPixels=function(t){return e.isValidElement(t)?e.getPixelSize(t.style.width):0},e.getElementStyleHeightInPixels=function(t){return e.isValidElement(t)?e.getPixelSize(t.style.height):0},e.getPixelSize=function(e){if(e&&-1!==e.indexOf("px")){var t=parseInt(s.l.substring(e,0,e.indexOf("px")));if(!isNaN(t))return t}return 0},e.getChildrenByTagName=function(e,t){t=s.l.toUpper(t);for(var n=new r.c(Object),o=0,a=e.childNodes.length;o<a;o++){var l=e.childNodes[o];l.nodeType===i.o.element&&s.l.toUpper(l.tagName)===t&&n.add(l)}return n.toArray()},e.copyChildNodes=function(t,n,i){void 0===i&&(i=!1),e.clearElement(n);var r=t.childNodes;if(r.length>0){for(var o=document.createDocumentFragment(),a=0,s=r.length;a<s;a++){var l=r[a];(i||"IFRAME"!==l.tagName)&&o.appendChild(l.cloneNode(!0))}n.appendChild(o)}},e.clearElementHtml=function(e){e&&""!==e.innerHTML&&(e.innerHTML="")},e.elementAttached=function(t){return!e.rootElementIfNotAttached(t)},e.getRootElementIfNotAttached=function(t){return e.rootElementIfNotAttached(t)},e.getTag=function(t){var n=e.get_tagStrings()[s.l.toLower(t.tagName||"")];return null!=n?n:0},e.isInDocument=function(e){return!!e&&!!e.parentNode&&!!e.parentNode.ownerDocument},e.isValidElement=function(e){return!!e&&!!e.ownerDocument},e.getElementText=function(t){if(!t)return"";if(t.nodeType===i.o.text){t.nodeValue;return t.nodeValue}for(var n="",r=0,o=t.childNodes.length;r<o;r++)n+=e.getElementText(t.childNodes[r]);return n},e.getElementTextLength=function(t){if(t.nodeType===i.o.text){t.nodeValue;return t.nodeValue.length}for(var n=0,r=0,o=t.childNodes.length;r<o;r++)n+=e.getElementTextLength(t.childNodes[r]);return n},e.isListTag=function(e){if(!e)return!1;var t=e.tagName.toLocaleLowerCase();return"ol"===t||"ul"===t},e.isEditable=function(e){return!(!e||a.y.get_isInternetExplorer11Up()&&"undefined"==typeof e.getAttribute)&&(("INPUT"===e.tagName&&"button"!==e.getAttribute("type")&&"image"!==e.getAttribute("type")&&"checkbox"!==e.getAttribute("type")||"SELECT"===e.tagName||"true"===e.getAttribute("contenteditable")||"TEXTAREA"===e.tagName)&&!e.disabled)},e.rootElementIfNotAttached=function(t){return t.nodeType===i.o.document?null:t.nodeType===i.o.element&&"HTML"===o.o(t.tagName)?null:t.parentNode&&e.elementHasChild(t.parentNode,t)?e.rootElementIfNotAttached(t.parentNode):t},e.elementHasChild=function(e,t){for(var n=0,i=e.childNodes.length;n<i;n++)if(e.childNodes[n]===t)return!0;return!1},e.getViewPortWidth=function(){return window.innerWidth},e.getViewPortHeight=function(){return window.innerHeight},e.ensureCSSClassOnElement=function(e,t){return!Sys.UI.DomElement.containsCssClass(e,t)&&(Sys.UI.DomElement.addCssClass(e,t),!0)},e.removeCSSClassFromElement=function(e,t){return!!Sys.UI.DomElement.containsCssClass(e,t)&&(Sys.UI.DomElement.removeCssClass(e,t),!0)},e.setFormattedTextToPlaceholders=function(e,t,n,i){for(void 0===i&&(i=null);e.hasChildNodes();)e.removeChild(e.firstChild);if(n&&"undefined"!=typeof n&&n.length){var r=new RegExp("{(\\d+)}|(?:{{)+|(?:(?!{\\d+}|(?:{{)+).)+","g");t.replace(r,(function(t,r){var o;if(r){var a=void 0,s=parseInt(r);a=isNaN(s)||s>=n.length?t:n[s]||"",i?o=i(a):((o=document.createElement("span")).setAttribute("dir","auto"),o.innerText=a)}else o=document.createTextNode(t);return e.appendChild(o),null}))}else e.innerText=t},e._cssFloatValues=["left","right","none","initial","inherit"],e._cssFloatRegex=new RegExp("float: *[A-Za-z]+;"),e._tagStrings=null,e}();(0,l.l)(u,"DomUtils",null,[])},,function(e,t,n){n(874),n(623),n(429),n(799);var i=n(908);e.exports=i.Set},function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var i=n(208),r=function(){function e(){this.ApplicationVersion=null,this.IsCoauthSession=!1,this.IsRealCoauthSession=!1,this.IsRealEdit=!1,this.HasReceivedInboundReplications=!1,this.SessionMergeInfo=0,this.CookieComplianceBanner=0,this.PrivacyNotice=0,this.Feedback=0,this.FrameMode=null,this.RenavigationReason=null,this.HasDataLoss=!1,this.ApplicationVersion="",this.IsCoauthSession=!1,this.IsRealCoauthSession=!1,this.IsRealEdit=!1,this.HasReceivedInboundReplications=!1,this.SessionMergeInfo=0,this.FrameMode="",this.CookieComplianceBanner=0,this.PrivacyNotice=0,this.HasDataLoss=!1}return e.prototype.markAsCoauthSession=function(){this.IsCoauthSession=!0},e.prototype.markAsRealEditSession=function(){this.IsRealEdit=!0},e.prototype.markAsActiveCoauthSession=function(){this.HasReceivedInboundReplications=!0},e}();(0,i.l)(r,"SessionFinishedDataPlumber",null,[])},,,function(e,t,n){"use strict";n.d(t,{t:function(){return i}});var i=(0,n(208).y)("IResourceTimingLogger")},,,,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=(0,r.y)("IEventHandlerRegistrationStrategy"),a=(0,r.y)("IEventHandlerManager"),s=n(809),l=n(550),u=n(255),c=n(995),p=n(605),d=function(){return function(e){this.proxyElement=null,this.eventProcessors=null,this.eventNameBindings=null,this.proxyElement=e,this.eventProcessors={},this.eventNameBindings={}}}();(0,r.l)(d,"EventHandlerProxyData",null,[]);var h=function(){return function(){this.isHandlerRegistered=!1,this.isPersistent=0,this.eventHandlerBindings=[],this.domEventHandlerBindings=[]}}();(0,r.l)(h,"EventNameBinding",null,[]);var g=function(e,t){return function(n){e(n,t)}},m=function(){function e(e,t){this.eventHandlerProxy=null,this.eventHandlerProxyData=null,this.eventHandlerProxyData=new d(t),this.eventHandlerProxy=g(e,this.eventHandlerProxyData)}return e.prototype.getEventNameBinding=function(e){var t=this.eventHandlerProxyData.eventNameBindings[e];return t||(t=new h,this.eventHandlerProxyData.eventNameBindings[e]=t),t},e}();(0,r.l)(m,"EventHandlerProxyCache",null,[]);var _=n(574),f=n(830),y=n(256),v=n(478),S=n(810),C=n(101),b=n(863),A=n(154),T=n(425),w=n(579),I=n(195),E=n(235);n.d(t,{EventHandlerManager:function(){return k}});var k=function(e){function t(t,n,i){var r=e.call(this)||this;return r._cpuMeter=null,r._wacCookieCompliance=null,r._eventHandlerRegistrationStrategy=null,r._enableClicksTask=null,r._clicksEnabled=!0,r._lastClickEventTime=0,r._isDragging=!1,r._eventBeingProcessed=null,r._isEventHandlingDisabled=!1,r._ignoreTaskManagerRunningRefCount=0,r._onEventInterruptedTask=null,r._onExceptionOccurred=null,r.cookieConsentClickHandler=null,r._onBeforeEventProcessedCallbacks={},r._onAfterEventProcessedCallbacks={},r._onAfterTouchEndProcessedHandlers=[],r._onTouchMoveHandlers=[],r._cpuMeter=t,r._wacCookieCompliance=n,i.execute((function(e){r._eventHandlerRegistrationStrategy=e})),r}return(0,i.t)(t,e),t.prototype.get_processingEvent=function(){return!!this._eventBeingProcessed},t.prototype.get_eventBeingProcessed=function(){return this._eventBeingProcessed},t.prototype.get_lastClickEventTime=function(){return this._lastClickEventTime},t.prototype.set_lastClickEventTime=function(e){return this._lastClickEventTime=e,e},t.prototype.get_isDragging=function(){return this._isDragging},t.prototype.set_isDragging=function(e){return this._isDragging=e,e},t.prototype.startIgnoringTaskManagerRunning=function(){this._ignoreTaskManagerRunningRefCount++},t.prototype.stopIgnoringTaskManagerRunning=function(){this._ignoreTaskManagerRunningRefCount>0&&this._ignoreTaskManagerRunningRefCount--},t.prototype.initializeListForElement=function(e,t,n,i){for(var r=0;r<e.length;r++)this.initializeEventForElement(e[r],t,n,i)},t.prototype.initializeEventForElement=function(t,n,i,r){e.prototype.initializeForElement.call(this,n),this.initializeForElementInternal(t,n,i,r)},t.prototype.initializeForElementInternal=function(e,t,n,i,r){void 0===r&&(r=!1),this.bindEventName(e,t,n,i,r).isPersistent++},t.prototype.deinitializeListForElement=function(e,t){for(var n=0;n<t.length;n++)this.deinitializeEventForElement(e,t[n])},t.prototype.deinitializeEventForElement=function(e,t){this.deinitializeForElement(e),this.deinitializeForElementInternal(e,t)},t.prototype.deinitializeForElementInternal=function(e,n,i){if(void 0===i&&(i=!1),n){if(!(a=t.getEventNameBinding(n,e)))return void u.ULS.sendTraceTag(4032353,310,15,"No event name binding found on element {0}.",e);this.deinitializeEventNameBinding(e,n,a,i)}else{var r=t.retrieveHandlerProxyCache(e).eventHandlerProxyData.eventNameBindings;for(var o in r){var a,s={key:o,value:r[o]},l=s.key;(a=s.value)?a.isHandlerRegistered&&this.deinitializeEventNameBinding(e,l,a):u.ULS.sendTraceTag(4032354,310,15,"No event name binding found on element {0} and event name for binding {1}.",e,l||"null")}}},t.prototype.deinitializeEventNameBinding=function(e,t,n,i){void 0===i&&(i=!1),n.isPersistent--,this.releaseEventListenerIfUnused(t,e,i)},t.prototype.setOnEventInterruptedTask=function(e){this._onEventInterruptedTask=e},t.prototype.setOnExceptionOccurred=function(e){this._onExceptionOccurred=e},t.prototype.registerHandler=function(e,t,n,i,r,o,a,s){void 0===s&&(s=!1),this.registerHandlerInternal(t,n,new p.a(e,o,a),!0,i,r,s)},t.prototype.registerRawEventHandler=function(e,t,n){this.registerHandlerInternal(e,t,n,!1)},t.prototype.registerHandlerInternal=function(e,t,n,i,r,o,a){void 0===r&&(r=2),void 0===o&&(o=null),void 0===a&&(a=!1);var s=this.bindEventName(e,t,r,o,a);Array.add(i?s.eventHandlerBindings:s.domEventHandlerBindings,n)},t.prototype.unregisterHandler=function(e,t,n,i,r){void 0===r&&(r=!1),this.unregisterHandlerInternal(t,n,(function(e){return i===e.handler}),!0,r)},t.prototype.unregisterRawEventHandler=function(e,t,n){this.unregisterHandlerInternal(e,t,(function(e){return n===e}),!1)},t.prototype.unregisterHandlerInternal=function(e,n,i,r,o){void 0===o&&(o=!1);var a=t.getEventNameBinding(e,n);a&&(this.removeHandlersFromBinding(r?a.eventHandlerBindings:a.domEventHandlerBindings,e,n,i),this.releaseEventListenerIfUnused(e,n,o))},t.prototype.removeHandlersFromBinding=function(e,t,n,i){void 0===i&&(i=null);for(var r=e.length-1;r>=0;r--)i&&!i(e[r])||(Array.removeAt(e,r))},t.prototype.unregisterAllHandlers=function(e){var n=t.retrieveHandlerProxyCache(e);if(n){var i=n.eventHandlerProxyData.eventNameBindings;for(var r in i){var o={key:r,value:i[r]},a=o.key,s=o.value;for(this.removeHandlersFromBinding(s.eventHandlerBindings,a,e),this.removeHandlersFromBinding(s.domEventHandlerBindings,a,e),this.releaseEventListenerIfUnused(a,e);s.isPersistent>0;)this.deinitializeForElementInternal(e,a)}}},t.prototype.unregisterAllHandlersForDOMArray=function(e){for(var t=0;t<e.length;++t)this.unregisterAllHandlers(e[t])},t.prototype.registerOnBeforeEventProcessed=function(e,t){this._onBeforeEventProcessedCallbacks[e]||(this._onBeforeEventProcessedCallbacks[e]=[]);var n=this._onBeforeEventProcessedCallbacks[e];Array.add(n,t)},t.prototype.registerOnBeforeEventsProcessed=function(e,t){for(var n=0;n<e.length;++n)this.registerOnBeforeEventProcessed(e[n],t)},t.prototype.registerOnAfterEventProcessed=function(e,t){this._onAfterEventProcessedCallbacks[e]||(this._onAfterEventProcessedCallbacks[e]=[]);var n=this._onAfterEventProcessedCallbacks[e];Array.add(n,t)},t.prototype.registerOnAfterEventsProcessed=function(e,t){for(var n=0;n<e.length;++n)this.registerOnAfterEventProcessed(e[n],t)},t.prototype.registerOnAfterTouchEndProcessed=function(e){Array.add(this._onAfterTouchEndProcessedHandlers,e)},t.prototype.unregisterOnAfterTouchEndProcessed=function(e){Array.contains(this._onAfterTouchEndProcessedHandlers,e)&&Array.remove(this._onAfterTouchEndProcessedHandlers,e)},t.prototype.registerOnTouchMove=function(e){Array.add(this._onTouchMoveHandlers,e)},t.prototype.unregisterOnTouchMove=function(e){Array.contains(this._onTouchMoveHandlers,e)&&Array.remove(this._onTouchMoveHandlers,e)},t.prototype.bindEventName=function(e,n,i,o,a){void 0===i&&(i=2),void 0===o&&(o=null),void 0===a&&(a=!1);var s=t.retrieveHandlerProxyCache(n);if(s||(s=new m(r.i(this,this.eventProxy,"eventProxy"),n),t.storeHandlerProxyCache(n,s)),o){var l=!1,u=s.eventHandlerProxyData,c=u.eventProcessors[e];if(c){for(var p=0,d=c.get_length();p<d;p++)if(c.peekAt(p)===o){l=!0;break}}else u.eventProcessors[e]=c=new b.j;l||c.enqueue(i,o)}var h=s.getEventNameBinding(e);return h.isHandlerRegistered||_.d.isSimulated(e)||(this._eventHandlerRegistrationStrategy?this._eventHandlerRegistrationStrategy.addDomEventHandler(n,e,s.eventHandlerProxy,a):this.addDomEventHandler(n,e,s.eventHandlerProxy,a),h.isHandlerRegistered=!0),h},t.prototype.eventProxy=function(e,t){var n=this;if(!this._isEventHandlingDisabled){var i=t,r=_.d.eventNameFromString(e.type),o=String.format("{0} / {1}[{2}]",r,i.proxyElement.tagName,i.proxyElement.id);if(!(!(null==e)&&!(void 0===e.rawEvent||null===e.rawEvent)&&e.rawEvent[l.n.markerFieldForEventsToBeIgnored]))if(this._onExceptionOccurred)try{this._cpuMeter.profileTopLevelTask((function(){n.eventProxyInternal(e,r,i)}),o,0)}catch(e){u.ULS.sendTraceTag(17114121,310,10,"EventProxy: Exception during event {0}",o),this._onExceptionOccurred(e)}else this._cpuMeter.profileTopLevelTask((function(){n.eventProxyInternal(e,r,i)}),o,0)}},t.prototype.eventProxyInternal=function(e,t,i){var r=this;if(t===_.d.mouseDown||t===_.d.msPointerDown||t===_.d.browserPointerDown||t===_.d.touchStart||t===_.d.keyDown){var o=new Date;n(254).AFrameworkApplication.set_latestActivityTime(o)}if(this._wacCookieCompliance.checkConsentWithSettings((function(){return(0,s.m)(new ConsentSettings(e,t),{clickEventCheckHandler:r.cookieConsentClickHandler})})),!this.filterClickAndMouseEvents(t,e)&&(this._ignoreTaskManagerRunningRefCount||!S.y.get_instance().get_isRunning()||!this.handleEventInterruptedTask(e,t))&&(void 0!==i.eventProcessors[t]||this.hasDomEventHandlersToExecute(i,t))){if(this._eventBeingProcessed=t,this.executeOnBeforeEventProcessedCallbacks(e,t),this.executeDomEventHandlers(i,t,e),this.executeEventProcessors(i,t,e),this.executeOnAfterEventProcessedCallbacks(e,t),t===_.d.touchEnd)for(var a=0;a<this._onAfterTouchEndProcessedHandlers.length;++a){(0,this._onAfterTouchEndProcessedHandlers[a])()}if(t===_.d.touchMove)for(a=0;a<this._onTouchMoveHandlers.length;++a){(0,this._onTouchMoveHandlers[a])()}this._eventBeingProcessed=null}},t.prototype.executeOnBeforeEventProcessedCallbacks=function(e,t){var n=this._onBeforeEventProcessedCallbacks[t];if(n)for(var i=0;i<n.length;++i)n[i](e)},t.prototype.executeOnAfterEventProcessedCallbacks=function(e,t){var n=this._onAfterEventProcessedCallbacks[t];if(n)for(var i=0;i<n.length;++i)n[i](e)},t.prototype.executeEventProcessors=function(e,t,n){var i=e.eventProcessors[t];if(void 0!==i)for(var r=0;r<i.get_length();r++){if(i.peekAt(r)(t,e.proxyElement,n))break}},t.prototype.hasDomEventHandlersToExecute=function(e,t){if(!e.eventNameBindings[t])return!1;var n=e.eventNameBindings[t].domEventHandlerBindings;return!!n&&n.length>0},t.prototype.executeDomEventHandlers=function(e,t,n){if(this.hasDomEventHandlersToExecute(e,t))for(var i=e.eventNameBindings[t].domEventHandlerBindings,r=0;r<i.length;r++){(0,i[r])(n)}},t.prototype.handleEventInterruptedTask=function(e,t){return(t!==_.d.message||!T.y.get_isInternetExplorer8())&&(this._onEventInterruptedTask&&this._onEventInterruptedTask(t),t!==_.d.touchStart&&t!==_.d.touchEnd||this.temporarilyDisableBrowserClicks(),t===_.d.touchEnd&&y.TouchAndHoldAdapter.cancelAnyPendingTouchAndHold(),l.n.cancelEvent(e),!0)},t.prototype.simulateBubblingEvent=function(e,n,i){for(var r=n,o=!1;!o&&r;){var a=t.retrieveHandlerProxyCache(r);if(a){var s=a.eventHandlerProxyData.eventProcessors[e];if(s)for(var l=0;l<s.get_length();l++){if(o=s.peekAt(l)(e,r,i)||o)break}}r=r.parentNode}},t.prototype.processEvent=function(e,n,i,r){var o=!1,a=t.retrieveHandlerProxyCache(i).eventHandlerProxyData.eventNameBindings[n];if(a)for(var s=0;s<a.eventHandlerBindings.length&&!o;s++){var l=a.eventHandlerBindings[s];r.userData=l.userData,o=l.handler(r)}return o},t.prototype.releaseEventListenerIfUnused=function(e,n,i){void 0===i&&(i=!1);var r=t.retrieveHandlerProxyCache(n),o=r.getEventNameBinding(e);if(o)try{o.isHandlerRegistered&&!o.eventHandlerBindings.length&&!o.domEventHandlerBindings.length&&o.isPersistent<=0&&(this._eventHandlerRegistrationStrategy?this._eventHandlerRegistrationStrategy.removeDomEventHandler(n,e,r.eventHandlerProxy,i):this.removeDomEventHandler(n,e,r.eventHandlerProxy,i),o.isHandlerRegistered=!1,delete r.eventHandlerProxyData.eventProcessors[e])}catch(t){u.ULS.sendTraceTag(51196386,310,15,"ReleaseEventListenerIfUnused: {0}",{Exception:t,ClassName:n.className,ID:n.id,eventName:e,useCapture:i})}else u.ULS.sendTraceTag(51196385,310,15,"binding is null when we try to release event listener")},t.prototype.filterClickAndMouseEvents=function(e,t){if(!this._clicksEnabled){if(e===_.d.click)return this.cancelBrowserClick(t),!0;if(f.p.isMouseEventName(e)&&!A.g.isTextField(t.rawEvent?t.rawEvent.srcElement:t.target))return l.n.cancelEvent(t),!0}return!1},t.prototype.temporarilyDisableBrowserClicks=function(){this._clicksEnabled=!1,this._enableClicksTask?(S.y.get_instance().deleteTask(this._enableClicksTask),S.y.get_instance().addTask(this._enableClicksTask)):(this._enableClicksTask=new v.c(2,1,t.maxClickDisabledTime,r.i(this,this.reenableBrowserClicks,"reenableBrowserClicks"),13),S.y.get_instance().addTask(this._enableClicksTask))},t.prototype.reenableBrowserClicks=function(e){this._clicksEnabled=!0,this._enableClicksTask=null},t.prototype.forceReenableBrowserClicks=function(){this.reenableBrowserClicks(null)},t.prototype.cancelBrowserClick=function(e){l.n.cancelEvent(e),S.y.get_instance().deleteTask(this._enableClicksTask),this.reenableBrowserClicks(null)},t.prototype.enableEventHandling=function(e){this._isEventHandlingDisabled=!e},t.get_instance=function(){return t._instance||(t._instance=t.createEventHandlerManager()),t._instance},t.createEventHandlerManager=function(){return new t(c.r.get_instance(),I.v.get_instance(),E.w.get_instance().resolveFuture(o))},t.disposeInputManager=function(){C.b(t._instance)},t.getEventNameBinding=function(e,n){var i=t.retrieveHandlerProxyCache(n);return i?i.getEventNameBinding(e):null},t.retrieveHandlerProxyCache=function(e){return w.j(e,t.inputDataName)},t.storeHandlerProxyCache=function(e,n){w.v(e,t.inputDataName,n)},t.inputDataName="HandlerCache",t.maxClickDisabledTime=1e3,t._instance=null,t}(l.n);(0,r.l)(k,"EventHandlerManager",l.n,[a])},,function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var i=(0,n(208).y)("IAppSettingsManager")},function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var i=(0,n(208).y)("IMacOfficeOffer")},,function(e,t,n){"use strict";n.d(t,{n:function(){return a}});var i=n(508),r=n(265),o=n(208),a=function(e){function t(t,n,i){var r=e.call(this,t,n,null,null,0,null,1,null,null,null,!1,!1,null,!1,!1)||this;return r._dynamicImport=null,r._dynamicImport=i,r}return(0,i.t)(t,e),t.prototype.addReference=function(){this.load()},t.prototype.reloadReference=function(){this.load()},t.prototype.load=function(){var e=this;this._dynamicImport().then((function(){e.scriptOnLoad(null)})).catch((function(t){return e.scriptOnError(null)}))},t.create=function(e,n,i){return new t(e,n,i)},t}(r.v);(0,o.l)(a,"WebpackScriptResourceWithAction",r.v,[])},,,,,,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(160),o=n(951),a=n(134),s=n(268),l=n(176),u=n(600),c=n(425),p=n(920),d=n(208),h=function(e){function t(t){var n=e.call(this,t)||this;return n.elmA=null,n}return(0,i.t)(t,e),t}(p.d);(0,d.l)(h,"GalleryButtonComponentDom",p.d,[]);var g=n(513),m=n(946),_=function(){function e(){}return e.prototype.buildControlDom=function(e,t){var n=new h(t);return this.buildGalleryButtonElements(e,t,(0,u.m)((function(){return n.elmControl}),(function(e){return n.elmControl=e})),(0,u.m)((function(){return n.elmA}),(function(e){return n.elmA=e})),(0,u.m)((function(){return n.elmImage}),(function(e){return n.elmImage=e})),(0,u.m)((function(){return n.elmIconContainer}),(function(e){return n.elmIconContainer=e}))),n},e.prototype.buildGalleryButtonElements=function(e,t,n,i,r,o){var s=e.get_properties(),l=g.x(s.Alt)?"":s.Alt,u=!g.x(s.InnerHTML);if(n.val=m.n.createElement(u?"div":"span"),n.val.setAttribute("mscui:controltype",e.get_controlType()),n.val.className="cui-gallerybutton cui-gallerybutton-"+m.n.galleryElementDimensionsToSizeString[e.elementDimensions],n.val.setAttribute("role","presentation"),i.val=m.n.createElement(u?"div":"a"),e.get_shouldIgnoreTitle()||(i.val.title=l),i.val.className="cui-gallerybutton-a",i.val.setAttribute(a.t.ariaRoleAttribute,e.get_ariaRole()),r.val=null,o.val=null,g.x(s.Alt)||e.get_shouldIgnoreTitle()||(i.val.title=s.Alt),u?i.val.tabIndex=0:m.n.addToTabLoop(i.val),n.val.appendChild(i.val),s.VerticalCenterAlign&&this.setAttributeToCenterAlignVertically(i.val),u)i.val.innerHTML=s.InnerHTML,m.n.setUnselectable(i.val,!0,!0);else{if(g.x(s.Image))throw Error.create("InnerHTML or Image must be defined for this GalleryButton");var c=7;switch(e.elementDimensions){case 1:c=4;break;case 2:c=6;break;case 3:c=7;break;case 5:c=8;break;case 6:c=9;break;case 9:c=5;break;case 10:c=15;break;case 11:c=13;break;case 12:c=12;break;case 13:c=16;break;case 14:c=17}r.val=m.n.createElement("img"),o.val=m.n.createClusteredImageContainerNew(c,s.Image,s.ImageClass,r.val,!0,!1),r.val.alt=l,i.val.appendChild(o.val)}},e.prototype.setAttributeToCenterAlignVertically=function(e){e.style.display="table",c.y.get_isSafari4Up()&&(e.style.width="100%",e.style.height="100%")},e}();(0,d.l)(_,"GalleryButtonDomStrategy",null,[]);var f=n(881);n.d(t,{GalleryButton:function(){return y}});var y=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i)||this;return o.componentDom=null,o._displayMode=null,o.elementDimensions=0,o.addDisplayMode("Large"),o.addDisplayMode("Menu"),o.addDisplayMode("MenuTellMe"),o.elementDimensions=r,o}return(0,i.t)(t,e),t.prototype.get_ariaRole=function(){return this.inMenu?a.t.ariaGridCellRole:e.prototype.get_ariaRole.call(this)},t.prototype.createComponentDomForDisplayMode=function(e){this.inMenu=s.r.isDisplayModeMenu(e);var t=new _;return this.componentDom=t.buildControlDom(this,e),this._displayMode=e,this.componentDom},t.prototype.get_controlType=function(){return o.Control.galleryButtonControlType},t.prototype.get_focusableElement=function(){return this.componentDom?this.componentDom.elmA:null},t.prototype.get_activatesOnPress=function(){return!0},t.prototype.getTextValue=function(){return this.get_properties().Alt},t.prototype.onStateChanged=function(){var e=this.get_stateProperties()[f.u.On],t=this.get_stateProperties()[f.u.IsRtl];m.n.toggleCSSClassOnElement(this.componentDom.elmControl,"cui-gallerybutton-highlighted",e),m.n.toggleCSSClassOnElement(this.componentDom.elmA,"cui-gallerybutton-a-ltr",1===t),m.n.toggleCSSClassOnElement(this.componentDom.elmA,"cui-gallerybutton-a-rtl",2===t);var n=this.inMenu?a.t.ariaSelectedAttribute:a.t.ariaPressedAttribute;a.t.setAriaAttribute(this.componentDom.elmA,n,e?a.t.ariaTrueValue:a.t.ariaFalseValue)},t.prototype.get_properties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n,this.elementDimensions)},t.prototype.constructClonedControlForMenu=function(e,t){return new l.d(e,this.get_id(),t)},t}(o.Control);(0,d.l)(y,"GalleryButton",o.Control,[r.a])},function(e,t,n){"use strict";var i=n(985),r=n(12),o=n(560);e.exports=function(e,t,n){var a=i(t);a in e?r.f(e,a,o(0,n)):e[a]=n}},function(e,t,n){"use strict";var i=n(508),r=n(208),o=function(){return function(){this.DivSyndicated=null,this.ImageDownArrow=null,this.ImageDownArrowClass=null,this.ImageDownArrow8by8=null,this.ImageDownArrow8by8Class=null,this.ImageSideArrow=null,this.ImageSideArrowClass=null,this.ImageUpArrow=null,this.ImageUpArrowClass=null,this.ImageUpArrow8by8=null,this.ImageUpArrow8by8Class=null,this.ImageCheckMark=null,this.ImageCheckMarkClass=null,this.ImageUncheckMark=null,this.ImageUncheckMarkClass=null,this.ImageCollapsedArrow=null,this.ImageCollapsedArrowClass=null,this.ImageExpandedArrow=null,this.ImageExpandedArrowClass=null,this.ImageSpinner=null,this.TextDirection=null,this.LabelText=null}}();(0,r.l)(o,"RootProperties",null,[]),n.d(t,{c:function(){return a}});var a=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t}(o);(0,r.l)(a,"StandaloneRootProperties",o,[])},function(e,t,n){"use strict";n.d(t,{d:function(){return a}});var i=n(508),r=n(771),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t.UpdateHtmlPostToggle=!1,t.AriaLabel=null,t}return(0,i.t)(t,e),t.prototype.get_ControlType=function(){return 2},t}(r.k);(0,o.l)(a,"ToggleButtonProps",r.k,[])},,function(e,t,n){"use strict";n.d(t,{i:function(){return r}});var i=n(208),r=function(){function e(){}return e.accessDenied=5373953,e.cannotFindSourceDocument=5373954,e.serviceBusy=5373955,e.inProgress=5373956,e.noManagerAvailable=5373957,e.documentFileExtensionDisabled=5373958,e.documentIsIRMProtected=5373959,e.documentIsEncrypted=5373960,e.fileTypeBlocked=5373961,e.printPdfNotGenerated=5373962,e.itemNotGenerated=5373963,e.cantCreateDocument=5373964,e.cantOpenDocument=5373965,e.documentHasOcx=5373966,e.documentRejectedByGatekeeper=5373967,e.fileTypeUnsupported=5373968,e.workerException=5373969,e.workerCrashed=5373970,e.workerHung=5373971,e.unexpectedError=5373972,e.unknownError=5373973,e.commentBeginInvalidPropertyData=5373974,e.commentBeginPermissionDenied=5373975,e.commentBeginUnspecifiedFailure=5373976,e.commentBeginOldProductDigitalSignature=5373977,e.commentBeginDocumentProtectionSettings=5373978,e.commentBeginDocumentPasswordEncrypted=5373979,e.commentBeginFileCheckedOut=5373980,e.commentBeginFileRequiresCheckout=5373981,e.commentBeginFileLockedForOfflineCheckout=5373982,e.commentBeginFileLockedByOtherInterface=5373983,e.commentBeginCorruptedFile=5373984,e.commentBeginNumberOfCoauthorsReachedMax=5373985,e.commentBeginDocumentMarkedFinal=5373986,e.commentBeginPreReleaseFile=5373987,e.commentBeginClientServerNormalizationConflict=5373988,e.commentBeginLockExpired=5373989,e.commentBeginWordFileVersionMismatch=5373990,e.commentBeginFileEditedInRichClient=5373991,e.commentBeginRequestCountTooLarge=5373992,e.commentSaveInvalidPropertyData=5373993,e.commentSaveUnspecifiedFailure=5373994,e.commentSavePermissionDenied=5373995,e.commentSaveOldProductDigitalSignature=5373996,e.commentSaveDocumentProtectionSettings=5373997,e.commentSaveDocumentPasswordEncrypted=5373998,e.commentSaveFileCheckedOut=5373999,e.commentSaveFileRequiresCheckout=5374e3,e.commentSaveFileLockedForOfflineCheckout=5374001,e.commentSaveFileLockedByOtherInterface=5374002,e.commentSaveNumberOfCoauthorsReachedMax=5374003,e.commentSaveWordFileVersionMismatch=5374004,e.commentSaveDocxCoherencyFailure=5374005,e.commentSaveCorruptedFile=5374006,e.commentSaveDocumentMarkedFinal=5374007,e.commentSavePreReleaseFile=5374008,e.commentSaveLockExpired=5374009,e.commentSaveFileEditedInRichClient=5374010,e.commentSaveRequestCountTooLarge=5374011,e.commentBeginCanaryFailure=5374012,e.commentSaveCanaryFailure=5374013,e.commentSaveRetryCountExceeded=5374014,e.commentNewSelectSomething=5374015,e.commentNewInvalidContent=5374016,e.commentBeginRefreshVersion=5374017,e.commentBeginRefreshNormalization=5374018,e.commentBeginNetworkError=5374019,e.commentLockRefreshCanaryFailure=5374020,e.stringsFailedToLoadWordViewer=5374021,e.stringsFailedToLoadCommonUI=5374022,e.hostCanaryFailure=5374023,e.unexpectedDocDataResponse=5374024,e.documentCorrupt=5374025,e.applicationServerError=5374026,e.documentAlreadyOpen=5374027,e.documentCannotBeTranslated=5374028,e.documentPasswordProtected=5374029,e.documentTooLong=5374030,e.invalidCurrentDocument=5374031,e.invalidParameter=5374032,e.thirdPartyPDFRendererFailed=5374033,e.thirdPartyXPSRendererFailed=5374034,e.translationServiceUnavailable=5374035,e}();(0,i.l)(r,"WordViewerErrorCode",null,[])},function(e,t,n){var i=n(499),r=n(786)("toStringTag"),o="Arguments"==i(function(){return arguments}());e.exports=function(e){var t,n,a;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),r))?n:o?i(t):"Object"==(a=i(t))&&"function"==typeof t.callee?"Arguments":a}},function(e,t,n){"use strict";n.d(t,{y:function(){return r}});var i=n(208),r=function(){return function(e,t){this.scrollTop=0,this.scrollLeft=0,this.scrollTop=e,this.scrollLeft=t}}();(0,i.l)(r,"ScrollData",null,[])},,,function(e,t,n){"use strict";n.r(t),n.d(t,{appChromeAlreadyLoaded:function(){return s},appChromeContainsAction:function(){return l},apiExists:function(){return u},selectorExists:function(){return c},apiExtensionExists:function(){return p},isSimplifiedReactRibbonUxEnabled:function(){return d},getRenderAppChromeSettings:function(){return h},initializeAppChrome:function(){return g}});var i=n(208),r=n(254),o=n(967),a=n(652),s=function(){return!!(window.appChrome&&appChrome.api&&appChrome.actions&&appChrome.selectors)},l=function(e){return s()&&!!appChrome.actions[e]},u=function(e){return s()&&!!appChrome.api[e]},c=function(e){return s()&&!!appChrome.selectors[e]},p=function(e){return s()&&!!appChrome[e]},d=function(){return!!r.AFrameworkApplication.get_activeFrame()&&r.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()},h=function(){var e={};e.negativeSign=r.AFrameworkApplication.get_numberFormat().negativeSign,e.numberDecimalDigits=r.AFrameworkApplication.get_numberFormat().numberDecimalDigits,e.numberDecimalSeparator=r.AFrameworkApplication.get_numberFormat().numberDecimalSeparator,e.numberNegativePattern=r.AFrameworkApplication.get_numberFormat().numberNegativePattern,e.numberGroupSeparator=r.AFrameworkApplication.get_numberFormat().numberGroupSeparator,e.numberGroupSizes=r.AFrameworkApplication.get_numberFormat().numberGroupSizes;var t={};return t.numberFormatInfo=e,t},g=function(e){appChrome.setAppSettings(r.AFrameworkApplication.appSettingsManager.get_appSettings()),appChrome.api.setWebpackPublicPath(o.y.get_isAppChromeLocalhostScriptEnabled()?o.y.get_scriptPath():r.AFrameworkApplication.get_staticContentScriptNameBase()),appChrome.setScriptLoader(i.i(e,e.loadScript,"loadScript")),appChrome.api.initializeLogger(new a.s)}},function(e,t,n){"use strict";n.r(t),n.d(t,{CheckRoamingRightsRequest:function(){return a}});var i=n(508),r=n(280),o=n(208),a=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.getPriority=function(){return 2},t.prototype.getClassId=function(){return 1},t}(r.n);(0,o.l)(a,"CheckRoamingRightsRequest",r.n,[])},function(e,t,n){var i=n(767),r=Math.min;e.exports=function(e){return e>0?r(i(e),9007199254740991):0}},,,,function(e,t,n){"use strict";n.d(t,{g:function(){return a}});var i=n(508),r=n(562),o=n(208),a=function(e){function t(t){return e.call(this,6,t)||this}return(0,i.t)(t,e),t}(r.w);(0,o.l)(a,"ShowAnimationEvent",r.w,[])},function(e,t,n){"use strict";n.d(t,{p:function(){return r}});var i=n(208),r=function(){return function(e,t){this.actionData=null,this.inputMethod=0,this.actionData=e,this.inputMethod=t}}();(0,i.l)(r,"ActionDataWithInputMethod",null,[])},function(e,t,n){"use strict";n.d(t,{h:function(){return i},b:function(){return r},w:function(){return o}});var i=function(e,t,n,i){void 0===i&&(i=0),i||(i=function(e){for(var t=2*e+1;;){for(var n=!1,i=Math.sqrt(t),r=t/2|0;r>=i;r--)if(!(t%r)){n=!0;break}if(!n)return t;t+=2}}(t.val.length));var r=t.val;t.val=new Array(i);for(var a=0;a<i;a++)t.val[a]=new Array(0);if(r)for(var s=0,l=r;s<l.length;s++)for(var u=0,c=l[s];u<c.length;u++){var p=c[u];Array.add(t.val[o(t.val,n.getHashCode(p))],p)}},r=function(e,t,n,r,a){var s=r.getHashCode(n),l=t.val[o(t.val,s)];return l.length>5&&a>3*t.val.length&&(i(e,t,r),l=t.val[o(t.val,s)]),l},o=function(e,t){var n=e.length,i=t%n;return i<0&&(i+=n),i}},,function(e,t,n){"use strict";n.d(t,{s:function(){return i},i:function(){return r}});var i=function(e,t){return e+Math.floor(Math.random()*(t-e+1))},r=function(e,t){var n=Math.pow(10,t);return Math.floor(Math.round(e*n))/n}},,,,,,,function(e,t,n){"use strict";var i,r=n(208);!function(e){e[e.doNotSet=0]="doNotSet",e[e.none=1]="none",e[e.lax=2]="lax",e[e.strict=3]="strict"}(i||(i={})),(0,r.h)("SameSite",i);var o=n(255),a=n(851),s=n(896),l=n(556);n.d(t,{i:function(){return u},g:function(){return c},p:function(){return p},r:function(){return d},q:function(){return h},z:function(){return g},l:function(){return m},w:function(){return f}});var u=390,c=function(e){return function(e){if(!e)return"";if(e.indexOf("=")>=0)throw Error.argumentOutOfRange();var t=""+document.cookie,n=new RegExp("(?:^|; )"+e+"=([^;]*)"),i=t.match(n);return!i||i.length<2?"":i[1]}(e)},p=function(e,t){return d(e,t,24)},d=function(e,t,n){return h(e,t,n,"")},h=function(e,t,n,i){var r=new Date;return r.setTime(r.getTime()+864e5*n),_(e,t,null,r,i,"")},g=function(e,t,n,i,r){var o=new Date;return o.setTime(o.getTime()+864e5*n),_(e,t,null,o,i,r)},m=function(e,t,n,i,r){return _(e,null,t,n,i,r)},_=function(e,t,n,r,a,c,p){if(void 0===p&&(p=1),e.indexOf("=")>=0)throw Error.argumentOutOfRange();var d="",h=c;(c=y(c))&&(d=";domain="+escape(c));var g="",m=new Date;m.setTime(m.getTime()+864e5*u),r>m&&(r=m),r&&(t||n)&&(g=";expires="+r.toUTCString());var f="";a&&(f=";path="+escape(a));var S="";document.URL.toLowerCase().startsWith("https://")&&(S=";Secure");var C="";p&&(C=";SameSite="+i[p],""===S&&o.ULS.sendTraceTag(51262751,209,15,"New versions of Chrome will ignore insecure SameSite cookies, which we attempted to write. SameSite:{0}",p));var b=e+"="+(t?l.l.urlKeyValueEncode(t):n?s.n(v(n),"&","="):"");return document.cookie=b+d+g+f+S+C,!(!document.cookie||-1===document.cookie.indexOf(b))||1===p&&_(e,t,n,r,a,h,0)},f=function(e){document.cookie=e+"="},y=function(e){var t=window.location.hostname;if(!(e=a.n.getOrigin(e)))return"";if(e=e.replace("http://","").replace("https://",""),(t=t.replace("http://","").replace("https://",""))===e)return"";for(var n=t.split("."),i=e.split("."),r="",o=n.length-1,s=i.length-1;o>=0&&s>=0;){var l=n[o];if(l!==i[s])break;r="."+l+r,o--,s--}return r},v=function(e){var t={};if(!e)return t;for(var n in e){var i={key:n,value:e[n]};t[l.l.urlKeyValueEncode(i.key)]=l.l.urlKeyValueEncode(i.value)}return t}},function(e,t,n){"use strict";n.d(t,{z:function(){return g}});var i=n(508),r=n(208),o=n(160),a=n(351),s=n(600),l=n(267),u=n(134),c=n(288),p=n(753),d=n(513),h=n(946),g=function(e){function t(t,n,i,r,o,a){var s=e.call(this,t,n,i,r)||this;return s._properties=null,s._elmSeparator=null,s._elmWrapper=null,s._elmTitle=null,s._elmItems=null,s._menuContext=null,s._isInComboboxListbox=!1,s._focusedIndex=-1,s._properties=o||{},s._menuContext=a,s}return(0,i.t)(t,e),t.prototype.refreshInternal=function(){var e=this;this.ensureDOMElementAndEmpty();var t=h.n.isTrue(this._properties.Loading),i=!d.x(this.get_title()),r=!h.n.isFalse(this._properties.ShowSeperator);if(!i&&r&&(this._elmSeparator=h.n.createElement("span"),this._elmSeparator.className="cui-menusection-separator",this._elmSeparator.setAttribute("role","separator"),this.get_elementInternal().appendChild(this._elmSeparator)),this._elmWrapper=h.n.createElement("div"),this._elmWrapper.className="cui-menusection",this._properties.Language&&this._elmWrapper.setAttribute("lang",this._properties.Language),this.get_elementInternal().appendChild(this._elmWrapper),i&&this.buildTitleForSection(this._elmWrapper,this.get_title(),(0,s.m)((function(){return e._elmTitle}),(function(t){return e._elmTitle=t}))),t){var o=h.n.createElement("img");o.alt="",o.src=this.get_root().get_properties().ImageSpinner,o.className="cui-ctl-spinner ",this._elmWrapper.appendChild(o)}else{this._elmItems=h.n.createElement("ul"),this._elmItems.className="cui-menusection-items","Menu16DescriptionEnabled"===this._properties.DisplayMode&&(this._elmItems.setAttribute(u.t.ariaLabelledByAttribute,this._properties.ArialabelledbyId),this._elmItems.setAttribute(u.t.ariaRoleAttribute,u.t.ariaGroupRole));var l=this.get_parent(),c=(0,a.e)(n(861).Menu,l);"Menu32"!==this._properties.DisplayMode&&"Menu48"!==this._properties.DisplayMode||c&&h.n.ensureCSSClassOnElement(l.get_elementInternal(),"cui-menu-large"),c&&(this._isInComboboxListbox=c.get_isComboboxListbox()),h.n.isTrue(this._properties.Scrollable)&&(this._elmItems.style.overflowY="auto",this._elmItems.style.position="relative"),d.t(this._properties.MaxHeight)||(this._elmItems.style.maxHeight=this._properties.MaxHeight),this._elmWrapper.appendChild(this._elmItems),this.appendChildrenToElement(this._elmItems)}},t.prototype.buildTitleForSection=function(e,t,n){var i;i=this.get_inContextMenu()?this.createTitleForContextMenuSection(t,n):n.val=this.createTextualTitleForSection("div",t),e.appendChild(i)},t.prototype.get_inContextMenu=function(){return r.r(n(744).ContextMenuRoot,this.get_root())&&("Menu16"===this._properties.DisplayMode||"Menu16DescriptionEnabled"===this._properties.DisplayMode)},t.prototype.createTitleForContextMenuSection=function(e,n){var i=h.n.createElement("li");i.className="cui-menusection-items cui-menusection-contextmenu-title",!h.n.isFalse(this._properties.ShowTitleBackground)||(i.style.background="transparent");var r=!h.n.isFalse(this._properties.TitleFocusable),o=t.createOuterElement("cui-ctl-menu cui-ctl-menu16",r);if(!h.n.isFalse(this._properties.ShowTitleIcon)){var a=this.createIconBlock(this._properties.Image,this._properties.ImageClass);o.appendChild(a)}var s=n.val=this.createTextualTitleForSection("span",e);o.appendChild(s),i.appendChild(o);var l=h.n.createElement("ul");return l.className="cui-menusection-items",l.appendChild(i),l},t.prototype.createIconBlock=function(e,t){var n=h.n.createElement("span");if(n.className="cui-ctl-iconContainer",e&&t){var i=h.n.createElement("img");i.alt="";var r=h.n.createClusteredImageContainerNew(4,e,t,i,!0,!1);n.appendChild(r)}return n},t.prototype.createTextualTitleForSection=function(e,t){var i=h.n.createElement(e);i.innerText=t;var o="cui-menusection-title-empty",a=u.t.ariaPresentationRole;return this._properties.TitleId&&i.setAttribute("id",this._properties.TitleId),d.t(t)||(o=(this.get_inContextMenu()?"cui-ctl-mediumlabel":"cui-menusection-title")+("Light"===this._properties.Theme?" cui-menusection-title-lightBackground":r.r(n(866).Jewel,this.get_root())?"":" UIFontBold"),a=u.t.ariaHeadingRole),i.className=o,i.setAttribute(u.t.ariaRoleAttribute,a),i},t.prototype.get_domElementTagName=function(){return"div"},t.prototype.get_selectableItemsCount=function(){for(var e=0,t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();if(r.r(p.m,n)){var i=(0,a.e)(p.m,n);i.get_control()&&r.r(o.a,i.get_control())&&e++}else e++}return e},t.prototype.appendChildrenToElement=function(e){var t,i=!0,s=this.get_selectableItemsCount(),l=0,c=0,d="",g=!1;this._menuContext&&(s=this._menuContext.get_selectableItemsCount(),l=this._menuContext.getSectionSelectableStartIndex(this));for(var m=this.get_children().getEnumerator();m.moveNext();){var _=m.get_current();(t=h.n.createElement("li")).className="cui-menusection-items",t.setAttribute(u.t.ariaRoleAttribute,u.t.ariaPresentationRole),i&&(h.n.ensureCSSClassOnElement(t,"cui-menusection-firstitem"),i=!1),_.ensureDOMElement();var f=(0,a.e)(p.m,_);(!f||f.get_control()&&r.r(o.a,f.get_control()))&&(_.get_elementInternal().setAttribute(u.t.ariaPosInSetAttribute,l+ ++c),_.get_elementInternal().setAttribute(u.t.ariaSetSizeAttribute,s),this._properties.TitleId&&_.get_elementInternal().setAttribute(u.t.ariaDescribedByAttribute,this._properties.TitleId)),this._isInComboboxListbox?_.get_elementInternal().setAttribute(u.t.ariaRoleAttribute,u.t.ariaOptionRole):(!f||f.get_control()&&r.r(n(697).FlyoutAnchor,f.get_control())&&f.get_control().get_useCheckMark())&&t.setAttribute(u.t.ariaRoleAttribute,u.t.ariaGroupRole),t.appendChild(_.get_elementInternal()),g||(g=!!(d=_.get_elementInternal().getAttribute(u.t.ariaRoleAttribute))&&d===u.t.ariaTabRole),e.appendChild(t),_.ensureRefreshed()}g&&e.setAttribute(u.t.ariaRoleAttribute,u.t.ariaTabListRole)},t.prototype.updateFocusedIndex=function(e){for(var t=0,n=this.get_children().getEnumerator();n.moveNext();){if(n.get_current().updateFocusedIndex(e))return this._focusedIndex=t,!0;t++}return!1},t.prototype.resetFocusedIndex=function(){if(this.get_children().get_count()){this._focusedIndex=-1;for(var e=this.get_children().getEnumerator();e.moveNext();){e.get_current().resetFocusedIndex()}}},t.prototype.focusNext=function(e){var t=this.get_children().get_count();return!(t<=0)&&(!!this.moveFocusFromIndex(this._focusedIndex,e)||(this._focusedIndex>=0&&this._focusedIndex<t&&this.get_children().get_item(this._focusedIndex).resetFocusedIndex(),this._focusedIndex=-1,!1))},t.prototype.moveFocusFromIndex=function(e,t){var n=this.get_children().get_count(),i=!t||4===t||6===t;-1===e&&(e=i?0:n-1);for(var r=e,o=this.get_children().getEnumeratorAtPos(r);i?o.moveNext():o.movePrevious();){if(o.get_current().focusNext(t))return this._focusedIndex>=0&&this._focusedIndex<n&&this._focusedIndex!==r&&this.get_children().get_item(this._focusedIndex).resetFocusedIndex(),this._focusedIndex=r,!0;r+=i?1:-1}return!1},t.prototype.ensureCorrectChildType=function(e){if(!r.r(p.m,e)&&!r.r(c.p,e))throw Error.create("MenuSections can only have children of type MenuItem or Gallery.")},t.prototype.get_separator=function(){return this._elmSeparator},t.prototype.get_titleElement=function(){return this._elmTitle},t.prototype.setTitleImmediate=function(e){this.set_titleInternal(e),this._elmTitle.innerText=e},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._elmSeparator=null,this._elmItems=null,this._elmTitle=null,this._elmWrapper=null},t.prototype.clone=function(e){for(var t=e.createMenuSection(this.get_id(),this.get_title(),this.get_description(),this._properties,this._menuContext),n=this.get_children().getEnumerator();n.moveNext();){var i=n.get_current();if(r.r(p.m,i)){var o=i.get_control().clone(e);t.addChild(o.createComponentForDisplayMode(this._properties.DisplayMode))}else r.r(c.p,i)&&t.addChild(i.clone(e))}return t},t.createOuterElement=function(e,t){void 0===t&&(t=!0);var n=h.n.createNoOpLink(t);return n.className=e,n},t}(l.s);(0,r.l)(g,"MenuSection",l.s,[])},,function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var i=(0,n(208).y)("IDialogMenuRootUser")},,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IDialogDownloadBehavior"),o=n(154);n.d(t,{r:function(){return a}});var a=function(){function e(e,t){this._url=null,this._openInCurrentTab=!1,this._url=e,this._openInCurrentTab=t}return e.prototype.attachDialog=function(e){},e.prototype.doDownload=function(){this._openInCurrentTab?o.g.downloadFile(this._url):window.open(this._url,"_blank")},e.prototype.dispose=function(){},e}();(0,i.l)(a,"OpenUrlInTabDialogDownloadBehavior",null,[r,Sys.IDisposable])},,function(e,t,n){"use strict";function i(e,t){return e.isInstanceOfType(t)?t:null}n.d(t,{e:function(){return i}})},function(e,t,n){"use strict";n.d(t,{l:function(){return r}});var i=function(e){if(null!=e)switch(e.toString().toLowerCase()){case"4":case"mouse":return 4;case"3":case"pen":return 3;case"2":case"touch":return 2}return 0},r=function(e){var t=0;return e?t=e.rawEvent?i(e.rawEvent.pointerType):i(e.pointerType):t}},,,function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var i=n(208),r=function(){function e(){}return e.close="UI_Close",e.fileProperties="UI_FileProperties",e.sharing="UI_Sharing",e.fileEmbed="UI_FileEmbed",e.copyAndEdit="UI_CopyAndEdit",e.replyWithChanges="UI_ReplyWithChanges",e.fileVersions="UI_FileVersions",e.fileClose="UI_Close",e.openInClient="UI_OpenInClient",e.signIn="UI_SignIn",e.redeemForCommenting="UI_RedeemForCommenting",e.workflow="UI_Workflow",e.checkUserAccessAndGrantPermissions="UI_CheckUserAccessAndGrantPermissions",e.checkUserAccessAndGrantPermissionsResult="CheckUserAccessAndGrantPermissions_Result",e.blurFocus="BlurFocus",e.grabFocus="GrabFocus",e.shareForm="UI_ShareForm",e.reportAbuse="UI_ReportAbuse",e.fileRename="File_Rename",e.fileRenameFailed="File_RenameFailed",e.blur_Focus="Blur_Focus",e.grab_Focus="Grab_Focus",e.conversation="UI_Conversation",e.openInBrowser="UI_OpenInBrowser",e.download="UI_Download",e.editMode="UI_Edit",e.canEmbed="CanEmbed",e.queryLoadingStatus="QueryLoadingStatus",e.appLoadingStatus="App_LoadingStatus",e.appTempError="App_TempError",e.appAllOK="App_AllOK",e.appFatalError=" App_FatalError",e.appNavigated="App_Navigated",e.broadcastGlobalId="Broadcast_GlobalId",e.broadcastInSync="Broadcast_InSync",e.broadcastLinkedNotesInfo="Broadcast_LinkedNotesInfo",e.broadcastNavigateToPage="Broadcast_NavigateToPage",e.broadcastOpenInClient="Broadcast_OpenInClient",e.broadcastOutOfSync="Broadcast_OutOfSync",e.broadcastError="Broadcast_Error",e.broadcastInitialized="Broadcast_Initialized",e.broadcastLocationChanged="Broadcast_LocationChanged",e.broadcastMediaState="Broadcast_MediaState",e.broadcastNavigate="Broadcast_Navigate",e.broadcastResize="Broadcast_Resize",e.broadcastSetOptions="Broadcast_SetOptions",e.broadcastState="Broadcast_State",e.broadcastSyncToPresenter="Broadcast_SyncToPresenter",e.checkPolicy="CheckPolicy",e.checkPolicyResponse="CheckPolicyResponse",e.hostPerfTiming="Host_PerfTiming",e.hostPostMessageReady="Host_PostmessageReady",e.loadTestSlice="Test_LTAS",e.editNotification="Edit_Notification",e.userActivity="User_Activity",e.addItem="AddItem",e.insert="Insert",e.addOtelEvent="AddOtelEvent",e.getCustomHeaders="GetCustomHeaders",e.getSessionId="GetSessionId",e.getCID="GetCID",e.insertImage="UI_InsertImage",e.insertImageHost="Host_InsertImage",e.insertFileLink="UI_InsertFileLink",e.insertFileLinkHost="Host_InsertFileLink",e.setCustomHeaders="SetCustomHeaders",e.setSessionId="SetSessionId",e.setCID="SetCID",e.cancelDialog="CancelDialog",e.showError="ShowError",e.showCFD="ShowCFD",e.showMOSS="ShowMOSS",e.commanding="Commanding",e.exitLT="Exit_LT",e.readyForStorageLT="readyForStorageId",e.requestLTFullScreen="immersiveReader-requestFullScreen",e.exitLTFullScreen="immersiveReader-exitFullScreen",e.getAccessToken="GetAccessToken",e.postAccessToken="PostAccessToken",e.getPrimaryIdentityInfo="GetPrimaryIdentityInfo",e.postPrimaryIdentityInfo="PostPrimaryIdentityInfo",e.ackMessage="Ack",e.wopiPendingComplete="WopiPendingSession_Complete",e.wopiPendingFail="WopiPendingSession_Fail",e.wopiStartSessionComplete="WopiStartSession_Complete",e.wopiSessionCompleteAck="WopiSession_Complete_Ack",e.jsApiDiagnostics="JsApiDiagnostics",e.wacInitializeReady="WacInitialize_Ready",e.wacInitializeReadyAck="WacInitialize_Ready_Ack",e.wacAppBootState="Wac_AppBootState",e.wacAppCompleted="Wac_AppCompleted",e.wacAppCompletedAck="Wac_AppCompleted_Ack",e.wacAppFailed="Wac_AppFailed",e.wacAppFailedAck="Wac_AppFailed_Ack",e.wacBeforeUnloadApp="Wac_BeforeUnloadApp",e.wacUnloadingApp="Wac_UnloadingApp",e.wacAppDataSavedStatus="Wac_AppDataSavedStatus",e.wacUnloadApp="Wac_UnloadApp",e.wacActionComplete="Wac_ActionComplete",e.hostCacheDiagnostic="HostCacheDiagnostic",e.setZoomLevel="SetZoomLevel",e.setCurrentPage="SetCurrentPage",e.appStateEvent="AppState",e.zoomChangeEvent="ZoomChanged",e.pageChangeEvent="PageChanged",e.pageCountEvent="PageCount",e.frameStateChangeEvent="StateChanged",e.browserEvent="BrowserEvent",e.zoomChangeEventAck="ZoomChanged_Ack",e.pageChangeEventAck="PageChanged_Ack",e.pageCountEventAck="PageCount_Ack",e.uI_SaveStatus="UI_SaveStatus",e.accessibilityLoopComplete="App_AccessibilityLoopComplete",e.hostAccessibilityLoopComplete="Host_AccessibilityLoopComplete",e.appSwitchMode="App_SwitchMode",e.hostSwitchMode="Host_SwitchMode",e.appRefreshSessionInfo="App_RefreshSessionInfo",e.hostRefreshSessionInfo="Host_RefreshSessionInfo",e.aadAuthSuccess="Aad_AuthSuccess",e.aadAuthSuccessAck="Aad_AuthSuccess_Ack",e.appUnloaded="App_Unloaded",e.hostUnload="Host_Unload",e.app_IsFrameTrusted="App_IsFrameTrusted",e.host_IsFrameTrusted="Host_IsFrameTrusted",e.documentRefresh="App_DocReboot",e.createNewDocument="App_CreateNewDocument",e.appWopiInfoFromUrl="App_WopiInfoFromUrl",e.hostWopiInfoFromUrl="Host_WopiInfoFromUrl",e.setOverlayContent="SetOverlayContent",e}();(0,i.l)(r,"CrossDocumentMessageId",null,[])},,,,,function(e,t,n){"use strict";n.d(t,{z:function(){return u}});var i=n(254),r=n(773),o=n(134),a=n(513),s=n(946),l=n(208),u=function(){function e(e,t,n,i){this._id=null,this._title=null,this._color=0,this._command=null,this._tabCount=0,this._elmMain=null,this._elmTitle=null,this._elmTabTitleContainer=null,this._id=e,this._title=t,this._color=n,this._command=i}return e.prototype.get_id=function(){return this._id},e.prototype.get_count=function(){return this._tabCount},e.prototype.get_title=function(){return this._title},e.prototype.get_color=function(){return this._color},e.prototype.get_command=function(){return this._command},e.prototype.get_elementInternal=function(){if(a.x(this._elmMain)){this._elmMain=s.n.createElement("li"),a.x(this.get_id())||(this._elmMain.id=this.get_id(),o.t.setAriaAttribute(this._elmMain,"aria-labelledby",this.get_id()+"_upper")),this._elmMain.setAttribute("role","group"),this._elmMain.className="cui-cg",i.AFrameworkApplication.get_activeFrame()&&i.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()||(this._elmMain.className+=" UITextTranformUpperCase");var t=e.getColorNameForContextualTabColor(this._color);t!==a.d&&s.n.ensureCSSClassOnElement(this._elmMain,"cui-cg-"+t);var n=s.n.createElement("div");n.className="cui-cg-i",a.x(this.get_id())||(n.id=this.get_id()+"_upper"),this._elmMain.appendChild(n),this._elmTitle=s.n.createElement("div"),this._elmTitle.className="cui-cg-t",n.appendChild(this._elmTitle);var r=s.n.createElement("span");r.className="cui-cg-t-i UISmallFont",i.AFrameworkApplication.get_activeFrame()&&i.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()&&(r.className="cui-cg-t-i"),r.innerText=this._title,this._elmTitle.appendChild(r),this._elmTabTitleContainer=s.n.createElement("ul"),this._elmTabTitleContainer.className="cui-ct-ul",a.x(this.get_id())||(this._elmTabTitleContainer.id=this.get_id()+"_lower"),this._elmMain.appendChild(this._elmTabTitleContainer),this._tabCount=0}return this._elmMain},e.prototype.addTabTitleDOMElement=function(e){this._elmTabTitleContainer.appendChild(e),this._tabCount++,1===this._tabCount?s.n.ensureCSSClassOnElement(this._elmTabTitleContainer,"cui-oneCtxTab"):2===this._tabCount&&s.n.removeCSSClassFromElement(this._elmTabTitleContainer,"cui-oneCtxTab")},e.prototype.ensureTabTitlesCleared=function(){a.x(this._elmTabTitleContainer)||s.n.removeChildNodesSlow(this._elmTabTitleContainer),this._tabCount=0},e.prototype.ensureTabTitleWidths=function(){if(!a.x(this._elmTabTitleContainer)&&this._tabCount>0)if(1!==this._tabCount){var e=Math.round(this._elmTabTitleContainer.offsetWidth),t=Math.round(this.getTotalTabTitleWidth());if(!(e<=t)){var n=Math.floor((e-t)/this._elmTabTitleContainer.childNodes.length);n>0&&this.adjustAllTabTitleWidths(n)}}else{this._elmTabTitleContainer.childNodes[0].style.width="100%"}},e.prototype.getTotalTabTitleWidth=function(){for(var e=0,t=0;t<this._elmTabTitleContainer.childNodes.length;t++){var n=this._elmTabTitleContainer.childNodes[t],i=0,o=0,a=r.o.getCurrentStyle(n);a&&(i=parseInt(a.marginLeft),i=isNaN(i)?0:i,o=parseInt(a.marginRight),o=isNaN(o)?0:o),e+=n.offsetWidth+i+o}return e},e.prototype.adjustAllTabTitleWidths=function(e){for(var t=0;t<this._elmTabTitleContainer.childNodes.length;t++){var n=this._elmTabTitleContainer.childNodes[t];n.style.width=n.offsetWidth+e+"px"}},e.prototype.dispose=function(){this._elmMain=null,this._elmTitle=null,this._elmTabTitleContainer=null,this._tabCount=0},e.getColorNameForContextualTabColor=function(e){switch(e){case 1:return"or";case 2:return"gr";case 3:return"mg";case 4:return"yl";case 5:return"pp";default:return a.d}},e}();(0,l.l)(u,"ContextualGroup",null,[Sys.IDisposable])},,,function(e,t,n){"use strict";n.d(t,{r:function(){return r}});var i=n(208),r=function(){function e(){}return e.topRowLeft="QATRowLeft",e.topRowCenter="QATRowCenter",e.topRowRight="QATRowRight",e.bottomRowLeft="TabRowLeft",e.bottomRowCenter="TabRowInline",e.bottomRowRight="TabRowRight",e}();(0,i.l)(r,"RibbonPeripheralSection",null,[])},,function(e,t,n){"use strict";n.r(t),n.d(t,{ToolbarContainer:function(){return s}});var i=n(508),r=n(10),o=n(98),a=n(208),s=function(e){function t(){var t=e.call(this)||this;return t.set_elmContainer(o.k.createUnselectableElement("span")),t.get_elmContainer().className="cui-herobar-toolbarContainer",t.get_elmContainer().id="viewerChrome-ToolbarContainer",t}return(0,i.t)(t,e),t}(r.x);(0,a.l)(s,"ToolbarContainer",r.x,[])},,function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var i=(0,n(208).y)("IEnumerator")},function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var i=n(508),r=n(603),o=n(255),a=n(17),s=n(988),l=n(208),u=function(e){function t(n,i,r){return void 0===r&&(r=null),e.call(this,n,i,r||a.i.get_instance(),t.initializeBrowserUlsImpl)||this}return(0,i.t)(t,e),t.initializeBrowserUlsImpl=function(){s.c.sendTraceTag=t.sendTraceTagImpl,s.c.debugAssertTag=t.debugAssertTagImpl},t.sendTraceTagImpl=function(e,n,i){for(var r=[],a=3;a<arguments.length;a++)r[a-3]=arguments[a];o.ULS.sendTraceTag.apply(null,[e,204,t.crmToUlsLevel(n),i].concat(r))},t.debugAssertTagImpl=function(e,t,n){void 0===n&&(n=null);for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r]},t.crmToUlsLevel=function(e){switch(e){case 0:return 200;case 1:return 100;case 2:return 50;case 4:return 15;case 3:return 10;default:return 100}},t.previousSessionParamName="wdPreviousSession",t.currentSessionParamName="wdUserSession",t}(r.c);(0,l.l)(u,"CommonCrossDocumentMessenger",r.c,[])},function(e,t,n){"use strict";n.d(t,{y:function(){return r}});var i=n(208),r=function(){return function(){this.isTouchClick=!1,this.isTouchDoubleClick=!1,this.clickArgs=null,this.isTouchClick=!1,this.isTouchDoubleClick=!1,this.clickArgs=null}}();(0,i.l)(r,"TouchClickResult",null,[])},,function(e,t,n){var i=n(287),r=n(439),o=n(329),a=n(175),s=n(457),l=n(761),u=function(e,t){this.stopped=e,this.result=t};(e.exports=function(e,t,n,c,p){var d,h,g,m,_,f,y=a(t,n,c?2:1);if(p)d=e;else{if("function"!=typeof(h=s(e)))throw TypeError("Target is not iterable");if(r(h)){for(g=0,m=o(e.length);m>g;g++)if((_=c?y(i(f=e[g])[0],f[1]):y(e[g]))&&_ instanceof u)return _;return new u(!1)}d=h.call(e)}for(;!(f=d.next()).done;)if((_=l(d,y,f.value,c))&&_ instanceof u)return _;return new u(!1)}).stop=function(e){return new u(!0,e)}},function(e,t,n){"use strict";n.d(t,{k:function(){return r}});var i=n(208),r=function(){function e(e,t){this._priority=0,this._data=null,this._priority=e,this._data=t}return e.prototype.get_priority=function(){return this._priority},e.prototype.get_data=function(){return this._data},e}();(0,i.l)(r,"PriorityQueueEntry",null,[])},,function(e){e.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},,,function(e,t,n){"use strict";var i=n(208),r=n(242),o=n(255),a=n(508),s=function(){function e(e){this.resourceUrl=null,this.failures=0,this.maxAttempts=0,this.resourceUrl=e}return e.prototype.get_resourceUrl=function(){return this.resourceUrl},e.prototype.get_failures=function(){return this.failures},e.prototype.get_maxAttempts=function(){return this.maxAttempts},e.prototype.set_maxAttempts=function(e){return this.maxAttempts=e,e},e.prototype.onFinishedLoadingResource=function(e){},e.prototype.onError=function(){this.failures=this.get_failures()+1},e.prototype.dispose=function(){},e}();(0,i.l)(s,"ResourceRetryBehavior",null,[Sys.IDisposable]);var l=3,u=function(e){function t(t){var n=e.call(this,t)||this;return n.set_maxAttempts(l),n}return(0,a.t)(t,e),t.prototype.shouldRetry=function(){return this.get_failures()<this.get_maxAttempts()},t.prototype.scheduleNextAttempt=function(e){e()},t}(s);(0,i.l)(u,"DefaultRetryBehavior",s,[]);var c=n(101),p=function(e){function t(t,n){var i=e.call(this)||this;return i.succeeded=!1,i.resourceUrl=null,i.succeeded=t,i.resourceUrl=n,i}return(0,a.t)(t,e),t.prototype.get_succeeded=function(){return this.succeeded},t.prototype.get_resourceUrl=function(){return this.resourceUrl},t}(Sys.EventArgs);(0,i.l)(p,"LoadFinishedEventArgs",Sys.EventArgs,[]);var d=n(586);n.d(t,{s:function(){return h}});var h=function(){function e(e,t,n,i,o){var a=this;void 0===i&&(i=null),void 0===o&&(o=!1),this._numberOfDependenciesLoaded=0,this._handlersAdded=!1,this._downloadResult=!1,this._shouldDownloadWithHighPriority=!1,this._tcs=null,this.resourceUrl=null,this.dependencies=null,this.cdn=null,this.element=null,this.status=0,this.retryBehavior=null,this.excludedScriptsForCheck=["common50.js","common.js"],this._eventSource=new d.f,this.resourceUrl=e,this.cdn=n,this.dependencies=t,this.retryBehavior=i||new u(e),this._shouldDownloadWithHighPriority=o,this.status=0,this._tcs=new r.z(Boolean),this.add_loadFinished((function(e,t){t.get_succeeded()?a._tcs.setResult(!0):a._tcs.SX(Error.create("Network"))}))}return e.prototype.get_TCS=function(){return this._tcs},e.prototype.get_isDownloading=function(){return 1===this.get_status()},e.prototype.get_isDownloaded=function(){return 2===this.get_status()},e.prototype.get_resourceUrl=function(){return this.resourceUrl},e.prototype.get_dependencies=function(){return this.dependencies},e.prototype.get_cdn=function(){return this.cdn},e.prototype.get_status=function(){return this.status},e.prototype.get_retryBehavior=function(){return this.retryBehavior},e.prototype.get_parentElement=function(){return this.get_couldGenerateLayout()?document.body:document.getElementsByTagName("head")[0]},e.prototype.add_loadFinished=function(e){this._eventSource.addHandler("LoadingFinished",e)},e.prototype.remove_loadFinished=function(e){this._eventSource.removeHandler("LoadingFinished",e)},e.prototype.add_loadStart=function(e){this._eventSource.addHandler("LoadingStart",e)},e.prototype.remove_loadStart=function(e){this._eventSource.removeHandler("LoadingStart",e)},e.prototype.get_loadFinishedTask=function(){return this._tcs.get_task()},e.prototype.loadResource=function(){switch(this.get_status()){case 2:this._eventSource.raiseEvent("LoadingFinished",new p(this._downloadResult,this.get_resourceUrl()),this);break;case 0:if(this._eventSource.raiseEvent("LoadingStart",Sys.EventArgs.Empty,this),this.status=1,this.get_dependencies())for(var e=0;2!==this.get_status()&&e<this.get_dependencies().length;e++)this.get_dependencies()[e].add_loadFinished(i.i(this,this.onDependencyLoaded,"onDependencyLoaded")),this.get_dependencies()[e].loadResource();else this.loadResourceInternal()}},e.prototype.loadResourceInternal=function(){this.get_cdn()?(this.get_cdn().add_loadFinished(i.i(this,this.onCdnDownloadFinished,"onCdnDownloadFinished")),this.get_cdn().addReference()):this.addReference()},e.prototype.onCdnDownloadFinished=function(e,t){t.get_succeeded()?this.finishedLoadingResource(!0):this.addReference()},e.prototype.onDependencyLoaded=function(e,t){e.remove_loadFinished(i.i(this,this.onDependencyLoaded,"onDependencyLoaded")),2!==this.get_status()&&(t.get_succeeded()?++this._numberOfDependenciesLoaded>=this.get_dependencies().length&&this.loadResourceInternal():this.finishedLoadingResource(!1))},e.prototype.addEventHandlers=function(){$addHandler(this.element,"load",i.i(this,this.scriptOnLoad,"scriptOnLoad")),$addHandler(this.element,"error",i.i(this,this.scriptOnError,"scriptOnError")),$addHandler(this.element,"readystatechange",i.i(this,this.onReadyStateChange,"onReadyStateChange")),this._handlersAdded=!0},e.prototype.finishedLoadingResource=function(e){(!e||this.get_retryBehavior().get_failures()>0)&&o.ULS.sendTraceTag(4563787,206,e?15:10,"{0}",{ResourceUrL:this.get_resourceUrl(),Successful:e,Failures:this.get_retryBehavior().get_failures(),MaxAttempts:this.get_retryBehavior().get_maxAttempts()}),this.get_retryBehavior().onFinishedLoadingResource(e),this._downloadResult=e,this.status=2,this._eventSource.raiseEvent("LoadingFinished",new p(e,this.get_resourceUrl()),this),this.dispose()},e.prototype.scriptOnLoad=function(e){this.finishedLoadingResource(!0)},e.prototype.scriptOnError=function(e){this.get_retryBehavior().onError(),this.get_retryBehavior().shouldRetry()?this.get_retryBehavior().scheduleNextAttempt(i.i(this,this.reloadReference,"reloadReference")):this.finishedLoadingResource(!1),e&&(e.preventDefault(),e.stopPropagation())},e.prototype.onReadyStateChange=function(e){var t=e.target.readyState;!t||"loaded"!==t&&"complete"!==t||this.finishedLoadingResource(!0)},e.prototype.dispose=function(){if(this.get_dependencies()){for(var e=0;e<this.get_dependencies().length;e++)this.get_dependencies()[e].remove_loadFinished(i.i(this,this.onDependencyLoaded,"onDependencyLoaded"));this.dependencies=null}this.get_cdn()&&(this.get_cdn().remove_loadFinished(i.i(this,this.onCdnDownloadFinished,"onCdnDownloadFinished")),this.cdn=null),this.removeEventHandlers(),c.b(this.get_retryBehavior()),this.retryBehavior=null,this._numberOfDependenciesLoaded=0},e.prototype.removeEventHandlers=function(){this._handlersAdded&&($removeHandler(this.element,"load",i.i(this,this.scriptOnLoad,"scriptOnLoad")),$removeHandler(this.element,"readystatechange",i.i(this,this.onReadyStateChange,"onReadyStateChange")),$removeHandler(this.element,"error",i.i(this,this.scriptOnError,"scriptOnError")),this._handlersAdded=!1)},e.prototype.addReference=function(){this.get_parentElement()?(this.element=this.createElement(),this.ensureHidden(this.element),this.addEventHandlers(),this._shouldDownloadWithHighPriority&&this.get_parentElement().appendChild(this.createHighPriorityResourceElement()),this.get_parentElement().appendChild(this.element)):this.finishedLoadingResource(!1)},e.prototype.ensureHidden=function(e){this.get_couldGenerateLayout()&&(e.style.visibility="hidden",e.style.position="fixed",e.style.top="-1000px")},e.prototype.checkIfResourceAlreadyLoaded_Debug=function(e){for(var t=0;t<e.children.length;t++){var n=e.children[t];if(n){var i=n.getAttribute("src");if(i&&i.toString().toLowerCase()===this.get_resourceUrl().toLowerCase()){var r=i.toString().toLowerCase().split("/"),o=r[r.length-1];Array.contains(this.excludedScriptsForCheck,o)}}}},e}();(0,i.l)(h,"DelayLoadedResource",null,[Sys.IDisposable])},,,,,function(e,t,n){var i=n(531),r=n(383),o=n(76),a=n(714),s=n(578),l=n(541),u=n(415),c=u.get,p=u.enforce,d=String(l).split("toString");r("inspectSource",(function(e){return l.call(e)})),(e.exports=function(e,t,n,r){var l=!!r&&!!r.unsafe,u=!!r&&!!r.enumerable,c=!!r&&!!r.noTargetGet;"function"==typeof n&&("string"!=typeof t||a(n,"name")||o(n,"name",t),p(n).source=d.join("string"==typeof t?t:"")),e!==i?(l?!c&&e[t]&&(u=!0):delete e[t],u?e[t]=n:o(e,t,n)):u?e[t]=n:s(t,n)})(Function.prototype,"toString",(function(){return"function"==typeof this&&c(this).source||l.call(this)}))},function(e,t,n){var i=n(531),r=n(578),o=n(295),a=i["__core-js_shared__"]||r("__core-js_shared__",{});(e.exports=function(e,t){return a[e]||(a[e]=void 0!==t?t:{})})("versions",[]).push({version:"3.1.3",mode:o?"pure":"global",copyright:"\xa9 2019 Denis Pushkarev (zloirock.ru)"})},,,function(e,t,n){"use strict";n.d(t,{k:function(){return u}});var i=n(931),r=n(550),o=n(369),a=n(579),s=n(635),l=n(208),u=function(){function e(){this._lastClickEvent=null,this._clickPendingPoint=null}return e.prototype.onTouchStart=function(t,n){e._sClickPossible=!0,this._clickPendingPoint=new Sys.UI.Point(t.get_elementPoint().x,t.get_elementPoint().y),this.isDoubleClick(t,n)&&r.n.cancelEventInternal(t.innerEvent,!0)},e.prototype.onTouchMove=function(e){this._clickPendingPoint&&(this._clickPendingPoint=Math.pow(this._clickPendingPoint.x-e.get_elementPoint().x,2)+Math.pow(this._clickPendingPoint.y-e.get_elementPoint().y,2)<=100?this._clickPendingPoint:null)},e.prototype.onTouchEnd=function(t,n){var r=new o.y;if(this._clickPendingPoint&&e._sClickPossible){r.isTouchClick=!0,r.clickArgs=i.q.createFromTouchArgs(t);var a=t;this.isDoubleClick(t,n)&&(r.isTouchDoubleClick=!0,a=null),this._lastClickEvent=a}return this._clickPendingPoint=null,r},e.prototype.onTouchCancel=function(e){this._clickPendingPoint=null},e.prototype.cancelPendingClick=function(){this._clickPendingPoint=null},e.prototype.isDoubleClick=function(e,t){var i=!!this._lastClickEvent&&e.get_timestamp().getTime()-this._lastClickEvent.get_timestamp().getTime()<=1e3&&Math.abs(e.get_screenPoint().x-this._lastClickEvent.get_screenPoint().x)<=40&&Math.abs(e.get_screenPoint().y-this._lastClickEvent.get_screenPoint().y)<=40;return n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SelectWordOnDoubleTapIsEnabled")&&!i&&t&&(i=e.get_timestamp().getTime()-t.get_timestamp().getTime()<=1e3&&Math.abs(e.get_screenPoint().x-t.get_screenPoint().x)<=40&&Math.abs(e.get_screenPoint().y-t.get_screenPoint().y)<=40),i},e.getTouchClickAdapter=function(t){var n=a.j(t,e.touchClickAdapterDataName);return n||(n=new e,a.v(t,e.touchClickAdapterDataName,n)),n},e.cancelAllPendingClicks=function(){e._sClickPossible=!1},e.touchClickAdapterDataName=s.z.touchClickAdapterCache,e._sClickPossible=!0,e}();(0,l.l)(u,"TouchClickAdapter",null,[])},,,function(e,t,n){e.exports=n(264)},function(e,t,n){"use strict";n.d(t,{j:function(){return r}});var i=n(208),r={$$:function(e){var t="IBaseInputManager$1$"+e.getName();return(0,i.g)(t)}}},function(e,t,n){"use strict";n.d(t,{k:function(){return i}});var i,r=n(208);!function(e){e[e.unknown=0]="unknown",e[e.excel=1]="excel",e[e.powerPoint=2]="powerPoint",e[e.word=3]="word",e[e.oneNote=4]="oneNote",e[e.visio=5]="visio"}(i||(i={})),(0,r.h)("OfficeAppType",i)},,function(e,t,n){"use strict";var i=n(12).f,r=n(38),o=n(455),a=n(175),s=n(79),l=n(371),u=n(793),c=n(249),p=n(57),d=n(764).fastKey,h=n(415),g=h.set,m=h.getterFor;e.exports={getConstructor:function(e,t,n,u){var c=e((function(e,i){s(e,c,t),g(e,{type:t,index:r(null),first:void 0,last:void 0,size:0}),p||(e.size=0),null!=i&&l(i,e[u],e,n)})),h=m(t),_=function(e,t,n){var i,r,o=h(e),a=f(e,t);return a?a.value=n:(o.last=a={index:r=d(t,!0),key:t,value:n,previous:i=o.last,next:void 0,removed:!1},o.first||(o.first=a),i&&(i.next=a),p?o.size++:e.size++,"F"!==r&&(o.index[r]=a)),e},f=function(e,t){var n,i=h(e),r=d(t);if("F"!==r)return i.index[r];for(n=i.first;n;n=n.next)if(n.key==t)return n};return o(c.prototype,{clear:function(){for(var e=h(this),t=e.index,n=e.first;n;)n.removed=!0,n.previous&&(n.previous=n.previous.next=void 0),delete t[n.index],n=n.next;e.first=e.last=void 0,p?e.size=0:this.size=0},delete:function(e){var t=h(this),n=f(this,e);if(n){var i=n.next,r=n.previous;delete t.index[n.index],n.removed=!0,r&&(r.next=i),i&&(i.previous=r),t.first==n&&(t.first=i),t.last==n&&(t.last=r),p?t.size--:this.size--}return!!n},forEach:function(e){for(var t,n=h(this),i=a(e,arguments.length>1?arguments[1]:void 0,3);t=t?t.next:n.first;)for(i(t.value,t.key,this);t&&t.removed;)t=t.previous},has:function(e){return!!f(this,e)}}),o(c.prototype,n?{get:function(e){var t=f(this,e);return t&&t.value},set:function(e,t){return _(this,0===e?0:e,t)}}:{add:function(e){return _(this,e=0===e?0:e,e)}}),p&&i(c.prototype,"size",{get:function(){return h(this).size}}),c},setStrong:function(e,t,n){var i=t+" Iterator",r=m(t),o=m(i);u(e,t,(function(e,t){g(this,{type:i,target:e,state:r(e),kind:t,last:void 0})}),(function(){for(var e=o(this),t=e.kind,n=e.last;n&&n.removed;)n=n.previous;return e.target&&(e.last=n=n?n.next:e.state.first)?"keys"==t?{value:n.key,done:!1}:"values"==t?{value:n.value,done:!1}:{value:[n.key,n.value],done:!1}:(e.target=void 0,{value:void 0,done:!0})}),n?"entries":"values",!n,!0),c(t)}}},function(e,t,n){var i=n(908),r=n(531),o=function(e){return"function"==typeof e?e:void 0};e.exports=function(e,t){return arguments.length<2?o(i[e])||o(r[e]):i[e]&&i[e][t]||r[e]&&r[e][t]}},function(e,t,n){"use strict";n.d(t,{w:function(){return r}});var i=n(208),r=function(){return function(){this.launchedLeft=!1,this.launchedUp=!1,this.viewPortHeight=0,this.viewPortWidth=0,this.flyoutTop=0,this.flyoutLeft=0,this.flyoutWidth=0,this.flyoutHeight=0}}();(0,i.l)(r,"MenuPositioningInfo",null,[])},function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var i=(0,n(208).y)("ICrossDocumentMessenger")},function(e,t,n){"use strict";n.d(t,{s:function(){return i}});var i=(0,n(208).y)("IContainerConfiguration")},,function(e,t,n){"use strict";n.d(t,{m:function(){return d}});var i=n(351),r=n(255),o=n(196),a=n(564),s=n(867),l=n(699),u=n(163),c=n(540),p=n(208),d=function(){function e(){}return e.populateSessionDimensions=function(){n(456).Health.get_instance().recordDimension("application",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.Application)||""),n(456).Health.get_instance().recordDimension("applicationLcid",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.ApplicationLCID)||""),n(456).Health.get_instance().recordDimension("applicationMode",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.ApplicationMode)||""),n(456).Health.get_instance().recordDimension("applicationModeExtended",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.ApplicationModeExtended)||""),n(456).Health.get_instance().recordDimension("arrVersion",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.ARRVersion)||""),n(456).Health.get_instance().recordDimension("browser",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.Browser)||""),n(456).Health.get_instance().recordDimension("browserLcid",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.BrowserLCID)||""),n(456).Health.get_instance().recordDimension("browserMajorVersion",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.BrowserMajorVersion)||""),n(456).Health.get_instance().recordDimension("browserMinorVersion",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.BrowserMinorVersion)||""),n(456).Health.get_instance().recordDimension("clientVersion",n(254).AFrameworkApplication.buildVersion),n(456).Health.get_instance().recordDimension("datacenter",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.WACDatacenter)||""),n(456).Health.get_instance().recordDimension("dataSource","Browser"),n(456).Health.get_instance().recordDimension("deviceName",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.DeviceName)||""),n(456).Health.get_instance().recordDimension("fileExtension",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.FileExtension)||""),n(456).Health.get_instance().recordDimension("host",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.Host)||""),n(456).Health.get_instance().recordDimension("ring",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.Ring)||"-1"),n(456).Health.get_instance().recordDimension("session_id",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.WACSessionID)||""),n(456).Health.get_instance().recordDimension("wfeVersion",(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.WFEVersion)||"")},e.initialize=function(){try{if(!n(254).AFrameworkApplication.appSettingsManager)return void r.ULS.sendTraceTag(42554066,383,10,"AppSettingsManager is null so couldn't fully initialize Health.");e.isHealthTelemetrySystemEnabled=n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HealthTelemetrySystemIsEnabled"),e.isHealthTelemetrySystemEnabled&&(e.isQosRecorderEnabled=n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsQosRecorderEnabled"),e.isKpiRecorderEnabled=n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsKpiRecorderEnabled"),e.remoteTelemetryUrl=n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl"),e.heartbeatIntervalMs=n(254).AFrameworkApplication.appSettingsManager.getIntAppSetting("HealthTelemetrySystemHeartbeatIntervalMs",3e5),e.recordQosPillarToWarmPipelineIntervalMs=n(254).AFrameworkApplication.appSettingsManager.getIntAppSetting("HealthTelemetrySystemRecordQosPillarToWarmPipelineIntervalMs",864e5),e.populateSessionDimensions(),n(456).Health.get_instance()&&(n(456).Health.get_instance().setQosHandlerForWarmPipeline((function(t,n,i){e.sendToWarmPipeline(t,n,i)})),n(456).Health.get_instance().setKpiHandlerForWarmPipeline((function(t,n,i){e.sendToWarmPipeline(t,n,i)})),n(456).Health.get_instance().setQosHandlerForOtelLibraryLoader((function(){try{o.r.get_instance().isCompleted(13)||o.r.get_instance().setAppInitializationStatus(13),a.o.get_instance().tryInitializePackage("Common.App.OtelLibraryLoader")}catch(e){r.ULS.sendTraceTag(594649997,383,10,"Failed to initialize OTelJS after a session ending error: "+e)}}))),qosWac.QosWacFactoryGlobal.createWacPillarsInstance().addPillars(n(456).Health.get_instance()),e.errorIDAlreadyReported={}),e.registerEvents()}catch(t){r.ULS.sendTraceTag(50677138,383,15,"Failed to initialize the health telemetry system: "+t),e.isHealthTelemetrySystemEnabled=!1,e.isQosRecorderEnabled=!1,e.isKpiRecorderEnabled=!1}},e.onAppSleepHandler=function(e,t){r.ULS.sendTraceTag(594616329,383,50,"App going to sleep, pausing health heartbeat"),n(456).Health.get_instance().stopAllHealthTimers()},e.onAppWakeupHandler=function(e,t){r.ULS.sendTraceTag(594616328,383,50,"App waking up, resuming health heartbeat"),n(456).Health.get_instance().resumeAllHealthTimers()},e.registerEvents=function(){n(254).AFrameworkApplication.add_appSleep(e.onAppSleepHandler),n(254).AFrameworkApplication.add_appWakeup(e.onAppWakeupHandler)},e.sendToWarmPipeline=function(e,t,n){try{var i=new u.z;i.name=e,i.succeeded=t,i.dataFields=new Array(0);for(var o=0,a=n;o<a.length;o++){var s=a[o];"DurationMs"===s.getName()&&(i.durationMs=Number.parseInvariant(s.getValue()));var p=new c.b;p.name=s.getName();var d=s.getType(),h=s.getValue();"string"===d?p.string=h:"int"===d?p.int64=Number.parseInvariant(h):"boolean"===d&&(p.bool=Boolean.parse(h)),Array.add(i.dataFields,p)}l.k.sendActivityEvent(i)}catch(e){r.ULS.sendTraceTag(50931778,383,15,"Exception in SendToWarmPipeline occurred: "+e)}},e.recordBSqmQosError=function(t,i){if(void 0===i&&(i=null),e.isHealthTelemetrySystemEnabled){if(e.errorIDAlreadyReported){if(t in e.errorIDAlreadyReported)return void r.ULS.sendTraceTag(595353998,383,50,"Not reporting errorID "+t+" again.");e.errorIDAlreadyReported[t]=1}try{var o=new Sys.Net.WebRequest;o.set_httpVerb("GET"),o.set_url(n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl")+"?ErrorId="+t);var a={};a.method=o.get_httpVerb(),"function"==typeof window.fetch?window.fetch(o.getResolvedUrl(),a).then((function(e){return e.json()}),(function(e){try{n(456).Health.get_instance()&&n(456).Health.get_instance().recordQosError(t,["FailedToFetchLegacyErrorDetails"],!1,!0,!1,!0,null)}catch(e){r.ULS.sendTraceTag(51168589,383,15,"Exception in RecordBSqmQosError occurred during first phase of fetch exception callback: "+e)}return null})).then((function(e){try{var t=s.d(JSON.stringify(e));t.IsV2Error&&n(456).Health.get_instance()&&n(456).Health.get_instance().recordQosError(t.ErrorName,t.Vetos,t.IsIntentional,t.CauseIsInternalToWac,t.IncludedInOverallFailureRateForAlerting,t.IsSessionEndingError,null),i&&i(t)}catch(e){r.ULS.sendTraceTag(51168590,383,15,"Exception in RecordBSqmQosError occurred during second phase of fetch callback: "+e)}return null}),(function(e){try{n(456).Health.get_instance()&&n(456).Health.get_instance().recordQosError(t,["FailedToFetchLegacyErrorDetails"],!1,!0,!1,!0,null)}catch(e){r.ULS.sendTraceTag(51168591,383,15,"Exception in RecordBSqmQosError occurred during second phase of fetch exception callback: "+e)}return null})):n(254).AFrameworkApplication.theClientRequestManager.addRequest(n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl")+"?ErrorId="+t,1,null,null,!1,1,(function(e){try{var t=s.d(e.get_data().responseData);t.IsV2Error&&n(456).Health.get_instance()&&n(456).Health.get_instance().recordQosError(t.ErrorName,t.Vetos,t.IsIntentional,t.CauseIsInternalToWac,t.IncludedInOverallFailureRateForAlerting,t.IsSessionEndingError,null),i&&i(t)}catch(e){r.ULS.sendTraceTag(51168592,383,15,"Exception in RecordBSqmQosError occurred during ClientRequestManager Succeeded callback: "+e)}}),(function(e){try{n(456).Health.get_instance()&&n(456).Health.get_instance().recordQosError(t,["Interruption"],!1,!0,!1,!0,null)}catch(e){r.ULS.sendTraceTag(51168593,383,15,"Exception in RecordBSqmQosError occurred during ClientRequestManager Failed callback: "+e)}}),null,void 0,void 0,void 0,void 0,"GetBSqmQosError")}catch(e){r.ULS.sendTraceTag(50931779,383,15,"Exception in RecordBSqmQosError occurred: "+e)}}},e.isHealthTelemetrySystemEnabled=!1,e.isQosRecorderEnabled=!1,e.isKpiRecorderEnabled=!1,e.remoteTelemetryUrl="",e.heartbeatIntervalMs=3e5,e.recordQosPillarToWarmPipelineIntervalMs=864e5,e.errorIDAlreadyReported=null,e}();(0,p.l)(d,"HealthUtils",null,[])},function(e,t,n){"use strict";n.d(t,{q:function(){return u},u:function(){return c},v:function(){return p},o:function(){return d},l:function(){return g},h:function(){return m}});var i=n(597),r=n(222),o=n(333),a=n(876),s=n(154),l=n(425),u=function(e,t,n){var r=s.g.getOpacity(e)/100;a.WacAirSpace.setAnimationClass(e,"Shared_BasicClass");var o=new i.y(e);o.animateOpacity(r,0),a.WacAirSpace.animate(o,t,n)},c=function(e){a.WacAirSpace.setAnimationClass(e,"Shared_QuickClass");var t=new o.g(e);t.animateOpacity(0,1),a.WacAirSpace.animate(t,null,null);var n=new r.r(e);n.animateY(e.clientTop-30,e.clientTop),a.WacAirSpace.animate(n,null,null)},p=function(e,t,n){var r=new i.y(e);r.animateOpacity(1,0),a.WacAirSpace.animate(r,t,n)},d=function(e,t,n){t&&t.length>0&&h(t),a.WacAirSpace.setAnimationClass(e,"Shared_QuickClass");var i=new o.g(e);i.animateOpacity(0,1),a.WacAirSpace.animate(i,null,n)},h=function(e){for(var t=0;t<e.length;t++)s.g.setOpacity(e[t],0)},g=function(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.style.position="relative",a.WacAirSpace.setAnimationClass(i,"Shared_QuickClass");var u=new o.g(i);if(u.animateOpacity(s.g.getOpacity(i)/100,1),a.WacAirSpace.animate(u,null,null),!l.y.get_isFirefox()){var c=new r.r(i);c.animateY(-100,0),a.WacAirSpace.animate(c,null,null)}}},m=function(e,t){l.y.get_isInternetExplorer8()&&a.WacAirSpace.temporarilyDisableAnimation(1e3);var n=a.WacAirSpace.cloneElement(e,!1,!0),r=n.children[0];n.style.zIndex=String(t),a.WacAirSpace.setAnimationClass(r,"Shared_QuickClass"),a.WacAirSpace.setAnimationClass(n,"Shared_BasicClass");var o=new i.y(n);o.animateOpacity(s.g.getOpacity(n)/100,0),a.WacAirSpace.animate(o,null,_);var u=new i.y(r);u.animateOpacity(s.g.getOpacity(r)/100,0),a.WacAirSpace.animate(u,null,null)},_=function(e){var t=e.get_element();t.parentNode&&t.parentNode.removeChild(t)}},,function(e,t,n){"use strict";n.d(t,{z:function(){return i},s:function(){return r},d:function(){return o}});var i=function(e,t){return Array.contains(e,t)},r=function(e,t,n){for(var i=0,r=t;i<r.length;i++){if(n(r[i]))return!0}return!1},o=function(e,t,n){if(null==n)return[t];var i=1+n.length,r=new Array(i);r[0]=t;for(var o=1;o<i;o++)r[o]=n[o-1];return r}},function(e,t,n){var i=n(714),r=n(947),o=n(919),a=n(231),s=o("IE_PROTO"),l=Object.prototype;e.exports=a?Object.getPrototypeOf:function(e){return e=r(e),i(e,s)?e[s]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?l:null}},,function(e,t,n){"use strict";var i=n(208),r=n(255),o=n(254),a=n(179),s=n(620),l=n(478),u=function(){return function(){this.maxRetryAttempts=22,this.retryIntervalInMSecs=1e3,this.retryIntervalLongInMSecs=2e4,this.retryTimeoutInMSecs=18e4}}();(0,i.l)(u,"Config$0",null,[]),n.d(t,{k:function(){return c}});var c=function(){function e(e){this._callback=null,this._url=null,this._retryCountForHttp200=0,this._retryCountForServiceBusy=0,this._useAdvancedRetryLogic=!1,this.pageStats="",this._notificationBar=null,this._notificationBar=e}return e.prototype.send=function(e,t,n){this._url=e,this._callback=t,this._useAdvancedRetryLogic=n,this.makeRequest(null)},e.prototype.makeRequest=function(e){o.AFrameworkApplication.theClientRequestManager.addRequest(this._url,1,null,null,!0,2,i.i(this,this.onRequestSucceeded,"onRequestSucceeded"),i.i(this,this.onRequestFailed,"onRequestFailed"),null,void 0,void 0,void 0,void 0,"16")},e.prototype.onRequestSucceeded=function(t){this.resetFailedRequestRetryLoop();var n=t.get_data().responseXml,i=null;if(n){if(e.isValidResponseXMLDoc(n)||(n=Sys.Net.XMLDOM(t.get_data().responseData,!0)),"undefined"==typeof n.selectSingleNode){var s=t.get_data().responseData||"[null]";return s.length>800&&(s=s.substring(0,400)+"[...]"+s.substring(s.length-400,s.length)),r.ULS.sendTraceTag(39387396,301,10,'Invalid docdata.xml retrieved.  Contents: "{0}"',s),void this.giveUp(t.get_data())}i=n.selectSingleNode("/docdata/status")}if(o.AFrameworkApplication.collectPageStats&&t.get_data().responseHeaders[a.PageStats.pageStatsResponseXHRHeader]&&(this.pageStats+=t.get_data().responseHeaders[a.PageStats.pageStatsResponseXHRHeader].toString()),!!i&&("InProgress"===i.text&&this._retryCountForHttp200++<e._config.maxRetryAttempts||"ServiceBusy"===i.text&&this._retryCountForServiceBusy++<3))r.ULS.sendTraceTag(39387397,301,50,"Re-requesting; Status: {0}; Retry Count: {1}; Url: {2}",i.text,this._retryCountForHttp200+this._retryCountForServiceBusy,this._url),this.retryRequest(e._config.retryIntervalInMSecs*(this._retryCountForHttp200+this._retryCountForServiceBusy));else{var l=i?i.text:null;r.ULS.sendTraceTag(39387398,301,50,"Request Complete. Result: {0}; Url: {1}",l,this._url),o.AFrameworkApplication.collectPageStats&&""!==this.pageStats&&(t.get_data().responseHeaders[a.PageStats.pageStatsResponseXHRHeader]=this.pageStats,this.pageStats=""),this._callback(!0,l,t.get_data())}},e.prototype.onRequestFailed=function(t){if(this._useAdvancedRetryLogic)if(e._retryLoopUnderway||(e._lastFailedRequestStamp=new Date,e._retryLoopUnderway=!0,e._retryCountFailure=1),(new Date).getTime()-e._lastFailedRequestStamp.getTime()<e._config.retryTimeoutInMSecs){var n=e._retryCountFailure>=4?e._config.retryIntervalLongInMSecs:e._config.retryIntervalInMSecs;this.retryOnFailure(n),4===e._retryCountFailure&&(e._notificationItem=this._notificationBar.createEntry(CommonUIStrings.l_NetworkProblemToast,!0),this._notificationBar.addEntry(e._notificationItem))}else this.giveUp(t.get_data());else e._retryCountFailure<4?this.retryOnFailure(2*e._config.retryIntervalInMSecs):this.giveUp(t.get_data())},e.prototype.retryRequest=function(e){var t=new l.c(2,1,e,i.i(this,this.makeRequest,"makeRequest"),94);o.AFrameworkApplication.get_theTaskManager().addTask(t)},e.prototype.retryOnFailure=function(t){this.retryRequest(t),e._retryCountFailure++},e.prototype.giveUp=function(e){this._callback(!1,null,e)},e.prototype.resetFailedRequestRetryLoop=function(){if(e._retryLoopUnderway=!1,e._retryCountFailure=0,e._notificationItem){this._notificationBar.removeEntry(e._notificationItem),e._notificationItem=null;var t=this._notificationBar.createEntry(CommonUIStrings.l_NetworkRestoredToast,!1);t.set_image(3),this._notificationBar.addEntry(t)}},e.doRequest=function(t,n,i){return!(s.c.get_instance().checkAndTriggerSessionHasExpired()&&o.AFrameworkApplication.get_activeFrame()&&o.AFrameworkApplication.get_activeFrame().get_holdRequestsWhenSessionHasExpired())&&(new e(i).send(t,n,!1),!0)},e.doRequestWithNetworkFailureNotification=function(t,n,i){new e(i).send(t,n,!0)},e.isValidResponseXMLDoc=function(e){return!!e&&"undefined"!=typeof e.selectSingleNode},e._lastFailedRequestStamp=null,e._retryLoopUnderway=!1,e._retryCountFailure=0,e._notificationItem=null,e._config=new u,e}();(0,i.l)(c,"ClientRequestWithRetry",null,[])},function(e,t,n){"use strict";n.d(t,{f:function(){return i}});var i=(0,n(208).y)("IReactSharedHeaderFocusManager")},function(e,t,n){"use strict";n.d(t,{q:function(){return T}});var i=n(508),r=n(208),o=n(430),a=n(396),s=n(368),l=n(255),u=n(614),c=n(254),p=n(657),d=n(101),h=n(867),g=n(851),m=n(154),_=n(460),f=n(711),y=n(250),v=n(355),S=n(603),C=n(984),b=n(796),A=n(586),T=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i)||this;return o._documentLoadedTime=0,o._hostClickTime=0,o._hostClickTimeReported=!1,o._hostIframeTime=0,o._hostPageFetchStartTime=null,o._hostPageRedirectCount=null,o._hostIFrameTimeReported=!1,o._hostDocumentLoadedTimeReported=!1,o._actionManager=null,o.isHostReadyToAcceptPostMessage=!1,o._eventSource=new A.f,o._postMessageAcked={},o._actionManager=r,o._name="HostIntegrationMessenger",o.create(),o}return(0,i.t)(t,e),t.prototype.hostMessageHandler=function(e){var t=e.message,n=e.eventArgs.origin;switch(c.AFrameworkApplication.wopiHostOriginFromPostMessage||(c.AFrameworkApplication.wopiHostOriginFromPostMessage=n),t.MessageId){case v.a.ackMessage:this.handleAckMessage(t);break;case v.a.blurFocus:case v.a.blur_Focus:this.hostBlurFocusHandler(t);break;case v.a.grabFocus:case v.a.grab_Focus:this.tryGrabFocus();break;case v.a.hostPerfTiming:this.hostPerfMessageHandler(t);break;case v.a.hostPostMessageReady:this.hostPostMessageReadyHandler(t);break;case v.a.jsApiDiagnostics:this.jsApiDiagnosticsHandler(t);break;case v.a.wacBeforeUnloadApp:this.beforeUnloadAppHandler(e);break;case v.a.wacUnloadApp:this.unloadAppHandler(e)}},t.prototype.uiHostMessageHandler=function(e){switch(e.MessageId){case v.a.fileRename:c.AFrameworkApplication.get_theActionManager().processActionWithData(u.sG,2,e.Values.NewName);break;case v.a.hostAccessibilityLoopComplete:c.AFrameworkApplication.get_theActionManager().processActionWithData(u.gZ,2,e.Values[y.t.direction]);break;case v.a.hostUnload:l.ULS.sendTraceTag(42481157,204,50,"Host_Unload Received"),c.AFrameworkApplication.get_theActionManager().processActionWithData(u.jd,2,(new Date).getTime())}},t.prototype.handleAckMessage=function(e){var t=e.CorrelationId;t&&""!==t&&t in this._postMessageAcked&&(l.ULS.sendTraceTag(42783044,204,50,"Received Ack for Message {0}",this._postMessageAcked[t]),this._postMessageAcked[t]="ACK_RECEIVED")},t.prototype.tryGrabFocus=function(){return!(!p.FocusManager.instance()||!p.FocusManager.instance().get_currentScope()||p.FocusManager.instance().get_currentScope().name!==c.AFrameworkApplication.postmessageFocusId)&&(p.FocusManager.instance().popScope(p.FocusManager.instance().get_currentScope().name),!0)},t.prototype.hostBlurFocusHandler=function(e){if(p.FocusManager.instance().pushScope(c.AFrameworkApplication.postmessageFocusId,!1),y.t.shareCorrelation in e.Values){var t={};t[y.t.shareCorrelation]=e.Values[y.t.shareCorrelation],l.ULS.sendTraceTag(38278996,204,50,h.w(t))}},t.prototype.hostPerfMessageHandler=function(e){if(!!!g.n.getParameterValue(document.URL,c.AFrameworkApplication.modeSwitchTimeParamName)&&e.Values){var t=0,n=0;try{t=e.Values[y.t.hostPerfTiming_Click],n=e.Values[y.t.hostPerfTiming_Iframe],y.t.hostPerfTiming_FetchStart in e.Values?this._hostPageFetchStartTime=e.Values[y.t.hostPerfTiming_FetchStart]:y.t.hostPerfTiming_FetchStartAlt in e.Values&&(this._hostPageFetchStartTime=e.Values[y.t.hostPerfTiming_FetchStartAlt]),y.t.hostPerfTiming_RedirectCount in e.Values&&(this._hostPageRedirectCount=e.Values[y.t.hostPerfTiming_RedirectCount])}catch(e){return}this._hostClickTime=t,this._hostIframeTime=n,this._documentLoadedTime&&this.logHostPerfSqm()}},t.prototype.hostPostMessageReadyHandler=function(e){l.ULS.sendTraceTag(6685782,204,50,"HostPostMessageReady"),this.isHostReadyToAcceptPostMessage=!0,this._eventSource.raiseEvent("HRTAPMR_EK")},t.prototype.jsApiDiagnosticsHandler=function(e){l.ULS.sendTraceTag(37536415,204,50,"JsApiDiagnostics");var t=e.Values[y.t.hostInitializeDiagnostics];t&&b.m.get_instance().recordHostInitDiagnostics(t);var n=e.Values[y.t.jsApiDiagnostics];n&&b.m.get_instance().recordJsApiDiagnostics(n)},t.prototype.beforeUnloadAppHandler=function(e){l.ULS.sendTraceTag(40433733,338,50,"Receive Wac_BeforeUnloadApp. Timestamp: {0}",Date.now()),c.AFrameworkApplication.isShuttingDownFromPostMessage=!0,c.AFrameworkApplication.get_activeFrame().get_thePageManager().onBeforeNavigate(e.eventArgs.innerEvent)},t.prototype.unloadAppHandler=function(e){l.ULS.sendTraceTag(40433734,338,50,"Receive Wac_UnloadApp. Timestamp: {0}",Date.now()),c.AFrameworkApplication.get_activeFrame().get_thePageManager().onNavigate(null,Sys.EventArgs.Empty)},t.prototype.logHostPerfSqm=function(){this.logHostClickTimeSqm(),this.logHostIFrameSqm(),null!=this._hostPageFetchStartTime&&b.m.get_instance().recordHostPageFetchStart(this._hostPageFetchStartTime),null!=this._hostPageRedirectCount&&b.m.get_instance().recordHostPageRedirectCount(this._hostPageRedirectCount)},t.prototype.logHostClickTimeSqm=function(){if(this._documentLoadedTime&&this._hostClickTime&&!this._hostClickTimeReported&&(this._hostClickTimeReported=!0,!(this._hostClickTime>this._documentLoadedTime))){var e=this._documentLoadedTime-this._hostClickTime;c.AFrameworkApplication.theWsaClient.setDw(10324,e),b.m.get_instance().recordUserClickedInHostUi(this._hostClickTime)}},t.prototype.logHostIFrameSqm=function(){if(this._documentLoadedTime&&this._hostIframeTime&&!this._hostIFrameTimeReported&&(this._hostIFrameTimeReported=!0,!(this._hostIframeTime>this._documentLoadedTime))){var e=this._documentLoadedTime-this._hostIframeTime;c.AFrameworkApplication.theWsaClient.setDw(10325,e),b.m.get_instance().recordWacIframeGeneratedInHost(this._hostIframeTime)}},t.prototype.reportBrowserFetchStartToLoadBsqm=function(){var e=m.g.getWindowPerformanceTimingObject();if(e){var t=0,n=e.fetchStart;if(null!=n&&(t=n),!(t<=0||t>this._documentLoadedTime)){var i=this._documentLoadedTime-t;c.AFrameworkApplication.theWsaClient.setDw(11045,i)}}},t.prototype.create=function(){c.AFrameworkApplication.isCrossDocumentMessengerDisabled&&this.disable(),this.get_targetOrigin()!==S.c.anyDomain&&this.addAllowedOrigin(this.get_targetOrigin()),this._actionManager.addActionWithFlags(u.Rr,C.a,r.i(this,this.disposeInstance,"disposeInstance"),96),this.addAllowedReceivingMessage(v.a.blurFocus),this.addAllowedReceivingMessage(v.a.blur_Focus),this.addAllowedReceivingMessage(v.a.grabFocus),this.addAllowedReceivingMessage(v.a.grab_Focus),this.addAllowedReceivingMessage(v.a.hostPerfTiming),this.addAllowedReceivingMessage(v.a.hostRefreshSessionInfo),this.addAllowedReceivingMessage(v.a.appRefreshSessionInfo);var e=r.i(this,this.hostMessageHandler,"hostMessageHandler");if(this.registerEventCallback(v.a.blurFocus,e),this.registerEventCallback(v.a.blur_Focus,e),this.registerEventCallback(v.a.grabFocus,e),this.registerEventCallback(v.a.grab_Focus,e),this.registerEventCallback(v.a.hostPerfTiming,e),c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteEmbedUnloadIsEnabled")&&(this.addAllowedFreeReceivingMessage(v.a.wacBeforeUnloadApp),this.addAllowedFreeReceivingMessage(v.a.wacUnloadApp),this.registerEventCallback(v.a.wacBeforeUnloadApp,e),this.registerEventCallback(v.a.wacUnloadApp,e)),c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("PostMessageEmbedded")||c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApi")){this.addAllowedReceivingMessage(v.a.fileRename),this.addAllowedReceivingMessage(v.a.hostUnload);var t=r.i(this,this.uiHostMessageHandler,"uiHostMessageHandler");this.registerCallback(v.a.fileRename,t),c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SupportsAccessibilityLoop")&&(this.addAllowedReceivingMessage(v.a.hostAccessibilityLoopComplete),this.registerCallback(v.a.hostAccessibilityLoopComplete,t)),this.registerCallback(v.a.hostUnload,t)}c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HostSendReadyToAcceptPostMessage")?(this.addAllowedReceivingMessage(v.a.hostPostMessageReady),this.registerEventCallback(v.a.hostPostMessageReady,e)):(l.ULS.sendTraceTag(6685783,204,50,"Host is not listed to send PostMessageReady postmessage setting it default value"),this.isHostReadyToAcceptPostMessage=!0),c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApi")&&(this.addAllowedReceivingMessage(v.a.jsApiDiagnostics),this.registerEventCallback(v.a.jsApiDiagnostics,e)),(c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RetryablePostMessagingIsEnabled")||c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2"))&&(this.addAllowedReceivingMessage(v.a.ackMessage),this.registerEventCallback(v.a.ackMessage,e))},t.prototype.disposeInstance=function(e,t,n,i,r){return 2!==n?32:(d.b(this),32)},t.prototype.packMessage=function(e,t,n){var i=new f.f;return i.MessageId=e,i.CorrelationId=n,t&&(i.Values=t),i.Values["ui-language"]=c.AFrameworkApplication.lcid.toString(),i.Values[s.a.currentSessionParamName]=c.AFrameworkApplication.userSessionId,i},t.prototype.reportDocumentLoadedTime=function(e){this._hostDocumentLoadedTimeReported||(this._documentLoadedTime=e,this.reportBrowserFetchStartToLoadBsqm(),this.get_targetOrigin()!==S.c.anyDomain&&this.sendMessage(v.a.appLoadingStatus,{DocumentLoadedTime:e}),this.logHostPerfSqm(),this._hostDocumentLoadedTimeReported=!0)},t.prototype.sendMessage=function(e,t,n){return void 0===n&&(n=""),this.get_isHostReadyToAcceptPostMessage()||l.ULS.sendTraceTag(7201236,204,50,"SendMessage function called before host is ready to accept postmessage for message {0}",e),n=n&&""!==n?n:_.l.create().toString(),this.send(this.packMessage(e,t,n))},t.prototype.sendMessageWithRetry=function(e,t,n,i){var r=this;if(void 0===n&&(n=""),void 0===i&&(i=0),c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("RetryablePostMessagingIsEnabled")||c.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2")){if(n&&""!==n&&n in this._postMessageAcked&&"ACK_RECEIVED"===this._postMessageAcked[n])return delete this._postMessageAcked[n],!0;if(i||(n=n&&""!==n?n:_.l.create().toString(),this._postMessageAcked[n]=e),i>3)return l.ULS.sendTraceTag(40716250,204,50,'No retries remaining. {{"MessageId":{0}, "CorrelationId":{1}}}',e,n),delete this._postMessageAcked[n],!1;i++,window.setTimeout((function(){r.sendMessageWithRetry(e,t,n,i)}),1e3),l.ULS.sendTraceTag(40716251,204,50,'Sending postmessage. Retries remaining {0}. {{"MessageId":{1}, "CorrelationId":{2}}}',3-i,e,n),t[y.t.ackExpected]=!0}return this.sendMessage(e,t,n)},t.prototype.get_isHostReadyToAcceptPostMessage=function(){return this.isHostReadyToAcceptPostMessage},t.prototype.add_hostReadyToAcceptPostMessageReceived=function(e){this._eventSource.addHandler("HRTAPMR_EK",e)},t.prototype.remove_hostReadyToAcceptPostMessageReceived=function(e){this._eventSource.removeHandler("HRTAPMR_EK",e)},t}(s.a);(0,r.l)(T,"HostIntegrationMessenger",s.a,[o.i,a.d,Sys.IDisposable])},,,,function(e,t,n){"use strict";n.d(t,{f:function(){return i}});var i=(0,n(208).y)("IScrollControl")},,,,function(e,t,n){var i,r,o,a=n(20),s=n(531),l=n(247),u=n(76),c=n(714),p=n(919),d=n(227),h=s.WeakMap;if(a){var g=new h,m=g.get,_=g.has,f=g.set;i=function(e,t){return f.call(g,e,t),t},r=function(e){return m.call(g,e)||{}},o=function(e){return _.call(g,e)}}else{var y=p("state");d[y]=!0,i=function(e,t){return u(e,y,t),t},r=function(e){return c(e,y)?e[y]:{}},o=function(e){return c(e,y)}}e.exports={set:i,get:r,has:o,enforce:function(e){return o(e)?r(e):i(e,{})},getterFor:function(e){return function(t){var n;if(!l(t)||(n=r(t)).type!==e)throw TypeError("Incompatible receiver, "+e+" required");return n}}}},,,,function(e,t,n){"use strict";n.d(t,{j:function(){return a}});var i=n(508),r=n(208),o=n(56),a=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.executeRequest=function(){var e=this.get_webRequest();this.verifyRequestValidity(e),this._xmlHttpRequest=new XMLHttpRequest,Sys.Browser.agent!==Sys.Browser.Firefox&&(this._xmlHttpRequest.onreadystatechange=r.i(this,this.onReadyStateChange,"onReadyStateChange")),this._xmlHttpRequest.open(e.get_httpVerb(),e.getResolvedUrl(),!1),this.setResponseType(!1),this.processXMLHttpRequest(e),this._xmlHttpRequest&&Sys.Browser.agent===Sys.Browser.Firefox&&this.onReadyStateChange()},t}(o.d);(0,r.l)(a,"Common.SynchronousXMLHttpExecutor",o.d,[])},,,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IActivityManager"),o=n(508),a=(0,i.y)("IActivity"),s=function(){function e(){this.$$pf_ActivityName=0,this.$$pf_StartTime=0,this.$$pf_EndTime=0,this.$$pf_Properties=null,this.maxAllowedDuration=0,this.$$pf_Ended=!1}return e.prototype.get_activityName=function(){return this.$$pf_ActivityName},e.prototype.set_activityName=function(e){return this.$$pf_ActivityName=e,e},e.prototype.get_startTime=function(){return this.$$pf_StartTime},e.prototype.set_startTime=function(e){return this.$$pf_StartTime=e,e},e.prototype.get_endTime=function(){return this.$$pf_EndTime},e.prototype.set_endTime=function(e){return this.$$pf_EndTime=e,e},e.prototype.get_properties=function(){return this.$$pf_Properties},e.prototype.set_properties=function(e){return this.$$pf_Properties=e,e},e.prototype.get_maxAllowedDuration=function(){return this.maxAllowedDuration},e.prototype.end=function(){},e.prototype.cancel=function(){},e.prototype.get_ended=function(){return this.$$pf_Ended},e.prototype.set_ended=function(e){return this.$$pf_Ended=e,e},e}();(0,i.l)(s,"ActivityStub",null,[a]);var l=n(658),u=function(e){function t(){var t=e.call(this)||this;return t.set_properties(new l.w(String)),t}return(0,o.t)(t,e),t}(s);(0,i.l)(u,"FakeActivity",s,[]),n.d(t,{y:function(){return c}});var c=function(){function e(){}return e.prototype.get_isProxy=function(){return e._instance!==this},e.prototype.get_enabled=function(){return!!this.get_isProxy()&&e._instance.get_enabled()},e.prototype.set_enabled=function(t){return this.get_isProxy()&&e._instance.set_enabled(t),t},e.prototype.startActivity=function(t,n){return void 0===n&&(n=-1),this.get_isProxy()?e._instance.startActivity(t,n):new u},e.prototype.recordEvent=function(t,n){void 0===n&&(n=null),this.get_isProxy()&&e._instance.recordEvent(t,n)},e.prototype.recordError=function(t,n){void 0===n&&(n=null),this.get_isProxy()&&e._instance.recordError(t,n)},e.prototype.add_activityRecorded=function(t){this.get_isProxy()&&e._instance.add_activityRecorded(t)},e.prototype.remove_activityRecorded=function(t){this.get_isProxy()&&e._instance.remove_activityRecorded(t)},e.get_instance=function(){return e._instance||(e._instance=e.getAnInstanceWithResolvedDependencies())},e.set_instance=function(t){return e._instance=t,t},e.getAnInstanceWithResolvedDependencies=function(){return new e},e._instance=null,e}();(0,i.l)(c,"ActivityManager",null,[r])},,function(e,t,n){e.exports=n(131)},function(e,t,n){"use strict";var i=n(351),r=n(255),o=n(208),a=function(){function e(){this._majorVersion=-1,this._minorVersion=-1}return e.prototype.get_majorVersion=function(){return this._majorVersion},e.prototype.set_majorVersion=function(e){return this._majorVersion=e,e},e.prototype.get_minorVersion=function(){return this._minorVersion},e.prototype.set_minorVersion=function(e){return this._minorVersion=e,e},e}();(0,o.l)(a,"AndroidVersion",null,[]);var s=function(){function e(e,t){this.original=null,this.wrapped=null,this.original=e,this.wrapped=t}return e.prototype.get_original=function(){return this.original},e.prototype.get_wrapped=function(){return this.wrapped},e}();(0,o.l)(s,"TimerFunctionData",null,[]),n.d(t,{y:function(){return l}});var l=function(){function e(){}return e.$$cctor=function(){window.self;e.setTimeoutData=e.wrapTimerFunctionWithExceptionHandling("setTimeout"),e.setIntervalData=e.wrapTimerFunctionWithExceptionHandling("setInterval"),e.setImmediateData=e.wrapTimerFunctionWithExceptionHandling("setImmediate")},e.get_isInternetExplorerNonEdge=function(){return Sys.Browser.agent===Sys.Browser.InternetExplorer},e.get_isInternetExplorerOrEdge=function(){return e.get_isInternetExplorerNonEdge()||e.get_isInternetExplorerEdge()},e.get_isNonStandardsCompliantIE=function(){return!!e.get_isInternetExplorerNonEdge()&&(!window.document.documentMode||window.document.documentMode<=8)},e.get_isInternetExplorer=function(){return e.get_isNonStandardsCompliantIE()||e.get_isInternetExplorer9Up()},e.get_isInternetExplorer7=function(){return!!e.get_isInternetExplorerNonEdge()&&!window.document.documentMode},e.get_isInternetExplorer8=function(){return!!e.get_isInternetExplorerNonEdge()&&(!!window.document.documentMode&&8===window.document.documentMode)},e.get_isInternetExplorer9=function(){return!!e.get_isInternetExplorerNonEdge()&&(!!window.document.documentMode&&9===window.document.documentMode)},e.get_supportsSynchronousXhrDuringNavigate=function(){return!e.get_isChrome()},e.get_isInternetExplorer9Up=function(){return!!e.get_isInternetExplorerNonEdge()&&(!!window.document.documentMode&&window.document.documentMode>=9)},e.get_isInternetExplorer10=function(){return!!e.get_isInternetExplorerNonEdge()&&(!!window.document.documentMode&&10===window.document.documentMode)},e.get_isInternetExplorer10Up=function(){return!!e.get_isInternetExplorerNonEdge()&&(!!window.document.documentMode&&window.document.documentMode>=10)},e.get_isInternetExplorerEdge=function(){return window.navigator.userAgent.indexOf("Edge/")>=0},e.get_isInternetExplorerMobile=function(){return window.navigator.userAgent.indexOf("IEMobile/11")>=0},e.get_isInternetExplorer11Up=function(){return!!e.get_isInternetExplorerNonEdge()&&(!!window.document.documentMode&&window.document.documentMode>=11)},e.get_is64bitBrowser=function(){return window.navigator.userAgent.indexOf("Win64; x64;")>=0},e.get_isIEOnWindows64=function(){var t=window.navigator.userAgent;return e.get_isInternetExplorerNonEdge()&&(t.indexOf("Win64; x64;")>=0||t.indexOf("Win64; IA64;")>=0||t.indexOf("WOW64;")>=0)},e.get_isFirefox=function(){return Sys.Browser.agent===Sys.Browser.Firefox},e.get_isFirefox3Up=function(){return e.get_firefoxVersion()>=3},e.get_isFirefox4Up=function(){return e.get_firefoxVersion()>=4},e.get_firefoxVersion=function(){if(e.get_isFirefox()){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf("firefox/");if(n>=0){var i=n+8,r=t.length;return parseInt(t.substring(i,r))}}return 0},e.get_edgeVersion=function(){if(e.get_isInternetExplorerEdge()){var t=e._edgeVersionRegularExpression.exec(window.navigator.appVersion);if(t&&2===t.length)return t[1]}return""},e.get_isBingPreview=function(){return window.navigator.userAgent.toLowerCase().indexOf("bingpreview/")>=0},e.isChromeAtLeast=function(t){if(e.get_isWebKit()){var n=window.navigator.userAgent.toLowerCase(),i=n.indexOf("chrome/");if(i>=0){var r=i+7,o=n.indexOf(".",r);if(o>0)return parseInt(n.substring(r,o))>=t}}return!1},e.get_isChrome76Up=function(){return e.isChromeAtLeast(76)},e.get_isChrome=function(){return window.navigator.userAgent.toLowerCase().indexOf("chrome/")>=0&&!e.get_isInternetExplorerEdge()},e.get_isChromeiOS=function(){return window.navigator.userAgent.toLowerCase().indexOf("crios/")>=0},e.get_isFirefoxiOS=function(){return window.navigator.userAgent.toLowerCase().indexOf("fxios/")>=0},e.get_isSamsungInternet=function(){return window.navigator.userAgent.toLowerCase().indexOf("samsungbrowser/")>=0},e.get_isElectron=function(){return window.navigator.userAgent.toLowerCase().indexOf("electron/")>=0&&e.get_isChrome()},e.get_electronVersion=function(){if(e.get_isElectron()){var t=e._electronVersionRegularExpression.exec(window.navigator.appVersion);if(t&&2===t.length)return t[1]}return""},e.get_isChromeOrIEEdge=function(){return window.navigator.userAgent.toLowerCase().indexOf("chrome/")>=0},e.get_supportsDomL2Selection=function(){return e._supportsDomL2SelectionChecked||(e._supportsDomL2Selection=!!window.self.getSelection,e._supportsDomL2SelectionChecked=!0),e._supportsDomL2Selection},e.browserSupportsSetActive=function(e){return!!e&&!!e.setActive},e.get_supportsCompositionEvents=function(){return e.get_isInternetExplorer9Up()||e.get_isSafari4Up()||e.get_isChromeOrIEEdge()||e.get_isIPhone()||e.get_isIPad()},e.get_supportsTextInputEvent=function(){return e.get_isInternetExplorer9Up()||e.get_isSafari4Up()||e.get_isChrome()},e.get_supportsInputEvent=function(){return e.get_isInternetExplorerEdge()||e.get_isSafari4Up()||e.get_isChrome()||e.get_isFirefox()},e.get_supportsOpenInClientNpapiPlugin=function(){return e.get_isFirefox3Up()},e.get_supportsOpenInClientForAllApps=function(){return!e.get_isAndroid()||!!n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OICForAndroidIsEnabled")},e.get_browserSupportsServiceWorker=function(){return"serviceWorker"in navigator},e.browserSupportsSendBeacon=function(){try{return"function"==typeof window.navigator.sendBeacon}catch(e){return!1}},e.isRequestKeepAliveSupported=function(){try{return null!=Object.getOwnPropertyDescriptor(Request.prototype,"keepalive")}catch(e){return!1}},e.browserSupportsFetchKeepAlive=function(){try{return null!=e._supportsFetchKeepAlive?e._supportsFetchKeepAlive:"function"==typeof window.fetch&&"undefined"!=typeof Request?(e._supportsFetchKeepAlive=e.isRequestKeepAliveSupported(),e._supportsFetchKeepAlive):(e._supportsFetchKeepAlive=!1,!1)}catch(e){return!1}},e.get_alwaysInImeMode=function(){return e.get_isAndroid()},e.get_supportsTextRange=function(){return!!window.self.document.body.createTextRange},e.get_supportsWordBreakingRange=function(){if(null!=e._supportsExpandOnRangeObjects)return e._supportsExpandOnRangeObjects;if(!e.get_supportsTextRange())return!1;var t=window.self.document.createRange();return e._supportsExpandOnRangeObjects=!!t.expand,e._supportsExpandOnRangeObjects},e.get_supportsPlacingIpInEmptySpan=function(){return!(e.get_isNonStandardsCompliantIE()||e.get_isInternetExplorer11Up()||e.get_isInternetExplorerEdge()||e.get_isWebKit())},e.get_isWebKit=function(){return Sys.Browser.agent===Sys.Browser.Safari&&!e.get_isInternetExplorerEdge()},e.get_isWebKitOrIEEdge=function(){return Sys.Browser.agent===Sys.Browser.Safari},e.isSafariAtLeast=function(t){if(e.get_isWebKit()){var n=window.navigator.userAgent.toLowerCase(),i=n.indexOf("version/");if(i>=0){var r=i+8,o=n.length;return parseInt(n.substring(r,o))>=t}}return!1},e.get_isSafari3Up=function(){return e.isSafariAtLeast(3)},e.get_isSafari4Up=function(){return e.isSafariAtLeast(4)},e.get_isSafari5Up=function(){return e.isSafariAtLeast(5)},e.get_isSafari9Up=function(){return e.isSafariAtLeast(9)},e.get_isSafari12Up=function(){return e.isSafariAtLeast(12)},e.get_isOpera12Older=function(){return Sys.Browser.agent===Sys.Browser.Opera},e.get_isOpera15Up=function(){return window.navigator.userAgent.indexOf("OPR")>=0},e.get_isOpera=function(){return e.get_isOpera12Older()||e.get_isOpera15Up()},e.get_isWindows=function(){return window.navigator.userAgent.indexOf("Windows")>=0},e.checkWindowsNTVersion=function(){if(!e._ntVersionChecked){var t=new RegExp("Windows NT\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent);e._ntVersionChecked=!0,e._ntVersion=-1,null!=t&&t.length>=2&&(e._ntVersion=parseFloat(t[1]),isNaN(e._ntVersion)&&(e._ntVersion=-1))}},e.get_isWindowsVistaUp=function(){return e.checkWindowsNTVersion(),e._ntVersion>=6},e.get_isWindows8Up=function(){return e.checkWindowsNTVersion(),e._ntVersion>=6.2},e.get_isMac=function(){return window.navigator.userAgent.indexOf("Macintosh")>=0},e.get_isPpcMac=function(){return window.navigator.userAgent.indexOf("PPC Mac")>=0},e.get_isLinux=function(){return window.navigator.userAgent.indexOf("Linux")>=0},e.get_isIPad=function(){return null===e._isIPad&&(e._isIPad=window.navigator.userAgent.indexOf("iPad")>=0||e.get_isMac()&&e.get_supportsTouch()&&!e.get_isIPhone()),e._isIPad},e.get_iPadOsVersion=function(){if(e.get_isIPad()){var t=window.navigator.userAgent,n=t.indexOf(" CPU OS ");if(n>=0){var i=n+8,r=t.length,o=parseInt(t.substring(i,r));if(o!==Number.NaN)return o}}return 0},e.get_isIPhone=function(){return window.navigator.userAgent.indexOf("iPhone")>=0},e.get_isWindowsPhone=function(){return window.navigator.userAgent.indexOf("Windows Phone")>=0},e.get_isAndroid=function(){return window.navigator.userAgent.indexOf("Android")>=0},e.get_androidVersion=function(){var t=new a;if(!e.get_isAndroid())return t;var n="";try{var i=(n=window.navigator.userAgent.toUpperCase()).indexOf(e._androidVersionPrefix),o=n.substr(i+e._androidVersionPrefix.length+1).indexOf(e._androidVersionSuffix),s=n.substr(i+e._androidVersionPrefix.length+1,o).split(e._androidVersionSeparator);t.set_majorVersion(parseInt(s[0].trim(),10)),t.set_minorVersion(1===s.length?0:parseInt(s[1].trim(),10))}catch(e){r.ULS.sendTraceTag(595079326,306,10,"UserAgent Parse Failure: {0}",n)}return t},e.get_isLocaleChina=function(){return"ZH-CN"===window.navigator.language.toUpperCase()},e.get_isChromeOS=function(){return window.navigator.userAgent.indexOf("CrOS ")>=0},e.get_chromeRevision=function(){if(e.get_isChrome()){var t=window.navigator.userAgent.toLowerCase(),n=t.indexOf("chrome/");if(n>=0){var i=n+7,r=t.indexOf(".",i),o=t.substring(i,r);return parseInt(o)}}return 0},e.get_isMobile=function(){return e.get_isIPad()||e.get_isAndroid()},e.get_maxTouchPoints=function(){for(var e=["maxTouchPoints","msMaxTouchPoints"],t=0;t<e.length;t++){var n=window.navigator[e[t]];if(null!=n)return n}return 0},e.get_supportsTouch=function(){return e.get_isAndroid()||e.get_maxTouchPoints()>0},e.get_supportsMouse=function(){return!e.get_isIPad()},e.get_selectionShowsThroughOpaqueContent=function(){return e.get_isMobile()},e.get_isSupportedMacBrowser=function(){return e.get_isMac()&&(e.get_isFirefox3Up()||e.get_isSafari3Up())},e.get_supportsInlineSVG=function(){return e.get_supportsSVG()&&(!e.get_isFirefox()||e.get_isFirefox4Up())},e.get_supportsVML=function(){return e.get_isInternetExplorerNonEdge()},e.get_supportsSVG=function(){return!e.get_isNonStandardsCompliantIE()},e.get_isMobileBrowser=function(){return window.navigator.userAgent.indexOf("Mobile")>=0},e.get_isChromiumEdge=function(){return window.navigator.userAgent.indexOf("Edg/")>=0},e.setOpacity=function(t,n){e.get_isInternetExplorerNonEdge()&&!e.get_isInternetExplorer9Up()?t.style.filter=1===n?"":"alpha(opacity="+100*n+")":t.style.opacity=n.toString()},e.supportsNoReferrer=function(){return e.get_isWebKitOrIEEdge()||e.get_isFirefox()},e.get_setTimeoutData=function(){return e.setTimeoutData},e.get_setIntervalData=function(){return e.setIntervalData},e.get_setImmediateData=function(){return e.setImmediateData},e.wrapTimerFunctionWithExceptionHandling=function(t){var o=window.self,a=(0,i.e)(Function,o[t]);return new s(a,(function(t,o){if(e.get_isInternetExplorer10()){var s=(0,i.e)(Function,t);s&&(t=function(){e.executeCodeInTryCatchWithExceptionLogging(s)})}return Sys.Application.get_isDisposing()?(r.ULS.sendTraceTag(595179603,210,50,"Unloading. Not queuing method [{0}] stack [{1}]",t,n(675).Debug.generateCallstack()),0):a(t,o)}))},e.executeCodeInTryCatchWithExceptionLogging=function(e){try{e()}catch(e){throw n(262).setExceptionCallStack(e),e}},e.get_supportsDocumentImplementationCreateHtmlDocument=function(){return null==e._supportsDocumentImplementationCreateHtmlDocument&&(e._supportsDocumentImplementationCreateHtmlDocument=(e.get_isInternetExplorer10Up()||!e.get_isInternetExplorerNonEdge())&&!!document.implementation&&!!document.implementation.createHTMLDocument),e._supportsDocumentImplementationCreateHtmlDocument},e.get_supportsFullscreen=function(){return!!(document.webkitRequestFullscreen||document.msRequestFullscreen||document.mozRequestFullScreen||document.requestFullscreen)},e.isWebSocketSupported=function(){return"undefined"!=typeof WebSocket},e.get_supportsWindowAtob=function(){return null==e._supportsWindowAtob&&(e._supportsWindowAtob=!!window.self.atob),e._supportsWindowAtob},e.get_supportsMicrophoneAccessInIframe=function(){return e.get_isInternetExplorerEdge()||e.get_isFirefox()||e.get_isChrome()},e.get_supports32BitsZIndex=function(){return null==e._supports32BitsZIndex&&(e._supports32BitsZIndex=e.get_isInternetExplorerOrEdge()||e.get_isSafari4Up()||e.get_isChrome()||e.get_isFirefox()),e._supports32BitsZIndex},e.get_browserNameForlogging=function(){return e._browserNameForLogging||(e.get_isInternetExplorerNonEdge()?e._browserNameForLogging="InternetExplorer":e.get_isInternetExplorerEdge()?e._browserNameForLogging="Edge":e.get_isChrome()&&window.chrome?e._browserNameForLogging="Chrome":e.get_isFirefox()?e._browserNameForLogging="Firefox":e.get_isSafari3Up()?e._browserNameForLogging="Safari3Up":e.get_isElectron()?e._browserNameForLogging="Electron":e._browserNameForLogging="UnsupportedBrowser"),e._browserNameForLogging},e.get_browserCodeForLogging=function(){return e.get_isInternetExplorerNonEdge()?e._browserCodeForLogging=3:e.get_isInternetExplorerEdge()?e._browserCodeForLogging=1:e.get_isChrome()&&window.chrome?e._browserCodeForLogging=0:e.get_isFirefox()?e._browserCodeForLogging=2:e.get_isSafari3Up()?e._browserCodeForLogging=4:e.get_isElectron()?e._browserCodeForLogging=7:e._browserCodeForLogging=5,e._browserCodeForLogging},e.get_browserIdentifierForLogging=function(){return e.browserCodePrefix+e.get_browserCodeForLogging()},e.isSupportedPlugin=function(e){var t=window.navigator.plugins;if(!t||!t.length)return!1;for(var n=0;n<t.length;n++){if(t[n].name.toLowerCase().indexOf(e.toLowerCase())>=0)return!0}return!1},e.get_hasPdfReader=function(){return e.get_isInternetExplorerEdge()||e.get_firefoxVersion()>=18||e.isSupportedPlugin("Chrome PDF Viewer")||e.isSupportedPlugin("Microsoft Edge PDF Viewer")||e.isSupportedPlugin("WebKit built-in PDF")},e._supportsDomL2SelectionChecked=!1,e._supportsDomL2Selection=!1,e._supportsDocumentImplementationCreateHtmlDocument=null,e._supportsWindowAtob=null,e._supports32BitsZIndex=null,e._supportsExpandOnRangeObjects=null,e._supportsFetchKeepAlive=null,e._ntVersionChecked=!1,e._ntVersion=-1,e._browserNameForLogging=null,e._browserCodeForLogging=6,e.browserCodePrefix="BCX",e._androidVersionPrefix="ANDROID",e._androidVersionSeparator=".",e._androidVersionSuffix=";",e._edgeVersionRegularExpression=new RegExp("Edge/(\\d+\\.\\d+)"),e._electronVersionRegularExpression=new RegExp("Electron/(\\d+\\.\\d+\\.\\d+)"),e._isIPad=null,e.setTimeoutData=null,e.setIntervalData=null,e.setImmediateData=null,e}();(0,o.l)(l,"BrowserUtils",null,[]),l.$$cctor()},function(e,t,n){var i=n(165),r=n(263);i({target:"Object",stat:!0,forced:Object.assign!==r},{assign:r})},function(e,t,n){"use strict";n.d(t,{s:function(){return T}});var i=n(508),r=n(208),o=n(715),a=n(550),s=n(390),l=n(931),u=n(605),c=n(306),p=n(574),d=n(657),h=n(352),g=n(256),m=n(386),_=n(369),f=n(445),y=n(25),v=n(810),S=n(101),C=n(154),b=n(425),A=n(296),T=function(e){function t(){var t=e.call(this)||this;return t._focusManager=null,t._eventHandlerManager=null,t._capturedHandler=null,t._inTouchClick=!1,t._clickStartedOutsideCanvas=!1,t._lastTouchEventArgs=null,t._eventHandlerManager=c.EventHandlerManager.get_instance(),t._focusManager=d.FocusManager.instance(),c.EventHandlerManager.get_instance().registerOnBeforeEventProcessed(p.d.msPointerDown,r.i(t,t.onMsPointerDown,"onMsPointerDown")),c.EventHandlerManager.get_instance().registerOnBeforeEventProcessed(p.d.browserPointerDown,r.i(t,t.onMsPointerDown,"onMsPointerDown")),t}return(0,i.t)(t,e),t.prototype.get_inTouchClick=function(){return this._inTouchClick},t.prototype.get_clickStartedOutsideCanvas=function(){return this._clickStartedOutsideCanvas},t.prototype.set_clickStartedOutsideCanvas=function(e){return this._clickStartedOutsideCanvas=e,e},t.prototype.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeListForElement(p.d.get_clickEvents(),t,2,r.i(this,this.onClickEvent,"onClickEvent"))},t.prototype.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeListForElement(t,p.d.get_clickEvents())},t.prototype.registerHandler=function(e,t,n){this.registerHandlerWithBrowserClickOption(e,t,n,null,!1)},t.prototype.registerHandlerWithData=function(e,t,n,i){this.registerHandlerWithBrowserClickOption(e,t,n,i,!1)},t.prototype.registerHandlerWithBrowserClickOption=function(e,t,n,i,r){this.registerHandlerWithCaptureOption(e,t,n,i,r,!1)},t.prototype.registerHandlerWithCaptureOption=function(e,t,n,i,o,a){void 0===a&&(a=!1),this._eventHandlerManager.registerHandler(l.q,e,t,2,r.i(this,this.onClickEvent,"onClickEvent"),n,i,a),o||(this._eventHandlerManager.initializeForElementInternal(p.d.touchStart,t,2,r.i(this,this.onTouchEvent,"onTouchEvent"),a),this._eventHandlerManager.initializeForElementInternal(p.d.touchMove,t,2,r.i(this,this.onTouchEvent,"onTouchEvent"),a),this._eventHandlerManager.initializeForElementInternal(p.d.touchEnd,t,2,r.i(this,this.onTouchEvent,"onTouchEvent"),a))},t.prototype.unregisterHandler=function(e,t,n){this.unregisterHandlerWithBrowserClickOption(e,t,n,!1)},t.prototype.unregisterHandlerWithBrowserClickOption=function(e,t,n,i){this.unregisterHandlerWithCaptureOption(e,t,n,i,!1)},t.prototype.unregisterHandlerWithCaptureOption=function(e,t,n,i,r){void 0===r&&(r=!1),this._eventHandlerManager.unregisterHandler(l.q,e,t,n,r),i||(this._eventHandlerManager.deinitializeForElementInternal(t,p.d.touchStart,r),this._eventHandlerManager.deinitializeForElementInternal(t,p.d.touchMove,r),this._eventHandlerManager.deinitializeForElementInternal(t,p.d.touchEnd,r))},t.prototype.registerDefaultHandler=function(e,t,n){for(var i=0;i<p.d.get_clickEvents().length;++i)p.d.isInternalEvent(p.d.get_clickEvents()[i])||this._eventHandlerManager.registerHandler(l.q,p.d.get_clickEvents()[i],e,3,r.i(this,this.onClickEvent,"onClickEvent"),t,n)},t.prototype.unregisterDefaultHandler=function(e,t){for(var n=0;n<p.d.get_clickEvents().length;++n)p.d.isInternalEvent(p.d.get_clickEvents()[n])||this._eventHandlerManager.unregisterHandler(l.q,p.d.get_clickEvents()[n],t,e)},t.prototype.onClickEvent=function(e,t,n){var i=this._inTouchClick?3:2;b.y.get_isIPad()&&(i=3);var r=l.q.createFromMouseEvent(e,t,null,n,i),o=e===p.d.click,a=e===p.d.doubleClick;return this.processClick(r,o,a)},t.prototype.onTouchEvent=function(e,t,i){var r=f.f.create(e,t,null,i),o=m.k.getTouchClickAdapter(t);if(y.v.isMultiTouch(i))return o.cancelPendingClick(),!1;if(t.disabled)return!1;var a=new _.y;if(e===p.d.touchStart)o.onTouchStart(r,this._lastTouchEventArgs);else if(e===p.d.touchMove)o.onTouchMove(r);else if(e===p.d.touchEnd){if((a=o.onTouchEnd(r,this._lastTouchEventArgs)).isTouchClick||a.isTouchDoubleClick)this._eventHandlerManager.temporarilyDisableBrowserClicks(),g.TouchAndHoldAdapter.getTouchAndHoldAdapter(r.get_sourceElement()).cancelTouchAndHold(),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SelectWordOnDoubleTapIsEnabled")&&i.rawEvent&&(a.isTouchDoubleClick?this._lastTouchEventArgs=null:this._lastTouchEventArgs=r)}else e===p.d.touchCancel&&o.onTouchCancel(r);if(a.isTouchClick||a.isTouchDoubleClick){this._inTouchClick=!0;var s=this.processClick(a.clickArgs,a.isTouchClick,a.isTouchDoubleClick);return this._inTouchClick=!1,s}return!1},t.prototype.onMsPointerDown=function(e){this._inTouchClick=2===h.l(e)},t.prototype.processClick=function(e,t,n){if(!this.get_isEnabled())return!1;if(!A.s.isValidElement(e.get_sourceElement()))return!1;if(v.y.get_instance().get_isYielding())return!1;if(this._supressEvents)return this.cancelClick(e),!0;if(this.get_clickStartedOutsideCanvas())return this.set_clickStartedOutsideCanvas(!1),!0;var i=!1;if(this._capturedHandler)return e.userData=this._capturedHandler.userData,(i=this._capturedHandler.handler(e))&&this.cancelClick(e),i;if(n){if(c.EventHandlerManager.get_instance().get_isDragging())return this.cancelClick(e),!0;i=this._eventHandlerManager.processEvent(l.q,p.d.doubleClick,e.get_caughtElement(),e)}else t&&(this._eventHandlerManager.set_lastClickEventTime((new Date).getTime()),i=this._eventHandlerManager.processEvent(l.q,p.d.click,e.get_caughtElement(),e));return i&&this.cancelClick(e),i},t.prototype.cancelClick=function(e){var t=!0;3===e.get_inputSource()&&C.g.isTextField(e.get_sourceElement())&&(t=!1),a.n.cancelEventInternal(e.innerEvent,t)},t.prototype.capture=function(e,t){this._capturedHandler=new u.a(l.q,e,t)},t.prototype.releaseCapture=function(){this._capturedHandler=null},t.prototype.addFocusEvent=function(e,t,n){var i=this;void 0===n&&(n=!1);var r=function(t){return!t.get_sourceElement().disabled&&i._focusManager&&i._focusManager.scopeChanged(e),!1};this.registerHandlerWithBrowserClickOption(p.d.click,t,r,null,n),this._focusManager.getScope(e).addDispose((function(){i.unregisterHandler(p.d.click,t,r)}))},t.get_instance=function(){return t._instance||(t._instance=new t),t._instance},t.disposeInputManager=function(){S.b(t._instance),t._instance=null},t._instance=null,t}(a.n);(0,r.l)(T,"ClickInputManager",a.n,[o.p,s.j.$$(Function),Sys.IDisposable])},,function(e,t,n){"use strict";var i=n(701).charAt,r=n(415),o=n(793),a=r.set,s=r.getterFor("String Iterator");o(String,"String",(function(e){a(this,{type:"String Iterator",string:String(e),index:0})}),(function(){var e,t=s(this),n=t.string,r=t.index;return r>=n.length?{value:void 0,done:!0}:(e=i(n,r),t.index+=e.length,{value:e,done:!1})}))},function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var i=(0,n(208).y)("IHostPostmessenger")},,function(e,t,n){"use strict";n.d(t,{v:function(){return r}});var i=n(208),r=function(){return function(){this.id=null,this.queryType=0,this.handler=null,this.data=null}}();(0,i.l)(r,"DataQuery",null,[])},,,function(e,t,n){"use strict";n.d(t,{b:function(){return s}});var i=n(508),r=n(700),o=n(296),a=n(208),s=function(e){function t(t,n,i){var r=e.call(this,t,n,null,i)||this;return r._handlingResize=!1,r._lastResizeWidthHeight=null,r._autoScale=!0,r._clientWidth=o.s.getViewPortWidth(),r._clientHeight=o.s.getViewPortHeight(),r._lastResizeWidthHeight=r.getClientWidthHeightString(),r}return(0,i.t)(t,e),t.prototype.get_lastResizeWidthHeight=function(){return this._lastResizeWidthHeight},t.prototype.get_autoScale=function(){return this._autoScale},t.prototype.set_autoScale=function(e){return this._autoScale=e,e},t.prototype.scale=function(){return this.resetCachedClientDimensions(),!0},t.prototype.refresh=function(){e.prototype.refresh.call(this),this.scale()},t.prototype.getClientWidthHeightString=function(){return this.get_elementInternal()?this.get_elementInternal().clientWidth.toString()+this.get_elementInternal().clientHeight.toString():""},t.prototype.clientDimensionsChanged=function(){return this._clientWidth!==this.get_elementInternal().clientWidth||this._clientHeight!==this.get_elementInternal().clientHeight},t.prototype.resetCachedClientDimensions=function(){this._clientWidth=this.get_elementInternal().clientWidth,this._clientHeight=this.get_elementInternal().clientHeight},t.prototype.onResize=function(){if(this.shouldHandleElementResize){var t=this.getClientWidthHeightString();if(this._lastResizeWidthHeight!==t)if(this._lastResizeWidthHeight=t,!this._handlingResize&&this._autoScale&&this.clientDimensionsChanged())this.resetCachedClientDimensions(),this._handlingResize=!0,e.prototype.onResize.call(this),this.scale()&&this.pollForStateAndUpdate(),this._handlingResize=!1}},t}(r.z);(0,a.l)(s,"ScalableRoot",r.z,[])},function(e,t,n){n(533),n(623),n(429),n(799);var i=n(908);e.exports=i.Map},,,function(e,t,n){var i=n(786),r=n(142),o=i("iterator"),a=Array.prototype;e.exports=function(e){return void 0!==e&&(r.Array===e||a[o]===e)}},function(e){var t=0,n=Math.random();e.exports=function(e){return"Symbol("+String(void 0===e?"":e)+")_"+(++t+n).toString(36)}},,,,,function(e,t,n){"use strict";n.d(t,{f:function(){return a}});var i=n(508),r=n(446),o=n(208),a=function(e){function t(t,n,i,r,o,a,s,l){var u=e.call(this,t,o,l,3)||this;return u._client=null,u._element=null,u._screen=null,u._caught=null,u._timestamp=null,u._timestamp=new Date,u._client=n,u._element=i,u._screen=r,u._caught=a,u.userData=s,u}return(0,i.t)(t,e),t.prototype.get_action=function(){return this.eventName},t.prototype.get_clientPoint=function(){return this._client},t.prototype.get_screenPoint=function(){return this._screen},t.prototype.get_elementPoint=function(){return this._element||(this._element=r.a.getElementPoint(this._client,this.get_sourceElement())),this._element},t.prototype.get_caughtElement=function(){return this._caught},t.prototype.get_timestamp=function(){return this._timestamp},t.create=function(e,n,i,o){var a=r.a.getSourceElement(o);return new t(e,r.a.getClientPointFromTouchEvent(o),null,r.a.getScreenPointFromTouchEvent(o),a,n,i,o)},t}(r.a);(0,o.l)(a,"TouchEventArgs",r.a,[])},function(e,t,n){"use strict";n.d(t,{a:function(){return a}});var i=n(508),r=n(929),o=n(208),a=function(e){function t(t,n,i,r){var o=e.call(this)||this;return o.eventName=null,o._source=null,o.innerEvent=null,o._inputSource=0,o.userData=null,o.eventName=t,o.innerEvent=i,o._source=n,o._inputSource=r,o}return(0,i.t)(t,e),t.prototype.get_clientPoint=function(){return null},t.prototype.get_screenPoint=function(){return null},t.prototype.get_elementPoint=function(){return null},t.prototype.get_shiftKey=function(){return!1},t.prototype.get_ctrlKey=function(){return!1},t.prototype.get_sourceElement=function(){return this._source},t.prototype.get_inputSource=function(){return this._inputSource},t.getSourceElement=function(e){var t=e.rawEvent;if(!t)return e.target;var n=t.srcElement||t.target;return n?n.nodeType===r.o.text&&n.parentNode?n.parentNode:n:null},t.getFirstTouchInfo=function(e){var t=null,n=null,i=null;return(i=e.rawEvent?e.rawEvent:e).touches&&(!(n=i.touches).length&&i.changedTouches&&(n=i.changedTouches),t=n[0]),t},t.getClientPointFromTouchEvent=function(e){var n=e.clientX?e:t.getFirstTouchInfo(e);return new Sys.UI.Point(n.clientX,n.clientY)},t.getScreenPointFromTouchEvent=function(e){var n=t.getFirstTouchInfo(e);return n?new Sys.UI.Point(n.screenX,n.screenY):new Sys.UI.Point(0,0)},t.getElementPoint=function(e,t){var n=Sys.UI.DomElement.getLocation(t);return new Sys.UI.Point(e.x-n.x,e.y-n.y)},t.getMouseButton=function(e){var t=e.button;return"undefined"!=typeof e.which?t:4===t?1:2===t?2:0},t}(Sys.EventArgs);(0,o.l)(a,"EventHandlerArgs",Sys.EventArgs,[])},,function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,{v:function(){return dangerouslyEval}});var dangerouslyEval=function(script){return eval(script)}},function(e,t,n){"use strict";n.d(t,{l:function(){return i}});var i=(0,n(208).y)("IBasicFrame")},,function(e,t,n){"use strict";n.d(t,{k:function(){return i}});var i=(0,n(208).y)("IGestureInputManager")},,,function(e,t,n){"use strict";var i=n(975),r=n(787),o=n(142),a=n(415),s=n(793),l=a.set,u=a.getterFor("Array Iterator");e.exports=s(Array,"Array",(function(e,t){l(this,{type:"Array Iterator",target:i(e),index:0,kind:t})}),(function(){var e=u(this),t=e.target,n=e.kind,i=e.index++;return!t||i>=t.length?(e.target=void 0,{value:void 0,done:!0}):"keys"==n?{value:i,done:!1}:"values"==n?{value:t[i],done:!1}:{value:[i,t[i]],done:!1}}),"values"),o.Arguments=o.Array,r("keys"),r("values"),r("entries")},function(e,t,n){var i=n(382);e.exports=function(e,t,n){for(var r in t)i(e,r,t[r],n);return e}},function(e,t,n){"use strict";n.r(t);var i=n(255),r=n(399),o=n(208),a=(0,o.y)("IQosVeto"),s=(0,o.y)("IQosVetoClassification"),l=n(600),u=n(790),c=n(201),p=n(837),d=function(){function e(t){this._vetosDictionary=null,this._vetosDictionary=t||e.createVetosDictionary()}return e.prototype.get_vetosDictionary=function(){return this._vetosDictionary},e.prototype.getVeto=function(e){if(!e||""===e)return null;var t=null;return this.get_vetosDictionary().tryGetValue(e,(0,l.m)((function(){return t}),(function(e){return t=e})))||p.k(42278923,200,15,"Failed to find veto: {0}",e),t||((t=health.HealthFactoryGlobal.createQosVetoInstance()).setVetoName(e),t.setPillars(["VetoMissingClassification"])),t},e.get_instance=function(){return e._instance||(e._instance=new e(null))},e.set_instance=function(t){return e._instance=t,t},e.createVetosDictionary=function(){for(var e=qosWac.QosWacFactoryGlobal.createWacVetosInstance().vetos(),t=new u.d(String,a,c.b.get_ordinalIgnoreCase()),n=0,i=e;n<i.length;n++){var r=i[n];t.containsKey(r.getVetoName())?p.k(42278924,200,10,"VetoName '{0}' was specified more than once",r.getVetoName()):t.add(r.getVetoName(),r)}return t},e._instance=null,e}();(0,o.l)(d,"QosVetoClassification",null,[s]),n.d(t,{Health:function(){return h}});var h=function(){function e(){}return e.get_instance=function(){return e.getInstance()},e.getInstance=function(){if(!e._singleton){var t=health.HealthFactoryGlobal.createHealthConfigInstance();t.setIsHealthEnabled(r.m.isHealthTelemetrySystemEnabled),t.setIsQosEnabled(r.m.isQosRecorderEnabled),t.setIsKpiEnabled(r.m.isKpiRecorderEnabled),t.setQosVetoClassifier(d.get_instance()),t.setRemoteTelemetryUrl(r.m.remoteTelemetryUrl),t.setHeartbeatIntervalMs(r.m.heartbeatIntervalMs),t.setRecordPillarToWarmPipelineIntervalMs(r.m.recordQosPillarToWarmPipelineIntervalMs),e.setInstance(health.HealthFactoryGlobal.createHealthInstance(t,e.logInitializationError))}return e._singleton},e.setInstance=function(t){if(!t)throw Error.argumentNull("health");e._singleton=t},e.logInitializationError=function(e){i.ULS.sendTraceTag(51144384,383,15,"Failed to initialize the health telemetry system: "+e),r.m.isHealthTelemetrySystemEnabled=!1,r.m.isQosRecorderEnabled=!1,r.m.isKpiRecorderEnabled=!1},e._singleton=null,e}();(0,o.l)(h,"Health",null,[])},function(e,t,n){var i=n(323),r=n(142),o=n(786)("iterator");e.exports=function(e){if(null!=e)return e[o]||e["@@iterator"]||r[i(e)]}},,,function(e,t,n){"use strict";var i=n(255),r=n(556),o=function(e,t){return e<<t|e>>>32-t},a=function(e){var t,n,i=new Sys.StringBuilder;for(t=7;t>=0;t--)n=e>>>4*t&15,i.append(n.toString(16));return i.toString()},s=function(e){var t,n,i,s,l,u,c,p,d=1732584193,h=4023233417,g=2562383102,m=271733878,_=3285377520,f=0,y=new Array(80),v=(e=function(e){e=e.replace("\r\n","\n");for(var t="",n=0;n<e.length;n++){var i=r.l.charCodeAt(e,n);i<128?t+=r.l.fromCharCode(i):i>127&&i<2048?(t+=r.l.fromCharCode(i>>6|192),t+=r.l.fromCharCode(63&i|128)):(t+=r.l.fromCharCode(i>>12|224),t+=r.l.fromCharCode(i>>6&63|128),t+=r.l.fromCharCode(63&i|128))}return t}(e)).length,S=[];for(t=0;t<v-3;t+=4)n=r.l.charCodeAt(e,t)<<24|r.l.charCodeAt(e,t+1)<<16|r.l.charCodeAt(e,t+2)<<8|r.l.charCodeAt(e,t+3),Array.add(S,n);switch(v%4){case 0:f=2147483648;break;case 1:f=r.l.charCodeAt(e,v-1)<<24|8388608;break;case 2:f=r.l.charCodeAt(e,v-2)<<24|r.l.charCodeAt(e,v-1)<<16|32768;break;case 3:f=r.l.charCodeAt(e,v-3)<<24|r.l.charCodeAt(e,v-2)<<16|r.l.charCodeAt(e,v-1)<<8|128}for(Array.add(S,f);S.length%16!=14;)Array.add(S,0);for(Array.add(S,v>>29),Array.add(S,v<<3&4294967295),i=0;i<S.length;i+=16){for(t=0;t<16;t++)y[t]=S[i+t];for(t=16;t<=79;t++)y[t]=o(y[t-3]^y[t-8]^y[t-14]^y[t-16],1);for(s=d,l=h,u=g,c=m,p=_,t=0;t<=19;t++)f=o(s,5)+(l&u|~l&c)+p+y[t]+1518500249&4294967295,p=c,c=u,u=o(l,30),l=s,s=f;for(t=20;t<=39;t++)f=o(s,5)+(l^u^c)+p+y[t]+1859775393&4294967295,p=c,c=u,u=o(l,30),l=s,s=f;for(t=40;t<=59;t++)f=o(s,5)+(l&u|l&c|u&c)+p+y[t]+2400959708&4294967295,p=c,c=u,u=o(l,30),l=s,s=f;for(t=60;t<=79;t++)f=o(s,5)+(l^u^c)+p+y[t]+3395469782&4294967295,p=c,c=u,u=o(l,30),l=s,s=f;d=d+s&4294967295,h=h+l&4294967295,g=g+u&4294967295,m=m+c&4294967295,_=_+p&4294967295}var C=a(d)+a(h)+a(g)+a(m)+a(_);return r.l.toLower(C)},l=n(208);n.d(t,{l:function(){return u}});var u=function(){function e(t){this._uuid=null,this._uuid=e.isValid(t)?t:e.get_nil().toString()}return e.prototype.toString=function(){return this._uuid},e.prototype.equals=function(e){return!!e&&this._uuid===e.toString()},e.get_nameSpace_DNS=function(){return"6ba7b810-9dad-11d1-80b4-00c04fd430c8"},e.get_nameSpace_URL=function(){return"6ba7b811-9dad-11d1-80b4-00c04fd430c8"},e.get_nameSpace_OID=function(){return"6ba7b812-9dad-11d1-80b4-00c04fd430c8"},e.get_nameSpace_X500=function(){return"6ba7b814-9dad-11d1-80b4-00c04fd430c8"},e.get_nil=function(){return e._nilInstance||(e._nilInstance=new e("00000000-0000-0000-0000-000000000000"))},e.createFromString=function(t){return t=e.normalizeUuidString(t),new e(t)},e.createV5Uuid=function(t){var n=s(e.get_nameSpace_URL()+t),i=parseInt(n.substring(16,17),16);return i=3&i|8,new e(n=n.substring(0,8)+"-"+n.substring(8,12)+"-5"+n.substring(13,16)+"-"+["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"][i]+n.substring(17,20)+"-"+n.substring(20,32))},e.deriveFrom=function(t,n){var i=t._uuid.split("-"),r=n._uuid.split("-"),o=new Array(5);return o[0]=e.convertToHex(parseInt(i[0].substr(0,4),16)^parseInt(r[0].substr(0,4),16),4),o[0]+=e.convertToHex(parseInt(i[0].substr(4,4),16)^parseInt(r[0].substr(4,4),16),4),o[1]=e.convertToHex(parseInt(i[1],16)^parseInt(r[1],16),4),o[2]=e.convertToHex(parseInt(i[2],16)^parseInt(r[2],16),4),o[3]=e.convertToHex(parseInt(i[3],16)^parseInt(r[3],16),4),o[4]=e.convertToHex(parseInt(i[4].substr(0,4),16)^parseInt(r[4].substr(0,4),16),4),o[4]+=e.convertToHex(parseInt(i[4].substr(4,4),16)^parseInt(r[4].substr(4,4),16),4),o[4]+=e.convertToHex(parseInt(i[4].substr(8,4),16)^parseInt(r[4].substr(8,4),16),4),new e(o.join("-"))},e.create=function(){n(254).AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.Common.Flighting.WacSecureUuidFlightingAttendant");for(var t=new Sys.StringBuilder,i=0;i<4;i++){var r=Math.floor(4294967295*e.getRandomNumber());2===i&&(r=r%1073741824+2147483648),t.append(e.convertToHex(r,8))}var o=t.toString();return new e([o.substr(0,8),"-",o.substr(8,4),"-4",o.substr(12,3),"-",o.substr(16,4),"-",o.substr(20,12)].join(""))},e.getRandomNumber=function(){var t,r="";!!n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SecureUuidEnabled")&&(window.self.crypto&&window.self.crypto.getRandomValues?r="crypto":window.self.msCrypto&&window.self.msCrypto.getRandomValues&&(r="msCrypto"));var o=n(254).AFrameworkApplication.appSettingsManager?n(254).AFrameworkApplication.appSettingsManager.getIntAppSetting("MaxRandomUuidIterations",1e5):1e5,a=0;do{if(a>o)throw Error.create("max random number generation iterations exceeded");if(""!==r)try{t=window.self[r].getRandomValues(new Uint32Array(1))[0]/4294967295}catch(n){e._errorLoggedInSession||(i.ULS.sendTraceTag(51447265,306,10,"crypto failed. fallback to random. exception: {0}",n),e._errorLoggedInSession=!0),r="",t=1}else t=Math.random();a++}while(1===t);return t},e.convertToHex=function(e,t){for(var n=e.toString(16);n.length<t;)n="0"+n;return n},e.compare=function(e,t){return e.toString()===t.toString()},e.isValid=function(e){try{return 36===e.length&&5===e.split("-").length}catch(e){return!1}},e.normalizeUuidString=function(e){return e.replace(" ","").replace("{","").replace("}","").toLowerCase()},e._nilInstance=null,e._errorLoggedInSession=!1,e}();(0,l.l)(u,"Uuid",null,[])},function(e,t,n){"use strict";n.d(t,{w:function(){return i}});var i,r=n(208);!function(e){e[e.notSpecified=0]="notSpecified",e[e.appCtorStarting=1]="appCtorStarting",e[e.appCtorInitialized=2]="appCtorInitialized",e[e.contentDisplayed=3]="contentDisplayed",e[e.interactivityReady=4]="interactivityReady",e[e.ribbonInitialized=5]="ribbonInitialized",e[e.ribbonBehaviorAttached=6]="ribbonBehaviorAttached",e[e.chromeReady=7]="chromeReady",e[e.appLoadedSuccessfully=8]="appLoadedSuccessfully",e[e.appLoadedFailure=9]="appLoadedFailure",e[e.ribbonDisplayed=10]="ribbonDisplayed",e[e.ribbonAutomationReady=11]="ribbonAutomationReady",e[e.commentRendered=12]="commentRendered",e[e.appEncounteredFirstError=13]="appEncounteredFirstError"}(i||(i={})),(0,r.h)("AppInitializationStatus",i)},,,,,,function(e,t,n){"use strict";n.d(t,{k:function(){return o}});var i=n(865),r=n(208),o=function(){function e(){this._parentOperation=null,this._isCompleted=!1,this._isCanceled=!1,this._isSynchronous=!1,this._childOperation=null,this._operationName=null,this.startTime=null,this.endTime=null}return e.prototype.init=function(e){this._parentOperation=e,this._parentOperation?(this.startTime=this._parentOperation.get_startTime(),e.setChildOperation(this),this._isSynchronous=this._parentOperation.get_isSynchronous()):(this.startTime=new Date,this._isSynchronous=!1),this._isCompleted=!1,this._isCanceled=!1},e.prototype.get_inProgress=function(){return!(this._isCompleted||this._isCanceled)},e.prototype.get_isCanceled=function(){return this._isCanceled},e.prototype.setIsCanceled=function(){this._isCanceled=!0,this.endTime=new Date},e.prototype.get_isCompleted=function(){return this._isCompleted},e.prototype.setIsCompleted=function(){this._isCompleted=!0,this.endTime=new Date},e.prototype.get_isSynchronous=function(){return this._isSynchronous},e.prototype.set_isSynchronous=function(e){return this._isSynchronous=e,e},e.prototype.get_startTime=function(){return this.startTime},e.prototype.get_endTime=function(){return this.endTime},e.prototype.get_childOperation=function(){return this._childOperation},e.prototype.get_operationName=function(){return this._operationName},e.prototype.get_activeChildOperation=function(){return this._childOperation&&this._childOperation.get_inProgress()?this._childOperation:null},e.prototype.get_timeoutExceeded=function(){var t;if(this.get_isSynchronous()||n(254).AFrameworkApplication.isShuttingDown)t=!1;else if(this._parentOperation)t=this._parentOperation.get_timeoutExceeded();else{t=(new Date).getTime()-this.get_startTime().getTime()>e.timeSliceLength}return t},e.prototype.get_hasYielded=function(){return!this._isSynchronous&&n(254).AFrameworkApplication.get_theTaskManager().get_isYielding()},e.prototype.setDebugName=function(e){this._operationName=e},e.prototype.setChildOperation=function(e){this._childOperation=e},e.prototype.clearChildOperation=function(){this._childOperation=null},e.prototype.yield=function(){this._parentOperation?(this._parentOperation.yield(),this.startTime=this._parentOperation.get_startTime()):(this.startTime=new Date,n(254).AFrameworkApplication.get_theTaskManager().yield(this))},e.prototype.recycle=function(){this._childOperation=null},e.timeSliceLength=200,e}();(0,r.l)(o,"AOperation",null,[i.b])},,function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var i=n(508),r=n(208),o=n(798),a=function(e){function t(){var t=e.call(this)||this;return t._request=null,t._state=0,t._parsedXml=null,t}return(0,i.t)(t,e),t.prototype.get_started=function(){return this._state>0},t.prototype.get_aborted=function(){return 2===this._state},t.prototype.get_responseAvailable=function(){return 5===this._state},t.prototype.get_timedOut=function(){return 3===this._state},t.prototype.get_statusCode=function(){return this._request.get_statusCode()},t.prototype.get_statusText=function(){return this._request.get_statusText()},t.prototype.get_responseData=function(){return this._request.get_responseText()},t.prototype.get_xml=function(){return this._parsedXml||(this._parsedXml=this.parseXmlResponse()),this._parsedXml},t.prototype.abort=function(){this.finishWebRequest(2,!0)},t.prototype.getAllResponseHeaders=function(){var e=this._request.get_contentType();return e&&e.length>0?String.format("Content-Type:{0}",e):""},t.prototype.getResponseHeader=function(e){return t.corsSimpleResponseHeadersOnlyIsEnabled&&!t.isSimpleHeader(e)?null:this._request.getResponseHeader(e)},t.prototype.executeRequest=function(){this._state=1;var e=this.get_webRequest(),t=e.get_httpVerb();if(this._request=o.u.create(),this._request){this._request.setRequestCompleted(r.i(this,this.onRequestCompleted,"onRequestCompleted")),this._request.open(t,e.getResolvedUrl());var n=e.get_timeout();n>0&&window.setTimeout(r.i(this,this.onTimeout,"onTimeout"),n),this._request.send("POST"===t.toUpperCase()?e.get_body():"")}else this.finishWebRequest(4,!1)},t.prototype.finishWebRequest=function(e,t){1===this._state&&(this._state=e,t&&this._request.abort(),this.get_webRequest().completed(Sys.EventArgs.Empty))},t.prototype.onRequestCompleted=function(){this.finishWebRequest(5,!1)},t.prototype.onTimeout=function(){this.finishWebRequest(3,!0)},t.prototype.parseXmlResponse=function(){var e=Sys.Net.XMLDOM(this.get_responseData());if(!e||!e.documentElement)return null;var t=e.documentElement;return"http://www.mozilla.org/newlayout/xml/parsererror.xml"===t.namespaceUri&&"parsererror"===t.tagName?null:t.firstChild&&"parsererror"===t.firstChild.tagName?null:e},t.prototype.verifyResponseAvailable=function(e){if(!this.get_responseAvailable()||!this._request)throw Error.invalidOperation(String.format("Cannot call method '{0}' except in synchronous callback. ResponseAvailable: '{1}', Request: '{2}'",e,this.get_responseAvailable(),this._request))},t.prototype.verifyCanExecute=function(){if(!this.get_webRequest()||this._state)throw Error.invalidOperation(String.format("Cannot execute request. State: '{0}', WebRequest: '{1}'",this._state,this.get_webRequest()))},t.isSimpleHeader=function(e){return e.toLowerCase()in t.simpleResponseHeaders},t.simpleResponseHeaders={"cache-control":1,"content-language":1,"content-type":1,expires:1,"last-modified":1,pragma:1},t.corsSimpleResponseHeadersOnlyIsEnabled=!1,t}(Sys.Net.WebRequestExecutor);(0,r.l)(a,"Common.CrossDomainRequestExecutor",Sys.Net.WebRequestExecutor,[])},,function(e,t,n){"use strict";n.d(t,{s:function(){return s}});var i=n(508),r=n(743),o=n(556),a=n(208),s=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.wordViewerImage=function(e){return r.h.staticContentHost+t.wordViewerImageBase+o.l.escape(e)+r.h.removeBroltiFlightFromStaticContentQueryParameter(r.h.get_staticContentQueryParameter())},t.wordViewerCss=function(e){return r.h.staticContentHost+t.wordViewerCssBase+o.l.escape(e)+r.h.get_staticContentQueryParameter()},t.wordViewerScriptLocalized=function(e){return t.wordViewerScriptsLcidBase+o.l.escape(e)+r.h.get_staticContentQueryParameter()},t.wordViewerScript=function(e){return t.wordViewerScriptsBase+o.l.escape(e)+r.h.get_staticContentQueryParameter()},t.ribbonImage=function(e){return r.h.staticContentHost+t.ribbonImageBase+o.l.escape(e)+r.h.removeBroltiFlightFromStaticContentQueryParameter(r.h.get_staticContentQueryParameter())},t.ribbonCss=function(e){return r.h.staticContentHost+t.ribbonCssBase+o.l.escape(e)+r.h.get_staticContentQueryParameter()},t.ribbonScript=function(e){return t.ribbonScriptsBase+o.l.escape(e)+r.h.get_staticContentQueryParameter()},t.wordViewerImageBase=null,t.wordViewerCssBase=null,t.wordViewerScriptsBase=null,t.wordViewerScriptsLcidBase=null,t.ribbonImageBase=null,t.ribbonCssBase=null,t.ribbonScriptsBase=null,t}(r.h);(0,a.l)(s,"Path",r.h,[])},function(e,t,n){n(770);var i=n(908);e.exports=i.Object.entries},function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=n(742),a=n(795),s=function(){function e(e){this._task=null,this._task=e}return e.prototype.onCompleted=function(e){this._task.OC(e,null,0,null)},e.prototype.get_isCompleted=function(){return this._task.get_isCompleted()},e.prototype.getResult=function(){if(this._task.get_isFaulted())throw this._task.get_exception();if(this._task.get_isCanceled())throw a.r.CreateCancellationException();return this._task.get_result()},e}();n.d(t,{Task$1:function(){return l}});var l=function(e){function t(n){var i=e.call(this)||this;return i._func=null,i._funcWithData=null,r.m(i,t.$$(n)),i._result=r.c(r.f(i,"$$sc.Task$1").TResult),i}return(0,i.t)(t,e),t.prototype.execute=function(){if(this._func)this.set_result(this._func());else{if(!this._funcWithData)return!1;this.set_result(this._funcWithData(this._data))}return!0},t.prototype.get_result=function(){if(6!==this.get_status())throw Error.invalidOperation();return this._result},t.prototype.set_result=function(e){return this._result=e,e},t.prototype.G=function(){return new s(this)},t.C=function(e){var n=new t(r.f(this,"$$sc.Task$1").TResult);return n._func=e,n},t.CO=function(e,n){var i=new t(r.f(this,"$$sc.Task$1").TResult);return i._funcWithData=e,i._data=n,i},t.$$=function(e){var n="Task$1$"+e.getName(),i=r.x(n);return i||r.u(n,"$$sc.Task$1",t,[{TResult:e}],o.Task,[])},t}(o.Task)},,function(e,t,n){"use strict";var i=n(842),r=n(254),o=n(851),a=n(154),s=n(235),l=n(556),u=n(208),c=n(255),p=function(){return function(){this.languageId=0,this.name=null,this.displayName=null}}();(0,u.l)(p,"TranslationLanguageInfo",null,[]);var d=n(867),h=n(484),g=function(){function e(e,t){this._translationLanguages=null,this._translationLanguagesLocalized=!1,this._requestUri=null,this._defaultLanguages=null,this._requestUri=e,this._defaultLanguages=t}return e.prototype.requestTranslationLanguagesAppSetting=function(){r.AFrameworkApplication.theClientRequestManager.addRequest(this._requestUri(),1,null,null,!1,2,u.i(this,this.onAppSettingsRequestSucceeded,"onAppSettingsRequestSucceeded"),u.i(this,this.onAppSettingsRequestFailed,"onAppSettingsRequestFailed"),null)},e.prototype.getLanguages=function(){for(var e=(this._translationLanguages||this._defaultLanguages()).split(","),t=this._translationLanguagesLocalized?e.length/3:e.length/2,n=new Array(t),i=0;i<t;i++){n[i]=new p,n[i].name=e[i];var r=parseInt(e[i+t]);n[i].languageId=r,n[i].displayName=this._translationLanguagesLocalized?e[i+2*t]:h.i.get_l_LanguageNames()[r]}return n},e.prototype.updateAppSettings=function(e){this._translationLanguages=e.TranslationLanguages,this._translationLanguagesLocalized=Boolean.parse(e.TranslationLanguagesLocalized||"false")},e.prototype.onAppSettingsRequestFailed=function(e){var t={Status:e.get_data().status,HttpStatus:e.get_data().httpStatus,ResponseData:l.l.trimToLength(e.get_data().responseData,100)};c.ULS.sendTraceTag(42295809,301,10,"Failed to get the supported translation languages. The translation languages from BRS setting will be used. Error: {0}",t)},e.prototype.onAppSettingsRequestSucceeded=function(e){var t;c.ULS.sendTraceTag(42295810,301,50,"Retrieved the supported translation languages successfully.");try{var n=e.get_data().responseData;t=d.b(n)}catch(e){return void c.ULS.sendTraceTag(42295811,301,10,"Failed to deserialize the supported translation languages. The translation languages from BRS setting will be used. Exception: {0}",e)}this.updateAppSettings(t)},e}();(0,u.l)(g,"TranslationLanguagesManager",null,[]),n.d(t,{o:function(){return m}});var m=function(){function e(){}return e.launchDialog=function(){(new(n(682).TranslationDialog)).start()},e.downloadATranslatedCopy=function(){(new(n(759).DownloadATranslatedCopyRequest)).start(n(941).App.get_activeAppFrame().get_notificationBar())},e.saveAndEditDialog=function(){(new(n(895).SaveAndEditDialog)).start()},e.saveAndEditATranslatedCopy=function(){(new(n(834).SaveAndEditATranslatedCopyRequest)).start(n(941).App.get_activeAppFrame().get_notificationBar())},e.translateDocument=function(e){new(n(737).TranslateDocumentRequestFromViewer)(e).start(n(941).App.get_activeAppFrame().get_notificationBar())},e.navigateToOriginalDocument=function(){var e=o.n.removeParameter(window.self.location.href,"language");a.g.openWindow(1,e)},e.triggerFloodgateSurveyForTranslator=function(){var e=s.w.get_instance().resolveFuture(i.t);e&&e.execute((function(e){window.setTimeout((function(){e.logActivity("WACTranslatorSurveyTrigger","WACTranslatorFloodgateCampaignEnabled")}),r.AFrameworkApplication.appSettingsManager.getIntAppSetting("WACTranslatorSurveyDelayInMilliseconds",5e3))}))},e.getLanguagesRequestUri=function(){return n(941).App.webServiceBase+"translation.ashx?"+n(941).App.get_instance().theDocument.get_baseDocQuerySignature()+"&uilang="+l.l.urlKeyValueEncode(r.AFrameworkApplication.uiCulture)},e.getDefaultTranslationLanguages=function(){return n(941).App.get_instance().get_translationLanguages()},e.translationLanguages=new g(e.getLanguagesRequestUri,e.getDefaultTranslationLanguages),e}();(0,u.l)(m,"TranslationManager",null,[])},,,function(e,t,n){"use strict";n.d(t,{c:function(){return o}});var i=n(898),r=n(208),o=function(){function e(e,t,n,i,r,o,a){void 0===r&&(r=0),void 0===o&&(o=null),void 0===a&&(a=!1),this._priority=0,this._tickInterval=0,this._acceptableTickRange=0,this._process=null,this._lastProcessed=0,this._lastDelayTick=0,this._type=0,this._deleted=!1,this._runImmediately=!1,this.customData=null,this.data=null,this.name=null,this.taskItemId=0,this._priority=e,this._type=t,this._tickInterval=n,this._process=i,this._runImmediately=a,this._lastProcessed=a?0:(new Date).getTime(),this.taskItemId=r,this.name=o}return e.prototype.get_priority=function(){return this._priority},e.prototype.get_taskType=function(){return this._type},e.prototype.get_interval=function(){return this._tickInterval},e.prototype.set_interval=function(e){return this._tickInterval=e,e},e.prototype.get_loggingName=function(){return this.name?this.get_taskItemId().toString()+"_"+this.name:this.get_taskItemId().toString()},e.prototype.get_acceptableTickRange=function(){return void 0!==this._acceptableTickRange&&null!==this._acceptableTickRange?this._acceptableTickRange:i.n.getDefaultTaskAcceptableTickRange(this)},e.prototype.set_acceptableTickRange=function(e){return this._acceptableTickRange=e,e},e.prototype.get_lastProcessed=function(){return this._lastProcessed},e.prototype.get_lastDelayTick=function(){return this._lastDelayTick},e.prototype.get_queueTick=function(){return this._lastDelayTick+this._tickInterval},e.prototype.get_isDeleted=function(){return this._deleted},e.prototype.set_isDeleted=function(e){return this._deleted=e,e},e.prototype.setDescription=function(e){},e.prototype.get_taskItemId=function(){return this.taskItemId},e.prototype.process=function(){this._lastProcessed=this._lastProcessed+this.get_interval(),this._lastDelayTick=(new Date).getTime()-this._lastProcessed,this._process&&this._process(this);var e=(new Date).getTime();this._lastProcessed=Math.max(e,this._lastProcessed)},e.prototype.onEnqueue=function(){var e=(new Date).getTime();this._priority?this._runImmediately?this._runImmediately=!1:this._lastProcessed=Math.max(e,this._lastProcessed):this._lastProcessed=e,this._deleted=!1},e}();(0,r.l)(o,"TaskItem",null,[])},,,function(e,t,n){"use strict";n.d(t,{k:function(){return u}});var i=n(508),r=n(223),o=n(255),a=n(349),s=n(254),l=n(208),u=function(e){function t(t,n,i){return void 0===i&&(i=null),e.call(this,t,!0,s.AFrameworkApplication.dialogClearerStringsIsEnabled,new a.r(t,n),i)||this}return(0,i.t)(t,e),t.prototype.get_iconString=function(){return"Print_32x32x32"},t.prototype.get_messageString=function(){return s.AFrameworkApplication.dialogClearerStringsIsEnabled?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:CommonUIStrings.l_PrintDialogDocumentIsPrinting},t.prototype.get_linkString=function(){return CommonUIStrings.l_PrintDialogLinkSuggestion},t.prototype.get_linkId=function(){return"PrintPDFLink"},t.prototype.get_buttonText=function(){return CommonUIStrings.l_PrintDialogOpenPDF},t.prototype.get_cssClassName=function(){return s.AFrameworkApplication.dialogClearerStringsIsEnabled?"UIFontDialogTextLarge":null},t.prototype.logDialogDisplayed=function(){o.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")},t.prototype.logDownloadLinkClicked=function(){s.AFrameworkApplication.theWsaClient.incrementDw(9540,1),o.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")},t.prototype.logDownloadButtonClicked=function(){o.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")},t}(r.v);(0,l.l)(u,"PrintDialogWithLinkToPdf",r.v,[])},function(e,t,n){"use strict";n.d(t,{c:function(){return a}});var i=n(508),r=n(208),o=n(56),a=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.executeRequest=function(){var e=this.get_webRequest();this.verifyRequestValidity(e),this._xmlHttpRequest=new XMLHttpRequest,this._xmlHttpRequest.onreadystatechange=r.i(this,this.onReadyStateChange,"onReadyStateChange"),this._xmlHttpRequest.open(e.get_httpVerb(),e.getResolvedUrl(),!0),this.setResponseType(!0),this._xmlHttpRequest.setRequestHeader("X-Requested-With","XMLHttpRequest"),this.processXMLHttpRequest(e)},t}(o.d);(0,r.l)(a,"Common.AsynchronousXMLHttpExecutor",o.d,[])},,function(e,t,n){"use strict";n.d(t,{i:function(){return o}});var i=n(978),r=n(208),o=function(){function e(t,n,i){if(this._lcid=0,this._name=null,this._neutral=!1,this._displayName=null,1===arguments.length){var r=e.getCultureInfo(t);r?(this._name=r._name,this._lcid=r._lcid,this._displayName=r._displayName,this._neutral=r._neutral):(this._name="X-NONE",this._lcid=0,this._displayName="Unknown Culture",this._neutral=!0)}else this._name=t,this._lcid=n,this._neutral=i}return e.prototype.get_LCID=function(){return this._lcid},e.prototype.get_languageId=function(){return 1023&this._lcid},e.prototype.get_name=function(){return this._name},e.prototype.get_formattingName=function(){return e.get_languageIdMapping().get_value()[this.get_LCID().toString()]?e.get_languageIdMapping().get_value()[this.get_LCID().toString()].toString():this.get_displayName()},e.prototype.get_displayName=function(){return this._displayName||(this._displayName=e.get_l_LanguageNames()[this._lcid]),this._displayName},e.prototype.get_isNeutralCulture=function(){return this._neutral},e.get_languageIdMapping=function(){return e._languageIdMapping||(e._languageIdMapping=new i.q(Object,(function(){return{20490:"es-PR",8251:"sms-FI",17418:"es-SV",17417:"en-MY",8218:"bs-Cyrl-BA",8204:"fr-RE",8202:"es-VE",8201:"en-JM",8200:"el-GR",8193:"ar-OM",6154:"es-PA",7227:"sma-SE",19466:"es-NI",16394:"es-BO",16393:"en-IN",16385:"ar-QA",7194:"sr-Cyrl-BA",7180:"fr-WINDIES",7178:"es-DO",7177:"en-ZA",7169:"ar-TN",12289:"ar-LB",6203:"sma-NO",15372:"fr-HT",15370:"es-PY",15369:"en-HK",15361:"ar-BH",6170:"sr-Latn-BA",6156:"fr-MC",18442:"es-HN",6153:"en-IE",6145:"ar-MA",4155:"smj-NO",11274:"es-AR",5179:"smj-SE",14348:"fr-MA",14346:"es-UY",14345:"en-ID",14337:"ar-AE",5146:"bs-Latn-BA",5132:"fr-LU",5130:"es-CR",5129:"en-NZ",5127:"de-LI",5124:"zh-MO",5121:"ar-DZ",31770:"sr",31748:"zh-HanT",22538:"es-419",10266:"sr-Cyrl-RS",10252:"fr-SN",10250:"es-PE",10249:"en-BZ",13324:"fr-ML",13322:"es-CL",13321:"en-PH",10241:"ar-SY",13313:"ar-KW",4122:"hr-BA",4108:"fr-CH",4106:"es-GT",4105:"en-CA",4103:"de-LU",4100:"zh-SG",3179:"quz-PE",4097:"ar-LY",1085:"yi-Hebr",1144:"ii-CN",2163:"ti-ET",21514:"es-US",2145:"ne-IN",3131:"se-FI",2143:"tzm-Latn-DZ",12314:"sr-Cyrl-ME",1070:"hsb-DE",1130:"yo-NG",12300:"fr-CI",1091:"uz-Latn-UZ",12298:"es-EC",12297:"en-ZW",2055:"de-CH",2052:"zh-CN",2115:"uz-Cyrl-UZ",9242:"sr-Latn-RS",3098:"sr-Cyrl-CS",2107:"se-SE",9228:"fr-CD",3084:"fr-CA",9226:"es-CO",3082:"es-ES",3081:"en-AU",2094:"dsb-DE",3079:"de-AT",2092:"az-Cyrl-AZ",1064:"tg-Cyrl-TJ",3076:"zh-HK",2155:"quz-EC",3073:"ar-EG",3072:"[Custom Culture]",1153:"mi-NZ",1119:"tzm-Arab-MA",1086:"ms-MY",2144:"ks-Deva",2077:"sv-FI",1053:"sv-SE",2141:"iu-Latn-CA",2074:"sr-Latn-CS",2073:"ru-MO",2072:"ro-MO",2137:"sd-Arab-PK",2070:"pt-PT",2068:"nn-NO",2067:"nl-BE",1073:"ts-ZA",2064:"it-CH",2129:"bo-BT",2128:"mn-Mong-CN",2060:"fr-BE",1132:"nso-ZA",1097:"ta-IN",2057:"en-GB",1164:"prs-AF",106:"yo",2118:"pa-Arab-PK",2117:"bn-BD",2049:"ar-IQ",2048:"[Language Not Specified]",1156:"gsw-FR",2110:"ms-BN",1054:"th-TH",2108:"ga-IE",1083:"se-NO",136:"wo",1114:"syr-SY",1148:"moh-CA",1145:"pap-AN",11290:"sr-Latn-ME",1075:"ve-ZA",1106:"cy-GB",1140:"gn-PY",1139:"ti-ER",1138:"om-Ethi-ET",120:"ii",1136:"ig-NG",1066:"vi-VN",1098:"te-IN",1169:"gd-GB",2087:"lt-LT",11276:"fr-CM",61:"yi",1060:"sl-SI",11273:"en-TT",1058:"uk-UA",128:"ug",1160:"wo-SN",1159:"rw-RW",1158:"qut-GT",1157:"sah-RU",11265:"ar-JO",1155:"co-FR",1154:"oc-FR",1117:"iu-Cans-CA",1152:"ug-CN",1115:"si-LK",1150:"br-FR",1113:"sd-Deva-IN",1112:"mni-IN",51:"ve",1146:"arn-CL",1109:"my-MM",115:"ti",1143:"so-SO",1142:"la-Latn",1141:"haw-US",1104:"mn-MN",2058:"es-MX",1102:"mr-IN",1137:"kr-NG",1100:"ml-IN",1135:"kl-GL",1134:"lb-LU",1133:"ba-RU",1096:"or-IN",1131:"quz-BO",1094:"pa-IN",1129:"ibb-NG",1128:"ha-Latn-NG",1127:"ff-NG",1126:"bin-NG",1125:"dv-MV",1124:"fil-PH",1123:"ps-AF",1122:"fy-NL",1121:"ne-NP",1120:"ks-Arab",1084:"gd-GB",1118:"am-ET",1082:"mt-MT",1116:"chr-Cher-US",1080:"fo-FO",1079:"ka-GE",1078:"af-ZA",1077:"zu-ZA",1111:"kok-IN",1110:"gl-ES",1074:"tn-ZA",1108:"lo-LA",1107:"km-KH",1071:"mk-MK",1105:"bo-CN",1069:"eu-ES",1103:"sa-IN",1067:"hy-AM",1101:"as-IN",1065:"fa-IR",1099:"kn-IN",1063:"lt-LT",1062:"lv-LV",1061:"et-EE",1095:"gu-IN",1059:"be-BY",1093:"bn-IN",1092:"tt-RU",1056:"ur-PK",1090:"tk-TM",1089:"sw-KE",1088:"ky-KG",1087:"kk-KZ",1052:"sq-AL",1051:"sk-SK",1050:"hr-HR",1049:"ru-RU",1048:"ro-RO",1081:"hi-IN",1046:"pt-BR",1045:"pl-PL",1044:"nb-NO",1043:"nl-NL",1076:"xh-ZA",1041:"ja-JP",1040:"it-IT",119:"so",1072:"st-ZA",1037:"he-IL",1036:"fr-FR",1035:"fi-FI",1068:"az-Latn-AZ",1033:"en-US",1032:"el-GR",1031:"de-DE",1030:"da-DK",1029:"cs-CZ",1028:"zh-TW",1027:"ca-ES",1026:"bg-BG",140:"prs",1024:"[No Proofing]",1057:"id-ID",50:"tn",1055:"tr-TR",135:"rw",134:"qut",133:"sah",132:"gsw",131:"co",130:"oc",129:"mi",1047:"rm-CH",127:"[Invariant Language]",126:"br",89:"sd",124:"moh",1042:"ko-KR",122:"arn",121:"pap",1039:"is-IS",1038:"hu-HU",118:"la",117:"haw",116:"gn",1034:"es-ES_tradnl",114:"om",113:"kr",112:"ig",111:"kl",110:"lb",109:"ba",108:"nso",107:"quz",1025:"ar-SA",105:"ibb",104:"ha",103:"ff",102:"bin",101:"dv",100:"fil",99:"ps",98:"fy",97:"ne",96:"ks",95:"tzm",94:"am",93:"iu",92:"chr",91:"si",90:"syr",85:"my",88:"mni",87:"kok",86:"gl",9275:"smn-FI",84:"lo",83:"km",82:"cy",81:"bo",80:"mn",79:"sa",78:"mr",77:"as",76:"ml",75:"kn",74:"te",73:"ta",72:"or",71:"gu",70:"pa",69:"bn",68:"tt",67:"uz",66:"tk",65:"sw",64:"ky",63:"kk",62:"ms",18441:"en-SG",60:"gd",59:"se",58:"mt",57:"hi",56:"fo",55:"ka",54:"af",53:"zu",52:"xh",31:"tr",47:"mk",49:"ts",48:"st",44:"az",46:"hsb",45:"eu",41:"fa",43:"hy",42:"vi",38:"lv",40:"tg",39:"lt",35:"be",37:"et",36:"sl",9225:"en-029",34:"uk",33:"id",32:"ur",29:"sv",30:"th",27:"sk",28:"sq",9217:"ar-YE",26:"hr",25:"ru",24:"ro",23:"rm",22:"pt",21:"pl",20:"no",19:"nl",18:"ko",17:"ja",16:"it",15:"is",14:"hu",13:"he",12:"fr",11:"fi",10:"es",9:"en",8:"el",7:"de",6:"da",5:"cs",4:"zh-HanS",3:"ca",2:"bg",1:"ar",0:"x-none"}})))},e.initLanguages=function(){e._allCultures=[],e._lcidMap=[],e._localnameMap={},e.initLanguagesFromDictionary({"AR-SA":1025,"BG-BG":1026,"CA-ES":1027,"ZH-TW":1028,"CS-CZ":1029,"DA-DK":1030,"DE-DE":1031,"EL-GR":1032,"EN-US":1033,"ES-ES":1034,"FI-FI":1035,"FR-FR":1036,"HE-IL":1037,"HU-HU":1038,"IS-IS":1039,"IT-IT":1040,"JA-JP":1041,"KO-KR":1042,"NL-NL":1043,"NB-NO":1044,"PL-PL":1045,"PT-BR":1046,"RM-CH":1047,"RO-RO":1048,"RU-RU":1049,"HR-HR":1050,"SK-SK":1051,"SQ-AL":1052,"SV-SE":1053,"TH-TH":1054,"TR-TR":1055,"UR-PK":1056,"ID-ID":1057,"UK-UA":1058,"BE-BY":1059,"SL-SI":1060,"ET-EE":1061,"LV-LV":1062,"LT-LT":1063,"TG-CYRL-TJ":1064,"FA-IR":1065,"VI-VN":1066,"HY-AM":1067,"AZ-LATN-AZ":1068,"EU-ES":1069,"HSB-DE":1070,"MK-MK":1071,"ST-ZA":1072,"TS-ZA":1073,"TN-ZA":1074,"VE-ZA":1075,"XH-ZA":1076,"ZU-ZA":1077,"AF-ZA":1078,"KA-GE":1079,"FO-FO":1080,"HI-IN":1081,"MT-MT":1082,"SE-NO":1083,"YI-HEBR":1085,"MS-MY":1086,"KK-KZ":1087,"KY-KG":1088,"SW-KE":1089,"TK-TM":1090,"UZ-LATN-UZ":1091,"TT-RU":1092,"BN-IN":1093,"PA-IN":1094,"GU-IN":1095,"OR-IN":1096,"TA-IN":1097,"TE-IN":1098,"KN-IN":1099,"ML-IN":1100,"AS-IN":1101,"MR-IN":1102,"SA-IN":1103,"MN-MN":1104,"BO-CN":1105,"CY-GB":1106,"KM-KH":1107,"LO-LA":1108,"MY-MM":1109,"GL-ES":1110,"KOK-IN":1111,"MNI-IN":1112,"SD-DEVA-IN":1113,"SYR-SY":1114,"SI-LK":1115,"CHR-CHER-US":1116,"IU-CANS-CA":1117,"AM-ET":1118,"TZM-ARAB-MA":1119,"KS-ARAB":1120,"NE-NP":1121,"FY-NL":1122,"PS-AF":1123,"FIL-PH":1124,"DV-MV":1125,"BIN-NG":1126,"FF-NG":1127,"HA-LATN-NG":1128,"IBB-NG":1129,"YO-NG":1130,"QUZ-BO":1131,"NSO-ZA":1132,"BA-RU":1133,"LB-LU":1134,"KL-GL":1135,"IG-NG":1136,"KR-NG":1137,"OM-ETHI-ET":1138,"TI-ET":1139,"GN-PY":1140,"HAW-US":1141,"LA-LATN":1142,"SO-SO":1143,"II-CN":1144,"PAP-AN":1145,"ARN-CL":1146,"MOH-CA":1148,"BR-FR":1150,"UG-CN":1152,"MI-NZ":1153,"OC-FR":1154,"CO-FR":1155,"GSW-FR":1156,"SAH-RU":1157,"QUT-GT":1158,"RW-RW":1159,"WO-SN":1160,"PRS-AF":1164,"GD-GB":1169,"KU-ARAB-IQ":1170,"AR-IQ":2049,"CA-ES-VALENCIA":2051,"ZH-CN":2052,"DE-CH":2055,"EN-GB":2057,"ES-MX":2058,"FR-BE":2060,"IT-CH":2064,"NL-BE":2067,"NN-NO":2068,"PT-PT":2070,"RO-MD":2072,"RU-MD":2073,"SR-LATN-CS":2074,"SV-FI":2077,"AZ-CYRL-AZ":2092,"DSB-DE":2094,"SE-SE":2107,"GA-IE":2108,"MS-BN":2110,"UZ-CYRL-UZ":2115,"BN-BD":2117,"PA-ARAB-PK":2118,"MN-MONG-CN":2128,"SD-ARAB-PK":2137,"IU-LATN-CA":2141,"TZM-LATN-DZ":2143,"KS-DEVA":2144,"NE-IN":2145,"QUZ-EC":2155,"TI-ER":2163,"AR-EG":3073,"ZH-HK":3076,"DE-AT":3079,"EN-AU":3081,"ES-419":22538},!1),e.initLanguagesFromDictionary({"ES-ES":3082,"FR-CA":3084,"SR-CYRL-CS":3098,"SE-FI":3131,"QUZ-PE":3179,"AR-LY":4097,"ZH-SG":4100,"DE-LU":4103,"EN-CA":4105,"ES-GT":4106,"FR-CH":4108,"HR-BA":4122,"SMJ-NO":4155,"AR-DZ":5121,"ZH-MO":5124,"DE-LI":5127,"EN-NZ":5129,"ES-CR":5130,"FR-LU":5132,"BS-LATN-BA":5146,"SMJ-SE":5179,"AR-MA":6145,"EN-IE":6153,"ES-PA":6154,"FR-MC":6156,"SR-LATN-BA":6170,"SMA-NO":6203,"AR-TN":7169,"EN-ZA":7177,"ES-DO":7178,"FR-WINDIES":7180,"SR-CYRL-BA":7194,"SMA-SE":7227,"AR-OM":8193,"EN-JM":8201,"ES-VE":8202,"FR-RE":8204,"BS-CYRL-BA":8218,"SMS-FI":8251,"AR-YE":9217,"EN-029":9225,"ES-CO":9226,"FR-CD":9228,"SR-LATN-RS":9242,"SMN-FI":9275,"AR-SY":10241,"EN-BZ":10249,"ES-PE":10250,"FR-SN":10252,"SR-CYRL-RS":10266,"AR-JO":11265,"EN-TT":11273,"ES-AR":11274,"FR-CM":11276,"SR-LATN-ME":11290,"AR-LB":12289,"EN-ZW":12297,"ES-EC":12298,"FR-CI":12300,"SR-CYRL-ME":12314,"AR-KW":13313,"EN-PH":13321,"ES-CL":13322,"FR-ML":13324,"AR-AE":14337,"EN-ID":14345,"ES-UY":14346,"FR-MA":14348,"AR-BH":15361,"EN-HK":15369,"ES-PY":15370,"FR-HT":15372,"AR-QA":16385,"EN-IN":16393,"ES-BO":16394,"EN-MY":17417,"ES-SV":17418,"EN-SG":18441,"ES-HN":18442,"ES-NI":19466,"ES-PR":20490,"ES-US":21514},!1),e.initLanguagesFromDictionary({AR:1,BG:2,CA:3,"ZH-CHS":4,CS:5,DA:6,DE:7,EL:8,EN:9,ES:10,FI:11,FR:12,HE:13,HU:14,IS:15,IT:16,JA:17,KO:18,NL:19,NO:20,PL:21,PT:22,RO:24,RU:25,HR:26,SK:27,SQ:28,SV:29,TH:30,TR:31,UR:32,ID:33,UK:34,BE:35,SL:36,ET:37,LV:38,LT:39,FA:41,VI:42,HY:43,AZ:44,EU:45,MK:47,ST:48,TS:49,VE:51,AF:54,KA:55,FO:56,HI:57,GD:60,YI:61,MS:62,KK:63,KY:64,SW:65,UZ:67,TT:68,PA:70,GU:71,TA:73,TE:74,KN:75,MR:78,SA:79,MN:80,MY:85,GL:86,KOK:87,MNI:88,SD:89,SYR:90,CHR:92,TZM:95,KS:96,NE:97,DV:101,BIN:102,FF:103,IBB:105,KR:113,OM:114,TI:115,GN:116,HAW:117,LA:118,SO:119,PAP:121,"X-NONE":127,"ZH-CHT":31748,SR:31770},!0)},e.initLanguagesFromDictionary=function(t,n){for(var i in t){var r={key:i,value:t[i]},o=r.key,a=r.value,s=new e(o,a,n);Array.add(e._allCultures,s),e._lcidMap[a]=s,e._localnameMap[o.toUpperCase()]=s}},e.get_l_LanguageNames=function(){return e._languageNames||(e._languageNames=[],e._languageNames[1025]=CommonStrings.arabic_Saudi_Arabia,e._languageNames[1026]=CommonStrings.bulgarian,e._languageNames[1027]=CommonStrings.catalan,e._languageNames[1028]=CommonStrings.chinese_Taiwan,e._languageNames[1029]=CommonStrings.czech,e._languageNames[1030]=CommonStrings.danish,e._languageNames[1031]=CommonStrings.german_Germany,e._languageNames[1032]=CommonStrings.greek,e._languageNames[1033]=CommonStrings.english_US,e._languageNames[1034]=CommonStrings.spanish_Spain_Traditional_Sort,e._languageNames[1035]=CommonStrings.finnish,e._languageNames[1036]=CommonStrings.french_France,e._languageNames[1037]=CommonStrings.hebrew,e._languageNames[1038]=CommonStrings.hungarian,e._languageNames[1039]=CommonStrings.icelandic,e._languageNames[1040]=CommonStrings.italian_Italy,e._languageNames[1041]=CommonStrings.japanese,e._languageNames[1042]=CommonStrings.korean,e._languageNames[1043]=CommonStrings.dutch_Netherlands,e._languageNames[1044]=CommonStrings.norwegian_Bokmal,e._languageNames[1045]=CommonStrings.polish,e._languageNames[1046]=CommonStrings.portuguese_Brazil,e._languageNames[1047]=CommonStrings.romansh,e._languageNames[1048]=CommonStrings.romanian,e._languageNames[1049]=CommonStrings.russian,e._languageNames[1050]=CommonStrings.croatian_Croatia,e._languageNames[1051]=CommonStrings.slovak,e._languageNames[1052]=CommonStrings.albanian,e._languageNames[1053]=CommonStrings.swedish_Sweden,e._languageNames[1054]=CommonStrings.thai,e._languageNames[1055]=CommonStrings.turkish,e._languageNames[1056]=CommonStrings.urdu,e._languageNames[1057]=CommonStrings.indonesian,e._languageNames[1058]=CommonStrings.ukrainian,e._languageNames[1059]=CommonStrings.belarusian,e._languageNames[1060]=CommonStrings.slovenian,e._languageNames[1061]=CommonStrings.estonian,e._languageNames[1062]=CommonStrings.latvian,e._languageNames[1063]=CommonStrings.lithuanian,e._languageNames[1064]=CommonStrings.tajik,e._languageNames[1065]=CommonStrings.persian,e._languageNames[1066]=CommonStrings.vietnamese,e._languageNames[1067]=CommonStrings.armenian,e._languageNames[1068]=CommonStrings.azerbaijani_Latin,e._languageNames[1069]=CommonStrings.basque,e._languageNames[1070]=CommonStrings.upper_Sorbian,e._languageNames[1071]=CommonStrings.macedonian,e._languageNames[1072]=CommonStrings.sesotho_South_Africa,e._languageNames[1073]=CommonStrings.xitsonga,e._languageNames[1074]=CommonStrings.setswana,e._languageNames[1075]=CommonStrings.venda,e._languageNames[1076]=CommonStrings.isiXhosa,e._languageNames[1077]=CommonStrings.isiZulu,e._languageNames[1078]=CommonStrings.afrikaans,e._languageNames[1079]=CommonStrings.georgian,e._languageNames[1080]=CommonStrings.faroese,e._languageNames[1081]=CommonStrings.hindi,e._languageNames[1082]=CommonStrings.maltese,e._languageNames[1083]=CommonStrings.sami_Northern_Norway,e._languageNames[1085]=CommonStrings.yiddish,e._languageNames[1086]=CommonStrings.malay_Malaysia,e._languageNames[1087]=CommonStrings.kazakh,e._languageNames[1088]=CommonStrings.kyrgyz,e._languageNames[1089]=CommonStrings.swahili,e._languageNames[1090]=CommonStrings.turkmen,e._languageNames[1091]=CommonStrings.uzbek_Latin,e._languageNames[1092]=CommonStrings.tatar,e._languageNames[1093]=CommonStrings.bangla_India,e._languageNames[1094]=CommonStrings.punjabi,e._languageNames[1095]=CommonStrings.gujarati,e._languageNames[1096]=CommonStrings.odia,e._languageNames[1097]=CommonStrings.tamil,e._languageNames[1098]=CommonStrings.telugu,e._languageNames[1099]=CommonStrings.kannada,e._languageNames[1100]=CommonStrings.malayalam,e._languageNames[1101]=CommonStrings.assamese,e._languageNames[1102]=CommonStrings.marathi,e._languageNames[1103]=CommonStrings.sanskrit,e._languageNames[1104]=CommonStrings.mongolian_Cyrillic,e._languageNames[1105]=CommonStrings.tibetan_China,e._languageNames[1106]=CommonStrings.welsh,e._languageNames[1107]=CommonStrings.khmer,e._languageNames[1108]=CommonStrings.lao,e._languageNames[1109]=CommonStrings.burmese,e._languageNames[1110]=CommonStrings.galician,e._languageNames[1111]=CommonStrings.konkani,e._languageNames[1112]=CommonStrings.manipuri,e._languageNames[1113]=CommonStrings.sindhi_Devanagari,e._languageNames[1114]=CommonStrings.syriac,e._languageNames[1115]=CommonStrings.sinhala,e._languageNames[1116]=CommonStrings.cherokee,e._languageNames[1117]=CommonStrings.inuktitut_Syllabics,e._languageNames[1118]=CommonStrings.amharic,e._languageNames[1119]=CommonStrings.tamazight_Arabic_Morocco,e._languageNames[1120]=CommonStrings.kashmiri_Arabic,e._languageNames[1121]=CommonStrings.nepali,e._languageNames[1122]=CommonStrings.frisian,e._languageNames[1123]=CommonStrings.pashto,e._languageNames[1124]=CommonStrings.filipino,e._languageNames[1125]=CommonStrings.divehi,e._languageNames[1126]=CommonStrings.edo,e._languageNames[1127]=CommonStrings.fulfulde,e._languageNames[1128]=CommonStrings.hausa,e._languageNames[1129]=CommonStrings.ibibio_Nigeria,e._languageNames[1130]=CommonStrings.yoruba,e._languageNames[1131]=CommonStrings.quechua_Bolivia,e._languageNames[1132]=CommonStrings.sesotho_sa_Leboa,e._languageNames[1133]=CommonStrings.bashkir,e._languageNames[1134]=CommonStrings.luxembourgish,e._languageNames[1135]=CommonStrings.greenlandic,e._languageNames[1136]=CommonStrings.igbo,e._languageNames[1137]=CommonStrings.kanuri,e._languageNames[1138]=CommonStrings.oromo,e._languageNames[1139]=CommonStrings.tigrigna_Ethiopia,e._languageNames[1140]=CommonStrings.guarani,e._languageNames[1141]=CommonStrings.hawaiian,e._languageNames[1142]=CommonStrings.latin,e._languageNames[1143]=CommonStrings.somali,e._languageNames[1144]=CommonStrings.yi_China,e._languageNames[1145]=CommonStrings.papiamentu,e._languageNames[1146]=CommonStrings.mapudungun,e._languageNames[1148]=CommonStrings.mohawk,e._languageNames[1150]=CommonStrings.breton,e._languageNames[1152]=CommonStrings.uyghur_China,e._languageNames[1153]=CommonStrings.maori,e._languageNames[1154]=CommonStrings.occitan,e._languageNames[1155]=CommonStrings.corsican,e._languageNames[1156]=CommonStrings.alsatian,e._languageNames[1157]=CommonStrings.sakha,e._languageNames[1158]=CommonStrings.kiche,e._languageNames[1159]=CommonStrings.kinyarwanda,e._languageNames[1160]=CommonStrings.wolof,e._languageNames[1164]=CommonStrings.dari_Afghanistan,e._languageNames[1169]=CommonStrings.scottish_Gaelic_United_Kingdom,e._languageNames[1170]=CommonStrings.central_Kurdish_Iraq,e._languageNames[2049]=CommonStrings.arabic_Iraq,e._languageNames[2051]=CommonStrings.valencian,e._languageNames[2052]=CommonStrings.chinese_China,e._languageNames[2055]=CommonStrings.german_Switzerland,e._languageNames[2057]=CommonStrings.english_UK,e._languageNames[2058]=CommonStrings.spanish_Mexico,e._languageNames[2060]=CommonStrings.french_Belgium,e._languageNames[2064]=CommonStrings.italian_Switzerland,e._languageNames[2067]=CommonStrings.dutch_Belgium,e._languageNames[2068]=CommonStrings.norwegian_Nynorsk,e._languageNames[2070]=CommonStrings.portuguese_Portugal,e._languageNames[2072]=CommonStrings.romanian_Moldova,e._languageNames[2073]=CommonStrings.russian_Moldova,e._languageNames[2074]=CommonStrings.serbian_Latin_Serbia_and_Montenegro_Former,e._languageNames[2077]=CommonStrings.swedish_Finland,e._languageNames[2092]=CommonStrings.azerbaijani_Cyrillic,e._languageNames[2094]=CommonStrings.lower_Sorbian,e._languageNames[2107]=CommonStrings.sami_Northern_Sweden,e._languageNames[2108]=CommonStrings.irish_Ireland,e._languageNames[2110]=CommonStrings.malay_Brunei_Darussalam,e._languageNames[2115]=CommonStrings.uzbek_Cyrillic,e._languageNames[2117]=CommonStrings.bangla_Bangladesh,e._languageNames[2118]=CommonStrings.punjabi_Pakistan,e._languageNames[2128]=CommonStrings.mongolian_Traditional_Mongolian_China,e._languageNames[2137]=CommonStrings.sindhi_Arabic,e._languageNames[2141]=CommonStrings.inuktitut_Latin,e._languageNames[2143]=CommonStrings.tamazight_Latin_Algeria,e._languageNames[2144]=CommonStrings.kashmiri,e._languageNames[2145]=CommonStrings.nepali_India,e._languageNames[2155]=CommonStrings.quechua_Ecuador,e._languageNames[2163]=CommonStrings.tigrigna_Eritrea,e._languageNames[3073]=CommonStrings.arabic_Egypt,e._languageNames[3076]=CommonStrings.chinese_Hong_Kong_SAR,e._languageNames[3079]=CommonStrings.german_Austria,e._languageNames[3081]=CommonStrings.english_Australia,e._languageNames[3082]=CommonStrings.spanish_International_Sort,e._languageNames[3084]=CommonStrings.french_Canada,e._languageNames[3098]=CommonStrings.serbian_Cyrillic_Serbia_and_Montenegro_Former,e._languageNames[3131]=CommonStrings.sami_Northern_Finland,e._languageNames[3179]=CommonStrings.quechua_Peru,e._languageNames[4097]=CommonStrings.arabic_Libya,e._languageNames[4100]=CommonStrings.chinese_Singapore,e._languageNames[4103]=CommonStrings.german_Luxembourg,e._languageNames[4105]=CommonStrings.english_Canada,e._languageNames[4106]=CommonStrings.spanish_Guatemala,e._languageNames[4108]=CommonStrings.french_Switzerland,e._languageNames[4122]=CommonStrings.croatian_Bosnia_and_Herzegovina,e._languageNames[4155]=CommonStrings.sami_Lule_Norway,e._languageNames[5121]=CommonStrings.arabic_Algeria,e._languageNames[5124]=CommonStrings.chinese_Macao_SAR,e._languageNames[5127]=CommonStrings.german_Liechtenstein,e._languageNames[5129]=CommonStrings.english_New_Zealand,e._languageNames[5130]=CommonStrings.spanish_Costa_Rica,e._languageNames[5132]=CommonStrings.french_Luxembourg,e._languageNames[5146]=CommonStrings.bosnian_Latin,e._languageNames[5179]=CommonStrings.sami_Lule_Sweden,e._languageNames[6145]=CommonStrings.arabic_Morocco,e._languageNames[6153]=CommonStrings.english_Ireland,e._languageNames[6154]=CommonStrings.spanish_Panama,e._languageNames[6156]=CommonStrings.french_Monaco,e._languageNames[6170]=CommonStrings.serbian_Latin_Bosnia_and_Herzegovina,e._languageNames[6203]=CommonStrings.sami_Southern_Norway,e._languageNames[7169]=CommonStrings.arabic_Tunisia,e._languageNames[7177]=CommonStrings.english_South_Africa,e._languageNames[7178]=CommonStrings.spanish_Dominican_Republic,e._languageNames[7180]=CommonStrings.french_West_Indies,e._languageNames[7194]=CommonStrings.serbian_Cyrillic_Bosnia_and_Herzegovina,e._languageNames[7227]=CommonStrings.sami_Southern_Sweden,e._languageNames[8193]=CommonStrings.arabic_Oman,e._languageNames[8201]=CommonStrings.english_Jamaica,e._languageNames[8202]=CommonStrings.spanish_Venezuela,e._languageNames[8204]=CommonStrings.french_Reunion,e._languageNames[8218]=CommonStrings.bosnian_Cyrillic,e._languageNames[8251]=CommonStrings.sami_Skolt_Finland,e._languageNames[9217]=CommonStrings.arabic_Yemen,e._languageNames[9225]=CommonStrings.english_Caribbean,e._languageNames[9226]=CommonStrings.spanish_Colombia,e._languageNames[9228]=CommonStrings.french_Congo_DRC,e._languageNames[9242]=CommonStrings.serbian_Latin_Serbia,e._languageNames[9275]=CommonStrings.sami_Inari_Finland,e._languageNames[10241]=CommonStrings.arabic_Syria,e._languageNames[10249]=CommonStrings.english_Belize,e._languageNames[10250]=CommonStrings.spanish_Peru,e._languageNames[10252]=CommonStrings.french_Senegal,e._languageNames[10266]=CommonStrings.serbian_Cyrillic_Serbia,e._languageNames[11265]=CommonStrings.arabic_Jordan,e._languageNames[11273]=CommonStrings.english_Trinidad_and_Tobago,e._languageNames[11274]=CommonStrings.spanish_Argentina,e._languageNames[11276]=CommonStrings.french_Cameroon,e._languageNames[11290]=CommonStrings.serbian_Latin_Montenegro,e._languageNames[12289]=CommonStrings.arabic_Lebanon,e._languageNames[12297]=CommonStrings.english_Zimbabwe,e._languageNames[12298]=CommonStrings.spanish_Ecuador,e._languageNames[12300]=CommonStrings.french_Cote_dIvoire,e._languageNames[12314]=CommonStrings.serbian_Cyrillic_Montenegro,e._languageNames[13313]=CommonStrings.arabic_Kuwait,e._languageNames[13321]=CommonStrings.english_Philippines,e._languageNames[13322]=CommonStrings.spanish_Chile,e._languageNames[13324]=CommonStrings.french_Mali,e._languageNames[14337]=CommonStrings.arabic_UAE,e._languageNames[14345]=CommonStrings.english_Indonesia,e._languageNames[14346]=CommonStrings.spanish_Uruguay,e._languageNames[14348]=CommonStrings.french_Morocco,e._languageNames[15361]=CommonStrings.arabic_Bahrain,e._languageNames[15369]=CommonStrings.english_Hong_Kong_SAR,e._languageNames[15370]=CommonStrings.spanish_Paraguay,e._languageNames[15372]=CommonStrings.french_Haiti,e._languageNames[16385]=CommonStrings.arabic_Qatar,e._languageNames[16393]=CommonStrings.english_India,e._languageNames[16394]=CommonStrings.spanish_Bolivia,e._languageNames[17417]=CommonStrings.english_Malaysia,e._languageNames[17418]=CommonStrings.spanish_El_Salvador,e._languageNames[18441]=CommonStrings.english_Singapore,e._languageNames[18442]=CommonStrings.spanish_Honduras,e._languageNames[19466]=CommonStrings.spanish_Nicaragua,e._languageNames[20490]=CommonStrings.spanish_Puerto_Rico,e._languageNames[21514]=CommonStrings.spanish_United_States,e._languageNames[22538]=CommonStrings.spanish_Latin_America,e._languageNames[31748]=CommonStrings.chinese_Traditional,e._languageNames[31770]=CommonStrings.serbian,e._languageNames[1]=CommonStrings.arabic,e._languageNames[2]=CommonStrings.bulgarian,e._languageNames[3]=CommonStrings.catalan,e._languageNames[4]=CommonStrings.chinese_Simplified,e._languageNames[5]=CommonStrings.czech,e._languageNames[6]=CommonStrings.danish,e._languageNames[7]=CommonStrings.german,e._languageNames[8]=CommonStrings.greek,e._languageNames[9]=CommonStrings.english,e._languageNames[10]=CommonStrings.spanish,e._languageNames[11]=CommonStrings.finnish,e._languageNames[12]=CommonStrings.french,e._languageNames[13]=CommonStrings.hebrew,e._languageNames[14]=CommonStrings.hungarian,e._languageNames[15]=CommonStrings.icelandic,e._languageNames[16]=CommonStrings.italian,e._languageNames[17]=CommonStrings.japanese,e._languageNames[18]=CommonStrings.korean,e._languageNames[19]=CommonStrings.dutch,e._languageNames[20]=CommonStrings.norwegian,e._languageNames[21]=CommonStrings.polish,e._languageNames[22]=CommonStrings.portuguese,e._languageNames[24]=CommonStrings.romanian,e._languageNames[25]=CommonStrings.russian,e._languageNames[26]=CommonStrings.croatian,e._languageNames[27]=CommonStrings.slovak,e._languageNames[28]=CommonStrings.albanian,e._languageNames[29]=CommonStrings.swedish,e._languageNames[30]=CommonStrings.thai,e._languageNames[31]=CommonStrings.turkish,e._languageNames[32]=CommonStrings.urdu,e._languageNames[33]=CommonStrings.indonesian,e._languageNames[34]=CommonStrings.ukrainian,e._languageNames[35]=CommonStrings.belarusian,e._languageNames[36]=CommonStrings.slovenian,e._languageNames[37]=CommonStrings.estonian,e._languageNames[38]=CommonStrings.latvian,e._languageNames[39]=CommonStrings.lithuanian,e._languageNames[41]=CommonStrings.persian,e._languageNames[42]=CommonStrings.vietnamese,e._languageNames[43]=CommonStrings.armenian,e._languageNames[44]=CommonStrings.azerbaijani,e._languageNames[45]=CommonStrings.basque,e._languageNames[47]=CommonStrings.macedonian,e._languageNames[48]=CommonStrings.sesotho_sa_Leboa,e._languageNames[49]=CommonStrings.xitsonga,e._languageNames[51]=CommonStrings.venda,e._languageNames[54]=CommonStrings.afrikaans,e._languageNames[55]=CommonStrings.georgian,e._languageNames[56]=CommonStrings.faroese,e._languageNames[57]=CommonStrings.hindi,e._languageNames[60]=CommonStrings.irish,e._languageNames[61]=CommonStrings.yiddish,e._languageNames[62]=CommonStrings.malay,e._languageNames[63]=CommonStrings.kazakh,e._languageNames[64]=CommonStrings.kyrgyz,e._languageNames[65]=CommonStrings.kiswahili,e._languageNames[67]=CommonStrings.uzbek,e._languageNames[68]=CommonStrings.tatar,e._languageNames[70]=CommonStrings.punjabi,e._languageNames[71]=CommonStrings.gujarati,e._languageNames[73]=CommonStrings.tamil,e._languageNames[74]=CommonStrings.telugu,e._languageNames[75]=CommonStrings.kannada,e._languageNames[78]=CommonStrings.marathi,e._languageNames[79]=CommonStrings.sanskrit,e._languageNames[80]=CommonStrings.mongolian,e._languageNames[85]=CommonStrings.burmese,e._languageNames[86]=CommonStrings.galician,e._languageNames[87]=CommonStrings.konkani,e._languageNames[88]=CommonStrings.manipuri,e._languageNames[89]=CommonStrings.sindhi,e._languageNames[90]=CommonStrings.syriac,e._languageNames[92]=CommonStrings.cherokee,e._languageNames[95]=CommonStrings.tamazight,e._languageNames[96]=CommonStrings.kashmiri,e._languageNames[97]=CommonStrings.nepali,e._languageNames[101]=CommonStrings.divehi,e._languageNames[102]=CommonStrings.edo,e._languageNames[103]=CommonStrings.fulfulde,e._languageNames[105]=CommonStrings.ibibio,e._languageNames[113]=CommonStrings.kanuri,e._languageNames[114]=CommonStrings.oromo,e._languageNames[115]=CommonStrings.tigrigna,e._languageNames[116]=CommonStrings.guarani,e._languageNames[117]=CommonStrings.hawaiian,e._languageNames[118]=CommonStrings.latin,e._languageNames[119]=CommonStrings.somali,e._languageNames[121]=CommonStrings.papiamentu,e._languageNames[127]=CommonStrings.invariant_Language),e._languageNames},e.get_l_DevanagariScriptVowelUnicode=function(){return e._devanagariScriptVowelUnicode||(e._devanagariScriptVowelUnicode={},e._devanagariScriptVowelUnicode["%u094B"]=1,e._devanagariScriptVowelUnicode["%u0940"]=2,e._devanagariScriptVowelUnicode["%u0941"]=3,e._devanagariScriptVowelUnicode["%u0942"]=4,e._devanagariScriptVowelUnicode["%u0952"]=5,e._devanagariScriptVowelUnicode["%u0962"]=6,e._devanagariScriptVowelUnicode["%u0943"]=7,e._devanagariScriptVowelUnicode["%u0953"]=8,e._devanagariScriptVowelUnicode["%u0963"]=9,e._devanagariScriptVowelUnicode["%u0945"]=10,e._devanagariScriptVowelUnicode["%u0955"]=11,e._devanagariScriptVowelUnicode["%u0946"]=12,e._devanagariScriptVowelUnicode["%u0956"]=13,e._devanagariScriptVowelUnicode["%u0947"]=14,e._devanagariScriptVowelUnicode["%u0957"]=15,e._devanagariScriptVowelUnicode["%u0948"]=16,e._devanagariScriptVowelUnicode["%u0949"]=17,e._devanagariScriptVowelUnicode["%u093A"]=18,e._devanagariScriptVowelUnicode["%u094A"]=19,e._devanagariScriptVowelUnicode["%u093B"]=20,e._devanagariScriptVowelUnicode["%u094C"]=21,e._devanagariScriptVowelUnicode["%u093C"]=22,e._devanagariScriptVowelUnicode["%u094D"]=23,e._devanagariScriptVowelUnicode["%u093E"]=24,e._devanagariScriptVowelUnicode["%u094E"]=25,e._devanagariScriptVowelUnicode["%u093F"]=26,e._devanagariScriptVowelUnicode["%u094F"]=27,e._devanagariScriptVowelUnicode["%u0971"]=28,e._devanagariScriptVowelUnicode["%u0902"]=29,e._devanagariScriptVowelUnicode["%u0900"]=30,e._devanagariScriptVowelUnicode["%u0901"]=31,e._devanagariScriptVowelUnicode["%u0903"]=32),e._devanagariScriptVowelUnicode},e.get_invariantCulture=function(){return e.getCultureInfo(127)},e.getCultures=function(t){e._allCultures||e.initLanguages();for(var n=[],i=!t||2===t,r=!t||1===t,o=0;o<e._allCultures.length;o++){var a=e._allCultures[o];a.get_isNeutralCulture()?i&&Array.add(n,a):r&&Array.add(n,a)}return n},e.getCultureInfo=function(t){if(e._allCultures||e.initLanguages(),"number"==typeof t){var n=t;return e._lcidMap[n]}return e._localnameMap[t.toUpperCase()]},e._allCultures=null,e._lcidMap=null,e._localnameMap=null,e._languageNames=null,e._devanagariScriptVowelUnicode=null,e._languageIdMapping=null,e}();(0,r.l)(o,"CultureInfo",null,[])},function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var i=(0,n(208).y)("IResizableContainer")},,,function(e,t,n){"use strict";n.r(t),n.d(t,{MenuLauncher:function(){return p}});var i=n(508),r=n(208),o=n(951),a=n(134),s=n(861),l=n(899),u=n(209),c=n(513),p=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i)||this;return o._isContextMenuDropDown=!1,o.sendFocusToMenuDrop=!1,o.onMenuLaunchCallback=null,o.onMenuCloseCallback=null,o.menuLaunched=!1,o._menu=null,o._elmHadFocus=null,o._cachedMenuVersions=null,o.set_menu(r),o.menuLaunched=!1,o.set_sendFocusToMenuDrop(!0),o}return(0,i.t)(t,e),t.prototype.get_sendFocusToMenuDrop=function(){return this.sendFocusToMenuDrop},t.prototype.set_sendFocusToMenuDrop=function(e){return this.sendFocusToMenuDrop=e,e},t.prototype.get_needsAKeytip=function(){return!0},t.prototype.get_menuLauncherBehavior=function(){return this.behavior},t.prototype.get_isFloatieContextMenuDropDown=function(){return this._isContextMenuDropDown},t.prototype.set_isFloatieContextMenuDropDown=function(e){return this._isContextMenuDropDown=e,c.x(this.get_menu())||(this.get_menu().isFloatieContextMenuDropDown=e),e},t.prototype.get_menu=function(){return this._menu},t.prototype.set_menu=function(e){return this._menu=e,c.x(this._menu)||(this._menu.isFloatieContextMenuDropDown=this.get_isFloatieContextMenuDropDown()),e},t.prototype.get_launcherComponent=function(){return this.get_displayedComponent()},t.prototype.get_launcher=function(){return r.r(l.l,this.get_launcherComponent())?this.get_launcherComponent().get_elementInternal():this.getDisplayedComponentElement()},t.prototype.get_menuDirection=function(){return 2},t.prototype.get_additionalMenuCssClass=function(){return""},t.prototype.get_elmHadFocus=function(){return this._elmHadFocus},t.prototype.set_elmHadFocus=function(e){return this._elmHadFocus=e,e},t.prototype.launchMenu=function(e){this.get_menuLauncherBehavior()&&this.get_menuLauncherBehavior().launchMenu(e)},t.prototype.setInitialAriaMenuLauncherAttributes=function(e){a.t.setAriaAttribute(e,a.t.ariaHasPopupAttribute,a.t.ariaTrueValue),this.updateAriaMenuLauncherAttributes(e,!1)},t.prototype.updateAriaMenuLauncherAttributes=function(e,t){a.t.setAriaAttribute(e,a.t.ariaExpandedAttribute,t?a.t.ariaTrueValue:a.t.ariaFalseValue)},t.prototype.selectDropdownItem=function(e){},t.prototype.sendNotifyAsyncMenuTrigger=function(){this.get_menuLauncherBehavior()&&this.get_menuLauncherBehavior().sendNotifyAsyncMenuTrigger()},t.prototype.onKeyDown=function(e){return!!this.get_menuLauncherBehavior()&&this.get_menuLauncherBehavior().onKeyDown(e)},t.prototype.onPointerDown=function(e){return!!this.get_menuLauncherBehavior()&&this.get_menuLauncherBehavior().onPointerDown(e)},t.prototype.getLauncherBounds=function(){return this.get_menuLauncherBehavior()?this.get_menuLauncherBehavior().getLauncherBounds():new Sys.UI.Bounds(0,0,0,0)},t.prototype.closeMenu=function(e){void 0===e&&(e=!0),u.f.get_instance().get_ribbon()&&u.f.get_instance().get_ribbon().get_inKeytipMode()&&this.onMenuCloseCallback&&this.onMenuCloseCallback(e),this.get_menuLauncherBehavior()&&this.get_menuLauncherBehavior().closeMenu()},t.prototype.ensureBehaviorAttachedIfAvailable=function(){e.prototype.ensureBehaviorAttachedIfAvailable.call(this),this.get_menu()&&this.get_menu().ensureBehaviorAttached()},t.prototype.notifyCommandExecuted=function(e,t){},t.prototype.refreshMenuCallback=function(){this.refreshMenu()},t.prototype.refreshMenu=function(){this.get_menuLauncherBehavior()&&this.get_menuLauncherBehavior().refreshMenu()},t.prototype.ensureCorrectChildType=function(e){if(!r.r(s.Menu,e))throw Error.create("This Component can only have Menu Components as children.")},t.prototype.getCommandPopulateProperties=function(){var e={};return e.MenuId=this.get_id(),e},t.prototype.pollForDynamicMenu=function(e){return this.get_menuLauncherBehavior()?this.get_menuLauncherBehavior().pollForDynamicMenu(e):null},t.prototype.populateMenuFromXml=function(e,t){return void 0===t&&(t=!1),!!this.get_menuLauncherBehavior()&&this.get_menuLauncherBehavior().populateMenuFromXml(e,t)},t.prototype.get_properties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.get_cachedMenuVersions=function(){return c.x(this._cachedMenuVersions)&&(this._cachedMenuVersions={}),this._cachedMenuVersions},t.prototype.get_focusableElement=function(){return this.getDisplayedComponentElement()},t.prototype.cloneMenu=function(e){var t=null;return this.get_menu()&&n(619).Builder.shouldBuildMenu(this.get_properties(),this.get_menu().get_children().toArray())&&(t=this.get_menu().clone(e)),t},t.prototype.constructClonedMenuLauncherForMenu=function(e,t,n){return this.constructClonedMenuLauncher(e,t,n)},t.prototype.constructClonedControl=function(e,t){var n=this.cloneMenu(e);return this.constructClonedMenuLauncher(e,t,n)},t.prototype.constructClonedControlForMenu=function(e,t){var n=this.cloneMenu(e);return this.constructClonedMenuLauncherForMenu(e,t,n)},t.prototype.dispose=function(){if(e.prototype.dispose.call(this),c.x(this.get_menu())||this.get_menu().dispose(),!c.x(this._cachedMenuVersions)){var t=this._cachedMenuVersions;for(var n in t){({key:n,value:t[n]}).value.dispose()}}this.set_menu(null)},t.menuDroppedClassName="cui-fa-dropped",t}(o.Control);(0,r.l)(p,"MenuLauncher",o.Control,[])},,,function(e,t,n){"use strict";n.d(t,{d:function(){return r}});var i=n(208),r=function(){function e(){}return e.application=1,e}();(0,i.l)(r,"ContextIds",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,{IgnoreTaskManagerRunningScope:function(){return o}});var i=n(306),r=n(208),o=function(){function e(){i.EventHandlerManager.get_instance().startIgnoringTaskManagerRunning()}return e.prototype.dispose=function(){i.EventHandlerManager.get_instance().stopIgnoringTaskManagerRunning()},e}();(0,r.l)(o,"IgnoreTaskManagerRunningScope",null,[Sys.IDisposable])},,,function(e,t,n){"use strict";n.d(t,{y:function(){return r}});var i=n(208),r=function(){function e(){}return e.fromPropertyDefinition=function(e){return e.type},e.definePropertyType=function(e,t){return e|t<<16},e.getStorageType=function(e){return e>>>16},e.isStringType=function(t){return t===e.string||t===e.byteArray},e.isSimpleType=function(t){return t===e.uInt_8||t===e.uInt_16||t===e.uInt_32||t===e.int_8||t===e.int_16||t===e.int_32||t===e.float_32||t===e.float_64||t===e.oneByte||t===e.twoBytes||t===e.fourBytes||t===e.eightBytes||t===e.guid||t===e.objectId||t===e.objectSpaceId||t===e.contextId||t===e.extendedGuid},e.isDateTimeType=function(t){return t===e.dateTime_32||t===e.dateTime_64},e.isBoolType=function(t){return t===e.bool},e.isArrayOfPrimitiveType=function(t){return t===e.arrayOfUInt_16s||t===e.arrayOfUInt_32s||t===e.arrayOfFloat_32s},e.isArrayOfObjectSpaceType=function(t){return t===e.arrayOfObjectIds||t===e.arrayOfObjectSpaceIds||t===e.arrayOfContextIds},e.isArrayOfBools=function(t){return t===e.arrayOfBools},e.isArrayOfPropertySets=function(t){return t===e.arrayOfPropertySets},e.isArrayOfPropertyValues=function(t){return t===e.arrayOfPropertyValues},e.isArrayOfStrings=function(t){return t===e.arrayOfStrings},e.isArrayOfGuids=function(t){return t===e.arrayOfGuids},e.isArrayOfExtendedGuids=function(t){return t===e.arrayOfExtendedGuids},e.isArrayOfDateTimes=function(t){return t===e.arrayOfDateTime_64s},e.isPropertySetType=function(t){return t===e.propertySet},e.isNullAllowedForPropertyType=function(t){return!(e.isSimpleType(t)||e.isDateTimeType(t)||e.isArrayOfPrimitiveType(t)||e.isArrayOfObjectSpaceType(t)||e.isArrayOfBools(t)||e.isArrayOfPropertyValues(t))},e.nil=e.definePropertyType(0,0),e.noData=e.definePropertyType(1,1),e.bool=e.definePropertyType(2,2),e.oneByte=e.definePropertyType(3,3),e.twoBytes=e.definePropertyType(4,4),e.fourBytes=e.definePropertyType(5,5),e.eightBytes=e.definePropertyType(6,6),e.byteArray=e.definePropertyType(7,7),e.objectId=e.definePropertyType(8,8),e.arrayOfObjectIds=e.definePropertyType(9,9),e.objectSpaceId=e.definePropertyType(10,10),e.arrayOfObjectSpaceIds=e.definePropertyType(11,11),e.contextId=e.definePropertyType(12,12),e.arrayOfContextIds=e.definePropertyType(13,13),e.reserved14=e.definePropertyType(14,14),e.reserved15=e.definePropertyType(15,15),e.arrayOfPropertyValues=e.definePropertyType(16,16),e.propertySet=e.definePropertyType(17,17),e.iUnknown=e.definePropertyType(18,18),e.iUnknownInPropertySet=e.definePropertyType(19,19),e.reserved20=e.definePropertyType(20,20),e.reserved21=e.definePropertyType(21,21),e.reserved22=e.definePropertyType(22,22),e.reserved23=e.definePropertyType(23,23),e.reserved24=e.definePropertyType(24,24),e.reserved25=e.definePropertyType(25,25),e.reserved26=e.definePropertyType(26,26),e.reserved27=e.definePropertyType(27,27),e.reserved28=e.definePropertyType(28,28),e.reserved29=e.definePropertyType(29,29),e.reserved30=e.definePropertyType(30,30),e.conflict=e.definePropertyType(31,31),e.int_8=e.definePropertyType(32,3),e.int_16=e.definePropertyType(33,4),e.int_32=e.definePropertyType(34,5),e.uInt_8=e.definePropertyType(36,3),e.uInt_16=e.definePropertyType(37,4),e.uInt_32=e.definePropertyType(38,5),e.float_32=e.definePropertyType(40,5),e.float_64=e.definePropertyType(41,6),e.arrayOfUInt_16s=e.definePropertyType(47,7),e.arrayOfUInt_32s=e.definePropertyType(48,7),e.arrayOfFloat_32s=e.definePropertyType(50,7),e.sz=e.definePropertyType(54,7),e.string=e.definePropertyType(58,7),e.wt=e.definePropertyType(59,7),e.arrayOfStrings=e.definePropertyType(61,7),e.arrayOfBools=e.definePropertyType(62,7),e.guid=e.definePropertyType(63,7),e.arrayOfGuids=e.definePropertyType(64,7),e.pointer=e.definePropertyType(65,6),e.dateTime_64=e.definePropertyType(67,6),e.arrayOfDateTime_64s=e.definePropertyType(68,7),e.color=e.definePropertyType(71,5),e.dateTime_32=e.definePropertyType(75,5),e.arrayOfPropertySets=e.definePropertyType(78,7),e.extendedGuid=e.definePropertyType(79,7),e.arrayOfExtendedGuids=e.definePropertyType(80,7),e}();(0,i.l)(r,"PropertyType",null,[])},function(e,t,n){"use strict";n.d(t,{n:function(){return r}});var i=n(208),r=function(){return function(e,t){this.firstPage=0,this.lastPage=0,this.firstPage=e,this.lastPage=t}}();(0,i.l)(r,"PageData",null,[])},,,function(e){var t={}.toString;e.exports=function(e){return t.call(e).slice(8,-1)}},,,function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var i,r=n(208);!function(e){e[e.none=0]="none",e[e.notOnCanceled=1]="notOnCanceled",e[e.notOnFaulted=2]="notOnFaulted",e[e.notOnRanToCompletion=4]="notOnRanToCompletion",e[e.onlyOnCanceled=6]="onlyOnCanceled",e[e.onlyOnFaulted=5]="onlyOnFaulted",e[e.onlyOnRanToCompletion=3]="onlyOnRanToCompletion",e[e.executeSynchronously=8]="executeSynchronously"}(i||(i={})),(0,r.h)("TaskContinuationOptions",i)},function(e,t,n){var i=n(950);e.exports=!i((function(){return Object.isExtensible(Object.preventExtensions({}))}))},function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var i=function(e,t,n){return t?(t.push(n),t):[n]}},,function(e,t,n){"use strict";n.d(t,{g:function(){return h}});var i=n(508),r=n(160),o=n(951),a=n(134),s=n(268),l=n(659),u=n(802),c=n(513),p=n(946),d=n(208),h=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r._id=null,r._displayMode=null,r.useCheckMark=!1,r.usePseudoCheckMark=!1,r.useUncheckedImage=!1,r.checkMarkImage=null,r.uncheckMarkImage=null,r.checkMarkImageClass=null,r.uncheckMarkImageClass=null,r._id=n,r.initializeCheckMarkProperties(t,i),r.addDisplayModes(),r.get_stateProperties()[u.e.On]=p.n.isTrue(i.IsChecked),r.get_stateProperties()[u.e.Visible]=r.get_visible(),r.get_stateProperties()[u.e.SourceControlId]=n,r.get_stateProperties()[u.e.LabelText]=r.labelText=r.get_properties().LabelText,r}return(0,i.t)(t,e),t.prototype.get_useCheckMark=function(){return this.useCheckMark},t.prototype.get_usePseudoCheckMark=function(){return this.usePseudoCheckMark},t.prototype.get_useUncheckedImage=function(){return this.useUncheckedImage},t.prototype.get_checkMarkImage=function(){return this.checkMarkImage},t.prototype.get_uncheckMarkImage=function(){return this.uncheckMarkImage},t.prototype.get_checkMarkImageClass=function(){return this.checkMarkImageClass},t.prototype.get_uncheckMarkImageClass=function(){return this.uncheckMarkImageClass},t.prototype.createComponentDomForDisplayMode=function(e){return this._displayMode=e,(new l.f).buildControlDom(this,e)},t.prototype.get_controlType=function(){return o.Control.toggleButtonControlType},t.prototype.get_needsAKeytip=function(){return!0},t.prototype.get_ariaRole=function(){return this.inMenu?this.get_useCheckMark()||this.get_usePseudoCheckMark()?a.t.ariaMenuItemCheckBoxRole:a.t.ariaMenuItemRadioRole:this.get_useCheckMark()?a.t.ariaCheckBoxRole:e.prototype.get_ariaRole.call(this)},t.prototype.onStateChanged=function(){this.setState(this.get_stateProperties()[u.e.On])},t.prototype.getTextValue=function(){return this.labelText},t.prototype.setState=function(e){var t=this;this.get_useCheckMark()&&this.get_useUncheckedImage()&&this.setCheckUncheckImageProperties(e),this.get_controlComponentDomCache().forEach((function(n){t.setStateOnElement(n.elmControl,e)}))},t.prototype.initializeCheckMarkProperties=function(e,t){this.useCheckMark=p.n.isTrue(t.UseCheckMark),this.usePseudoCheckMark=p.n.isTrue(t.UsePseudoCheckMark),this.useUncheckedImage=p.n.isTrue(t.UseUncheckedImage),this.get_useUncheckedImage()&&(this.uncheckMarkImage=c.x(t.UncheckedImage)?e.get_properties().ImageUncheckMark:t.UncheckedImage,this.uncheckMarkImageClass=c.x(t.UncheckedImageClass)?e.get_properties().ImageUncheckMarkClass:t.UncheckedImageClass),this.get_useCheckMark()&&(this.checkMarkImage=c.x(t.CheckedImage)?e.get_properties().ImageCheckMark:t.CheckedImage,this.checkMarkImageClass=c.x(t.CheckedImageClass)?e.get_properties().ImageCheckMarkClass:t.CheckedImageClass,t.Image16by16=this.get_checkMarkImage(),t.Image16by16Class=this.get_checkMarkImageClass()),c.x(t.IsChecked)||this.setCheckUncheckImageProperties(p.n.isTrue(t.IsChecked))},t.prototype.setCheckUncheckImageProperties=function(e){this.get_properties().Image16by16=e?this.get_checkMarkImage():this.get_uncheckMarkImage(),this.get_properties().Image16by16Class=e?this.get_checkMarkImageClass():this.get_uncheckMarkImageClass()},t.prototype.setStateOnElement=function(e,t){if(!c.x(e)){var n=void 0;this.get_useCheckMark()?(this.get_useUncheckedImage()||p.n.toggleCSSClassOnElement(e,"cui-ctl-unchkd",!t),n=a.t.ariaCheckedAttribute):(p.n.toggleCSSClassOnElement(e,"cui-ctl-on",t),n=this._displayMode&&s.r.isDisplayModeMenu(this._displayMode)?a.t.ariaCheckedAttribute:a.t.ariaPressedAttribute),a.t.setAriaAttribute(e,n,t?a.t.ariaTrueValue:a.t.ariaFalseValue)}},t.prototype.addDisplayModes=function(){this.addDisplayMode("Small"),this.addDisplayMode("Small14"),this.addDisplayMode("Small24"),this.addDisplayMode("Medium"),this.addDisplayMode("Medium14"),this.addDisplayMode("Medium20"),this.addDisplayMode("Large"),this.addDisplayMode("Large16"),this.addDisplayMode("Large30"),this.addDisplayMode("LargeNoText"),this.addDisplayMode("Menu"),this.addDisplayMode("Menu16"),this.addDisplayMode("Menu20"),this.addDisplayMode("Menu32"),this.addDisplayMode("Menu48"),this.addDisplayMode("MenuTellMe")},t.prototype.get_focusableElement=function(){return this.getDisplayedComponentElement()},t.prototype.get_activatesOnPress=function(){return!this.isStandardMenuItem()},t.prototype.get_properties=function(){return this.get_controlProperties()},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n)},t}(o.Control);(0,d.l)(h,"ToggleButton",o.Control,[r.a])},,function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function r(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}},function(e,t,n){"use strict";n.d(t,{y:function(){return l}});var i=n(508),r=n(861),o=n(254),a=n(400),s=n(208),l=function(e){function t(t,n,i,r,o,a){return e.call(this,t,n,i,r,o,a)||this}return(0,i.t)(t,e),t.prototype.get_cssClass=function(){var n=e.prototype.get_cssClass.call(this)+" "+t.jewelMenuClass;return o.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()&&(n+=" "+t.jewelMenuBackArrowRefreshClass),n},t.prototype.onPointerOut=function(e){return!1},t.prototype.onMenuClosed=function(){a.h(this.get_elementInternal(),o.AFrameworkApplication.get_activeFrame().get_activeModalUIZIndex()),e.prototype.onMenuClosed.call(this)},t.jewelMenuClass="cui-jewelmenu",t.jewelMenuBackArrowRefreshClass="cui-jewelmenu-backarrowrefresh",t}(r.Menu);(0,s.l)(l,"JewelMenu",r.Menu,[])},,,,function(e,t,n){"use strict";n.d(t,{d:function(){return i},t:function(){return r},x:function(){return o}});var i="",r=function(e){return null===e||"undefined"==typeof e||!e.length},o=function(e){return null===e||"undefined"==typeof e}},,function(e,t,n){"use strict";n.r(t);var i=n(845),r=n(596),o=n(255),a=n(208),s=function(){function e(){}return e.get_commercialPrivacyNoticeDialogHtmlTemplate=function(){return e.dialogHtmlFormat},e.dialogHtmlFormat="<div class='PrivacyNoticeDialogContainer' id='PrivacyNoticeContainerId'> <div class='\"\"' id='{0}'> <svg xmlns='http://www.w3.org/2000/svg' class='MsDialogLogo' viewBox='0 0 99 21'><path class='HC c74' d='M34.94384 12.1124l-.59342 1.6608h-.03374a15.86223 15.86223 0 0 0-.56213-1.64266l-3.1758-7.96679h-3.1049V16.83h2.0478V9.0436c0-.48062-.01031-1.0614-.03057-1.72611-.01055-.33629-.04861-.60582-.058-.811h.045c.10406.4772.21219.84074.29036 1.084L33.57659 16.83h1.43266L38.789 7.507a8.2553 8.2553 0 0 0 .2602-1.00052h.04492c-.04934.9227-.09132 1.76588-.097 2.27472V16.83h2.18466V4.16375h-2.98185zM43.23858 7.75293h2.13529v9.07703h-2.13529zM44.32818 3.89545a1.28731 1.28731 0 0 0-.90968.35668 1.17694 1.17694 0 0 0-.38108.89053 1.14511 1.14511 0 0 0 .37691.87288 1.30076 1.30076 0 0 0 .91385.34783 1.31646 1.31646 0 0 0 .91793-.34758 1.13946 1.13946 0 0 0 .38181-.87313 1.19956 1.19956 0 0 0-.37138-.88073 1.27358 1.27358 0 0 0-.92836-.36648zM52.93294 7.66212a5.91561 5.91561 0 0 0-1.19319-.12789 5.26835 5.26835 0 0 0-2.59678.62421 4.20113 4.20113 0 0 0-1.7121 1.761 5.60038 5.60038 0 0 0-.58863 2.60829 4.81649 4.81649 0 0 0 .57156 2.33827 4.01747 4.01747 0 0 0 1.59784 1.61566 4.76026 4.76026 0 0 0 2.33414.56726 5.10923 5.10923 0 0 0 2.57564-.60285l.02823-.01646v-1.95585l-.08958.06553a4.01826 4.01826 0 0 1-1.04469.5437 3.16174 3.16174 0 0 1-1.02312.19835 2.62927 2.62927 0 0 1-1.99855-.7791 3.02828 3.02828 0 0 1-.73738-2.15814 3.14318 3.14318 0 0 1 .7683-2.2158 2.61573 2.61573 0 0 1 2.0025-.82649 3.42846 3.42846 0 0 1 2.03294.70694l.08958.06505V8.01264l-.02871-.01619a3.53811 3.53811 0 0 0-.988-.33433zM59.96821 7.59536a2.18731 2.18731 0 0 0-1.42788.512 2.88955 2.88955 0 0 0-.82155 1.21724h-.0226V7.75293h-2.135V16.83h2.135v-4.64348a3.23654 3.23654 0 0 1 .53217-1.92787 1.63252 1.63252 0 0 1 1.381-.72928 2.51241 2.51241 0 0 1 .64211.09425 1.6279 1.6279 0 0 1 .49781.20129l.08984.0648V7.73722l-.03461-.01472a2.21076 2.21076 0 0 0-.83629-.12714zM65.76756 7.53423a4.73981 4.73981 0 0 0-3.53323 1.30366 4.8866 4.8866 0 0 0-1.27666 3.55874 4.62871 4.62871 0 0 0 1.24622 3.397 4.52193 4.52193 0 0 0 3.34472 1.2553 4.61146 4.61146 0 0 0 3.4635-1.32158 4.87659 4.87659 0 0 0 1.27641-3.5234 4.75509 4.75509 0 0 0-1.19763-3.42251 4.41 4.41 0 0 0-3.32333-1.24721zm1.69763 6.98912a2.16529 2.16529 0 0 1-1.7941.758 2.292 2.292 0 0 1-1.83879-.77224 3.28324 3.28324 0 0 1-.66079-2.18268 3.41139 3.41139 0 0 1 .66079-2.2396 2.25617 2.25617 0 0 1 1.82135-.785 2.2219 2.2219 0 0 1 1.77349.75063 3.34221 3.34221 0 0 1 .64729 2.22145 3.56448 3.56448 0 0 1-.60924 2.24944zM75.02376 11.50364a4.64261 4.64261 0 0 1-1.28156-.66645.93192.93192 0 0 1-.25872-.69907.7783.7783 0 0 1 .32844-.64681 1.47116 1.47116 0 0 1 .91951-.2597A3.75721 3.75721 0 0 1 75.82669 9.4a3.5299 3.5299 0 0 1 .95633.44332l.08836.06015V7.92966l-.03438-.01473a4.71358 4.71358 0 0 0-.97056-.27048 5.95145 5.95145 0 0 0-1.06507-.11022 3.90841 3.90841 0 0 0-2.504.774 2.46926 2.46926 0 0 0-.97524 2.01379 2.80966 2.80966 0 0 0 .21036 1.12521 2.25421 2.25421 0 0 0 .64606.84416 5.62313 5.62313 0 0 0 1.31374.73491 9.79062 9.79062 0 0 1 1.09256.5091 1.51226 1.51226 0 0 1 .48085.395.88377.88377 0 0 1 .13427.5145c0 .61022-.45681.90649-1.39643.90649a3.84033 3.84033 0 0 1-1.18167-.216 4.45107 4.45107 0 0 1-1.21016-.61366l-.08958-.06455v2.0813l.03265.01521a5.36515 5.36515 0 0 0 1.14606.354 6.138 6.138 0 0 0 1.22365.14139 4.15062 4.15062 0 0 0 2.64391-.77812 2.51712 2.51712 0 0 0 .98431-2.06215 2.36906 2.36906 0 0 0-.52948-1.55943 4.53616 4.53616 0 0 0-1.79947-1.14574zM83.09416 7.53423a4.7402 4.7402 0 0 0-3.53323 1.30366 4.88764 4.88764 0 0 0-1.27666 3.55874 4.62784 4.62784 0 0 0 1.24647 3.397 4.52149 4.52149 0 0 0 3.34472 1.2553 4.61122 4.61122 0 0 0 3.46325-1.32158 4.87564 4.87564 0 0 0 1.27666-3.5234 4.75413 4.75413 0 0 0-1.19788-3.42251 4.41 4.41 0 0 0-3.32333-1.24721zm1.69789 6.98912a2.16569 2.16569 0 0 1-1.79411.758 2.29291 2.29291 0 0 1-1.839-.77224 3.28319 3.28319 0 0 1-.66054-2.18268 3.41139 3.41139 0 0 1 .66079-2.2396 2.25548 2.25548 0 0 1 1.82135-.785 2.22224 2.22224 0 0 1 1.77349.75063 3.34221 3.34221 0 0 1 .64729 2.22145 3.56611 3.56611 0 0 1-.60927 2.24944zM99 9.49425V7.75293h-2.16229V5.04546l-.07289.02234-2.031.62176-.04.01229v2.05108H91.49V6.6103a1.811 1.811 0 0 1 .354-1.21038 1.244 1.244 0 0 1 .99-.40526 2.307 2.307 0 0 1 .94012.21428l.07953.03534V3.41019l-.0373-.01327a3.65779 3.65779 0 0 0-1.201-.161 3.52356 3.52356 0 0 0-1.70329.40944 2.91321 2.91321 0 0 0-1.16926 1.15585 3.43992 3.43992 0 0 0-.41409 1.6952v1.25652H87.823v1.74132h1.50569V16.83H91.49V9.49425h3.2038v4.66187c0 1.91953.90551 2.8928 2.69152 2.8928a4.4019 4.4019 0 0 0 .9178-.10187 2.5365 2.5365 0 0 0 .66841-.21207L99 16.71877v-1.75826l-.08787.05866a1.5096 1.5096 0 0 1-.43472.18975 1.66121 1.66121 0 0 1-.42686.07242 1.15891 1.15891 0 0 1-.92023-.33506 1.8056 1.8056 0 0 1-.29261-1.16669V9.49425z'/><path fill='#f05226' d='M0-.06719h10.0444v10.0444H0z'/><path fill='#80bb42' d='M11.09009-.06719h10.04415V9.97698H11.09009z'/><path fill='#339fd9' d='M0 11.02682h10.04415v10.04417H0z'/><path fill='#fdb816' d='M11.09009 11.02682h10.04415v10.04417H11.09009z'/></svg> </div> <div class='PrivacyNoticeDialogInnerContainer' id='PrivacyNoticeInnerContainerId'> <div class='UIFontDialogTitle PrivacyDialogTitle' id='PrivacyDialogTitle'> <div class='WACDialogSectionTitle'>{1}</div> </div> <div class='WACDialogRow' id='ThanksBlock'> <div class='\"\"' id='ThanksTextRow'> <label id='ThanksText' class='WACDialogLabel' >{2}</label> </div> <div class='\"\"' id='AdminInfoRow'> <label id='AdminInfo' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRow' id='LearnMoreLinkRow'> <a id='LearnMoreLinkId' class='LearnMoreLink' href={5} target='_blank' >{4}</a> </div> </div> <div class='WACDialogRow' id='AdjustBlock'> <div class='\"\"' id='AdjustBlockText'> <label id='AdjustText' class='WACDialogLabel' >{6}</label> </div> <div class='\"\"' id='AdjustBlockLink'> <a id='{7}' class='AccountPrivacyLink' href=# target='_self' >{8}</a> </div> </div> <div class='WACDialogRow' id='ServicesAgreementBlock'> <div class='\"\"' id='ServicesAgreementText'> <label id='AgreementText' class='WACDialogLabel' >{9}</label> </div> <div class='\"\"' id='ServicesAgreementLink'> <a id='ServicesAgreementLinkId' class='ServicesAgreementLink' href={11} target='_blank' >{10}</a> </div> </div> </div> </div>",e}();(0,a.l)(s,"CommercialPrivacyNoticeDialogHtml",null,[]);var l=n(550),u=n(882),c=n(92),p=n(134),d=function(){function e(){this.dialog=null,this._callback=null}return e.prototype.initializeAndShowDialog=function(e){n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyNotice_CommercialUsersShown),this.dialog=new c.o,this._callback=e,this.dialog.set_dialogHtml(c.o.formatHtml(s.get_commercialPrivacyNoticeDialogHtmlTemplate(),"MSDialogLogoId",CommonUIStrings.l_PrivacyNoticeDialogTitle,CommonUIStrings.l_PrivacyNoticeDialogMessageText,CommonUIStrings.l_PrivacyNoticeDialogMessageSubText,CommonUIStrings.l_PrivacyDialogLearnMore,"https://go.microsoft.com/fwlink/?linkid=2090814",CommonUIStrings.l_PrivacyNoticeDialogSettingsLocation,"TrustCenterLinkId",CommonUIStrings.l_PrivacyNoticeDialogSettingsLink,CommonUIStrings.l_PrivacyNoticeDialogServicesAgreementText,CommonUIStrings.l_PrivacyNoticeDialogServiesAgreementLink,"https://go.microsoft.com/fwlink/?linkid=2093457")),this.dialog.set_dialogId("CommercialPrivacyNoticeDialog"),this.dialog.set_buttonsOption(0),this.dialog.setButtonText(1,CommonUIStrings.l_Close),this.dialog.initializeAndShow("",a.i(this,this.dialogHandler,"dialogHandler"),null);var t=document.getElementById("TrustCenterLinkId");l.n.addHandler(t,"click",a.i(this,this.onTrustCenterClicked,"onTrustCenterClicked"));var i=document.getElementById("MSDialogLogoId");i&&(i.setAttribute(p.t.ariaRoleAttribute,p.t.ariaImageRole),i.setAttribute("title",CommonUIStrings.l_PrivacySettingsDialogMicrosoftLogoAltText))},e.prototype.onTrustCenterClicked=function(e){n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyNotice_CommercialUsersTrustCenterClicked),this.dialog&&(this.dialog.hide(),this.dialog=null,n(515).PrivacyDialogManager.showCommercialTrustCenterDialog())},e.prototype.dialogHandler=function(e,t){n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyNotice_CommercialUsersDismissed),this.dialog=null,this._callback()},e}();(0,a.l)(d,"CommercialPrivacyNoticeDialog",null,[]);var h=function(){function e(){}return e.get_commercialTrustCenterDialogHtmlTemplate=function(){return e.dialogHtmlFormat},e.dialogHtmlFormat="<div class='TrustCenterDialogOuterContainer' id='PrivacySettingsContainer'> <div class='UIFontDialogTitle PrivacyDialogTitle' id='PrivacyDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='\"\"' id='PrivacyDialogSubTitle'> <label id='PrivacyDialogSubTitle' class='WACDialogLabel' >{1}</label> </div> <br/> <div class='TrustCenterDialogInfoContainer' id='InfoContainer'> <div class='\"\"' id='InfoMessageBlock'> <div class='WACDialogIcon' id='TopInfoIconArea'> <div class='clip24x24' id='TopInfoIconClip' unselectable='on' style='z-index: 0; display: inline-block;' role='img'> <img id='TopIconInfo' title='{4}' class='{3}' role='presentation' src={2} /> </div> </div> <div class='TrustCenterDialogInfoText' id='InfoMessageArea'> <label id='MessageInfo' class='\"\"' >{5}</label> </div> </div> </div> <br/> <div class='TrustCenterDialogExperiencesContainer' id='{6}'> <div class='UIFontDialogTextLarge PrivacyDialogTitle' id='OptionalExperiences'> <label id='OptionalExperiencesTitle' class='WACDialogLabel' >{7}</label> </div> <div class='WACDialogRow' id='OptionalExperiences'> <label id='OptionalExperiencesSubTitle' class='WACDialogLabel' >{8}</label> </div> <div class='WACDialogRow' id='LearnMoreLinkRow'> <a id='LearnMoreLinkId' class='LearnMoreLink' href={10} target='_blank' >{9}</a> </div> <div class='WACDialogCheckBoxDiv' id='EnableExperiencesCheckBox'> <input type='checkbox' id='{11}' class='WACDialogCheckBox' title='{12}'></input> <label id='\"\"' class='WACDialogLabel' for='{11}' >{12}</label> </div> <br/> <div class='{13}' id='CheckboxInfoContainer'> <div class='\"\"' id='CheckboxInfoMessage'> <div class='WACDialogIcon' id='BottomInfoIconArea'> <div class='clip24x24' id='BottomInfoIconClip' unselectable='on' style='z-index: 0; display: inline-block;' role='img'> <img id='BottomIconInfo' title='{4}' class='{3}' role='presentation' src={2} /> </div> </div> <div class='TrustCenterDialogInfoText' id='ExperiencesInfoRow'> <label id='ExperiencesInfo' class='\"\"' >{14}</label> </div> </div> <a id='PrivacyStatementLinkId' class='PrivacyStatementLink' href={16} target='_blank' >{15}</a> </div> <br/> </div>",e}();(0,a.l)(h,"CommercialTrustCenterDialogHtml",null,[]);var g="EnableConnectedExperiencesCheckbox",m=function(){function e(){this.enableConnectedExperiencesCheckbox=null,this._userPrivacySettings=null,this._callback=null}return e.prototype.initializeAndShowDialog=function(t,i,r){n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyTrustCenter_Shown);var o=new c.o;this._callback=r;var s=2!==i.controllerServicesStateRoaming?"TrustCenterDialogInfoContainer":"TrustCenterExperiencesDisabledDialogInfoContainer";this._userPrivacySettings=i,o.set_dialogHtml(c.o.formatHtml(h.get_commercialTrustCenterDialogHtmlTemplate(),CommonUIStrings.l_PrivacySettingsDialogHeader,CommonUIStrings.l_PrivacySettingsDialogSubHeader,n(254).AFrameworkApplication.get_imageClusterPath(),n(973).getImageClass(e.iconName),CommonUIStrings.l_DialogInfo,t?CommonUIStrings.l_PrivacySettingsDialogMessage:CommonUIStrings.l_PrivacySettingsDialogAdminDisabled,"ConnectedExperiencesID",CommonUIStrings.l_PrivacySettingsDialogExperiencesTitle,CommonUIStrings.l_PrivacySettingsDialogExperiencesMessage,CommonUIStrings.l_PrivacyDialogLearnMore,"https://go.microsoft.com/fwlink/?linkid=2090814",g,CommonUIStrings.l_PrivacySettingsDialogCheckboxText,s,CommonUIStrings.l_PrivacySettingsDialogWarning,CommonUIStrings.l_PrivacySettingsDialogMicrosoftPrivacyStatement,"https://go.microsoft.com/fwlink/?linkid=2090462")),o.set_dialogId("CommercialTrustCenterDialog"),o.set_buttonsOption(1);var l={};(l[g]=2!==i.controllerServicesStateRoaming,t?o.initializeAndShow(CommonUIStrings.l_PrivacySettingsDialogTitle,a.i(this,this.dialogHandler_PrivacySettingsAdminEnabled,"dialogHandler_PrivacySettingsAdminEnabled"),l):o.initializeAndShow(CommonUIStrings.l_PrivacySettingsDialogTitle,a.i(this,this.dialogHandler_PrivacySettingsAdminDisabled,"dialogHandler_PrivacySettingsAdminDisabled"),l),this.setUpCheckbox(),t)||(document.getElementById("ConnectedExperiencesID").style.display="none")},e.prototype.setUpCheckbox=function(){this.enableConnectedExperiencesCheckbox=document.getElementById(g),l.n.addHandler(this.enableConnectedExperiencesCheckbox,"click",a.i(this,this.onConnectedExperiencesCheckChanged,"onConnectedExperiencesCheckChanged"))},e.prototype.onConnectedExperiencesCheckChanged=function(e){var t=document.getElementById("CheckboxInfoContainer");this.enableConnectedExperiencesCheckbox&&t&&(this.enableConnectedExperiencesCheckbox.checked?n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyTrustCenter_UserPrivacyOptionCCSChecked):n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyTrustCenter_UserPrivacyOptionCCSUnChecked),t.className=this.enableConnectedExperiencesCheckbox.checked?"TrustCenterDialogInfoContainer":"TrustCenterExperiencesDisabledDialogInfoContainer")},e.prototype.dialogHandler_PrivacySettingsAdminEnabled=function(e,t){if(n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyTrustCenter_Dismissed),1===e&&t){this._userPrivacySettings.controllerServicesStateRoaming=t[g]?1:2;var i=new Date;this._userPrivacySettings.controllerServicesTimeRoaming=i.toISOString(),this._callback(this._userPrivacySettings)}},e.prototype.dialogHandler_PrivacySettingsAdminDisabled=function(e,t){n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyTrustCenter_Dismissed)},e.iconName="Info_24x24x32",e}();(0,a.l)(m,"CommercialTrustCenterDialog",null,[]);var _=n(841),f=function(){function e(){}return e.prototype.initializeAndShowDialog=function(e){e?n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyTrustCenter_RefreshRequiredDialogShownForAnonUser):n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyTrustCenter_RefreshRequiredDialogShownForSignedInUser);var t=new _.StandardDialog;t.set_buttonsOption(4),t.setButtonText(1,CommonUIStrings.l_RefreshRequiredDialogRefreshButton),t.setButtonText(2,CommonUIStrings.l_RefreshRequiredDialogNotNowButton),t.set_dialogId("RefreshRequiredDialog");var i=document.createElement("span");i.id="RefreshRequiredDialogContent";var r=document.createElement("span");if(r.innerText=CommonUIStrings.l_RefreshRequiredDialogText,i.appendChild(r),i.appendChild(document.createElement("br")),i.appendChild(document.createElement("br")),e){var o=document.createElement("span");o.innerText=CommonUIStrings.l_RefreshRequiredDialogAnonymousText,i.appendChild(o),i.appendChild(document.createElement("br")),i.appendChild(document.createElement("br"))}var s=document.createElement("a");s.href="https://go.microsoft.com/fwlink/?linkid=2100681",s.innerText=CommonUIStrings.l_RefreshRequiredDialogLinkText,s.target="_blank",i.appendChild(s),t.messageBox(CommonUIStrings.l_RefreshRequiredDialogTitle,null,0,a.i(this,this.dialogHandler,"dialogHandler"),i)},e.prototype.dialogHandler=function(e,t){n(515).PrivacyDialogManager.recordSessionPrivacyActivity(u.u.privacyTrustCenter_RefreshRequiredDialogDismissed),1===e&&n(254).AFrameworkApplication.get_activeFrame().get_applicationInstance().privacyRefreshRequested()},e}();(0,a.l)(f,"RefreshRequiredDialog",null,[]);var y=n(344),v=n(235);n.d(t,{PrivacyDialogManager:function(){return S}});var S=function(){function e(){}return e.showCommercialPrivacyNoticeDialog=function(t,n){(new d).initializeAndShowDialog((function(){e.saveLocally("1"),t.userPrivacySettingsRoamedNoticeShown=1,t.controllerServicesStateRoaming=1;var i=new Date;t.controllerServicesTimeRoaming=i.toISOString(),e.savePrivateNoticeShown(n,t)}))},e.showPrivacyNoticeBusinessBar=function(t,i){e.recordSessionPrivacyActivity(u.u.privacyNotice_BusinessBarForAnonymousUsersShown),n(254).AFrameworkApplication.get_activeFrame().get_applicationInstance().addGdprBusinessBarWithCloseCallback(CommonUIStrings.l_AnonymousBusBarPrivacyNotice,CommonUIStrings.l_PrivacyDialogLearnMore,"2090814",(function(n){e.recordSessionPrivacyActivity(u.u.privacyNotice_BusinessBarForAnonymousUsersDismissed),e.saveLocally("1"),t.controllerServicesStateRoaming=1,e.savePrivateNoticeShown(i,t)}))},e.showPrivacyNoticeRoamingBusinessBar=function(t,i){e.recordSessionPrivacyActivity(u.u.privacyNotice_SettingsRoamedBusinessBarShown),n(254).AFrameworkApplication.get_activeFrame().get_applicationInstance().addGdprBusinessBarWithCloseCallback(CommonUIStrings.l_RoamedSettingsBusBarPrivacyNotice,"","",(function(t){e.recordSessionPrivacyActivity(u.u.privacyNotice_SettingsRoamedBusinessBarDismissed)})),e.saveLocally("1"),t.userPrivacySettingsRoamedNoticeShown=1,e.savePrivateNoticeShown(i,t)},e.savePrivateNoticeShown=function(t,n){t.saveSettings(n).then((function(t){return t?e.recordSessionPrivacyActivity(u.u.privacyNotice_SaveNoticeShownSucceeded):e.recordSessionPrivacyActivity(u.u.privacyNotice_SaveNoticeShownFailed),null}),(function(t){return e.recordSessionPrivacyActivity(u.u.privacyNotice_SaveNoticeShownFailed),null}))},e.showCommercialTrustCenterDialog=function(){v.w.get_instance().resolveFuture(i.l).execute((function(t){t.getSettings().then((function(n){e.recordUserPrivacySettingsDataSourceForSession(n);var i=new m;return e.tryGetAdminControllerConnectedServicesState(!0).then((function(r){return i.initializeAndShowDialog(r,n,(function(n){o.ULS.sendTraceTag(51258457,306,50,"PrivacyDialogManager.ShowCommercialTrustCenterDialog Callback, userPrivacySettingsModified = {0}",n),t.saveSettings(n).then((function(t){if(t){e.recordSessionPrivacyActivity(u.u.privacyTrustCenter_SaveSettingsSucceeded);var i=!!n.get_src();e.showRefreshRequiredDialog(i)}return null}),(function(t){return e.recordSessionPrivacyActivity(u.u.privacyTrustCenter_SaveSettingsFailed),o.ULS.sendTraceTag(50917390,306,10,"PrivacyDialogManager.ShowCommercialTrustCenterDialog: Error Saving Settings, error: {0}",t.toString()),null}))})),null})),null}))}))},e.showRefreshRequiredDialog=function(e){(new f).initializeAndShowDialog(e)},e.showPrivacyDialogIfNecessary=function(){e.shouldShowPrivacyNotice().then((function(t){return new Promise((function(n){t?(e._seenThisSession=!0,v.w.get_instance().resolveFuture(i.l).execute((function(t){t.getSettings().then((function(i){return e.recordUserPrivacySettingsDataSourceForSession(i),n(e.showFRENotice(i,t)),null}))}))):n(!1)}))})).then((function(t){return o.ULS.sendTraceTag(51258458,306,50,"PrivacyDialogManager.ShowPrivacyDialogIfNecessary: Notice shown = {0}",t.toString()),e.logPrivacyNoticeResult(),null}),(function(t){return o.ULS.sendTraceTag(51258459,306,10,"PrivacyDialogManager.ShowPrivacyDialogIfNecessary: Error showing notice {0}",t.toString()),e.recordSessionPrivacyActivity(u.u.privacyNotice_Error),e.logPrivacyNoticeResult(),null}))},e.shouldShowPrivacyNotice=function(){var t=-1!==window.location.href.indexOf("&wd_pn=1"),i=new Promise((function(e,t){e(!1)})),r=new Promise((function(e,t){e(!0)}));return t?(e.recordSessionPrivacyActivity(u.u.privacyNotice_Forced),r):n(254).AFrameworkApplication.mightNeedPrivacyDialog?(e.recordSessionPrivacyActivity(u.u.privacyNotice_MightBeNeeded),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OcpsIsEnabled")?e._seenThisSession?i:n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser")&&!e.canWriteHasSeenNotice()?(e.recordSessionPrivacyActivity(u.u.privacyNotice_NotShown_CantWriteCachedCookie),i):(n(254).AFrameworkApplication.privacyDialogAlreadySeen&&(e.recordSessionPrivacyActivity(u.u.privacyNotice_NotShown_AlreadySeenFromHost),e.saveLocally("1")),e._seenLocally=e.hasSeenLocally("1"),e._seenLocally&&e.recordSessionPrivacyActivity(u.u.privacyNotice_NotShown_AlreadySeenFromCachedCookie),e._seenLocally||n(254).AFrameworkApplication.privacyDialogAlreadySeen?i:e.tryGetAdminControllerConnectedServicesState(!1)):(e.recordSessionPrivacyActivity(u.u.privacyNotice_NotShown_OCPSDisabled),i)):i},e.logPrivacyNoticeResult=function(){var e=n(254).AFrameworkApplication.dataPlumber.PrivacyNotice,t={};e&u.u.privacyNotice_MightBeNeeded&&(t.MightBeNeeded=1),e&u.u.privacyNotice_Forced&&(t.Forced=1),e&u.u.privacyNotice_CommercialUsersShown&&(t.CommercialUsersShown=1),e&u.u.privacyNotice_CommercialUsersTrustCenterClicked&&(t.CommercialUsersTrustCenterClicked=1),e&u.u.privacyNotice_CommercialUsersDismissed&&(t.CommercialUsersDismissed=1),e&u.u.privacyNotice_SettingsRoamedBusinessBarShown&&(t.SettingsRoamedBusinessBarShown=1),e&u.u.privacyNotice_SettingsRoamedBusinessBarDismissed&&(t.SettingsRoamedBusinessBarDismissed=1),e&u.u.privacyNotice_BusinessBarForAnonymousUsersShown&&(t.BusinessBarForAnonymousUsersShown=1),e&u.u.privacyNotice_BusinessBarForAnonymousUsersDismissed&&(t.BusinessBarForAnonymousUsersDismissed=1),e&u.u.privacyNotice_SaveNoticeShownSucceeded&&(t.SaveNoticeShownSucceeded=1),e&u.u.privacyNotice_SaveNoticeShownFailed&&(t.SaveNoticeShownFailed=1),e&u.u.privacyNotice_NotShown_OCPSDisabled&&(t.NotShown_OCPSDisabled=1),e&u.u.privacyNotice_NotShown_CantWriteCachedCookie&&(t.NotShown_CantWriteCachedCookie=1),e&u.u.privacyNotice_NotShown_AlreadySeenFromCachedCookie&&(t.NotShown_AlreadySeenFromCachedCookie=1),e&u.u.privacyNotice_NotShown_AlreadySeenFromHost&&(t.NotShown_AlreadySeenFromHost=1),e&u.u.privacyNotice_Error&&(t.PrivacyNoticeError=1),e&u.u.privacy_OCPSCCSDisabled&&(t.OCPSCCSDisabled=1),e&u.u.privacy_OCPSFailure&&(t.OCPSFailure=1),e&u.u.privacy_UserSettingsSourceRoaming&&(t.UserSettingsSourceRoaming=1),e&u.u.privacy_UserSettingsSourceCookie&&(t.UserSettingsSourceCookie=1),e&u.u.privacy_UserSettingsSourceQUeryParam&&(t.UserSettingsSourceQUeryParam=1),o.ULS.sendTraceTag(37357660,306,50,"PrivacyDialogmanager.LogPrivacyNoticeResult: {0}",t)},e.canWriteHasSeenNotice=function(){return e.saveLocally("-1"),e.hasSeenLocally("-1")},e.hasSeenLocally=function(e){return y.g("PrivNote")===e},e.saveLocally=function(e){var t=n(254).AFrameworkApplication.appSettingsManager.getStringAppSetting("PrivacyCookieDomain")||"";y.z("PrivNote",e,y.i,"/",t)},e.tryGetAdminControllerConnectedServicesState=function(t){return void 0===t&&(t=!0),new Promise((function(n,i){v.w.get_instance().resolveFuture(r.c).execute((function(r){r.getBooleanPolicySetting("ControllerConnectedServicesEnabled",t).then((function(t){return n(t),t||e.recordSessionPrivacyActivity(u.u.privacy_OCPSCCSDisabled),null}),(function(t){return i(t),e.recordSessionPrivacyActivity(u.u.privacy_OCPSFailure),null}))}))}))},e.showFRENotice=function(t,i){if(null==t)return!1;if(t.get_src()){if(1===t.get_src()&&!t.controllerServicesStateRoaming&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsAnonymousUser"))return e.showPrivacyNoticeBusinessBar(t,i),!0}else{if(1===t.userPrivacySettingsRoamedNoticeShown)return!1;if(!t.controllerServicesStateRoaming)return e.showCommercialPrivacyNoticeDialog(t,i),!0;if(!t.userPrivacySettingsRoamedNoticeShown)return e.showPrivacyNoticeRoamingBusinessBar(t,i),!0}return!1},e.recordSessionPrivacyActivity=function(e){n(254).AFrameworkApplication.dataPlumber.PrivacyNotice|=e},e.recordUserPrivacySettingsDataSourceForSession=function(t){switch(t.get_src()){case 0:e.recordSessionPrivacyActivity(u.u.privacy_UserSettingsSourceRoaming);break;case 1:e.recordSessionPrivacyActivity(u.u.privacy_UserSettingsSourceCookie);break;case 2:e.recordSessionPrivacyActivity(u.u.privacy_UserSettingsSourceQUeryParam)}},e._seenThisSession=!1,e._seenLocally=!1,e}();(0,a.l)(S,"PrivacyDialogManager",null,[])},,,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=n(619),a=n(502),s=n(192),l=n(432),u=n(822),c=n(866),p=n(808),d=function(e){function t(){var t=e.call(this)||this;return t.jewel=null,t.jewelId=null,t.parentRoot=null,t}return(0,i.t)(t,e),t}(p.n);(0,r.l)(d,"JewelBuildContext",p.n,[]);var h=n(618),g=n(966),m=n(513),_=n(946);n.d(t,{JewelBuilder:function(){return f}});var f=function(e){function t(t,n,i){var r=e.call(this,t,n,i,null)||this;if(m.x(n))throw Error.create("Jewel placeholder DOM element is null or undefined.");return r}return(0,i.t)(t,e),t.prototype.get_jewel=function(){return this.get_root()},t.prototype.set_jewel=function(e){return this.set_root(e),e},t.prototype.buildJewel=function(e,t){if(this.get_inQuery())return!1;if(this.isIdTrimmed(e))return!0;var n=new d;n.jewelId=e,n.parentRoot=t,this.set_inQuery(!0);var i=new l.v;return i.id=n.jewelId,i.queryType=4,i.handler=r.i(this,this.onReturnJewel,"onReturnJewel"),i.data=n,this.get_dataSource().runQuery(i),!0},t.prototype.buildJewelFromData=function(e,t){var n=new u.r;n.success=!0,n.queryData=e,n.contextData=t,this.onReturnJewel(n)},t.prototype.onReturnJewel=function(e){var t=this,n=e.contextData,i=s.o.getFirstChildNodeWithName(e.queryData,s.o.JEWEL);this.set_jewel(this.buildJewelInternal(i,n)),this.get_jewel().set_jewelBuilder(this),this.get_jewel().refreshInternal(),this.get_placeholder().appendChild(this.get_jewel().get_elementInternal()),_.n.ensureCSSClassOnElement(this.get_placeholder(),"loaded"),this.get_buildClientTask().CWo((function(e){t.get_buildClientTask().get_result().onComponentBuilt(t.get_jewel(),t.get_jewel().get_id())}),a.d.onlyOnRanToCompletion|a.d.executeSynchronously)},t.prototype.buildJewelInternal=function(e,t){if(m.x(e))throw Error.create("No Jewel element was present in the data");var n=new s.o(e),i=n.get_attributes();i.DefaultSelection=this.get_jewelBuildOptions().defaultSelectionOverride||i.DefaultSelection,this.set_jewel(new c.Jewel(n.get_attributes().Id,i));var r=this.buildJewelMenuLauncher(e,t);return this.get_jewel().addChild(r.createComponentForDisplayMode("Default")),this.get_jewel().set_jewelMenuLauncher(r),this.get_jewel()},t.prototype.buildJewelMenuLauncher=function(e,t){var n=e[s.o.ATTRIBUTES],i=s.o.getNodeChildren(e),r=null,o=e[s.o.ATTRIBUTES];_.n.isTrue(o.PopulateDynamically)||(r=this.buildMenu(i[0],t));var a=new h.JewelMenuLauncher(this.get_jewel(),n.Id,n,r,t.parentRoot);return a.parentKeytipsIds=g.v.ribbonShortcutId,a.parentKeytipsKeys="",a},t.prototype.get_jewelBuildOptions=function(){return e.prototype.get_options.call(this)},t}(o.Builder);(0,r.l)(f,"JewelBuilder",o.Builder,[])},,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("ITopRowPeripheralControlCreator"),o=n(809),a=n(547),s=n(987),l=n(254),u=function(){return function(){this.command=null,this.queryCommand=null,this.label=null,this.image=null,this.id=null,this.keytip=null}}();(0,i.l)(u,"HeaderToggleButtonInfo",null,[]),n.d(t,{b:function(){return c}});var c=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this._standaloneRoot=null,this._topRowControls=null,this.shareIconWhenShownInRibbon=null,this.shareButtonCommand=null,this._standaloneRoot=e,this.shareButtonCommand=n||"981334692",this.shareIconWhenShownInRibbon=t}return e.prototype.getTopRightActionButtonInfo=function(){return null},e.prototype.getTopRightCommentsButtonInfo=function(){return e.getDefaultCommentsButtonInfo()},e.prototype.getTopRightChangesButtonInfo=function(){return e.getDefaultChangesButtonInfo()},e.prototype.getPeopleWellControlSettings=function(){return null},e.prototype.createTopRowControls=function(e,t,n){this._topRowControls=t.createTopRowControls(n,e,this.shouldShowActionButtonInRibbon()?null:this.getActionButtonInfo(),this._standaloneRoot.get_cuiControlManager(),!1,!1,this.shouldShowRibbonToggleButtonInHeader())},e.prototype.createRibbonPeripheralControls=function(e,t,n){var i=null;this.shouldShowActionButtonInRibbon()&&(i=this.getActionButtonInfo()).command===this.shareButtonCommand&&(i.image=this.shareIconWhenShownInRibbon);var r=l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isCommentsButtonInCollabCornerEnabled()?this.getTopRightCommentsButtonInfo():null,o=l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isChangesButtonEnabled()?this.getTopRightChangesButtonInfo():null;t.createBottomRowRightControls(n,e,this.getPeopleWellControlSettings(),this._standaloneRoot.get_cuiControlManager(),i,r,o)},e.prototype.getActionButtonInfo=function(){var e=s.g();return e||this.getTopRightActionButtonInfo()},e.prototype.disposeTopRowControls=function(){this._topRowControls&&(a.CuiHelper.disposeTopRowControls(this._topRowControls),this._topRowControls=null)},e.prototype.shouldShowActionButtonInRibbon=function(){return!1},e.prototype.shouldShowRibbonToggleButtonInHeader=function(){return!1},e.prototype.shouldShowCopyLinkButtonInRibbon=function(){return!1},e.getDefaultCommentsButtonInfo=function(){return(0,o.m)(new u,{command:"2281051331",queryCommand:"847427893",id:e.commentsButtonId,image:null,label:CommonUIStrings.L_OpenCommentPane})},e.getDefaultChangesButtonInfo=function(){return(0,o.m)(new u,{command:l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_catchUpFlyoutEnabled()?"3418267371":"1956545633",queryCommand:l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_catchUpFlyoutEnabled()?"1059068017":"1715205439",id:e.changesButtonId,image:null,label:CommonUIStrings.L_ActivityPaneTitle})},e.workflowButtonId="btnWorkflow",e.commentsButtonId="ShowCommentsTopBar",e.changesButtonId="CatchUpWithChanges",e}();(0,i.l)(c,"TopRowPeripheralControlCreator",null,[r])},function(e,t,n){"use strict";var i=n(323),r={};r[n(786)("toStringTag")]="z",e.exports="[object z]"!==String(r)?function(){return"[object "+i(this)+"]"}:r.toString},,,,function(e,t,n){var i=n(714),r=n(760),o=n(537),a=n(12);e.exports=function(e,t){for(var n=r(t),s=a.f,l=o.f,u=0;u<n.length;u++){var c=n[u];i(e,c)||s(e,c,l(t,c))}}},function(e,t,n){e.exports=n(909)},function(e,t,n){"use strict";n.d(t,{y:function(){return r}});var i=n(208),r=function(){return function(){this.name=null,this.samplingPolicy=null,this.dataFields=null}}();(0,i.l)(r,"TelemetryEvent",null,[])},,function(e,t,n){"use strict";n.d(t,{t:function(){return i}});var i=(0,n(208).y)("IRootUser")},function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var i=(0,n(208).y)("IMenuItem")},function(e,t,n){var i="object",r=function(e){return e&&e.Math==Math&&e};e.exports=r(typeof globalThis==i&&globalThis)||r(typeof window==i&&window)||r(typeof self==i&&self)||r(typeof n.g==i&&n.g)||Function("return this")()},function(e,t,n){"use strict";n.d(t,{y:function(){return r}});var i=n(208),r=function(){return function(){}}();(0,i.l)(r,"ExtraInfo",null,[])},function(e,t,n){"use strict";var i=n(140),r=n(393);e.exports=i("Map",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r,!0)},,,function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var i=(0,n(208).y)("IPackage")},function(e,t,n){var i=n(57),r=n(9),o=n(560),a=n(975),s=n(985),l=n(714),u=n(557),c=Object.getOwnPropertyDescriptor;t.f=i?c:function(e,t){if(e=a(e),t=s(t,!0),u)try{return c(e,t)}catch(e){}if(l(e,t))return o(!r.f.call(e,t),e[t])}},,function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var i=n(208),r=function(){function e(){}return e.measurementTag="o",e.machineAttr="m",e.titleAttr="n",e.timeStampeAttr="ts",e.beginTimeAttr="t",e.spendTimeAttr="d",e.errorTag="Error",e.indent="  ",e.correlation="c",e.sessionId="sid",e.fileRep="f",e}();(0,i.l)(r,"PageStatsXmlName",null,[])},function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var i=n(208),r=function(){return function(){this.name=null,this.bool=null,this.string=null,this.int64=null,this.double=null,this.date=null,this.contract=null}}();(0,i.l)(r,"DataField",null,[])},function(e,t,n){var i=n(383);e.exports=i("native-function-to-string",Function.toString)},,function(e,t,n){"use strict";n.d(t,{k:function(){return i}});var i=(0,n(208).y)("IWindowEventManager")},function(e,t,n){"use strict";n.r(t);n(27),n(217),n(848),n(389),n(424),n(526),n(804),n(702)},,,function(e,t,n){"use strict";n.r(t);var i=n(233),r=n(208),o=(0,r.y)("ICuiHelper"),a=n(809),s=n(600),l=n(255),u=n(614),c=n(721),p=n(987),d=n(363),h=n(704),g=n(254),m=function(){function e(){}return e.createRibbonUpsellButton=function(t,i,r){if(i&&t){var o="1274543852";switch(g.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FreemiumUpsellShowDialogIsEnabled")&&(o="4180531998"),r){case 1:var a=n(547).CuiHelper.addButton(e.freemiumUpsellEligibleButtonId+e.buttonCount.toString(),o,CommonUIStrings.l_FreemiumUpsell,e.freemiumUpsellButtonImageName,null,"Medium20",i,t);Sys.UI.DomElement.addCssClass(a,"FreemiumUpsellButton"),i.appendChild(a),g.AFrameworkApplication.get_theActionManager().processAction(u.KD,2),l.ULS.sendTraceTag(40739802,340,50,"Go Premium Upsell button created"),e.buttonCount++}}},e.freemiumUpsellButtonImageName="UpgradeProductGlyph_20x20x32",e.freemiumUpsellEligibleButtonId="btnFreemiumUpsellEligible",e.freemiumUpsellBadgeButtonId="btnFreemiumUpsellBadge",e.buttonCount=0,e}();(0,r.l)(m,"RibbonUpsellButtonCreator",null,[]);var _=n(508),f=function(e){function t(t){var n=e.call(this)||this;return n.withoutSaveStatus=!1,n.withoutSaveStatus=t,n}return(0,_.t)(t,e),t}(Sys.EventArgs);(0,r.l)(f,"TopRowCreatedEventArgs",Sys.EventArgs,[]);var y=n(422),v=n(928),S=n(698),C=n(973),b=n(427),A=n(306),T=n(574),w=function(){return function(e,t){this.cluster=null,this.css=null,this.cluster=e,this.css=t}}();(0,r.l)(w,"ImageInfo",null,[]);var I=function(){function e(e,t,n,i,r,o,a,s,l,u,c,p,d,h,g,m){void 0===g&&(g=null),void 0===m&&(m=null),this.id=null,this.actionIdCommand=0,this.actionIdQueryStatus=0,this.actionIdPopulateFlyout=0,this.actionIdCommandMenuOpen=0,this.actionIdCommandMenuClose=0,this.actionIdUserButtonClick=0,this.actionIdRefreshControl=0,this.singleUserCollabGlyph16=null,this.singleUserCollabGlyph32=null,this.multipleUserCollabGlyph16=null,this.groupChatButtonGlyph32=null,this.id=e,this.actionIdCommand=t,this.actionIdQueryStatus=n,this.actionIdPopulateFlyout=i,this.actionIdCommandMenuOpen=r,this.actionIdCommandMenuClose=o,this.actionIdUserButtonClick=a,this.actionIdRefreshControl=s,this.singleUserCollabGlyph16=new w(l,u),this.singleUserCollabGlyph32=new w(c,p),this.multipleUserCollabGlyph16=new w(d,h),g&&m&&(this.groupChatButtonGlyph32=new w(g,m))}return e.prototype.get_id=function(){return this.id},e.prototype.get_actionIdCommand=function(){return this.actionIdCommand},e.prototype.get_actionIdQueryStatus=function(){return this.actionIdQueryStatus},e.prototype.get_actionIdPopulateFlyout=function(){return this.actionIdPopulateFlyout},e.prototype.get_actionIdCommandMenuOpen=function(){return this.actionIdCommandMenuOpen},e.prototype.get_actionIdCommandMenuClose=function(){return this.actionIdCommandMenuClose},e.prototype.get_actionIdUserButtonClick=function(){return this.actionIdUserButtonClick},e.prototype.get_actionIdRefreshControl=function(){return this.actionIdRefreshControl},e.prototype.get_singleUserCollabGlyph16=function(){return this.singleUserCollabGlyph16},e.prototype.get_singleUserCollabGlyph32=function(){return this.singleUserCollabGlyph32},e.prototype.get_multipleUserCollabGlyph16=function(){return this.multipleUserCollabGlyph16},e.prototype.get_groupChatButtonGlyph32=function(){return this.groupChatButtonGlyph32},e}();(0,r.l)(I,"PeoplesWellBaseSettings",null,[]);var E=function(){return function(){this.breadcrumbContainer=null,this.breadcrumbItems=null}}();(0,r.l)(E,"BreadcrumbControls",null,[]);var k=function(){function e(e,t,n,i,r,o,a,s){void 0===t&&(t=u.lv),void 0===n&&(n=u.kB),void 0===i&&(i=u.Lm),void 0===r&&(r=u.CQ),void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=!1),this.id=null,this.togglePaneActionId=0,this.queryStatusActionId=0,this.refreshControlActionId=0,this.joinChatActionId=0,this.imageName=null,this.unreadImageName=null,this.hideUnreadMessageCount=!1,this.id=e,this.togglePaneActionId=t,this.queryStatusActionId=n,this.refreshControlActionId=i,this.joinChatActionId=r,this.imageName=o,this.unreadImageName=a,this.hideUnreadMessageCount=s}return e.getChatButtonSettings=function(){return e.swxDocChatSettings},e.swxDocChatSettings=new e("DocChat",void 0,void 0,void 0,void 0,"WACSkypeDocChat_16x16x32","WACSkypeDocChatUnread_16x16x32"),e}();(0,r.l)(k,"ChatButtonSettings",null,[]);var D=function(){return function(){this.command=null,this.label=null,this.image=null,this.id=null,this.swxExperience=0}}();(0,r.l)(D,"SkypeButtonInfo",null,[]);var M=function(){return function(){this.breadcrumb=null,this.titleSection=null,this.userControl=null}}();(0,r.l)(M,"TopRowControls",null,[]);var P=n(402),F=n(235),x=n(296),R=n(743),B=n(556);n.d(t,{CuiHelper:function(){return L}});var L=function(){function e(t,n,i,r,o){void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=null),this._imagePath="",this._intlStringClasses=null,this._isOfficePresentationAttendeeMode=!1,this._imagePath=t,this._intlStringClasses=P.d(Object,n,o),this._intlStringClasses.push(CommonUIStrings),this._isOfficePresentationAttendeeMode=p.o(),e._actionManager=null==i?g.AFrameworkApplication.get_theActionManager():i,null==r?this.buildHeaderStringsDictionary():e._headerStrings=r,e._officeOnlineBrandWidth=g.AFrameworkApplication.get_unifiedHeaderOfficeOnlineLogoWidth(),e._officeOnlineBrandHeight=e.unifiedHeaderHeight}return e.prototype.buildHeaderStringsDictionary=function(){e._headerStrings={SignoutLink:CommonUIStrings.l_SignoutLink,SignInLink:CommonUIStrings.l_SignIn,SwitcherTooltip:CommonUIStrings.l_SwitcherTooltip}},e.prototype.updateData=function(t){var n={},i=e.getNodeAttributes(t);for(var r in i){var o={key:r,value:i[r]},a=o.value.toString();a&&(this.replaceIntlString(i,o.key,a),this.replaceImagePath(i,o.key,a),this.replaceImageMap(i,o.key,a,n))}for(var s in n){var l={key:s,value:n[s]};i[l.key+"Class"]=l.value}for(var u=e.getNodeChildren(t),c=0;c<u.length;c++)this.updateData(u[c])},e.prototype.replaceIntlString=function(e,t,n){if(-1!==n.indexOf("STR@")){var i=n.replace("STR@","");e[t]=this.getIntlString(i)}},e.prototype.replaceImagePath=function(e,t,n){-1!==n.indexOf("IMAGEPATH@")&&(e[t]=R.h.staticContentHost+n.replace("IMAGEPATH@",this._imagePath)+R.h.get_staticContentQueryParameter())},e.prototype.replaceImageMap=function(e,t,n,i){if(-1!==n.indexOf("IMGMAP@")){var r=n.split("@");if(3===r.length){var o=g.AFrameworkApplication.get_imageClusterPath(),a=C.getImageClass(r[2]),s=r[1],l=g.AFrameworkApplication.get_imageClusterName();s!==l&&(o=o.replace(l+".png",s+".png"),a=a.replace(l,s)),e[t]=o,i[t]=a}}},e.prototype.getIntlString=function(e){for(var t=0,n=this._intlStringClasses;t<n.length;t++){var i=n[t][e];if(null!=i)return i}return""},e.prototype.createTopRowControls=function(e,t,n,i,r,o,a){return void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=!1),this.createTopRowControlsInternal(e,t,n,i,!r,!r,o,a)},e.prototype.createTopRowControlsInternal=function(t,n,i,r,o,a,s,l){var u=new M,c=this.createTopLeftControls(t,o&&!this._isOfficePresentationAttendeeMode);c&&(u.breadcrumb=c,n.appendChild(c.breadcrumbContainer));var _=e.createGenericPeripheralSection(t,d.r.topRowCenter),y=!!g.AFrameworkApplication.get_activeFrame().get_applicationInstance()&&4===g.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_officeAppType()||!this._isOfficePresentationAttendeeMode;g.AFrameworkApplication.docPropertiesProvider.get_breadcrumbDocName()&&a&&y&&e.createDocumentTitleElement(_),u.titleSection=_,n.appendChild(_),e.headerDocumentTitleSpanId=_.id;var v=e.createGenericPeripheralSection(t,d.r.topRowRight);if(v){if(i?this.createActionButton(r,i,v,e.actionButtonDisplayModeInHeader):p.f(l)&&h.l(v),r&&p.u()&&m.createRibbonUpsellButton(r,v,g.AFrameworkApplication.get_freemiumUpsellMode()),r&&p.h()){var S=e.getTopRightSkypeButtonInfo(),C=S.id+(e._topRowControlsCount>0?e._topRowControlsCount.toString():""),b=e.addButton(C,S.command,S.label,S.image,null,e.skypeButtonDisplayMode,v,r);e.skypeButtonId?e.secondSkypeButtonId=C:e.skypeButtonId=C,e._topRowControlsCount++,Sys.UI.DomElement.addCssClass(b,"SkypeButton"),b.style.display="none";var A=document.createElement("div");Sys.UI.DomElement.addCssClass(A,"SkypeUnreadConversationsDiv"),b.appendChild(A);var T=document.createElement("span");A.appendChild(T),Sys.UI.DomElement.addCssClass(T,"SkypeUCBBackground"),Sys.UI.DomElement.addCssClass(T,e.skypeUnreadConversationsBubbleClass),T.style.display="none"}if(!g.AFrameworkApplication.get_isEmbedded()){if(g.AFrameworkApplication.userNameUnknown&&!g.AFrameworkApplication.signoutUrl||g.AFrameworkApplication.limitedEdit){var w=this.createSignInLink(g.AFrameworkApplication.signInUrl);w&&v.appendChild(w),u.userControl=w}else{var I=this.createUserNameAndSignOutLink();I&&v.appendChild(I),u.userControl=I}}n.appendChild(v)}return e._topRowControlsCount++,e.get_headerEventSource().raiseTopRowControlsCreatedEvent(r,new f(s)),u},e.prototype.createBottomRowRightControls=function(t,n,i,r,o,a,s){void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=null);var l=e.createGenericPeripheralSection(t,d.r.bottomRowRight);if(r){if(e.createPeopleWellControl(i,r,l),e.createDocChatButton(r,l),o&&this.createActionButton(r,o,l,e.actionButtonDisplayModeInRibbon),a&&l)e.addToggleButton(a.id,a.command,a.queryCommand,a.label,a.image,a.keytip,e.commentsButtonDisplayMode,l,r).className+=" CommentsButton";if(s&&l){var u=e.addToggleButton(s.id,s.command,s.queryCommand,s.label,s.image,s.keytip,e.changesButtonDisplayMode,l,r);u.className+=" ChangesButton",g.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_shouldHideChangesButtonInitially()&&(u.style.display="none")}}n.appendChild(l)},e.prototype.createActionButton=function(t,n,i,r){(void 0===r&&(r="Medium20"),i&&n&&t)&&(e.addButton(n.id+(e._topRowControlsCount>0?e._topRowControlsCount.toString():""),n.command,n.label,n.image,null,r,i,t).className+=" DocumentActionButton")},e.prototype.createBottomRowCenterControls=function(t,n,i,r,o,a,s){var l=e.createGenericPeripheralSection(t,d.r.bottomRowCenter);e.addPrintButton(i,l,s),e.addTellMeSearchBox(r,l,s),o&&e.addSeparator(l,s),e.addOpenInClientButton(o,l,s),e.addFeedbackButton(a,s,l),n.appendChild(l)},e.prototype.createOfficeBrandElement=function(){var t=null;return void 0!==e._officeOnlineBrandWidth&&((t=document.createElement("span")).style.width=e._officeOnlineBrandWidth+"px",t.style.height=e._officeOnlineBrandHeight+"px",t.style.lineHeight=e._officeOnlineBrandHeight+"px",t.className="headBrand",t.innerText=CommonUIStrings.l_AppNameShort,l.ULS.shipAssertTag(40978313,344,CommonUIStrings.l_AppNameShort.indexOf("webappshort")<0)),t},e.prototype.createTopRowSeparatorElement=function(e,t){t&&(!!g.AFrameworkApplication.breadcrumbBrandName,g.AFrameworkApplication.breadcrumbFolderName);var n=null;return e&&((n=document.createElement("span")).className=e?"OfficeOnlineBrandSwitcherSeparator":"OfficeOnlineBrandBreadcrumbSeparator"),n},e.prototype.createTopLeftControls=function(t,i){var r=p.k(),o=e.createGenericPeripheralSection(t,d.r.topRowLeft);Sys.UI.DomElement.addCssClass(o,"BreadcrumbContainer");var a=new E;a.breadcrumbContainer=o,a.breadcrumbItems=[];var s=e.createUnifiedAppAndBrandContainer(t);if(r?(n(858).AppSwitcher.createSwitcherDropdown(t,s,a,e._headerStrings,r),n(858).AppSwitcher.setupFocusRegionForSwitcher()):this.createAppIcon(s),e.isTransistionalHeaderUIEnabled()||this.addSeparatorToContainer(s,r,i),this.createAndAddBreadCrumbToContainer(s,a.breadcrumbItems),o.appendChild(s),i)for(var l=0,u=e.createHostBrandAndFolderElements(o,e.breadcrumbSeparatorImageName);l<u.length;l++){var c=u[l];Array.add(a.breadcrumbItems,c)}return a},e.prototype.addSeparatorToContainer=function(e,t,n){var i=this.createTopRowSeparatorElement(t,n);i&&e.appendChild(i)},e.prototype.createAndAddBreadCrumbToContainer=function(e,t){var n=this.createOfficeBrandElement();n&&(e.appendChild(n),Array.add(t,n))},e.prototype.createAppIcon=function(e){var t=C.createClusteredImage(36,36,"AppLogoSilhouette_36x36x32","AppHeaderIconFloat",!0,null);e.appendChild(t)},e.prototype.createSignInLink=function(t){var n=null;return t&&((n=document.createElement("a")).className="SignInLink",n.href=t,n.id=e.signInLinkId,n.innerText=e._headerStrings.SignInLink.toString(),n.target="_top",b.s.get_instance().registerHandlerWithBrowserClickOption(T.d.click,n,e.onSignInLinkClick,null,!0)),n},e.prototype.createUserNameAndSignOutLink=function(){var t=null;if(g.AFrameworkApplication.userName||g.AFrameworkApplication.signoutUrl){t=document.createElement("span"),Sys.UI.DomElement.addCssClass(t,"UsernameContainer");var n=document.createElement("span");if(n.className="UsernameNameContainer",t.appendChild(n),!g.AFrameworkApplication.userNameUnknown){var i=document.createElement("span");i.className="UsernameNameItem",i.setAttribute("dir","auto"),i.innerText=g.AFrameworkApplication.userName,n.appendChild(i)}var r=g.AFrameworkApplication.signoutUrl;if(r){if(!e.isTransistionalHeaderUIEnabled()){var o=document.createElement("span");o.className="UserNameSeparator",t.appendChild(o)}var a=document.createElement("a");a.className="SignoutLink",a.href=r,a.id=e.signoutLinkId,a.innerText=e._headerStrings.SignoutLink.toString(),t.appendChild(a)}}return t},e.get_headerEventSource=function(){return e._headerEventSource||(e._headerEventSource=F.w.get_instance().resolve(c.p))},e.registerOnClickBreadcrumbLink=function(t){e._breadcrumbLinkClickHandler=t},e.getNodeAttributes=function(e){return e.attrs},e.getNodeChildren=function(t){var n=t.children;return null==n?e.get_emptyArray():n},e.get_emptyArray=function(){return void 0!==e.s_emptyArray&&null!==e.s_emptyArray||(e.s_emptyArray=[]),e.s_emptyArray},e.getPeoplesWellDefaultControlSettings=function(t,n,i,r,o,a,s,l){return void 0===s&&(s=null),void 0===l&&(l=null),new I(e.peoplesWellControlId,u.ww,u.gD,u.ci,u.IJ,u.RH,u.rQ,u.Go,t,n,i,r,o,a,s,l)},e.addFeedbackButton=function(t,n,i){if(t&&n){var r=S.yL(e.feedbackButtonId,t.command,t.label,null),o=n.hostControl(e.feedbackButtonId,r,"Medium");o&&i&&(Sys.UI.DomElement.addCssClass(o,"UITextTranformUpperCase"),Sys.UI.DomElement.addCssClass(o,"GiveFeedbackControl"),i.appendChild(o))}},e.createPeopleWellControl=function(e,t,n){if(e&&t){var i=S.LU(e),r=t.hostControl(e.get_id(),i,"Medium");if(r){var o=!1;g.AFrameworkApplication.appSettingsManager&&(o=g.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ColorPresenceHashIsEnabled")),o?Sys.UI.DomElement.addCssClass(r,"PeoplesWellControl2"):Sys.UI.DomElement.addCssClass(r,"PeoplesWellControl"),n.appendChild(r)}}},e.createDocChatButton=function(t,n){var i,r=k.swxDocChatSettings,o=g.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DocChatIsEnabled"),a=g.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BasicChatIsEnabled");o&&r&&t&&(i=!a&&o?S.Ff(r.id,r.id,r.togglePaneActionId.toString(),r.queryStatusActionId.toString(),CommonUIStrings.l_DocChatButtonLabel,CommonUIStrings.l_DocChatButtonTooltip,r.imageName,!1):S.yL(r.id,r.togglePaneActionId.toString(),CommonUIStrings.l_DocChatButtonLabel,r.imageName,r.id,null,CommonUIStrings.l_DocChatButtonTooltip,"Medium",null,r.queryStatusActionId.toString(),void 0,void 0,void 0,!1),t.addControl(r.id,i)&&e.addDocChatButtonToContainer(n,t.getDOMElementForControlDisplayMode(r.id,"Medium")))},e.getTopRightSkypeButtonInfo=function(){var t=g.AFrameworkApplication.appSettingsManager.getIntAppSetting("SkypeExperience",0),n=1===t?e.skypeConsumerButtonWhite:e.skypeBusinessButtonWhite;return e.isTransistionalHeaderUIEnabled()&&(n=e.skypeNewHeaderButton),(0,a.m)(new D,{label:CommonUIStrings.l_SkypeTooltip,command:"3476734992",image:n,id:e.skypeButtonPrefixId,swxExperience:t})},e.addDocChatButtonToContainer=function(e,t){t&&(t.style.display="none",e.appendChild(t))},e.disposeTopRowControls=function(t){var i;t.breadcrumb&&(e.disposeTopLeftControls(t.breadcrumb),t.breadcrumb=null),t.titleSection&&(e.disposeTitleElement(),t.titleSection=null),t.userControl&&(e.disposeUserControl(t.userControl),t.userControl=null),n(858).AppSwitcher.disposeSwitcher(),e.get_headerEventSource().raiseOnTopRowControlsDisposingEvent(),v.f((0,s.m)((function(){return i}),(function(e){return i=e})),!1)&&(x.s.clearElementHtml(i),e.skypeButtonId=e.secondSkypeButtonId=null)},e.createDocumentTitleElement=function(t){return e.createDocumentTitleElementInternal(t,g.AFrameworkApplication.isRenameSupported())},e.createDocumentTitleElementInternal=function(t,n){var i=g.AFrameworkApplication.docPropertiesProvider.get_breadcrumbDocName();g.AFrameworkApplication.get_documentIsFolder()||(i=B.l.getFileNameWithoutExtension(i));var r=e.createBreadcrumbItem(t,e.breadcrumbTitleId,i,null,n);return n&&(g.AFrameworkApplication.documentTitleInputElement=r),r},e.createEmptyHeaderAndToolbar=function(t){var n,i,r,o,a=document.createElement("div");return a.className="cui-viewerchrome",e.ensureTopBars(a,(0,s.m)((function(){return n}),(function(e){return n=e})),(0,s.m)((function(){return i}),(function(e){return i=e}))),e.ensureTopBars1And2(t,n,i,(0,s.m)((function(){return r}),(function(e){return r=e})),(0,s.m)((function(){return o}),(function(e){return o=e}))),a.appendChild(i),a},e.ensureTopBars=function(e,t,n){var i;n.val=document.createElement("div"),n.val.className="cui-ribbonTopBars",v.f((0,s.m)((function(){return i}),(function(e){return i=e})))?(t.val=document.createElement("div"),t.val.id="EmptyHeaderTopBars",t.val.className="cui-viewerchrome cui-ribbonTopBars empty",i.appendChild(t.val),Sys.UI.DomElement.addCssClass(e,"cui-exth")):t.val=n.val},e.ensureTopBars1And2=function(e,t,n,i,r){i.val=document.createElement("div"),i.val.className="cui-topBar1",g.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LegacyHeaderAppColorIsEnabled")&&(i.val.className+=" cui-topBar1-transistionalHeaderUI"),e&&(i.val.style.display="none"),t.appendChild(i.val),r.val=document.createElement("div"),r.val.className="cui-topBar2",n.appendChild(r.val)},e.disposeEmptyHeaderAndToolbar=function(e){x.s.removeElement(e);var t=document.getElementById("EmptyHeaderTopBars");t&&x.s.removeElement(t)},e.initializeRenameUIHandler=function(){g.AFrameworkApplication.get_theActionManager().processAction(u.LJ,2)},e.disposeTitleElement=function(){g.AFrameworkApplication.documentTitleInputElement&&A.EventHandlerManager.get_instance().unregisterAllHandlers(g.AFrameworkApplication.documentTitleInputElement)},e.addPrintButton=function(t,n,i){t&&i&&e.addButton(e.printButtonId,t.command,t.label,null,CommonUIStrings.l_PrintKeytip,"Medium",n,i)},e.addTellMeSearchBox=function(t,n,i){if(t&&i){var r=e.buildSearchBoxXml(e.tellMeSearchBoxId,t.accessibilityTextCommand,t.command,t.commandMenuClose,t.commandMenuOpen,t.menuControlExecutedCommand,t.onInteractionBegin,t.onRestoreFocus,t.onInputBoxFocus,t.onInputBoxBlur,t.populateQueryCommand,t.populateAsyncTriggerCommand,!0,!1,t.altText,t.placeHolderText,t.keytip,"182px",g.AFrameworkApplication.get_imageClusterPath(),C.getImageClass("Oz_16x16x32"),C.getImageClass("OzSilhouette_Glyph_16x16x32"),C.getImageClass("OzSilhouette_16x16x32")),o=i.hostControl(e.tellMeSearchBoxId,r,"Medium");Sys.UI.DomElement.addCssClass(o,e.tellMeSearchBoxClass),o&&(g.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OcpsIsEnabled")&&e.hideTellMeSearchBoxOnlyTillFeatureIsEnabled(o,n),n.appendChild(o))}},e.hideTellMeSearchBoxOnlyTillFeatureIsEnabled=function(e,t){for(var n=e.childNodes,r=0;r<n.length;r++)n[r].style.display="none";F.w.get_instance().resolveFuture(i.a).execute((function(e){e.isFeatureEnabled("ConnectedServices",!0).then((function(e){if(e)for(var t=0;t<n.length;t++)n[t].style.display="";return null}))}))},e.addOpenInClientButton=function(t,n,i){if(t&&i){var r=e.addButton(e.openInClientButtonId,t.command,t.label,null,CommonUIStrings.l_OpenInClientKeytip,"Medium",n,i);Sys.UI.DomElement.addCssClass(r,e.openInClientButtonClass)}},e.buildSearchBoxXml=function(e,t,n,i,r,o,a,s,l,u,c,p,d,h,g,m,_,f,y,v,S,C){var b={Id:e,AccessibilityTextCommand:t,Command:n,CommandMenuClose:i,CommandMenuOpen:r,MenuControlExecutedCommand:o,InteractionBeginCommand:a,RestoreFocusCommand:s,InputBoxFocusCommand:l,InputBoxBlurCommand:u,PopulateQueryCommand:c,PopulateAsyncTriggerCommand:p,PopulateDynamically:d,PopulateOnlyOnce:h,Alt:g,PlaceholderText:m,Keytip:_,Width:f,Image16by16:y,Image16by16Class:v,LightImage16by16Class:S,DarkImage16by16Class:C},A="<SearchBox ";for(var T in b){var w={key:T,value:b[T]};w.value&&(A+=w.key+'="'+B.l.xmlEncode(w.value.toString())+'" ')}return A+"/>"},e.addSeparator=function(e,t){if(t){var n=S.vN("BottomRowCenterSeparator"),i=t.hostControl("BottomRowCenterSeparator",n,"Small");i&&e.appendChild(i)}},e.addButton=function(e,t,n,i,r,o,a,s){var l=S.yL(e,t,n,i,null,null,null,o,null,null,void 0,void 0,r),u=s.hostControl(e,l,o);return u&&a.appendChild(u),u},e.addToggleButton=function(e,t,n,i,r,o,a,s,l){var u=S.Ff(e,null,t,n,i,i,r,void 0,o),c=l.hostControl(e,u,a);return c&&s.appendChild(c),c},e.createGenericPeripheralSection=function(t,n){var i=document.createElement("span");return i.className="cui-"+n,i.id=e.generatePeripheralSectionID(t,n),i.style.display="none",i},e.generatePeripheralSectionID=function(e,t){return e+"-"+t},e.createUnifiedAppAndBrandContainer=function(e){var t=document.createElement("span");return Sys.UI.DomElement.addCssClass(t,"AppAndBrandContainer"),t.id=e+"-AppAndBrandContainer",t},e.createAppBrandElement=function(t){return e.createBreadcrumbItem(t,e.breadcrumbAppBrandId,CommonUIStrings.l_AppNameShort,null,!1)},e.createAppBrandSeparatorElement=function(e){var t=document.createElement("span");return t.className="AppBrandSeparator",e.appendChild(t),t},e.createHostBrandAndFolderElements=function(t,n){var i=!!g.AFrameworkApplication.breadcrumbBrandName,r=!!g.AFrameworkApplication.breadcrumbFolderName,o=[],a=null;if(i&&(a=e.createBreadcrumbItem(t,e.breadcrumbBrandId,g.AFrameworkApplication.breadcrumbBrandName,g.AFrameworkApplication.breadcrumbBrandUrl,!1),Array.add(o,a),r)){var s=C.createClusteredImage(6,16,n,"BreadcrumbItem FolderSeparator",!0,"");s.id=e.folderSeparatorId,t.appendChild(s),Array.add(o,s)}return r&&(a=e.createBreadcrumbItem(t,e.breadcrumbFolderId,g.AFrameworkApplication.breadcrumbFolderName,g.AFrameworkApplication.breadcrumbFolderUrl,!1),Array.add(o,a)),o},e.createBreadcrumbItem=function(t,n,i,r,o){var a;return!!r?((a=document.createElement("a")).href=r,a.target="_top",b.s.get_instance().registerHandlerWithBrowserClickOption(T.d.click,a,e.onBreadcrumbLinkClick,null,!0)):o?(a=document.createElement("div")).tabIndex=0:a=document.createElement("span"),a.className="BreadcrumbItem"+(o?" Selectable":""),a.id=n,a.innerText=i,a.setAttribute("dir","auto"),t.appendChild(a),a},e.disposeTopLeftControls=function(e){e.breadcrumbItems&&A.EventHandlerManager.get_instance().unregisterAllHandlersForDOMArray(e.breadcrumbItems)},e.onBreadcrumbLinkClick=function(t){var n=y.y.get_instance().startActivity(u.HV);return n.get_properties().add("id",t.get_caughtElement().id),n.end(),l.ULS.sendTraceTag(595732178,207,50,"Breadcrumb link clicked: {0}",{id:t.get_caughtElement().id}),!!e._breadcrumbLinkClickHandler&&e._breadcrumbLinkClickHandler(t)},e.disposeUserControl=function(t){b.s.get_instance().unregisterHandlerWithBrowserClickOption(T.d.click,t,e.onSignInLinkClick,!0)},e.onSignInLinkClick=function(e){if(g.AFrameworkApplication.useSignInCommandPostMessage){var t=g.AFrameworkApplication.get_activeFrame().get_applicationInstance().getSignInParams();g.AFrameworkApplication.get_activeFrame().signInInternal(t),g.AFrameworkApplication.useSignInCommandPostMessage=!1}else window.top.location=g.AFrameworkApplication.signInUrl;return!0},e.isTransistionalHeaderUIEnabled=function(){return!!g.AFrameworkApplication.get_activeFrame()&&g.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isTransistionalHeaderUIEnabled()},e._headerEventSource=null,e.shareButtonImg20="ShareServerWhite_20x20x32",e.skypeConsumerButtonBlack="WACSkypeButtonBlack_20x20x32",e.skypeConsumerButtonWhite="WACSkypeButtonWhite_20x20x32",e.skypeBusinessButtonBlack="WACSkypeBusinessButtonBlack_20x20x32",e.skypeBusinessButtonWhite="WACSkypeBusinessButtonWhite_20x20x32",e.skypeNewHeaderButton="SkypeTitlebar_20x20x32",e.externalHeaderFullTopBarsId="ExternalHeaderFullTopBars",e.externalHeaderViewerChromeTopBarsId="ExternalHeaderViewerChromeTopBars",e.headerTopBarsId="HeaderTopBars",e.breadcrumbAppBrandId="BreadcrumbAppBrand",e.breadcrumbBrandId="BreadcrumbBrand",e.breadcrumbFolderId="BreadcrumbFolder",e.breadcrumbTitleId="BreadcrumbTitle",e.folderSeparatorId="FolderSeparator",e.signoutLinkId="SignoutLink",e.signInLinkId="SignInLink",e.tellMeSearchBoxId="sbTellMe",e.simplifiedTellMeSearchBoxId="TellMe-SearchBox",e.openInClientButtonId="btnOpenInClient",e.printButtonId="btnPrint",e.shareButtonId="btnFileSharing",e.skypeButtonPrefixId="BasicChat",e.replyWithChangesButtonId="btnReplyWithChanges",e.feedbackButtonId="jbtnGiveFeedback",e.peoplesWellControlId="PeoplesWellControl",e.editableBreadcrumbItemClass="EditableBreadcrumbItem",e.tellMeSearchBoxClass="TellMeSearchBox",e.openInClientButtonClass="ButtonOpenInClient",e.skypeUnreadConversationsBubbleClass="SkypeUnreadConversationsBubble",e._actionManager=null,e._headerStrings=null,e._breadcrumbLinkClickHandler=null,e._officeOnlineBrandWidth=0,e._officeOnlineBrandHeight=0,e.unifiedHeaderHeight=50,e._topRowControlsCount=0,e.breadcrumbSeparatorImageName="BreadcrumbCaret_6x16x32",e.breadcrumbAlternateSeparatorImageName="BreadcrumbCaretAlt_6x16x32",e.skypeButtonDisplayMode="Small20",e.actionButtonDisplayModeInRibbon="Medium",e.actionButtonDisplayModeInHeader="Medium20",e.commentsButtonDisplayMode="Medium",e.changesButtonDisplayMode="Medium",e.headerDocumentTitleSpanId=null,e.skypeButtonId=null,e.secondSkypeButtonId=null,e.s_emptyArray=null,e}();(0,r.l)(L,"CuiHelper",null,[o])},function(e){e.exports=function(e){if(null==e)throw TypeError("Can't call method on "+e);return e}},,function(e,t,n){"use strict";n.d(t,{n:function(){return l}});var i=n(446),r=n(574),o=n(154),a=n(586),s=n(208),l=function(){function e(){this._supressEvents=!1,this._isEnabled=!0,this._postEventCallback=null,this._controlledElements=[],this._postEventCallback=function(){},e._refCount++,this._supressEvents=!1}return e.prototype.get_isEnabled=function(){return this._isEnabled},e.prototype.set_isEnabled=function(e){return this._isEnabled=e,e},e.prototype.dispose=function(){for(this.releaseCapture(),this.resume();this._controlledElements.length>0;)this.deinitializeForElement(this._controlledElements[0]);Array.clear(this._controlledElements),e._refCount--},e.prototype.suspend=function(){this._supressEvents=!0},e.prototype.resume=function(){this._supressEvents=!1},e.prototype.registerPostEventCallback=function(e){this._postEventCallback=e},e.prototype.releaseCapture=function(){},e.prototype.initializeForElement=function(e){Array.add(this._controlledElements,e)},e.prototype.deinitializeForElement=function(e){Array.remove(this._controlledElements,e)},e.prototype.addDomEventHandler=function(e,t,n,i){void 0===i&&(i=!1),i?e.addEventListener(t,n,i):$addHandler(e,t,n)},e.prototype.removeDomEventHandler=function(e,t,n,i){void 0===i&&(i=!1),i?e.removeEventListener(t,n,i):$removeHandler(e,t,n)},e.add_onInputCancelled=function(t){e._eventSource.addHandler("InputCancelled",t)},e.remove_onInputCancelled=function(t){e._eventSource.removeHandler("InputCancelled",t)},e.setEnsureAppAwakeCallback=function(t){e._ensureAppAwakeCallback=t},e.setEnsureAppAwakeIfAsleepCallback=function(t){e._ensureAppAwakeIfAsleepCallback=t},e.ensureAppAwake=function(){e._ensureAppAwakeCallback&&e._ensureAppAwakeCallback()},e.ensureAppAwakeIfAsleep=function(){e._ensureAppAwakeIfAsleepCallback&&e._ensureAppAwakeIfAsleepCallback()},e.addHandler=function(e,t,i){n(306).EventHandlerManager.get_instance().registerRawEventHandler(t,e,i)},e.removeHandler=function(e,t,i){n(306).EventHandlerManager.get_instance().unregisterRawEventHandler(t,e,i)},e.registerEventsToBeIgnored=function(t,i){n(306).EventHandlerManager.get_instance().initializeListForElement(i,t,0,(function(t,n,i){return i.rawEvent[e.markerFieldForEventsToBeIgnored]=!0,!1}))},e.removeAllHandlers=function(e){$clearHandlers(e)},e.cancelEventNoPreventDefault=function(t){e.cancelEventInternal(t,!1)},e.cancelEvent=function(t){e.cancelEventInternal(t,!0)},e.cancelEventInternal=function(t,n){if(t.stopPropagation(),n&&t.preventDefault(),t.rawEvent&&t.rawEvent.keyCode)try{t.rawEvent.keyCode=0}catch(e){}Array.contains(r.d.get_keyTypedEvents(),t.type)&&e._eventSource.raiseEvent("InputCancelled")},e.eventLandedBeyondSourceElement=function(e){var t=e.rawEvent,n=i.a.getSourceElement(e);if(!n.ownerDocument)return!1;if(Sys.UI.DomElement.containsCssClass(n,"ignore-scroll-bounds-check"))return!1;var r=!1,a=n.clientWidth,s=n.clientHeight;if(a&&s){if(a===n.offsetWidth&&s===n.offsetHeight)return!1;var l=o.g.getElementBounds(n),u=new Sys.UI.Bounds(l.x,l.y,a,s);if(o.g.isBoundsEqual(l,u))return!1;var c=new Sys.UI.Point(t.clientX,t.clientY);r=!o.g.isPointInBounds(u,c)}return r},e.markerFieldForEventsToBeIgnored="shouldBeIgnoredByMsospHandlers",e._refCount=0,e._ensureAppAwakeIfAsleepCallback=null,e._ensureAppAwakeCallback=null,e._eventSource=new a.f,e.cancelEventHandler=e.cancelEvent,e}();(0,s.l)(l,"InputManager",null,[Sys.IDisposable])},,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IBusinessBarEntry"),o=n(809),a=n(255),s=n(614),l=n(254),u=n(196),c=n(973),p=n(574),d=n(66),h=n(124),g=n(806),m=function(){return function(){this.message=null,this.messageTitle=null,this.firstActionButtonProps=null,this.secondActionButtonProps=null,this.isMultiline=!1,this.messageBarType=0,this.closeable=!1,this.onDismiss=null,this.dismissButtonAriaLabel=null}}();(0,i.l)(m,"MessageBarProps",null,[]);var _=n(0),f=n(55),y=n(573),v=n(460),S=n(134);n.d(t,{l:function(){return C}});var C=function(){function e(e,t,n){this._title=null,this._message=null,this._invokeHandler=null,this._containerDomID=null,this._closeable=!1,this._imagePath=null,this._imageAltText="",this._errorCode=0,this._image=0,this._htmlElement=null,this._imageHolder=null,this._titleParagraph=null,this._bodyParagraph=null,this._titleAndBodyHolder=null,this._buttonOne=null,this._buttonOneHolder=null,this._buttonTwo=null,this._buttonTwoHolder=null,this._linkHolder=null,this._link=null,this._closeIconHolder=null,this._closeAnchor=null,this._closeIconElement=null,this._closeHandler=null,this._buttonOneUsed=!1,this._buttonTwoUsed=!1,this._buttonOneText="",this._buttonOneScreenReaderText="",this._buttonOneDismissesEntry=!1,this._buttonTwoText="",this._buttonTwoScreenReaderText="",this._buttonTwoDismissesEntry=!1,this._buttonOneHandler=null,this._buttonTwoHandler=null,this._linkUsed=!1,this._linkText="",this._linkHref="",this._linkHandler=null,this._invokeWithContextMenu=!1,this._isContextMenuHandlerSet=!1,this._reactMessageBarAPI=null,this.$$pf_BusinessBar=null,this.$$pf_Id=0,this.visible=!1,this.set_title(e),this.set_message(t),this.set_invokeHandler(n),this.set_id(0),this.set_image(1)}return e.prototype.get_businessBar=function(){return this.$$pf_BusinessBar},e.prototype.set_businessBar=function(e){return this.$$pf_BusinessBar=e,e},e.prototype.get_id=function(){return this.$$pf_Id},e.prototype.set_id=function(e){return this.$$pf_Id=e,e},e.prototype.get_htmlElement=function(){return this._htmlElement},e.prototype.get_title=function(){return this._title},e.prototype.set_title=function(e){return this._title!==e&&(this._title=e,this._titleParagraph&&(this._titleParagraph.innerText=this._title)),e},e.prototype.get_message=function(){return this._message},e.prototype.set_message=function(e){return this._message!==e&&(this._message=e,this._bodyParagraph&&(this._bodyParagraph.innerText=this._message)),e},e.prototype.get_invokeHandler=function(){return this._invokeHandler},e.prototype.set_invokeHandler=function(e){return this._invokeHandler=e,e},e.prototype.get_image=function(){return this._image},e.prototype.set_image=function(e){return this._image=e,4!==this._image&&this.set_imagePath(""),e},e.prototype.get_imagePath=function(){return this._imagePath},e.prototype.set_imagePath=function(e){return this._imagePath=e,e},e.prototype.get_imageAltText=function(){return this._imageAltText},e.prototype.set_imageAltText=function(e){return this._imageAltText=e,e},e.prototype.get_closeHandler=function(){return this._closeHandler},e.prototype.set_closeHandler=function(e){return this._closeHandler=e,e},e.prototype.get_closeable=function(){return this._closeable},e.prototype.set_closeable=function(e){return this._closeable!==e&&(this._closeable=e,this._closeIconHolder&&(this._closeIconHolder.style.display=this._closeable?"table-cell":"none")),e},e.prototype.get_reactBusinessBarIsEnabled=function(){return l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactBusinessBarIsEnabled")&&!this._linkUsed},e.prototype.get_containerID=function(){return this._containerDomID},e.prototype.set_containerID=function(e){return this._containerDomID=e,e},e.prototype.get_errorCode=function(){return this._errorCode},e.prototype.set_errorCode=function(e){return this._errorCode=e,e},e.prototype.get_invokeActionIsContextMenu=function(){return this._invokeWithContextMenu},e.prototype.set_invokeActionIsContextMenu=function(e){return this._invokeWithContextMenu=e,this._htmlElement?(this._invokeWithContextMenu&&!this._isContextMenuHandlerSet?(l.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().registerHandler(this._htmlElement,i.i(this,this.onClick,"onClick"),null),this._isContextMenuHandlerSet=!0):!this._invokeWithContextMenu&&this._isContextMenuHandlerSet&&(l.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().unregisterHandler(this._htmlElement,i.i(this,this.onClick,"onClick")),this._isContextMenuHandlerSet=!1),e):e},e.prototype.get_getPointForContextMenu=function(){var e=Sys.UI.DomElement.getBounds(this._htmlElement);return new Sys.UI.Point(e.x,e.y)},e.prototype.addButton=function(e,t,n,i){void 0===i&&(i=!1),this._buttonOneText=e,this._buttonOneHandler=t,this._buttonOneUsed=!0,this._buttonOneScreenReaderText=n,this._buttonOneDismissesEntry=i},e.prototype.addSecondButton=function(e,t,n,i){void 0===i&&(i=!1),this._buttonTwoText=e,this._buttonTwoHandler=t,this._buttonTwoUsed=!0,this._buttonTwoScreenReaderText=n,this._buttonTwoDismissesEntry=i},e.prototype.addLink=function(e,t){this._linkText=e,this._linkHref=t,this._linkUsed=!0},e.prototype.addLinkWithHandler=function(e,t){this._linkText=e,this._linkHandler=t,this._linkUsed=!0},e.prototype.createReactEntryElement=function(){var t=this;this._htmlElement=document.createElement("div"),this._htmlElement.className=String.format("{0} {1}",e._businessBarClass,e._reactBusinessBarClass),this._htmlElement.setAttribute("UNSELECTABLE","on"),void 0!==this._containerDomID&&null!==this._containerDomID&&(this._htmlElement.id=this._containerDomID);var n=this;return u.r.get_instance().executeWhen(7,(function(){f.UISurfaces.getMessageBarAPIAsync().then((function(e){t.get_businessBar().get_isReactBusinessBarStoreInitialized()||(e.initializeMessageBarInStore(),t.get_businessBar().set_isReactBusinessBarStoreInitialized(!0));var i=(0,o.m)(new m,{message:t._message,messageTitle:t._title,isMultiline:!1,messageBarType:5});return t._closeable&&(i.onDismiss=function(){t.closeReactBusinessBar(n)}),t._buttonOneUsed&&(i.firstActionButtonProps=new _.g(t._buttonOneText,(function(){t.buttonOneReactClickHandler(n)}))),t._buttonTwoUsed&&(i.secondActionButtonProps=new _.g(t._buttonTwoText,(function(){t.buttonTwoReactClickHandler(n)}))),e.createNewMessageBar(t._htmlElement,i),t._reactMessageBarAPI=e,null})).catch((function(e){return a.ULS.sendTraceTag(595096981,324,10,"Failed to load React Message Bar API"),null}))})),this._htmlElement},e.prototype.createElement=function(){if(this.get_reactBusinessBarIsEnabled())return this.createReactEntryElement();if(this._htmlElement=document.createElement("div"),this._htmlElement.className=e._businessBarClass,this._htmlElement.setAttribute("UNSELECTABLE","on"),void 0!==this._containerDomID&&null!==this._containerDomID&&(this._htmlElement.id=this._containerDomID),this._imageHolder=null,this._image){this._imageHolder=document.createElement("span"),this._imageHolder.className="WACBusinessBarIcon",this._htmlElement.appendChild(this._imageHolder);var t=null,n=null;switch(this._image){case 2:t=e._errorIconName,n=CommonUIStrings.l_DialogError;break;case 1:t=e._warningIconName,n=CommonUIStrings.l_DialogWarning;break;case 3:t=e._infoIconName,n=CommonUIStrings.l_DialogInfo;break;case 4:t=this._imagePath,n=this._imageAltText}this._imageHolder.title=n,this._imageHolder.setAttribute(S.t.ariaRoleAttribute,S.t.ariaImageRole),this._imageHolder.appendChild(c.createClusteredImage(24,24,t,e._imageClass,!0,""))}var r=v.l.create().toString();this._titleAndBodyHolder=document.createElement("div"),this._titleAndBodyHolder.id="BBTitleAndBody"+r,this._titleAndBodyHolder.className=e._businessBarTitleBodyHolderClass,this._titleAndBodyHolder.tabIndex=0,this._titleAndBodyHolder.setAttribute(S.t.ariaRoleAttribute,S.t.ariaGroupRole),this._title&&(this._titleParagraph=document.createElement("p"),this._titleParagraph.innerText=this._title,this._titleParagraph.className=e._businessBarTitleClass+" UIFontBold",this._titleParagraph.id="BBTitle"+r,this._titleParagraph.setAttribute("UNSELECTABLE","on"),this._titleAndBodyHolder.setAttribute(S.t.ariaLabelledByAttribute,this._titleParagraph.id),this._titleAndBodyHolder.appendChild(this._titleParagraph)),this._bodyParagraph=document.createElement("p"),this._bodyParagraph.className=e._businessBarBodyClass,this._bodyParagraph.innerText=this._message,this._bodyParagraph.id="BBBody"+r,this._bodyParagraph.setAttribute("UNSELECTABLE","on"),this._bodyParagraph.style.width="100%",this._titleAndBodyHolder.setAttribute(S.t.ariaDescribedByAttribute,this._bodyParagraph.id),this._buttonOneUsed&&this.addContentAvailableOnlyToScreenReader(this._bodyParagraph,this._buttonOneScreenReaderText),this._buttonTwoUsed&&this.addContentAvailableOnlyToScreenReader(this._bodyParagraph,this._buttonTwoScreenReaderText),this._titleAndBodyHolder.appendChild(this._bodyParagraph);var o=document.createElement("div");return o.setAttribute(S.t.ariaRoleAttribute,S.t.ariaAlertRole),o.appendChild(this._titleAndBodyHolder),this._htmlElement.appendChild(o),this._buttonOneUsed&&(this._buttonOneHolder=document.createElement("span"),this._buttonOne=document.createElement("button"),this.createButton(this._buttonOneHolder,this._buttonOne,this._buttonOneText,i.i(this,this.buttonOneClickHandler,"buttonOneClickHandler"))),this._buttonTwoUsed&&(this._buttonTwoHolder=document.createElement("span"),this._buttonTwo=document.createElement("button"),this.createButton(this._buttonTwoHolder,this._buttonTwo,this._buttonTwoText,i.i(this,this.buttonTwoClickHandler,"buttonTwoClickHandler"))),this._linkUsed&&(this._linkHolder=document.createElement("span"),this._linkHolder.className=e._businessBarLinkHolderClass,this._link=document.createElement("a"),this._link.className=y.t._businessBarLinkClass,this._link.innerText=this._linkText,this._linkHandler?(this._link.tabIndex=0,l.AFrameworkApplication.get_activeFrame().get_theClickInputManager().registerHandlerWithData(p.d.click,this._link,i.i(this,this.linkClickHandler,"linkClickHandler"),this),l.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().registerHandlerWithData(p.d.keyUp,this._link,i.i(this,this.onLinkKeyUp,"onLinkKeyUp"),this)):(this._link.href=this._linkHref,this._link.target="_blank"),this._linkHolder.appendChild(this._link),this._htmlElement.appendChild(this._linkHolder)),l.AFrameworkApplication.get_activeFrame().get_theClickInputManager().registerHandler(p.d.click,this._htmlElement,i.i(this,this.onClick,"onClick")),l.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().registerHandlerWithData(p.d.keyUp,this._titleAndBodyHolder,i.i(this,this.onBodyKeyUp,"onBodyKeyUp"),this),this._invokeWithContextMenu&&!this._isContextMenuHandlerSet&&(l.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().registerHandler(this._htmlElement,i.i(this,this.onClick,"onClick"),null),this._isContextMenuHandlerSet=!0),this._closeable&&(this._closeIconHolder=document.createElement("span"),this._closeIconHolder.className=e._closeHolderClass,this._closeAnchor=document.createElement("a"),this._closeAnchor.className=e._closeIconClass,this._closeAnchor.tabIndex=0,this._closeAnchor.title=CommonUIStrings.l_DialogClose,this._closeAnchor.setAttribute(S.t.ariaRoleAttribute,S.t.ariaButtonRole),this._closeIconElement=c.createClusteredImage(16,16,e._closeIconFileName,"",!0,""),this._closeAnchor.appendChild(this._closeIconElement),this._closeIconHolder.style.display="table-cell",this._closeIconHolder.appendChild(this._closeAnchor),this._htmlElement.appendChild(this._closeIconHolder),l.AFrameworkApplication.get_activeFrame().get_theClickInputManager().registerHandlerWithData(p.d.click,this._closeAnchor,i.i(this,this.onCloseClick,"onCloseClick"),this),l.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().registerHandlerWithData(p.d.keyUp,this._closeAnchor,i.i(this,this.onCloseKeyUp,"onCloseKeyUp"),this)),this._htmlElement},e.prototype.showEntryForScreenReader=function(){this._titleAndBodyHolder&&this._titleAndBodyHolder.setAttribute(S.t.ariaHiddenAttribute,S.t.ariaFalseValue)},e.prototype.addContentAvailableOnlyToScreenReader=function(t,n){var i;n&&""!==n&&((i=document.createElement("span")).className=e._screenReaderOnlyClass,i.innerText=n,t.appendChild(i))},e.prototype.createButton=function(t,n,i,r){t.className=e._businessBarButtonHolderClass,n.setAttribute("type","button"),n.className=e._businessBarButtonClass,n.innerText=i,t.appendChild(n),this._htmlElement.appendChild(t),l.AFrameworkApplication.get_activeFrame().get_theClickInputManager().registerHandlerWithData(p.d.click,n,r,this)},e.prototype.resizeToFit=function(){this.get_reactBusinessBarIsEnabled()||(this._titleAndBodyHolder.style.whiteSpace="nowrap",this.get_closeable()?this._closeIconHolder.style.width="auto":this._linkUsed?this._linkHolder.style.width="auto":this._buttonTwoUsed?this._buttonTwoHolder.style.width="auto":this._buttonOneUsed?this._buttonOneHolder.style.width="auto":this._titleAndBodyHolder.style.width="auto",this._htmlElement.clientWidth>this.get_businessBar().get_htmlElement().clientWidth?this._titleAndBodyHolder.style.whiteSpace="normal":this.get_closeable()?this._closeIconHolder.style.width="100%":this._linkUsed?this._linkHolder.style.width="100%":this._buttonTwoUsed?this._buttonTwoHolder.style.width="100%":this._buttonOneUsed?this._buttonOneHolder.style.width="100%":this._titleAndBodyHolder.style.width="100%")},e.prototype.ulsLogTelemetryInfo=function(e,t){if(g.j.oldActionsPipelineIsEnabled()){var n={};n.WacSessionId=l.AFrameworkApplication.userSessionId,n.ActionName="BusinessBar"+e,n.InputMethod=t,a.ULS.sendTraceTag(35489761,207,50,JSON.stringify(n))}},e.prototype.logTelemetryInfo=function(e,t,n,i){this.ulsLogTelemetryInfo(e,n),g.j.isUserActionLoggingToOtelEnabled()&&h.b(t,!0,h.u,i,10)},e.prototype.buttonOneClickHandler=function(e){return this._buttonOneHandler(e.userData),this.logTelemetryInfo("ButtonOne",s.uC,"Mouse",2),this._buttonOneDismissesEntry&&(this.logTelemetryInfo("Close",s.nm,"Mouse_ButtonOne",2),this.close(e)),!0},e.prototype.buttonOneReactClickHandler=function(e){return this._buttonOneHandler(e),this.logTelemetryInfo("ButtonOne",s.uC,"Mouse",2),this._buttonOneDismissesEntry&&(this.logTelemetryInfo("Close",s.nm,"Mouse_ButtonOne",2),this.closeReactBusinessBar(e)),!0},e.prototype.buttonTwoClickHandler=function(e){return this._buttonTwoHandler(e.userData),this.logTelemetryInfo("ButtonTwo",s.XJ,"Mouse",2),this._buttonTwoDismissesEntry&&(this.logTelemetryInfo("Close",s.nm,"Mouse_ButtonTwo",2),this.close(e)),!0},e.prototype.buttonTwoReactClickHandler=function(e){return this._buttonTwoHandler(e),this.logTelemetryInfo("ButtonTwo",s.XJ,"Mouse",2),this._buttonTwoDismissesEntry&&(this.logTelemetryInfo("Close",s.nm,"Mouse_ButtonTwo",2),this.closeReactBusinessBar(e)),!0},e.prototype.linkClickHandler=function(e){return this._linkHandler(e.userData),this.logTelemetryInfo("Link",s.zG,"Mouse",2),!0},e.prototype.onLinkKeyUp=function(e){return e.innerEvent.keyCode===d.v.vK_Enter&&!e.innerEvent.altKey&&(this._linkHandler(e.userData),this.logTelemetryInfo("Link",s.zG,"Keyboard",1),!0)},e.prototype.onBodyKeyUp=function(e){return!(e.innerEvent.keyCode!==d.v.vK_Enter||e.innerEvent.altKey||!this._invokeHandler)&&(this._invokeHandler(e.userData,e),this.logTelemetryInfo("Invoke",s.H,"Keyboard",1),!0)},e.prototype.dispose=function(){this._htmlElement&&(l.AFrameworkApplication.get_activeFrame().get_theClickInputManager().unregisterHandler(p.d.click,this._htmlElement,i.i(this,this.onClick,"onClick")),this._isContextMenuHandlerSet&&l.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().unregisterHandler(this._htmlElement,i.i(this,this.onClick,"onClick"))),this._closeAnchor&&(l.AFrameworkApplication.get_activeFrame().get_theClickInputManager().unregisterHandler(p.d.click,this._closeAnchor,i.i(this,this.onCloseClick,"onCloseClick")),l.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().unregisterHandler(p.d.keyUp,this._closeAnchor,i.i(this,this.onCloseKeyUp,"onCloseKeyUp"))),this._buttonOne&&l.AFrameworkApplication.get_activeFrame().get_theClickInputManager().unregisterHandler(p.d.click,this._buttonOne,i.i(this,this.buttonOneClickHandler,"buttonOneClickHandler")),this._buttonTwo&&l.AFrameworkApplication.get_activeFrame().get_theClickInputManager().unregisterHandler(p.d.click,this._buttonTwo,i.i(this,this.buttonTwoClickHandler,"buttonTwoClickHandler")),this._link&&this._linkHandler&&(l.AFrameworkApplication.get_activeFrame().get_theClickInputManager().unregisterHandler(p.d.click,this._link,i.i(this,this.linkClickHandler,"linkClickHandler")),l.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().unregisterHandler(p.d.keyUp,this._link,i.i(this,this.onLinkKeyUp,"onLinkKeyUp"))),this._titleAndBodyHolder&&l.AFrameworkApplication.get_activeFrame().get_theKeyInputManager().unregisterHandler(p.d.keyUp,this._titleAndBodyHolder,i.i(this,this.onBodyKeyUp,"onBodyKeyUp")),this._imageAltText=null,this._imageHolder=null,this._titleParagraph=null,this._htmlElement=null,this._bodyParagraph=null,this._titleAndBodyHolder=null,this._buttonOne=null,this._buttonOneHolder=null,this._buttonTwo=null,this._buttonTwoHolder=null,this._link=null,this._linkHolder=null,this._closeIconElement=null,this._closeIconHolder=null,this._closeAnchor=null,this.set_businessBar(null)},e.prototype.onClick=function(e){return this.logTelemetryInfo("Invoke",s.H,"Mouse",2),!!this.get_invokeHandler()&&this.get_invokeHandler()(this,e)},e.prototype.onCloseClick=function(e){return this.logTelemetryInfo("Close",s.nm,"Mouse",2),this.close(e),!0},e.prototype.onCloseKeyUp=function(e){return e.innerEvent.keyCode===d.v.vK_Enter&&!e.innerEvent.altKey&&(this.logTelemetryInfo("Close",s.nm,"Keyboard",1),this.close(e),!0)},e.prototype.close=function(e){var t=e.userData;this.get_businessBar().removeEntry(t),this.invokeCloseHandler(t,e.get_inputSource())},e.prototype.invokeCloseHandler=function(e,t){if(e.get_closeHandler()){var n=l.AFrameworkApplication.get_theActionManager();n.set_commandLocation(10),n.set_invocationMethod(t),e.get_closeHandler()(e),n.set_commandLocation(0),n.set_invocationMethod(0)}},e.prototype.closeReactBusinessBar=function(e){e&&(this.get_businessBar().removeEntry(e),this.invokeCloseHandler(e,0))},e._businessBarClass="WACBusinessBarEntry",e._businessBarTitleClass="WACBusinessBarTitle",e._businessBarBodyClass="WACBusinessBarBody",e._businessBarTitleBodyHolderClass="WACBusinessBarTitleBodyHolder",e._businessBarButtonHolderClass="WACBusinessBarButtonHolder",e._businessBarButtonClass="WACBusinessBarButton",e._businessBarLinkHolderClass="WACBusinessBarLinkHolder",e._closeIconClass="WACBusinessBarClose",e._closeHolderClass="WACBusinessBarCloseHolder",e._closeIconFileName="BusinessBarClose_16x16x32",e._imageClass="WACBusinessBarImage",e._screenReaderOnlyClass="WACScreenReaderOnly",e._errorIconName="CancelRequest_24x24x32",e._warningIconName="Risks_24x24x32",e._infoIconName="Info_24x24x32",e._reactBusinessBarClass="ReactBusinessBarEntry",e._margin=30,e.linkMargin=20,e}();(0,i.l)(C,"BusinessBarEntry",null,[r,Sys.IDisposable])},function(e,t,n){"use strict";var i=n(809),r=n(255),o=n(208),a=function(){return function(){this.ScreenWidth=0,this.ScreenHeight=0,this.WinInnerWidth=0,this.WinInnerHeight=0,this.WinOuterHeight=0,this.WinOuterWidth=0,this.WinDevicePixelRatio=0,this.CalculatedDevicePixelRatio=0,this.ScreenDeviceXdpi=0,this.ScreenDeviceYdpi=0,this.ScreenLogicalXdpi=0,this.ScreenLogicalYdpi=0,this.ScreenAvailHeight=0,this.ScreenAvailWidth=0,this.DocElemOffsetWidth=0,this.DocElemOffsetHeight=0,this.DocElemClientWidth=0,this.DocElemClientHeight=0,this.WinOrientation=0,this.SupportsTouch=!1,this.NavPlugins=null,this.NavUserAgent=null,this.NavPlatform=null,this.NavAppName=null,this.NavAppVersion=null,this.NavLanguage=null,this.Error=null}}();(0,o.l)(a,"BrowserInfo",null,[]);var s=function(){return function(){this.Name=null,this.Version=null}}();(0,o.l)(s,"PluginInfo",null,[]);var l=n(254),u=n(425);n.d(t,{p:function(){return c},k:function(){return h}});var c=function(){if(l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LogBrowserInfoIsEnabled")){var e=d();try{var t=JSON.stringify(e);r.ULS.sendTraceTag(6903563,102,50,t)}catch(e){r.ULS.sendTraceTag(6903564,102,15,e.message)}}else r.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")},p=function(){var e=window.navigator.plugins;if(!e||!e.length)return null;for(var t=new Array(0),n=0;n<e.length;n++){var r=e[n].name,o=e[n].version;Array.add(t,(0,i.m)(new s,{Name:r,Version:o}))}return t},d=function(){var e=new a,t=new Sys.StringBuilder;return g(Number,(function(t){e.DocElemClientHeight=t}),(function(){return document.documentElement.clientHeight}),t),g(Number,(function(t){e.DocElemClientWidth=t}),(function(){return document.documentElement.clientWidth}),t),g(Number,(function(t){e.DocElemOffsetHeight=t}),(function(){return document.documentElement.offsetHeight}),t),g(Number,(function(t){e.DocElemOffsetWidth=t}),(function(){return document.documentElement.offsetWidth}),t),g(Number,(function(t){e.ScreenAvailHeight=t}),(function(){return window.screen.availHeight}),t),g(Number,(function(t){e.ScreenAvailWidth=t}),(function(){return window.screen.availWidth}),t),g(Number,(function(t){e.ScreenWidth=t}),(function(){return window.screen.width}),t),g(Number,(function(t){e.ScreenHeight=t}),(function(){return window.screen.height}),t),g(Number,(function(t){e.ScreenLogicalXdpi=t}),(function(){return window.screen.logicalXDPI}),t),g(Number,(function(t){e.ScreenLogicalYdpi=t}),(function(){return window.screen.logicalYDPI}),t),g(Number,(function(t){e.ScreenDeviceXdpi=t}),(function(){return window.screen.deviceXDPI}),t),g(Number,(function(t){e.ScreenDeviceYdpi=t}),(function(){return window.screen.deviceYDPI}),t),g(Number,(function(t){e.WinInnerHeight=t}),(function(){return window.self.innerHeight}),t),g(Number,(function(t){e.WinInnerWidth=t}),(function(){return window.self.innerWidth}),t),g(Number,(function(t){e.WinOuterHeight=t}),(function(){return window.self.outerHeight}),t),g(Number,(function(t){e.WinOuterWidth=t}),(function(){return window.self.outerWidth}),t),g(Number,(function(t){e.WinOrientation=t}),(function(){return window.self.orientation}),t),g(Number,(function(t){e.WinDevicePixelRatio=t}),(function(){return window.self.devicePixelRatio}),t),g(Boolean,(function(t){e.SupportsTouch=t}),(function(){return u.y.get_supportsTouch()}),t),g(String,(function(t){e.NavAppName=t}),(function(){return window.navigator.appName}),t),g(String,(function(t){e.NavAppVersion=t}),(function(){return window.navigator.appVersion}),t),g(String,(function(t){e.NavLanguage=t}),(function(){return window.navigator.browserLanguage||window.navigator.language}),t),g(String,(function(t){e.NavUserAgent=t}),(function(){return window.navigator.userAgent}),t),g(String,(function(t){e.NavPlatform=t}),(function(){return window.navigator.platform}),t),g(Array,(function(t){e.NavPlugins=t}),p,t),g(Number,(function(t){e.CalculatedDevicePixelRatio=t}),(function(){return h()}),t),e.Error=t.toString(),e},h=function(){var e=window.devicePixelRatio;return isNaN(e)?window.screen.deviceXDPI/window.screen.logicalXDPI:e},g=function(e,t,n,i){try{t(n())}catch(e){i.isEmpty()||i.append(" | "),i.append(e.message||"null")}}},function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=n(267),a=n(254),s=n(154),l=n(134),u=n(176),c=n(427),p=n(574),d=n(749),h=n(951),g=n(899),m=n(513),_=n(946),f=function(e){function t(t,n,i){var r=e.call(this,t,n,i,"")||this;return r._elmTitleA=null,r._elmTitleSpan=null,r._elmIconContainer=null,r._elmImage=null,r._elmBody=null,r.arrowCollapsedImage=null,r.arrowCollapsedImageClass=null,r.arrowExpandedImage=null,r.arrowExpandedImageClass=null,r.isCollapsed=!1,r.arrowCollapsedImage=t.get_properties().ImageCollapsedArrow,r.arrowCollapsedImageClass=t.get_properties().ImageCollapsedArrowClass,r.arrowExpandedImage=t.get_properties().ImageExpandedArrow,r.arrowExpandedImageClass=t.get_properties().ImageExpandedArrowClass,r.set_isCollapsed(!0),r}return(0,i.t)(t,e),t.prototype.get_arrowCollapsedImage=function(){return this.arrowCollapsedImage},t.prototype.get_arrowCollapsedImageClass=function(){return this.arrowCollapsedImageClass},t.prototype.get_arrowExpandedImage=function(){return this.arrowExpandedImage},t.prototype.get_arrowExpandedImageClass=function(){return this.arrowExpandedImageClass},t.prototype.get_isCollapsed=function(){return this.isCollapsed},t.prototype.set_isCollapsed=function(e){return this.isCollapsed=e,e},t.prototype.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.ensureTitleRefreshed(),this._elmBody=_.n.createElement("div"),this._elmBody.id=this.get_id()+"-Body",this._elmBody.className="cui-cs-body",this._elmBody.style.display=this.get_isCollapsed()?"none":"block",this.get_elementInternal().appendChild(this._elmBody),this.appendChildrenToElement(this._elmBody),this.ensureDOMElement(),this.set_dirty(!1)},t.prototype.attachTitleEvents=function(){d.KeyInputManager.get_instance().registerHandler(p.d.keyUp,this._elmTitleA,r.i(this,this.onTitleKeyUp,"onTitleKeyUp")),c.s.get_instance().registerHandler(p.d.click,this._elmTitleA,r.i(this,this.onTitleClick,"onTitleClick"))},t.prototype.ensureTitleRefreshed=function(){if(m.x(this._elmTitleA)){this._elmTitleA=_.n.createElement("a"),this._elmTitleA.id=this.get_id()+"-Title",this._elmTitleA.className="cui-cs-title cui-ctl-medium UIFontBold stretchedHorizontally",this._elmTitleA.setAttribute(l.t.ariaRoleAttribute,l.t.ariaButtonRole),this._elmTitleA.setAttribute(l.t.ariaDisabledAttribute,l.t.ariaFalseValue),this._elmTitleA.setAttribute("mscui:controltype",h.Control.buttonControlType),this._elmTitleA.tabIndex=0,this._elmImage=_.n.createElement("img"),this._elmImage.alt="";var e=this.get_isCollapsed()?this.get_arrowCollapsedImage():this.get_arrowExpandedImage(),t=this.get_isCollapsed()?this.get_arrowCollapsedImageClass():this.get_arrowExpandedImageClass(),n=_.n.createClusteredImageContainerNew(4,e,t,this._elmImage,!0,!1);this._elmIconContainer=_.n.createElement("span"),this._elmIconContainer.className="cui-ctl-iconContainer",this._elmIconContainer.appendChild(n),this._elmTitleA.appendChild(this._elmIconContainer),this._elmTitleSpan=_.n.createElement("span"),this._elmTitleSpan.className="cui-ctl-mediumlabel",this._elmTitleSpan.innerText=this.get_title(),this._elmTitleA.appendChild(this._elmTitleSpan),this.get_elementInternal().appendChild(this._elmTitleA),this.attachTitleEvents()}},t.prototype.get_cssClass=function(){return"cui-cs"},t.prototype.get_domElementTagName=function(){return"div"},t.prototype.ensureCorrectChildType=function(e){if(!r.r(g.l,e))throw Error.create("Only children of type section can be added this Group")},t.prototype.onTitleKeyUp=function(e){var t=!1;if(!m.x(e.innerEvent)){var n=e.innerEvent.keyCode;n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||(this.doTitleDefaultAction(1),t=!0)}return t},t.prototype.onTitleClick=function(e){return this.doTitleDefaultAction(e.get_inputSource()),!0},t.prototype.doTitleDefaultAction=function(e){this.set_isCollapsed(!this.get_isCollapsed()),this._elmBody.style.display=this.get_isCollapsed()?"none":"block",this._elmImage.src=this.get_isCollapsed()?this.get_arrowCollapsedImage():this.get_arrowExpandedImage(),this._elmImage.className=this.get_isCollapsed()?this.get_arrowCollapsedImageClass():this.get_arrowExpandedImageClass(),this.get_root().pollForStateAndUpdate()},t}(o.s);(0,r.l)(f,"CollapsibleSection",o.s,[]);var y=n(696);n.d(t,{Group:function(){return v}});var v=function(e){function t(t,n,i,r,o,a,s,l,u,c,p){void 0===c&&(c=!1),void 0===p&&(p=null);var d=e.call(this,t,n,i,r,null,!u||!u.Visible||Boolean.parse(u.Visible))||this;return d._elmBody=null,d._elmGroupContainer=null,d._elmTitle=null,d._elmSeparator=null,d._elmDialogLauncher=null,d._dialogLauncherComponent=null,d._usesLayouts=!1,d._showseparator=!0,d._isTouchGroup=!1,d._isStretched=!1,d._minHeight=null,d._selectedLayout=null,d._properties=null,d._hideLauncherButton=!1,d._command=null,d._isTouchGroup=s,d._command=o,d._usesLayouts=a,d._isStretched=l,d._minHeight=p,d._properties=u,d._hideLauncherButton=c,d}return(0,i.t)(t,e),t.prototype.get_properties=function(){return this._properties},t.prototype.get_displaySeparator=function(){return this._showseparator},t.prototype.set_displaySeparator=function(e){return this._showseparator=e,m.x(this._elmSeparator)||(this._elmSeparator.style.display=this._showseparator?"":"none"),e},t.prototype.get_hasElementDialogLauncherComponent=function(){return!!this._dialogLauncherComponent},t.prototype.get_elementDialogLauncherComponent=function(){return this._dialogLauncherComponent},t.prototype.get_isTouchGroup=function(){return this._isTouchGroup},t.prototype.set_isTouchGroup=function(e){return this._isTouchGroup=e,e},t.prototype.get_bodyElement=function(){return this._elmBody},t.prototype.get_titleDOMElement=function(){return this._elmTitle},t.prototype.createDialogLauncherComponent=function(){var e={};e.Command=this._properties.DialogLauncherButtonCommand,e.Image16by16=this._properties.ImageDialogLauncherButton,e.Image16by16Class=this._properties.ImageDialogLauncherButtonClass,e.Alt=this._properties.DialogLauncherButtonTooltip,e.Keytip=this._properties.Keytip;var n=new u.d(this.get_root(),t.getLauncherButtonId(this.get_id()),e).createComponentForDisplayMode("Small");return _.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-dialogLauncherButton"),n},t.prototype.tryInsertDialogLauncherButton=function(e,t){e.appendChild(t),s.g.leftBoundsOverlapsRightBounds(s.g.getElementBounds(this._elmTitle),s.g.getElementBounds(t),a.AFrameworkApplication.get_isRtl())&&e.removeChild(t)},t.prototype.refreshInternal=function(){if(this.ensureDOMElementAndEmpty(),this._usesLayouts){m.x(this._elmTitle)?(this._elmTitle=_.n.createElement("span"),this._elmTitle.className="cui-groupTitle UISmallFont",this._elmTitle.id=this.get_id()+"-title",l.t.setAriaAttribute(this._elmTitle,"aria-hidden","true")):this._elmTitle=_.n.removeChildNodes(this._elmTitle);var t=this.get_title();m.x(t)||(this._elmTitle.innerText=t),this._elmDialogLauncher||!this._properties.DialogLauncherButtonCommand||this._hideLauncherButton||(this._dialogLauncherComponent=this.createDialogLauncherComponent(),this._elmDialogLauncher=this._dialogLauncherComponent.get_elementInternal(),this.addChild(this._dialogLauncherComponent))}m.x(this._elmBody)?(this._elmBody=_.n.createElement("span"),this._elmBody.className="cui-groupBody"):this._elmBody=_.n.removeChildNodes(this._elmBody),m.x(this._elmSeparator)&&this.get_displaySeparator()&&(this._elmSeparator=_.n.createElement("span"),this._elmSeparator.className="cui-groupSeparator"),this._elmGroupContainer=_.n.createElement("span"),this._elmGroupContainer.className="cui-groupContainer",this._elmGroupContainer.appendChild(this._elmBody),this._usesLayouts&&this._elmGroupContainer.appendChild(this._elmTitle),this.get_elementInternal().appendChild(this._elmGroupContainer),this.get_displaySeparator()&&this.get_elementInternal().appendChild(this._elmSeparator),!m.x(this._selectedLayout)&&this._usesLayouts?(this._selectedLayout.ensureDOMElement(),this._elmBody.appendChild(this._selectedLayout.get_elementInternal()),this._selectedLayout.ensureRefreshed(),this._selectedLayout.ensureBehaviorAttached()):this.appendChildrenToElement(this._elmBody),m.x(this._minHeight)||(this.get_elementInternal().style.minHeight=this._minHeight+"px"),e.prototype.refreshInternal.call(this)},t.prototype.onGroupAttachedToRibbon=function(){this._usesLayouts&&this._elmDialogLauncher&&this.tryInsertDialogLauncherButton(this._elmGroupContainer,this._elmDialogLauncher)},t.prototype.ensureDOMElement=function(){e.prototype.ensureDOMElement.call(this);var t=l.t.ariaPresentationRole;this._usesLayouts&&(l.t.setAriaAttribute(this.get_elementInternal(),l.t.ariaLabelledByAttribute,this.get_id()+"-title"),t=l.t.ariaGroupRole),this.get_elementInternal().setAttribute(l.t.ariaRoleAttribute,t)},t.prototype.get_cssClass=function(){var e="cui-group";return this._isStretched&&(e+=" stretched"),e},t.prototype.get_domElementTagName=function(){return"li"},t.prototype.unselectLayout=function(){this.selectLayout(null)},t.prototype.selectLayout=function(e){var t=m.x(e)?null:this.getChildByTitle(e);t===this._selectedLayout||m.x(t)&&m.x(this._selectedLayout)||(this._selectedLayout=m.x(t)?null:t,m.x(t)||t.setDirtyRecursively(!0),this.onDirtyingChange())},t.prototype.get_selectedLayout=function(){return this._selectedLayout},t.prototype.isGroupDialogLauncherButton=function(e){return!!e&&!!e.className&&e.className.indexOf("cui-dialogLauncherButton")>0},t.prototype.ensureCorrectChildType=function(e){if(this._usesLayouts){if(this.isGroupDialogLauncherButton(e.get_elementInternal()))return;if(!r.r(y.g,e))throw Error.create("Only children of type Layout or the dialog launcher button can be added this Group");if(!m.x(this.getChildByTitle(e.get_title())))throw Error.create("A Layout with title "+e.get_title()+" already exists in this Group.")}else if(!r.r(g.l,e)&&!r.r(f,e))throw Error.create("Only children of type Section or CollapsibleSection can be added this Group")},t.prototype.get_command=function(){return this._command},t.prototype.pollForStateAndUpdateInternal=function(){if(m.x(this.get_command()))this.set_enabled(!0);else{var t=this.get_root().pollForCommandState(this.get_command(),null,null);this.set_enabled((1&t)>0)}if(this._usesLayouts){if(this.get_enabled()&&!m.x(this._selectedLayout)&&(this._selectedLayout.pollForStateAndUpdateInternal(),this._dialogLauncherComponent)){t=this.get_root().pollForCommandState(this._properties.DialogLauncherButtonCommand,null,null);this._dialogLauncherComponent.set_enabled((1&t)>0)}}else e.prototype.pollForStateAndUpdateInternal.call(this)},t.prototype.onChildrenVisibleChanged=function(){this._usesLayouts?this.get_selectedLayout()&&this.set_visible(this.get_selectedLayout().get_visible()):e.prototype.onChildrenVisibleChanged.call(this)},t.getLauncherButtonId=function(e){return e+"DialogLauncherButton"},t}(o.s);(0,r.l)(v,"Group",o.s,[])},,function(e,t,n){"use strict";var i=n(600),r=n(800),o=n(255),a=n(208),s=function(){function e(){this._logLevelMapping=null,this._logCategoryMapping=null,this._logLevelMapping={},this._logLevelMapping[1]=10,this._logLevelMapping[2]=15,this._logLevelMapping[3]=50,this._logLevelMapping[4]=100,this._logLevelMapping[5]=200,this._logCategoryMapping={},this._logCategoryMapping[1]=300,this._logCategoryMapping[2]=303,this._logCategoryMapping[3]=304,this._logCategoryMapping[4]=319,this._logCategoryMapping[5]=201,this._logCategoryMapping[6]=370,this._logCategoryMapping[7]=315,this._logCategoryMapping[8]=324}return e.prototype.getLogLevel=function(e){var t;return""+e in this._logLevelMapping?t=this._logLevelMapping[""+e]:(t=200,o.ULS.shipAssertTag(6423762,200,!1,"Failed to find SharedLogLevel: {0}",e)),t},e.prototype.getLogCategory=function(e){var t;return""+e in this._logCategoryMapping?t=this._logCategoryMapping[""+e]:(t=200,o.ULS.shipAssertTag(6423763,200,!1,"Failed to find CommonLogCategory: {0}",e)),t},e.prototype.shouldTrace=function(e,t){var n=this.getLogCategory(e),i=this.getLogLevel(t);return o.ULS.shouldTrace(n,i)},e.prototype.traceTag=function(e,t,n,i){for(var r=[],a=4;a<arguments.length;a++)r[a-4]=arguments[a];var s=this.getLogCategory(t),l=this.getLogLevel(n);o.ULS.sendTraceTag.apply(null,[e,s,l,i].concat(r))},e.prototype.debugAssertTag=function(e,t,n,i){for(var r=[],o=4;o<arguments.length;o++)r[o-4]=arguments[o];this.getLogCategory(t)},e.prototype.shipAssertTag=function(e,t,n,i){for(var r=[],a=4;a<arguments.length;a++)r[a-4]=arguments[a];var s=this.getLogCategory(t);o.ULS.shipAssertTag.apply(null,[e,s,n,i].concat(r))},e.prototype.traceMultiPartMessageTag=function(e,t,n,i,r){r=r||"";var o=3048-i.length;if(o<=0)this.traceTag(e,t,n,i+": "+r);else{var a=Math.ceil(r.length/o);if(a<=1)this.traceTag(e,t,n,i+": "+r);else for(var s=1,l=0,u=o;s<=a;s++,l=u,u+=o){var c=Math.min(r.length,u),p=r.substring(l,c),d=String.format("[{0} of {1}] {2}: {3}",s,a,i,p);this.traceTag(e,t,n,d)}}},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,a.l)(s,"XLog",null,[]),n.d(t,{l:function(){return l}});var l=function(){function e(){}return e.get_linkableProtocolList=function(){return e._linkableProtocolList||(e._linkableProtocolList=["http://","https://","file://","file:\\\\","ftp://",e.mailToProtocol,"news:","notes:","\\\\","www.","onenote:","tel:","mms://","notes://","mssv://",e.bookmarkAnchorPrefix])},e.get_urlKeyValueEncodeReplacements=function(){return e._urlKeyValueEncodeReplacements||(e._urlKeyValueEncodeReplacements=[r.o.createGlobalSearchFindReplacePair("!","%21"),r.o.createGlobalSearchFindReplacePair("'","%27"),r.o.createGlobalSearchFindReplacePair("\\(","%28"),r.o.createGlobalSearchFindReplacePair("\\)","%29"),r.o.createGlobalSearchFindReplacePair("\\*","%2A")])},e.stripIgnoredLinkChars=function(e,t){if(t.val=0,!e)return null;for(var n=e.length;n>t.val&&-1!=="#%&*{}:<>?+.;(),!']\"\u201d".indexOf(e.charAt(n-1));)n--;for(;t.val<n&&-1!=="(['\"\u201c".indexOf(e.charAt(t.val));)t.val++;return e.substr(t.val,n-t.val)},e.isLinkable=function(t){if(!t)return!1;var n;t=e.toLower(t),t=e.stripIgnoredLinkChars(t,(0,i.m)((function(){return n}),(function(e){return n=e})));for(var r=0,o=e.get_linkableProtocolList();r<o.length;r++){var a=o[r];if(e.startsWith(t,a))return!0}return!1},e.isEmail=function(t){return!!t&&t.length<=254&&e._emailRegex.test(t)},e.isWhitespace=function(e){switch(e){case 12288:case 8197:case 32:case 13:case 10:case 65532:case 11:case 9:case 160:return!0}return!1},e.isWhitespaceUnicode=function(e){switch(e){case" ":case"\xa0":case"\u1680":case"\u2000":case"\u2001":case"\u2002":case"\u2003":case"\u2004":case"\u2005":case"\u2006":case"\u2007":case"\u2008":case"\u2009":case"\u200a":case"\u202f":case"\u205f":case"\u3000":return!0}return!1},e.startsWith=function(e,t){return!!e&&!!t&&e.startsWith(t)},e.convertToHex=function(t,n){for(var i=t.toString(16);i.length<n;)i="0"+i;return e.toLower(i)},e.removeSurroundingChar=function(e,t){return e&&e.length>=2&&e.charAt(0)===t&&e.charAt(e.length-1)===t&&(e=e.substr(1,e.length-2)),e},e.encodeString=function(e,t){for(var n=e,i=t.length,r=0;r<i;++r)n=t[r].performReplaceOn(n);return n},e.urlKeyValueEncode=function(t){var n=t;return n=encodeURIComponent(n),n=e.encodeString(n,e.get_urlKeyValueEncodeReplacements())},e.get_romanOnes=function(){return e.romanOnes||(e.romanOnes=["","I","II","III","IV","V","VI","VII","VIII","IX"])},e.get_romanTens=function(){return e.romanTens||(e.romanTens=["","X","XX","XXX","XL","L","LX","LXX","LXXX","XC"])},e.get_romanHundreds=function(){return e.romanHundreds||(e.romanHundreds=["","C","CC","CCC","CD","D","DC","DCC","DCCC","CM"])},e.convertToRoman=function(t,n){void 0===n&&(n=!1);for(var i="";t>=1e3;)i+="M",t-=1e3;var r=e.get_romanHundreds()[Math.floor(t/100)];t%=100;var o=e.get_romanTens()[Math.floor(t/10)];t%=10;var a=e.get_romanOnes()[t],s=String.format("{0}{1}{2}{3}",i,r,o,a);return n&&(s=e.toLower(s)),s},e.redactForLogging=function(e){return null==e?"(null)":"REDACTED:"+e.length},e.convertFromRoman=function(t){t=e.toUpper(t);var n=new RegExp("^[IVXLCDM]+$"),r=t.match(n);if(!r||1!==r.length||r[0]!==t||t.length<1)return-1;for(var o=0,a=0;o<t.length&&"M"===t.charAt(o);)o++;if(o>0){if(a=1e3*o,!(o<t.length))return a;t=t.substr(o)}return o=0,a+=e.convertIndividualPlaceValueFromRoman(e.get_romanHundreds(),t,(0,i.m)((function(){return o}),(function(e){return o=e})),100),o<t.length&&(t=t.substr(o),o=0,a+=e.convertIndividualPlaceValueFromRoman(e.get_romanTens(),t,(0,i.m)((function(){return o}),(function(e){return o=e})),10),o<t.length&&(t=t.substr(o),o=0,a+=e.convertIndividualPlaceValueFromRoman(e.get_romanOnes(),t,(0,i.m)((function(){return o}),(function(e){return o=e})),1))),t.length!==o&&(a=-1),a<1?-1:a},e.convertIndividualPlaceValueFromRoman=function(t,n,i,r){for(var o=t.length-1;o>0;o--)if(e.startsWith(n,t[o]))return i.val+=t[o].length,o*r;return 0},e.convertFromAlpha=function(e){var t=new RegExp("^([a-zA-Z])\\1{0,}$"),n=e.match(t);return!n||n.length<=1||n[0]!==e||e.length<1?-1:26*((e=e.toUpperCase()).length-1)+e.charCodeAt(0)-64},e.convertToAlpha=function(t,n){void 0===n&&(n=!1);var i="";if(t<0)return i;i=e.fromCharCode(t%26+65);var r=Math.floor(t/26);if(r>0)for(var o=i.charAt(0);r>0;)i+=o,r--;return n&&(i=e.toLower(i)),i},e.isAlpha=function(t){var n=t.toString();return e.toLower(n)!==e.toUpper(n)},e.isNumeric=function(e){return"0123456789".indexOf(e)>=0},e.isAlphaNum=function(t){return e.isAlpha(t)||e.isNumeric(t)},e.isLowSurrogateCharAt=function(e,t){return e.charCodeAt(t)>=56320&&e.charCodeAt(t)<=57343},e.isHighSurrogateCharAt=function(e,t){return e.charCodeAt(t)>=55296&&e.charCodeAt(t)<=56319},e.getMinimalDifferenceBoundsAtCp=function(t,n,r,o,a){var s,l,u=!0,c=t.substr(r),p=n.substr(r),d=e.reverseString(c),h=e.reverseString(p);e.getMinimalDifferenceBounds(d,h,(0,i.m)((function(){return s}),(function(e){return s=e})),(0,i.m)((function(){return l}),(function(e){return l=e}))),s<c.length&&s<p.length&&t.charCodeAt(r)===n.charCodeAt(r)&&(u=!1),u?(o.val=r,a.val=s):e.getMinimalDifferenceBounds(t,n,o,a)},e.reverseString=function(e){for(var t="",n=e.length-1;n>=0;n--)t+=e.charAt(n);return t},e.getMinimalDifferenceBounds=function(t,n,i,r){var o,a;if(n=n||"",(t=t||"").length<n.length?(o=t,a=n):(o=n,a=t),a.startsWith(o))i.val=o.length,r.val=0;else if(a.endsWith(o))i.val=0,r.val=o.length;else{var l=void 0;for(l=0;l<t.length&&l<n.length;l++){if(!((u=t.charCodeAt(l))===(c=n.charCodeAt(l))||e.isWhitespace(u)&&e.isWhitespace(c)))break}for(i.val=l,l=0;l<t.length&&l<n.length;l++){var u,c;if(!((u=t.charCodeAt(t.length-l-1))===(c=n.charCodeAt(n.length-l-1))||e.isWhitespace(u)&&e.isWhitespace(c)))break}r.val=l,i.val+r.val>o.length&&(r.val=o.length-i.val)}if(i.val>0){var p=i.val<t.length&&e.isLowSurrogateCharAt(t,i.val),d=i.val<n.length&&e.isLowSurrogateCharAt(n,i.val);(p||d)&&i.val--}if(r.val>1){p=r.val<t.length&&e.isLowSurrogateCharAt(t,t.length-r.val),d=r.val<n.length&&e.isLowSurrogateCharAt(n,n.length-r.val);(p||d)&&r.val--}var h=i.val<t.length&&e.isLowSurrogateCharAt(t,i.val)||i.val<n.length&&e.isLowSurrogateCharAt(n,i.val),g=r.val>0&&(r.val<t.length&&e.isLowSurrogateCharAt(t,t.length-r.val)||r.val<n.length&&e.isLowSurrogateCharAt(n,n.length-r.val));(h||g)&&s.get_instance().traceTag(6961039,5,3,"Consecutive low surrogate chars!")},e.get__lineBreakRegExp=function(){return e._lineBreakRegularExpression||(e._lineBreakRegularExpression=new RegExp("[\r\n]+","g"))},e.get_unwantedCharsRegExp=function(){return e._unwantedCharsRegularExpression||(e._unwantedCharsRegularExpression=new RegExp("\\([^)]*\\)|[\\0-\\u001F\\!-/:-@\\[-`\\{-\\u00BF\\u0250-\\u036F\\uD800-\\uFFFF]","g"))},e.get_phoneNumberRegExp=function(){return e._phoneNumberRegularExpression||(e._phoneNumberRegularExpression=new RegExp("^\\d+[\\d\\s]*(:?ext|x|)\\s*\\d+$","i"))},e.get_multipleWhitespaceRegExp=function(){return e._multipleWhitespaceRegularExpression||(e._multipleWhitespaceRegularExpression=new RegExp("\\s+","g"))},e.get_unsupportedTextRegExp=function(){return e._unsupportedTextRegularExpression||(e._unsupportedTextRegularExpression=new RegExp("[\\u0600-\\u06FF\\u0750-\\u077F\\u08A0-\\u08FF\\u1100-\\u11FF\\u3130-\\u318F\\uA960-\\uA97F\\uAC00-\\uD7AF\\uD7B0-\\uD7FF\\u3040-\\u309F\\u30A0-\\u30FF\\u3400-\\u4DBF\\u4E00-\\u9FFF\\uF900-\\uFAFF]|[\\uD840-\\uD869][\\uDC00-\\uDED6]"))},e.get_nbspRegExp=function(){return e._nbspRegExpression||(e._nbspRegExpression=new RegExp("\xa0","g"))},e.get_htmlEncodeReplacements=function(){if(!e._htmlEncodeReplacements){var t="&<>'\"`".length;e._htmlEncodeReplacements=new Array(t);for(var n=0;n<t;n++){var i=new RegExp("&<>'\"`".charAt(n).toString(),"g");e._htmlEncodeReplacements[n]=new r.o(i,"&#"+e.charCodeAt("&<>'\"`",n)+";")}}return e._htmlEncodeReplacements},e.get_htmlAttributeEncodeReplacements=function(){return e._htmlAttributeEncodeReplacements||(e._htmlAttributeEncodeReplacements=[r.o.createGlobalSearchFindReplacePair("&","&amp;"),r.o.createGlobalSearchFindReplacePair("<","&lt;"),r.o.createGlobalSearchFindReplacePair(">","&gt;"),r.o.createGlobalSearchFindReplacePair('"',"&quot;"),r.o.createGlobalSearchFindReplacePair("'","&#39;"),r.o.createGlobalSearchFindReplacePair("\r",""),r.o.createGlobalSearchFindReplacePair("\n","")])},e.get_xmlEncodeReplacements=function(){return e._xmlEncodeReplacements||(e._xmlEncodeReplacements=[r.o.createGlobalSearchFindReplacePair("&","&amp;"),r.o.createGlobalSearchFindReplacePair("<","&lt;"),r.o.createGlobalSearchFindReplacePair(">","&gt;"),r.o.createGlobalSearchFindReplacePair("'","&apos;"),r.o.createGlobalSearchFindReplacePair('"',"&quot;")])},e.get_htmlTextWhiteSpaceReplacements=function(){return e._htmlTextWhiteSpaceReplacements||(e._htmlTextWhiteSpaceReplacements=[r.o.createGlobalSearchFindReplacePair(" ","\xa0"),r.o.createGlobalSearchFindReplacePair("\xa0(?!\xa0)"," ")])},e.get_httpHeaderSanitizationReplacements=function(){return e._httpHeaderSanitizationReplacements||(e._httpHeaderSanitizationReplacements=[r.o.createGlobalSearchFindReplacePair("\r",""),r.o.createGlobalSearchFindReplacePair("\n","")])},e.areTextEqualIgnoreNbsp=function(t,n){return e.replaceNbsp(t)===e.replaceNbsp(n)},e.replaceNbsp=function(t){return t?t.replace(e.get_nbspRegExp()," "):null},e.htmlEncode=function(t){return e.encodeString(t,e.get_htmlEncodeReplacements())},e.htmlAttributeEncode=function(t){return e.encodeString(t,e.get_htmlAttributeEncodeReplacements())},e.xmlEncode=function(t){return e.encodeString(t,e.get_xmlEncodeReplacements())},e.getCssStyleFromDictionary=function(e){var t=new Sys.StringBuilder;for(var n in e){var i={key:n,value:e[n]};t.append(i.key),t.append(": "),t.append(i.value),t.append("; ")}return t.toString()},e.encodeWhitespace=function(t){return e.encodeString(t,e.get_htmlTextWhiteSpaceReplacements())},e.httpHeaderEncode=function(t){return e.encodeString(t,e.get_httpHeaderSanitizationReplacements())},e.isValidWebImageProtocol=function(t){return!!t&&((t=e.toLower(t)).startsWith("http://")||t.startsWith("https://"))},e.getFileNameWithoutExtension=function(e){if(!e)return null;var t=e.lastIndexOf(".");return t>=0&&t<e.length?e.substring(0,t):e},e.getFileExtension=function(e){if(!e)return"";var t=e.lastIndexOf(".");return t>=0&&t<e.length?e.substring(t,e.length):""},e.testGlobal=function(e,t){if(e.global){for(var n=!1;e.test(t);)n=!0;return n}return e.test(t)},e.matchGlobal=function(e,t){var n=[],i=e.match(t);if(i&&Array.add(n,i),t.global)for(i=e.match(t);i;)Array.add(n,i),i=e.match(t);return n},e.replaceAll=function(e,t,n){return e.replace(new RegExp(t,"g"),n)},e.localeCompare=function(t,n){return t.localeCompare(n)-e._localeCompareOffset},e.charAt=function(e,t){return e.charAt(t)},e.tryGetCharAt=function(e,t){return!e||t<0||t>=e.length?null:e.substring(t,t+1)},e.charCodeAt=function(e,t){return e.charCodeAt(t)},e.toUpper=function(e){return e.toUpperCase()},e.toLower=function(e){return e.toLowerCase()},e.toLowerForLocale=function(t,n){var i=t;return 1055!==n&&2092!==n&&1068!==n||(i=(i=i.replace("I","\u0131")).replace("\u0130","i")),e.toLower(i)},e.isLowerCase=function(e){return e.toLowerCase()===e},e.isUpperCase=function(e){return e.toUpperCase()===e},e.isNullOrEmpty=function(e){return!e},e.removeAllWhitespace=function(t){for(var n="",i=0;i<t.length;i++)e.isWhitespace(t.charCodeAt(i))||(n+=t.charAt(i).toString());return n},e.indexOfWhiteSpace=function(t,n){if(!t)return-1;if((n=n<0?0:n)>=t.length)return-1;for(var i=n;i<t.length;i++)if(e.isWhitespace(t.charCodeAt(i)))return i;return-1},e.lastIndexOfWhiteSpace=function(t,n){if(!t)return-1;if((n=n>t.length-1?t.length-1:n)<0)return-1;for(var i=n;i>=0;i--)if(e.isWhitespace(t.charCodeAt(i)))return i;return-1},e.isEastAsianChar=function(e){return e>=19968&&e<=40959||e>=13312&&e<=19967||e>=12544&&e<=12591||e>=12352&&e<=12543||e>=4352&&e<=4607||e>=12592&&e<=12687||e>=44032&&e<=55203||e>=40960&&e<=42191},e.isEastAsianCharExtended=function(t){return e.isEastAsianChar(t)||t>=12688&&t<=12703||t>=63744&&t<=64255||t>=11904&&t<=12245||t>=12288&&t<=12351},e.isThaiChar=function(e){return e>=3584&&e<=3711},e.getHexString=function(e){return e.toString(16).toUpperCase()},e.getInitials=function(t,n,i){return void 0===i&&(i=!1),t?(t=e.cleanupDisplayName(t),e.get_unsupportedTextRegExp().test(t)||!i&&e.get_phoneNumberRegExp().test(t)?"":e.getInitialsLatin(t,n)):""},e.cleanupDisplayName=function(t){return(t=(t=t.replace(e.get_unwantedCharsRegExp(),"")).replace(e.get_multipleWhitespaceRegExp()," ")).trim()},e.getInitialsLatin=function(e,t){var n="",i=e.split(" ");return 2===i.length?(n+=i[0].charAt(0),n+=i[1].charAt(0)):3===i.length?(n+=i[0].charAt(0),n+=i[2].charAt(0)):i.length>0&&(n+=i[0].charAt(0)),t&&n.length>1&&(n=n.charAt(1)+""+n.charAt(0)),n.toUpperCase()},e.stripPreTag=function(e){return e.replace(new RegExp("\\s*<pre>(.*)</pre>\\s*","i"),"$1")},e.fromCharCode=function(e){return String.fromCharCode(e)},e.from4CharCodes=function(e,t,n,i){return String.fromCharCode(e,t,n,i)},e.escape=function(e){return escape(e)},e.unescape=function(e){return unescape(e)},e.right=function(e,t){return e.substr(t)},e.substr=function(e,t,n){return e.substr(t,n)},e.substring=function(e,t,n){return e.substring(t,n)},e.trimToLength=function(e,t){return null===e?null:e.length>t?e.substring(0,t):e},e.boundsToString=function(e){return e?"[L:"+e.x+", T:"+e.y+", R:"+(e.x+e.width)+", B:"+(e.y+e.height)+", W:"+e.width+", H:"+e.height+"]":""},e.pointToString=function(e){return"("+e.x+","+e.y+")"},e.padLeft=function(e,t,n){for(;e.length<t;)e=n+e;return e},e.calcHashCode=function(t){if(!t)return 0;if(e._hashCodeCache[t])return e._hashCodeCache[t];for(var n=5381,i=n,r=t.length,o=0;o<r&&(n=4294967295&((n<<5)+n^t.charCodeAt(o)),o!==r-1);o+=2)i=4294967295&((i<<5)+i^t.charCodeAt(o+1));var a=n+35685*i+(23896*i<<16)&4294967295;return a<0&&(a+=4294967296),e._hashCodeCache[t]=a,a},e.formatNumberToString=function(t,n,i,r){var o=t<0;if(6===n){e.generateAbsoluteValueString(t,i.percentDecimalDigits,i.percentDecimalSeparator,i.percentGroupSeparator,i.percentGroupSizes,r);var a=o?i.percentNegativePattern:i.percentPositivePattern;r.val=e.generatePercentString(r.val,i.percentSymbol,o,i.negativeSign,a)}else if(8===n){var s=new Array(2);s[0]=i.numberDecimalSeparator,r.val=e.generateTimespanString(t,s)}else e.generateAbsoluteValueString(t,i.numberDecimalDigits,i.numberDecimalSeparator,i.numberGroupSeparator,i.numberGroupSizes,r),r.val=e.generateNumberString(r.val,n,o,i.negativeSign,i.numberNegativePattern)},e.generateAbsoluteValueString=function(e,t,n,i,r,o){var a="",s="",l=Math.pow(10,t),u=Math.abs(Math.round(e*l)/l),c=Math.floor(u),p=(u*l-c*l)/l;if(c)for(var d=r.length,h=0,g=c;g>0;){var m=r[h];if(m){for(var _=0;_<m&&g>0;_++){a=(g%10).toString()+a,g=Math.floor(g/10)}g>0&&(a=i+a)}else a=g.toString()+a,g=0;h<d-1&&h++}else a="0";var f="",y=Math.round(p*l)/l;for(_=0;_<t;_++){var v=Math.floor(10*y);f+=v.toString();var S=Math.pow(10,t-_-1);y=Math.round(y*S*10-v*S)/S}for(var C=f.length;C>0&&"0"===f.charAt(C-1);)C--;""!==(f=f.substring(0,Math.max(0,C)))&&(s+=n+f),o.val=a+s},e.generatePercentString=function(t,n,i,r,o){var a=e.placeholderForPercent(n,i,r,o);return String.format(a,t)},e.generateTimespanString=function(t,n){return e.genTimeSpanFromSecond(t,n)},e.generateNumberString=function(t,n,i,r,o){var a=t;if(i)switch(o){case 0:a="("+a+")";break;case 1:a=r+a;break;case 2:a=r+" "+a;break;case 3:a+=r;break;case 4:a=a+" "+r}return String.format(e.placeholderForNumberMeasurement(n),a)},e.getExceptionMessage=function(e){var t=new Sys.StringBuilder,n=e.Exceptions;if(n&&n.length>0)for(var i=0,r=n;i<r.length;i++){var o=r[i];t.appendLine(o.message)}else t.append(e.message);return t.toString()},e.parseNumberAndUnitsFromString=function(t,n,i,r,o){var a="[0-9]*"+("["+i.numberDecimalSeparator+"]")+"?[0-9]+",s=new RegExp(a,"g"),l=t.match(s);if(!l||1!==l.length)return r.val=Number.NaN,void(o.val=0);var u="",c=i.negativeSign;switch(i.numberNegativePattern){case 0:u="[(][ ]?"+a+"[ ]?[)]";break;case 1:case 2:u=c+"[ ]?"+a;break;case 3:case 4:u=a+"[ ]?"+c}var p=new RegExp(u,"g"),d=t.match(p),h=!!d,g=h?t.replace(d[0],"{0}"):t.replace(l[0],"{0}"),m=!1,_=0;if("{0}"===(g=(g=e.removeAllWhitespace(g)).toLowerCase()))m=!0;else for(var f=0;f<n.length;f++){var y=n[f],v="";if(6===y){var S=h?i.percentNegativePattern:i.percentPositivePattern;v=e.placeholderForPercent(i.percentSymbol,h,c,S)}else v=e.placeholderForNumberMeasurement(y);if((v=(v=e.removeAllWhitespace(v)).toLowerCase())===g){_=y,m=!0;break}}if(m){var C=(h?"-":"")+l[0];C=C.replace(i.numberDecimalSeparator,"."),r.val=parseFloat(C),o.val=isNaN(r.val)?0:_}else r.val=Number.NaN,o.val=0},e.placeholderForNumberMeasurement=function(e){var t="";switch(e){case 0:t="{0}";break;case 1:t=CommonUIStrings.l_CentimeterUnitPlaceholder;break;case 2:t=CommonUIStrings.l_CharacterUnitPlaceholder;break;case 3:t=CommonUIStrings.l_InchUnitPlaceholder;break;case 4:t=CommonUIStrings.l_LineUnitPlaceholder;break;case 5:t=CommonUIStrings.l_PointUnitPlaceholder;break;case 7:t=CommonUIStrings.l_PixelsUnitPlaceholder;break;case 9:t=CommonUIStrings.l_DegreeUnitPlaceholder}return t},e.placeholderForPercent=function(e,t,n,i){var r="";if(t)switch(i){case 0:case 1:r=n+"{0}"+e;break;case 2:case 7:r=n+e+"{0}";break;case 3:case 10:r=e+n+"{0}";break;case 4:case 9:r=e+"{0}"+n;break;case 5:case 11:r="{0}"+n+e;break;case 6:case 8:r="{0}"+e+n}else switch(i){case 0:case 1:r="{0}"+e;break;case 2:case 3:r=e+"{0}"}return r},e.isNumber=function(t){return!!e.ignoredNumbersCheck.exec(t)},e.containsWhitespaceAtMost=function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=-1);for(var r=n;r<i&&r<t.length;r++)if(!e.isWhitespace(t.charCodeAt(r)))return!1;return!0},e.containsWhitespaceWithoutObjectReplacementSpace=function(t,n,i){void 0===n&&(n=0),void 0===i&&(i=-1);for(var r=n;r<i&&r<t.length;r++)if(65532===t.charCodeAt(r)||!e.isWhitespace(t.charCodeAt(r)))return!1;return!0},e.genTimeSpanFromSecond=function(t,n){var i=Math.round(100*Math.abs(t)),r=Math.floor(i/100),o=i%100;return e.padLeft(r.toString(),2,"0")+n[0]+e.padLeft(o.toString(),2,"0")},e.getRGBFromBGR=function(e){return 6===e.length&&new RegExp("^[0-9A-F]{6}$","i").test(e)?"#"+e.substr(4,2)+e.substr(2,2)+e.substr(0,2):e},e.mailToProtocol="mailto:",e.bookmarkAnchorPrefix="bookmark://",e._emailRegex=new RegExp("\\S+@\\S+\\.[\\w]+"),e._linkableProtocolList=null,e._urlKeyValueEncodeReplacements=null,e.romanOnes=null,e.romanTens=null,e.romanHundreds=null,e._hashCodeCache={},e._localeCompareOffset="A".localeCompare("A"),e._htmlEncodeReplacements=null,e._htmlAttributeEncodeReplacements=null,e._xmlEncodeReplacements=null,e._htmlTextWhiteSpaceReplacements=null,e._httpHeaderSanitizationReplacements=null,e._lineBreakRegularExpression=null,e._unwantedCharsRegularExpression=null,e._phoneNumberRegularExpression=null,e._multipleWhitespaceRegularExpression=null,e._unsupportedTextRegularExpression=null,e._nbspRegExpression=null,e.jsonEscapedCharacters=[new r.o(new RegExp("\\\\","g"),"\\\\"),new r.o(new RegExp('\\"',"g"),'\\"')],e.ignoredNumbersCheck=new RegExp("^[\\d\\s\\.\\,\\+\\-]+$"),e}();(0,a.l)(l,"StringUtils",null,[])},function(e,t,n){var i=n(57),r=n(950),o=n(875);e.exports=!i&&!r((function(){return 7!=Object.defineProperty(o("div"),"a",{get:function(){return 7}}).a}))},,,function(e){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},,function(e,t,n){"use strict";n.d(t,{w:function(){return a}});var i=n(773),r=n(425),o=n(208),a=function(){function e(e,t){this._isOpacityConstant=!1,this._isXConstant=!1,this._isYConstant=!1,this._isHeightConstant=!1,this._isWidthConstant=!1,this._isScrollTopConstant=!1,this._isScrollLeftConstant=!1,this._isRotateZConstant=!1,this._useRightAttributeForX=!1,this._useRelativePositioning=!1,this.element=null,this.type=0,this._finalOpacity=Number.NaN,this._finalX=Number.NaN,this._finalY=Number.NaN,this._finalHeight=Number.NaN,this._finalWidth=Number.NaN,this._finalScrollTop=Number.NaN,this._finalScrollLeft=Number.NaN,this._finalRotateZ=Number.NaN,this.type=e,this.element=t,"relative"===this.element.style.position&&(this._useRelativePositioning=!0)}return e.prototype.get_useRelativePositioning=function(){return this._useRelativePositioning},e.prototype.get_finalX=function(){return this._finalX},e.prototype.set_finalX=function(e){return this._finalX=e,e},e.prototype.get_isXConstant=function(){return this._isXConstant},e.prototype.animateX=function(e,t,n){this._useRightAttributeForX=n,e!==t?(this._isXConstant=!1,this.setInitialX(e,n),this.set_finalX(t)):this.maintainConstantX(e,n)},e.prototype.maintainConstantX=function(e,t){this._isXConstant=!0,this.setInitialX(e,t),this.set_finalX(e)},e.prototype.setInitialX=function(e,t){t?this._useRelativePositioning?this.element.style.marginRight=e+"px":this.element.style.right=e+"px":this._useRelativePositioning?this.element.style.marginLeft=e+"px":this.element.style.left=e+"px"},e.prototype.animateXRight=function(e,t,n){this._useRightAttributeForX=!n,e!==t?(this._isXConstant=!1,this.setInitialXRight(e,n),this.set_finalX(t)):this.maintainConstantXRight(e,n)},e.prototype.maintainConstantXRight=function(e,t){this._isXConstant=!0,this.setInitialXRight(e,t),this.set_finalX(e)},e.prototype.setInitialXRight=function(e,t){t?this._useRelativePositioning?this.element.style.marginLeft=e+"px":this.element.style.left=e+"px":this._useRelativePositioning?this.element.style.marginRight=e+"px":this.element.style.right=e+"px"},e.prototype.get_useRightAttributeForX=function(){return this._useRightAttributeForX},e.prototype.get_finalY=function(){return this._finalY},e.prototype.set_finalY=function(e){return this._finalY=e,e},e.prototype.get_isYConstant=function(){return this._isYConstant},e.prototype.animateY=function(e,t){e!==t?(this._isYConstant=!1,this.setInitialY(e),this.set_finalY(t)):this.maintainConstantY(e)},e.prototype.maintainConstantY=function(e){this._isYConstant=!0,this.setInitialY(e),this.set_finalY(e)},e.prototype.setInitialY=function(e){this._useRelativePositioning?this.element.style.marginTop&&""!==this.element.style.marginTop&&this.element.style.marginTop===e+"px"||(this.element.style.marginTop=e+"px"):this.element.style.top&&""!==this.element.style.top&&this.element.style.top===e+"px"||(this.element.style.top=e+"px")},e.prototype.get_finalHeight=function(){return this._finalHeight},e.prototype.set_finalHeight=function(e){return this._finalHeight=e,e},e.prototype.get_isHeightConstant=function(){return this._isHeightConstant},e.prototype.animateHeight=function(e,t){e!==t?(this._isHeightConstant=!1,this.element.style.height&&""!==this.element.style.height&&this.element.style.height!==t+"px"||this.setInitialHeight(e),this.set_finalHeight(t)):this.maintainConstantHeight(e)},e.prototype.maintainConstantHeight=function(e){this._isHeightConstant=!0,this.setInitialHeight(e),this.set_finalHeight(e)},e.prototype.setInitialHeight=function(e){this.element.style.height=e+"px"},e.prototype.get_finalWidth=function(){return this._finalWidth},e.prototype.set_finalWidth=function(e){return this._finalWidth=e,e},e.prototype.get_isWidthConstant=function(){return this._isWidthConstant},e.prototype.animateWidth=function(e,t){e!==t?(this._isWidthConstant=!1,this.element.style.width&&""!==this.element.style.width&&this.element.style.width!==t+"px"||this.setInitialWidth(e),this.set_finalWidth(t)):this.maintainConstantWidth(e)},e.prototype.maintainConstantWidth=function(e){this._isWidthConstant=!0,this.setInitialWidth(e),this.set_finalWidth(e)},e.prototype.setInitialWidth=function(e){this.element.style.width=e+"px"},e.prototype.get_finalOpacity=function(){return this._finalOpacity},e.prototype.set_finalOpacity=function(e){return this._finalOpacity=e,e},e.prototype.get_isOpacityConstant=function(){return this._isOpacityConstant},e.prototype.animateOpacity=function(e,t){this.setInitialOpacity(e),this.set_finalOpacity(t)},e.prototype.setInitialOpacity=function(e){r.y.setOpacity(this.element,e)},e.prototype.get_finalScrollTop=function(){return this._finalScrollTop},e.prototype.set_finalScrollTop=function(e){return this._finalScrollTop=e,e},e.prototype.get_isScrollTopConstant=function(){return this._isScrollTopConstant},e.prototype.animateScrollTop=function(e,t){e!==t?(this._isScrollTopConstant=!1,this.element.scrollTop===t&&this.setInitialScrollTop(e),this.set_finalScrollTop(t)):this.maintainConstantScrollTop(e)},e.prototype.maintainConstantScrollTop=function(e){this._isScrollTopConstant=!0,this.setInitialScrollTop(e),this.set_finalScrollTop(e)},e.prototype.setInitialScrollTop=function(e){this.element.scrollTop=e},e.prototype.get_finalScrollLeft=function(){return this._finalScrollLeft},e.prototype.set_finalScrollLeft=function(e){return this._finalScrollLeft=e,e},e.prototype.get_isScrollLeftConstant=function(){return this._isScrollLeftConstant},e.prototype.animateScrollLeft=function(e,t){e!==t?(this._isScrollLeftConstant=!1,this.element.scrollLeft===t&&this.setInitialScrollLeft(e),this.set_finalScrollLeft(t)):this.maintainConstantScrollLeft(e)},e.prototype.maintainConstantScrollLeft=function(e){this._isScrollLeftConstant=!0,this.setInitialScrollLeft(e),this.set_finalScrollLeft(e)},e.prototype.setInitialScrollLeft=function(e){this.element.scrollLeft=e},e.prototype.get_finalRotateZ=function(){return this._finalRotateZ},e.prototype.set_finalRotateZ=function(e){return this._finalRotateZ=e,e},e.prototype.get_isRotateZConstant=function(){return this._isRotateZConstant},e.prototype.animateRotateZ=function(e,t){e!==t?(this._isRotateZConstant=!1,this.setInitialRotateZ(e),this.set_finalRotateZ(t)):this.maintainConstantRotateZ(e)},e.prototype.maintainConstantRotateZ=function(e){this._isRotateZConstant=!0,this.setInitialRotateZ(e),this.set_finalRotateZ(e)},e.prototype.setInitialRotateZ=function(e){i.o.setRotation(this.element,e)},e}();(0,o.l)(a,"AAnimationEvent",null,[])},,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IPackageLifecycleManager"),o=n(600),a=n(644),s=n(658),l=n(255),u=n(614),c=n(196),p=function(){return function(e,t,n){this.packageInstanceInstance=null,this.appStatusForInitialization=0,this.status=0,this.packageInstanceInstance=e,this.status=t,this.appStatusForInitialization=n}}();(0,i.l)(p,"PackageRegistration",null,[]);var d=n(478),h=n(195),g=n(984);n.d(t,{o:function(){return m}});var m=function(){function e(e,t,n){this._taskSet=!1,this._retriedTask=!1,this._readyToInit=!1,this._readyToConfigure=!1,this._container=null,this._appLifecycleManager=null,this._cookieCompliance=null,this._isSettingEnabledFunc=null,this._packages=new s.w(p),this._pendingOnInitCallbacks={},this._registerAfterCookieConsent=new a.c(p),this._appLifecycleManager=e,this._isSettingEnabledFunc=t,this._cookieCompliance=n,n.add_onConsentReceived(i.i(this,this.onCookieConsentReceived,"onCookieConsentReceived"))}return e.prototype.registerActions=function(e){e.addActionWithFlags(u.SA,g.a,i.i(this,this.queryPackageInitialized,"queryPackageInitialized"),96)},e.prototype.queryPackageInitialized=function(e,t,n,i,r){return this.callQueryPackageInitialized(r)},e.prototype.callQueryPackageInitialized=function(e){return this._readyToInit&&this._packages.tryGetValue(e,(0,o.m)((function(){return t}),(function(e){return t=e})))&&t.status>=3?32:2;var t},e.prototype.registerPackage=function(e,t,n){void 0===t&&(t=0),void 0===n&&(n=!1);var i=new p(e,0,t);n&&this._cookieCompliance.get_isConsentNeeded()?this._registerAfterCookieConsent.add(i):this.registerPackageInternal(i)},e.prototype.registerPackageInternal=function(e){var t=e.packageInstanceInstance;this._packages.containsKey(t.get_name())?l.ULS.sendTraceTag(40722710,306,10,"Package name '{0}' was already registered with the PackageLifecycleManager",t.get_name()):(this._packages.set_item(t.get_name(),e),this._isSettingEnabledFunc("InitializePackagesInTask")?this._readyToConfigure&&!this._taskSet&&this.scheduleTask():(this._readyToConfigure&&this.configurePackage(t),this._readyToInit&&this.initializePackage(t)))},e.prototype.onCookieConsentReceived=function(){for(var e=this._registerAfterCookieConsent.$$lge();e.$$mn();){var t=e.$$cu();this.registerPackageInternal(t)}this._registerAfterCookieConsent.clear()},e.prototype.scheduleTask=function(){var e=this,t=new d.c(2,1,0,(function(t){if(!e._readyToConfigure||!e._readyToInit)return l.ULS.shipAssertTag(6350740,324,!1),void(e._retriedTask||(e._retriedTask=!0,e.scheduleTask()));e._taskSet=!1,e.notifyReadyToConfigure(e._container),e.notifyReadyToInit()}),95);n(254).AFrameworkApplication.get_theTaskManager().addTask(t),this._taskSet=!0},e.prototype.notifyReadyToConfigure=function(e){this._readyToConfigure=!0,this._container=e;for(var t=this._packages.getEnumerator();t.$$mn();){var n=t.$$cu();n.get_value().status||this.configurePackage(n.get_value().packageInstanceInstance)}},e.prototype.configurePackage=function(e){var t=this._packages.get_item(e.get_name());l.ULS.shipAssertTag(6575509,306,!!t&&!t.status,e.get_name()),e.configure(this._container),t.status=1},e.prototype.registerOnPackageInit=function(e,t){this._readyToInit&&this._packages.containsKey(e)&&3===this._packages.get_item(e).status?t():this._pendingOnInitCallbacks[e]=t},e.prototype.notifyReadyToInit=function(){this._readyToInit=!0;for(var e=this._packages.getEnumerator();e.$$mn();){var t=e.$$cu();!this._isSettingEnabledFunc("InitializePackagesInTask")||t.get_value().status?t.get_value().status<2&&this.initializePackage(t.get_value().packageInstanceInstance):this._taskSet||this.scheduleTask()}},e.prototype.initializePackage=function(e){var t=this,n=this._packages.get_item(e.get_name());l.ULS.shipAssertTag(6575511,306,!!n&&n.status<3,e.get_name());var i=function(){(e.init(),n.status=3,e.get_name()in t._pendingOnInitCallbacks)&&(0,t._pendingOnInitCallbacks[e.get_name()])()};n.appStatusForInitialization&&this._isSettingEnabledFunc("Box4DelayedPackageInitEnabled")?(n.status=2,this._appLifecycleManager.executeWhen(n.appStatusForInitialization,i)):i()},e.prototype.tryInitializePackage=function(e){var t;if(this._packages.tryGetValue(e,(0,o.m)((function(){return t}),(function(e){return t=e})))){if(t.status<2)return this.initializePackage(t.packageInstanceInstance),!0;if(3===t.status)return!0}return l.ULS.sendTraceTag(40489671,306,15,"Failed to initialize {0} package.",e),!1},e.prototype.dispose=function(){for(var e=this._packages.getEnumerator();e.$$mn();){var t=e.$$cu();3===t.get_value().status&&(t.get_value().packageInstanceInstance.dispose(),t.get_value().status=4)}},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=new e(c.r.get_instance(),(function(e){return!!n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e)}),h.v.get_instance()))},e._singletonInstance=null,e}();(0,i.l)(m,"PackageLifecycleManager",null,[r])},,,,function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var i=(0,n(208).y)("IDynamicScriptLoaderProvider")},,,,function(e,t,n){"use strict";n.d(t,{i:function(){return r}});var i=n(208),r=(i.y("Sys.IEnumerable$1"),{$$:function(e){var t="IEnumerable$1$"+e.getName();return(0,i.g)(t)}})},function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var i=n(208),r=function(){function e(){}return e.businessBarFocusID="businessBar",e.conflictBusinessBarID="bbCfl",e.versionsBusinessBarID="bbVer",e._businessBarLinkClass="WACBusinessBarLink",e}();(0,i.l)(r,"BusinessBarConstants",null,[])},function(e,t,n){"use strict";n.d(t,{d:function(){return a}});var i=n(425),r=n(896),o=n(208),a=function(){function e(){}return e.get_mouseWheel=function(){return e._mouseWheel||(i.y.get_isFirefox()?e._mouseWheel="DOMMouseScroll":e._mouseWheel="mousewheel"),e._mouseWheel},e.get_keyEvents=function(){return e.ensureKeyEventsCreated(),e._keyEvents},e.get_keyTypedEvents=function(){return e.ensureKeyTypedEventsCreated(),e._keyTypedEvents},e.get_mouseEvents=function(){return e.ensureMouseEventsCreated(),e._mouseEvents},e.get_dragEvents=function(){return e.ensureDragEventsCreated(),e._dragEvents},e.get_dragDropEvents=function(){return e.ensureDragDropEventsCreated(),e._dragDropEvents},e.get_clickEvents=function(){return e.ensureClickEventsCreated(),e._clickEvents},e.get_touchEvents=function(){return e.ensureTouchEventsCreated(),e._touchEvents},e.get_pointerEvents=function(){return e.ensurePointerEventsCreated(),e._pointerEvents},e.get_gesturePointerEvents=function(){return e.ensureGesturePointerEventsCreated(),e._gesturePointerEvents},e.get_gestureMouseEvents=function(){return e.ensureGestureMouseEventsCreated(),e._gestureMouseEvents},e.ensureEventNamesMapping=function(){e._eventNames||(e._eventNames=r.r([e.aggregateEventTiming,e.beforeDeactivate,e.beforeKeyDown,e.beforeKeyPress,e.beforeKeyUp,e.blur,e.browserPointerCancel,e.browserPointerDown,e.browserPointerEnter,e.browserPointerLeave,e.browserPointerMove,e.browserPointerOut,e.browserPointerOver,e.browserPointerUp,e.change,e.click,e.compositionEnd,e.compositionStart,e.compositionUpdate,e.contextMenu,e.copy,e.cut,e.domSubtreeModified,e.doubleClick,e.dragLeave,e.dragStart,e.dragOver,e.dragEnter,e.drop,e.durationChange,e.error,e.ended,e.focus,e.input,e.keyDown,e.keyPress,e.keyUp,e.load,e.loseCapture,e.message,e.mouseDown,e.mouseEnter,e.mouseLeave,e.mouseMove,e.mouseOut,e.mouseOver,e.mouseUp,e.get_mouseWheel(),e.msPointerCancel,e.msPointerDown,e.msPointerEnter,e.msPointerLeave,e.msPointerMove,e.msPointerOut,e.msPointerOver,e.msPointerUp,e.pan,e.panStart,e.panMove,e.panEnd,e.panCancel,e.panUp,e.panDown,e.panRight,e.panLeft,e.paste,e.pause,e.pinch,e.pinchCancel,e.pinchEnd,e.pinchIn,e.pinchMove,e.pinchOut,e.pinchStart,e.play,e.playing,e.pointerDown,e.pointerEnter,e.pointerLeave,e.pointerMove,e.pointerOut,e.pointerOver,e.pointerUp,e.propertyChange,e.reportFrameTiming,e.resize,e.scroll,e.selectionChange,e.selectStart,e.submit,e.swcReady,e.swipe,e.reset,e.textInput,e.timeUpdate,e.touchCancel,e.touchContextMenu,e.touchEnd,e.touchMove,e.touchStart,e.unload,e.visibilityChange]))},e.ensureKeyEventsCreated=function(){e._keyEvents||(e._keyEvents=[e.keyDown,e.keyUp,e.keyPress,e.beforeKeyDown,e.beforeKeyUp,e.beforeKeyPress])},e.ensureKeyTypedEventsCreated=function(){e._keyTypedEvents||(e._keyTypedEvents=[e.keyDown,e.keyPress])},e.ensureMouseEventsCreated=function(){e._mouseEvents||(e._mouseEvents=[e.mouseDown,e.mouseUp,e.mouseMove,e.mouseEnter,e.mouseLeave,e.mouseOver,e.mouseOut,e.get_mouseWheel()])},e.ensureDragEventsCreated=function(){e._dragEvents||(e._dragEvents=[e.mouseDown,e.mouseUp,e.mouseMove,e.mouseOut,e.touchStart,e.touchEnd,e.touchMove,e.click])},e.ensureDragDropEventsCreated=function(){e._dragDropEvents||(e._dragDropEvents=[e.dragOver,e.drop])},e.ensureClickEventsCreated=function(){e._clickEvents||(e._clickEvents=[e.click,e.doubleClick])},e.ensureTouchEventsCreated=function(){e._touchEvents||(e._touchEvents=[e.touchStart,e.touchEnd,e.touchMove,e.touchCancel])},e.ensurePointerEventsCreated=function(){e._pointerEvents||(e._pointerEvents=[e.pointerDown,e.pointerEnter,e.pointerLeave,e.pointerMove,e.pointerUp,e.pointerOver,e.pointerOut])},e.ensureGesturePointerEventsCreated=function(){e._gesturePointerEvents||(e._gesturePointerEvents=[e.browserPointerDown,e.browserPointerMove,e.browserPointerUp,e.browserPointerCancel])},e.ensureGestureMouseEventsCreated=function(){e._gestureMouseEvents||(e._gestureMouseEvents=[e.mouseDown,e.mouseMove,e.mouseUp])},e.isValidEventName=function(t){return e.ensureEventNamesMapping(),!!e._eventNames[t]},e.ensureIsSimulatedMapping=function(){e._isSimulated||(e._isSimulated=r.r([e.beforeKeyDown,e.beforeKeyUp,e.beforeKeyPress,e.pan,e.pinch,e.swipe,e.touchContextMenu]))},e.isSimulated=function(t){return e.ensureIsSimulatedMapping(),!!e._isSimulated[t]},e.ensureIsInternalMapping=function(){e._isInternal||(e._isInternal=r.r([e.touchContextMenu]))},e.isInternalEvent=function(t){return e.ensureIsInternalMapping(),!!e._isInternal[t]},e.eventNameFromString=function(t){var n=t;switch(n){case"textinput":n=e.textInput;break;case"dommousescroll":n=e.get_mouseWheel();break;case"domsubtreemodified":n=e.domSubtreeModified;break;case"mspointerdown":n=e.msPointerDown;break;case"mspointerup":n=e.msPointerUp;break;case"mspointermove":n=e.msPointerMove;break;case"mspointerover":n=e.msPointerOver;break;case"mspointerout":n=e.msPointerOut;break;case"mspointercancel":n=e.msPointerCancel;break;case"mspointerleave":n=e.msPointerLeave;break;case"mspointerenter":n=e.msPointerEnter}return n},e.keyDown="keydown",e.keyUp="keyup",e.keyPress="keypress",e.beforeKeyDown="BeforeKeyDown",e.beforeKeyUp="BeforeKeyUp",e.beforeKeyPress="BeforeKeyPress",e.touchContextMenu="touchcontextmenu",e.compositionStart="compositionstart",e.compositionEnd="compositionend",e.compositionUpdate="compositionupdate",e.loseCapture="losecapture",e.pointerDown="msospPointerDown",e.pointerMove="msospPointerMove",e.pointerUp="msospPointerUp",e.pointerOver="msospPointerOver",e.pointerOut="msospPointerOut",e.pointerLeave="msospPointerLeave",e.pointerEnter="msospPointerEnter",e.browserPointerDown="pointerdown",e.browserPointerMove="pointermove",e.browserPointerUp="pointerup",e.browserPointerOver="pointerover",e.browserPointerOut="pointerout",e.browserPointerCancel="pointercancel",e.browserPointerLeave="pointerleave",e.browserPointerEnter="pointerenter",e.mouseDown="mousedown",e.mouseUp="mouseup",e.mouseMove="mousemove",e.mouseEnter="mouseenter",e.mouseLeave="mouseleave",e.mouseOver="mouseover",e.mouseOut="mouseout",e._mouseWheel=null,e.click="click",e.doubleClick="dblclick",e.touchStart="touchstart",e.touchMove="touchmove",e.touchEnd="touchend",e.touchCancel="touchcancel",e.msPointerDown="MSPointerDown",e.msPointerMove="MSPointerMove",e.msPointerUp="MSPointerUp",e.msPointerOver="MSPointerOver",e.msPointerOut="MSPointerOut",e.msPointerCancel="MSPointerCancel",e.msPointerLeave="MSPointerLeave",e.msPointerEnter="MSPointerEnter",e.textInput="textInput",e.drop="drop",e.dragStart="dragstart",e.dragOver="dragover",e.dragEnter="dragenter",e.dragLeave="dragleave",e.contextMenu="contextmenu",e.beforeDeactivate="beforedeactivate",e.domSubtreeModified="DOMSubtreeModified",e.message="message",e.focus="focus",e.input="input",e.blur="blur",e.change="change",e.propertyChange="propertychange",e.scroll="scroll",e.selectionChange="selectionchange",e.selectStart="selectstart",e.submit="submit",e.reset="reset",e.load="load",e.unload="unload",e.error="error",e.resize="resize",e.copy="copy",e.cut="cut",e.paste="paste",e.play="play",e.playing="playing",e.pause="pause",e.timeUpdate="timeupdate",e.durationChange="durationchange",e.ended="ended",e.aggregateEventTiming="aggregateeventtiming",e.reportFrameTiming="reportframetiming",e.visibilityChange="visibilitychange",e.swcReady="swc:ready",e.pinch="pinch",e.pinchStart="pinchstart",e.pinchEnd="pinchend",e.pinchOut="pinchout",e.pinchIn="pinchin",e.pinchMove="pinchmove",e.pinchCancel="pinchcancel",e.pan="pan",e.panStart="panstart",e.panEnd="panend",e.panMove="panmove",e.panCancel="pancancel",e.panDown="pandown",e.panUp="panup",e.panLeft="panleft",e.panRight="panright",e.swipe="swipe",e._eventNames=null,e._isSimulated=null,e._isInternal=null,e._keyEvents=null,e._keyTypedEvents=null,e._mouseEvents=null,e._dragEvents=null,e._dragDropEvents=null,e._clickEvents=null,e._touchEvents=null,e._pointerEvents=null,e._gesturePointerEvents=null,e._gestureMouseEvents=null,e}();(0,o.l)(a,"EventNames",null,[])},function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var i=n(208),r=function(){return function(){this.displayTimeoutSeconds=null,this.onExpire=null}}();(0,i.l)(r,"ExpirationOptions",null,[])},,function(e,t,n){"use strict";n.r(t),n.d(t,{F6Manager:function(){return h}});var i=n(726),r=n(255),o=n(614),a=n(254),s=n(657),l=n(66),u=n(749),c=n(713),p=n(355),d=n(208),h=function(){function e(e){this._activeFocuses=null,this._focusManager=null,this._navOrderList=null,this._priorityOrderList=null,this._activeList=null,this.f6KeyInput=u.KeyInputManager.hashKey(l.v.vK_F6,0),this.f6ShiftKeyInput=u.KeyInputManager.hashKey(l.v.vK_F6,4),this._f6Scopes={},this._onBeforeF6forScope={},this._onPostF6forScope={},this._focusManager=e}return e.prototype.get_f6KeyInput=function(){return this.f6KeyInput},e.prototype.set_f6KeyInput=function(e){return this.f6KeyInput=e,e},e.prototype.get_f6ShiftKeyInput=function(){return this.f6ShiftKeyInput},e.prototype.set_f6ShiftKeyInput=function(e){return this.f6ShiftKeyInput=e,e},e.prototype.initializeOrder=function(e){this._navOrderList=e;for(var t=[],n=0;n<e.length;n++)Array.add(t,!1);this._activeList=t,this._activeFocuses=[]},e.prototype.initializePriorityOrder=function(e){this._priorityOrderList=e},e.prototype.getHighestPriority=function(){var e=null,t=0;if(this._priorityOrderList||(this._priorityOrderList=this._navOrderList),!this._priorityOrderList)return null;for(;!e&&t<this._priorityOrderList.length;){var n=this._priorityOrderList[t],i=Array.indexOf(this._navOrderList,n);i>=0&&this._activeList[i]&&(e=n),t++}return e},e.prototype.activateFocus=function(e){if(this._navOrderList&&Array.contains(this._navOrderList,e)){var t=Array.indexOf(this._navOrderList,e);this._activeList[t]||(this._activeList[t]=!0,this.updateActiveFocuses())}},e.prototype.deactivateFocus=function(e){if(this._navOrderList&&Array.contains(this._navOrderList,e)){var t=Array.indexOf(this._navOrderList,e);this._activeList[t]&&(this._activeList[t]=!1,this.updateActiveFocuses())}},e.prototype.isFocusScopeActive=function(e){return Array.contains(this._activeFocuses,e)},e.prototype.updateActiveFocuses=function(){for(var e=[],t=0;t<this._activeList.length;t++)this._activeList[t]&&Array.add(e,this._navOrderList[t]);this._activeFocuses=e},e.prototype.handleF6=function(e,t,n,i,r){return this.handleF6WithDirection(!0)},e.prototype.handleF6Shift=function(e,t,n,i,r){return this.handleF6WithDirection(!1)},e.prototype.resumeFocusWithDirection=function(e,t,n,i,o){var a="forward";o?a=o.toLowerCase():r.ULS.sendTraceTag(41502554,321,15,"Didn't find direction in message values");var l=0;return"backward"===a?l=this._activeFocuses.length-1:"forward"===a?l=0:r.ULS.sendTraceTag(41302162,321,15,"Received unknown direction to resume focus: "+a),s.FocusManager.instance().setScopeFromTop(this._activeFocuses[l]),32},e.prototype.handleF6WithDirection=function(e){c.t.mark(4696);var t=this.getCurrentIndex();if(-1===t)return 2;var n=this._onBeforeF6forScope[this._activeFocuses[t]];if(n&&n(e),this.setFocusableScope(t,e),-1!==(t=this.getCurrentIndex())){var i=this._onPostF6forScope[this._activeFocuses[t]];i&&i()}return c.t.mark(4697),32},e.prototype.handleTabFromBottom=function(){var e=this.getCurrentIndex();return-1!==e&&(--e<0&&(e=this._activeFocuses.length-1),this._focusManager.setScopeFromBottom(this._activeFocuses[e]))},e.prototype.setFocusableScope=function(e,t){var n,i=e,r=t?1:-1,o=a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsUIEmbedMode")&&a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SupportsAccessibilityLoop");do{if(n=null,(e+=r)>=this._activeFocuses.length){if(o){this.blurFocusAndSendMessage(!0);break}e=0}else if(e<0){if(o){this.blurFocusAndSendMessage(!1);break}e=this._activeFocuses.length-1}this._focusManager.setScopeFromTop(this._activeFocuses[e]);var s=this._focusManager.getCurrentRegion();s&&(n=s.listing)}while(n&&!n.get_firstElement()&&e!==i)},e.prototype.blurFocusAndSendMessage=function(e){var t=e?"forward":"backward";this._focusManager.pushScope(a.AFrameworkApplication.postmessageFocusId,!1),a.AFrameworkApplication.get_hostPostmessengerFuture().execute((function(e){e.sendMessage(p.a.accessibilityLoopComplete,{Direction:t})}))},e.prototype.getCurrentIndex=function(){var e=this._focusManager.get_currentScope().name;return e&&Array.contains(this._activeFocuses,e)||(e=this._focusManager.get_currentScope().get_containerScope())&&Array.contains(this._activeFocuses,e)?Array.indexOf(this._activeFocuses,e):-1},e.prototype.hasFocus=function(){return-1!==this.getCurrentIndex()},e.prototype.addF6KeyBindings=function(e){var t=this._focusManager.getScope(e);t.bindAction(this.get_f6KeyInput(),o.UT),t.bindAction(this.get_f6ShiftKeyInput(),o.Rh),this._f6Scopes[e]=t},e.prototype.hasF6KeyBindings=function(e){return e in this._f6Scopes},e.prototype.addF6=function(e,t){var n=this;void 0===t&&(t=!0),this.activateFocus(e),this._focusManager.getScope(e).addDispose((function(){n.deactivateFocus(e)})),t&&this.addF6KeyBindings(e)},e.prototype.setOnBeforeF6=function(e,t){this._onBeforeF6forScope[e]=t},e.prototype.setOnPostF6=function(e,t){this._onPostF6forScope[e]=t},e.prototype.bindFocusToBrowser=function(e){var t=this._focusManager.getScope(e);t.bindAction(u.KeyInputManager.hashKey(l.v.vK_D,1),o.QS),t.bindAction(u.KeyInputManager.hashKey(l.v.vK_F6,0),o.QS),t.bindAction(u.KeyInputManager.hashKey(l.v.vK_F6,4),o.QS)},e.usable=function(){return!!a.AFrameworkApplication.get_activeFrame()&&!!a.AFrameworkApplication.get_activeFrame().get_theFocusManager()&&!!a.AFrameworkApplication.get_activeFrame().get_theF6Manager()&&e.enabled},e.get_instance=function(){return e._instance||(e._instance=new e(s.FocusManager.instance())),e._instance},e.enabled=!1,e._instance=null,e}();(0,d.l)(h,"F6Manager",null,[i.k])},function(e,t,n){var i=n(531),r=n(76);e.exports=function(e,t){try{r(i,e,t)}catch(n){i[e]=t}return t}},function(e,t,n){"use strict";n.d(t,{j:function(){return i},v:function(){return r}});n(896);var i=function(e,t){var n=e._customData;return n?n[t]:null},r=function(e,t,n){var i=e._customData;i||(i={},e._customData=i),i[t]=n}},,function(e,t,n){"use strict";n.d(t,{s:function(){return a}});var i=n(508),r=n(216),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t.KeyTip=null,t.Alt=null,t.Command=null,t.LabelText=null,t.LabelCss=null,t.Image16by16=null,t.Image16by16Class=null,t.Image32by32=null,t.Image32by32Class=null,t.Lang=null,t.ExternalImageId=null,t}return(0,i.t)(t,e),t}(r.i);(0,o.l)(a,"CommonControlWithIconAndTextProps",r.i,[])},,,,,function(e,t,n){"use strict";n.d(t,{f:function(){return a}});var i=n(644),r=n(658),o=n(208),a=function(){function e(){this._events=null,this._recordedEvents=null}return e.prototype.get_hasSubscribers=function(){return this.get_recordedEvents().get_count()>0},e.prototype.get_events=function(){return this._events||(this._events=new Sys.EventHandlerList)},e.prototype.get_recordedEvents=function(){return this._recordedEvents||(this._recordedEvents=new r.w(i.c.$$(Function)))},e.prototype.dispose=function(){this._events=null,this._recordedEvents=null},e.prototype.addHandler=function(e,t){this.get_recordedEvents().containsKey(e)||this.get_recordedEvents().set_item(e,new i.c(Function)),this.get_events().addHandler(e,t),this.get_recordedEvents().get_item(e).add(t)},e.prototype.removeHandler=function(e,t){if(this.get_recordedEvents().containsKey(e)){var n=this.get_recordedEvents().get_item(e);n.remove(t)&&(this.get_events().removeHandler(e,t),n.get_count()||this.get_recordedEvents().remove(e))}},e.prototype.raiseEvent=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null);var i=this.get_events().getHandler(e);return!!i&&(i(n||this,t||Sys.EventArgs.Empty),!0)},e}();(0,o.l)(a,"EventSource",null,[Sys.IDisposable])},,,,,,function(e,t,n){"use strict";n.d(t,{h:function(){return i}});var i=(0,n(208).y)("ITaskManager")},,function(e,t,n){"use strict";n.d(t,{C:function(){return i},s:function(){return r}});var i=function(e){for(var t=new Array(0),n=e.$$ge();n.$$mn();){var i=n.$$cu();t.push(i)}return Error.create("AggregateException: Aggregate exceptions",{Exceptions:t})},r=function(e){for(var t=new Array(0),n=0,i=e;n<i.length;n++){var r=i[n];t.push(r)}return Error.create("AggregateException: Aggregate exceptions",{Exceptions:t})}},function(e,t,n){"use strict";n.r(t),n.d(t,{HostCallsTelemetryLogger:function(){return a}});var i=n(625),r=n(254),o=n(208),a=function(){function e(){this.requestType="PERF_HOSTCALLS"}return e.prototype.logToMdm=function(e,t){var n=this.prepareRequestPayload(e,t);r.AFrameworkApplication.theClientRequestManager.addRequest(r.AFrameworkApplication.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl"),2,n,null,!1,1,null,null,null,void 0,void 0,void 0,void 0,"PerfTelemetry")},e.prototype.prepareRequestPayload=function(e,t){var n={},i={};return n.hostCallPerfValue=e,n.perfHostCallDimensions=t,i.type=this.requestType,i.payloadJson=JSON.stringify(n),JSON.stringify(i)},e}();(0,o.l)(a,"HostCallsTelemetryLogger",null,[i.n])},function(e,t,n){"use strict";n.d(t,{c:function(){return i}});var i=(0,n(208).y)("ICloudPolicySettingsHelper")},function(e,t,n){"use strict";n.d(t,{y:function(){return a}});var i=n(508),r=n(562),o=n(208),a=function(e){function t(t){return e.call(this,2,t)||this}return(0,i.t)(t,e),t}(r.w);(0,o.l)(a,"HideAnimationEvent",r.w,[])},,,function(e,t,n){"use strict";n.d(t,{m:function(){return r}});var i=function(){function e(e,t){this._use=e,this._assign=t}return Object.defineProperty(e.prototype,"val",{get:function(){return this._use()},set:function(e){this._assign(e)},enumerable:!0,configurable:!0}),e}(),r=function(e,t){return new i(e,t)}},function(e,t,n){var i=n(394);e.exports=i("document","documentElement")},function(e,t,n){"use strict";n.d(t,{l:function(){return o}});var i=n(187),r=n(208),o=function(){function e(t,n){this._array=null,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,r.m(this,e.$$(t)),this._index=-1,this._array=n}return e.prototype.get_current=function(){if(-1===this._index||this._index>=this._array.length)throw Error.invalidOperation();return this._array[this._index]},e.prototype.moveNext=function(){return this._index++,this._index<this._array.length},e.prototype.reset=function(){this._index=-1},e.$$=function(t){var n="ArrayEnumerator$1$"+t.getName(),o=r.x(n);return o||r.u(n,"$$sc.ArrayEnumerator$1",e,[{T:t}],null,[i.m])},e}()},function(e,t,n){"use strict";var i=n(208),r=n(396),o=n(851),a=n(425),s=function(){return function(e,t){this.message=null,this.eventArgs=null,this.message=e,this.eventArgs=t}}();(0,i.l)(s,"CrossDocumentEventArgs",null,[]);var l=n(711),u=n(902),c=n(988);n.d(t,{c:function(){return p}});var p=function(){function e(t,n,i,r){this._enabled=!1,this._name="",this._receivingAllowList=null,this._freeReceivingAllowList=null,this._freeSendingAllowList=null,this._originAllowList=null,this.targetOrigin=null,this.targetWindow=null,this._messageCallbacks=null,this._eventCallbacks=null,this._useFreeSendingAllowList=!0,this._useRecevingAllowList=!0,this._useOriginAllowList=!0,this._messageEventHandler=null,this._messageListener=null,this._receivingAllowList=[],this._freeReceivingAllowList=[],this._freeSendingAllowList=[],this._originAllowList=[],this.targetWindow=t,this.targetOrigin=n,this._messageCallbacks={},this._eventCallbacks={},this._messageEventHandler=i,e._id++,r&&r(),this._enabled=this.enable()}return e.prototype.get_targetOrigin=function(){return this.targetOrigin},e.prototype.get_targetWindow=function(){return this.targetWindow},e.prototype.setName=function(e){this._name=e},e.prototype.get_useFreeSendingAllowList=function(){return this._useFreeSendingAllowList},e.prototype.get_useReceivingAllowList=function(){return this._useRecevingAllowList},e.prototype.get_useOriginAllowList=function(){return this._useOriginAllowList},e.prototype.enable=function(){return u.m()?(this.internalEnableReceiving(),this.createReceivingAllowList(),this.createFreeSendingAllowList(),c.c.sendTraceTag(5018252,2,"Enabled."),!0):(c.c.sendTraceTag(5018251,2,"Not supported for current browser."),!1)},e.prototype.isEnabled=function(){return this._enabled},e.prototype.internalEnableReceiving=function(){c.c.debugAssertTag(5018253,!!this._messageEventHandler,null),this._messageListener=i.i(this,this.messageListener,"messageListener"),this._messageEventHandler.attachHandler(this._messageListener,null)},e.prototype.disable=function(){this._enabled=!1,this._receivingAllowList=[],this._freeReceivingAllowList=[],this._freeSendingAllowList=[],this._originAllowList=[],this.targetWindow=null,this.targetOrigin="",this._messageEventHandler.detachHandler(this._messageListener),this._messageCallbacks={},this._eventCallbacks={}},e.prototype.dispose=function(){this.disable()},e.prototype.createReceivingAllowList=function(){},e.prototype.createReceivingAllowListDebug=function(){},e.prototype.createFreeSendingAllowList=function(){},e.prototype.createFreeSendingAllowListDebug=function(){},e.prototype.isMessageReceivingAllowed=function(e){return!!this._receivingAllowList&&Array.contains(this._receivingAllowList,e)||this.isMessageFreeReceivingAllowed(e)},e.prototype.isMessageFreeReceivingAllowed=function(e){return!!this._freeReceivingAllowList&&Array.contains(this._freeReceivingAllowList,e)},e.prototype.addAllowedReceivingMessage=function(e){return c.c.debugAssertTag(5018259,!!this._receivingAllowList,null),Array.add(this._receivingAllowList,e),c.c.sendTraceTag(5018260,2,"Allow receiving : {0}",e),!0},e.prototype.addAllowedFreeReceivingMessage=function(e){return c.c.debugAssertTag(5018261,!!this._freeReceivingAllowList,null),Array.add(this._freeReceivingAllowList,e),c.c.sendTraceTag(5018262,2,"Allow free receiving: {0}",e),!0},e.prototype.isMessageFreeSendingAllowed=function(e){return!!this._freeSendingAllowList&&Array.contains(this._freeSendingAllowList,e)},e.prototype.addAllowedFreeSendingMessage=function(e){return c.c.debugAssertTag(5018263,!!this._freeSendingAllowList,null),Array.add(this._freeSendingAllowList,e),c.c.sendTraceTag(5018264,2,"Allow free sending: {0}",e),!0},e.prototype.isOriginAllowed=function(e){var t=o.n.getOrigin(e);return!!t&&!!this._originAllowList&&Array.contains(this._originAllowList,t)},e.prototype.addAllowedOrigin=function(t){if(c.c.debugAssertTag(5018265,!!this._originAllowList,null),t===e.anyDomain)return c.c.debugAssertTag(5018266,!1,null),!1;var n=o.n.getOrigin(t);return n?(Array.add(this._originAllowList,n),c.c.sendTraceTag(5018268,2,"Add origin:{0}",n),!0):(c.c.sendTraceTag(5018267,4,"Get origin fail:{0}",t),!1)},e.prototype.send=function(e,t){void 0===t&&(t=null);var n=this.get_targetOrigin();if(t){var i=o.n.getOrigin(t);if(!i)return!1;n=i}return this.sendToWindow(e,this.get_targetWindow(),n)},e.prototype.sendToWindow=function(t,n,i){if(c.c.debugAssertTag(5018269,!!t,null),!this._enabled)return!1;if(c.c.debugAssertTag(5018270,!!n,null),c.c.debugAssertTag(5018271,!!i,null),!n||!i)return c.c.debugAssertTag(5018272,!1,null),!1;if(this.get_useOriginAllowList()&&i===e.anyDomain&&!this.isMessageFreeSendingAllowed(t.MessageId))return c.c.sendTraceTag(5018273,1,"Got unregistered message {0}",{id:t.MessageId}),!1;var r=new Date;t.SendTime=r.getTime();var o="";try{o=Sys.Serialization.JavaScriptSerializer.serialize(t)}catch(e){return c.c.sendTraceTag(5018274,4,"JSON Ser failed {0}",{Exception:e.message}),!1}var a=e.sendMessage(n,o,i),s={id:t.MessageId,origin:i};return c.c.sendTraceTag(5018275,2,"Send {0}. {1}",a?"succeeded":"failed",s),a},e.prototype.registerCallback=function(e,t){return c.c.debugAssertTag(5018304,!!t,null),c.c.debugAssertTag(5018305,!!this._messageCallbacks&&!!this._eventCallbacks,null),!!this._enabled&&(this.get_useReceivingAllowList()&&!this.isMessageReceivingAllowed(e)?(c.c.sendTraceTag(5018306,2,"Not allow receiving {0}",{id:e}),!1):(this._messageCallbacks[e]!==t&&(c.c.debugAssertTag(5018307,!this._messageCallbacks[e]&&!this._eventCallbacks[e],null),this._messageCallbacks[e]=t,delete this._eventCallbacks[e]),!0))},e.prototype.registerEventCallback=function(e,t){return c.c.debugAssertTag(40420062,!!t,null),c.c.debugAssertTag(40420063,!!this._eventCallbacks&&!!this._messageCallbacks,null),!!this._enabled&&(this.get_useReceivingAllowList()&&!this.isMessageReceivingAllowed(e)?(c.c.sendTraceTag(40420064,2,"Not allow receiving {0}",{id:e}),!1):(this._eventCallbacks[e]!==t&&(c.c.debugAssertTag(40420065,!this._messageCallbacks[e]&&!this._eventCallbacks[e],null),this._eventCallbacks[e]=t,delete this._messageCallbacks[e]),!0))},e.prototype.unregisterCallback=function(e){return!!this._enabled&&(this._messageCallbacks[e]&&delete this._messageCallbacks[e],this._eventCallbacks[e]&&delete this._eventCallbacks[e],!0)},e.prototype.messageListener=function(e){var t=this.getMessageFromEvent(e);if(!t)return!1;if(this._messageCallbacks[t.MessageId]){var n=this._messageCallbacks[t.MessageId];return this._messageEventHandler.invokeCallback(n,t),!0}if(this._eventCallbacks[t.MessageId]){n=this._eventCallbacks[t.MessageId];var i=new s(t,e);return this._messageEventHandler.invokeEventCallback(n,i),!0}return!1},e.prototype.getMessageFromEvent=function(e){var t=new Date;if(this.logReceivedMessage(e),!e.origin||!e.source||void 0===e.data||null===e.data)return c.c.debugAssertTag(5018308,!1,null),null;var n=this.jsonStringToMessage(e.data);if(!n)return null;if(this.get_useOriginAllowList()&&!this.isOriginAllowed(e.origin)){if(!this.isMessageFreeReceivingAllowed(n.MessageId))return c.c.sendTraceTag(5018309,1,"{0}",{id:n.MessageId}),null;if(!a.y.get_isInternetExplorer8()&&e.source!==this.get_targetWindow())return c.c.sendTraceTag(5018310,4,"Received message came from a source other than the parent window."),null}return c.c.debugAssertTag(5018311,!!n.Values,null),n.Values.m_Source=e.source,n.Values.m_Origin=e.origin,n.Values.m_ReceivedTime=t.getTime(),n},e.prototype.jsonStringToMessage=function(t){if(!t)return null;var n=null;try{n=Sys.Serialization.JavaScriptSerializer.deserialize(t,!0)}catch(t){return e._deserFailureLogCount<2&&(c.c.sendTraceTag(5018312,2,"Deser failed"),e._deserFailureLogCount++),null}if(!n)return c.c.debugAssertTag(5018313,!1,null),null;for(var i=0;i<e.crossDocumentMessageRequiredFields.length;i++)if(!n[e.crossDocumentMessageRequiredFields[i]])return"MessageId"!==e.crossDocumentMessageRequiredFields[i]&&c.c.sendTraceTag(41502555,2,"Cannot find required message field: {0}",e.crossDocumentMessageRequiredFields[i]),null;if(n.Values)try{n.Values}catch(e){return c.c.sendTraceTag(5018314,4,"Not a valid dictionary: {0}",e.message),null}else c.c.sendTraceTag(41502556,2,"No values in message");if(this.get_useReceivingAllowList()&&!this.isMessageReceivingAllowed(n.MessageId))return c.c.sendTraceTag(5018315,1,"Ignore recvd {0}",{id:n.MessageId}),null;var r=n.SendTime,o=new Date;if(r<0||r>o.getTime())return c.c.sendTraceTag(5018316,2,"{0}",{t:r}),null;if(r<new Date(o.getTime()-6e4).getTime())return c.c.sendTraceTag(5018317,2,"{0}",{t:r}),null;var a=new l.f;return a.MessageId=n.MessageId,a.SendTime=n.SendTime,a.CorrelationId=n.CorrelationId,n.Values&&(a.Values=n.Values),c.c.sendTraceTag(40640779,1,"Received message with MessageId:{0}, SendTime:{1}, CorrelationId:{2}",a.MessageId,a.SendTime,a.CorrelationId),a},e.prototype.logReceivedMessage=function(e){c.c.sendTraceTag(5018318,1,String.format("Received: {0}",{origin:e.origin,data:e.data,source:e.source}))},e.sendMessage=function(e,t,n){if(!u.m())return c.c.debugAssertTag(5018319,!1,null),!1;try{return e.postMessage(t,n),!0}catch(e){c.c.sendTraceTag(5018320,4,"{0}",{exception:e.message})}return!1},e.crossDocumentMessageRequiredFields=["MessageId","SendTime"],e.anyDomain="*",e._id=0,e._deserFailureLogCount=0,e}();(0,i.l)(p,"CrossDocumentMessenger",null,[Sys.IDisposable,r.d])},,function(e,t,n){"use strict";n.d(t,{a:function(){return r}});var i=n(208),r=function(){function e(t,n,r){this.handler=null,this.userData=null,i.m(this,e.$$(t)),this.handler=n,this.userData=r}return e.$$=function(t){var n="EventHandlerBinding$1$"+t.getName(),r=i.x(n);return r||i.u(n,"Common.EventHandlerBinding$1",e,[{T:t}],null,[])},e}()},function(e,t,n){"use strict";n.d(t,{d:function(){return i}});var i=(0,n(208).y)("IDirectPrintManager")},function(e,t,n){"use strict";n.d(t,{b:function(){return a}});var i=n(508),r=n(216),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t.UpdateDynamically=!1,t.Title=null,t.MaxWidth=null,t.MenuSectionList=null,t.AriaLabel=null,t.ShouldAutoOpen=!1,t.AriaRoleDescription=null,t}return(0,i.t)(t,e),t}(r.i);(0,o.l)(a,"MenuProps",r.i,[])},,function(e,t,n){"use strict";n.d(t,{g:function(){return r}});var i=n(208),r=function(){function e(){}return e.IsFreeForm="IsFreeForm",e.Value="Value",e.Key="Key",e.FontStyle="FontStyle",e}();(0,i.l)(r,"ComboBoxCommandProperties",null,[])},function(e,t,n){"use strict";var i=n(508),r=n(208),o=(0,r.y)("IProgressDialog"),a=n(92),s=function(){function e(){}return e.html="<div class='WACProgressRow' id='block1'> <img id='WACProgressImg' class='WACProgressIcon' role='presentation' /> <label id='WACProgressText' class='WACProgressTextPanel' >Loading</label> </div>",e}();(0,r.l)(s,"ProgressDialogHtml",null,[]);var l=n(134),u=n(743);n.d(t,{c:function(){return p}});var c="ProgressDialog",p=function(e){function t(t){void 0===t&&(t=!1);var n=e.call(this)||this;return n._progressStatusAriaUpdateEnabled=!1,n._progressDialogHandler=null,n._progressDialogHandlerData=null,n._progressMessage=CommonUIStrings.l_DialogLoading,n.set_dialogId(c),n.set_buttonsOption(6),n.setButtonText(0,CommonUIStrings.l_DialogCancel),n._progressStatusAriaUpdateEnabled=t,n}return(0,i.t)(t,e),t.prototype.get_message=function(){return this._progressMessage},t.prototype.set_message=function(e){return this._progressMessage=e,e},t.prototype.prepareDialog=function(){e.prototype.prepareDialog.call(this),this._progressStatusAriaUpdateEnabled&&(this._divMessageBox.setAttribute(l.t.ariaRoleAttribute,"progressbar"),this._divMessageBox.setAttribute(l.t.ariaValueMinAttribute,"0"),this._divMessageBox.setAttribute(l.t.ariaValueMaxAttribute,"100"),this._divMessageBox.setAttribute(l.t.ariaValueNowAttribute,"0")),this.set_dialogHtml(s.html),this._divMessageBox.style.minWidth="120px",this._divMessageBox.style.maxWidth="400px",this._buttonPanel.className="WACProgressButtonSection",this.setDescribedByForDialog("WACProgressText"),this.get_hasCloseGlyph()||this.get_hasButtons()?this._divMessageBox.style.minWidth="300px":(this._divMessageBoxTitle.style.display="none",this._buttonPanel.style.display="none"),this.get_hasButtons()||(this._divMessageBox.tabIndex=0)},t.prototype.showProgressDialog=function(e,t,n){this._progressDialogHandler=t,this._progressDialogHandlerData=n,this.initializeAndShow(e,r.i(this,this.baseDialogHandler$4,"baseDialogHandler$4"),{WACProgressText:this.get_message(),WACProgressImg:u.h.commonImage("progress.gif")}),this._divMessageBox.style.width="auto",this.get_hasButtons()||this._divMessageBox.focus()},t.prototype.showCustomizedProgressDialog=function(e,t,n){this.initializeAndShow(e,t,n)},t.prototype.updateAriaNowValue=function(e){this.get_isShowing()&&this._divMessageBox&&this._divMessageBox.setAttribute(l.t.ariaValueNowAttribute,String.format("{0}",e))},t.prototype.close=function(){this.hide()},t.prototype.baseDialogHandler$4=function(e,t){this._progressDialogHandler&&this._progressDialogHandler(this._progressDialogHandlerData)},t}(a.o);(0,r.l)(p,"ProgressDialog",a.o,[o])},,,,function(e,t,n){"use strict";n.d(t,{GG:function(){return i},kR:function(){return r},Xq:function(){return o},Hx:function(){return a},QJ:function(){return s},CS:function(){return l},yZ:function(){return u},cs:function(){return c},HV:function(){return p},uC:function(){return d},XJ:function(){return h},nm:function(){return g},H:function(){return m},zG:function(){return _},OY:function(){return f},AO:function(){return y},M:function(){return v},pA:function(){return S},bT:function(){return C},ni:function(){return b},Lu:function(){return A},os:function(){return T},vp:function(){return w},lW:function(){return I},ZO:function(){return E},CF:function(){return k},ne:function(){return D},jX:function(){return M},bm:function(){return P},xE:function(){return F},lm:function(){return x},Lv:function(){return R},iW:function(){return B},wt:function(){return L},bK:function(){return N},Li:function(){return U},UU:function(){return O},XQ:function(){return H},bg:function(){return W},te:function(){return V},WV:function(){return $},Dd:function(){return K},vN:function(){return z},bH:function(){return q},wL:function(){return Q},cF:function(){return G},YE:function(){return j},Zq:function(){return Z},FJ:function(){return X},Rr:function(){return J},Ps:function(){return Y},uU:function(){return ee},Wy:function(){return te},xF:function(){return ne},Ci:function(){return ie},Vo:function(){return re},Ir:function(){return oe},kY:function(){return ae},UT:function(){return se},Rh:function(){return le},cp:function(){return ue},fd:function(){return ce},MQ:function(){return pe},mX:function(){return de},tD:function(){return he},Di:function(){return ge},gK:function(){return me},Ti:function(){return _e},So:function(){return fe},N:function(){return ye},QS:function(){return ve},Nk:function(){return Se},Mg:function(){return Ce},fK:function(){return be},KO:function(){return Ae},dd:function(){return Te},pd:function(){return we},jd:function(){return Ie},LJ:function(){return Ee},CQ:function(){return ke},hA:function(){return De},wQ:function(){return Me},mu:function(){return Pe},oS:function(){return Fe},bW:function(){return xe},pp:function(){return Re},KQ:function(){return Be},Ht:function(){return Le},xo:function(){return Ne},yl:function(){return Ue},FC:function(){return Oe},wg:function(){return He},GV:function(){return We},jl:function(){return Ve},Dg:function(){return $e},Lt:function(){return Ke},MR:function(){return ze},yT:function(){return qe},ww:function(){return Qe},RH:function(){return Ge},IJ:function(){return je},ci:function(){return Ze},gD:function(){return Xe},Go:function(){return Je},rQ:function(){return Ye},SV:function(){return et},jz:function(){return tt},uO:function(){return nt},yN:function(){return it},ue:function(){return rt},nN:function(){return ot},VR:function(){return at},LY:function(){return st},Dt:function(){return lt},kB:function(){return ut},qM:function(){return ct},jG:function(){return pt},vr:function(){return dt},SA:function(){return ht},xR:function(){return gt},eX:function(){return mt},Id:function(){return _t},Le:function(){return ft},qb:function(){return yt},ui:function(){return vt},QD:function(){return St},HU:function(){return Ct},Lm:function(){return bt},Bo:function(){return At},Oo:function(){return Tt},sG:function(){return wt},rN:function(){return It},LL:function(){return Et},eb:function(){return kt},FH:function(){return Dt},dB:function(){return Mt},Vr:function(){return Pt},bk:function(){return Ft},J:function(){return xt},KD:function(){return Rt},zq:function(){return Bt},gZ:function(){return Lt},CO:function(){return Nt},Rz:function(){return Ut},eW:function(){return Ot},f:function(){return Ht},Uf:function(){return Wt},Pf:function(){return Vt},or:function(){return $t},pJ:function(){return Kt},vZ:function(){return zt},BB:function(){return qt},rI:function(){return Qt},Ig:function(){return Gt},Ec:function(){return jt},Fq:function(){return Zt},SS:function(){return Xt},md:function(){return Jt},lv:function(){return Yt},Ct:function(){return en},Hi:function(){return tn},BO:function(){return nn},Sd:function(){return rn},BA:function(){return on},ws:function(){return an},mE:function(){return sn},KW:function(){return ln},BJ:function(){return un},PD:function(){return cn},er:function(){return pn},kG:function(){return dn},Ut:function(){return hn},qr:function(){return gn},Jn:function(){return mn},FL:function(){return _n},go:function(){return fn},rG:function(){return yn}});var i=83795095,r=389865630,o=3803697328,a=798637440,s=2175352112,l=2556904104,u=4289528682,c=3551492845,p=2279655429,d=954512041,h=1404592381,g=3484823337,m=3786550719,_=2119511063,f=1915117369,y=3270784282,v=2635327499,S=241072808,C=3033402446,b=953328883,A=3259256685,T=1637502579,w=863375655,I=1510212254,E=467845448,k=375707647,D=3609945866,M=159412208,P=1951217806,F=1046295975,x=2462410242,R=4041287661,B=516537638,L=4156131848,N=1991982245,U=485487087,O=2489743155,H=3103450156,W=710925581,V=1750478296,$=1278286187,K=211953924,z=3756639316,q=844297214,Q=1245654357,G=646039090,j=1825605114,Z=779285039,X=4275690876,J=3113540593,Y=537152338,ee=1169404878,te=336231556,ne=1203133001,ie=3555692408,re=2619015155,oe=2413704991,ae=291542435,se=1261644258,le=715899390,ue=1754333801,ce=3019354063,pe=512688659,de=981334692,he=2398455418,ge=1783557e3,me=1486778386,_e=3016992658,fe=1501863744,ye=672565674,ve=710478303,Se=4180531998,Ce=1274543852,be=4288982261,Ae=802602464,Te=1454393937,we=2493123577,Ie=3107136749,Ee=3740310824,ke=2246375352,De=1784018444,Me=951969558,Pe=1478840041,Fe=2531463828,xe=1813655452,Re=2423504651,Be=1056925771,Le=3506486948,Ne=1448619089,Ue=3389570779,Oe=3963562945,He=3476734992,We=2068502235,Ve=3427834559,$e=2683007645,Ke=2349775795,ze=1959943459,qe=628793421,Qe=929022654,Ge=3236517055,je=250882013,Ze=1285265560,Xe=3798167515,Je=2052777571,Ye=4033456482,et=3675896289,tt=2799130311,nt=2074131365,it=1145315516,rt=1208554566,ot=3847984948,at=3874562422,st=3720034241,lt=825574620,ut=1478537812,ct=3887408216,pt=1369572530,dt=3914542e3,ht=49122376,gt=497870830,mt=3134802707,_t=2875864574,ft=991261903,yt=2793115165,vt=847427893,St=433063458,Ct=2576944597,bt=2854028228,At=2924716042,Tt=1656936120,wt=1897077126,It=3502386740,Et=1197060601,kt=3237171630,Dt=4133531354,Mt=3865601672,Pt=2275483468,Ft=4142738798,xt=4177432571,Rt=2539564555,Bt=2527431031,Lt=637959088,Nt=1596290176,Ut=617689800,Ot=1873541548,Ht=4242021840,Wt=2935633379,Vt=3276527670,$t=3510751882,Kt=4193807224,zt=3681556347,qt=2220417879,Qt=2583751502,Gt=1738002952,jt=4196619892,Zt=1621589088,Xt=1550573691,Jt=2145510275,Yt=2288458806,en=1342108365,tn=941487903,nn=2478534165,rn=3485513367,on=3901198658,an=1391456747,sn=201621520,ln=1773624819,un=4268365028,cn=2578423837,pn=215809929,dn=2112877354,hn=2424604265,gn=3800318691,mn=2988588587,_n=2910828042,fn=2095185708,yn=function(e){switch(e){case 617890675:return"AccCheckerFocusBackward";case 2971500747:return"AccCheckerFocusBottom";case 3772228079:return"AccCheckerFocusForward";case 1785655699:return"AccCheckerFocusTop";case 83795095:return"AccessibilityHelp";case 389865630:return"AccessibilityHelpDialogFocusBackward";case 3803697328:return"AccessibilityHelpDialogFocusForward";case 1099072191:return"ActivateAppForOffice";case 1743607468:return"ActivateTranslatorApp";case 1750752436:return"ActivityNotificationButtonHandler";case 3602816928:return"ActivityNotificationClosed";case 1402209562:return"AddInCommandsActionHandler";case 798637440:return"AlwaysEnabled";case 3030242601:return"AnswerForSearch";case 2434078920:return"amutTest1";case 2434078917:return"amutTest2";case 2434078918:return"amutTest3";case 3896010204:return"Animation";case 613275288:return"AnonymousCreationNavigateAfterSave";case 2316947260:return"AnonymousCreationSaveToHost";case 2175352112:return"AuthenticationLost";case 2556904104:return"AuthenticationRestored";case 4289528682:return"BlockIfFocusedTextField";case 3551492845:return"BlockIfNotFocusedTextField";case 2279655429:return"BreadcrumbLinkClick";case 954512041:return"BusinessBarButtonOne";case 1404592381:return"BusinessBarButtonTwo";case 3484823337:return"BusinessBarClose";case 3786550719:return"BusinessBarInvoke";case 2119511063:return"BusinessBarLink";case 1281138585:return"CancelPresenceTooltips";case 1915117369:return"CancelSigninBusinessBar";case 3270784282:return"CancelSigninDialog";case 1168274369:return"CheckTab";case 3134914741:return"CheckTabShift";case 3695056554:return"CheckUserAccessAndGrantPermissionsTest";case 2598811989:return"CheckUserAccessTest";case 2635327499:return"ClearSearch";case 241072808:return"ClearSearchFromSearchMenu";case 3033402446:return"Close";case 1895329487:return"CloseAccessibilityCheckerPane";case 1520278933:return"CloseEnrichmentPane";case 1530887760:return"CloseExtensionTaskPane";case 953328883:return"CloseSwitcher";case 691867605:return"CoauthorsRendered";case 3411172825:return"CommentActivityPreviewed";case 36098707:return"CommentActivitySelected";case 3259256685:return"CommentBeginRefresh";case 1637502579:return"CommentBeginRefreshRefused";case 863375655:return"CommentBeginSucceeded";case 1510212254:return"CommentCancelled";case 467845448:return"CommentDelete";case 375707647:return"CommentDone";case 3609945866:return"CommentDownloadFailed";case 159412208:return"CommentDownloadSucceeded";case 1951217806:return"CommentHintClick";case 2477668749:return"CommentHintMouseExit";case 4198211167:return"CommentHintMouseOver";case 1046295975:return"CommentNewCreated";case 2462410242:return"CommentNewSaved";case 4041287661:return"CommentReply";case 516537638:return"CommentSaveNetworkError";case 4156131848:return"CommentSaveRetry";case 1991982245:return"CommentSaveSucceeded";case 485487087:return"CommentTabBackward";case 2489743155:return"CommentTabForward";case 3103450156:return"CommentUndone";case 1808554760:return"CommitNewDocumentTitle";case 2609364291:return"ContactSupport";case 710925581:return"Conversation";case 1750478296:return"CopyAndEdit";case 3505086889:return"CopyLink";case 1278286187:return"CreateDocument";case 195579685:return"DecreaseZoom";case 1756450500:return"Definitions";case 2114287254:return"DefinitionsForTellMe";case 211953924:return"DialogAction";case 3756639316:return"DialogCancel";case 844297214:return"DialogClose";case 1245654357:return"DialogMove";case 646039090:return"DialogSecondaryAction";case 1825605114:return"DialogTertiaryAction";case 779285039:return"DigitalPrintToSwaySlabClicked";case 4275690876:return"DimeLaunch";case 3619977465:return"DismissNewCommentActivityIndicator";case 3113540593:return"DisposeCrossDocumentMessenger";case 537152338:return"DoBrowserDefault";case 1169404878:return"DocumentLoaded";case 336231556:return"DoNothing";case 1203133001:return"DoNothingInEdit";case 3555692408:return"DownloadACopy";case 2619015155:return"EditComment";case 2413704991:return"EndPinchToZoom";case 291542435:return"EditDocument";case 3280707168:return"ExecuteDynamicAddInCommandsAPI";case 1176360680:return"ExecuteUnitTests";case 2281252844:return"ExecuteUnitTestsBvt";case 1261644258:return"F6";case 715899390:return"F6shift";case 1754333801:return"FeedbackSubmit";case 3019354063:return"FeedbackCancel";case 3537588550:return"FileNameUpdate";case 512688659:return"FileProperties";case 981334692:return"FileSharing";case 3541645273:return"FindReplaceInDocument";case 1540292897:return"FindInDocument";case 2398455418:return"FindMatchCase";case 1783557e3:return"FindWholeWord";case 15750502:return"FireGetRelevantActivities";case 1486778386:return"FirstRunExperienceCompleted";case 3016992658:return"FirstRunExperienceFocusBackward";case 1501863744:return"FirstRunExperienceFocusForward";case 672565674:return"FirstRunExperienceShowUI";case 710478303:return"FocusToBrowser";case 348609604:return"FreemiumUpsellBadge";case 4180531998:return"FreemiumUpsellDialogShowUI";case 1274543852:return"FreemiumUpsellEligible";case 4288982261:return"GetAnimationStats";case 3890502328:return"GetUserContactsTest";case 3094869204:return"GetUserProfilePictureTest";case 802602464:return"GiveFeedback";case 577991405:return"GrantUserAccessTest";case 1454393937:return"Help";case 4065325971:return"HideActivityPane";case 1017511445:return"HideCatchUpFlyout";case 2493123577:return"HideCommentPane";case 1592314317:return"HideUILessDialog";case 3107136749:return"HostUnload";case 3018530951:return"IncreaseZoom";case 3545261133:return"InitializeCatchUpFlyout";case 3740310824:return"InitializeRenameUIHandler";case 3553159035:return"InsertAgaveFromOsf";case 56493533:return"InsertOfficeAddin";case 1435347209:return"Insights";case 3317204163:return"InsightsForTellMe";case 1914896509:return"InvokeSerplet";case 2670256092:return"InvokeFilesSerplet";case 3565729580:return"InvokeInDocSerplet";case 3799468329:return"IsJoined";case 2246375352:return"JoinChatThread";case 57698967:return"KeyManagerCommandUnitTest";case 407117407:return"LaunchAddInCommands";case 1945259303:return"LaunchAppForOfficeDialog";case 1784018444:return"LaunchFileMenu";case 951969558:return"LaunchMenu";case 1478840041:return"LaunchSigninWindow";case 2531463828:return"LaunchWildFireBusinessBar";case 2153376084:return"LivePersonaCardAction";case 1813655452:return"NavigateUrlInNewTab";case 2423504651:return"NewComment";case 1002198721:return"NewCommentActivityReady";case 1056925771:return"NewDocument";case 3266255548:return"NewReply";case 3506486948:return"NoTouchStart";case 1448619089:return"O365SwitcherReady";case 3389570779:return"OnDemandLoadingDialogCancelled";case 3963562945:return"OnDemandLoadingDialogCompleted";case 3476734992:return"OpenBasicChatPane";case 2068502235:return"OpenDocument";case 3427834559:return"OpenDocumentLabelPane";case 2596942163:return"OpenInBrowser";case 2683007645:return"OpenSwitcher";case 2349775795:return"OpenTermsOfUseLink";case 1959943459:return"OpenUrlInNewTab";case 628793421:return"OreoOnToggleRibbonState";case 3723784884:return"OtelSendSampleOfEvents";case 2888780028:return"OtelSendTelemetryEvents";case 1298584397:return"OtelSendTelemetryEventsPeriodically";case 929022654:return"CoauthoringCommand";case 3236517055:return"CoauthoringCommandMenuClose";case 250882013:return"CoauthoringCommandMenuOpen";case 1285265560:return"CoauthoringPopulateFlyout";case 3798167515:return"CoauthoringQueryStatus";case 2052777571:return"CoauthoringRefreshControl";case 4033456482:return"CoauthoringUserButtonClick";case 1397611854:return"PerformUserAuth";case 3675896289:return"PopulateDialogMenu";case 2799130311:return"PopulateMruMenu";case 2074131365:return"PopulateNewMenu";case 1145315516:return"PopulateSensitivityFlyout";case 3934434802:return"PreviewPanelTabBackward";case 1596970964:return"PreviewPanelTabForward";case 1208554566:return"PrivacyLink";case 3511208508:return"QueryActivateTranslatorApp";case 1309495434:return"QueryAddInCommandsLoadStatus";case 3847984948:return"QueryBreadcrumbDocName";case 3874562422:return"QueryBuildVersion";case 3720034241:return"QueryClearSearch";case 825574620:return"QueryCopyAndEditButton";case 1478537812:return"QueryDocChatButtonStatus";case 860152194:return"QueryEntitledAppsForOffice";case 3887408216:return"QueryEnvironmentName";case 1369572530:return"QueryFindMatchCase";case 3914542e3:return"QueryFindWholeWord";case 49122376:return"QueryPackageInitialized";case 497870830:return"QueryPolicyLabel";case 3134802707:return"QuerySensitivity";case 2875864574:return"QuerySensitivitySubFlyout";case 991261903:return"QuerySensitivityToggleButton";case 2793115165:return"QuerySessionId";case 1536028887:return"QuerySimplifiedRibbonIsEnabled";case 1557026322:return"QueryStaticUiTouchMode";case 1949220702:return"QueryToggleAccCheckerButton";case 1715205439:return"QueryToggleActivityPane";case 1059068017:return"QueryToggleCatchUpFlyout";case 847427893:return"QueryToggleCommentPane";case 433063458:return"QueryZoomText";case 2576944597:return"RaiseActionToHost";case 269161319:return"RebootUrlOnUiHost";case 2999339013:return"RedoCommentAction";case 543799107:return"RefreshAddinCommands";case 2854028228:return"RefreshChatControl";case 2924716042:return"RegionMoveBackward";case 1656936120:return"RegionMoveForward";case 741381681:return"RegisterAppActivatedEvent";case 1897077126:return"RenameFile";case 3502386740:return"RenameMostRecentlyUsedFileEntry";case 1197060601:return"ReplyWithChanges";case 3237171630:return"ReportAbuseLink";case 4248596885:return"ReportFileMenuPageAbout";case 1074909883:return"ReportFileMenuPageHome";case 127178350:return"ReportFileMenuPageInfo";case 1852071536:return"ReportFileMenuPageNew";case 2392426770:return"ReportFileMenuPageOpen";case 2971760737:return"ReportFileMenuPagePrint";case 4100738419:return"ReportFileMenuPageSaveAs";case 720070809:return"ReportFileMenuPageShare";case 4133531354:return"ReportFileMenuPageSwitch";case 3048126886:return"ReportFileMenuPageTransform";case 3865908344:return"ReportFileMenuPageUnknown";case 1509043591:return"ReportFreemiumUpsellBadgeClicked";case 975509583:return"ReportFreemiumUpsellBadgeDisplayed";case 3865601672:return"ReportFreemiumUpsellDialogClicked";case 2275483468:return"ReportFreemiumUpsellDialogDismissed";case 4142738798:return"ReportFreemiumUpsellDialogDisplayed";case 4177432571:return"ReportFreemiumUpsellEligibleClicked";case 2539564555:return"ReportFreemiumUpsellEligibleDisplayed";case 1355500294:return"ReportLegacyRibbonLoaded";case 1128336726:return"ReportMRUFromHomePage";case 105169305:return"ReportMRUFromOpenPage";case 4188650553:return"ReportOneLineRibbonLoaded";case 2050007412:return"ReportRibbonModeMLR";case 2050007578:return"ReportRibbonModeSLR";case 2363934117:return"ReportSwitchFromLegacyRibbon";case 422501225:return"ReportSwitchFromSimplifedRibbon";case 903886994:return"ReportTabAddins";case 1120156565:return"ReportTabChart";case 1449630229:return"ReportTabData";case 3221800135:return"ReportTabDeveloper";case 3099434941:return"ReportTabDrawing";case 3696531680:return"ReportTabFormulas";case 2625726220:return"ReportTabHelp";case 4191810468:return"ReportTabHome";case 469886678:return"ReportTabInsert";case 491924414:return"ReportTabPageLayout";case 3328108543:return"ReportTabReview";case 2527431031:return"ReportTabSwitch";case 3841439565:return"ReportTabUnknown";case 2652577546:return"ReportTabView";case 1240571126:return"ReportTemplateFromHomePage";case 3302080867:return"ReportTemplateFromNewPage";case 1323818969:return"RestartExtensionTaskPane";case 637959088:return"ResumeFocusWithDirection";case 1782110672:return"RetrieveAddInCommandsEntitlementsList";case 1596290176:return"RetryOpenInClient";case 4169072475:return"RibbonEsc";case 1047758638:return"RibbonFocus";case 1604566443:return"RibbonModeToggled";case 536345575:return"RibbonModeToggledToMLR";case 4031133701:return"RibbonModeToggledToSLR";case 1254348094:return"RibbonMoveBackward";case 2187030096:return"RibbonMoveForward";case 1308255763:return"RibbonStateChanged";case 3190032724:return"RibbonTabSwitched";case 4246497969:return"SaveACopy";case 2316717900:return"SaveAsToHost";case 3070187925:return"SaveFileChange";case 617689800:return"SaveToCloudStorage";case 3050207199:return"SaveToSharePoint";case 2918242107:return"SearchHelp";case 1873541548:return"SelectNextComment";case 4242021840:return"SelectPrevComment";case 2935633379:return"SetSensitivity";case 1384511460:return"SharedCommentsCancelCommentCreateThread";case 3401575755:return"SharedCommentsCommitComment";case 1426025625:return"SharedCommentsCommitDraft";case 2297956587:return"SharedCommentsCreateReply";case 3866509012:return"SharedCommentsCreateReplyWithMentions";case 2104859114:return"SharedCommentsCreateReplyWithTaskAssigned";case 2716070047:return"SharedCommentsCreateThread";case 355666834:return"SharedCommentsCreateThreadWithMentions";case 2470061772:return"SharedCommentsCreateThreadWithTaskAssigned";case 3191809076:return"SharedCommentsDeletePost";case 1912911518:return"SharedCommentsDeleteThread";case 1414137793:return"SharedCommentsDeleteThreadWithTask";case 1127700748:return"SharedCommentsDiscardDraft";case 243899744:return"SharedCommentsReopenThread";case 1615492167:return"SharedCommentsReopenThreadWithTask";case 738982675:return"SharedCommentsRequestInitCommentSession";case 537095687:return"SharedCommentsResolveThread";case 88639566:return"SharedCommentsResolveThreadWithTask";case 334636250:return"SharedCommentsSelectComment";case 2079612261:return"SharedCommentsUpdateCommentBodyAction";case 2529583086:return"ShowAccessibilityCheckerPane";case 3276527670:return"ShowAccessibilityHelpDialog";case 749424676:return"ShowActivityPane";case 516359383:return"ShowAddInCommandsLoadStatusCallout";case 2269104277:return"ShowAddInErrorDialog";case 4885028:return"ShowCatchUpFlyout";case 3510751882:return"ShowCommentPane";case 4284341431:return"ShowContextMenu";case 2269433685:return"ShowContextMenuWithFloatie";case 4193807224:return"ShowDialogMenu";case 2451283737:return"ShowExtensionTaskpane";case 3681556347:return"ShowFileVersion";case 459047735:return"ShowFloatie";case 2391539661:return"ShowFloatPane";case 1203507006:return"ShowGrantUserAccessDialog";case 2603175857:return"ShowInsightsForSuggestion";case 2382951455:return"ShowRenameDialog";case 2638199087:return"ShowRenameDisabledDialog";case 83993843:return"ShowSmartLookupForSuggestion";case 545765261:return"ShowSmartLookupFromCommand";case 2220417879:return"ShowThirdPartyNotices";case 2583751502:return"ShowTrustCenter";case 2517401660:return"ShowUILessDialog";case 466976539:return"ShowVersionHistoryDialog";case 1738002952:return"ShowZoomDialog";case 4196619892:return"SignIn";case 3231625709:return"SimulateO365ShellServiceReceived";case 606289265:return"SmartLookupForTellMe";case 1621589088:return"StartPinchToZoom";case 1550573691:return"SwitcherTileClick";case 380914761:return"TabSwitch";case 2652476189:return"TellMe";case 4054875485:return"TellMeAccessibilityMenuText";case 2751631965:return"TellMeCacheAsyncMenuRefresh";case 815990803:return"TellMeFocusInput";case 586156566:return"TellMeInteractionBegin";case 878547493:return"TellMeLogCommandExecuted";case 1024534176:return"TellMeLogInputBlur";case 2303219627:return"TellMeLogInputFocus";case 4266170064:return"TellMeLogMenuClose";case 2480888384:return"TellMeLogMenuOpen";case 1708531416:return"TellMeLogOfficeAppStatusQuery";case 3243793933:return"TellMeRestoreFocus";case 1404166600:return"TellMeTryQuery";case 1956545633:return"ToggleActivityPane";case 2145510275:return"ToggleAnimations";case 3418267371:return"ToggleCatchUpFlyout";case 2288458806:return"ToggleChatPane";case 2281051331:return"ToggleCommentPane";case 2758000563:return"ToggleRibbonState";case 2684863833:return"ToggleRibbonUX";case 1342108365:return"ToggleRibbonUXDialog";case 941487903:return"ToggleSensitivity";case 2478534165:return"TouchStart";case 1468994080:return"Training";case 3485513367:return"TriggerFloodgateSurvey";case 3901198658:return"TryMacOffice";case 1391456747:return"TryMacOfficeFromPowerPointViewer";case 201621520:return"TryMacOfficeFromWordViewer";case 1773624819:return"TryOffice";case 4268365028:return"TryOfficeFromPowerPointViewer";case 2578423837:return"TryOfficeFromWordViewer";case 215809929:return"TryOfficeThroughTellMe";case 3466807785:return"UndoCommentAction";case 2112877354:return"UpdateCommandUI";case 1852918846:return"UpdateSaveStatusForHeader";case 3649559640:return"UpdateVersionsPane";case 2424604265:return"UserSurveyCancel";case 3800318691:return"UserSurveySubmit";case 3329796304:return"SupportsExchangeRestApisTest";case 3182458430:return"VersionHistory";case 1255721029:return"WhatsNew";case 2988588587:return"Workflow";case 2910828042:return"ZoomDialogFocusBackward";case 2095185708:return"ZoomDialogFocusForward"}return null}},,,,function(e,t,n){"use strict";n.r(t),n.d(t,{JewelMenuLauncher:function(){return S}});var i=n(508),r=n(208),o=n(600),a=n(488),s=n(614),l=n(254),u=n(574),c=n(749),p=n(733),d=n(876),h=n(425),g=n(984),m=n(951),_=n(920),f=n(153),y=n(513),v=n(946),S=function(e){function t(t,n,i,o,a){var u=e.call(this,t,n,i,o)||this;return u._elmJewel=null,u._parentRoot=null,u._parentRoot=a,u.addDisplayMode("Default"),l.AFrameworkApplication.get_theActionManager().addAction(s.hA,g.a,r.i(u,u.launchFileMenu,"launchFileMenu")),u}return(0,i.t)(t,e),t.prototype.get_parentRoot=function(){return this._parentRoot},t.prototype.get_controlType=function(){return m.Control.jewelMenuLauncherControlType},t.prototype.createComponentDomForDisplayMode=function(e){var t,n,i,r;return this._elmJewel=m.Control.createStandardControlDOMElement(this,this.get_root(),e,this.get_properties$2(),!1,(0,o.m)((function(){return t}),(function(e){return t=e})),(0,o.m)((function(){return n}),(function(e){return n=e})),(0,o.m)((function(){return i}),(function(e){return i=e})),(0,o.m)((function(){return r}),(function(e){return r=e}))),this._elmJewel.className="cui-jewel-jewelMenuLauncher",l.AFrameworkApplication.get_activeFrame()&&l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()||(this._elmJewel.className+=" UITextTranformUpperCase"),this._elmJewel.id=this.get_properties$2().Id+"-Default",t.className="cui-jewel-label",t.innerText=this.get_properties$2().LabelText,this.setInitialAriaMenuLauncherAttributes(this._elmJewel),this.attachEvents(),new _.d(e,this._elmJewel)},t.prototype.attachEvents=function(){p.z.get_instance().registerHandler(u.d.pointerDown,this._elmJewel,r.i(this,this.onPointerDown,"onPointerDown")),c.KeyInputManager.get_instance().registerHandler(u.d.keyDown,this._elmJewel,r.i(this,this.onKeyDown,"onKeyDown")),c.KeyInputManager.get_instance().registerHandler(u.d.keyUp,this._elmJewel,r.i(this,this.onKeyUp,"onKeyUp"))},t.prototype.launchFileMenu=function(e,t,n,i,r){if(1===n)return 32;var o=0;return o=l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&r.hasOwnProperty("InputMethod")?r.InputMethod:r,l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactFileMenuUxEnabled()||this.launchMenu(o),l.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordTransformToWebPageSettings"),l.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWordReadOnlyRecommendedSettings"),32},t.prototype.launchMenu=function(e){this.launchMenuWithSubmenu(e)},t.prototype.launchMenuWithSubmenu=function(t,n){void 0===n&&(n=null),this.get_enabled()&&!this.menuLaunched&&(h.y.get_isInternetExplorer8()&&d.WacAirSpace.temporarilyDisableAnimation(1e3),l.AFrameworkApplication.dismissSplashScreenImmediately(),l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactFileMenuUxEnabled()?appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(!0)):(e.prototype.launchMenu.call(this,t),this.get_menu().get_elementInternal()&&(this.get_menu().get_elementInternal().style.position="fixed"),(1!==t||n)&&this.get_root().launchSubMenu(t,n)))},t.prototype.updateAriaMenuLauncherAttributes=function(t,n){l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()?appChrome.api.dispatch(appChrome.actions.updateFileMenuExpandedValue(n)):e.prototype.updateAriaMenuLauncherAttributes.call(this,t,n)},t.prototype.doDefaultAction=function(t,n,i){var o=this.get_parentRoot();r.r(f.Ribbon,o)&&o.dismissTabPopup();e.prototype.doDefaultAction.call(this,t,n,i)},t.prototype.onKeyDown=function(t){var n=!1;return y.x(t.innerEvent)||y.x(t.innerEvent.rawEvent)||(t.innerEvent.keyCode===Sys.UI.Key.down&&(this.doDefaultAction(t.get_sourceElement(),1,t.innerEvent),n=!0),n||(n=e.prototype.onKeyDown.call(this,t))),n},t.prototype.get_properties$2=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.dispose=function(){y.x(this._elmJewel)||v.n.unregisterAllHandlers(this._elmJewel),l.AFrameworkApplication.get_theActionManager().removeAction(s.hA,g.a,r.i(this,this.launchFileMenu,"launchFileMenu")),e.prototype.dispose.call(this),this._elmJewel=null},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i,e)},t}(a.MenuLauncher);(0,r.l)(S,"JewelMenuLauncher",a.MenuLauncher,[])},function(e,t,n){"use strict";n.r(t);var i=n(208),r=n(448),o=n(255),a=n(254),s=n(867),l=n(925),u=n(425),c=function(e){var t=0;switch(e){case"none":t=0;break;case"centimeter":t=1;break;case"character":t=2;break;case"inch":t=3;break;case"line":t=4;break;case"point":t=5;break;case"percent":t=6;break;case"pixels":t=7;break;case"timespan":t=8;break;case"degree":t=9;break;default:t=0}return t},p=function(){return function(e,t){this.units=null,this.specialTextStrings=null,this.units=e,this.specialTextStrings=t}}();(0,i.l)(p,"SpinnerChildren",null,[]);var d=n(176),h=function(){return function(){this.Color=null,this.DisplayColor=null,this.Title=null}}();(0,i.l)(h,"ColorCellInfo",null,[]);var g=n(958),m=n(34),_=n(50),f=n(697),y=n(317),v=n(230),S=n(508),C=n(951),b=n(127),A=n(248),T=n(920),w=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.buildControlDom=function(e,t){var n=C.Control.createOuterElement("cui-menuloading",e);n.setAttribute("aria-label",e.get_controlProperties().LabelText);var i=new A.k("");return n.appendChild(i.get_element()),new T.d(t,n)},t}(b.r);(0,i.l)(w,"LoadingIndicatorLabelDomStrategy",b.r,[]);var I=n(296),E=n(866),k=n(513),D=n(946),M=function(e){function t(){var t=e.call(this)||this;return t._innerLinkElement=null,t._control=null,t}return(0,S.t)(t,e),t.prototype.get_focusableElement=function(){return this._innerLinkElement},t.prototype.get_properties=function(){return this._control.get_controlProperties()},t.prototype.buildControlDom=function(e,t){this._control=e;var n=this.getSubsectionLabelClass(t),r=C.Control.createOuterElement(n,e),o=this.get_properties().LabelCss;if(k.x(o)||(r.style.cssText=o),"MenuSaveButton"===t||"MenuDiagnostics"===t){var a=D.n.createElement("span");if(a.appendChild(document.createTextNode(this.get_properties().LabelText)),a.className=String.format("{0} {1}","cui-ctl-mediumlabel","cui-btn-title"),i.r(E.Jewel,e.get_root())||(a.className+=" UIFontBold"),a.style.display="block",r.appendChild(a),this.get_properties().Description){var s=D.n.createElement("span");s.appendChild(document.createTextNode(this.get_properties().Description)),s.className="cui-btn-menu-description UIFont",r.appendChild(s),s.style.display="block"}}else this.updateElementInternal(r,this.get_properties().LabelText);var l=new T.d(t,r,this);return l.elmLabel=r,l},t.prototype.getSubsectionLabelClass=function(e){var t;switch(e){case"MenuFileName":t="cui-ctl-filenamelabel cui-menusection-filenametitle";break;case"MenuDiagnostics":t=String.format("{0} {1}","cui-menusection-diagnostics-label","cui-ctl-mediumlabel");break;default:t=String.format("{0} {1}","cui-ctl-mediumlabel","cui-menusection-subsectiontitle"),i.r(E.Jewel,this._control.get_root())||"MenuSaveButton"!==e||(t+=" cui-ctl-menu")}return t},t.prototype.updateLabel=function(e,t){return this.updateElementInternal(e,t),!0},t.prototype.updateElementInternal=function(e,t){t?(e.style.display="block",this._innerLinkElement=this.updateChildDomElements(e,t)):e.style.display="none"},t.prototype.updateChildDomElements=function(e,t){I.s.clearElement(e);var n,i=t.split("{0}");return this.concateChildNodesWithBr(e,i[0]),n=this.appendLinkChildNode(e),i.length>1&&this.concateChildNodesWithBr(e,i[1]),n},t.prototype.concateChildNodesWithBr=function(e,t){for(var n=0,i=t.split("\n");n<i.length;n++){var r=i[n],o=document.createElement("span");o.innerText=r,e.appendChild(o);var a=document.createElement("br");e.appendChild(a)}var s=e.lastChild;e.removeChild(s)},t.prototype.appendLinkChildNode=function(e){var t=null;if(this.get_properties().InnerLink&&this.get_properties().InnerLinkText){(t=D.n.createElement("a")).className="cui-subsectionlabellink",t.href=this.get_properties().InnerLink,t.target="_blank";var n=this.get_properties().InnerLinkTitle;n&&n.length>0&&(t.title=n),t.appendChild(document.createTextNode(this.get_properties().InnerLinkText)),e.appendChild(t)}return t},t}(b.r);(0,i.l)(M,"MenuSubsectionLabelDomStrategy",b.r,[]);var P=n(134),F=n(268),x=n(659),R=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.buildControlDom=function(e,t){var n=(new x.f).buildControlDom(e,t),i=F.r.isDisplayModeMenu(t),r="MediumCompact"===t;return this.setCssClasses(n.elmControl,i,r),this.setAccessibilityInfo(n.elmControl,i),this.setImageBackgroundColor(n.elmImage,e.get_controlProperties().ImageBackColor),this.setLabelForTarget(n.elmLabel,e.get_controlProperties().For),n},t.prototype.setCssClasses=function(e,t,n){e.className=n?"cui-fslb cui-ctl-compact":"cui-fslb",t&&(D.n.ensureCSSClassOnElement(e,"cui-ctl-menu"),D.n.ensureCSSClassOnElement(e,"cui-ctl-menu16"))},t.prototype.setAccessibilityInfo=function(e,t){e.tabIndex=-1,t||P.t.setAriaAttribute(e,"aria-hidden","true"),e.title=""},t.prototype.setImageBackgroundColor=function(e,t){e&&""!==t&&(e.style.backgroundColor=t)},t.prototype.setLabelForTarget=function(e,t){e&&!k.t(t)&&e.setAttribute("for",t)},t}(b.r);(0,i.l)(R,"StandardLabelDomStrategy",b.r,[]);var B=n(151),L=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r._focusableElement=null,r.addDisplayMode("Medium"),r.addDisplayMode("Medium14"),r.addDisplayMode("MediumCompact"),r.addDisplayMode("Small"),r.addDisplayMode("Small14"),r.addDisplayMode("Menu"),r.addDisplayMode("Menu16"),r.addDisplayMode("MenuMru"),r.addDisplayMode("MenuLoading"),r.addDisplayMode("MenuTemplate"),r.addDisplayMode("MenuTellMe"),r.addDisplayMode("MenuSaveAs"),r.addDisplayMode("MenuFileName"),r.addDisplayMode("MenuSaveButton"),r.addDisplayMode("MenuDiagnostics"),r.get_stateProperties()[B.i.Visible]=r.get_visible(),r}return(0,S.t)(t,e),t.prototype.get_focusableElement=function(){return this._focusableElement},t.prototype.createComponentDomForDisplayMode=function(e){var t=null,n=this.getDomElementCreationStrategy(e);return n&&(t=n.buildControlDom(this,e),this._focusableElement=n.get_focusableElement()),t},t.prototype.getDomElementCreationStrategy=function(e){switch(e){case"MenuMru":case"MenuTemplate":case"MenuSaveAs":case"MenuFileName":case"MenuSaveButton":case"MenuDiagnostics":return new M;case"MenuLoading":return new w;default:return new R}},t.prototype.get_controlType=function(){return C.Control.labelControlType},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n)},t}(C.Control);(0,i.l)(L,"Label",C.Control,[]);var N=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r._element=null,r}return(0,S.t)(t,e),t.prototype.ensureValidDisplayMode=function(e){},t.prototype.createComponentDomForDisplayMode=function(e){return this._element=D.n.createElement("span"),this._element.className="cui-ctl cui-placeholder",new T.d(e,this._element)},t.prototype.get_controlType=function(){return C.Control.placeholderControlType},t.prototype.pollForStateAndUpdate=function(){},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._element=null},t.prototype.get_properties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n)},t}(C.Control);(0,i.l)(N,"Placeholder",C.Control,[]);var U=n(488),O=n(547),H=n(36),W=n(427),V=n(574),$=n(66),K=n(749),z=n(733),q=(0,i.y)("IAriaNotifier"),Q=function(){function e(t){this._domContainer=null,this._politeRegion=null,this._assertiveRegion=null,this._alertRegion=null,this._domContainer=t,e.isInternetExplorerNonEdge=Sys.Browser.agent===Sys.Browser.InternetExplorer}return e.prototype.get_politeRegion=function(){return this._politeRegion||(this._politeRegion=this._domContainer.appendChild(e.createLiveRegion(this.getFullId("PoliteNotifier"))))},e.prototype.get_assertiveRegion=function(){return this._assertiveRegion||(this._assertiveRegion=this._domContainer.appendChild(e.createLiveRegion(this.getFullId("AssertiveNotifier"),"assertive")))},e.prototype.get_alertRegion=function(){return this._alertRegion||(this._alertRegion=this._domContainer.appendChild(e.createLiveRegion(this.getFullId("AlertNotifier"),"assertive","alert")))},e.prototype.getLiveRegion=function(e){return this.getLiveRegionInternal(e,!1)},e.prototype.sendNotification=function(e,t){this.sendNotificationInternal(e,t,!1)},e.prototype.sendNonInteruptiveNotification=function(e){this.sendNotificationInternal(e,!0,!0)},e.prototype.sendNotificationInternal=function(e,t,n){var i=this.getLiveRegionInternal(t,n);i.firstChild&&i.removeChild(i.firstChild),e&&i.appendChild(document.createTextNode(e))},e.prototype.getFullId=function(e){return String.format("{0}_{1}",this._domContainer.id,e)},e.prototype.getLiveRegionInternal=function(e,t){return t?this.get_alertRegion():e?this.get_assertiveRegion():this.get_politeRegion()},e.prototype.dispose=function(){this._domContainer.removeChild(this._politeRegion),this._politeRegion=null,this._domContainer.removeChild(this._assertiveRegion),this._assertiveRegion=null,this._domContainer.removeChild(this._alertRegion),this._alertRegion=null},e.createLiveRegion=function(t,n,i,r){void 0===n&&(n="polite"),void 0===i&&(i="marquee"),void 0===r&&(r=!0);var o=document.createElement("div");return o.id=t,o.setAttribute("role",i),e.isInternetExplorerNonEdge&&o.setAttribute("aria-label",""),o.setAttribute("aria-live",n),o.setAttribute("aria-atomic",r?"true":"false"),o.className="WACAriaLiveRegion",o},e.isInternetExplorerNonEdge=!1,e}();(0,i.l)(Q,"AriaNotifier",null,[q,Sys.IDisposable]);var G=function(){function e(e){this._input=null,this._input=e}return e.prototype.interactionEnd=function(){this._input.value=""},e}();(0,i.l)(G,"ClearInputOnInteractionEndModule",null,[]);var j=function(){function e(e,t,n,i){this._getControlComponent=null,this._root=null,this._properties=null,this._keyboardingState=null,this._root=e,this._properties=t,this._getControlComponent=n,this._keyboardingState=i}return e.prototype.onInputBlur=function(e,t){return this.executeCommand(this._properties.InputBoxBlurCommand,t),!1},e.prototype.onInputFocus=function(e,t){return this.executeCommand(this._properties.InputBoxFocusCommand,t),!1},e.prototype.onInteractionBegin=function(e,t){return this._properties.InteractionBeginCommand&&this.executeCommand(this._properties.InteractionBeginCommand,null),!1},e.prototype.onRestoreFocus=function(e,t){return this._keyboardingState.get_escaping()&&this.executeCommand(this._properties.RestoreFocusCommand,null),!1},e.prototype.executeCommand=function(e,t){var n=t?t.get_inputSource():0;this._root.executeCommand(e,{},this._getControlComponent(),n,!1)},e}();(0,i.l)(j,"FocusBlurEventsToCommandsAdapter",null,[]);var Z=(0,i.y)("IFocusableMenu"),X=n(657),J=function(){function e(e){this._searchBox=null,this._searchBox=e}return e.prototype.setFocus=function(e){return!(!this._searchBox.menuLaunched||!this._searchBox.get_menu())&&(this._searchBox.get_menu().setFocus(e),!0)},e.prototype.closeMenuStack=function(){this._searchBox.closeMenuStack()},e.prototype.blurInputField=function(){return X.FocusManager.tryBlur(this._searchBox.get_inputField())},e.prototype.get_escaping=function(){return this._searchBox.escaping},e.prototype.set_escaping=function(e){return this._searchBox.escaping=e,e},e.prototype.get_processingKeystroke=function(){return this._searchBox.get_processingKeystroke()},e.prototype.set_processingKeystroke=function(e){return this._searchBox.set_processingKeystroke(e),e},e}();(0,i.l)(J,"FocusableMenu",null,[Z]);var Y=function(){function e(e){this._target=null,this._target=e}return e.prototype.onKeyDown=function(e,t){if(!t||!t.innerEvent)return!1;var n=t.innerEvent.keyCode;return this.shouldMoveFocusToMenu(n)?this._target.setFocus(t.get_inputSource()):n===$.v.vK_Escape?(this._target.set_escaping(!0),this._target.closeMenuStack(),this._target.blurInputField()):(n===$.v.vK_Tab&&(this._target.set_processingKeystroke(!0),this._target.closeMenuStack()),!1)},e.prototype.shouldMoveFocusToMenu=function(e){return e===$.v.vK_Enter||e===$.v.vK_Down},e}();(0,i.l)(Y,"KeyboardNavigationModule",null,[]);var ee=(0,i.y)("IKeyboardingState"),te=function(){function e(e){this._searchBox=null,this._searchBox=e}return e.prototype.get_escaping=function(){return this._searchBox.escaping},e.prototype.set_escaping=function(e){return this._searchBox.escaping=e,e},e}();(0,i.l)(te,"KeyboardState",null,[ee]);var ne=function(){function e(t){this._adapter=null,this._oldInputText=null,this._oldInputText=e.defaultValue,this._adapter=t}return e.prototype.onInputKeyUp=function(t,n){var i=!1;return this._adapter.set_processingKeystroke(!0),this.textChanged()&&(this._adapter.get_inputText().trim()===e.defaultValue&&this._adapter.closeMenuStack(),this.updateMenu(n.get_inputSource()),i=!0),this._adapter.set_processingKeystroke(!1),i},e.prototype.updateMenu=function(e){this._oldInputText=this._adapter.get_inputText(),this._adapter.pollForResults(e)},e.prototype.onSearchButtonClick=function(e,t){return this._adapter.focusSearchbox()},e.prototype.onInteractionBegin=function(){this.updateMenu(0)},e.prototype.onInteractionEnd=function(){this.updateMenu(0)},e.prototype.textChanged=function(){return this._oldInputText!==this._adapter.get_inputText()},e.defaultValue="",e}();(0,i.l)(ne,"MenuUpdateModule",null,[]);var ie=function(){function e(e,t,n){this._input=null,this._placeHolderText=null,this._cssClass=null,this._placeholderTextActive=!1,this._input=e,this._placeHolderText=t,this._cssClass=n,this.onInputBlur(null,null)}return e.prototype.onInputBlur=function(e,t){return""===this._input.value&&(this._input.value=this._placeHolderText,this._placeholderTextActive=!0,D.n.ensureCSSClassOnElement(this._input,this._cssClass)),!1},e.prototype.onInputFocus=function(e,t){return this._placeholderTextActive&&(this._input.value="",this._placeholderTextActive=!1,D.n.removeCSSClassFromElement(this._input,this._cssClass)),!1},e}();(0,i.l)(ie,"PlaceholderTextModule",null,[]);var re=(0,i.y)("IUpdateableMenu"),oe=function(){function e(e){this._searchBox=null,this._searchBox=e}return e.prototype.closeMenuStack=function(){this._searchBox.closeMenuStack()},e.prototype.pollForResults=function(e){this._searchBox.pollForResults(e)},e.prototype.focusSearchbox=function(){return X.FocusManager.tryFocus(this._searchBox.get_inputField())},e.prototype.get_inputText=function(){return this._searchBox.get_inputText()},e.prototype.get_processingKeystroke=function(){return this._searchBox.get_processingKeystroke()},e.prototype.set_processingKeystroke=function(e){return this._searchBox.set_processingKeystroke(e),e},e}();(0,i.l)(oe,"SeachBoxToUpdateableMenu",null,[re]);var ae=function(){function e(){this._handlers=[]}return e.prototype.addHandler=function(e){Array.add(this._handlers,e)},e.prototype.removeHandler=function(e){Array.remove(this._handlers,e)},e.prototype.raiseEvent=function(e,t){for(var n=0,i=this._handlers;n<i.length;n++){var r=i[n];if(r&&r(t,e))return!0}return!1},e}();(0,i.l)(ae,"EventChain",null,[]);var se=function(){function e(){this._eventMap=null,this._eventMap={}}return e.prototype.addHandler=function(e,t){this._eventMap[e]||(this._eventMap[e]=new ae),this._eventMap[e].addHandler(t)},e.prototype.removeHandler=function(e,t){this._eventMap[e]&&this._eventMap[e].removeHandler(t)},e.prototype.raiseEvent=function(e,t,n){var i=this._eventMap[e];return!!i&&i.raiseEvent(t,n)},e.prototype.dispose=function(){this._eventMap=null},e}();(0,i.l)(se,"SearchBoxEventSource",null,[Sys.IDisposable]);var le=n(286),ue=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.topLevelElement=null,o.inputField=null,o._imageMask=null,o._searchButton=null,o.searchIcon=null,o._ariaNotifier=null,o._currentImageClass=null,o.inputHasFocus=!1,o.mouseIsOver=!1,o._eventSource=null,o.processingKeystroke=!1,o.escaping=!1,o.addDisplayMode("Medium"),o.set_sendFocusToMenuDrop(!1),n===O.CuiHelper.tellMeSearchBoxId&&(o.get_stateProperties().TakeFocusOnMenuNavigationEnd=!0),o._eventSource=new se,o}return(0,S.t)(t,e),t.prototype.get_topLevelElement=function(){return this.topLevelElement},t.prototype.get_inputField=function(){return this.inputField},t.prototype.get_inputHasFocus=function(){return this.inputHasFocus},t.prototype.get_mouseIsOver=function(){return this.mouseIsOver},t.prototype.get_searchBoxBehavior=function(){return this.behavior},t.prototype.get_additionalMenuCssClass=function(){return"cui-sb-menu"},t.prototype.get_controlType=function(){return C.Control.searchBoxControlType},t.prototype.get_ariaRole=function(){return"SearchBox"},t.prototype.createComponentDomForDisplayMode=function(e){this.topLevelElement=D.n.createElement("span"),D.n.ensureCSSClassOnElement(this.get_topLevelElement(),"cui-sb");var t=a.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMeRedesignIsEnabled");return t&&D.n.ensureCSSClassOnElement(this.get_topLevelElement(),"tellme-flight"),this.get_topLevelElement().setAttribute("mscui:controltype",this.get_controlType()),D.n.addToTabLoop(this.get_topLevelElement()),this.get_topLevelElement().tabIndex=-1,this.inputField=D.n.createSelectableElement("input"),D.n.ensureCSSClassOnElement(this.get_inputField(),"cui-sb-input"),this.get_inputField().setAttribute("data-lpignore","true"),t&&D.n.ensureCSSClassOnElement(this.get_inputField(),"tellme-flight"),this.get_inputField().type="text",this.get_inputField().setAttribute("Autocomplete","off"),this.get_inputField().style.width=this.get_sbProperties().Width,this.get_inputField().id=this.get_sbProperties().Id,this.get_inputField().title=this.get_sbProperties().Alt,this.get_inputField().setAttribute("maxlength","256"),this.get_inputField().setAttribute("tabindex","0"),this._searchButton=D.n.createElement("a"),this._searchButton.setAttribute(P.t.ariaHiddenAttribute,P.t.ariaTrueValue),this._searchButton.id=this.get_id()+"-icon",this._searchButton.tabIndex=-1,this.searchIcon=D.n.createElement("img"),this._ariaNotifier=new Q(this.get_topLevelElement()),D.n.ensureCSSClassOnElement(this._searchButton,"cui-sb-image-button"),t&&D.n.ensureCSSClassOnElement(this._searchButton,"tellme-flight"),this._currentImageClass=t?this.get_sbProperties().DarkImage16by16Class:this.get_sbProperties().Image16by16Class,this._imageMask=D.n.createClusteredImageContainerNew(4,this.get_sbProperties().Image16by16,this._currentImageClass,this.searchIcon,!0,!1),D.n.ensureCSSClassOnElement(this._imageMask,"sb-img"),t&&this.get_topLevelElement().appendChild(this._searchButton),this._searchButton.appendChild(this._imageMask),this.get_topLevelElement().appendChild(this.get_inputField()),t||this.get_topLevelElement().appendChild(this._searchButton),this.attachEvents(),this.attachModules(),new T.d(e,this.get_topLevelElement())},t.prototype.ensureKeytipForControl=function(e,t){e.ensureKeytip(t,this.get_inputField(),this.parentKeytipsIds,this.parentKeytipsKeys)},t.prototype.attachModules=function(){var e=this,n=new ne(new oe(this));this.add_onInputKeyUp(i.i(n,n.onInputKeyUp,"onInputKeyUp")),this.add_onSearchButtonClick(i.i(n,n.onSearchButtonClick,"onSearchButtonClick"));var r=new j(this.get_root(),this.get_sbProperties(),(function(){return e.get_displayedComponent()}),new te(this));this.add_onInputBlur(i.i(r,r.onInputBlur,"onInputBlur")),this.add_onInputFocus(i.i(r,r.onInputFocus,"onInputFocus")),this.add_onInteractionBegin(i.i(r,r.onInteractionBegin,"onInteractionBegin")),this.add_onInteractionEnd(i.i(r,r.onRestoreFocus,"onRestoreFocus"));var o=new Y(new J(this));this.add_onInputKeyDown(i.i(o,o.onKeyDown,"onKeyDown"));var a=new G(this.get_inputField());if(this.add_onInteractionEnd(t.actionToEventDelegate(i.i(a,a.interactionEnd,"interactionEnd"))),this.add_onInteractionEnd(t.actionToEventDelegate(i.i(n,n.onInteractionEnd,"onInteractionEnd"))),this.add_onInteractionBegin(t.actionToEventDelegate(i.i(n,n.onInteractionBegin,"onInteractionBegin"))),"placeholder"in this.get_inputField())this.get_inputField().setAttribute("placeholder",this.get_sbProperties().PlaceholderText);else{var s=new ie(this.get_inputField(),this.get_sbProperties().PlaceholderText,"cui-sb-placeholder");this.add_onInputBlur(i.i(s,s.onInputBlur,"onInputBlur")),this.add_onInputFocus(i.i(s,s.onInputFocus,"onInputFocus"))}this.add_onMenuChange(i.i(this,this.onMenuChangedAriaNotification,"onMenuChangedAriaNotification")),this.add_onInputKeyDown((function(e,t){return D.n.preventDefaultKeyAction(t,$.v.vK_Esc)})),this.add_onInputKeyDown((function(t,n){return U.MenuLauncher.prototype.onKeyDown.call(e,n)})),this.add_onInputKeyUp((function(t,n){return C.Control.prototype.onKeyUp.call(e,n)}))},t.prototype.attachEvents=function(){H.z.get_instance().registerHandler(V.d.focus,this.get_inputField(),i.i(this,this.onInputBoxFocus,"onInputBoxFocus")),H.z.get_instance().registerHandler(V.d.blur,this.get_inputField(),i.i(this,this.onInputBoxBlur,"onInputBoxBlur")),K.KeyInputManager.get_instance().registerHandler(V.d.keyDown,this.get_inputField(),i.i(this,this.onKeyDown,"onKeyDown")),K.KeyInputManager.get_instance().registerHandler(V.d.keyUp,this.get_inputField(),i.i(this,this.onKeyUp,"onKeyUp")),z.z.get_instance().registerHandler(V.d.pointerOver,this.get_topLevelElement(),i.i(this,this.onSearchContainerMouseOver,"onSearchContainerMouseOver")),z.z.get_instance().registerHandler(V.d.pointerOut,this.get_topLevelElement(),i.i(this,this.onSearchContainerMouseOut,"onSearchContainerMouseOut")),W.s.get_instance().registerHandler(V.d.click,this._searchButton,i.i(this,this.onButtonClick,"onButtonClick"))},t.prototype.raiseEvent=function(e,t){this._eventSource.raiseEvent(e,t)},t.prototype.addHandler=function(e,t){this._eventSource.addHandler(e,t)},t.prototype.removeHandler=function(e,t){this._eventSource.removeHandler(e,t)},t.prototype.add_onInputBlur=function(e){this.addHandler(le.t.blur,e)},t.prototype.remove_onInputBlur=function(e){this.removeHandler(le.t.blur,e)},t.prototype.add_onInputFocus=function(e){this.addHandler(le.t.focus,e)},t.prototype.remove_onInputFocus=function(e){this.removeHandler(le.t.focus,e)},t.prototype.add_onInputKeyUp=function(e){this.addHandler(le.t.keyUp,e)},t.prototype.remove_onInputKeyUp=function(e){this.removeHandler(le.t.keyUp,e)},t.prototype.add_onInputKeyDown=function(e){this.addHandler(le.t.keyDown,e)},t.prototype.remove_onInputKeyDown=function(e){this.removeHandler(le.t.keyDown,e)},t.prototype.add_onSearchButtonClick=function(e){this.addHandler(le.t.click,e)},t.prototype.remove_onSearchButtonClick=function(e){this.removeHandler(le.t.click,e)},t.prototype.add_onMenuChange=function(e){this.addHandler(le.t.menuChanged,e)},t.prototype.remove_onMenuChange=function(e){this.removeHandler(le.t.menuChanged,e)},t.prototype.add_onInteractionBegin=function(e){this.addHandler(le.t.interactionBegin,e)},t.prototype.remove_onInteractionBegin=function(e){this.removeHandler(le.t.interactionBegin,e)},t.prototype.add_onInteractionEnd=function(e){this.addHandler(le.t.interactionEnd,e)},t.prototype.remove_onInteractionEnd=function(e){this.removeHandler(le.t.interactionEnd,e)},t.prototype.onSearchContainerMouseOver=function(e){return this.mouseIsOver=!0,this.get_searchBoxBehavior()&&this.get_searchBoxBehavior().onSearchContainerMouseOver(e),!1},t.prototype.onSearchContainerMouseOut=function(e){return this.mouseIsOver=!1,this.get_searchBoxBehavior()&&this.get_searchBoxBehavior().onSearchContainerMouseOut(e),!1},t.prototype.onInputBoxBlur=function(e){return this.inputHasFocus=!1,this.get_searchBoxBehavior()&&this.get_searchBoxBehavior().onInputBoxBlur(e),!1},t.prototype.onInputBoxFocus=function(e){return this.inputHasFocus=!0,this.escaping=!1,this.set_processingKeystroke(!1),this._ariaNotifier.sendNotification("",!1),this.get_searchBoxBehavior()&&this.get_searchBoxBehavior().onInputBoxFocus(e),!1},t.prototype.onKeyUp=function(e){return this.get_searchBoxBehavior()&&this.get_searchBoxBehavior().raiseInteractionBegin(),this._eventSource.raiseEvent(le.t.keyUp,e)},t.prototype.onKeyDown=function(e){return this.get_searchBoxBehavior()&&this.get_searchBoxBehavior().raiseInteractionBegin(),this._eventSource.raiseEvent(le.t.keyDown,e)},t.prototype.onButtonClick=function(e){return this.get_searchBoxBehavior()&&this.get_searchBoxBehavior().raiseInteractionBegin(),this._eventSource.raiseEvent(le.t.click,e)},t.prototype.onMenuChanged=function(){this._eventSource.raiseEvent(le.t.menuChanged,null)},t.prototype.launchMenu=function(t){e.prototype.launchMenu.call(this,t)},t.prototype.closeMenu=function(e){void 0===e&&(e=!0),this.get_searchBoxBehavior()&&this.get_searchBoxBehavior().closeMenu()},t.prototype.closeMenuStack=function(){this.menuLaunched&&this.get_root().closeMenuStack(this),this.get_searchBoxBehavior()&&this.get_searchBoxBehavior().raiseInteractionEnd()},t.prototype.onMenuChangedAriaNotification=function(e,t){return this._ariaNotifier.sendNotification(this.getAccessibiltyText(),!1),!1},t.prototype.pollForResults=function(e){this.sendNotifyAsyncMenuTrigger(),this.pollForDynamicMenu(e)},t.prototype.refreshMenu=function(){this.menuLaunched?e.prototype.refreshMenu.call(this):this.get_inputHasFocus()&&this.launchMenu(0)},t.prototype.getCommandPopulateProperties=function(){var e={};return e.Value=this.get_inputField().value,e},t.prototype.get_inputText=function(){return this.get_inputField().value},t.prototype.set_inputText=function(e){return this.get_inputField().value=e,e},t.prototype.get_processingKeystroke=function(){return this.processingKeystroke},t.prototype.set_processingKeystroke=function(e){return this.processingKeystroke=e,e},t.prototype.get_sbProperties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.getAccessibiltyText=function(){var e={};return this.get_root().executeCommand(this.get_sbProperties().AccessibilityTextCommand,e,this.get_displayedComponent(),0,!1),e.Value},t.prototype.doDefaultAction=function(e,t,n){var i={};i.Value=this.get_inputField().value,this.get_root().executeCommand(this.get_sbProperties().Command,i,this.get_displayedComponent(),t,!1)},t.prototype.get_focusableElement=function(){return this.get_inputField()},t.prototype.notifyCommandExecuted=function(e,t){if(this.get_searchBoxBehavior()){var n=this.get_sbProperties().MenuControlExecutedCommand;this.get_searchBoxBehavior().notifyCommandExecuted(e,t,this.get_topLevelElement(),n)}},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t.prototype.get_isEditable=function(){return!0},t.actionToEventDelegate=function(e){return function(t,n){return e(),!1}},t.maxCharacterLimit=256,t}(U.MenuLauncher);(0,i.l)(ue,"SearchBox",U.MenuLauncher,[]);var ce=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r._elmSmall=null,r.addDisplayMode("Small"),r}return(0,S.t)(t,e),t.prototype.createComponentDomForDisplayMode=function(e){return this._elmSmall=D.n.createElement("span"),this._elmSmall.className="cui-separator",new T.d(e,this._elmSmall)},t.prototype.get_controlType=function(){return C.Control.separatorControlType},t.prototype.pollForStateAndUpdate=function(){this.set_enabled(!0)},t.prototype.dispose=function(){e.prototype.dispose.call(this),this._elmSmall=null},t.prototype.get_properties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n)},t}(C.Control);(0,i.l)(ce,"Separator",C.Control,[]);var pe=function(e){function t(t){var n=e.call(this,t)||this;return n.elmInput=null,n}return(0,S.t)(t,e),t}(T.d);(0,i.l)(pe,"SliderComponentDom",T.d,[]);var de=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.sliderDom=null,r.addDisplayMode("Large"),r}return(0,S.t)(t,e),t.prototype.get_sliderDom=function(){return this.sliderDom},t.prototype.createComponentDomForDisplayMode=function(e){return this.sliderDom=this.buildSliderDom(e),this.get_sliderDom()},t.prototype.buildSliderDom=function(t){var n,i,r;(n=D.n.createElement("span")).className="cui-sldr",n.setAttribute("mscui:controltype",this.get_controlType()),(i=D.n.createSelectableElement("input")).type="range",i.className="cui-sldr-input",i.id=e.prototype.get_controlProperties.call(this).Id,i.value=e.prototype.get_controlProperties.call(this).Value,(r=D.n.createElement("span")).className="cui-ctl-largelabel",D.n.setLargeControlText(r,e.prototype.get_controlProperties.call(this).LabelText,!1),r.id=e.prototype.get_controlProperties.call(this).LabelId,n.appendChild(i),n.appendChild(r);var o=new pe(t);return o.elmControl=n,o.elmInput=i,o.elmLabel=r,o},t.prototype.get_controlType=function(){return C.Control.sliderControlType},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n)},t}(C.Control);(0,i.l)(de,"Slider",C.Control,[]);var he=function(e){function t(t){var n=e.call(this,t)||this;return n.elmInput=null,n.elmUpArrow=null,n.elmDownArrow=null,n.elmUpArrowImageContainer=null,n.elmDownArrowImageContainer=null,n.elmUpArrowImage=null,n.elmDownArrowImage=null,n}return(0,S.t)(t,e),t}(T.d);(0,i.l)(he,"SpinnerComponentDom",T.d,[]);var ge=function(){function e(e,t,n,i){this._type=0,this._min=0,this._max=0,this._step=0,this._type=e,this._min=t,this._max=n,this._step=i}return e.prototype.normalizeNumber=function(e){return e<this._min?this._min:e>this._max?this._max:e},e.prototype.get_type=function(){return this._type},e.prototype.get_min=function(){return this._min},e.prototype.get_max=function(){return this._max},e.prototype.set_max=function(e){return this._max=e,e},e.prototype.get_step=function(){return this._step},e}();(0,i.l)(ge,"Unit",null,[]);var me=function(e){function t(t,n,i,r,o){var a=e.call(this,t,n,i)||this;return a.spinnerDom=null,a.validUnits=null,a.validSpecialStrings=null,a.addDisplayMode("Medium"),a.validUnits=r,a.validSpecialStrings=o,a.behavior&&a.behavior.initialize(),a}return(0,S.t)(t,e),t.prototype.get_spinnerDom=function(){return this.spinnerDom},t.prototype.get_validUnits=function(){return this.validUnits},t.prototype.get_validSpecialStrings=function(){return this.validSpecialStrings},t.prototype.createComponentDomForDisplayMode=function(e){return this.spinnerDom=this.buildSpinnerDom(e),this.get_spinnerDom()},t.prototype.ensureKeytipForControl=function(e,t){e.ensureKeytip(t,this.get_spinnerDom().elmInput,this.parentKeytipsIds,this.parentKeytipsKeys)},t.prototype.buildSpinnerDom=function(e){var t,n,i,r,o,a,s,l;(t=D.n.createElement("span")).className="cui-spn",t.setAttribute("mscui:controltype",this.get_controlType()),t.setAttribute(P.t.ariaRoleAttribute,P.t.ariaPresentationRole),(n=D.n.createSelectableElement("input")).className="cui-spn-txtbx",n.id=this.get_id(),n.setAttribute("role","spinbutton"),n.setAttribute("type","text"),n.setAttribute("autocomplete","off"),n.setAttribute("data-lpignore","true"),t.appendChild(n);var u=D.n.createElement("span");u.className="cui-spn-arwbx",t.appendChild(u),(i=D.n.createElement("span")).className="cui-spn-btnup",i.setAttribute(P.t.ariaHiddenAttribute,"true"),u.appendChild(i),(r=D.n.createElement("span")).className="cui-spn-btndown",r.setAttribute(P.t.ariaHiddenAttribute,"true"),u.appendChild(r),(o=D.n.createElement("img")).alt="",1===this.get_root().get_textDirection()&&(n.style.direction="rtl"),s=this.get_isVisualRefreshEnabled()?D.n.createClusteredImageContainerNew(2,this.get_root().get_properties().ImageUpArrow8by8,this.get_root().get_properties().ImageUpArrow8by8Class,o,!0,!1):D.n.createClusteredImageContainerNew(1,this.get_root().get_properties().ImageUpArrow,this.get_root().get_properties().ImageUpArrowClass,o,!0,!1),D.n.ensureCSSClassOnElement(s,"cui-spn-imgcnt"),i.appendChild(s),(a=D.n.createElement("img")).alt="",l=this.get_isVisualRefreshEnabled()?D.n.createClusteredImageContainerNew(2,this.get_root().get_properties().ImageDownArrow8by8,this.get_root().get_properties().ImageDownArrow8by8Class,a,!0,!1):D.n.createClusteredImageContainerNew(1,this.get_root().get_properties().ImageDownArrow,this.get_root().get_properties().ImageDownArrowClass,a,!0,!1),D.n.ensureCSSClassOnElement(l,"cui-spn-imgcnt"),r.appendChild(l);var c=this.get_properties().Alt;k.x(c)||(n.title=c);var p=this.get_properties().Width;k.x(p)||(n.style.width=p);var d=new he(e);d.elmControl=t,d.elmInput=n,d.elmUpArrow=i,d.elmDownArrow=r,d.elmUpArrowImage=o,d.elmDownArrowImage=a,d.elmUpArrowImageContainer=s,d.elmDownArrowImageContainer=l;var h=this.get_properties().LabelledBy;return k.x(h)||n.setAttribute("aria-labelledby",h),d},t.prototype.get_controlType=function(){return C.Control.spinnerControlType},t.prototype.get_needsAKeytip=function(){return!0},t.prototype.get_focusableElement=function(){return this.get_spinnerDom()?this.get_spinnerDom().elmInput:null},t.prototype.get_properties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.commitPendingChange=function(){this.behavior&&this.behavior.commitPendingChange()},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n,this.get_validUnits(),this.get_validSpecialStrings())},t.prototype.get_isEditable=function(){return!0},t.createUnit=function(e,t,n,i){return new ge(e,t,n,i)},t}(C.Control);(0,i.l)(me,"Spinner",C.Control,[]);var _e=n(600),fe=function(e){function t(t){var n=e.call(this,t)||this;return n.elmButtonPart=null,n.elmMenuLauncherPart=null,n}return(0,S.t)(t,e),t.prototype.onImageLoad=function(){this.internalImageLoadHandler()},t.prototype.internalImageLoadHandler=function(){},t}(T.d);(0,i.l)(fe,"SplitButtonComponentDom",T.d,[]);var ye=function(){function e(){}return e.prototype.buildControlDom=function(e,t){var n=new fe(t);return this.populateControlDom(n,e,t),n},e.prototype.populateControlDom=function(t,n,i){var r,o,a,s=e.createTwoAnchorControlDOMElement(n,n.get_root(),i,n.get_properties$2(),!0,(0,_e.m)((function(){return r}),(function(e){return r=e})),(0,_e.m)((function(){return o}),(function(e){return o=e})),(0,_e.m)((function(){return a}),(function(e){return a=e})));$addHandler(a,"load",(function(){t.onImageLoad()})),t.elmControl=s,t.elmImage=a,t.elmButtonPart=r,t.elmMenuLauncherPart=o},e.createTwoAnchorControlDOMElement=function(e,t,n,i,r,o,a,s){var l=i.LabelText;k.x(l)&&(l="");var u=D.n.createElement("span");u.className="Large"===n?"cui-ctl-large":"Medium"===n?"cui-ctl cui-ctl-medium":"Medium20"===n?"cui-ctl cui-ctl-medium20 cui-ctl-medium":"cui-ctl cui-ctl-small",u.setAttribute("mscui:controltype",e.get_controlType()),u.setAttribute("aria-expanded","false");var c=D.n.createNoOpLink(),p=D.n.createNoOpLink();c.className="cui-ctl-a1",p.className="cui-ctl-a2",u.setAttribute("role",e.get_ariaRole()),P.t.setAriaAttribute(u,"aria-haspopup","true"),c.setAttribute("role","button"),p.setAttribute("role","button"),p.setAttribute("aria-expanded","false"),P.t.setAriaAttribute(p,"aria-haspopup","true");var d=D.n.createElement("span");d.className="cui-ctl-a1Internal",s.val=D.n.createElement("img");var h=null,g=null,m=0;s.val.alt="";var _=i.Alt;k.x(_)&&(_=l),u.title=_,("Medium"!==n&&"Medium20"!==n||_!==l)&&(c.title=_),"Large"===n&&_===l||(p.title=_),"Large"===n||"Menu32"===n?(h=i.Image32by32,g=i.Image32by32Class,m=5):"Medium20"===n?(h=i.Image20by20,g=i.Image20by20Class,m=13):(h=i.Image16by16,g=i.Image16by16Class,m=4);var f=D.n.createClusteredImageContainerNew(m,h,g,s.val,!0,!1),y=null;("Small"!==n&&"Small14"!==n||r)&&(y=D.n.createElement("span"),"Small"!==n&&"Small14"!==n&&("Large"===n?(D.n.ensureCSSClassOnElement(y,"cui-ctl-largelabel"),D.n.setLargeControlText(y,l,r)):"Medium"!==n&&"Medium20"!==n||(D.n.ensureCSSClassOnElement(y,"cui-ctl-mediumlabel"),y.innerText=l)));var v=null;if(r){var S=D.n.createElement("img");S.alt="",v=e.get_isVisualRefreshEnabled()?D.n.createClusteredImageContainerNew(2,t.get_properties().ImageDownArrow8by8,t.get_properties().ImageDownArrow8by8Class,S,!0,!1):D.n.createClusteredImageContainerNew(1,t.get_properties().ImageDownArrow,t.get_properties().ImageDownArrowClass,S,!0,!1)}return u.appendChild(c),u.appendChild(p),c.appendChild(d),d.appendChild(f),k.x(y)||("Large"===n?p.appendChild(y):d.appendChild(y)),k.x(v)||("Large"===n?y.appendChild(v):p.appendChild(v)),u.tabIndex=0,c.tabIndex=-1,p.tabIndex=-1,o.val=c,a.val=p,u},e}();(0,i.l)(ye,"SplitButtonDomStrategy",null,[]);var ve=n(921),Se=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.addDisplayMode("Large"),o.addDisplayMode("Medium"),o.addDisplayMode("Medium20"),o.addDisplayMode("Small"),o.addDisplayMode("Menu32"),o.addDisplayMode("Menu16"),o.addDisplayMode("Menu"),o.addDisplayMode("MenuTellMe"),o.set_on(!1),o}return(0,S.t)(t,e),t.prototype.createComponentDomForDisplayMode=function(e){return(new ye).buildControlDom(this,e)},t.prototype.forEachSplitButtonComponentDom=function(e){this.get_controlComponentDomCache().forEach((function(t){e(t)}))},t.prototype.onStateChanged=function(){this.setState(this.get_on()&&this.get_enabled())},t.prototype.get_displayedButtonElement=function(){var e=this.getDisplayedControlDom();return e?e.elmButtonPart:null},t.prototype.get_displayedButtonImageElement=function(){var e=this.getDisplayedControlDom();return e?e.elmImage:null},t.prototype.get_controlType=function(){return C.Control.splitButtonControlType},t.prototype.get_on=function(){return!!D.n.isTrue(this.get_properties$2().IsToggleSplit)&&this.get_stateProperties()[ve.z.On]},t.prototype.set_on=function(e){return D.n.isTrue(this.get_properties$2().IsToggleSplit)&&(this.get_stateProperties()[ve.z.On]=e,this.setState(e&&this.get_enabled())),e},t.prototype.setState=function(e){var t=this;D.n.isTrue(this.get_properties$2().IsToggleSplit)&&this.forEachSplitButtonComponentDom((function(n){t.toggleCssClass(n,"cui-ctl-on",e)}))},t.prototype.toggleCssClass=function(e,t,n){D.n.toggleCSSClassOnElement(e.elmControl,t,n),D.n.toggleCSSClassOnElement(e.elmButtonPart,t,n),D.n.toggleCSSClassOnElement(e.elmMenuLauncherPart,t,n),this.updateAriaMenuLauncherPressedAttribute(e.elmControl,n),this.updateAriaMenuLauncherPressedAttribute(e.elmButtonPart,n)},t.prototype.get_properties$2=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.updateAriaMenuLauncherPressedAttribute=function(e,t){P.t.setAriaAttribute(e,P.t.ariaPressedAttribute,t?P.t.ariaTrueValue:P.t.ariaFalseValue)},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t.prototype.constructClonedMenuLauncherForMenu=function(e,t,n){return new f.FlyoutAnchor(e,this.get_id(),t,n)},t.prototype.getDisplayedControlDom=function(){var e=this.get_displayedComponent();return e?this.get_controlComponentDomCache().get_item(e.get_displayMode()):null},t}(U.MenuLauncher);(0,i.l)(Se,"SplitButton",U.MenuLauncher,[]);var Ce=(0,i.y)("IIconColorFormatManager"),be=n(351),Ae=n(556),Te=function(e){function t(t){var n=e.call(this,t)||this;return n.elmCanvasPart=null,n}return(0,S.t)(t,e),t}(T.d);(0,i.l)(Te,"StatefulColorFlyoutAnchorComponentDom",T.d,[]);var we=function(){function e(e){void 0===e&&(e=!0),this.hasArrow=!1,this.hasArrow=e}return e.prototype.buildControlDom=function(e,t){var n=new Te(t);return n.elmControl=C.Control.createStandardControlDOMElement(e,e.get_root(),t,e.get_controlProperties(),this.hasArrow,(0,_e.m)((function(){return n.elmLabel}),(function(e){return n.elmLabel=e})),(0,_e.m)((function(){return n.elmImage}),(function(e){return n.elmImage=e})),(0,_e.m)((function(){return n.elmDescription}),(function(e){return n.elmDescription=e})),(0,_e.m)((function(){return n.elmIconContainer}),(function(e){return n.elmIconContainer=e}))),this.populateCanvasElement(n,t),n},e.prototype.populateCanvasElement=function(e,t){if(e.elmCanvasPart=null,6===C.Control.getControlSize(t))if(e.elmImage){var n=e.elmImage.parentNode,i=D.n.createElement("canvas");if(i){i.height=16,i.width=16;var r=i.getContext("2d");if(r)try{r.clearRect(0,0,i.width,i.height),n.appendChild(i),e.elmCanvasPart=i}catch(e){o.ULS.sendTraceTag(40421410,207,15,String.format("StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: a 2d context operation of appending the canvas to StatefulColorFlyoutAnchorComponentDom.ElmImage failed. Exception message: {0}",e.message))}else o.ULS.sendTraceTag(40421409,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: element.GetContext did not return a 2d context. Bailing out...")}else o.ULS.sendTraceTag(40421408,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: Utility.CreateElement did not create a CanvasElement. Bailing out...")}else o.ULS.sendTraceTag(40421407,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: StatefulColorFlyoutAnchorComponentDom.ElmImage is null. Bailing out...");else o.ULS.sendTraceTag(40421406,207,15,"StatefulColorFlyoutAnchorComponentDomStrategy.PopulateCanvasElement: Control.GetControlSize did not return ControlSize of Control16. Bailing out...")},e}();(0,i.l)(we,"StatefulColorFlyoutAnchorDomStrategy",null,[]);var Ie=function(){function e(){}return e.Color="Color",e.IntColor="IntColor",e}();(0,i.l)(Ie,"IconColorCommandProperties",null,[]);var Ee=(0,i.y)("IIconColorManager"),ke=function(){function e(){this.$$pf_DisplayColor=null}return e.prototype.get_displayColor=function(){return this.$$pf_DisplayColor},e.prototype.set_displayColor=function(e){return this.$$pf_DisplayColor=e,e},e.prototype.get_automaticDisplayColor=function(){return"Window"},e.prototype.get_noFillStrokeColor=function(){return"WindowFrame"},e.prototype.get_iconHeight=function(){return 16},e.prototype.get_colorStripLeft=function(){return 0},e.prototype.get_colorStripHeight=function(){return this.get_iconHeight()/4},e.prototype.get_colorStripTop=function(){return this.get_iconHeight()-this.get_colorStripHeight()},e.prototype.get_colorStripAntiBlurStrokeOffset=function(){return.5},e.prototype.iconColorChanged=function(e,t){return!(k.t(t)&&k.t(e)||t===e)},e.prototype.drawColorStrip=function(e,t){if(e){var n=e.getContext("2d");if(n)if(t)try{n.clearRect(this.get_colorStripLeft(),this.get_colorStripTop(),e.width,this.get_colorStripHeight()),n.strokeStyle=this.get_noFillStrokeColor(),n.strokeRect(this.get_colorStripLeft()+this.get_colorStripAntiBlurStrokeOffset(),this.get_colorStripTop()+this.get_colorStripAntiBlurStrokeOffset(),e.width-2*this.get_colorStripAntiBlurStrokeOffset(),this.get_colorStripHeight()-2*this.get_colorStripAntiBlurStrokeOffset())}catch(t){o.ULS.sendTraceTag(40421404,207,15,String.format("IconColorManager.DrawColorStrip: a 2d context operation failed (clearRect or strokeRect) with element.Width='{0}'. Exception message: {1}",e.width,t.message))}else try{n.fillStyle=this.get_displayColor(),n.fillRect(this.get_colorStripLeft(),this.get_colorStripTop(),e.width,this.get_colorStripHeight())}catch(t){o.ULS.sendTraceTag(40421405,207,15,String.format("IconColorManager.DrawColorStrip: a 2d context fillRect operation failed with fillStyle='{0}' and element.Width='{1}'. Exception message: {2}",this.get_displayColor(),e.width,t.message))}else o.ULS.sendTraceTag(40421403,207,15,"IconColorManager.DrawColorStrip: element.GetContext did not return a 2d context. Bailing out...")}else o.ULS.sendTraceTag(40421402,207,15,"IconColorManager.DrawColorStrip: CanvasElement is null. Bailing out...")},e}();(0,i.l)(ke,"IconColorManager",null,[Ee]);var De=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.displayedButtonCanvasElement=null,o.iconColorManager=new ke,o.set_currentIconColor(o.get_properties$3().InitializationColor),o}return(0,S.t)(t,e),t.prototype.get_properties$3=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.get_currentIconColor=function(){return this.get_stateProperties()[Ie.Color]},t.prototype.set_currentIconColor=function(e){this.get_stateProperties()[Ie.Color]=e;var t=new RegExp("^-1$").test(e);return this.set_iconColorInt(t),t?this.iconColorManager.set_displayColor(this.iconColorManager.get_automaticDisplayColor()):this.iconColorManager.set_displayColor(Ae.l.getRGBFromBGR(e)),e},t.prototype.get_iconColorInt=function(){return this.get_stateProperties()[Ie.IntColor]},t.prototype.set_iconColorInt=function(e){return this.get_stateProperties()[Ie.IntColor]=e,e},t.prototype.get_controlType=function(){return C.Control.statefulColorFlyoutAnchorControlType},t.prototype.selectDropdownItem=function(e){var t=(0,be.e)(C.Control,e);t&&this.iconColorManager.iconColorChanged(t.get_stateProperties().Color,this.get_currentIconColor())&&(k.t(t.get_stateProperties().Color)?this.set_currentIconColor(this.get_properties$3().DefaultColor):this.set_currentIconColor(t.get_stateProperties().Color),this.iconColorManager.drawColorStrip(this.displayedButtonCanvasElement,this.get_iconColorInt()))},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t.prototype.createComponentDomForDisplayMode=function(e){var t=(new we).buildControlDom(this,e);return this.populateControlDom(t,e),this.displayedButtonCanvasElement=t.elmCanvasPart,this.iconColorManager.drawColorStrip(this.displayedButtonCanvasElement,this.get_iconColorInt()),t},t}(f.FlyoutAnchor);(0,i.l)(De,"StatefulColorFlyoutAnchor",f.FlyoutAnchor,[Ce]);var Me=function(e){function t(t){var n=e.call(this,t)||this;return n.elmCanvasPart=null,n}return(0,S.t)(t,e),t.prototype.internalImageLoadHandler=function(){var e=this.elmCanvasPart.getContext("2d");if(e){try{e.drawImage(this.elmImage,-this.elmImage.offsetLeft,-this.elmImage.offsetTop,this.elmCanvasPart.width,12,0,0,this.elmCanvasPart.width,12)}catch(e){return o.ULS.sendTraceTag(39986015,207,15,String.format("StatefulColorSplitButtonComponentDom.InternalImageLoadHandler: a 2d context drawImage operation failed. Exception message: {0}",e.message)),void this.setDefaultImageDisplay()}this.setDefaultImageDisplay("none")}else o.ULS.sendTraceTag(39986014,207,15,"StatefulColorSplitButtonComponentDom.InternalImageLoadHandler: ElmCanvasPart.GetContext did not return a 2d context. Bailing out...")},t.prototype.setDefaultImageDisplay=function(e){void 0===e&&(e="");try{this.elmImage&&this.elmImage.style&&this.elmImage.style.display!==e&&(this.elmImage.style.display=e)}catch(t){o.ULS.sendTraceTag(39986016,207,15,String.format("StatefulColorSplitButtonComponentDom.SetDefualtImangeDisplay: ElmImage.Style.Display = {0} failed. Exception message: {1}",e,t.message))}},t}(fe);(0,i.l)(Me,"StatefulColorSplitButtonComponentDom",fe,[]);var Pe=function(e){function t(){return e.call(this)||this}return(0,S.t)(t,e),t.prototype.buildControlDom=function(e,t){var n=new Me(t);return this.populateControlDom(n,e,t),this.populateCanvasElement(n,t),n},t.prototype.populateCanvasElement=function(e,t){e.elmCanvasPart=null;var n=C.Control.getControlSize(t);if(o.ULS.shipAssertTag(22315809,207,6===n,"Stateful color split button is implemented for 16X16px icons"),6===n){var i=e.elmImage.parentNode,r=D.n.createElement("canvas");if(!r)return o.ULS.sendTraceTag(39986017,207,15,"StatefulColorSplitButtonComponentDom.PopulateCanvasElement: failed to create a canvas element. Bailing out..."),void e.setDefaultImageDisplay();r.height=16,r.width=16;var a=r.getContext("2d");if(!a)return o.ULS.sendTraceTag(39986018,207,15,"StatefulColorSplitButtonComponentDom.PopulateCanvasElement: element.GetContext did not return a 2d context. Bailing out..."),void e.setDefaultImageDisplay();try{a.clearRect(0,0,r.width,r.height),i.appendChild(r),e.elmCanvasPart=r}catch(t){o.ULS.sendTraceTag(39986019,207,15,String.format("StatefulColorSplitButtonComponentDom.PopulateCanvasElement: a 2d context ClearRect operation failed with element.Width='{0}', element.Height='{1}'. Exception message: {2}",r.width,r.height,t.message)),e.setDefaultImageDisplay()}}},t}(ye);(0,i.l)(Pe,"StatefulColorSplitButtonDomStrategy",ye,[]);var Fe=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.iconColorManager=new ke,o.set_currentIconColor(o.get_statefulColorSplitButtonProperties().InitializationColor),o}return(0,S.t)(t,e),t.prototype.get_statefulColorSplitButtonProperties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.get_currentIconColor=function(){return this.get_stateProperties()[Ie.Color]},t.prototype.set_currentIconColor=function(e){this.get_stateProperties()[Ie.Color]=e;var t=new RegExp("^-1$").test(e);return this.set_iconColorInt(t),t?this.iconColorManager.set_displayColor(this.iconColorManager.get_automaticDisplayColor()):this.iconColorManager.set_displayColor(Ae.l.getRGBFromBGR(e)),e},t.prototype.get_iconColorInt=function(){return this.get_stateProperties()[Ie.IntColor]},t.prototype.set_iconColorInt=function(e){return this.get_stateProperties()[Ie.IntColor]=e,e},t.prototype.get_displayedButtonCanvasElement=function(){var e=this.getDisplayedControlDom();return e?e.elmCanvasPart:null},t.prototype.get_controlType=function(){return C.Control.statefulColorSplitButtonControlType},t.prototype.selectDropdownItem=function(e){var t=(0,be.e)(C.Control,e);t&&this.iconColorManager.iconColorChanged(t.get_stateProperties().Color,this.get_currentIconColor())&&(k.t(t.get_stateProperties().Color)?this.set_currentIconColor(this.get_statefulColorSplitButtonProperties().DefaultColor):this.set_currentIconColor(t.get_stateProperties().Color),this.iconColorManager.drawColorStrip(this.get_displayedButtonCanvasElement(),this.get_iconColorInt()))},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t.prototype.constructClonedMenuLauncherForMenu=function(e,t,n){return new f.FlyoutAnchor(e,this.get_id(),t,n)},t.prototype.createComponentDomForDisplayMode=function(e){var t=(new Pe).buildControlDom(this,e);return this.iconColorManager.drawColorStrip(t.elmCanvasPart,this.get_iconColorInt()),t},t}(Se);(0,i.l)(Fe,"StatefulColorSplitButton",Se,[Ce]);var xe=function(){function e(){}return e.MenuItemIdKey="MenuItemId",e.ImageClassKey="ImageClass",e}();(0,i.l)(xe,"StatefulImageSplitButtonCommandProperties",null,[]);var Re=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.set_recentMenuItemId(o.get_statefulImageSplitButtonProperties().DefaultMenuItemId),o.set_recentImageClass(o.get_statefulImageSplitButtonProperties().DefaultImageClass),o}return(0,S.t)(t,e),t.prototype.get_statefulImageSplitButtonProperties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.get_recentMenuItemId=function(){return this.get_stateProperties()[xe.MenuItemIdKey]},t.prototype.set_recentMenuItemId=function(e){return this.get_stateProperties()[xe.MenuItemIdKey]=e,e},t.prototype.get_recentImageClass=function(){return this.get_stateProperties()[xe.ImageClassKey]},t.prototype.set_recentImageClass=function(e){return this.get_stateProperties()[xe.ImageClassKey]=e,e},t.prototype.get_controlType=function(){return C.Control.statefulImageSplitButtonControlType},t.prototype.selectDropdownItem=function(e){this.set_recentMenuItemId(e.getMenuItemId()),this.setRecentRecentImageClass(t.getCssClassName(e))&&this.updateDOM()},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t.prototype.constructClonedMenuLauncherForMenu=function(e,t,n){return new f.FlyoutAnchor(e,this.get_id(),t,n)},t.prototype.setRecentRecentImageClass=function(e){var t=this.get_recentImageClass();return(!k.t(t)||!k.t(e))&&(t!==e&&(k.t(e)&&(e=this.get_statefulImageSplitButtonProperties().DefaultImageClass),this.set_recentImageClass(e),!0))},t.prototype.updateDOM=function(){var e=this.get_displayedButtonImageElement();e&&(e.className=this.get_recentImageClass())},t.getCssClassName=function(e){var t=(0,be.e)(C.Control,e);if(!t)return"";var n=C.Control.getControlSize(t.get_displayMode());return o.ULS.shipAssertTag(34961356,207,6===n,"Stateful button is implemented for 16X16px icons"),6!==n?"":t.get_controlProperties().Image16by16Class},t}(Se);(0,i.l)(Re,"StatefulImageSplitButton",Se,[]);var Be=n(160),Le=n(809),Ne=n(648),Ue=function(e){function t(t,n,i){void 0===n&&(n=null),void 0===i&&(i=null);var r=e.call(this,t,n,i)||this;return r.elmInput=null,r.isEditable=!0,r.isMultiline=!1,r}return(0,S.t)(t,e),t}(T.d);(0,i.l)(Ue,"TextBoxComponentDom",T.d,[]);var Oe=function(e){function t(){var t=e.call(this)||this;return t._focusableElement=null,t}return(0,S.t)(t,e),t.prototype.get_focusableElement=function(){return this._focusableElement},t.prototype.buildControlDom=function(e,n){var i=e.get_controlProperties(),r=D.n.createElement("span");Sys.UI.DomElement.addCssClass(r,"cui-btn-menu-description"),Sys.UI.DomElement.addCssClass(r,"cui-menusection-diagnostics-textbox"),Sys.UI.DomElement.addCssClass(r,"UIFont");var o=i.ControlCss;k.x(o)||(r.style.cssText=o);var a=D.n.createElement("label");Sys.UI.DomElement.addCssClass(a,"UIFontBold"),Sys.UI.DomElement.addCssClass(a,"cui-menusection-diagnostics-textboxlabel"),a.setAttribute("for",e.get_id()),a.id=e.get_id()+"-label",a.appendChild(document.createTextNode(i.LabelText||""));var s=a.id,l=i.AdditionalLabelBy;k.x(l)||(s+=" "+l);var u=t.createTextBox(e.get_id(),s);return r.appendChild(a),r.appendChild(u),this._focusableElement=u,(0,Le.m)(new Ue(n,r,this),{elmInput:u,elmLabel:a,isEditable:!1})},t.createTextBox=function(e,t){var n=document.createElement("textarea");return n.id=e,n.rows=1,u.y.get_isIPad()||(n.readOnly=!0),n.setAttribute(P.t.ariaLabelledByAttribute,t),n.setAttribute(P.t.ariaMultilineAttribute,P.t.ariaFalseValue),n.setAttribute(P.t.ariaReadOnlyAttribute,P.t.ariaTrueValue),n.setAttribute(P.t.ariaRoleAttribute,P.t.ariaTextboxAttribute),Sys.UI.DomElement.addCssClass(n,Ne.r.allowBrowserContextMenu),Sys.UI.DomElement.addCssClass(n,"UIFont"),n},t}(b.r);(0,i.l)(Oe,"DiagnosticsItemTextBoxDomStrategy",b.r,[]);var He=function(e){function t(){var t=e.call(this)||this;return t._focusableElement=null,t}return(0,S.t)(t,e),t.prototype.get_focusableElement=function(){return this._focusableElement},t.prototype.buildControlDom=function(e,n){var i=e.get_controlProperties(),r=D.n.createElement("span");r.className="cui-tb",r.setAttribute("mscui:controltype",e.get_controlType()),r.setAttribute(P.t.ariaRoleAttribute,P.t.ariaPresentationRole),D.n.isTrue(i.IsStretchedHorizontally)&&D.n.ensureCSSClassOnElement(r,"stretchedHorizontally");var o=t.createLabelElement(e,n);r.appendChild(o);var a=t.createInputElement(e,n);return r.appendChild(a),this._focusableElement=a,(0,Le.m)(new Ue(n,r),{elmInput:a,elmLabel:o,isEditable:!0,isMultiline:D.n.isTrue(i.IsMultiline)})},t.createLabelElement=function(e,t){var n=e.get_controlProperties(),i=D.n.createElement("span"),r=n.LabelText||"";"Small"===t?D.n.ensureCSSClassOnElement(i,"cui-ctl-smalllabel"):"Large"===t?D.n.ensureCSSClassOnElement(i,"cui-ctl-largelabel"):D.n.ensureCSSClassOnElement(i,"cui-ctl-mediumlabel"),i.id="lbl"+e.get_id()+"-"+t,i.innerText=r;var o=n.LabelCss;return k.t(o)||(i.style.cssText=o),i},t.createInputElement=function(e,t){var n,i=e.get_controlProperties();D.n.isTrue(i.IsMultiline)?((n=D.n.createSelectableElement("textarea")).setAttribute("aria-multiline","true"),n.className="cui-txtbx",D.n.ensureCSSClassOnElement(n,"cui-txtbx-multiline")):((n=D.n.createSelectableElement("input")).setAttribute("aria-multiline","false"),n.setAttribute("data-lpignore","true"),n.className="cui-txtbx"),n.id=e.get_id(),n.setAttribute("type","text"),n.setAttribute("role","textbox"),n.setAttribute("autocomplete","off"),D.n.isTrue(i.IsStretchedHorizontally)&&D.n.ensureCSSClassOnElement(n,"stretchedHorizontally");var r=i.Height;k.x(r)||(n.style.height=r);var o=i.Width;k.x(o)||(n.style.width=o);var a="lbl"+e.get_id()+"-"+t,s=i.AdditionalLabelBy;k.x(s)?n.setAttribute("aria-labelledby",a):n.setAttribute("aria-labelledby",s+" "+a);var l=i.MaxLength;k.x(l)||n.setAttribute("maxlength",l);var u=i.PlaceholderText;return k.x(u)||n.setAttribute("placeholder",u),n},t}(b.r);(0,i.l)(He,"StandardTextBoxDomStrategy",b.r,[]);var We=function(e){function t(t,n,i){var r=e.call(this,t,n,i)||this;return r.textBoxDom=null,r._focusableElement=null,r.addDisplayMode("Medium"),r.addDisplayMode("MenuDiagnostics"),r.behavior&&r.behavior.initialize(),r}return(0,S.t)(t,e),t.prototype.get_textBoxDom=function(){return this.textBoxDom},t.prototype.createComponentDomForDisplayMode=function(e){var n=t.getDomElementCreationStrategy(e);return this.textBoxDom=n.buildControlDom(this,e),this._focusableElement=n.get_focusableElement(),this.get_textBoxDom()},t.prototype.ensureKeytipForControl=function(e,t){e.ensureKeytip(t,this.get_textBoxDom().elmInput,this.parentKeytipsIds,this.parentKeytipsKeys)},t.prototype.get_controlType=function(){return C.Control.textBoxControlType},t.prototype.get_focusableElement=function(){return this._focusableElement},t.prototype.commitPendingChange=function(){this.behavior&&this.behavior.commitPendingChange()},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n)},t.prototype.get_isEditable=function(){return!!this.get_textBoxDom()&&this.get_textBoxDom().isEditable},t.getDomElementCreationStrategy=function(e){switch(e){case"MenuDiagnostics":return new Oe;default:return new He}},t}(C.Control);(0,i.l)(We,"TextBox",C.Control,[Be.a]);var Ve=n(506),$e=n(192),Ke=n(288),ze=n(894),qe=n(209);n.d(t,{Builder:function(){return Qe}});var Qe=function(){function e(e,t,n,r){this._rootBuildClientTask=null,this._resizableContainer=null,this._root=null,this._inQuery=!1,this._data=null,this._elmPlaceholder=null,this._bo=null,this._bo=e,k.x(this._bo.trimmedIds)&&(this._bo.trimmedIds={}),this._elmPlaceholder=t,this._rootBuildClientTask=n,this._resizableContainer=r||new l.o,$addHandler(window,"unload",i.i(this,this.onUnload,"onUnload"))}return e.prototype.get__resizableContainer=function(){return this._resizableContainer},e.prototype.onUnload=function(e){this.dispose()},e.prototype.onRootBuilt=function(e){},e.prototype.dispose=function(){this._root=null,this._bo=null,this._elmPlaceholder=null,this._rootBuildClientTask=null,this._data=null,$removeHandler(window,"unload",i.i(this,this.onUnload,"onUnload"))},e.prototype.get_buildClientTask=function(){return this._rootBuildClientTask},e.prototype.get_root=function(){return this._root},e.prototype.set_root=function(e){return this._root=e,e},e.prototype.get_inQuery=function(){return this._inQuery},e.prototype.set_inQuery=function(e){return this._inQuery=e,e},e.prototype.get_dataSource=function(){return this._data},e.prototype.set_dataSource=function(e){return this._data=e,e},e.prototype.get_placeholder=function(){return this._elmPlaceholder},e.prototype.get_options=function(){return this._bo},e.prototype.isIdTrimmed=function(e){return!!this._bo&&this._bo.trimmedIds[e]},e.prototype.isNodeTrimmed=function(e){var t=$e.o.getNodeAttribute(e,$e.o.id);return this._bo.trimmedIds[t]},e.prototype.buildControl=function(t,n){var i=null,r=t[$e.o.NAME];switch(r){case $e.o.button:i=this.buildButton(t,n);break;case $e.o.colorPicker:i=this.buildColorPicker(t,n);break;case $e.o.comboBox:i=this.buildComboBox(t,n);break;case $e.o.dropDown:i=this.buildDropDown(t,n);break;case $e.o.flyoutAnchor:i=this.buildFlyoutAnchor(t,n);break;case $e.o.galleryButton:i=this.buildGalleryButton(t,n,null);break;case $e.o.insertTable:e._insertTableBuilder&&(i=e._insertTableBuilder(t,n,this.get_root()));break;case $e.o.label:i=this.buildLabel(t,n);break;case $e.o.placeholder:i=this.buildPlaceholder(t,n);break;case $e.o.searchBox:i=this.buildSearchBox(t,n);break;case $e.o.separator:i=this.buildSeparator(t,n);break;case $e.o.slider:i=e.buildSlider(t,n,this.get_root());break;case $e.o.spinner:a.AFrameworkApplication.get_activeFrame()&&a.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&(e._spinnerBuilder||e.enableSpinner()),e._spinnerBuilder&&(i=e._spinnerBuilder(t,n,this.get_root()));break;case $e.o.splitButton:i=this.buildSplitButton(t,n);break;case $e.o.statefulColorFlyoutAnchor:i=this.buildStatefulColorFlyoutAnchor(t,n);break;case $e.o.statefulColorSplitButton:i=this.buildStatefulColorSplitButton(t,n);break;case $e.o.statefulImageSplitButton:i=this.buildStatefulImageSplitButton(t,n);break;case $e.o.textBox:i=e.buildTextBox(t,n,this.get_root());break;case $e.o.toggleButton:i=this.buildToggleButton(t,n);break;case $e.o.clonedControl:i=this.buildClonedControl(t,n);break;default:var o=t[$e.o.ATTRIBUTES][$e.o.CLASSNAME];if(k.x(o))throw Error.create("Unable to create Control with tagname: "+r)}return k.x(n.parentId)||(i.get_stateProperties().ParentMenuId=n.parentId),i},e.prototype.buildMenu=function(e,t,n){if(void 0===n&&(n=!1),this.isNodeTrimmed(e))return null;var i=e[$e.o.ATTRIBUTES],r=this.get_root().createMenu(i[$e.o.id],i[$e.o.TITLE],i[$e.o.DESCRIPTION],i[$e.o.MAXWIDTH],n,"2"===i[$e.o.HORIZONTALALIGNMENT]?2:1);return this.fillMenu(r,e,t),r},e.prototype.buildMenuForFlyoutAnchor=function(t,n){var i=$e.o.getNodeChildren(t),r=null,o=t[$e.o.ATTRIBUTES];return n.parentId=o.Id,e.shouldBuildMenu(o,i)&&(r=this.buildMenu(i[0],n)),n.parentId=null,r},e.prototype.fillMenu=function(e,t,n){for(var i=$e.o.getNodeChildren(t),r=i.length,a=null,s=0;s<r;s++){var l=(a=i[s])[$e.o.NAME];if(l===$e.o.MENUSECTION){if(!this.isNodeTrimmed(a)){var u=this.buildMenuSection(a,n,e);e.addChild(u)}}else o.ULS.sendTraceTag(8402819,201,10,"Tags with the name: {0} cannot be children of Menu tags.",l)}},e.prototype.buildMenuSection=function(e,t,n){var i=e[$e.o.ATTRIBUTES],r={},o=i[$e.o.id],a=i[$e.o.TITLE],s=i[$e.o.DESCRIPTION];r.DisplayMode=i[$e.o.DISPLAYMODE],r.MaxHeight=i[$e.o.MAXHEIGHT],r.Image=i[$e.o.IMAGE],r.ImageClass=i[$e.o.IMAGECLASS],r.Theme=i[$e.o.THEME],r.TitleId=i[$e.o.TITLEID],r.Language=i[$e.o.LANGUAGE],r.ArialabelledbyId=i[$e.o.ARIALABELLEDBYID],k.x(r.DisplayMode)&&(r.DisplayMode="Menu"),r.ShowSeperator=(!D.n.isFalse(i[$e.o.SHOWMENUSECTIONSEPERATOR])).toString(),r.ShowTitleIcon=(!D.n.isFalse(i[$e.o.SHOWMENUSECTIONTITLEICON])).toString(),r.ShowTitleBackground=(!D.n.isFalse(i[$e.o.SHOWMENUSECTIONTITLEBACKGROUND])).toString(),r.TitleFocusable=(!D.n.isFalse(i[$e.o.MENUSECTIONTITLEFOCUSABLE])).toString(),r.Scrollable=D.n.isTrue(i[$e.o.SCROLLABLE]).toString(),r.Loading=D.n.isTrue(i[$e.o.LOADING]).toString();var l=this.get_root().createMenuSection(o,a,s,r,n),u=$e.o.getNodeName($e.o.getNodeChildren(e)[0]);if(u===$e.o.CONTROLS){for(var c=$e.o.getNodeChildren($e.o.getNodeChildren(e)[0]),p=c.length,d=null,h=0;h<p;h++)if(d=c[h],!this.isNodeTrimmed(d)){var g=this.buildControl(d,t);g&&l.addChild(g.createComponentForDisplayMode(r.DisplayMode))}}else if(u===$e.o.GALLERY){var m=this.buildGallery($e.o.getNodeChildren(e)[0],t,!0);l.addChild(m)}return l},e.prototype.buildGallery=function(e,t,n){for(var i=e[$e.o.ATTRIBUTES],r=e[$e.o.ATTRIBUTES],o=this.get_root().createGallery(r.Id,i[$e.o.TITLE],i[$e.o.DESCRIPTION],r),a=n?"Menu":"Default",s=$e.o.getNodeChildren(e),l=s.length,u=null,c=0;c<l;c++)if(u=s[c],!this.isNodeTrimmed(u)){var p=void 0;switch($e.o.getNodeName(u)){case $e.o.galleryButton:p=this.buildGalleryButton(u,t,r.ElementDimensions);break;default:p=this.buildControl(u,t)}p&&o.addChild(p.createComponentForDisplayMode(a))}return o},e.prototype.buildGalleryButton=function(e,t,n){var i;k.t(n)&&(n=e[$e.o.ATTRIBUTES][$e.o.ELEMENTDIMENSIONS]);i=k.t(n)?3:Ke.p.convertStringToGalleryElementDimensions(n);var r=e[$e.o.ATTRIBUTES],o=new y.GalleryButton(this.get_root(),r.Id,r,i);return k.x(t.parentId)||(o.get_stateProperties().ParentMenuId=t.parentId),o},e.prototype.buildToggleButton=function(e,t){var n=e[$e.o.ATTRIBUTES];return new Ve.g(this.get_root(),n.Id,n)},e.prototype.buildColorPicker=function(e,t){for(var n=e[$e.o.ATTRIBUTES],i=$e.o.getNodeChildren($e.o.getFirstChildNodeWithName(e,$e.o.colors)),r=new Array(i.length),o=i.length,a=0;a<o;a++){var s=new h,l=$e.o.getNodeAttributes(i[a]),u=l[$e.o.TITLE];s.Title=k.x(u)?l[$e.o.ALT]:u,s.Color=l[$e.o.COLOR],s.DisplayColor=l[$e.o.DISPLAYCOLOR],r[a]=s}return new g.ColorPicker(this.get_root(),n.Id,n,r)},e.prototype.buildSearchBox=function(t,n){var i=t[$e.o.ATTRIBUTES],r=$e.o.getNodeChildren(t),o=null;return e.shouldBuildMenu(i,r)&&(o=this.buildMenu(r[0],n)),new ue(this.get_root(),i.Id,i,o)},e.prototype.buildComboBox=function(t,n,i){var r=t[$e.o.ATTRIBUTES],o=$e.o.getNodeChildren(t),a=null,s=t[$e.o.ATTRIBUTES],l=null;if(e.shouldBuildMenu(s,o)){a=this.buildMenu(o[0],n,!0),l={};for(var u=$e.o.getNodeChildren(o[0]),c=u.length,p=0;p<c;p++)for(var d=$e.o.getNodeChildren(u[p]),h=$e.o.getNodeChildren(d[0]),g=h.length,_=0;_<g;_++){var f=h[_][$e.o.ATTRIBUTES],y=f[$e.o.LABELTEXT],v=f[$e.o.MENUITEMID];l[y]=v}}var S=i?i(this.get_root(),r.Id,r,a):new m.y(this.get_root(),r.Id,r,a);return S.set_menuItems(l),S},e.prototype.buildDropDown=function(t,n){var i=t[$e.o.ATTRIBUTES],r=$e.o.getNodeChildren(t),o=null,a=t[$e.o.ATTRIBUTES];return e.shouldBuildMenu(a,r)&&(o=this.buildMenu(r[0],n)),new _.p(this.get_root(),i.Id,i,o)},e.prototype.buildButton=function(e,t){var n=e[$e.o.ATTRIBUTES];return new d.d(this.get_root(),n.Id,n)},e.prototype.buildSplitButton=function(t,n){var i=t[$e.o.ATTRIBUTES],r=$e.o.getNodeChildren(t),o=null;return e.shouldBuildMenu(i,r)&&(o=this.buildMenu(r[0],n)),new Se(this.get_root(),i.Id,i,o)},e.prototype.buildStatefulColorSplitButton=function(t,n){var i=t[$e.o.ATTRIBUTES],r=$e.o.getNodeChildren(t),o=null;return e.shouldBuildMenu(i,r)&&(o=this.buildMenu(r[0],n)),new Fe(this.get_root(),i.Id,i,o)},e.prototype.buildStatefulImageSplitButton=function(t,n){var i=t[$e.o.ATTRIBUTES],r=$e.o.getNodeChildren(t),o=null;return e.shouldBuildMenu(i,r)&&(o=this.buildMenu(r[0],n)),new Re(this.get_root(),i.Id,i,o)},e.prototype.buildFlyoutAnchor=function(e,t){var n=e[$e.o.ATTRIBUTES],i=this.buildMenuForFlyoutAnchor(e,t);return new f.FlyoutAnchor(this.get_root(),n.Id,n,i)},e.prototype.buildStatefulColorFlyoutAnchor=function(e,t){var n=e[$e.o.ATTRIBUTES],i=this.buildMenuForFlyoutAnchor(e,t);return new De(this.get_root(),n.Id,n,i)},e.prototype.buildLabel=function(e,t){var n=e[$e.o.ATTRIBUTES];return new L(this.get_root(),n.Id,n)},e.prototype.buildPlaceholder=function(e,t){var n=e[$e.o.ATTRIBUTES];return new N(this.get_root(),n.Id,n)},e.prototype.buildSeparator=function(e,t){var n=e[$e.o.ATTRIBUTES];return new ce(this.get_root(),n.Id,n)},e.prototype.convertNodeValueToInt=function(e){return"string"==typeof e?parseInt(e):e},e.prototype.buildClonedControl=function(e,t){var n=e[$e.o.ATTRIBUTES],r=i.r(ze.g,t)&&t.cloneControlsForMenu,o=qe.f.get_instance().getFirstValidControl(n.Id);return o&&(o=r?o.cloneForMenu(this.get_root(),n):o.clone(this.get_root(),n)),o},e.enableSlider=function(){e._sliderBuilder=e.buildSlider},e.enableSpinner=function(){e._spinnerBuilder=e.buildSpinner},e.enableInsertTable=function(){e._insertTableBuilder=e.buildInsertTable},e.buildInsertTable=function(e,t,n){var i=e[$e.o.ATTRIBUTES];return new v.o(n,i.Id,i)},e.buildSlider=function(e,t,n){var i=e[$e.o.ATTRIBUTES];return new de(n,i.Id,i)},e.buildSpinner=function(t,n,i){var r=t[$e.o.ATTRIBUTES],o=e.buildSpinnerChildren(t);return new me(i,r.Id,r,o.units,o.specialTextStrings)},e.convertNodeValueToFloat=function(e){return"string"==typeof e?parseFloat(e):e},e.buildSpinnerChildren=function(t){for(var n=$e.o.getNodeChildren(t),i=[],r=[],o=n.length,a=0;a<o;a++){var s=n[a],l=$e.o.getNodeName(s),u=$e.o.getNodeAttributes(s);if(l===$e.o.UNIT){var d=me.createUnit(c(u[$e.o.UNITTYPE]),e.convertNodeValueToFloat(u[$e.o.MINIMUMVALUE]),e.convertNodeValueToFloat(u[$e.o.MAXIMUMVALUE]),e.convertNodeValueToFloat(u[$e.o.STEP]));Array.add(i,d)}else l===$e.o.SPECIALTEXTSTRINGS&&Array.add(r,u[$e.o.VALUE])}return new p(i,r)},e.buildTextBox=function(e,t,n){var i=e[$e.o.ATTRIBUTES];return new We(n,i.Id,i)},e.convertXMLStringToJSON=function(t){var n=null;if(u.y.get_isInternetExplorer8()){var i=null;(i=document.createElement("xml")).innerText=t,document.body.appendChild(i),n=i.XMLDocument,document.body.removeChild(i)}else n=Sys.Net.XMLDOM(t);return k.x(n)||k.x(n.documentElement)?(o.ULS.sendTraceTag(4523028,201,50,"Failure in ConvertXMLStringToJSON"),null):e.convertXMLToJSON(n)},e.convertXMLToJSON=function(t){return(0,r.v)("("+e.convertNodeToJSON(t.documentElement)+")")},e.convertNodeToJSON=function(t){var n;n="{",n+='"name" : ',n+=s.w(t.nodeName),n+=",",n+='"attrs": {';var i=t.attributes;if(!k.x(t.attributes)){var r=i.length;if(r>0)for(var o=!0,a=0;a<r;a++){var l=i.item(a);o?o=!1:n+=",",n+=s.w(l.name),n+=":",D.n.isEncodedStringArray(l.value)?n+=s.w(D.n.decodeStringArrayXmlAttribute(l.value)):n+=s.w(l.value)}}n+="}";var u=t.childNodes;if(u){var c=u.length;if(c>0){n+=",",n+="children:[";for(o=!0,a=0;a<c;a++){var p=u[a];"#text"!==p.nodeName&&(o?o=!1:n+=",",n+=e.convertNodeToJSON(p))}n+="]"}}return n+="}"},e.shouldBuildMenu=function(e,t){return!!t[0]&&(!D.n.isTrue(e.PopulateDynamically)||D.n.isTrue(e.AllowDefaultContent))},e._sliderBuilder=null,e._spinnerBuilder=null,e._insertTableBuilder=null,e}();(0,i.l)(Qe,"Builder",null,[Sys.IDisposable])},function(e,t,n){"use strict";n.d(t,{c:function(){return a}});var i=n(255),r=n(586),o=n(208),a=function(){function e(){this._sessionExpiredLogged=!1,this._sessionAboutToExpireLogged=!1,this.sessionExpiredDetectedEventKey="SED",this.sessionAboutToExpireDetectedEventKey="SATED",this.cancelSessionExpiration=null,this._ignoreOverride=0,this._eventSource=new r.f}return e.prototype.add_sessionExpiredDetected=function(e){this._eventSource.addHandler(this.sessionExpiredDetectedEventKey,e)},e.prototype.remove_sessionExpiredDetected=function(e){this._eventSource.removeHandler(this.sessionExpiredDetectedEventKey,e)},e.prototype.add_sessionAboutToExpireDetected=function(e){this._eventSource.addHandler(this.sessionAboutToExpireDetectedEventKey,e)},e.prototype.remove_sessionAboutToExpireDetected=function(e){this._eventSource.removeHandler(this.sessionAboutToExpireDetectedEventKey,e)},e.prototype.checkAndTriggerSessionHasExpired=function(){var e=n(254).AFrameworkApplication.get_accessTokenTtl(),t=n(254).AFrameworkApplication.accessTokenExpirationPromptSeconds,i=this.isSessionExpired(e);return i&&this.cancelSessionExpiration&&!this._ignoreOverride&&(this._ignoreOverride=1,i=!this.cancelSessionExpiration(),this._ignoreOverride=i?2:0),i?this.logAndRaiseEvent(!0,e,t):this.isSessionAboutToExpire(e,t)&&this.logAndRaiseEvent(!1,e,t),i},e.prototype.isSessionExpired=function(e){return e>0&&(new Date).getTime()>=e},e.prototype.isSessionAboutToExpire=function(e,t){return n(254).AFrameworkApplication.get_isWopiTokenRefreshEnabled()&&n(254).AFrameworkApplication.get_wopiTokenExpiresAfterMinutes()>0?!this.isSessionExpired(e)&&(new Date).getTime()>=n(254).AFrameworkApplication.wopiTokenLastRefreshTime+60*n(254).AFrameworkApplication.get_wopiTokenExpiresAfterMinutes()*1e3:!this.isSessionExpired(e)&&e>0&&(new Date).getTime()>=e-1e3*t},e.prototype.logAndRaiseEvent=function(e,t,r){e?this._sessionExpiredLogged||(i.ULS.sendTraceTag(20492681,201,50,"SessionHasExpired: {0}",{AccessTokenTtl:t,TimeNow:(new Date).getTime(),BootTime:n(254).AFrameworkApplication.bootTime}),this._sessionExpiredLogged=!0):this._sessionAboutToExpireLogged||(i.ULS.sendTraceTag(20492682,201,50,"SessionAboutToExpire: {0}",{AccessTokenExpirationPromptSeconds:r,AccessTokenTtl:t,TimeNow:(new Date).getTime(),BootTime:n(254).AFrameworkApplication.bootTime}),this._sessionAboutToExpireLogged=!0),this._eventSource.raiseEvent(e?this.sessionExpiredDetectedEventKey:this.sessionAboutToExpireDetectedEventKey)},e.prototype.dispose=function(){this._eventSource.dispose()},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=new e)},e._singletonInstance=null,e}();(0,o.l)(a,"SessionExpirationEventSource",null,[Sys.IDisposable])},function(e,t,n){"use strict";n.d(t,{u:function(){return a}});var i=n(508),r=n(208),o=n(943),a=function(e){function t(n){var i=e.call(this,Number,n)||this;return r.m(i,t.$$(n)),i}return(0,i.t)(t,e),t.$$=function(e){var n="IntDictionary$1$"+e.getName(),i=r.x(n);return i||r.u(n,"$$sc.IntDictionary$1",t,[{TValue:e}],o.i.$$(Number,e),[])},t}(o.i)},,function(e,t,n){var i=n(382),r=n(521),o=Object.prototype;r!==o.toString&&i(o,"toString",r,{unsafe:!0})},function(e,t,n){"use strict";n.r(t),n.d(t,{getExecuteState:function(){return s},executeAction:function(){return l},executeActionWithData:function(){return u},getPageHeightAtZoom:function(){return c},getPageWidthAtZoom:function(){return p},perfMetricsStart:function(){return d},perfMetricsStop:function(){return h}});var i=n(901),r=n(254),o=n(713),a=n(2),s=function(){a.x.getExecuteState()},l=function(e){return a.x.verifyExecuteState()?r.AFrameworkApplication.get_theActionManager().processAction(a.x.calcActionId(e),2):16},u=function(e,t){if(!a.x.verifyExecuteState())return 16;var n=a.x.calcActionId(e);return r.AFrameworkApplication.get_theActionManager().processActionWithData(n,2,t)},c=function(e,t){return a.x.verifyExecuteState()?i.t.get_instance().getPageHeightAtZoom(e,t):-1},p=function(e,t){return a.x.verifyExecuteState()?i.t.get_instance().getPageWidthAtZoom(e,t):-1},d=function(){a.x.ignoreExecuteState(),o.t.start()},h=function(){a.x.ignoreExecuteState(),o.t.stop()}},function(e,t,n){"use strict";n.d(t,{n:function(){return i}});var i=(0,n(208).y)("IPerfTelemetryLogger")},function(e,t,n){"use strict";n.r(t),n.d(t,{DocumentTitleContainer:function(){return c}});var i=n(508),r=n(3),o=n(547),a=n(98),s=n(254),l=n(973),u=n(208),c=function(e){function t(){var t=e.call(this)||this;if(t.set_elmContainer(a.k.createUnselectableElement("span")),t.get_elmContainer().id="viewerChrome-documentTitleContainer",t.get_elmContainer().className="cui-herobar-documentTitleContainer",s.AFrameworkApplication.isMobileMode){var n=l.createClusteredImage(32,32,s.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppIcon"),"AppHeaderIconFloat",!0,"");t.get_elmContainer().appendChild(n)}return s.AFrameworkApplication.docPropertiesProvider.get_breadcrumbDocName()&&(t._elementToTruncate=o.CuiHelper.createDocumentTitleElementInternal(t.get_elmContainer(),!1)),t}return(0,i.t)(t,e),t.prototype.dispose=function(){o.CuiHelper.disposeTitleElement()},t}(r.m);(0,u.l)(c,"DocumentTitleContainer",r.m,[])},,,,,,,,,function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var i=n(208),r=function(){function e(){}return e.touchClickAdapterCache="#t",e.touchAndHoldAdapterCache="#th",e.gestureAdapterCache="#g",e.dragAdapterCache="#d",e}();(0,i.l)(r,"InputDataNameConstants",null,[])},function(e,t,n){n.p=function(){var e=function(e){return e.toLowerCase().endsWith("/wordviewerds.js")?e.substring(0,e.lastIndexOf("/")+1):null},t=document.currentScript,n=null;if(n=t?e(t.src):function(){for(var t=document.getElementsByTagName("script"),n=0;n<t.length;n++){var i=e(t[n].src);if(i)return i}return null}())return n;throw"Could not locate webpack public path"}()},,,,,,,function(e,t,n){"use strict";var i,r=n(508),o=n(208),a=n(214),s=n(347),l=n(600),u=n(255),c=n(614),p=n(574),d=n(657),h=n(550),g=n(66),m=n(749),_=n(124),f=n(806);!function(e){e[e.cancel=0]="cancel",e[e.action=1]="action",e[e.ok=1]="ok",e[e.yes=1]="yes",e[e.secondaryAction=2]="secondaryAction",e[e.retry=2]="retry",e[e.no=2]="no",e[e.tertiaryAction=3]="tertiaryAction",e[e.quaternaryAction=4]="quaternaryAction"}(i||(i={})),(0,o.h)("DialogButton",i);var y=n(154),v=n(235),S=n(984),C=n(296),b=n(134),A=n(556);n.d(t,{h:function(){return D}});var T="WACDialogOuterContainer",w="WACDialogOuterContainer",I="WACDialogPanel",E="WACDialogOverlay",k=3,D=function(e){function t(i,r,o,a){void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===o&&(o=!1),void 0===a&&(a=!1);var s=e.call(this,document.createElement("div"))||this;s._clientId=null,s._id=null,s._messageBoxHandler=null,s._closeClickHandler=null,s._buttonClickHandler=null,s._buttonKeyHandler=null,s._clickManager=null,s._keyInputManager=null,s._dragAdapter=null,s._keyAdapter=null,s._windowScrollHandler=null,s._windowResizeHandler=null,s._btnAction=null,s._btnCancel=null,s._btnSecondary=null,s._btnTertiary=null,s._btnQuaternary=null,s._overlayElement=null,s._divOuterDialogContainer=null,s._divInnerDialogContainer=null,s._divMessageBox=null,s._bodyPanel=null,s._divMessageBoxTitle=null,s._buttonPanel=null,s._document=null,s._body=null,s._titleText=null,s._outerBody=null,s._closeAnchor=null,s._menuLaunchPoint=null,s._closeIconElement=null,s._okText="OK",s._cancelText="Cancel",s._closeText="Close",s._yesText="Yes",s._noText="No",s._retryText="Retry",s._permanentlyDeleteText="Permanently Delete",s._shareAndNotifyText="Share and notify",s._actionText="Action",s._secondaryActionText="Secondary Action",s._tertiaryActionText="Tertiary Action",s._quaternaryActionText="Quaternary Action",s._width=15,s._buttonsOption=0,s._visible=!1,s._keystrokeOnButtonPending=!1,s._revertToLastScope=!1,s._hasCloseGlyph=!1,s._hasTitleBar=!1,s._shouldPreemptExistingDialog=!1,s._useReactDialog=!1,s._isRegisteredWithRegionComposer=!1,s._disposed=!1,s._tabOrderLooped=!0,s._disposeOnHide=!0,s._hideOnButtonClick=!0,s._showTransparentOverlay=!1,s._dialogOnKeyDownHandler=null,s._dialogOnKeyPressHandler=null,s._dialogOnKeyUpHandler=null,s._menuRootUser=null,s.isSimplifiedReactRibbonUxEnabled=!1,s._dismissFocusScope=null,s.hasButtonPanel=!1,s._dialogPanelCssClass=I,s._buttonText=new Array(k),s._buttonState=new Array(k),s._buttonDisplay=new Array(k),s._buttons=new Array(k),s._defaultButton=1,s._windowMode="undefined",s._rectsWithoutKeyboard=[],s._overlayCssClass=E,s._shouldPreemptExistingDialog=i,s._useReactDialog=o&&!!n(254).AFrameworkApplication.get_activeFrame()&&n(254).AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactDialogEnabled(),t._currentDialog&&(t._currentDialog.get_canBePreempted()||i)&&!a&&t._currentDialog.hide(),t._currentDialog=s;try{n(254).AFrameworkApplication.get_activeFrame()&&!n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacDialogSizingChanges")&&(s._width=CommonUIStrings.l_DialogWidth),s._okText=CommonUIStrings.l_DialogOk,s._cancelText=CommonUIStrings.l_DialogCancel,s._closeText=CommonUIStrings.l_DialogClose,s._yesText=CommonUIStrings.l_DialogYes,s._noText=CommonUIStrings.l_DialogNo,s._retryText=CommonUIStrings.l_DialogRetry,s._permanentlyDeleteText=CommonUIStrings.l_DialogPermanentlyDelete,s._shareAndNotifyText=CommonUIStrings.l_DialogShareAndNotify}catch(e){n(254).AFrameworkApplication.get_activeFrame()&&!n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WacDialogSizingChanges")&&(s._width=15)}s.isSimplifiedReactRibbonUxEnabled=!!n(254).AFrameworkApplication.get_activeFrame()&&n(254).AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled();try{s._outerBody=s.isSimplifiedReactRibbonUxEnabled&&!r||d.FocusManager.instance().get_currentScope().name===n(751).AFrame.previewPanelId?document.body:n(254).AFrameworkApplication.get_activeFrame().getDOMElement()}catch(e){s._outerBody=document.body}return s._document=s._outerBody.ownerDocument,s._clientId=s.get_element().id,s.set_buttonsOption(1),s._defaultButton=1,s.set_hasTitleBar(!0),s.set_hasCloseGlyph(!0),s.hasButtonPanel=!0,s._useReactDialog&&(s._divOuterDialogContainer=s._document.createElement("div"),s._divOuterDialogContainer.id=s.myId(T),s._divOuterDialogContainer.className=w,s._outerBody.insertBefore(s._divOuterDialogContainer,s._outerBody.firstChild),n(55).UISurfaces.getDialogAPIAsync().then((function(e){return e.initialize(s._divOuterDialogContainer),null}))),s}return(0,r.t)(t,e),t.prototype.get_fullDialogFocusId=function(){return t.dialogFocusId+"/modal"},t.prototype.get_dialogElement=function(){return t.get_currentDialog()?t.get_currentDialog()._divMessageBox:null},t.prototype.get_menuLaunchPoint=function(){return t.get_currentDialog()?t.get_currentDialog()._menuLaunchPoint:null},t.prototype.get_closeAnchor=function(){return this._closeAnchor},t.prototype.get_closeIconElement=function(){return this._closeIconElement},t.prototype.get_dialogOnKeyDownHandler=function(){return this._dialogOnKeyDownHandler?this._dialogOnKeyDownHandler:o.i(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")},t.prototype.set_dialogOnKeyDownHandler=function(e){return this._dialogOnKeyDownHandler=e,e},t.prototype.get_dialogOnKeyPressHandler=function(){return this._dialogOnKeyPressHandler?this._dialogOnKeyPressHandler:o.i(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")},t.prototype.set_dialogOnKeyPressHandler=function(e){return this._dialogOnKeyPressHandler=e,e},t.prototype.get_dialogOnKeyUpHandler=function(){return this._dialogOnKeyUpHandler?this._dialogOnKeyUpHandler:o.i(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")},t.prototype.set_dialogOnKeyUpHandler=function(e){return this._dialogOnKeyUpHandler=e,e},t.prototype.get_buttonsOption=function(){return this._buttonsOption},t.prototype.set_buttonsOption=function(e){this._buttonsOption=e,this.hideAllButtons();try{switch(this._buttonsOption){case 0:this.initializeButton(1,this._okText);break;case 1:this.initializeButton(1,this._okText),this.initializeButton(0,this._cancelText);break;case 2:this.initializeButton(1,this._okText),this.initializeButton(0,this._cancelText),this.initializeButton(2,this._retryText);break;case 3:this.initializeButton(1,this._yesText),this.initializeButton(0,this._cancelText),this.initializeButton(2,this._noText);break;case 4:this.initializeButton(1,this._yesText),this.initializeButton(2,this._noText);break;case 6:this.initializeButton(0,this._cancelText);break;case 7:this.initializeButton(1,this._permanentlyDeleteText),this.initializeButton(0,this._cancelText);break;case 8:this.initializeButton(1,this._shareAndNotifyText),this.initializeButton(0,this._cancelText);break;case 9:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(0,this._cancelText);break;case 10:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(3,this._tertiaryActionText),this.initializeButton(0,this._cancelText);break;case 11:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText);break;case 12:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(3,this._tertiaryActionText);break;case 13:this.initializeButton(1,this._actionText),this.initializeButton(2,this._secondaryActionText),this.initializeButton(3,this._tertiaryActionText),this.initializeButton(4,this._quaternaryActionText);break;case 14:this.initializeButton(2,this._secondaryActionText),this.initializeButton(1,this._actionText),this.initializeButton(0,this._cancelText)}}catch(e){switch(this._buttonsOption){case 0:this.initializeButton(1,null);break;case 1:this.initializeButton(1,null),this.initializeButton(0,null);break;case 2:case 3:this.initializeButton(1,null),this.initializeButton(0,null),this.initializeButton(2,null);break;case 4:this.initializeButton(1,null),this.initializeButton(2,null);break;case 6:this.initializeButton(0,null)}}return e},t.prototype.get_width=function(){return this._width},t.prototype.set_width=function(e){return this._width=e,e},t.prototype.get_overlayCss=function(){return this._overlayCssClass},t.prototype.set_overlayCss=function(e){return this._overlayCssClass=e,e},t.prototype.get_btnAction=function(){return this._btnAction},t.prototype.set_btnAction=function(e){return this._btnAction=e,e},t.prototype.get_canBePreempted=function(){return!1},t.prototype.get_hasRovingTabIndex=function(){return!1},t.prototype.get_menuRootUser=function(){return this._menuRootUser||(this._menuRootUser=v.w.get_instance().tryResolve(s.x))||u.ULS.sendTraceTag(20824577,207,10,"Could not resolve IDialogMenuRootUser"),this._menuRootUser},t.prototype.get_keyMoveAdapter=function(){return this._keyAdapter||(this._keyAdapter=v.w.get_instance().tryResolve(a.o))||u.ULS.sendTraceTag(21516489,207,10,"Could not resolve dialog KeyMoveAdapter"),this._keyAdapter},t.prototype.get_dismissFocusScope=function(){return this._dismissFocusScope},t.prototype.set_dismissFocusScope=function(e){return this._dismissFocusScope=e,e},t.prototype.prepareDialog=function(){if(this.get_isModalDialog()&&!this._overlayElement&&(this._overlayElement=this._document.createElement("div"),this._overlayElement.id=this.myId(E),this._overlayElement.className=this._overlayCssClass),this._divOuterDialogContainer)for(;this._divOuterDialogContainer.firstChild;)this._divOuterDialogContainer.removeChild(this._divOuterDialogContainer.firstChild);else this._divOuterDialogContainer=this._document.createElement("div"),this._divOuterDialogContainer.id=this.myId(T),this._divOuterDialogContainer.className=w;this._divInnerDialogContainer=this._document.createElement("div"),this._divInnerDialogContainer.id=this.myId("WACDialogInnerContainer"),this._divInnerDialogContainer.className="WACDialogInnerContainer",this._divMessageBox=this._document.createElement("div"),this._divMessageBox.id=this.myId(I),n(254).AFrameworkApplication.get_activeFrame()&&n(254).AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()?this._divMessageBox.className="MLRVisualRefresh "+this._dialogPanelCssClass:this._divMessageBox.className=this._dialogPanelCssClass,this._divMessageBox.setAttribute(b.t.ariaRoleAttribute,b.t.ariaDialogRole),this._divMessageBox.setAttribute(b.t.ariaLabelledByAttribute,this.myId("WACDialogTitleText")),this._clickManager=n(254).AFrameworkApplication.get_activeFrame().get_theClickInputManager(),this._keyInputManager=n(254).AFrameworkApplication.get_activeFrame().get_theKeyInputManager(),this._menuLaunchPoint=this._document.createElement("div"),this._menuLaunchPoint.className="WACDialogMenuLaunchPoint",this._divMessageBox.appendChild(this._menuLaunchPoint),this._divMessageBoxTitle=this._document.createElement("div"),this._divMessageBoxTitle.id=this.myId("WACDialogTitlePanel"),this._divMessageBoxTitle.className="WACDialogTitlePanel",this._titleText=this._document.createElement("div"),this._titleText.id=this.myId("WACDialogTitleText"),this._titleText.className="WACDialogTitleText",this._divMessageBoxTitle.appendChild(this._titleText),this.get_hasCloseGlyph()&&(this._closeAnchor=this._document.createElement("a"),this._closeAnchor.className="WACGlyph WACDialogCloseAnchor",this._closeAnchor.setAttribute(b.t.ariaRoleAttribute,b.t.ariaButtonRole),this._closeAnchor.title=this._closeText,this._divMessageBoxTitle.appendChild(this._closeAnchor),this._closeIconElement=n(973).createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACDialogCloseIcon",!0,""),this._closeAnchor.appendChild(this._closeIconElement)),this.get_hasTitleBar()||(this._divMessageBoxTitle.style.display="none"),this._divMessageBox.appendChild(this._divMessageBoxTitle),this._bodyPanel=this._document.createElement("div"),this._bodyPanel.id=this.myId("WACDialogBodyPanel"),this._bodyPanel.className="WACDialogBodyPanel",this._divMessageBox.appendChild(this._bodyPanel),this._body=this._document.createElement("div"),this._body.id=this.myId("WACDialogBodyContent"),this._body.className="WACDialogBodyContent",this._bodyPanel.appendChild(this._body),this.hasButtonPanel&&(this._buttonPanel=this._document.createElement("div"),this._buttonPanel.id=this.myId("WACDialogButtonPanel"),this._buttonPanel.className="WACDialogButtonPanel",this._divMessageBox.appendChild(this._buttonPanel),this._btnAction=this.prepareButton(1,t._actionButtonId),this._buttonDisplay[2]&&(this._btnSecondary=this.prepareButton(2,t._secondaryButtonId)),this._buttonDisplay[3]&&(this._btnTertiary=this.prepareButton(3,t._tertiaryButtonId)),this._buttonDisplay[4]&&(this._btnQuaternary=this.prepareButton(4,t._quaternaryButtonId)),this._buttonDisplay[0]&&(this._btnCancel=this._document.createElement("button"),this._buttons[0]=this._btnCancel,this._btnCancel.id=this.myId(t._cancelButtonId),this._btnCancel.className="WACButton WACDialogButtonNormal",this.setButtonProperties(this._btnCancel,0),this._buttonPanel.appendChild(this._btnCancel))),this._overlayElement&&this._outerBody.insertBefore(this._overlayElement,this._outerBody.firstChild),this._outerBody.insertBefore(this._divOuterDialogContainer,this._outerBody.firstChild),this._divOuterDialogContainer.appendChild(this._divInnerDialogContainer),this._divInnerDialogContainer.appendChild(this._divMessageBox),this._windowScrollHandler=o.i(this,this.scrollFix,"scrollFix"),this._windowResizeHandler=o.i(this,this.sizeFix,"sizeFix"),h.n.addHandler(window.self,"scroll",this._windowScrollHandler),h.n.addHandler(window.self,"resize",this._windowResizeHandler),this._dragAdapter=new(n(221).MoveDragAdapter)(this._divMessageBox),n(254).AFrameworkApplication.get_activeFrame().get_theDragInputManager().registerDragAdapter(this._divMessageBoxTitle,this._dragAdapter),t.areRegionComposerAPIsAvailable()&&this.registerForRegionComposerEvents()},t.prototype.prepareButton=function(e,t){var n=this._document.createElement("button");return this._buttons[e]=n,n.id=this.myId(t),14===this.get_buttonsOption()&&2===e?n.className="WACButton WACDialogButtonNormal WACAlignLeftButton":n.className="WACButton WACDialogButtonNormal",this.setButtonProperties(n,e),this._buttonPanel.appendChild(n),n},t.prototype.addMultiScreenClassNames=function(e){"DL"===e?(Sys.UI.DomElement.addCssClass(this._divMessageBox,"DL"),Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DP")):"DP"===e?(Sys.UI.DomElement.addCssClass(this._divMessageBox,"DP"),Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DL")):(Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DP"),Sys.UI.DomElement.removeCssClass(this._divMessageBox,"DL"))},t.prototype.registerForRegionComposerEvents=function(){var e=this;this._windowMode=n(254).AFrameworkApplication.get_activeFrame().get_adaptiveLayoutInstance().getWindowMode(),this._rectsWithoutKeyboard=n(254).AFrameworkApplication.get_activeFrame().get_adaptiveLayoutInstance().getWindowRectsWithoutKeyboard(),this.addMultiScreenClassNames(this._windowMode),n(254).AFrameworkApplication.get_activeFrame().get_adaptiveLayoutInstance().registerBoundingWindowRectsChanged("legacyDialog",(function(t,i){e._rectsWithoutKeyboard=n(254).AFrameworkApplication.get_activeFrame().get_adaptiveLayoutInstance().getWindowRectsWithoutKeyboard(),e._windowMode=i,e.addMultiScreenClassNames(i),e.reSizeDialog()})),this._isRegisteredWithRegionComposer||this.reSizeDialog(),this._isRegisteredWithRegionComposer=!0},t.prototype.unRegisterForRegionComposerEvents=function(){this._isRegisteredWithRegionComposer&&(n(254).AFrameworkApplication.get_activeFrame().get_adaptiveLayoutInstance().unregisterBoundingWindowRectsChanged("legacyDialog",null),this._isRegisteredWithRegionComposer=!1)},t.prototype.getMaxHeight=function(e){var t=n(254).AFrameworkApplication.get_activeFrame().get_adaptiveLayoutInstance().getKeyboardSegment();if(t){var i=t.left?0:t.height;return"DL"===this._windowMode?e:e-i}return e},t.prototype.needsToAvoidKeyboard=function(){if(this._rectsWithoutKeyboard.length>=1){var e=this._rectsWithoutKeyboard[0].height;if(this.getMaxHeight(e)!==e)return!0}return!1},t.prototype.getPageHeight=function(){if(t.areRegionComposerAPIsAvailable()&&this.needsToAvoidKeyboard()){var e=this._rectsWithoutKeyboard[0].height;return this.getMaxHeight(e)}return t.get_pageHeight()},t.prototype.getPageWidth=function(){return t.areRegionComposerAPIsAvailable()&&"DP"===this._windowMode&&this._rectsWithoutKeyboard.length>=1?this._rectsWithoutKeyboard[0].width:t.get_pageWidth()},t.prototype.centerDialog=function(){if(this._divMessageBox){var e=this._divMessageBox.style.zIndex;if(this._divMessageBox.style.zIndex="-9999",this._divMessageBox.offsetWidth<this.getPageWidth()){var i=String.format("{0}px",Math.floor(-this._divMessageBox.offsetWidth/2));n(254).AFrameworkApplication.get_isRtl()?this._divMessageBox.style.marginRight=i:this._divMessageBox.style.marginLeft=i,"DP"!==this._windowMode&&(n(254).AFrameworkApplication.get_isRtl()?this._divMessageBox.style.right="50%":this._divMessageBox.style.left="50%")}if(this._divMessageBox.offsetHeight<this.getPageHeight()&&this._divMessageBox.offsetTop>=0)if("DL"!==this._windowMode&&(this._divMessageBox.style.top="50%"),t.areRegionComposerAPIsAvailable()&&this.needsToAvoidKeyboard()){var r=this.getMaxHeight(this._rectsWithoutKeyboard[0].height);this._divMessageBox.style.marginTop=String.format("{0}px",Math.floor((r-this._divMessageBox.clientHeight)/2)),this._divMessageBox.style.top="unset"}else this._divMessageBox.style.marginTop=String.format("{0}px",Math.floor(-this._divMessageBox.offsetHeight/2));else t.areRegionComposerAPIsAvailable()&&this.needsToAvoidKeyboard()&&(this._divMessageBox.style.top="unset");this._divMessageBox.style.zIndex=String(e)}else u.ULS.sendTraceTag(17688785,306,10,"_divMessageBox is null in CenterDialog()")},t.prototype.dispose=function(){this.unRegisterForRegionComposerEvents(),this._useReactDialog?this.reactDispose():this.legacyDispose(),Sys.Component.prototype.dispose.call(this)},t.prototype.reactDispose=function(){var e=this;n(55).UISurfaces.getDialogAPIAsync().then((function(n){return n.dispose(),e.removeElement(e._divOuterDialogContainer),e._divOuterDialogContainer=null,t._currentDialog=null,e._disposed=!0,null}))},t.prototype.legacyDispose=function(){this._disposed||(null!==this._windowScrollHandler&&(h.n.removeHandler(window.self,"scroll",this._windowScrollHandler),h.n.removeHandler(window.self,"resize",this._windowResizeHandler),this._windowScrollHandler=null,this._windowResizeHandler=null),n(254).AFrameworkApplication.get_activeFrame()&&n(254).AFrameworkApplication.get_activeFrame().get_theDragInputManager()&&this._divMessageBoxTitle&&this._dragAdapter&&n(254).AFrameworkApplication.get_activeFrame().get_theDragInputManager().unregisterDragAdapter(this._divMessageBoxTitle,this._dragAdapter),this._dragAdapter=null,this._clickManager=null,this._keyInputManager=null,this._keyAdapter&&this._keyAdapter.get_inMoveMode()&&this._keyAdapter.exitMoveMode(),this._keyAdapter=null,this._divMessageBox&&C.s.elementAttached(this._divMessageBox)&&this.removeElement(this._divOuterDialogContainer),this._divOuterDialogContainer=null,this._divInnerDialogContainer=null,this._divMessageBox=null,this._btnAction=null,this._btnCancel=null,this._btnSecondary=null,this._btnTertiary=null,this._btnQuaternary=null,this._overlayElement=null,this._divMessageBoxTitle=null,this._buttonPanel=null,this._document=null,this._body=null,this._titleText=null,this._outerBody=null,this._closeAnchor=null,this._closeIconElement=null,t._currentDialog=null,this._disposed=!0)},t.prototype.removeElement=function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},t.prototype.hideAllButtons=function(){this.setButtonVisiblity(1,!1),this.setButtonVisiblity(0,!1),this.setButtonVisiblity(2,!1),this.setButtonVisiblity(3,!1),this.setButtonVisiblity(4,!1)},t.prototype.clickHandler=function(e){return this.executeDismissButton(e.get_sourceElement(),2),!0},t.prototype.keyHandler=function(e){return this.keyHandlerWithAction(e,o.i(this,this.executeDismissButtonFromArgs,"executeDismissButtonFromArgs"))},t.prototype.dialogDefaultEnterKeyHandler=function(e){if(e.innerEvent.keyCode===Sys.UI.Key.enter&&"a"!==e.get_sourceElement().tagName.toLowerCase()){if(n(254).AFrameworkApplication.dialogDefaultEnterBehaviorIsEnabled&&this.get_hasButtons()){var t=this.getButtonElement(this.getDefaultButton());this.executeDismissButton(t,1)}return!0}return!1},t.prototype.keyHandlerWithAction=function(e,t){if(e.innerEvent.ctrlKey||e.innerEvent.altKey||e.innerEvent.keyCode>=g.v.vK_F1&&e.innerEvent.keyCode<=g.v.vK_F12)return!1;if(e.eventName===p.d.keyUp&&this._keystrokeOnButtonPending){var n=e.innerEvent.keyCode;n!==Sys.UI.Key.enter&&n!==Sys.UI.Key.space||t(e),this._keystrokeOnButtonPending=!1}return e.eventName===p.d.keyDown&&(this._keystrokeOnButtonPending=!0),!0},t.prototype.executeDismissButtonFromArgs=function(e){this.executeDismissButton(e.get_sourceElement(),1)},t.prototype.onCheckboxFocusOrBlur=function(e){if(e){var t=e.target;e.type===p.d.focus?Sys.UI.DomElement.addCssClass(t.parentNode,"WACDialogCheckboxDivHighlight"):Sys.UI.DomElement.removeCssClass(t.parentNode,"WACDialogCheckboxDivHighlight")}else u.ULS.sendTraceTag(18465239,306,10,"event is null in OnCheckboxFocusOrBlur")},t.prototype.attachFocusHandlersForCheckbox=function(e){if(e){var t=e.getElementsByTagName("input");if(t)for(var n=0;n<t.length;n++){var i=t[n];"checkbox"===A.l.toLower(i.type)&&(h.n.addHandler(i,p.d.focus,o.i(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")),h.n.addHandler(i,p.d.blur,o.i(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")))}}},t.prototype.detachFocusHandlersForCheckbox=function(e){if(e){var t=e.getElementsByTagName("input");if(t)for(var n=0;n<t.length;n++){var i=t[n];"checkbox"===A.l.toLower(i.type)&&(h.n.removeHandler(i,p.d.focus,o.i(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")),h.n.removeHandler(i,p.d.blur,o.i(this,this.onCheckboxFocusOrBlur,"onCheckboxFocusOrBlur")))}}},t.prototype.executeDismissButton=function(e,t){void 0===t&&(t=0);var n=1;e===this._btnAction?n=1:e===this._btnCancel?n=0:e===this._btnSecondary?n=2:e===this._btnTertiary?n=3:e===this._btnQuaternary&&(n=4),this.validateAndHide(n,t)},t.prototype.logTelemetryInfo=function(e,t){if(this.ulsLogTelemetryInfo("Dialog"+i[e]),f.j.isUserActionLoggingToOtelEnabled()){var n=function(e){var t=0;switch(e){case 0:t=c.vN;break;case 1:t=c.Dd;break;case 2:t=c.cF;break;case 3:t=c.YE}return t}(e);n?(_.b(n,!0,_.u,t,8),u.ULS.sendTraceTag(39978636,207,50,"Dialog action logged")):u.ULS.sendTraceTag(51500119,207,15,"Dialog action ID not found for DialogButton value: ",e)}},t.prototype.ulsLogTelemetryInfo=function(e){if(f.j.oldActionsPipelineIsEnabled()){var t={};t.WacSessionId=n(254).AFrameworkApplication.userSessionId,t.ActionName=e,u.ULS.sendTraceTag(35489762,207,50,JSON.stringify(t))}},t.prototype.validateAndHide=function(e,t){void 0===t&&(t=0),this.logTelemetryInfo(e,t),e&&!this.validate()||(this._messageBoxHandler&&this._messageBoxHandler(e),this._hideOnButtonClick&&this.hide())},t.prototype.openDialogMenu=function(e,n,i,r,o){if(!this.get_menuLaunchPoint()||!this.get_menuRootUser())return 16;t._dialogMenuInit||(this.get_menuRootUser().createDialogMenu("DialogMenuId","1245654357","844297214"),t._dialogMenuInit=!0);var a=y.g.getElementLocation(this.get_menuLaunchPoint());return this.get_menuRootUser().showDialogMenuAt("DialogMenuId",a.x,a.y,1),32},t.prototype.enterMovableMode=function(e,n,i,r,o){return 1===i?32:t.get_currentDialog()&&this.get_keyMoveAdapter()?(this.get_keyMoveAdapter().enterMoveMode(this.get_dialogElement()),32):16},t.prototype.initializeButton=function(e,t){this.setButtonVisiblity(e,!0),this.setButtonState(e,!0),this.setButtonText(e,t)},t.prototype.setButtonProperties=function(e,t){var n=t;e.setAttribute("type","button"),e.disabled=!this._buttonState[n],e.style.display=this._buttonDisplay[n]?"inline":"none",e.innerText=this._buttonText[n]},t.prototype.closeHandler=function(e){return this.validateAndHide(0,2),!0},t.prototype.scrollFix=function(e){this._overlayElement&&(this._overlayElement.style.top=String.format("{0}px",t.get_posTop()),this._overlayElement.style.left=String.format("{0}px",t.get_posLeft()))},t.prototype.reSizeDialog=function(){this._divMessageBox?(this.resetDialogStyle(),this._divMessageBox.clientWidth>this.getPageWidth()&&(this._divMessageBox.style.width=String.format("{0}px",this.getPageWidth()),this._divMessageBox.style.overflowX="scroll",this._divMessageBox.style.minWidth="0px"),this._divMessageBox.offsetParent&&this._divMessageBox.clientHeight+this._divMessageBox.offsetParent.offsetTop>this.getPageHeight()&&(this._divMessageBox.style.marginTop=-this._divMessageBox.offsetParent.offsetTop+"px"),this._divMessageBox.clientHeight>this.getPageHeight()&&(this._divMessageBox.style.height=String.format("{0}px",this.getPageHeight()),this._divMessageBox.style.overflowY="scroll"),this.centerDialog()):u.ULS.sendTraceTag(19409122,306,10,String.format("_divMessageBox is null in ResizeDialog(), already disposed: {0}",this._disposed))},t.prototype.resetDialogStyle=function(){this._divMessageBox.style.height="auto",this._divMessageBox.style.width="auto",this._divMessageBox.style.overflowY="hidden",this._divMessageBox.style.overflowX="hidden",this._divMessageBox.style.marginTop="",this._divMessageBox.style.top="",n(254).AFrameworkApplication.get_isRtl()?(this._divMessageBox.style.right="",this._divMessageBox.style.marginRight=""):(this._divMessageBox.style.left="",this._divMessageBox.style.marginLeft="")},t.prototype.sizeFix=function(e){this._overlayElement&&(this._overlayElement.style.height=String.format("{0}px",t.get_pageHeight()),this._overlayElement.style.width=String.format("{0}px",t.get_pageWidth())),this._menuRootUser&&this._menuRootUser.closeDialogMenu("DialogMenuId"),this.reSizeDialog()},t.prototype.setButtonVisiblity=function(e,t){var n=e;this._buttonDisplay[n]=t,this._buttons[n]&&(this._buttons[n].style.display=t?"inline":"none")},t.prototype.getButtonElement=function(e){var t=null;switch(e){case 0:t=this._btnCancel;break;case 1:t=this._btnAction;break;case 2:t=this._btnSecondary;break;case 3:t=this._btnTertiary;break;case 4:t=this._btnQuaternary}return t},t.prototype.setAriaAttributeForDialog=function(e,t){this._divMessageBox&&e&&t?this._divMessageBox.setAttribute(e,t):u.ULS.sendTraceTag(19449870,306,10,String.format("Invalid state in SetAriaAttributeForDialog(), _divMessageBox == null {0}, already disposed: {1}, AFrameworkApplication.ActiveFrame == null: {2}, ariaAttribute == null: {3}, value == null: {4}",!this._divMessageBox,this._disposed,!n(254).AFrameworkApplication.get_activeFrame(),!e,!t))},t.prototype.get_hasButtons=function(){return 5!==this._buttonsOption},t.prototype.get_hasCloseGlyph=function(){return this._hasCloseGlyph},t.prototype.set_hasCloseGlyph=function(e){return this._hasCloseGlyph=e,e},t.prototype.get_hasTitleBar=function(){return this._hasTitleBar},t.prototype.set_hasTitleBar=function(e){return this._hasTitleBar=e,e},t.prototype.get_isShowing=function(){return this._visible},t.prototype.get_isModalDialog=function(){return!0},t.prototype.get_dialogId=function(){return this._id},t.prototype.set_dialogId=function(e){return this._id=e,e},t.prototype.myId=function(e){return this._clientId+e},t.prototype.validate=function(){return!0},t.prototype.showOverlay=function(){this._overlayElement&&(this._overlayElement.style.height="100%",this._overlayElement.style.width="100%",this._overlayElement.style.top="0",this._overlayElement.style.left="0",this._overlayElement.style.display="block",this._showTransparentOverlay&&(this._overlayElement.style.opacity=".0"))},t.prototype.unblockOverlay=function(){this._overlayElement&&(this._overlayElement.style.display="none")},t.prototype.attachDialogEvents=function(){this.get_hasCloseGlyph()&&!this._closeClickHandler&&(this._closeClickHandler=o.i(this,this.closeHandler,"closeHandler"),this._clickManager.registerHandler(p.d.click,this._closeIconElement,this._closeClickHandler)),this._divMessageBox&&this.attachFocusHandlersForCheckbox(this._divMessageBox),this.get_hasButtons()&&(this._buttonClickHandler||(this._buttonClickHandler=o.i(this,this.clickHandler,"clickHandler"),this._clickManager.registerHandler(p.d.click,this._btnAction,this._buttonClickHandler),this._btnCancel&&this._clickManager.registerHandler(p.d.click,this._btnCancel,this._buttonClickHandler),this._btnSecondary&&this._clickManager.registerHandler(p.d.click,this._btnSecondary,this._buttonClickHandler),this._btnTertiary&&this._clickManager.registerHandler(p.d.click,this._btnTertiary,this._buttonClickHandler),this._btnQuaternary&&this._clickManager.registerHandler(p.d.click,this._btnQuaternary,this._buttonClickHandler)),this._buttonKeyHandler||(this._buttonKeyHandler=o.i(this,this.keyHandler,"keyHandler"),this._keyInputManager.registerHandler(p.d.keyDown,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.registerHandler(p.d.keyDown,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.registerHandler(p.d.keyDown,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.registerHandler(p.d.keyDown,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.registerHandler(p.d.keyDown,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.registerHandler(p.d.keyPress,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.registerHandler(p.d.keyPress,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.registerHandler(p.d.keyPress,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.registerHandler(p.d.keyPress,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.registerHandler(p.d.keyPress,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.registerHandler(p.d.keyUp,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.registerHandler(p.d.keyUp,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.registerHandler(p.d.keyUp,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.registerHandler(p.d.keyUp,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.registerHandler(p.d.keyUp,this._btnQuaternary,this._buttonKeyHandler)),this._divMessageBox&&(this._keyInputManager.registerHandler(p.d.keyDown,this._divMessageBox,this.get_dialogOnKeyDownHandler()),this._keyInputManager.registerHandler(p.d.keyPress,this._divMessageBox,this.get_dialogOnKeyPressHandler()),n(254).AFrameworkApplication.get_removeWacDialogKeyUpHandler()||this._keyInputManager.registerHandler(p.d.keyUp,this._divMessageBox,this.get_dialogOnKeyUpHandler())))},t.prototype.detachDialogEvents=function(){this._closeClickHandler&&(this._clickManager.unregisterHandler(p.d.click,this._closeIconElement,this._closeClickHandler),this._closeClickHandler=null),this._divMessageBox&&this.detachFocusHandlersForCheckbox(this._divMessageBox),this._buttonClickHandler&&(this._clickManager.unregisterHandler(p.d.click,this._btnAction,this._buttonClickHandler),this._btnCancel&&this._clickManager.unregisterHandler(p.d.click,this._btnCancel,this._buttonClickHandler),this._btnSecondary&&this._clickManager.unregisterHandler(p.d.click,this._btnSecondary,this._buttonClickHandler),this._btnTertiary&&this._clickManager.unregisterHandler(p.d.click,this._btnTertiary,this._buttonClickHandler),this._btnQuaternary&&this._clickManager.unregisterHandler(p.d.click,this._btnQuaternary,this._buttonClickHandler),this._buttonClickHandler=null),this._buttonKeyHandler&&(this._keyInputManager.unregisterHandler(p.d.keyDown,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.unregisterHandler(p.d.keyDown,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.unregisterHandler(p.d.keyDown,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.unregisterHandler(p.d.keyDown,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.unregisterHandler(p.d.keyDown,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.unregisterHandler(p.d.keyPress,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.unregisterHandler(p.d.keyPress,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.unregisterHandler(p.d.keyPress,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.unregisterHandler(p.d.keyPress,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.unregisterHandler(p.d.keyPress,this._btnQuaternary,this._buttonKeyHandler),this._keyInputManager.unregisterHandler(p.d.keyUp,this._btnAction,this._buttonKeyHandler),this._btnCancel&&this._keyInputManager.unregisterHandler(p.d.keyUp,this._btnCancel,this._buttonKeyHandler),this._btnSecondary&&this._keyInputManager.unregisterHandler(p.d.keyUp,this._btnSecondary,this._buttonKeyHandler),this._btnTertiary&&this._keyInputManager.unregisterHandler(p.d.keyUp,this._btnTertiary,this._buttonKeyHandler),this._btnQuaternary&&this._keyInputManager.unregisterHandler(p.d.keyUp,this._btnQuaternary,this._buttonKeyHandler),this._divMessageBox&&(this._keyInputManager.unregisterHandler(p.d.keyDown,this._divMessageBox,this.get_dialogOnKeyDownHandler()),this._keyInputManager.unregisterHandler(p.d.keyPress,this._divMessageBox,this.get_dialogOnKeyPressHandler()),n(254).AFrameworkApplication.get_removeWacDialogKeyUpHandler()||this._keyInputManager.unregisterHandler(p.d.keyUp,this._divMessageBox,this.get_dialogOnKeyUpHandler())),this._buttonKeyHandler=null)},t.prototype.show=function(e){if(this._disposed)throw Error.invalidOperation("This dialog has already been disposed and cannot be shown again");this._visible||(this._useReactDialog&&null!=e?this.reactShow(e):(this._useReactDialog=!1,this.legacyShow()),this._visible=!0,u.ULS.sendTraceTag(50402897,207,50,"Dialog launched for Id: {0}",this.get_dialogId()),this.allowKeytips(!1))},t.prototype.reactShow=function(e){this.addFocusScope(),n(254).AFrameworkApplication.dismissSplashScreenImmediately(),n(254).AFrameworkApplication.get_activeFrame().beginModal(!1),e.dialogButtonsOption=e.dialogButtonsOption||this.get_buttonsOption(),this.addButtonProps(1,(0,l.m)((function(){return e}),(function(t){return e=t}))),this.addButtonProps(2,(0,l.m)((function(){return e}),(function(t){return e=t}))),this.addButtonProps(3,(0,l.m)((function(){return e}),(function(t){return e=t}))),this.addButtonProps(4,(0,l.m)((function(){return e}),(function(t){return e=t}))),this.addButtonProps(0,(0,l.m)((function(){return e}),(function(t){return e=t}))),e.defaultExecutionButton=e.defaultExecutionButton||this._defaultButton,e.hideCloseButton=e.hideCloseButton||!this._hasCloseGlyph,e.canBeOverridden=e.canBeOverridden||this.get_canBePreempted(),e.shouldOverrideExistingDialog=e.shouldOverrideExistingDialog||this._shouldPreemptExistingDialog,e.hidden=!1,n(55).UISurfaces.getDialogAPIAsync().then((function(t){return t.show(e.id,e),null}))},t.prototype.addButtonProps=function(e,t){if(this._buttonDisplay[e]){var n;switch(e){case 1:n="actionButtonProps";break;case 2:n="secondaryActionButtonProps";break;case 3:n="tertiaryActionButtonProps";break;case 4:n="quaternaryActionButtonProps";break;case 0:n="cancelButtonProps";break;default:return}t.val[n]=t.val[n]||{label:this._buttonText[e],disabled:!this._buttonState[e]}}},t.prototype.legacyShow=function(){if(n(254).AFrameworkApplication.get_activeFrame()&&(n(254).AFrameworkApplication.get_activeFrame().prepareForDialog(),n(254).AFrameworkApplication.get_activeFrame().beginModal(!1),this._overlayElement&&(this._overlayElement.style.zIndex=String(n(254).AFrameworkApplication.get_activeFrame().get_activeModalDivZIndex())),this._divMessageBox.style.zIndex=String(n(254).AFrameworkApplication.get_activeFrame().get_activeModalUIZIndex()),n(254).AFrameworkApplication.get_activeFrame().set_state(this.get_isModalDialog()?1:2),t._dialogCloseHandler||(t._dialogCloseHandler=t.dialogClose,n(254).AFrameworkApplication.get_theActionManager().addAction(c.bH,S.a,t._dialogCloseHandler)),n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AccessibleMovingDialogsEnabled")&&(t._dialogOpenMenuHandler||(t._dialogOpenMenuHandler=o.i(this,this.openDialogMenu,"openDialogMenu"),n(254).AFrameworkApplication.get_theActionManager().addAction(c.pJ,S.a,t._dialogOpenMenuHandler)),t._dialogMoveModeHandler||(t._dialogMoveModeHandler=o.i(this,this.enterMovableMode,"enterMovableMode"),n(254).AFrameworkApplication.get_theActionManager().addAction(c.wL,S.a,t._dialogMoveModeHandler))),this.addFocusScope()),n(254).AFrameworkApplication.dismissSplashScreenImmediately(),t.setBackgroundVisibility("hidden"),this.showOverlay(),this.attachDialogEvents(),this.get_hasButtons()){var e=this.getButtonElement(this.getDefaultButton());this.setFocusOnElement(e)}this.reSizeDialog()},t.prototype.addFocusScope=function(){if(d.FocusManager.usable()){var e=d.FocusManager.instance(),t=e.getScope(this.get_fullDialogFocusId());t.parent=n(751).AFrame.appFocusId;var i=this._useReactDialog?this._divOuterDialogContainer:this._divMessageBox,r=e.get_currentScope()&&e.getCurrentRegion()&&e.getCurrentRegion().listing?e.getCurrentRegion().listing.get_currentElement():document.activeElement;C.s.isEditable(r)||e.get_currentScope()&&e.get_currentScope().parent===d.FocusManager.editingFocusId||e.get_currentScope()&&e.get_currentScope().name===n(751).AFrame.previewPanelId||e.get_currentScope()&&e.get_currentScope().name===n(751).AFrame.versionHistoryOverlayId?(this._revertToLastScope=!0,e.pushScope(this.get_fullDialogFocusId(),!1)):e.scopeChanged(this.get_fullDialogFocusId()),this._useReactDialog||(t.bindAction(m.KeyInputManager.hashKey(g.v.vK_Escape,0),c.bH),t.bindAction(m.KeyInputManager.hashKey(g.v.vK_Space,3),c.pJ));var o=new(n(197).DOMFocusListing)((function(){return i}));o.rememberFirstElement=!this.get_hasRovingTabIndex(),o.addValidTag(3),o.addValidTag(2),o.addValidTag(4),o.addValidTag(1),o.addValidTag(6),o.addValidTag(5);var a=e.buildRegionWithDelegate((function(){return i}),e.getScope(this.get_fullDialogFocusId()),o);if(a.rememberFocusStealers(),a.looped=this._tabOrderLooped,a.contained=!0,this._useReactDialog){t.set_keyDownHandledExternally(!0);var s=m.KeyInputManager.hashKey(g.v.vK_Tab,0),l=m.KeyInputManager.hashKey(g.v.vK_Tab,4);t.unBindAction(s),t.unBindAction(l),t.bindAction(s,c.Ps),t.bindAction(l,c.Ps)}}},t.prototype.removeFocusScope=function(){if(d.FocusManager.usable()&&!n(254).AFrameworkApplication.isShuttingDown){var e=d.FocusManager.instance();this._revertToLastScope?(this._revertToLastScope=!1,e.popScope(this.get_fullDialogFocusId())):this.get_dismissFocusScope()?e.setScope(this.get_dismissFocusScope()):e.setScope(e.get_defaultScopeName());var t=e.getRegion(this.get_fullDialogFocusId());t&&t.listing.trySetCurrentElement(null),e.removeScope(this.get_fullDialogFocusId())}},t.prototype.setFocusOnElement=function(e){d.FocusManager.usable()?d.FocusManager.instance().getRegion(this.get_fullDialogFocusId()).listing.forceSetCurrentElement(e):e.focus()},t.prototype.setButtonText=function(e,t){var n=e;this._buttonText[n]=t,this._buttons[n]&&(this._buttons[n].innerText=t)},t.prototype.getButtonText=function(e){return this._buttonText[e]},t.prototype.setButtonState=function(e,t){var n=e;this._buttonState[n]=t,this._buttons[n]&&(this._buttons[n].disabled=!t)},t.prototype.getButtonState=function(e){return this._buttonState[e]},t.prototype.setDefaultButton=function(e){this._defaultButton=e},t.prototype.getDefaultButton=function(){return this._defaultButton},t.prototype.setLabelledByForDialog=function(e){this.setAriaAttributeForDialog(b.t.ariaLabelledByAttribute,e)},t.prototype.setDescribedByForDialog=function(e){this.setAriaAttributeForDialog(b.t.ariaDescribedByAttribute,e)},t.prototype.hide=function(){this.hideInternal(!1)},t.prototype.hidePreservingMessageBoxElement=function(){this.hideInternal(!0)},t.prototype.hideInternal=function(e){this._useReactDialog?this.reactHideInternal(e):this.legacyHideInternal(e),this._disposeOnHide&&!e&&this.dispose()},t.prototype.reactHideInternal=function(e){e&&n(55).UISurfaces.getDialogAPIAsync().then((function(e){return e.hide(),null})),n(254).AFrameworkApplication.get_activeFrame().endModal(!1),n(254).AFrameworkApplication.get_activeFrame()&&(n(254).AFrameworkApplication.get_activeFrame().set_state(0),this.removeFocusScope()),this._visible=!1,this.allowKeytips(!0)},t.prototype.legacyHideInternal=function(e){this._visible&&(n(254).AFrameworkApplication.get_activeFrame().endModal(!1),this._overlayElement&&(this._overlayElement.style.zIndex="-1"),this._divMessageBox.style.zIndex="-1",t.setBackgroundVisibility("visible"),n(254).AFrameworkApplication.get_activeFrame()&&(n(254).AFrameworkApplication.get_activeFrame().set_state(0),this.removeFocusScope()),this.detachDialogEvents(),e?(this._overlayElement.style.display="none",this._divMessageBox.style.display="none"):(this._overlayElement&&this.removeElement(this._overlayElement),this._divOuterDialogContainer?this.removeElement(this._divOuterDialogContainer):u.ULS.sendTraceTag(25247879,207,50,"DivOuterDialogContainer is null")),this._visible=!1,this.allowKeytips(!0))},t.prototype.allowKeytips=function(e){this.isSimplifiedReactRibbonUxEnabled&&n(327).apiExists("allowKeytips")&&this.get_isModalDialog()&&appChrome.api.allowKeytips(e)},t.get_currentDialog=function(){return t._currentDialog},t.set_currentDialog=function(e){return t._currentDialog=e,e},t.areRegionComposerAPIsAvailable=function(){return!!n(254).AFrameworkApplication.get_activeFrame()&&n(254).AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRegionComposerEnabled()&&!!n(254).AFrameworkApplication.get_activeFrame().get_adaptiveLayoutInstance()},t.setBackgroundVisibility=function(e){for(var n=["object"],i=0;i<n.length;i++)for(var r=n[i],o=document.getElementsByTagName(r),a=o.length-1;a>=0;a--)(!o[a].className||-1===o[a].className.indexOf(t._objectInDialogCssClass)&&-1===o[a].className.indexOf(t._addinIframeCssClass))&&(o[a].style.visibility=e)},t.dialogClose=function(e,n,i,r,o){var a=t.get_currentDialog();return a?1===i?32:a.get_hasCloseGlyph()?(a.validateAndHide(0,1),32):2:16},t.get_pageWidth=function(){return window.document.documentElement.clientWidth},t.get_pageHeight=function(){return window.document.documentElement.clientHeight},t.get_posLeft=function(){return window.document.documentElement.scrollLeft},t.get_posTop=function(){return window.document.documentElement.scrollTop},t.isNumber=function(e){return!isNaN(parseInt(e))},t.isPositive=function(e){var t=!1,n=parseInt(e);return!isNaN(n)&&n>=0&&(t=!0),t},t._dialogMenuInit=!1,t.dialogFocusId="dialog",t._actionButtonId="WACDialogActionButton",t._secondaryButtonId="WACDialogSecondaryButton",t._tertiaryButtonId="WACDialogTertiaryButton",t._quaternaryButtonId="WACDialogQuaternaryButton",t._cancelButtonId="WACDialogCancelButton",t._objectInDialogCssClass="ObjectInDialog",t._addinIframeCssClass="AddinIframe",t._dialogCloseHandler=null,t._dialogOpenMenuHandler=null,t._dialogMoveModeHandler=null,t._currentDialog=null,t}(Sys.UI.Control);(0,o.l)(D,"Dialog",Sys.UI.Control,[])},function(e,t,n){"use strict";var i=n(572),r=n(998),o=n(208),a=function(e){var t="IList$1$"+e.getName();return(0,o.g)(t)},s=n(602),l=n(367),u=function(){function e(e){this._array=null,this._index=-1,this._array=e}return e.prototype.get_current=function(){if(-1===this._index||this._index>=this._array.length)throw Error.invalidOperation();return this._array[this._index]},e.prototype.moveNext=function(){return this._index++,this._index<this._array.length},e.prototype.reset=function(){this._index=-1},e}();(0,o.l)(u,"ArrayEnumerator",null,[l.e]),n.d(t,{c:function(){return c}});var c=function(){function e(t){this._items=null,this.$$ge=this.$$lge,this.getEnumerator=this.GetEnumerator,o.m(this,e.$$(t)),this._items=new Array(0)}return e.prototype.$$lge=function(){return new s.l(o.f(this,"$$sc.List$1").T,this._items)},e.prototype.GetEnumerator=function(){return new u(this._items)},e.prototype.get_count=function(){return this._items.length},e.prototype.add=function(e){Array.add(this._items,e)},e.prototype.clear=function(){this._items=new Array(0)},e.prototype.contains=function(e){return Array.contains(this._items,e)},e.prototype.remove=function(e){return!!this.contains(e)&&(Array.remove(this._items,e),!0)},e.prototype.indexOf=function(e){return Array.indexOf(this._items,e)},e.prototype.removeAt=function(e){if(e>=this.get_count())throw Error.argumentOutOfRange("index");Array.removeAt(this._items,e)},e.prototype.get_item=function(e){if(e>=this.get_count())throw Error.argumentOutOfRange("index");return this._items[e]},e.prototype.set_item=function(e,t){if(e>=this.get_count())throw Error.argumentOutOfRange("index");return this._items[e]=t,t},e.prototype.addRange=function(e){for(var t=e.$$ge();t.$$mn();){var n=t.$$cu();this.add(n)}},e.prototype.insert=function(e,t){if(e>this.get_count())throw Error.argumentOutOfRange("index");Array.insert(this._items,e,t)},e.prototype.insertRange=function(e,t){if(e>this.get_count())throw Error.argumentOutOfRange("index");for(var n=t.$$ge();n.$$mn();){var i=n.$$cu();Array.insert(this._items,e++,i)}},e.prototype.toArray=function(){return Array.clone(this._items)},e.prototype.sort=function(){this._items.sort()},e.prototype.Sc=function(e){this._items.sort((function(t,n){return e(t,n)}))},e.$$=function(t){var n="List$1$"+t.getName(),s=o.x(n);return s||o.u(n,"$$sc.List$1",e,[{T:t}],null,[a(t),i.i,r.k])},e}()},function(e,t,n){"use strict";n.d(t,{cP:function(){return i},v:function(){return r},ZB:function(){return o},D:function(){return a},Pb:function(){return s},zh:function(){return l},Yh:function(){return u},CZ:function(){return c},xx:function(){return p},ON:function(){return d},qk:function(){return h},YO:function(){return g},Xz:function(){return m},nZ:function(){return _},Vu:function(){return f},lq:function(){return y},dL:function(){return v},Hk:function(){return S},Sb:function(){return C},jK:function(){return b},hD:function(){return A},QM:function(){return T},Pi:function(){return w},Hn:function(){return I},yZ:function(){return E},Mn:function(){return k},Nc:function(){return D},AM:function(){return M},AP:function(){return P},pC:function(){return F},AG:function(){return x},pw:function(){return R},Qc:function(){return B},Ui:function(){return L},Kg:function(){return N},yV:function(){return U},Le:function(){return O},ll:function(){return H},GA:function(){return W},dk:function(){return V},Ut:function(){return $},AB:function(){return K},HE:function(){return z},QD:function(){return q},zp:function(){return Q},dJ:function(){return G},vx:function(){return j},jS:function(){return Z},sV:function(){return X},cY:function(){return J},cv:function(){return Y},iy:function(){return ee},AH:function(){return te},SB:function(){return ne},IJ:function(){return ie},l:function(){return re},MJ:function(){return oe},lF:function(){return ae},Xq:function(){return se},bn:function(){return le},ln:function(){return ue},Us:function(){return ce},vI:function(){return pe},oW:function(){return de},di:function(){return he},hP:function(){return ge},ye:function(){return me},pP:function(){return _e},Od:function(){return fe},lH:function(){return ye},Ap:function(){return ve},no:function(){return Se},HF:function(){return Ce},RV:function(){return be},Io:function(){return Ae},P:function(){return Te},SN:function(){return we},ev:function(){return Ie},oi:function(){return Ee},KG:function(){return ke},wQ:function(){return De},Hb:function(){return Me},Mj:function(){return Pe},oA:function(){return Fe},dc:function(){return xe},xH:function(){return Re},rG:function(){return Be}});var i=146879195,r=4038446671,o=3614810735,a=940168130,s=3686078251,l=2474762090,u=1041156544,c=2718896640,p=3383614517,d=3571000895,h=3082914623,g=1485307652,m=1045098306,_=1074370255,f=2719151194,y=2289035997,v=2268993336,S=2376600552,C=2599343072,b=1925081555,A=1548165396,T=716333338,w=3346400015,I=2092285007,E=1314702013,k=2854499422,D=3006111724,M=3588168074,P=2947452783,F=3870085532,x=2936063169,R=2589737880,B=1568572584,L=3940382077,N=1693292334,U=3537571872,O=1480533506,H=3321901940,W=310212246,V=1122736542,$=936755515,K=1289223352,z=495441999,q=433063458,Q=2918606216,G=3838916066,j=702693766,Z=2778760596,X=569132212,J=541818074,Y=2385100972,ee=662384170,te=2866603464,ne=3456074588,ie=135979168,re=3369669304,oe=340039443,ae=2180939724,se=1783913247,le=4117423060,ue=3073381345,ce=1297807363,pe=3828858224,de=231667503,he=3458683028,ge=2802067523,me=1725824390,_e=3402718245,fe=4205256019,ye=2893474578,ve=428795035,Se=329275380,Ce=3349150556,be=2281051331,Ae=976411380,Te=2680748364,we=573791575,Ie=2612243365,Ee=3917526816,ke=851844167,De=2195537549,Me=3850825085,Pe=779228655,Fe=4224281129,xe=1495397774,Re=1281912385,Be=function(e){switch(e){case 146879195:return"AnimateScrollStarted";case 4038446671:return"BeforeAnimateScroll";case 3614810735:return"BeginSelection";case 940168130:return"BinaryConvert";case 3686078251:return"BroadcastOnScroll";case 2474762090:return"BrowserCopied";case 1041156544:return"BuildClipboard";case 2718896640:return"CommentDownloadCorrupt";case 3383614517:return"Copy";case 482496454:return"DirectPrintForPdfMode";case 3571000895:return"DocumentLoadFinished";case 3082914623:return"DoubleClickSelection";case 1485307652:return"DownloadAsPdf";case 1045098306:return"DownloadATranslatedCopy";case 1074370255:return"EndSelection";case 2719151194:return"FitHeight";case 2289035997:return"FitWidth";case 2268993336:return"HandleEscKeyDown";case 2376600552:return"HideAllPanes";case 2599343072:return"HideSearchPane";case 1925081555:return"LaunchImmersiveReader";case 1548165396:return"NextPage";case 716333338:return"NextSearchResult";case 3346400015:return"OnAppReady";case 2092285007:return"OnContainerResizeForSelection";case 1314702013:return"OnCurrentPageChange";case 1008943434:return"OnLabelPoll";case 2854499422:return"OnScroll";case 3006111724:return"OnZoomChange";case 1381613595:return"OpenAccessibleView";case 3588168074:return"OpenInClient";case 2947452783:return"OpenInWordViewer";case 3870085532:return"OpenSharedNotes";case 2936063169:return"PageCacheChanged";case 2491927299:return"PageSetResized";case 2589737880:return"PopulateContextMenu";case 1568572584:return"PopulateZoomFlyout";case 3940382077:return"PreventWarningsOnAppClose";case 1693292334:return"PreviousSearchResult";case 3537571872:return"PrevPage";case 1480533506:return"PrintAccessibilityDocument";case 3321901940:return"PrintDocument";case 127034278:return"PrintXml";case 310212246:return"QueryAccessibleModeButtonToggledState";case 1122736542:return"QueryCurrentPageLabel";case 936755515:return"QueryPresenterPageLabel";case 1289223352:return"QueryToggleSearchPane";case 495441999:return"QueryZoomLevel";case 433063458:return"QueryZoomText";case 2918606216:return"RebuildCommentHints";case 3838916066:return"RebuildCommentHintsWithoutAnimation";case 702693766:return"RepositionScroller";case 2778760596:return"RepositionScrollerWithoutAnimation";case 569132212:return"ResizeCache";case 541818074:return"ResizeCacheWithoutAnimation";case 2385100972:return"ResizeScroller";case 662384170:return"ResizeScrollerWithoutAnimation";case 2866603464:return"SaveAndEditATranslatedCopy";case 3456074588:return"ScrollDownArrow";case 135979168:return"ScrollEnd";case 3369669304:return"ScrollHome";case 340039443:return"ScrollLeftArrow";case 2180939724:return"ScrollPageDown";case 1783913247:return"ScrollPageUp";case 4117423060:return"ScrollRightArrow";case 3073381345:return"ScrollUpArrow";case 1297807363:return"SelectFromScroll";case 3828858224:return"SetCurrentPage";case 231667503:return"SetZoomLevel";case 3458683028:return"ShowContextMenuFromKey";case 2802067523:return"ShowContextMenuInDocument";case 1725824390:return"ShowFileEmbedInfo";case 3402718245:return"ShowPdfConvertAndEditDialog";case 4205256019:return"ShowPdfCopyAndEditDialog";case 2893474578:return"ShowReembedCode";case 428795035:return"ShowSearchPane";case 2666100903:return"SLPageReady";case 4125937875:return"StatusBarTest";case 329275380:return"SwitchToEditMode";case 3349150556:return"SyncToPresenter";case 2281051331:return"ToggleCommentPane";case 583433745:return"ToggleMenu";case 976411380:return"ToggleSearchPane";case 2680748364:return"ToggleViewMode";case 573791575:return"TranslateBackToOriginal";case 2612243365:return"TranslateDocument";case 3917526816:return"UpdateCommentHighlight";case 851844167:return"UpdateSearchHighlight";case 2195537549:return"UpdateSelection";case 3850825085:return"UpdateZoomOnWindowResize";case 779228655:return"XmlPageDownloaded";case 4224281129:return"XmlPageDownloaded2";case 1495397774:return"XmlPageDownloaded3";case 1281912385:return"ZoomToNextLevel"}return null}},,,function(e,t,n){"use strict";var i=n(508),r=n(208),o=n(451),a=n(550),s=n(929),l=n(446),u=n(574),c=n(425),p=function(e){function t(t,n,i,r){var o=e.call(this,u.d.contextMenu,n,t,r)||this;return o._clientPoint=null,o._clientPoint=i,o}return(0,i.t)(t,e),t.prototype.get_clientPoint=function(){return this._clientPoint},t.create=function(e,n,i){var r,o;n.rawEvent;if(e===u.d.touchContextMenu)r=3,o=l.a.getClientPointFromTouchEvent(n);else{var a=n.rawEvent;r=i,o=c.y.get_isMac()||!a?new Sys.UI.Point(n.clientX,n.clientY):new Sys.UI.Point(a.clientX,a.clientY)}return new t(n,l.a.getSourceElement(n),o,r)},t}(l.a);(0,r.l)(p,"ContextMenuEventArgs",l.a,[]);var d=n(47),h=n(306),g=n(733),m=n(386),_=n(810),f=n(101),y=n(235);n.d(t,{r:function(){return v}});var v=function(e){function t(){var t=e.call(this)||this;return t._eventHandlerManager=null,t._dragInputManager=null,t._gestureInputManager=null,t._cancelPointersOnContextMenu=!1,t._isSuppressingMenus=!1,t._lastInputMethodHeard=0,t._eventHandlerManager=h.EventHandlerManager.get_instance(),g.z.get_instance().registerOnBeforeEventProcessed(u.d.pointerDown,r.i(t,t.onPointerEventHeard,"onPointerEventHeard")),g.z.get_instance().registerOnBeforeEventProcessed(u.d.pointerUp,r.i(t,t.onPointerEventHeard,"onPointerEventHeard")),h.EventHandlerManager.get_instance().registerOnBeforeEventProcessed(u.d.keyDown,r.i(t,t.onKeyEventHeard,"onKeyEventHeard")),h.EventHandlerManager.get_instance().registerOnBeforeEventProcessed(u.d.keyUp,r.i(t,t.onKeyEventHeard,"onKeyEventHeard")),t._cancelPointersOnContextMenu=!1,n(254).AFrameworkApplication.appSettingsManager&&(t._cancelPointersOnContextMenu=n(254).AFrameworkApplication.isMultiTouchGestureEnabled()&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MultiTouchCancelPointersOnContextMenu")),t._cancelPointersOnContextMenu&&(t._dragInputManager=d.p.get_instance(),t._gestureInputManager=y.w.get_instance().resolveFuture(o.k)),t}return(0,i.t)(t,e),t.prototype.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeEventForElement(u.d.contextMenu,t,2,r.i(this,this.onContextMenu,"onContextMenu")),this._eventHandlerManager.initializeEventForElement(u.d.touchContextMenu,t,2,r.i(this,this.onContextMenu,"onContextMenu"))},t.prototype.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeEventForElement(t,u.d.contextMenu),this._eventHandlerManager.deinitializeEventForElement(t,u.d.touchContextMenu)},t.prototype.registerHandler=function(e,t,n){this._eventHandlerManager.registerHandler(p,u.d.contextMenu,e,2,r.i(this,this.onContextMenu,"onContextMenu"),t,n),this._eventHandlerManager.initializeForElementInternal(u.d.touchContextMenu,e,2,r.i(this,this.onContextMenu,"onContextMenu"))},t.prototype.unregisterHandler=function(e,t){this._eventHandlerManager.unregisterHandler(p,u.d.contextMenu,e,t),this._eventHandlerManager.deinitializeForElementInternal(e,u.d.touchContextMenu)},t.prototype.get_isSuppressingMenus=function(){return this._isSuppressingMenus},t.prototype.set_isSuppressingMenus=function(e){return this._isSuppressingMenus=e,e},t.prototype.fireContextMenu=function(e){var t=e.srcElement||e.target,n=new Sys.UI.DomEvent(e);this._eventHandlerManager.simulateBubblingEvent(u.d.contextMenu,t,n)},t.prototype.onContextMenu=function(e,i,r){if(!this.get_isEnabled())return!1;if(r.target&&r.target.nodeType===s.o.element&&Sys.UI.DomElement.containsCssClass(r.target,t.allowBrowserContextMenu))return!1;if(this._isSuppressingMenus||n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteTeamsEmbedMobileIsEnabled"))return a.n.cancelEvent(r),!0;if(_.y.get_instance().get_isYielding())return!0;var o=this._eventHandlerManager.processEvent(p,u.d.contextMenu,i,p.create(e,r,this._lastInputMethodHeard));return o&&(a.n.cancelEvent(r),e===u.d.touchContextMenu&&(m.k.cancelAllPendingClicks(),this._eventHandlerManager.temporarilyDisableBrowserClicks(),this._cancelPointersOnContextMenu&&(this._dragInputManager.cancelPendingPointerEvents(),this._gestureInputManager.get_instance()&&this._gestureInputManager.get_instance().cancelPendingPointerEvents()))),o},t.prototype.onPointerEventHeard=function(e){this._lastInputMethodHeard=e.get_inputSource()},t.prototype.onKeyEventHeard=function(e){this._lastInputMethodHeard=1},t.get_instance=function(){return t._instance||(t._instance=new t),t._instance},t.disposeInputManager=function(){f.b(t._instance),t._instance=null},t.allowBrowserContextMenu="AllowBrowserContextMenu",t._instance=null,t}(a.n);(0,r.l)(v,"ContextMenuInputManager",a.n,[])},,,,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IExternalLogger"),o=n(255);n.d(t,{s:function(){return a}});var a=function(){function e(){}return e.prototype.sendTraceTag=function(e,t,n,i){o.ULS.sendTraceTag(e,t,n,i)},e.prototype.shipAssertTag=function(e,t,n,i){o.ULS.shipAssertTag(e,t,n,i)},e.prototype.debugAssertTag=function(e,t,n,i){},e.prototype.debugTraceTag=function(e,t,n,i){},e}();(0,i.l)(a,"UlsExternalLogger",null,[r])},function(e,t,n){"use strict";n.r(t),n.d(t,{ProcessContextOperation:function(){return s}});var i=n(508),r=n(816),o=n(195),a=n(208),s=function(e){function t(){var t=e.call(this)||this;return t._context=null,t._shouldSpecialize=!1,t._stage=0,t}return(0,i.t)(t,e),t.prototype.recycle=function(){e.prototype.recycle.call(this),Array.add(t._instances,this)},t.prototype.run=function(){if(!this._stage){var e=this.processCurrentOperation();if(1===e)return;if(!e){var t=this._actionManager.getActionMetadata(this.get_actionId()),n=this._context.get_contextId(),i=null,r=null;if(t&&(i=t.asyncHandlers[n],r=t.handlers[n]),r||i){var a=t.flags[1024],s=t.flags[4],l=t.flags[2048];if(this._actionManager.get_isOffline()?l:!a&&!s||a&&2===this._actionManager.get_mode()||s&&3===this._actionManager.get_mode()){if(t.flags[1]&&(void 0===this._actionData||null===this._actionData))return this.set_response(16),void this.setIsCanceled();if(t.flags[8]&&!this.get_reportingData())return this.set_response(16),void this.setIsCanceled();if(t.flags[512]&&o.v.get_instance().get_isConsentNeeded())return this.set_response(16),void this.setIsCanceled();if(i){if(i(this,this.get_actionId(),this._context,this.get_behavior(),this.get_reportingData(),this._actionData),1===this.processCurrentOperation())return}else this.set_response(r(this.get_actionId(),this._context,this.get_behavior(),this.get_reportingData(),this._actionData))}else this.set_response(4)}}this._stage=this.get_response()>2?2:1}if(1===this._stage&&this._shouldSpecialize){if(!this.get_childOperation()){var u=this._context.get_nextContext();u?this.setCurrentOperationFromContext(u):this.set_response(2)}if(1===this.processCurrentOperation())return}this._stage=2,2===this._stage&&this.setIsCompleted()},t.registerInstance=function(e,n,i,r,o,a,s,l,u){var c,p=t._instances.length;return p?(c=t._instances[p-1],Array.removeAt(t._instances,p-1)):c=new t,c.init(n),c.setDebugName("ProcessContextOperation"),c.initAction(e,r,o,s,l,u),c._context=i,c._shouldSpecialize=a,c._stage=0,c},t._instances=[],t}(r.g);(0,a.l)(s,"ProcessContextOperation",r.g,[])},,,,function(e,t,n){"use strict";n.r(t);var i=n(208),r=(0,i.y)("IProcessInputStrategy"),o=n(85),a=n(255),s=n(614),l=n(574),u=n(550),c=n(154),p=n(425),d=n(296),h=function(){function e(e,t,n){this._root=null,this.scope=null,this.looped=!1,this.contained=!1,this.enabled=!0,this.listing=null,this._focusHandledElements=[],this._blurHandledElements=[],this.scope=e,this.listing=t,this._root=n}return e.prototype.dispose=function(){this.listing.dispose(),this.listing=null,this._root=null;for(var t=this._focusHandledElements.length,n=0;n<t;n++)u.n.removeHandler(this._focusHandledElements[n],"focus",i.i(this,this.focusEventHandler,"focusEventHandler"));if(Array.clear(this._focusHandledElements),this._focusHandledElements=null,p.y.get_isInternetExplorerNonEdge()){var r=this._blurHandledElements.length;for(n=0;n<r;n++)u.n.removeHandler(this._blurHandledElements[n],"blur",e.blurEventHandler);Array.clear(this._blurHandledElements),this._blurHandledElements=null}this.scope=null},e.prototype.moveForward=function(){return c.g.clearSelectionIfNecessary(),this.listing.get_currentElement()===this.listing.get_lastElement()?this.looped?this.listing.trySetCurrentElement(this.listing.get_firstElement()):(this.contained||n(254).AFrameworkApplication.get_activeFrame().get_theF6Manager().handleF6(0,null,2,null,null),!0):this.listing.trySetCurrentElement(this.listing.get_nextElement())},e.prototype.moveBackward=function(){return c.g.clearSelectionIfNecessary(),this.listing.get_currentElement()===this.listing.get_firstElement()?this.looped?this.listing.trySetCurrentElement(this.listing.get_lastElement()):!!this.contained||n(254).AFrameworkApplication.get_activeFrame().get_theF6Manager().handleTabFromBottom():this.listing.trySetCurrentElement(this.listing.get_previousElement())},e.prototype.moveIntoFromTop=function(){this.listing.forceSetCurrentElement(this.listing.get_firstElement())},e.prototype.moveIntoFromBottom=function(){this.listing.forceSetCurrentElement(this.listing.get_lastElement())},e.prototype.moveIntoRestore=function(){var e=this.listing.get_currentElement();e&&n(197).DOMFocusListing.elementFocusable(e)&&n(657).FocusManager.tryFocus(e)||this.listing.trySetCurrentElement(this.listing.get_firstElement())},e.prototype.rememberFocusStealers=function(){this.processFocusStealer(this._root())},e.prototype.processFocusStealer=function(t){if(void 0!==t.tagName&&null!==t.tagName){var n=d.s.getTag(t);if(p.y.get_isInternetExplorerNonEdge()&&"text"===c.g.getInputTypeFromElement(t)&&(u.n.addHandler(t,"blur",e.blurEventHandler),Array.add(this._blurHandledElements,t)),3===n||4===n||6===n||5===n)u.n.addHandler(t,"focus",i.i(this,this.focusEventHandler,"focusEventHandler")),Array.add(this._focusHandledElements,t);else for(var r=t.firstChild;r;)this.processFocusStealer(r),r=r.nextSibling}},e.prototype.focusEventHandler=function(e){n(657).FocusManager.instance().setScope(this.scope.name),this.listing&&this.listing.trySetCurrentElement(e.target)},e.blurEventHandler=function(e){var t=e.target;t.value=t.value},e}();(0,i.l)(h,"FocusRegion",null,[Sys.IDisposable]);var g=function(){return function(){this.action=0,this.preventHandleExternally=!1,this.argumentsGenerator=null}}();(0,i.l)(g,"ActionInfo",null,[]);var m=function(){function e(e){this._keyDownHandledExternally=!1,this._useBrowserClick=!1,this._containerScope=null,this.name=null,this.parent=null,this.restoreFocusHandledExternally=!1,this._actions={},this._dispose=[],this._setFocus=[],this._onFocus=[],this._onBlur=[],this.name=e}return e.prototype.get_hasSetFocus=function(){return!!this._setFocus&&this._setFocus.length>0},e.prototype.get_keyDownHandledExternally=function(){return this._keyDownHandledExternally},e.prototype.set_keyDownHandledExternally=function(e){return this._keyDownHandledExternally=e,e},e.prototype.get_containerScope=function(){return this._containerScope},e.prototype.set_containerScope=function(e){return this._containerScope=e,e},e.prototype.get_useBrowserClick=function(){return this._useBrowserClick},e.prototype.set_useBrowserClick=function(e){return this._useBrowserClick=e,e},e.prototype.dispose=function(){for(var e=0;e<this._dispose.length;e++)this._dispose[e]();this._actions=null,Array.clear(this._dispose),this._dispose=null,Array.clear(this._setFocus),this._setFocus=null,Array.clear(this._onFocus),this._onFocus=null,Array.clear(this._onBlur),this._onBlur=null},e.prototype.addDispose=function(e){Array.add(this._dispose,e)},e.prototype.addSetFocus=function(e){Array.add(this._setFocus,e)},e.prototype.clearSetFocus=function(){Array.clear(this._setFocus)},e.prototype.addOnFocus=function(e){Array.add(this._onFocus,e)},e.prototype.addOnBlur=function(e){Array.add(this._onBlur,e)},e.prototype.bindAction=function(e,t){this.bindActionWithArguments(e,t,null)},e.prototype.bindActionWithArguments=function(e,t,i){var r=this._actions[e];if(r&&r.action!==s.Wy){if(r.action===t||t===s.Wy)return;a.ULS.sendTraceTag(41739609,310,15,"Key bound to two different actions. Key={0}, Action={1}, SecondAction={2} UICulture={3}.",e,t,r.action,n(254).AFrameworkApplication.uiCulture)}else{var o=new g;o.action=t,o.argumentsGenerator=i,o.preventHandleExternally=!!r,this._actions[e]=o}},e.prototype.unBindAction=function(e){delete this._actions[e]},e.prototype.getAction=function(e){return this._actions[e]},e.prototype.runOnBlur=function(e){this.runFocusActions(this,e,this._onBlur)},e.prototype.runOnFocus=function(e){this.runFocusActions(e,this,this._onFocus)},e.prototype.runSetFocus=function(e){this.runFocusActions(e,this,this._setFocus)},e.prototype.runFocusActions=function(e,t,n){for(var i=0;i<n.length;i++)n[i](e,t)},e}();(0,i.l)(m,"FocusScope",null,[Sys.IDisposable]);var _=n(66),f=n(749),y=n(713),v=n(101),S=n(235),C=n(984),b=n(556);n.d(t,{FocusManager:function(){return T}});var A=-1,T=function(){function e(t){this._actionManager=null,this._delegatesEnabled=!0,this._currentWithDelegates=!1,this._currentScopeIndex=0,this._defaultScopeName=null,this._root=null,this._validTags=null,this._keyDownHandler=null,this._tabChecksDocument=null,this._tabChecksKeyInputManager=null,this._isDisposed=!1,this._addTriggerTimeTelemetryEnabled=null,this._processInputStrategyFuture=null,this.$$pf_InSetFocus=!1,this.$$pf_InForceSetFocus=!1,this._tabInput=f.KeyInputManager.hashKey(_.v.vK_Tab,0),this._tabShiftInput=f.KeyInputManager.hashKey(_.v.vK_Tab,4),this._scopeNames=[],this._scopes=[],this._scopeStack=[],this._regions={},this._regionList=[],this._switchingTasks=[],this._actionManager=n(254).AFrameworkApplication.get_theActionManager(),this._currentScopeIndex=A,this._defaultScopeName=null,this._actionManager.addAction(s.Oo,C.a,e.moveForwardAction),this._actionManager.addAction(s.Bo,C.a,e.moveBackwardAction),this._keyDownHandler=i.i(this,this.keyDownHandler,"keyDownHandler"),this._processInputStrategyFuture=t}return e.prototype.addFocusableScope=function(t,i,r){var o=this,a=this.getScope(t);a.parent=i,a.addSetFocus((function(i,a){e.tryFocus(r)||(o.get_defaultScopeName()&&t!==o.get_defaultScopeName()?o.setScopeToDefault():o.get_defaultScopeName()===n(751).AFrame.appFocusId?o.setScope(null):o.setScope(n(751).AFrame.appFocusId))}))},e.prototype.get_inSetFocus=function(){return this.$$pf_InSetFocus},e.prototype.set_inSetFocus=function(e){return this.$$pf_InSetFocus=e,e},e.prototype.get_inForceSetFocus=function(){return this.$$pf_InForceSetFocus},e.prototype.set_inForceSetFocus=function(e){return this.$$pf_InForceSetFocus=e,e},e.prototype.get_delegatesEnabled=function(){return this._delegatesEnabled&&!n(254).AFrameworkApplication.isShuttingDown},e.prototype.set_delegatesEnabled=function(e){return this._delegatesEnabled=e,e},e.prototype.dispose=function(){if(!this._isDisposed){null!==this._tabChecksDocument&&(this._tabChecksKeyInputManager.unregisterHandlerWithDocument(l.d.keyDown,this._tabChecksDocument,this._keyDownHandler),this._keyDownHandler=null,this._tabChecksDocument=null,this._tabChecksKeyInputManager=null);for(var e=0;e<this._scopes.length;e++)this.getScopeAtIndex(e).dispose();Array.clear(this._scopes),Array.clear(this._scopeNames),this._currentScopeIndex=A;for(var t=0;t<this._regionList.length;t++)this._regionList[t].dispose();Array.clear(this._regionList),this._regionList=null,this._regions=null,this._root=null,this._validTags&&(Array.clear(this._validTags),this._validTags=null),this._isDisposed=!0}},e.prototype.get_currentScope=function(){return this._currentScopeIndex===A?null:this.getScopeAtIndex(this._currentScopeIndex)},e.prototype.get_defaultScopeName=function(){return this._defaultScopeName},e.prototype.set_defaultScopeName=function(e){return this._defaultScopeName=e,e},e.prototype.setScope=function(e){this.updateCurrentScope(e,!0,!1),this.clearScopeStackIfNewScope(e)},e.prototype.scopeChanged=function(e){this.updateCurrentScope(e,!1,!1),this.clearScopeStackIfNewScope(e)},e.prototype.forceScopeChange=function(e){this.updateCurrentScope(e,!0,!0),this.clearScopeStackIfNewScope(e)},e.prototype.setScopeFromTop=function(e){var t=this.getRegion(e);t&&!this.getScope(e).get_hasSetFocus()||n(254).AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&"EditingRibbonPanelFocus"===e?(this.scopeChanged(e),t.moveIntoFromTop()):this.setScope(e)},e.prototype.setScopeFromBottom=function(e){var t=this.getRegion(e);return t?(this.scopeChanged(e),t.moveIntoFromBottom(),!0):(this.scopeChanged(e),!1)},e.prototype.setScopeRestore=function(e,t){if(!this.canScopeReceiveFocus(e))return!1;var n=this.getRegion(e);return n?(this.scopeChanged(e),t&&n.moveIntoRestore()):this.setScope(e),!0},e.prototype.canScopeReceiveFocus=function(t){return!e.get_f6Manager().hasF6KeyBindings(t)||e.get_f6Manager().isFocusScopeActive(t)},e.prototype.processInput=function(e){var t=f.KeyInputManager.hashEvent(e);if(t){var n=null,i=this._processInputStrategyFuture?this._processInputStrategyFuture.get_instance():null;if(n=i?i.findAction(this,this.get_currentScope(),t):this.findAction(this.get_currentScope(),t)){var r=null;n.argumentsGenerator&&(r=n.argumentsGenerator()),this._actionManager.set_commandLocation(6),this._actionManager.set_invocationMethod(1);var o=void 0,a=null;if(this.get_addTriggerTimeTelemetryEnabled()&&e&&e.rawEvent){var s=0;if(e.rawEvent.srcElement&&e.rawEvent.srcElement.ownerDocument){if(e.rawEvent.srcElement.ownerDocument!==window.document){var l=this.getPerformanceNowByDOMDocument(e.rawEvent.srcElement.ownerDocument),u=this.getPerformanceNowByDOMDocument(window.document);s=l&&u?u-l:null}s&&((a={}).TriggerTime=e.rawEvent.timeStamp+s)}}return 4===(o=i?i.handleInputAction(n.action,r,a):this._actionManager.processActionWithData(n.action,2,r,a))&&n.preventHandleExternally?32:o}}return 4},e.prototype.focusToBrowser=function(t,n,i,r,o){return this.pushScope(e.browserFocusId,!0),4},e.prototype.addSwitchingTask=function(e){Array.add(this._switchingTasks,e)},e.prototype.addScope=function(e){if(!Array.contains(this._scopeNames,e)){var t=new m(e);Array.add(this._scopeNames,e),Array.add(this._scopes,t)}},e.prototype.removeScope=function(e){if(Array.contains(this._scopeNames,e)){var t=this.getScopeIndex(e);t===this._currentScopeIndex?this.setScope(null):t<this._currentScopeIndex&&this._currentScopeIndex--,this.getScopeAtIndex(t).dispose();var n=this._regions[e];n&&(this._regions[e]=null,Array.remove(this._regionList,n),n.dispose()),Array.removeAt(this._scopes,t),Array.removeAt(this._scopeNames,t)}},e.prototype.getScope=function(e){return e?(this.addScope(e),this.getScopeAtIndex(this.getScopeIndex(e))):null},e.prototype.pushScope=function(e,t){this._currentScopeIndex!==A&&Array.insert(this._scopeStack,0,this.get_currentScope().name),this.updateCurrentScope(e,t,!1)},e.prototype.popScope=function(t,n){void 0===n&&(n=!0);var i=null;if(this._scopeStack.length>0)if(this.get_currentScope()&&this.get_currentScope().name===t){var r=this._scopeStack[0],o=this.getScope(r);this.restoreToPreviousScope(!o.restoreFocusHandledExternally&&n)&&(i=this.get_currentScope().name)}else;i||(i=e.get_f6Manager().getHighestPriority())&&this.setScopeRestore(i,n)},e.prototype.peekNonReactTransientUiScope=function(){for(var e=0;e<this._scopeStack.length;e++)if(this._scopeStack[e]!==n(751).AFrame.reactTransientUIFocusId)return this._scopeStack[e];return""},e.prototype.tryGrabFocus=function(e){var t=!!this.get_currentScope()&&this.get_currentScope().name===e;return t&&this.popScope(e),t},e.prototype.focusLastEditableSurface=function(){n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("MoveFocusAfterCommandIsEnabled")&&n(254).AFrameworkApplication.get_activeFrame().restoreFocusAfterExecutingActionFromRibbon()},e.prototype.restoreToPreviousScope=function(e){var t=!1;if(this._scopeStack.length){var n=this._scopeStack[0];if(Array.removeAt(this._scopeStack,0),Array.contains(this._scopeNames,n)){var i=this.getScope(n);i.get_containerScope()&&(n=i.get_containerScope()),(t=this.setScopeRestore(n,e))||(t=this.restoreToPreviousScope(e))}else t=this.restoreToPreviousScope(e)}else this.setScopeToDefault();return t},e.prototype.tryChangeScopeOnStealingFocusEvent=function(e,t,n,i){(t||d.s.isEditable(i.get_sourceElement()))&&(this.scopeChanged(e),n&&i.innerEvent.stopPropagation())},e.prototype.buildRegion=function(e,t,n){return this.buildRegionWithDelegate((function(){return e}),t,n)},e.prototype.buildRegionWithDelegate=function(e,t,n){this.removeRegion(t);var i=new h(t,n,e);return this._regions[t.name]=i,Array.add(this._regionList,i),t.bindAction(this._tabInput,s.Oo),t.bindAction(this._tabShiftInput,s.Bo),i},e.prototype.removeRegion=function(e){if(this._regions[e.name]){var t=this._regions[e.name];Array.remove(this._regionList,t),t.dispose(),this._regions[e.name]=null,e.unBindAction(this._tabInput),e.unBindAction(this._tabShiftInput)}},e.prototype.getRegion=function(e){for(var t=e,n=null;t&&!n;)(n=this._regions[t])||(t=this.getScope(t).parent);return n},e.prototype.getCurrentRegion=function(){return void 0===this.get_currentScope()||null===this.get_currentScope()?null:this.getRegion(this.get_currentScope().name)},e.prototype.tabIntoRegionTop=function(e){for(var t=this.getCurrentRegion(),n=0;n<this._regionList.length;n++){var i=this._regionList[n];if(i.enabled&&i.listing.get_firstElement()===e&&i!==t)return this.scopeChanged(i.scope.name),i.listing.forceSetCurrentElement(e),!0}return!1},e.prototype.tabIntoRegionBottom=function(e){for(var t=this.getCurrentRegion(),n=0;n<this._regionList.length;n++){var i=this._regionList[n];if(i.enabled&&i.listing.get_lastElement()===e&&i!==t)return this.scopeChanged(i.scope.name),i.listing.forceSetCurrentElement(e),!0}return!1},e.prototype.setupTabChecks=function(e,t,n,i){this._root=t,this._validTags=n,this._tabChecksDocument=e,this._tabChecksKeyInputManager=i,this._tabChecksKeyInputManager.registerHandlerWithDocument(l.d.keyDown,this._tabChecksDocument,this._keyDownHandler,null)},e.prototype.keyDownHandler=function(e){if(this.get_currentScope()&&this.get_currentScope().get_keyDownHandledExternally())return!1;var t=e.innerEvent,n=f.KeyInputManager.hashEvent(t),i=t.target;return n===this._tabInput&&this.checkTab(i)||n===this._tabShiftInput&&this.checkTabShift(i)},e.prototype.checkTab=function(e){if(null!=e&&"body"!==b.l.toLower(e.tagName)){y.t.mark(4698);var t=n(197).DOMFocusListing.findNextElement(e,this._root,this._validTags),i=!!t&&(this.tabIntoRegionTop(t)||e===n(197).DOMFocusListing.firstInElement(this._root,this._validTags)&&this.tabIntoRegionTop(e));return y.t.mark(4699),i}return!1},e.prototype.checkTabShift=function(e){if(null!=e&&"body"!==b.l.toLower(e.tagName)){y.t.mark(4698);var t=n(197).DOMFocusListing.findPreviousElement(e,this._root,this._validTags),i=!!t&&(this.tabIntoRegionBottom(t)||e===n(197).DOMFocusListing.lastInElement(this._root,this._validTags)&&this.tabIntoRegionBottom(e));return y.t.mark(4699),i}return!1},e.prototype.getPerformanceNowByDOMDocument=function(e){var t=null,n=e.defaultView;if(n){var i=n.performance;if(i)i.now&&(t=i.now())}return t},e.prototype.get_addTriggerTimeTelemetryEnabled=function(){return!this._addTriggerTimeTelemetryEnabled&&n(254).AFrameworkApplication.appSettingsManager&&(this._addTriggerTimeTelemetryEnabled=n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AddTriggerTimeTelemetryEnabled")),!!this._addTriggerTimeTelemetryEnabled&&this._addTriggerTimeTelemetryEnabled},e.prototype.runSwitchingTasks=function(e,t){for(var n=0;n<this._switchingTasks.length;n++){(0,this._switchingTasks[n])(e,t)}},e.prototype.setScopeToDefault=function(){this._defaultScopeName&&this.setScope(this._defaultScopeName)},e.prototype.updateCurrentScope=function(e,t,n){var i=this.get_currentScope();if((!i&&e||i&&(i.name!==e||n))&&(e&&this.addScope(e),i&&this.get_delegatesEnabled()&&this._currentWithDelegates&&this.runOnBlur(i,e?this.getScope(e):null),t&&this.get_delegatesEnabled()&&this.runSwitchingTasks(i,this.getScope(e)),this._currentScopeIndex=this.getScopeIndex(e),this._currentScopeIndex!==A)){var r=i;i=this.get_currentScope(),this.get_delegatesEnabled()?(t&&this.runSetFocus(i,r),this.runOnFocus(i,r),this._currentWithDelegates=!0):this._currentWithDelegates=!1}},e.prototype.getScopeIndex=function(e){return Array.contains(this._scopeNames,e)?Array.indexOf(this._scopeNames,e):A},e.prototype.getScopeAtIndex=function(e){return e===A?null:this._scopes[e]},e.prototype.findAction=function(e,t){if(!e)return null;var n=e.getAction(t);return!n&&e.parent&&(n=this.findAction(this.getScope(e.parent),t)),n},e.prototype.runOnBlur=function(e,t){e.runOnBlur(t);var n=this.getScope(e.parent);n&&this.runOnBlur(n,t)},e.prototype.runOnFocus=function(e,t){var n=this.getScope(e.parent);n&&this.runOnFocus(n,t),e.runOnFocus(t)},e.prototype.runSetFocus=function(e,t){var n=this.getScope(e.parent);n&&this.runSetFocus(n,t),e.runSetFocus(t)},e.prototype.clearScopeStackIfNewScope=function(e){this._scopeStack.length>0&&this._scopeStack[0]===e&&Array.clear(this._scopeStack)},e.usable=function(){return!!n(254).AFrameworkApplication.get_activeFrame()&&!!e._instance},e.instance=function(){return e._instance||(e._instance=new e(S.w.get_instance().resolveFuture(r)))},e.get_f6Manager=function(){return n(254).AFrameworkApplication.get_activeFrame()?n(254).AFrameworkApplication.get_activeFrame().get_theF6Manager():null},e.tryFocus=function(e){try{return e.focus(),!0}catch(e){return!1}},e.trySetActive=function(e){try{return e.setActive(),!0}catch(e){return!1}},e.trySetActiveIfNotFocus=function(t){p.y.browserSupportsSetActive(t)?e.trySetActive(t):e.tryFocus(t)},e.tryBlur=function(e){try{return e.blur(),!0}catch(e){return!1}},e.registerActions=function(t){t.addAction(s.yZ,C.a,e.blockIfFocusedTextField),t.addActionWithFlags(s.cs,C.a,e.blockIfNotFocusedTextField,96)},e.registerShortcuts=function(e){e.getScope(n(751).AFrame.appFocusId).bindAction(f.KeyInputManager.hashKey(_.v.vK_Backspace,0),s.cs)},e.blockIfFocusedTextField=function(e,t,n,i,r){var o=document.body.ownerDocument,a=c.g.getActiveElement(o);return a&&c.g.isTextField(a)?32:4},e.blockIfNotFocusedTextField=function(e,t,n,i,r){var o=document.body.ownerDocument,a=c.g.getActiveElement(o);return a&&c.g.isTextField(a)?4:32},e.moveForwardAction=function(t,n,i,r,o){var s=e.instance().getCurrentRegion();return s?s.moveForward()?32:4:(a.ULS.sendTraceTag(19261475,310,10,"CurrentRegion is null with scope name {0}.",e.instance().get_currentScope()?e.instance().get_currentScope().name:"[NotExist]"),8)},e.moveBackwardAction=function(t,n,i,r,o){var s=e.instance().getCurrentRegion();return s?s.moveBackward()?32:4:(a.ULS.sendTraceTag(19261504,310,10,"CurrentRegion is null with scope name {0}.",e.instance().get_currentScope()?e.instance().get_currentScope().name:"[NotExist]"),8)},e.disposeInputManager=function(){v.b(e._instance)},e.reset=function(){e._instance=null},e.browserFocusId="Browser",e.editingFocusId="editing",e._instance=null,e}();(0,i.l)(T,"FocusManager",null,[Sys.IDisposable,o.k])},function(e,t,n){"use strict";n.d(t,{w:function(){return l}});var i=n(572),r=n(208),o=n(149),a=n(755),s=n(244),l=function(){function e(t){this.$$ge=this.getEnumerator,r.m(this,e.$$(t)),this._map=new Map,this._defaultValue=r.c(r.f(this,"$$sc.StringDictionary$1").TValue)}return e.prototype.getEnumerator=function(){return s.select(Array,a.z,s.fromIterator(Array,r.i(this._map,this._map.entries,"entries")),(function(e){return new a.z(e[0],e[1])})).$$ge()},e.prototype.get_count=function(){return this._map.size},e.prototype.get_keys=function(){return s.fromIterator(String,r.i(this._map,this._map.keys,"keys"))},e.prototype.get_values=function(){return s.fromIterator(r.f(this,"$$sc.StringDictionary$1").TValue,r.i(this._map,this._map.values,"values"))},e.prototype.add=function(e,t){if(this._map.has(e))throw Error.create("DuplicateKey");this._map.set(e,t)},e.prototype.containsKey=function(e){return this._map.has(e)},e.prototype.remove=function(e){return!!this._map.has(e)&&(this._map.delete(e),!0)},e.prototype.tryGetValue=function(e,t){return this._map.has(e)?(t.val=this._map.get(e),!0):(t.val=this._defaultValue,!1)},e.prototype.get_item=function(e){if(!this._map.has(e))throw Error.create("KeyNotFoundException");return this._map.get(e)},e.prototype.set_item=function(e,t){return this._map.set(e,t),t},e.$$=function(t){var n="StringDictionary$1$"+t.getName(),a=r.x(n);return a||r.u(n,"$$sc.StringDictionary$1",e,[{TValue:t}],null,[o.m.$$(String,t),i.i])},e}()},function(e,t,n){"use strict";n.d(t,{f:function(){return u}});var i=n(508),r=n(600),o=n(127),a=n(951),s=n(920),l=n(208),u=function(e){function t(t){void 0===t&&(t=!1);var n=e.call(this)||this;return n._hasArrow=!1,n._hasArrow=t,n}return(0,i.t)(t,e),t.prototype.buildControlDom=function(e,t){var n=new s.d(t);return n.elmControl=a.Control.createStandardControlDOMElement(e,e.get_root(),t,e.get_controlProperties(),this._hasArrow,(0,r.m)((function(){return n.elmLabel}),(function(e){return n.elmLabel=e})),(0,r.m)((function(){return n.elmImage}),(function(e){return n.elmImage=e})),(0,r.m)((function(){return n.elmDescription}),(function(e){return n.elmDescription=e})),(0,r.m)((function(){return n.elmIconContainer}),(function(e){return n.elmIconContainer=e}))),n},t}(o.r);(0,l.l)(u,"StandardControlDomStrategy",o.r,[])},,,,,,function(e,t,n){"use strict";var i=n(208),r=n(606),o=n(644),a=n(255),s=n(491),l=n(508),u=n(841),c="accessibleViewText",p=function(e){function t(t){var n=e.call(this)||this,i=document.createElement("span");i.id=n.myId(c);var r=document.createElement("span");r.innerText=WordViewerIntl.WordViewerStrings.l_MoreAccessibleViewDialogDescription,i.appendChild(r),i.appendChild(document.createElement("br")),i.appendChild(document.createElement("br"));var o=document.createElement("a");return o.href=t,o.target="_blank",o.innerText=WordViewerIntl.WordViewerStrings.l_MoreAccessibleViewDialogLink,i.appendChild(o),n.set_buttonsOption(0),n.setButtonText(1,CommonUIStrings.l_DialogClose),n.messageBoxImpl(CommonUIStrings.l_DefaultDialogTitle,null,null,null,null,i),n.setDescribedByForDialog(n.myId(c)),o.focus(),n}return(0,l.t)(t,e),t}(u.StandardDialog);(0,i.l)(p,"MoreAccessibleViewDialog",u.StandardDialog,[]);var d=n(322),h=n(917),g=n(614),m=n(645),_=n(481),f=n(254),y=function(e){function t(t){return e.call(this,t,!0)||this}return(0,l.t)(t,e),t.prototype.get_iconString=function(){return null},t.prototype.get_messageString=function(){return f.AFrameworkApplication.dialogClearerStringsIsEnabled?CommonUIStrings.l_DownLoadACopyDialogMessage:CommonUIStrings.l_PrintDialogDocumentIsPrinting},t.prototype.get_linkString=function(){return CommonUIStrings.l_DownloadAsPdfDialogLinkSuggestion},t.prototype.get_buttonText=function(){return CommonUIStrings.l_Download},t}(_.k);(0,i.l)(y,"DownloadAsPdfDialog",_.k,[]);var v=n(751),S=n(722),C=n(657),b=n(550),A=n(66),T=n(749),w=n(478),I=n(610),E=n(405),k=n(684),D=n(235),M=n(296),P=n(513);n.d(t,{i:function(){return F}});var F=function(){function e(e,t,i,r,o,a,s,l){this._isCancelled=!1,this._isAccessibleLinkHidden=!1,this._waitDlg=null,this._printWaitTask=null,this._accessibleLink=null,this._RequestAccessibilePDFFromMouseUp=null,this._RequestAccessibilePDFFromEnter=null,this._ShowAccessibleLink=null,this._HideAccessibleLink=null,this._directPrintManager=null,this._focusManager=null,this._userMayEnterAccessiblePdfMode=!1,this._isAccessiblePdfMode=!1,this._actionManager=null,this._legacyDialogDownloadACopyUrlFactory=null,this._showPrintDialogInPdfMode=!1,this._isPdfMode=!1,this._actionManager=e,this._directPrintManager=o,this._focusManager=a,this._userMayEnterAccessiblePdfMode=s,this._isAccessiblePdfMode=l,this.registerPrintActions(n(941).App.get_instance().get_showPrint()),n(941).App.get_instance().get_printingEnabled()&&(this._isCancelled=!1,this._legacyDialogDownloadACopyUrlFactory=t,this._showPrintDialogInPdfMode=r,this._isPdfMode=i,this.registerPrintDependentActions(),this.createAccessibleLink())}return e.prototype.directPrintForPdfMode=function(e,t,i,r,o){if(2===i){if(!this._directPrintManager.shouldUseDirectPrint()&&!P.t(f.AFrameworkApplication.downloadACopyUrl))return n(941).App.get_activeAppFrame().navigateToHostUrl(2===i,f.AFrameworkApplication.downloadACopyUrl,!0);this._directPrintManager.shouldUseDirectPrint()&&a.ULS.sendTraceTag(7135491,301,50,"Plugin in installed,Request printable pdf from server."),this.requestPDF(2,!0)}return 32},e.prototype.registerPrintActions=function(e){this._actionManager.addAction(m.ll,s.d.application,e?i.i(this,this.handlePrintCommand,"handlePrintCommand"):S.ActionManager.doNothingHandler),C.FocusManager.instance().getScope(v.AFrame.appFocusId).bindAction(T.KeyInputManager.hashKey(A.v.vK_P,T.KeyInputManager.get_commandKeyModifier()),e?m.ll:g.Wy)},e.prototype.registerPrintDependentActions=function(){this._actionManager.addAction(m.YO,s.d.application,i.i(this,this.handleDownloadAsPdf,"handleDownloadAsPdf")),this._actionManager.addAction(m.Le,s.d.application,i.i(this,this.requestAccessiblePDF,"requestAccessiblePDF"))},e.prototype.getRequestTypeParameter=function(e){switch(e){case 0:return"accesspdf";case 1:return"downloadpdf";case 2:return"printpdf";default:return a.ULS.sendTraceTag(5301274,324,10,"Unknown request PDF type {0}",e),"printpdf"}},e.prototype.handlePrintCommand=function(e,t,n,i,r){return 1===n?32:this._isPdfMode?(a.ULS.sendTraceTag(7135492,301,50,"Handle PDF print command, actionId: {0}",e),this.handlePrintInPdfMode(e,t,n,i,r)):this.handlePrintInDocxMode(e,t,n,i,r)},e.prototype.handleDownloadAsPdf=function(e,t,n,i,r){return 1===n?32:this._isPdfMode?16:(this._isCancelled=!1,this.requestPDF(1),32)},e.prototype.handlePrintInPdfMode=function(e,t,n,i,r){if(a.ULS.sendTraceTag(7135493,301,50,"Handle print command in PDF mode."),P.t(f.AFrameworkApplication.downloadACopyUrl)&&a.ULS.sendTraceTag(4855504,301,50,"PdfModePrint called with no DownloadACopyUrl URL."),this._directPrintManager.get_directPrintSettings().isEnabled)return this.directPrintForPdfMode(e,t,n,i,r);if(this._showPrintDialogInPdfMode){if(!P.t(f.AFrameworkApplication.downloadACopyUrl))return this._legacyDialogDownloadACopyUrlFactory(),32;a.ULS.sendTraceTag(8709637,301,10,"DirectPrint is disabled and have no DownloadACopyUrl,we show error dialog."),this.showErrorUI(d.i.printPdfNotGenerated),h.u.propagateError(!1,"PrintFailed",d.i.printPdfNotGenerated,this._isPdfMode?WordViewerIntl.WordViewerStrings.l_PrintPdfError:WordViewerIntl.WordViewerStrings.l_PrintError)}return this._actionManager.processAction(g.Ci,n)},e.prototype.handlePrintInDocxMode=function(e,t,n,i,r){return this.requestPrintPDF(e,t,n,i,r)},e.prototype.requestPrintPDF=function(e,t,n,i,r){return this._isCancelled=!1,this.requestPDF(2),32},e.prototype.requestAccessiblePDF=function(e,t,n,i,r){return 1===n?32:(this.accessiblePdfRequested(),32)},e.prototype.requestAccessibilePDFFromEnter=function(e){var t=e.keyCode;t===A.v.vK_Enter?this.accessiblePdfRequested():t===A.v.vK_Tab&&e.shiftKey&&(e.preventDefault(),e.stopPropagation(),this.hideAccessibleLink(e))},e.prototype.requestAccessibilePDFFromMouseUp=function(e){this.accessiblePdfRequested()},e.prototype.showWaitUI=function(e){if(1!==n(941).App.get_activeAppFrame().get_state()&&!this._waitDlg){this._waitDlg=new I.c;var t=e.customData,r=void 0;switch(t){case 2:r=this._directPrintManager.shouldUseDirectPrint()?f.AFrameworkApplication.dialogClearerStringsIsEnabled?CommonUIStrings.l_DirectPrintPreparingPDF:WordViewerIntl.WordViewerStrings.L_DirectPrintWait:WordViewerIntl.WordViewerStrings.l_PrintPDFWait;break;case 1:r=WordViewerIntl.WordViewerStrings.l_PrintPDFWait;break;case 0:r=WordViewerIntl.WordViewerStrings.l_AccessibilityPDFWait;break;default:a.ULS.sendTraceTag(5301275,324,10,"Unknown PdfRequestType{0}",t),r=WordViewerIntl.WordViewerStrings.l_PrintPDFWait}this._waitDlg.set_message(r),this._waitDlg.showProgressDialog(CommonUIStrings.l_DefaultDialogTitle,i.i(this,this.cancelButton,"cancelButton"),null)}},e.prototype.cancelButton=function(e){this._isCancelled=!0},e.prototype.dismissWaitUI=function(){this._waitDlg&&(this._waitDlg.close(),this._waitDlg=null)},e.prototype.showErrorUI=function(e){if(1!==n(941).App.get_activeAppFrame().get_state()){var t=new u.StandardDialog;t.set_buttonsOption(0),t.setButtonText(1,CommonUIStrings.l_DialogClose),t.showError(e,CommonUIStrings.l_DefaultDialogTitle,this._isPdfMode?WordViewerIntl.WordViewerStrings.l_PrintPdfError:WordViewerIntl.WordViewerStrings.l_PrintError,null)}},e.prototype.requestPDF=function(e,t){void 0===t&&(t=!1);var r="WordViewer/request.pdf?"+n(941).App.get_instance().theDocument.get_baseDocQuerySignature()+"&type="+this.getRequestTypeParameter(e);switch(t&&(r+="&pdfMode=1"),n(941).App.get_instance().get_translationLanguage()&&(r+="&language="+n(941).App.get_instance().get_translationLanguage(),f.AFrameworkApplication.theWsaClient.incrementDw(9987,1)),2===e&&this._directPrintManager.shouldUseNamedAction()&&(r+="&useNamedAction=1"),e){case 0:a.ULS.sendTraceTag(20820061,301,50,"Sending Accessible PDF conversion request.");break;case 1:a.ULS.sendTraceTag(20820062,301,50,"Sending Download PDF conversion request.");break;case 2:a.ULS.sendTraceTag(20820063,301,50,"Sending Print PDF conversion request.")}E.k.doRequest(r,i.i(this,this.onRequestComplete,"onRequestComplete"),n(941).App.get_activeAppFrame().get_notificationBar())&&(this._printWaitTask||(this._printWaitTask=new w.c(2,1,500,i.i(this,this.showWaitUI,"showWaitUI")),this._printWaitTask.customData=e,f.AFrameworkApplication.get_theTaskManager().addTask(this._printWaitTask)))},e.prototype.requestTypeFromUri=function(e){return e.indexOf("&type=downloadpdf")>0?1:e.indexOf("&type=printpdf")>0?2:e.indexOf("&type=accesspdf")>0?0:(a.ULS.sendTraceTag(5301276,324,10,"Could not get requestType from uri:{0}",e),2)},e.prototype.isRequestUriPdfMode=function(e){return e.indexOf("&pdfMode=1")>-1},e.prototype.onRequestComplete=function(e,t,n){if(this.dismissWaitUI(),this._directPrintManager.probeDirectPrintExperience(),!e||t)return this.logConversionRequestFailure(n,t),void(this.isRequestUriPdfMode(n.request.get_url())?P.t(f.AFrameworkApplication.downloadACopyUrl)?(a.ULS.sendTraceTag(8709638,301,10,"have no DownloadACopyUrl and fail to request printable pdf url from server."),this.showErrorUI(d.i.printPdfNotGenerated),h.u.propagateError(!1,"PrintFailed",d.i.printPdfNotGenerated,this._isPdfMode?WordViewerIntl.WordViewerStrings.l_PrintPdfError:WordViewerIntl.WordViewerStrings.l_PrintError)):this._legacyDialogDownloadACopyUrlFactory():(this.showErrorUI(d.i.printPdfNotGenerated),h.u.propagateError(!1,"PrintFailed",d.i.printPdfNotGenerated,this._isPdfMode?WordViewerIntl.WordViewerStrings.l_PrintPdfError:WordViewerIntl.WordViewerStrings.l_PrintError)));if(this._isCancelled)return this._isCancelled=!1,void(this._printWaitTask=null);this._printWaitTask&&f.AFrameworkApplication.get_theTaskManager().deleteTask(this._printWaitTask),this._printWaitTask=null;var i=new k.QueryStringBuilder(n.request.get_url());f.AFrameworkApplication.addCommonUrlParameters(i);var r=i.toString();this.displayPDF(r,this.requestTypeFromUri(r))},e.prototype.logConversionRequestFailure=function(e,t){var n=e.request.get_url(),i=e.httpStatus,r=e.status,o=String.format("HTTP Status: {0}, RequestItem Status: {1}",i,r);switch(t&&(o=String.format("{0}, Response Status: {1}",o,t)),this.requestTypeFromUri(n)){case 0:a.ULS.sendTraceTag(20820064,301,10,"Accessible PDF conversion failed. {0}",o);break;case 1:a.ULS.sendTraceTag(20820065,301,10,"Download PDF conversion failed. {0}",o);break;case 2:a.ULS.sendTraceTag(20820066,301,10,"Print PDF conversion failed. {0}",o)}if(this.isRequestUriPdfMode(n))switch(t||""){case"InvalidParameter":a.ULS.sendTraceTag(7170206,301,10,"PdfModePrint, auto print PDF conversion failed. Status: InvalidParameter");break;case"CantOpenDocument":a.ULS.sendTraceTag(7170207,301,10,"PdfModePrint, auto print PDF conversion failed. Status: CantOpenDocument");break;case"DocumentAlreadyOpen":a.ULS.sendTraceTag(7170208,301,10,"PdfModePrint, auto print PDF conversion failed. Status: DocumentAlreadyOpen");break;case"ApplicationServerError":a.ULS.sendTraceTag(7170209,301,10,"PdfModePrint, auto print PDF conversion failed. Status: ApplicationServerError");break;case"DocumentIsEncrypted":a.ULS.sendTraceTag(7170210,301,10,"PdfModePrint, auto print PDF conversion failed. Status: DocumentIsEncrypted");break;case"InvalidCurrentDocument":a.ULS.sendTraceTag(7170211,301,10,"PdfModePrint, auto print PDF conversion failed. Status: InvalidCurrentDocument");break;default:a.ULS.sendTraceTag(7135494,301,10,"PdfModePrint, auto print PDF conversion failed. Status: "+(t||"null"))}},e.prototype.accessiblePdfRequested=function(){f.AFrameworkApplication.theWsaClient.incrementDw(9542,1),this._isCancelled=!1,this._isPdfMode?(a.ULS.sendTraceTag(5849884,301,50,"Accessible PDF requested while in PDF mode"),this._actionManager.processAction(g.Ci,2)):this._userMayEnterAccessiblePdfMode?this._actionManager.processAction(m.P,2):this.requestPDF(0),this.hideAccessibleLink(null)},e.prototype.createAccessibleLink=function(){if(this._isAccessiblePdfMode){var t=document.getElementById(e.accessibilityLinkId);t&&M.s.removeElement(t)}else this._accessibleLink||(this._accessibleLink=document.getElementById(e.accessibilityLinkId)),this._accessibleLink&&(this.hideAccessibleLink(null),this._RequestAccessibilePDFFromMouseUp=i.i(this,this.requestAccessibilePDFFromMouseUp,"requestAccessibilePDFFromMouseUp"),this._RequestAccessibilePDFFromEnter=i.i(this,this.requestAccessibilePDFFromEnter,"requestAccessibilePDFFromEnter"),this._ShowAccessibleLink=i.i(this,this.showAccessibleLink,"showAccessibleLink"),this._HideAccessibleLink=i.i(this,this.hideAccessibleLink,"hideAccessibleLink"),b.n.addHandler(this._accessibleLink,"mouseup",this._RequestAccessibilePDFFromMouseUp),b.n.addHandler(this._accessibleLink,"keydown",this._RequestAccessibilePDFFromEnter),b.n.addHandler(this._accessibleLink,"focus",this._ShowAccessibleLink),b.n.addHandler(this._accessibleLink,"blur",this._HideAccessibleLink))},e.prototype.showAccessibleLink=function(t){this._accessibleLink&&(this._accessibleLink.className=e.accessibilityLinkShownClass,this._isAccessibleLinkHidden=!1)},e.prototype.hideAccessibleLink=function(t){this._accessibleLink&&!this._isAccessibleLinkHidden&&(this._accessibleLink.className=e.accessibilityLinkHiddenClass,this._isAccessibleLinkHidden=!0,t&&this._focusManager.setScopeFromTop(n(752).AppFrame.ribbonFocusId))},e.prototype.displayPDF=function(e,t){var i=new o.c(String);if(i.add("access_token"),i.add("access_token_ttl"),1!==n(941).App.get_activeAppFrame().get_state())switch(t){case 0:new p(e);break;case 1:new y(e);break;case 2:this._directPrintManager.showPrintDialog(e,!1,i);break;default:a.ULS.sendTraceTag(5301277,324,10,"Unknown PdfRequestType:{0}",t)}},e.prototype.dispose=function(){this._accessibleLink&&this._RequestAccessibilePDFFromMouseUp&&b.n.removeHandler(this._accessibleLink,"mouseup",this._RequestAccessibilePDFFromMouseUp),this._accessibleLink&&this._RequestAccessibilePDFFromEnter&&b.n.removeHandler(this._accessibleLink,"keydown",this._RequestAccessibilePDFFromEnter),this._accessibleLink&&this._ShowAccessibleLink&&b.n.removeHandler(this._accessibleLink,"focus",this._ShowAccessibleLink),this._accessibleLink&&this._HideAccessibleLink&&b.n.removeHandler(this._accessibleLink,"blur",this._HideAccessibleLink),this._accessibleLink=null},e.getPrintManagerInstance=function(){return new e(f.AFrameworkApplication.get_theActionManager(),(function(){return new _.k(f.AFrameworkApplication.downloadACopyUrl,!1)}),n(941).App.get_instance().get_isPdfMode(),n(941).App.get_instance().get_showLegacyPrintDialogPdfMode(),D.w.get_instance().resolve(r.d),C.FocusManager.instance(),n(941).App.get_instance().get_userMayEnterAccessiblePdfMode(),n(941).App.get_instance().get_isAccessiblePdfMode())},e.accessibilityLinkId="WACAccessibilityLink",e.accessibilityLinkShownClass="WACAccessibilityLinkShown",e.accessibilityLinkHiddenClass="WACAccessibilityLinkHidden",e}();(0,i.l)(F,"PrintManager",null,[Sys.IDisposable])},,function(e,t,n){"use strict";var i=n(508),r=n(208),o=function(e){function t(t){var n=e.call(this)||this;return n.$$pf_Exception=null,n.set_exception(t),n}return(0,i.t)(t,e),t.prototype.get_exception=function(){return this.$$pf_Exception},t.prototype.set_exception=function(e){return this.$$pf_Exception=e,e},t}(Sys.EventArgs);(0,r.l)(o,"UnobservedTaskExceptionEventArgs",Sys.EventArgs,[]),n.d(t,{a:function(){return a}});var a=function(){function e(){}return e.prototype.tryExecuteTask=function(e){return e.TryExecute()},e.get_Events=function(){return e._events||(e._events=new Sys.EventHandlerList)},e.get_default=function(){return e._default},e.get_current=function(){return e._current},e.set_current=function(t){return e._current=t,t},e.add_unobservedTaskException=function(t){e.get_Events().addHandler("UnobservedException",t)},e.remove_unobservedTaskException=function(t){e.get_Events().removeHandler("UnobservedException",t)},e.RunOnSpecific=function(t,i){(i=i||e.get_current())===e._default?window.setTimeout(e.RunCurrent(t,i),0):n(742).Task.Create(t).Start$Scheduler(i)},e.PublishUnobservedTaskException=function(t,n){var i=e.get_Events().getHandler("UnobservedException");i&&i(t,new o(n))},e.RunCurrent=function(t,n){return function(){var i=e.get_current();e.set_current(n),t(),e.set_current(i)}},e._events=null,e}();(0,r.l)(a,"TaskScheduler",null,[])},,,,function(e,t,n){var i=n(247);e.exports=function(e){if(!i(e)&&null!==e)throw TypeError("Can't set "+String(e)+" as a prototype");return e}},,,,function(e,t,n){"use strict";n.r(t);var i=n(255),r=n(183),o=n(425),a=n(208),s=function(){function e(){this.assertHandler=null}return e.getDefaultDebugSettings=function(){return new e},e}();(0,a.l)(s,"DebugSettings",null,[]);var l=n(556);n.d(t,{Debug:function(){return u}});var u=function(){function e(){}return e.get_isUnitTest=function(){if(null==e._isUnitTest)try{e._isUnitTest=!(void 0===JVUnit||null===JVUnit)}catch(t){e._isUnitTest=!1}return e._isUnitTest},e.get_debugSettings=function(){return e._debugSettings||(e._debugSettings=s.getDefaultDebugSettings()),e._debugSettings},e.set_debugSettings=function(t){return e._debugSettings=t,t},e.get_KomodoLoaded=function(){return window.self.g_liveBooksKomodoLoaded},e.get_KomodoFailedToConnect=function(){return window.self.g_liveBooksKomodoFailedToConnect},e.set_KomodoFailedToConnect=function(e){return window.self.g_liveBooksKomodoFailedToConnect=e,e},e.breakpoint=function(){},e.alert=function(e){alert(e)},e.alertObject=function(e){},e.assert=function(e){},e.assertTag=function(e,t){},e.assertString=function(e,t){},e.assertStringTag=function(e,t,n){},e.assertNotReached=function(){},e.assertNotReachedTag=function(e){},e.assertNotReachedString=function(e){},e.assertNotReachedStringTag=function(e,t){},e.assertImplies=function(e,t){},e.assertImpliesTag=function(e,t,n){},e.assertImpliesString=function(e,t,n){},e.assertImpliesStringTag=function(e,t,n,i){},e.assertNotReachedNamed=function(e,t){},e.alertAssertCallback=function(e,t){},e.internalAssertHandler=function(e,t,n){},e.internalAssertNamedHandler=function(e,t,n){},e.alertAssertNamedCallback=function(e,t){},e.reportAssertToTestHarness=function(e,t){var i=t?r.z(t):"not tagged",o=new Sys.StringBuilder;o.appendLine("Assert ["+i+"] OAUTOBUGTAG:CLS[WebToadBrowserProductErrorAssert]["+i+"][][][]ENDOABT  "),o.append(e),n(254).AFrameworkApplication.tryReportErrorToTestHarness(l.l.replaceAll(o.toString(),"\r\n","\\r\\n"))},e.generateCallstack=function(t,n,i,r){void 0===t&&(t=null),void 0===n&&(n=!0),void 0===i&&(i=!1),void 0===r&&(r=!1);var o=new Sys.StringBuilder,a=[];r||e.get_isUnitTest()||e.addAnonymousFunctionNameFieldToAtlasTypes();var s=1;try{for(var u=t||arguments.callee;u&&s<40;u=u.caller,s++){var c=e.getFunctionName(u);if(!c.startsWith(e._commonDebugFunctionPrefix)){var p=e.generateSignature(u,i)||"";if(n)o.append(c),o.append(p),o.appendLine();else{var d="anonymous"===c;o.append(String.format(d?'<function depth="{0}" signature="{1}"><![CDATA[{2}]]></function>':'<function depth="{0}" signature="{1}" />',s-1,l.l.htmlEncode(c+p),d?u.toString():""))}if(Array.contains(a,u)){n&&o.appendLine("--[JavaScript recursion]--");break}Array.add(a,u)}}40===s&&n&&o.appendLine("***[Maximum callstack depth reached]***")}catch(e){n?(o.append("Exception: "),o.append(e.message),o.appendLine()):o.append(String.format('<function depth="{0}" signature="{1}" />',s-1,l.l.htmlEncode("Exception: "+e.message)))}return o.toString()},e.generateMethodFrame=function(t,n,i){void 0===i&&(i=!1);var r="";i||e.get_isUnitTest()||e.addAnonymousFunctionNameFieldToAtlasTypes();try{for(var o=t||arguments.callee;o&&((r=e.getFunctionName(o)).startsWith(e._commonDebugFunctionPrefix)||r.startsWith("$$ct"));o=o.caller);}catch(e){return"[Failed to find current method name - exception "+e.toString()+"]"}if(null==r)return"[Failed to find current method name]";if(n){var a=r.indexOf("__");-1!==a&&(r=r.substr(a+2));var s=r.lastIndexOf("$");-1!==s&&(r=r.substring(0,s))}return r},e.generateSignature=function(t,n){if(!t)return null;var i,r=null,o=t.toString().match(e._simpleSignatureRegex);if(o&&3===o.length&&(r=o[2]),!n)return r;i=r&&r.length>=2?r.substring(r.indexOf("(")+1,r.length-1).split(","):[];var a=t.arguments;if(a){for(var s=new Sys.StringBuilder("("),l=i.length,u=0,c=a.length;u<c;u++){var p=void 0;if(u<l){var d=i[u];d=d?d.trim():"",s.append(d),s.append(" = ")}var h=a[u];if(null===h)p="null";else{var g=typeof h;switch(g){case"function":case"undefined":case"object":p=g;break;case"number":case"boolean":p=h.toString();break;case"string":p='"'+h+'"';break;default:p="unknown ("+g+")"}}s.append(p),u<c-1&&s.append(", ")}return s.append(")"),s.toString()}return null},e.getFunctionName=function(t){var r;if(n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FixAnonymousCallstacksIsEnabled")){r=t.name;var a=t[e._functionLabelFieldName];r&&r.length?"anonymous"===r.toLowerCase()&&o.y.get_isInternetExplorer()&&(i.ULS.sendTraceTag(0,201,15,String.format("Reporting decorated name instead of 'anonymous' in the callstack. Decorated name = {0}. Function body = {1}.",a,t.toString())),r=a):r=a}else r=t.name||t[e._functionLabelFieldName];if(null==r){var s=t.toString().match(e._functionNameRegex);if(!s||2!==s.length)return"anonymous";r=s[1]}return r.trim().length>0?r:"anonymous"},e.addAnonymousFunctionNameFieldToAtlasTypes=function(){for(var t=0,n=Type.getRootNamespaces();t<n.length;t++){var i=n[t];e.addAnonymousFunctionNameFieldsForNamespace(i)}},e.nnlpt=function(t){return t.getName().replace(e._normalizeNamespaceRegex,"_")},e.normalizeNamespaceLabelPrefix=function(t){return t.getName().replace(e._normalizeNamespaceRegex,"_")},e.addAnonymousFunctionNameFieldsForNamespace=function(t){for(var n in t){var i={key:n,value:t[n]};try{var r=i.value;if(Type.isClass(r)){var o=r,a=e.nnlpt(o);if(void 0!==o.prototype){var s=o.prototype.constructor;void 0===s[e._functionLabelFieldName]&&(e.addAnonymousFunctionNameField(a,s,"",""),e.processObjectFieldDictionary(a,o.prototype,o.getBaseType()))}e.processObjectFieldDictionary(a,r,null)}else Type.isInterface(r)||Type.isEnum(r)||(Type.isNamespace(r)?e.addAnonymousFunctionNameFieldsForNamespace(r):e.addAnonymousFunctionNameField(e.normalizeNamespaceLabelPrefix(t),i.value,i.key,"_"))}catch(e){}}},e.processObjectFieldDictionary=function(t,n,i){for(var r in n){var o={key:r,value:n[r]};if(!(Type.isClass(o.value)||i&&i.prototype[o.key]===o.value)){var a="$";i&&(a+="prototype$"),e.addAnonymousFunctionNameField(t,o.value,o.key,a)}}},e.addAnonymousFunctionNameField=function(t,n,i,r){"function"==typeof n&&"anonymous"===e.getFunctionName(n)&&(n[e._functionLabelFieldName]=t+r+i)},e.shouldLog=function(e,t){return!1,!1},e.logMethodFrame=function(t,n,i){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];null!=t&&""!==t&&(t=": "+t),t=e.methodFrame(!0)+t},e.logMethodFrameRaw=function(t,n,i){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];t&&(t=": "+t),t=e.methodFrame(!1)+t},e.methodFrame=function(t,n){return void 0===n&&(n=null),e.generateMethodFrame(n,t)},e.log=function(e,t,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r]},e.logCallstack=function(e,t,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r]},e.logDOMElement=function(e,t,n,i){for(var r=[],o=4;o<arguments.length;o++)r[o-4]=arguments[o]},e.domElementLoggingInfo=function(t){var n=e.domElementInfo(t);t.parentNode&&(n+="\nwith Parent "+e.domElementInfo(t.parentNode));var i=t.innerHTML;return i.length<5e3?n+="\n InnerHTML: "+i:n+="\n InnerHTML too long",n},e.domElementInfo=function(e){return String.format("'{0}' tag named '{1}' class '{2}'",e.tagName,e.id,e.className)},e._debugSettings=null,e._simpleSignatureRegex=new RegExp("function\\s*([^(]*)([^{]*\\))"),e._functionNameRegex=new RegExp("function\\s*([^(]*)\\("),e._normalizeNamespaceRegex=new RegExp("\\.","g"),e._functionLabelFieldName="__ulsFunctionName",e._commonDebugFunctionPrefix=e.nnlpt(e),e._isUnitTest=null,e.alertAssertAdditionalInfo=null,e.ReadyForKomodo=!1,e}();(0,a.l)(u,"Debug",null,[])},,function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var i,r=n(208);!function(e){e[e.waiting=0]="waiting",e[e.executing=1]="executing",e[e.succeeded=2]="succeeded",e[e.failed=3]="failed",e[e.notFound=4]="notFound",e[e.preConditionFailed=5]="preConditionFailed",e[e.socketConnectionError=6]="socketConnectionError",e[e.timeOut=7]="timeOut",e[e.offlineMode=8]="offlineMode",e[e.serverError=9]="serverError",e[e.cancelled=10]="cancelled",e[e.clientError=11]="clientError",e[e.serverAuthenticationError=12]="serverAuthenticationError",e[e.expiredWithoutSending=13]="expiredWithoutSending",e[e.accessTokenExpired=14]="accessTokenExpired"}(i||(i={})),(0,r.h)("RequestStatus",i)},,,,,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=n(92),a=n(475),s=function(){function e(){}return e.get_myDialogHtml=function(){return o.o.formatHtml(e.myDialogHtmlFormat,WordViewerIntl.WordViewerStrings.l_TranslationPrivacyWarning,WordViewerIntl.WordViewerStrings.l_ChooseTranslationLanguage)},e.myDialogHtmlFormat="<div class='WACDialogRow' id='TranslationPrivacyLabelBlock'> <label id='TranslationPrivacyLabel' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='TranslationLabelBlock'> <label id='TranslationLabel' class='WACDialogLabel' for='TranslationLanguageList' >{1}</label> </div> <div class='WACDialogRowNoBreak' id='TranslationLanguageListBlock'> <select class='UIFont WACDialogList' id='TranslationLanguageList'> </select> </div>",e}();(0,r.l)(s,"TranslationDialogHtml",null,[]);var l=n(254),u=n(425);n.d(t,{TranslationDialog:function(){return c}});var c=function(e){function t(){var t=e.call(this)||this;return t._languages=null,t._uiLanguageId=0,t}return(0,i.t)(t,e),t.prototype.start=function(){this.set_dialogId("TranslationDialog");this.set_dialogHtml(s.get_myDialogHtml()),this.set_buttonsOption(1),this.initializeAndShow(WordViewerIntl.WordViewerStrings.L_TranslateDocument,r.i(this,this.handleClick,"handleClick"),{TranslationLanguageList:0}),this.setDescribedByForDialog(this.myId("TranslationPrivacyLabel")),this.populateLanguageList()},t.prototype.populateLanguageList=function(){this._languages=a.o.translationLanguages.getLanguages(),this._uiLanguageId=1023&l.AFrameworkApplication.lcid,this._languages.sort(r.i(this,this.compareLanguages,"compareLanguages"));for(var e=document.getElementById("TranslationLanguageList"),t=0;t<this._languages.length;t++){var n=document.createElement("OPTION");n.value=this._languages[t].name,n.text=this._languages[t].displayName,u.y.get_isInternetExplorerNonEdge()?e.add(n):e.add(n,null)}},t.prototype.compareLanguages=function(e,t){var n=e,i=t,r=n.languageId===this._uiLanguageId,o=i.languageId===this._uiLanguageId;return r&&!o?-1:o&&!r?1:n.displayName.localeCompare(i.displayName)},t.prototype.handleClick=function(e,t){1===e&&a.o.translateDocument(this._languages[t.TranslationLanguageList].name)},t}(o.o);(0,r.l)(c,"TranslationDialog",o.o,[])},function(e,t,n){"use strict";var i=n(935).IteratorPrototype,r=n(38),o=n(560),a=n(128),s=n(142),l=function(){return this};e.exports=function(e,t,n){var u=t+" Iterator";return e.prototype=r(i,{next:o(1,n)}),a(e,u,!1,!0),s[u]=l,e}},function(e,t,n){"use strict";n.r(t),n.d(t,{QueryStringBuilder:function(){return a}});var i=n(851),r=n(556),o=n(208),a=function(){function e(e){this._queryString=null,this._first=!1,this._queryString=e,this._first=-1===e.indexOf("?")}return e.prototype.getParam=function(e){return i.n.getParameterValueDecoded(this._queryString,e)},e.prototype.addParam=function(e,t){this.addFullParam(r.l.urlKeyValueEncode(e)+"="+r.l.urlKeyValueEncode(t))},e.prototype.addOrReplaceParam=function(e,t){this._queryString=i.n.addOrReplaceParameterValue(this._queryString,r.l.urlKeyValueEncode(e),t?r.l.urlKeyValueEncode(t):null)},e.prototype.addFullParam=function(e){this._queryString+=(this._first?"?":"&")+e,this._first=!1},e.prototype.addOrReplaceFullParam=function(e){var t=e.split("=");if(2===t.length){var n=t[0],r=t[1];this._queryString=i.n.addOrReplaceParameterValue(this._queryString,n,r)}},e.prototype.toString=function(){return this._queryString},e}();(0,o.l)(a,"QueryStringBuilder",null,[])},,function(e,t,n){"use strict";var i=n(508),r=n(208),o=(0,r.y)("IZoomDialog"),a=n(92),s=n(614),l=n(574),u=n(657),c=n(550),p=n(556),d=function(){function e(){}return e.get_zoomDialogOneRowHtmlTemplate=function(){return e.zoomDialogOneRowHtmlTemplateFormat},e.zoomDialogOneRowHtmlTemplateFormat="<div class='WACZoomDialogRadioRow' id='ZoomDlgBlock{0}'> <input type='radio' id='radiobox{0}' name='{2}' class='WACDialogRadio' alt='{1}' title='{1}'></input> <label id='ZoomDlgList{0}' class='WACDialogLabel' for='radiobox{0}' >{1}</label> </div>",e}();(0,r.l)(d,"ZoomDialogHtml",null,[]),n.d(t,{j:function(){return g}});var h="ZoomDialog",g=function(e){function t(t,n,i,r){var o=e.call(this)||this;return o.focusManager=null,o.activeSelection=null,o._zoomLists=null,o._zoomValues=null,o._container=null,o._zoomDialogCallback=null,o._zoomDialogClickHandler=null,o._zoomDialogKeyHandler=null,o._zoomLists=t,o._zoomValues=n,o._zoomDialogCallback=i,o.focusManager=r,o.set_dialogHtml(o.buildDialogHTML()),o.set_buttonsOption(1),o.set_dialogId(h),o}return(0,i.t)(t,e),t.prototype.get_radioboxName=function(){return"ListRadioBox"},t.prototype.get_radioboxPrefix=function(){return"radiobox"},t.prototype.get_radioRowClassName=function(){return"WACZoomDialogRadioRow"},t.prototype.get_radioRowHighlightClassName=function(){return"WACZoomDialogRadioRow-highlight"},t.prototype.get_focusManager=function(){return this.focusManager},t.prototype.get_activeSelection=function(){return this.activeSelection},t.prototype.showZoomDialog=function(e,t){for(var n={},i=0;i<this._zoomLists.length;i++)this._zoomValues[i]===t?n[this.get_radioboxPrefix()+i]=!0:n[this.get_radioboxPrefix()+i]=!1;this.initializeAndShow(e,r.i(this,this.zoomDialogHandler,"zoomDialogHandler"),n),this.rebindTabNavigationHandlers(),this.registerFocusForRadioButtons()},t.prototype.selectFirstZoomOption=function(){this.activeSelection=document.getElementsByName(this.get_radioboxName())[0],this.focusRadioButton(this.get_activeSelection())},t.prototype.attachDialogEvents=function(){this._container||(this._container=document.getElementById("WACDialogText")),this._container&&(this._zoomDialogClickHandler||(this._zoomDialogClickHandler=r.i(this,this.zoomDialogClickHandler,"zoomDialogClickHandler"),this._clickManager.registerHandler(l.d.click,this._container,this._zoomDialogClickHandler)),this._zoomDialogKeyHandler||(this._zoomDialogKeyHandler=r.i(this,this.zoomDialogKeyDownHandler,"zoomDialogKeyDownHandler"),this._keyInputManager.registerHandler(l.d.keyDown,this._container,this._zoomDialogKeyHandler))),e.prototype.attachDialogEvents.call(this),this._divMessageBox&&this._keyInputManager.registerHandler(l.d.keyUp,this._divMessageBox,r.i(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler"))},t.prototype.rebindTabNavigationHandlers=function(){this.get_focusManager().getCurrentRegion().scope.unBindAction(u.FocusManager.instance()._tabInput),this.get_focusManager().getCurrentRegion().scope.unBindAction(u.FocusManager.instance()._tabShiftInput),this.get_focusManager().getCurrentRegion().scope.bindAction(u.FocusManager.instance()._tabInput,s.go),this.get_focusManager().getCurrentRegion().scope.bindAction(u.FocusManager.instance()._tabShiftInput,s.FL)},t.prototype.registerFocusForRadioButtons=function(){for(var e=document.getElementsByName(this.get_radioboxName()),t=0;t<e.length;t++){var n=e[t];c.n.addHandler(n,l.d.focus,r.i(this,this.radioButtonFocusHandler,"radioButtonFocusHandler")),n.checked&&(this.activeSelection=n)}},t.prototype.zoomDialogHandler=function(e,t){if(1===e)for(var n=0;n<this._zoomLists.length;n++)if(t[this.get_radioboxPrefix()+n]){this._zoomDialogCallback(this._zoomValues[n]);break}},t.prototype.radioButtonFocusHandler=function(e){this.focusRadioButton(e.target)},t.prototype.zoomDialogClickHandler=function(e){var t=e.get_sourceElement();if(!t||!t.parentNode||"label"!==t.tagName.toLowerCase()&&!t.className.startsWith(this.get_radioRowClassName()))return!1;var n=this.getIndexOfElement(t),i=document.getElementById(this.get_radioboxPrefix()+n);return this.focusRadioButton(i),!0},t.prototype.zoomDialogKeyDownHandler=function(e){var t=e.innerEvent.keyCode;if(t!==Sys.UI.Key.down&&t!==Sys.UI.Key.right&&t!==Sys.UI.Key.up&&t!==Sys.UI.Key.left)return!1;var n=this.getIndexOfElement(this.get_activeSelection()),i=this._zoomLists.length-1;t===Sys.UI.Key.down||t===Sys.UI.Key.right?n=n<i?n+1:0:t!==Sys.UI.Key.up&&t!==Sys.UI.Key.left||(n=n>0?n-1:i);var r=document.getElementById(this.get_radioboxPrefix()+n);return this.focusRadioButton(r),!0},t.prototype.dialogDefaultEnterKeyHandler=function(t){return t.eventName===l.d.keyUp&&t.innerEvent.keyCode===Sys.UI.Key.enter&&(e.prototype.dialogDefaultEnterKeyHandler.call(this,t),!0)},t.prototype.focusRadioButton=function(e){e&&(e.checked=!0,this.get_focusManager().get_currentScope()&&this.get_focusManager().get_currentScope().name===this.get_fullDialogFocusId()||this.get_focusManager().setScope(this.get_fullDialogFocusId()),this.get_focusManager().getCurrentRegion().listing.trySetCurrentElement(e),e.focus(),this.get_activeSelection()&&Sys.UI.DomElement.removeCssClass(this.get_activeSelection().parentNode,this.get_radioRowHighlightClassName()),Sys.UI.DomElement.addCssClass(e.parentNode,this.get_radioRowHighlightClassName()),this.activeSelection=e)},t.prototype.getIndexOfElement=function(e){return Number.parseInvariant(p.l.substr(e.id,e.id.length-1,1))},t.prototype.sizeAndPositionDialog=function(){e.prototype.sizeAndPositionDialog.call(this);var t=document.getElementById(this.myId("WACDialogPanel"));t.style.minWidth=String.format("{0}px",200),t.style.width=String.format("{0}px",200)},t.prototype.buildDialogHTML=function(){for(var e="",n=0;n<this._zoomLists.length;n++)e+=a.o.formatHtml(t.zoomDialogOneRowHTMLTemplate,n.toString(),this._zoomLists[n],this.get_radioboxName());return e},t.prototype.dispose=function(){this._container&&(this._clickManager&&this._zoomDialogClickHandler&&this._clickManager.unregisterHandler(l.d.click,this._container,this._zoomDialogClickHandler),this._keyInputManager&&this._zoomDialogKeyHandler&&this._keyInputManager.unregisterHandler(l.d.keyDown,this._container,this._zoomDialogKeyHandler)),this._clickManager&&this._divMessageBox&&this._keyInputManager.unregisterHandler(l.d.keyUp,this._divMessageBox,r.i(this,this.dialogDefaultEnterKeyHandler,"dialogDefaultEnterKeyHandler")),e.prototype.dispose.call(this)},t.zoomDialogOneRowHTMLTemplate=d.get_zoomDialogOneRowHtmlTemplate(),t}(a.o);(0,r.l)(g,"ZoomDialog",a.o,[o])},,,,,,,,,,function(e,t,n){"use strict";n.d(t,{g:function(){return s}});var i=n(508),r=n(208),o=n(779),a=n(899),s=function(e){function t(t,n,i,r){return e.call(this,t,n,i,"",null,r)||this}return(0,i.t)(t,e),t.prototype.refreshInternal=function(){this.get_needsDelayIniting()&&this.doDelayedInit(),this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.get_elementInternal()),e.prototype.refreshInternal.call(this)},t.prototype.ensureCorrectChildType=function(e){if(!r.r(a.l,e))throw Error.create("Only children of Section can be added to a Layout")},t.prototype.get_cssClass=function(){return"cui-layout"},t.prototype.get_visibleInDOM=function(){return!!r.r(n(554).Group,this.get_parent())&&this.get_parent().get_selectedLayout()===this},t}(o.p);(0,r.l)(s,"Layout",o.p,[])},function(e,t,n){"use strict";n.r(t),n.d(t,{FlyoutAnchor:function(){return _}});var i=n(508),r=n(208),o=n(160),a=n(488),s=n(134),l=n(951),u=n(268),c=n(659),p=n(833),d=n(802),h=n(899),g=n(513),m=n(946),_=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o._imageIsVisible=!1,o._imageUsesSpaceWhileInvisible=!1,o.useCheckMark=!1,o.addDisplayMode("Small"),o.addDisplayMode("Small14"),o.addDisplayMode("Medium"),o.addDisplayMode("Medium14"),o.addDisplayMode("Large"),o.addDisplayMode("Large16"),o.addDisplayMode("Thin"),o.addDisplayMode("Menu"),o.addDisplayMode("Menu16"),o.addDisplayMode("Menu32"),o.addDisplayMode("Menu48"),o.addDisplayMode("MenuTellMe"),o.addDisplayMode("FloatieLarge"),o.addDisplayMode("Small20"),o.addDisplayMode("Small24"),o.addDisplayMode("Medium20"),o.set_isFloatieContextMenuDropDown(m.n.isTrue(o.get_properties$2().FloatieContextMenuDropDown)),o._imageIsVisible=!m.n.isFalse(i.ImageIsVisible),o._imageUsesSpaceWhileInvisible=m.n.isTrue(i.ImageUsesSpaceWhileInvisible),o.get_stateProperties()[p.g.SourceControlId]=n,o.get_stateProperties()[p.g.LabelText]=o.labelText=o.get_properties$2().LabelText,o.get_stateProperties()[p.g.LabelTextUserGeneratedPlaceholderReplacements]=o.get_properties$2().LabelTextUserGeneratedPlaceholderReplacements,o.get_stateProperties()[p.g.Visible]=o.get_visible(),o.get_stateProperties()[p.g.ImageIsVisible]=o.get_imageIsVisible(),o.get_stateProperties()[p.g.ImageBackColor]=o.get_properties$2().ImageBackColor,o.useCheckMark=m.n.isTrue(i.UseCheckMark),o.get_stateProperties()[p.g.On]=m.n.isTrue(i.IsChecked),o}return(0,i.t)(t,e),t.prototype.get_useCheckMark=function(){return this.useCheckMark},t.prototype.get_ariaRole=function(){return this.inMenu?this.get_useCheckMark()?s.t.ariaTreeItemRole:s.t.ariaTabRole:e.prototype.get_ariaRole.call(this)},t.prototype.onStateChanged=function(){var e=this,t=this.get_stateProperties()[d.e.On];this.get_useCheckMark()&&(this.get_stateProperties()[s.t.ariaCheckedAttribute]=t?s.t.ariaTrueValue:s.t.ariaFalseValue),this.get_controlComponentDomCache().forEach((function(n){e.updateAriaMenuLauncherAttributes(n.elmControl,t)}))},t.prototype.createComponentDomForDisplayMode=function(e){var t=!m.n.isTrue(this.get_properties$2().HideDefaultArrow),n=new c.f(t).buildControlDom(this,e);return this.populateControlDom(n,e),n},t.prototype.populateControlDom=function(e,t){m.n.isTrue(this.get_properties$2().FloatieContextMenuDropDown)&&m.n.ensureCSSClassOnElement(e.elmControl,"context-menu-dd"),u.r.isDisplayModeMenu(t)&&m.n.ensureCSSClassOnElement(e.elmControl,"cui-fa-menuitem"),t.startsWith("Small")&&m.n.ensureCSSClassOnElement(e.elmControl,"cui-fa-sm"),this.setInitialAriaMenuLauncherAttributes(e.elmControl)},t.prototype.setInitialAriaMenuLauncherAttributes=function(t){this.get_useCheckMark()&&s.t.setAriaAttribute(t,s.t.ariaCheckedAttribute,s.t.ariaFalseValue),e.prototype.setInitialAriaMenuLauncherAttributes.call(this,t)},t.prototype.updateAriaMenuLauncherAttributes=function(e,t){var n=this.menuLaunched?s.t.ariaTrueValue:s.t.ariaFalseValue;this.get_useCheckMark()?s.t.setAriaAttribute(e,s.t.ariaCheckedAttribute,t?s.t.ariaTrueValue:s.t.ariaFalseValue):this.inMenu&&s.t.setAriaAttribute(e,s.t.ariaSelectedAttribute,n),s.t.setAriaAttribute(e,s.t.ariaExpandedAttribute,n)},t.prototype.get_controlType=function(){return l.Control.flyoutAnchorControlType},t.prototype.get_imageIsVisible=function(){return this._imageIsVisible},t.prototype.set_imageIsVisible=function(e){var t=e;return t!==this._imageIsVisible&&(this._imageIsVisible=t,this.onImageVisibleChanged(t)),e},t.prototype.onImageVisibleChanged=function(e){var t=this;this.get_controlComponentDomCache().forEach((function(n){t.setDisplay(n.elmIconContainer,e)}))},t.prototype.setDisplay=function(e,t){e&&(e.style.display="",e.style.visibility="",t||(this._imageUsesSpaceWhileInvisible?e.style.visibility="hidden":e.style.display="none"))},t.prototype.get_menuDirection=function(){var e=2;return this.get_displayedComponent().isMenuItem()?e=1:this.get_root().get_launchMenusUp()&&(e=3),e},t.prototype.get_launcherComponent=function(){var e=this.get_displayedComponent();if(!g.x(e)&&"Thin"===e.get_displayMode()){for(;e&&!r.r(h.l,e);)e=e.get_parent();e||(e=this.get_displayedComponent())}return e},t.prototype.getTextValue=function(){return this.labelText},t.prototype.get_properties$2=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t.prototype.getControlsInFlyoutAnchorMenu=function(){for(var e=new Array(0),t=this.get_menu().get_children().getEnumerator();t.moveNext();)for(var n=t.get_current().get_children().getEnumerator();n.moveNext();){var i=n.get_current();e[e.length]=i.get_control()}return e},t}(a.MenuLauncher);(0,r.l)(_,"FlyoutAnchor",a.MenuLauncher,[o.a])},function(e,t,n){"use strict";var i=n(351),r=(n(809),n(600)),o=n(254),a=n(778),s=n(508),l=n(216),u=n(208),c=function(e){function t(){var t=e.call(this)||this;return t.McuLayout=!1,t.McuExternalId=null,t.Command=null,t.QueryCommand=null,t.CommandPreviewId=null,t.CommandRevertId=null,t.Width=0,t.Colors=null,t.Stateful=!1,t}return(0,s.t)(t,e),t.prototype.get_ControlType=function(){return 7},t}(l.i);(0,u.l)(c,"ColorPickerControlProps",l.i,[]);var p=n(771),d=n(212),h=function(e){function t(){var t=e.call(this)||this;return t.Type=0,t.Width=0,t.ElementDimensions=null,t.ExternalGalleryId=null,t.Title=null,t.GalleryItems=null,t.GalleryStyle=null,t}return(0,s.t)(t,e),t.prototype.get_ControlType=function(){return 8},t}(l.i);(0,u.l)(h,"GalleryProps",l.i,[]);var g=n(973),m=function(e){function t(){var t=e.call(this)||this;return t.LabelText=null,t}return(0,s.t)(t,e),t}(l.i);(0,u.l)(m,"LabelProps",l.i,[]);n(607),n(167);var _=n(320),f=n(556);n.d(t,{yL:function(){return y},LU:function(){return C},oG:function(){return b},Ff:function(){return A},wD:function(){return T},eF:function(){return w},wF:function(){return I},IV:function(){return E},OU:function(){return k},vN:function(){return D},gu:function(){return M}});var y=function(e,t,n,i,r,a,s,l,u,c,p,d,h,m,_,f,y,S,C,b){return void 0===p&&(p=null),void 0===d&&(d=null),void 0===h&&(h=null),void 0===m&&(m=!0),void 0===_&&(_=null),void 0===f&&(f=null),void 0===y&&(y=null),void 0===S&&(S=null),void 0===C&&(C=null),void 0===b&&(b=null),v(e,t,n,i?o.AFrameworkApplication.get_imageClusterPath():null,i?g.getImageClass(i):null,r,a,s,l,u,c,p,d,h,m,_,f,y,S,C,null,b)},v=function(e,t,n,i,r,o,a,s,l,u,c,p,d,h,g,m,_,f,y,v,S,C){void 0===p&&(p=null),void 0===d&&(d=null),void 0===h&&(h=null),void 0===g&&(g=!0),void 0===m&&(m=null),void 0===_&&(_=null),void 0===f&&(f=null),void 0===y&&(y=null),void 0===v&&(v=null),void 0===S&&(S=null),void 0===C&&(C=null);var b='<Button Id="{0}" Command="{1}" LabelText="{2}" Visible="{3}"';b=String.format(b,e,t,n,g);var A={MenuItemId:o,CommandValueId:a,Alt:s,DisplayMode:l,LabelCss:u,QueryCommand:c,Description:p,ImageBackColor:d,Keytip:h,LabelTextUserGeneratedPlaceholderReplacements:S,ShortcutHint:C};for(var T in m&&(A.AriaLabel=m),_&&(A.AriaLabelledById=_),f&&(A.AriaLabelledByText=f),y&&(A.AriaDescribedById=y),v&&(A.AriaDescribedByText=v),i&&(l&&"Small"!==l&&"Medium"!==l&&"Menu16"!==l?"Small20"===l||"Medium20"===l?(A.Image20by20=i,A.Image20by20Class=r):"Large"!==l&&"Menu32"!==l&&"Initials"!==l||(A.Image32by32=i,A.Image32by32Class=r):(A.Image16by16=i,A.Image16by16Class=r)),A){var w={key:T,value:A[T]};w.value&&(b+=String.format(' {0}="{1}"',w.key,w.value))}return b+=" />"},S=function(e,t,n,i,r,o,a,s,l,u,c,p,d,h,g,m,_,f,y){void 0===y&&(y=null);var v='<FlyoutAnchor Id="{0}" ';v=String.format(v,e);var S={Command:t,CommandMenuOpen:n,CommandMenuClose:i,PopulateDynamically:r?"True":"False",PopulateOnlyOnce:o?"True":"False",QueryCommand:a,PopulateQueryCommand:s,Alt:p,SequenceType:d,LabelText:h,LabelCss:g,ShouldRefreshWhenDropped:m?"True":"False",RefreshableMenu:_?"True":"False",Visible:f?"True":"False"},C=null,b=null;for(var A in"None"!==l&&(C=l,b=l+"Class"),u&&C&&(S[C]=u),c&&b&&(S[b]=c),S){var T={key:A,value:S[A]};T.value&&(v+=String.format(' {0}="{1}"',T.key,T.value))}return v+=">",y&&(v+=I(y)),v+="</FlyoutAnchor>"},C=function(e){return S(e.get_id(),e.get_actionIdCommand().toString(),e.get_actionIdCommandMenuOpen().toString(),e.get_actionIdCommandMenuClose().toString(),!0,!1,e.get_actionIdQueryStatus().toString(),e.get_actionIdPopulateFlyout().toString(),"Image16by16",e.get_singleUserCollabGlyph16().cluster,e.get_singleUserCollabGlyph16().css,null,null,null,null,!1,!1,!1)},b=function(e,t,n){var i="";return f.l.formatNumberToString(n,6,o.AFrameworkApplication.get_numberFormat(),(0,r.m)((function(){return i}),(function(e){return i=e}))),y(e,t,i,null,n.toString())},A=function(e,t,n,i,r,a,s,l,u,c,p){void 0===a&&(a=null),void 0===s&&(s=null),void 0===l&&(l=!0),void 0===u&&(u=null),void 0===c&&(c=!1),void 0===p&&(p=null);var d='<ToggleButton Id="{0}" MenuItemId="{1}" Command="{2}" QueryCommand="{3}" LabelText="{4}" Visible="{5}" UpdateHtmlPostToggle="{6}" ';return d=String.format(d,e,t,n,i,r,l,c),null!=a&&r!==a&&(d+=String.format('Alt="{0}" ',a)),null!=s&&(d+=String.format('Image16by16="{0}" Image16by16Class="{1}" ',o.AFrameworkApplication.get_imageClusterPath(),g.getImageClass(s))),null!=u&&(d+=String.format('Keytip="{0}" ',u)),null!=p&&(d+=String.format('AriaLabel="{0}" ',p)),d+="/>"},T=function(e,t,n,i,r,o,a,s,l,u,c,p,d){void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=!1),void 0===l&&(l=!0),void 0===u&&(u=null),void 0===c&&(c=null),void 0===p&&(p=null),void 0===d&&(d=!1);var h=o||r,g=a?String.format('Keytip="{0}"',a):"",m=i?String.format('QueryCommand="{0}"',i):"",_=u?String.format('IsChecked="{0}"',null!=u&&u):"",f=c?String.format('CheckedImageClass="{0}"',c):"",y=p?String.format('CheckedImage="{0}"',p):"";return String.format('<ToggleButton Id="{0}"\r\n\tMenuItemId="{1}"\r\n\tCommand="{2}"\r\n\t{3}\r\n\tLabelText="{4}"\r\n\tAlt="{5}"\r\n\t{6}\r\n\tUseCheckMark="true"\r\n\tUseUncheckedImage="{7}"\r\n\tCloseMenuWhenExecuted="{8}"\r\n\t{9}\r\n\t{10}\r\n\t{11}\r\n\tUpdateHtmlPostToggle="{12}"\r\n/>',e,t,n,m,r,h,g,s,l,_,f,y,d)},w=function(e,t,n,i,r,a){var s='<SplitButton Id="{0}" Command="{1}" QueryCommand="{2}" LabelText="{3}" Image16by16="{4}" Image16by16Class="{5}">';return s=String.format(s,e,t,n,i,o.AFrameworkApplication.get_imageClusterPath(),g.getImageClass(r)),s+=I(a),s+="</SplitButton>"},I=function(e,t){var n="<Menu";null!=t&&(n+=' Id="'+t+'"'),n+=">";for(var i=0;i<e.length;++i)n+=e[i];return n+="</Menu>"},E=function(e,t){for(var n=null==e?"<Controls>":String.format('<Controls Id="{0}">',e),i=0;i<t.length;i++)n+=t[i];return n+="</Controls>"},k=function(e,t,n,i,r,a,s){void 0===i&&(i=null),void 0===r&&(r=null),void 0===a&&(a=null),void 0===s&&(s=null);var l="<MenuSection ";return e&&(l+=String.format('Id="{0}" ',e)),n&&(l+=String.format('DisplayMode="{0}" ',n)),i&&(l+=String.format('Title="{0}" ',i),!r||n&&"Menu16"!==n&&"Menu16DescriptionEnabled"!==n||(l+=String.format('Image="{0}" ',o.AFrameworkApplication.get_imageClusterPath()),l+=String.format('ImageClass="{0}" ',g.getImageClass(r)))),a&&(l+=String.format('Language="{0}" ',a)),s&&(l+=String.format('ariaLabelledById="{0}" ',s)),l+=">",l+=t,l+="</MenuSection>"},D=function(e){var t='<Separator Id="{0}" />';return t=String.format(t,e)},M=function(e){var t=new Sys.StringBuilder;t.append(String.format('<Menu Id="{0}"',e.Id)),e.MaxWidth&&t.append(String.format(' MaxWidth="{0}"',e.MaxWidth)),t.append(">");for(var n=0;n<e.MenuSectionList.length;n++){var i=e.MenuSectionList[n];i&&t.append(P(i))}return t.append("</Menu>"),t.toString()},P=function(e){if(!e.ControlList.length)return"";var t=new Sys.StringBuilder;return t.append("<MenuSection"),e.Id&&t.append(String.format(' Id="{0}"',e.Id)),e.DisplayMode&&t.append(String.format(' DisplayMode="{0}"',e.DisplayMode)),e.Title&&t.append(String.format(' Title="{0}"',e.Title)),e.TitleId&&t.append(String.format(' TitleId="{0}"',e.TitleId)),e.Theme&&t.append(String.format(' Theme="{0}"',e.Theme)),e.ShowMenuSectionSeparator||t.append(String.format(' ShowMenuSectionSeparator="{0}"',e.ShowMenuSectionSeparator)),e.ShowMenuSectionTitleIcon||t.append(String.format(' ShowMenuSectionTitleIcon="{0}"',e.ShowMenuSectionTitleIcon)),e.ShowMenuSectionTitleBackground||t.append(String.format(' ShowMenuSectionTitleBackground="{0}"',e.ShowMenuSectionTitleBackground)),e.MenuSectionTitleFocusable||t.append(String.format(' MenuSectionTitleFocusable="{0}"',e.MenuSectionTitleFocusable)),e.ControlsId?t.append(String.format('><Controls Id="{0}">',e.ControlsId)):t.append(">"),t.append(N(e.ControlList)),e.ControlsId&&t.append("</Controls>"),t.append("</MenuSection>"),t.toString()},F=function(e){var t=new Sys.StringBuilder;return e&&(t.append(String.format('<Button Id="{0}"',e.Id)),e.Command&&t.append(String.format(' Command="{0}"',e.Command)),e.CommandValueId&&t.append(String.format(' CommandValueId="{0}"',e.CommandValueId)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),e.MenuItemId&&t.append(String.format(' MenuItemId="{0}"',e.MenuItemId)),e.LabelCss&&t.append(String.format(' LabelCss="{0}"',e.LabelCss)),e.Image16by16Class&&t.append(String.format(' Image16by16="{0}" Image16by16Class="{1}"',e.Image16by16,e.Image16by16Class)),e.Image32by32Class&&t.append(String.format(' Image32by32="{0}" Image32by32Class="{1}"',e.Image32by32,e.Image32by32Class)),e.DisplayMode&&t.append(String.format(' DisplayMode="{0}"',e.DisplayMode)),e.Description&&t.append(String.format(' Description="{0}"',e.Description)),e.ImageBackColor&&t.append(String.format(' ImageBackColor="{0}"',e.ImageBackColor)),e.LabelTextUserGeneratedPlaceholderReplacements&&t.append(String.format(' LabelTextUserGeneratedPlaceholderReplacements="{0}"',e.LabelTextUserGeneratedPlaceholderReplacements)),e.KeyTip&&t.append(String.format(' Keytip="{0}"',e.KeyTip)),e.Alt&&t.append(String.format(' Alt="{0}"',e.Alt)),t.append("/>")),t.toString()},x=function(e){return e?A(e.Id,e.MenuItemId,e.Command,e.QueryCommand,e.LabelText,e.Alt,e.Image16by16Class,e.Visible,e.KeyTip,e.UpdateHtmlPostToggle,e.AriaLabel):null},R=function(e){var t=new Sys.StringBuilder;return e&&(t.append(String.format('<GalleryButton Id="{0}"',e.Id)),e.Command&&t.append(String.format(' Command="{0}"',e.Command)),e.QueryCommand&&t.append(String.format(' QueryCommand="{0}"',e.QueryCommand)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),e.VerticalCenterAlign&&t.append(String.format(' VerticalCenterAlign="{0}"',e.VerticalCenterAlign)),e.MenuItemId&&t.append(String.format(' MenuItemId="{0}"',e.MenuItemId)),e.Image&&t.append(String.format(' Image="{0}"',e.Image)),e.ImageClass&&t.append(String.format(' ImageClass="{0}"',e.ImageClass)),e.InnerHTML&&t.append(String.format(' InnerHTML="{0}"',e.InnerHTML)),e.Image||e.InnerHTML||t.append(' InnerHTML=""'),e.ShouldSetTitle&&t.append(String.format(' ShouldSetTitle="{0}"',e.ShouldSetTitle)),e.Alt&&t.append(String.format(' Alt="{0}"',e.Alt)),t.append("/>")),t.toString()},B=function(e){var t=new Sys.StringBuilder;if(e){t.append(String.format('<Gallery Id="{0}" Width="{1}" ElementDimensions="{2}">',e.Id,e.Width,e.ElementDimensions));for(var n=0;n<e.GalleryItems.length;n++)t.append(R(e.GalleryItems[n]));t.append("</Gallery>")}return t.toString()},L=function(e){var t,n=new Sys.StringBuilder;if(e){n.append(String.format('<ColorPicker Id="{0}" Width="{1}"',e.Id,e.Width)),e.McuLayout&&n.append(String.format(' McuLayout="{0}"',e.McuLayout.toString())),e.Command&&n.append(String.format(' Command="{0}"',e.Command)),e.QueryCommand&&n.append(String.format(' QueryCommand="{0}"',e.QueryCommand)),e.Stateful&&n.append(String.format(' Stateful="{0}"',e.Stateful)),n.append("><Colors>");for(var i=0;i<e.Colors.length;i++)n.append((t=e.Colors[i],String.format('<Color Color="{0}" Alt="{1}" DisplayColor="{2}"/>',t.Color,t.Alt,t.DisplayColor)));n.append("</Colors></ColorPicker>")}return n.toString()},N=function(e){for(var t,n=new Sys.StringBuilder,r=0;r<e.length;r++){var o=B((0,i.e)(h,e[r]));o?n.append(o):(o=(t=(0,i.e)(a.e,e[r]))?T(t.Id,t.MenuItemId,t.Command,t.QueryCommand,t.LabelText,t.Alt,t.KeyTip,t.UseUncheckedImage,t.CloseMenuWhenExecuted,t.IsChecked,t.CheckedImageClass,t.CheckedImage,t.UpdateHtmlPostToggle):null)?n.append(o):(o=x((0,i.e)(_.d,e[r])))?n.append(o):(o=F((0,i.e)(p.k,e[r])))?n.append(o):(o=L((0,i.e)(c,e[r])))?n.append(o):(o=U((0,i.e)(d.b,e[r])))?n.append(o):(o=O((0,i.e)(m,e[r])))&&n.append(o)}return n.toString()},U=function(e){var t=new Sys.StringBuilder;return e&&(t.append(String.format('<FlyoutAnchor Id="{0}" ',e.Id)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),e.Alt&&t.append(String.format(' Alt="{0}"',e.Alt)),e.KeyTip&&t.append(String.format(' Keytip="{0}"',e.KeyTip)),e.Command&&t.append(String.format(' Command="{0}"',e.Command)),e.QueryCommand&&t.append(String.format(' QueryCommand="{0}"',e.QueryCommand)),e.PopulateQueryCommand&&t.append(String.format(' PopulateDynamically="true" PopulateQueryCommand="{0}"',e.PopulateQueryCommand)),e.PopulateOnlyOnce&&t.append(String.format(' PopulateOnlyOnce="{0}"',e.PopulateOnlyOnce)),e.MenuOpenCommand&&t.append(String.format(' MenuOpenCommand="{0}"',e.MenuOpenCommand)),e.MenuCloseCommand&&t.append(String.format(' MenuCloseCommand="{0}"',e.MenuCloseCommand)),e.Image16by16Class&&t.append(String.format(' Image16by16="{0}" Image16by16Class="{1}"',e.Image16by16,e.Image16by16Class)),e.Image32by32Class&&t.append(String.format(' Image32by32="{0}" Image32by32Class="{1}"',e.Image32by32,e.Image32by32Class)),e.ImageIsVisible&&t.append(String.format(' ImageIsVisible="{0}"',e.ImageIsVisible)),e.ImageUsesSpaceWhileInvisible&&t.append(String.format(' ImageUsesSpaceWhileInvisible="{0}"',e.ImageUsesSpaceWhileInvisible)),t.append(">"),e.Menu&&t.append(M(e.Menu)),t.append("</FlyoutAnchor>")),t.toString()},O=function(e){var t=new Sys.StringBuilder;return e&&(t.append(String.format('<Label Id="{0}" ',e.Id)),e.LabelText&&t.append(String.format(' LabelText="{0}"',e.LabelText)),t.append("/>")),t.toString()}},function(e,t,n){"use strict";n.d(t,{k:function(){return r}});var i=n(208),r=function(){function e(){}return e.getInstance=function(t,n){return void 0===t&&(t=null),void 0===n&&(n=!1),e._singleton||(e.setInstance(otel.TelemetryFactoryGlobal.createInstance()),t&&t.length>0?(e._actionsTableNamePrefix="Office."+t+".Online.UserAction.",e._activityTableNamePrefix="Office."+t+".Online.Data.Activity."):(e._actionsTableNamePrefix="Office.Online.UserAction.",e._activityTableNamePrefix="Office.Online.Data.Activity."),e._oneTablePerUserActionEnabled=n),e._singleton},e.setInstance=function(t){if(!t)throw Error.argumentNull("telemetryLogger");e._singleton=t},e.sendTelemetryEvent=function(t){e.getInstance().sendTelemetryEvent(t)},e.containsTenantName=function(e){return e.indexOf("Office.")>=0},e.sendActivityEvent=function(t){t&&t.name&&(e.containsTenantName(t.name)||(t.name=e._activityTableNamePrefix+t.name)),e.getInstance().sendActivityEvent(t)},e.sendOtelEvent=function(t){e.getInstance().sendOtelEvent(t)},e.sendUserActionEvent=function(t){e._oneTablePerUserActionEnabled&&(!t||t.name&&t.name.length||t.actionName&&t.actionName.length>0&&(t.name=e._actionsTableNamePrefix+t.actionName)),e.getInstance().sendUserActionEvent(t)},e.sendTellMeUserActionEvent=function(t,n){void 0===n&&(n=""),t.name=e.getTellMeActivityName(t.actionName,n),e.sendUserActionEvent(t)},e.sendTellMeActivityEvent=function(t,n){void 0===n&&(n=""),t.name=e.getTellMeActivityName(t.name,n),e.sendActivityEvent(t)},e.getTellMeActivityName=function(e,t){return e&&e.length>0?"Office.TellMe."+t+e:"Office.TellMe."+t+"NoActionName"},e.addNamespaceMapping=function(t,n){e.getInstance().addNamespaceMapping(t,n)},e.setEnabledState=function(t){e.getInstance().setEnabledState(t)},e.registerEventHandler=function(t){e.getInstance().registerEventHandler(t)},e.shutdown=function(){return e.getInstance().shutdown()},e._singleton=null,e._actionsTableNamePrefix=null,e._activityTableNamePrefix=null,e._oneTablePerUserActionEnabled=!1,e}();(0,i.l)(r,"Telemetry",null,[])},function(e,t,n){"use strict";var i=n(508),r=n(208),o=n(205),a=n(813),s=n(70),l=n(600),u=n(267),c=n(255),p=n(254),d=n(872),h=n(427),g=n(574),m=n(830),_=n(733),f=n(344),y=n(425),v=n(296),S=n(134),C=n(268),b=n(288),A=n(861),T=n(753),w=n(345),I=n(209),E=(0,r.y)("IRootUserExt"),k=n(351),D=n(513),M=function(){function e(){}return e.prototype.pollForCommandState=function(e,t,n,i,r,o){var a=0;if(e){this.pollForEnabledDisabledControlState(e,n,r)&&(a|=1);var s=new d.f;s.CommandLocation=t,null!=o&&(s.InvocationMethod=o),!D.x(i)&&e.executeRootCommand(i,r,s)&&(a|=2)}return a},e.prototype.pollForEnabledDisabledControlState=function(e,t,n){if(void 0===n&&(n=null),e){if(p.AFrameworkApplication.appSettingsManager&&p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DynamicAddinCommandsEnableDisableControlsEnabled")){var i=e.isRootCommandEnabled(t);if(i&&"1402209562"===t&&!D.x(n)){var r=(0,k.e)(E,e);r&&(i=r.isRootCommandEnabledWithData(t,n))}return i}return e.isRootCommandEnabled(t)}return!1},e}();(0,r.l)(M,"RootPoller",null,[]);var P=n(946),F=n(586);n.d(t,{z:function(){return x}});var x=function(e){function t(t,n,i,o){var a=e.call(this,null,t,null,null)||this;return a._controls=null,a._unique=0,a._textDirection=0,a._isStaticUiTouchMode=!1,a._isSingleRowLayoutRibbon=!1,a._launchMenusUp=!1,a._controlWithFocus=null,a._activeControl=null,a._rootManager=null,a._rootPoller=null,a._controlIdPrefix="",a._resizableContainer=null,a.hiddenLabel=null,a._clientID=null,a._initializing=!0,a.supportsEmphasizedControls=!1,a.shouldHandleElementResize=!1,a.menuPositioningInfo=null,a.needScaling=!1,a.needRefresh=!1,a._rootUser=null,a._builder=null,a._events=null,a._menuLauncherStack=null,a._closeInProgress=!1,a._elmModalDiv=null,a._modalControllerStack=null,a._modalWithCaptureControllerStack=null,a._currentModalController=null,a._currentModalWithCaptureController=null,a._inBlockingMode=!1,a._disposed$1=!1,a._cookieDataVersion="",a._useDataCookie=!1,a._properties=null,a._pendingCloseMenuStackTimeoutId=-1,a._pendingCloseMenuStackLauncherIndex=-1,a.initRootMember(a),a._properties=n,a._controls={},a._unique=0,a._rootManager=i||I.f.get_instance(),a._resizableContainer=o,a._resizableContainer&&a._resizableContainer.add_onResize(r.i(a,a.onResize,"onResize")),D.x(n.TextDirection)||(a._textDirection="rtl"===n.TextDirection.toLowerCase()?1:0),a._rootManager.addRoot(a),a._rootPoller=new M,a}return(0,i.t)(t,e),t.prototype.get_rootManager=function(){return this._rootManager},t.prototype.get_clientID=function(){return this._clientID},t.prototype.set_clientID=function(e){return this._clientID=e,e},t.prototype.get_initializing=function(){return this._initializing},t.prototype.get_supportsInvisibleControls=function(){return!1},t.prototype.get_supportsDynamicDisplayMode=function(){return!1},t.prototype.get_isStaticUiTouchMode=function(){return this._isStaticUiTouchMode||this.get_touchModeForcedOn()},t.prototype.set_isStaticUiTouchMode=function(e){return this._isStaticUiTouchMode=e,e},t.prototype.get_isSingleRowLayoutRibbon=function(){return this._isSingleRowLayoutRibbon},t.prototype.set_isSingleRowLayoutRibbon=function(e){return this._isSingleRowLayoutRibbon=e,e},t.prototype.get_touchModeForcedOn=function(){return y.y.get_isIPad()||p.AFrameworkApplication.forceTouchRibbon},t.prototype.get_launchMenusUp=function(){return this._launchMenusUp},t.prototype.get_controls=function(){return this._controls},t.prototype.get_controlWithFocus=function(){return this._controlWithFocus},t.prototype.set_controlWithFocus=function(e){return this._controlWithFocus=e,e},t.prototype.get_controlIdPrefix=function(){return this._controlIdPrefix},t.prototype.set_controlIdPrefix=function(e){return this._controlIdPrefix=e,e},t.prototype.get_activeControl=function(){return this._activeControl},t.prototype.set_activeControl=function(e){return this._activeControl=e,e},t.prototype.ensureBehaviorAttached=function(){e.prototype.ensureBehaviorAttached.call(this),this.pollForStateAndUpdate()},t.prototype.registerControl=function(e){this._controls[e.get_id()]=e},t.prototype.getControlById=function(e){return this._controls[e]},t.prototype.getValidControl=function(e){var t=this.getControlById(e);return this._disposed$1||!t||t.get_disposed()||this.get_builder().isIdTrimmed(e)?null:t},t.prototype.refreshInternal=function(){e.prototype.refreshInternal.call(this),this._initializing=!1},t.prototype.ensureDOMElement=function(){e.prototype.ensureDOMElement.call(this),1===this.get_textDirection()&&P.n.ensureCSSClassOnElement(this.get_elementInternal(),"cui-rtl"),this.ensureHiddenLabel(),this.shouldHandleElementResize=!0},t.prototype.ensureHiddenLabel=function(){this.get_properties().LabelText&&!this.hiddenLabel&&(this.hiddenLabel=S.t.appendHiddenLabel(this.get_element(),this.get_id()+"-label",this.get_properties().LabelText))},t.prototype.refresh=function(){this.refreshInternal()},t.prototype.refreshOpenMenu=function(e){for(var t=0;t<this.get_menuStackDepth();t++){var n=this.get_menuLauncherStack()[t];if(n.get_id()===e)return n.refreshMenu(),!0}return!1},t.prototype.updateControl=function(e){e in this._controls&&this._controls[e].pollForStateAndUpdate()},t.prototype.commitAnyPendingChange=function(){this.get_controlWithFocus()&&this.get_controlWithFocus().commitPendingChange()},t.prototype.get_rootUser=function(){return this._rootUser},t.prototype.set_rootUser=function(e){return this._rootUser=e,e},t.prototype.get_builder=function(){return this._builder},t.prototype.set_builder=function(e){return this._builder=e,e},t.prototype.get_pollForState=function(){return!D.x(this._rootUser)},t.prototype.pollForCommandState=function(e,t,n,i){return this._rootPoller.pollForCommandState(this._rootUser,this.get_rootType(),e,t,n,i)},t.prototype.pollForStateAndUpdate=function(){this.pollForStateAndUpdateInternal()},t.prototype.pollForStateAndUpdateInternal=function(){this.set_lastPollTime(new Date),e.prototype.pollForStateAndUpdateInternal.call(this),this.ensureGlobalDisablingRemoved()},t.prototype.ensureGlobalDisablingRemoved=function(){P.n.setEnabledOnElement(this.get_elementInternal(),!0)},t.prototype.get_element=function(){return this.get_elementInternal()},t.prototype.get_cssClass=function(){return"cui-disabled"},t.prototype.get_textDirection=function(){return this._textDirection},t.prototype.getUniqueNumber=function(){return this._unique++},t.prototype.createMenuSection=function(e,t,n,i,r){return new w.z(this,e,t,n,i,r)},t.prototype.createMenu=function(e,t,n,i,r,o){return void 0===r&&(r=!1),void 0===o&&(o=1),new A.Menu(this,e,t,n,i,this._rootManager,r,o)},t.prototype.createGallery=function(e,t,n,i){return new b.p(this,e,t,n,i)},t.prototype.createControlComponent=function(e,t,n){return new C.r(this,e,t,n)},t.prototype.createMenuItem=function(e,t,n){return new T.m(this,e,t,n)},t.prototype.get_events=function(){return this._events||(this._events=new Sys.EventHandlerList),this._events},t.prototype.executeCommand=function(e,t,i,a,s,l,u){if(void 0===l&&(l=null),void 0===u&&(u=null),this.notifyMenuLaunchersCommandExecuted(i,s),s&&(r.r(o.u,this)&&r.r(C.r,i)&&(i.get_control().isMemberOfContextMenuDropDown()||i.get_control().get_isDefinitive())&&this.dismissAllTransientUI(),this.closeAllMenus(),r.r(n(153).Ribbon,this)&&r.r(C.r,i)&&i.get_control().get_isDefinitive()&&this.dismissTabPopup()),!D.x(this._rootUser)){var c=new d.f;c.CommandLocation=this.get_rootType(),c.InvocationMethod=a;for(var p=i;!D.x(p);){if(r.r(n(84).Tab,p)){c.CommandTabName=p.get_id();break}p=p.get_parent()}if(t&&r.r(C.r,i)){var h=i.get_control();h&&(!t.ParentMenuId&&h.get_stateProperties()&&h.get_stateProperties().ParentMenuId&&(t.ParentMenuId=h.get_stateProperties().ParentMenuId),!t.SqmControlId&&!t.SourceControlId&&h.get_controlProperties()&&h.get_controlProperties().Id&&(t.SqmControlId=h.get_controlProperties().Id))}this._rootUser.executeRootCommand(e,t,c,l,u)}},t.prototype.notifyMenuLaunchersCommandExecuted=function(e,t){if(this.get_menuLauncherStack()&&this.get_menuLauncherStack().length&&r.r(C.r,e)&&e.isMenuItem())for(var n=0;n<this.get_menuLauncherStack().length;n++)this.get_menuLauncherStack()[n].notifyCommandExecuted(e,t)},t.prototype.get_menuLauncherStack=function(){return this._menuLauncherStack},t.prototype.set_menuLauncherStack=function(e){return this._menuLauncherStack=e,e},t.prototype.get_menuStackDepth=function(){var e=this.get_menuLauncherStack();return D.x(e)?0:e.length},t.prototype.addMenuLauncherToStack=function(e){D.x(this.get_menuLauncherStack())&&this.set_menuLauncherStack([]),Array.add(this.get_menuLauncherStack(),e)},t.prototype.closeAllMenus=function(){return this.closeMenuStackAtIndex(0,!0)},t.prototype.closeMenuStack=function(e){this.closeMenuStackAtIndex(Array.indexOf(this.get_menuLauncherStack(),e),!0)},t.prototype.closeMenuStackAtIndex=function(e,n,i){void 0===i&&(i=!0);var o=!1;if(this.cancelPendingCloseMenuStack(),!D.x(this.get_menuLauncherStack()))if(n){if(!this._closeInProgress){this._closeInProgress=!0;for(var a=this.get_menuLauncherStack().length-1;a>=e;a--)this.get_menuLauncherStack()[a].closeMenu(i),Array.removeAt(this.get_menuLauncherStack(),a),o=!0,a||this.onMenuStackCleared();this._closeInProgress=!1}}else this._pendingCloseMenuStackLauncherIndex=e,this._pendingCloseMenuStackTimeoutId=window.setTimeout(r.i(this,this.closePendingMenuStack,"closePendingMenuStack"),t.closeMenuStackDelay);return o},t.prototype.clearMenuStack=function(e){if(!D.x(this.get_menuLauncherStack()))for(;this.get_menuLauncherStack().length>0;){var t=this.get_menuLauncherStack().length-1,n=this.get_menuLauncherStack()[t];if(Array.removeAt(this.get_menuLauncherStack(),t),this.get_menuLauncherStack().length||this.endModal(e,!1),n===e)return;n.closeMenu()}},t.prototype.closePendingMenuStack=function(){this.closeMenuStackAtIndex(this._pendingCloseMenuStackLauncherIndex,!0)},t.prototype.cancelPendingCloseMenuStack=function(){var e=this;this&&P.n.cancelPendingTimeout((0,l.m)((function(){return e._pendingCloseMenuStackTimeoutId}),(function(t){return e._pendingCloseMenuStackTimeoutId=t})))},t.prototype.onMenuStackCleared=function(){},t.prototype.beginModal=function(e,t,n){void 0===n&&(n=!1);var i=this.get_inModalMode(),r=this.get_modalDiv();i&&this._inBlockingMode||(D.x(this._modalControllerStack)&&(this._modalControllerStack=[]),Array.add(this._modalControllerStack,e),this._currentModalController=e,n&&!this._inBlockingMode&&(this._inBlockingMode=!0),i||(r.style.visibility="hidden",r.style.display="block",r.style.visibility="visible"),p.AFrameworkApplication.get_activeFrame().beginModal(t),r.style.zIndex=String(p.AFrameworkApplication.get_activeFrame().get_activeModalDivZIndex()))},t.prototype.beginModalWithCapture=function(e,t){c.ULS.sendTraceTag(20308505,207,50,"Begin Light Dismiss Modal using Capture");var n=this.get_inModalWithCaptureMode();D.x(this._modalWithCaptureControllerStack)&&(this._modalWithCaptureControllerStack=[]),Array.add(this._modalWithCaptureControllerStack,e),this._currentModalWithCaptureController=e,n||(_.z.get_instance().registerHandlerWithCaptureOption(g.d.pointerDown,window.document.body,r.i(this,this.onModalWithCapturePointerDown,"onModalWithCapturePointerDown"),!0),_.z.get_instance().registerHandlerWithCaptureOption(g.d.pointerUp,window.document.body,r.i(this,this.onModalWithCapturePointerUp,"onModalWithCapturePointerUp"),!0),_.z.get_instance().registerHandlerWithCaptureOption(g.d.pointerMove,window.document.body,r.i(this,this.onModalWithCapturePointerMove,"onModalWithCapturePointerMove"),!0),_.z.get_instance().registerHandlerWithCaptureOption(g.d.pointerOut,window.document.body,r.i(this,this.onModalWithCapturePointerOut,"onModalWithCapturePointerOut"),!0),h.s.get_instance().registerHandlerWithCaptureOption(g.d.click,window.document.body,r.i(this,this.onModalWithCaptureClick,"onModalWithCaptureClick"),null,!1,!0),m.p.get_instance().registerHandlerWithCaptureOption(g.d.get_mouseWheel(),window.document.body,r.i(this,this.onModalWithCaptureMouseWheel,"onModalWithCaptureMouseWheel"),null,!0)),p.AFrameworkApplication.get_activeFrame().beginModal(t)},t.prototype.get_inModalMode=function(){return!D.x(this._modalControllerStack)&&this._modalControllerStack.length>0},t.prototype.get_inModalWithCaptureMode=function(){return!D.x(this._modalWithCaptureControllerStack)&&this._modalWithCaptureControllerStack.length>0},t.prototype.isCurrentModalController=function(e){return e===this._currentModalController},t.prototype.endModal=function(e,t,n){if(void 0===n&&(n=!1),this.isCurrentModalController(e)){if(!this.get_inModalMode())throw Error.create("Cannot end modal mode because the Ribbon is not in Modal Mode");this._inBlockingMode&&!n||(n&&(this._inBlockingMode=!1),Array.removeAt(this._modalControllerStack,this._modalControllerStack.length-1),this._currentModalController=null,this._modalControllerStack.length>0&&(this._currentModalController=this._modalControllerStack[this._modalControllerStack.length-1]),p.AFrameworkApplication.get_activeFrame().endModal(t),this.get_modalDiv().style.zIndex=String(p.AFrameworkApplication.get_activeFrame().get_activeModalDivZIndex()),D.x(this._currentModalController)&&(this.get_modalDiv().style.display="none"))}},t.prototype.endModalWithCapture=function(e,t){if(c.ULS.sendTraceTag(20308506,207,50,"End Light Dismiss Modal using Capture"),e===this._currentModalWithCaptureController){if(!this.get_inModalWithCaptureMode())throw Error.create("Cannot end modal mode because the Control is not in Modal Mode");Array.removeAt(this._modalWithCaptureControllerStack,this._modalWithCaptureControllerStack.length-1),this._currentModalWithCaptureController=null,this._modalWithCaptureControllerStack.length>0&&(this._currentModalWithCaptureController=this._modalWithCaptureControllerStack[this._modalWithCaptureControllerStack.length-1]),D.x(this._currentModalWithCaptureController)&&(_.z.get_instance().unregisterHandlerWithCaptureOption(g.d.pointerDown,window.document.body,r.i(this,this.onModalWithCapturePointerDown,"onModalWithCapturePointerDown"),!0),_.z.get_instance().unregisterHandlerWithCaptureOption(g.d.pointerUp,window.document.body,r.i(this,this.onModalWithCapturePointerUp,"onModalWithCapturePointerUp"),!0),_.z.get_instance().unregisterHandlerWithCaptureOption(g.d.pointerMove,window.document.body,r.i(this,this.onModalWithCapturePointerMove,"onModalWithCapturePointerMove"),!0),_.z.get_instance().unregisterHandlerWithCaptureOption(g.d.pointerOut,window.document.body,r.i(this,this.onModalWithCapturePointerOut,"onModalWithCapturePointerOut"),!0),h.s.get_instance().unregisterHandlerWithCaptureOption(g.d.click,window.document.body,r.i(this,this.onModalWithCaptureClick,"onModalWithCaptureClick"),!1,!0),m.p.get_instance().unregisterHandlerWithCaptureOption(g.d.get_mouseWheel(),window.document.body,r.i(this,this.onModalWithCaptureMouseWheel,"onModalWithCaptureMouseWheel"),!0)),p.AFrameworkApplication.get_activeFrame().endModal(t)}},t.prototype.endBlockingModeKeepModal=function(){this._inBlockingMode=!1},t.prototype.get_modalDiv=function(){return D.x(this._elmModalDiv)&&(this._elmModalDiv=P.n.createElement("div"),this._elmModalDiv.setAttribute("id",t.modalDivId),P.n.ensureCSSClassOnElement(this._elmModalDiv,"cui-modalDiv"),P.n.setUnselectable(this._elmModalDiv,!0,!1),document.body.appendChild(this._elmModalDiv),_.z.get_instance().registerHandler(g.d.pointerDown,this._elmModalDiv,r.i(this,this.onModalPointerDown,"onModalPointerDown")),_.z.get_instance().registerHandler(g.d.pointerUp,this._elmModalDiv,r.i(this,this.onModalPointerUp,"onModalPointerUp")),_.z.get_instance().registerHandler(g.d.pointerMove,this._elmModalDiv,r.i(this,this.onModalPointerMove,"onModalPointerMove")),_.z.get_instance().registerHandler(g.d.pointerOut,this._elmModalDiv,r.i(this,this.onModalPointerOut,"onModalPointerOut")),h.s.get_instance().registerHandler(g.d.click,this._elmModalDiv,r.i(this,this.onModalClick,"onModalClick")),m.p.get_instance().registerHandler(g.d.get_mouseWheel(),this._elmModalDiv,r.i(this,this.onModalMouseWheel,"onModalMouseWheel"))),this._elmModalDiv},t.prototype.onModalPointerDown=function(e){return!D.x(this._currentModalController)&&this._currentModalController.onModalBodyPointerDown(e)},t.prototype.onModalPointerUp=function(e){return!D.x(this._currentModalController)&&this._currentModalController.onModalBodyPointerUp(e)},t.prototype.onModalPointerMove=function(e){return!D.x(this._currentModalController)&&this._currentModalController.onModalBodyPointerMove(e)},t.prototype.onModalPointerOut=function(e){return!D.x(this._currentModalController)&&this._currentModalController.onModalBodyPointerOut(e)},t.prototype.onModalClick=function(e){return!D.x(this._currentModalController)&&this._currentModalController.onModalBodyClick(e)},t.prototype.onModalMouseWheel=function(e){return!D.x(this._currentModalController)&&this._currentModalController.onModalBodyMouseWheel(e)},t.prototype.shouldHandleOnCapturePhase=function(e,t){return!(v.s.isDescendantOf(e,t)||D.x(this._currentModalWithCaptureController)||!D.x(this._currentModalController))},t.prototype.onModalWithCapturePointerDown=function(e){return!!this.shouldHandleOnCapturePhase(this.get_element(),e.get_sourceElement())&&this._currentModalWithCaptureController.onModalBodyPointerDown(e)},t.prototype.onModalWithCapturePointerUp=function(e){return!!this.shouldHandleOnCapturePhase(this.get_element(),e.get_sourceElement())&&this._currentModalWithCaptureController.onModalBodyPointerUp(e)},t.prototype.onModalWithCapturePointerMove=function(e){return!!this.shouldHandleOnCapturePhase(this.get_element(),e.get_sourceElement())&&this._currentModalWithCaptureController.onModalBodyPointerMove(e)},t.prototype.onModalWithCapturePointerOut=function(e){return!!this.shouldHandleOnCapturePhase(this.get_element(),e.get_sourceElement())&&this._currentModalWithCaptureController.onModalBodyPointerOut(e)},t.prototype.onModalWithCaptureClick=function(e){return!!this.shouldHandleOnCapturePhase(this.get_element(),e.get_sourceElement())&&this._currentModalWithCaptureController.onModalBodyClick(e)},t.prototype.onModalWithCaptureMouseWheel=function(e){return!!this.shouldHandleOnCapturePhase(this.get_element(),e.get_sourceElement())&&this._currentModalWithCaptureController.onModalBodyMouseWheel(e)},t.prototype.dismissAllTransientUI=function(){return this.closeAllMenus()},t.prototype.onResize=function(){this.shouldHandleElementResize&&(y.y.get_isAndroid()||this.dismissAllTransientUI())},t.prototype.dispose=function(){if(!this._disposed$1){this._disposed$1=!0;var t=this.get_elementInternal();D.x(t)||P.n.unregisterAllHandlers(t),this.shouldHandleElementResize=!1,this._resizableContainer&&(this._resizableContainer.remove_onResize(r.i(this,this.onResize,"onResize")),this._resizableContainer=null),this.hiddenLabel=null,D.x(this._elmModalDiv)||P.n.unregisterAllHandlers(this._elmModalDiv),this._rootManager.removeRoot(this),this._elmModalDiv=null,this._rootUser=null,this._builder=null,e.prototype.dispose.call(this)}},t.prototype.get_disposed=function(){return this._disposed$1},t.prototype.set_disposed=function(e){return this._disposed$1=e,e},t.prototype.get_cookieDataVersion=function(){return this._cookieDataVersion},t.prototype.set_cookieDataVersion=function(e){return this._cookieDataVersion=e,e},t.prototype.get_useDataCookie=function(){return this._useDataCookie},t.prototype.set_useDataCookie=function(e){return this._useDataCookie=e,e},t.prototype.storeDataCookie=function(e,t){e=this.get_cookieDataVersion()+e,f.r(e,t,7)},t.prototype.getDataCookieValue=function(e){return e=this.get_cookieDataVersion()+e,f.g(e)},t.prototype.get_properties=function(){return this._properties},t.prototype.setFlyoutCoordinates=function(e,t,n,i){return null},t.add_onSQMEventHandler=function(e){t._SQMEventSource.addHandler(t.sqmEventName,e)},t.remove_onSQMEventHandler=function(e){t._SQMEventSource.removeHandler(t.sqmEventName,e)},t.raiseSQMEvent=function(e){p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SqmCommandEventSourceEnabled")&&t._SQMEventSource.raiseEvent(t.sqmEventName,e)},t.unifiedHeaderHeightPx=48,t.tabRowHeightPx=30,t.singleRowLayoutTabRowHeightPx=24,t.closeMenuStackDelay=300,t.completeConstructionInterval=200,t.sqmEventName="SQMEvent",t._SQMEventSource=new F.f,t.modalDivId="ModalDiv",t}(u.s);(0,r.l)(x,"Root",u.s,[Sys.IDisposable,a.s,s.l])},function(e,t,n){var i=n(767),r=n(548),o=function(e){return function(t,n){var o,a,s=String(r(t)),l=i(n),u=s.length;return l<0||l>=u?e?"":void 0:(o=s.charCodeAt(l))<55296||o>56319||l+1===u||(a=s.charCodeAt(l+1))<56320||a>57343?e?s.charAt(l):o:e?s.slice(l,l+2):a-56320+(o-55296<<10)+65536}};e.exports={codeAt:o(!1),charAt:o(!0)}},function(e){var t=function(e){"use strict";var t,n=Object.prototype,i=n.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},o=r.iterator||"@@iterator",a=r.asyncIterator||"@@asyncIterator",s=r.toStringTag||"@@toStringTag";function l(e,t,n,i){var r=t&&t.prototype instanceof m?t:m,o=Object.create(r.prototype),a=new E(i||[]);return o._invoke=function(e,t,n){var i=c;return function(r,o){if(i===d)throw new Error("Generator is already running");if(i===h){if("throw"===r)throw o;return D()}for(n.method=r,n.arg=o;;){var a=n.delegate;if(a){var s=T(a,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===c)throw i=h,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=d;var l=u(e,t,n);if("normal"===l.type){if(i=n.done?h:p,l.arg===g)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(i=h,n.method="throw",n.arg=l.arg)}}}(e,n,a),o}function u(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=l;var c="suspendedStart",p="suspendedYield",d="executing",h="completed",g={};function m(){}function _(){}function f(){}var y={};y[o]=function(){return this};var v=Object.getPrototypeOf,S=v&&v(v(k([])));S&&S!==n&&i.call(S,o)&&(y=S);var C=f.prototype=m.prototype=Object.create(y);function b(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function A(e){var t;this._invoke=function(n,r){function o(){return new Promise((function(t,o){!function t(n,r,o,a){var s=u(e[n],e,r);if("throw"!==s.type){var l=s.arg,c=l.value;return c&&"object"==typeof c&&i.call(c,"__await")?Promise.resolve(c.__await).then((function(e){t("next",e,o,a)}),(function(e){t("throw",e,o,a)})):Promise.resolve(c).then((function(e){l.value=e,o(l)}),(function(e){return t("throw",e,o,a)}))}a(s.arg)}(n,r,t,o)}))}return t=t?t.then(o,o):o()}}function T(e,n){var i=e.iterator[n.method];if(i===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method))return g;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var r=u(i,e.iterator,n.arg);if("throw"===r.type)return n.method="throw",n.arg=r.arg,n.delegate=null,g;var o=r.arg;return o?o.done?(n[e.resultName]=o.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):o:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function E(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function k(e){if(e){var n=e[o];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,a=function n(){for(;++r<e.length;)if(i.call(e,r))return n.value=e[r],n.done=!1,n;return n.value=t,n.done=!0,n};return a.next=a}}return{next:D}}function D(){return{value:t,done:!0}}return _.prototype=C.constructor=f,f.constructor=_,f[s]=_.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,s in e||(e[s]="GeneratorFunction")),e.prototype=Object.create(C),e},e.awrap=function(e){return{__await:e}},b(A.prototype),A.prototype[a]=function(){return this},e.AsyncIterator=A,e.async=function(t,n,i,r){var o=new A(l(t,n,i,r));return e.isGeneratorFunction(n)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},b(C),C[s]="Generator",C[o]=function(){return this},C.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var i=t.pop();if(i in e)return n.value=i,n.done=!1,n}return n.done=!0,n}},e.values=k,E.prototype={constructor:E,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(I),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(i,r){return s.type="throw",s.arg=e,n.next=i,r&&(n.method="next",n.arg=t),!!r}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],s=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var l=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(l&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(l){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),g},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),g}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var i=n.completion;if("throw"===i.type){var r=i.arg;I(n)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,i){return this.delegate={iterator:k(e),resultName:n,nextLoc:i},"next"===this.method&&(this.arg=t),g}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}},function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var i=(0,n(208).y)("IRootManager")},function(e,t,n){"use strict";n.d(t,{s:function(){return p},l:function(){return d}});var i=n(614),r=n(254),o=n(973),a=n(427),s=n(574),l=n(66),u=n(749),c=n(134),p="btnToggleRibbon_Header",d=function(e){if(e){var t=document.createElement("div");t.id=p,t.className="cui-ctl-medium",t.title=CommonUIStrings.l_ToggleRibbonText;var n=o.createClusteredImage(40,20,m()?"Pill_Toggle_On_40x20x32":"Pill_Toggle_Off_40x20x32","",!0,null),i=document.createElement("span");i.id="btnToggleRibbonButton_Header",i.tabIndex=0,i.className="toggleButton-iconContainer",i.appendChild(n),i.setAttribute(c.t.ariaRoleAttribute,c.t.ariaButtonRole),i.setAttribute(c.t.ariaPressedAttribute,m()?c.t.ariaTrueValue:c.t.ariaFalseValue),i.setAttribute(c.t.ariaLabelledByAttribute,"btnToggleRibbonLabel_Header");var r=document.createElement("label");r.id="btnToggleRibbonLabel_Header",r.className="toggleButton-label",r.setAttribute("for","btnToggleRibbonButton_Header"),r.innerText=CommonUIStrings.l_ToggleRibbonText,t.appendChild(i),t.appendChild(r),e.appendChild(t),a.s.get_instance().registerHandler(s.d.click,i,g),u.KeyInputManager.get_instance().registerHandler(s.d.keyDown,i,h)}},h=function(e){return(e.innerEvent.keyCode===l.v.vK_Enter||e.innerEvent.keyCode===l.v.vK_Space)&&(r.AFrameworkApplication.get_theActionManager().processAction(i.Ct,2),!0)},g=function(e){return r.AFrameworkApplication.get_theActionManager().processAction(i.Ct,2),!0},m=function(){return!!r.AFrameworkApplication.get_activeFrame()&&r.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()}},,,,function(e,t,n){"use strict";n.r(t),n.d(t,{XMLHttpCrossDomainRequest:function(){return a}});var i=n(508),r=n(208),o=n(798),a=function(e){function t(){var t=e.call(this)||this;return t._request=null,t._request=new XMLHttpRequest,t._request.onreadystatechange=r.i(t,t.onReadyStateChange,"onReadyStateChange"),t}return(0,i.t)(t,e),t.prototype.get_contentType=function(){return this._request.getResponseHeader("Content-Type")},t.prototype.get_responseText=function(){return this._request.responseText},t.prototype.get_statusCode=function(){return this._request.status},t.prototype.get_statusText=function(){return this._request.statusText},t.prototype.abort=function(){this._request.abort()},t.prototype.getResponseHeader=function(e){return this._request.getResponseHeader(e)},t.prototype.send=function(e){this._request.send(e)},t.prototype.open=function(e,t){this._request.open(e,t,!0)},t.prototype.onReadyStateChange=function(){4===this._request.readyState&&this.onRequestCompleted()},t}(o.u);(0,r.l)(a,"XMLHttpCrossDomainRequest",o.u,[])},,,function(e,t,n){"use strict";n.d(t,{f:function(){return r}});var i=n(208),r=function(){return function(e){this.MessageId=e,this.SendTime=0,this.CorrelationId="",this.Values={}}}();(0,i.l)(r,"CrossDocumentMessage",null,[])},function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var i=(0,n(208).y)("IWordViewerPostMessenger")},function(e,t,n){"use strict";n.d(t,{t:function(){return r}});var i=n(208),r=function(){function e(){}return e.get_browserSupportsPerformanceMark=function(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.mark||null===window.performance.mark)},e.start=function(){e._outputElement||(e._outputElement=document.getElementById("perf-markers"),e._outputElement||(e._outputElement=document.createElement("div"),e._outputElement.id="perf-markers",e._outputElement.style.display="none",document.body.appendChild(e._outputElement)),e.mark(1),e.mark(4808),e.mark(4809))},e.isStarted=function(){return!!e._outputElement},e.stop=function(){e.mark(4807),e._outputElement=null},e.msWriteProfilerMark=function(e){window.self.msWriteProfilerMark&&window.self.msWriteProfilerMark(e)},e.mark=function(t){if(e._outputElement){var n=(new Date).format("MM/dd/yyyy HH:mm:ss.fffffff");e.exportToPerfMetricsDiv(t,n),e.get_browserSupportsPerformanceMark()&&window.performance.mark(t.toString())}},e.exportToPerfMetricsDiv=function(t,n){if(e._outputElement){var i=document.createElement("p"),r=document.createElement("span");r.className="time",r.innerText=n,i.appendChild(r);var o=document.createTextNode(" - ");i.appendChild(o);var a=document.createElement("span");a.className="marker",a.innerText=t.toString(),i.appendChild(a),e._outputElement.appendChild(i),e.msWriteProfilerMark(""+t)}},e._outputElement=null,e}();(0,i.l)(r,"PerfMetrics",null,[])},function(e){var t={}.hasOwnProperty;e.exports=function(e,n){return t.call(e,n)}},function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var i=(0,n(208).y)("IClickInputManager")},,,,,function(e,t,n){"use strict";n.r(t),n.d(t,{CompletableTask:function(){return s}});var i=n(508),r=n(742),o=n(594),a=n(208),s=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.SEsE=function(e){this.set_exception(o.C(e))},t.prototype.SEsA=function(e){this.set_exception(o.s(e))},t.prototype.SE=function(e){this.set_exception(e)},t.prototype.setResult=function(){this.setCompleted(!0)},t}(r.Task);(0,a.l)(s,"CompletableTask",r.Task,[])},function(e,t,n){"use strict";n.d(t,{p:function(){return o}});var i=n(586),r=n(208),o=function(){function e(){this.topRowControlsCreated=!1,this.standaloneRootControlManager=null,this._eventSource=new i.f}return e.prototype.add_onTopRowControlsCreated=function(e){this._eventSource.addHandler("OnTopRowControlsCreatedEvent",e)},e.prototype.remove_onTopRowControlsCreated=function(e){this._eventSource.removeHandler("OnTopRowControlsCreatedEvent",e)},e.prototype.add_onTopRowControlsDisposing=function(e){this._eventSource.addHandler("OnTopRowControlsDisposingEvent",e)},e.prototype.remove_onTopRowControlsDisposing=function(e){this._eventSource.removeHandler("OnTopRowControlsDisposingEvent",e)},e.prototype.add_onRenameTextboxStatusChanged=function(e){this._eventSource.addHandler("OnRenameTextboxStatusChangedEventKey",e)},e.prototype.remove_onRenameTextboxStatusChanged=function(e){this._eventSource.removeHandler("OnRenameTextboxStatusChangedEventKey",e)},e.prototype.get_topRowControlsCreated=function(){return this.topRowControlsCreated},e.prototype.get_standaloneRootControlManager=function(){return this.standaloneRootControlManager},e.prototype.raiseTopRowControlsCreatedEvent=function(e,t){void 0===t&&(t=null),this.topRowControlsCreated=!0,this.standaloneRootControlManager=e,this._eventSource.raiseEvent("OnTopRowControlsCreatedEvent",t)},e.prototype.raiseOnTopRowControlsDisposingEvent=function(){this.topRowControlsCreated=!1,this._eventSource.raiseEvent("OnTopRowControlsDisposingEvent")},e.prototype.raiseRenameTextboxStatusChangedEvent=function(e){this._eventSource.raiseEvent("OnRenameTextboxStatusChangedEventKey",e?"true":"false")},e}();(0,r.l)(o,"HeaderEventSource",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(208),r=n(15),o=(0,i.y)("IActionManager"),a=n(809),s=n(255),l=n(508),u=function(){function e(t,n){this.actionId=0,this.behavior=0,this.reportingData=null,i.m(this,e.$$(t,n)),this.context=i.c(i.f(this,"Common.AActionArgs$2").TContext),this.actionData=i.c(i.f(this,"Common.AActionArgs$2").TData)}return e.$$=function(t,n){var r="AActionArgs$2$"+t.getName()+"$"+n.getName(),o=i.x(r);return o||i.u(r,"Common.AActionArgs$2",e,[{TContext:t},{TData:n}],null,[])},e}(),c=function(e){function t(n,r){var o=e.call(this,n,r)||this;return i.m(o,t.$$(n,r)),o}return(0,l.t)(t,e),t.$$=function(e,n){var r="ActionArgs$2$"+e.getName()+"$"+n.getName(),o=i.x(r);return o||i.u(r,"Common.ActionArgs$2",t,[{TContext:e},{TData:n}],u.$$(e,n),[])},t}(u),p=function(e){function t(n){var r=e.call(this,n,Object)||this;return i.m(r,t.$$(n)),r}return(0,l.t)(t,e),t.$$=function(e){var n="ActionArgs$1$"+e.getName(),r=i.x(n);return r||i.u(n,"Common.ActionArgs$1",t,[{TContext:e}],c.$$(e,Object),[])},t}(c),d=function(){return function(){this.defaultActionDataGenerator=null,this.flags=[],this.handlers=[],this.asyncHandlers=[]}}();(0,i.l)(d,"ActionMetadata",null,[]);var h=n(467),g=function(e){function t(){var t=e.call(this)||this;return t._stage=0,t._actionManager=null,t}return(0,l.t)(t,e),t.prototype.run=function(){if(this._stage||(this._actionManager.beforeAction(this.get_childOperation()),this._stage=1),1===this._stage){if(this.get_childOperation().run(),this.get_childOperation().get_hasYielded())return;this._stage=2}2===this._stage&&(this._actionManager.afterAction(this.get_childOperation()),this.get_childOperation().recycle(),this.setIsCompleted(),this.recycle())},t.prototype.recycle=function(){e.prototype.recycle.call(this),Array.add(t._instances,this)},t.registerInstance=function(e,n){var i,r=t._instances.length;return r?(i=t._instances[r-1],Array.removeAt(t._instances,r-1)):i=new t,i.init(e),i.setDebugName("ActionNotificationOperation"),i._stage=0,i._actionManager=n,i},t._instances=[],t}(h.k);(0,i.l)(g,"ActionNotificationOperation",h.k,[]);var m=function(e){function t(n,r){var o=e.call(this,n,r)||this;return o.parentOperation=null,i.m(o,t.$$(n,r)),o}return(0,l.t)(t,e),t.$$=function(e,n){var r="AsyncActionArgs$2$"+e.getName()+"$"+n.getName(),o=i.x(r);return o||i.u(r,"Common.AsyncActionArgs$2",t,[{TContext:e},{TData:n}],u.$$(e,n),[])},t}(u),_=function(e){function t(n){var r=e.call(this,n,Object)||this;return i.m(r,t.$$(n)),r}return(0,l.t)(t,e),t.$$=function(e){var n="AsyncActionArgs$1$"+e.getName(),r=i.x(n);return r||i.u(n,"Common.AsyncActionArgs$1",t,[{TContext:e}],m.$$(e,Object),[])},t}(m),f=n(816),y=function(e){function t(){var t=e.call(this)||this;return t._actionResultCallback=null,t._callbackUserData=null,t._stage=0,t._currentIndex=0,t}return(0,l.t)(t,e),t.prototype.recycle=function(){e.prototype.recycle.call(this),Array.add(t._instances,this)},t.prototype.run=function(){if(1===this._stage){if(1===this.processCurrentOperation())return;for(var e=this._actionManager.get_applicationContextCollection().length,t=this._currentIndex;t<e;t++){var i=this._actionManager.get_applicationContextCollection()[t];if(this._currentIndex=t+1,this.setCurrentOperationFromContext(i),1===this.processCurrentOperation())return;if(this.get_timeoutExceeded()&&t!==e-1)return void this.yield()}this._stage=3}3===this._stage&&(this.set_response(n(722).ActionManager.mergeResponses(this.get_response(),2)),this.setIsCompleted(),!this.get_isSynchronous()&&this._actionResultCallback&&this._actionResultCallback(this,this._callbackUserData))},t.registerInstance=function(e,n,i,r,o,a,s,l,u){var c,p=t._instances.length;return p?(c=t._instances[p-1],Array.removeAt(t._instances,p-1)):c=new t,c.init(n),c.setDebugName("ProcessActionOperation"),c.initAction(e,i,r,o,a,u),c._actionResultCallback=s,c._callbackUserData=l,c._stage=1,c._currentIndex=0,c._actionManager=e,c},t._instances=[],t}(f.g);(0,i.l)(y,"ProcessActionOperation",f.g,[]);var v=n(653),S=n(818),C=function(){return function(){this.dataValue1=0,this.dataValue2=0}}();(0,i.l)(C,"ReportingData",null,[]);var b=n(896),A=n(195);n.d(t,{ActionManager:function(){return T}});var T=function(){function e(e){void 0===e&&(e=null),this._invocationMethod=0,this.commandLocation=0,this._commandTabName=null,this._actionsWithoutHandlers=null,this._applicationFeatureHelperFuture=null,this.contextRegistrationValidator=null,this.$$pf_Mode=0,this.$$pf_IsOffline=!1,this.throttlingManager=null,this._actionCollection=[],this._actionDepth=[],this._applicationContextCollection=[],this._listeners=[],this.set_mode(3),this.set_isOffline(!1),this._actionsWithoutHandlers={},this._applicationFeatureHelperFuture=e}return e.prototype.get_mode=function(){return this.$$pf_Mode},e.prototype.set_mode=function(e){return this.$$pf_Mode=e,e},e.prototype.get_isOffline=function(){return this.$$pf_IsOffline},e.prototype.set_isOffline=function(e){return this.$$pf_IsOffline=e,e},e.prototype.get_commandLocation=function(){return this.commandLocation},e.prototype.set_commandLocation=function(e){return this.commandLocation=e,e},e.prototype.get_invocationMethod=function(){return this._invocationMethod},e.prototype.set_invocationMethod=function(e){return this._invocationMethod=e,e},e.prototype.get_commandTabName=function(){return this._commandTabName},e.prototype.set_commandTabName=function(e){return this._commandTabName=e,e},e.prototype.get_applicationContextCollection=function(){return this._applicationContextCollection},e.prototype.registerApplication=function(e){Array.add(this._applicationContextCollection,e)},e.prototype.logUnhandledKeyboardActions=function(){b.f(this._actionsWithoutHandlers).length>0&&(s.ULS.sendTraceTag(23658528,306,15,"Unhandled actions: {0}",JSON.stringify(this._actionsWithoutHandlers)),this._actionsWithoutHandlers=null)},e.prototype.logUnhandledAction=function(e){var t=e.toString();if(t in this._actionsWithoutHandlers){var n=this._actionsWithoutHandlers[t];this._actionsWithoutHandlers[t]=n+1}else this._actionsWithoutHandlers[t]=1},e.prototype.unregisterApplication=function(e){Array.remove(this._applicationContextCollection,e)},e.prototype.registerListener=function(e){Array.add(this._listeners,e)},e.prototype.unregisterListener=function(e){Array.remove(this._listeners,e)},e.prototype.addAction=function(e,t,n){this.registerAction(e,t,n,null)},e.prototype.removeAction=function(e,t,n){this.unregisterAction(e,t,n,null)},e.prototype.validateContextRegistration=function(e,t){},e.prototype.validateContextType=function(e,t){},e.prototype.validateActionDataType=function(e,t){},e.prototype.addActionForContext=function(e,t,n,i){this.registerAction(t,n,(function(t,n,r,o,s){return i((0,a.m)(new p(e),{actionId:t,context:n,behavior:r,reportingData:o,actionData:s}))}),null)},e.prototype.addActionForContextAndData=function(e,t,n,i,r){this.registerAction(n,i,(function(n,i,o,s,l){return r((0,a.m)(new c(e,t),{actionId:n,context:i,behavior:o,reportingData:s,actionData:l}))}),null)},e.prototype.addActionWithFlags=function(e,t,n,i){this.registerAction(e,t,n,null),this.setActionFlags(e,i)},e.prototype.addAsyncAction=function(e,t,n){this.registerAction(e,t,null,n)},e.prototype.addAsyncActionForContext=function(e,t,n,i){this.registerAction(t,n,null,(function(t,n,r,o,s,l){return i((0,a.m)(new _(e),{parentOperation:t,actionId:n,context:r,behavior:o,reportingData:s,actionData:l}))}))},e.prototype.addAsyncActionForContextAndData=function(e,t,n,i,r){this.registerAction(n,i,null,(function(n,i,o,s,l,u){return r((0,a.m)(new m(e,t),{parentOperation:n,actionId:i,context:o,behavior:s,reportingData:l,actionData:u}))}))},e.prototype.addAsyncActionWithFlags=function(e,t,n,i){this.registerAction(e,t,null,n),this.setActionFlags(e,i)},e.prototype.setActionFlags=function(e,t){if(0!==t){this._actionCollection[e]||(this._actionCollection[e]=new d);for(var n=this._actionCollection[e],i=1;i<=t;i*=2)t&i&&(n.flags[i]=!0)}},e.prototype.setActionDataGenerator=function(e,t){this._actionCollection[e].defaultActionDataGenerator=t},e.prototype.processAction=function(e,t,n){void 0===n&&(n=null);var i=null;return this._actionCollection[e]&&this._actionCollection[e].defaultActionDataGenerator&&(i=this._actionCollection[e].defaultActionDataGenerator()),this.processActionWithData(e,t,i,n)},e.prototype.processActionAsync=function(e,t,n,i,r,o){void 0===o&&(o=null);var a=null;return this._actionCollection[t]&&this._actionCollection[t].defaultActionDataGenerator&&(a=this._actionCollection[t].defaultActionDataGenerator()),this.processActionWithDataAsync(e,t,n,a,i,r,null)},e.prototype.processActionWithDataInternal=function(t,n,i,r,o,a,s,l){if(n===e.nullAction)return 2;if(!this._actionCollection[n])return this._actionsWithoutHandlers&&2===i&&6===this.get_commandLocation()&&this.logUnhandledAction(n),2;var u=this.getActionMetadata(n);if(u.flags[16]&&this.throttlingManager&&!this.throttlingManager.get_shouldRunThrottledAction())return 2;var c=g.registerInstance(t,this);c.set_isSynchronous(l);var p=y.registerInstance(this,c,n,i,new C,r,a,s,o);if(c.run(),u.flags[16]&&this.throttlingManager){var d=+c.get_endTime()-+c.get_startTime();this.throttlingManager.recordThrottledActionTime(d)}return p.get_response()},e.prototype.processActionWithData=function(e,t,n,i){return void 0===i&&(i=null),this.processActionWithDataInternal(null,e,t,n,i,null,null,!0)},e.prototype.processActionWithDataAsync=function(e,t,n,i,r,o,a){return void 0===a&&(a=null),this.processActionWithDataInternal(e,t,n,i,a,r,o,!1)},e.prototype.processContextSet=function(e,t,n,i,r,o,a){void 0===a&&(a=null);var s=g.registerInstance(null,this);s.set_isSynchronous(!0);var l=S.ProcessContextSetOperation.registerInstance(this,s,e,t,n,i,r,o,a);return s.run(),l.get_response()},e.prototype.processContextSetAsync=function(e,t,n,i,r,o,a,s){void 0===s&&(s=null);var l=g.registerInstance(e,this),u=S.ProcessContextSetOperation.registerInstance(this,l,t,n,i,r,o,a,s);return l.run(),u.get_response()},e.prototype.processActionAgainstContext=function(e,t,n,i,r,o,a){if(void 0===a&&(a=null),!e)return 8;if(e.get_isContextSet())return this.processContextSet(e,t,n,i,r,o,a);var s=g.registerInstance(null,this);s.set_isSynchronous(!0);var l=v.ProcessContextOperation.registerInstance(this,s,e,t,n,i,r,o,a);return s.run(),l.get_response()},e.prototype.processActionAgainstContextAsync=function(e,t,n,i,r,o,a,s){if(!t)return 8;if(t.get_isContextSet())return this.processContextSetAsync(e,t,n,i,r,o,a,s);var l=g.registerInstance(e,this),u=v.ProcessContextOperation.registerInstance(this,l,t,n,i,r,o,a,s);return l.run(),u.get_response()},e.prototype.removeActionIfFeatureIsDisabled=function(e,t,n,i,r,o){var a=this;void 0===o&&(o=null),this._applicationFeatureHelperFuture&&this._applicationFeatureHelperFuture.execute((function(s){s.isFeatureEnabled(e,t).then((function(e){return e||(a.removeAction(n,i,r),o&&o(n)),null}))}))},e.prototype.beforeAction=function(t){var i=t.get_actionId();1!==t.get_behavior()&&n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LoggingActionsEnabled")&&e.logActionForAutomation(i),this._actionDepth[i]?this._actionDepth[i]++:(this.notifyOnBeforeAction(t),this._actionDepth[i]=1)},e.prototype.afterAction=function(e){var t=e.get_actionId();this._actionDepth[t]--,this._actionDepth[t]||(this.set_invocationMethod(0),this.set_commandLocation(0),this.set_commandTabName(null),e.get_response()>1&&this.notifyOnAfterAction(e),2!==e.get_behavior()||32!==e.get_response()&&4!==e.get_response()||!this.getActionMetadata(t).flags[256]||A.v.get_instance().consentGiven(),delete this._actionDepth[t])},e.prototype.registerAction=function(e,t,n,i){this._actionCollection[e]||(this._actionCollection[e]=new d);var r=this._actionCollection[e];n?r.handlers[t]=n:r.asyncHandlers[t]=i},e.prototype.unregisterAction=function(e,t,i,r){if(this._actionCollection[e]){var o=this._actionCollection[e];o.handlers[t]===i?o.handlers[t]=null:o.asyncHandlers[t]===r&&(o.asyncHandlers[t]=null),n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CleanActionFlagsIsEnabled")&&(o.flags=[])}},e.prototype.notifyOnBeforeAction=function(e){for(var t=0;t<this._listeners.length;t++)this._listeners[t].onBeforeAction(e)},e.prototype.notifyOnAfterAction=function(e){for(var t=0;t<this._listeners.length;t++)this._listeners[t].onAfterAction(e)},e.prototype.getActionMetadata=function(e){return this._actionCollection[e]},e.prototype.dumpActionsToLog=function(){},e.logActionForAutomation=function(e){var t=document.getElementById("ActionLog");t||((t=document.createElement("div")).id="ActionLog",t.style.display="none",document.body.appendChild(t));var n=document.createElement("div");n.innerText=e.toString(),t.appendChild(n)},e.actionIdResolver=function(t){return e.actionIdResolverDelegate(t)},e.contextIdResolver=function(t){return e.contextIdResolverDelegate(t)},e.nullIdResolver=function(e){return null},e.doNothing=function(e,t,n,i,r){return 32},e.doNothingButReport=function(e,t,n,r,o){if(i.r(C,o)){var a=o;r.dataValue1=a.dataValue1,r.dataValue2=a.dataValue2}return 32},e.mergeResponses=function(e,t){return t>e?t:e},e.doNothingHandler=e.doNothing,e.doNothingButReportHandler=e.doNothingButReport,e.nullAction=null,e.emptyActionId=371857150,e.actionIdResolverDelegate=e.nullIdResolver,e.contextIdResolverDelegate=e.nullIdResolver,e}();(0,i.l)(T,"ActionManager",null,[r.v,o])},function(e,t,n){"use strict";var i=n(208),r=n(58),o=n(121),a=n(978),s=n(242),l=n(255),u=n(889),c=n(620),p=n(478),d=n(810),h=n(337),g=n(863),m=n(684),_=n(851),f=n(154),y=n(644),v=function(){function e(){this.noOpenConnectionCount=0,this.invokeCount=0,this.invokeSentCount=0,this.invokeFailedCount=0,this.invokeTimeoutCount=0,this.succeededCount=0,this.failedCount=0,this.timeoutCount=0,this.synchronousNotificationCount=0,this.responseNotAvailableIds=null}return e.prototype.get_responseNotAvailableIds=function(){return this.responseNotAvailableIds},e.prototype.reset=function(){this.noOpenConnectionCount=0,this.invokeCount=0,this.invokeSentCount=0,this.invokeFailedCount=0,this.invokeTimeoutCount=0,this.succeededCount=0,this.failedCount=0,this.timeoutCount=0,this.synchronousNotificationCount=0,this.responseNotAvailableIds=null},e.prototype.addToResponseNotAvailableIds=function(e){this.get_responseNotAvailableIds()||(this.responseNotAvailableIds=new y.c(Number)),!this.get_responseNotAvailableIds().contains(e)&&this.get_responseNotAvailableIds().get_count()<50&&this.get_responseNotAvailableIds().add(e)},e.prototype.generateLogDictionary=function(){var e={};return e.NoOpenConnectionCount=this.noOpenConnectionCount,e.InvokeCount=this.invokeCount,e.InvokeSentCount=this.invokeSentCount,e.InvokeFailedCount=this.invokeFailedCount,e.InvokeTimeoutCount=this.invokeTimeoutCount,e.SucceededCount=this.succeededCount,e.FailedCount=this.failedCount,e.TimeoutCount=this.timeoutCount,e.SynchronousNotificationCount=this.synchronousNotificationCount,e},e}();(0,i.l)(v,"ClientRequestManagerTelemetryStorage",null,[]);var S=n(469),C=n(73),b=n(508),A=(0,i.y)("IClientRequestManagerEventArgs"),T=function(e){function t(t){var n=e.call(this)||this;return n._data=null,n._data=t,n}return(0,b.t)(t,e),t.prototype.get_data=function(){return this._data},t}(Sys.EventArgs);(0,i.l)(T,"RequestFailedEventArgs",Sys.EventArgs,[A]);var w=function(e){function t(t){var n=e.call(this)||this;return n._data=null,n._data=t,n}return(0,b.t)(t,e),t.prototype.get_data=function(){return this._data},t}(Sys.EventArgs);(0,i.l)(w,"RequestInvokedEventArgs",Sys.EventArgs,[A]);var I=n(785),E=function(){function e(e,t){void 0===t&&(t=!1),this.args=null,this.succeeded=!1,this.args=e,this.succeeded=t}return e.prototype.get_args=function(){return this.args},e}();(0,i.l)(E,"RequestManagerResponse",null,[]);n(677);var k=function(e){function t(t){var n=e.call(this)||this;return n._data=null,n._data=t,n}return(0,b.t)(t,e),t.prototype.get_data=function(){return this._data},t}(Sys.EventArgs);(0,i.l)(k,"RequestSucceededEventArgs",Sys.EventArgs,[A]);var D=n(425),M=n(550),P=function(){function e(e,t){this._iframe=null,this._parent=null,this._onAfterSignInCallback=null,this._parent=e,this._onAfterSignInCallback=t,this._iframe=document.createElement("iframe"),this._iframe.className="WACSigninFrame";var r=new m.QueryStringBuilder("Signin.aspx");n(254).AFrameworkApplication.addCommonUrlParameters(r),this._iframe.src=r.toString(),this._parent.appendChild(this._iframe),M.n.addHandler(this._iframe,"load",i.i(this,this.onSigninFrameLoad,"onSigninFrameLoad"))}return e.prototype.dispose=function(){this._parent.removeChild(this._iframe),M.n.removeHandler(this._iframe,"load",i.i(this,this.onSigninFrameLoad,"onSigninFrameLoad")),this._iframe=null,this._parent=null},e.prototype.onSigninFrameLoad=function(e){try{this._onAfterSignInCallback(this._iframe.contentWindow.document.URL),this.dispose()}catch(e){}},e.prototype.logSignInFrameResponse=function(){var e=this._iframe.contentWindow.document.body;D.y.get_isInternetExplorerNonEdge()?e.innerText:e.innerHTML},e}();(0,i.l)(P,"SigninFrame",null,[Sys.IDisposable]);var F=n(460),x=n(482),R=n(111),B=n(419),L=n(796),N=n(586),U=n(556);n.d(t,{h:function(){return O}});var O=function(){function e(e,t,n,i,r,o,a,s,l,u){this._requests=null,this._lastRequestId=0,this._openConnections=0,this._firstConsecutiveFailureResponseTime=null,this._defaultSentTimeoutMs=0,this._defaultQueueTimeoutMs=0,this._taskManager=null,this._stopwatchBuilder=null,this._nonAuthedUrls=null,this._nonDCSpecificUrls=null,this._userSessionId=null,this._signInFrame=null,this._wacClusterId=null,this._consecutive403ErrorCount=0,this._consecutive403ErrorStart=0,this._silentAuthFailedWithError=!1,this._isConsecutive403ErrorOccurredEventRaised=!1,this._eventSource=null,this._getBooleanAppSetting=null,this._offlineLogger=null,this._markWebRequestOnTimelineIsEnabled=!1,this.telemetryStorage=null,this.lastResponseTime=null,this.isNetworkOffline=!1,this.lastCorrelationId=null,this.$$pf_MaxConnections=0,this.$$pf_WacUserAgent=null,this._networkConnectivityListeners=[],this._requestStatusListeners=[],this._machineIds={},this._onNextSilentAuthCallbacks=[],this._onBeforeRemoveRequestCallbacks=[],this._requestsFailedWith403Error={},this._requests=new g.j,this._userSessionId=e,this._stopwatchBuilder=l,this.set_maxConnections(t),this._defaultQueueTimeoutMs=n,this._defaultSentTimeoutMs=i,this._taskManager=r,this._nonAuthedUrls=o,this._nonDCSpecificUrls=s,this.lastResponseTime=new Date,this._eventSource=new N.f,this.telemetryStorage=new v,this._getBooleanAppSetting=a,this._offlineLogger=u,this._markWebRequestOnTimelineIsEnabled=this._getBooleanAppSetting("MarkWebRequestOnTimelineIsEnabled")}return e.prototype.add_consecutive403ErrorOccurred=function(e){this._eventSource.addHandler("C403EOEK",e)},e.prototype.remove_consecutive403ErrorOccurred=function(e){this._eventSource.removeHandler("C403EOEK",e)},e.prototype.get_telemetryStorage=function(){return this.telemetryStorage},e.prototype.get_userSessionId=function(){return this._userSessionId},e.prototype.set_userSessionId=function(e){if(this._userSessionId)throw Error.invalidOperation("User session id is already set");return this._userSessionId=e,e},e.prototype.get_defaultSentTimeoutMs=function(){return this._defaultSentTimeoutMs},e.prototype.get_lastResponseTime=function(){return this.lastResponseTime},e.prototype.get_isNetworkOffline=function(){return this.isNetworkOffline},e.prototype.get_lastCorrelationId=function(){return this.lastCorrelationId},e.prototype.get_maxConnections=function(){return this.$$pf_MaxConnections},e.prototype.set_maxConnections=function(e){return this.$$pf_MaxConnections=e,e},e.prototype.get_hasAvailableConnections=function(){return this._openConnections<this.get_maxConnections()},e.prototype.get_timeToWaitAfterLastKeyStroke=function(){return this._taskManager.get_timeToWaitAfterLastKeyStroke()},e.prototype.set_timeToWaitAfterLastKeyStroke=function(e){return this._taskManager.set_timeToWaitAfterLastKeyStroke(e),e},e.prototype.get_machineIds=function(){var e=new Sys.StringBuilder,t=!1,n=this._machineIds;for(var i in n){var r={key:i,value:n[i]};t&&e.append(",");var o=r.key;o&&(t=!0,e.append(o))}return e.toString()},e.prototype.get_wacClusterId=function(){return this._wacClusterId},e.prototype.set_wacClusterId=function(e){return this._wacClusterId=e,e},e.prototype.get_wacUserAgent=function(){return this.$$pf_WacUserAgent},e.prototype.set_wacUserAgent=function(e){return this.$$pf_WacUserAgent=e,e},e.prototype.get_requestQueueLength=function(){return this._requests.get_length()},e.prototype.sendShuttingDownRequest=function(t,i){var r=!n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DisableFetchKeepAliveOnShutdown")&&D.y.browserSupportsFetchKeepAlive(),o=!r&&D.y.browserSupportsSendBeacon(),a=r?"f":o?"b":"x";if(window.console&&window.console.log&&t){var s=window.console;new Date;s.log("SendShuttingDownRequest: "+t+"; requestApi: "+a)}var l=new m.QueryStringBuilder(t);if(this.get_userSessionId()&&l.addOrReplaceParam(n(254).AFrameworkApplication.userSessionIdQueryParam,this.get_userSessionId()),n(254).AFrameworkApplication.buildVersion&&l.addOrReplaceParam(e.officeVersionQueryParam,n(254).AFrameworkApplication.buildVersion),this._wacClusterId&&!this.shouldSkipDCSpecificRequest(t)&&l.addOrReplaceParam(e.wacClusterQsName,this._wacClusterId),n(254).AFrameworkApplication.userType&&l.addOrReplaceParam(e.userTypeQsName,n(254).AFrameworkApplication.userType),n(254).AFrameworkApplication.isLoggingHostRequests&&l.addOrReplaceParam(e.logHostRequestsQueryParam,"1"),n(254).AFrameworkApplication.canary&&l.addOrReplaceParam(e.canaryQueryParam,n(254).AFrameworkApplication.canary),this.isAuthedRequest(t)&&(l.addOrReplaceParam(n(254).AFrameworkApplication.accessTokenParamName,n(254).AFrameworkApplication.get_accessToken()),l.addOrReplaceParam(n(254).AFrameworkApplication.accessTokenTtlParamName,n(254).AFrameworkApplication.get_accessTokenTtl().toString())),l.addOrReplaceParam(e.requestApiQueryParam,a),t=l.toString(),r){var u={};u.body=i,u.keepalive=!0,u.method="POST",window.fetch(t,u)}else o?window.navigator.sendBeacon(t,i):this.addRequestInternal(t,2,i,null,[],!1,0,null,null,null,"",!0,null,null,null,null,!1,null,!0)},e.prototype.addRequest=function(e,t,n,i,r,o,a,s,l,u,c,p,d,h,g,m,_,f,y){return void 0===u&&(u=null),void 0===c&&(c=!1),void 0===p&&(p=null),void 0===d&&(d=null),void 0===h&&(h=null),void 0===g&&(g=null),void 0===m&&(m=!1),void 0===_&&(_=null),void 0===f&&(f=!1),void 0===y&&(y=null),this.addRequestInternal(e,t,n,i,y||[],r,o,a,s,l,u||"",c,p,d,h,g,m,_,f)},e.prototype.addRequestWithTaskAndStopWatch=function(e,t,n,i,r,o,a,l,u,c,p,d,h,g,m,_){void 0===u&&(u=null),void 0===c&&(c=!1),void 0===p&&(p=null),void 0===d&&(d=null),void 0===h&&(h=null),void 0===g&&(g=null),void 0===m&&(m=!1),void 0===_&&(_=null);var f=null;l&&(f=this._stopwatchBuilder.get_value().makeAndStartStopwatch("WebServiceCall",l));var y=new s.z(E);try{this.addRequestInternal(e,t,n,i,[],r,o,(function(e){f&&f.stop(),y.setResult(new E(e,!0))}),(function(e){f&&f.stop(),y.setResult(new E(e,!1))}),a,u||"",c,p,d,h,g,m)}catch(e){y.trySetException(e)}return y.get_task()},e.prototype.addSynchronousRequest=function(e,t,n,i,r,o,a,s,l,u,c,p){return void 0===u&&(u=null),void 0===c&&(c=null),void 0===p&&(p=null),this.addRequestInternal(e,t,n,i,[],r,o,a,s,l,u||"",!0,c,p)},e.prototype.addRequestWithHeaderForwarding=function(e,t,n,i,r,o,a,s,l,u,c,p,d,h,g,m,_,f,y,v,S){return void 0===c&&(c=null),void 0===p&&(p=!1),void 0===d&&(d=null),void 0===h&&(h=null),void 0===g&&(g=null),void 0===m&&(m=null),void 0===_&&(_=!1),void 0===f&&(f=null),void 0===y&&(y=!1),void 0===v&&(v=null),void 0===S&&(S=null),this.addRequestInternal(e,t,n,i,r||[],o,a,s,l,u,c||"",p,d,h,g,m,_,f,y,v,S)},e.prototype.addSynchronousRequestWithHeaderForwarding=function(e,t,n,i,r,o,a,s,l,u,c,p){return void 0===c&&(c=null),void 0===p&&(p=null),this.addRequestInternal(e,t,n,i,r||[],o,a,s,l,u,"",!0,c,p,"24")},e.prototype.addRequestInternal=function(t,r,o,a,s,u,d,h,g,m,_,f,y,v,S,C,b,A,T,w,E){void 0===y&&(y=null),void 0===v&&(v=null),void 0===S&&(S=null),void 0===C&&(C=null),void 0===b&&(b=!1),void 0===A&&(A=null),void 0===T&&(T=!1),void 0===w&&(w=null),void 0===E&&(E=null);var k=!1;if((n(254).AFrameworkApplication.get_isWopiTokenRefreshEnabled()||this.isAuthedRequest(t))&&(k=c.c.get_instance().checkAndTriggerSessionHasExpired()),n(254).AFrameworkApplication.get_activeFrame()&&n(254).AFrameworkApplication.get_activeFrame().get_holdRequestsWhenSessionHasExpired()&&k&&this.isAuthedRequest(t))return l.ULS.sendTraceTag(6636637,205,50,String.format("Session has expired, so hold client request for [Url: {0}].",t)),-1;var D=y||this._defaultQueueTimeoutMs,M=v||this._defaultSentTimeoutMs;this._lastRequestId++,Array.contains(s,e.correlationIdHeaderName)||Array.add(s,e.correlationIdHeaderName),n(254).AFrameworkApplication.collectPageStats&&!Array.contains(s,n(179).PageStats.pageStatsResponseXHRHeader)&&Array.add(s,n(179).PageStats.pageStatsResponseXHRHeader);var P=new Sys.Net.WebRequest,x=P.get_headers();if(x["X-xhr"]="1",n(254).AFrameworkApplication.collectPageStats&&(P.get_headers()[n(179).PageStats.showPageStatsXHRHeader]=1),C?t=e.addGlobalRequestInfo(x,t,e.userSessionIdHeaderName,n(254).AFrameworkApplication.userSessionIdQueryParam,C):this.get_userSessionId()&&(t=e.addGlobalRequestInfo(x,t,e.userSessionIdHeaderName,n(254).AFrameworkApplication.userSessionIdQueryParam,this.get_userSessionId())),P.set_url(t),n(254).AFrameworkApplication.isLoggingHostRequests&&(x[e.logHostRequestsHeaderName]=1),(A||n(254).AFrameworkApplication.buildVersion)&&(x[e.officeVersionHeaderName]=U.l.httpHeaderEncode(A||n(254).AFrameworkApplication.buildVersion)),2===r?(P.set_httpVerb("POST"),o&&P.set_body(o)):P.set_httpVerb("GET"),this._wacClusterId&&!this.shouldSkipDCSpecificRequest(t)&&(x[e.wacClusterHeaderName]=this._wacClusterId),this.get_wacUserAgent()&&(x[e.wacUserAgentHeaderName]=this.get_wacUserAgent()),a)for(var B in a){var L={key:B,value:a[B]};x[L.key]=U.l.httpHeaderEncode(L.value)}!this._getBooleanAppSetting("LogWhenClientRequestFailedEnabled")||e.correlationIdHeaderName in x||(x[e.correlationIdHeaderName]=F.l.create().toString()),n(254).AFrameworkApplication.canary&&(P.get_headers()[e.canaryHeaderName]=U.l.httpHeaderEncode(n(254).AFrameworkApplication.canary),n(254).AFrameworkApplication.logCanaryInBrowser&&l.ULS.sendTraceTag(6063237,205,50,"Canary in request: {0}",P.get_headers()[e.canaryHeaderName])),n(254).AFrameworkApplication.get_accessToken()&&(e.checkParamInUrl(P.get_url(),n(254).AFrameworkApplication.accessTokenParamName)||(P.get_headers()[e.accessTokenHeaderName]=U.l.httpHeaderEncode(n(254).AFrameworkApplication.get_accessToken())),e.checkParamInUrl(P.get_url(),n(254).AFrameworkApplication.accessTokenTtlParamName)||(P.get_headers()[e.accessTokenTtlHeaderName]=n(254).AFrameworkApplication.accessTokenServerExpirationTime.toString())),n(254).AFrameworkApplication.userType&&(x[e.userTypeHeaderName]=U.l.httpHeaderEncode(n(254).AFrameworkApplication.userType)),b?P.add_completed(i.i(this,this.onRequestCompletedSynchronousNotify,"onRequestCompletedSynchronousNotify")):P.add_completed(i.i(this,this.onRequestCompleted,"onRequestCompleted")),M>0&&P.set_timeout(M);var N=new I.n(this._lastRequestId,d,P,s,u,h,g,m,f,_,S,b,w,E);if(T&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UseFetchKeepAliveOnShutdown"))N.request.set_executor(new R.n),N.request.invoke();else{if(D>0){var O=new p.c(2,1,D,i.i(this,this.timeoutCallbackProcess,"timeoutCallbackProcess"),91);O.customData=N,O.data=N.id.toString(),N.requestQueuedTimeoutTask=O,this._taskManager.addTask(O)}N.status=0,this._requests.enqueue(d,N),N.enqueueTime=new Date,this.onPendingRequestsModified(_,N),this.invoke()}return this._lastRequestId},e.prototype.isAuthedRequest=function(e){return!this.isRequestEndingWithSpecificUrl(e,this._nonAuthedUrls)},e.prototype.shouldSkipDCSpecificRequest=function(e){return!!this._getBooleanAppSetting("NonDCSpecificSqmRequestIsEnabled")&&this.isRequestEndingWithSpecificUrl(e,this._nonDCSpecificUrls)},e.prototype.isRequestEndingWithSpecificUrl=function(e,t){for(var n=_.n.removeAllUrlParameters(e).toLowerCase(),i=0;i<t.length;i++){var r=(0,t[i])();if(r&&n.endsWith(r))return!0}return!1},e.prototype.abortRequest=function(e){if(!(e<0)){var t=this.peekById(e);if(!t)throw Error.argument(String.format("No request is found for the given id: {0}",e));this.abortRequestInternal(t)}},e.prototype.abortRequestInternal=function(e){e&&(l.ULS.sendTraceTag(20289093,205,50,"Trying to abort request id: [{0}], request status is: [{1}], requestor id is: [{2}]",e.id,e.status,e.requestorId),this.ensureCompletionCallbackTaskRemoved(e),this.ensureQueuedTimeoutTaskRemoved(e),1===e.status?(e.request.get_executor().abort(),this.onPendingRequestsModified(e.requestorId,e)):this._getBooleanAppSetting("RunCompletionCallbackAfterCancelingRequest")&&(e.status=10))},e.prototype.ensureCompletionCallbackTaskRemoved=function(e){return this.ensureTaskRemoved((function(){return e.completionCallbackTask}),(function(){e.completionCallbackTask=null}))},e.prototype.ensureQueuedTimeoutTaskRemoved=function(e){return this.ensureTaskRemoved((function(){return e.requestQueuedTimeoutTask}),(function(){e.requestQueuedTimeoutTask=null}))},e.prototype.ensureTaskRemoved=function(e,t){var n=e();return!!n&&(this._taskManager.deleteTask(n),t(),!0)},e.prototype.tryAbortRequest=function(e){var t=this.peekById(e);return!!t&&(this.abortRequestInternal(t),!0)},e.prototype.getRequestStatus=function(e){var t=this.peekById(e);return t?t.status:4},e.prototype.pendingRequestsCount=function(e){for(var t=0,n=0,i=this._requests.get_length();n<i;n++)this._requests.peekAt(n).requestorId===e&&t++;return t},e.prototype.executingRequestsCount=function(e){for(var t=0,n=0,i=this._requests.get_length();n<i;n++){var r=this._requests.peekAt(n);r.requestorId===e&&1===r.status&&t++}return t},e.prototype.peekAtRequestQueue=function(e){return this._requests.peekAt(e)},e.prototype.abortAllOutstandingRequests=function(e){for(var t=this._requests.get_length()-1;t>=0;t--){var n=this._requests.peekAt(t);n.requestorId===e&&this.abortRequest(n.id)}},e.prototype.abortRequests=function(e){for(var t=this._requests.get_length()-1;t>=0;t--){var n=this._requests.peekAt(t);e(n)&&this.abortRequest(n.id)}},e.prototype.addNetworkConnectivityListener=function(e){Array.add(this._networkConnectivityListeners,e)},e.prototype.removeNetworkConnectivityListener=function(e){Array.remove(this._networkConnectivityListeners,e)},e.prototype.addRequestStatusListener=function(e){Array.add(this._requestStatusListeners,e)},e.prototype.removeRequestStatusListener=function(e){Array.remove(this._requestStatusListeners,e)},e.prototype.onNetworkDisconnect=function(){for(var e=Array.clone(this._networkConnectivityListeners),t=0;t<e.length;t++)e[t].networkDisconnected()},e.prototype.onNetworkResume=function(){for(var e=Array.clone(this._networkConnectivityListeners),t=0;t<e.length;t++)e[t].networkResumed()},e.prototype.onPendingRequestsModified=function(e,t){for(var n=Array.clone(this._requestStatusListeners),i=0;i<n.length;i++)n[i].pendingRequestsModified(e,t)},e.prototype.createAndInvokeCompletionTask=function(e,t){var r=new p.c(e.priority,1,0,i.i(this,this.callbackProcess,"callbackProcess"),9);r.data=e.id.toString(),r.name=e.name,n(254).AFrameworkApplication.isShuttingDown||e.isSynchronous||t?this.callbackProcess(r):(e.completionCallbackTask=r,this._taskManager.addTask(r))},e.prototype.invoke=function(){var e;if((e=this.get_telemetryStorage()).invokeCount=e.invokeCount+1,this.get_hasAvailableConnections()){this.removeCancelledItems();for(var t=null,i=0;i<this._requests.get_length();++i){var r=this._requests.peekAt(i);if(!r.status){t=r;break}}if(t){if(this.ensureQueuedTimeoutTaskRemoved(t),n(254).AFrameworkApplication.get_activeFrame()&&n(254).AFrameworkApplication.get_activeFrame().get_runRequestCallbackWhenSessionHasExpired()&&c.c.get_instance().isSessionExpired(n(254).AFrameworkApplication.get_accessTokenTtl())&&this.isAuthedRequest(t.request.get_url()))return t.status=14,void this.createAndInvokeCompletionTask(t,t.forceSynchronousNotify);t.status=1;var o=null;n(254).AFrameworkApplication.isShuttingDown||t.isSynchronous?(o=Sys.Net.WebRequestManager.get_defaultExecutorType(),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DisableSynchronousXMLHttpExecutor")||n(254).AFrameworkApplication.isShuttingDownFromPostMessage||n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("EnableAsyncXHROnNavigateForChrome")&&(n(254).AFrameworkApplication.isShuttingDown||"wsaupload.ashx"===n(254).AFrameworkApplication.theWsaClient.get_uploadUrl().toLowerCase())&&!D.y.get_supportsSynchronousXhrDuringNavigate()?Sys.Net.WebRequestManager.set_defaultExecutorType(x.c.getName()):Sys.Net.WebRequestManager.set_defaultExecutorType(B.j.getName())):n(254).AFrameworkApplication.requiresCrossDomainAjax?(S.b.corsSimpleResponseHeadersOnlyIsEnabled=this._getBooleanAppSetting("CORSSimpleResponseHeadersOnlyIsEnabled"),o=Sys.Net.WebRequestManager.get_defaultExecutorType(),Sys.Net.WebRequestManager.set_defaultExecutorType(S.b.getName())):(D.y.get_isInternetExplorer10Up()||D.y.get_isInternetExplorerMobile())&&(o=Sys.Net.WebRequestManager.get_defaultExecutorType(),Sys.Net.WebRequestManager.set_defaultExecutorType(x.c.getName()));var a=!1;try{t.invokedTime=new Date,t.invokedTimeTicks=h.i(f.g.getTickCount(),2),this._markWebRequestOnTimelineIsEnabled&&t.get_shouldMarkOnTimeline()&&L.m.get_instance().addMark("RequestInvoked"+t.invokedTimeTicks),t.invokedCallback&&t.invokedCallback(new w(t));var s=void 0;(s=this.get_telemetryStorage()).invokeSentCount=s.invokeSentCount+1,t.request.invoke(),this.onPendingRequestsModified(t.requestorId,t)}catch(e){var l=void 0;(l=this.get_telemetryStorage()).invokeFailedCount=l.invokeFailedCount+1,a=!0}o&&Sys.Net.WebRequestManager.set_defaultExecutorType(o),this._openConnections++,!a||n(254).AFrameworkApplication.isShuttingDown||t.isSynchronous||this.onRequestCompleted(t.request.get_executor())}}else{var u=void 0;(u=this.get_telemetryStorage()).noOpenConnectionCount=u.noOpenConnectionCount+1}},e.prototype.removeCancelledItems=function(){if(this._getBooleanAppSetting("RunCompletionCallbackAfterCancelingRequest"))for(var e=this._requests.get_length()-1;e>=0;--e){var t=this._requests.peekAt(e);10===t.status&&(this.ensureQueuedTimeoutTaskRemoved(t),this.removeById(t.id))}},e.prototype.onRequestCompletedSynchronousNotify=function(e){var t;(t=this.get_telemetryStorage()).synchronousNotificationCount=t.synchronousNotificationCount+1,this.onRequestCompletedInternal(e,!0)},e.prototype.onRequestCompleted=function(e){this.onRequestCompletedInternal(e,!1)},e.prototype.onRequestCompletedInternal=function(t,r){if(t){var o=t.get_webRequest();if(o){var a=this.peekByWebRequest(o);if(a){this._openConnections--;var s=t.get_responseAvailable()?t.get_statusCode():t.get_timedOut()?C.MO:-1;a.httpStatus=s;var u=t.get_aborted()?"'Aborted'":t.get_timedOut()?"'Request Timeout'":t.get_responseAvailable()?s.toString():"'Response Not Available'";a.completedTime=this.lastResponseTime=new Date,a.completedTimeTicks=h.i(f.g.getTickCount(),2),this._markWebRequestOnTimelineIsEnabled&&a.get_shouldMarkOnTimeline()&&L.m.get_instance().addMark("RequestCompleted"+a.completedTimeTicks);var c=!1;t.get_aborted()&&(a.status=10);var p=null,d=null;if(t.get_responseAvailable()){if(t.getResponseHeader(e.endSessionHeaderName)&&n(254).AFrameworkApplication.endSessionHeaderReceivedCallback)return void n(254).AFrameworkApplication.endSessionHeaderReceivedCallback();var g=t.getResponseHeader(e.officeFEHeaderName);g&&(this._machineIds[g]=1);var m=t.getResponseHeader(e.isCacheableHeaderName);!(null==m)&&Boolean.parse(m)?this.lastCorrelationId=F.l.create().toString():(this.lastCorrelationId=t.getResponseHeader(e.correlationIdHeaderName),p=t.getResponseHeader(e.canaryNewValueHeaderName),e.updateCanary(p)),d=this.get_lastCorrelationId();var y=_.n.getPageName(o.get_url()),v=void 0;if(s===C.o)v=4;else if(s===C.Vu)v=5;else if(s===C.Fc){t.getResponseHeader("OdsiHttpModule")?(this._signInFrame=new P(document.body,i.i(this,this.runAllSilentAuthCallbacks,"runAllSilentAuthCallbacks")),v=12):v=3,l.ULS.shipAssertTag(8157283,205,!!y),this._requestsFailedWith403Error[y]="1";var S=!1;this._consecutive403ErrorStart?S=++this._consecutive403ErrorCount>=n(254).AFrameworkApplication.appSettingsManager.getIntAppSetting("MaxConsecutive403ErrorCount",2)&&(new Date).getTime()-this._consecutive403ErrorStart>=n(254).AFrameworkApplication.appSettingsManager.getIntAppSetting("Consecutive403ErrorInterval",3e3):(l.ULS.shipAssertTag(8157312,205,!this._consecutive403ErrorCount),l.ULS.sendTraceTag(8157313,205,50,"Try recovering from 403 error"),this._consecutive403ErrorCount=1,this._consecutive403ErrorStart=(new Date).getTime()),!this._isConsecutive403ErrorOccurredEventRaised&&S&&(this._silentAuthFailedWithError?l.ULS.sendTraceTag(8157314,205,50,"OnConsecutive403ErrorOccured: Legitimate since SoftAuth got MSA errors [Count: {0}]",this._consecutive403ErrorCount):l.ULS.sendTraceTag(7352910,205,50,"OnConsecutive403ErrorOccured: [Count: {0}]",this._consecutive403ErrorCount),this._isConsecutive403ErrorOccurredEventRaised=!0,this._eventSource.raiseEvent("C403EOEK"))}else 12029===s||12030===s||12031===s||12152===s||12159===s?v=6:s!==C.eN?v=C.ts(s)?11:C.CD(s)?9:s&&2!==s?3:8:(v=2,c=!0);s!==C.Fc&&s&&2!==s&&this._consecutive403ErrorCount>0&&"1"===this._requestsFailedWith403Error[y]&&(this._consecutive403ErrorCount=0,this._consecutive403ErrorStart=0,this._silentAuthFailedWithError=!1,this._requestsFailedWith403Error={}),a.status=v}else t.get_timedOut()?a.status=7:this.get_telemetryStorage().addToResponseNotAvailableIds(a.id);if(c)this.get_isNetworkOffline()&&(this._offlineLogger&&this._offlineLogger.listenNextTag(4284739,306,50),l.ULS.sendTraceTag(4284739,306,50,"OnNetworkResume"),this.isNetworkOffline=!1,this.onNetworkResume()),this._firstConsecutiveFailureResponseTime=null;else{var b=s===C.Vu&&!!p,A=new Date;this._firstConsecutiveFailureResponseTime||(this._firstConsecutiveFailureResponseTime=A);var T=A.getTime()-this._firstConsecutiveFailureResponseTime.getTime();if(!this.get_isNetworkOffline()&&!b&&T>=3e4&&(this._offlineLogger&&this._offlineLogger.listenNextTag(4284740,306,50),l.ULS.sendTraceTag(4284740,306,50,"NetworkDisconnected {0}",{TimeSinceFirstFailure:T,OfflineRetryInterval:3e4,StatusCode:u,RequestStatus:a.status,Url:_.n.removeAllUrlParameters(o.getResolvedUrl())}),this.isNetworkOffline=!0,this.onNetworkDisconnect()),this._getBooleanAppSetting("LogWhenClientRequestFailedEnabled")&&(null==d&&t.get_webRequest().get_headers()&&(d=t.get_webRequest().get_headers()[e.correlationIdHeaderName]),null!=d)){var w="Request failed! Correlation: "+d+", StatusCode: "+s.toString();if(this._getBooleanAppSetting("DumpResponseHeadersWhenClientRequestFailedEnabled")&&t.get_responseAvailable()){var I=t.getAllResponseHeaders();if(null!=I)w+=(I.length>2e4?", TruncatedResponseHeaders: ":", ResponseHeaders: ")+I}l.ULS.sendTraceTag(39936897,306,50,w)}}if(t.get_responseAvailable())try{if(a.responseData=t.get_responseData(),void 0!==a.responseHeadersToSet&&null!==a.responseHeadersToSet){a.responseHeaders={};for(var E=0;E<a.responseHeadersToSet.length;++E){var k=a.responseHeadersToSet[E];a.responseHeaders[k]=t.getResponseHeader(k)}}a.shouldSetResponseXml&&(t.get_responseData()&&t.get_responseData().length?a.responseXml=t.get_xml():a.responseXml=null)}catch(e){l.ULS.sendTraceTag(4322132,205,10,"OnRequestCompleted: Unable to get ResponseData/XML, Id={0}, Url={1} ResponseAvailable={2}, Status={3}, CorrelationId={4}, Exception={5}",a.id,a.request.get_url(),t.get_responseAvailable(),u,this.get_lastCorrelationId(),e.toString())}this._getBooleanAppSetting("RunCompletionCallbackAfterCancelingRequest")&&10===a.status?this.removeById(a.id):this.createAndInvokeCompletionTask(a,r),this.invoke()}else l.ULS.sendTraceTag(39965911,205,15,"OnRequestCompleted: Request is not found in the queue. Request body: {0}. ",U.l.redactForLogging(o.get_body()))}else l.ULS.sendTraceTag(19161608,205,15,"OnRequestCompleted: Request doesn't exist.")}else l.ULS.sendTraceTag(19161607,205,15,"OnRequestCompleted: Executor doesn't exist.")},e.prototype.runAllSilentAuthCallbacks=function(e){var t=e;if(t){var n=_.n.getParameterValue(t,"f");n?(l.ULS.sendTraceTag(8157315,205,50,"SilentAuth failed with error code: {0}",{f:n,MSPPError:_.n.getParameterValue(t,"MSPPError")}),this._silentAuthFailedWithError=!0):this._silentAuthFailedWithError=!1}this._signInFrame&&(this._onNextSilentAuthCallbacks.forEach((function(e){e()})),Array.clear(this._onNextSilentAuthCallbacks),this._signInFrame=null)},e.prototype.addNextSilentAuthCallback=function(e){this._signInFrame?Array.add(this._onNextSilentAuthCallbacks,e):e()},e.prototype.addOnBeforeRemoveRequestCallback=function(e){Array.add(this._onBeforeRemoveRequestCallbacks,e)},e.prototype.removeOnBeforeRemoveRequestCallback=function(e){Array.remove(this._onBeforeRemoveRequestCallbacks,e)},e.prototype.timeoutCallbackProcess=function(e){var t=e.data,n=e.customData;if(this.ensureQueuedTimeoutTaskRemoved(n)){var i,r=_.n.removeAllUrlParameters(n.request.get_url());n.status?l.ULS.shipAssertTag(5904529,306,!1,"TimeoutCallbackProcess: Leaving request untouched. It timed out in the queue with unexpected status. {0}",{Url:r,Status:n.status}):(n.status=13,n.completedTime=new Date,n.completedTimeTicks=h.i(f.g.getTickCount(),2),this._markWebRequestOnTimelineIsEnabled&&n.get_shouldMarkOnTimeline()&&L.m.get_instance().addMark("RequestCompleted"+n.completedTimeTicks),this.removeById(n.id),this.executeCallbackForRequest(n,t),l.ULS.sendTraceTag(5904528,306,15,"TimeoutCallbackProcess: Request timed out in the queue. {0}",{Url:r})),(i=this.get_telemetryStorage()).invokeTimeoutCount=i.invokeTimeoutCount+1}},e.prototype.callbackProcess=function(e){var t=e.data,n=this.removeById(parseInt(t));this.executeCallbackForRequest(n,t)},e.prototype.executeCallbackForRequest=function(e,t){if(e)if(this.onPendingRequestsModified(e.requestorId,e),2===e.status){e.successCallback&&e.successCallback(new k(e));var n=void 0;(n=this.get_telemetryStorage()).succeededCount=n.succeededCount+1}else{if(7===e.status){var i=void 0;(i=this.get_telemetryStorage()).timeoutCount=i.timeoutCount+1}else{var r=void 0;(r=this.get_telemetryStorage()).failedCount=r.failedCount+1}e.failureCallback&&e.failureCallback(new T(e))}},e.prototype.removeById=function(e){var t=this.indexofId(e);if(-1===t)return null;var n=this.peekByIndex(t);return this._onBeforeRemoveRequestCallbacks.forEach((function(e){e(n)})),this._requests.removeAt(t),n},e.prototype.indexofId=function(e){return this.indexOfRequestWhere((function(t){return t.id===e}))},e.prototype.indexofWebRequest=function(e){return this.indexOfRequestWhere((function(t){return t.request===e}))},e.prototype.indexOfRequestWhere=function(e){for(var t=0;t<this._requests.get_length();++t){if(e(this._requests.peekAt(t)))return t}return-1},e.prototype.peekById=function(e){return this.peekByIndex(this.indexofId(e))},e.prototype.peekByWebRequest=function(e){return this.peekByIndex(this.indexofWebRequest(e))},e.prototype.peekByIndex=function(e){return e<0?null:this._requests.peekAt(e)},e.prototype.getNextRequestIdAndIncrement=function(){return c.c.get_instance().checkAndTriggerSessionHasExpired()?-1:(this._lastRequestId++,this._lastRequestId)},e.prototype.dump=function(){},e.prototype.getUserTypeQueryStringPair=function(){return n(254).AFrameworkApplication.userType?String.format("{0}={1}",e.userTypeQsName,U.l.urlKeyValueEncode(n(254).AFrameworkApplication.userType)):null},e.createAnInstance=function(t){return e.createAnInstanceWithResolvedDependencies(t)},e.createAnInstanceWithResolvedDependencies=function(t){var i=n(254).AFrameworkApplication.appSettingsManager||new u.p({}),o=new a.q(r.i,(function(){return n(254).AFrameworkApplication.get_activeFrame().get_theStopwatchBuilder()})),s=[function(){return n(254).AFrameworkApplication.theWsaClient?n(254).AFrameworkApplication.theWsaClient.get_uploadUrl().toLowerCase():null},function(){return"remoteuls.ashx"},function(){return"remotetelemetry.ashx"}],l=[function(){return n(254).AFrameworkApplication.theWsaClient?n(254).AFrameworkApplication.theWsaClient.get_uploadUrl().toLowerCase():null},function(){return"rtc2/findsession"}];return new e(t,i.getIntAppSetting("ClientRequestManagerMaxConnections",2),i.getIntAppSetting("ClientRequestManagerDefaultQueueTimeMs",0),i.getIntAppSetting("ClientRequestManagerDefaultSentTimeMs",0),d.y.get_instance(),s,(function(e){return!!n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e)}),l,o,n(254).AFrameworkApplication.theOfflineLogger)},e.addGlobalRequestInfo=function(t,i,r,o,a){return n(254).AFrameworkApplication.requiresCrossDomainAjax?i=e.addQueryParameterToUrl(i,o,a):t[r]=U.l.httpHeaderEncode(a),i},e.addQueryParameterToUrl=function(t,n,i){if(_.n.getParameterValue(t,n))return l.ULS.sendTraceTag(4301539,205,15,"Param collision: {0}",n),t;var r=_.n.addParameterValue(t,n,i);return r.length>e.maxUrlLength?l.ULS.sendTraceTag(4301568,205,15,"Url too long: {0}. Length: {1}",n,r.length):t=r,t},e.validateAndFixCanary=function(e){var t=e.split(",");if(t.length>4)l.ULS.sendTraceTag(7161414,205,10,"Unexpected canary value [{0}]. Less than 4 commas expected.",e);else if(4===t.length){l.ULS.sendTraceTag(7161415,205,10,"Canary got duplicated header value : {0}",e);var n=t[0].trim()+","+t[1].trim();e=n===t[2].trim()+","+t[3].trim()?n:e,l.ULS.sendTraceTag(7161416,205,50,"Fixed canary value is: {0}",e)}return e},e.updateCanary=function(t){t&&(t=e.validateAndFixCanary(t),n(254).AFrameworkApplication.canary=t,n(254).AFrameworkApplication.logCanaryInBrowser&&l.ULS.sendTraceTag(6063238,205,50,"New canary in response: {0}",n(254).AFrameworkApplication.canary))},e.checkParamInUrl=function(e,t){return!(!e||!t)&&(-1!==e.indexOf("?"+t+"=")||-1!==e.indexOf("&"+t+"="))},e.invalidRequestId=0,e.maxUrlLength=2048,e.canaryHeaderName="X-Key",e.canaryQueryParam="ckey",e.canaryNewValueHeaderName="X-NewKey",e.correlationIdHeaderName="X-CorrelationId",e.isCacheableHeaderName="X-IsCacheable",e.officeFEHeaderName="X-OfficeFE",e.officeVersionHeaderName="X-OfficeVersion",e.officeVersionQueryParam="build",e.endSessionHeaderName="X-EndSession",e.accessTokenHeaderName="X-AccessToken",e.accessTokenTtlHeaderName="X-AccessTokenTtl",e.userTypeHeaderName="X-UserType",e.userTypeQsName="WacUserType",e.wacClusterHeaderName="X-WacCluster",e.wacClusterQsName="waccluster",e.wacUserAgentHeaderName="X-WacUserAgent",e.wacUserAgentQsName="wdwacuseragent",e.requestApiQueryParam="rapi",e.userSessionIdHeaderName="X-UserSessionId",e.appliedPolicyIdHeaderName="X-AppliedPolicyId",e.selectedPolicyLabelIdHeaderName="X-SelectedPolicyLabelId",e.setPolicyLabelJustificationHeaderName="X-SetPolicyLabelJustification",e.setPolicyLabelActionSourceHeaderName="X-SetPolicyLabelActionSource",e.setPolicyLabelAssignmentMethodHeaderName="X-SetPolicyLabelAssignmentMethod",e.policyLabelVersionTokenHeaderName="X-PolicyLabelVersionToken",e.appLockIdHeaderName="X-AppLockId",e.logHostRequestsHeaderName="X-LogHostRequests",e.logHostRequestsQueryParam="loghostrequests",e}();(0,i.l)(O,"ClientRequestManager",null,[o.u])},,,function(e,t,n){"use strict";n.d(t,{k:function(){return i}});var i=(0,n(208).y)("IF6Manager")},,function(e,t,n){"use strict";var i=n(800),r=n(208),o=function(){function e(e,t){if(this.includedString=null,this._findReplacePair=null,-1===e.indexOf("{"))throw Error.argument("find","find string needs to use curly braces");this._findReplacePair=new i.o(new RegExp(e,"gi"),t),this.includedString=e}return e.prototype.get_includedString=function(){return this.includedString},e.prototype.replaceIn=function(e){return this._findReplacePair.performReplaceOn(e)},e}();(0,r.l)(o,"UserStringReplacement",null,[]),n.d(t,{k:function(){return a}});var a=function(){function e(){}return e.formatResourceStrings=function(t){var n=t,i=e.buildReplacements(),r=i.length;for(var o in n){var a={key:o,value:n[o]},s=a.value;if("string"==typeof s){var l=s;if(-1===l.indexOf("{"))continue;for(var u=0;u<r;u++)e.shouldSkipUnnecessaryRegexReplace&&i[u].get_includedString()&&l.indexOf(i[u].get_includedString())<0||(l=i[u].replaceIn(l));n[a.key]=l}}},e.formatSingleString=function(t){var n=e.buildReplacements(),i=n.length,r=t;if(!r||-1===r.indexOf("{"))return r;for(var o=0;o<i;o++)e.shouldSkipUnnecessaryRegexReplace&&n[o].get_includedString()&&r.indexOf(n[o].get_includedString())<0||(r=n[o].replaceIn(r));return r},e.buildReplacements=function(){return e._replacements||(e._replacements=[new o("{webappfull}",e.applicationNameLong),new o(e._webappshort,e.applicationNameShort),new o("{richclientfull}",e.richClientNameLong),new o("{appshort}",e.applicationNameOnly),new o("{doctype}",e.documentType),new o("{doctypetitlecase}",e.documentTypeTitleCase),new o("{doctypeplural}",e.documentTypePlural),new o("{subdoctype}",e.subDocumentType),new o("{officefull}",CommonUIStrings.l_OfficeNameLong),new o("{officeshort}",CommonUIStrings.l_OfficeNameShort),new o("{onedrive}",CommonUIStrings.l_OneDriveName),new o("{brandingstring}",CommonUIStrings.l_BrandingString),new o("{brandingstringplural}",CommonUIStrings.l_BrandingString),new o("{skype}",CommonUIStrings.l_SkypeName)])},e._webappshort="{webappshort}",e.applicationNameLong=null,e.applicationNameShort=null,e.documentType=null,e.documentTypeTitleCase=null,e.documentTypePlural=null,e.richClientNameLong=null,e.subDocumentType=null,e.applicationNameOnly=null,e.shouldSkipUnnecessaryRegexReplace=!1,e._replacements=null,e}();(0,r.l)(a,"UserStringFormatter",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(208),r=(0,i.y)("ILogCache2"),o=(0,i.y)("ILogCache"),a=n(255),s=function(){return function(e,t,n,i,r){this.T=e,this.L=t,this.S=n,this.I=i,this.V=r}}();(0,i.l)(s,"SerializableLogCache",null,[]);var l=function(){function e(e,t,n,i,r,o){this.G=0,this.T=0,this.M=null,this.C=null,this.D=0,this.G=o,this.T=i,this.M=e,this.C=t,this.D=1e3*r+n}return e.prototype.computeSerializedLength=function(){return n(729).LogCache.logEnvelopeSize+e.charsInObj(this.G)+e.charsInObj(this.T)+this.M.length+e.charsInObj(this.C)+e.charsInObj(this.D)},e.charsInObj=function(e){return(""+e).length},e}();(0,i.l)(l,"SerializableLogEntry",null,[]);var u=n(183);n.d(t,{LogCache:function(){return d}});var c=25,p=65536,d=function(){function e(e,t,n){this._timestampBase=0,this._logs=null,this._userSessionId=null,this._dataSizeBytes=0,this._uploadMaximumSizeBytes=0,this._sizeThresholdBytes=0,this._logMessageMaxChars=0,this._maxDataSizeBytes=0,this.$$pf_UploadId=0,this._sizeThresholdBytes=e,this._logMessageMaxChars=t,this._userSessionId=n,this._sizeThresholdBytes=e<p?e:p,this._maxDataSizeBytes=this._sizeThresholdBytes-4*(this._logMessageMaxChars+c),this.reset()}return e.prototype.reset=function(){this._logs=[],this._dataSizeBytes=c,this._timestampBase=(new Date).getTime()},e.prototype.get_count=function(){return this._logs.length},e.prototype.get_uploadId=function(){return this.$$pf_UploadId},e.prototype.set_uploadId=function(e){return this.$$pf_UploadId=e,e},e.prototype.get_uploadMaximumSizeBytes=function(){return this._uploadMaximumSizeBytes},e.prototype.set_uploadMaximumSizeBytes=function(e){return this._uploadMaximumSizeBytes=e,e},e.prototype.get_dataSizeBytes=function(){return this._dataSizeBytes},e.prototype.addLog=function(e){if(e){e.message.length>this._logMessageMaxChars&&(e.message=e.message.substr(0,this._logMessageMaxChars-13)+"... [trimmed]",a.ULS.sendTraceTag(3465240,100,50,"Trimmed message for log {0}",u.z(e.tag)));var t=new l(e.message,e.category,e.level,e.timestamp-this._timestampBase,e.logType,e.tag),n=t.computeSerializedLength();if(this._uploadMaximumSizeBytes>0&&n+this._dataSizeBytes>this._uploadMaximumSizeBytes){var i=this.get_count();this.reset(),a.ULS.sendTraceTag(0,100,15,"The log size is too large to be accepted by the server, throwing away {0} logs.",i)}Array.add(this._logs,t),this._dataSizeBytes+=n}},e.prototype.get_isDataSizeThresholdExceeded=function(){return this._dataSizeBytes>this._maxDataSizeBytes},e.prototype.serialize=function(){return a.ULS.jsonSerialize(new s(this._timestampBase,this._logs,this._userSessionId,this.get_uploadId(),1))},e.prototype.get_sizeThresholdBytes=function(){return this._sizeThresholdBytes},e.prototype.get_logMessageMaxChars=function(){return this._logMessageMaxChars},e.prototype.get_logs=function(){return this._logs},e.prototype.get_timestampBase=function(){return this._timestampBase},e.testJsonSerialize=function(e){return a.ULS.jsonSerialize(e)},e.logEnvelopeSize=31,e}();(0,i.l)(d,"LogCache",null,[r,o])},,,function(e,t,n){"use strict";var i=n(572),r=n(600),o=n(208),a=function(e){var t="ISet$1$"+e.getName();return(0,o.g)(t)},s=n(335),l=n(244);n.d(t,{e:function(){return u}});var u=function(){function e(t,n){this._comparer=null,this._buckets=null,this.$$pf_Count=0,this.$$ge=this.getEnumerator,o.m(this,e.$$(t)),this._comparer=n,this.clear()}return e.prototype.getEnumerator=function(){var e=this;return l.selectMany(Array,o.f(this,"$$sc.HashSet$1").T,l.asEnumerable(Array,this._buckets),(function(t){return l.asEnumerable(o.f(e,"$$sc.HashSet$1").T,t)})).$$ge()},e.prototype.get_count=function(){return this.$$pf_Count},e.prototype.set_count=function(e){return this.$$pf_Count=e,e},e.prototype.add=function(e){for(var t=this,n=s.b(o.f(this,"$$sc.HashSet$1").T,(0,r.m)((function(){return t._buckets}),(function(e){return t._buckets=e})),e,this._comparer,this.get_count()),i=0;i<n.length;i++){var a=n[i];if(this._comparer.equals(a,e))return!1}return this.set_count(this.get_count()+1),Array.add(n,e),!0},e.prototype.clear=function(){var e=this;this._buckets=null,this.set_count(0),s.h(o.f(this,"$$sc.HashSet$1").T,(0,r.m)((function(){return e._buckets}),(function(t){return e._buckets=t})),this._comparer,7)},e.prototype.contains=function(e){for(var t=this._buckets[s.w(this._buckets,this._comparer.getHashCode(e))],n=0;n<t.length;n++){var i=t[n];if(this._comparer.equals(i,e))return!0}return!1},e.prototype.remove=function(e){for(var t=this._buckets[s.w(this._buckets,this._comparer.getHashCode(e))],n=0;n<t.length;n++){var i=t[n];if(this._comparer.equals(i,e))return Array.removeAt(t,n),this.set_count(this.get_count()-1),!0}return!1},e.$$=function(t){var n="HashSet$1$"+t.getName(),r=o.x(n);return r||o.u(n,"$$sc.HashSet$1",e,[{T:t}],null,[a(t),i.i])},e}()},function(e,t,n){"use strict";var i=n(508),r=n(208),o=(0,r.y)("IPointerInputManager"),a=n(550),s=n(390),l=n(255),u=n(446),c=n(306),p=n(574),d=function(){function e(e,t){this._currentTimeGetter=null,this._ulsReporter=null,this._lastMsPointerDownTime=0,this._currentTimeGetter=e,this._ulsReporter=t}return e.prototype.markPointerDownEventTime=function(){this._lastMsPointerDownTime=this._currentTimeGetter()},e.prototype.markMouseDownEventTime=function(){var e=this._currentTimeGetter()-this._lastMsPointerDownTime;e>250&&this._ulsReporter(e)},e.getAnInstance=function(){return new e(e.getCurrentTime,e.reportToUls)},e.getCurrentTime=function(){return(new Date).getTime()},e.reportToUls=function(e){l.ULS.sendTraceTag(4248472,310,15,"msPointerDown before mousedown was {0}ms",e)},e}();(0,r.l)(d,"MissingPointerEventsTracker",null,[]);var h=n(352),g=n(425),m=function(e){function t(t,n,i,r,o,a,s,l,u){var c,p=e.call(this,t,r,o,a)||this;(p._button=0,p._shiftKey=!1,p._ctrlKey=!1,p._metaKey=!1,p._clientPoint=null,p._pointerId=0,p._button=n,p._clientPoint=i,p._shiftKey=s,p._ctrlKey=l,p._metaKey=u,o.rawEvent)?c=o.rawEvent.pointerId:c=o.pointerId;return p._pointerId=null!=c?c:-1,p}return(0,i.t)(t,e),t.prototype.get_mouseButton=function(){return this._button},t.prototype.get_shiftKey=function(){return this._shiftKey},t.prototype.get_ctrlKey=function(){return this._ctrlKey},t.prototype.get_metaKey=function(){return this._metaKey},t.prototype.get_commandKey=function(){return g.y.get_isMac()?this._metaKey:this._ctrlKey},t.prototype.get_clientPoint=function(){return this._clientPoint},t.prototype.get_pointerId=function(){return this._pointerId},t.create=function(e,n,i,r){var o,a,s=!1;if(i.rawEvent){var l=i.rawEvent;o=u.a.getMouseButton(l),a=new Sys.UI.Point(l.clientX,l.clientY),s=l.metaKey,void 0!==l.clientX&&null!==l.clientX&&void 0!==l.clientX&&null!==l.clientX||3!==r||(a=u.a.getClientPointFromTouchEvent(i))}else o=i.button,a=new Sys.UI.Point(i.clientX,i.clientY);return new t(e,o,a,n,i,r,i.shiftKey,i.ctrlKey,s)},t}(u.a);(0,r.l)(m,"PointerEventArgs",u.a,[]);var _=n(101);n.d(t,{z:function(){return f}});var f=function(e){function t(){var t=e.call(this)||this;return t._eventHandlerManager=null,t._pointerEventToBrowserEvents=null,t._browserEventToPointerEvent=null,t._browserPointerEventsEnabled=window.navigator.pointerEnabled||!!window.PointerEvent&&g.y.get_isInternetExplorerEdge(),t._msPointerEventsEnabled=window.navigator.msPointerEnabled,t._missingPointerEventsTracker=d.getAnInstance(),t._eventHandlerManager=c.EventHandlerManager.get_instance(),t._pointerEventToBrowserEvents={},t._browserEventToPointerEvent={},t._browserPointerEventsEnabled?(t.setupPointerEventDicts(p.d.pointerDown,[p.d.browserPointerDown,p.d.touchStart,p.d.mouseDown]),t.setupPointerEventDicts(p.d.pointerMove,[p.d.browserPointerMove,p.d.mouseMove]),t.setupPointerEventDicts(p.d.pointerUp,[p.d.browserPointerUp,p.d.mouseUp]),t.setupPointerEventDicts(p.d.pointerOver,[p.d.browserPointerOver,p.d.mouseOver]),t.setupPointerEventDicts(p.d.pointerOut,[p.d.browserPointerOut,p.d.mouseOut]),t.setupPointerEventDicts(p.d.pointerEnter,[p.d.browserPointerEnter,p.d.mouseEnter]),t.setupPointerEventDicts(p.d.pointerLeave,[p.d.browserPointerLeave,p.d.mouseLeave])):t._msPointerEventsEnabled?(t.setupPointerEventDicts(p.d.pointerDown,[p.d.msPointerDown,p.d.touchStart,p.d.mouseDown]),t.setupPointerEventDicts(p.d.pointerMove,[p.d.msPointerMove,p.d.mouseMove]),t.setupPointerEventDicts(p.d.pointerUp,[p.d.msPointerUp,p.d.mouseUp]),t.setupPointerEventDicts(p.d.pointerOver,[p.d.msPointerOver,p.d.mouseOver]),t.setupPointerEventDicts(p.d.pointerOut,[p.d.msPointerOut,p.d.mouseOut]),t.setupPointerEventDicts(p.d.pointerEnter,[p.d.msPointerEnter,p.d.mouseEnter]),t.setupPointerEventDicts(p.d.pointerLeave,[p.d.msPointerLeave,p.d.mouseLeave])):(t.setupPointerEventDicts(p.d.pointerDown,[p.d.touchStart,p.d.mouseDown]),t.setupPointerEventDicts(p.d.pointerMove,[p.d.mouseMove]),t.setupPointerEventDicts(p.d.pointerUp,[p.d.mouseUp]),t.setupPointerEventDicts(p.d.pointerOver,[p.d.mouseOver]),t.setupPointerEventDicts(p.d.pointerOut,[p.d.mouseOut]),t.setupPointerEventDicts(p.d.pointerEnter,[p.d.mouseEnter]),t.setupPointerEventDicts(p.d.pointerLeave,[p.d.mouseLeave])),t}return(0,i.t)(t,e),t.prototype.setupPointerEventDicts=function(e,t){this._pointerEventToBrowserEvents[e]=t;for(var n=0;n<t.length;++n)this._browserEventToPointerEvent[t[n]]=e},t.prototype.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t);for(var n=p.d.get_pointerEvents(),i=0;i<n.length;++i)this.initializeBrowserEvents(n[i],t)},t.prototype.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t);for(var n=p.d.get_pointerEvents(),i=0;i<n.length;++i)this.deInializeBrowserEvents(n[i],t)},t.prototype.registerHandler=function(e,t,n){this.registerHandlerWithCaptureOption(e,t,n,!1)},t.prototype.registerHandlerWithData=function(e,t,n,i){this.registerHandlerInternal(e,t,n,i)},t.prototype.registerHandlerWithCaptureOption=function(e,t,n,i){void 0===i&&(i=!1),this.registerHandlerInternal(e,t,n,null,i)},t.prototype.unregisterHandler=function(e,t,n){this.unregisterHandlerWithCaptureOption(e,t,n,!1)},t.prototype.unregisterHandlerWithCaptureOption=function(e,t,n,i){void 0===i&&(i=!1),this._eventHandlerManager.unregisterHandler(m,e,t,n,i),this.deInializeBrowserEvents(e,t,i)},t.prototype.registerOnBeforeEventProcessed=function(e,t){var n=this._pointerEventToBrowserEvents[e],i=this.buildOnBeforeEventProcessedHandler(t);this._eventHandlerManager.registerOnBeforeEventsProcessed(n,i)},t.prototype.registerHandlerInternal=function(e,t,n,i,o){void 0===o&&(o=!1),this._eventHandlerManager.registerHandler(m,e,t,2,r.i(this,this.onPointerEvent,"onPointerEvent"),n,i,o),this.initializeBrowserEvents(e,t,o)},t.prototype.buildOnBeforeEventProcessedHandler=function(e){var t=this;return function(i){if(!n(254).AFrameworkApplication.get_theTaskManager().get_isYielding()){var r=p.d.eventNameFromString(i.type);if(!t.shouldIgnoreDuplicateEvent(r)){var o=t.buildPointerEventArgs(r,i);e(o)}}}},t.prototype.initializeBrowserEvents=function(e,t,n){void 0===n&&(n=!1);var i=this._pointerEventToBrowserEvents[e];if(null!=i)for(var o=0;o<i.length;++o)this._eventHandlerManager.initializeForElementInternal(i[o],t,2,r.i(this,this.onPointerEvent,"onPointerEvent"),n)},t.prototype.deInializeBrowserEvents=function(e,t,n){void 0===n&&(n=!1);var i=this._pointerEventToBrowserEvents[e];if(null!=i)for(var r=0;r<i.length;++r)this._eventHandlerManager.deinitializeForElementInternal(t,i[r],n)},t.prototype.onPointerEvent=function(e,t,i){if(n(254).AFrameworkApplication.get_theTaskManager().get_isYielding())return l.ULS.sendTraceTag(24699483,324,50,"Pointer event dropped."),!1;if(e!==p.d.msPointerDown&&e!==p.d.browserPointerDown||this._missingPointerEventsTracker.markPointerDownEventTime(),(this._msPointerEventsEnabled||this._browserPointerEventsEnabled)&&e===p.d.mouseDown&&this._missingPointerEventsTracker.markMouseDownEventTime(),this.shouldIgnoreDuplicateEvent(e))return!1;var r=this.buildPointerEventArgs(e,i),o=this._eventHandlerManager.processEvent(m,r.eventName,t,r);return o&&a.n.cancelEvent(i),o},t.prototype.shouldIgnoreDuplicateEvent=function(e){var t=e.startsWith("MSPointer");if(this._browserPointerEventsEnabled&&t)return!0;var n=e.startsWith("mouse");return(this._browserPointerEventsEnabled||this._msPointerEventsEnabled)&&n},t.prototype.buildPointerEventArgs=function(e,n){var i;i=n.rawEvent?u.a.getSourceElement(n):n.target;var r=t.getIeInputMethod(n);r||(r=Array.contains(p.d.get_touchEvents(),e)?3:2);var o=this._browserEventToPointerEvent[e];return m.create(o,i,n,r)},t.get_instance=function(){return t._instance||(t._instance=new t),t._instance},t.set_instance=function(e){return t._instance=e,e},t.disposeInputManager=function(){_.b(t._instance)},t.getIeInputMethod=function(e){var t;if(null!=(t=h.l(e)))switch(t){case 4:case 3:return 2;case 2:return 3}return 0},t._instance=null,t}(a.n);(0,r.l)(f,"PointerInputManager",a.n,[o,s.j.$$(Function),Sys.IDisposable])},,,,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(884),o=n(255),a=n(254),s=n(208),l=9984,u=function(e){function t(t,n){void 0===n&&(n=0);var i=e.call(this)||this;return i._startTime=0,i._pageCount=0,i._language=null,i._language=t,i._pageCount=n,i._startTime=(new Date).getTime(),a.AFrameworkApplication.theWsaClient.incrementDw(l,1),i}return(0,i.t)(t,e),t.prototype.start=function(t){o.ULS.sendTraceTag(23184016,301,50,"Translation started"),e.prototype.start.call(this,t)},t.prototype.onCancel=function(t){e.prototype.onCancel.call(this,t),a.AFrameworkApplication.theWsaClient.incrementDw(9986,1),o.ULS.sendTraceTag(40953793,301,50,"Translation canceled")},t.prototype.onSuccess=function(e){var t=(new Date).getTime()-this._startTime;a.AFrameworkApplication.theWsaClient.setDw(9985,t),this.redirect(),o.ULS.sendTraceTag(23184017,301,50,"Translation succeeded")},t.prototype.get_waitMessage=function(){return this._pageCount>=10?CommonUIStrings.l_WaitForLongTranslation:CommonUIStrings.l_WaitForTranslation},t.prototype.get_dismissWaitUIOnSuccess=function(){return!1},t.prototype.getErrorMessage=function(e){return"TranslationServiceUnavailable"===e?CommonUIStrings.l_TranslationServiceUnavailable:"DocumentCannotBeTranslated"===e?CommonUIStrings.l_DocumentCannotBeTranslated:"DocumentHasOCX"===e?CommonUIStrings.l_DocumentCannotBeTranslatedOCX:"DocumentTooLong"===e?CommonUIStrings.l_DocumentCannotBeTranslatedLength:CommonUIStrings.l_GenericTranslationError},t.prototype.isDocumentIssue=function(e){return"DocumentCannotBeTranslated"===e||"DocumentHasOCX"===e||"DocumentTooLong"===e},t}(r.j);(0,s.l)(u,"TranslateDocumentRequest",r.j,[]);var c=n(941),p=n(322),d=n(917),h=n(851),g=n(154);n.d(t,{TranslateDocumentRequestFromViewer:function(){return m}});var m=function(e){function t(t){return e.call(this,t,c.App.get_instance().theDocument.get_pageCount())||this}return(0,i.t)(t,e),t.prototype.redirect=function(){var e=h.n.addOrReplaceParameterValue(window.self.location.href,"language",this._language);g.g.openWindow(1,e)},t.prototype.propagateError=function(e){d.u.propagateError(!1,"TranslationFailed",p.i.itemNotGenerated,e)},t.prototype.get_requestUri=function(){return c.App.get_instance().getDocDataUri(this._language)},t}(u);(0,s.l)(m,"TranslateDocumentRequestFromViewer",u,[])},,,,function(e,t,n){"use strict";n.d(t,{u:function(){return i}});var i=(0,n(208).y)("IO365ShellActor")},function(e,t,n){"use strict";n.r(t);var i=n(208),r=n(809),o=n(504),a=n(244),s=n(795),l=(0,i.y)("INotifyCompletion"),u=function(){function e(e){this._task=null,this._task=e}return e.prototype.onCompleted=function(e){this._task.OC(e,null,0,null)},e.prototype.get_isCompleted=function(){return this._task.get_isCompleted()},e.prototype.getResult=function(){if(this._task.get_isFaulted())throw this._task.get_exception();if(this._task.get_isCanceled())throw s.r.CreateCancellationException()},e}();(0,i.l)(u,"TaskAwaiter",null,[l]);var c=function(){return function(e,t,n){this.handler=null,this.taskHandler=null,this.task=null,this.token=null,this.taskScheduler=null,this.options=0,this.token=e,this.options=t,this.taskScheduler=n}}();(0,i.l)(c,"Continuation",null,[]);var p=n(667),d=function(){function e(){this.$$pf_IsCompleted=!1,this._actions=new Array(0),p.a.RunOnSpecific(i.i(this,this.Complete,"Complete"),null)}return e.prototype.Complete=function(){this.set_isCompleted(!0);for(var e=0,t=this._actions;e<t.length;e++){(0,t[e])()}},e.prototype.get_isCompleted=function(){return this.$$pf_IsCompleted},e.prototype.set_isCompleted=function(e){return this.$$pf_IsCompleted=e,e},e.prototype.getResult=function(){},e.prototype.onCompleted=function(e){this.get_isCompleted()?e():Array.add(this._actions,e)},e.prototype.getAwaiter=function(){return this},e}();(0,i.l)(d,"YieldAwaitable",null,[l]),n.d(t,{Task:function(){return h}});var h=function(){function e(){this._continuations=null,this._action=null,this._actionWithData=null,this._taskScheduler=null,this._cancelationToken=null,this._exception=null,this._data=null,this.$$pf_Status=0,this.set_status(1)}return e.prototype.get_asyncState=function(){return this._data},e.prototype.get_id=function(){return this._id||(this._id=++e._nextTaskId),this._id},e.prototype.get_status=function(){return this.$$pf_Status},e.prototype.set_status=function(e){return this.$$pf_Status=e,e},e.prototype.get_exception=function(){return this._exception},e.prototype.set_exception=function(e){return s.r.isCancellationException(e)?this.setCanceled():(this._exception=e,this.setCompleted(!1)),e},e.prototype.get_isCanceled=function(){return 4===this.get_status()},e.prototype.get_isCompleted=function(){return this.get_status()>3},e.prototype.get_isFaulted=function(){return 5===this.get_status()},e.prototype.g=function(){return new u(this)},e.prototype.onCompleted_Synchronous_Deprecated=function(e){this.get_isCompleted()?e():this.g().onCompleted(e)},e.prototype.setCanceled=function(){this.TrySetCanceled(!1)||e.ThrowNotActive()},e.prototype.TrySetCanceled=function(e){return!this.get_isCompleted()&&(!(!e&&3===this.get_status())&&(this.set_status(4),this.RunAllContinuations(),!0))},e.prototype.setCompleted=function(t){this.TrySetCompleted(t)||e.ThrowNotActive()},e.prototype.TrySetCompleted=function(e){return!this.get_isCompleted()&&(this.set_status(e?6:5),this.RunAllContinuations(),!0)},e.prototype.RunAllContinuations=function(){var e=this._continuations;this._continuations=null;var t=!1;if(e)for(var n=0,i=e;n<i.length;n++){var r=i[n];t=this.TriggerContinuation(r)||t}this.get_exception()&&!t&&p.a.PublishUnobservedTaskException(this,this.get_exception())},e.prototype.TriggerContinuation=function(t){var n=this;if(t.token&&t.token.get_isCancellationRequested())return t.task&&t.task.TrySetCanceled(!1),!1;var i=this.CheckShouldExecute(t);if(t.task)e.ContinueTask(t,i,t.taskScheduler);else{var r=t.handler||function(){t.taskHandler(n)};e.ContinueAction(t,i,t.taskScheduler,r)}return i},e.prototype.CheckShouldExecute=function(e){return!(this.get_isFaulted()&&2&e.options)&&(!(this.get_isCanceled()&&1&e.options)&&!(6===this.get_status()&&4&e.options))},e.prototype.AddContinuation=function(e,t,n,i){var o=(0,r.m)(new c(t,n,i),{task:e});this.AddContinuationInternal(o)},e.prototype.OC=function(e,t,n,i){var o=(0,r.m)(new c(t,n,i),{handler:e,token:t,taskScheduler:i});this.AddContinuationInternal(o)},e.prototype.OCT=function(e,t,n,i){var o=(0,r.m)(new c(t,n,i),{taskHandler:e,token:t,taskScheduler:i});this.AddContinuationInternal(o)},e.prototype.AddContinuationInternal=function(e){var t=this;if(e.taskScheduler=e.taskScheduler||p.a.get_current(),e.token&&e.task){if(e.token.get_isCancellationRequested()&&this.HandleCancelation(e))return;e.token.R((function(){t.HandleCancelation(e)}))}this.get_isCompleted()?this.TriggerContinuation(e):this._continuations=o.o(c,this._continuations,e)},e.prototype.HandleCancelation=function(e){return!!e.task&&e.task.TrySetCanceled(!1)},e.prototype.CW=function(e){var t=n(93).ContinuableTask.C(e,this);return this.AddContinuation(t,null,0,null),t},e.prototype.CWC=function(e,t){var i=n(93).ContinuableTask.C(e,this);return this.AddContinuation(i,t,0,null),i},e.prototype.CWo=function(e,t){var i=n(93).ContinuableTask.C(e,this);return this.AddContinuation(i,null,t,null),i},e.prototype.CWT=function(e,t){var i=n(93).ContinuableTask.C(e,this);return this.AddContinuation(i,null,0,t),i},e.prototype.CWO=function(e,t){var i=n(93).ContinuableTask.CO(e,t,this);return this.AddContinuation(i,null,0,null),i},e.prototype.CWOC=function(e,t,i){var r=n(93).ContinuableTask.CO(e,t,this);return this.AddContinuation(r,i,0,null),r},e.prototype.CWOo=function(e,t,i){var r=n(93).ContinuableTask.CO(e,t,this);return this.AddContinuation(r,null,i,null),r},e.prototype.CWOT=function(e,t,i){var r=n(93).ContinuableTask.CO(e,t,this);return this.AddContinuation(r,null,0,i),r},e.prototype.CWCT=function(e,t,i,r){var o=n(93).ContinuableTask.C(e,this);return this.AddContinuation(o,t,i,r),o},e.prototype.CWOCT=function(e,t,i,r,o){var a=n(93).ContinuableTask.CO(e,t,this);return this.AddContinuation(a,i,r,o),a},e.prototype.CWR=function(e,t){var i=n(272).ContinuableTask$1.$$(e).C(t,this);return this.AddContinuation(i,null,0,null),i},e.prototype.CWRCC=function(e,t,i){var r=n(272).ContinuableTask$1.$$(e).C(t,this);return this.AddContinuation(r,i,0,null),r},e.prototype.CWRCo=function(e,t,i){var r=n(272).ContinuableTask$1.$$(e).C(t,this);return this.AddContinuation(r,null,i,null),r},e.prototype.CWRT=function(e,t,i){var r=n(272).ContinuableTask$1.$$(e).C(t,this);return this.AddContinuation(r,null,0,i),r},e.prototype.CWRO=function(e,t,i){var r=n(272).ContinuableTask$1.$$(e).CO(t,i,this);return this.AddContinuation(r,null,0,null),r},e.prototype.CWRCT=function(e,t,i,r,o){var a=n(272).ContinuableTask$1.$$(e).C(t,this);return this.AddContinuation(a,i,r,o),a},e.prototype.CWROCT=function(e,t,i,r,o,a){var s=n(272).ContinuableTask$1.$$(e).CO(t,i,this);return this.AddContinuation(s,r,o,a),s},e.prototype.start=function(){this.Start$Scheduler(p.a.get_current())},e.prototype.Start$Scheduler=function(e){if(1!==this.get_status())throw Error.invalidOperation();this._taskScheduler=e,this.set_status(2),e.queueTask(this)},e.prototype.TryExecute=function(){if(this._cancelationToken&&this._cancelationToken.get_isCancellationRequested())return this.get_isCompleted()||this.setCanceled(),!1;if(this.get_isCompleted())return!1;var e=p.a.get_current();return this._taskScheduler=this._taskScheduler||p.a.get_current(),p.a.set_current(this._taskScheduler||p.a.get_current()),this.runSynchronously(),p.a.set_current(e),!0},e.prototype.runSynchronously=function(){this.set_status(3);try{if(!this.execute())throw Error.invalidOperation();this.setCompleted(!0)}catch(e){s.r.isCancellationException(e)?this.TrySetCanceled(!0):this.set_exception(e)}},e.prototype.execute=function(){if(this._action)this._action();else{if(!this._actionWithData)return!1;this._actionWithData(this._data)}return!0},e.get_factory=function(){return e._factory},e.Create=function(t){return(0,r.m)(new e,{_action:t})},e.Create$object=function(t,n){return(0,r.m)(new e,{_actionWithData:t,_data:n})},e.ThrowNotActive=function(){throw Error.invalidOperation()},e.ContinueAction=function(e,t,n,i){t&&(8&e.options?i():p.a.RunOnSpecific(i,n))},e.ContinueTask=function(e,t,n){var i=e.task;t?8&e.options?i.TryExecute():1===i.get_status()&&(i._cancelationToken=e.token,i.Start$Scheduler(n||p.a.get_current())):i.setCanceled()},e.delay=function(e){var t=new(n(720).CompletableTask);return window.setTimeout(i.i(t,t.setResult,"setResult"),e),t},e.y=function(){return new d},e.fromResult=function(e,t){var i=new(n(37).CompletableTask$1)(e);return i.setResult(t),i},e.WAA=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return e.WAE(a.asEnumerable(e,t))},e.WAE=function(e){var t=null,i=!1,r=0,a=new(n(720).CompletableTask),s=function(){t?a.SEsA(t):i?a.setCanceled():a.setResult()},l=function(e){e.get_isFaulted()&&(t=o.o(Error,t,e.get_exception())),e.get_isCanceled()&&(i=!0),--r||s()};r++;for(var u=e.$$ge();u.$$mn();){var c=u.$$cu();r++,c.get_isCompleted()?l(c):c.OCT(l,null,0,null)}return--r||s(),a},e.When=function(t){for(var i=new(n(37).CompletableTask$1)(e),r=function(e){i&&(i.setResult(e),i=null)},o=0,a=t;o<a.length;o++){var s=a[o];if(s.get_isCompleted())return e.fromResult(e,s);s.OCT(r,null,0,null)}return i},e.When$Result=function(t,i){for(var r=new(n(37).CompletableTask$1)(n(473).Task$1.$$(t)),o=function(e){r&&(r.setResult(e),r=null)},a=i.$$ge();a.$$mn();){var s=a.$$cu();if(s.get_isCompleted())return e.fromResult(n(473).Task$1.$$(t),s);s.OCT((function(e){o(e)}),null,0,null)}return r},e._nextTaskId=0,e}();(0,i.l)(h,"Task",null,[])},function(e,t,n){"use strict";n.d(t,{h:function(){return o}});var i=n(556),r=n(208),o=function(){function e(){}return e.get_staticContentQueryParameter=function(){return e._StaticContentQueryParameter},e.set_staticContentQueryParameter=function(t){return e._StaticContentQueryParameter=t?t.replace("&","&amp;"):"",t},e.removeBroltiFlightFromStaticContentQueryParameter=function(t){return t&&((t=t.replace("?UseBrotli=true",""))!==e.get_staticContentQueryParameter()&&""!==t&&(t="?"+t),t=t.replace("&UseBrotli=true","")),t},e.get_pagePath=function(){return e._pagePath||(e._pagePath=e._prefixExp.exec(document.URL)[1])},e.get_pageBase=function(){return e._pageBase||(e._pageBase=e._absolutePatExp.exec(e.get_pagePath())[1])},e.get_pageHost=function(){return e._pageHost||(e._pageHost=new RegExp("^([a-z+.-]+://[^/]*)").exec(document.URL)[1])},e.commonImage=function(t){return e.sharedStaticContentHost+e.commonImageBase+i.l.escape(t)+e.removeBroltiFlightFromStaticContentQueryParameter(e.get_staticContentQueryParameter())},e.commonCss=function(t){return e.sharedStaticContentHost+e.commonCssBase+i.l.escape(t)+e.get_staticContentQueryParameter()},e.commonScripts=function(t){return e.commonScriptsPath(t)+e.get_staticContentQueryParameter()},e.commonScriptsPath=function(t){return e.sharedStaticContentHost+e.commonScriptsBase+i.l.escape(t)},e.commonScriptsLocalized=function(t){return e.sharedStaticContentHost+e.commonScriptsLcidBase+i.l.escape(t)+e.get_staticContentQueryParameter()},e.combineUrlPaths=function(e,t){return e?e.endsWith("/")?e+t:e+"/"+t:t},e.isAbsolute=function(t){return e._absolutePatExp.test(e._prefixExp.exec(t)[1])},e.absolutePath=function(t){return e.isAbsolute(t)?t:t.startsWith("/")?e.get_pageHost()+t:t.startsWith("~")?null:e.get_pageBase()+t},e.commonImageLocation=function(t){var n=e.commonImage(t);return n.substring(0,n.length-t.length)},e.commonImageBase=null,e.commonCssBase=null,e.commonScriptsBase=null,e.commonScriptsLcidBase=null,e._StaticContentQueryParameter=null,e.staticContentHost=null,e.sharedStaticContentHost=null,e._prefixExp=new RegExp("^([^?]+)"),e._absolutePatExp=new RegExp("^([a-z+.-]+://(?:[^/]*/)*)[^/]*$"),e._pagePath=null,e._pageBase=null,e._pageHost=null,e}();(0,r.l)(o,"CommonPath",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=n(239),a=n(255),s=n(488),l=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.x=0,o.y=0,o.launcherHeight=0,o.launcherWidth=0,o.launcherHeight=0,o.launcherWidth=0,o}return(0,i.t)(t,e),t.prototype.get_x=function(){return this.x},t.prototype.get_y=function(){return this.y},t.prototype.get_launcherHeight=function(){return this.launcherHeight},t.prototype.get_launcherWidth=function(){return this.launcherWidth},t.prototype.get_needsAKeytip=function(){return!1},t.prototype.get_menuDirection=function(){return 4},t.prototype.setInitialAriaMenuLauncherAttributes=function(e){},t.prototype.updateAriaMenuLauncherAttributes=function(e,t){},t.prototype.launchContextMenuAt=function(e,t,n){this.launchContextMenuAtLauncher(new Sys.UI.Bounds(e,t,0,0),n)},t.prototype.launchContextMenuAtLauncher=function(e,t){this.x=e.x,this.y=e.y,this.launcherHeight=e.height,this.launcherWidth=e.width,this.launchMenu(t)},t}(s.MenuLauncher);(0,r.l)(l,"ContextMenuLauncher",s.MenuLauncher,[]);var u=n(951),c=n(920),p=n(946),d=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o.m_elmDefault=null,o.addDisplayMode("Menu"),o}return(0,i.t)(t,e),t.prototype.get_controlType=function(){return u.Control.contextMenuControlType},t.prototype.createComponentDomForDisplayMode=function(e){return this.m_elmDefault=p.n.createElement("span"),new c.d(e,this.m_elmDefault)},t.prototype.get_properties$3=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t}(l);(0,r.l)(d,"ContextMenuControl$0",l,[]);var h=n(861),g=n(513),m=n(45);n.d(t,{ContextMenuRoot:function(){return _}});var _=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i._activeFloatie=null,i._activeMenu=null,i}return(0,i.t)(t,e),t.prototype.get_activeFloatie=function(){return this._activeFloatie},t.prototype.set_activeFloatie=function(e){return this._activeFloatie=e,e},t.prototype.get_hasActiveFloatie=function(){return!(void 0===this.get_activeFloatie()||null===this.get_activeFloatie())},t.prototype.get_activeMenu=function(){return this._activeMenu},t.prototype.refreshInternal=function(){e.prototype.refreshInternal.call(this),g.x(this.get_elementInternal())&&this.ensureDOMElement(),this.set_elementInternal(p.n.removeChildNodes(this.get_elementInternal())),this.appendChildrenToElement(this.get_elementInternal()),this.set_dirty(!1)},t.prototype.get_rootType=function(){return 19},t.prototype.get_contextMenuRootProperties=function(){return this.get_properties()},t.prototype.ensureCorrectChildType=function(e){if(!r.r(m.z,e))throw Error.create("Only children of type StandaloneDock can be added to a ContextMenuRoot")},t.prototype.createContextMenu=function(e,t,n,i,r){var o=new h.Menu(this,t,n,i,null);e||(e={}),e.CommandMenuOpen=this.get_contextMenuRootProperties().CommandMenuOpen,e.CommandMenuClose=this.get_contextMenuRootProperties().CommandMenuClose;var a=new d(this,t+"Launcher",e,o);this.get_createdControls()[t]=a;var s=new m.z(this,"dock"+t);s.addChild(a.createComponentForDisplayMode("Menu")),this.addChild(s),this.refresh()},t.prototype.showContextMenuAt=function(e,t,n,i){this.showContextMenuAtLauncher(e,new Sys.UI.Bounds(t,n,0,0),i),a.ULS.sendTraceTag(36497229,207,50,"ContextMenu launched for Id: {0}",e)},t.prototype.showContextMenuAtLauncher=function(e,t,n){var i=this.get_createdControls()[e];if(g.x(i))throw Error.create('The context menu "'+e+'" does not exist');i.launchContextMenuAtLauncher(t,n),this._activeMenu=i.get_menu()},t.prototype.onMenuStackCleared=function(){this.get_hasActiveFloatie()&&(this._activeFloatie.dismissFloatie(),this._activeFloatie=null),this._activeMenu=null},t.prototype.dispose=function(){var t=this.get_createdControls();for(var n in t){({key:n,value:t[n]}).value.dispose()}e.prototype.dispose.call(this)},t}(o.w);(0,r.l)(_,"ContextMenuRoot",o.w,[])},,,,function(e,t,n){"use strict";var i=n(508),r=n(208),o=(0,r.y)("IFileMenuSQMInformation"),a=n(861),s=n(614),l=n(254),u=function(){function e(){}return e.pageId="PageId",e}();(0,r.l)(u,"FileMenuSQMProperties",null,[]);var c=n(400),p=n(66),d=n(235);n.d(t,{m:function(){return h}});var h=function(e){function t(t,n,i,r,o,a){return e.call(this,t,n,i,r,o,a)||this}return(0,i.t)(t,e),t.prototype.get_cssClass=function(){return e.prototype.get_cssClass.call(this)+" "+t.jewelSubmenuClass},t.prototype.onPointerOut=function(e){return!1},t.prototype.onMenuClosed=function(){c.h(this.get_elementInternal(),l.AFrameworkApplication.get_activeFrame().get_activeModalUIZIndex()+1),e.prototype.onMenuClosed.call(this)},t.prototype.setFocus=function(t){if(d.w.get_instance().tryResolve(o)){var n={};n[u.pageId]=this.get_id(),l.AFrameworkApplication.get_theActionManager().processActionWithData(s.FH,2,n)}e.prototype.setFocus.call(this,2)},t.prototype.onKeyPress=function(t){var n=t.innerEvent.rawEvent;return!(n&&n.keyCode===p.v.vK_Enter&&n.target&&"a"===n.target.tagName.toLowerCase()&&n.target.href&&"#"!==n.target.href)&&e.prototype.onKeyPress.call(this,t)},t.jewelSubmenuClass="cui-jewelsubmenu",t}(a.Menu);(0,r.l)(h,"JewelSubMenu",a.Menu,[])},function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=n(840),a=n(550),s=n(390),l=n(732),u=n(877),c=n(255),p=n(605),d=n(306),h=n(574),g=n(66),m=n(446),_=n(425),f=function(e){function t(t,n,i){return e.call(this,t,n,i,1)||this}return(0,i.t)(t,e),t.prototype.get_commandKey=function(){var e=this.innerEvent.rawEvent;return!!e&&(_.y.get_isMac()?e.metaKey:e.ctrlKey)},t.create=function(e,n){return new t(e,m.a.getSourceElement(n),n)},t}(m.a);(0,r.l)(f,"KeyEventArgs",m.a,[]);var y=n(586),v=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.add_onCtrlKeyDown=function(e){this.addHandler(t.onCtrlKeyDownEventKey,e)},t.prototype.remove_onCtrlKeyDown=function(e){this.removeHandler(t.onCtrlKeyDownEventKey,e)},t.prototype.add_onCtrlKeyUp=function(e){this.addHandler(t.onCtrlKeyUpEventKey,e)},t.prototype.remove_onCtrlKeyUp=function(e){this.removeHandler(t.onCtrlKeyUpEventKey,e)},t.instance=function(){return t._instance||(t._instance=new t)},t.onCtrlKeyDownEventKey="OnCtrlKeyDown",t.onCtrlKeyUpEventKey="OnCtrlKeyUp",t._instance=null,t}(y.f);(0,r.l)(v,"PressCtrlKeyEvent",y.f,[]);var S=n(978),C=function(){function e(){this.keyCode=0}return e.getAnInstanceWithResolvedDependencies=function(){return new S.q(e,(function(){return new e}))},e.get_instance=function(){return e._instance.get_value()},e._instance=e.getAnInstanceWithResolvedDependencies(),e}();(0,r.l)(C,"PressOnlyKeyArgs",null,[]);var b=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.add_onKeyCodeWasPressedOnly=function(e){this.addHandler(t.onKeyCodeWasPressedOnlyEventKey,e)},t.prototype.remove_onKeyCodeWasPressedOnly=function(e){this.removeHandler(t.onKeyCodeWasPressedOnlyEventKey,e)},t.instance=function(){return t._instance||(t._instance=new t)},t.onKeyCodeWasPressedOnlyEventKey="OnKeyCodeWasPressedOnly",t._instance=null,t}(y.f);(0,r.l)(b,"PressOnlyKeyEvent",y.f,[]);var A=n(810),T=n(101),w=n(556);n.d(t,{KeyInputManager:function(){return I}});var I=function(e){function t(t,n,i,r){var o=e.call(this)||this;return o._eventHandlerManager=null,o._capturedHandler=null,o._focusManager=null,o._pressOnlyKeyEvent=null,o._pressCtrlKeyEvent=null,o._currentEventArgs=null,o._forwardKeyPressToKeyDown=!0,o._isAltRight=!1,o._keyEvents=[h.d.keyUp,h.d.keyDown,h.d.keyPress],o._keyDownValues=new l.e(Number,u.g.get_default()),o._lastKeyStroke=new Date,o._lastKeyDownReceived=-1,o._eventHandlerManager=t,o._focusManager=n,o._supressEvents=!1,o._capturedHandler=null,o._pressOnlyKeyEvent=i,o._pressCtrlKeyEvent=r,o._lastKeyStroke=new Date,o}return(0,i.t)(t,e),t.prototype.get_lastKeyStroke=function(){return this._lastKeyStroke},t.prototype.get_currentKeyEvent=function(){return this._currentEventArgs},t.prototype.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeListForElement(h.d.get_keyEvents(),t.ownerDocument,2,r.i(this,this.onKeyEvent,"onKeyEvent"))},t.prototype.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeListForElement(t.ownerDocument,h.d.get_keyEvents())},t.prototype.registerHandler=function(e,t,n){this.registerHandlerWithCaptureOption(e,t,n)},t.prototype.registerHandlerWithCaptureOption=function(e,t,n,i){void 0===i&&(i=!1),this._eventHandlerManager.registerHandler(f,e,t,2,r.i(this,this.onKeyEvent,"onKeyEvent"),n,null,i)},t.prototype.registerHandlerForAllKeyEvents=function(e,t){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];for(var r=function(e){return!!Array.contains(n,e.innerEvent.keyCode)&&(e.eventName!==h.d.keyUp||t(e))},o=0,a=this._keyEvents;o<a.length;o++){var s=a[o];this.registerHandler(s,e,r)}return r},t.prototype.registerHandlerWithData=function(e,t,n,i){this._eventHandlerManager.registerHandler(f,e,t,2,r.i(this,this.onKeyEvent,"onKeyEvent"),n,i)},t.prototype.registerHandlerWithDocument=function(e,t,n,i){void 0===i&&(i=null),this._eventHandlerManager.registerHandler(f,e,t,2,r.i(this,this.onKeyEvent,"onKeyEvent"),n,i)},t.prototype.unregisterHandler=function(e,t,n){this.unregisterHandlerWithCaptureOption(e,t,n)},t.prototype.unregisterHandlerWithCaptureOption=function(e,t,n,i){void 0===i&&(i=!1),this._eventHandlerManager.unregisterHandler(f,e,t,n,i)},t.prototype.unregisterHandlerForAllKeyEvents=function(e,t){for(var n=0,i=this._keyEvents;n<i.length;n++){var r=i[n];this.unregisterHandler(r,e,t)}},t.prototype.unregisterHandlerWithDocument=function(e,t,n){this._eventHandlerManager.unregisterHandler(f,e,t,n)},t.prototype.capture=function(e,t){this._capturedHandler=new p.a(f,e,t)},t.prototype.releaseCapture=function(){this._capturedHandler=null},t.prototype.resume=function(){e.prototype.resume.call(this),this._forwardKeyPressToKeyDown=!0},t.prototype.fireKeyEvent=function(e,t,n,i){var r=1==(1&i),o=2==(2&i),a=4==(4&i),s=8==(8&i);if(t.createEvent){var l=t.createEvent("KeyboardEvent"),u="";switch(e){case h.d.keyDown:u="keydown";break;case h.d.keyUp:u="keyup";break;case h.d.keyPress:u="keypress"}if(l.initKeyEvent)l.initKeyEvent(u,!0,!0,t.parentWindow,o,r,a,s,n,0);else if(l.initKeyboardEvent){for(var c=w.l.charCodeAt(w.l.toUpper(w.l.fromCharCode(n)),0),p=w.l.getHexString(c);p.length<4;)p="0"+p;p="U+"+p,l.initKeyboardEvent(u,!1,!0,t.defaultView,p,0,o,r,a,s,!1)}t.dispatchEvent(l)}else if(t.createEventObject){u="";switch(e){case h.d.keyDown:u="keydown";break;case h.d.keyUp:u="keyup";break;case h.d.keyPress:u="keypress"}(l=t.createEventObject()).keyCode=n,l.altKey=r,l.ctrlKey=o,l.shiftKey=a,l.metaKey=s,t.body.fireEvent("on"+u,l)}},t.prototype.rerouteKeyEvent=function(e,t,n){this.onKeyEvent(t,n,e)},t.prototype.processKeyActions=function(e){if(A.y.get_instance().get_isYielding())return c.ULS.sendTraceTag(24699481,324,50,"Key event dropped."),!0;var t=this._focusManager.processInput(e);return 4!==t&&(a.n.cancelEvent(e),2!==t)},t.prototype.onKeyEvent=function(e,t,n){var i=this.onKeyEventInternal(e,t,n);return this._postEventCallback(),i},t.prototype.onKeyEventInternal=function(e,i,r){var o=!1;if(n(657).FocusManager.instance().tryGrabFocus(n(254).AFrameworkApplication.postmessageFocusId),_.y.get_isMac()&&_.y.get_isFirefox())if(e===h.d.keyDown)this._forwardKeyPressToKeyDown=!1,this._lastKeyDownReceived=r.keyCode;else if(e===h.d.keyPress){if(this._forwardKeyPressToKeyDown&&!o){var a=r.keyCode;r.keyCode=this._lastKeyDownReceived,o=this.processKeyEvent(r,h.d.keyDown,i),r.keyCode=a}this._forwardKeyPressToKeyDown=!0}if(e===h.d.keyPress&&_.y.get_isFirefox()&&(!(n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BypassNonPrintableKeysCheckForKeyPressEvent")&&!!window.event)&&t.getKeyCodeFromDomEvent(r)||r.altKey||r.ctrlKey||t.getFieldFromDomEvent(r,"metaKey")))return!1;return e===h.d.keyDown&&_.y.get_isIPad()&&(_.y.get_iPadOsVersion()<=6||i===window.document)&&window.focus(),o||(o=this.processKeyEvent(r,e,i)),o},t.prototype.processKeyEvent=function(e,n,i){if(!this.get_isEnabled())return!1;if(this._supressEvents)return a.n.cancelEvent(e),!0;if(this._lastKeyStroke=new Date,a.n.ensureAppAwake(),this._capturedHandler)return this._currentEventArgs=f.create(n,e),this._capturedHandler.handler(this._currentEventArgs),a.n.cancelEvent(e),this._currentEventArgs=null,!0;var r=t.getBeforeKeyEventName(n);this._currentEventArgs=f.create(r,e);var o=this._eventHandlerManager.processEvent(f,r,i,this._currentEventArgs);return o?(this._currentEventArgs=null,!1):(n===h.d.keyDown&&(this._keyDownValues.add(e.keyCode),o=this.processKeyActions(e),this.raiseKeyDownEvents(e)),n===h.d.keyUp&&this.keyUpHandler(e),o||(this._currentEventArgs=f.create(n,e),o=this._eventHandlerManager.processEvent(f,n,i,this._currentEventArgs)),o&&a.n.cancelEvent(e),this._currentEventArgs=null,o)},t.prototype.raiseKeyDownEvents=function(e){e.keyCode===(_.y.get_isMac()?g.v.vK_Meta:g.v.vK_Ctrl)&&this._pressCtrlKeyEvent.raiseEvent(v.onCtrlKeyDownEventKey)},t.prototype.keyUpHandler=function(e){if(1===this._keyDownValues.get_count()&&(e.keyCode===g.v.vK_Ctrl||e.keyCode===g.v.vK_RightCtrl||e.keyCode===g.v.vK_Shift||e.keyCode===g.v.vK_Alt||e.keyCode===g.v.vK_ContextMenu)){var t=C.get_instance();t.keyCode=e.keyCode,this._pressOnlyKeyEvent.raiseEvent(b.onKeyCodeWasPressedOnlyEventKey,t)}this._keyDownValues=new l.e(Number,u.g.get_default()),e.keyCode===(_.y.get_isMac()?g.v.vK_Meta:g.v.vK_Ctrl)&&this._pressCtrlKeyEvent.raiseEvent(v.onCtrlKeyUpEventKey)},t.prototype.setAltRight=function(e){var n=t.getFieldFromDomEvent(e,"location");this._isAltRight=null==n||1!==n},t.prototype.handleAltGr=function(e,t){return(e||t)&&this._isAltRight?":G":":A"},t.get_commandKeyModifier=function(){return _.y.get_isMac()?8:2},t.get_instance=function(){return t._instance||(t._instance=t.getInstance()),t._instance},t.get_usable=function(){return!!t._instance},t.getInstance=function(){return new t(d.EventHandlerManager.get_instance(),n(657).FocusManager.instance(),b.instance(),v.instance())},t.disposeInputManager=function(){T.b(t._instance),t._instance=null},t.isKeyEventName=function(e){return Array.contains(h.d.get_keyEvents(),e)},t.isImeKeyPress=function(e){var t;return t=void 0===e.innerEvent.keyCode||null===e.innerEvent.keyCode?e.innerEvent.charCode:e.innerEvent.keyCode,w.l.isEastAsianChar(t)},t.getBeforeKeyEventName=function(e){switch(e){case h.d.keyDown:return h.d.beforeKeyDown;case h.d.keyUp:return h.d.beforeKeyUp;case h.d.keyPress:return h.d.beforeKeyPress;default:return e}},t.hashEvent=function(e){e.keyCode===g.v.vK_Alt&&t.get_instance().setAltRight(e);var n=e.keyCode!==g.v.vK_Ctrl&&e.ctrlKey,i=e.keyCode!==g.v.vK_Windows&&t.getFieldFromDomEvent(e,"metaKey"),r=void 0===e.keyCode||null===e.keyCode?g.v.vK_UNDEFINED:e.keyCode;return t.hash(r,e.altKey,n,e.shiftKey,i,!0)},t.hasKeyModifiers=function(e){if(e&&e.innerEvent.rawEvent){var t=e.innerEvent.rawEvent;return t.ctrlKey||t.shiftKey||t.altKey||t.metaKey}return!1},t.hashKeyString=function(e){var t=e.indexOf(":"),n=(-1===t?e:e.substring(0,t)).toLowerCase(),i=g.v.fromString(n).toString()+(t>0?e.substr(t):"");return i=i.replace(":X",_.y.get_isMac()?":M":":C")},t.hashKey=function(e,n){return t.hash(e,1==(1&n),2==(2&n),4==(4&n),8==(8&n),!1)},t.hash=function(e,n,i,r,o,a){var s=e.toString();return n&&(s+=a?t.handleAltGrHelper(i,o):":A"),r&&(s+=":S"),i&&(s+=":C"),o&&(s+=":M"),s},t.handleAltGrHelper=function(e,n){return t.get_instance().handleAltGr(e,n)},t.getKeyCodeFromDomEvent=function(e){return e?e.rawEvent?e.rawEvent.keyCode:e.keyCode:0},t.getFieldFromDomEvent=function(e,t){return e?e.rawEvent?e.rawEvent[t]:e[t]:null},t._instance=null,t}(a.n);(0,r.l)(I,"KeyInputManager",a.n,[o.i,s.j.$$(Function),Sys.IDisposable])},,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=n(58),a=n(449),s=n(485),l=n(978),u=n(255),c=n(614),p=n(254),d=(0,r.y)("IAdaptiveLayout"),h=n(790),g=n(201),m=function(){function e(){this._regionNames=null}return e.prototype.get_regionNames=function(){return this._regionNames||(this._regionNames=new h.d(String,String,g.b.get_ordinalIgnoreCase()),this._regionNames.add("Header","Header"),this._regionNames.add("Ribbon","Ribbon"),this._regionNames.add("NotificationBar","NotificationBar"),this._regionNames.add("BusinessBar","BusinessBar"),this._regionNames.add("Canvas","Canvas"),this._regionNames.add("FarPane","FarPane"),this._regionNames.add("StatusBar","StatusBar")),this._regionNames},e.prototype.getRegion=function(e){return null},e.prototype.registerBoundingWindowRectsChanged=function(e,t){},e.prototype.unregisterBoundingWindowRectsChanged=function(e,t){},e.prototype.registerLayoutBreakpointChanged=function(e,t){},e.prototype.unregisterLayoutBreakpointChanged=function(e){},e.prototype.getLayoutBreakpoint=function(){return"Default"},e.prototype.getWindowMode=function(){return"undefined"},e.prototype.getKeyboardSegment=function(){return null},e.prototype.getWindowRectsWithoutKeyboard=function(){return null},e}();(0,r.l)(m,"AAdaptiveLayout",null,[d]);var _=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t}(m);(0,r.l)(_,"AdaptiveLayoutEmptyImpl",m,[]);var f=n(892),y=function(){return function(){this.selector=null,this.definition=null,this.index=0}}();(0,r.l)(y,"CssRule",null,[]);var v=function(){function e(e,t,n,i){this._parentSheet=null,this._readOnly=!1,this._model=0,this._broswerRule=null,this._model=e,this._broswerRule=t,this._parentSheet=n,this._readOnly=i}return e.prototype.get_style=function(){return this._broswerRule.style},e.prototype.get_selectorText=function(){return this._broswerRule.selectorText},e.prototype.get_parentSheet=function(){return this._parentSheet},e.prototype.get_isReadOnly=function(){return this._readOnly},e}();(0,r.l)(v,"StyleRule",null,[]);var S=n(550),C=n(478),b=function(){function e(e,t,n,i,r){this._model=0,this._browserSheet=null,this._styleElement=null,this._styleElementOnLoad=null,this._ownerDocument=null,this._retryDelay=0,this._retryAttempts=0,this._onLoadCallbacks=null,this._loaded=!1,this._pendingCssRules=null,this._readOnly=!1,this._onLoadCallbacks=[],this._ownerDocument=e,this._model=t,this._browserSheet=n,this._styleElement=i,this._readOnly=r,this._loaded=!r,this._pendingCssRules=[]}return e.prototype.dispose=function(){this._styleElement=null,this._browserSheet=null,this._ownerDocument=null},e.prototype.remove=function(){this._browserSheet&&this._styleElement&&this._styleElement.parentNode.removeChild(this._styleElement)},e.prototype.addLoadHandler=function(e){e&&(this._loaded?e(this):(Array.add(this._onLoadCallbacks,e),this._styleElementOnLoad||(this._styleElementOnLoad=r.i(this,this.onLoad,"onLoad"),S.n.addHandler(this._styleElement,"load",this._styleElementOnLoad))))},e.prototype.addRule=function(e,t,n){if(t&&!t.length)throw Error.argument("css definition must be valid css or null");switch(u.ULS.shipAssertTag(17154717,324,this._loaded&&!!this._browserSheet),this._model){case 1:this._browserSheet.addRule(e,t,n);break;case 2:if(this._browserSheet){var i=t||"";this._browserSheet.insertRule(e+" {"+i+"}",n)}else{if(!this._loaded&&this._retryAttempts<5){var r=new y;r.selector=e,r.definition=t,r.index=n,Array.add(this._pendingCssRules,r)}u.ULS.sendTraceTag(17342615,324,15,"Fail to insert Css Rule since _brwoserSheet is null. selector={0} definition={1} index={2} _retryAttempts={3}",e,t,n,this._retryAttempts)}break;default:throw Error.invalidOperation("Unknown stylesheet model detected.")}},e.prototype.removeRule=function(e){switch(u.ULS.shipAssertTag(17154718,324,this._loaded&&!!this._browserSheet),this._model){case 1:this._browserSheet.removeRule(e);break;case 2:this._browserSheet.deleteRule(e)}},e.prototype.getRuleCount=function(){switch(u.ULS.shipAssertTag(17154719,324,this._loaded&&!!this._browserSheet),this._model){case 1:return this._browserSheet.rules.length;case 2:return this._browserSheet.cssRules.length;default:throw Error.invalidOperation("Unknown stylesheet model detected.")}},e.prototype.getRule=function(e){var t;switch(u.ULS.shipAssertTag(17154720,324,this._loaded&&!!this._browserSheet),this._model){case 1:return(t=this._browserSheet.rules.item(e))?new v(1,t,this,this._readOnly):null;case 2:return(t=this._browserSheet.cssRules[e])?new v(1,t,this,this._readOnly):null;default:throw Error.invalidOperation("Unknown stylesheet model detected.")}},e.prototype.get_styleElement=function(){return this._styleElement},e.prototype.get_isReadOnly=function(){return this._readOnly},e.prototype.get_isLoaded=function(){return this._loaded},e.prototype.onLoad=function(e){if(this._browserSheet){this._loaded=!0;for(var t=0;t<this._onLoadCallbacks.length;t++){(0,this._onLoadCallbacks[t])(this)}Array.clear(this._onLoadCallbacks),this._styleElementOnLoad&&(S.n.removeHandler(this._styleElement,"load",this._styleElementOnLoad),this._styleElementOnLoad=null);for(t=0;t<this._pendingCssRules.length;t++){var n=this._pendingCssRules[t],i=n.definition||"";this._browserSheet.insertRule(n.selector+" {"+i+"}",n.index)}Array.clear(this._pendingCssRules)}},e.prototype.findSheet=function(e){for(var t=this._ownerDocument.styleSheets,n=0;n<t.length;n++){var i=t[n].ownerNode;if(this._styleElement===i)return this._browserSheet=t[n],void this.onLoad(null)}++this._retryAttempts<5?(this._retryDelay*=3,this.createFindhCallbackTask()):u.ULS.sendTraceTag(17154721,324,10,"Failed to load stylesheet after max retry attempts, abandoning search")},e.prototype.createFindhCallbackTask=function(){var e=new C.c(2,1,this._retryDelay,r.i(this,this.findSheet,"findSheet"),11);p.AFrameworkApplication.get_theTaskManager().addTask(e)},e.createStyleSheet=function(t,n){return void 0===n&&(n=null),e.createOrImportStyleSheet(t,n)},e.importStyleSheet=function(t,n,i){return e.createOrImportStyleSheet(t,i,n)},e.createOrImportStyleSheet=function(t,n,i){void 0===i&&(i=null);var r=null;return t.createStyleSheet?r=e.createStylesheetUsingCreateStyleSheetFunction(t,i,n):t.styleSheets&&(r=e.createStylesheetUsingStyleSheetsCollection(t,i,n)),r},e.createStylesheetUsingCreateStyleSheetFunction=function(t,n,i){var r=n?t.createStyleSheet(n):t.createStyleSheet(),o=new e(t,1,r,r.owningElement,!!n);return i&&o.addLoadHandler(i),o},e.createStylesheetUsingStyleSheetsCollection=function(t,n,i){var r=n?e.createLinkElement(t,n):e.createStyleElement(t),o=new e(t,2,null,r,!!n);return t.getElementsByTagName("head")[0].appendChild(r),e.attemptToLoadSheet(t,o,r,i),o},e.createLinkElement=function(e,t){var n=e.createElement("link");return n.rel="stylesheet",n.href=t,n.type="text/css",n},e.createStyleElement=function(e){var t=e.createElement("style"),n=e.createTextNode(" ");return t.appendChild(n),t},e.attemptToLoadSheet=function(e,t,n,i){for(var r=e.styleSheets,o=0;o<r.length;o++){if(n===r[o].ownerNode)if(t._browserSheet=r[o],t.addLoadHandler(i),p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SynchronizeStyleSheetExperimentIsEnabled"))t.onLoad(null);else{var a=new C.c(0,1,0,(function(e){t.onLoad(null)}),10);p.AFrameworkApplication.get_theTaskManager().addTask(a)}}t._browserSheet||(t._retryDelay=100,t._loaded=!1,t.addLoadHandler(i),t.createFindhCallbackTask())},e.importStyleSheetFromText=function(e){try{var t=document.createElement("style");return t.type="text/css",t.appendChild(document.createTextNode(e)),document.getElementsByTagName("head")[0].appendChild(t),t}catch(t){u.ULS.sendTraceTag(40137891,210,10,"ImportStyleSheetFromText error message : {0}.",t.message);var n=document.createStyleSheet();return n.cssText=e,n.owningElement}},e}();(0,r.l)(b,"StyleSheet",null,[Sys.IDisposable]);var A=(0,r.y)("ICursorPinningTool"),T=n(773),w=n(101),I="cursorControl",E=function(){function e(t){this._controllerID=0,this._controlledElement=null,this._styleSheet=null,this._selectorText=null,this._numCssRules=0,this._rulesErrorFirstHitTime=0,this._rulesErrorLogged=!1,this._selectors=[],this._cssState=0,this._controllerID=e._currentControllerCount++,this._controlledElement=t,this._selectorText=I+this._controllerID,Array.addRange(this._selectors,["."+this._selectorText,"."+this._selectorText+" *"]),t.id&&""!==t.id&&Array.add(this._selectors,"#"+t.id+" *"),Sys.UI.DomElement.addCssClass(this._controlledElement,this._selectorText)}return e.prototype.dispose=function(){w.b(this._styleSheet),this._styleSheet=null,this._controlledElement=null},e.prototype.setCursor=function(e){switch(e){case 1:this.setCursorString("crosshair");break;case 2:this.setCursorString("pointer");break;case 3:this.setCursorString("move");break;case 4:this.setCursorString("e-resize");break;case 5:this.setCursorString("ne-resize");break;case 6:this.setCursorString("nw-resize");break;case 7:this.setCursorString("n-resize");break;case 8:this.setCursorString("se-resize");break;case 9:this.setCursorString("sw-resize");break;case 10:this.setCursorString("s-resize");break;case 11:this.setCursorString("w-resize");break;case 12:this.setCursorString("text");break;case 13:this.setCursorString("wait");break;case 14:this.setCursorString("help");break;case 20:this.setCursorString("col-resize");break;case 21:this.setCursorString("row-resize");break;case 15:this.setCursorString("not-allowed");break;case 22:this.setCursorString("default")}},e.prototype.setCursorUrl=function(e,t){var n;switch(t){case 1:n="crosshair";break;case 2:n="pointer";break;case 3:n="move";break;case 4:n="e-resize";break;case 5:n="ne-resize";break;case 6:n="nw-resize";break;case 7:n="n-resize";break;case 8:n="se-resize";break;case 9:n="sw-resize";break;case 10:n="s-resize";break;case 11:n="w-resize";break;case 12:n="text";break;case 13:n="wait";break;case 14:n="help";break;case 20:n="col-resize";break;case 21:n="row-resize";break;default:return}this.setCursorString("url('"+e+"'), "+n)},e.prototype.resetCursor=function(){var e=this;this.ensureCssIsLoaded((function(){if(3===e._cssState){for(var t=0;t<e._numCssRules;++t)e.updateCssRuleCursorStyleSafe("",t);e._cssState=2}}))},e.prototype.pinCursor=function(e){var t=T.o.getCurrentStyle(e);t&&this.setCursorString(t.cursor)},e.prototype.setCursorString=function(e){var t=this;this.ensureCssIsLoaded((function(){if(2===t._cssState){for(var n=0;n<t._numCssRules;++n)t.updateCssRuleCursorStyleSafe(e,n);t._cssState=3}}))},e.prototype.updateCssRuleCursorStyleSafe=function(e,t){var n=null;try{n=this._styleSheet.getRule(t)}catch(e){u.ULS.sendTraceTag(17342976,324,15,"GetRule({0}) threw an exception:{1}.",t,e.message)}n?n.get_style().cursor=e:this.monitorNullCssRuleError(t)},e.prototype.monitorNullCssRuleError=function(e){if(this._rulesErrorFirstHitTime<=0)this._rulesErrorFirstHitTime=Date.now(),u.ULS.sendTraceTag(17342977,324,15,"GetRule({0}) returned null.",e);else if(!this._rulesErrorLogged){var t=(Date.now()-this._rulesErrorFirstHitTime)/1e3;t>30&&(u.ULS.sendTraceTag(17342978,324,10,"GetRule({0}) still returns null, causing improper cursor/drag experience, {1} seconds after first hit!",e,t),this._rulesErrorLogged=!0)}},e.prototype.ensureCssIsLoaded=function(e){this._cssState?e():this.createStylesheet(e)},e.prototype.createStylesheet=function(e){var t=this;this._styleSheet=b.createStyleSheet(this._controlledElement.ownerDocument,(function(n){t._styleSheet=n;for(var i=0,r=t._selectors.length;i<r;++i)t._styleSheet.addRule(t._selectors[i],null,i),t._numCssRules++;t._cssState=2,e()})),this._styleSheet||(this._cssState=1)},e._currentControllerCount=0,e}();(0,r.l)(E,"CursorManager",null,[A,Sys.IDisposable]);var k=n(427),D=n(446),M=function(e){function t(t,n,i){return e.call(this,t,n,i,1)||this}return(0,i.t)(t,e),t}(D.a);(0,r.l)(M,"CompositionEventHandlerArgs",D.a,[]);var P=n(574),F=function(){function e(e){this._eventHandlerManager=null,this._eventHandlerManager=e}return e.prototype.registerHandler=function(e,t,n,i){this._eventHandlerManager.registerHandler(M,e,t,2,r.i(this,this.onCompositionEvent,"onCompositionEvent"),n,i)},e.prototype.unregisterHandler=function(e,t,n){this._eventHandlerManager.unregisterHandler(M,e,t,n)},e.prototype.onCompositionEvent=function(e,t,n){return this._eventHandlerManager.processEvent(M,e,t,new M(e,t,n))},e.isCompositionEventName=function(e){return e===P.d.compositionStart||e===P.d.compositionUpdate||e===P.d.compositionEnd},e}();(0,r.l)(F,"CompositionEventManager",null,[]);var x=n(648),R=n(47),B=n(306),L=n(657),N=n(749),U=n(830),O=n(733),H=function(e){function t(t,n,i){var r=e.call(this,t,n,i,1)||this;return r.text=null,r.text=i.data,r}return(0,i.t)(t,e),t}(D.a);(0,r.l)(H,"TextInputEventHandlerArgs",D.a,[]);var W=function(){function e(e){this._eventHandlerManager=null,this._eventHandlerManager=e}return e.prototype.registerHandler=function(e,t,n,i){this._eventHandlerManager.registerHandler(H,e,t,2,r.i(this,this.onTextInputEvent,"onTextInputEvent"),n,i)},e.prototype.unregisterHandler=function(e,t,n){this._eventHandlerManager.unregisterHandler(H,e,t,n)},e.prototype.onTextInputEvent=function(e,t,n){return this._eventHandlerManager.processEvent(H,e,t,new H(e,t,n))},e.isTextInputEventName=function(e){return e===P.d.textInput||e===P.d.input},e}();(0,r.l)(W,"TextInputEventManager",null,[]);var V=n(25),$=n(620),K=n(643),z=(0,r.y)("IHighContrastDetector"),q=n(809),Q=n(600),G=function(){function e(){this.foregroundTextColor=null,this.backgroundColor=null,this.linkColor=null}return e.prototype.toString=function(){return String.format("ForegroundTextColor: {0}, BackgroundColor: {1}, LinkColor: {2}",this.foregroundTextColor,this.backgroundColor,this.linkColor)},e}();(0,r.l)(G,"HighContrastColors",null,[]);var j=n(134),Z=n(556),X="screenReaderDetectionDiv",J=function(){function e(t){this._isInHighContrastMode=!1,this._areAllHighContrastValuesValid=!0,this._highContrastColors=null,this.screenReaderDetector=null,this._isScreenReaderPresent=!1,this._highContrastColorsQueryParameter=null,this._validColorPatternRegularExpression=new RegExp("#[0-9A-Fa-f]{6}");var n=t.ownerDocument.createElement("div");n.id=e.highContrastDetectionDivId,n.setAttribute(j.t.ariaRoleAttribute,j.t.ariaPresentationRole),n.setAttribute(j.t.ariaHiddenAttribute,j.t.ariaTrueValue);var i=t.ownerDocument.createElement("a");i.setAttribute("href","#"),i.id=e.highContrastDetectionAnchorId,i.setAttribute(j.t.ariaRoleAttribute,j.t.ariaPresentationRole),i.setAttribute(j.t.ariaHiddenAttribute,j.t.ariaTrueValue),n.appendChild(i),t.appendChild(n);var r=T.o.getCurrentStyle(n),o=T.o.getCurrentStyle(i);this._isInHighContrastMode=!!o&&-1===o.backgroundImage.toLowerCase().indexOf(e.highContrastDetectionAnchorDefaultBackgroundImageName),r&&o||u.ULS.sendTraceTag(25523335,334,50,"HighContrastDetector foregroundBackgroundCurrentStyle is null:[{0}] and linkCurrentStyle is null:[{1}]",!r,!o),this._isInHighContrastMode&&(this._highContrastColors=r?this.getNormalizedHighContrastHexValuesFromColor(r.color.toLowerCase(),r.backgroundColor.toLowerCase(),o.color.toLowerCase()):null,this._areAllHighContrastValuesValid||u.ULS.sendTraceTag(19223450,334,15,"We believe the user is in high contrast mode, but encountered an invalid color value (transparent or window)")),u.ULS.sendTraceTag(18458837,334,50,"HighContrastDetector.ctor: IsInHighContrastMode=[{0}], HighContrastColors=[{1}]",this._isInHighContrastMode,this._highContrastColors),t.removeChild(n);var a=t.ownerDocument.createElement("div");a.id=X,a.setAttribute(j.t.ariaRoleAttribute,j.t.ariaPresentationRole),a.setAttribute(j.t.ariaHiddenAttribute,j.t.ariaTrueValue),t.appendChild(a)}return e.prototype.get_isInHighContrastMode=function(){return this._isInHighContrastMode},e.prototype.get_isScreenReaderPresent=function(){if(!this._isScreenReaderPresent&&(this.screenReaderDetector=document.getElementById(X),this.screenReaderDetector)){var e=T.o.getCurrentStyle(this.screenReaderDetector);e||u.ULS.sendTraceTag(25523334,334,50,"HighContrastDetector.IsScreenReaderPresent=false, current style is null"),this._isScreenReaderPresent=!!e&&-1===e.borderBottomStyle.toLowerCase().indexOf("dashed"),this._isScreenReaderPresent&&u.ULS.sendTraceTag(19137420,334,50,"HighContrastDetector.IsScreenReaderPresent=true")}return this._isScreenReaderPresent},e.prototype.get_areAllHighContrastValuesValid=function(){return this._areAllHighContrastValuesValid},e.prototype.get_highContrastColors=function(){return this._highContrastColors},e.prototype.get_highContrastColorsQueryParameter=function(){return!this._highContrastColorsQueryParameter&&this._isInHighContrastMode&&this._highContrastColors&&this._areAllHighContrastValuesValid&&(this._highContrastColorsQueryParameter=String.format("{0}_{1}_{2}",this._highContrastColors.foregroundTextColor,this._highContrastColors.backgroundColor,this._highContrastColors.linkColor)),this._highContrastColorsQueryParameter},e.prototype.getNormalizedHighContrastHexValuesFromColor=function(e,t,n){var i,r,o,a=this.tryGetNormalizedColor(e,(0,Q.m)((function(){return i}),(function(e){return i=e}))),s=this.tryGetNormalizedColor(t,(0,Q.m)((function(){return r}),(function(e){return r=e}))),l=this.tryGetNormalizedColor(n,(0,Q.m)((function(){return o}),(function(e){return o=e})));return a&&s&&l?(0,q.m)(new G,{backgroundColor:r,foregroundTextColor:i,linkColor:o}):(u.ULS.sendTraceTag(18458838,334,15,"Failed to parse system colors. isParsingForegroundTextColorSucceed({0}): {1}, isParsingBackgroundColorSucceed({2}): {3}, isParsingLinkColorSucceed({4}): {5}",a,e,s,t,l,n),null)},e.prototype.tryGetNormalizedColor=function(e,t){return this._validColorPatternRegularExpression.test(e)?t.val=e:"transparent"===e||"window"===e?(t.val="transparent",this._areAllHighContrastValuesValid=!1):t.val=this.convertRgbRawToHex(e),!!t.val},e.prototype.convertRgbRawToHex=function(e){if(e.startsWith("rgb(")){var t=e.indexOf("("),n=e.indexOf(","),i=e.lastIndexOf(","),r=e.indexOf(")");if(-1!==t&&-1!==n&&-1!==i&&n!==i&&-1!==r){var o=e.substring(t+1,n),a=e.substring(n+1,i),s=e.substring(i+1,r);return this.convertRgbToHex(o,a,s)}}return null},e.prototype.convertRgbToHex=function(e,t,n){return"#"+(e=Z.l.convertToHex(parseInt(e),2))+(t=Z.l.convertToHex(parseInt(t),2))+(n=Z.l.convertToHex(parseInt(n),2))},e.highContrastDetectionDivId="highContrastDetectionDiv",e.highContrastDetectionAnchorId="highContrastDetectionAnchor",e.highContrastDetectionAnchorDefaultBackgroundImageName="highcontrastdetectordefault",e}();(0,r.l)(J,"HighContrastDetector",null,[z]);var Y=n(425),ee=n(195),te=function(){return ee.v.get_instance().get_isCookieComplianceEnabled()?CookieComplianceConstants.cookieBannerId:"wacMsccBanner"},ne=n(984),ie=n(586);n.d(t,{AFrame:function(){return re}});var re=function(e){function t(n,i){var a=e.call(this,i)||this;return a._theMouseInputManager=null,a._theClickInputManager=null,a._theTouchInputManager=null,a._theKeyInputManager=null,a._theContextMenuInputManager=null,a._thePageManager=null,a._theErrorHandler=null,a._theFocusManager=null,a._theActionManager=null,a._theCursorManager=null,a._theF6Manager=null,a._theCompositionEventManager=null,a._theTextInputEventManager=null,a._theDragInputManager=null,a._theLazyStopwatchBuilder=null,a._applicationInstance=null,a._isDisposed=!1,a._upperRibbonHeight=0,a._lowerRibbonHeight=0,a._isStaticUiTouchMode=!1,a._styleSheet=null,a._taskPaneManager=null,a._highContrastDetector=null,a._adaptiveLayoutInstance=null,a._documentFocusHandler=null,a.eventHandlerManager=null,a.isOffline=!1,a._eventSource=null,a._mode=0,a._frameState=0,a._activeModalDivZIndex=-1,a.isOffline=!1,a._applicationInstance=n,a._eventSource=new ie.f,a.eventHandlerManager=B.EventHandlerManager.get_instance(),a.set_theFocusManager(L.FocusManager.instance()),a.get_theFocusManager().getScope(t.mainAppFocusId).parent=t.appFocusId,a.set_theKeyInputManager(N.KeyInputManager.get_instance()),a.get_theKeyInputManager().initializeForElement(a.get_element()),a.set_theMouseInputManager(U.p.get_instance()),a.get_theMouseInputManager().initializeForElement(a.get_element()),a.set_theTouchInputManager(V.v.get_instance()),a.get_theTouchInputManager().initializeForElement(a.get_element()),a.set_theClickInputManager(k.s.get_instance()),a.get_theClickInputManager().initializeForElement(a.get_element()),a.set_theDragInputManager(R.p.get_instance()),a.get_theDragInputManager().initializeForElement(a.get_element()),O.z.get_instance().initializeForElement(a.get_element()),a.set_theCursorManager(new E(a.get_element())),p.AFrameworkApplication.get_cursorPinningIsEnabled()&&R.p.get_instance().registerCursorPinningTool(a.get_theCursorManager()),a.set_theActionManager(p.AFrameworkApplication.get_theActionManager()),L.FocusManager.registerActions(a.get_theActionManager()),f.registerActions(a.get_theActionManager()),L.FocusManager.registerShortcuts(a.get_theFocusManager()),f.registerShortcuts(a.get_theFocusManager()),a.get_theActionManager().addAction(c.QS,ne.a,r.i(a.get_theFocusManager(),a.get_theFocusManager().focusToBrowser,"focusToBrowser")),a.get_theActionManager().addActionWithFlags(c.Wy,ne.a,t.doNothing,96),a.get_theActionManager().addActionWithFlags(c.xF,ne.a,t.doNothing,100),a.get_theActionManager().addActionWithFlags(c.Ps,ne.a,r.i(a,a.doBrowserDefault,"doBrowserDefault"),96),Y.y.get_isInternetExplorerNonEdge()?(Sys.UI.DomElement.addCssClass(document.body,"InternetExplorer"),Y.y.get_isInternetExplorer8()?Sys.UI.DomElement.addCssClass(document.body,"v8"):Y.y.get_isInternetExplorer9()&&Sys.UI.DomElement.addCssClass(document.body,"v9")):Y.y.get_isInternetExplorerEdge()?Sys.UI.DomElement.addCssClass(document.body,"IEEdge"):Y.y.get_isFirefox()?Sys.UI.DomElement.addCssClass(document.body,"FireFox"):Y.y.get_isWebKit()?Sys.UI.DomElement.addCssClass(document.body,"Safari"):Y.y.get_isOpera12Older()&&Sys.UI.DomElement.addCssClass(document.body,"Opera"),Y.y.get_isIPad()&&(Sys.UI.DomElement.addCssClass(document.body,"iPad"),Y.y.get_iPadOsVersion()>=6&&Sys.UI.DomElement.addCssClass(document.body,"v6up")),Y.y.get_isIPhone()&&Sys.UI.DomElement.addCssClass(document.body,"iPhone"),Y.y.get_isMac()&&Sys.UI.DomElement.addCssClass(document.body,"Mac"),Y.y.get_isWindows()&&Sys.UI.DomElement.addCssClass(document.body,"Windows"),Y.y.get_isLinux()&&Sys.UI.DomElement.addCssClass(document.body,"Linux"),Y.y.get_isIPad()||Sys.UI.DomElement.addCssClass(document.body,"usehover"),a._documentFocusHandler=r.i(a,a.onDocumentFocus,"onDocumentFocus"),a._theLazyStopwatchBuilder=new l.q(o.i,r.i(a,a.makeStopwatchBuilder,"makeStopwatchBuilder")),a.applyTouchStyles(),a.applyScrollBarStyles(),S.n.addHandler(document.body,"focus",a._documentFocusHandler),S.n.addHandler(window.document,"focus",a._documentFocusHandler),b.createStyleSheet(i.ownerDocument,r.i(a,a.updateStyleSheetWithLocalizableStyles,"updateStyleSheetWithLocalizableStyles")),p.AFrameworkApplication.hasExternalHeader&&a.buildExternalHeaderPanel(a.get_element(),!!a._applicationInstance&&a._applicationInstance.get_isRibbonFlexBoxLayoutEnabled()),a._highContrastDetector=new J(i),a}return(0,i.t)(t,e),t.prototype.getDOMElement=function(){return this.get_element()},t.prototype.get_mode=function(){return this._mode},t.prototype.set_mode=function(e){return this._mode=e,e},t.prototype.get_theMouseInputManager=function(){return this._theMouseInputManager},t.prototype.set_theMouseInputManager=function(e){return this._theMouseInputManager=e,e},t.prototype.get_theClickInputManager=function(){return this._theClickInputManager},t.prototype.set_theClickInputManager=function(e){return this._theClickInputManager=e,e},t.prototype.get_theTouchInputManager=function(){return this._theTouchInputManager},t.prototype.set_theTouchInputManager=function(e){return this._theTouchInputManager=e,e},t.prototype.get_theKeyInputManager=function(){return this._theKeyInputManager},t.prototype.set_theKeyInputManager=function(e){return this._theKeyInputManager=e,e},t.prototype.get_theContextMenuInputManager=function(){return this._theContextMenuInputManager},t.prototype.set_theContextMenuInputManager=function(e){return this._theContextMenuInputManager=e,e},t.prototype.get_thePageManager=function(){return this._thePageManager},t.prototype.set_thePageManager=function(e){return this._thePageManager=e,e},t.prototype.get_theErrorHandler=function(){return this._theErrorHandler},t.prototype.set_theErrorHandler=function(e){return this._theErrorHandler=e,e},t.prototype.get_theFocusManager=function(){return this._theFocusManager},t.prototype.set_theFocusManager=function(e){return this._theFocusManager=e,e},t.prototype.get_theActionManager=function(){return this._theActionManager},t.prototype.set_theActionManager=function(e){return this._theActionManager=e,e},t.prototype.get_theCursorManager=function(){return this._theCursorManager},t.prototype.set_theCursorManager=function(e){return this._theCursorManager=e,e},t.prototype.get_theF6Manager=function(){return this._theF6Manager},t.prototype.set_theF6Manager=function(e){return this._theF6Manager=e,e},t.prototype.get_theStopwatchBuilder=function(){return this._theLazyStopwatchBuilder.get_value()},t.prototype.get_theCompositionEventManager=function(){return this._theCompositionEventManager||(this._theCompositionEventManager=new F(this.eventHandlerManager))},t.prototype.set_theCompositionEventManager=function(e){return this._theCompositionEventManager=e,e},t.prototype.get_theTextInputEventManager=function(){return this._theTextInputEventManager||(this._theTextInputEventManager=new W(this.eventHandlerManager))},t.prototype.set_theTextInputEventManager=function(e){return this._theTextInputEventManager=e,e},t.prototype.get_theDragInputManager=function(){return this._theDragInputManager},t.prototype.set_theDragInputManager=function(e){return this._theDragInputManager=e,e},t.prototype.get_taskPaneManager=function(){return this._taskPaneManager},t.prototype.set_taskPaneManager=function(e){return this._taskPaneManager=e,e},t.prototype.get_adaptiveLayoutInstance=function(){return this._adaptiveLayoutInstance||(this._adaptiveLayoutInstance=new _)},t.prototype.set_adaptiveLayoutInstance=function(e){return this._adaptiveLayoutInstance=e,e},t.prototype.get_applicationInstance=function(){return this._applicationInstance},t.prototype.get_modeName=function(){return""},t.prototype.get_state=function(){return this._frameState},t.prototype.set_state=function(e){return this._frameState=e,e},t.prototype.get_businessBar=function(){return null},t.prototype.set_businessBar=function(e){return e},t.prototype.get_hasStatusBar=function(){return!1},t.prototype.get_statusBarPanel=function(){if(!this.get_hasStatusBar())return null;var e=document.getElementById(t._statusPanelId);return e?this.updateExistingStatusBarPanel(e,this._applicationInstance):e=this.buildStatusBarPanel(),e},t.prototype.get_upperRibbonHeight=function(){return this._upperRibbonHeight},t.prototype.set_upperRibbonHeight=function(e){return this._upperRibbonHeight=e,e},t.prototype.get_lowerRibbonHeight=function(){return this._lowerRibbonHeight},t.prototype.set_lowerRibbonHeight=function(e){return this._lowerRibbonHeight=e,e},t.prototype.get_documentPanelWithRibbonTop=function(){return this.get_upperRibbonHeight()+this.get_lowerRibbonHeight()},t.prototype.get_documentPanelWithoutRibbonTop=function(){return this.get_upperRibbonHeight()},t.prototype.get_isStaticUiTouchMode=function(){return this._isStaticUiTouchMode},t.prototype.get_highContrastDetector=function(){return this._highContrastDetector},t.prototype.get_headerFocusScopeName=function(){return"NoOpHeaderUi"},t.prototype.add_modeSwitched=function(e){this.get_events().addHandler("ModeSwitched",e)},t.prototype.remove_modeSwitched=function(e){this.get_events().removeHandler("ModeSwitched",e)},t.prototype.add_onSetOffline=function(e){this.get_events().addHandler("OnSetOffline",e)},t.prototype.remove_onSetOffline=function(e){this.get_events().removeHandler("OnSetOffline",e)},t.prototype.updateCommandUI=function(e){void 0===e&&(e=!1)},t.prototype.get_canSaveACopy=function(){var e=1===this.get_mode(),t=$.c.get_instance().isSessionExpired(p.AFrameworkApplication.get_accessTokenTtl())||$.c.get_instance().isSessionAboutToExpire(p.AFrameworkApplication.get_accessTokenTtl(),p.AFrameworkApplication.accessTokenExpirationPromptSeconds),n=p.AFrameworkApplication.get_protectFile()||p.AFrameworkApplication.get_protectedFile()||p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ProtectedFile");return!(e&&t)&&!n&&p.AFrameworkApplication.webEditingEnabled},t.prototype.setStaticUiTouchMode=function(e){this._isStaticUiTouchMode!==e&&(this._isStaticUiTouchMode=e,this._isStaticUiTouchMode?Sys.UI.DomElement.addCssClass(this.get_element(),"msosp-touch"):Sys.UI.DomElement.removeCssClass(this.get_element(),"msosp-touch"))},t.prototype.get_defaultModalDivZIndex=function(){return 1e3},t.prototype.get_activeModalDivZIndex=function(){return this._activeModalDivZIndex},t.prototype.get_activeModalUIZIndex=function(){return this._activeModalDivZIndex+1},t.prototype.beginModal=function(e){-1===this._activeModalDivZIndex?this._activeModalDivZIndex=this.get_defaultModalDivZIndex():this._activeModalDivZIndex+=2},t.prototype.endModal=function(e){this._activeModalDivZIndex-=2,this._activeModalDivZIndex<this.get_defaultModalDivZIndex()&&(this._activeModalDivZIndex=-1)},t.prototype.get_holdRequestsWhenSessionHasExpired=function(){return!0},t.prototype.get_runRequestCallbackWhenSessionHasExpired=function(){return!1},t.prototype.get_isOffline=function(){return this.isOffline},t.prototype.applyTouchStyles=function(){this.setStaticUiTouchMode(Y.y.get_supportsTouch());p.AFrameworkApplication.appSettingsManager;p.AFrameworkApplication.isMultiTouchGestureEnabled()&&p.AFrameworkApplication.isPinchToZoomEnabled()&&Sys.UI.DomElement.addCssClass(document.body,t.touchPanOnlyCssClass)},t.prototype.applyScrollBarStyles=function(){p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ModernScrollBarIsEnabled")?Sys.UI.DomElement.addCssClass(document.body,t.modernScrollBarCssClass):Sys.UI.DomElement.addCssClass(document.body,t.legacyScrollBarCssClass)},t.prototype.updateStyleSheetWithLocalizableStyles=function(e){this._styleSheet=e;var t="font-family:"+this.get_uiFontFamily()+";font-size:"+this.get_uiFontSize()+";",n="font-family:"+this.get_uiFontFamilyLight()+";font-size:"+this.get_uiFontSize()+";",i="font-size:"+this.get_uiSmallFontSize()+";",r="font-weight:"+this.get_uiFontWeightBold()+";",o="text-transform:"+this.get_uiTextTranformUpperCase()+";",a="font-family:"+this.get_uiFontFamily()+";font-size:"+this.get_uiSmallFontSize()+";";this._styleSheet.addRule(".UIFont, .AppHeaderPanel, .WACFrame, .WACFrameWord, .ewa-root-ltr, .ewa-root-rtl, .cui-menu, .WACDialogButtonNormal, .WACBusinessBarButton, .WACDialogPanel, .AppRegionComposer",t,0),this._styleSheet.addRule(".cui-floatie",a,0),this._styleSheet.addRule(".UIFontLight",n,0),this._styleSheet.addRule(".UISmallFont",i,0),this._styleSheet.addRule(".UIFontBold",r,0),this._styleSheet.addRule(".UITextTranformUpperCase",o,0);this.get_headerLargeFontSize();var s="-webkit-font-smoothing: antialiased;",l="font-size:"+this.get_jewelMenuFontSize()+";"+s,u="font-family:"+this.get_uiFontFamily()+";font-size:"+this.get_jewelSubmenuFontSize()+";font-weight:300;"+s,c="font-family:"+this.get_uiFontFamily()+";font-size:"+this.get_jewelSubmenuMainTitleFontSize()+";font-weight:200;"+s,p="font-family:"+this.get_uiFontFamily()+";font-size:"+this.get_jewelSubmenuFileNameFontSize()+";font-weight:300;"+s;this._styleSheet.addRule(".cui-jewelmenu .cui-ctl-mediumlabel",l,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-mediumlabel",u,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-menusection-titleAtTop",c,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-filenamelabel",p,0);var d="font-family:"+this.get_uiFontFamily()+";font-weight:400;"+s,h="font-family:"+this.get_uiFontFamily()+";font-size:"+this.get_uiFontSizeReactSmall()+"pt;font-weight:400;"+s,g="font-family:"+this.get_uiFontFamily()+";font-size:"+this.get_uiFontSizeReactLarge()+"pt !important;font-weight:300;"+s,m="font-family:"+this.get_uiFontFamily()+" !important;font-weight:400 !important;"+s;this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-filenamelabel.cui-menusection-filenametitle",h,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-menulabel",d,0),this._styleSheet.addRule(".cui-jewelmenu .cui-ctl-mediumlabel .cui-btn-title",d,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-menusection-titleAtTop",g,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-ctl-mediumlabel",m,0),this._styleSheet.addRule(".cui-jewelsubmenu #lblWheresTheSaveButton-MenuSaveButton .cui-btn-menu-description","font-weight:400;-webkit-font-smoothing: antialiased;",0);var _="font-family:"+this.get_uiFontFamily()+";font-size:"+this.get_jewelSubmenuMruButtonTitleFontSize()+";",f="font-family:"+this.get_uiFontFamily()+";font-size:"+this.get_jewelSubmenuFooterButtonFontSize()+";";this._styleSheet.addRule(".cui-jewelsubmenu .cui-mrubutton-title",_,0),this._styleSheet.addRule(".cui-jewelsubmenu .cui-footerbutton",f,0);var y="font-size:"+this.get_dialogTitleFontSize()+";",v="font-size:"+this.get_dialogButtonFontSize()+";",S="font-size:"+this.get_dialogTextFontSize()+";",C="font-size:"+this.get_dialogTextLargeFontSize()+";";this._styleSheet.addRule(".UIFontDialogTitle",y,0),this._styleSheet.addRule(".UIFontDialogButton",v,0),this._styleSheet.addRule(".UIFontDialogText",S,0),this._styleSheet.addRule(".UIFontDialogTextLarge",C,0);var b="font-family:"+this.get_uiFontFamilyLight()+";font-size:"+this.get_taskPaneTitleFontSize()+";";this._styleSheet.addRule(".cui-taskPaneTitle",b,0)},t.prototype.buildStatusBarPanel=function(){var e=document.createElement("div");return e.id=t._statusPanelId,e.className="WACStatusBarContainer",this._applicationInstance&&p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactStatusBarIsEnabled")?Sys.UI.DomElement.addCssClass(e,"reactStatusBar"):e.style.height=t.statusBarHeight+"px",this._applicationInstance&&this._applicationInstance.get_isRegionComposerEnabled()&&Sys.UI.DomElement.addCssClass(e,"regionComposer"),this._applicationInstance&&this._applicationInstance.get_isRibbonFlexBoxLayoutEnabled()&&Sys.UI.DomElement.addCssClass(e,"FlexBoxLayout"),this._applicationInstance&&this._applicationInstance.get_isRibbonVisualRefreshEnabled()&&Sys.UI.DomElement.addCssClass(e,"MLRVisualRefresh"),this.get_element().appendChild(e),e},t.prototype.updateExistingStatusBarPanel=function(e,t){},t.prototype.buildExternalHeaderPanel=function(e,n){if(e.parentNode){var i=p.AFrameworkApplication.externalHeaderPanelClassName;n&&!p.AFrameworkApplication.hideHeaderEmbedded&&(i+=" FlexBoxLayout");var r=this.addAppHearderPanelIfNeeded(i,e);r.setAttribute("role","toolbar"),j.t.appendHiddenLabel(r,p.AFrameworkApplication.externalHeaderPanelId+"-label",p.AFrameworkApplication.externalHeaderLabel||CommonUIStrings.l_AppHeader_Label),N.KeyInputManager.get_instance().initializeForElement(r),U.p.get_instance().initializeForElement(r),V.v.get_instance().initializeForElement(r),k.s.get_instance().initializeForElement(r),R.p.get_instance().initializeForElement(r),O.z.get_instance().initializeForElement(r),x.r.get_instance().initializeForElement(r),x.r.get_instance().registerHandler(r,t.suppressContextMenuHandler,null)}},t.prototype.addAppHearderPanelIfNeeded=function(e,t){var n=document.getElementById(p.AFrameworkApplication.externalHeaderPanelId)||document.createElement("div");return n.id=p.AFrameworkApplication.externalHeaderPanelId,n.className=e,t.parentNode.insertBefore(n,t),n},t.prototype.dispose=function(){this._isDisposed||(w.b(this._styleSheet),this._styleSheet=null,this._documentFocusHandler&&(S.n.removeHandler(document.body,"focus",this._documentFocusHandler),S.n.removeHandler(window.document,"focus",this._documentFocusHandler)),this._documentFocusHandler=null,K.h.get_currentDialog()&&K.h.get_currentDialog().hide(),N.KeyInputManager.get_instance().deinitializeForElement(this.get_element()),U.p.get_instance().deinitializeForElement(this.get_element()),V.v.get_instance().deinitializeForElement(this.get_element()),k.s.get_instance().deinitializeForElement(this.get_element()),R.p.get_instance().deinitializeForElement(this.get_element()),O.z.get_instance().deinitializeForElement(this.get_element()),w.b(this.get_theCursorManager()),t.disposeExternalHeader(),p.AFrameworkApplication.unRegisterFrame(this.get_element().id),this._applicationInstance=null,Sys.Component.prototype.dispose.call(this),this._isDisposed=!0)},t.prototype.switchToMode=function(e){if(this._mode!==e){switch(e){case 0:throw Error.argumentNull("newMode");case 1:this._mode=e,p.AFrameworkApplication.get_theActionManager().set_mode(1);break;case 2:this._mode=e,p.AFrameworkApplication.get_theActionManager().set_mode(3);break;default:throw Error.argumentOutOfRange("newMode")}var t=this.get_events().getHandler("ModeSwitched");t&&t(this)}},t.prototype.setOffline=function(e){if(this.get_isOffline()!==e){this.isOffline=e,p.AFrameworkApplication.get_theActionManager().set_isOffline(e);var t=this.get_events().getHandler("OnSetOffline");t&&t(e)}},t.prototype.prepareForDialog=function(){},t.prototype.animateDocumentPanel=function(e,t){},t.prototype.updateOpenMenu=function(e){return!1},t.prototype.doBrowserDefault=function(e,t,n,i,r){return 4},t.prototype.restoreFocusAfterDismissingPopup=function(e,t){try{e.focus()}catch(e){}},t.prototype.setFocusOnDocument=function(){},t.prototype.restoreFocusAfterExecutingActionFromRibbon=function(){this.get_theFocusManager()&&this.get_theFocusManager().get_currentScope()&&(this.get_theFocusManager().get_currentScope().name===this.get_ribbonFocusScopeName()||this.get_theFocusManager().get_currentScope().name===this.get_headerFocusScopeName()||this.get_theFocusManager().get_currentScope().name===t.reactTransientUIFocusId&&this.get_theFocusManager().peekNonReactTransientUiScope()===this.get_ribbonFocusScopeName())&&this.setFocusOnDocument()},t.prototype.onFloatieDismissed=function(e){},t.prototype.signInInternal=function(e){},t.prototype.onDocumentFocus=function(e){this.get_theFocusManager().get_currentScope()&&this.get_theFocusManager().get_currentScope().name===L.FocusManager.browserFocusId&&this.get_theFocusManager().popScope(L.FocusManager.browserFocusId)},t.prototype.navigateToHostUrl=function(e,t,n){if(void 0===n&&(n=!1),!t)return 8;if(e){u.ULS.sendTraceTag(6070364,306,50,"AFrame::NavigateToHostUrl openInNewWindow:{0}",n);try{if(n||p.AFrameworkApplication.get_isEmbedded()){var i=window.open(t,"_blank");(null==i||i.closed)&&u.ULS.sendTraceTag(5325278,306,15,"Window.Open did not succeed.")}else window.top.location=t}catch(e){var r="Unable to get exception message";try{r=e.toString()}catch(e){}return u.ULS.sendTraceTag(6070365,306,10,"AFrame::NavigateToHostUrl caught exception: {0}",r),8}}return 32},t.prototype.beforeRefreshDocument=function(){return!0},t.prototype.refreshDocument=function(e){},t.prototype.onBeforeOpenSwitcher=function(){return!0},t.prototype.onBeforeCloseSwitcher=function(){return!0},t.prototype.add_onResize=function(e){this._eventSource.addHandler(t.resizeEventKey,e)},t.prototype.remove_onResize=function(e){this._eventSource.removeHandler(t.resizeEventKey,e)},t.prototype.notifyResize=function(){this._eventSource.raiseEvent(t.resizeEventKey)},t.reflowCookieBannerIfNecessary=function(e){void 0===e&&(e=!0);var t=!1;if(!p.AFrameworkApplication.get_isCookieBannerVisible())return t;var n=document.getElementById(te());if(n&&n.parentNode===document.body){var i=document.getElementById(p.AFrameworkApplication.applicationOuterContainerId),r=document.getElementById(p.AFrameworkApplication.externalHeaderPanelId),o=document.getElementById(p.AFrameworkApplication.applicationDivId);if(i&&r&&o){var a=T.o.getCurrentStyle(r),s=T.o.getCurrentStyle(o);if(a&&s&&"absolute"===a.position&&"absolute"===s.position&&(!e||"none"!==a.display)){i.insertBefore(n,i.firstChild);var l=n.offsetHeight;r.style.top=l+r.offsetTop+"px",o.style.top=l+o.offsetTop+"px";var u=null;u=function(){r.style.top=Math.max(0,r.offsetTop-l)+"px",o.style.top=Math.max(0,o.offsetTop-l)+"px",ee.v.get_instance().remove_onConsentReceived(u)},ee.v.get_instance().add_onConsentReceived(u),t=!0}}}return t},t.reflowCookieBannerIfNecessaryForEmbed=function(e){if(t.reflowCookieBannerIfNecessary(e)&&p.AFrameworkApplication.get_isCookieBannerVisible()){var n=document.getElementById(te()),i=document.getElementById(p.AFrameworkApplication.applicationDivId);if(n&&i){var r=n.offsetHeight;i.style.top=Math.max(0,i.offsetTop-r)+"px",i.style.height="auto",i.style.bottom="0px"}}},t.suppressContextMenuHandler=function(e){return!0},t.disposeExternalHeader=function(){var e=document.getElementById(p.AFrameworkApplication.externalHeaderPanelId);e&&(N.KeyInputManager.get_instance().deinitializeForElement(e),U.p.get_instance().deinitializeForElement(e),V.v.get_instance().deinitializeForElement(e),k.s.get_instance().deinitializeForElement(e),R.p.get_instance().deinitializeForElement(e),O.z.get_instance().deinitializeForElement(e),x.r.get_instance().deinitializeForElement(e),x.r.get_instance().unregisterHandler(e,t.suppressContextMenuHandler),e=null)},t.bindWithDoNothingFallback=function(e,n,i,r){t._appScope||(t._appScope=L.FocusManager.instance().getScope(t.appFocusId)),r?(e.bindActionWithArguments(n,i,r),t._appScope.bindActionWithArguments(n,c.Wy,r)):(e.bindAction(n,i),t._appScope.bindAction(n,c.Wy))},t.doNothing=function(e,t,n,i,r){return 32},t.ribbonMinimizedStateCookieName="WACRibbonMinimized",t.uiCookieExpirationDays=390,t._statusPanelId="WACStatusBarContainer",t.touchPanOnlyCssClass="TouchPanOnly",t.modernScrollBarCssClass="customScrollBar",t.legacyScrollBarCssClass="legacyScrollBar",t.allowBrowserClickClassname="AllowBrowserClick",t.dynamicTouchModeCssClass="msosp-touch-dyn",t._appScope=null,t.appFocusId="app",t.mainAppFocusId="main",t.documentFocusID="document",t.flexPaneFocusId="FlexPane",t.commentPaneFocusId="CommentPane",t.accCheckerPaneFocusId="AccessibilityCheckerPane",t.cookieConsentBannerFocusId="CookieConsentBanner",t.activityPaneFocusId="ActivityTaskPane",t.catchUpNotificationFocusId="CatchUpNotification",t.catchUpFlyoutFocusId="CatchUpFlyout",t.modalCommandUIFocusId="CUIModal",t.reactTransientUIFocusId="ReactTransientUI",t.modelessDialogFocusId="dialog/modeless",t.switcherFocusId="SwitcherFocus",t.activityFeedPaneFocusId="ActivityFeedTaskPane",t.previewPanelId="PreviewPanelOverlay",t.versionHistoryOverlayId="VersionHistoryOverlay",t.statusBarHeight=23,t.resizeEventKey="Resize",t}(Sys.UI.Control);(0,r.l)(re,"AFrame",Sys.UI.Control,[a.l,Sys.IDisposable,s.z])},function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=n(712),a=n(351),s=n(600),l=n(751),u=n(255),c=n(614),p=n(254),d=n(648),h=n(577),g=n(657),m=n(996),_=n(179),f=n(101),y=n(984),v=function(e){function t(n,i){var o=e.call(this,n,i)||this;o._businessBar=null,o.set_theContextMenuInputManager(d.r.get_instance()),o.get_theContextMenuInputManager().initializeForElement(o.get_element()),o.set_thePageManager(new m.h),o.get_thePageManager().registerHandler(1,t.onBeforeAppClose,null),o.get_thePageManager().registerHandler(0,(function(e){o.notifyResize()}),null),o.set_theF6Manager(h.F6Manager.get_instance()),_.PageStats.start(o);var a=p.AFrameworkApplication.get_theActionManager();return a.addAction(c.UT,y.a,r.i(o.get_theF6Manager(),o.get_theF6Manager().handleF6,"handleF6")),a.addAction(c.Rh,y.a,r.i(o.get_theF6Manager(),o.get_theF6Manager().handleF6Shift,"handleF6Shift")),a.addAction(c.gZ,y.a,r.i(o.get_theF6Manager(),o.get_theF6Manager().resumeFocusWithDirection,"resumeFocusWithDirection")),o}return(0,i.t)(t,e),t.prototype.get_businessBar=function(){return this._businessBar},t.prototype.set_businessBar=function(e){return this._businessBar=e,e},t.prototype.get_canUseAppAfterAuthLost=function(){return!1},t.prototype.get_uiFontFamily=function(){return CommonUIStrings.l_UserInterfaceFontName},t.prototype.get_uiFontFamilySemiLight=function(){return CommonUIStrings.l_UserInterfaceSemiLightFontName},t.prototype.get_uiFontFamilyLight=function(){return CommonUIStrings.l_UserInterfaceLightFontName},t.prototype.get_uiFontSize=function(){return CommonUIStrings.l_UserInterfaceFontSize},t.prototype.get_uiSmallFontSize=function(){return CommonUIStrings.l_UserInterfaceSmallFontSize},t.prototype.get_uiFontSizeReactSmall=function(){return CommonUIStrings.L_FontSize14},t.prototype.get_uiFontSizeReactLarge=function(){return CommonUIStrings.L_FontSize26},t.prototype.get_headerLargeFontSize=function(){return CommonUIStrings.l_HeaderLargeFontSize},t.prototype.get_jewelMenuFontSize=function(){return CommonUIStrings.l_JewelMenuFontSize},t.prototype.get_jewelSubmenuFontSize=function(){return CommonUIStrings.l_JewelSubMenuFontSize},t.prototype.get_jewelSubmenuFileNameFontSize=function(){return CommonUIStrings.l_JewelSubmenuFileNameFontSize},t.prototype.get_jewelSubmenuMainTitleFontSize=function(){return CommonUIStrings.l_JewelSubMenuMainTitleFontSize},t.prototype.get_dialogTitleFontSize=function(){return CommonUIStrings.l_UserInterfaceDialogTitleFontSize},t.prototype.get_dialogButtonFontSize=function(){return CommonUIStrings.l_UserInterfaceDialogButtonFontSize},t.prototype.get_dialogTextFontSize=function(){return CommonUIStrings.l_UserInterfaceDialogTextFontSize},t.prototype.get_dialogTextLargeFontSize=function(){return CommonUIStrings.l_UserInterfaceDialogTextLargeFontSize},t.prototype.get_jewelSubmenuMruButtonTitleFontSize=function(){return CommonUIStrings.l_JewelSubmenuMruButtonTitleFontSize},t.prototype.get_jewelSubmenuFooterButtonFontSize=function(){return CommonUIStrings.l_JewelSubmenuFooterButtonFontSize},t.prototype.get_uiFontWeightBold=function(){return CommonUIStrings.l_UserInterfaceFontWeightBold},t.prototype.get_uiTextTranformUpperCase=function(){return CommonUIStrings.l_UserInterfaceUpperCaseTextTransform},t.prototype.get_taskPaneTitleFontSize=function(){return CommonUIStrings.l_UserInterfaceTaskPaneTitleFontSize},t.prototype.dispose=function(){_.PageStats.stop(),f.b(this._businessBar),this._businessBar=null,f.b(this.get_thePageManager()),this.set_thePageManager(null),e.prototype.dispose.call(this)},t.prototype.signInInternal=function(e){32!==p.AFrameworkApplication.get_theActionManager().processActionWithData(c.Ec,2,e)&&u.ULS.sendTraceTag(4776159,207,15,"SignIn failed")},t.prototype.beginModal=function(t){e.prototype.beginModal.call(this,t),t&&g.FocusManager.instance().pushScope(l.AFrame.modalCommandUIFocusId,!1)},t.prototype.endModal=function(t){e.prototype.endModal.call(this,t),t&&(p.AFrameworkApplication.isShuttingDown||g.FocusManager.instance().popScope(l.AFrame.modalCommandUIFocusId))},t.onBeforeAppClose=function(e){var t=null;try{t=WacAnimation.Telemetry.GetAnimationSqmStats()}catch(e){}t&&(p.AFrameworkApplication.theWsaClient.setDw(10486,parseInt(String(Math.round(t[0])))),p.AFrameworkApplication.theWsaClient.setDw(10487,parseInt(String(Math.round(t[1])))),p.AFrameworkApplication.theWsaClient.setDw(10485,parseInt(String(Math.round(t[2])))))},t.includeCloseButton=function(){return!p.AFrameworkApplication.get_isEmbedded()&&(!!p.AFrameworkApplication.get_closeWindowOnAppClose()||!!p.AFrameworkApplication.closeUrl)},t}(l.AFrame);(0,r.l)(v,"WebAppFrame",l.AFrame,[]);var S=n(917),C=n(645),b=n(873),A=n(610),T=n(841),w=function(){function e(){this._progressDialog=null}return e.prototype.showInitialScreen=function(e,t){var n=new T.StandardDialog;n.set_buttonsOption(3),n.setButtonText(1,CommonUIStrings.l_ConversionButton),n.setButtonText(2,t);var i=document.createElement("span"),r=document.createElement("div"),o=document.createElement("div");r.innerText=CommonUIStrings.l_ConversionDialogLine1,o.innerText=CommonUIStrings.l_ConversionDialogLine2,i.appendChild(r),i.appendChild(o),n.messageBox(CommonUIStrings.l_ConversionDialogTitle,null,3,e,i)},e.prototype.showInitialScreenPdf=function(e){var t=new T.StandardDialog;t.set_buttonsOption(1),t.setButtonText(1,CommonUIStrings.l_ConversionButton);var n=document.createElement("span"),i=document.createElement("div");i.innerText=CommonUIStrings.l_ConversionDialogPdf,n.appendChild(i),t.messageBox(CommonUIStrings.l_ConversionDialogTitle,null,3,e,n)},e.prototype.showProgressDialog=function(){this._progressDialog=new A.c,this._progressDialog.set_buttonsOption(5),this._progressDialog.set_message(CommonUIStrings.l_ConversionProgressString),this._progressDialog.showProgressDialog(CommonUIStrings.l_ConversionDialogTitle,null,null)},e.prototype.dismissWaitUI=function(){this._progressDialog.close(),this._progressDialog=null},e.prototype.showErrorUI=function(e,t,n,i,r){if(void 0===r&&(r=!1),1!==p.AFrameworkApplication.get_activeFrame().get_state()){var o=new T.StandardDialog,a=document.createElement("span");if(i){o.set_buttonsOption(6),o.setButtonText(0,CommonUIStrings.l_DialogClose),(s=document.createElement("div")).innerText=r?n:CommonUIStrings.l_ErrorDialogMessage,a.appendChild(s)}else{o.set_buttonsOption(1),o.setButtonText(1,t),o.setButtonText(0,CommonUIStrings.l_DialogClose);var s=document.createElement("div"),l=document.createElement("div");s.innerText=r?n:CommonUIStrings.l_ConversionErrorMessage1,l.innerText=CommonUIStrings.l_ConversionErrorMessage2,a.appendChild(s),a.appendChild(l)}p.AFrameworkApplication.reportError(b.p.conversionFailed),o.messageBox(CommonUIStrings.l_ConversionDialogTitle,null,2,i?null:e,a)}},e}();(0,r.l)(w,"BinaryConversionUI",null,[]);var I=n(405),E=function(){function e(){this._binaryConversionUi=null,this._editUrl=null,this._viewUrl=null,this._binaryConversionUi=new w,n(941).App.get_instance().get_isPdfMode()?this._binaryConversionUi.showInitialScreenPdf(r.i(this,this.initialDialogHandler,"initialDialogHandler")):this._binaryConversionUi.showInitialScreen(r.i(this,this.initialDialogHandler,"initialDialogHandler"),WordViewerIntl.WordViewerStrings.L_OpenInWord)}return e.prototype.initialDialogHandler=function(t,i){if(1===t){this._binaryConversionUi.showProgressDialog();var o=n(941).App.webServiceBase+"docdatahandler.ashx?"+n(941).App.get_instance().theDocument.get_baseDocQuerySignature()+"&type=docx&o15=1";n(941).App.get_instance().get_isPdfMode()?(o+="&PdfMode=1",u.ULS.sendTraceTag(18411874,301,50,"PDF conversion start.")):u.ULS.sendTraceTag(18411875,301,50,"Binary conversion start."),I.k.doRequest(o,r.i(this,this.onRequestComplete,"onRequestComplete"),n(941).App.get_activeAppFrame().get_notificationBar())}else 2===t&&e.openInRichClient()},e.prototype.onRequestComplete=function(t,n,i){if(this._binaryConversionUi.dismissWaitUI(),t&&"Success"===n||"ConvertedFileExists"===n){var r=i.responseXml.selectSingleNode("/docdata/editUrl"),o=i.responseXml.selectSingleNode("/docdata/viewUrl");if(!r||!o){var a="Unexpected null edit or view url in response!";return this._binaryConversionUi.showErrorUI(e.errorDialogHandler,WordViewerIntl.WordViewerStrings.L_OpenInWord,i.responseData,this.hideOpenButton()),void S.u.propagateError(!1,"BinaryConversionFailed",b.p.conversionFailed,a)}this._editUrl=r.text,this._viewUrl=o.text,"Success"===n?(u.ULS.sendTraceTag(18411904,301,50,"Binary conversion success."),this.showSuccessUI()):(u.ULS.sendTraceTag(18411905,301,50,"Converted file already exists."),this.showConvertedFileExistsUI(),S.u.propagateError(!1,"ConvertedFileExists",b.p.conversionFileExists,CommonUIStrings.l_ConversionFileExists))}else{a=String.format("Binary Conversion failed: {0}",n||"No status");u.ULS.sendTraceTag(18990600,301,10,a),this._binaryConversionUi.showErrorUI(e.errorDialogHandler,WordViewerIntl.WordViewerStrings.L_OpenInWord,i.responseData,this.hideOpenButton()),S.u.propagateError(!1,"BinaryConversionFailed",b.p.conversionFailed,a)}},e.prototype.hideOpenButton=function(){return 32!==p.AFrameworkApplication.get_theActionManager().processAction(C.AM,1)},e.prototype.showSuccessUI=function(){if(1!==p.AFrameworkApplication.get_activeFrame().get_state()){var e=new T.StandardDialog;e.set_buttonsOption(4),e.setButtonText(2,WordViewerIntl.WordViewerStrings.L_Edit),e.setButtonText(1,WordViewerIntl.WordViewerStrings.l_View);var t=document.createElement("span"),n=document.createElement("div"),i=document.createElement("div");n.innerText=CommonUIStrings.l_ConversionSucceded1,i.innerText=CommonUIStrings.l_ConversionSucceded2,t.appendChild(n),t.appendChild(i),e.messageBox(CommonUIStrings.l_ConversionDialogTitle,null,0,r.i(this,this.onNavigate,"onNavigate"),t)}},e.prototype.showConvertedFileExistsUI=function(){if(1!==p.AFrameworkApplication.get_activeFrame().get_state()){var e=new T.StandardDialog;e.set_buttonsOption(3),e.setButtonText(1,WordViewerIntl.WordViewerStrings.l_View),e.setButtonText(2,WordViewerIntl.WordViewerStrings.L_Edit),e.setButtonText(0,WordViewerIntl.WordViewerStrings.L_Close),e.showError(b.p.conversionFileExists,CommonUIStrings.l_ConversionDialogTitle,CommonUIStrings.l_ConversionFileExists,r.i(this,this.onStandardDialog,"onStandardDialog"))}},e.prototype.onStandardDialog=function(e,t){this.onNavigate(e,t)},e.prototype.onNavigate=function(e,t){var n=window.top;2===e?n.location.href=this._editUrl:1===e&&(n.location.href=this._viewUrl)},e.launch=function(){new e},e.openInRichClient=function(){p.AFrameworkApplication.get_theActionManager().processAction(C.AM,2)},e.errorDialogHandler=function(t,n){1===t&&e.openInRichClient()},e}();(0,r.l)(E,"BinaryConversionManager",null,[]);var k=n(491),D=n(945),M=n(665),P=n(529),F=(0,r.y)("IRootBuildClient"),x=n(568),R=n(809),B=n(644),L=function(){return function(){this.scriptBaseUrl=null,this.isMLRRibbonMode=!1}}();(0,r.l)(L,"IntlBootResourcesOptions",null,[]);var N=n(967),U=n(327),O=n(235),H=function(){function e(){}return e.getAppChrome=function(t){void 0===t&&(t=!0);var n=O.w.get_instance().resolve(x.d).getScriptLoader(),i=e.getLoadAppResourceLoaderPromise(n).then((function(t){return e.getRibbonLoaderPromise(n)}));return!e.isAppChromeInitialized&&t&&(i=i.then((function(){U.initializeAppChrome(n),e.isAppChromeInitialized=!0}))),i},e.getLoadAppResourceLoaderPromise=function(e){return e.loadScript("appResourceLoader").catch((function(e){return u.ULS.sendTraceTag(50456130,340,10,"Failed to load the resources for AppResourceLoader")}))},e.getRibbonLoaderPromise=function(e){var t=new B.c(Promise),n=p.AFrameworkApplication.get_staticContentScriptNameBase()+p.AFrameworkApplication.lcid+"/";N.y.get_isAppChromeLocalhostScriptEnabled()&&(n=N.y.getLocalizationLocalhostPath(p.AFrameworkApplication.lcid));var i=(0,R.m)(new L,{scriptBaseUrl:n,isMLRRibbonMode:p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_shouldRenderReactMultilineRibbon()});return t.add(appResourceLoader.loadIntlBootResources(i).catch((function(e){return u.ULS.sendTraceTag(50456131,340,10,"Failed to load the resources for IntlBoot")}))),t.add(e.loadScript("appChrome").catch((function(e){return u.ULS.sendTraceTag(50456132,340,10,"Failed to load the resources for AppChrome")}))),Promise.all(t.toArray())},e.preloadUIResourceScripts=function(){O.w.get_instance().resolve(x.d).getScriptLoader().preloadScript("appResourceLoader")},e.isAppChromeInitialized=!1,e}();(0,r.l)(H,"AppChromeProvider",null,[]);var W=n(471),V=function(){function e(){}return e.getAccessibilityHelpButtonId="jbtnAccessibilityHelp",e.getAccessiblePdfLinkButtonId="jbtnAccessibility",e.toggleCommentPaneButtonId="btnOpenCommentPane",e.toggleSearchPaneButtonId="btnOpenSearchPane",e.toggleWordViewerModeButtonId="jbtnToggleViewMode",e}();(0,r.l)(V,"AccessibilityModeIds",null,[]);var $=function(){function e(){}return e.toolbarDownloadWithWordButtonId="btnDownloadWithWord",e.toolbarOverflowDownloadWithWordButtonId="overflowbtnDownloadWithWord",e.toolbarDownloadPdfButtonId="btnDownloadPdf",e.toolbarDownloadWordDocAsPdfButtonId="jbtnDownloadAsPdf",e.toolbarDownloadATranslatedCopy="jbtnDownloadATranslatedCopy",e}();(0,r.l)($,"DownloadButtonIds",null,[]);var K=function(){function e(){}return e.yammerButtonId="btnToggleYammerPanel",e.fileVersionButtonId="jbtnFileVersion",e.jewelFileSharingButtonId="jbtnFileSharing",e.toolbarFileSharingButtonId="btnFileSharing",e.privacyButtonId="jbtnPrivacy",e.reportAbuseButtonId="jbtnReportAbuse",e.termsOfUseButtonId="jbtnTermsOfUse",e.giveFeedbackButtonId="jbtnGiveFeedback",e.closeButtonId="btnjClose",e.translateButtonId="jbtnTranslateDocument",e.trustCenterButtonId="jbtnTrustCenter",e}();(0,r.l)(K,"FeatureButtonIds",null,[]);var z=function(){function e(){}return e.toolbarConvertToPdfPrintButtonId="btnPrintToPdf",e.toolbarDirectPrintButtonId="btnDirectPrint",e.toolbarPrintPdfButtonId="btnPrintPdfFile",e.toolbarDirectPrintPdfButtonId="btnDirectPrintPdfMode",e.jewelPrintSubMenuId="faPrint",e}();(0,r.l)(z,"PrintButtonIds",null,[]);var q=function(e,t,n,i){t?(e[V.getAccessiblePdfLinkButtonId]=!0,n&&(e[V.toggleCommentPaneButtonId]=!0,e[V.toggleSearchPaneButtonId]=!0)):e[V.toggleWordViewerModeButtonId]=!0,i&&t||(e[V.getAccessibilityHelpButtonId]=!0)},Q=function(e,t,n,i){e[z.toolbarConvertToPdfPrintButtonId]=!i||n||t,e[z.toolbarDirectPrintButtonId]=!i||n||!t,e[z.toolbarPrintPdfButtonId]=!i||!n||t,e[z.toolbarDirectPrintPdfButtonId]=!i||!n||!t},G=function(e,t,n,i,r,o){e[$.toolbarDownloadWithWordButtonId]=t||n||o||!r,e[$.toolbarDownloadPdfButtonId]=t||!n||o,e[$.toolbarOverflowDownloadWithWordButtonId]=t||n||o||r,e[$.toolbarDownloadWordDocAsPdfButtonId]=t||n||!i,e[$.toolbarDownloadATranslatedCopy]=t||!o},j=function(e){e[K.yammerButtonId]=!p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("YammerIsEnabled"),e[K.fileVersionButtonId]=!p.AFrameworkApplication.fileVersionUrl&&!p.AFrameworkApplication.useFileVersionPostMessage,e[K.jewelFileSharingButtonId]=!p.AFrameworkApplication.fileShareEnabled,e[K.toolbarFileSharingButtonId]=!p.AFrameworkApplication.fileShareEnabled,e[K.privacyButtonId]=!p.AFrameworkApplication.privacyUrl,e[K.reportAbuseButtonId]=!p.AFrameworkApplication.reportAbuseUrl,e[K.termsOfUseButtonId]=!p.AFrameworkApplication.termsUrl,e[K.giveFeedbackButtonId]=!p.AFrameworkApplication.showFeedbackButton,e[K.closeButtonId]=!v.includeCloseButton(),e[K.trustCenterButtonId]=!p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TrustCenterDialogIsEnabled"),e[K.translateButtonId]=n(941).App.get_instance().get_isPdfMode()||!n(941).App.get_instance().get_translationLanguages()||!n(941).App.get_instance().get_translationLanguages().length},Z=n(901),X=n(166),J=n(218),Y=n(311),ee=function(){var e=n(941).App.get_instance();if(e){var t=!e.get_fileTypeSupportsCommenting()||!e.get_userCanComment()&&!p.AFrameworkApplication.useRedeemForCommentingPostMessage,i=!Z.t.get_instance().get_hasComments()&&n(941).App.get_instance().get_accessibleModeEnabled();return t||i}return!1},te=n(547),ne=(0,r.y)("IExternalUICommandDefinitionMapping"),ie=n(741),re=(0,r.y)("ISaveStatusUIHandler"),oe=n(406),ae=(0,r.y)("IReactSharedHeaderPropsHelper"),se=n(502),le=n(987),ue=(0,r.y)("ISearchOAuthManager"),ce=function(){function e(){this._searchOauthManager=null,this._prefetchAuthToken=!0}return e.prototype.tryResolveSearchOAuthManager=function(){try{this._searchOauthManager||(this._searchOauthManager=O.w.get_instance().resolve(ue))}catch(e){u.ULS.sendTraceTag(51689674,1300,10,"Unable to resolve ISearchOAuthManager: "+e)}},e.prototype.getLokiTokenPromise=function(){var e=this;return this.tryResolveSearchOAuthManager(),this._searchOauthManager?this._searchOauthManager.isConnectedServiceEnabled().then((function(t){return t?e._searchOauthManager.getToken("Search",p.AFrameworkApplication.lokiEndpointForSearch):null})):null},e.prototype.getSubstrateTokenPromise=function(){var e=this;return this.tryResolveSearchOAuthManager(),this._searchOauthManager?this._searchOauthManager.isConnectedServiceEnabled().then((function(t){return t?e._searchOauthManager.getToken("Search",p.AFrameworkApplication.substrateEndpointForSearch):null})):null},e.prototype.getLokiTokenPromiseFunc=function(){return r.i(this,this.getLokiTokenPromise,"getLokiTokenPromise")},e.prototype.getSubstrateTokenPromiseFunc=function(){return r.i(this,this.getSubstrateTokenPromise,"getSubstrateTokenPromise")},e.prototype.shouldFetchTokensForSearch=function(){return!!p.AFrameworkApplication.get_activeFrame()&&p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_shouldFetchTokensForSearch()},e.prototype.shouldPrefetchAuthTokensForSearch=function(){return!!p.AFrameworkApplication.get_activeFrame()&&p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_shouldPrefetchAuthTokensForSearch()},e.prototype.getTokenRequestDict=function(){var e={};return this.shouldFetchTokensForSearch()&&(e.Loki=this.getLokiTokenPromiseFunc(),e.Substrate=this.getSubstrateTokenPromiseFunc(),this._prefetchAuthToken&&this.shouldPrefetchAuthTokensForSearch()&&(this._prefetchAuthToken=!1,this.getLokiTokenPromise().then((function(){u.ULS.sendTraceTag(51500871,1300,50,"Cached Loki token")})))),e},e.prototype.loadTellMeStrings=function(){var e=O.w.get_instance().resolve(x.d).getScriptLoader();e&&e.loadScript("tellme-strings").then((function(){appChrome.api.dispatch(appChrome.actions.updateHeaderSearchBoxVisibility(!0)),u.ULS.sendTraceTag(50376975,1300,50,"Loaded resource(s) for the TellMe providers")}))},e.isSearchEnabled=function(){return!!p.AFrameworkApplication.get_activeFrame()&&p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSharedHeaderSearchUxEnabled()},e}();(0,r.l)(ce,"ReactSharedHeaderSearchUtils",null,[]);var pe=function(){return function(){this.documentTitle=null,this.saveStatus=null,this.isVersionHistoryEnabled=!1,this.breadcrumbBrandName=null,this.breadcrumbBrandUrl=null,this.breadcrumbFolderName=null,this.breadcrumbFolderUrl=null,this.hideDocumentTitleInput=!1,this.documentExtension=null,this.onGetSuggestedTitle=null}}();(0,r.l)(pe,"DocumentTitleAppProps",null,[]);var de=function(){return function(){this.appName=null,this.userDisplayName=null,this.emailAddress=null,this.userID=null,this.culture=null,this.language=null,this.isConsumer=!1,this.showAppLauncher=!1,this.showMeControl=!1,this.assetsContainerOverride=null,this.controls=null,this.documentTitleAppProps=null,this.showChatControl=!1,this.showSearchControl=!1,this.enableSearchControl=!1,this.showGoPremiumControl=!1,this.signInLink=null,this.getTokenRequestDictionary=null,this.onHeaderReducersReady=null,this.setCookie=null,this.getCookie=null,this.onFlexPaneOpen=null,this.onFlexPaneClose=null,this.enableTheming=!1,this.enableDelayLoading=!1,this.userRing=null,this.testTraffic=!1}}();(0,r.l)(de,"HeaderAppProps",null,[]);var he=function(){return function(){this.ribbonToggleId=null,this.workflowButton=null}}();(0,r.l)(he,"HeaderControls",null,[]);var ge=function(){return function(){this.label=null,this.command=null}}();(0,r.l)(ge,"WorkflowButtonAppProps",null,[]);var me=n(344),_e=n(867),fe=n(484),ye=n(743),ve=n(556),Se=function(){function e(){}return e.prototype.shouldShowRibbonToggleButtonInHeader=function(){return!0},e.prototype.getReactCommand=function(e){var t=O.w.get_instance().tryResolve(ne).getCommandById(e);return t&&t.length>0?t[0].get_externalUxCommand():(u.ULS.sendTraceTag(594929363,340,10,String.format("GetReactCommand cannot find the command mapping for {0}",e)),null)},e.prototype.getWorkflowButtonAppProps=function(){var e=null,t=le.g();if(t){var n=this.getReactCommand(t.command);n&&(e=(0,R.m)(new ge,{command:n,label:t.label}))}return e},e.prototype.getControls=function(){return(0,R.m)(new he,{ribbonToggleId:le.f(this.shouldShowRibbonToggleButtonInHeader())?"ToggleRibbonUXDialog":null,workflowButton:p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WorkflowButtonsInSharedHeaderIsEnabled")?this.getWorkflowButtonAppProps():null})},e.prototype.getDocumentTitleAppProps=function(){var e=p.AFrameworkApplication.docPropertiesProvider.get_breadcrumbDocName();return(0,R.m)(new pe,{documentTitle:p.AFrameworkApplication.get_documentIsFolder()?e:ve.l.getFileNameWithoutExtension(e),isVersionHistoryEnabled:this.shouldShowVersionHistory(),breadcrumbBrandName:p.AFrameworkApplication.breadcrumbBrandName,breadcrumbBrandUrl:p.AFrameworkApplication.breadcrumbBrandUrl,breadcrumbFolderName:p.AFrameworkApplication.breadcrumbFolderName,breadcrumbFolderUrl:p.AFrameworkApplication.breadcrumbFolderUrl,hideDocumentTitleInput:!p.AFrameworkApplication.isRenameSupported(),documentExtension:ve.l.getFileExtension(p.AFrameworkApplication.fileName)})},e.prototype.shouldShowVersionHistory=function(){return!!p.AFrameworkApplication.get_activeFrame()&&p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSharedHeaderVersionHistoryEnabled()},e.prototype.shouldEnableTheming=function(){return!!p.AFrameworkApplication.get_activeFrame()&&p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSharedHeaderThemingEnabled()},e.prototype.shouldShowChatControl=function(){return!le.o()&&!p.AFrameworkApplication.hideHeader&&(p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SkypeWebControlIsEnabled")||p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TeamsChatIsEnabled"))},e.prototype.continueShellServiceDataAsync=function(e){var t=_e.w(e.get_result());appChrome.api.dispatch(appChrome.actions.setHeaderNavBarData(t)),u.ULS.sendTraceTag(50602782,215,50,"SetHeaderNavBarData has been dispatched.")},e.prototype.onHeaderReducersReady=function(){var e=this;O.w.get_instance().resolveFuture(ie.u).execute((function(t){t.get_shellServiceDataAsync().CWo(r.i(e,e.continueShellServiceDataAsync,"continueShellServiceDataAsync"),se.d.onlyOnRanToCompletion)})),O.w.get_instance().resolveFuture(re).execute((function(e){e.updateSaveStatusDisplay(!1,p.AFrameworkApplication.get_theActionManager().get_mode())}))},e.prototype.getCookie=function(e){var t=me.g(e);return null!=t&&t.length>0&&(t=decodeURIComponent(t)),t},e.prototype.getSuiteUxShellPath=function(){return N.y.get_isAppChromeLocalhostScriptEnabled()?N.y.getLocalhostPath("suiteux-shell",!1):ye.h.staticContentHost+p.AFrameworkApplication.get_scriptFolderPath()+"suiteux-shell"},e.prototype.getProps=function(e){void 0===e&&(e=!1);var t=fe.i.getCultureInfo(p.AFrameworkApplication.lcid),n=t?t.get_name():"en-us",i=t?fe.i.getCultureInfo(t.get_languageId()).get_name():"en",o=le.k(),a=ce.isSearchEnabled(),s=O.w.get_instance().resolve(oe.f),l=(0,R.m)(new de,{appName:CommonUIStrings.l_AppNameShort,culture:n,language:i,isConsumer:!p.AFrameworkApplication.useO365ShellService,showAppLauncher:o,showMeControl:o,assetsContainerOverride:this.getSuiteUxShellPath(),controls:this.getControls(),documentTitleAppProps:e?null:this.getDocumentTitleAppProps(),showChatControl:this.shouldShowChatControl(),showGoPremiumControl:!e&&le.u(),onHeaderReducersReady:r.i(this,this.onHeaderReducersReady,"onHeaderReducersReady"),showSearchControl:a,enableSearchControl:a,onFlexPaneOpen:r.i(s,s.onFlexPaneOpen,"onFlexPaneOpen"),onFlexPaneClose:r.i(s,s.onFlexPaneClose,"onFlexPaneClose"),enableTheming:this.shouldEnableTheming(),setCookie:me.p,getCookie:r.i(this,this.getCookie,"getCookie"),enableDelayLoading:le.d(),testTraffic:p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SharedHeaderTestTrafficIsEnabled")});if(!p.AFrameworkApplication.userNameUnknown||p.AFrameworkApplication.signoutUrl?(l.userDisplayName=p.AFrameworkApplication.userName,l.emailAddress=p.AFrameworkApplication.appSettingsManager.getStringAppSetting("UserPrincipalName"),l.userID=p.AFrameworkApplication.appSettingsManager.getStringAppSetting("Puid")||""):l.signInLink=p.AFrameworkApplication.signInUrl,a){var u=new ce;u.loadTellMeStrings(),l.getTokenRequestDictionary=r.i(u,u.getTokenRequestDict,"getTokenRequestDict");var c=p.AFrameworkApplication.appSettingsManager.getStringAppSetting("Microsoft365Ring");c&&c.length||(c="generalAudience"),l.userRing=c}return l},e}();(0,r.l)(Se,"ReactSharedHeaderPropsHelper",null,[ae]);var Ce=n(98),be=n(334),Ae=n(928),Te=n(238),we=n(973),Ie=n(425),Ee=(0,r.y)("IDataSource"),ke=n(822),De=function(){function e(e,t){this._rootDataVarName=null,this._cuiHelper=null,this._ribbonData=null,this._tabData={},this._rootDataVarName=e,this._cuiHelper=t}return e.prototype.getData=function(e){var t=this.lookupData(e);return void 0!==this._cuiHelper&&null!==this._cuiHelper&&this._cuiHelper.updateData(t),t},e.prototype.lookupData=function(e){return window[e]},e.prototype.runQuery=function(e){if(null!=e){var t=null,n=!1;switch(e.queryType){case 1:case 4:case 2:t=this.getRootData(),n=!0;break;case 3:(n=!!(t=this._tabData[e.id]))||u.ULS.sendTraceTag(5247233,207,50,"{0}",{Msg:"Tab not available",Id:e.id})}var i=new ke.r;i.success=n,i.id=e.id,i.contextData=e.data,i.queryData=t,e.handler(i)}},e.prototype.getRootData=function(){return this._ribbonData||(this._ribbonData=this.getData(this._rootDataVarName))},e.prototype.addTabData=function(e,t){this._tabData[e]=this.getData(t)},e}();(0,r.l)(De,"JsonDataSource",null,[Ee]);var Me=n(239),Pe=n(319),Fe=n(257),xe=n(267),Re=n(697),Be=n(861),Le=n(345),Ne=n(946),Ue=function(e){function t(n,i,r){var o=e.call(this,n,i,"","")||this;return o._overflowFlyoutAnchor=null,o.heroDockControls=null,o._heroDockProperties=null,o.heroControlCount=t.defaultHeroControlCount,o.heroDockControls=new Array(0),o._heroDockProperties=r,o}return(0,i.t)(t,e),t.prototype.get_visibleInDOM=function(){return!0},t.prototype.get_cssClass=function(){return"cui-herodock"},t.prototype.refreshInternal=function(){this.refreshHeroDockVisuals(),e.prototype.refreshInternal.call(this)},t.prototype.ensureBehaviorAttached=function(){for(var t=0,n=this.heroDockControls;t<n.length;t++){n[t].ensureBehaviorAttachedIfAvailable()}e.prototype.ensureBehaviorAttached.call(this)},t.prototype.splitHeroDockControls=function(e,t,n){e.val=new Array(0),t.val=new Array(0),n.val=new Array(0);for(var i=0;i<this.heroDockControls.length;i++){var o=this.heroDockControls[i];o.get_visible()?e.val.length<this.heroControlCount?e.val.push(o):r.r(Re.FlyoutAnchor,o)?Array.addRange(t.val,o.getControlsInFlyoutAnchorMenu()):t.val.push(o):n.val.push(o)}},t.prototype.createOverflowMenu=function(e){if(!e||!e.length)return null;for(var t={DisplayMode:"Menu20",ShowSeperator:"false",Scrollable:"true"},n=new Be.Menu(this.get_root(),this.get_id()+"OverflowMenu",null,null,null),i=new Le.z(this.get_root(),this.get_id()+"OverflowMenuSection",null,null,t,n),r=0,o=e;r<o.length;r++){var a=o[r];i.addChild(a.createComponentForDisplayMode("Menu20"))}return n.addChild(i),n},t.prototype.refreshHeroDockVisuals=function(){var e,t,n;this.removeChildren(),this.set_elementInternal(Ne.n.removeChildNodes(this.get_elementInternal())),this.ensureDOMElement(),this.splitHeroDockControls((0,s.m)((function(){return e}),(function(t){return e=t})),(0,s.m)((function(){return t}),(function(e){return t=e})),(0,s.m)((function(){return n}),(function(e){return n=e})));for(var i=0,r=e;i<r.length;i++){(h=r[i].createComponentForDisplayMode("Medium20")).set_enabled(!0),this.addChildAtIndex(h,this.get_children().get_count()),this.get_elementInternal().appendChild(h.get_elementInternal()),h.ensureRefreshed()}var o=this.createOverflowMenu(t);if(o){if(this._overflowFlyoutAnchor)this._overflowFlyoutAnchor.set_menu(o);else{var a=this.get_id()+"OverflowMenuLauncher",l={};l.Image20by20=this._heroDockProperties.OverflowMenuImage20by20,l.Image20by20Class=this._heroDockProperties.OverflowMenuImage20by20Class,l.PopulateDynamically="false",l.HideDefaultArrow="true",l.Alt=this._heroDockProperties.OverflowMenuTooltip,l.Command="798637440",l.Id=a,this._overflowFlyoutAnchor=new Re.FlyoutAnchor(this.get_root(),a,l,o)}var u=this._overflowFlyoutAnchor.createComponentForDisplayMode("Small20");u.set_enabled(!0),this.addChildAtIndex(u,this.get_children().get_count()),this.get_elementInternal().appendChild(u.get_elementInternal()),u.ensureRefreshed()}if(p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FixHeroDockNotPollingInvisibleComponentsIsEnabled"))for(var c=0,d=n;c<d.length;c++){var h=d[c].createComponentForDisplayMode("Medium20");this.addChild(h),h.ensureRefreshed()}},t.prototype.dispose=function(){this._overflowFlyoutAnchor&&(this._overflowFlyoutAnchor.dispose(),this._overflowFlyoutAnchor=null);for(var t=0,n=this.heroDockControls;t<n.length;t++){n[t].dispose()}this.removeChildren(),e.prototype.dispose.call(this)},t.defaultHeroControlCount=4,t}(xe.s);(0,r.l)(Ue,"HeroDock",xe.s,[]);var Oe=function(e){function t(){var t=e.call(this)||this;return t.staticUiTouchMode=!1,t.isOneRowToolbar=!1,t.supportsEmphasizedControls=!1,t.maxElementsBeforeOverflow=p.AFrameworkApplication.isMobileMode?1:Ue.defaultHeroControlCount,t}return(0,i.t)(t,e),t}(Fe.l);(0,r.l)(Oe,"ToolbarBuildOptions",Fe.l,[]);var He=n(619),We=n(742),Ve=n(192),$e=n(432),Ke=n(513),ze=(0,r.y)("IToolbar"),qe=n(435),Qe=n(700),Ge=n(268),je=n(836),Ze=function(e){function t(t,n,i){var r=e.call(this,t,n,"","")||this;return r._alignment=null,r._dropFromStart=!1,r._alignment=i.Alignment,r._dropFromStart=i.ScalingDirection===Ve.o.FIRSTTOLAST,r}return(0,i.t)(t,e),t.prototype.refreshInternal=function(){this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.get_elementInternal()),e.prototype.refreshInternal.call(this)},t.prototype.appendChildrenToElement=function(e){for(var t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();switch(n.ensureDOMElement(),this._alignment){case Ve.o.LEFTALIGN:Ne.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-toolbar-button-left");break;case Ve.o.CENTERALIGN:Ne.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-toolbar-button-center");break;case Ve.o.RIGHTALIGN:Ne.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-toolbar-button-right");break;default:throw Error.argumentOutOfRange(this._alignment)}n.get_visible()&&e.appendChild(n.get_elementInternal()),n.ensureRefreshed()}},t.prototype.ensureCorrectChildType=function(e){if(!r.r(Ge.r,e))throw Error.create("Only children of type ControlComponent can be added to a ButtonDock.")},t.prototype.get_cssClass=function(){switch(this._alignment){case Ve.o.LEFTALIGN:return"cui-toolbar-buttondock alignleft";case Ve.o.CENTERALIGN:return"cui-toolbar-buttondock aligncenter";case Ve.o.RIGHTALIGN:return"cui-toolbar-buttondock alignright";default:throw Error.argumentOutOfRange(this._alignment)}},t.prototype.get_visibleInDOM=function(){return!0},t.prototype.get_alignment=function(){return this._alignment},t.prototype.getWidthPx=function(){var e=0;if(this.get_alignment()===Ve.o.CENTERALIGN)for(var t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();n.get_visible()&&(e+=n.get_elementInternal().offsetWidth)}else e=this.get_elementInternal().offsetWidth;return e},t.prototype.getStartPoint=function(){var e=null;if(this.get_alignment()===Ve.o.CENTERALIGN)for(var t=this.get_children().getEnumerator();t.moveNext();){var n=t.get_current();if(n.get_visible()){e=Sys.UI.DomElement.getBounds(n.get_elementInternal());break}}else e=Sys.UI.DomElement.getBounds(this.get_elementInternal());return e?this.get_root().get_textDirection()?e.x+e.width:e.x:0},t.prototype.getEndPoint=function(){var e=null;if(this.get_alignment()===Ve.o.CENTERALIGN){if(this.get_children().get_count()>0)for(var t=this.get_children().getEnumeratorAtPos(this.get_children().get_count()-1);t.movePrevious();){var n=t.get_current();if(n.get_visible()){e=Sys.UI.DomElement.getBounds(n.get_elementInternal());break}}}else e=Sys.UI.DomElement.getBounds(this.get_elementInternal());return e?this.get_root().get_textDirection()?e.x:e.x+e.width:0},t.prototype.ensureNoChildrenScaledAway=function(){for(var e=this.get_children().getEnumerator();e.moveNext();){var t=e.get_current();r.r(Ge.r,t)&&!t.get_control().get_visible()||t.set_visible(!0)}},t.prototype.scaleDownToFitSize=function(e){for(var t=this.get_children().toArray(),n=new je.y,i=this._dropFromStart?0:t.length-1,o=this.get_children().get_count(),a=this.get_root().get_supportsInvisibleControls();this.getWidthPx()>=e&&!(i>=o||i<0);){var s=t[i];a&&r.r(Ge.r,s)&&s.get_control().get_visible()&&(n.add(s),s.applyHideElementOverride()),i+=this._dropFromStart?1:-1}for(var l=n.getEnumerator();l.moveNext();){(s=l.get_current()).removeHideElementOverride(),s.set_visible(!1)}},t}(xe.s);(0,r.l)(Ze,"ButtonDock",xe.s,[]);var Xe=function(e){function t(t,n,i,r,o,a,s){void 0===s&&(s=!1);var l=e.call(this,t,n,a)||this;return l._builder$3=null,l._startDock=null,l._centerDock=null,l._endDock=null,l._multipleDocksOfSameType=!1,l._toolbarScalingOptimizationsEnabled=!1,l._toolbarSize=0,l._builder$3=i,l.set_isStaticUiTouchMode(r),l.supportsEmphasizedControls=o,l._toolbarSize=0,Ke.x(n.Size)||(n.Size===Ve.o.ONEROW||i.get_options().isOneRowToolbar?l._toolbarSize=0:n.Size===Ve.o.SINGLEDOCK&&(l._toolbarSize=1)),l._toolbarScalingOptimizationsEnabled=s,l}return(0,i.t)(t,e),t.prototype.get_supportsInvisibleControls=function(){return!0},t.prototype.addChild=function(t){if(e.prototype.addChild.call(this,t),r.r(Ze,t)&&!this._multipleDocksOfSameType){var n=t;n.get_alignment()===Ve.o.LEFTALIGN?(this._startDock&&this.setMultipleDocksOfSameType(),this._startDock=n):n.get_alignment()===Ve.o.CENTERALIGN?(this._centerDock&&this.setMultipleDocksOfSameType(),this._centerDock=n):n.get_alignment()===Ve.o.RIGHTALIGN&&(this._endDock&&this.setMultipleDocksOfSameType(),this._endDock=n)}},t.prototype.setMultipleDocksOfSameType=function(){this._multipleDocksOfSameType=!0,this._startDock=null,this._centerDock=null,this._endDock=null},t.prototype.setControlVisibility=function(e,t,n){void 0===n&&(n=!0);var i=this.getControlById(e);Ke.x(i)||i.get_visible()===t||(i.set_visible(t),n&&this.refresh())},t.prototype.refreshInternal=function(){e.prototype.refreshInternal.call(this),this.refreshInternalCore(!0)},t.prototype.refreshInternalCore=function(e){var t=this.get_root().get_controlWithFocus();Ke.x(this.get_elementInternal())&&this.createToolbarStructure(),this.set_elementInternal(Ne.n.removeChildNodes(this.get_elementInternal())),this.hiddenLabel&&this.get_elementInternal().appendChild(this.hiddenLabel);for(var n=this.get_children().getEnumerator();n.moveNext();){var i=n.get_current();i.get_visible()&&(i.ensureDOMElement(),this.get_elementInternal().appendChild(i.get_elementInternal()),i.ensureRefreshed())}this._centerDock&&e&&this.ensureCenterDockLayout(),t&&t.setFocusOnControl(),this.set_dirty(!1)},t.prototype.ensureCenterDockLayout=function(){if(this._centerDock.get_visible()&&this._centerDock.get_children().get_count()&&(this.applyMarginsToCenterDock(0,0),this.doesCenterDockCollide(this._startDock,this._centerDock,this._endDock))){var e=0,t=0,n=this._startDock?this._startDock.getWidthPx():0,i=this._endDock?this._endDock.getWidthPx():0;(i>0||n>0)&&(i>n?(e=0,t=i-n):(e=n-i,t=0)),this.applyMarginsToCenterDock(e,t)}},t.prototype.doesCenterDockCollide=function(e,t,n){var i=!1;return this.get_root().get_textDirection()?(e&&(i=e.getEndPoint()<t.getStartPoint()),!i&&n&&(i=t.getEndPoint()<n.getStartPoint())):(e&&(i=e.getEndPoint()>t.getStartPoint()),!i&&n&&(i=t.getEndPoint()>n.getStartPoint())),i},t.prototype.applyMarginsToCenterDock=function(e,t){this.get_textDirection()?(this._centerDock.get_elementInternal().style.marginRight=e+"px",this._centerDock.get_elementInternal().style.marginLeft=t+"px"):(this._centerDock.get_elementInternal().style.marginLeft=e+"px",this._centerDock.get_elementInternal().style.marginRight=t+"px")},t.prototype.createToolbarStructure=function(){this.ensureDOMElement()},t.prototype.pollForStateAndUpdateInternal=function(){var e=this;this.doPoll((function(){Qe.z.prototype.pollForStateAndUpdateInternal.call(e)}))},t.prototype.pollForControlState=function(e){var t=this.getControlById(e);Ke.x(t)||this.doPoll(r.i(t,t.pollForStateAndUpdate,"pollForStateAndUpdate"))},t.prototype.doPoll=function(e){this.needScaling=!1,this.needRefresh=!1,e(),(this.needScaling||this.needRefresh)&&(this._toolbarScalingOptimizationsEnabled||this.refresh(),this.scale())},t.prototype.ensureCorrectChildType=function(e){if(!r.r(Ue,e)&&!r.r(Ze,e))throw Error.create("Only children of type ButtonDock and HeroDock can be added to a Toolbar");if(r.r(Ze,e)&&e.get_alignment()===Ve.o.CENTERALIGN)for(var t=this.get_children().getEnumerator();t.moveNext();){if(t.get_current().get_alignment()===Ve.o.CENTERALIGN)throw Error.create("Can't add a centered buttondock because one is already present.")}},t.prototype.get_cssClass=function(){var t="cui-toolbar-toolbar ";return this._toolbarSize?1===this._toolbarSize&&(t+="cui-toolbar-singledock "):(t+="cui-toolbar-onerow ",p.AFrameworkApplication.get_activeFrame()&&p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()||(t+="UITextTranformUpperCase ")),t+e.prototype.get_cssClass.call(this)},t.prototype.get_domElementTagName=function(){return"div"},t.prototype.get_rootType=function(){return 26},t.prototype.get_toolbarBuilder=function(){return this.get_builder()},t.prototype.set_toolbarBuilder=function(e){return this.set_builder(e),e},t.prototype.createButtonDock=function(e,t){var n=e[Ve.o.ATTRIBUTES];return new Ze(this.get_root(),n.Id,n)},t.prototype.ensureDOMElement=function(){e.prototype.ensureDOMElement.call(this),this.get_elementInternal().setAttribute("role","toolbar"),this.get_properties().Title&&this.get_elementInternal().setAttribute("title",this.get_properties().Title)},t.prototype.updateOpenMenu=function(e){return!(!this.get_root()||!this.get_root().refreshOpenMenu(e))},t.prototype.setFocusOnToolbar=function(){return this.setFocusOnFirstControl()},t.prototype.scale=function(){if(e.prototype.scale.call(this),!Ne.n.isTrue(this.get_properties().Scale))return!1;if(this._multipleDocksOfSameType)return!1;Ke.x(this._startDock)||(this._startDock.set_visible(!0),this._startDock.ensureNoChildrenScaledAway()),Ke.x(this._centerDock)||(this._centerDock.set_visible(!0),this._centerDock.ensureNoChildrenScaledAway()),Ke.x(this._endDock)||(this._endDock.set_visible(!0),this._endDock.ensureNoChildrenScaledAway()),this.refreshInternalCore(!1);var t=this.get_elementInternal().offsetWidth,n=Ke.x(this._startDock)?0:this._startDock.getWidthPx(),i=Ke.x(this._centerDock)?0:this._centerDock.getWidthPx(),r=Ke.x(this._endDock)?0:this._endDock.getWidthPx();return r+i+n>=t&&(r+n>=t?(this.hideDockIfPresent(this._centerDock),r>=t?(this.hideDockIfPresent(this._startDock),this.scaleDockIfPresent(this._endDock,t)):this.scaleDockIfPresent(this._startDock,t-r)):this.scaleDockIfPresent(this._centerDock,t-r-n)),this.needScaling=!1,this.refreshInternal(),!1},t.prototype.hideDockIfPresent=function(e){e&&e.set_visible(!1)},t.prototype.scaleDockIfPresent=function(e,t){e&&e.scaleDownToFitSize(t)},t.oneRowToolbarHeightPx=26,t}(qe.b);(0,r.l)(Xe,"Toolbar",qe.b,[ze]);var Je=function(e){function t(t,n,i,r,o){void 0===o&&(o=!1);var a=e.call(this,t,n,i,!1,!1,r,o)||this;return a._launchMenusUp=!0,a}return(0,i.t)(t,e),t.prototype.get_rootType=function(){return 7},t.prototype.get_cssClass=function(){return t.get_statusBarClassName()+" "+e.prototype.get_cssClass.call(this)},t.get_statusBarClassName=function(){var e="cui-statusbar";return p.AFrameworkApplication.get_activeFrame()&&p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()||(e+=" UISmallFont UITextTranformUpperCase"),e},t}(Xe);(0,r.l)(Je,"StatusBar",Xe,[]);var Ye=n(808),et=function(e){function t(){var t=e.call(this)||this;return t.toolbar=null,t.isStatusBar=!1,t}return(0,i.t)(t,e),t}(Ye.n);(0,r.l)(et,"ToolbarBuildContext",Ye.n,[]);var tt=function(e){function t(t,n,i,r){var o=e.call(this,t,n,We.Task.fromResult(F,i),r)||this;if(Ke.x(n))throw Error.create("Toolbar placeholder DOM element is null or undefined.");return o}return(0,i.t)(t,e),t.prototype.get_toolbar=function(){return this.get_root()},t.prototype.set_toolbar=function(e){return this.set_root(e),e},t.prototype.get_toolbarBuildOptions=function(){return this.get_options()},t.prototype.buildToolbar=function(){var e=new et,t=new $e.v;t.id="toolbar",t.queryType=1,t.handler=r.i(this,this.onReturnToolbarData,"onReturnToolbarData"),t.data=e,this.get_dataSource().runQuery(t)},t.prototype.onReturnToolbarData=function(e){var t=this,n=e.contextData;this.set_toolbar(this.buildToolbarFromData(e.queryData,n)),this.get_toolbar().set_toolbarBuilder(this),this.get_toolbar().refreshInternal(),this.get_placeholder().appendChild(this.get_toolbar().get_elementInternal()),Ne.n.ensureCSSClassOnElement(this.get_placeholder(),"loaded"),this.get_buildClientTask().CWo((function(e){t.get_buildClientTask().get_result().onComponentBuilt(t.get_toolbar(),t.get_toolbar().get_id())}),se.d.onlyOnRanToCompletion|se.d.executeSynchronously)},t.prototype.buildToolbarFromData=function(e,t){var n=Ve.o.getFirstChildNodeWithName(e,Ve.o.TOOLBAR);if(Ke.x(n)&&(n=Ve.o.getFirstChildNodeWithName(e,Ve.o.STATUSBAR),t.isStatusBar=!0),Ke.x(n))throw Error.create("No toolbar element was present in the data");var i=new Ve.o(n),r=p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ToolbarScalingRedundancyEliminationIsEnabled");t.isStatusBar?this.set_toolbar(new Je(i.get_attributes()[Ve.o.id],i.get_attributes(),this,this.get__resizableContainer(),r)):this.set_toolbar(new Xe(i.get_attributes()[Ve.o.id],i.get_attributes(),this,this.get_toolbarBuildOptions().staticUiTouchMode,this.get_toolbarBuildOptions().supportsEmphasizedControls,this.get__resizableContainer(),r)),this.get_toolbar().set_clientID(this.get_options().clientID),this.get_toolbar().set_useDataCookie(!0),this.get_toolbar().refreshInternal();for(var o=Ve.o.getNodeChildren(Ve.o.getFirstChildNodeWithName(i.get_node(),Ve.o.DOCKS)),a=0,s=this.buildAllDocksFromData(o,t);a<s.length;a++){var l=s[a];this.get_toolbar().addChild(l)}return this.get_toolbar()},t.prototype.buildAllDocksFromData=function(e,t){for(var n=new Array(0),i=0;i<e.length;i++)this.isNodeTrimmed(e[i])||Array.add(n,this.buildDockFromData(e[i],t));return n},t.prototype.buildDockFromData=function(e,t){var n=Ve.o.getNodeName(e),i=null;return n===Ve.o.BUTTONDOCK?i=this.buildButtonDockFromData(e,t):n===Ve.o.HERODOCK&&(i=this.buildHeroDockFromData(e,t)),i},t.prototype.buildHeroDockFromData=function(e,t){var n=new Ve.o(e),i=e[Ve.o.ATTRIBUTES],r=new Ue(this.get_root(),n.get_attributes()[Ve.o.id],i);r.heroControlCount=this.get_toolbarBuildOptions().maxElementsBeforeOverflow;for(var o=Ve.o.getFirstChildNodeWithName(e,Ve.o.CONTROLS),a=Ve.o.getNodeChildren(o),s=new Array(0),l=0;l<a.length;l++){var u=a[l];if(!this.isNodeTrimmed(u)){var c=this.buildControl(u,t);Array.add(s,c)}}return r.heroDockControls=s,r},t.prototype.buildButtonDockFromData=function(e,t){new Ve.o(e);for(var n=this.get_toolbar().createButtonDock(e,t),i=Ve.o.getFirstChildNodeWithName(e,Ve.o.CONTROLS),r=Ve.o.getNodeChildren(i),o=0;o<r.length;o++)if(!this.isNodeTrimmed(r[o])){var a=this.buildToolbarControlComponent(r[o],t);n.addChild(a)}return n},t.prototype.buildToolbarControlComponent=function(e,t){var n,i=new Ve.o(e),r=i.get_name(),o=i.get_attributes()[Ve.o.DISPLAYMODE];switch(n=t.isStatusBar?"Small14":"Small",r){case Ve.o.button:return this.buildControl(e,t).createComponentForDisplayMode(Ke.t(o)?n:o);case Ve.o.flyoutAnchor:return n=t.isStatusBar?"Medium14":"Medium",this.buildControl(e,t).createComponentForDisplayMode(Ke.t(o)?n:o);case Ve.o.label:return this.buildControl(e,t).createComponentForDisplayMode(Ke.t(o)?n:o);case Ve.o.separator:return this.buildControl(e,t).createComponentForDisplayMode("Small");case Ve.o.toggleButton:return this.buildControl(e,t).createComponentForDisplayMode(Ke.t(o)?n:o);default:throw Error.create("Invalid control type.")}},t}(He.Builder);(0,r.l)(tt,"ToolbarBuilder",He.Builder,[]);var nt="WordViewerToolbarData",it="toolbar",rt=function(){function e(e,t,i,r){var o=this;if(this._hostingAppFrame=null,this._theToolbar=null,this._theViewerChrome=null,this._theStandaloneRoot=null,this._topRowControls=null,null==e)throw Error.argumentNull("hostingAppFrame");this._hostingAppFrame=e,this.createStandaloneRoot();var a=new te.CuiHelper(W.s.wordViewerImageBase,WordViewerIntl.WordViewerStrings),s=null;p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()?s=H.getAppChrome(!1):this._topRowControls=a.createTopRowControls(it,t,null,this._theStandaloneRoot,!0);var l=new Oe;l.clientID=it,l.staticUiTouchMode=e.get_isStaticUiTouchMode(),l.supportsEmphasizedControls=!0,l.trimmedIds={},G(l.trimmedIds,p.AFrameworkApplication.get_trimDownloadACopy(),this._hostingAppFrame.get_wordViewerApp().get_isPdfMode(),p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordDownloadAsPdfIsEnabled"),p.AFrameworkApplication.downloadCopyOnOpenInClient,!!this._hostingAppFrame.get_wordViewerApp().get_translationLanguage()),this._hostingAppFrame.get_wordViewerApp().get_isPdfMode()?(l.trimmedIds.jbtnAccessibility=!0,l.trimmedIds.flyoutWordViewerEdit=!0,l.trimmedIds.flyoutWordViewerOpen=!0,l.trimmedIds.btnInteractiveViewOnWeb=!0,l.trimmedIds.btnOpenInClient=!0,l.trimmedIds.btnOpenCommentPane=!0,l.trimmedIds.btnEditOnWeb=!0,l.trimmedIds.btnConvertToEditOnWeb=!0,l.trimmedIds.btnCopyAndEdit=!0,l.trimmedIds.sep1=!0):(l.trimmedIds.btnPdfConvertAndEdit=!0,l.trimmedIds.btnPdfCopyAndEdit=!0,l.trimmedIds.jbtnAccessibilityPdf=!0),q(l.trimmedIds,this._hostingAppFrame.get_wordViewerApp().get_userMayEnterAccessiblePdfMode(),this._hostingAppFrame.get_wordViewerApp().get_isAccessiblePdfMode(),p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("UIDiscoverabilityEnabled")),Q(l.trimmedIds,p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("DirectPrintIsEnabled"),this._hostingAppFrame.get_wordViewerApp().get_isPdfMode(),this._hostingAppFrame.get_wordViewerApp().get_showPrint()),j(l.trimmedIds),!p.AFrameworkApplication.copyAndEditUrl||p.AFrameworkApplication.get_protectFile()||this._hostingAppFrame.get_wordViewerApp().get_translationLanguage()?this._hostingAppFrame.get_wordViewerApp().get_supportsEditing()&&n(941).App.canEdit?e.get_editNeedsConversion()?(l.trimmedIds.btnEditOnWeb=!0,l.trimmedIds.btnCopyAndEdit=!0,l.trimmedIds.btnPdfCopyAndEdit=!0,l.trimmedIds.btnFlyoutEditOnWeb=!0,l.trimmedIds.btnFlyoutCopyAndEdit=!0,l.trimmedIds.btnSaveToCloudStorage=!0):(l.trimmedIds.btnConvertToEditOnWeb=!0,l.trimmedIds.btnPdfConvertAndEdit=!0,l.trimmedIds.btnCopyAndEdit=!0,l.trimmedIds.btnPdfCopyAndEdit=!0,l.trimmedIds.btnFlyoutConvertToEditOnWeb=!0,l.trimmedIds.btnFlyoutCopyAndEdit=!0,l.trimmedIds.btnSaveToCloudStorage=!0):(l.trimmedIds.btnConvertToEditOnWeb=!0,l.trimmedIds.btnPdfConvertAndEdit=!0,l.trimmedIds.btnCopyAndEdit=!0,l.trimmedIds.btnPdfCopyAndEdit=!0,l.trimmedIds.btnEditOnWeb=!0,l.trimmedIds.sep1=!0):(l.trimmedIds.btnConvertToEditOnWeb=!0,l.trimmedIds.btnPdfConvertAndEdit=!0,l.trimmedIds.btnFlyoutConvertToEditOnWeb=!0,l.trimmedIds.btnEditOnWeb=!0,l.trimmedIds.btnFlyoutEditOnWeb=!0,p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")&&"HMWeb"===p.AFrameworkApplication.appSettingsManager.get_appSettings().FileSource||(l.trimmedIds.btnSaveToCloudStorage=!0)),Ie.y.get_isMobile()&&(l.trimmedIds.btnSaveToCloudStorage=!0),p.AFrameworkApplication.get_protectFile()&&(l.trimmedIds.btnPrintToPdf=!0,l.trimmedIds.jbtnPrintPdfFile=!0,l.trimmedIds.btnPrintPdfFile=!0,l.trimmedIds.jbtnAccessibility=!0,l.trimmedIds.jbtnAccessibilityPdf=!0,l.trimmedIds.jbtnTranslateDocument=!0),(p.AFrameworkApplication.get_protectFile()||p.AFrameworkApplication.get_isEmbedded()||!p.AFrameworkApplication.hostEmbeddedViewUrl&&!p.AFrameworkApplication.fileEmbedCommandUrl&&!p.AFrameworkApplication.useFileEmbedCommandPostMessage)&&(l.trimmedIds.jbtnFileEmbed=!0),i.officeTrialExperience&&i.officeTrialExperience.get_offerOfficeTrialInFileMenu()||(l.trimmedIds.msJewelTryOffice=!0,l.trimmedIds.btnjTryOffice=!0,u.ULS.shipAssertTag(5838167,301,!!i.officeTrialExperience)),i.macOfficeOffer&&i.macOfficeOffer.get_shouldOfferMacOfficeTrialInFileMenu()||(l.trimmedIds.msJewelTryMacOffice=!0,l.trimmedIds.btnjTryMacOffice=!0,u.ULS.shipAssertTag(5838168,301,!!i.macOfficeOffer)),p.AFrameworkApplication.get_trimOICButtons()||p.AFrameworkApplication.limitedEdit?(l.trimmedIds.flyoutWordViewerEdit=!0,l.trimmedIds.flyoutWordViewerOpen=!0,l.trimmedIds.btnOpenInClient=!0,!p.AFrameworkApplication.limitedEdit&&this._hostingAppFrame.get_wordViewerApp().get_supportsEditing()&&n(941).App.interactiveViewIsEnabled||(l.trimmedIds.btnInteractiveViewOnWeb=!0)):this._hostingAppFrame.get_wordViewerApp().get_supportsEditing()?(n(941).App.canEdit?(p.AFrameworkApplication.get_disableEditIfAndroid()?l.trimmedIds.flyoutWordViewerEdit=!0:l.trimmedIds.btnOpenInClient=!0,l.trimmedIds.flyoutWordViewerOpen=!0):n(941).App.interactiveViewIsEnabled?(l.trimmedIds.flyoutWordViewerEdit=!0,l.trimmedIds.btnOpenInClient=!0):(l.trimmedIds.flyoutWordViewerEdit=!0,l.trimmedIds.flyoutWordViewerOpen=!0),l.trimmedIds.btnInteractiveViewOnWeb=!0,l.trimmedIds.btnConvertToEditOnWeb=!0,l.trimmedIds.btnCopyAndEdit=!0,l.trimmedIds.btnEditOnWeb=!0):(l.trimmedIds.flyoutWordViewerEdit=!0,l.trimmedIds.flyoutWordViewerOpen=!0,l.trimmedIds.btnInteractiveViewOnWeb=!0),this._hostingAppFrame.get_wordViewerApp().get_translationLanguage()?(l.trimmedIds.jbtnFileProperties=!0,l.trimmedIds.jbtnFileVersion=!0,l.trimmedIds.btnOpenInClient=!0,l.trimmedIds.btnFileSharing=!0,l.trimmedIds.jbtnBroadcast=!0,l.trimmedIds.jbtnFileEmbed=!0,l.trimmedIds.jbtnTranslateDocument=!0,l.trimmedIds.btnSaveToCloudStorage=!0):l.trimmedIds.jbtnTranslateDocumentBack=!0,this._hostingAppFrame.get_wordViewerApp().get_userCanWriteRelative()||(l.trimmedIds.btnPdfConvertAndEdit=!0,l.trimmedIds.btnPdfCopyAndEdit=!0),ee()&&(l.trimmedIds.btnOpenCommentPane=!0),p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("SaveToCloudStorageUIIsEnabled")||(l.trimmedIds.btnSaveToCloudStorage=!0),this._hostingAppFrame.get_wordViewerApp().get_isBroadcastMode()?(l.trimmedIds.jbtnTranslateDocument=!0,l.trimmedIds.jbtnTranslateDocumentBack=!0,l.trimmedIds.jbtnBroadcast=!0,l.trimmedIds.btnFileSharing=!0,l.trimmedIds.btnOpenInClient=!0,l.trimmedIds.btnDownloadWithWord=!0,l.trimmedIds.btnDownloadPdf=!0,l.trimmedIds.sep1=!0,l.trimmedIds.msJewelTryMacOffice=!0,l.trimmedIds.btnjTryMacOffice=!0,l.trimmedIds.msJewelTryOffice=!0,l.trimmedIds.btnjTryOffice=!0,l.trimmedIds.btnjTryO14=!0,l.trimmedIds.msJewelProperties=!0,l.trimmedIds.jbtnFileEmbed=!0,l.trimmedIds.btnCopyAndEdit=!0,l.trimmedIds.btnConvertToEditOnWeb=!0,l.trimmedIds.btnPdfConvertAndEdit=!0,l.trimmedIds.btnPdfCopyAndEdit=!0,l.trimmedIds.btnEditOnWeb=!0,l.trimmedIds.btnOpenSearchPane=!0,l.trimmedIds.jbtnFileVersion=!0,l.trimmedIds.btnjClose=!0,l.trimmedIds.jbtnAccessibility=!0,l.trimmedIds.jbtnAccessibilityPdf=!0,l.trimmedIds.jbtnReportAbuse=!0,l.trimmedIds.btnSaveToCloudStorage=!0):(l.trimmedIds.btnSyncToPresenter=!0,l.trimmedIds.btnOpenSharedNotes=!0),p.AFrameworkApplication.get_disableEditIfAndroid()&&(this._hostingAppFrame.get_wordViewerApp().get_isPdfMode()?(l.trimmedIds.btnPdfConvertAndEdit=!0,l.trimmedIds.btnPdfCopyAndEdit=!0):(l.trimmedIds.btnEditOnWeb=!0,l.trimmedIds.flyoutWordViewerEdit=!0,l.trimmedIds.flyoutWordViewerOpen=!0,l.trimmedIds.btnInteractiveViewOnWeb=!0,l.trimmedIds.btnFlyoutEditOnWeb=!0,l.trimmedIds.btnFlyoutConvertToEditOnWeb=!0,l.trimmedIds.btnFlyoutCopyAndEdit=!0,l.trimmedIds.btnConvertToEditOnWeb=!0)),p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerLearningToolsIsEnabled")?p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsEduUser")?l.trimmedIds.btnLaunchImmersiveViewNonEdu=!0:l.trimmedIds.btnLaunchImmersiveViewEdu=!0:(l.trimmedIds.btnLaunchImmersiveViewEdu=!0,l.trimmedIds.btnLaunchImmersiveViewNonEdu=!0),p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TrustCenterDialogIsEnabled")||(l.trimmedIds.jbtnTrustCenter=!0),l.trimmedIds.btnSaveAndEdit=!this._hostingAppFrame.get_wordViewerApp().get_userCanSaveAndEditTranslatedDocument(),this._theViewerChrome=new Ce.k(t,it,r,p.AFrameworkApplication.hideHeader),p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled()&&s.then((function(){appChrome.api.setWebpackPublicPath(p.AFrameworkApplication.get_staticContentScriptNameBase());var e=new Se;appChrome.renderSharedHeader(o._theViewerChrome.get_peripheralContentContainer(),e.getProps(!0))}));var c=new tt(l,this._theViewerChrome.get_toolbarContainer(),this,r);c.set_dataSource(new De(nt,a)),c.buildToolbar(),this._theToolbar=c.get_toolbar(),this._theToolbar.set_rootUser(this),this._theToolbar.refresh(),this._theViewerChrome.scale(),this.poll(),Ae.x(n(752).AppFrame.ribbonFocusId,null,this._theViewerChrome.get_toolbarContentContainer(),!1,!0,!this._hostingAppFrame.get_wordViewerApp().get_isAccessiblePdfMode(),!this._hostingAppFrame.get_wordViewerApp().get_isAccessiblePdfMode()),Ae.x(n(752).AppFrame.headerUiFocusId,null,this._theViewerChrome.get_peripheralContentContainer(),!1,!0,!this._hostingAppFrame.get_wordViewerApp().get_isAccessiblePdfMode(),!this._hostingAppFrame.get_wordViewerApp().get_isAccessiblePdfMode())}return e.prototype.createStandaloneRoot=function(){var e=new Pe.c;e.ImageUpArrow=e.ImageDownArrow=e.ImageSideArrow=p.AFrameworkApplication.get_imageClusterPath(),e.ImageUpArrowClass=we.getImageClass("RibbonUpArrow_5x3x32"),e.ImageDownArrowClass=we.getImageClass("SplitButtonArrow_5x3x32"),e.ImageSideArrowClass=we.getImageClass("SubmenuFlyoutArrow_13x13x32"),e.TextDirection=p.AFrameworkApplication.get_isRtl()?"rtl":"ltr",this._theStandaloneRoot=new Me.w("TheStandaloneRoot",e),this._theStandaloneRoot.set_rootUser(this),this._theStandaloneRoot.refresh()},e.prototype.dispose=function(){this._theToolbar&&(this._theToolbar.dispose(),this._theToolbar=null),this._theViewerChrome&&(this._theViewerChrome.dispose(),this._theViewerChrome=null),this._theStandaloneRoot&&(this._theStandaloneRoot.dispose(),this._theStandaloneRoot=null),this._topRowControls&&(te.CuiHelper.disposeTopRowControls(this._topRowControls),this._topRowControls=null)},e.prototype.get_theToolbar=function(){return this._theToolbar},e.prototype.get_theViewerChrome=function(){return this._theViewerChrome},e.prototype.poll=function(){this._theToolbar.pollForStateAndUpdate(),this._theStandaloneRoot.pollForStateAndUpdate()},e.prototype.executeRootCommand=function(e,t,n,i,r){if(void 0===i&&(i=null),void 0===r&&(r=null),p.AFrameworkApplication.isShuttingDown)return!1;var o=parseInt(e),a=null;switch(o){case c.bT:a=Te.l;break;case C.Io:case C.RV:a=new be.p(a,n.InvocationMethod);break;case C.GA:case C.AB:case c.ui:case c.KQ:case c.MR:case c.jz:case c.uO:case c.LY:case c.jG:case c.vr:case c.Dt:a=t}var s=p.AFrameworkApplication.get_theActionManager();return n&&(s.set_commandLocation(n.CommandLocation),s.set_invocationMethod(n.InvocationMethod)),32===s.processActionWithData(o,2,a,r)},e.prototype.isRootCommandEnabled=function(e){if(p.AFrameworkApplication.isShuttingDown)return!1;if(!e)return!0;var t=parseInt(e);return 32===p.AFrameworkApplication.get_theActionManager().processAction(t,1)},e.prototype.onComponentBuilt=function(e,t){e.set_rootUser(this)},e.ribbonScopeSetFocus=function(e,t){var i=n(941).App.get_activeAppFrame();i&&i.get_ribbonUser()&&i.get_ribbonUser().get_theToolbar().pollForStateAndUpdate()},e}();(0,r.l)(rt,"RibbonUser",null,[P.t,F,Sys.IDisposable]);var ot=n(66),at=n(749),st=function(e){if(!n(941).App.get_instance().get_isAccessiblePdfMode()){var t=e.getScope(l.AFrame.appFocusId);t.bindAction(at.KeyInputManager.hashKeyString(WordViewerIntl.WordViewerStrings.l_HK_Find),C.Ap),t.bindAction(at.KeyInputManager.hashKey(ot.v.vK_F3,0),C.Ap),Ie.y.get_isFirefox()&&(t.bindAction(at.KeyInputManager.hashKey(ot.v.vK_SingleQuote,0),C.Ap),t.bindAction(at.KeyInputManager.hashKey(ot.v.vK_Slash,0),C.Ap),t.bindAction(at.KeyInputManager.hashKey(ot.v.vK_F3,4),C.Ap),t.bindAction(at.KeyInputManager.hashKey(ot.v.vK_G,4|at.KeyInputManager.get_commandKeyModifier()),C.Ap))}},lt=n(69),ut=n(144),ct=n(168),pt=function(){function e(){this.downloadEnabled=!1,this.feedbackEnabled=!1,this.hasPrivacyUrl=!1,this.hasTermsOfUseUrl=!1,this.isAccessiblePdfMode=!1,this.isEmbeddedViewer=!1,this.isBroadcastMode=!1,this.newEmbedModeIsEnabled=!1,this.printEnabled=!1,this.showEmbedCode=!1,this.userMayEnterAccessiblePdfMode=!1,this.zoomPopupDialogEnabled=!1}return e.prototype.getTrimmedIds=function(){var e={};if(e[ut.m.zoomFlyout]=this.isAccessiblePdfMode||this.isEmbeddedViewer&&!this.newEmbedModeIsEnabled||this.zoomPopupDialogEnabled,e[ut.m.buttonShowZoomDialog]=this.isAccessiblePdfMode||this.isEmbeddedViewer&&!this.newEmbedModeIsEnabled||!this.zoomPopupDialogEnabled,e[ut.m.pageInfoLabel]=this.isAccessiblePdfMode,e[ut.m.presenterPageLabel]=!this.isBroadcastMode,this.isEmbeddedViewer){e[ut.m.giveFeedbackButton]=!0;var t=this.getTrimmedIdsForMenuSectionOne(e),n=this.getTrimmedIdsForMenuSectionTwo(e),i=this.getTrimmedIdsForMenuSectionThree(e);e[ct.k.controlMenu]=t&&n&&i}else e[ut.m.giveFeedbackButton]=!this.feedbackEnabled,e[ct.k.wordIcon]=!0,e[ct.k.fullScreenButton]=!0,e[ct.k.controlMenu]=!0;return e},e.prototype.getTrimmedIdsForMenuSectionOne=function(e){var t=!0;return t=(e[ct.k.printButton]=!this.printEnabled)&&t,t=(e[ct.k.downloadACopyButton]=!this.downloadEnabled)&&t,t=(e[ct.k.accessibleModeButton]=!this.userMayEnterAccessiblePdfMode)&&t,e[ct.k.controlMenuSectionOne]=t,t},e.prototype.getTrimmedIdsForMenuSectionTwo=function(e){var t=!0;return t=(e[ct.k.documentInformationButton]=!this.showEmbedCode)&&t,e[ct.k.controlMenuSectionTwo]=t,t},e.prototype.getTrimmedIdsForMenuSectionThree=function(e){var t=!0;return t=(e[ct.k.privacyButton]=!this.hasPrivacyUrl)&&t,t=(e[ct.k.termsOfUseButton]=!this.hasTermsOfUseUrl)&&t,t=(e[ct.k.giveFeedbackButtonEmbed]=!this.feedbackEnabled)&&t,e[ct.k.controlMenuSectionThree]=t,t},e}();(0,r.l)(pt,"StatusBarIdTrimmer",null,[]);var dt=n(722),ht="WordViewerStatusBarData",gt="StatusBar",mt=function(){function e(e,t,n){this._zoomControlId=null,this._theStatusBar=null;var i=p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ZoomPopupDialogIsEnabled");this._zoomControlId=i?ut.m.buttonShowZoomDialog:ut.m.zoomFlyout;var r=new te.CuiHelper(W.s.wordViewerImageBase,WordViewerIntl.WordViewerStrings,null,null,null),o=(0,R.m)(new pt,{downloadEnabled:!p.AFrameworkApplication.get_trimDownloadACopy(),feedbackEnabled:p.AFrameworkApplication.showFeedbackButton&&!(p.AFrameworkApplication.mightNeedPrivacyDialog&&n.get_isSmallView()),hasPrivacyUrl:!!p.AFrameworkApplication.privacyUrl,hasTermsOfUseUrl:!!p.AFrameworkApplication.termsUrl,isAccessiblePdfMode:n.get_isAccessiblePdfMode(),isBroadcastMode:n.get_isBroadcastMode(),isEmbeddedViewer:n.get_isSmallView(),newEmbedModeIsEnabled:p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NewEmbedModeIsEnabled"),printEnabled:n.get_showPrint(),showEmbedCode:n.get_showEmbed(),userMayEnterAccessiblePdfMode:n.get_userMayEnterAccessiblePdfMode(),zoomPopupDialogEnabled:i}),a=(0,R.m)(new Oe,{clientID:gt,trimmedIds:o.getTrimmedIds()}),s=new tt(a,e,this,t);s.set_dataSource(new De(ht,r)),s.buildToolbar(),this._theStatusBar=s.get_toolbar(),this._theStatusBar.set_rootUser(this),this.setZoomVisibility(!1),this._theStatusBar.refresh()}return e.prototype.dispose=function(){this._theStatusBar&&(this._theStatusBar.dispose(),this._theStatusBar=null)},e.prototype.poll=function(){this._theStatusBar.pollForStateAndUpdate()},e.prototype.executeRootCommand=function(e,t,n,i,r){if(void 0===i&&(i=null),void 0===r&&(r=null),p.AFrameworkApplication.isShuttingDown)return!1;if(p.AFrameworkApplication.get_theTaskManager().get_isYielding())return!1;var o=parseInt(e),a=p.AFrameworkApplication.get_theActionManager();n&&(a.set_commandLocation(n.CommandLocation),a.set_invocationMethod(n.InvocationMethod));var s=t,l=o;switch(o){case C.Nc:s=parseInt(t.MenuItemId)}return 32===a.processActionWithData(l,2,s,r)},e.prototype.isRootCommandEnabled=function(e){if(p.AFrameworkApplication.isShuttingDown)return!1;if(p.AFrameworkApplication.get_theTaskManager().get_isYielding())return!1;var t=parseInt(e);if(!e||t===dt.ActionManager.emptyActionId)return!0;var n=t;return 32===p.AFrameworkApplication.get_theActionManager().processAction(n,1)},e.prototype.setControlVisibility=function(e,t){this._theStatusBar.setControlVisibility(e,t)},e.prototype.setZoomVisibility=function(e){this.setControlVisibility(this._zoomControlId,e)},e.prototype.pollControl=function(e){this._theStatusBar.pollForControlState(e)},e.prototype.pollZoomControl=function(){this.pollControl(this._zoomControlId)},e.prototype.onComponentBuilt=function(e,t){},e}();(0,r.l)(mt,"StatusBarUser",null,[P.t,F]);var _t=n(475),ft=n(552),yt=function(){function e(){if(n(941).App.get_activeAppFrame().get_businessBar()){var e=new ft.l(WordViewerIntl.WordViewerStrings.l_TranslatedDocumentBusinessBarTitle,n(941).App.get_activeAppFrame().get_wordViewerApp().get_userCanSaveAndEditTranslatedDocument()?WordViewerIntl.WordViewerStrings.l_TranslatedDocumentBusinessBarDescription:"",null);e.set_closeable(!0),e.set_image(3),n(941).App.get_activeAppFrame().get_businessBar().addEntry(e,!0)}}return e.prototype.navigateToOriginalDocument=function(e){_t.o.navigateToOriginalDocument()},e}();(0,r.l)(yt,"TranslatedDocumentBusinessBar",null,[]);var vt=n(220),St=n(322),Ct=n(77),bt=n(224),At=n(959),Tt=n(198),wt=n(309),It=n(916),Et=function(){function e(t,n,i,r){void 0===r&&(r=!1),this.theAppSettingsManager=null,this.officeTrialExperience=null,this.macOfficeOffer=null,this.isPasteOptionsEnable=!1,this._isFullAppSettingsReady=!1,this._actionManager=null,this._focusManager=null,this.theAppSettingsManager=t,this._isFullAppSettingsReady=this.theAppSettingsManager.get_isFullAppSettingsReady(),this.officeTrialExperience=O.w.get_instance().tryResolve(Tt.v),this.macOfficeOffer=O.w.get_instance().tryResolve(wt.u),e._callbackExecuted=!1,this.isPasteOptionsEnable=r,this._actionManager=n,this._focusManager=i}return e.prototype.get_actionManager=function(){return this._actionManager},e.prototype.get_focusManager=function(){return this._focusManager},e.prototype.areReady=function(){return this._isFullAppSettingsReady&&!!this.officeTrialExperience&&!!this.macOfficeOffer},e.prototype.waitForReady=function(e,t,n){var i=this;void 0===n&&(n=null),this.theAppSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){u.ULS.sendTraceTag(5878046,340,50,"Full app settings are ready"),i._isFullAppSettingsReady=!0,i.executeCallbackWhenReady(e,t)})),O.w.get_instance().resolveFuture(Tt.v).execute((function(n){u.ULS.sendTraceTag(5878049,340,50,"IOfficeTrialExperience object is ready"),i.officeTrialExperience=n,i.executeCallbackWhenReady(e,t)})),O.w.get_instance().resolveFuture(wt.u).execute((function(n){u.ULS.sendTraceTag(5878050,340,50,"IMacOfficeOffer object is ready"),i.macOfficeOffer=n,i.executeCallbackWhenReady(e,t)}))},e.prototype.executeCallbackWhenReady=function(t,n){e._callbackExecuted||(this.areReady()?(u.ULS.sendTraceTag(5878051,340,50,"ExecuteCallbackWhenReady: ready"),t(this,n),e._callbackExecuted=!0):u.ULS.sendTraceTag(5878080,340,100,"ExecuteCallbackWhenReady: not ready yet"))},e._callbackExecuted=!1,e}();(0,r.l)(Et,"RibbonDependencies",null,[It.b]);var kt=n(864),Dt=n(229),Mt=n(368),Pt=n(355),Ft=function(e,t){var n={};return n[Mt.a.previousSessionParamName]=p.AFrameworkApplication.userSessionId,n[p.AFrameworkApplication.modeSwitchTimeParamName]=t.toString(),e.sendMessage(Pt.a.editMode,n)?32:(u.ULS.sendTraceTag(5023452,204,10,"SendForEditModeAction failed"),8)},xt=n(422),Rt=n(574),Bt=n(78),Lt=n(246),Nt=n(882),Ut=n(478),Ot=n(162),Ht=n(573),Wt=(0,r.y)("ICalloutManager"),Vt=(0,r.y)("INotificationBar"),$t=n(400),Kt=n(550),zt=(0,r.y)("INotificationBarEntry"),qt=n(296),Qt=function(){function e(e,t){this._imagePath=null,this._imageAltText="",this._toolTip="",this._message="",this._isSticky=!1,this._displayTimeoutSeconds=5,this._image=0,this._imageElement=null,this._bodyElement=null,this._messageElement=null,this._isSticky=t,this._message=e,this.set_image(1)}return e.prototype.get_image=function(){return this._image},e.prototype.set_image=function(e){return this._image=e,5!==this._image&&this.set_imagePath(""),e},e.prototype.get_imagePath=function(){return this._imagePath},e.prototype.set_imagePath=function(e){return this._imagePath!==e&&(this._imagePath=e,this._imageElement&&(this._imageElement.src=this._imagePath)),e},e.prototype.get_imageAltText=function(){return this._imageAltText},e.prototype.set_imageAltText=function(e){return this._imageAltText!==e&&(this._imageAltText=e,this._imageElement&&(this._imageElement.alt=this._imageAltText)),e},e.prototype.get_toolTip=function(){return this._toolTip},e.prototype.set_toolTip=function(e){return this._toolTip!==e&&(this._toolTip=e,this._bodyElement&&(this._bodyElement.title=this._toolTip)),e},e.prototype.get_displayTimeoutSeconds=function(){return this._displayTimeoutSeconds},e.prototype.set_displayTimeoutSeconds=function(e){return this._displayTimeoutSeconds=e,this._displayTimeoutSeconds>0&&(this._isSticky=!1),e},e.prototype.get_isSticky=function(){return this._isSticky},e.prototype.get_message=function(){return this._message},e.prototype.set_message=function(e){return this._message!==e&&(this._message=e,this._message&&(this._messageElement.innerText=this._message)),e},e.prototype.get_htmlElement=function(){return this._bodyElement},e.prototype.get_isShowing=function(){return!!this.get_htmlElement()&&qt.s.isInDocument(this.get_htmlElement())},e.prototype.createElement=function(e){void 0===e&&(e=!0),this._bodyElement=document.createElement("span"),this._bodyElement.className="WACNotificationEntry",this._bodyElement.setAttribute("UNSELECTABLE","on"),this._bodyElement.title=this._toolTip;var t=document.createElement("div");if(t.setAttribute("UNSELECTABLE","on"),t.className="WACNotificationBottomBar",this._bodyElement.appendChild(t),this._image){var n=document.createElement("a");t.appendChild(n);var i=null,r=null;switch(this._image){case 2:i="CancelRequest_16x16x32",r=CommonUIStrings.l_DialogError;break;case 1:i="Risks_16x16x32",r=CommonUIStrings.l_DialogWarning;break;case 3:i="Info_16x16x32",r=CommonUIStrings.l_DialogInfo;break;case 5:i=this._imagePath,r=this._imageAltText}n.appendChild(we.createClusteredImage(16,16,i,"WACNotificationImage",!0,r))}return this._messageElement=document.createElement("span"),this._messageElement.className="WACNotificationMessage",this._messageElement.setAttribute("UNSELECTABLE","on"),e&&(this._messageElement.innerText=this._message),t.appendChild(this._messageElement),this._bodyElement},e.prototype.updateInnerText=function(e){this._messageElement&&e&&this._messageElement.innerText!==e&&(this._messageElement.innerText=e,this._message=e)},e.prototype.dispose=function(){this._imagePath=null,this._imageAltText=null,this._message=null,this._imageElement=null,this._messageElement=null,this._bodyElement=null},e}();(0,r.l)(Qt,"NotificationBarEntry",null,[zt,Sys.IDisposable]);var Gt=n(579),jt=n(134),Zt="WACNotificationBar",Xt=2500,Jt=function(){function e(e,t){this._visible=!1,this._element=null,this._target=null,this._retireNotificationTask=null,this._isRetireTaskRunning=!1,this._updateTargetTaskPending=!1,this._updateTopTask=null,this._resizeHandlerAttached=!1,this._contextMenuHandler=null,this._entriesToAdd=null,this._calloutManager=null,this._enteredCalloutManagerQueue=!1,this._target=t,this._element=document.createElement("div"),this._element.className=Zt,this._retireNotificationTask=new Ut.c(4,2,Xt,r.i(this,this.retireNotification,"retireNotification"),16),this._entriesToAdd=[],e.insertBefore(this._element,t)}return e.prototype.get_calloutManager=function(){return this._calloutManager||(this._calloutManager=O.w.get_instance().tryResolve(Wt))},e.prototype.get_htmlElement=function(){return this._element},e.prototype.get_isVisible=function(){return this._visible},e.prototype.set_isVisible=function(e){return this._visible===e?e:(e?this.attachToTarget():this.detachFromTarget(),this._visible=e,e)},e.prototype.addEntry=function(e){if(!this.get_calloutManager())return u.ULS.sendTraceTag(37552159,207,100,"The Notification Bar is displaying entries without using the Callout Manager."),void this.addEntryApproved(e);this._element.childNodes.length>0?this.addEntryApproved(e):(Array.add(this._entriesToAdd,e),this._enteredCalloutManagerQueue||(this._enteredCalloutManagerQueue=!0,u.ULS.sendTraceTag(37552160,207,50,"The Notification Bar enters the Callout Manager queue."),this.get_calloutManager().enterCalloutManagerQueue(this,r.i(this,this.onShowApproved,"onShowApproved"))))},e.prototype.onShowApproved=function(){for(var e=0;e<this._entriesToAdd.length;e++)this.addEntryApproved(this._entriesToAdd[e]);Array.clear(this._entriesToAdd)},e.prototype.createEntry=function(e,t){return new Qt(e,t)},e.prototype.addEntryApproved=function(e){var t=e.createElement(!1);t.setAttribute(jt.t.ariaRoleAttribute,jt.t.ariaAlertRole),this._element.appendChild(t),$t.u(t),this.set_isVisible(!0),e.get_isSticky()||(Gt.v(t,"expires",(new Date).getTime()+1e3*e.get_displayTimeoutSeconds()),this._isRetireTaskRunning||(p.AFrameworkApplication.get_theTaskManager().addTask(this._retireNotificationTask),this._isRetireTaskRunning=!0)),e.updateInnerText(e.get_message())},e.prototype.removeEntry=function(e){var t=e.get_htmlElement();qt.s.isInDocument(t)&&$t.v(t,null,r.i(this,this.afterRemoveEntry,"afterRemoveEntry"))},e.prototype.afterRemoveEntry=function(e){e.get_element()&&e.get_element().parentNode&&e.get_element().parentNode.removeChild(e.get_element()),this.onFinishedShowingEntries()},e.prototype.retireNotification=function(e){for(var t=this._element.childNodes,n=!0,i=[],r=(new Date).getTime(),o=0;o<t.length;++o){var a=t[o],s=Gt.j(a,"expires");s&&(r>s?Array.add(i,a):n=!1)}for(o=0;o<i.length;++o)this._element.removeChild(i[o]);n&&(p.AFrameworkApplication.get_theTaskManager().deleteTask(this._retireNotificationTask),this._isRetireTaskRunning=!1),this.onFinishedShowingEntries()},e.prototype.onFinishedShowingEntries=function(){this.get_calloutManager()&&this._enteredCalloutManagerQueue&&!this._element.childNodes.length&&(u.ULS.sendTraceTag(37552161,207,50,"The Notification Bar exits the Callout Manager queue."),this.get_calloutManager().exitCalloutManagerQueue(this),this._enteredCalloutManagerQueue=!1)},e.prototype.attachToTarget=function(){this._element.style.visibility="visible",Kt.n.addHandler(this._element,Rt.d.selectStart,Kt.n.cancelEventHandler),p.AFrameworkApplication.get_activeFrame().add_onResize(r.i(this,this.onResize,"onResize")),this._resizeHandlerAttached=!0,this._contextMenuHandler=r.i(this,this.contextMenuHandler,"contextMenuHandler"),p.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().registerHandler(this._element,this._contextMenuHandler,null),this.updateTop(null)},e.prototype.detachFromTarget=function(){this._element.style.visibility="hidden",Kt.n.removeHandler(this._element,Rt.d.selectStart,Kt.n.cancelEventHandler),this._resizeHandlerAttached&&(p.AFrameworkApplication.get_activeFrame().remove_onResize(r.i(this,this.onResize,"onResize")),this._resizeHandlerAttached=!1),this._contextMenuHandler&&(p.AFrameworkApplication.get_activeFrame().get_theContextMenuInputManager().unregisterHandler(this._element,this._contextMenuHandler),this._contextMenuHandler=null)},e.prototype.onResize=function(){this._updateTopTask||(this._updateTopTask=new Ut.c(4,1,500,r.i(this,this.updateTop,"updateTop"),17)),this._updateTargetTaskPending&&p.AFrameworkApplication.get_theTaskManager().deleteTask(this._updateTopTask),p.AFrameworkApplication.get_theTaskManager().addTask(this._updateTopTask),this._updateTargetTaskPending=!0},e.prototype.updateTop=function(e){this._element.style.top=(this._target?qt.s.parseCssSize(this._target.style.top):0)+2+"px",this._updateTargetTaskPending=!1},e.prototype.dispose=function(){this._visible&&this.detachFromTarget(),this._element=null,this._target=null},e.prototype.contextMenuHandler=function(e){return!0},e}();(0,r.l)(Jt,"NotificationBar",null,[Vt,Sys.IDisposable]);var Yt=n(978),en=n(55),tn=n(575),nn=n(26),rn=function(){return function(){this.icon=0,this.customIconName=null}}();(0,r.l)(rn,"ToastIconOptions",null,[]);var on=function(){return function(){this.message=null,this.icon=null}}();(0,r.l)(on,"ToastParameters",null,[]);var an=function(){function e(e,t,n,i){this.id=null,this.message=null,this.image=0,this.imagePath=null,this.displayTimeoutSeconds=5,this.registerEntry=null,this.unregisterEntry=null,this.isRegistered=!1,this.isShowing=!1,this.isSticky=!1,this.htmlElement=null,this.set_message(e),this.isSticky=t,this.registerEntry=n,this.unregisterEntry=i}return e.prototype.get_message=function(){return this.message},e.prototype.set_message=function(e){return this.updateInnerText(e),e},e.prototype.get_image=function(){return this.image},e.prototype.set_image=function(e){return this.image!==e&&(this.image=e,this.updateEntry()),e},e.prototype.get_imagePath=function(){return this.imagePath},e.prototype.set_imagePath=function(e){return this.imagePath!==e&&(this.imagePath=e,5===this.image&&this.updateEntry()),e},e.prototype.get_displayTimeoutSeconds=function(){return this.displayTimeoutSeconds},e.prototype.set_displayTimeoutSeconds=function(e){return this.isRegistered||(this.displayTimeoutSeconds=e,e<=0&&(this.isSticky=!0)),e},e.prototype.get_isShowing=function(){return this.isShowing},e.prototype.get_isSticky=function(){return this.isSticky},e.prototype.createElement=function(e){var t=this;if(void 0===e&&(e=!0),!this.isRegistered){var n=(0,R.m)(new nn.t,{onShow:function(){t.isShowing=!0}});this.get_isSticky()||(n.expirationOptions=(0,R.m)(new tn.t,{displayTimeoutSeconds:this.get_displayTimeoutSeconds(),onExpire:function(){t.isShowing=!1,t.dispose()}})),en.UISurfaces.getNotificationsAPIAsync().then((function(e){var i=e.toast((0,R.m)(new on,{message:t.message,icon:t.getIconOptions()}));return t.id=e.addNotification(i,n),t.registerEntry(t.id,t),t.isRegistered=!0,null}),(function(e){return u.ULS.sendTraceTag(51451665,383,15,"Attempt to add toast notification failed: {0}",e),null}))}return null},e.prototype.updateInnerText=function(e){e!==this.message&&(this.message=e,this.updateEntry())},e.prototype.get_htmlElement=function(){return this.htmlElement},e.prototype.dispose=function(){var e=this;this.isRegistered&&en.UISurfaces.getNotificationsAPIAsync().then((function(t){return e.id&&t.removeNotification(e.id),e.unregisterEntry(e.id),null}))},e.prototype.updateEntry=function(){var e=this;en.UISurfaces.getNotificationsAPIAsync().then((function(t){return t.updateNotification(e.id,t.toast((0,R.m)(new on,{message:e.message,icon:e.getIconOptions()}))),null}))},e.prototype.getIconOptions=function(){var e;switch(this.get_image()){case 3:e=1;break;case 5:e=5;break;case 2:e=3;break;case 1:e=2;break;case 0:default:return null}var t=(0,R.m)(new rn,{icon:e});if(5===e){if(!this.get_imagePath())return null;t.customIconName=this.get_imagePath()}return t},e}();(0,r.l)(an,"ReactNotificationBarEntry",null,[zt,Sys.IDisposable]);var sn=n(896),ln="WACNotificationBar",un=function(){function e(e,t){this.initializedNotificationsApi=null,this.entryById={};var n=document.createElement("div");n.className=ln,e.insertBefore(n,t),this.initializedNotificationsApi=new Yt.q(Promise,(function(){return en.UISurfaces.getNotificationsAPIAsync().then((function(e){return e.initializeToastNotifications(n),e}),(function(e){return u.ULS.sendTraceTag(51451664,383,15,"Notifications API not available. Cannot initialize toast notifications: {0}",e),null}))}))}return e.prototype.addEntry=function(e){this.initializedNotificationsApi.get_value().then((function(){e.createElement()}))},e.prototype.removeEntry=function(e){e.dispose()},e.prototype.get_isVisible=function(){return sn.s(this.entryById,(function(e,t){return t.get_isShowing()}))},e.prototype.createEntry=function(e,t){var n=this;return new an(e,t,(function(e,t){n.entryById[e]=t}),(function(e){delete n.entryById[e]}))},e.prototype.dispose=function(){},e}();(0,r.l)(un,"ReactNotificationBar",null,[Vt,Sys.IDisposable]);var cn=function(){function e(){}return e.createInstance=function(t,n,i){return void 0===i&&(i=!1),e._instance=i?new un(t,n):new Jt(t,n),e._instance},e._instance=null,e}();(0,r.l)(cn,"NotificationBarFactory",null,[]);var pn=n(990),dn=n(851),hn=n(154),gn=n(195),mn=n(879),_n=n(796),fn=n(58),yn=n(88),vn=function(){function e(){}return e.prototype.makeStopwatch=function(e,t){return new yn.q(e,t)},e.prototype.makeAndStartStopwatch=function(e,t){var n=this.makeStopwatch(e,t);return n.start(),n},e.prototype.bindStopwatchBuilderFactory=function(e){},e}();(0,r.l)(vn,"DefaultStopwatchBuilder",null,[fn.i]);var Sn=function(){function e(){this._factory=new vn}return e.prototype.makeStopwatch=function(e,t){return this._factory.makeStopwatch(e,t)},e.prototype.makeAndStartStopwatch=function(e,t){return this._factory.makeAndStartStopwatch(e,t)},e.prototype.bindStopwatchBuilderFactory=function(e){this._factory=e()},e}();(0,r.l)(Sn,"StopwatchBuilder",null,[fn.i]),n.d(t,{AppFrame:function(){return bn}});var Cn="WACRibbonPanel",bn=function(e){function t(i,o,s){var u=e.call(this,i,o)||this;u._isDisposed$4=!1,u._theRibbonUser=null,u._clientEditDocumentUrl=null,u._wordEditorUrl=null,u._hostViewUrl=null,u._hostEditUrl=null,u._editNeedsConversion=!1,u._isTranslatorRedirect=!1,u._ribbonPanel=null,u._theStatusBarUser=null,u._notificationBar=null,u._translatedDocumentBusinessBar=null,u._updateCommandUITask=null,u._disableFocus=!1,u._disableFocusOnBoot=!1,u._isSearchPaneVisible=!1,u._isCommentPaneVisible=!1,u._isSearchPaneTouchMode=!1,u._isCommentPaneTouchMode=!1,u._showCommentPaneOnBoot=!1,u._shouldLoadViewerWarningBusinessBar=!0,u._onEditCommand=0,u._wordViewerApp=null,u._workspace=null,u._postMessenger=null,u._theContextMenu=null,u.thePageInfoCache=null,u.webServiceBase=null;var d=(0,a.e)(n(941).App,i);if(u.set_wordViewerApp(d||n(941).App.get_instance()),!pn.q.get_isInitialized()){var g=document.createElement("div");n(941).App.InitializeHtmlScratchPadProvider(g),o.appendChild(g)}u.get_wordViewerApp().isScreenReaderPresent=u.get_highContrastDetector().get_isScreenReaderPresent(),document.body.setAttribute(jt.t.ariaRoleAttribute,jt.t.ariaApplicationRole),h.F6Manager.enabled=!0,u.get_wordViewerApp().get_isAccessiblePdfMode()||(u.get_theF6Manager().set_f6KeyInput(at.KeyInputManager.hashKey(ot.v.vK_F6,at.KeyInputManager.get_commandKeyModifier())),u.get_theF6Manager().set_f6ShiftKeyInput(at.KeyInputManager.hashKey(ot.v.vK_F6,4|at.KeyInputManager.get_commandKeyModifier()))),u.get_theF6Manager().bindFocusToBrowser(l.AFrame.appFocusId);var m=[l.AFrame.cookieConsentBannerFocusId,t.headerUiFocusId,Bt.r.meControlFlexPaneFocusId,t.ribbonFocusId,Ht.t.businessBarFocusID,lt.u.searchFocusID,l.AFrame.documentFocusID,l.AFrame.commentPaneFocusId,l.AFrame.flexPaneFocusId,Bt.r.chatFocusId,t.statusBarFocusId];u.get_theF6Manager().initializeOrder(m),gn.v.get_instance().ensureF6BindingIfNeeded(),p.AFrameworkApplication.appSettingsManager.get_isFullAppSettingsReady()&&u.updateFullSettings(s),u.set_wordEditorUrl(s.WordEditorUrl),u.webServiceBase=s.WebServiceBase;var _=!1,f=document.getElementById("FirstPageImage");if(f&&f.firstPageDisplayed&&(_=!0),u.get_wordViewerApp().get_isSmallView()?Sys.UI.DomElement.addCssClass(u.get_element(),"Embed"):p.AFrameworkApplication.get_isNoChrome()||(u._ribbonPanel=document.createElement("div"),u._ribbonPanel.id=t.ribbonPanelId,u._ribbonPanel.className=Cn,_&&(u._ribbonPanel.style.top=-u.get_upperRibbonHeight()+"px"),u.get_element().appendChild(u._ribbonPanel),u.tryInitializeToolbar(),u._isSearchPaneTouchMode=u.get_isStaticUiTouchMode(),u._isCommentPaneTouchMode=u.get_isStaticUiTouchMode()),l.AFrame.reflowCookieBannerIfNecessary(),u.get_theKeyInputManager().registerHandler(Rt.d.keyPress,document.body,r.i(u,u.showViewerWarningBusinessBar,"showViewerWarningBusinessBar")),u.get_theCompositionEventManager().registerHandler(Rt.d.compositionStart,document.body,r.i(u,u.showViewerWarningBusinessBar,"showViewerWarningBusinessBar"),null),!u.get_wordViewerApp().get_isCoreMode()){var v=u.get_statusBarPanel();_&&(v.style.height="0",Ie.y.setOpacity(v,0)),u._theStatusBarUser=new mt(v,u,n(941).App.get_instance()),Ae.x(t.statusBarFocusId,r.i(u,u.statusBarScopeSetFocus,"statusBarScopeSetFocus"),v,!1,!0,!u.get_wordViewerApp().get_isAccessiblePdfMode(),!u.get_wordViewerApp().get_isAccessiblePdfMode())}if(u.switchToMode(1),u.get_theActionManager().addActionWithFlags(C.D,k.d.application,r.i(u,u.onBinaryConvert,"onBinaryConvert"),96),u.get_theActionManager().addAction(C.AP,k.d.application,r.i(u,u.onOpenInWordViewer,"onOpenInWordViewer")),u.get_theActionManager().addActionWithFlags(c.Hx,k.d.application,dt.ActionManager.doNothingHandler,96),u.get_theActionManager().addAction(C.ev,k.d.application,r.i(u,u.onTranslateDocument,"onTranslateDocument")),u.get_theActionManager().addAction(C.SN,k.d.application,r.i(u,u.onTranslateBack,"onTranslateBack")),u.get_theActionManager().addAction(C.Xz,k.d.application,r.i(u,u.onDownloadATranslatedCopy,"onDownloadATranslatedCopy")),u.get_theActionManager().addAction(C.AH,k.d.application,r.i(u,u.onSaveAndEditATranslatedCopy,"onSaveAndEditATranslatedCopy")),u.get_theActionManager().addAction(C.Hk,y.a,r.i(u,u.hideAllPanes,"hideAllPanes")),u.get_theActionManager().addAction(C.dL,y.a,r.i(u,u.handleEscKeyDown,"handleEscKeyDown")),u.get_theActionManager().addAction(C.pP,k.d.application,r.i(u,u.onShowPdfConvertAndEditDialog,"onShowPdfConvertAndEditDialog")),st(u.get_theFocusManager()),Lt.Redirect.application=2,Lt.Redirect.registerActions(k.d.application),u._disableFocus=Boolean.parse(s.WordViewerFocusDisabled||"false"),u._disableFocusOnBoot=Boolean.parse(s.DisableFocusOnBoot||"false"),u._showCommentPaneOnBoot=Boolean.parse(s.ShowCommentsOnBoot||"false"),u.set_theErrorHandler(new Ct.k),u.get_theErrorHandler().register(u.get_thePageManager()),jt.t.registerHelpActionAndShortcut(k.d.application,o),_){var S=new Ut.c(2,1,100,(function(){vt.r.animateChromeInWordViewer(u.get_upperRibbonHeight(),l.AFrame.statusBarHeight)}));p.AFrameworkApplication.get_theTaskManager().addTask(S)}return kt.p.initSignOutResponseUI(u,r.i(u.get_applicationInstance(),u.get_applicationInstance().onAuthenticationLost,"onAuthenticationLost"),r.i(u.get_applicationInstance(),u.get_applicationInstance().onAuthenticationRestored,"onAuthenticationRestored"),u.get_canUseAppAfterAuthLost()),u}return(0,i.t)(t,e),t.prototype.get_workspace=function(){return this._workspace||(this._workspace=O.w.get_instance().resolve(bt.h))},t.prototype.set_workspace=function(e){return this._workspace=e,e},t.prototype.get_postMessenger=function(){return this._postMessenger||(this._postMessenger=O.w.get_instance().resolve(o.e))},t.prototype.get_modeName=function(){return this.get_wordViewerApp().get_isBroadcastMode()?"Attendee":"View"},t.prototype.get_state=function(){return this._frameState},t.prototype.set_state=function(e){this._frameState=e;var t={isDisabled:!!this._frameState};return p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this.get_postMessenger().sendMessageWithRetry(Pt.a.frameStateChangeEvent,t):this.get_postMessenger().sendMessage(Pt.a.frameStateChangeEvent,t),e},t.prototype.get_ribbonPanel=function(){return this._ribbonPanel},t.prototype.get_ribbonUser=function(){return this._theRibbonUser},t.prototype.get_statusBarUser=function(){return this._theStatusBarUser},t.prototype.get_contextMenuControl=function(){return this._theContextMenu},t.prototype.get_notificationBar=function(){return this._notificationBar?this._notificationBar:null},t.prototype.get_clientEditDocumentUrl=function(){return this._clientEditDocumentUrl},t.prototype.set_clientEditDocumentUrl=function(e){return this._clientEditDocumentUrl=Ie.y.get_supportsOpenInClientForAllApps()?e:null,e},t.prototype.get_wordEditorUrl=function(){return this._wordEditorUrl},t.prototype.set_wordEditorUrl=function(e){return this._wordEditorUrl=e,e},t.prototype.get_hostViewUrl=function(){return this._hostViewUrl},t.prototype.set_hostViewUrl=function(e){return this._hostViewUrl=e,e},t.prototype.get_hostEditUrl=function(){return this._hostEditUrl},t.prototype.set_hostEditUrl=function(e){return this._hostEditUrl=e,e},t.prototype.get_editNeedsConversion=function(){return this._editNeedsConversion},t.prototype.set_editNeedsConversion=function(e){return this._editNeedsConversion=e,e},t.prototype.get_hasStatusBar=function(){return!this.get_wordViewerApp().get_isCoreMode()},t.prototype.get_wordViewerApp=function(){return this._wordViewerApp},t.prototype.set_wordViewerApp=function(e){return this._wordViewerApp=e,e},t.prototype.get_ribbonFocusScopeName=function(){return"NoOpWordViewerAppFrame"},t.prototype.updateFullSettings=function(e){if(this.get_wordViewerApp().get_printingEnabled()){var t=document.createElement("a");t.innerText=WordViewerIntl.WordViewerStrings.l_AccessibilityLink,t.href="javascript:;",t.id=M.i.accessibilityLinkId,t.className=M.i.accessibilityLinkHiddenClass,this.get_element().insertBefore(t,this.get_element().firstChild)}this.set_clientEditDocumentUrl(e.EditDocInClientUrl),this.get_clientEditDocumentUrl()||(p.AFrameworkApplication.isOpenInClientEnabled=!1),this.set_hostViewUrl(e.HostViewUrl),this.set_hostEditUrl(e.HostEditUrl),this.set_editNeedsConversion("true"===e.ConvertToEdit),n(941).App.interactiveViewIsEnabled="true"===e.InteractiveViewIsEnabled},t.prototype.tryInitializeToolbar=function(){var e=new Et(p.AFrameworkApplication.appSettingsManager,this.get_theActionManager(),this.get_theFocusManager());if(e.areReady())this.initializeToolbarInternal(e,null);else{var t=te.CuiHelper.createEmptyHeaderAndToolbar(p.AFrameworkApplication.hideHeader);this._ribbonPanel.appendChild(t),this._ribbonPanel.style.height=Ce.k.calculateToolbarWithTopBarHeight(p.AFrameworkApplication.hideHeader,p.AFrameworkApplication.hasExternalHeader)+"px",e.waitForReady(r.i(this,this.initializeToolbarInternal,"initializeToolbarInternal"),t)}},t.prototype.initializeToolbarInternal=function(e,t){t&&te.CuiHelper.disposeEmptyHeaderAndToolbar(t),this._theRibbonUser=new rt(this,this._ribbonPanel,e,this),this._ribbonPanel.style.height=this._theRibbonUser.get_theViewerChrome().get_toolbarWithTopbarHeight()+"px"},t.prototype.updateCommandUI=function(e){var t=this;void 0===e&&(e=!1),this._updateCommandUITask||(this._updateCommandUITask=new Ut.c(2,1,25,(function(e){t.onUpdateCommandUI()}),45),p.AFrameworkApplication.get_theTaskManager().addTask(this._updateCommandUITask))},t.prototype.onUpdateCommandUI=function(){var e=xt.y.get_instance().startActivity(c.kG);this._updateCommandUITask=null,this.get_statusBarUser()&&this.get_statusBarUser().poll(),e.end()},t.prototype.showViewerWarningBusinessBar=function(e){if(void 0!==this.get_theFocusManager().get_currentScope()&&null!==this.get_theFocusManager().get_currentScope()&&void 0!==this.get_theFocusManager().get_currentScope().name&&null!==this.get_theFocusManager().get_currentScope().name&&l.AFrame.documentFocusID===this.get_theFocusManager().get_currentScope().name&&"input"!==e.get_sourceElement().tagName.toLowerCase()){if(!n(941).App.get_activeAppFrame().get_businessBar()||this.get_wordViewerApp().get_translationLanguage()||!this._shouldLoadViewerWarningBusinessBar||e.innerEvent.ctrlKey||e.innerEvent.rawEvent.metaKey||e.innerEvent.altKey||e.innerEvent.charCode===ot.v.vK_Enter)return!1;var t=this.get_wordViewerApp().get_supportsEditing()&&n(941).App.canEdit,i=void 0;i=t?this.get_wordViewerApp().get_isPdfMode()?WordViewerIntl.WordViewerStrings.L_ViewerWarningBusinessBarMessagePdf:WordViewerIntl.WordViewerStrings.L_ViewerWarningBusinessBarMessage:this.get_wordViewerApp().get_isPdfMode()?WordViewerIntl.WordViewerStrings.L_ViewerWarningDisabledEditBusinessBarMessagePdf:WordViewerIntl.WordViewerStrings.L_ViewerWarningDisabledEditBusinessBarMessage;var o=new ft.l(WordViewerIntl.WordViewerStrings.L_ViewerWarningBusinessBarTitle,i,null);t&&(this.get_wordViewerApp().get_isPdfMode()?o.addButton(WordViewerIntl.WordViewerStrings.L_ViewerWarningBusinessBarButtonPdf,r.i(this,this.navigateToEditor,"navigateToEditor"),""):o.addButton(WordViewerIntl.WordViewerStrings.L_ViewerWarningBusinessBarButton,r.i(this,this.navigateToEditor,"navigateToEditor"),"")),o.set_closeable(!0),o.set_image(3),n(941).App.get_activeAppFrame().get_businessBar().addEntry(o,!0);var a=g.FocusManager.instance().getRegion(Ht.t.businessBarFocusID);return a&&(a.contained=!this.get_wordViewerApp().get_isAccessiblePdfMode(),a.looped=!this.get_wordViewerApp().get_isAccessiblePdfMode()),this._shouldLoadViewerWarningBusinessBar=!1,!0}return!1},t.prototype.navigateToEditor=function(e){var t=null;if(this.setOnEditCommand(),this._onEditCommand===c.te){t={targetWacAction:"Edit"};var n=this.getTopParagraphId();n&&(t.wdparams="wd=pid("+n+")")}p.AFrameworkApplication.get_theActionManager().processActionWithData(this._onEditCommand,2,t)},t.prototype.restoreFocusAfterDismissingPopup=function(t,n){1!==n?this.setFocusOnDocument():e.prototype.restoreFocusAfterDismissingPopup.call(this,t,n)},t.prototype.setFocusOnDocument=function(){this.get_theFocusManager().setScope(l.AFrame.documentFocusID)},t.prototype.updateOpenMenu=function(e){return!!this.get_ribbonUser()&&!!this.get_ribbonUser().get_theToolbar()&&this.get_ribbonUser().get_theToolbar().updateOpenMenu(e)},t.prototype.get_iE9SoftBlockIsEnabled=function(){return p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IE9SoftBlockIsEnabled")},t.prototype.get_iE10SoftBlockIsEnabled=function(){return p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IE10SoftBlockIsEnabled")},t.prototype.get_shouldDisplayUnsupportedBrowserBusinessBar=function(){return this.get_iE10SoftBlockIsEnabled()?Ie.y.get_isInternetExplorerNonEdge()&&!Ie.y.get_isInternetExplorer11Up():!!this.get_iE9SoftBlockIsEnabled()&&(Ie.y.get_isInternetExplorerNonEdge()&&!Ie.y.get_isInternetExplorer10Up())},t.prototype.get_shouldViewIrmProtectedDocuments=function(){return p.AFrameworkApplication.get_isEmbedded()&&!p.AFrameworkApplication.get_isUIEmbedMode()},t.prototype.checkUnsupportedBrowserBusinessBarEntry=function(){if(this.get_businessBar()&&this.get_shouldDisplayUnsupportedBrowserBusinessBar()){var e=new ft.l("",CommonUIStrings.l_UnsupportedBrowser,null);e.set_id(15),e.set_closeable(!0),Lt.Redirect.isHelpAvailable()&&e.addButton(WordViewerIntl.WordViewerStrings.l_LearnMore,r.i(this,this.unsupportedBrowserHandler,"unsupportedBrowserHandler"),""),this.get_businessBar().addEntry(e,!1)}},t.prototype.unsupportedBrowserHandler=function(e){Lt.Redirect.showHelp("UnsupportedBrowser")},t.prototype.initializeAll=function(e){var t,i=this;if(this.get_shouldViewIrmProtectedDocuments()&&p.AFrameworkApplication.get_protectFile())return S.u.showErrorDialogEx(St.i.documentIsIRMProtected,CommonUIStrings.l_DefaultDialogTitle,WordViewerIntl.WordViewerStrings.l_DocumentProtectionSettingsEmbed),void S.u.propagateError(!0,"DocumentIsIRMProtected",St.i.documentIsIRMProtected,WordViewerIntl.WordViewerStrings.l_DocumentProtectionSettingsEmbed);if(this.get_workspace().init(e),this.get_wordViewerApp().get_isSmallView()||this.get_wordViewerApp().get_isAccessiblePdfMode()||p.AFrameworkApplication.get_isNoChrome()||(t=[new X.f(c.or,k.d.application,0),new X.f(C.RV,k.d.application,0)],J.z.enqueueActions(t,Y.n.create("dll1",null,(function(){return n.e(1).then(n.bind(null,878))}))),function(){var e=[new X.f(C.Ap,k.d.application,0),new X.f(C.Io,k.d.application,0)];J.z.enqueueActions(e,Y.n.create("dll1",null,(function(){return n.e(1).then(n.bind(null,878))})))}()),n(941).App.get_activeAppFrame().get_ribbonUser()&&n(941).App.get_activeAppFrame().get_ribbonUser().poll(),n(941).App.get_activeAppFrame().get_statusBarUser()&&n(941).App.get_activeAppFrame().get_statusBarUser().poll(),this._theContextMenu=new D.k(this),!this.get_wordViewerApp().get_isSmallView()&&!p.AFrameworkApplication.get_isNoChrome()){if(this.set_businessBar(new Dt.f(this.get_workspace().get_appBaseDom(),this.get_workspace().get_heightAboveAppBase())),e.insertBefore(this.get_businessBar().get_htmlElement(),this.get_workspace().get_appBaseDom()),!p.AFrameworkApplication.get_protectFile()||""===this.get_wordViewerApp().get_irmPolicyTitle()&&""===this.get_wordViewerApp().get_irmPolicyDescription()){if(!this.get_wordViewerApp().get_showPrint()&&""!==this.get_wordViewerApp().get_irmPolicyDescription()){var r=new ft.l("",this.get_wordViewerApp().get_irmPolicyDescription(),null);r.set_closeable(!0),this.get_businessBar().addEntry(r,!0)}}else{var o=new ft.l(this.get_wordViewerApp().get_irmPolicyTitle(),this.get_wordViewerApp().get_irmPolicyDescription(),null);o.set_closeable(!0),this.get_businessBar().addEntry(o,!0)}this.checkUnsupportedBrowserBusinessBarEntry()}this._notificationBar=cn.createInstance(e,this.get_workspace().get_appBaseDom()),this.get_wordViewerApp().get_translationLanguage()&&(this._translatedDocumentBusinessBar=new yt,p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WACTranslatorFloodgateCampaignEnabled")&&_t.o.triggerFloodgateSurveyForTranslator()),n(941).App.get_activeAppFrame().notifyResize();var a=g.FocusManager.instance().getScope(l.AFrame.documentFocusID);a.parent=l.AFrame.mainAppFocusId,this._disableFocus||a.addSetFocus((function(e,t){try{if(i.get_wordViewerApp().get_isAccessiblePdfMode()){var n=document.getElementById(i.get_workspace().get_theDisplayManager().get_outerElementID());n&&(document.body.blur(),window.self.blur(),n.focus())}else document.body.focus(),window.self.focus()}catch(e){u.ULS.shipAssertTag(4318919,321,!1)}})),n(941).App.get_activeAppFrame().get_theF6Manager().addF6(l.AFrame.documentFocusID),n(941).App.get_instance().get_isSmallView()||this._disableFocusOnBoot||g.FocusManager.instance().setScope(l.AFrame.documentFocusID),g.FocusManager.instance().set_defaultScopeName(l.AFrame.documentFocusID),g.FocusManager.instance().getScope(l.AFrame.appFocusId).bindAction(at.KeyInputManager.hashKey(ot.v.vK_Esc,0),C.dL),this.setOnEditCommand(),this._showCommentPaneOnBoot&&p.AFrameworkApplication.get_theActionManager().processAction(c.or,2)},t.prototype.setOnEditCommand=function(){p.AFrameworkApplication.copyAndEditUrl?this._onEditCommand=c.te:n(941).App.get_instance().get_supportsEditing()?n(941).App.get_activeAppFrame().get_editNeedsConversion()?this._onEditCommand=C.D:this._onEditCommand=C.no:n(941).App.interactiveViewIsEnabled?this._onEditCommand=C.no:this._onEditCommand=0},t.prototype.dispose=function(){this._isDisposed$4||(this._notificationBar&&(this._notificationBar.dispose(),this._notificationBar=null),this._theContextMenu&&(this._theContextMenu.dispose(),this._theContextMenu=null),this.get_workspace()&&(this.get_workspace().dispose(),this.set_workspace(null)),this._theRibbonUser&&(this._theRibbonUser.dispose(),this._theRibbonUser=null),this._theStatusBarUser&&(this._theStatusBarUser.dispose(),this._theStatusBarUser=null),this._translatedDocumentBusinessBar=null,this.get_theKeyInputManager().unregisterHandler(Rt.d.keyPress,document.body,r.i(this,this.showViewerWarningBusinessBar,"showViewerWarningBusinessBar")),this.get_theCompositionEventManager().unregisterHandler(Rt.d.compositionStart,document.body,r.i(this,this.showViewerWarningBusinessBar,"showViewerWarningBusinessBar")),e.prototype.dispose.call(this),this._isDisposed$4=!0)},t.prototype.statusBarScopeSetFocus=function(e,n){var i=this.get_theFocusManager().getRegion(t.statusBarFocusId);i&&i.moveIntoFromTop()},t.prototype.refreshDocument=function(e){if(p.AFrameworkApplication.appSettingsManager.get_isFullAppSettingsReady())if(32!==p.AFrameworkApplication.get_theActionManager().processActionWithData(c.HU,2,mn.y.refresh)){var t="";p.AFrameworkApplication.get_isEmbedded()?(t=p.AFrameworkApplication.hostEmbeddedViewUrl,this.get_wordViewerApp().get_showPrint()||(t=dn.n.addOrReplaceParameterValue(t,"wdPrint","0")),this.get_wordViewerApp().get_showEmbed()||(t=dn.n.addOrReplaceParameterValue(t,"wdEmbedCode","0"))):t=this.get_hostViewUrl(),this.get_wordViewerApp().get_userMayEnterAccessiblePdfMode()&&(t=n(941).App.updateUrlForAccessiblePdfMode(t,this.get_wordViewerApp().get_isAccessiblePdfMode()));var i=this.getTopParagraphId();i&&(t=dn.n.addOrReplaceParameterValue(t,"wdparaid",i)),this.get_isCommentPaneVisible()&&(t=dn.n.addOrReplaceParameterValue(t,"wdcomments","1")),p.AFrameworkApplication.get_isControllerServicesQueryParamNeeded()&&(t=dn.n.addOrReplaceParameterValue(t,p.AFrameworkApplication.controllerServicesParamName,"1")),window.open(t,"_parent")}else u.ULS.sendTraceTag(41972614,301,50,"WordViewer.AppFrame.RefreshDocument - sending refresh request to the host instead.");else u.ULS.sendTraceTag(5560476,301,15,"WordViewer.AppFrame.RefreshDocument tried to refresh page before full app settings ready.")},t.prototype.makeStopwatchBuilder=function(){return new Sn},t.prototype.get_isSearchPaneVisible=function(){return this._isSearchPaneVisible},t.prototype.get_isSearchPaneTouchMode=function(){return this._isSearchPaneTouchMode},t.prototype.showSearchPane=function(e){3===e?this._isSearchPaneTouchMode=!0:2===e&&(this._isSearchPaneTouchMode=!1),this._isSearchPaneVisible=!0,n(941).App.get_activeAppFrame().notifyResize()},t.prototype.hideSearchPane=function(){this._isSearchPaneVisible=!1,n(941).App.get_activeAppFrame().notifyResize()},t.prototype.get_isCommentPaneVisible=function(){return this._isCommentPaneVisible},t.prototype.get_isCommentPaneTouchMode=function(){return this._isCommentPaneTouchMode},t.prototype.showCommentPane=function(e){3===e?this._isCommentPaneTouchMode=!0:2===e&&(this._isCommentPaneTouchMode=!1),this._isCommentPaneVisible=!0,n(941).App.get_activeAppFrame().notifyResize()},t.prototype.hideCommentPane=function(){this._isCommentPaneVisible=!1,n(941).App.get_activeAppFrame().notifyResize()},t.prototype.hideAllPanes=function(e,t,n,i,r){return 1===n?32:(p.AFrameworkApplication.get_theActionManager().processAction(C.Sb,2),p.AFrameworkApplication.get_theActionManager().processActionWithData(c.pd,2,!0),g.FocusManager.instance().setScope(l.AFrame.documentFocusID),32)},t.prototype.propagateEscKeyEventToHost=function(){this.get_postMessenger().sendMessage(Pt.a.browserEvent,{type:"keydown",keyCode:ot.v.vK_Esc,altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1})},t.prototype.getTopParagraphId=function(){if(!this.get_wordViewerApp().theDocument.get_pageCount())return null;var e=this.get_wordViewerApp().get_zoomControl().get_currentZoom(),t=this.get_wordViewerApp().get_scrollControl().getScrollTop(),i=Z.t.get_instance().getPageFromScrollTop(t,e),r=Z.t.get_instance().getPageTopAtZoom(i,e),o=n(941).App.get_activeAppFrame().thePageInfoCache.getPage(i),a=(t-r)/e,s=Z.t.get_instance().getPageWidthAtZoom(i,1),l=Z.t.get_instance().getPageHeightAtZoom(i,1),u=At.d(0,s,a,l,i,o),c=u&&u.length>0?u[0]:null;c||(c=(u=At.d(0,s,0,a,i,o))&&u.length>0?u[u.length-1]:null);var p=null;if(c){var d=c.parentNode;d&&"P"===d.nodeName&&d.attributes.getNamedItem("id")&&(p=d.attributes.getNamedItem("id").nodeValue)}return p},t.prototype.onBinaryConvert=function(e,t,n,i,r){if(t.get_contextId()!==k.d.application)return 2;if(!this.get_editNeedsConversion())return 8;if(1===n)return 32;var o=(new Date).getTime();return _n.m.get_instance().recordEditClickedInWebApp(o),p.AFrameworkApplication.useEditModePostMessage?Ft(p.AFrameworkApplication.hostPostmessenger,o):(E.launch(),32)},t.prototype.onOpenInWordViewer=function(e,t,i,r,o){if(t.get_contextId()!==k.d.application)return 2;if(!this._hostViewUrl)return 8;if(2===i){var a=this._hostViewUrl;this.get_wordViewerApp().get_userMayEnterAccessiblePdfMode()&&(a=n(941).App.updateUrlForAccessiblePdfMode(a,this.get_wordViewerApp().get_isAccessiblePdfMode())),window.open(a)}return 32},t.prototype.onTranslateDocument=function(e,t,n,i,r){return t.get_contextId()!==k.d.application?2:1===n?32:(_t.o.launchDialog(),32)},t.prototype.onTranslateBack=function(e,t,n,i,r){return this._isTranslatorRedirect=!0,1===n?32:this.get_wordViewerApp().get_translationFromEditor()?this.switchIntoEditMode(n,null,!1):(_t.o.navigateToOriginalDocument(),32)},t.prototype.switchIntoEditMode=function(e,t,i){if(t&&!this.get_wordEditorUrl()&&!p.AFrameworkApplication.useEditModePostMessage)return 8;if(t&&!n(941).App.get_instance().get_supportsEditing())return 8;if(1===e)return 32;if(2!==e)return u.ULS.sendTraceTag(41170244,301,15,"Unexpected ActionBehavior {0} for switching to edit mode",e),2;var r=(new Date).getTime();if(_n.m.get_instance().recordEditClickedInWebApp(r),t&&p.AFrameworkApplication.useEditModePostMessage)return Ft(t,r);if(p.AFrameworkApplication.get_isEmbedded()){var o=this.get_hostEditUrl();this._isTranslatorRedirect&&dn.n.addOrReplaceParameterValue(o,"translatorRedirect","1"),p.AFrameworkApplication.get_isControllerServicesQueryParamNeeded()&&dn.n.addOrReplaceParameterValue(o,p.AFrameworkApplication.controllerServicesParamName,"1"),window.open(o)}else try{var a,l;this.generateEditUrlAndTarget(r,i,(0,s.m)((function(){return a}),(function(e){return a=e})),(0,s.m)((function(){return l}),(function(e){return l=e}))),p.AFrameworkApplication.get_wasAuthenticationLostDuringSession()?window.open(a,hn.g.windowTargetToString(l)):hn.g.openWindow(l,a,void 0,void 0,Nt.u.renavigate_AppModeSwitch),p.AFrameworkApplication.isShuttingDown=!0}catch(e){}return 32},t.prototype.generateEditUrlAndTarget=function(e,t,i,r){p.AFrameworkApplication.get_wasAuthenticationLostDuringSession()||t?(i.val=this.get_hostEditUrl(),r.val=3):(i.val=this.get_wordEditorUrl(),r.val=1);var o=this.getTopParagraphId();o&&(i.val=dn.n.addOrReplaceParameterValue(i.val,"wdPid",o)),i.val=dn.n.addOrReplaceParameterValue(i.val,p.AFrameworkApplication.modeSwitchTimeParamName,e.toString()),i.val=dn.n.addOrReplaceParameterValue(i.val,p.AFrameworkApplication.previousSessionParamName,p.AFrameworkApplication.userSessionId),i.val=dn.n.addOrReplaceParameterValue(i.val,Ot.o.userSessionDataParam,Ot.o.userSessionData);var a=p.AFrameworkApplication.appSettingsManager.getStringAppSetting(p.AFrameworkApplication.uiHostSettingName);a&&(i.val=dn.n.addOrReplaceParameterValue(i.val,p.AFrameworkApplication.uiHostParamName,a)),!n(941).App.canEdit&&n(941).App.interactiveViewIsEnabled&&(i.val=dn.n.addOrReplaceParameterValue(i.val,"readOnly","1"),i.val=dn.n.addOrReplaceParameterValue(i.val,"wdDoNotAutoNavigateToReadingView","1")),this._isTranslatorRedirect&&(i.val=dn.n.addOrReplaceParameterValue(i.val,"translatorRedirect","1")),p.AFrameworkApplication.get_isControllerServicesQueryParamNeeded()&&(i.val=dn.n.addOrReplaceParameterValue(i.val,p.AFrameworkApplication.controllerServicesParamName,"1"))},t.prototype.onDownloadATranslatedCopy=function(e,t,n,i,r){return t.get_contextId()!==k.d.application?2:1===n?32:(_t.o.downloadATranslatedCopy(),32)},t.prototype.onSaveAndEditATranslatedCopy=function(e,t,n,i,r){return t.get_contextId()!==k.d.application?2:1===n?32:(_t.o.saveAndEditDialog(),32)},t.prototype.onShowPdfConvertAndEditDialog=function(e,t,n,i,r){return t.get_contextId()!==k.d.application?2:this.get_editNeedsConversion()?1===n&&this.get_wordViewerApp().get_isProtectedPdf()?8:1===n?32:(p.AFrameworkApplication.get_theActionManager().processAction(C.D,2),32):8},t.prototype.handleEscKeyDown=function(e,t,n,i,r){return 1===n?32:(this.get_isSearchPaneVisible()||this.get_isCommentPaneVisible()?p.AFrameworkApplication.get_theActionManager().processAction(C.Hk,2):this.propagateEscKeyEventToHost(),32)},t.ribbonPanelId="WACRibbonPanel",t.ribbonFocusId="ribbon",t.statusBarFocusId="statusbar",t.headerUiFocusId="headerui",t}(v);(0,r.l)(bn,"AppFrame",v,[])},function(e,t,n){"use strict";n.d(t,{m:function(){return a}});var i=n(508),r=n(268),o=n(208),a=function(e){function t(t,n,i,r){return e.call(this,t,n,i,r)||this}return(0,i.t)(t,e),t.prototype.focusNext=function(e){return this.get_control().focusNext(e)},t}(r.r);(0,o.l)(a,"MenuItem",r.r,[])},,function(e,t,n){"use strict";n.d(t,{z:function(){return i}});var i=function(){function e(t,n){this.$$pf_Key=e.TKey===Number||Type.isEnum(e.TKey)?0:e.TKey!==Boolean&&null,this.$$pf_Value=e.TValue===Number||Type.isEnum(e.TValue)?0:e.TValue!==Boolean&&null,this.set_value(n),this.set_key(t)}return e.prototype.get_key=function(){return this.$$pf_Key},e.prototype.set_key=function(e){return this.$$pf_Key=e,e},e.prototype.get_value=function(){return this.$$pf_Value},e.prototype.set_value=function(e){return this.$$pf_Value=e,e},e}()},,,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("IBrowserFeatureManager"),o=n(255),a=(0,i.y)("IBrowserFeature"),s=function(){function e(e,t,n){this._name=null,this._test=null,this._shouldRedirect=!1,this._name=e.toLowerCase(),this._test=t,this._shouldRedirect=n}return e.prototype.get_name=function(){return this._name},e.prototype.get_test=function(){return this._test},e.prototype.get_shouldRedirect=function(){return this._shouldRedirect},e.prototype.isSupported=function(){return this._test()},e}();(0,i.l)(s,"BrowserFeature",null,[a]);var l=n(873),u=n(841);n.d(t,{n:function(){return c}});var c=function(){function e(){this._browserFeatures=null,this._areBrowserFeaturesSupported=!0,this._title="Microsoft Office",this._message="The browser you're using isn't supported, so some features may not work as expected. For best results, switch to a supported browser.",this._dialogOk="OK",this._linkText="Learn More",this._dialog=null,this._browserFeatures=[],Array.add(this._browserFeatures,new s("window.Map",(function(){var e=!0;try{e=void 0!==window.Map;new Map}catch(t){e=!1}return e}),!0)),Array.add(this._browserFeatures,new s("window.Set",(function(){var e=!0;try{e=void 0!==window.Set;new Set}catch(t){e=!1}return e}),!0)),Array.add(this._browserFeatures,new s("window.requestanimationframe",(function(){var e=!0;try{e=void 0!==window.requestAnimationFrame}catch(t){e=!1}return e}),!0)),Array.add(this._browserFeatures,new s("window.Promise",(function(){var e=!0;try{e=void 0!==window.Promise}catch(t){e=!1}return e}),!1)),Array.add(this._browserFeatures,new s("window.performance",(function(){var e=!0;try{e=void 0!==window.performance}catch(t){e=!1}return e}),!1))}return e.prototype.get_areBrowserFeaturesSupported=function(){return this._areBrowserFeaturesSupported},e.prototype.runFeatureChecks=function(e){try{if(e&&e.getBooleanAppSetting("BrowserFeatureDetectionIsEnabled")){for(var t=!1,n=0;n<this._browserFeatures.length;n++)this._browserFeatures[n].isSupported()||(t=this._browserFeatures[n].get_shouldRedirect()||t,o.ULS.sendTraceTag(39321882,306,15,"{0} is not supported. Show warning dialog: {1}",this._browserFeatures[n].get_name(),this._browserFeatures[n].get_shouldRedirect()));if(this._areBrowserFeaturesSupported=!t,t&&e.getBooleanAppSetting("BrowserFeatureDetectionWarningIsEnabled")){var i=e.getStringAppSetting("BrowserFeatureDetectionRedirectURL")||"";""!==i&&this.showDialog(i)}}}catch(e){o.ULS.sendTraceTag(39321883,306,15,"RunFeatureChecks caught exception: {0}",e)}},e.prototype.showDialog=function(e){this._dialog=new u.StandardDialog;try{this._title=CommonUIStrings.l_DefaultDialogTitle,this._message=CommonUIStrings.l_UnsupportedBrowser,this._dialogOk=CommonUIStrings.l_DialogOk,this._linkText=CommonUIStrings.l_LearnMore}catch(e){o.ULS.sendTraceTag(39321884,306,15,"Failed to get CommonUIStrings. Exception: {0}",e)}this._dialog.set_buttonsOption(6),this._dialog.setButtonText(0,this._dialogOk),this._dialog.addExtraLink(this._linkText,e),this._dialog.showError(l.p.unsupportedBrowserWarning,this._title,this._message,i.i(this,this.dialogHandler,"dialogHandler"),!1,!0),o.ULS.sendTraceTag(39683483,306,15,"Show dialog and report UnsupportedBrowserWarning error")},e.prototype.dialogHandler=function(e,t){e||this._dialog.dispose()},e.get_instance=function(){return e._instance||(e._instance=new e),e._instance},e._instance=null,e}();(0,i.l)(c,"BrowserFeatureManager",null,[r])},function(e,t,n){"use strict";n.r(t),n.d(t,{DownloadATranslatedCopyRequest:function(){return d}});var i=n(508),r=n(884),o=n(941),a=n(475),s=n(322),l=n(917),u=n(254),c=n(556),p=n(208),d=function(e){function t(){var n=e.call(this)||this;n._downloadUri=null;for(var i=a.o.translationLanguages.getLanguages(),r="",s=0;s<i.length;s++)if(i[s].name===o.App.get_instance().get_translationLanguage()){r=i[s].displayName;break}return n._downloadUri=o.App.webServiceBase+"docdatahandler.ashx?"+o.App.get_instance().theDocument.get_baseDocQuerySignature()+"&language="+c.l.urlKeyValueEncode(o.App.get_instance().get_translationLanguage())+"&languagename="+c.l.urlKeyValueEncode(r)+"&type=docx&o15=1",u.AFrameworkApplication.theWsaClient.incrementDw(t.dataiD_WORDWEBAPPTRANSLATIONDOWNLOADCLICKS,1),n}return(0,i.t)(t,e),t.prototype.onSuccess=function(e){window.self.location.href=this._downloadUri},t.prototype.propagateError=function(e){l.u.propagateError(!1,"TranslationFailed",s.i.itemNotGenerated,e)},t.prototype.get_requestUri=function(){return this._downloadUri},t.prototype.get_waitMessage=function(){return WordViewerIntl.WordViewerStrings.l_PrepareTranslationDownload},t.prototype.get_dismissWaitUIOnSuccess=function(){return!0},t.prototype.getErrorMessage=function(e){return WordViewerIntl.WordViewerStrings.l_DownloadTranslatedDocumentError},t.prototype.isDocumentIssue=function(e){return!1},t.dataiD_WORDWEBAPPTRANSLATIONDOWNLOADCLICKS=9988,t}(r.j);(0,p.l)(d,"DownloadATranslatedCopyRequest",r.j,[])},function(e,t,n){var i=n(394),r=n(891),o=n(789),a=n(287);e.exports=i("Reflect","ownKeys")||function(e){var t=r.f(a(e)),n=o.f;return n?t.concat(n(e)):t}},function(e,t,n){var i=n(287);e.exports=function(e,t,n,r){try{return r?t(i(n)[0],n[1]):t(n)}catch(t){var o=e.return;throw void 0!==o&&i(o.call(e)),t}}},,function(e,t,n){"use strict";var i=n(600),r=n(547),o=n(704),a=n(520),s=n(773),l=n(154),u=n(296),c=function(e,t){for(var n=0;t()&&n<e.length;)e[n](),n++},p=function(e,t,n,i){if(e&&e.parentNode&&e.parentNode.parentNode){var r=C(e);if("auto"!==e.parentNode.style.width){var o=e.parentNode.offsetWidth-r;e.style.width=o+"px"}var a=i?n:t,s=i?t:n,u=l.g.getElementBounds(e.parentNode.parentNode),c=a?l.g.getElementBounds(a):new Sys.UI.Bounds(u.x,0,0,0),p=s?l.g.getElementLocation(s):new Sys.UI.Point(u.x+u.width,0),d=0;if("absolute"===e.parentNode.style.position)d=p.x-(c.x+c.width)-r-1;else{var h=l.g.getElementBounds(e.nextSibling?e.parentNode:e),g=h.x+h.width/2;d=2*Math.min(g-(c.x+c.width),p.x-g)-r-1}e.style.maxWidth=d+"px"}},d=function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];h(i)}},h=function(e){e&&m(e)&&(e.style.display="",e._isHidden="0")},g=function(e){e&&!m(e)&&(e.style.display="none",e._isHidden="1")},m=function(e){if(!e)return!0;var t=e._isHidden;return!(null==t||"0"===t)},_=function(e,t,n){if(e&&!m(e)){for(var i=s.o.getCurrentStyle(e),r=u.s.parseCssSize(i.paddingLeft)+u.s.parseCssSize(i.paddingRight),o=e.offsetWidth-n-r,a=t,l=0;a&&a!==e;)(i=s.o.getCurrentStyle(a))&&(l+=u.s.parseCssSize(i.paddingLeft)+u.s.parseCssSize(i.paddingRight)),a=a.parentNode;o=Math.max(o,75+l),e.style.width=o+"px"}},f=function(e){e&&(e.style.width="auto",e.style.maxWidth="none")},y=function(e,t){e&&(e.style.position="absolute",e.style.left=t+"px")},v=function(e,t,n){return!(!e||!t)&&(!m(e)&&!m(t)&&l.g.leftBoundsOverlapsRightBounds(l.g.getElementBounds(e),l.g.getElementBounds(t),n))},S=function(e,t,n){var i=0;return e&&t&&(i=l.g.leftBoundsOverlapsRightBoundsByAmount(l.g.getElementBounds(e),l.g.getElementBounds(t),n)),i},C=function(e){for(var t=s.o.getCurrentStyle(e),n=t?u.s.parseCssSize(t.paddingLeft)+u.s.parseCssSize(t.paddingRight):0,i=s.o.getCurrentStyle(e.parentNode),r=i?u.s.parseCssSize(i.paddingLeft)+u.s.parseCssSize(i.paddingRight):0,o=0,a=e;a.nextSibling;)o+=(a=a.nextSibling).offsetWidth;return n+r+o},b=function(e){return!!e.id&&(e.id.startsWith(r.CuiHelper.shareButtonId)||e.id.startsWith(o.s)||e.id.startsWith(r.CuiHelper.replyWithChangesButtonId)||e.id.startsWith(a.b.workflowButtonId))},A=n(928),T=n(208);n.d(t,{b:function(){return w}});var w=function(){function e(e,t,n){this._isRtl=!1,this._elmTopBar1=null,this.elmTopBar1Left=null,this.elmBreadcrumbSeparator=null,this.elmHostBrand=null,this.elmFolderSeparator=null,this.elmFolder=null,this.elmTopBar1Center=null,this.elmTitle=null,this.elmTopBar1Right=null,this.elmTopRightActionButton=null,this.elmSkypeButton=null,this.elmUserNameNameContainer=null,this.elmUserNameNameItem=null,this._elmTopBar2=null,this.elmFileButton=null,this.elmTabHeaders=null,this.elmTopBar2Center=null,this.elmOICSeparator=null,this.elmOpenInClientButton=null,this.elmFeedbackButton=null,this.elmTopBar2Right=null,this.elmPeopleWellControl=null,this._elmTopBar1=e,this._elmTopBar2=t,this._isRtl=n}return e.prototype.findAndScaleDefaultRibbonTopBars=function(){var e;A.f((0,i.m)((function(){return e}),(function(t){return e=t})));var t=$get(r.CuiHelper.headerTopBarsId);e?(this._elmTopBar1=document.getElementById(r.CuiHelper.externalHeaderFullTopBarsId),this._elmTopBar2=t):(this._elmTopBar1=t.childNodes[0],this._elmTopBar2=t.childNodes[1]),this.scaleHeader()},e.prototype.scaleNonCuiHeader=function(e){this._elmTopBar1=e,this._elmTopBar2=null,this.findTopBar1Elements(this._elmTopBar1),this.undoScaleTopBar1(),this.scaleTopBar1()},e.prototype.scaleHeader=function(){this._elmTopBar1&&this._elmTopBar2&&this._elmTopBar2.clientHeight&&(this.findTopBar1Elements(this._elmTopBar1),this.undoScaleTopBar1(),this.scaleTopBar1(),-1!==this._elmTopBar2.parentNode.parentNode.className.indexOf("cui-ribbon")&&(this.findTopBar2Elements(this._elmTopBar2),this.undoScaleTopBar2(),this.scaleTopBar2()))},e.prototype.findTopBar1Elements=function(e){if(e)for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t],i=u.s.getDOMElementClassName(n),o=!!n.id;-1!==i.indexOf("cui-QATRowLeft")?this.elmTopBar1Left=n:-1!==i.indexOf("OfficeOnlineBrandBreadcrumbSeparator")?this.elmBreadcrumbSeparator=n:n.id===r.CuiHelper.breadcrumbBrandId?this.elmHostBrand=n:n.id===r.CuiHelper.folderSeparatorId?this.elmFolderSeparator=n:n.id===r.CuiHelper.breadcrumbFolderId?this.elmFolder=n:-1!==i.indexOf("cui-QATRowCenter")?this.elmTopBar1Center=n:n.id===r.CuiHelper.breadcrumbTitleId?this.elmTitle=n:-1!==i.indexOf("cui-QATRowRight")?this.elmTopBar1Right=n:o&&b(n)?this.elmTopRightActionButton=n:o&&n.id.startsWith(r.CuiHelper.skypeButtonPrefixId)?this.elmSkypeButton=n:-1!==i.indexOf("UsernameNameContainer")?this.elmUserNameNameContainer=n:-1!==i.indexOf("UsernameNameItem")&&(this.elmUserNameNameItem=n),this.findTopBar1Elements(n)}},e.prototype.undoScaleTopBar1=function(){var e,t=[this.elmBreadcrumbSeparator,this.elmHostBrand,this.elmFolderSeparator,this.elmFolder,this.elmTopBar1Center,this.elmTitle,this.elmTopBar1Right,this.elmTopRightActionButton,this.elmSkypeButton,this.elmUserNameNameContainer],n=[this.elmTopBar1Center,this.elmTitle,this.elmUserNameNameContainer];d(t),function(e){for(var t=0,n=e;t<n.length;t++){var i=n[t];f(i)}}(n),(e=this.elmTopBar1Center)&&(e.style.position="static",e.style.left="auto")},e.prototype.scaleTopBar1=function(){var e,t;this.contextualTabsVisible()?this.scaleTopBar1WithContextual():this.scaleTopBar1WithoutContextual(),e=this.elmFolderSeparator,t=this.elmFolder,e&&t&&(e.style.marginTop=(t.offsetHeight-e.offsetHeight)/2+"px")},e.prototype.scaleTopBar1WithContextual=function(){var e=this,t=this.getFirstContextualTabSet();c([function(){_(e.elmFolder,e.elmFolder,S(e.elmTopBar1Left,t,e._isRtl))},function(){g(e.elmBreadcrumbSeparator),g(e.elmHostBrand),g(e.elmFolderSeparator),g(e.elmFolder)}],(function(){return v(e.elmFolder,t,e._isRtl)})),v(this.elmTabHeaders,this.elmTopBar1Center,this._isRtl)&&function(e,t,n){if(e&&t){var r=0,o=0;l.g.getElementAbsolutePosition(t,(0,i.m)((function(){return r}),(function(e){return r=e})),(0,i.m)((function(){return o}),(function(e){return o=e})));var a=n?r-e.offsetWidth:r+t.offsetWidth;y(e,a)}}(this.elmTopBar1Center,this.elmTabHeaders,this._isRtl),this.resolveTopBar1CenterAndRightOverlap(),this.resolveTopBar1LeftAndRightOverlap(),m(this.elmTopBar1Center)||m(this.elmTitle)||p(this.elmTitle,this.elmTabHeaders,this.elmTopBar1Right,this._isRtl)},e.prototype.scaleTopBar1WithoutContextual=function(){var e=this,t=!!this.elmFolder,n=!!this.elmTitle,i=0;if((t||n)&&(i=S(this.elmTopBar1Left,this.elmTopBar1Center,this._isRtl))>0){var r=t;n&&(!t||this.elmTitle.offsetWidth>this.elmFolder.offsetWidth)&&(r=!1),_(r?this.elmFolder:this.elmTitle,r?this.elmFolder:this.elmTitle,r?i:2*i),t&&n&&(i=S(this.elmTopBar1Left,this.elmTopBar1Center,this._isRtl))>0&&_((r=!r)?this.elmFolder:this.elmTitle,r?this.elmFolder:this.elmTitle,r?i:2*i)}c([function(){g(e.elmBreadcrumbSeparator),g(e.elmHostBrand),g(e.elmFolderSeparator),g(e.elmFolder),f(e.elmTitle)},function(){_(e.elmTitle,e.elmTitle,2*S(e.elmTopBar1Left,e.elmTopBar1Center,e._isRtl))},function(){g(e.elmTitle)}],(function(){return v(e.elmTopBar1Left,e.elmTopBar1Center,e._isRtl)})),this.resolveTopBar1CenterAndRightOverlap(),this.resolveTopBar1LeftAndRightOverlap(),m(this.elmTopBar1Center)||m(this.elmTitle)||p(this.elmTitle,this.elmTopBar1Left,this.elmTopBar1Right,this._isRtl)},e.prototype.resolveTopBar1CenterAndRightOverlap=function(){var e=this,t=m(this.elmTitle);c([function(){e.resolveTopBar1TitleandRightOverlap()},function(){g(e.elmTopRightActionButton),f(e.elmTitle),f(e.elmUserNameNameContainer),t||h(e.elmTitle)},function(){e.resolveTopBar1TitleandRightOverlap()},function(){g(e.elmSkypeButton),f(e.elmTitle),f(e.elmUserNameNameContainer),t||h(e.elmTitle)},function(){e.resolveTopBar1TitleandRightOverlap()}],(function(){return v(e.elmTopBar1Center,e.elmTopBar1Right,e._isRtl)}))},e.prototype.resolveTopBar1TitleandRightOverlap=function(){var e=!!this.elmTitle,t=!!this.elmUserNameNameContainer,n=0;if((e||t)&&(n=S(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl))>0){var i=!!this.elmTopBar1Center&&"absolute"!==this.elmTopBar1Center.style.position,r=e;t&&(!e||this.elmUserNameNameContainer.offsetWidth>this.elmTitle.offsetWidth)&&(r=!1),_(r?this.elmTitle:this.elmUserNameNameContainer,r?this.elmTitle:this.elmUserNameNameItem,r&&i?2*n:n),e&&t?((n=S(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl))>0&&_((r=!r)?this.elmTitle:this.elmUserNameNameContainer,r?this.elmTitle:this.elmUserNameNameItem,r&&i?2*n:n),v(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl)&&(g(this.elmTopBar1Center),f(this.elmUserNameNameContainer))):e&&v(this.elmTopBar1Center,this.elmTopBar1Right,this._isRtl)&&g(this.elmTitle)}},e.prototype.resolveTopBar1LeftAndRightOverlap=function(){var e=this,t=function(){_(e.elmUserNameNameContainer,e.elmUserNameNameItem,S(e.elmTopBar1Left,e.elmTopBar1Right,e._isRtl))};c([t,function(){g(e.elmTopRightActionButton),f(e.elmUserNameNameContainer)},t,function(){g(e.elmSkypeButton),f(e.elmUserNameNameContainer)},t,function(){g(e.elmUserNameNameContainer)}],(function(){return v(e.elmTopBar1Left,e.elmTopBar1Right,e._isRtl)}))},e.prototype.contextualTabsVisible=function(){if(!this.elmTabHeaders)return!1;for(var e=0;e<this.elmTabHeaders.childNodes.length;e++){var t=this.elmTabHeaders.childNodes[e];if(-1!==u.s.getDOMElementClassName(t).indexOf("cui-cg"))return!0}return!1},e.prototype.getFirstContextualTabSet=function(){if(!this.elmTabHeaders)return null;for(var e=null,t=this.elmTabHeaders.childNodes.length-1;t>=0;t--){var n=this.elmTabHeaders.childNodes[t];if(-1===u.s.getDOMElementClassName(n).indexOf("cui-cg"))break;e=n}return e},e.prototype.findTopBar2Elements=function(e){if(e)for(var t=0;t<e.childNodes.length;t++){var n=e.childNodes[t],i=u.s.getDOMElementClassName(n),o=!!n.id;-1!==i.indexOf("cui-jewel-container")?this.elmFileButton=n:-1!==i.indexOf("cui-tts")?this.elmTabHeaders=n:-1!==i.indexOf("cui-TabRowInline")?this.elmTopBar2Center=n:-1!==i.indexOf("cui-separator")?this.elmOICSeparator=n:o&&n.id.startsWith(r.CuiHelper.openInClientButtonId)?this.elmOpenInClientButton=n:o&&n.id.startsWith(r.CuiHelper.feedbackButtonId)?this.elmFeedbackButton=n:-1!==i.indexOf("cui-TabRowRight")?this.elmTopBar2Right=n:o&&n.id.startsWith(r.CuiHelper.peoplesWellControlId)&&(this.elmPeopleWellControl=n),this.findTopBar2Elements(n)}},e.prototype.undoScaleTopBar2=function(){var e=[this.elmTabHeaders,this.elmTopBar2Center,this.elmOICSeparator,this.elmOpenInClientButton,this.elmFeedbackButton,this.elmTopBar2Right,this.elmPeopleWellControl];d(e),this.setTabHeaderScaleIndex(0)},e.prototype.scaleTopBar2=function(){var e=this;c([function(){g(e.elmOICSeparator),g(e.elmOpenInClientButton)},function(){e.setTabHeaderScaleIndex(1)},function(){e.setTabHeaderScaleIndex(2)},function(){g(e.elmTopBar2Center),e.setTabHeaderScaleIndex(0)}],(function(){return v(e.elmTabHeaders,e.elmTopBar2Center,e._isRtl)})),c([function(){g(e.elmOICSeparator),g(e.elmOpenInClientButton)},function(){g(e.elmFeedbackButton)},function(){g(e.elmPeopleWellControl)},function(){g(e.elmTopBar2Right)}],(function(){return v(e.elmTopBar2Center,e.elmTopBar2Right,e._isRtl)||v(e.elmTabHeaders,e.elmTopBar2Right,e._isRtl)})),c([function(){e.setTabHeaderScaleIndex(1)},function(){e.setTabHeaderScaleIndex(2)},function(){g(e.elmTabHeaders)}],(function(){return v(e.elmFileButton,e.elmTabHeaders,e._isRtl)}))},e.prototype.setTabHeaderScaleIndex=function(t){this.elmTabHeaders&&(this.elmTabHeaders.className=e.tabHeaderScaleClasses[t],this.elmTabHeaders._scaleStep=t)},e.tabHeaderScaleClasses=["cui-tts","cui-tts-scale-1","cui-tts-scale-2"],e}();(0,T.l)(w,"TopBarScalingManager",null,[])},function(e,t,n){var i=n(227),r=n(247),o=n(714),a=n(12).f,s=n(440),l=n(503),u=s("meta"),c=0,p=Object.isExtensible||function(){return!0},d=function(e){a(e,u,{value:{objectID:"O"+ ++c,weakData:{}}})},h=e.exports={REQUIRED:!1,fastKey:function(e,t){if(!r(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!o(e,u)){if(!p(e))return"F";if(!t)return"E";d(e)}return e[u].objectID},getWeakData:function(e,t){if(!o(e,u)){if(!p(e))return!0;if(!t)return!1;d(e)}return e[u].weakData},onFreeze:function(e){return l&&h.REQUIRED&&p(e)&&!o(e,u)&&d(e),e}};i[u]=!0},function(e,t,n){var i=n(57),r=n(12),o=n(287),a=n(147);e.exports=i?Object.defineProperties:function(e,t){o(e);for(var n,i=a(t),s=i.length,l=0;s>l;)r.f(e,n=i[l++],t[n]);return e}},,function(e){var t=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:t)(e)}},function(e,t,n){"use strict";n.r(t);var i=n(482),r=n(419),o=n(111),a=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./lib/core/index.js")}({"./lib/core/api.js":function(e,t,n){n.d(t,"c",(function(){return u})),n.d(t,"b",(function(){return c})),n.d(t,"g",(function(){return p})),n.d(t,"e",(function(){return d})),n.d(t,"f",(function(){return h})),n.d(t,"h",(function(){return g})),n.d(t,"a",(function(){return m})),n.d(t,"i",(function(){return _})),n.d(t,"j",(function(){return f})),n.d(t,"d",(function(){return y}));var i,r=!1,o=[],a=0,s=2e4,l="Unknown";function u(e,t,n,i,r,o,a){void 0===t&&(t=!0),void 0===n&&(n=l),void 0===i&&(i=l),void 0===r&&(r=l),void 0===o&&(o=0),void 0===a&&(a=[]),g({name:null,actionName:e,commandSurface:r,parentName:n,triggerMethod:i,durationMs:o,succeeded:t,dataFields:a})}function c(e,t,n,i){void 0===t&&(t=!0),void 0===n&&(n=0),void 0===i&&(i=[]),d({name:e,succeeded:t,durationMs:n,dataFields:i})}function p(e){v({kind:"event",event:e,timestamp:(new Date).getTime()})}function d(e){v({kind:"activity",event:e,timestamp:(new Date).getTime()})}function h(e){v({kind:"otel",event:e})}function g(e){v({kind:"action",event:e,timestamp:(new Date).getTime()})}function m(e,t){v({kind:"addNamespaceMapping",namespace:e,ariaTenantToken:t})}function _(e){(r=e)||(o=[])}function f(){return v({kind:"shutdown"}),o.length+a}function y(e){i=e,o.forEach((function(e){return v(e)})),o=[]}function v(e){r&&(i?i(e):o.length<=s?o.push(e):a+=1)}},"./lib/core/generated/otel.gen.js":function(e,t,n){n.d(t,"a",(function(){return i}));var i=new(n("./lib/core/telemetryFactory.js").a)},"./lib/core/index.js":function(e,t,n){n.r(t);var i=n("./lib/core/generated/otel.gen.js");n.d(t,"TelemetryFactoryGlobal",(function(){return i.a}));var r=n("./lib/core/api.js");n.d(t,"logUserAction",(function(){return r.c})),n.d(t,"logActivity",(function(){return r.b})),n.d(t,"sendTelemetryEvent",(function(){return r.g})),n.d(t,"sendActivityEvent",(function(){return r.e})),n.d(t,"sendOtelEvent",(function(){return r.f})),n.d(t,"sendUserActionEvent",(function(){return r.h})),n.d(t,"addNamespaceMapping",(function(){return r.a})),n.d(t,"setEnabledState",(function(){return r.i})),n.d(t,"shutdown",(function(){return r.j})),n.d(t,"registerEventHandler",(function(){return r.d}))},"./lib/core/telemetryFactory.js":function(e,t,n){n.d(t,"a",(function(){return r}));var i=n("./lib/core/telemetryLogger.js"),r=function(){function e(){}return e.prototype.createInstance=function(){return new i.a},e}()},"./lib/core/telemetryLogger.js":function(e,t,n){n.d(t,"a",(function(){return r}));var i=n("./lib/core/api.js"),r=function(){function e(){}return e.prototype.sendTelemetryEvent=function(e){e&&Object(i.g)(e)},e.prototype.sendActivityEvent=function(e){e&&Object(i.e)(e)},e.prototype.sendUserActionEvent=function(e){e&&Object(i.h)(e)},e.prototype.addNamespaceMapping=function(e,t){e&&t&&Object(i.a)(e,t)},e.prototype.sendOtelEvent=function(e){e&&Object(i.f)(e)},e.prototype.setEnabledState=function(e){Object(i.i)(e)},e.prototype.registerEventHandler=function(e){e&&Object(i.d)(e)},e.prototype.shutdown=function(){return Object(i.j)()},e}()}}),s=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./lib/index.js")}({"./lib/generated/health.gen.js":function(e,t,n){n.d(t,"a",(function(){return i}));var i=new(n("./lib/healthFactory.js").a)},"./lib/health.js":function(e,t,n){n.d(t,"a",(function(){return r}));var i=n("./lib/healthInternal.js"),r=function(){function e(e,t){this._isHealthEnabled=!1,this._health=null;try{this._isHealthEnabled=e.getIsHealthEnabled(),this._isHealthEnabled&&(this._health=new i.a(e))}catch(e){t&&t(e),this._health=null,this._isHealthEnabled=!1}}return e.prototype.recordDimension=function(e,t){this._isHealthEnabled&&this._health&&e&&t&&this._health.recordDimension(e,t)},e.prototype.healthTimersStopSignalEncountered=function(){this._isHealthEnabled&&this._health&&this._health.stopAllHealthTimers()},e.prototype.stopAllHealthTimers=function(){this._isHealthEnabled&&this._health&&this._health.stopAllHealthTimers()},e.prototype.resumeAllHealthTimers=function(){this._isHealthEnabled&&this._health&&this._health.resumeAllHealthTimers()},e.prototype.getQosRecorder=function(){return this._isHealthEnabled&&this._health?this._health.Qos:null},e.prototype.getKpiRecorder=function(){return this._isHealthEnabled&&this._health?this._health.Kpi:null},e.prototype.recordQosError=function(e,t,n,i,r,o,a){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.recordError(e,t,n,i,r,o,a)},e.prototype.addQosPillar=function(e){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.addPillar(e)},e.prototype.recordKpiFailure=function(e,t,n,i,r){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordFailure(e,t,n,i,r)},e.prototype.recordKpiFailureMultiple=function(e,t,n,i,r){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordFailureMultiple(e,t,n,i,r)},e.prototype.recordKpiSuccess=function(e,t){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordSuccess(e,t)},e.prototype.recordKpiSuccessMultiple=function(e,t){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordSuccessMultiple(e,t)},e.prototype.recordKpiUsage=function(e,t,n,i){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordUsage(e,t,n,i)},e.prototype.recordKpiUsageForAlertableKpi=function(e,t,n){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordUsageForAlertableKpi(e,t,n)},e.prototype.recordKpiUsageMultiple=function(e,t,n,i){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordUsageMultiple(e,t,n,i)},e.prototype.setQosHandlerForWarmPipeline=function(e){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.setHandlerForWarmPipeline(e)},e.prototype.setKpiHandlerForWarmPipeline=function(e){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.setHandlerForWarmPipeline(e)},e.prototype.setQosHandlerForOtelLibraryLoader=function(e){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.setHandlerForOtelLibraryLoader(e)},e}()},"./lib/healthConfig.js":function(e,t,n){n.d(t,"a",(function(){return i}));var i=function(){function e(){this._remoteTelemetryUrl="",this._isHealthEnabled=!1,this._isQosEnabled=!1,this._isKpiEnabled=!1,this._heartbeatIntervalMs=0,this._recordPillarToWarmIntervalMs=0,this._qosVetoClassifier=function(){}}return e.prototype.getRemoteTelemetryUrl=function(){return this._remoteTelemetryUrl},e.prototype.getIsHealthEnabled=function(){return this._isHealthEnabled},e.prototype.getIsQosEnabled=function(){return this._isQosEnabled},e.prototype.getIsKpiEnabled=function(){return this._isKpiEnabled},e.prototype.getHeartbeatIntervalMs=function(){return this._heartbeatIntervalMs},e.prototype.getRecordPillarToWarmPipelineIntervalMs=function(){return this._recordPillarToWarmIntervalMs},e.prototype.getQosVetoClassifier=function(){return this._qosVetoClassifier},e.prototype.setRemoteTelemetryUrl=function(e){this._remoteTelemetryUrl=e},e.prototype.setIsHealthEnabled=function(e){this._isHealthEnabled=e},e.prototype.setIsQosEnabled=function(e){this._isQosEnabled=e},e.prototype.setIsKpiEnabled=function(e){this._isKpiEnabled=e},e.prototype.setHeartbeatIntervalMs=function(e){this._heartbeatIntervalMs=e},e.prototype.setRecordPillarToWarmPipelineIntervalMs=function(e){this._recordPillarToWarmIntervalMs=e},e.prototype.setQosVetoClassifier=function(e){this._qosVetoClassifier=e},e}()},"./lib/healthFactory.js":function(e,t,n){n.d(t,"a",(function(){return a}));var i=n("./lib/healthConfig.js"),r=n("./lib/qosVeto.js"),o=n("./lib/health.js"),a=function(){function e(){this._health=null}return e.prototype.createHealthInstance=function(e,t){return null==this._health&&(this._health=new o.a(e,t)),this._health},e.prototype.createHealthConfigInstance=function(){return new i.a},e.prototype.createQosVetoInstance=function(){return new r.a},e}()},"./lib/healthHeartbeat.js":function(e,t,n){n.d(t,"a",(function(){return o}));var i=n("./lib/utils.js"),r=3e5,o=function(){function e(e){var t=this;this.xhrFactory=e,this.isQosEnabled=!1,this.isKpiEnabled=!1,this.heartbeatSendTimerId=0,this.heartbeatIntervalMs=r,this.remoteTelemetryUrl="",this.initialStartCalled=!1,this.running=!1,this.getHeartbeatRequestJson=function(){var e={};e.heartbeatQosPillars=t.isQosEnabled&&t._qosPillars?i.b.convertStringSetToArray(t._qosPillars):[],e.heartbeatKpiNames=t.isKpiEnabled&&t._alertableKpiNames?i.b.convertStringSetToArray(t._alertableKpiNames):[],e.heartbeatDimensions=t.getHeartbeatDimensions?i.b.convertStringMapToObject(t.getHeartbeatDimensions()):{};var n={type:"health_heartbeat"};return n.payloadJson=JSON.stringify(e),JSON.stringify(n)},this._qosPillars=new Set,this._alertableKpiNames=new Set}return e.prototype.start=function(e){e&&(e.isQosEnabled||e.isKpiEnabled)&&!this.initialStartCalled&&e.remoteTelemetryUrl&&(this.isQosEnabled=e.isQosEnabled,this.isKpiEnabled=e.isKpiEnabled,this.remoteTelemetryUrl=e.remoteTelemetryUrl,this.heartbeatIntervalMs=e.heartbeatIntervalMs&&e.heartbeatIntervalMs>0?e.heartbeatIntervalMs:r,this.getHeartbeatDimensions=e.getHeartbeatDimensions,this.initialStartCalled=!0,this.running=!0,this.sendHeartbeatAndReQueue())},e.prototype.stop=function(){this.running=!1,this.clearHeartbeatSendTimer()},e.prototype.resume=function(){this.initialStartCalled&&!this.running&&this.sendHeartbeatAndReQueue()},e.prototype.qosPillarAdded=function(e){e&&!this._qosPillars.has(e)&&(this._qosPillars.add(e),this.sendHeartbeat())},e.prototype.kpiAdded=function(e){e&&!this._alertableKpiNames.has(e)&&(this._alertableKpiNames.add(e),this.sendHeartbeat())},e.prototype.sessionEndingErrorEncountered=function(){this.stop()},e.prototype.queueHeartbeat=function(){var e=this;this.heartbeatSendTimerId=window.setTimeout((function(){e.sendHeartbeatAndReQueue()}),this.heartbeatIntervalMs)},e.prototype.sendHeartbeat=function(){var e=this.getHeartbeatRequestJson();try{var t=this.xhrFactory();t.open("POST",this.remoteTelemetryUrl),t.send(e)}catch(e){}},e.prototype.sendHeartbeatAndReQueue=function(){this.sendHeartbeat(),this.queueHeartbeat()},e.prototype.clearHeartbeatSendTimer=function(){0!==this.heartbeatSendTimerId&&(window.clearTimeout(this.heartbeatSendTimerId),this.heartbeatSendTimerId=0)},e}()},"./lib/healthInternal.js":function(e,t,n){n.d(t,"a",(function(){return a}));var i=n("./lib/healthHeartbeat.js"),r=n("./lib/qosRecorder.js"),o=n("./lib/kpiRecorder.js"),a=function(){function e(e){var t=this;if(this._heartbeat=void 0,this._dimensions=new Map,this._heartbeat=new i.a((function(){return new XMLHttpRequest})),this._dimensions=new Map,e){if(e.getIsQosEnabled()){var n={isEnabled:e.getIsQosEnabled(),remoteTelemetryUrl:e.getRemoteTelemetryUrl(),vetoClassifier:e.getQosVetoClassifier(),recordPillarToWarmIntervalMs:e.getRecordPillarToWarmPipelineIntervalMs(),getQosDimensions:function(){return t._dimensions}};this.Qos=new r.a(n),this.Qos.registerAddPillarObserver(this._heartbeat.qosPillarAdded.bind(this._heartbeat)),this.Qos.registerSessionEndingErrorObserver(this._heartbeat.sessionEndingErrorEncountered.bind(this._heartbeat)),this.Qos.registerSessionEndingErrorObserver(this.healthTimersStopSignalEncountered.bind(this))}if(e.getIsKpiEnabled()){var a={isEnabled:e.getIsKpiEnabled(),remoteTelemetryUrl:e.getRemoteTelemetryUrl(),getKpiDimensions:function(){return t._dimensions}};this.Kpi=new o.a(a),this.Kpi.registerAlertableKpiObserver(this._heartbeat.kpiAdded.bind(this._heartbeat))}if(e.getIsQosEnabled()||e.getIsKpiEnabled()){var s={isQosEnabled:e.getIsQosEnabled(),isKpiEnabled:e.getIsKpiEnabled(),remoteTelemetryUrl:e.getRemoteTelemetryUrl(),heartbeatIntervalMs:e.getHeartbeatIntervalMs(),getHeartbeatDimensions:function(){return t._dimensions}};this._heartbeat.start(s)}}}return e.prototype.recordDimension=function(e,t){e&&this._dimensions.set(e,t)},e.prototype.healthTimersStopSignalEncountered=function(){this.stopAllHealthTimers()},e.prototype.stopAllHealthTimers=function(){this._heartbeat&&this._heartbeat.stop(),this.Qos&&this.Qos.stopRecordPillarToWarmPipelineTimer()},e.prototype.resumeAllHealthTimers=function(){this._heartbeat&&this._heartbeat.resume(),this.Qos&&this.Qos.resumeRecordPillarToWarmPipelineTimer()},e}()},"./lib/index.js":function(e,t,n){n.r(t);var i=n("./lib/generated/health.gen.js");n.d(t,"HealthFactoryGlobal",(function(){return i.a}));var r=n("./lib/utils.js");n.d(t,"Utils",(function(){return r.b})),n.d(t,"HealthDataField",(function(){return r.a}));var o=n("./lib/healthFactory.js");n.d(t,"HealthFactory",(function(){return o.a}))},"./lib/kpiRecorder.js":function(e,t,n){n.d(t,"a",(function(){return r}));var i=n("./lib/utils.js"),r=function(){function e(e){var t=this;this._isEnabled=!1,this._kpis=new Map,this._application="",this._recordToWarmPipeline=null,this.formatAlertableKpiFailurePayload=function(e,n){var r={};r.sessionDimensions=i.b.convertStringMapToObject(t._getKpiDimensions());var o=new Set;e&&o.add(e),r.failedKpis=i.b.convertStringSetToArray(o),n&&n.durationMs&&(r.durationMs=n.durationMs);var a={type:"kpi_failure"};return a.payloadJson=JSON.stringify(r),JSON.stringify(a)},this.formatAlertableKpiSuccessDurationPayload=function(e,n){var r={};r.sessionDimensions=i.b.convertStringMapToObject(t._getKpiDimensions()),r.succeededKpi=e,r.durationMs=n.durationMs;var o={type:"kpi_success_duration"};return o.payloadJson=JSON.stringify(r),JSON.stringify(o)},e?(e.remoteTelemetryUrl&&(this._remoteTelemetryUrl=e.remoteTelemetryUrl),this._isEnabled=e.isEnabled,e.getKpiDimensions?this._getKpiDimensions=e.getKpiDimensions:this._getKpiDimensions=function(){return new Map}):this._getKpiDimensions=function(){return new Map},this._alertableKpiObservers=[]}return e.prototype.registerAlertableKpiObserver=function(e){e&&this._alertableKpiObservers.push(e)},e.prototype.removeAlertableKpiObserver=function(e){e&&(this._alertableKpiObservers=this._alertableKpiObservers.filter((function(t){return t!==e})))},e.prototype.recordFailure=function(e,t,n,i,r){if(this._isEnabled&&e&&this._kpis&&this._kpis.has(e)){var o=this._kpis.get(e);if(o){if(o.failureCount=o.failureCount+1,t&&o.kpiErrors)if(o.kpiErrors.has(t)){var a=o.kpiErrors.get(e);a&&(a.count=a.count+1,o.kpiErrors.set(t,a))}else{var s={kpiErrorName:t,isIntentional:n||!1,isInternal:i||!0,count:1};o.kpiErrors.set(t,s)}this._kpis.set(e,o),o&&o.isAlertable&&this.sendKpiFailureToHotPipeline(e,r),this.sendToWarmPipeline(e,"Failure",r,t)}}},e.prototype.recordFailureMultiple=function(e,t,n,i,r){var o=this;this._isEnabled&&e&&e.forEach((function(e){e&&o.recordFailure(e,t,n,i,r)}))},e.prototype.recordSuccess=function(e,t){if(this._isEnabled&&e&&this._kpis&&this._kpis.has(e)){var n=this._kpis.get(e);n&&(n.successCount=n.successCount+1,this._kpis.set(e,n),n&&n.isAlertable&&this.sendKpiSuccessDurationToHotPipeline(e,t),this.sendToWarmPipeline(e,"Success",t))}},e.prototype.recordSuccessMultiple=function(e,t){var n=this;this._isEnabled&&e&&e.forEach((function(e){e&&n.recordSuccess(e,t)}))},e.prototype.recordUsage=function(e,t,n,i){this._isEnabled&&e&&this._kpis&&(this._kpis.has(e)?this.incrementUsageOnKpi(e):this.addNewKpi(e,t,!1,n),this.sendToWarmPipeline(e,"Usage",{extendedProperties:i}))},e.prototype.recordUsageMultiple=function(e,t,n,i){var r=this;this._isEnabled&&e&&e.forEach((function(e){e&&r.recordUsage(e,t,n,i)}))},e.prototype.recordUsageForAlertableKpi=function(e,t,n){if(this._isEnabled&&e&&this._kpis){var i=!0;if(this._kpis.has(e)){var r=this._kpis.get(e);r&&(i=0===r.type),this.incrementUsageOnKpi(e)}else this.addNewKpi(e,0,!0,t);i&&this._alertableKpiObservers.forEach((function(t){return t(e)})),this.sendToWarmPipeline(e,"Usage",{extendedProperties:n})}},e.prototype.setHandlerForWarmPipeline=function(e){e&&(this._recordToWarmPipeline=e)},e.prototype.sendToWarmPipeline=function(e,t,n,r){if(this._recordToWarmPipeline){var o=i.b.formatEventName(e,"Kpi",this.getApplication());if(this._kpis){var a=this._kpis.get(e);if(a){var s=0===a.type,l=[new i.a("KpiEvent","string",t),new i.a("KpiType","string",s?"FailureBased":"SuccessBased"),new i.a("UsageCount","int",a.usageCount.toString()),new i.a("FailureCount","int",a.failureCount.toString()),new i.a("SuccessCount","int",a.successCount.toString())];if(s&&a.kpiErrors&&r){var u=a.kpiErrors.get(r);u&&(l.push(new i.a("ErrorName","string",u.kpiErrorName?u.kpiErrorName:"")),l.push(new i.a("IsIntentional","boolean",u.isIntentional.toString())),l.push(new i.a("IsInternal","boolean",u.isInternal.toString())),l.push(new i.a("ErrorCount","int",u.count.toString())))}n&&(n.durationMs&&l.push(new i.a("DurationMs","int",n.durationMs.toString())),n.extendedProperties&&n.extendedProperties.forEach((function(e,t){l.push(new i.a("ExtendedProperties_"+t,"string",e||""))}))),this._recordToWarmPipeline(o,!0,l)}}}},e.prototype.addNewKpi=function(e,t,n,i){if(e&&this._kpis){var r={kpiName:e,type:n?0:t||0,isAlertable:n,owningFeatureCrewAlias:i,kpiErrors:new Map,usageCount:1,successCount:0,failureCount:0};this._kpis.set(e,r)}},e.prototype.incrementUsageOnKpi=function(e){if(e&&this._kpis){var t=this._kpis.get(e);t&&(t.usageCount=t.usageCount+1,this._kpis.set(e,t))}},e.prototype.sendKpiFailureToHotPipeline=function(e,t){if(this._remoteTelemetryUrl){var n=this.formatAlertableKpiFailurePayload(e,t);i.b.sendToHotPipeline(this._remoteTelemetryUrl,n)}},e.prototype.sendKpiSuccessDurationToHotPipeline=function(e,t){if(this._remoteTelemetryUrl&&e&&t&&t.durationMs){var n=this.formatAlertableKpiSuccessDurationPayload(e,t);i.b.sendToHotPipeline(this._remoteTelemetryUrl,n)}},e.prototype.getApplication=function(){if(this._application)return this._application;var e=i.b.getDimension(this._getKpiDimensions(),"application");return"Unknown"!==e&&(this._application=e),e},e}()},"./lib/qosRecorder.js":function(e,t,n){n.d(t,"a",(function(){return o}));var i=n("./lib/utils.js"),r=864e5,o=function(){function e(e){var t=this;this._isEnabled=!1,this._qosErrors=new Map,this._qosPillars=new Set,this._application="",this.recordPillarToWarmTimerId=0,this.recordPillarToWarmIntervalMs=r,this._recordToWarmPipeline=null,this._downloadOtelLibrary=null,this.formatQosErrorPayload=function(e){var n={};n.qosDimensions=i.b.convertStringMapToObject(t._getQosDimensions());var r=new Map;e&&e.errorName&&r.set(e.errorName,e),n.errors=i.b.convertQosErrorToObject(r),n.sessionPillars=i.b.convertStringSetToArray(t._qosPillars);var o={type:"qos_error"};return o.payloadJson=JSON.stringify(n),JSON.stringify(o)},e?(e.remoteTelemetryUrl&&(this._remoteTelemetryUrl=e.remoteTelemetryUrl),this._vetoClassifier=e.vetoClassifier,this._isEnabled=e.isEnabled,e.getQosDimensions?this._getQosDimensions=e.getQosDimensions:this._getQosDimensions=function(){return new Map},this.recordPillarToWarmIntervalMs=e.recordPillarToWarmIntervalMs&&e.recordPillarToWarmIntervalMs>0?e.recordPillarToWarmIntervalMs:r):this._getQosDimensions=function(){return new Map},this._addPillarObservers=[],this._sessionEndingErrorObservers=[]}return e.prototype.registerAddPillarObserver=function(e){e&&this._addPillarObservers.push(e)},e.prototype.registerSessionEndingErrorObserver=function(e){e&&this._sessionEndingErrorObservers.push(e)},e.prototype.removeAddPillarObserver=function(e){e&&(this._addPillarObservers=this._addPillarObservers.filter((function(t){return t!==e})))},e.prototype.removeSessionEndingErrorObserver=function(e){e&&(this._sessionEndingErrorObservers=this._sessionEndingErrorObservers.filter((function(t){return t!==e})))},e.prototype.setHandlerForWarmPipeline=function(e){e&&(this._recordToWarmPipeline=e)},e.prototype.setHandlerForOtelLibraryLoader=function(e){e&&(this._downloadOtelLibrary=e)},e.prototype.recordError=function(e,t,n,r,o,a,s){if(this._isEnabled){var l=null;if(this._qosErrors&&e&&t&&(this._qosErrors.has(e)?(l=this._qosErrors.get(e))&&(l.count+=1,this._qosErrors.set(e,l)):(l={errorName:e,isIntentional:n||!1,isInternal:r||!0,alertOnPillar:o||!0,isSessionEndingError:a||!1,count:1},this._qosErrors.set(e,l)),l)){l.vetos=[];for(var u=0,c=t;u<c.length;u++){var p=c[u];if(this._vetoClassifier){var d=this._vetoClassifier.getVeto(p);d&&l.vetos.push(d)}}if(l.durationMs=s&&s.durationMs?s.durationMs:null,l.extendedProperties=s&&s.extendedProperties?s.extendedProperties:null,this.sendQosErrorToHotPipeline(l),l.isSessionEndingError&&(this._downloadOtelLibrary&&this._downloadOtelLibrary(),this._sessionEndingErrorObservers.forEach((function(e){return e()}))),this._recordToWarmPipeline){var h=i.b.formatEventName(l.errorName,"Qos.Error",this.getApplication()),g=[];l.extendedProperties&&l.extendedProperties.forEach((function(e,t){g.push(new i.a("ExtendedProperties_"+t,"string",e||""))}));for(var m={},_=0,f=this.getPillars();_<f.length;_++){var y=f[_];this.recordPillarToWarmPipeline(y),m[y]=!0}if(l.vetos)for(var v=0,S=l.vetos;v<S.length;v++){var C=S[v];if(C){p=C.getVetoName();var b=C.getPillars();if(b)for(var A=0,T=b;A<T.length;A++){if((y=T[A])&&(m[y]||"VetoMissingClassification"===y)){var w=[new i.a("IsIntentional","boolean",l.isIntentional.toString()),new i.a("IsInternal","boolean",l.isInternal.toString()),new i.a("AlertOnPillar","boolean",l.alertOnPillar.toString()),new i.a("Count","int",l.count.toString()),new i.a("Pillar","string",y),new i.a("Veto","string",p||"")];l.durationMs&&w.push(new i.a("DurationMs","int",l.durationMs.toString())),w=w.concat(g),this._recordToWarmPipeline(h,!1,w)}}}}}}}},e.prototype.addPillar=function(e){e&&this._qosPillars&&(0===this._qosPillars.size&&this.queueRecordPillarToWarmPipeline(),this._qosPillars.has(e)||(this._qosPillars.add(e),this._addPillarObservers.forEach((function(t){return t(e)})),this.recordPillarToWarmPipeline(e)))},e.prototype.getPillars=function(){return i.b.convertStringSetToArray(this._qosPillars)},e.prototype.sendQosErrorToHotPipeline=function(e){if(this._remoteTelemetryUrl){var t=this.formatQosErrorPayload(e);i.b.sendToHotPipeline(this._remoteTelemetryUrl,t)}},e.prototype.recordPillarToWarmPipeline=function(e){if(this._recordToWarmPipeline){var t=i.b.formatEventName(e,"Qos.Pillar",this.getApplication(),!0);this._recordToWarmPipeline(t,!0,[new i.a("Pillar","string",e)])}},e.prototype.queueRecordPillarToWarmPipeline=function(){var e=this;this.recordPillarToWarmTimerId=window.setTimeout((function(){e.recordPillarsToWarmPipelineAndReQueue()}),this.recordPillarToWarmIntervalMs)},e.prototype.recordPillarsToWarmPipelineAndReQueue=function(){var e=this;this._qosPillars&&this._qosPillars.forEach((function(t){t&&e.recordPillarToWarmPipeline(t)})),this.queueRecordPillarToWarmPipeline()},e.prototype.stopRecordPillarToWarmPipelineTimer=function(){this.clearRecordPillarToWarmPipelineTimer()},e.prototype.resumeRecordPillarToWarmPipelineTimer=function(){0===this.recordPillarToWarmTimerId&&this.recordPillarsToWarmPipelineAndReQueue()},e.prototype.clearRecordPillarToWarmPipelineTimer=function(){0!==this.recordPillarToWarmTimerId&&(window.clearTimeout(this.recordPillarToWarmTimerId),this.recordPillarToWarmTimerId=0)},e.prototype.getApplication=function(){if(this._application)return this._application;var e=i.b.getDimension(this._getQosDimensions(),"application");return"Unknown"!==e&&(this._application=e),e},e}()},"./lib/qosVeto.js":function(e,t,n){n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.prototype.getPillars=function(){return this._pillars},e.prototype.getVetoName=function(){return this._vetoName},e.prototype.setPillars=function(e){this._pillars=e},e.prototype.setVetoName=function(e){this._vetoName=e},e}()},"./lib/utils.js":function(e,t,n){n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var i=function(){function e(){}return e.convertStringMapToObject=function(e){if(!e)return{};var t={};return e.forEach((function(e,n){n&&(t[n]=e)})),t},e.convertStringSetToArray=function(e){if(!e)return[];var t=[];return e.forEach((function(e){e&&t.push(e)})),t},e.convertQosErrorToObject=function(e){if(!e)return{};var t={};return e.forEach((function(e,n){if(n&&e){var i=[];e.vetos&&e.vetos.forEach((function(e){if(e){var t={};t.vetoName=e.getVetoName(),t.pillars=e.getPillars(),i.push(t)}}));var r={};r.errorName=e.errorName,r.extendedProperties=e.extendedProperties,r.isIntentional=e.isIntentional,r.isInternal=e.isInternal,r.alertOnPillar=e.alertOnPillar,r.vetos=i,r.count=e.count,r.durationMs=e.durationMs,t[n]=r}})),t},e.sendToHotPipeline=function(e,t){if(t)if("undefined"!=typeof navigator.sendBeacon)try{navigator.sendBeacon(e,t)}catch(i){var n;(n=new XMLHttpRequest).open("POST",e),n.send(t)}else(n=new XMLHttpRequest).open("POST",e),n.send(t)},e.formatEventName=function(e,t,n,i){if(i)return"Office."+n+".Online.Health."+t;var r="Unknown"+t;return e&&(r=(r=(r=e.length>0&&!isNaN(Number(e.charAt(0)))?"Unknown"+e:e).replace(/_/g,"")).charAt(0).toUpperCase()+r.slice(1)),"Office."+n+".Online.Health."+t+"."+r},e.getDimension=function(e,t){var n="Unknown";if(e){var i=e.get(t);i&&(n=i)}return n},e}(),r=function(){function e(e,t,n){this._name=e,this._type=t,this._value=n}return e.prototype.getName=function(){return this._name},e.prototype.getValue=function(){return this._value},e.prototype.getType=function(){return this._type},e}()}}),l=n(254),u=n(675),c=n(351),p=n(18),d=n(162),h=n(208),g=(0,h.y)("IActionDataContainer"),m=function(){function e(e,t){void 0===t&&(t=!0),this.actionData=null,this.shouldCanvasTakeFocus=!1,this.actionData=e,this.shouldCanvasTakeFocus=t}return e.prototype.get_actionData=function(){return this.actionData},e.prototype.get_shouldCanvasTakeFocus=function(){return this.shouldCanvasTakeFocus},e}();(0,h.l)(m,"ActionDataContainer",null,[g]);var _=n(469),f=n(2),y=n(196),v=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./lib/index.js")}({"../office-online-qos/lib/generated/health.gen.js":function(e,t,n){new(n("../office-online-qos/lib/healthFactory.js").a)},"../office-online-qos/lib/health.js":function(e,t,n){n.d(t,"a",(function(){return r}));var i=n("../office-online-qos/lib/healthInternal.js"),r=function(){function e(e,t){this._isHealthEnabled=!1,this._health=null;try{this._isHealthEnabled=e.getIsHealthEnabled(),this._isHealthEnabled&&(this._health=new i.a(e))}catch(e){t&&t(e),this._health=null,this._isHealthEnabled=!1}}return e.prototype.recordDimension=function(e,t){this._isHealthEnabled&&this._health&&e&&t&&this._health.recordDimension(e,t)},e.prototype.healthTimersStopSignalEncountered=function(){this._isHealthEnabled&&this._health&&this._health.stopAllHealthTimers()},e.prototype.stopAllHealthTimers=function(){this._isHealthEnabled&&this._health&&this._health.stopAllHealthTimers()},e.prototype.resumeAllHealthTimers=function(){this._isHealthEnabled&&this._health&&this._health.resumeAllHealthTimers()},e.prototype.getQosRecorder=function(){return this._isHealthEnabled&&this._health?this._health.Qos:null},e.prototype.getKpiRecorder=function(){return this._isHealthEnabled&&this._health?this._health.Kpi:null},e.prototype.recordQosError=function(e,t,n,i,r,o,a){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.recordError(e,t,n,i,r,o,a)},e.prototype.recordQosErrorNew=function(e,t,n,i,r,o,a){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.recordError(e,t,n,i,r,o,a)},e.prototype.addQosPillar=function(e){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.addPillar(e)},e.prototype.recordKpiFailure=function(e,t,n,i,r){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordFailure(e,t,n,i,r)},e.prototype.recordKpiFailureNew=function(e,t,n,i,r){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordFailure(e,t,n,i,r)},e.prototype.recordKpiFailureMultiple=function(e,t,n,i,r){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordFailureMultiple(e,t,n,i,r)},e.prototype.recordKpiFailureMultipleNew=function(e,t,n,i,r){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordFailureMultiple(e,t,n,i,r)},e.prototype.recordKpiSuccess=function(e,t){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordSuccess(e,t)},e.prototype.recordKpiSuccessNew=function(e,t){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordSuccess(e,t)},e.prototype.recordKpiSuccessMultiple=function(e,t){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordSuccessMultiple(e,t)},e.prototype.recordKpiSuccessMultipleNew=function(e,t){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordSuccessMultiple(e,t)},e.prototype.recordKpiUsage=function(e,t,n,i){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordUsage(e,t,n,i)},e.prototype.recordKpiUsageForAlertableKpi=function(e,t,n){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordUsageForAlertableKpi(e,t,n)},e.prototype.recordKpiUsageMultiple=function(e,t,n,i){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.recordUsageMultiple(e,t,n,i)},e.prototype.setQosHandlerForWarmPipeline=function(e){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.setHandlerForWarmPipeline(e)},e.prototype.setKpiHandlerForWarmPipeline=function(e){this._isHealthEnabled&&this._health&&this._health.Kpi&&this._health.Kpi.setHandlerForWarmPipeline(e)},e.prototype.setQosHandlerForOtelLibraryLoader=function(e){this._isHealthEnabled&&this._health&&this._health.Qos&&this._health.Qos.setHandlerForOtelLibraryLoader(e)},e}()},"../office-online-qos/lib/healthConfig.js":function(e,t,n){n.d(t,"a",(function(){return i}));var i=function(){function e(){this._remoteTelemetryUrl="",this._isHealthEnabled=!1,this._isQosEnabled=!1,this._isKpiEnabled=!1,this._heartbeatIntervalMs=0,this._recordPillarToWarmIntervalMs=0,this._qosVetoClassifier=function(){}}return e.prototype.getRemoteTelemetryUrl=function(){return this._remoteTelemetryUrl},e.prototype.getIsHealthEnabled=function(){return this._isHealthEnabled},e.prototype.getIsQosEnabled=function(){return this._isQosEnabled},e.prototype.getIsKpiEnabled=function(){return this._isKpiEnabled},e.prototype.getHeartbeatIntervalMs=function(){return this._heartbeatIntervalMs},e.prototype.getRecordPillarToWarmPipelineIntervalMs=function(){return this._recordPillarToWarmIntervalMs},e.prototype.getQosVetoClassifier=function(){return this._qosVetoClassifier},e.prototype.setRemoteTelemetryUrl=function(e){this._remoteTelemetryUrl=e},e.prototype.setIsHealthEnabled=function(e){this._isHealthEnabled=e},e.prototype.setIsQosEnabled=function(e){this._isQosEnabled=e},e.prototype.setIsKpiEnabled=function(e){this._isKpiEnabled=e},e.prototype.setHeartbeatIntervalMs=function(e){this._heartbeatIntervalMs=e},e.prototype.setRecordPillarToWarmPipelineIntervalMs=function(e){this._recordPillarToWarmIntervalMs=e},e.prototype.setQosVetoClassifier=function(e){this._qosVetoClassifier=e},e}()},"../office-online-qos/lib/healthFactory.js":function(e,t,n){n.d(t,"a",(function(){return a}));var i=n("../office-online-qos/lib/healthConfig.js"),r=n("../office-online-qos/lib/qosVeto.js"),o=n("../office-online-qos/lib/health.js"),a=function(){function e(){this._health=null}return e.prototype.createHealthInstance=function(e,t){return null==this._health&&(this._health=new o.a(e,t)),this._health},e.prototype.createHealthConfigInstance=function(){return new i.a},e.prototype.createQosVetoInstance=function(){return new r.a},e}()},"../office-online-qos/lib/healthHeartbeat.js":function(e,t,n){n.d(t,"a",(function(){return o}));var i=n("../office-online-qos/lib/utils.js"),r=3e5,o=function(){function e(e){var t=this;this.xhrFactory=e,this.isQosEnabled=!1,this.isKpiEnabled=!1,this.heartbeatSendTimerId=0,this.heartbeatIntervalMs=r,this.remoteTelemetryUrl="",this.initialStartCalled=!1,this.running=!1,this.getHeartbeatRequestJson=function(){var e={};e.heartbeatQosPillars=t.isQosEnabled&&t._qosPillars?i.b.convertStringSetToArray(t._qosPillars):[],e.heartbeatKpiNames=t.isKpiEnabled&&t._alertableKpiNames?i.b.convertStringSetToArray(t._alertableKpiNames):[],e.heartbeatDimensions=t.getHeartbeatDimensions?i.b.convertStringMapToObject(t.getHeartbeatDimensions()):{};var n={type:"health_heartbeat"};return n.payloadJson=JSON.stringify(e),JSON.stringify(n)},this._qosPillars=new Set,this._alertableKpiNames=new Set}return e.prototype.start=function(e){e&&(e.isQosEnabled||e.isKpiEnabled)&&!this.initialStartCalled&&e.remoteTelemetryUrl&&(this.isQosEnabled=e.isQosEnabled,this.isKpiEnabled=e.isKpiEnabled,this.remoteTelemetryUrl=e.remoteTelemetryUrl,this.heartbeatIntervalMs=e.heartbeatIntervalMs&&e.heartbeatIntervalMs>0?e.heartbeatIntervalMs:r,this.getHeartbeatDimensions=e.getHeartbeatDimensions,this.initialStartCalled=!0,this.running=!0,this.sendHeartbeatAndReQueue())},e.prototype.stop=function(){this.running=!1,this.clearHeartbeatSendTimer()},e.prototype.resume=function(){this.initialStartCalled&&!this.running&&this.sendHeartbeatAndReQueue()},e.prototype.qosPillarAdded=function(e){e&&!this._qosPillars.has(e)&&(this._qosPillars.add(e),this.sendHeartbeat())},e.prototype.kpiAdded=function(e){e&&!this._alertableKpiNames.has(e)&&(this._alertableKpiNames.add(e),this.sendHeartbeat())},e.prototype.sessionEndingErrorEncountered=function(){this.stop()},e.prototype.queueHeartbeat=function(){var e=this;this.heartbeatSendTimerId=window.setTimeout((function(){e.sendHeartbeatAndReQueue()}),this.heartbeatIntervalMs)},e.prototype.sendHeartbeat=function(){var e=this.getHeartbeatRequestJson();try{var t=this.xhrFactory();t.open("POST",this.remoteTelemetryUrl),t.send(e)}catch(e){}},e.prototype.sendHeartbeatAndReQueue=function(){this.sendHeartbeat(),this.queueHeartbeat()},e.prototype.clearHeartbeatSendTimer=function(){0!==this.heartbeatSendTimerId&&(window.clearTimeout(this.heartbeatSendTimerId),this.heartbeatSendTimerId=0)},e}()},"../office-online-qos/lib/healthInternal.js":function(e,t,n){n.d(t,"a",(function(){return a}));var i=n("../office-online-qos/lib/healthHeartbeat.js"),r=n("../office-online-qos/lib/qosRecorder.js"),o=n("../office-online-qos/lib/kpiRecorder.js"),a=function(){function e(e){var t=this;if(this._heartbeat=void 0,this._dimensions=new Map,this._heartbeat=new i.a((function(){return new XMLHttpRequest})),this._dimensions=new Map,e){if(e.getIsQosEnabled()){var n={isEnabled:e.getIsQosEnabled(),remoteTelemetryUrl:e.getRemoteTelemetryUrl(),vetoClassifier:e.getQosVetoClassifier(),recordPillarToWarmIntervalMs:e.getRecordPillarToWarmPipelineIntervalMs(),getQosDimensions:function(){return t._dimensions}};this.Qos=new r.a(n),this.Qos.registerAddPillarObserver(this._heartbeat.qosPillarAdded.bind(this._heartbeat)),this.Qos.registerSessionEndingErrorObserver(this._heartbeat.sessionEndingErrorEncountered.bind(this._heartbeat)),this.Qos.registerSessionEndingErrorObserver(this.healthTimersStopSignalEncountered.bind(this))}if(e.getIsKpiEnabled()){var a={isEnabled:e.getIsKpiEnabled(),remoteTelemetryUrl:e.getRemoteTelemetryUrl(),getKpiDimensions:function(){return t._dimensions}};this.Kpi=new o.a(a),this.Kpi.registerAlertableKpiObserver(this._heartbeat.kpiAdded.bind(this._heartbeat))}if(e.getIsQosEnabled()||e.getIsKpiEnabled()){var s={isQosEnabled:e.getIsQosEnabled(),isKpiEnabled:e.getIsKpiEnabled(),remoteTelemetryUrl:e.getRemoteTelemetryUrl(),heartbeatIntervalMs:e.getHeartbeatIntervalMs(),getHeartbeatDimensions:function(){return t._dimensions}};this._heartbeat.start(s)}}}return e.prototype.recordDimension=function(e,t){e&&this._dimensions.set(e,t)},e.prototype.healthTimersStopSignalEncountered=function(){this.stopAllHealthTimers()},e.prototype.stopAllHealthTimers=function(){this._heartbeat&&this._heartbeat.stop(),this.Qos&&this.Qos.stopRecordPillarToWarmPipelineTimer()},e.prototype.resumeAllHealthTimers=function(){this._heartbeat&&this._heartbeat.resume(),this.Qos&&this.Qos.resumeRecordPillarToWarmPipelineTimer()},e}()},"../office-online-qos/lib/index.js":function(e,t,n){n("../office-online-qos/lib/generated/health.gen.js"),n("../office-online-qos/lib/utils.js");var i=n("../office-online-qos/lib/healthFactory.js");n.d(t,"a",(function(){return i.a}))},"../office-online-qos/lib/kpiRecorder.js":function(e,t,n){n.d(t,"a",(function(){return r}));var i=n("../office-online-qos/lib/utils.js"),r=function(){function e(e){var t=this;this._isEnabled=!1,this._kpis=new Map,this._application="",this._recordToWarmPipeline=null,this.formatAlertableKpiFailurePayload=function(e,n){var r={};r.sessionDimensions=i.b.convertStringMapToObject(t._getKpiDimensions());var o=new Set;e&&o.add(e),r.failedKpis=i.b.convertStringSetToArray(o),n&&n.durationMs&&(r.durationMs=n.durationMs);var a={type:"kpi_failure"};return a.payloadJson=JSON.stringify(r),JSON.stringify(a)},this.formatAlertableKpiSuccessDurationPayload=function(e,n){var r={};r.sessionDimensions=i.b.convertStringMapToObject(t._getKpiDimensions()),r.succeededKpi=e,r.durationMs=n.durationMs;var o={type:"kpi_success_duration"};return o.payloadJson=JSON.stringify(r),JSON.stringify(o)},e?(e.remoteTelemetryUrl&&(this._remoteTelemetryUrl=e.remoteTelemetryUrl),this._isEnabled=e.isEnabled,e.getKpiDimensions?this._getKpiDimensions=e.getKpiDimensions:this._getKpiDimensions=function(){return new Map}):this._getKpiDimensions=function(){return new Map},this._alertableKpiObservers=[]}return e.prototype.registerAlertableKpiObserver=function(e){e&&this._alertableKpiObservers.push(e)},e.prototype.removeAlertableKpiObserver=function(e){e&&(this._alertableKpiObservers=this._alertableKpiObservers.filter((function(t){return t!==e})))},e.prototype.recordFailure=function(e,t,n,i,r){if(this._isEnabled&&e&&this._kpis&&this._kpis.has(e)){var o=this._kpis.get(e);if(o){if(o.failureCount=o.failureCount+1,t&&o.kpiErrors)if(o.kpiErrors.has(t)){var a=o.kpiErrors.get(e);a&&(a.count=a.count+1,o.kpiErrors.set(t,a))}else{var s={kpiErrorName:t,isIntentional:n||!1,isInternal:i||!0,count:1};o.kpiErrors.set(t,s)}this._kpis.set(e,o),o&&o.isAlertable&&this.sendKpiFailureToHotPipeline(e,r),this.sendToWarmPipeline(e,"Failure",r,t)}}},e.prototype.recordFailureMultiple=function(e,t,n,i,r){var o=this;this._isEnabled&&e&&e.forEach((function(e){e&&o.recordFailure(e,t,n,i,r)}))},e.prototype.recordSuccess=function(e,t){if(this._isEnabled&&e&&this._kpis&&this._kpis.has(e)){var n=this._kpis.get(e);n&&(n.successCount=n.successCount+1,this._kpis.set(e,n),n&&n.isAlertable&&this.sendKpiSuccessDurationToHotPipeline(e,t),this.sendToWarmPipeline(e,"Success",t))}},e.prototype.recordSuccessMultiple=function(e,t){var n=this;this._isEnabled&&e&&e.forEach((function(e){e&&n.recordSuccess(e,t)}))},e.prototype.recordUsage=function(e,t,n,i){this._isEnabled&&e&&this._kpis&&(this._kpis.has(e)?this.incrementUsageOnKpi(e):this.addNewKpi(e,t,!1,n),this.sendToWarmPipeline(e,"Usage",{extendedProperties:i}))},e.prototype.recordUsageMultiple=function(e,t,n,i){var r=this;this._isEnabled&&e&&e.forEach((function(e){e&&r.recordUsage(e,t,n,i)}))},e.prototype.recordUsageForAlertableKpi=function(e,t,n){if(this._isEnabled&&e&&this._kpis){var i=!0;if(this._kpis.has(e)){var r=this._kpis.get(e);r&&(i=0===r.type),this.incrementUsageOnKpi(e)}else this.addNewKpi(e,0,!0,t);i&&this._alertableKpiObservers.forEach((function(t){return t(e)})),this.sendToWarmPipeline(e,"Usage",{extendedProperties:n})}},e.prototype.setHandlerForWarmPipeline=function(e){e&&(this._recordToWarmPipeline=e)},e.prototype.sendToWarmPipeline=function(e,t,n,r){if(this._recordToWarmPipeline){var o=i.b.formatEventName(e,"Kpi",this.getApplication());if(this._kpis){var a=this._kpis.get(e);if(a){var s=0===a.type,l=[new i.a("KpiEvent","string",t),new i.a("KpiType","string",s?"FailureBased":"SuccessBased"),new i.a("UsageCount","int",a.usageCount.toString()),new i.a("FailureCount","int",a.failureCount.toString()),new i.a("SuccessCount","int",a.successCount.toString())];if(s&&a.kpiErrors&&r){var u=a.kpiErrors.get(r);u&&(l.push(new i.a("ErrorName","string",u.kpiErrorName?u.kpiErrorName:"")),l.push(new i.a("IsIntentional","boolean",u.isIntentional.toString())),l.push(new i.a("IsInternal","boolean",u.isInternal.toString())),l.push(new i.a("ErrorCount","int",u.count.toString())))}n&&(n.durationMs&&l.push(new i.a("DurationMs","int",n.durationMs.toString())),n.extendedProperties&&n.extendedProperties.forEach((function(e,t){l.push(new i.a("ExtendedProperties_"+t,"string",e||""))}))),this._recordToWarmPipeline(o,!0,l)}}}},e.prototype.addNewKpi=function(e,t,n,i){if(e&&this._kpis){var r={kpiName:e,type:n?0:t||0,isAlertable:n,owningFeatureCrewAlias:i,kpiErrors:new Map,usageCount:1,successCount:0,failureCount:0};this._kpis.set(e,r)}},e.prototype.incrementUsageOnKpi=function(e){if(e&&this._kpis){var t=this._kpis.get(e);t&&(t.usageCount=t.usageCount+1,this._kpis.set(e,t))}},e.prototype.sendKpiFailureToHotPipeline=function(e,t){if(this._remoteTelemetryUrl){var n=this.formatAlertableKpiFailurePayload(e,t);i.b.sendToHotPipeline(this._remoteTelemetryUrl,n)}},e.prototype.sendKpiSuccessDurationToHotPipeline=function(e,t){if(this._remoteTelemetryUrl&&e&&t&&t.durationMs){var n=this.formatAlertableKpiSuccessDurationPayload(e,t);i.b.sendToHotPipeline(this._remoteTelemetryUrl,n)}},e.prototype.getApplication=function(){if(this._application)return this._application;var e=i.b.getDimension(this._getKpiDimensions(),"application");return"Unknown"!==e&&(this._application=e),e},e}()},"../office-online-qos/lib/qosRecorder.js":function(e,t,n){n.d(t,"a",(function(){return o}));var i=n("../office-online-qos/lib/utils.js"),r=864e5,o=function(){function e(e){var t=this;this._isEnabled=!1,this._qosErrors=new Map,this._qosPillars=new Set,this._application="",this.recordPillarToWarmTimerId=0,this.recordPillarToWarmIntervalMs=r,this._recordToWarmPipeline=null,this._downloadOtelLibrary=null,this.formatQosErrorPayload=function(e){var n={};n.qosDimensions=i.b.convertStringMapToObject(t._getQosDimensions());var r=new Map;e&&e.errorName&&r.set(e.errorName,e),n.errors=i.b.convertQosErrorToObject(r),n.sessionPillars=i.b.convertStringSetToArray(t._qosPillars);var o={type:"qos_error"};return o.payloadJson=JSON.stringify(n),JSON.stringify(o)},e?(e.remoteTelemetryUrl&&(this._remoteTelemetryUrl=e.remoteTelemetryUrl),this._vetoClassifier=e.vetoClassifier,this._isEnabled=e.isEnabled,e.getQosDimensions?this._getQosDimensions=e.getQosDimensions:this._getQosDimensions=function(){return new Map},this.recordPillarToWarmIntervalMs=e.recordPillarToWarmIntervalMs&&e.recordPillarToWarmIntervalMs>0?e.recordPillarToWarmIntervalMs:r):this._getQosDimensions=function(){return new Map},this._addPillarObservers=[],this._sessionEndingErrorObservers=[]}return e.prototype.registerAddPillarObserver=function(e){e&&this._addPillarObservers.push(e)},e.prototype.registerSessionEndingErrorObserver=function(e){e&&this._sessionEndingErrorObservers.push(e)},e.prototype.removeAddPillarObserver=function(e){e&&(this._addPillarObservers=this._addPillarObservers.filter((function(t){return t!==e})))},e.prototype.removeSessionEndingErrorObserver=function(e){e&&(this._sessionEndingErrorObservers=this._sessionEndingErrorObservers.filter((function(t){return t!==e})))},e.prototype.setHandlerForWarmPipeline=function(e){e&&(this._recordToWarmPipeline=e)},e.prototype.setHandlerForOtelLibraryLoader=function(e){e&&(this._downloadOtelLibrary=e)},e.prototype.recordError=function(e,t,n,r,o,a,s){if(this._isEnabled){var l=null;if(this._qosErrors&&e&&t){if(this._qosErrors.has(e))(l=this._qosErrors.get(e))&&(l.count+=1,this._qosErrors.set(e,l));else{for(var u=[],c=0,p=t;c<p.length;c++){var d=p[c];if(this._vetoClassifier){var h=this._vetoClassifier.getVeto(d);h&&u.push(h)}}l={errorName:e,isIntentional:n||!1,isInternal:r||!0,alertOnPillar:o||!0,isSessionEndingError:a||!1,vetos:u,count:1},this._qosErrors.set(e,l)}if(l&&(l.durationMs=s&&s.durationMs?s.durationMs:null,l.extendedProperties=s&&s.extendedProperties?s.extendedProperties:null,this.sendQosErrorToHotPipeline(l),l.isSessionEndingError&&(this._downloadOtelLibrary&&this._downloadOtelLibrary(),this._sessionEndingErrorObservers.forEach((function(e){return e()}))),this._recordToWarmPipeline)){var g=i.b.formatEventName(l.errorName,"Qos.Error",this.getApplication()),m=[];l.extendedProperties&&l.extendedProperties.forEach((function(e,t){m.push(new i.a("ExtendedProperties_"+t,"string",e||""))}));for(var _={},f=0,y=this.getPillars();f<y.length;f++){var v=y[f];this.recordPillarToWarmPipeline(v),_[v]=!0}if(l.vetos)for(var S=0,C=l.vetos;S<C.length;S++){var b=C[S];if(b){d=b.getVetoName();var A=b.getPillars();if(A)for(var T=0,w=A;T<w.length;T++){if((v=w[T])&&(_[v]||"VetoMissingClassification"===v)){var I=[new i.a("IsIntentional","boolean",l.isIntentional.toString()),new i.a("IsInternal","boolean",l.isInternal.toString()),new i.a("AlertOnPillar","boolean",l.alertOnPillar.toString()),new i.a("Count","int",l.count.toString()),new i.a("Pillar","string",v),new i.a("Veto","string",d||"")];l.durationMs&&I.push(new i.a("DurationMs","int",l.durationMs.toString())),I=I.concat(m),this._recordToWarmPipeline(g,!1,I)}}}}}}}},e.prototype.addPillar=function(e){e&&this._qosPillars&&(0===this._qosPillars.size&&this.queueRecordPillarToWarmPipeline(),this._qosPillars.has(e)||(this._qosPillars.add(e),this._addPillarObservers.forEach((function(t){return t(e)})),this.recordPillarToWarmPipeline(e)))},e.prototype.getPillars=function(){return i.b.convertStringSetToArray(this._qosPillars)},e.prototype.sendQosErrorToHotPipeline=function(e){if(this._remoteTelemetryUrl){var t=this.formatQosErrorPayload(e);i.b.sendToHotPipeline(this._remoteTelemetryUrl,t)}},e.prototype.recordPillarToWarmPipeline=function(e){if(this._recordToWarmPipeline){var t=i.b.formatEventName(e,"Qos.Pillar",this.getApplication(),!0);this._recordToWarmPipeline(t,!0,[new i.a("Pillar","string",e)])}},e.prototype.queueRecordPillarToWarmPipeline=function(){var e=this;this.recordPillarToWarmTimerId=window.setTimeout((function(){e.recordPillarsToWarmPipelineAndReQueue()}),this.recordPillarToWarmIntervalMs)},e.prototype.recordPillarsToWarmPipelineAndReQueue=function(){var e=this;this._qosPillars&&this._qosPillars.forEach((function(t){t&&e.recordPillarToWarmPipeline(t)})),this.queueRecordPillarToWarmPipeline()},e.prototype.stopRecordPillarToWarmPipelineTimer=function(){this.clearRecordPillarToWarmPipelineTimer()},e.prototype.resumeRecordPillarToWarmPipelineTimer=function(){0===this.recordPillarToWarmTimerId&&this.recordPillarsToWarmPipelineAndReQueue()},e.prototype.clearRecordPillarToWarmPipelineTimer=function(){0!==this.recordPillarToWarmTimerId&&(window.clearTimeout(this.recordPillarToWarmTimerId),this.recordPillarToWarmTimerId=0)},e.prototype.getApplication=function(){if(this._application)return this._application;var e=i.b.getDimension(this._getQosDimensions(),"application");return"Unknown"!==e&&(this._application=e),e},e}()},"../office-online-qos/lib/qosVeto.js":function(e,t,n){n.d(t,"a",(function(){return i}));var i=function(){function e(){}return e.prototype.getPillars=function(){return this._pillars},e.prototype.getVetoName=function(){return this._vetoName},e.prototype.setPillars=function(e){this._pillars=e},e.prototype.setVetoName=function(e){this._vetoName=e},e}()},"../office-online-qos/lib/utils.js":function(e,t,n){n.d(t,"b",(function(){return i})),n.d(t,"a",(function(){return r}));var i=function(){function e(){}return e.convertStringMapToObject=function(e){if(!e)return{};var t={};return e.forEach((function(e,n){n&&(t[n]=e)})),t},e.convertStringSetToArray=function(e){if(!e)return[];var t=[];return e.forEach((function(e){e&&t.push(e)})),t},e.convertQosErrorToObject=function(e){if(!e)return{};var t={};return e.forEach((function(e,n){if(n&&e){var i=[];e.vetos&&e.vetos.forEach((function(e){if(e){var t={};t.vetoName=e.getVetoName(),t.pillars=e.getPillars(),i.push(t)}}));var r={};r.errorName=e.errorName,r.extendedProperties=e.extendedProperties,r.isIntentional=e.isIntentional,r.isInternal=e.isInternal,r.alertOnPillar=e.alertOnPillar,r.vetos=i,r.count=e.count,r.durationMs=e.durationMs,t[n]=r}})),t},e.sendToHotPipeline=function(e,t){if(t)if("undefined"!=typeof navigator.sendBeacon)try{navigator.sendBeacon(e,t)}catch(i){var n;(n=new XMLHttpRequest).open("POST",e),n.send(t)}else(n=new XMLHttpRequest).open("POST",e),n.send(t)},e.formatEventName=function(e,t,n,i){if(i)return"Office."+n+".Online.Health."+t;var r="Unknown"+t;return e&&(r=(r=(r=e.length>0&&!isNaN(Number(e.charAt(0)))?"Unknown"+e:e).replace(/_/g,"")).charAt(0).toUpperCase()+r.slice(1)),"Office."+n+".Online.Health."+t+"."+r},e.getDimension=function(e,t){var n="Unknown";if(e){var i=e.get(t);i&&(n=i)}return n},e}(),r=function(){function e(e,t,n){this._name=e,this._type=t,this._value=n}return e.prototype.getName=function(){return this._name},e.prototype.getValue=function(){return this._value},e.prototype.getType=function(){return this._type},e}()},"./lib/generated/qosWac.gen.js":function(e,t,n){n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return o}));var i,r=n("./lib/qosWacFactory.js");!function(e){e[e.Interruptions=0]="Interruptions",e[e.Open=1]="Open",e[e.Save=2]="Save",e[e.VetoMissingClassification=3]="VetoMissingClassification",e[e.Consumption=4]="Consumption",e[e.Authoring=5]="Authoring",e[e.RealTimeCoauth=6]="RealTimeCoauth"}(i||(i={}));var o=new r.a},"./lib/index.js":function(e,t,n){n.r(t);var i=n("./lib/generated/qosWac.gen.js");n.d(t,"QosPillarName",(function(){return i.a})),n.d(t,"QosWacFactoryGlobal",(function(){return i.b}));var r=n("./lib/qosWacFactory.js");n.d(t,"QosWacFactory",(function(){return r.a}))},"./lib/qosPillar.js":function(e,t,n){n.d(t,"a",(function(){return i}));var i=function(){function e(e){this._pillarName=e}return e.prototype.pillarName=function(){return this._pillarName},e}()},"./lib/qosWacFactory.js":function(e,t,n){n.d(t,"a",(function(){return a}));var i=n("./lib/qosPillar.js"),r=n("./lib/wacVetos.js"),o=n("./lib/wacPillars.js"),a=function(){function e(){this._wacVetos=null}return e.prototype.createQosPillarInstance=function(e){return new i.a(e)},e.prototype.createWacVetosInstance=function(){return null==this._wacVetos&&(this._wacVetos=new r.a),this._wacVetos},e.prototype.createWacPillarsInstance=function(){return new o.a},e}()},"./lib/vetosByPillar.json":function(e){e.exports={Authoring:["SlowEditAction","SlowScrollingSession","SlowTypingSession"],Consumption:["NavigationSlow","SilentFailure","SlideShowACE","SlideShowNavigationSlow","SlideShowOpenSlow","ThumbnailLoadSlow"],Interruptions:["ACE","ClientSideHangs","DismissibleDialog","ExpiredSessions","FailedToFetchLegacyErrorDetails","FellBackToReadOnly","ICE","NonDismissibleDialog","SessionExpired","UnexpectedAppRefresh","WorkingOnIt"],Open:["FileOpenFailed","InteractiveOpenSlow","PerceivedOpenSlow"],RealTimeCoauth:["CoauthGalleryExperienceDegraded","PresenceExperienceDegraded","UserBlockedByOtherUser"],Save:["ClientSideDataLoss","MergeFailure","ServerSideDataLoss"]}},"./lib/wacPillars.js":function(e,t,n){n.d(t,"a",(function(){return r}));var i=n("./lib/generated/qosWac.gen.js"),r=function(){function e(){this._pillars=[i.a[i.a.Open],i.a[i.a.Interruptions],i.a[i.a.Consumption]]}return e.prototype.addPillars=function(e){this._pillars.forEach((function(t){e.addQosPillar(t)}))},e}()},"./lib/wacVetos.js":function(e,t,n){n.d(t,"a",(function(){return o}));var i=n("./lib/generated/qosWac.gen.js"),r=n("../office-online-qos/lib/index.js"),o=function(){function e(){this._vetos=[]}return e.prototype.vetos=function(){if(0===this._vetos.length){var e=n("./lib/vetosByPillar.json");for(var t in e)if(e.hasOwnProperty(t))for(var r=0,o=e[t];r<o.length;r++){var a=o[r];this.addVetoToPillar(a,i.a[t])}}return this._vetos},e.prototype.addVetoToPillar=function(e,t){var n=r.a.prototype.createQosVetoInstance();n.setVetoName(e),n.setPillars([i.a[t]]),this._vetos.push(n)},e}()}}),S=n(536),C=n(397),b=n(255),A=n(809),T=n(461),w=n(456),I=n(219),E=n(652),k=n(218),D=n(867),M=n(132),P=n(265),F=n(699),x=function(){return function(){this.name=null,this.platform=null,this.version=null,this.osVersion=null,this.osBuild=null,this.sessionId=null,this.host=null,this.serverDocId=null,this.datacenter=null,this.isSynthetic=null,this.applicationMode=null,this.applicationModeExtended=null,this.flights=null,this.flightsImpressionId=null,this.ring=null,this.audienceGroup=null,this.loggableUserId=null,this.loggableUserIdSpace=null,this.isAnonymousUser=null,this.isBusinessUser=null,this.isEduUser=null,this.omsTenantId=null,this.browserName=null,this.browserVersion=null,this.browserLanguage=null,this.appLanguage=null,this.contentLanguage=null,this.uiHost=null}}();(0,h.l)(x,"AlwaysOnMetadata",null,[]);var R=function(){return function(){this.otelUseOneDsSink=null,this.eventUploadFrequency=null,this.wacAriaThrottlingIsEnabled=!1,this.wacAriaTotalEventsThrottlePerSec=0,this.wacAriaSingleEventThrottlePerSec=0,this.otelEventNamesToBeSuppressedCommaSeparated=null,this.ariaEndpointTarget=null,this.periodicStatsLogFrequency=null,this.oneDsTaskDurationLogThreshold=null}}();(0,h.l)(R,"OtelBRSValues",null,[]);var B=n(508),L=function(){return function(){this.ulsLogger=null,this.sendToUls=!1,this.enableAdditionalDiagnosticTracing=null}}();(0,h.l)(L,"LoggingSettings",null,[]);var N=function(e){function t(){var t=e.call(this)||this;return t.sendToAria=!1,t.alwaysOnMetadata=null,t.cacheMemorySizeLimitInNumberOfEvents=null,t.otelBRSValues=null,t}return(0,B.t)(t,e),t}(L);(0,h.l)(N,"TelemetrySettings",L,[]);var U=n(957),O=function(){function e(){}return e.get_metricsLogged=function(){return e.metricsLogged},e.isEnabledCheckAppInitStatusBeforeOtelFullDownload=function(t){var n=!1;switch(t){case"word":case"onenote":case"powerpoint":case"visio":n=e.appSettingsManager.getBooleanAppSetting("OtelFullJsDelayLoadAfterAppLoadedSuccessfullyEnabled");break;case"excel":n=!0}return n},e.getAppInitializationStatusToWaitForInViewMode=function(t){var n=7;switch(t){case"onenote":case"excel":n=7;break;case"word":case"powerpoint":case"visio":n=8}var i=e.sessionStartInfoSettings.ApplicationModeExtended;return i&&"embed_view"===i.toLowerCase()&&(n=8),n},e.getAppInitializationStatusToWaitForInEditMode=function(t){var n=7;switch(t){case"word":case"onenote":case"powerpoint":n=7;break;case"excel":n=e.appSettingsManager.getBooleanAppSetting("FlushBootMetricsToOtelIsEnabled")?8:4;break;case"visio":n=8}return n},e.getAppInitializationStatusToWaitFor=function(t){var n=e.sessionStartInfoSettings.ApplicationMode,i=n?n.toLowerCase():"";return"view"===i?e.getAppInitializationStatusToWaitForInViewMode(t):"slideshow"===i||"broadcast_view"===i?8:e.getAppInitializationStatusToWaitForInEditMode(t)},e.getOtelDownloadSafetyTimerDelayMs=function(){e._otelDownloadSafetyTimerDelayMsMainAppModes=e.appSettingsManager.getIntAppSetting("OtelDownloadSafetyTimerDelayMsMainAppModes",0),e._otelDownloadSafetyTimerDelayMsNonMainAppModes=e.appSettingsManager.getIntAppSetting("OtelDownloadSafetyTimerDelayMsNonMainAppModes",3e3);var t=e._otelDownloadSafetyTimerDelayMsNonMainAppModes,n=e.sessionStartInfoSettings.ApplicationMode;if(n)switch(n=n.toLowerCase()){case"view":case"edit":case"unified":t=e._otelDownloadSafetyTimerDelayMsMainAppModes;break;default:t=e._otelDownloadSafetyTimerDelayMsNonMainAppModes}return t},e.checkAppInitStatusBeforeOtelFullDownload=function(){window.setTimeout((function(){e.kickOffOtelFullDownloadCallback()}),e.getOtelDownloadSafetyTimerDelayMs());var t=e.sessionStartInfoSettings.Application||"unknownapp";t=t.toLowerCase(),e.isEnabledCheckAppInitStatusBeforeOtelFullDownload(t)?(b.ULS.sendTraceTag(50622754,383,50,"OtelLibraryLoader:Waiting for {0} to download {1}",T.w[e.getAppInitializationStatusToWaitFor(t)],e.otelFullJSName),e.appLifecycleManager.executeWhen(e.getAppInitializationStatusToWaitFor(t),e.kickOffOnDemandFullDownload)):(b.ULS.sendTraceTag(50622755,383,50,"OtelLibraryLoader:NOT waiting for any app initialization status to download {0}",e.otelFullJSName),e.kickOffOtelFullDownload()),e.appSettingsManager.getBooleanAppSetting("OtelTriggerDemandLoadIsEnabled")&&e.appLifecycleManager.executeWhen(13,e.kickOffOtelFullDownload)},e.kickOffOtelFullDownloadCallback=function(){e.kickOffOtelFullDownloadCallMade||(b.ULS.sendTraceTag(50622784,383,15,"KickOffOtelFullDownload was called from safety callback[{0}]",e.getAppDetails()),e.kickOffOtelFullDownload())},e.kickOffOnDemandFullDownload=function(){e.kickOffOtelFullDownloadCallMade||(b.ULS.sendTraceTag(50622785,383,50,"OtelFull download was demand initiated [{0}]",e.getAppDetails()),e.kickOffOtelFullDownload())},e.flushBootMetricsToOtel=function(){try{if(e.metricsLogged=!1,e.pageLoadPerfRecorder.logTelemetry(),!e.appSettingsManager.getBooleanAppSetting("FlushBootMetricsToOtelIsEnabled"))return;e.pageLoadPerfRecorder.computeAndAddDurationMetrics();new Array(0);var t=D.b(e.appSettingsManager.get_appSettings().SessionStartInfoJson.toString()),n=(0,A.m)(new U.e,{extendedProperties:new Map});n.extendedProperties.set("SessionOrigin",t.SessionOrigin);var i=e.pageLoadPerfRecorder.get_pageLoadPerfMetrics();for(var r in i){var o={key:r,value:i[r]};try{if(Object.getType(o.value)===Boolean)n.extendedProperties.set(o.key,o.value.toString());else if(n.extendedProperties.set(o.key,Object.getType(o.value)===Object?D.w(o.value):o.value.toString()),o.key===I.c.eupl){var a=Number.parseInvariant(o.value.toString());!isNaN(a)&&a>0&&(n.durationMs=a)}}catch(e){n.extendedProperties.set(o.key,"")}}w.Health.get_instance().recordKpiUsageForAlertableKpi("BootPerf","wacbootmonitoring",null),w.Health.get_instance().recordKpiSuccess("BootPerf",n),e.metricsLogged=!0}catch(e){b.ULS.sendTraceTag(594137291,383,15,"Failed to send boot metrics to Otel"+e.toString())}},e.kickOffOtelFullDownload=function(){if(!e.kickOffOtelFullDownloadCallMade){e.kickOffOtelFullDownloadCallMade=!0;var t=e.appSettingsManager.getBooleanAppSetting("OtelPipelineIsEnabled");if(F.k.setEnabledState(t),t){b.ULS.sendTraceTag(50622787,383,50,"Otel pipeline is enabled [{0}]",e.getAppDetails());var n=P.v.create(l.AFrameworkApplication.scriptUrlFromName(e.otelFullJSName,5));n.add_loadFinished(e.onOtelFullLoadFinished),k.z.enqueueResourceWithoutEnabling(n),e.flushBootMetricsToOtel()}else b.ULS.sendTraceTag(50622786,383,50,"Otel pipeline is disabled [{0}]!",e.getAppDetails())}},e.onOtelFullLoadFinished=function(t,n){if(!n.get_succeeded())return F.k.setEnabledState(!1),void b.ULS.sendTraceTag(50622788,383,10,"Failed to load {0} from {1}",e.otelFullJSName,n.get_resourceUrl());b.ULS.sendTraceTag(50622789,383,50,"Successfully loaded {0} from {1}",e.otelFullJSName,n.get_resourceUrl()),e.tryInitializeOtelFull()&&F.k.registerEventHandler((function(e){otelFull.TelemetryFullGlobal.processTelemetryEvent(e)}))},e.tryInitializeOtelFull=function(){try{var t=(0,c.e)(String,e.sessionStartInfoSettings.Os);if(t){var n=(0,c.e)(String,e.sessionStartInfoSettings.OsVersion);n&&(t+="("+n+")")}var i=(0,A.m)(new x,{name:(0,c.e)(String,e.sessionStartInfoSettings.Application)||"",platform:"Web",version:(0,c.e)(String,l.AFrameworkApplication.buildVersion||e.sessionStartInfoSettings.WFEVersion)||"",osVersion:t||"",sessionId:(0,c.e)(String,e.sessionStartInfoSettings.WACSessionID)||"",flightsImpressionId:(0,c.e)(String,e.sessionStartInfoSettings.FlightsImpressionId)||"",audienceGroup:(0,c.e)(String,e.sessionStartInfoSettings.AudienceGroup)||"",browserName:(0,c.e)(String,e.sessionStartInfoSettings.Browser)||"",browserVersion:(0,c.e)(String,e.sessionStartInfoSettings.BrowserVersion)||"",appLanguage:(0,c.e)(String,e.sessionStartInfoSettings.ApplicationLCID)||"",host:(0,c.e)(String,e.sessionStartInfoSettings.Host)||"",uiHost:(0,c.e)(String,e.sessionStartInfoSettings.UiHost)||"",serverDocId:(0,c.e)(String,e.sessionStartInfoSettings.ServerDocId)||"",datacenter:(0,c.e)(String,e.sessionStartInfoSettings.WACDatacenter)||"",isSynthetic:Boolean.parse(e.sessionStartInfoSettings.IsSynthetic||"false"),applicationMode:(0,c.e)(String,e.sessionStartInfoSettings.ApplicationMode)||"",applicationModeExtended:(0,c.e)(String,e.sessionStartInfoSettings.ApplicationModeExtended)||"",browserLanguage:(0,c.e)(String,e.sessionStartInfoSettings.BrowserLCID)||"",contentLanguage:(0,c.e)(String,e.sessionStartInfoSettings.DataCulture)||"",ring:(0,c.e)(String,e.sessionStartInfoSettings.Ring)||"-1",loggableUserId:e.appSettingsManager.getStringAppSetting("LoggableUserId")||"",loggableUserIdSpace:e.appSettingsManager.getStringAppSetting("LoggableUserIdSpace")||"",isAnonymousUser:Boolean.parse(e.appSettingsManager.getStringAppSetting("IsAnonymousUser")||"false"),isBusinessUser:"OrgIdPuid"===e.appSettingsManager.getStringAppSetting("LoggableUserIdSpace")||!!e.sessionStartInfoSettings.IsBusinessUser,isEduUser:!!e.sessionStartInfoSettings.IsEduUser,omsTenantId:e.appSettingsManager.getStringAppSetting("TenantId")||"",flights:l.AFrameworkApplication.flightId?l.AFrameworkApplication.flightId.split(";"):new Array(0)});""===i.name||""===i.applicationMode||""===i.sessionId||""===i.loggableUserId||""===i.loggableUserIdSpace||""===i.audienceGroup||""===i.host||""===i.datacenter||"-1"===i.ring||""===i.omsTenantId?b.ULS.sendTraceTag(594903131,383,15,"Otel AlwaysOnMetadata Missing! AppName: "+(""!==i.name?i.name:"N")+", ApplicationMode: "+(""!==i.applicationMode?i.applicationMode:"N")+", SessionId: "+(""!==i.sessionId?"Y":"N")+", LoggableUserIdSpace: "+(""!==i.loggableUserIdSpace?"Y":"N")+", LoggableUserId: "+(""!==i.loggableUserId?"Y":"N")+", AudienceGroup: "+(""!==i.audienceGroup?"Y":"N")+", Host: "+(""!==i.host?"Y":"N")+", Datacenter: "+(""!==i.datacenter?"Y":"N")+", Ring: "+("-1"!==i.ring?"Y":"N")+", OmsTenantId: "+(""!==i.omsTenantId?"Y":"N")):b.ULS.sendTraceTag(594903130,383,50,"Otel AlwaysOnMetadata Good!");var r=null;M.d((function(){r=new E.s}));var o=(0,A.m)(new N,{sendToAria:!0,sendToUls:!1,ulsLogger:r,alwaysOnMetadata:i,otelBRSValues:e.getOtelBRSSettings()});return e.appSettingsManager.getBooleanAppSetting("OtelPipelineExperimentalFeaturesEnabled")&&(o.sendToAria=e.appSettingsManager.getBooleanAppSetting("OtelPipelineSendEventsToAria"),o.sendToUls=e.appSettingsManager.getBooleanAppSetting("OtelPipelineSendEventsToULS"),o.alwaysOnMetadata=e.appSettingsManager.getBooleanAppSetting("OtelPipelineAppendAlwaysOnMetadataToEveryEvent")?i:null),e.isOtelFullAvailable()?(otelFull.TelemetryFullGlobal.initialize(o),b.ULS.sendTraceTag(50622791,383,50,"Success OtelFullAvailable"),!0):(b.ULS.sendTraceTag(50622792,383,10,"We thought we had downloaded the otel js content but something went wrong because otelFull isn't actually available"),!1)}catch(e){b.ULS.sendTraceTag(50622793,383,10,"Failed in TryInitializeOtelFull: "+e)}return!1},e.getOtelBRSSettings=function(){var t=new R;return t.wacAriaThrottlingIsEnabled=e.appSettingsManager.getBooleanAppSetting("WACAriaThrottlingIsEnabled"),t.wacAriaTotalEventsThrottlePerSec=e.appSettingsManager.getIntAppSetting("WACAriaTotalEventsThrottlePerSec",100),t.wacAriaSingleEventThrottlePerSec=e.appSettingsManager.getIntAppSetting("WACAriaSingleEventThrottlePerSec",20),t.otelEventNamesToBeSuppressedCommaSeparated=e.appSettingsManager.getStringAppSetting("WACAriaEventNamesToBeSuppressedCommaSeparated"),t.ariaEndpointTarget=e.appSettingsManager.getStringAppSetting("AriaEndpointTarget"),t.otelUseOneDsSink=e.appSettingsManager.getBooleanAppSetting("OtelPipelineUseNewOneDsSDK"),t.eventUploadFrequency=e.appSettingsManager.getIntAppSetting("OtelPipelineEventUploadFrequency",2e3),t.periodicStatsLogFrequency=e.appSettingsManager.getIntAppSetting("OtelPipelinePeriodicStatsLogFrequency",12e4),t.oneDsTaskDurationLogThreshold=e.appSettingsManager.getIntAppSetting("OtelPipelineOneDsTaskDurationLogThreshold",100),b.ULS.sendTraceTag(595076676,383,50,"[{0}] Otel is using '{1}' SDK",e.getAppDetails(),l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OtelPipelineUseNewOneDsSDK")?"NEW 1DS":"Legacy Aria"),t},e.isOtelFullAvailable=function(){return"undefined"!=typeof otelFull},e.getAppDetails=function(){return String.format("{0}, {1}, {2}",e.sessionStartInfoSettings.Application,e.sessionStartInfoSettings.ApplicationMode,e.sessionStartInfoSettings.ApplicationModeExtended)},e.appSettingsManager=null,e.sessionStartInfoSettings=null,e.appLifecycleManager=null,e.pageLoadPerfRecorder=null,e.otelFullJSName="otelFull.min.js",e.kickOffOtelFullDownloadCallMade=!1,e._otelDownloadSafetyTimerDelayMsMainAppModes=3e4,e._otelDownloadSafetyTimerDelayMsNonMainAppModes=3e3,e.metricsLogged=!1,e}();(0,h.l)(O,"OtelLibraryLoaderHelper",null,[]);var H=n(564),W=n(266),V=function(){function e(){}return e.prototype.get_name=function(){return"Common.App.OtelLibraryLoader"},e.prototype.configure=function(e){},e.prototype.init=function(){b.ULS.sendTraceTag(38836106,383,50,"OtelLibraryLoader:Init");var e=function(){O.appSettingsManager=l.AFrameworkApplication.appSettingsManager,O.sessionStartInfoSettings=l.AFrameworkApplication.sessionStartInfoSettings,O.appLifecycleManager=y.r.get_instance(),O.pageLoadPerfRecorder=W.e.get_instance(),O.checkAppInitStatusBeforeOtelFullDownload()};try{y.r.get_instance().isCompleted(13)&&e()}catch(e){b.ULS.sendTraceTag(594564771,383,10,"Failed to initialize OTelJS after a session ending error: "+e)}l.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){b.ULS.sendTraceTag(38836107,383,50,"OtelLibraryLoader:FullAppSettingsReady"),e()})),l.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsFailed((function(){b.ULS.sendTraceTag(38836108,383,10,"OtelLibraryLoader:Failed to get FullAppSettings"),e()}))},e.prototype.dispose=function(){},e.main=function(){H.o.get_instance().registerPackage(new e)},e}();(0,h.l)(V,"OtelLibraryLoaderPackage",null,[S.u,C.s]);var $=n(553),K=function(){function e(){}return e.prototype.get_name=function(){return"Common.App.BrowserInfoLogger"},e.prototype.configure=function(e){},e.prototype.init=function(){$.p()},e.prototype.dispose=function(){},e.main=function(){H.o.get_instance().registerPackage(new e)},e}();(0,h.l)(K,"BrowserInfoLoggerPackage",null,[S.u,C.s]);var z=n(64),q=(0,h.y)("IJavascriptErrorReporter"),Q=function(){function e(){this.Message=null,this.File=null,this.Line=0,this.Column=0,this.Stack=null,this.ClientAppVersion=null,this.AppType=0,this.AppMode=0,this.DeobfuscateWithSourceMaps=!1,this.SessionStartInfoJson=null,this.DataPlumber=null,this.IsShuttingDown=!1,this.Flight=null}return e.prototype.serialization=function(){return D.w(this)},e}();(0,h.l)(Q,"DiagnosticsRequest",null,[]);var G=n(723),j=n(556),Z=function(){function e(e,t,n,i,r){this._webServiceUrl=null,this._appVersion=null,this._appType=0,this._appMode=0,this._isGoogleClosureEnabled=!1,this._webServiceUrl=e,this._appVersion=t,this._appType=n,this._appMode=i,this._isGoogleClosureEnabled=r}return e.prototype.sendReport=function(e,t){try{this.createHttpRequest().send(this.generateReport(e,t))}catch(e){b.ULS.sendTraceTag(6161306,201,10,"Could not send error report [{0}]",e.toString())}},e.prototype.createHttpRequest=function(){var e=new XMLHttpRequest;if(e.open("POST",this._webServiceUrl,!0),e.setRequestHeader("Content-Type","text/json; charset=utf-8"),l.AFrameworkApplication.userSessionId&&e.setRequestHeader(G.h.userSessionIdHeaderName,j.l.httpHeaderEncode(l.AFrameworkApplication.userSessionId)),this._appVersion&&e.setRequestHeader(G.h.officeVersionHeaderName,this._appVersion),l.AFrameworkApplication.theClientRequestManager){var t=l.AFrameworkApplication.theClientRequestManager.get_wacClusterId();t&&e.setRequestHeader(G.h.wacClusterHeaderName,t)}return e},e.prototype.generateReport=function(e,t){if(!e)return null;t=t?"<stack>"+t+"</stack>":"";var n=new Q;if(n.Message=e.message,n.File=e.source,n.Line=e.line,n.Column=e.column,n.Stack=t,n.ClientAppVersion=this._appVersion,n.AppType=this._appType,n.AppMode=this._appMode,n.DeobfuscateWithSourceMaps=this._isGoogleClosureEnabled,l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("JavaScriptCrashJsonTagEnabled")){var i=l.AFrameworkApplication.appSettingsManager.get_appSettings().SessionStartInfoJson||"";n.SessionStartInfoJson=i,l.AFrameworkApplication.dataPlumber&&(n.DataPlumber=D.w(l.AFrameworkApplication.dataPlumber)),n.IsShuttingDown=l.AFrameworkApplication.isShuttingDown,n.Flight=l.AFrameworkApplication.flightId}return n.serialization()},e}();(0,h.l)(Z,"JavascriptErrorReporter",null,[q]);var X=function(){function e(){}return e.prototype.build=function(e,t,n,i,r){return new Z(e,t,n,i,r)},e}();(0,h.l)(X,"JavascriptErrorReporterFactory",null,[z.z]);var J=function(){function e(){}return e.prototype.configure=function(e){e.register(X).as(z.z).singleInstance().usingFactory((function(){return new X}))},e.prototype.get_name=function(){return"Common.App.Diagnostics"},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){H.o.get_instance().registerPackage(new e)},e}();(0,h.l)(J,"DiagnosticsPackage",null,[S.u,C.s]);var Y=(0,h.y)("IUpsellActor"),ee=(0,h.y)("IChatManager"),te=n(406),ne=n(36),ie=n(574),re=n(78),oe=function(){function e(e){this._reactSharedHeaderFocusManager=null,this._previousNumberOfChats=0,this._chatContainerId=null,this._reactSharedHeaderFocusManager=e}return e.prototype.get_chat=function(){return window.swc},e.prototype.get_isInitialized=function(){return!!this.get_chat()},e.prototype.get_sharedHeaderFocusManager=function(){return this._reactSharedHeaderFocusManager.get_value()},e.prototype.registerActions=function(){this.get_isInitialized()?this.registerActionsInternal():this.registerOnChatReady(h.i(this,this.registerActionsInternal,"registerActionsInternal"))},e.prototype.registerActionsInternal=function(){var e=this;b.ULS.sendTraceTag(50595938,333,50,"Registering for chat events");try{this.get_isInitialized()&&(this.get_chat().getContainerProvider().then((function(t){t.getChatsContainer(h.i(e,e.onChatContainerReady,"onChatContainerReady"))})).catch((function(e){b.ULS.sendTraceTag(50960143,333,10,"Failed to register for chat container {0}",e)})),this.get_chat().getChatsCounter().then((function(t){t.onChatsCountChange(h.i(e,e.chatCountChanged,"chatCountChanged"))})).catch((function(e){b.ULS.sendTraceTag(50595939,333,10,"Failed to register chat counter callback {0}",e)})),this.get_chat().getKeyboard().then((function(t){t.onKeyDown(h.i(e,e.onChatKeyPress,"onChatKeyPress"))})).catch((function(e){b.ULS.sendTraceTag(50595968,333,10,"Failed to register chat ctrlF6 callback {0}",e)})))}catch(e){b.ULS.sendTraceTag(50595969,333,10,"Failed to register chat events: {0}",e)}},e.prototype.chatCountChanged=function(e){if(b.ULS.sendTraceTag(50595970,333,50,"Chat count:{0}",e),e){if(1===e&&!this._previousNumberOfChats){var t=document.getElementById(this._chatContainerId?this._chatContainerId:re.r.chatFocusId);t?this.get_sharedHeaderFocusManager().onChatOpen(t,h.i(this,this.transferFocusToChat,"transferFocusToChat")):b.ULS.sendTraceTag(50595971,333,10,"Chat parent is null")}}else this.get_sharedHeaderFocusManager().onChatClose();this._previousNumberOfChats=e},e.prototype.onChatContainerReady=function(e){this._chatContainerId=e},e.prototype.onChatKeyPress=function(e){e.ctrlKey&&"f6"===e.key.toLowerCase()&&this.transferFocusFromChat(e.shiftKey)},e.prototype.registerOnChatReady=function(e){ne.z.get_instance().registerHandler(ie.d.swcReady,window.self,(function(t){return e(),!0}))},e.prototype.transferFocusToChat=function(){b.ULS.sendTraceTag(50595972,333,50,"Transferring focus to chat");try{this.get_isInitialized()&&this.get_chat().getFocuser().then((function(e){e.focusConversationInput()})).catch((function(e){b.ULS.sendTraceTag(50595973,333,10,"Failed to transfer focus to chat: {0}",e)}))}catch(e){b.ULS.sendTraceTag(50595974,333,10,"Failed to transfer focus to chat: {0}",e)}},e.prototype.transferFocusFromChat=function(e){b.ULS.sendTraceTag(50595975,333,50,"Transferring focus from chat"),this.get_sharedHeaderFocusManager().onChatCtrlF6(e)},e}();(0,h.l)(oe,"ChatManager",null,[ee]);var ae=n(721),se=n(614),le=n(751),ue=n(197),ce=n(66),pe=n(749),de=function(){function e(e,t,n,i,r){this._focusManager=null,this._f6Manager=null,this._mouseInputManager=null,this._touchInputManager=null,this._actionManager=null,this._transferFocusToChat=null,this._focusManager=e,this._f6Manager=t,this._mouseInputManager=n,this._touchInputManager=i,this._actionManager=r}return e.prototype.registerF6=function(e,t,n,i){void 0===i&&(i=null);var r=this._focusManager.getScope(t);r.parent=n,r.set_keyDownHandledExternally(!0),i&&r.addOnFocus(i),this._mouseInputManager.addControlFocus(t,e,!1),this._touchInputManager.addControlFocus(t,e,!1);var o=new ue.DOMFocusListing((function(){return e}));o.addValidTag(2),o.addValidTag(1),o.addValidTag(8),o.addValidTag(5),o.addValidTag(3),o.addValidTag(6),this._focusManager.buildRegionWithDelegate((function(){return e}),r,o).looped=!0;var a=pe.KeyInputManager.hashKey(ce.v.vK_Tab,0),s=pe.KeyInputManager.hashKey(ce.v.vK_Tab,4);r.unBindAction(a),r.unBindAction(s)},e.prototype.onFlexPaneOpen=function(e){this.registerF6(e,re.r.meControlFlexPaneFocusId,re.r.headerUiFocusId),this._focusManager.setScope(re.r.meControlFlexPaneFocusId),this._f6Manager.addF6(re.r.meControlFlexPaneFocusId)},e.prototype.onFlexPaneClose=function(e){this._f6Manager.deactivateFocus(re.r.meControlFlexPaneFocusId),this._focusManager.setScope(re.r.headerUiFocusId)},e.prototype.onChatOpen=function(e,t){this._transferFocusToChat||(this._transferFocusToChat=t,this.registerF6(e,re.r.chatFocusId,le.AFrame.appFocusId,h.i(this,this.onChatFocus,"onChatFocus"))),this._focusManager.setScope(re.r.chatFocusId),this._f6Manager.addF6(re.r.chatFocusId)},e.prototype.onChatFocus=function(e,t){this._transferFocusToChat&&this._transferFocusToChat()},e.prototype.onChatClose=function(){this._f6Manager.deactivateFocus(re.r.chatFocusId),this._focusManager.forceScopeChange(le.AFrame.documentFocusID)},e.prototype.onChatCtrlF6=function(e){this._actionManager.processAction(e?se.Rh:se.UT,2)},e}();(0,h.l)(de,"ReactSharedHeaderFocusManager",null,[te.f]);var he=n(233),ge=n(722),me=n(204),_e=n(851),fe=n(235),ye=n(984),ve=function(){function e(e){this._actionManager=null,this._actionManager=e}return e.prototype.registerActions=function(){this._actionManager.addAction(se.Mg,ye.a,h.i(this,this.navigateToUpsellPage,"navigateToUpsellPage")),this._actionManager.addAction(se.Nk,ye.a,h.i(this,this.launchUpsellExperience,"launchUpsellExperience")),this._actionManager.addAction(se.KD,ye.a,ge.ActionManager.doNothingButReportHandler),this._actionManager.addAction(se.J,ye.a,ge.ActionManager.doNothingButReportHandler)},e.prototype.navigateToUpsellPage=function(e,t,n,i,r){if(1===n)return 32;var o=8;if(2===n){var a=this.getCommandArgument(r,"experience","gopremiumribbon"),s=_e.n.getFwLinkUrl("2116536");s=_e.n.addParameterValue(s,"ocid",me.x(a)),window.open(s,"_blank"),o=32,this._actionManager.processAction(se.J,2),b.ULS.sendTraceTag(38929747,340,50,"User directed to POC")}return o},e.prototype.launchUpsellExperience=function(e,t,n,i,r){if(1===n)return 32;var o=8;if(2===n){var a=fe.w.get_instance().tryResolve(he.a);if(a){var s=this.getCommandArgument(r,"experience","gopremium");a.launchUpsellExperience(s),o=32}else b.ULS.sendTraceTag(594874952,340,15,"ApplicationFeatureHelper not available"),o=this.navigateToUpsellPage(e,t,n,i,r)}return o},e.prototype.getCommandArgument=function(e,t,n){var i=n,r=e;return r&&r[t]&&(i=(0,c.e)(String,r[t])),i},e}();(0,h.l)(ve,"UpsellActor",null,[Y]);var Se=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.Header"},e.prototype.init=function(){fe.w.get_instance().resolve(Y).registerActions(),fe.w.get_instance().resolve(ee).registerActions()},e.prototype.dispose=function(){},e.prototype.configure=function(e){var t=this;this._container=e,this._container.register(ae.p).singleInstance(),this._container.register(ve).as(Y).singleInstance().usingFactory((function(){return new ve(l.AFrameworkApplication.get_theActionManager())})),this._container.register(de).as(te.f).singleInstance().usingFactory((function(){return new de(l.AFrameworkApplication.get_activeFrame().get_theFocusManager(),l.AFrameworkApplication.get_activeFrame().get_theF6Manager(),l.AFrameworkApplication.get_activeFrame().get_theMouseInputManager(),l.AFrameworkApplication.get_activeFrame().get_theTouchInputManager(),l.AFrameworkApplication.get_theActionManager())})),this._container.register(oe).as(ee).singleInstance().usingFactory((function(){return new oe(t._container.resolveLazy(te.f))}))},e.main=function(){H.o.get_instance().registerPackage(new e)},e}();(0,h.l)(Se,"CommonAppHeaderPackage",null,[S.u,C.s]);var Ce=n(430),be=n(17),Ae=n(355),Te=n(879),we=function(){function e(e,t,n){this._appSettingsManager=null,this._hostPostMessengerFuture=null,this._supportedHostActions={},this._appSettingsManager=e,this._hostPostMessengerFuture=n,this.loadSupportedHostActions(),this.registerActionListener(t)}return e.prototype.loadSupportedHostActions=function(){var e=this;this._appSettingsManager.getBooleanAppSetting("DocRebootIsSupported")&&(this._supportedHostActions[Te.y.refresh]=function(){return e.sendPostMessageForAction(Ae.a.documentRefresh)})},e.prototype.registerActionListener=function(e){e.addAction(se.HU,ye.a,h.i(this,this.sendActionToHostIfSupported,"sendActionToHostIfSupported"))},e.prototype.sendActionToHostIfSupported=function(e,t,n,i,r){if(2!==n)return 32;if(!r)return b.ULS.sendTraceTag(41972610,204,15,"HostActionExecutionManager - No actionData provided"),16;var o=r.toLowerCase();return this._supportedHostActions[o]?(b.ULS.sendTraceTag(41972611,204,50,"HostActionExecutionManager - executing host action for action id {0}",o),this._supportedHostActions[o]()):2},e.prototype.sendPostMessageForAction=function(e){return this._hostPostMessengerFuture.execute((function(t){t.sendMessageWithRetry(e,{})})),32},e}();(0,h.l)(we,"HostActionExecutionManager",null,[]);var Ie=n(407),Ee=n(603),ke=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.Postmessengers"},e.prototype.init=function(){var e=this;l.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){e.initHostPostmessenger(e._container)}))},e.prototype.initHostPostmessenger=function(e){l.AFrameworkApplication.hostPostmessenger=e.resolve(Ie.q),l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("HostActionExecutionIsEnabled")&&e.resolve(we)},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,e.register(Ie.q).as(Ce.i).singleInstance().usingFactory((function(){l.AFrameworkApplication.appSettingsManager.get_isFullAppSettingsReady()||b.ULS.sendTraceTag(5886165,204,10,"HostIntegrationMessenger instantiated before full app settings ready");var e=l.AFrameworkApplication.postMessageOrigin?l.AFrameworkApplication.postMessageOrigin:Ee.c.anyDomain;return new Ie.q(window.parent,e,be.i.get_instance(),l.AFrameworkApplication.get_theActionManager())})),e.register(we).singleInstance().usingFactory((function(){return l.AFrameworkApplication.appSettingsManager.get_isFullAppSettingsReady()||b.ULS.sendTraceTag(41972612,204,10,"HostSupportedActionManager instantiated before full app settings ready"),new we(l.AFrameworkApplication.appSettingsManager,l.AFrameworkApplication.get_theActionManager(),e.resolveFuture(Ce.i))}))},e}();(0,h.l)(ke,"PostmessengersPackage",null,[S.u,C.s]);var De=n(864),Me=function(){function e(){}return e.prototype.get_name=function(){return"Common.App.DialogWithLinkToResource"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){},e.main=function(){H.o.get_instance().registerPackage(new e)},e}();(0,h.l)(Me,"CommonAppDialogWithLinkToResourcePackage",null,[S.u,C.s]);var Pe=(0,h.y)("IZoomDialogFactory"),Fe=n(686),xe=function(){function e(){this._dialog=null}return e.prototype.create=function(e,t,n,i){return this._dialog=new Fe.j(e,t,n,i),this._dialog},e}();(0,h.l)(xe,"ZoomDialogFactory",null,[Pe]);var Re=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"Common.App.Zoom"},e.prototype.init=function(){},e.prototype.dispose=function(){},e.prototype.configure=function(e){this._container=e,this._container.register(xe).as(Pe).usingFactory((function(){return new xe})).singleInstance()},e.main=function(){H.o.get_instance().registerPackage(new e)},e}();(0,h.l)(Re,"ZoomPackage",null,[S.u,C.s]);var Be=n(606),Le=n(481),Ne=function(){function e(t){this.isEnabled=!1,this.isProbeEnabled=!1,this.isInternetExplorerEnabled=!1,this.supportedMimeTypes=null,this.supportedPlugins=null,this.immersivePreviewPlugins=null,this.isEdgeEnabled=!1,this.minEdgeMajorVersion=0,this.minEdgeMinorVersion=0,this.isChromePrintLayoutFixEnabled=!1,this.chromeVersionFromWhichPrintLayoutIsEnabled=0,this.isEnabled=Boolean.parse(t.DirectPrintIsEnabled||"false"),this.isProbeEnabled=Boolean.parse(t.DirectPrintProbeIsEnabled||"false"),this.isInternetExplorerEnabled=Boolean.parse(t.DirectPrintEnabledForInternetExplorer||"false"),this.supportedMimeTypes=(t.DirectPrintSupportedMimeTypes||"").split(e.directPrintBRSDelimeter),this.supportedPlugins=(t.DirectPrintSupportedPlugins||"").split(e.directPrintBRSDelimeter),this.immersivePreviewPlugins=(t.DirectPrintImmersivePreviewPlugins||"").split(e.directPrintBRSDelimeter),this.isEdgeEnabled=Boolean.parse(t.DirectPrintEnabledForEdge||"false"),this.isChromePrintLayoutFixEnabled=Boolean.parse(t.ChromePrintLayoutFixIsEnabled||"false"),this.chromeVersionFromWhichPrintLayoutIsEnabled=parseInt(t.ChromeVersionFromWhichPrintLayoutIsEnabled||"76"),this.minEdgeMajorVersion=14,this.minEdgeMinorVersion=14394;var n=t.DirectPrintMinimalSupportedEdgeVersion;if(n){var i=n.split(".");2===i.length?(this.minEdgeMajorVersion=parseInt(i[0]),this.minEdgeMinorVersion=parseInt(i[1])):b.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",n)}else b.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}return e.directPrintBRSDelimeter=",",e}();(0,h.l)(Ne,"DirectPrintBrsSettings",null,[]);var Ue=(0,h.y)("IDirectPrintDialogFactory"),Oe=(0,h.y)("IDirectPrintDialog"),He=n(841),We=n(550),Ve=n(643),$e=n(88),Ke=n(296),ze=n(134),qe=function(e){function t(t,n,i,r){void 0===r&&(r=null);var o=e.call(this)||this;return o._failureLink=null,o._printPreviewPostForm=null,o._sensitiveParameters=null,o._pdfUrl=null,o._mouseInputManager=null,o._hideEmbeddedPdf=!1,o._stopwatch=null,o._pdfObject=null,o._pdfUrl=n,o._mouseInputManager=t,o._hideEmbeddedPdf=i,o._sensitiveParameters=r,o._stopwatch=new $e.q("LoadResource","LoadPrintablePdf"),o}return(0,B.t)(t,e),t.prototype.displayDialog=function(){this.set_buttonsOption(5),this.set_width(40);var e=document.createElement("span");e.id=this.myId("DirectPrintHeaderContent");var t=document.createElement("span");if(t.innerText=CommonUIStrings.l_DirectPrintDialogHeader,Sys.UI.DomElement.addCssClass(t,"DirectPrintHeader"),this._pdfObject=document.createElement("iframe"),this._pdfObject.name="pdfObjectFrame",this._pdfObject.onload=h.i(this,this.printablePdfLoaded,"printablePdfLoaded"),this._sensitiveParameters&&this._sensitiveParameters.get_count()>0){var n=_e.n.getParametersFromUrl(this._pdfUrl,this._sensitiveParameters),i=_e.n.removeParameters(this._pdfUrl,this._sensitiveParameters);this._printPreviewPostForm=document.createElement("form"),this._printPreviewPostForm.id="printPreviewPostForm",this._printPreviewPostForm.method="POST",this._printPreviewPostForm.target=this._pdfObject.name,this._printPreviewPostForm.action=i;for(var r=n.getEnumerator();r.$$mn();){var o=r.$$cu(),a=document.createElement("input");a.type="hidden",a.name=o.get_key(),a.value=o.get_value(),this._printPreviewPostForm.appendChild(a)}}else this._pdfObject.setAttribute("src",this._pdfUrl);Sys.UI.DomElement.addCssClass(this._pdfObject,Ve.h._objectInDialogCssClass),this._hideEmbeddedPdf?(Sys.UI.DomElement.addCssClass(this._pdfObject,"DirectPrintPdfObjectHidden"),t.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,ze.t.setAriaAttribute(this._pdfObject,ze.t.ariaHiddenAttribute,ze.t.ariaTrueValue)):Sys.UI.DomElement.addCssClass(this._pdfObject,"DirectPrintPdfObject"),e.appendChild(t),e.appendChild(document.createElement("br")),e.appendChild(this._pdfObject),this._printPreviewPostForm&&e.appendChild(this._printPreviewPostForm),e.appendChild(document.createElement("br")),e.appendChild(this.constructDownloadSpan(this._printPreviewPostForm?"#":this._pdfUrl)),this._stopwatch.start(),this.messageBoxImpl(CommonUIStrings.l_AppTitle,null,null,null,null,e),this.setDescribedByForDialog(this.myId("DirectPrintHeaderContent")),this._printPreviewPostForm&&this._printPreviewPostForm.submit(),this._failureLink.focus(),b.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")},t.prototype.constructDownloadSpan=function(e){var t=document.createElement("span"),n=document.createElement("span");n.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader,t.appendChild(n);var i=document.createElement("a");return i.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,i.href=e,i.target="_blank",i.id="PrintPDFLink",i.className="AllowBrowserClick",this._failureLink=i,t.appendChild(document.createElement("br")),t.appendChild(i),this._printPreviewPostForm&&We.n.addHandler(i,"click",h.i(this,this.onSubmit,"onSubmit")),this._mouseInputManager.registerHandler(ie.d.click,this._failureLink,h.i(this,this.downloadPDFLinkClicked,"downloadPDFLinkClicked"),null),t},t.prototype.onSubmit=function(e){this._printPreviewPostForm&&(this._printPreviewPostForm.target="_blank",this._printPreviewPostForm.submit()),e.preventDefault()},t.prototype.downloadPDFLinkClicked=function(e){return b.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked."),!1},t.prototype.logDownloadButtonClicked=function(){b.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")},t.prototype.printablePdfLoaded=function(){b.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully"),this._stopwatch&&this._stopwatch.stop()},t.prototype.dispose=function(){this._failureLink&&(this._mouseInputManager.unregisterHandler(ie.d.click,this._failureLink,h.i(this,this.downloadPDFLinkClicked,"downloadPDFLinkClicked")),this._failureLink=null),Ke.s.removeElement(this._pdfObject),this._pdfObject=null,e.prototype.dispose.call(this)},t}(He.StandardDialog);(0,h.l)(qe,"DirectPrintDialog",He.StandardDialog,[Oe]);var Qe=function(){function e(e){this._mouseInputManager=null,this._mouseInputManager=e}return e.prototype.getDirectPrintDialog=function(e,t,n){return void 0===n&&(n=null),new qe(this._mouseInputManager,e,t,n)},e}();(0,h.l)(Qe,"DirectPrintDialogFactory",null,[Ue]);var Ge=n(978),je=function(){return function(e,t){this.supportedMimetypes=null,this.supportedPlugins=null,this.supportedMimetypes=e,this.supportedPlugins=t}}();(0,h.l)(je,"DirectPrintProbeResults",null,[]);var Ze=n(402),Xe=n(425),Je=n(896),Ye=function(){function e(e,t,n,i,r,o,a,s,l,u){this.directPrintSettings=null,this._navigatorMimeTypes=null,this._navigatorPlugins=null,this._isEnabledMimeType=null,this._probeResults=null,this._isSupportedActiveXControl=null,this._dialogFactory=null,this._stopWatchBuilder=null,this._isSupportedBrowser=null,this._legacyDialogFactory=null,this._isWordEmbeddedPreview=!1,this._useNamedActionForAutoPrint=null,this.directPrintSettings=e,this._navigatorMimeTypes=t,this._navigatorPlugins=n,this._isEnabledMimeType=i,this._isSupportedActiveXControl=r,this._probeResults=new Ge.q(je,h.i(this,this.getProbeResults,"getProbeResults")),this._dialogFactory=o,this._legacyDialogFactory=l,this._stopWatchBuilder=a,this._isSupportedBrowser=s,this._isWordEmbeddedPreview=u}return e.prototype.get_directPrintSettings=function(){return this.directPrintSettings},e.prototype.start=function(){},e.prototype.probeDirectPrintExperience=function(){this.get_directPrintSettings().isProbeEnabled&&this.logProbeResults()},e.prototype.querySupportedMimeTypes=function(){var e=new Array(this.get_directPrintSettings().supportedMimeTypes.length);if(!(void 0===this._navigatorMimeTypes||null===this._navigatorMimeTypes))for(var t=0;t<this.get_directPrintSettings().supportedMimeTypes.length;t++)e[t]=this.get_directPrintSettings().supportedMimeTypes[t]in this._navigatorMimeTypes&&this._isEnabledMimeType(this._navigatorMimeTypes[this.get_directPrintSettings().supportedMimeTypes[t]]);return e},e.prototype.querySupportedPlugins=function(){for(var e=new Array(this.get_directPrintSettings().supportedPlugins.length),t=!(void 0===this._navigatorPlugins||null===this._navigatorPlugins),n=0;n<this.get_directPrintSettings().supportedPlugins.length;n++){var i=this.get_directPrintSettings().supportedPlugins[n];t&&i in this._navigatorPlugins?e[n]=!0:e[n]=this._isSupportedActiveXControl(i)}return e},e.prototype.getSupportedMimeTypePluginNames=function(){for(var e=this.querySupportedMimeTypes(),t=new Array(e.length),n=0;n<e.length;n++)e[n]?t[n]=this.extractPluginNameFromMimeType(this._navigatorMimeTypes[this.get_directPrintSettings().supportedMimeTypes[n]]):t[n]=null;return t},e.prototype.extractPluginNameFromMimeType=function(e){if(null==e)return null;var t=e.enabledPlugin;return null==t?null:t.name},e.prototype.logProbeResults=function(){b.ULS.sendTraceTag(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",this._probeResults.get_value().supportedMimetypes,this._probeResults.get_value().supportedPlugins)},e.prototype.getProbeResults=function(){for(var e=this.getSupportedMimeTypePluginNames(),t=this.querySupportedPlugins(),n={},i={},r=0;r<this.get_directPrintSettings().supportedMimeTypes.length;r++)n[this.get_directPrintSettings().supportedMimeTypes[r]]=e[r];for(r=0;r<this.get_directPrintSettings().supportedPlugins.length;r++)i[this.get_directPrintSettings().supportedPlugins[r]]=t[r];return new je(n,i)},e.prototype.shouldUseDirectPrint=function(){return!this._isWordEmbeddedPreview&&(!!this.get_directPrintSettings().isEnabled&&this.supportPluginPrint())},e.prototype.shouldUseNamedAction=function(){if(null!=this._useNamedActionForAutoPrint)return this._useNamedActionForAutoPrint;var t=e.isEdgeAndContainsPrintLayoutFix(this.get_directPrintSettings());return this._useNamedActionForAutoPrint=this.get_directPrintSettings().isEdgeEnabled&&t||this.isChromeAndContainsPrintLayoutFix(),this._useNamedActionForAutoPrint},e.prototype.isChromeAndContainsPrintLayoutFix=function(){return!!(Xe.y.get_isChrome()&&this.get_directPrintSettings().isChromePrintLayoutFixEnabled&&Xe.y.get_chromeRevision()>=this.get_directPrintSettings().chromeVersionFromWhichPrintLayoutIsEnabled)},e.prototype.supportPluginPrint=function(){if(!this._isSupportedBrowser(this.get_directPrintSettings()))return!1;for(var e=0,t=Je.g(this._probeResults.get_value().supportedMimetypes);e<t.length;e++){var n=t[e];if(null!=n)return!0}for(var i=0,r=Je.g(this._probeResults.get_value().supportedPlugins);i<r.length;i++){if(r[i])return!0}return!1},e.prototype.hasImmersiveViewer=function(){for(var e=0,t=Je.g(this._probeResults.get_value().supportedMimetypes);e<t.length;e++){var n=t[e];if(Ze.z(this.get_directPrintSettings().immersivePreviewPlugins,n))return!0}return!1},e.prototype.showPrintDialog=function(e,t,n){void 0===t&&(t=!1),void 0===n&&(n=null),this.shouldUseDirectPrint()?this.displayDirectPrintDialog(e,this.hasImmersiveViewer()&&!t,n):this._legacyDialogFactory(e,n)},e.prototype.displayDirectPrintDialog=function(e,t,n){void 0===n&&(n=null);var i=this._stopWatchBuilder.makeAndStartStopwatch("UserAction","OpenDirectPrintDialog");this._dialogFactory.getDirectPrintDialog(e,t,n).displayDialog(),i.stop()},e.isSupportedActiveXControl=function(e){try{return new ActiveXObject(e),!0}catch(t){b.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",e)}return!1},e.isEnabledMimeType=function(e){return null!=e&&!(void 0===e.enabledPlugin||null===e.enabledPlugin)},e.isSupportedBrowserCheck=function(t){return!!Xe.y.get_isChrome()||(!(!Xe.y.get_isInternetExplorerNonEdge()||!t.isInternetExplorerEnabled)||!(!t.isEdgeEnabled||!e.isEdgeAndContainsPrintLayoutFix(t)))},e.isEdgeAndContainsPrintLayoutFix=function(e){var t=Xe.y.get_edgeVersion();if(t){var n=t.split(".");if(2===n.length){var i=parseInt(n[0]),r=parseInt(n[1]);return i>e.minEdgeMajorVersion||i===e.minEdgeMajorVersion&&r>=e.minEdgeMinorVersion}}return!1},e}();(0,h.l)(Ye,"DirectPrintManager",null,[Be.d]);var et=function(){function e(){this._container=null,this._directPrintManager=null}return e.prototype.get_name=function(){return"Common.App.DirectPrint"},e.prototype.configure=function(e){this._container=e,e.register(Qe).singleInstance().usingFactory((function(){return new Qe(l.AFrameworkApplication.get_activeFrame().get_theMouseInputManager())})),e.register(Be.d).singleInstance().usingFactory((function(){return new Ye(new Ne(l.AFrameworkApplication.appSettingsManager.get_appSettings()),window.navigator.mimeTypes,window.navigator.plugins,Ye.isEnabledMimeType,Ye.isSupportedActiveXControl,e.resolve(Qe),l.AFrameworkApplication.get_activeFrame().get_theStopwatchBuilder(),Ye.isSupportedBrowserCheck,(function(e,t){return new Le.k(e,!1,t)}),l.AFrameworkApplication.get_isEmbedded())}))},e.prototype.init=function(){this._directPrintManager=this._container.resolve(Be.d),this._directPrintManager.start()},e.prototype.dispose=function(){},e}();(0,h.l)(et,"PackageManager",null,[S.u,C.s]);var tt=window.dynamicScriptLoaderDependencies=[{identifier:"appChrome",dependencies:["common"]},{identifier:"appResourceLoader",dependencies:[]},{identifier:"sharedComments",dependencies:["common","common50","comment-pane-strings"]},{identifier:"catchUpActivity",dependencies:["common","common50","word-catchup-activity-intl"]},{identifier:"speechClient",dependencies:[]},{identifier:"frontdoorSpeechClient",dependencies:["common","common50"]},{identifier:"alVoiceClient",dependencies:["common","common50"]},{identifier:"previewPanel",dependencies:["common","common50","word-preview-panel-intl"]},{identifier:"versionHistory",dependencies:["common","common50","office-version-history-strings","friendly-dates-strings","version-history-sprite"]},{identifier:"wordVersionHistory",dependencies:["common","common50","versionHistory","pdfjsWorker"]},{identifier:"canvasAtMentions",dependencies:["common","common50","comment-pane-strings","uiFabricLazy"]},{identifier:"canvasContextual",dependencies:["common","common50","uiFabricLazy"]},{identifier:"performanceMeasureAggregator",dependencies:[]},{identifier:"workerboot",dependencies:[]},{identifier:"comment-pane-strings",isLocalized:!0},{identifier:"word-catchup-activity-intl",isLocalized:!0},{identifier:"word-preview-panel-intl",isLocalized:!0},{identifier:"office-version-history-strings",isLocalized:!0},{identifier:"accessibility-checker-pane-strings",isLocalized:!0},{identifier:"friendly-dates-strings",isLocalized:!0},{identifier:"version-history-sprite",isLocalized:!0},{identifier:"dictation-intl",isLocalized:!0},{identifier:"tellme-strings",isLocalized:!0},{identifier:"floatingContainerManager"},{identifier:"word-app-intl-lazy",isLocalized:!0},{identifier:"word-app-intl-mlr-lazy",isLocalized:!0},{identifier:"word-app-sprite",isLocalized:!0},{identifier:"word-app-mlr-sprite",isLocalized:!0},{identifier:"word-app-sprite-lazy",isLocalized:!0},{identifier:"word-app-mlr-sprite-lazy",isLocalized:!0},{identifier:"word-ideas-strings",isLocalized:!0}],nt=function(e){var t={};function n(i){if(t[i])return t[i].exports;var r=t[i]={i:i,l:!1,exports:{}};return e[i].call(r.exports,r,r.exports,n),r.l=!0,r.exports}return n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(i,r,function(t){return e[t]}.bind(null,r));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="./lib/index.js")}({"../../common/temp/node_modules/.office.pkgs.visualstudio.com/toposort/1.0.7/node_modules/toposort/index.js":function(e,t){function n(e,t){for(var n=e.length,i=new Array(n),r={},o=n;o--;)r[o]||a(e[o],o,[]);return i;function a(o,s,l){if(l.indexOf(o)>=0){var u;try{u=", node was:"+JSON.stringify(o)}catch(e){u=""}throw new Error("Cyclic dependency"+u)}if(!~e.indexOf(o))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(o));if(!r[s]){r[s]=!0;var c=t.filter((function(e){return e[0]===o}));if(s=c.length){var p=l.concat(o);do{var d=c[--s][1];a(d,e.indexOf(d),p)}while(s)}i[--n]=o}}}e.exports=function(e){return n(function(e){for(var t=[],n=0,i=e.length;n<i;n++){var r=e[n];t.indexOf(r[0])<0&&t.push(r[0]),t.indexOf(r[1])<0&&t.push(r[1])}return t}(e),e)},e.exports.array=n},"./lib/DynamicScriptLoader.js":function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n("./lib/getOrderedScriptAndDependencies.js"),r=n("./lib/loadScript.js"),o=n("./lib/preloadScript.js"),a=function(){function e(e){var t=this;this.config=e,this.requestedScripts=new Map,this.knownScriptMap=new Map,this.loadScript=function(e){var n=t.config,o=n.crossOriginAttributeValue,a=n.loadScriptHandler,s=i.getOrderedScriptAndDependencies(e,t.knownScriptMap).map((function(e){var n=t.requestedScripts.get(e);return n||(n=(a||r.loadScript)(e,t.getUrlFromScriptIdentifier(e),o),t.requestedScripts.set(e,n)),n}));return Promise.all(s).then((function(){return e}))},this.preloadScript=function(e){i.getOrderedScriptAndDependencies(e,t.knownScriptMap).forEach((function(e){return o.preloadScript(t.getUrlFromScriptIdentifier(e),t.config.crossOriginAttributeValue)}))},e.knownScripts&&e.knownScripts.forEach((function(e){var n=e.identifier.toLowerCase();if(t.knownScriptMap.has(n))throw new Error("The knownScripts passed into the DynamicScriptLoader config contains multiple entries for the script with identifier: "+n);t.knownScriptMap.set(n,e)}))}return e.prototype.getUrlFromScriptIdentifier=function(e){var t=this.knownScriptMap.get(e)||{identifier:e};return this.config.resolveScript(t)},e}();t.DynamicScriptLoader=a},"./lib/getOrderedScriptAndDependencies.js":function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var i=n("../../common/temp/node_modules/.office.pkgs.visualstudio.com/toposort/1.0.7/node_modules/toposort/index.js");t.getOrderedScriptAndDependencies=function(e,t){for(var n=new Set,r=[e.toLowerCase()],o=[],a=function(){var e=r.shift();n.add(e);var i=t.get(e);i&&i.dependencies&&i.dependencies.forEach((function(t){var i=t.toLowerCase();n.has(i)||r.push(i),o.push([i,e])}))};r.length>0;)a();var s=[];return n.forEach((function(e){return s.push(e)})),i.array(s,o)}},"./lib/index.js":function(e,t,n){function i(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,"__esModule",{value:!0}),i(n("./lib/DynamicScriptLoader.js")),i(n("./lib/loadScript.js")),i(n("./lib/preloadScript.js"))},"./lib/loadScript.js":function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.loadScript=function(e,t,n,i){return function e(t,n,i,r,o,a){return new Promise((function(s,l){var u=document.createElement("script");u.async=!1,u.src=n,void 0!==i&&(u.crossOrigin=i),u.onload=function(){o?o(t):s(t)},u.onerror=function(){if(r&&r>0)document.head.removeChild(u),e(t,n,i,r-1,o||s,a||l);else{var c=new Error("Failed to download the script with identifier: "+t+" at url: "+n);a?a(c):l(c)}},document.head.appendChild(u)}))}(e,t,n,i)}},"./lib/preloadScript.js":function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.preloadScript=function(e,t){var n=document.createElement("link");n.rel="preload",n.href=e,n.setAttribute("as","script"),void 0!==t&&(n.crossOrigin=t),document.head.appendChild(n)}}}),it=n(568),rt=n(967),ot=function(e,t){void 0===e&&(e="anonymous"),void 0===t&&(t="dynamicScriptLoaderDependencies");var n={};return n.resolveScript=function(e){return rt.y.isFileSupportedForLocalhost(n.knownScripts,e.identifier)?function(e){var t=e.isLocalized?rt.y.getLocalizationLocalhostPath(l.AFrameworkApplication.lcid):rt.y.get_scriptPath(),n=2===rt.y.getOverrideType()?".min":"";return t+e.identifier+n+".js"}(e):function(e){var t=l.AFrameworkApplication.get_staticContentScriptNameBase();e.isLocalized&&(t+=l.AFrameworkApplication.lcid+"/");return t+e.identifier+".min.js"}(e)},n.crossOriginAttributeValue=e,n.knownScripts=window[t],n},at=function(){function e(e){this._dynamicScriptLoader=null,this._dynamicScriptLoader=e}return e.prototype.getScriptLoader=function(){return this._dynamicScriptLoader},e}();(0,h.l)(at,"DynamicScriptLoaderProvider",null,[it.d]);var st=function(){function e(){this._container=null}return e.prototype.get_name=function(){return"WordViewer.DynamicScriptLoader"},e.prototype.configure=function(e){this._container=e;var t=ot();e.register(at).as(it.d).singleInstance().usingFactory((function(){return new at(new dynamicScriptLoader.DynamicScriptLoader(t))}))},e.prototype.init=function(){},e.prototype.dispose=function(){},e}();(0,h.l)(st,"DynamicScriptLoaderPackage",null,[S.u,C.s]);var lt,ut={WordUISurvey1:{campaignId:"44444444-4444-4444-4444-444444444444",commentQuestion:"Comment Question1",isZeroBased:!1,promptQuestion:"Prompt Question1",promptNoButtonText:"Prompt No Button Text",promptYesButtonText:"Prompt Yes Button Text",ratingQuestion:"Rating Question1",ratingValuesAscending:["CustomSurvey_Rating_11","CustomSurvey_Rating_12","CustomSurvey_Rating_3","CustomSurvey_Rating_4","CustomSurvey_Rating_5"],showPrompt:!1,surveyType:4,title:"Custom Survey Title"},WordUISurvey2:{campaignId:"44444444-4444-4444-4444-444444444444",commentQuestion:"Comment Question2",isZeroBased:!1,promptQuestion:"Prompt Question2",promptNoButtonText:"Prompt No Button Text",promptYesButtonText:"Prompt Yes Button Text",ratingQuestion:"Rating Question2",ratingValuesAscending:["CustomSurvey_Rating_21","CustomSurvey_Rating_22","CustomSurvey_Rating_3","CustomSurvey_Rating_4","CustomSurvey_Rating_5"],showPrompt:!1,surveyType:4,title:"Custom Survey Title"},WordIdeasSurvey:{campaignId:"de75bc89-e697-465e-9eb5-85a3dc0946b0",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your document?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"}},ct={PPTIdeasSurvey:{campaignId:"00832D36-A8AF-4883-B8C2-7FD77D1E3829",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall how do you feel while using Ideas to get suggestions for improving your slides?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Ideas"},PPTRehearsePresentationSurvey:{campaignId:"2c3d6424-b363-4328-8dec-a07edda7a808",commentQuestion:"Why did you choose that answer?",isZeroBased:!1,promptQuestion:"Not Used",promptNoButtonText:"Not Used",promptYesButtonText:"Not Used",ratingQuestion:"Overall, how do you feel while using Presenter Coach?",ratingValuesAscending:["Extremely negative","Somewhat negative","Neither negative nor positive","Somewhat positive","Extremely positive"],showPrompt:!1,surveyType:4,title:"Thanks for using Presenter Coach"}},pt={VisioUISurveyExample:{campaignId:"44444444-4444-4444-4444-444444444444",commentQuestion:"Comment Question1",isZeroBased:!1,promptQuestion:"Prompt Question1",promptNoButtonText:"Prompt No Button Text",promptYesButtonText:"Prompt Yes Button Text",ratingQuestion:"Rating Question1",ratingValuesAscending:["CustomSurvey_Rating_11","CustomSurvey_Rating_12","CustomSurvey_Rating_3","CustomSurvey_Rating_4","CustomSurvey_Rating_5"],showPrompt:!1,surveyType:4,title:"Custom Survey Title"}},dt={OneNoteUISurveyExample:{campaignId:"44444444-4444-4444-4444-444444444444",commentQuestion:"Comment Question1",isZeroBased:!1,promptQuestion:"Prompt Question1",promptNoButtonText:"Prompt No Button Text",promptYesButtonText:"Prompt Yes Button Text",ratingQuestion:"Rating Question1",ratingValuesAscending:["CustomSurvey_Rating_11","CustomSurvey_Rating_12","CustomSurvey_Rating_3","CustomSurvey_Rating_4","CustomSurvey_Rating_5"],showPrompt:!1,surveyType:4,title:"Custom Survey Title"}},ht={ExcelUISurveyExample:{campaignId:"44444444-4444-4444-4444-444444444444",commentQuestion:"Comment Question1",isZeroBased:!1,promptQuestion:"Prompt Question1",promptNoButtonText:"Prompt No Button Text",promptYesButtonText:"Prompt Yes Button Text",ratingQuestion:"Rating Question1",ratingValuesAscending:["CustomSurvey_Rating_11","CustomSurvey_Rating_12","CustomSurvey_Rating_3","CustomSurvey_Rating_4","CustomSurvey_Rating_5"],showPrompt:!1,surveyType:4,title:"Custom Survey Title"}};window.WordViewerToolbarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"Toolbar",attrs:{Id:"WordViewer",ImageDownArrow:"IMGMAP@wv@SplitButtonArrow_5x3x32",Size:"SingleDock",TextDirection:"STR@L_RibbonOptionTextDirection"},children:[{name:"Docks",attrs:{Id:"buttondocks"},children:[{name:"HeroDock",attrs:{Id:"WordViewerHeroDock",OverflowMenuImage20by20:"IMGMAP@wv@EllipsisDark_20x20x32",OverflowMenuTooltip:"STR@L_MoreOptionsMenu"},children:[{name:"Controls",attrs:{id:"ctrlStripLeft"},children:[{name:"ToggleButton",attrs:{Alt:"STR@L_AccessibilityMode",Id:"jbtnToggleViewMode",LabelText:"STR@L_AccessibilityMode",Image20by20:"IMGMAP@wv@AccessibilityGlyph_20x20x32",QueryCommand:"0x127D7696",Command:"0x9FC8F94C"}},{name:"Button",attrs:{Alt:"STR@L_ImmersiveView",Id:"btnLaunchImmersiveViewEdu",LabelText:"STR@L_ImmersiveView",Image20by20:"IMGMAP@wv@AudioReaderGlyph_20x20x32",Command:"0x72BE69D3"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_EditDocument",Command:"0x2F9A3D80",Id:"flyoutWordViewerEdit",LabelText:"STR@L_EditDocument",TextDirection:"STR@L_RibbonOptionTextDirection",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32"},children:[{name:"Menu",attrs:{Id:"menuEdit"},children:[{name:"MenuSection",attrs:{Id:"menuSectionEdit",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlsEdit"},children:[{name:"Button",attrs:{Alt:"STR@L_EditInWord",Id:"btnEditInClient",LabelText:"STR@L_EditInWord",Description:"STR@L_EditInWordDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0xD5DF198A"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnFlyoutEditOnWeb",LabelText:"STR@L_EditInBrowser",Description:"STR@L_EditInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0x13A057F4"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnFlyoutConvertToEditOnWeb",LabelText:"STR@L_EditInBrowser",Description:"STR@L_EditInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0x3809D3C2"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnFlyoutCopyAndEdit",LabelText:"STR@L_EditInBrowser",Description:"STR@L_EditInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",QueryCommand:"0x313544DC",Command:"0x68562DD8"}}]}]}]}]},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_OpenDocument",Command:"0x2F9A3D80",Id:"flyoutWordViewerOpen",LabelText:"STR@L_OpenDocument",TextDirection:"STR@L_RibbonOptionTextDirection",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32"},children:[{name:"Menu",attrs:{Id:"menuOpen"},children:[{name:"MenuSection",attrs:{Id:"menuSectionOpen",DisplayMode:"Menu32"},children:[{name:"Controls",attrs:{Id:"ctrlsOpen"},children:[{name:"Button",attrs:{Alt:"STR@L_OpenInWord",Id:"btnOpenInClientBig",LabelText:"STR@L_OpenInWord",Description:"STR@L_EditInWordDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0xD5DF198A"}},{name:"Button",attrs:{Alt:"STR@L_InteractiveViewInBrowser",Id:"btnFlyoutInteractiveViewOnWeb",LabelText:"STR@L_InteractiveViewInBrowser",Description:"STR@L_ViewInWordWebAppDescription",Image32by32:"IMGMAP@wv@Word_32x32x32",Command:"0x13A057F4"}}]}]}]}]},{name:"Button",attrs:{Alt:"STR@L_EditInWord",Id:"btnPdfConvertAndEdit",LabelText:"STR@L_EditInWord",Command:"0xCAD15C25",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInWord",Id:"btnPdfCopyAndEdit",LabelText:"STR@L_EditInWord",Command:"0xFAA71D53",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_OpenInWord",Id:"btnOpenInClient",LabelText:"STR@L_OpenInWord",Command:"0xD5DF198A",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_InteractiveViewInBrowser",Id:"btnInteractiveViewOnWeb",LabelText:"STR@L_InteractiveViewInBrowser",Command:"0x13A057F4",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnEditOnWeb",LabelText:"STR@L_EditInBrowser",Command:"0x13A057F4",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnConvertToEditOnWeb",LabelText:"STR@L_EditInBrowser",Command:"0x3809D3C2",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_EditInBrowser",Id:"btnCopyAndEdit",LabelText:"STR@L_EditInBrowser",Command:"0x68562DD8",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32",QueryCommand:"0x313544DC",IsEmphasized:"True"}},{name:"Button",attrs:{Alt:"STR@L_SaveAndEditTranslatedDocumentButtonAltText",Id:"btnSaveAndEdit",LabelText:"STR@L_EditInBrowser",Command:"0xAADCE5C8",Image20by20:"IMGMAP@wv@EditGlyph_20x20x32"}},{name:"Button",attrs:{Id:"jbtnTranslateDocumentBack",LabelText:"STR@L_TranslateBackToOriginal",Image20by20:"IMGMAP@wv@Translator_20x20x32",Command:"0x22335D57"}},{name:"Button",attrs:{Alt:"STR@L_Download",Id:"btnDownloadWithWord",LabelText:"STR@L_Download",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Alt:"STR@L_SaveToCloudStorage",Id:"btnSaveToCloudStorage",LabelText:"STR@L_SaveToCloudStorage",Image20by20:"IMGMAP@wv@SkyDriveCloud_20x20x32",Command:"0x24D132C8"}},{name:"Button",attrs:{Id:"btnPrintToPdf",LabelText:"STR@L_Print",Alt:"STR@L_PrintToPdf",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnDirectPrint",LabelText:"STR@L_DirectPrintJewelButton",Alt:"STR@L_DirectPrintJewelDescription",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnPrintPdfFile",LabelText:"STR@L_Print",Alt:"STR@L_PrintToPdf",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnDirectPrintPdfMode",LabelText:"STR@L_DirectPrintJewelButton",Alt:"STR@L_DirectPrintJewelDescription",Image20by20:"IMGMAP@wv@PrintGlyph_20x20x32",Command:"0xC6003374"}},{name:"Button",attrs:{Id:"btnjClose",Command:"0xB4CE0C4E",LabelText:"STR@L_Exit",Image20by20:"IMGMAP@wv@CloseGlyphServer_20x20x32"}},{name:"Button",attrs:{Alt:"STR@L_Share",Id:"btnFileSharing",LabelText:"STR@L_Share",Image20by20:"IMGMAP@wv@ShareServer_20x20x32",Command:"0x3A7DFAA4"}},{name:"ToggleButton",attrs:{Alt:"STR@L_OpenCommentPane",Id:"btnOpenCommentPane",LabelText:"STR@L_OpenCommentPane",Image20by20:"IMGMAP@wv@CommentsGlyphGrey_20x20x32",Command:"0x87F614C3",QueryCommand:"0x3282B935",UsePseudoCheckMark:"true"}},{name:"ToggleButton",attrs:{Alt:"STR@L_OpenSearchPane",Id:"btnOpenSearchPane",LabelText:"STR@L_OpenSearchPane",Image20by20:"IMGMAP@wv@FindGlyphServer_20x20x32",Command:"0x3A32DAF4",QueryCommand:"0x4CD7FCB8",UsePseudoCheckMark:"true"}},{name:"Button",attrs:{Alt:"STR@L_ImmersiveView",Id:"btnLaunchImmersiveViewNonEdu",LabelText:"STR@L_ImmersiveView",Image20by20:"IMGMAP@wv@AudioReaderGlyph_20x20x32",Command:"0x72BE69D3"}},{name:"Button",attrs:{Id:"jbtnTranslateDocument",LabelText:"STR@L_TranslateDocument",Image20by20:"IMGMAP@wv@Translator_20x20x32",Command:"0x9BB3ABA5"}},{name:"Button",attrs:{Id:"jbtnFileVersion",LabelText:"STR@L_PreviousVersions",Image20by20:"IMGMAP@wv@VersionsServer_20x20x32",Command:"0xDB70177B"}},{name:"Button",attrs:{Alt:"STR@L_Download",Id:"overflowbtnDownloadWithWord",LabelText:"STR@L_Download",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Id:"jbtnDownloadATranslatedCopy",LabelText:"STR@L_Download",Description:"STR@L_DownloadDescription",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0x3E4AEF42"}},{name:"Button",attrs:{Alt:"STR@L_Download",Id:"btnDownloadPdf",LabelText:"STR@L_Download",Image20by20:"IMGMAP@wv@DownloadGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Id:"jbtnDownloadAsPdf",LabelText:"STR@L_DownloadAsPDF",Description:"STR@L_DownloadAsPDFDescription",Image20by20:"IMGMAP@wv@PDFGlyph_20x20x32",Command:"0x5887FF04"}},{name:"Button",attrs:{Id:"jbtnFileEmbed",LabelText:"STR@L_Embed",Image20by20:"IMGMAP@wv@EmbedServer_20x20x32",Command:"0x66DDFD86"}},{name:"Button",attrs:{Id:"jbtnHelp",LabelText:"STR@L_HelpButtonTitle",Image20by20:"IMGMAP@wv@OfficeAssistantServerDark_20x20x32",Command:"0x56B04A51"}},{name:"Button",attrs:{Id:"jbtnAccessibilityHelp",LabelText:"STR@L_AccessibilityHelp",Image20by20:"IMGMAP@wv@GeneralAccessibilityGlyph_20x20x32",Command:"0xC34BD836"}},{name:"Button",attrs:{Id:"jbtnGiveFeedback",LabelText:"STR@L_GiveFeedback",Image20by20:"IMGMAP@wv@FeedbackGlyph_20x20x32",Command:"0x2FD6BDE0"}},{name:"Button",attrs:{Id:"btnjTryOffice",LabelText:"STR@L_TryOffice",Image20by20:"IMGMAP@wv@OfficeTrial_20x20x32",Command:"0x99AFA01D"}},{name:"Button",attrs:{Id:"btnjTryMacOffice",LabelText:"STR@L_TryMacOffice",Image20by20:"IMGMAP@wv@OfficeTrial_20x20x32",Command:"0x0C048010"}},{name:"Button",attrs:{Id:"jbtnTermsOfUse",LabelText:"STR@L_TermsOfUse",Image20by20:"IMGMAP@wv@InfoGlyphServer_20x20x32",Command:"0x8C0EBBB3"}},{name:"Button",attrs:{Id:"jbtnPrivacy",LabelText:"STR@L_Privacy",Image20by20:"IMGMAP@wv@PrivacyGlyphServer_20x20x32",Command:"0x48091446"}},{name:"Button",attrs:{Id:"jbtnReportAbuse",LabelText:"STR@L_ReportAbuse",Image20by20:"IMGMAP@wv@AbuseGlyph_20x20x32",Command:"0xC0F351AE"}},{name:"Button",attrs:{Id:"jbtnAccessibility",LabelText:"STR@L_AccessibilityMode",Image20by20:"IMGMAP@wv@AccessibilityGlyph_20x20x32",Command:"0x583F2602"}},{name:"Button",attrs:{Id:"jbtnAccessibilityPdf",LabelText:"STR@L_AccessibilityMode",Image20by20:"IMGMAP@wv@AccessibilityGlyph_20x20x32",Command:"0xD3EF8F78"}},{name:"Button",attrs:{Alt:"STR@L_SyncToPresenter",Id:"btnSyncToPresenter",LabelText:"STR@L_SyncToPresenter",Image20by20:"IMGMAP@wv@SyncToPresenterServer_20x20x32",Command:"0xC79FFB5C"}},{name:"Button",attrs:{Alt:"STR@L_OpenSharedNotes",Id:"btnOpenSharedNotes",LabelText:"STR@L_OpenSharedNotes",Image20by20:"IMGMAP@wv@SharedNotesGlyph_Grey_20x20x32",Command:"0xE6ACD19C"}},{name:"Button",attrs:{Id:"jbtnTrustCenter",LabelText:"STR@l_TrustCenter",Image20by20:"IMGMAP@wv@PrivacyGlyphServer_20x20x32",Command:"0x9A00EB4E"}}]}]}]}]}]},window.WordViewerStatusBarData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"StatusBar",attrs:{Id:"WordViewerStatusBar",ImageDownArrow:"IMGMAP@wv@StatusBarDownArrowGrey_5x3x32",Scale:"true",Size:"OneRow",TeamId:"WAC",TextDirection:"STR@L_RibbonOptionTextDirection",LabelText:"STR@L_StatusBarLabel"},children:[{name:"Docks",attrs:{Id:"buttondocks"},children:[{name:"ButtonDock",attrs:{Id:"buttonDockLeft",Alignment:"Left"},children:[{name:"Controls",attrs:{id:"buttonDockLeftControls"},children:[{name:"Label",attrs:{Id:"WordIcon",Image16by16:"IMGMAP@wv@Word_14x14x32",DisplayMode:"Small14"}},{name:"Label",attrs:{Id:"PageInfoLabel",LabelText:"",QueryCommand:"0x42EB999E",DisplayMode:"Medium14"}},{name:"Label",attrs:{Id:"ClassificationLabel",Alt:"",LabelText:"",Image16by16:"IMGMAP@wv@MarkAsProtected14",Command:"0xCC509ABF",QueryCommand:"0x1DACE7EE",DisplayMode:"Medium14",Visible:"false"}}]}]},{name:"ButtonDock",attrs:{Id:"buttonDockCenter",Alignment:"Center"},children:[{name:"Controls",attrs:{id:"buttonDockCenterControls"},children:[{name:"Label",attrs:{Id:"EnvironmentLabel",QueryCommand:"0xE7B52458",LabelText:"",DisplayMode:"Medium14",Visible:"false"}},{name:"Label",attrs:{Id:"PresenterPageLabel",LabelText:"",QueryCommand:"0x37D5C13B",DisplayMode:"Medium14"}}]}]},{name:"ButtonDock",attrs:{Id:"buttonDockRight",Alignment:"Right"},children:[{name:"Controls",attrs:{id:"buttonDockRightControls"},children:[{name:"Button",attrs:{Id:"GiveFeedback",Alt:"STR@L_HelpImproveOffice",Command:"0x2FD6BDE0",LabelText:"STR@L_GiveFeedback",DisplayMode:"Medium14"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_CurrentZoom",Command:"0x2F9A3D80",Id:"ZoomFlyout",PopulateDynamically:"true",PopulateQueryCommand:"0x5D7E84A8",PopulateOnlyOnce:"true",QueryCommand:"0x19D00622",LabelText:""}},{name:"Button",attrs:{Id:"buttonShowZoomDialog",Alt:"STR@L_ZoomTooltip",Command:"0x6797D208",LabelText:"100%",QueryCommand:"0x19D00622",DisplayMode:"Medium14"}},{name:"FlyoutAnchor",attrs:{Alt:"STR@L_ControlMenu",Command:"0x2F9A3D80",Id:"ControlMenu",PopulateDynamically:"false",PopulateOnlyOnce:"false",Image16by16:"IMGMAP@wv@sbMenuGrey_14x14x32",DisplayMode:"Small14"},children:[{name:"Menu",attrs:{Id:"menuEmbeddedControls"},children:[{name:"MenuSection",attrs:{Id:"msControlMenu1"},children:[{name:"Controls",attrs:{Id:"msControlMenu.Controls"},children:[{name:"Button",attrs:{MenuItemId:"DownloadACopy",Id:"DownloadACopy",Command:"0xD3EF8F78",LabelText:"STR@L_DownloadACopy",Alt:"STR@L_DownloadACopy"}},{name:"Button",attrs:{MenuItemId:"PrintPDF",Id:"PrintPDF",Command:"0xC6003374",LabelText:"STR@L_PrintPDF",Alt:"STR@L_PrintPDF"}},{name:"ToggleButton",attrs:{MenuItemId:"AccessibleMode",Id:"AccessibleMode",Command:"0x9FC8F94C",LabelText:"STR@L_AccessibilityMode",Alt:"STR@L_AccessibilityMode",QueryCommand:"0x127D7696"}}]}]},{name:"MenuSection",attrs:{Id:"msControlMenu2"},children:[{name:"Controls",attrs:{Id:"msControlMenu.Controls"},children:[{name:"Button",attrs:{MenuItemId:"DocumentInformation",Id:"DocumentInformation",Command:"0xAC76EB12",LabelText:"STR@L_DocumentInformation",Alt:"STR@L_DocumentInformation"}}]}]},{name:"MenuSection",attrs:{Id:"msControlMenu3"},children:[{name:"Controls",attrs:{Id:"msControlMenu.Controls"},children:[{name:"Button",attrs:{Id:"msControlMenu.Controls.GiveFeedback",LabelText:"STR@L_GiveFeedback",Command:"0x2FD6BDE0",DisplayMode:"Medium14"}},{name:"Button",attrs:{MenuItemId:"TermsOfUse",Id:"TermsOfUse",Command:"0x8C0EBBB3",LabelText:"STR@L_TermsOfUse",Alt:"STR@L_TermsOfUse"}},{name:"Button",attrs:{MenuItemId:"Privacy",Id:"Privacy",Command:"0x48091446",LabelText:"STR@L_Privacy",Alt:"STR@L_Privacy"}}]}]}]}]},{name:"Button",attrs:{Alt:"STR@L_FullScreen",Id:"fseaFullScreen",LabelText:"STR@L_FullScreen",Command:"0xAFAE8F6F",DisplayMode:"Small14",Image16by16:"IMGMAP@wv@FullScreenAttendee_14x14x32"}}]}]}]}]}]};"undefined"==typeof lt&&(lt={}),window.MSOJS=lt,lt.ClientUtils=function(){function e(){return Boolean(j)||(j=!0,Z=i("Windows NT")),Z>=6.1&&!(window.navigator.userAgent.indexOf("ARM;")>=0)&&(l()||h()||p())}function t(){return window.navigator.userAgent.indexOf("Windows")>=0}function n(){return window.navigator.userAgent.indexOf("Windows Phone")>=0}function i(e){var t=new RegExp(e+"\\s+(\\d+(\\.\\d*)?)").exec(window.navigator.userAgent),n=-1;return null!=t&&t.length>=2&&(n=parseFloat(t[1]),isNaN(n)&&(n=-1)),n}function r(){return Boolean(X)||(X=!0,J=i("Windows Phone")),J>=8}function o(){return"function"==typeof navigator.msLaunchUri&&!n()&&!d()&&!s()}function a(){return window.navigator.userAgent.indexOf("Macintosh")>=0}function s(){return window.navigator.userAgent.indexOf("Edge/")>=0}function l(){return window.navigator.userAgent.indexOf(" MSIE ")>=0||window.navigator.userAgent.indexOf("Trident/")>=0}function u(){return!!l()&&8==window.document.documentMode}function c(){return window.navigator.userAgent.indexOf(" Firefox/")>=0}function p(){return window.navigator.userAgent.toLowerCase().indexOf("chrome")>=0}function d(){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("android")>=0&&e.indexOf("chrome")>=0}function h(){return(c()?m("firefox/"):0)>=3}function g(){return(window.navigator.userAgent.indexOf(" AppleWebKit/")>=0?m("version/"):0)>=3}function m(e){var t,n,i=window.navigator.userAgent.toLowerCase(),r=i.indexOf(e);return r>=0?(t=r+e.length,n=i.length,parseInt(i.substring(t,n))):0}function _(e,t,n,i){i&&null!=t?t():o()?navigator.msLaunchUri(e,t,n):!p()&&!(window.navigator.userAgent.indexOf("iPhone")>=0||window.navigator.userAgent.indexOf("iPad")>=0||window.navigator.maxTouchPoints>0&&a())||s()?y(e,t,n):f(e,t,n)}function f(e,t,n){var i="OICLinkTag",r=document.getElementById(i);null==r&&((r=document.createElement("a")).id=i,r.style.visibility="hidden",r.href="",r.target=S(G)?"_top":"_blank",document.body.appendChild(r),null!=r.addEventListener&&r.addEventListener("click",(function(e){null!=e.stopPropagation&&e.stopPropagation()}),!1));try{r.href=e,r.click()}catch(e){return void(null!=n&&n())}null!=t&&t()}function y(e,t,n){var i="OICFrame",r=document.getElementById(i);null==r&&((r=document.createElement("iframe")).className="ObjectInDialog",r.style.visibility="hidden",r.src="about:blank",document.body.appendChild(r),r.id=i);try{r.contentWindow.location.href=e}catch(e){return void(null!=n&&n())}null!=t&&t()}function v(e){return 0!=(e.Options&Te.SkipProtocolHandler)||u()}function S(e){return 0!=(e.Options&Te.SupportsTopTargetNavigation)}function C(e){return a()&&(e.Application==Ee.OneNote||x(oe,!1)||x(ae,!1))}function b(e){return!v(e)&&(!!C(e)||(!!o()||(!!d()||(!(A()||"ActiveXObject"in window&&!n()||p())||V()>=15))))}function A(){return a()&&(h()||g())||h()}function T(e){return e===Ae.ReadOnly||e===Ae.ReadWrite}function w(e,t,i,o,a){var s,l,u,c;if(e==Ee.Visio&&i==Ae.ReadWrite&&(i=Ae.WriteOnly),s=a,(o=o||n()&&!r())||(l="",l+=T(i)?pe+de:he,s+=E(l+=ge)),s+=E(t),null!=(u=function(e,t){var n,i,r=e.toLowerCase().indexOf("&"+t+"=");return-1==r?void 0:(n=r+(t.length+2),-1==(i=e.indexOf("&",n))?e.substr(n):e.substring(n,i))}(window.location.href,_e))&&"undefined"!=typeof u){c="";try{c=decodeURIComponent(u)}catch(e){}c.length>0&&function(e){return RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(e)}(c)&&(s+=me,s+=c)}return s}function I(e,t,n,i,r){var o=N(e);return null==o?(W(we.Unattempted,G.Application),!1):(_(w(e,t,n,i,o),k,D,r),!0)}function E(e){if(a()&&p()){var t="";try{t=decodeURI(e)}catch(e){}if(t==e)return encodeURI(e)}return e}function k(){H(Ie.ProtocolHandler)}function D(){G.Options|=Te.SkipProtocolHandler,O(G,K,z)}function M(){null!=q&&q(Ie.RoamingProtocolHandler)}function P(){null!=Q&&Q(we.ControlNeeded)}function F(){var e,t,n=document.getElementById(le);if(null==n){if(e=ie,a()&&g()&&R(re)&&(e=re),!R(e)){if(!a()||!R(se))return null;e=se}(t=document.createElement("object")).id=le,t.type=e,t.style.width="0px",t.style.height="0px",t.style.setProperty("visibility","hidden",""),document.body.appendChild(t),n=document.getElementById(le)}return n}function x(e,t){var n,i=window.navigator.mimeTypes;return null!=i&&(!!(n=i[e])&&!(t&&!n.enabledPlugin))}function R(e){return x(e,!0)}function B(e){try{if(null!=new ActiveXObject(e))return!0}catch(e){}return!1}function L(e){switch(e){case Ee.OneNote:return ce;default:return""}}function N(e){if(e!=Ee.OneNote&&n()&&!r())return"office:";switch(e){case Ee.Excel:return"ms-excel:";case Ee.OneNote:return"onenote:";case Ee.PowerPoint:return"ms-powerpoint:";case Ee.Visio:return"ms-visio:";case Ee.Word:return"ms-word:";case Ee.Project:return"ms-project:";case Ee.Publisher:return"ms-publisher:";case Ee.Infopath:return"ms-infopath:";case Ee.Access:return"ms-access:";default:return""}}function U(e){switch(e){case Ee.Excel:return"root\\office15\\excel.exe";case Ee.PowerPoint:return"root\\office15\\powerpnt.exe";case Ee.Visio:return"root\\office15\\visio.exe";case Ee.Word:return"root\\office15\\winword.exe";case Ee.Project:return"root\\office15\\winproj.exe";case Ee.Publisher:return"root\\office15\\mspub.exe";case Ee.Infopath:return"root\\office15\\infopath.exe";case Ee.Access:return"root\\office15\\msaccess.exe";default:return null}}function O(t,n,i){var r;if(G=t,K=n,z=i,t.DocumentUrl){var o=t.DocumentUrl,s=t.DocumentUrl,c=t.DocumentUrl;try{c=decodeURIComponent(t.DocumentUrl)}catch(e){}try{s=encodeURI(t.DocumentUrl)}catch(e){}if(o=o+""+t.CorrelationIdForWinClient,c+=t.CorrelationIdForWinClient,s+=t.CorrelationIdForWinClient,t.Mode===Ae.ReadWrite&&Te.CheckoutRequired===(t.Options&Te.CheckoutRequired)&&(t.Mode=Ae.ForceCheckout),Te.HostIsEditOnly===(t.Options&Te.HostIsEditOnly)&&(t.Mode=Ae.WriteOnly),b(t))I(t.Application,t.EncodeUrl?s:o,t.Mode,t.Application==Ee.OneNote,t.SilentExternalHandler);else if(u()&&function(e,t,n,i){try{var r=new ActiveXObject(Y);if(r)return r.ViewDocument3(window.self,e,t,i)}catch(e){}return!1}(t.EncodeUrl?o:c,t.Mode,t.Options,L(t.Application)))H(Ie.O15ActiveX);else if(A()?r=function(e,t,n){var i,r=F();if(null==r)return we.Unattempted;i=!1;try{i=r.ViewDocument3(window.self,e,t,n)}catch(e){}if(!i)try{i=T(t)?r.ViewDocument2(window.self,e,n):r.EditDocument2(window.self,e,n)}catch(e){}return i?(H(Ie.NpapiPlugin),we.None):we.Failed}(t.EncodeUrl?o:c,t.Mode,L(t.Application)):(function(){try{var e=new ActiveXObject(ue);null!=e&&e.SaveSSOCreds()}catch(e){}}(),r=function(e,t,n,i){var r;try{if(r=new ActiveXObject(ee))return r.ViewDocument3(window.self,e,t,i)?(H(Ie.O14ActiveX),we.None):we.Failed}catch(e){}if(Te.O14Only===(n&Te.O14Only))return we.Unattempted;try{if(r=new ActiveXObject(te))return r.ViewDocument3(window.self,e,t,i)?(H(Ie.O12ActiveX),we.None):we.Failed}catch(e){}if(Te.O12UpOnly===(n&Te.O12UpOnly))return we.Unattempted;try{if(r=new ActiveXObject(ne))return(T(t)?r.ViewDocument2(window.self,e,i):r.EditDocument2(window.self,e,i))?(H(Ie.O11ActiveX),we.None):we.Failed}catch(e){}return we.Unattempted}(t.EncodeUrl?o:c,t.Mode,t.Options,L(t.Application))),r!=we.None){if(t.CouldUseRoamingApps&&e()&&t.Application!=Ee.OneNote){if(!lt.ClientUtils.CanUseRoamingControl())return void W(we.ControlNeeded,G.Application);if(t.RoamingAppsLauncher)return void function(e){"undefined"!=typeof e.RoamingAppsLauncher&&null!=e.RoamingAppsLauncher?"undefined"==typeof e.RoamingBitsUrl||null==e.RoamingBitsUrl?lt.ClientUtils.LaunchRoamingApps(e.DocumentUrl,e.RoamingAppsLauncher,e.Application,e.ApplicationParameters,K,z):lt.ClientUtils.LaunchRoamingApps2(e.DocumentUrl,e.RoamingAppsLauncher,e.RoamingApplicationExe,e.ApplicationParameters,e.RoamingPlatform,e.RoamingBitsUrl,K,z):W(we.Unattempted,G.Application)}(t);if(!t.ContinueIfLauncherIsNull)return void W(we.LauncherNeeded,G.Application)}if(!(Te.NoProtocolHandlerFallback==(t.Options&Te.NoProtocolHandlerFallback)||v(t)||l()||a()&&r!=we.Unattempted))return void I(t.Application,t.EncodeUrl?s:o,t.Mode,t.Application==Ee.OneNote,t.SilentExternalHandler);W(r,G.Application)}}else W(we.Unattempted,G.Application)}function H(e){null!=K&&K(e)}function W(e,t){"undefined"==typeof t&&(t=null),null!=z&&z(e,t)}function V(){var e,t=0;if(A()||p()){e=F();try{null!=e&&(t=e.GetOfficeVersion())}catch(e){}}else B(Y)?t=15:B(ee)?t=14:B(te)?t=12:B(ne)&&(t=11);return t}function $(){return a()&&(R(ie)||R(re))}var K,z,q,Q,G,j,Z,X,J,Y="SharePoint.OpenDocuments.5",ee="SharePoint.OpenDocuments.4",te="SharePoint.OpenDocuments.3",ne="SharePoint.OpenDocuments.2",ie="application/x-sharepoint",re="application/x-sharepoint-webkit",oe="application/x-sharepoint-protocolhandler",ae="application/x-sharepoint-webkit-protocolhandler",se="application/officelive",le="npSharePointPlugin",ue="IDBHO.IDBHOCtrl",ce="OneNote.Notebook",pe="ofv|",de="ofc|",he="ofe|",ge="u|",me="|f|",_e="wdlor",fe="RoamingOfficeActiveX.RoamingOffice",ye="application/x-vnd.officeondemand",ve="office:",Se="",Ce="",be="",Ae={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},Te={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},we={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5},Ie={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},Ee={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Ae,OpenDocumentOptions:Te,OpenDocumentFailureType:we,OpenDocumentControl:Ie,OfficeApplication:Ee,EditDocumentInClient:O,EditDocumentInClientParams:function(){this.DocumentUrl="",this.Mode=0,this.Options=0,this.Application=Ee.Unknown,this.CouldUseRoamingApps=!1,this.RoamingAppsLauncher="",this.ContinueIfLauncherIsNull=!1,this.ApplicationParameters="",this.RoamingPlatform="",this.RoamingApplicationExe="",this.RoamingBitsUrl="",this.SilentExternalHandler=!1,this.EncodeUrl=!1,this.CorrelationIdForWinClient=""},OfficeVersionInstalled:V,IsO14MacPluginInstalled:$,OfferOfficeInDialog:function(){return t()&&V()<=11},OfferOfficeNoIntrusive:function(){return t()&&V()<15},OfferMacOffice:function(){return a()&&!(window.navigator.userAgent.indexOf("PPC Mac")>=0)&&!$()},InstallRoamingControl:function(){c()?window.InstallTrigger.install({Office:{URL:Ce}}):y(be,null,null)},CanUseRoamingControl:function(){var e,t;if(o())return!0;if(p())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),Boolean(navigator.mimeTypes[ye]);if(c())return e=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(e),(t=document.createEvent("Events")).initEvent("RoamingOfficeInstalled",!0,!1),e.dispatchEvent(t),Boolean(e.getAttribute("installed"));if(l())try{return new ActiveXObject(fe).HrExists()}catch(e){}return!1},InitUrls:function(e,t,n){Se=e,Ce=n,be=t},LaunchRoamingApps:function(e,t,n,i,r,o){lt.ClientUtils.LaunchRoamingApps2(e,t,U(n),i,"x86",Se,r,o)},LaunchRoamingApps2:function(e,t,n,i,r,a,s,u){var d,h,g,m,f="";if(null!=i&&(f+=" "+i),null!=e&&(f+=' "'+e+'"'),o()||p())q=s,Q=u,d=ve,d+=' "'+a+'"',d+=' "'+n+'"',d+=' "ROAMING"',d+=' "'+t+'"',d+=' "'+r+'"',_(d+=" "+f,M,P,!1);else if(c())(h=document.createElement("RoamingExtensionElement")).setAttribute("cabUrl",a),h.setAttribute("app",n),h.setAttribute("licensingEntitlements",t),h.setAttribute("platform",r),h.setAttribute("args",f),document.documentElement.appendChild(h),(g=document.createEvent("Events")).initEvent("RoamingOfficeLaunch",!0,!1),h.dispatchEvent(g),null!=s&&s(Ie.RoamingFFExtension);else if(l()){if(null!=(m=new ActiveXObject(fe)))try{m.HrConfigureSingle(a,n,t,r,f),null!=s&&s(Ie.RoamingActiveX)}catch(e){}}else null!=u&&u(we.Failed)},ShouldShowDialog:function(){return!n()},NavigateToUrlUsingClickingOnATag:f,OpenDocumentWithProtocolHandler:I,OpenDocumentWithProtocolHandlerNoCallBack:function(e,t,n,i){var r=N(e);return null==r?(W(we.Unattempted,G.Application),!1):(_(w(e,t,n,i,r),null,null,!1),!0)}}}(),lt.ClientUtils=lt.ClientUtils;var gt=n(941),mt=function(){function e(){}return e.trace=b.ULS.sendTraceTag,e}();(0,h.l)(mt,"UULS",null,[]);var _t=n(347),ft=n(214),yt=n(703),vt=(0,h.y)("IPresenceContextMenuSectionBuilder"),St=n(813),Ct=n(733),bt=(0,h.y)("IControlBehaviorFactory"),At=(0,h.y)("IControlBehavior"),Tt=n(154),wt=n(951),It=n(926),Et=n(802),kt=n(753),Dt=n(488),Mt=n(513),Pt=n(912),Ft=n(946),xt=function(){function e(e){this.control=null,this._isCommitChangeFixEnabled=!1,this._activeElement=null,this._activeElementBounds=null,this._activeElementHovered=!1,this.control=e}return e.prototype.get_control=function(){return this.control},e.prototype.get_stateProperties=function(){return this.get_control().get_stateProperties()},e.prototype.get_root=function(){return this.get_control().get_root()},e.prototype.get_parentMenu=function(){return this.get_control().get_parentMenu()},e.prototype.get_activatesOnPress=function(){return this.get_control().get_activatesOnPress()},e.prototype.get_displayedComponent=function(){return this.get_control().get_displayedComponent()},e.prototype.get_controlComponentDomCache=function(){return this.get_control().get_controlComponentDomCache()},e.prototype.attachEvents=function(e){},e.prototype.initialize=function(){},e.prototype.doDefaultAction=function(e,t,n){this.get_control().doDefaultActionPublic(e,t,n)},e.prototype.pollForStateAndUpdate=function(){Mt.x(this.get_control().get_controlProperties().Command)||this.pollForStateAndUpdateInternal(this.get_control().get_controlProperties().Command,null,null)},e.prototype.pollForStateAndUpdateInternal=function(e,t,n){var i=0;return this.get_root()&&(i=this.get_root().pollForCommandState(e,t,n)),this.get_control().set_enabled((1&i)>0),i},e.prototype.updateVisibility=function(){var e=this.get_control().get_visible();return this.get_root().get_supportsInvisibleControls()&&(e=this.get_stateProperties()[Pt.b.visible])!==this.get_control().get_visible()&&(this.get_control().set_visible(e),this.get_root().needRefresh=!0),e},e.prototype.updateLabelText=function(){var e=Ft.n.validateStringProperty(this.get_stateProperties()[Pt.b.labelText],this.get_control().get_controlProperties().LabelText);this.setLabelText(e)},e.prototype.setLabelText=function(e){this.get_control().labelText!==e&&(this.get_controlComponentDomCache().forEach((function(t){t.setLabelText(e)})),this.get_control().labelText=e,this.get_root().needScaling=!0)},e.prototype.updateTooltip=function(){var e=Ft.n.validateStringProperty(this.get_stateProperties()[Pt.b.alt],this.get_control().get_controlProperties().Alt);this.setTooltip(e)},e.prototype.setTooltip=function(e){this.get_control().tooltip!==e&&(this.get_controlComponentDomCache().forEach((function(t){t.setTooltip(e)})),this.get_control().tooltip=e)},e.prototype.updateImage=function(){var e=Ft.n.validateStringProperty(this.get_stateProperties()[It.f.Image16by16Class],this.get_control().get_controlProperties().Image16by16Class),t=Ft.n.validateStringProperty(this.get_stateProperties()[It.f.Image32by32Class],this.get_control().get_controlProperties().Image32by32Class),n=Ft.n.validateStringProperty(this.get_stateProperties()[It.f.Image48by48Class],this.get_control().get_controlProperties().Image48by48Class),i=Mt.t(n)?t:n;this.applyImageCssClass(this.get_controlComponentDomCache().get_small(),e),this.applyImageCssClass(this.get_controlComponentDomCache().get_medium(),e),this.applyImageCssClass(this.get_controlComponentDomCache().get_large(),t),this.applyImageCssClass(this.get_controlComponentDomCache().get_smallMenu(),e),this.applyImageCssClass(this.get_controlComponentDomCache().get_largeMenu(),i)},e.prototype.applyImageCssClass=function(e,t){e&&(Mt.x(e.elmImage)||Mt.x(t)||e.elmImage.className===t||(e.elmImage.className=t))},e.prototype.updateDisplayMode=function(e){if(!Mt.t(e)&&this.get_root().get_supportsDynamicDisplayMode()){for(var t=0,n=this.get_control().get_components();t<n.length;t++){var i=n[t],r=i.get_displayMode()===e;r&&(!0,this.get_control().set_activeComponentWhenVisible(i)),this.get_control().get_visible()&&i.set_visibleInDOM(r)}this.get_control().get_visible()&&(this.get_root().needScaling=!0)}},e.prototype.adjustLayoutForLargeMenu=function(){if(this.get_controlComponentDomCache().get_largeMenu()&&this.get_controlComponentDomCache().get_largeMenu().elmLabel&&this.get_controlComponentDomCache().get_largeMenu().elmDescription){var e=this.get_controlComponentDomCache().get_largeMenu().elmLabel,t=Ft.n.validateStringProperty(this.get_stateProperties()[Et.e.Description],this.get_control().get_controlProperties().Description);Mt.t(t)&&(e.style.position="relative",e.style.top=(e.parentNode.offsetHeight-e.offsetHeight)/2+"px",e.style.padding="0px")}},e.prototype.onFocus=function(e){var t=this.get_displayedComponent();return h.r(kt.m,t)?this.get_parentMenu().updateFocusedIndex(t):this.get_root().set_controlWithFocus(this.get_control()),!1},e.prototype.onBlur=function(e){var t=this.get_displayedComponent();return this.get_control().isStandardMenuItem()&&Ft.n.removeCSSClassFromElement(t.get_elementInternal(),"cui-ctl-menu-hovered-without-focus"),this.get_root().set_controlWithFocus(null),!1},e.prototype.onPointerOver=function(e){if(this.get_control().isStandardMenuItem()){var t=this.get_parentMenu().get_stackIndex(),n=t===this.get_root().get_menuStackDepth()-1,i=n?null:this.get_root().get_menuLauncherStack()[t+1];this.closeChildMenus(!1),n||this.get_control()===i||Ft.n.removeCSSClassFromElement(i.get_launcher(),Dt.MenuLauncher.menuDroppedClassName),this.get_control().get_enabled()&&this.get_control().get_focusableElement()?n?this.get_control().setFocusOnControl():(Ft.n.ensureCSSClassOnElement(this.get_displayedComponent().get_elementInternal(),"cui-ctl-menu-hovered-without-focus"),i.set_elmHadFocus(this.get_control().get_focusableElement())):n?this.get_parentMenu().setFocus(e.get_inputSource()):(i.set_elmHadFocus(this.get_parentMenu().get_elementInternal()),this.get_parentMenu().resetFocusedIndex())}return!1},e.prototype.onPointerOut=function(e){return this.get_control().isStandardMenuItem()&&Ft.n.removeCSSClassFromElement(this.get_displayedComponent().get_elementInternal(),"cui-ctl-menu-hovered-without-focus"),!1},e.prototype.onKeyDown=function(e){var t=!1;if(!Mt.x(e.innerEvent)&&!Mt.x(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode,r=n.shiftKey;if(i===Sys.UI.Key.enter&&(t=!0),h.r(kt.m,this.get_displayedComponent())){var o=this.get_parentMenu();if(!Mt.x(o)){var a=o.get_stackIndex(),s=!this.get_root().get_textDirection(),l=!Mt.x(this.get_control().get_parentGrid());if(i!==Sys.UI.Key.tab&&i!==Sys.UI.Key.left&&i!==Sys.UI.Key.right&&i!==Sys.UI.Key.up&&i!==Sys.UI.Key.down&&i!==Sys.UI.Key.esc)return t;Tt.g.clearSelectionIfNecessary(),i!==Sys.UI.Key.tab||r?i===Sys.UI.Key.tab&&r?(o.focusNext(1),t=!0):i===Sys.UI.Key.left&&s||i===Sys.UI.Key.right&&!s?(l?o.focusNext(2):a>0&&this.get_root().closeMenuStackAtIndex(a,!0,!1),t=!0):i===Sys.UI.Key.right&&s||i===Sys.UI.Key.left&&!s?(l&&o.focusNext(4),t=!0):i===Sys.UI.Key.up?(o.focusNext(5),t=!0):i===Sys.UI.Key.down?(o.focusNext(6),t=!0):i===Sys.UI.Key.esc&&(this.get_root().closeMenuStackAtIndex(a,!0,!1),t=!0):(o.focusNext(0),t=!0)}}}return t},e.prototype.onKeyUp=function(e){var t=!1;if(!Mt.x(e.innerEvent)&&!Mt.x(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode;n.shiftKey;pe.KeyInputManager.hasKeyModifiers(e)||i!==Sys.UI.Key.enter&&i!==Sys.UI.Key.space||(t=this.handleDefaultActionWithKeytips(e))||(this.doDefaultAction(e.get_sourceElement(),1,e.innerEvent),t=!0)}return t},e.prototype.onPointerDown=function(e){if(this.commitRootPendingChanges(),this.get_activatesOnPress()){var t=!0;2===e.get_inputSource()&&(t=!e.get_mouseButton()),t&&this.get_displayedComponent()&&this.activateElement(this.get_displayedComponent().get_elementInternal())}return(e.innerEvent.type.toLowerCase()!==ie.d.touchStart||this.get_activatesOnPress())&&e.innerEvent.preventDefault(),!1},e.prototype.get_isCommitChangeFixEnabled=function(){return this._isCommitChangeFixEnabled},e.prototype.enableCommitChangeFix=function(){this._isCommitChangeFixEnabled=!0},e.prototype.commitRootPendingChanges=function(){this.get_isCommitChangeFixEnabled()&&this.get_control().get_root().commitAnyPendingChange()},e.prototype.onPointerUp=function(e){var t=!1;return!h.r(kt.m,this.get_displayedComponent())||this.get_activatesOnPress()||2!==e.get_inputSource()||e.get_mouseButton()?t=this.get_control().deactivateElement(e):(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0),t},e.prototype.onClick=function(e){var t=!1;return h.r(kt.m,this.get_displayedComponent())&&!this.get_activatesOnPress()&&3===e.get_inputSource()&&(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0),!Xe.y.get_isIPad()&&t},e.prototype.onTouchMove=function(e){return this.onActivePointerMove(e)},e.prototype.onTouchEnd=function(e){return this.deactivateElement(e),!1},e.prototype.onActivePointerMove=function(e){if(!Mt.x(this._activeElement)){var t=Tt.g.isPointInBounds(this.get_activeElementBounds(),e.get_clientPoint());return this.setActiveElementHovered(t),!0}return!1},e.prototype.onModalBodyPointerDown=function(e){var t=!1;return this.deactivateElement(e)&&(t=!0),3!==e.get_inputSource()&&(this.get_root().closeAllMenus(),t=!0),t},e.prototype.onModalBodyPointerUp=function(e){return this.deactivateElement(e)},e.prototype.onModalBodyPointerMove=function(e){return this.onActivePointerMove(e)},e.prototype.onModalBodyPointerOut=function(e){return this.deactivateElement(e)},e.prototype.onModalBodyClick=function(e){return 3===e.get_inputSource()&&(this.get_root().closeAllMenus(),!0)},e.prototype.onModalBodyMouseWheel=function(e){return!1},e.prototype.get_activeElementBounds=function(){return!Mt.x(this._activeElement)&&Mt.x(this._activeElementBounds)&&(this._activeElementBounds=Tt.g.getElementBounds(this._activeElement)),this._activeElementBounds},e.prototype.setActiveElementHovered=function(e){this._activeElementHovered!==e&&(this._activeElementHovered=e,this.activeElementStateChanged(this._activeElementHovered))},e.prototype.activeElementStateChanged=function(e){Mt.x(this._activeElement)||Ft.n.toggleCSSClassOnElement(this._activeElement,wt.Control.activeClassName,e)},e.prototype.activateElement=function(e){this.get_control().get_enabled()&&(this._activeElement=e,this.get_root().set_activeControl(this.get_control()),this.setActiveElementHovered(!0),this.get_root().beginModal(this.get_control(),!1))},e.prototype.deactivateElement=function(e){if(!Mt.x(this._activeElement)){if(this.setActiveElementHovered(!1),this.get_root()&&this.get_root().endModal(this.get_control(),!1),!Mt.x(e)){var t=e.get_clientPoint();Tt.g.isPointInBounds(this.get_activeElementBounds(),t)&&this.doDefaultAction(this._activeElement,e.get_inputSource(),e.innerEvent)}return this.get_root()&&this.get_root().set_activeControl(null),this._activeElement=null,this._activeElementBounds=null,!0}return!1},e.prototype.focusNext=function(e){var t=this.get_displayedComponent();return!(!h.r(kt.m,t)||2===e||4===e||Tt.g.isActiveElement(this.get_control().get_focusableElement()))&&this.setFocusOnControl()},e.prototype.setFocusOnControl=function(){try{if(this.get_control().get_visible()){var e=this.get_control().get_focusableElement();if(!Mt.x(e))return e.focus(),!0}}catch(e){}return!1},e.prototype.closeChildMenus=function(e){var t=this.get_parentMenu();Mt.x(t)||this.get_root().closeMenuStackAtIndex(t.get_stackIndex()+1,e)},e.prototype.onMenuClosed=function(){},e.prototype.handleDefaultActionWithKeytips=function(e){return!1},e.prototype.getTelemetryData=function(t){var n=null;return t&&t.rawEvent&&((n={})[e.triggerTime]=t.rawEvent.timeStamp),n},e.triggerTime="TriggerTime",e}();(0,h.l)(xt,"ControlBehavior",null,[At]);var Rt=n(427),Bt=n(25),Lt=function(e){function t(t){return e.call(this,t)||this}return(0,B.t)(t,e),t.prototype.get_button=function(){return this.get_control()},t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.attachEvents=function(e){var t=e.elmControl,n=e.get_displayMode();Mt.x(t)||(ne.z.get_instance().registerHandler(ie.d.focus,t,h.i(this,this.onFocus,"onFocus")),ne.z.get_instance().registerHandler(ie.d.blur,t,h.i(this,this.onBlur,"onBlur")),Ct.z.get_instance().registerHandler(ie.d.pointerOver,t,h.i(this,this.onPointerOver,"onPointerOver")),Ct.z.get_instance().registerHandler(ie.d.pointerOut,t,h.i(this,this.onPointerOut,"onPointerOut")),pe.KeyInputManager.get_instance().registerHandlerWithData(ie.d.keyDown,t,h.i(this,this.onKeyDown,"onKeyDown"),n),pe.KeyInputManager.get_instance().registerHandlerWithData(ie.d.keyPress,t,h.i(this,this.onKeyPress,"onKeyPress"),n),pe.KeyInputManager.get_instance().registerHandlerWithData(ie.d.keyUp,t,h.i(this,this.onKeyUp,"onKeyUp"),n),Ct.z.get_instance().registerHandler(ie.d.pointerDown,t,h.i(this,this.onPointerDown,"onPointerDown")),Ct.z.get_instance().registerHandler(ie.d.pointerUp,t,h.i(this,this.onPointerUp,"onPointerUp")),Rt.s.get_instance().registerHandler(ie.d.click,t,h.i(this,this.onClick,"onClick")),Bt.v.get_instance().registerHandler(ie.d.touchMove,t,h.i(this,this.onTouchMove,"onTouchMove")),Bt.v.get_instance().registerHandler(ie.d.touchEnd,t,h.i(this,this.onTouchEnd,"onTouchEnd")))},t.prototype.doDefaultAction=function(e,t,n){if(this.get_control().get_enabled()){var i=null;if(this.get_displayedComponent()&&this.get_displayedComponent().isMenuItem()&&this.get_parentMenu()){var r=this.get_parentMenu().get_stackIndex();(i=this.get_root().get_menuLauncherStack()[r])&&!this.get_isCommitChangeFixEnabled()&&(i.selectDropdownItem(this.get_button()),i=null)}this.executeCommand(this.get_control().get_controlProperties().Command,t,!0,n),i&&i.selectDropdownItem(this.get_button())}},t.prototype.executeCommand=function(e,t,n,i){if(!Mt.x(e)){var r=this.get_stateProperties();r.CommandValueId=this.get_button().getCommandValueId(),r.MenuItemId=this.get_button().getMenuItemId(),r.SourceControlId=this.get_control().get_id(),this.get_root().executeCommand(e,r,this.get_displayedComponent(),t,n,null,this.getTelemetryData(i))}},t.prototype.pollForStateAndUpdate=function(){Mt.x(this.get_control().get_controlProperties().Command)||(2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties()))>0&&this.updateVisibility()&&this.updateHtml()},t.prototype.updateHtml=function(){this.updateLabelText(),this.updateTooltip(),this.updateImage()},t.prototype.onFocus=function(t){return e.prototype.onFocus.call(this,t),this.startLivePreview(),!1},t.prototype.onBlur=function(t){return e.prototype.onBlur.call(this,t),this.endLivePreview(),!1},t.prototype.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!Mt.x(t.innerEvent)){var i=t.userData,r=t.innerEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(i,r)&&(n=!1)}return n},t.prototype.onKeyPress=function(e){var t=!1;if(!Mt.x(e.innerEvent)&&!Mt.x(e.innerEvent.rawEvent)){var n=e.userData,i=e.innerEvent.rawEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(n,i)?(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0):e.innerEvent.preventDefault()}return t},t.prototype.shouldDoDefaultActionOnKeyPress=function(e,t){if(Xe.y.get_isInternetExplorerNonEdge()&&t===Sys.UI.Key.enter)switch(e){case"MenuMru":case"MenuTemplate":case"MenuHeader":case"MenuFooter":return!0}return!1},t.prototype.onKeyUp=function(t){var n=!1;if(!Mt.x(t.innerEvent)){var i=t.userData,r=t.innerEvent.keyCode;this.shouldDoDefaultActionOnKeyPress(i,r)||(n=e.prototype.onKeyUp.call(this,t))}return n},t.prototype.startLivePreview=function(){this.get_control().get_enabled()&&this.executeCommand(this.get_properties().CommandPreview,0,!1,null)},t.prototype.endLivePreview=function(){this.get_control().get_enabled()&&this.executeCommand(this.get_properties().CommandRevert,0,!1,null)},t}(xt);(0,h.l)(Lt,"ButtonBehavior",xt,[]);var Nt=n(958),Ut=function(){function e(){}return e.Color="Color",e.IndexColorSelected="ColorSelected",e}();(0,h.l)(Ut,"ColorPickerCommandProperties",null,[]);var Ot=function(e){function t(t){var n=e.call(this,t)||this;return n._focusedIndex=-1,n._selectedIndex=-1,n}return(0,B.t)(t,e),t.prototype.get_colorPicker=function(){return this.get_control()},t.prototype.get_colorCells=function(){return this.get_colorPicker().get_colorPickerDom().colorCells},t.prototype.get_properties=function(){return this.get_colorPicker().get_controlProperties()},t.prototype.doDefaultAction=function(e,n,i){if(this.get_control().get_enabled()){var r=t.getNearestContainingParentElementOfType(e,"td"),o=this.get_stateProperties();o.Color=r[Nt.ColorPicker.colorInformation];var a=null;if(Ft.n.isTrue(this.get_properties().Stateful)&&this.get_displayedComponent()&&this.get_displayedComponent().isMenuItem()&&this.get_parentMenu()){var s=this.get_parentMenu().get_stackIndex();a=this.get_root().get_menuLauncherStack()[s]}this.get_root().executeCommand(this.get_properties().Command,o,this.get_displayedComponent(),n,!0,null,this.getTelemetryData(i)),a&&a.selectDropdownItem(this.get_colorPicker())}},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties();if(e.SourceControlId=this.get_properties().Id,(2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,e))>0){var t=-1;if(Ut.IndexColorSelected in this.get_stateProperties()&&(t=this.get_stateProperties()[Ut.IndexColorSelected]),t!==this._selectedIndex){var n=this.get_colorCells();0<=t&&t<n.length&&this.updateCellSelection(n[t],!0),0<=this._selectedIndex&&this._selectedIndex<n.length&&this.updateCellSelection(n[this._selectedIndex],!1),this._selectedIndex=t}}},t.prototype.updateCellSelection=function(e,t){t?Ft.n.ensureCSSClassOnElement(e,"cui-colorpicker-selected"):Ft.n.removeCSSClassFromElement(e,"cui-colorpicker-selected")},t.prototype.attachEvents=function(e){for(var t=e,n=0;n<t.aTags.length;++n){var i=t.aTags[n];ne.z.get_instance().registerHandler(ie.d.focus,i,h.i(this,this.onCellFocus,"onCellFocus")),ne.z.get_instance().registerHandler(ie.d.blur,i,h.i(this,this.onCellBlur,"onCellBlur")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyDown,i,h.i(this,this.onKeyDown,"onKeyDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyUp,i,h.i(this,this.onKeyUp,"onKeyUp")),Rt.s.get_instance().registerHandler(ie.d.click,i,h.i(this,this.onCellClick,"onCellClick")),Ct.z.get_instance().registerHandler(ie.d.pointerUp,i,h.i(this,this.onCellPointerUp,"onCellPointerUp")),Ct.z.get_instance().registerHandler(ie.d.pointerOver,i,h.i(this,this.onCellPointerOver,"onCellPointerOver")),Ct.z.get_instance().registerHandler(ie.d.pointerDown,i,h.i(this,this.onCellPointerDown,"onCellPointerDown"))}},t.prototype.onCellFocus=function(e){var n=t.getNearestContainingParentElementOfType(e.get_sourceElement(),"td");return this.get_parentMenu().updateFocusedIndex(this.get_displayedComponent()),this.updateCellFocus(n,!0),!0},t.prototype.onCellBlur=function(e){var n=t.getNearestContainingParentElementOfType(e.get_sourceElement(),"td");return this.updateCellFocus(n,!1),!0},t.prototype.updateCellFocus=function(e,t){t?(this._focusedIndex=parseInt(e.getAttribute("arrayPosition")),Ft.n.ensureCSSClassOnElement(e,"cui-colorpicker-hoveredOver"),this.startLivePreview(e)):(this._focusedIndex=-1,this.endLivePreview(e),Ft.n.removeCSSClassFromElement(e,"cui-colorpicker-hoveredOver"))},t.prototype.onCellClick=function(e){return 3===e.get_inputSource()&&this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),!0},t.prototype.onCellPointerUp=function(e){return 3!==e.get_inputSource()&&this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),!0},t.prototype.onCellPointerOver=function(e){this.closeChildMenus(!1);var n=t.getNearestContainingParentElementOfType(e.get_sourceElement(),"td"),i=parseInt(n.getAttribute("arrayPosition"));return this.setFocusOnCell(i),!0},t.prototype.onCellPointerDown=function(e){return!1},t.prototype.startLivePreview=function(e){if(this.get_control().get_enabled()){var t=this.get_properties().CommandPreview;if(!Mt.t(t)){var n=this.get_stateProperties();n.Color=e[Nt.ColorPicker.colorInformation],this.get_root().executeCommand(t,n,this.get_displayedComponent(),0,!1)}}},t.prototype.endLivePreview=function(e){if(this.get_control().get_enabled()){var t=this.get_properties().CommandRevert;if(!Mt.t(t)){var n=this.get_stateProperties();n.Color=e[Nt.ColorPicker.colorInformation],this.get_root().executeCommand(t,n,this.get_displayedComponent(),0,!1)}}},t.prototype.focusNext=function(e){var t=wt.Control.focusNextIndexInGrid(this._focusedIndex,this.get_colorPicker().get_width(),this.get_colorCells().length,e);return!(t===this._focusedIndex||!this.setFocusOnCell(t))||(this.updateCellFocus(this.get_colorCells()[this._focusedIndex],!1),!1)},t.prototype.setFocusOnControl=function(){return this.setFocusOnCell(0)},t.prototype.setFocusOnCell=function(e){if(this.get_colorCells()&&this.get_colorCells().length>e){var t=this.get_colorCells()[e];if(t.firstChild)return t.firstChild.focus(),!0}return!1},t.prototype.onMenuClosed=function(){-1!==this._focusedIndex&&this.updateCellFocus(this.get_colorCells()[this._focusedIndex],!1)},t.getNearestContainingParentElementOfType=function(e,n){return t.getNearestContainingParentElementOfTypes(e,[n])},t.getNearestContainingParentElementOfTypes=function(e,t){var n=t.length;if(!e)return null;for(var i=0;i<n;i++)if(e.tagName.toLowerCase()===t[i].toLowerCase())return e;for(var r=e.parentNode;r;){for(i=0;i<n;i++)if(r.tagName.toLowerCase()===t[i].toLowerCase())return r;r=r.parentNode}return null},t}(xt);(0,h.l)(Ot,"ColorPickerBehavior",xt,[]);var Ht=n(160),Wt=n(530),Vt=n(205),$t=n(600),Kt=(0,h.y)("IMenuLauncherBehavior"),zt=n(422),qt=n(400),Qt=n(150),Gt=function(){function e(){}return e.Callback="action",e}();(0,h.l)(Gt,"MenuLauncherAsyncTriggerCommandProperties",null,[]);var jt=n(713),Zt=function(){function e(e,t){this._floatMetricsGetter=null,this._floatMetricsSetter=null,this._savedFloatMetricsState=!1,this._usingFloatMetrics=!1,this._floatMetricsGetter=e,this._floatMetricsSetter=t,this.ensureUsingFloatMetrics()}return e.prototype.ensureUsingFloatMetrics=function(){this._usingFloatMetrics||(this._savedFloatMetricsState=this._floatMetricsGetter(),this._floatMetricsSetter(!0)),this._usingFloatMetrics=!0},e.prototype.doneUsingFloatMetrics=function(){this._usingFloatMetrics&&this._floatMetricsSetter(this._savedFloatMetricsState),this._usingFloatMetrics=!1},e.prototype.dispose=function(){this.doneUsingFloatMetrics()},e.create=function(){return new e(e.getUsingCssFloatMetrics,e.setUsingCssFloatMetrics)},e.getUsingCssFloatMetrics=function(){return window.document.msCSSOMElementFloatMetrics},e.setUsingCssFloatMetrics=function(e){window.document.msCSSOMElementFloatMetrics=e},e}();(0,h.l)(Zt,"CssFloatMetricsActivator",null,[Sys.IDisposable]);var Xt=n(861),Jt=n(395),Yt=function(){function e(e,t){this._textDirectionLtr=!1,this._isAppDivSyndicated=!1,this._textDirectionLtr=e,this._isAppDivSyndicated=t}return e.prototype.setFlyoutCoordinates=function(t,n,i,r){if(Mt.x(t)||Mt.x(n))return null;var o,a,s=new Jt.w,l=r.x,u=r.y,c=r.width,p=r.height,d=e.dictToInt(n,"flyoutWidth"),h=e.dictToInt(n,"flyoutRealHeight"),g=e.dictToInt(n,"viewportWidth"),m=e.dictToInt(n,"viewportHeight"),_=e.dictToInt(n,"viewableLeft"),f=e.dictToInt(n,"viewableTop"),y=this._textDirectionLtr,v=!1,S=!1,C=1===i,b=4===i,A=this._isAppDivSyndicated;if(t.style.maxHeight="none",t.style.top="0px",t.style.overflowY="visible",t.style.width="auto",d=this.measureWidth(t),s.viewPortHeight=m,s.viewPortWidth=g,C)y?o=l+c:(o=l-d,s.launchedLeft=!0),a=u;else{var T="";c>d&&(T=((d=c)-2*Xt.Menu.menuBorderPx).toString()),y?o=l:(o=l+c-d,s.launchedLeft=!0),a=u+p,""!==T&&(t.style.minWidth=T+"px")}A&&(a+=f,o+=_),t.style.top=a+"px",t.style.left=o+"px";var w=!1,I=!1;d<=g?o+d>_+g?(C&&y&&l-d>_||b&&l-d>_?(o=l-d,A&&(o+=_),s.launchedLeft=!0,I=!0):(o=_+g-d,v=!0),w=!0):o<_&&(C&&!y&&l+c+d<_+g?(o=l+c,A&&(o+=_),s.launchedLeft=!1,I=!0):(o=_,S=!0,s.launchedLeft=!0),w=!0):y?(o=_,w=!0,s.launchedLeft=!0):(o=_+g-d,w=!0,s.launchedLeft=!1),w&&(t.style.left=o+"px");var E,k,D,M,P=a+h<=f+m;(s.flyoutTop=a,P&&3!==i)||(s.launchedUp=!0,this.fitFlyoutVertically(i,a,h,u,f,m,(0,$t.m)((function(){return E}),(function(e){return E=e})),(0,$t.m)((function(){return k}),(function(e){return k=e})),(0,$t.m)((function(){return D}),(function(e){return D=e})),(0,$t.m)((function(){return M}),(function(e){return M=e}))),a!==E&&(t.style.top=E+"px",s.flyoutTop=E),k>-1&&(t.style.maxHeight=k+"px"),D&&(t.style.bottom="0px",t.style.height="auto"),M&&this.makeFlyoutScrollable(t,y,C,I,S,v,g,l,c));return s.flyoutLeft=o,s.flyoutWidth=d,s.flyoutHeight=h,s},e.prototype.fitFlyoutVertically=function(e,t,n,i,r,o,a,s,l,u){a.val=t,s.val=-1,l.val=!1,u.val=!1;var c=t,p=r+o-t;t=i-n;var d=this._isAppDivSyndicated,h=!1;t<0&&(t=r);var g=i;(d||(g-=r),n<=g&&1!==e)||(4===e||1===e?n<o?(t=o-n,l.val=!0):(t=r,l.val=!0,u.val=!0,h=!0):(g<p&&3!==e?(t=c,l.val=!0):s.val=g,u.val=!0));d&&(l.val=!1,h?s.val=o:t+=r),a.val=t},e.prototype.makeFlyoutScrollable=function(e,t,n,i,r,o,a,s,l){if(e.style.overflowY="scroll",e.style.width="auto",t){if(o||i){var u=o?0:a-s;e.style.left="",e.style.right=u+"px"}}else if(!r&&!i){u=n?a-s:a-s-l;e.style.left="",e.style.right=u+"px"}},e.prototype.getDimensionsForMenu=function(e){var t={};if(Mt.x(e))return t;t.viewportWidth=Ke.s.getViewPortWidth(),t.viewportHeight=Ke.s.getViewPortHeight(),Mt.x(t.viewportWidth)&&(t.viewportWidth=document.documentElement.clientWidth,t.viewportHeight=document.documentElement.clientHeight),Mt.x(t.viewportWidth)&&(t.viewportWidth=document.body.clientWidth,t.viewportHeight=document.body.clientHeight),t.viewableTop=window.pageYOffset,t.viewableLeft=window.pageXOffset,Mt.x(t.viewableTop)&&(t.viewableTop=document.documentElement.scrollTop,t.viewableLeft=document.documentElement.scrollLeft),Mt.x(t.viewableTop)&&(t.viewableTop=document.body.scrollTop,t.viewableLeft=document.body.scrollLeft),e.scrollHeight!==e.offsetHeight?t.flyoutRealHeight=e.scrollHeight+2*Xt.Menu.menuBorderPx:t.flyoutRealHeight=e.scrollHeight;var n=e.style.overflowY;return e.style.overflowY="visible",t.flyoutWidth=this.measureWidth(e),e.style.overflowY=n,t},e.prototype.measureWidth=function(e){return e.offsetWidth},e.dictToInt=function(e,t){return Mt.x(e)?0:e[t]},e}();(0,h.l)(Yt,"MenuPositioner",null,[]);var en=n(619),tn=n(176),nn=n(34),rn=n(506),on=n(509),an=n(748),sn=n(894),ln=n(899),un=n(435),cn=function(e){function t(t){var n=e.call(this,t)||this;return n.menuPositioner=null,n._menuInvocationMethod=0,n._lastDynamicPopulationXml=null,n._elmBackFrame=null,n._hasAsyncCallbackBeenSentToHandler=!1,n.polledOnce=!1,n._pendingBackFrameTimeoutId=-1,n.menuPositioner=new Yt(!n.get_root().get_textDirection(),Ft.n.isTrue(n.get_root().get_properties().DivSyndicated)),n}return(0,B.t)(t,e),t.prototype.get_menuPositioner=function(){return this.menuPositioner},t.prototype.get_menuLauncher=function(){return this.get_control()},t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.get_menu=function(){return this.get_menuLauncher().get_menu()},t.prototype.set_menu=function(e){return this.get_menuLauncher().set_menu(e),e},t.prototype.get_menuLaunched=function(){return this.get_menuLauncher().menuLaunched},t.prototype.set_menuLaunched=function(e){return this.get_menuLauncher().menuLaunched=e,e},t.prototype.get_backFrame=function(){return Mt.x(this._elmBackFrame)&&(this._elmBackFrame=t.createHiddenIframeElement()),this._elmBackFrame},t.prototype.get_shouldRestoreFocusToApp=function(){var e=!this.get_root().get_inModalMode();return h.r(Vt.u,this.get_root())&&1===this.get_root().get_menuStackDepth()&&(e=!0),e},t.prototype.doDefaultAction=function(e,t,n){h.r(Vt.u,this.get_root())&&this.get_root().ensureContextMenuDismissed(),this.get_menuLauncher().launchMenu(t)},t.prototype.launchMenu=function(e){if(this.get_menuLauncher().get_enabled()&&!this.get_menuLaunched()){var t=zt.y.get_instance().startActivity(se.wQ);t.get_properties().add("Id",this.get_menuLauncher().get_controlProperties().Id),t.get_properties().add("InputMethod",Qt.s[e]),t.end(),jt.t.mark(10326),Tt.g.measureTimeToNextFrame(this.get_menuLauncher().get_controlProperties().Id,"MenuOpen"),this.get_menuLauncher().get_focusableElement()&&this.get_menuLauncher().set_elmHadFocus(Tt.g.getActiveElement(this.get_menuLauncher().get_focusableElement().ownerDocument)),this._menuInvocationMethod=e,this.populateAndPositionMenu(e),this.sendNotifyAsyncMenuTrigger(),this.get_menuLauncher().updateAriaMenuLauncherAttributes(this.get_menuLauncher().get_focusableElement(),!0)}},t.prototype.sendNotifyAsyncMenuTrigger=function(){Mt.x(this.get_properties().PopulateAsyncTriggerCommand)||this._hasAsyncCallbackBeenSentToHandler||(this.notifyAsyncMenuTrigger(),this._hasAsyncCallbackBeenSentToHandler=!0)},t.prototype.notifyAsyncMenuTrigger=function(){var e={};e[Gt.Callback]=h.i(this,this.refreshMenuCallback,"refreshMenuCallback"),this.get_root().executeCommand(this.get_properties().PopulateAsyncTriggerCommand,e,this.get_displayedComponent(),0,!1)},t.prototype.refreshMenuCallback=function(){this.get_menuLauncher().refreshMenu()},t.prototype.refreshMenu=function(){this.get_menuLaunched()&&this.populateAndPositionMenu(this._menuInvocationMethod,!0)},t.prototype.populateAndPositionMenu=function(e,t){void 0===t&&(t=!1);var n=!0;if(Ft.n.isTrue(this.get_properties().PopulateDynamically)){var i=!1,r=this.pollForDynamicMenu(e);r!==this._lastDynamicPopulationXml&&(i=this.populateMenuFromXml(r,t)),n=i||!this.get_menuLaunched()}if(n){var o=l.AFrameworkApplication.get_activeFrame().get_theStopwatchBuilder(),a=null;o&&(a=o.makeAndStartStopwatch("LoadResource","Menu Initialization")),this.initializeMenu(e),a&&a.stop(),this.onMenuChanged()}},t.prototype.initializeMenu=function(e){if(Mt.x(this.get_menu()))jt.t.mark(10327);else{if(this.get_menuLauncher().parentKeytipsIds){var t=this.get_menuLauncher().get_displayedComponent();if(t&&t.get_keytip()){var n=t.get_keytip().get_key().toLocaleLowerCase();this.get_menu().setParentKeytipsIdsForMenuItems(String.format("{0} {1}",this.get_menuLauncher().parentKeytipsIds,t.get_keytip().get_elementId()),this.get_menuLauncher().parentKeytipsKeys&&""!==this.get_menuLauncher().parentKeytipsKeys?String.format("{0}-{1}",this.get_menuLauncher().parentKeytipsKeys,n):n)}}this.get_menu().ensureRefreshed(),Ft.n.ensureCSSClassOnElement(this.get_menu().get_elementInternal(),this.get_menuLauncher().get_additionalMenuCssClass());var i=3===e||this.get_root().get_touchModeForcedOn();if(Ft.n.toggleCSSClassOnElement(this.get_menu().get_elementInternal(),"cui-touch",i),this.get_menu().hasItems()){this.get_menu().attachEvents();var r=this.get_displayedComponent();r.ensureChildren(),r.set_ignoreDirtyingEvents(!0),r.addChild(this.get_menu()),r.set_ignoreDirtyingEvents(!1),this.get_menu().pollIfRootPolledSinceLastPoll();var o=h.r(un.b,this.get_root()),a=null,s=!1;o&&(s=(a=this.get_root()).shouldHandleElementResize,a.shouldHandleElementResize=!1);var u=this.get_menu().get_elementInternal();u.style.visibility="hidden",u.style.position="absolute",u.style.top="0px",u.style.left="0px",Xe.y.get_isInternetExplorerNonEdge()&&!Xe.y.get_isInternetExplorer9Up()&&(u.style.maxHeight="100px",u.style.overflowY="scroll"),document.body.appendChild(u),this.adjustMenuLayout(),this.positionMenu(u),Sys.Browser.agent===Sys.Browser.InternetExplorer&&this.addAndPositionBackFrame(),Ft.n.ensureCSSClassOnElement(this.get_menuLauncher().get_launcher(),Dt.MenuLauncher.menuDroppedClassName);var c=this.get_root().get_menuStackDepth();this.get_shouldGoModal()&&this.get_root().beginModal(this.get_control(),!0),u.style.zIndex=String(l.AFrameworkApplication.get_activeFrame().get_activeModalUIZIndex()),this.get_root().addMenuLauncherToStack(this.get_menuLauncher()),this.get_menu().set_stackIndex(c),u.style.visibility="visible";var p=this.getChildElementsToAnimate();if(h.r(an.m,this.get_menu())){u.style.position="fixed";var d=this.get_root().get_menuLauncherStack()[0];d&&d.get_menu()&&d.get_menu().get_elementInternal()?100!==Tt.g.getOpacity(this.get_root().get_menuLauncherStack()[0].get_menu().get_elementInternal())&&qt.o(u,p,h.i(this,this.afterShowMenu,"afterShowMenu")):qt.o(u,p,h.i(this,this.afterShowMenu,"afterShowMenu"))}else qt.o(u,p,h.i(this,this.afterShowMenu,"afterShowMenu"));this.set_menuLaunched(!0),this.get_menu().set_launched(!0),!Xe.y.get_isIPad()&&this.get_menuLauncher().get_sendFocusToMenuDrop()&&this.get_menu().setFocus(e),o&&(a.shouldHandleElementResize=s);var g=this.get_properties().CommandMenuOpen;Mt.t(g)||this.get_root().executeCommand(g,null,r,e,!1),jt.t.mark(10327)}else jt.t.mark(10327)}},t.prototype.onMenuChanged=function(){},t.prototype.addAndPositionBackFrame=function(){var e=this;Ft.n.cancelPendingTimeout((0,$t.m)((function(){return e._pendingBackFrameTimeoutId}),(function(t){return e._pendingBackFrameTimeoutId=t}))),this._pendingBackFrameTimeoutId=window.setTimeout(h.i(this,this.addAndPositionBackFrameInternal,"addAndPositionBackFrameInternal"),50)},t.prototype.addAndPositionBackFrameInternal=function(){this.get_menu()&&this.get_menu().get_elementInternal()&&(document.body.appendChild(this.get_backFrame()),this.positionBackFrame())},t.prototype.positionBackFrame=function(){var e=this.get_backFrame(),t=this.get_menu().get_elementInternal();e.style.position="absolute",e.style.visibility="hidden",e.style.left=t.style.left,e.style.right=t.style.right,e.style.top=t.style.top,e.style.bottom=t.style.bottom;var n=t.offsetWidth,i=t.offsetHeight;Xe.y.get_isInternetExplorer9Up()&&(n-=4,i-=4),e.style.width=n.toString()+"px",e.style.height=i.toString()+"px",e.style.visibility="visible"},t.prototype.get_shouldGoModal=function(){return!this.get_root().get_menuStackDepth()},t.prototype.afterShowMenu=function(e){e.get_element()&&(e.get_element().style.filter="",e.get_element().style.opacity="",this.get_menu()&&this.get_menu().get_elementInternal()===e.get_element()&&h.r(on.y,this.get_menu())&&qt.l(this.get_menu().get_elementInternal(),this.getChildElementsToAnimate()))},t.prototype.getChildElementsToAnimate=function(){var e=this.get_menu().get_children(),t=[];if(h.r(on.y,this.get_menu()))for(var n=0;n<e.get_count();n++){var i=e.get_item(n);Array.add(t,i.get_separator());for(var r=0;r<i.get_children().get_count();r++){var o=i.get_children().get_item(r);Array.add(t,o.get_elementInternal())}}return t},t.prototype.adjustMenuLayout=function(){for(var e=this.get_menu().get_children(),t=0;t<e.get_count();t++)for(var n=e.get_item(t).get_children(),i=0;i<n.get_count();i++){var r=n.get_item(i);if(h.r(kt.m,r)){var o=r;if("Menu32"===o.get_displayMode()||"Menu48"===o.get_displayMode()){var a=r.get_control();a.behavior&&(h.r(tn.d,a)||h.r(rn.g,a))&&a.behavior.adjustLayoutForLargeMenu()}}}if(e.get_count()>0){var s=e.get_item(0);Mt.x(s.get_separator())||(s.get_separator().style.display="none"),Mt.x(s.get_titleElement())||Ft.n.ensureCSSClassOnElement(s.get_titleElement(),"cui-menusection-titleAtTop")}},t.prototype.positionMenu=function(e){if(!Mt.x(e)){e.style.top="0px",e.style.left="0px",e.style.bottom="",e.style.right="",e.style.width="",e.style.minWidth="";var t=Zt.create();try{var n=this.get_menuPositioner().getDimensionsForMenu(e),i=this.getLauncherBounds(),r=this.get_root().setFlyoutCoordinates(e,n,this.get_menuLauncher().get_menuDirection(),i);r||(r=this.get_menuPositioner().setFlyoutCoordinates(e,n,this.get_menuLauncher().get_menuDirection(),i)),this.get_root().menuPositioningInfo=r}finally{t&&t.dispose()}}},t.prototype.getLauncherBounds=function(){var e=Tt.g.getElementBounds(this.get_menuLauncher().get_launcher()),t=this.get_parentMenu();if(!Mt.x(t)&&!Mt.x(t.get_elementInternal())){var n=Tt.g.getElementBounds(t.get_elementInternal());e.x=n.x+Xt.Menu.menuBorderPx,e.width=n.width-2*Xt.Menu.menuBorderPx}return h.r(ln.l,this.get_menuLauncher().get_launcherComponent())&&(e.height=0),e},t.prototype.closeMenu=function(){if(this.get_menuLauncher().menuLaunched){b.ULS.sendTraceTag(6688860,207,50,"Menu closing {0}",{Id:this.get_menuLauncher().get_controlProperties().Id}),this.get_menu().onMenuClosed(),this.removeMenuFromHierarchy(),this.set_menuLaunched(!1),this.get_menu().set_launched(!1),this.get_root().endModal(this.get_control(),!0),this.get_shouldRestoreFocusToApp()?l.AFrameworkApplication.get_activeFrame().restoreFocusAfterDismissingPopup(this.get_menuLauncher().get_elmHadFocus(),this._menuInvocationMethod):this.restoreFocusToElmHadFocus(),this.get_menuLauncher().set_elmHadFocus(null);var e=this.get_menuLauncher().get_launcher();Ft.n.removeCSSClassFromElement(e,Dt.MenuLauncher.menuDroppedClassName),this.get_menuLauncher().updateAriaMenuLauncherAttributes(this.get_menuLauncher().get_focusableElement(),!1),Ft.n.removeCSSClassFromElement(e,"cui-ctl-menu-hovered-without-focus"),this.get_menu().resetFocusedIndex();var t=this.get_properties().CommandMenuClose;Mt.t(t)||this.get_root().executeCommand(this.get_properties().CommandMenuClose,null,this.get_displayedComponent(),0,!1),this.removeMenuFromDom()}},t.prototype.restoreFocusToElmHadFocus=function(){var e=this.get_menuLauncher().get_elmHadFocus();if(e)try{e.focus()}catch(e){}else;},t.prototype.removeMenuFromDom=function(){Ke.s.removeElement(this.get_menu().get_elementInternal()),Ke.s.removeElement(this._elmBackFrame),Ft.n.unregisterAllHandlers(this.get_menu().get_elementInternal())},t.prototype.pollForDynamicMenu=function(e){if(this.polledOnce&&Ft.n.isTrue(this.get_properties().PopulateOnlyOnce))return null;if(Mt.x(this.get_properties().PopulateQueryCommand))return null;null==e&&(e=0);var t=this.get_menuLauncher().getCommandPopulateProperties();return(1&this.get_root().pollForCommandState(this.get_properties().PopulateQueryCommand,this.get_properties().PopulateQueryCommand,t,e))>0?t.PopulationXML:null},t.prototype.populateMenuFromXml=function(e,t){if(void 0===t&&(t=!1),this.polledOnce&&Ft.n.isTrue(this.get_properties().PopulateOnlyOnce))return!0;var n=null;if(this._lastDynamicPopulationXml=e,Mt.x(e)||(n=this.createMenuFromXml(e)),Mt.x(n)||(this.polledOnce=!0),t){if(this.get_root().clearMenuStack(this.get_menuLauncher()),Mt.x(n)||!n.hasItems())return this.closeMenu(),!1;this.removeMenuFromHierarchy(),this.removeMenuFromDom()}return this.setMenu(n),!0},t.prototype.onDynamicMenuPopulated=function(){},t.prototype.createMenuFromXml=function(e){var t=en.Builder.convertXMLStringToJSON(e);if(!Mt.x(t)){var n=new sn.g;n.cloneControlsForMenu=!0,n.parentId=this.get_control().get_id();var i;return i=h.r(nn.y,this.get_control()),this.get_root().get_builder().buildMenu(t,n,i)}return null},t.prototype.setMenu=function(e){Mt.x(e)||(Mt.x(this.get_menu())||this.get_menu().dispose(),this.set_menu(e),this.onDynamicMenuPopulated())},t.prototype.removeMenuFromHierarchy=function(){var e=this.get_menu().get_parent();e.set_ignoreDirtyingEvents(!0),e.removeChild(this.get_menu().get_id()),e.set_ignoreDirtyingEvents(!1)},t.prototype.onKeyDown=function(t){var n=!1;Mt.x(t.innerEvent)||Mt.x(t.innerEvent.rawEvent)||(h.r(kt.m,this.get_displayedComponent())||t.innerEvent.rawEvent.altKey&&t.innerEvent.keyCode===Sys.UI.Key.down&&(this.doDefaultAction(t.get_sourceElement(),1,t.innerEvent),n=!0));return n||(n=e.prototype.onKeyDown.call(this,t)),n},t.prototype.onPointerDown=function(e){return this.commitRootPendingChanges(),2===e.get_inputSource()&&e.get_mouseButton()||this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),e.innerEvent.preventDefault(),!1},t.prototype.handleDefaultActionWithKeytips=function(e){return!!(this.get_parentMenu()&&this.get_parentMenu().get_inKeytipMode()&&this.get_menuLauncher().onMenuLaunchCallback)&&(this.get_menuLauncher().onMenuLaunchCallback(this.get_displayedComponent(),e),!0)},t.createHiddenIframeElement=function(){var e=Ft.n.createElement("iframe");return e.style.position="absolute",e.style.visibility="hidden",e.style.borderWidth="0px",e},t}(xt);(0,h.l)(cn,"MenuLauncherBehavior",xt,[Kt,At]);var pn=n(184),dn=function(e){function t(t){return e.call(this,t)||this}return(0,B.t)(t,e),t.prototype.get_properties$2=function(){return this.get_dropDown().get_properties()},t.prototype.get_dropDown=function(){return this.get_control()},t.prototype.get_dropDownDom=function(){return this.get_dropDown().get_dropDownDom()},t.prototype.attachEvents=function(e){Ct.z.get_instance().registerHandler(ie.d.pointerDown,this.get_dropDownDom().elmControl,h.i(this,this.onPointerDown,"onPointerDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyDown,this.get_dropDownDom().elmControl,h.i(this,this.onKeyDown,"onKeyDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyUp,this.get_dropDownDom().elmControl,h.i(this,this.onKeyUp,"onKeyUp"))},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[pn.v.SelectedItemId];if((2&this.pollForStateAndUpdateInternal(this.get_properties$2().Command,this.get_properties$2().QueryCommand,this.get_stateProperties()))>0){var t=this.get_stateProperties()[pn.v.SelectedItemId];Mt.x(t)||e===t||this.get_dropDown().selectDropdownItemById(t)||(this.get_stateProperties()[pn.v.SelectedItemId]=null)}},t}(cn);(0,h.l)(dn,"DropDownBehavior",cn,[]);var hn=n(657),gn=n(830),mn=n(609),_n=n(153),fn=function(e){function t(t){var n=e.call(this,t)||this;return n._elmHadFocus=null,n._mouseupOnTextboxSinceFocus=!1,n._inputFocused=!1,n._needMenuContentsForAutocomplete=!1,n._pendingDropdownItemId=null,n._pendingAutoCompleteTimeoutId=-1,n}return(0,B.t)(t,e),t.prototype.get_comboBox=function(){return this.get_control()},t.prototype.get_comboBoxDom=function(){return this.get_comboBox().get_comboBoxDom()},t.prototype.get_cbProperties=function(){return this.get_comboBox().get_cbProperties()},t.prototype.get_isFreeForm=function(){return this.get_stateProperties()[mn.g.IsFreeForm]},t.prototype.set_isFreeForm=function(e){return this.get_stateProperties()[mn.g.IsFreeForm]=e,e},t.prototype.attachEvents=function(e){var t=e;Ct.z.get_instance().registerHandler(ie.d.pointerDown,t.elmControl,h.i(this,this.onPointerDown,"onPointerDown"));var n=t.elmInput;ne.z.get_instance().registerHandler(ie.d.focus,n,h.i(this,this.onInputFocus,"onInputFocus")),ne.z.get_instance().registerHandler(ie.d.blur,n,h.i(this,this.onInputBlur,"onInputBlur")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyDown,n,h.i(this,this.onInputKeyDown,"onInputKeyDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyPress,n,h.i(this,this.onInputKeyPress,"onInputKeyPress")),gn.p.get_instance().registerHandler(ie.d.mouseUp,n,h.i(this,this.onInputMouseUp,"onInputMouseUp")),Ct.z.get_instance().registerHandler(ie.d.pointerDown,n,h.i(this,this.onInputPointerDown,"onInputPointerDown")),Ct.z.get_instance().registerHandler(ie.d.pointerDown,t.elmBtnA,h.i(this,this.onMenuButtonPointerDown,"onMenuButtonPointerDown"))},t.prototype.pollForStateAndUpdate=function(){(2&this.pollForStateAndUpdateInternal(this.get_cbProperties().Command,this.get_cbProperties().QueryCommand,this.get_stateProperties()))>0&&(this._inputFocused||this.updateValueAndSelectedControl(),this.updateFontStyle())},t.prototype.onDynamicMenuPopulated=function(){this.get_comboBox().set_menuItems(null);var e=null,t=null,n=null;if(!Mt.x(this.get_menu())){this.setAriaOwnsAttributeWithMenuId();for(var i=this.get_menu().get_children().getEnumerator();i.moveNext();)for(var r=i.get_current().get_children().getEnumerator();r.moveNext();){var o=r.get_current();h.r(kt.m,o)&&(e=o.get_control(),h.r(Ht.a,e)&&(t=e.getMenuItemId()),h.r(Wt.x,e)&&(n=e.getTextValue()),Mt.x(t)||Mt.x(n)||(this.get_comboBox().get_menuItems()[n]=t,n=null,t=null))}}},t.prototype.onInputPointerDown=function(e){return h.r(Vt.u,this.get_root())&&2===e.get_inputSource()&&(this._elmHadFocus=Tt.g.getActiveElement(this.get_control().get_focusableElement().ownerDocument),this.get_control().get_focusableElement().focus()),!1},t.prototype.onPointerDown=function(t){this.commitRootPendingChanges();var n=!1;return 3===t.get_inputSource()&&(n=e.prototype.onPointerDown.call(this,t),this.setAriaOwnsAttributeWithMenuId()),n&&t.innerEvent.preventDefault(),!1},t.prototype.onMenuButtonPointerDown=function(e){var t=!1;return 2===e.get_inputSource()&&e.get_mouseButton()||(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),this.setAriaOwnsAttributeWithMenuId(),t=!0),t&&e.innerEvent.preventDefault(),!1},t.prototype.onInputKeyDown=function(e){var t=!1;if(!Mt.x(e.innerEvent)&&!Mt.x(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode,r=n.shiftKey;n.altKey,Ft.n.isTrue(this.get_cbProperties().AutoComplete);if(i===Sys.UI.Key.enter)this.commitPendingChange(),this.restoreFocusFromFloatie(),h.r(_n.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0;else if(i===Sys.UI.Key.tab){if(this.commitPendingChange(),this.restoreFocusFromFloatie(),h.r(_n.Ribbon,this.get_root())&&(t=this.get_root().wrapKeyboardFocus(this.get_displayedComponent().get_elementInternal(),!r)),h.r(Vt.u,this.get_root()))return!0}else i===Sys.UI.Key.backspace||i===Sys.UI.Key.del?this.get_control().get_enabled()?(this.cancelPendingAutoComplete(),this._pendingDropdownItemId=null):t=!0:i===Sys.UI.Key.esc?(this.restoreToKnownValue(),this.restoreFocusFromFloatie(),h.r(_n.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0):i===Sys.UI.Key.down&&(this.launchMenu(1),this.setAriaOwnsAttributeWithMenuId(),t=!0)}return t},t.prototype.onInputKeyPress=function(e){return!this.get_control().get_enabled()||(!Mt.x(e.innerEvent)&&e.innerEvent.charCode&&this.delayAutoComplete(),!1)},t.prototype.onInputMouseUp=function(e){return!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0)},t.prototype.executeAutoComplete=function(){this._pendingAutoCompleteTimeoutId=-1;var e=this.get_comboBoxDom().elmInput,t=e.value,n=this.getFirstMenuItemThatBeginsWith(t);if(n){if(e.value=n.key,e.setSelectionRange)e.setSelectionRange(t.length,e.value.length);else if(e.createTextRange){var i=e.createTextRange();i.moveStart("character",t.length),i.moveEnd("character",e.value.length),i.select()}this._pendingDropdownItemId=n.value}else this._pendingDropdownItemId=null},t.prototype.getFirstMenuItemThatBeginsWith=function(e){var t=this.get_comboBox().get_menuItems();for(var n in t){var i={key:n,value:t[n]};if(i.key.toLowerCase().startsWith(e.toLowerCase()))return i}return null},t.prototype.delayAutoComplete=function(){Ft.n.isTrue(this.get_cbProperties().AutoComplete)&&-1===this._pendingAutoCompleteTimeoutId&&(this._needMenuContentsForAutocomplete&&(this.pollForDynamicMenu(0),this._needMenuContentsForAutocomplete=!1),this._pendingAutoCompleteTimeoutId=window.setTimeout(h.i(this,this.executeAutoComplete,"executeAutoComplete"),this.get_comboBox().get_autoCompleteDelay()))},t.prototype.cancelPendingAutoComplete=function(){var e=this;Ft.n.isTrue(this.get_cbProperties().AutoComplete)&&Ft.n.cancelPendingTimeout((0,$t.m)((function(){return e._pendingAutoCompleteTimeoutId}),(function(t){return e._pendingAutoCompleteTimeoutId=t})))},t.prototype.onInputFocus=function(t){return this.get_menuLaunched()?(this.get_menu().setFocus(0),!0):(h.r(Vt.u,this.get_root())&&(hn.FocusManager.instance().scopeChanged("ribbon"),this.get_root().set_hasShynessBehavior(!1)),e.prototype.onFocus.call(this,t),this._inputFocused=!0,Ft.n.ensureCSSClassOnElement(this.get_comboBoxDom().elmControl,"cui-cb-focus"),Ft.n.isTrue(this.get_cbProperties().PopulateDynamically)&&(this._needMenuContentsForAutocomplete=!0),Tt.g.selectAllTextInInput(this.get_comboBoxDom().elmInput),Mt.x(this.get_menu())||this.get_menu().refreshInternal(),this._mouseupOnTextboxSinceFocus=!1,!1)},t.prototype.onInputBlur=function(e){return this._inputFocused=!1,this.commitPendingChange(),Ft.n.removeCSSClassFromElement(this.get_comboBoxDom().elmControl,"cui-cb-focus"),!1},t.prototype.restoreFocusFromFloatie=function(){h.r(Vt.u,this.get_root())&&(void 0!==this._elmHadFocus&&null!==this._elmHadFocus&&l.AFrameworkApplication.get_activeFrame().restoreFocusAfterDismissingPopup(this._elmHadFocus,2),this._elmHadFocus=null)},t.prototype.commitPendingChange=function(){if(this.get_control().get_enabled()){this.cancelPendingAutoComplete();var e=this.get_comboBoxDom().elmInput;if(void 0!==this.get_stateProperties()[mn.g.Value]&&null!==this.get_stateProperties()[mn.g.Value]&&e.value===this.get_stateProperties()[mn.g.Value].toString())return;if(this.get_comboBox().selectDropdownItemById(this._pendingDropdownItemId)){this.set_isFreeForm(!1),this.get_stateProperties()[mn.g.Value]=e.value;n={IsFreeForm:!1,CommandValueId:this.get_comboBox().get_selectedControl().getCommandValueId(),MenuItemId:this.get_comboBox().get_selectedControl().getMenuItemId()};this.get_root().executeCommand(this.get_cbProperties().Command,n,this.get_displayedComponent(),0,!1)}else{if(!Ft.n.isTrue(this.get_cbProperties().AutoComplete)){var t=this.get_comboBox().get_menuItems()[e.value];if(!Mt.t(t)&&this.get_comboBox().selectDropdownItemById(t)){this.set_isFreeForm(!1),this.get_stateProperties()[mn.g.Value]=e.value;var n={IsFreeForm:!1,CommandValueId:this.get_comboBox().get_selectedControl().getCommandValueId(),MenuItemId:t};return void this.get_root().executeCommand(this.get_cbProperties().Command,n,this.get_displayedComponent(),0,!1)}}var i=!Mt.t(e.value)&&""!==j.l.removeAllWhitespace(e.value);if(!this.get_comboBox().get_allowFreeForm()||!i)return void this.restoreToKnownValue();this.set_isFreeForm(!0),this.get_stateProperties()[mn.g.Value]=e.value;var n={IsFreeForm:!0,Value:e.value};this.get_root().executeCommand(this.get_cbProperties().Command,n,this.get_displayedComponent(),0,!1)}}else this.restoreToKnownValue()},t.prototype.restoreToKnownValue=function(){this.cancelPendingAutoComplete(),this._pendingDropdownItemId=null,this.updateValueAndSelectedControl()},t.prototype.updateValueAndSelectedControl=function(){var e=this.get_stateProperties()[mn.g.Value]||"";e!==this.get_comboBoxDom().elmInput.value&&(this.get_comboBoxDom().elmInput.value=e),this.get_comboBox().selectDropdownItemById(this.get_comboBox().get_menuItems()[e])},t.prototype.updateFontStyle=function(){var e=this.get_stateProperties()[mn.g.FontStyle]||"normal";e!==this.get_comboBoxDom().elmInput.style.fontStyle&&(this.get_comboBoxDom().elmInput.style.fontStyle=e)},t.prototype.setAriaOwnsAttributeWithMenuId=function(){this.get_control().get_focusableElement()&&this.get_menu()&&this.get_control().get_focusableElement().setAttribute(ze.t.ariaOwnsAttribute,this.get_menu().get_id())},t}(dn);(0,h.l)(fn,"ComboBoxBehavior",dn,[]);var yn=function(e){function t(t){return e.call(this,t)||this}return(0,B.t)(t,e),t.prototype.get_contextMenuLauncher=function(){return this.get_control()},t.prototype.getLauncherBounds=function(){var e=0;return this.get_menu()&&this.get_menu().get_elementInternal()&&2===this.get_menu().get_horizontalAlignment()&&(e=this.get_menu().get_elementInternal().clientWidth),new Sys.UI.Bounds(this.get_contextMenuLauncher().get_x()-e,this.get_contextMenuLauncher().get_y(),this.get_contextMenuLauncher().get_launcherWidth(),this.get_contextMenuLauncher().get_launcherHeight())},t}(cn);(0,h.l)(yn,"ContextMenuLauncherBehavior",cn,[]);var vn=function(e){function t(t){return e.call(this,t)||this}return(0,B.t)(t,e),t.prototype.get_dialogMenuLauncher=function(){return this.get_control()},t.prototype.getLauncherBounds=function(){return new Sys.UI.Bounds(this.get_dialogMenuLauncher().get_x(),this.get_dialogMenuLauncher().get_y(),this.get_dialogMenuLauncher().get_launcherWidth(),this.get_dialogMenuLauncher().get_launcherHeight())},t}(cn);(0,h.l)(vn,"DialogMenuLauncherBehavior",cn,[]);var Sn=n(833),Cn=function(e){function t(t){var n=e.call(this,t)||this;return n._shouldRefreshWhenDropped=!1,n._needToRefreshAfterMenuClose=!1,n._shouldRefreshWhenDropped=!Ft.n.isFalse(n.get_properties$2().ShouldRefreshWhenDropped),n}return(0,B.t)(t,e),t.prototype.get_flyoutAnchor=function(){return this.get_control()},t.prototype.get_properties$2=function(){return this.get_control().get_controlProperties()},t.prototype.attachEvents=function(e){var t=e.elmControl;Mt.x(t)||(ne.z.get_instance().registerHandler(ie.d.focus,t,h.i(this,this.onFocus,"onFocus")),ne.z.get_instance().registerHandler(ie.d.blur,t,h.i(this,this.onBlur,"onBlur")),Ct.z.get_instance().registerHandler(ie.d.pointerOver,t,h.i(this,this.onPointerOver,"onPointerOver")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyDown,t,h.i(this,this.onKeyDown,"onKeyDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyUp,t,h.i(this,this.onKeyUp,"onKeyUp")),Ct.z.get_instance().registerHandler(ie.d.pointerDown,t,h.i(this,this.onPointerDown,"onPointerDown")))},t.prototype.pollForStateAndUpdate=function(){if(!Mt.x(this.get_control().get_controlProperties().Command))if(!this.get_flyoutAnchor().menuLaunched||this._shouldRefreshWhenDropped){if((2&this.pollForStateAndUpdateInternal(this.get_properties$2().Command,this.get_properties$2().QueryCommand,this.get_stateProperties()))>0)this.updateVisibility()&&this.updateHtml();Ft.n.isTrue(this.get_properties$2().RefreshableMenu)&&this.get_menuLaunched()&&this.get_menu().pollMenuState()}else this._needToRefreshAfterMenuClose=!0},t.prototype.updateHtml=function(){this.updateFlyoutLabelText(),this.updateImage(),this.updateImageBackgroundColor(),this.get_flyoutAnchor().set_imageIsVisible(this.get_stateProperties()[Sn.g.ImageIsVisible])},t.prototype.updateFlyoutLabelText=function(){var e=Ft.n.validateStringProperty(this.get_stateProperties()[Sn.g.LabelText],this.get_properties$2().LabelText),t=this.get_stateProperties()[Sn.g.LabelTextUserGeneratedPlaceholderReplacements];this.get_control().labelText===e&&this.get_properties$2().LabelTextUserGeneratedPlaceholderReplacements===t||(this.get_controlComponentDomCache().get_medium()&&this.updateFlyoutLabelTextDom(this.get_controlComponentDomCache().get_medium().elmLabel,e,t),this.get_controlComponentDomCache().get_large(),this.get_root().needScaling=!0,this.get_control().labelText=e,this.get_properties$2().LabelTextUserGeneratedPlaceholderReplacements=t)},t.prototype.updateFlyoutLabelTextDom=function(e,t,n){var i=e.lastChild;Ft.n.setControlText(e,t+" ",n);var r=Mt.x(i);b.ULS.sendTraceTag(38535884,207,50,"FlyoutAnchorBehaviorUpdate.FlyoutLabelTextDom: arrow type: {0}",r?"":i.nodeType.toString()),r||e.appendChild(i)},t.prototype.updateImageBackgroundColor=function(){var e=this.get_stateProperties()[Sn.g.ImageBackColor];this.get_controlComponentDomCache().forEach((function(n){t.applyColorToImage(n.elmImage,e)}))},t.prototype.launchMenu=function(t){"faPrint"===this.get_control().get_id()&&"jewelWordEditor"===this.get_control().get_root().get_id()&&(l.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.SessionSettings.IWacWordPrintToWebSettings"),l.AFrameworkApplication.get_theActionManager().processAction(se.Zq,2)),"faRemix"!==this.get_control().get_id()&&"faTransform"!==this.get_control().get_id()&&"faPublish"!==this.get_control().get_id()||"jewelWordEditor"!==this.get_control().get_root().get_id()||l.AFrameworkApplication.get_theActionManager().processAction(se.Zq,2),h.r(kt.m,this.get_displayedComponent())&&(this.get_menuLaunched()||this.closeChildMenus(!0),this.get_control().get_enabled()&&this.setFocusOnControl()),e.prototype.launchMenu.call(this,t)},t.prototype.closeMenu=function(){e.prototype.closeMenu.call(this),this._needToRefreshAfterMenuClose&&(this._needToRefreshAfterMenuClose=!1,this.pollForStateAndUpdate())},t.prototype.onPointerOver=function(t){return this.get_control().isStandardMenuItem()?(this.get_flyoutAnchor().menuLaunched?(this.get_root().cancelPendingCloseMenuStack(),Ft.n.ensureCSSClassOnElement(this.get_flyoutAnchor().get_launcher(),Dt.MenuLauncher.menuDroppedClassName),this.get_flyoutAnchor().set_elmHadFocus(this.get_control().get_focusableElement())):(e.prototype.onPointerOver.call(this,t),this.doDefaultAction(t.get_sourceElement(),t.get_inputSource(),t.innerEvent)),!1):e.prototype.onPointerOver.call(this,t)},t.prototype.onKeyDown=function(t){var n=!1;if(!Mt.x(t.innerEvent)&&!Mt.x(t.innerEvent.rawEvent)){if(h.r(kt.m,this.get_displayedComponent())){var i=t.innerEvent.rawEvent,r=t.innerEvent.keyCode,o=!this.get_root().get_textDirection();i.shiftKey||i.ctrlKey||!(r===Sys.UI.Key.right&&o||r===Sys.UI.Key.left&&!o)||(n=this.handleDefaultActionWithKeytips(t))||(this.doDefaultAction(t.get_sourceElement(),1,t.innerEvent),n=!0)}n||(n=e.prototype.onKeyDown.call(this,t))}return n},t.applyColorToImage=function(e,t){Mt.x(e)||Mt.x(t)||e.style.backgroundColor===t||(e.style.backgroundColor=t)},t}(cn);(0,h.l)(Cn,"FlyoutAnchorBehavior",cn,[]);var bn=n(881),An=function(e){function t(t){return e.call(this,t)||this}return(0,B.t)(t,e),t.prototype.get_galleryButton=function(){return this.get_control()},t.prototype.get_properties=function(){return this.get_galleryButton().get_properties()},t.prototype.get_componentDom=function(){return this.get_galleryButton().componentDom},t.prototype.attachEvents=function(e){var t=e.elmA;ne.z.get_instance().registerHandler(ie.d.focus,t,h.i(this,this.onFocus,"onFocus")),ne.z.get_instance().registerHandler(ie.d.blur,t,h.i(this,this.onBlur,"onBlur")),Ct.z.get_instance().registerHandler(ie.d.pointerOver,t,h.i(this,this.onPointerOver,"onPointerOver")),Ct.z.get_instance().registerHandler(ie.d.pointerOut,t,h.i(this,this.onPointerOut,"onPointerOut")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyDown,t,h.i(this,this.onKeyDown,"onKeyDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyUp,t,h.i(this,this.onKeyUp,"onKeyUp")),Ct.z.get_instance().registerHandler(ie.d.pointerDown,t,h.i(this,this.onPointerDown,"onPointerDown")),Ct.z.get_instance().registerHandler(ie.d.pointerUp,t,h.i(this,this.onPointerUp,"onPointerUp")),Bt.v.get_instance().registerHandler(ie.d.touchMove,t,h.i(this,this.onTouchMove,"onTouchMove")),Bt.v.get_instance().registerHandler(ie.d.touchEnd,t,h.i(this,this.onTouchEnd,"onTouchEnd"))},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[bn.u.On],t=this.get_stateProperties()[bn.u.IsRtl];if(this.updateStateProperties(),(2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties()))>0){var n=!Mt.x(this.get_stateProperties()[bn.u.InnerHTML])||!Mt.x(this.get_properties().InnerHTML),i=!Mt.x(this.get_properties().Image);n||i||this.get_control().set_enabled(!1);var r=this.get_componentDom().elmA;if(!Mt.x(r)){if(n){var o=Ft.n.validateStringProperty(this.get_stateProperties()[bn.u.InnerHTML],this.get_properties().InnerHTML);null!==r.innerHTML&&null!==o&&j.l.toLower(r.innerHTML)===j.l.toLower(o)||(r.innerHTML=o),""===o&&this.get_control().set_enabled(!1)}var a=r.title,s=Ft.n.validateStringProperty(this.get_stateProperties()[bn.u.Alt],this.get_properties().Alt);s===a||this.get_control().get_shouldIgnoreTitle()||(r.title=s)}var l=this.get_stateProperties()[bn.u.On],u=this.get_stateProperties()[bn.u.IsRtl];e===l&&t===u||this.get_control().onStateChanged()}},t.prototype.updateStateProperties=function(){var e=this.get_stateProperties();e[bn.u.CommandValueId]=this.get_control().getCommandValueId(),e.MenuItemId=this.get_control().getMenuItemId(),e.SourceControlId=this.get_properties().Id},t.prototype.doDefaultAction=function(e,t,n){var i=this.get_displayedComponent();if(i&&this.get_control().get_enabled()){var r=this.get_root();if(l.AFrameworkApplication.appSettingsManager&&l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelBorderMenuCompactionEnabled")&&i.isMenuItem()&&this.get_parentMenu()){var o=this.get_parentMenu().get_stackIndex(),a=r.get_menuLauncherStack()[o];a?a.selectDropdownItem(this.get_galleryButton()):b.ULS.sendTraceTag(41034837,207,15,"GalleryButtonBehavior.DoDefaultAction: Did not get Menulauncher for the menu item.")}this.updateStateProperties(),this.get_stateProperties()[bn.u.On]||(this.get_stateProperties()[bn.u.On]=!0,this.get_control().onStateChanged()),"Menu"===i.get_displayMode()&&Ft.n.removeCSSClassFromElement(this.get_componentDom().elmControl,"cui-gallerybutton-focused"),r.executeCommand(this.get_properties().Command,this.get_stateProperties(),i,t,!0,null,this.getTelemetryData(n))}},t.prototype.onFocus=function(t){return e.prototype.onFocus.call(this,t),Ft.n.ensureCSSClassOnElement(this.get_componentDom().elmControl,"cui-gallerybutton-focused"),!1},t.prototype.onBlur=function(t){return e.prototype.onBlur.call(this,t),Ft.n.removeCSSClassFromElement(this.get_componentDom().elmControl,"cui-gallerybutton-focused"),!1},t}(xt);(0,h.l)(An,"GalleryButtonBehavior",xt,[]);var Tn=n(230),wn=function(){function e(){}return e.Rows="Rows",e.Columns="Columns",e}();(0,h.l)(wn,"InsertTableCommandProperties",null,[]);var In=n(345),En=function(e){function t(t){var n=e.call(this,t)||this;return n._oldIdx=-1,n}return(0,B.t)(t,e),t.prototype.get_insertTableControl=function(){return this.get_control()},t.prototype.get_properties=function(){return this.get_insertTableControl().get_controlProperties()},t.prototype.get_commandProperties=function(){return this.get_insertTableControl().get_commandProperties()},t.prototype.get_hostMenuSection=function(){var e=null;if(this.get_displayedComponent()){var t=this.get_displayedComponent().get_parent();if(!h.r(In.z,t))throw Error.create("InsertTable must live inside of a MenuSection.");e=t}return e},t.prototype.get_innerDivs=function(){return this.get_insertTableControl().get_insertTableDom().innerDivs},t.prototype.get_outerDivs=function(){return this.get_insertTableControl().get_insertTableDom().outerDivs},t.prototype.doDefaultAction=function(e,t,n){if(this.get_control().get_enabled()){var i=this.getIndexFromElement(this.getCellOuterDiv(e)),r=this.getColFromIndex(i),o=this.getRowFromIndex(i);this.get_commandProperties()[wn.Rows]=o+1,this.get_commandProperties()[wn.Columns]=r+1,this.get_root().executeCommand(this.get_properties().Command,this.get_commandProperties(),this.get_displayedComponent(),t,!0,null,this.getTelemetryData(n))}},t.prototype.attachEvents=function(e){var t=e,n=t.elmControl,i=t.cellATags,r=t.cells;Ct.z.get_instance().registerHandler(ie.d.pointerOut,n,h.i(this,this.onControlPointerOut,"onControlPointerOut")),Bt.v.get_instance().registerHandler(ie.d.touchMove,n,h.i(this,this.onControlTouchMove,"onControlTouchMove")),Bt.v.get_instance().registerHandler(ie.d.touchEnd,n,h.i(this,this.onControlTouchEnd,"onControlTouchEnd"));for(var o=0;o<r.length;++o)this.attachCellEvents(i[o],r[o])},t.prototype.attachCellEvents=function(e,t){ne.z.get_instance().registerHandler(ie.d.focus,e,h.i(this,this.onCellFocus,"onCellFocus")),Ct.z.get_instance().registerHandler(ie.d.pointerOver,t,h.i(this,this.onCellPointerOver,"onCellPointerOver")),Ct.z.get_instance().registerHandler(ie.d.pointerUp,t,h.i(this,this.onCellPointerUp,"onCellPointerUp")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyDown,t,h.i(this,this.onKeyDown,"onKeyDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyUp,t,h.i(this,this.onKeyUp,"onKeyUp")),Bt.v.get_instance().registerHandler(ie.d.touchStart,t,h.i(this,this.onCellTouchStart,"onCellTouchStart"))},t.prototype.getIndexFromElement=function(e){return parseInt(e.id.substr(this.get_insertTableControl().get_id().length+1))},t.prototype.handleHighlightingTitle=function(e){this.handleHighlightingAndTitleForIndex(this.getIndexFromElement(e))},t.prototype.getRowFromIndex=function(e){return Math.floor(e/Tn.o.numCols)},t.prototype.getColFromIndex=function(e){return e%Tn.o.numCols},t.prototype.handleHighlightingAndTitleForIndex=function(e){if(e!==this._oldIdx){var t=this.getColFromIndex(e),n=this.getRowFromIndex(e),i=-1,r=-1;for(-1!==this._oldIdx&&(i=this.getRowFromIndex(this._oldIdx),r=this.getColFromIndex(this._oldIdx));i!==n||r!==t;)i<n?this.setRowHighlighting(++i,r,!0):i>n?(this.setRowHighlighting(i,r,!1),i--):r<t?this.setColHighlighting(++r,i,!0):r>t&&(this.setColHighlighting(r,i,!1),r--);if(this.get_hostMenuSection())this.get_hostMenuSection().setTitleImmediate(this.getCellTitle(n+1,t+1));else{var o=this.get_control().get_components(),a=o&&o.length>0?o[0]:null,s=this.get_displayedComponent();b.ULS.sendTraceTag(19748692,207,15,"Insert table menu is NULL. {0}",{CtrlComps:!!o,FirstComp:!!a,FirstCompPar:!!a&&!!a.get_parent(),DispComp:!!s,DispCompPar:!!s&&!!s.get_parent()})}this._oldIdx=e}},t.prototype.setRowHighlighting=function(e,t,n){for(var i=0;i<=t;i++)this.setCellHighlighting(e,i,n)},t.prototype.setColHighlighting=function(e,t,n){for(var i=0;i<=t;i++)this.setCellHighlighting(i,e,n)},t.prototype.setCellHighlighting=function(e,t,n){var i=e*Tn.o.numCols+t,r=this.get_innerDivs()[i],o=this.get_outerDivs()[i];n?(r.className="cui-it-activeCell",o.className="cui-it-activeCellOuter"):(r.className="cui-it-inactiveCell",o.className="cui-it-inactiveCellOuter")},t.prototype.onCellPointerUp=function(e){return this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),!0},t.prototype.getCellOuterDiv=function(e){for(;e.hasChildNodes();)e=e.childNodes[0];return Mt.x(e.tagName)||"a"!==e.tagName.toLowerCase()?null:e.parentNode.parentNode},t.prototype.setTitleOnAnchor=function(e){var t=e.childNodes[0].childNodes[0],n=this.getIndexFromElement(e);t.title=this.getCellTitle(this.getRowFromIndex(n)+1,this.getColFromIndex(n)+1)},t.prototype.getCellTitle=function(e,t){var n=this.get_properties().Alt;return Mt.x(n)&&(n=this.get_properties().MenuSectionTitle),n=String.format(n,t.toString(),e.toString())},t.prototype.resetAll=function(){if(this.get_displayedComponent()){for(var e=0;e<Tn.o.numCells;e++)this.get_innerDivs()[e].className="cui-it-inactiveCell",this.get_outerDivs()[e].className="cui-it-inactiveCellOuter";this._oldIdx=-1;var t=this.get_properties().MenuSectionInitialTitle;Mt.x(t)&&(t=""),this.get_hostMenuSection().setTitleImmediate(t)}},t.prototype.onCellPointerOver=function(e){if(this.get_control().get_enabled()){var t=this.getCellOuterDiv(e.get_sourceElement());this.setFocusOnCell(t),this.doCellHover(t)}return!1},t.prototype.doCellHover=function(e){this.setTitleOnAnchor(e),this.handleHighlightingTitle(e)},t.prototype.onCellFocus=function(e){if(!this.get_control().get_enabled())return!1;var t=this.getCellOuterDiv(e.get_sourceElement());return this.setTitleOnAnchor(t),this.handleHighlightingTitle(t),!1},t.prototype.onControlPointerOut=function(e){return Tt.g.isPointInElement(this.get_insertTableControl().get_insertTableDom().elmControl,e.get_clientPoint())||this.resetAll(),!1},t.prototype.onCellTouchStart=function(e){if(!this.get_control().get_enabled())return!1;var t=this.getCellOuterDiv(e.get_sourceElement());return this.doCellHover(t),!0},t.prototype.onControlTouchMove=function(e){if(!this.get_control().get_enabled())return!1;var t=e.get_clientPoint(),n=Tt.g.getElementAtPoint(t);if(!n||"table"===n.tagName.toLowerCase())return!1;var i=this.getCellOuterDiv(n);return i?this.doCellHover(i):this.resetAll(),!0},t.prototype.onControlTouchEnd=function(e){if(!this.get_control().get_enabled())return!1;var t=e.get_clientPoint(),n=Tt.g.getElementAtPoint(t);if(!n||"table"===n.tagName.toLowerCase())return this.resetAll(),!0;var i=this.getCellOuterDiv(n);return i?this.doDefaultAction(i,3,e.innerEvent):this.resetAll(),!0},t.prototype.focusNext=function(e){var t=wt.Control.focusNextIndexInGrid(this._oldIdx,Tn.o.numCols,Tn.o.numCells,e);return t!==this._oldIdx?(this.get_innerDivs()[t].firstChild.focus(),this.handleHighlightingAndTitleForIndex(t),!0):(this.resetAll(),this._oldIdx=-1,!1)},t.prototype.setFocusOnControl=function(){var e=this.get_innerDivs()[0];return!Mt.x(e)&&(e.firstChild.focus(),!0)},t.prototype.setFocusOnCell=function(e){return!Mt.x(e)&&(e.firstChild.firstChild.focus(),!0)},t.prototype.onMenuClosed=function(){this.resetAll()},t}(xt);(0,h.l)(En,"InsertTableBehavior",xt,[]);var kn=function(e){function t(t){return e.call(this,t)||this}return(0,B.t)(t,e),t.prototype.pollForStateAndUpdate=function(){this.get_control().set_enabled(!!this.get_menu())},t.prototype.doDefaultAction=function(e,t,n){l.AFrameworkApplication.get_theActionManager().processActionWithData(se.hA,2,t,this.getTelemetryData(n))},t}(cn);(0,h.l)(kn,"JewelMenuLauncherBehavior",cn,[]);var Dn=n(151),Mn=function(e){function t(t){return e.call(this,t)||this}return(0,B.t)(t,e),t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.pollForStateAndUpdate=function(){(2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties()))>0&&(this.updateVisibility()&&this.updateHtml())},t.prototype.updateHtml=function(){this.updateTextForLabelControl(),this.updateImage(),this.updateTooltip()},t.prototype.updateTextForLabelControl=function(){var e=this.get_control().labelText,t=this.get_stateProperties()[Dn.i.Value];Mt.x(t)&&(t=this.get_properties().LabelText,Mt.x(t)&&(t="")),t!==e&&this.setLabelText(t)},t.prototype.attachEvents=function(e){var t=e.elmControl;Mt.x(t)||(Ct.z.get_instance().registerHandler(ie.d.pointerDown,t,h.i(this,this.onPointerDown,"onPointerDown")),Ct.z.get_instance().registerHandler(ie.d.pointerOver,t,h.i(this,this.onPointerOver,"onPointerOver")),Ct.z.get_instance().registerHandler(ie.d.pointerOut,t,h.i(this,this.onPointerOut,"onPointerOut")))},t}(xt);(0,h.l)(Mn,"LabelBehavior",xt,[]);var Pn=(0,h.y)("ISearchBoxBehavior"),Fn=n(872),xn=n(268),Rn=n(286),Bn=function(e){function t(t){var n=e.call(this,t)||this;return n._closingMenu=!1,n._inActiveInteraction=!1,n._isRedesignFlightEnabled=!1,n._activeIconClass=null,n._inactiveIconClass=null,n._isRedesignFlightEnabled=l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("TellMeRedesignIsEnabled"),n._isRedesignFlightEnabled&&(n._activeIconClass=n.get_searchBox().get_sbProperties().LightImage16by16Class,n._inactiveIconClass=n.get_searchBox().get_sbProperties().DarkImage16by16Class),n}return(0,B.t)(t,e),t.prototype.get_searchBox=function(){return this.get_control()},t.prototype.notifyCommandExecuted=function(e,t,n,i){if(t&&(this.get_searchBox().set_elmHadFocus(n),l.AFrameworkApplication.get_activeFrame().setFocusOnDocument()),h.r(xn.r,e)&&i){var r=new Fn.f;r.CommandLocation=this.get_root().get_rootType(),r.InvocationMethod=0;var o={},a=e.get_control();if(a&&a.get_controlProperties()){if(o.CommandId=a.get_controlProperties().Command,o.ControlId=a.get_controlProperties().Id,o.CloseAllMenus=t,a.get_parentMenu()&&a.get_parentMenu().get_parent()&&a.get_parentMenu().get_parent().get_id()){var s=a.get_parentMenu().get_parent().get_id();o.ParentControlId=s.split("-")[0]}this.get_root().get_rootUser()&&this.get_root().get_rootUser().executeRootCommand(i,o,r)}}},t.prototype.closeMenu=function(){this.get_searchBox().get_elmHadFocus()||this.get_searchBox().set_elmHadFocus(this.get_searchBox().get_inputField()),this.get_searchBox().get_mouseIsOver()||this._isRedesignFlightEnabled&&(Ft.n.removeCSSClassFromElement(this.get_searchBox().get_inputField(),"cui-sb-focus"),Ft.n.removeCSSClassFromElement(this.get_searchBox().get_topLevelElement(),"cui-sb-focus"),Ft.n.removeCSSClassFromElement(this.get_searchBox().searchIcon,this._activeIconClass),Ft.n.ensureCSSClassOnElement(this.get_searchBox().searchIcon,this._inactiveIconClass)),this._closingMenu=!0,e.prototype.closeMenu.call(this),this._closingMenu=!1,this.raiseInteractionEnd()},t.prototype.get_shouldRestoreFocusToApp=function(){return!this.get_searchBox().get_processingKeystroke()},t.prototype.onMenuChanged=function(){this.get_searchBox().onMenuChanged()},t.prototype.raiseInteractionBegin=function(){this._inActiveInteraction||this._closingMenu||(this._inActiveInteraction=!0,this.get_searchBox().raiseEvent(Rn.t.interactionBegin,null))},t.prototype.raiseInteractionEnd=function(){this.get_menuLaunched()||this.get_searchBox().get_inputHasFocus()||(this._inActiveInteraction=!1,this.get_searchBox().raiseEvent(Rn.t.interactionEnd,null))},t.prototype.onInputBoxBlur=function(e){return Ft.n.removeCSSClassFromElement(this.get_searchBox().get_inputField(),"cui-sb-focus"),Ft.n.removeCSSClassFromElement(this.get_searchBox().get_topLevelElement(),"cui-sb-focus"),this._isRedesignFlightEnabled&&!this.get_searchBox().menuLaunched&&(Ft.n.removeCSSClassFromElement(this.get_searchBox().searchIcon,this._activeIconClass),Ft.n.ensureCSSClassOnElement(this.get_searchBox().searchIcon,this._inactiveIconClass)),this.get_searchBox().raiseEvent(Rn.t.blur,e),this.raiseInteractionEnd(),this.get_searchBox().set_elmHadFocus(this.get_searchBox().get_inputField()),!1},t.prototype.onInputBoxFocus=function(e){return Ft.n.ensureCSSClassOnElement(this.get_searchBox().get_inputField(),"cui-sb-focus"),Ft.n.ensureCSSClassOnElement(this.get_searchBox().get_topLevelElement(),"cui-sb-focus"),this._isRedesignFlightEnabled&&(Ft.n.removeCSSClassFromElement(this.get_searchBox().searchIcon,this._inactiveIconClass),Ft.n.ensureCSSClassOnElement(this.get_searchBox().searchIcon,this._activeIconClass)),this.get_searchBox().raiseEvent(Rn.t.focus,e),this.raiseInteractionBegin(),!1},t.prototype.onSearchContainerMouseOver=function(e){return this._isRedesignFlightEnabled&&(Ft.n.ensureCSSClassOnElement(this.get_searchBox().get_topLevelElement(),"cui-sb-hover"),Ft.n.ensureCSSClassOnElement(this.get_searchBox().get_inputField(),"cui-sb-hover"),Ft.n.removeCSSClassFromElement(this.get_searchBox().searchIcon,this._inactiveIconClass),Ft.n.ensureCSSClassOnElement(this.get_searchBox().searchIcon,this._activeIconClass)),!1},t.prototype.onSearchContainerMouseOut=function(e){return this._isRedesignFlightEnabled&&(Ft.n.removeCSSClassFromElement(this.get_searchBox().get_topLevelElement(),"cui-sb-hover"),Ft.n.removeCSSClassFromElement(this.get_searchBox().get_inputField(),"cui-sb-hover"),this.get_searchBox().menuLaunched||this.get_searchBox().get_inputHasFocus()||(Ft.n.removeCSSClassFromElement(this.get_searchBox().searchIcon,this._activeIconClass),Ft.n.ensureCSSClassOnElement(this.get_searchBox().searchIcon,this._inactiveIconClass))),!1},t}(cn);(0,h.l)(Bn,"SearchBoxBehavior",cn,[Pn,At]);var Ln=function(){function e(){}return e.Value="Value",e.MaxValue="MaxValue",e.Text="Text",e}();(0,h.l)(Ln,"SliderCommandProperties",null,[]);var Nn=function(e){function t(t){return e.call(this,t)||this}return(0,B.t)(t,e),t.prototype.get_slider=function(){return this.get_control()},t.prototype.get_sliderDom=function(){return this.get_slider().get_sliderDom()},t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.initialize=function(){},t.prototype.doDefaultAction=function(e,t,n){},t.prototype.attachEvents=function(e){var t=e.elmInput;ne.z.get_instance().registerHandler(ie.d.focus,t,h.i(this,this.onFocus,"onFocus")),ne.z.get_instance().registerHandler(ie.d.blur,t,h.i(this,this.onBlur,"onBlur")),ne.z.get_instance().registerHandler(ie.d.change,t,h.i(this,this.onChange,"onChange")),ne.z.get_instance().registerHandler(ie.d.input,t,h.i(this,this.onChange,"onChange"))},t.prototype.onFocus=function(t){return this.get_sliderDom().elmControl&&Sys.UI.DomElement.addCssClass(this.get_sliderDom().elmControl,"cui-sldr-onfocus"),e.prototype.onFocus.call(this,t)},t.prototype.onBlur=function(t){return this.get_sliderDom().elmControl&&Sys.UI.DomElement.removeCssClass(this.get_sliderDom().elmControl,"cui-sldr-onfocus"),e.prototype.onBlur.call(this,t)},t.prototype.onChange=function(e){return this.commitValue(this.get_sliderDom().elmInput.value),!0},t.prototype.commitValue=function(e){this.get_stateProperties()[Ln.Value]=parseFloat(e),this.get_root().executeCommand(this.get_properties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1)},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[Ln.Value],t=this.get_stateProperties()[Ln.MaxValue],n=this.get_stateProperties()[Ln.Text],i=this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties());if(this.get_sliderDom()&&this.get_sliderDom().elmInput&&(this.get_sliderDom().elmInput.disabled=!this.get_control().get_enabled()),(2&i)>0){var r=this.get_stateProperties()[Ln.Value],o=this.get_stateProperties()[Ln.MaxValue],a=this.get_stateProperties()[Ln.Text];o===t&&r===e&&n===a||this.get_sliderDom()&&this.get_sliderDom().elmInput&&(this.get_sliderDom().elmInput.setAttribute(ze.t.ariaValueMaxAttribute,String.format("{0}",o)),this.get_sliderDom().elmInput.setAttribute("max",String.format("{0}",o)),this.get_sliderDom().elmInput.value=r,this.get_sliderDom().elmLabel.innerText=this.get_stateProperties()[Ln.Text])}},t}(xt);(0,h.l)(Nn,"SliderBehavior",xt,[]);var Un,On=(0,h.y)("ISpinnerBehavior");!function(e){e[e.none=0]="none",e[e.centimeter=1]="centimeter",e[e.character=2]="character",e[e.inch=3]="inch",e[e.line=4]="line",e[e.point=5]="point",e[e.percent=6]="percent",e[e.pixels=7]="pixels",e[e.timespan=8]="timespan",e[e.degree=9]="degree"}(Un||(Un={})),(0,h.h)("UnitType",Un);var Hn=function(){function e(){}return e.Alt="Alt",e.Number="Number",e.UnitType="UnitType",e.Text="Text",e.MaxValue="MaxValue",e}();(0,h.l)(Hn,"SpinnerCommandProperties",null,[]);var Wn=function(e){function t(t){var n=e.call(this,t)||this;return n._numericalValue=0,n._unit=null,n._isSpecialText=!1,n._validUnitTypes=null,n._spinningUp=!1,n._mouseupOnTextboxSinceFocus=!1,n._pendingDelaySpinTimeoutId=-1,n._repeatSpinIntervalId=-1,n}return(0,B.t)(t,e),t.prototype.get_spinner=function(){return this.get_control()},t.prototype.get_spinnerDom=function(){return this.get_spinner().get_spinnerDom()},t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.initialize=function(){var e=this.get_spinner().get_validUnits();this._validUnitTypes=this.unitTypeArrayFromUnitArray(e),this._numericalValue=e[0].get_min(),this._unit=e[0],this._isSpecialText=!1},t.prototype.doDefaultAction=function(e,t,n){},t.prototype.attachEvents=function(e){var t=e,n=t.elmInput,i=t.elmUpArrow,r=t.elmDownArrow;ne.z.get_instance().registerHandler(ie.d.focus,n,h.i(this,this.onFocus,"onFocus")),ne.z.get_instance().registerHandler(ie.d.blur,n,h.i(this,this.onBlur,"onBlur")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyDown,n,h.i(this,this.onKeyDown,"onKeyDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyPress,n,h.i(this,this.onKeyPress,"onKeyPress")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyUp,n,h.i(this,this.onKeyUp,"onKeyUp")),ne.z.get_instance().registerHandler(ie.d.change,n,h.i(this,this.onChange,"onChange")),gn.p.get_instance().registerHandler(ie.d.mouseUp,n,h.i(this,this.onInputMouseUp,"onInputMouseUp")),Ct.z.get_instance().registerHandler(ie.d.pointerDown,i,h.i(this,this.onArrowPointerDown,"onArrowPointerDown")),Ct.z.get_instance().registerHandler(ie.d.pointerDown,r,h.i(this,this.onArrowPointerDown,"onArrowPointerDown")),Ct.z.get_instance().registerHandler(ie.d.pointerUp,i,h.i(this,this.onArrowPointerUp,"onArrowPointerUp")),Ct.z.get_instance().registerHandler(ie.d.pointerUp,r,h.i(this,this.onArrowPointerUp,"onArrowPointerUp")),Bt.v.get_instance().registerHandler(ie.d.touchMove,i,h.i(this,this.onArrowTouchMove,"onArrowTouchMove")),Bt.v.get_instance().registerHandler(ie.d.touchMove,r,h.i(this,this.onArrowTouchMove,"onArrowTouchMove")),Bt.v.get_instance().registerHandler(ie.d.touchEnd,i,h.i(this,this.onArrowTouchEnd,"onArrowTouchEnd")),Bt.v.get_instance().registerHandler(ie.d.touchEnd,r,h.i(this,this.onArrowTouchEnd,"onArrowTouchEnd"))},t.prototype.onFocus=function(t){return e.prototype.onFocus.call(this,t),Ft.n.ensureCSSClassOnElement(this.get_spinnerDom().elmControl,"cui-spn-focus"),this.get_control().get_enabled()&&Tt.g.selectAllTextInInput(this.get_spinnerDom().elmInput),this._mouseupOnTextboxSinceFocus=!1,!1},t.prototype.onBlur=function(t){return e.prototype.onBlur.call(this,t),Ft.n.removeCSSClassFromElement(this.get_spinnerDom().elmControl,"cui-spn-focus"),!1},t.prototype.onKeyDown=function(e){var t=!1;if(!Mt.x(e.innerEvent)&&!Mt.x(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent,i=e.innerEvent.keyCode,r=n.shiftKey;i===Sys.UI.Key.up||i===Sys.UI.Key.down?(this.get_root().isCurrentModalController(this.get_control())||this.startSpin(i===Sys.UI.Key.up,e.get_inputSource()),t=!0):i===Sys.UI.Key.enter?(this.commitPendingChange(),h.r(_n.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0):i===Sys.UI.Key.tab?(this.commitPendingChange(),h.r(_n.Ribbon,this.get_root())&&(t=this.get_root().wrapKeyboardFocus(this.get_displayedComponent().get_elementInternal(),!r))):i===Sys.UI.Key.esc?(this.resetInputToPreviousValue(),h.r(_n.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),t=!0):i!==Sys.UI.Key.backspace&&i!==Sys.UI.Key.del||(t=!this.get_control().get_enabled())}return t},t.prototype.onKeyPress=function(e){return!this.get_control().get_enabled()},t.prototype.onKeyUp=function(e){return this.deactivateElementFromKeyboard(),!1},t.prototype.onChange=function(e){return this.commitPendingChange(),!1},t.prototype.onInputMouseUp=function(e){return!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0)},t.prototype.onArrowPointerDown=function(e){var t=!1,n=!0;if(2===e.get_inputSource()&&(n=!e.get_mouseButton()),n){var i=e.get_sourceElement(),r=i===this.get_spinnerDom().elmUpArrow||i===this.get_spinnerDom().elmUpArrowImageContainer||i===this.get_spinnerDom().elmUpArrowImage;this.startSpin(r,e.get_inputSource()),t=!0}return t},t.prototype.onArrowPointerUp=function(e){return this.deactivateElement(e)},t.prototype.onArrowTouchMove=function(e){return this.onActivePointerMove(e)},t.prototype.onArrowTouchEnd=function(e){return this.deactivateElement(e)},t.prototype.incDecValue=function(e){if(this.get_control().get_enabled()){var t=!1;if(!this._isSpecialText){var n=this.getIncDecStartingValue(e),i=e?n+this._unit.get_step():n-this._unit.get_step();i=Math.min(i,this._unit.get_max()),(i=Math.max(i,this._unit.get_min()))!==this._numericalValue&&(this.commitNumericalValue(i,this._unit),this.get_root().executeCommand(this.get_properties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1),t=!0)}if(!t){var r=this.get_properties().SpinCommand,o=this.get_stateProperties();o.Increment=e,Mt.x(r)||this.get_root().executeCommand(r,o,this.get_displayedComponent(),0,!1)}}},t.prototype.getIncDecStartingValue=function(e){var t=Math.pow(10,l.AFrameworkApplication.get_numberFormat().numberDecimalDigits),n=Math.round(this._numericalValue*t),i=Math.round(this._unit.get_step()*t),r=n/i;return(r=e?Math.floor(r):Math.ceil(r))*i/t},t.prototype.startSpin=function(e,t){if(this.get_control().get_enabled()){this.commitPendingChange();var n=e?this.get_spinnerDom().elmUpArrow:this.get_spinnerDom().elmDownArrow;switch(t){case 2:case 3:this._spinningUp=e,this.activateElement(n);break;case 1:this._spinningUp=e,this.activateElementFromKeyboard(n)}}},t.prototype.stopSpin=function(){this.cancelPendingDelaySpin(),this.cancelRepeatSpin()},t.prototype.delaySpin=function(){-1===this._pendingDelaySpinTimeoutId&&(this._pendingDelaySpinTimeoutId=window.setTimeout(h.i(this,this.repeatSpin,"repeatSpin"),500))},t.prototype.cancelPendingDelaySpin=function(){var e=this;Ft.n.cancelPendingTimeout((0,$t.m)((function(){return e._pendingDelaySpinTimeoutId}),(function(t){return e._pendingDelaySpinTimeoutId=t})))},t.prototype.repeatSpin=function(){this.cancelPendingDelaySpin(),-1===this._repeatSpinIntervalId&&(this.spin(),this._repeatSpinIntervalId=window.setInterval(h.i(this,this.spin,"spin"),50))},t.prototype.cancelRepeatSpin=function(){var e=this;Ft.n.cancelInterval((0,$t.m)((function(){return e._repeatSpinIntervalId}),(function(t){return e._repeatSpinIntervalId=t})))},t.prototype.spin=function(){this.incDecValue(this._spinningUp)},t.prototype.activateElementFromKeyboard=function(e){this.get_root().beginModal(this.get_control(),!1),Ft.n.ensureCSSClassOnElement(e,wt.Control.activeClassName),this.spin(),this.delaySpin()},t.prototype.deactivateElementFromKeyboard=function(){this.get_root().endModal(this.get_control(),!1),this.stopSpin(),Ft.n.removeCSSClassFromElement(this.get_spinnerDom().elmUpArrow,wt.Control.activeClassName),Ft.n.removeCSSClassFromElement(this.get_spinnerDom().elmDownArrow,wt.Control.activeClassName)},t.prototype.setInputValue=function(e){this.get_spinnerDom().elmInput.value!==e&&(this.get_spinnerDom().elmInput.value=e)},t.prototype.resetInputToPreviousValue=function(){this.setInputValue(this.get_stateProperties()[Hn.Text])},t.prototype.setCurrentValueToSpecialText=function(e){this.setInputValue(e),this.get_stateProperties()[Hn.Text]=e,this._isSpecialText=!0},t.prototype.setCurrentValueToNumber=function(e,t,n){this.setInputValue(n),this.get_stateProperties()[Hn.Text]=n,this.get_stateProperties()[Hn.Number]=e,this.get_stateProperties()[Hn.UnitType]=t.get_type(),this._numericalValue=e,this._unit=t,this.get_spinnerDom().elmInput.setAttribute(ze.t.ariaValueNowAttribute,n),this.get_spinnerDom().elmInput.setAttribute(ze.t.ariaValueMinAttribute,String.format("{0}",t.get_min())),this.get_spinnerDom().elmInput.setAttribute(ze.t.ariaValueMaxAttribute,String.format("{0}",t.get_max())),this._isSpecialText=!1},t.prototype.commitTextValue=function(e){var t;if(this.isSpecialText(e,(0,$t.m)((function(){return t}),(function(e){return t=e}))))this.setCurrentValueToSpecialText(t);else{var n=0,i=0;j.l.parseNumberAndUnitsFromString(e,this._validUnitTypes,l.AFrameworkApplication.get_numberFormat(),(0,$t.m)((function(){return n}),(function(e){return n=e})),(0,$t.m)((function(){return i}),(function(e){return i=e})));var r=this.unitFromUnitType(i);!i&&Mt.x(r)&&(r=this.unitFromUnitType(this.get_stateProperties()[Hn.UnitType])),this.commitNumericalValue(n,r)}},t.prototype.commitNumericalValue=function(e,t){if(e=this.normalizeNumber(e,t),isNaN(e)||Mt.x(t))this.resetInputToPreviousValue();else{var n=l.AFrameworkApplication.get_numberFormat(),i="";j.l.formatNumberToString(e,t.get_type(),n,(0,$t.m)((function(){return i}),(function(e){return i=e})));var r=6===t.get_type()?n.numberGroupSeparator:n.percentGroupSeparator;i=i.replace(r,""),this.setCurrentValueToNumber(e,t,i)}},t.prototype.isSpecialText=function(e,t){var n=!1;t.val="",e=e.trim();var i=this.get_spinner().get_validSpecialStrings();if(!Mt.x(i))for(var r=0;r<i.length;r++)if(i[r].toLowerCase()===e.toLowerCase()){t.val=i[r],n=!0;break}return n},t.prototype.normalizeNumber=function(e,t){return isNaN(e)||Mt.x(t)?Number.NaN:t.normalizeNumber(e)},t.prototype.unitFromUnitType=function(e){for(var t=null,n=this.get_spinner().get_validUnits(),i=0;i<n.length;i++)if(n[i].get_type()===e){t=n[i];break}return t},t.prototype.unitTypeArrayFromUnitArray=function(e){for(var t=e.length,n=new Array(t),i=0;i<t;i++)n[i]=e[i].get_type();return n},t.prototype.commitPendingChange=function(){if(this.get_control().get_enabled()){var e=this.get_stateProperties()[Hn.Text],t=this.get_spinnerDom().elmInput.value;if(t!==e)this.commitTextValue(t),this.get_stateProperties()[Hn.Text]!==e&&this.get_root().executeCommand(this.get_properties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1)}else this.resetInputToPreviousValue()},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[Hn.Text],t=this.get_stateProperties()[Hn.Number],n=this.get_stateProperties()[Hn.UnitType],i=this.get_stateProperties()[Hn.MaxValue];if((2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties()))>0){var r=this.get_stateProperties()[Hn.Text],o=this.get_stateProperties()[Hn.Number],a=this.get_stateProperties()[Hn.UnitType],s=this.get_stateProperties()[Hn.MaxValue];s!==i&&(this.unitFromUnitType(a).set_max(s),this.get_spinnerDom().elmInput.setAttribute(ze.t.ariaValueMaxAttribute,String.format("{0}",s))),r!==e?""===r?this.setCurrentValueToSpecialText(r):this.commitTextValue(r):isNaN(o)||o===t&&a===n||this.commitNumericalValue(o,this.unitFromUnitType(a));var l=this.get_spinnerDom().elmControl.title,u=Ft.n.validateStringProperty(this.get_stateProperties()[Hn.Alt],this.get_properties().Alt);u!==l&&(this.get_spinnerDom().elmInput.title=u,this.get_spinnerDom().elmUpArrow.title=u,this.get_spinnerDom().elmDownArrow.title=u)}},t.prototype.activeElementStateChanged=function(t){e.prototype.activeElementStateChanged.call(this,t),t?(this.spin(),this.delaySpin()):this.stopSpin()},t}(xt);(0,h.l)(Wn,"SpinnerBehavior",xt,[On,At]);var Vn=n(352),$n=n(921),Kn=function(e){function t(t){var n=e.call(this,t)||this;return n._menuButtonEnabled=!0,n._buttonEnabled=!1,n}return(0,B.t)(t,e),t.prototype.get_splitButton=function(){return this.get_control()},t.prototype.get_properties$2=function(){return this.get_splitButton().get_properties()},t.prototype.attachEvents=function(e){var t=e,n=t.elmControl,i=t.elmButtonPart,r=t.elmMenuLauncherPart;ne.z.get_instance().registerHandler(ie.d.focus,n,h.i(this,this.onFocus,"onFocus")),ne.z.get_instance().registerHandler(ie.d.blur,n,h.i(this,this.onBlur,"onBlur")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyDown,n,h.i(this,this.onKeyDown,"onKeyDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyUp,n,h.i(this,this.onKeyUp,"onKeyUp")),Xe.y.get_isInternetExplorerEdge()&&this.getEdgeMajorVersion()<16&&(Ct.z.get_instance().registerHandler(ie.d.pointerDown,n,h.i(this,this.onSplitbuttonPointerDownPointerUp,"onSplitbuttonPointerDownPointerUp")),Ct.z.get_instance().registerHandler(ie.d.pointerUp,n,h.i(this,this.onSplitbuttonPointerDownPointerUp,"onSplitbuttonPointerDownPointerUp"))),Ct.z.get_instance().registerHandler(ie.d.pointerOver,i,h.i(this,this.onButtonPointerOver,"onButtonPointerOver")),Ct.z.get_instance().registerHandler(ie.d.pointerOut,i,h.i(this,this.onButtonPointerOut,"onButtonPointerOut")),Ct.z.get_instance().registerHandler(ie.d.pointerDown,i,h.i(this,this.onButtonPointerDown,"onButtonPointerDown")),Ct.z.get_instance().registerHandler(ie.d.pointerUp,i,h.i(this,this.onButtonPointerUp,"onButtonPointerUp")),Bt.v.get_instance().registerHandler(ie.d.touchMove,i,h.i(this,this.onButtonTouchMove,"onButtonTouchMove")),Bt.v.get_instance().registerHandler(ie.d.touchEnd,i,h.i(this,this.onButtonTouchEnd,"onButtonTouchEnd")),Ct.z.get_instance().registerHandler(ie.d.pointerDown,r,h.i(this,this.onMenuButtonPointerDown,"onMenuButtonPointerDown")),Ct.z.get_instance().registerHandler(ie.d.pointerOver,r,h.i(this,this.onMenuButtonPointerOver,"onMenuButtonPointerOver")),Ct.z.get_instance().registerHandler(ie.d.pointerOut,r,h.i(this,this.onMenuButtonPointerOut,"onMenuButtonPointerOut"))},t.prototype.doDefaultAction=function(t,n,i){if(Sys.UI.DomElement.containsCssClass(t,"cui-ctl-a1")){if(this._buttonEnabled){this.get_splitButton().set_on(!this.get_splitButton().get_on());var r=this.get_stateProperties();r.CommandValueId=this.get_control().getCommandValueId(),this.get_root().executeCommand(this.get_properties$2().Command,r,this.get_displayedComponent(),n,!0,null,this.getTelemetryData(i))}}else this._menuButtonEnabled&&e.prototype.doDefaultAction.call(this,t,n,i)},t.prototype.onKeyUp=function(t){var n=t.innerEvent.keyCode;if(n===Sys.UI.Key.enter||n===Sys.UI.Key.space){var i=this.get_stateProperties();return i.CommandValueId=this.get_control().getCommandValueId(),this.get_root().executeCommand(this.get_properties$2().Command,i,this.get_displayedComponent(),1,!0),!0}return e.prototype.onKeyUp.call(this,t)},t.prototype.pollForStateAndUpdate=function(){var e=this.get_root().pollForCommandState(this.get_properties$2().Command,this.get_properties$2().QueryCommand,this.get_stateProperties()),t=(1&e)>0,n=!0;Mt.x(this.get_properties$2().CommandMenuOpen)?n=t:n=(1&this.get_root().pollForCommandState(this.get_properties$2().CommandMenuOpen,null,null))>0;if(n===this._menuButtonEnabled&&t===this._buttonEnabled&&(n||t)===this.get_control().get_enabled()||(this.get_control().set_enabled(n||t),t!==this._buttonEnabled&&this.onEnabledChangedForButton(t),n!==this._menuButtonEnabled&&this.onEnabledChangedForMenu(n),this._menuButtonEnabled=n,this._buttonEnabled=t),(2&e)>0){this.updateImage();var i=Ft.n.validateStringProperty(this.get_stateProperties()[$n.z.LabelText],this.get_properties$2().LabelText);if(this.get_stateProperties()[$n.z.ApplyLabelTextToControlOnly]?this.get_splitButton().forEachSplitButtonComponentDom((function(e){e.elmControl.title=i,e.elmButtonPart.removeAttribute("title"),e.elmMenuLauncherPart.removeAttribute("title")})):this.get_splitButton().forEachSplitButtonComponentDom((function(e){e.elmButtonPart.title=i})),this.get_stateProperties()[$n.z.EnsureControlRoleIsButton]&&this.get_splitButton().forEachSplitButtonComponentDom((function(e){ze.t.setAriaAttribute(e.elmControl,ze.t.ariaRoleAttribute,ze.t.ariaButtonRole)})),!Mt.x(this.get_stateProperties()[$n.z.Visible]))this.updateVisibility()&&this.updateHtml()}this.get_splitButton().setState(this.get_splitButton().get_on()&&t)},t.prototype.updateHtml=function(){this.updateLabelText(),this.updateTooltip(),this.updateImage()},t.prototype.onEnabledChangedForMenu=function(e){this.get_splitButton().forEachSplitButtonComponentDom((function(t){Ft.n.setEnabledOnElement(t.elmMenuLauncherPart,e)})),this.removeControlHighlight(),this._menuButtonEnabled=e},t.prototype.onEnabledChangedForButton=function(e){this.get_splitButton().forEachSplitButtonComponentDom((function(t){Ft.n.setEnabledOnElement(t.elmButtonPart,e)})),this.removeControlHighlight(),this._buttonEnabled=e},t.prototype.removeControlHighlight=function(){var e=this.get_splitButton().getDisplayedComponentElement();Mt.x(e)||(Ft.n.removeCSSClassFromElement(e.childNodes[0],"cui-ctl-split-hovered-primary"),Ft.n.removeCSSClassFromElement(e.childNodes[0],"cui-ctl-split-hovered-secondary"),Ft.n.removeCSSClassFromElement(e.childNodes[1],"cui-ctl-split-hovered-primary"),Ft.n.removeCSSClassFromElement(e.childNodes[1],"cui-ctl-split-hovered-secondary"))},t.prototype.onSplitbuttonPointerDownPointerUp=function(e){if(Vn.l(e.innerEvent))return!1;var t=!1;return e.eventName===ie.d.pointerDown?t=this.onButtonPointerDown(e):e.eventName===ie.d.pointerUp&&(t=this.onButtonPointerUp(e)),t},t.prototype.onButtonPointerDown=function(e){var t=!1,n=e.get_inputSource();switch(n){case 3:this.shouldUseFlyoutBehaviorOnTouch()?(this.doDefaultAction(this.get_displayedComponent().get_elementInternal(),n,e.innerEvent),t=!0):(this.activateElement(this.get_splitButton().get_displayedButtonElement()),t=!0);break;case 2:e.get_mouseButton()||(this.activateElement(this.get_splitButton().get_displayedButtonElement()),t=!0)}return t&&e.innerEvent.preventDefault(),!1},t.prototype.shouldUseFlyoutBehaviorOnTouch=function(){var e=this.get_displayedComponent().get_displayMode();return"Small"===e||"Medium"===e||"Menu16"===e||"MenuTellMe"===e},t.prototype.onButtonPointerUp=function(e){return this.deactivateElement(e)},t.prototype.onButtonTouchMove=function(e){return this.onActivePointerMove(e)},t.prototype.onButtonTouchEnd=function(e){return this.deactivateElement(e)},t.prototype.onFocus=function(t){return e.prototype.onFocus.call(this,t),this.highlightControl(!0,!0),!1},t.prototype.onBlur=function(t){return e.prototype.onFocus.call(this,t),this.removeControlHighlight(),!1},t.prototype.onButtonPointerOver=function(e){return this.get_control().get_enabled()&&this._buttonEnabled&&this.highlightControl(!0,this.get_splitButton().get_on()),!1},t.prototype.onButtonPointerOut=function(e){return this.get_control().get_enabled()&&this._buttonEnabled&&this.removeControlHighlight(),!1},t.prototype.onMenuButtonPointerDown=function(e){var t=!1;return 2===e.get_inputSource()&&e.get_mouseButton()||(this.doDefaultAction(e.get_sourceElement(),e.get_inputSource(),e.innerEvent),t=!0),t&&e.innerEvent.preventDefault(),!1},t.prototype.onMenuButtonPointerOver=function(e){return this.get_control().get_enabled()&&this._menuButtonEnabled&&this.highlightControl(this.get_splitButton().get_on(),!0),!1},t.prototype.onMenuButtonPointerOut=function(e){return this.removeControlHighlight(),!1},t.prototype.highlightControl=function(e,t){var n=this.get_control().getDisplayedComponentElement();Mt.x(n)||(Ft.n.ensureCSSClassOnElement(n.childNodes[0],e?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"),Ft.n.ensureCSSClassOnElement(n.childNodes[1],t?"cui-ctl-split-hovered-primary":"cui-ctl-split-hovered-secondary"))},t.prototype.getEdgeMajorVersion=function(){var e=Xe.y.get_edgeVersion();if(e){var t=e.split(".");if(2===t.length)return parseInt(t[0])}return 0},t}(cn);(0,h.l)(Kn,"SplitButtonBehavior",cn,[]);var zn=(0,h.y)("ITextBoxBehavior"),qn=function(){function e(){}return e.Text="Text",e}();(0,h.l)(qn,"TextBoxCommandProperties",null,[]);var Qn=function(e){function t(t){var n=e.call(this,t)||this;return n._mouseupOnTextboxSinceFocus=!1,n._inputFocused=!1,n._excelTableRenameEnabled=!!l.AFrameworkApplication.appSettingsManager&&l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelTableRenameEnabled"),n}return(0,B.t)(t,e),t.prototype.get_textBox=function(){return this.get_control()},t.prototype.get_textBoxDom=function(){return this.get_textBox().get_textBoxDom()},t.prototype.get_tbProperties=function(){return this.get_textBox().get_controlProperties()},t.prototype.attachEvents=function(e){var t=e.elmInput;ne.z.get_instance().registerHandler(ie.d.focus,t,h.i(this,this.onFocus,"onFocus")),ne.z.get_instance().registerHandler(ie.d.blur,t,h.i(this,this.onBlur,"onBlur")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyDown,t,h.i(this,this.onKeyDown,"onKeyDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyPress,t,h.i(this,this.onKeyPress,"onKeyPress")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyUp,t,h.i(this,this.onKeyUp,"onKeyUp")),ne.z.get_instance().registerHandler(ie.d.change,t,h.i(this,this.onChange,"onChange")),gn.p.get_instance().registerHandler(ie.d.mouseUp,t,h.i(this,this.onMouseUp,"onMouseUp"))},t.prototype.onFocus=function(t){return e.prototype.onFocus.call(this,t),this._inputFocused=!0,Ft.n.ensureCSSClassOnElement(this.get_textBoxDom().elmControl,"cui-tb-focus"),this.get_control().get_enabled()&&Tt.g.selectAllTextInInput(this.get_textBoxDom().elmInput),this._mouseupOnTextboxSinceFocus=!1,!1},t.prototype.onBlur=function(t){return this._inputFocused=!1,e.prototype.onBlur.call(this,t),Ft.n.removeCSSClassFromElement(this.get_textBoxDom().elmControl,"cui-tb-focus"),!1},t.prototype.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!Mt.x(t.innerEvent)&&!Mt.x(t.innerEvent.rawEvent)){var i=t.innerEvent.rawEvent,r=t.innerEvent.keyCode,o=i.shiftKey;r===Sys.UI.Key.tab?(this.commitPendingChange(),h.r(_n.Ribbon,this.get_root())&&(n=this.get_root().wrapKeyboardFocus(this.get_displayedComponent().get_elementInternal(),!o))):r===Sys.UI.Key.enter?this._excelTableRenameEnabled&&(this.commitPendingChange(),h.r(_n.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),n=!0):r===Sys.UI.Key.esc?(this.resetInputToPreviousValue(),h.r(_n.Ribbon,this.get_root())&&this.get_root().dismissTabPopup(),n=!0):r===Sys.UI.Key.backspace||r===Sys.UI.Key.del?n=!this.get_control().get_enabled():t.get_commandKey()&&(We.n.cancelEventNoPreventDefault(t.innerEvent),n=!1)}return n},t.prototype.onKeyPress=function(e){return!this.get_control().get_enabled()},t.prototype.onKeyUp=function(e){return!1},t.prototype.onChange=function(e){return this.commitPendingChange(),!1},t.prototype.onMouseUp=function(e){return this.get_textBoxDom().isEditable?!this._mouseupOnTextboxSinceFocus&&(this._mouseupOnTextboxSinceFocus=!0,!0):(Tt.g.selectAllTextInInput(this.get_textBoxDom().elmInput),!0)},t.prototype.setInputValue=function(e){this.get_textBoxDom().elmInput.value!==e&&(this.get_textBoxDom().elmInput.value=e)},t.prototype.resetInputToPreviousValue=function(){this.setInputValue(this.get_stateProperties()[qn.Text])},t.prototype.commitPendingChange=function(){if(this.get_control().get_enabled()&&this.get_textBoxDom().isEditable){var e=this.get_stateProperties()[qn.Text],t=this.get_textBoxDom().elmInput.value;t!==e&&(this.get_stateProperties()[qn.Text]=t,this.get_root().executeCommand(this.get_tbProperties().Command,this.get_stateProperties(),this.get_displayedComponent(),0,!1))}else this.resetInputToPreviousValue()},t.prototype.pollForStateAndUpdate=function(){var e=this.get_stateProperties()[qn.Text];if((2&this.pollForStateAndUpdateInternal(this.get_tbProperties().Command,this.get_tbProperties().QueryCommand,this.get_stateProperties()))>0&&!this._inputFocused){var t=this.get_stateProperties()[qn.Text];t!==e&&this.setInputValue(t)}},t}(xt);(0,h.l)(Qn,"TextBoxBehavior",xt,[zn,At]);var Gn=n(866),jn=function(e){function t(t){return e.call(this,t)||this}return(0,B.t)(t,e),t.prototype.get_toggleButton=function(){return this.get_control()},t.prototype.get_properties=function(){return this.get_control().get_controlProperties()},t.prototype.doDefaultAction=function(e,t,n){var i=this;this.get_control().get_enabled()&&(Ft.n.isFalse(this.get_properties().TogglesWhenExecuted)||this.toggle(),this.get_stateProperties().CommandValueId=this.get_toggleButton().getCommandValueId(),this.get_stateProperties().MenuItemId=this.get_toggleButton().getMenuItemId(),this.get_stateProperties().SourceControlId=this.get_control().get_id(),this.get_root().executeCommand(this.get_properties().Command,this.get_stateProperties(),this.get_displayedComponent(),t,!Ft.n.isFalse(this.get_properties().CloseMenuWhenExecuted),(function(e){Ft.n.isTrue(i.get_properties().UpdateHtmlPostToggle)&&(32===e?i.toggleUx():i.toggleState())}),this.getTelemetryData(n)))},t.prototype.toggleState=function(){var e=!this.get_stateProperties()[Et.e.On];this.get_stateProperties()[Et.e.On]=e},t.prototype.toggleUx=function(){var e=this.get_stateProperties()[Et.e.On];this.get_toggleButton().setState(e),(this.get_toggleButton().get_useCheckMark()&&this.get_toggleButton().get_useUncheckedImage()||Ft.n.isTrue(this.get_properties().UpdateHtmlPostToggle))&&this.updateHtml()},t.prototype.toggle=function(){this.toggleState(),Ft.n.isTrue(this.get_properties().UpdateHtmlPostToggle)||this.toggleUx()},t.prototype.onKeyDown=function(t){var n=e.prototype.onKeyDown.call(this,t);if(!n&&!Mt.x(t.innerEvent)&&this.get_parentMenu()){var i=t.innerEvent.keyCode;i!==Sys.UI.Key.enter&&i!==Sys.UI.Key.space||t.innerEvent.preventDefault()}return n},t.prototype.pollForStateAndUpdate=function(){(Mt.x(this.get_properties().MenuItemId)||(this.get_stateProperties().MenuItemId=this.get_properties().MenuItemId),(2&this.pollForStateAndUpdateInternal(this.get_properties().Command,this.get_properties().QueryCommand,this.get_stateProperties()))>0)&&(this.updateVisibility()&&this.updateHtml())},t.prototype.updateHtml=function(){this.get_toggleButton().setState(this.get_stateProperties()[Et.e.On]),this.updateDisplayMode(Ft.n.validateStringProperty(this.get_stateProperties()[Et.e.DisplayMode],"")),this.updateLabelText(),this.updateImage(),this.updateLargeMenu(),Et.e.Alt in this.get_stateProperties()&&this.updateTooltip()},t.prototype.updateLargeMenu=function(){var e=this.get_controlComponentDomCache().get_largeMenu();if(e&&e.elmDescription){var t=Ft.n.validateStringProperty(this.get_stateProperties()[Et.e.Description],this.get_properties().Description);if(t!==e.elmDescription.innerText&&(e.elmDescription.innerText=t,e.elmLabel&&!h.r(Gn.Jewel,this.get_root()))){var n=!Mt.t(t);Ft.n.toggleCSSClassOnElement(e.elmLabel,"UIFontBold",n),Ft.n.toggleCSSClassOnElement(e.elmLabel,"cui-ctl-mediumlabel-nodescription",!n)}}},t.prototype.attachEvents=function(e){var t=e.elmControl;ne.z.get_instance().registerHandler(ie.d.focus,t,h.i(this,this.onFocus,"onFocus")),ne.z.get_instance().registerHandler(ie.d.blur,t,h.i(this,this.onBlur,"onBlur")),Ct.z.get_instance().registerHandler(ie.d.pointerOver,t,h.i(this,this.onPointerOver,"onPointerOver")),Ct.z.get_instance().registerHandler(ie.d.pointerOut,t,h.i(this,this.onPointerOut,"onPointerOut")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyDown,t,h.i(this,this.onKeyDown,"onKeyDown")),pe.KeyInputManager.get_instance().registerHandler(ie.d.keyUp,t,h.i(this,this.onKeyUp,"onKeyUp")),Ct.z.get_instance().registerHandler(ie.d.pointerDown,t,h.i(this,this.onPointerDown,"onPointerDown")),Ct.z.get_instance().registerHandler(ie.d.pointerUp,t,h.i(this,this.onPointerUp,"onPointerUp")),Rt.s.get_instance().registerHandler(ie.d.click,t,h.i(this,this.onClick,"onClick")),Bt.v.get_instance().registerHandler(ie.d.touchMove,t,h.i(this,this.onTouchMove,"onTouchMove")),Bt.v.get_instance().registerHandler(ie.d.touchEnd,t,h.i(this,this.onTouchEnd,"onTouchEnd"))},t}(xt);(0,h.l)(jn,"ToggleButtonBehavior",xt,[]);var Zn=function(){function e(e){this._factoryMethods=null,this._commitChangeFixEnabled=!1,this._commitChangeFixEnabled=e,this._factoryMethods={Button:function(e){return new Lt(e)},FileMenuButton:function(e){return new Lt(e)},ColorPicker:function(e){return new Ot(e)},ComboBox:function(e){return new fn(e)},ContextMenuControl:function(e){return new yn(e)},ContextMenuLauncher:function(e){return new yn(e)},DialogMenuLauncher:function(e){return new vn(e)},DropDown:function(e){return new dn(e)},FlyoutAnchor:function(e){return new Cn(e)},GalleryButton:function(e){return new An(e)},StatefulColorFlyoutAnchor:function(e){return new Cn(e)},JewelMenuLauncher:function(e){return new kn(e)},Label:function(e){return new Mn(e)},Placeholder:function(e){return new xt(e)},SearchBox:function(e){return new Bn(e)},Separator:function(e){return new xt(e)},SplitButton:function(e){return new Kn(e)},StatefulColorSplitButton:function(e){return new Kn(e)},StatefulImageSplitButton:function(e){return new Kn(e)},TextBox:function(e){return new Qn(e)},ToggleButton:function(e){return new jn(e)}}}return e.prototype.enableInsertTable=function(){this._factoryMethods[wt.Control.insertTableControlType]=function(e){return new En(e)}},e.prototype.enableSlider=function(){this._factoryMethods[wt.Control.sliderControlType]=function(e){return new Nn(e)}},e.prototype.enableSpinner=function(){this._factoryMethods[wt.Control.spinnerControlType]=function(e){return new Wn(e)}},e.prototype.getBehaviorForControl=function(e){var t=this._factoryMethods[e.get_controlType()],n=t?t(e):null;return n&&this._commitChangeFixEnabled&&n.enableCommitChangeFix(),n},e.get_instance=function(){return e._instance||(e._instance=new e(!!l.AFrameworkApplication.appSettingsManager&&l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("CUICommitChangeFixIsEnabled")))},e._instance=null,e}();(0,h.l)(Zn,"ControlBehaviorFactory",null,[bt]);var Xn=n(529),Jn=n(973),Yn=n(239),ei=n(920),ti=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;return o._launcherElement=null,o.x=0,o.y=0,o.launcherHeight=0,o.launcherWidth=0,o._rootUser=null,o.launcherHeight=0,o.launcherWidth=0,o.addDisplayMode("Menu"),o.set_enabled(!0),o}return(0,B.t)(t,e),t.prototype.get_x=function(){return this.x},t.prototype.get_y=function(){return this.y},t.prototype.get_launcherHeight=function(){return this.launcherHeight},t.prototype.get_launcherWidth=function(){return this.launcherWidth},t.prototype.get_rootUser=function(){return this._rootUser},t.prototype.set_rootUser=function(e){return this._rootUser=e,e},t.prototype.get_controlType=function(){return"DialogMenuLauncher"},t.prototype.setInitialAriaMenuLauncherAttributes=function(e){},t.prototype.updateAriaMenuLauncherAttributes=function(e,t){},t.prototype.getCommandPopulateProperties=function(){var e={};return e.MenuId=this.get_id(),e.DialogMoveCommand=this.get_properties$2().DialogMoveCommand,e.DialogCloseCommand=this.get_properties$2().DialogCloseCommand,e},t.prototype.launchDialogMenuAtLauncher=function(e,t){this.x=e.x,this.y=e.y,this.launcherHeight=e.height,this.launcherWidth=e.width,this.launchMenu(t)},t.prototype.createComponentDomForDisplayMode=function(e){return this._launcherElement=Ft.n.createElement("span"),new ei.d(e,this._launcherElement)},t.prototype.get_properties$2=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedMenuLauncher=function(e,n,i){return new t(e,this.get_id(),n,i)},t}(Dt.MenuLauncher);(0,h.l)(ti,"DialogMenuLauncher",Dt.MenuLauncher,[]);var ni=n(45),ii=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i._activeMenu=null,i}return(0,B.t)(t,e),t.prototype.get_activeMenu=function(){return this._activeMenu},t.prototype.get_dialogMenuRootProperties=function(){return this.get_properties()},t.prototype.get_rootType=function(){return 20},t.prototype.refreshInternal=function(){e.prototype.refreshInternal.call(this),Mt.x(this.get_elementInternal())&&this.ensureDOMElement(),this.set_elementInternal(Ft.n.removeChildNodes(this.get_elementInternal())),this.appendChildrenToElement(this.get_elementInternal()),this.set_dirty(!1)},t.prototype.ensureCorrectChildType=function(e){if(!h.r(ni.z,e))throw Error.create("Only children of type StandaloneDock can be added to a DialogMenuRoot")},t.prototype.createDialogMenu=function(e,t,n,i){var r=new Xt.Menu(this,t,n,i,null);e||(e={}),e.CommandMenuOpen=this.get_dialogMenuRootProperties().CommandMenuOpen,e.CommandMenuClose=this.get_dialogMenuRootProperties().CommandMenuClose;var o=new ti(this,t,e,r);this.get_createdControls()[t]=o;var a=new ni.z(this,"dock"+t);a.addChild(o.createComponentForDisplayMode("Menu")),this.addChild(a),this.refresh()},t.prototype.showDialogMenuAt=function(e,t,n,i){var r=this.get_createdControls()[e];if(Mt.x(r))throw Error.create('The dialog menu "'+e+'" does not exist');r.launchDialogMenuAtLauncher(new Sys.UI.Bounds(t,n,0,0),i),this._activeMenu=r.get_menu()},t.prototype.closeDialogMenu=function(e){var t=this.get_createdControls()[e];Mt.x(t)||(t.closeMenu(),this._activeMenu=null)},t.prototype.onMenuStackCleared=function(){this._activeMenu=null},t.prototype.dispose=function(){var t=this.get_createdControls();for(var n in t){({key:n,value:t[n]}).value.dispose()}e.prototype.dispose.call(this)},t}(Yn.w);(0,h.l)(ii,"DialogMenuRoot",Yn.w,[]);var ri=n(319),oi=function(e){function t(){var t=e.call(this)||this;return t.CommandMenuOpen=null,t.CommandMenuClose=null,t}return(0,B.t)(t,e),t}(ri.c);(0,h.l)(oi,"DialogMenuRootProperties",ri.c,[]);var ai="DialogMenuRootId",si=function(){function e(){this._root=null;var e=new oi;e.ImageSideArrow=l.AFrameworkApplication.get_imageClusterPath(),e.ImageSideArrowClass=Jn.getImageClass("SubmenuFlyoutArrow_13x13x32"),e.TextDirection=l.AFrameworkApplication.get_isRtl()?"rtl":"ltr",this._root=new ii(ai,e),this._root.set_rootUser(this),this._root.refresh(),l.AFrameworkApplication.get_theActionManager().addActionWithFlags(se.SV,ye.a,h.i(this,this.populateDialogMenu,"populateDialogMenu"),96)}return e.prototype.get_theRoot=function(){return this._root},e.prototype.executeRootCommand=function(e,t,n,i,r){void 0===i&&(i=null),void 0===r&&(r=null);var o=parseInt(e),a=l.AFrameworkApplication.get_theActionManager();n&&(a.set_commandLocation(n.CommandLocation),a.set_invocationMethod(n.InvocationMethod));var s=t,u=a.processActionWithData(o,2,s,r);return this._root.refresh(),32===u},e.prototype.isRootCommandEnabled=function(e){if(!e)return!0;var t=parseInt(e);return 32===l.AFrameworkApplication.get_theActionManager().processAction(t,1)},e.prototype.pollForStateAndUpdateInternal=function(){this.get_theRoot().get_root().pollForStateAndUpdate()},e.prototype.createDialogMenu=function(e,t,n){var i={PopulateDynamically:"true",PopulateOnlyOnce:"false",PopulateQueryCommand:"3675896289",Command:"798637440"};i.DialogMoveCommand=t,i.DialogCloseCommand=n,this.get_theRoot().createDialogMenu(i,e,"","")},e.prototype.showDialogMenuAt=function(e,t,n,i){this.get_theRoot().showDialogMenuAt(e,t,n,i)},e.prototype.closeDialogMenu=function(e){this.get_theRoot().closeDialogMenu(e)},e.prototype.populateDialogMenu=function(e,t,n,i,r){if(1===n)return 32;var o=r,a=new Sys.StringBuilder;a.append('<Menu Id="dialogMenu">'),a.append('<MenuSection Id="dialogMenuSection" DisplayMode="Menu"><Controls>');var s=o.DialogMoveCommand;a.append(String.format('<Button Id="DialogMenuMoveControl" Command="{0}" LabelText="{1}"/>',s,CommonUIStrings.l_DialogMove));var l=o.DialogCloseCommand;return a.append(String.format('<Button Id="DialogMenuCloseControl" Command="{0}" LabelText="{1}"/>',l,CommonUIStrings.l_DialogClose)),a.append("</Controls></MenuSection>"),a.append("</Menu>"),o.PopulationXML=a.toString(),32},e.prototype.dispose=function(){this._root&&(this._root.dispose(),this._root=null)},e}();(0,h.l)(si,"DialogMenuRootUser",null,[Xn.t,Sys.IDisposable,_t.x]);var li=n(773),ui=function(){function e(e,t,n){this._target=null,this._moveIcon=null,this._startingPosition=null,this._currentPosition=null,this._inMoveMode=!1,this._shouldExit=!1,this._isRTL=!1,this._frameElement=null,this._keyInputManager=null,this._pointerInputManager=null,this._frameElement=e,this._keyInputManager=t,this._pointerInputManager=n,this._isRTL=l.AFrameworkApplication.get_isRtl()}return e.prototype.get_inMoveMode=function(){return this._inMoveMode},e.prototype.enterMoveMode=function(e){e?(this._target=e,this._inMoveMode=!0,this._shouldExit=!1,this._keyInputManager.capture(h.i(this,this.keyEventHandler,"keyEventHandler"),null),this._pointerInputManager.registerHandler(ie.d.pointerDown,this._frameElement,h.i(this,this.pointerDownHandler,"pointerDownHandler")),this._moveIcon||this.createMoveIcon(),this._target.appendChild(this._moveIcon),this.initializeCurrentPosition()):b.ULS.sendTraceTag(21516492,201,10,"Cannot move null element")},e.prototype.exitMoveMode=function(){this._inMoveMode=!1,this._currentPosition=null,this._startingPosition=null,this.removeMoveIcon(),this.releaseHandlers(),this._target=null},e.prototype.releaseHandlers=function(){this._keyInputManager.releaseCapture(),this._pointerInputManager.unregisterHandler(ie.d.pointerDown,this._frameElement,h.i(this,this.pointerDownHandler,"pointerDownHandler"))},e.prototype.initializeCurrentPosition=function(){if(this._target.style.left.endsWith("px")&&this._target.style.right.endsWith("px"))this._currentPosition=new Sys.UI.Point(li.o.parseIntDefaultZero(this._isRTL?this._target.style.right:this._target.style.left),li.o.parseIntDefaultZero(this._target.style.top));else{var e=this._isRTL?this._frameElement.offsetWidth-(this._target.offsetLeft+this._target.offsetWidth+li.o.parseIntDefaultZero(this._target.style.marginRight)):this._target.offsetLeft-li.o.parseIntDefaultZero(this._target.style.marginLeft),t=this._target.offsetTop-li.o.parseIntDefaultZero(this._target.style.marginTop);this.setStylePosition(e,t),this._currentPosition=new Sys.UI.Point(e,t)}this._startingPosition=this._currentPosition},e.prototype.createMoveIcon=function(){this._moveIcon=Jn.createClusteredImage(24,24,"ShapeQuadArrow_24x24x32","WACMoveArrowIcon",!0,"")},e.prototype.removeMoveIcon=function(){this._moveIcon.parentNode===this._target&&this._target.removeChild(this._moveIcon)},e.prototype.keyEventHandler=function(e){if(!this.get_inMoveMode())return!1;if(e.innerEvent.preventDefault(),e.eventName===ie.d.keyDown){var t=e.innerEvent.ctrlKey?1:10,n=void 0;switch(e.innerEvent.keyCode){case ce.v.vK_UpArrow:this.moveElement(0,-1*t);break;case ce.v.vK_DownArrow:this.moveElement(0,1*t);break;case ce.v.vK_LeftArrow:n=this._isRTL?1:-1,this.moveElement(n*t,0);break;case ce.v.vK_RightArrow:n=this._isRTL?-1:1,this.moveElement(n*t,0);break;case ce.v.vK_Esc:this.moveElementTo(this._startingPosition.x,this._startingPosition.y),this._shouldExit=!0;break;case ce.v.vK_Enter:this._shouldExit=!0}}return e.eventName===ie.d.keyUp&&this._shouldExit&&this.exitMoveMode(),!0},e.prototype.pointerDownHandler=function(e){return!!this.get_inMoveMode()&&(e.innerEvent.preventDefault(),this.exitMoveMode(),!0)},e.prototype.moveElement=function(e,t){var n=this._currentPosition.x+e,i=this._currentPosition.y+t;this.moveElementTo(n,i)},e.prototype.moveElementTo=function(e,t){var n=this.adjustPositionForAppFrameBounds(e,t);this.setStylePosition(n.x,n.y),this._currentPosition=n},e.prototype.setStylePosition=function(e,t){this._isRTL?this._target.style.right=e+"px":this._target.style.left=e+"px",this._target.style.top=t+"px"},e.prototype.adjustPositionForAppFrameBounds=function(e,t){var n=this._isRTL?li.o.parseIntDefaultZero(this._target.style.marginRight):li.o.parseIntDefaultZero(this._target.style.marginLeft),i=this._frameElement.offsetWidth-this._target.offsetWidth-n,r=Math.min(Math.max(-n,e),i),o=li.o.parseIntDefaultZero(this._target.style.marginTop),a=this._frameElement.offsetHeight-this._target.offsetHeight-o,s=Math.min(Math.max(-o,t),a);return new Sys.UI.Point(r,s)},e}();(0,h.l)(ui,"KeyMoveAdapter",null,[ft.o]);var ci=n(212),pi=n(607),di=n(167),hi=n(771),gi=function(e){function t(){var t=e.call(this)||this;return t.DisplayName=null,t.PersonaId=null,t.IsAnonymous=!1,t}return(0,B.t)(t,e),t.prototype.get_ControlType=function(){return 4},t}(hi.k);(0,h.l)(gi,"PersonaButtonProps",hi.k,[]);var mi=function(){function e(){}return e.prototype.createProps=function(e,t){if(e&&!(e.length<1)&&t){var n=(0,A.m)(new di.x,{ExternalId:"msPresenceOuter",ControlList:[]});this.createFlyoutAnchorProps(e,n.ControlList),t.push(n)}},e.prototype.createFlyoutAnchorProps=function(e,t){var n=(0,A.m)(new ci.b,{ExternalId:"ContextCoauthors",LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:(0,A.m)(new pi.b,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(t,n);var i=(0,A.m)(new di.x,{Title:"",ControlList:[]});Array.add(n.Menu.MenuSectionList,i),this.createPersonaButtonProps(e,i.ControlList)},e.prototype.createPersonaButtonProps=function(e,t){for(var n=0;n<e.length;n++){var i=(0,A.m)(new gi,{ExternalId:String.format("CoauthorPersona_{0}",n),Command:"336231556",DisplayName:e[n].get_userName(),LabelText:e[n].get_userName(),ImageBackColor:e[n].get_color(),PersonaId:e[n].get_email(),IsAnonymous:e[n].get_isAnonymous()});Array.add(t,i)}},e}();(0,h.l)(mi,"PresenceContextMenuSectionBuilder",null,[vt]);var _i=n(930),fi=n(209),yi=function(){function e(){}return e.prototype.get_name=function(){return"CUI.Behavior"},e.prototype.configure=function(e){l.AFrameworkApplication.appSettingsManager&&l.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("AccessibleMovingDialogsEnabled")&&(e.register(_t.x).singleInstance().usingFactory((function(){return new si})),e.register(ft.o).singleInstance().usingFactory((function(){return new ui(l.AFrameworkApplication.get_activeFrame().getDOMElement(),pe.KeyInputManager.get_instance(),Ct.z.get_instance())}))),e.register(fi.f).as(yt.b).singleInstance().usingFactory((function(){return fi.f.get_instance()})),e.register(vt).singleInstance().usingFactory((function(){return new mi}))},e.prototype.init=function(){_i.b.set_controlBehaviorFactory(Zn.get_instance());for(var e=fi.f.get_instance().get_roots(),t=0;t<e.length;++t){var n=(0,c.e)(St.s,e[t]);n&&n.ensureBehaviorAttached()}y.r.get_instance().setAppInitializationStatus(6)},e.prototype.dispose=function(){},e.main=function(){H.o.get_instance().registerPackage(new e,5)},e}();(0,h.l)(yi,"CuiBehaviorPackage",null,[S.u,C.s]);var vi=n(998),Si=n(367);window.IEnumerable=vi.y,window.IEnumerator=Si.x,"undefined"==typeof Sys&&Type.registerNamespace("Sys");var Ci=n(742),bi=n(473),Ai=n(667),Ti=function(){function e(){this._scheduler=null,this._scheduler=Ai.a.get_default()}return e.prototype.S=function(e){var t=Ci.Task.Create(e);return t.Start$Scheduler(this._scheduler),t},e.prototype.SC=function(e,t){var n=Ci.Task.Create(e);return t.get_isCancellationRequested()?n.setCanceled():n.Start$Scheduler(this._scheduler),n},e.prototype.SO=function(e,t){var n=Ci.Task.Create$object(e,t);return n.Start$Scheduler(this._scheduler),n},e.prototype.SOC=function(e,t,n){var i=Ci.Task.Create$object(e,t);return n.get_isCancellationRequested()?i.setCanceled():i.Start$Scheduler(this._scheduler),i},e.prototype.SR=function(e,t){var n=bi.Task$1.$$(e).C(t);return n.Start$Scheduler(this._scheduler),n},e.prototype.SRC=function(e,t,n){var i=bi.Task$1.$$(e).C(t);return n.get_isCancellationRequested()?i.setCanceled():i.Start$Scheduler(this._scheduler),i},e.prototype.SRO=function(e,t,n){var i=bi.Task$1.$$(e).CO(t,n);return i.Start$Scheduler(this._scheduler),i},e.prototype.SROC=function(e,t,n,i){var r=bi.Task$1.$$(e).CO(t,n);return i.get_isCancellationRequested()?r.setCanceled():r.Start$Scheduler(this._scheduler),r},e}();(0,h.l)(Ti,"TaskFactory",null,[]);var wi=function(e){function t(){return e.call(this)||this}return(0,B.t)(t,e),t.prototype.queueTask=function(e){var t=this;window.setTimeout((function(){t.tryExecuteTask(e)}),0)},t}(Ai.a);(0,h.l)(wi,"DefaultTaskScheduler",Ai.a,[]),Type.registerNamespace("$$sc"),window.$$as=function(e,t){return e.isInstanceOfType(t)?t:null},Ci.Task._factory=new Ti,Ai.a._default=new wi,Ai.a._current=Ai.a._default,Type.registerNamespace("AppRealtimeChannel"),Type.registerNamespace("Box4"),Type.registerNamespace("CADWLTR"),Type.registerNamespace("CAUI"),Type.registerNamespace("CUIB"),Type.registerNamespace("CommandUI"),Type.registerNamespace("CommandUI.Controls"),Type.registerNamespace("CommandUI.Controls.SearchBoxComponents"),Type.registerNamespace("Common"),Type.registerNamespace("Common.AdaptiveLayout"),Type.registerNamespace("Common.App"),Type.registerNamespace("Common.App.AccessibilityHelpDialog"),Type.registerNamespace("Common.App.ApplicationFeatureHelper"),Type.registerNamespace("Common.App.BasicChat"),Type.registerNamespace("Common.App.BrowserInfoLogger"),Type.registerNamespace("Common.App.CoauthTelemetry"),Type.registerNamespace("Common.App.CustomerFeedback"),Type.registerNamespace("Common.App.Diagnostics"),Type.registerNamespace("Common.App.DirectPrint"),Type.registerNamespace("Common.App.LearningTools"),Type.registerNamespace("Common.App.O365Shell"),Type.registerNamespace("Common.App.OtelLibraryLoader"),Type.registerNamespace("Common.App.Policy.Contracts"),Type.registerNamespace("Common.App.SafeLinks"),Type.registerNamespace("Common.App.SaveStatus"),Type.registerNamespace("Common.App.SearchCommon"),Type.registerNamespace("Common.App.SensitiveLogging"),Type.registerNamespace("Common.App.SkypeChat"),Type.registerNamespace("Common.App.Zoom"),Type.registerNamespace("Common.Collections"),Type.registerNamespace("Common.Comments"),Type.registerNamespace("Common.Interface"),Type.registerNamespace("Common.NetworkTiming"),Type.registerNamespace("Common.UI"),Type.registerNamespace("Common.UnitTestFramework"),Type.registerNamespace("Common.Utils"),Type.registerNamespace("Common.Utils.Aggregators"),Type.registerNamespace("Common.Utils.System"),Type.registerNamespace("Common.Utils.Telemetry"),Type.registerNamespace("CommonUI"),Type.registerNamespace("Diag"),Type.registerNamespace("DiagUse"),Type.registerNamespace("Fdbk"),Type.registerNamespace("Otel"),Type.registerNamespace("System"),Type.registerNamespace("System.Collections.Generic"),Type.registerNamespace("Wac.Common"),Type.registerNamespace("Wac.Common.SendUsYourFile"),Type.registerNamespace("WordShared"),Type.registerNamespace("WordViewer"),Type.registerNamespace("WordViewer.Comments"),Type.registerNamespace("WordViewer.Controls"),Type.registerNamespace("WordViewer.DisplayManager"),Type.registerNamespace("WordViewer.DocumentData"),Type.registerNamespace("WordViewer.DynamicScriptLoader"),Type.registerNamespace("WordViewer.PageInfo"),Type.registerNamespace("WordViewer.Search"),Type.registerNamespace("WordViewer.Selection"),Type.registerNamespace("common"),window.isUndefined=function(e){return void 0===e},window.isNull=function(e){return null===e},window.isNullOrUndefined=function(e){return null==e},window.Common.AsynchronousXMLHttpExecutor=i.c,window.Common.SynchronousXMLHttpExecutor=r.j,window.Common.FetchKeepAliveExecutor=o.n;var Ii=a;window.otel=Ii;var Ei=s;window.health=Ei,window.Common.AFrameworkApplication=l.AFrameworkApplication,window.Common.Debug=u.Debug,window.$$methodFrame=function(e){return u.Debug.methodFrame(e,(0,c.e)(Function,arguments.callee.caller))},window.hardSigninCompleted=function(){p.t.get_instance().authenticationCheck()},window.Common.TestHarnessInterface=d.o,window.Common.ActionDataContainer=m,window.Common.CrossDomainRequestExecutor=_.b,window.Common.ObjectModelUtils=f.x,window.Common.App.AppLifecycleManager=y.r;var ki=v;window.qosWac=ki,V.main(),K.main(),J.main(),Se.main(),H.o.get_instance().registerPackage(new ke),De.p.main(),Me.main(),Re.main(),H.o.get_instance().registerPackage(new et),window.dynamicScriptLoaderDependencies=tt;var Di=nt;window.dynamicScriptLoader=Di,window.dynamicScriptLoader=Di,H.o.get_instance().registerPackage(new st),window.WordCampaignsObj=[{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customux",StartTimeUtc:"2019-10-23T00:00:00Z",EndTimeUtc:"2039-12-29T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPSOneClick",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageNPSOneClickTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_OneClickPromptQuestion_Word",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_OneClickRatingQuestion_Word",RatingValuesAscending:["nps_OneClickRating_Values_1","nps_OneClickRating_Values_2","nps_OneClickRating_Values_3","nps_OneClickRating_Values_4","nps_OneClickRating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"95e3afa4-6f57-42e8-9750-86add4f45573",StartTimeUtc:"2018-03-12T00:00:00Z",EndTimeUtc:"2019-12-29T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SLROptOut",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on the web version of Word's Simplified Ribbon!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall, how satisfied were you with it?",RatingValuesAscending:["1 - Very dissatisfied","2 - Somewhat dissatisfied","3 - Neutral","4 - Somewhat satisfied","5 - Very satisfied"]},Question:{Question:"Why did you turn off the Simplified Ribbon?"}}}},{CampaignId:"c3898ba1-939b-4d4e-adf2-1d07caf2328d",StartTimeUtc:"2018-03-12T00:00:00Z",EndTimeUtc:"2019-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SLRCommandUsed",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"We'd love your feedback on the web version of Word's Simplified Ribbon!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall how do you feel while using the Simplified Ribbon at the top?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Tell us more about why you chose this answer"}}}},{CampaignId:"56fd0d5e-2388-4638-9ba8-d5d095440f2a",StartTimeUtc:"2018-04-02T00:00:00Z",EndTimeUtc:"2018-10-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"DefaultToEdit",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Now you can edit documents immediately in Word on the web",Question:"We'd love your feedback!",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Instead of opening a read-only version of your document, you can now edit right away. How satisfied are you with the new experience?",RatingValuesAscending:["1 - Very dissatisfied","2 - Somewhat dissatisfied","3 - Neutral","4 - Somewhat satisfied","5 - Very satisfied"]},Question:{Question:"Tell us more about why you chose this rating"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_Word",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"2df03896-1257-4681-a7f6-1e241349f1f5",StartTimeUtc:"2018-06-18T00:00:00Z",EndTimeUtc:"2018-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AtMentionDeepLink",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"AtMentionFS_PromptTitle",Question:"AtMentionFS_PromptQuestion",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"AtMentionFS_RatingQuestion",RatingValuesAscending:["AtMentionFS_RaitingValue_1","AtMentionFS_RaitingValue_2","AtMentionFS_RaitingValue_3","AtMentionFS_RaitingValue_4","AtMentionFS_RaitingValue_5"]},Question:{Question:"AtMentionFS_Question"}}}},{CampaignId:"e73aa75c-4ad3-45f6-abaf-a92dfe257c0c",StartTimeUtc:"2018-09-05T00:00:00Z",EndTimeUtc:"2019-09-15T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"UsageForFeelingsSurveySuiteLevel",IsAggregate:!0,Count:300},{Type:0,Activity:"UsageTimeSatisfiedForFeelingsSurveySuiteLevel",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback!",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall how do you feel while using Word, Excel, and PowerPoint on the web?",RatingValuesAscending:["1-Extremely negative","2-Somewhat negative","3-Neither negative nor positive","4-Somewhat positive","5-Extremely positive"]},Question:{Question:"Please tell us more.\xa0 Why did you choose that answer?"}}}},{CampaignId:"92b899ee-add4-4f8f-b912-cacd4a7e46d9",StartTimeUtc:"2018-09-05T00:00:00Z",EndTimeUtc:"2019-09-15T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:1,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"UsageForFeelingsSurveyAppLevel",IsAggregate:!0,Count:300},{Type:0,Activity:"UsageTimeSatisfiedForFeelingsSurveyAppLevel",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback!",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall how do you feel while using Word on the web?",RatingValuesAscending:["1-Extremely negative","2-Somewhat negative","3-Neither negative nor positive","4-Somewhat positive","5-Extremely positive"]},Question:{Question:"Please tell us more.\xa0 Why did you choose that answer?"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2018-11-26T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in Word on the web.",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"ab3891e1-0732-4423-a33a-3f345b0e7c91",StartTimeUtc:"2018-12-04T00:00:00Z",EndTimeUtc:"2019-05-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPSLocalizationTest",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"6db126af-c2c8-48be-88f6-fae4ad46ee24",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2020-02-29T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"DictationV2Used",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"We'd love your feedback on Dictation in Word!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:" Overall, how satisfied are you with the Dictation feature in Word?",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-03-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2020-10-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied were you with the web version of Word for content creation and collaboration?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us more about why you chose your answer"}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-03-27T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:3,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Would you recommend Office 365 to others, if asked?",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"Please describe how we can make Office 365 better for you."}}}},{CampaignId:"74eb3f02-206c-47c2-ad65-c4d21db60910",LauncherType:"coachingux",StartTimeUtc:"2019-05-15T00:00:00Z",EndTimeUtc:null,GovernedChannelType:3,Scope:{Type:1,Languages:[{Type:0,Value:"en-US"},{Type:0,Value:"en-GB"}]},NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:1209600},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:22,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ShowFirstRunExperienceUIV2",Count:1,IsAggregate:!0}]},Metadata:{ContentMetadata:{itemCount:3,surfaceType:"sequence",preFetchDelay:500,preventAutoDismiss:!0,backgroundColor:"#2b579a",closeButtonAriaLabel:"Close",position:"left",anchorHint:5,surfaceType1:"teaching",anchorElementSelectors1:["#BreadcrumbSaveStatus","#documentTitle","#documentTitleContainer","#WACRibbon-QATRowCenter","#ResponsiveCenterRegion","#AppHeaderPanel","div[role='toolbar']","div[class*='cui-topBar1-transistionalHeaderUI']","#o365header","#O365_NavHeader"],title1:"Welcome to Word on the web",description1:"Your document automatically saves \nand can be found on Office.com.",illustrationImage1:"https://contentstorage.osi.office.net/dynamiccanvas/programmablesurfaces/prod/assets/office/word/fre/autosave.svg",primaryButtonText1:"Next",delayLoad1:1e3,retryTimes1:3,retryInterval1:500,surfaceType2:"teaching",anchorElementSelectors2:["button[data-unique-id='Share']","button[aria-label='Share']"],title2:"Share your document",description2:"Send a link to others so they can view \nand edit.",illustrationImage2:"https://contentstorage.osi.office.net/dynamiccanvas/programmablesurfaces/prod/assets/office/word/fre/share.svg",primaryButtonText2:"Next",surfaceType3:"teaching",anchorElementSelectors3:["button[data-unique-id='ShowCommentsTopBar']","button[aria-label='Comments']"],title3:"Add comments",description3:"Make comments, read or reply to \nexisting ones.",illustrationImage3:"https://contentstorage.osi.office.net/dynamiccanvas/programmablesurfaces/prod/assets/office/word/fre/comments.svg",primaryButtonText3:"Got it"}}}},{CampaignId:"c376b98d-aa70-4d46-b9ff-a370cea8e438",StartTimeUtc:"2019-06-01T00:00:00Z",EndTimeUtc:"2020-06-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WACTranslatorSurveyTrigger",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on the translation experience.",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the translation experience in Office?",RatingValuesAscending:["1 - Not Satisfied","2","3","4","5 - Very Satisfied"]},Question:{Question:"Any suggestions for how we can improve the translation experience?"}}}},{CampaignId:"5fcca8af-6431-499e-a399-68dec620c2fa",GovernedChannelType:1,StartTimeUtc:"2019-07-01T00:00:00Z",EndTimeUtc:"2020-07-01T00:00:00Z",AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:432e3},FallbackSurveyDurationSeconds:5},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordTypingSurveyTrigger",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on your typing experience in Word on the web",Question:"We have just two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How was your typing experience in Word on the web?",RatingValuesAscending:["1 - Not Satisfied","2","3","4","5 - Very Satisfied"]},Question:{Question:"Please tell us why you chose that answer(Optional)"}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2020-10-13T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"ed3f617b-ca66-48ff-8b98-2f6a1435a01e",StartTimeUtc:"2019-08-16T00:00:00Z",EndTimeUtc:"2019-11-18T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordWebCommitNewCommentActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"We'd love your feedback on Comments in Word.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall how do you feel while using Comments in Word?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us more. Why did you choose that answer?"}}}},{CampaignId:"b915b0e8-f0ff-4e44-8b29-19e9ab1983bc",StartTimeUtc:"2019-01-15T00:00:00Z",EndTimeUtc:"2019-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PresenceIpRendered",IsAggregate:!1,Count:3}]},Content:{Prompt:{Title:"We would love your feedback about working with others in Word on the web",Question:"We have one question for you about the experience.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with how other people appear in the file?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us more about why you chose this rating."}}}},{CampaignId:"f09ecdb8-4df4-4b13-856b-b1dceaf46d42",StartTimeUtc:"2019-09-12T00:00:00Z",EndTimeUtc:"2020-03-31T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TrackChangesUsed",IsAggregate:!1,Count:2}]},Content:{Prompt:{Title:"In Review Mode your edits are tracked as suggestions.",Question:"We have one question for you about the experience.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with this feature?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither dissatisfied nor satisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us more about why you chose this rating."}}}},{CampaignId:"53080772-6284-4a08-9f25-5e3477e17bfa",StartTimeUtc:"2019-09-25T00:00:00Z",EndTimeUtc:"2020-07-31T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordWebToWebActiveCoauth",IsAggregate:!0,Count:20}]},Content:{Prompt:{Title:"CoauthLatencySurvey_PromptTitle",Question:"CoauthLatencySurvey_PromptQuestion",YesLabel:"CoauthLatencySurvey_YesLabel",NoLabel:"CoauthLatencySurvey_NoLabel"},Rating:{Question:"CoauthLatencySurvey_RatingQuestion",RatingValuesAscending:["CoauthLatencySurvey_Rating_Values_1","CoauthLatencySurvey_Rating_Values_2","CoauthLatencySurvey_Rating_Values_3","CoauthLatencySurvey_Rating_Values_4"]},Question:{Question:"CoauthLatencySurvey_QuestionQuestion"}}}},{CampaignId:"91d835f4-cd27-49bc-b86b-909703fcaba5",StartTimeUtc:"2019-12-13T00:00:00Z",EndTimeUtc:"2020-03-04T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office_Docs_SharedComments_CommitComment",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"AtMentionFPS_Title",Question:"AtMentionFPS_Question",YesLabel:"AtMentionFPS_YesLabel",NoLabel:"AtMentionFPS_NoLabel"},Rating:{Question:"AtMentionFPS_RatingQuestion",RatingValuesAscending:["AtMentionFPS_RatingValue_1","AtMentionFPS_RatingValue_2","AtMentionFPS_RatingValue_3","AtMentionFPS_RatingValue_4","AtMentionFPS_RatingValue_5"]},Question:{Question:"AtMentionFPS_WhyQuestion"}}}},{CampaignId:"85b78574-0a8b-405b-8e57-ebe3df413a42",StartTimeUtc:"2019-11-25T00:00:00Z",EndTimeUtc:"2020-04-04T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WordWebUndoPreserve",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"UndoExperience_PromptTitle",Question:"UndoExperience_PromptQuestion",YesLabel:"UndoExperience_PromptLabel_Sure",NoLabel:"UndoExperience_PromptLabel_No"},Rating:{Question:"UndoExperience_RatingQuestion",RatingValuesAscending:["UndoExperience_Rating1","UndoExperience_Rating2","UndoExperience_Rating3","UndoExperience_Rating4","UndoExperience_Rating5"]},Question:{Question:"UndoExperience_WhyQuestion"}}}},{CampaignId:"b0d64dba-9345-4b14-9975-4991bd2ed51a",StartTimeUtc:"2020-02-04T00:00:00Z",EndTimeUtc:"2020-04-03T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"ReviewModeShareLinksUsed",IsAggregate:!1,Count:2}]},Content:{Prompt:{Title:"ReviewMode_FloodgatePromptTitle",Question:"ReviewMode_FloodgatePromptQuestion",YesLabel:"ReviewMode_FloodgatePrompt_YesLabel",NoLabel:"ReviewMode_FloodgatePrompt_NoLabel"},Rating:{Question:"ReviewMode_FloodgateRatingQuestion",RatingValuesAscending:["ReviewMode_FloodgateRating_1","ReviewMode_FloodgateRating_2","ReviewMode_FloodgateRating_3","ReviewMode_FloodgateRating_4","ReviewMode_FloodgateRating_5"]},Question:{Question:"ReviewMode_FloodgateQuestion"}}}}],window.PPTCampaignsObj=[{CampaignId:"2df03896-1257-4681-a7f6-1e241349f1f5",StartTimeUtc:"2018-06-18T00:00:00Z",EndTimeUtc:"2018-12-31T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AtMentionDeepLink",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"AtMentionFS_PromptTitle",Question:"AtMentionFS_PromptQuestion",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"AtMentionFS_RatingQuestion",RatingValuesAscending:["AtMentionFS_RaitingValue_1","AtMentionFS_RaitingValue_2","AtMentionFS_RaitingValue_3","AtMentionFS_RaitingValue_4","AtMentionFS_RaitingValue_5"]},Question:{Question:"AtMentionFS_Question"}}}},{CampaignId:"7BC32D60-19AD-41B5-A039-4408D47C5884",LauncherType:"customux",StartTimeUtc:"2020-01-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:8,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPSOneClick",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageNPSOneClickTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_OneClickPromptQuestion_PPT",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_OneClickRating_Values_1","nps_OneClickRating_Values_2","nps_OneClickRating_Values_3","nps_OneClickRating_Values_4","nps_OneClickRating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_PowerPoint",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthContentMerge",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in PowerPoint Online.",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:8,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"WebSuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"WebSuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Would you recommend Office 365 to others, if asked?",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"Please describe how we can make Office 365 better for you."}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2019-09-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2020-10-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied were you with PowerPoint Online for content creation and collaboration?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us more about why you chose your answer"}}}},{CampaignId:"278833a1-5538-4739-8fe7-9a7e23336414",StartTimeUtc:"2019-02-25T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"TranscriptionUsed",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on live captions & subtitles.",Question:"It will only take a few seconds.",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"How satisfied were you and your audience with the live captions or subtitles experience?",RatingValuesAscending:["1 - Not satisfied","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","5 - Very satisfied"]},Question:{Question:"Please tell us what you liked or didn't like."}}}},{CampaignId:"0d13dbe1-af04-49d1-84a8-624706f4293f",StartTimeUtc:"2019-04-08T00:00:00Z",EndTimeUtc:"2019-07-08T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3}},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"HasSeenDesigner",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"We'd love your feedback on PowerPoint Design Ideas",Question:"We have just 2 questions",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall, how do you feel while using Design Ideas?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Why did you choose that answer?"}}}},{CampaignId:"b915b0e8-f0ff-4e44-8b29-19e9ab1983bc",StartTimeUtc:"2019-09-03T00:00:00Z",EndTimeUtc:"2020-04-03T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PresenceBubbleRendered",IsAggregate:!1,Count:3}]},Content:{Prompt:{Title:"We would love your feedback about working with others in PowerPoint on the web",Question:"We have one question for you about the experience.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with how other people appear in the file?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us more about why you chose this rating."}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2020-10-13T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"91d835f4-cd27-49bc-b86b-909703fcaba5",StartTimeUtc:"2019-12-13T00:00:00Z",EndTimeUtc:"2020-03-04T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office_Docs_SharedComments_CommitComment",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"AtMentionFPS_Title",Question:"AtMentionFPS_Question",YesLabel:"AtMentionFPS_YesLabel",NoLabel:"AtMentionFPS_NoLabel"},Rating:{Question:"AtMentionFPS_RatingQuestion",RatingValuesAscending:["AtMentionFPS_RatingValue_1","AtMentionFPS_RatingValue_2","AtMentionFPS_RatingValue_3","AtMentionFPS_RatingValue_4","AtMentionFPS_RatingValue_5"]},Question:{Question:"AtMentionFPS_WhyQuestion"}}}},{CampaignId:"ed3f617b-ca66-48ff-8b98-2f6a1435a01e",StartTimeUtc:"2019-12-20T00:00:00Z",EndTimeUtc:"2020-03-18T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebCommitNewCommentActivity",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"We'd love your feedback on Comments in PowerPoint.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall how do you feel while using Comments in PowerPoint?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us more. Why did you choose that answer?"}}}},{CampaignId:"59857ee9-c113-46fc-9ec1-e9674870b839",StartTimeUtc:"2020-02-01T00:00:00Z",EndTimeUtc:"2020-03-01T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:604800},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"PPTWebLivePresentationsActivity",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We\u2019d love your feedback on the PowerPoint Live experience.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the latest Live Presentation?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer"}}}}],window.VisioCampaignsObj=[{CampaignId:"bb3ef5aa-e2a4-4ca2-b268-7d8177571479",StartTimeUtc:"2018-09-12T00:00:00Z",EndTimeUtc:"2019-12-29T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CreateUsingOnlineTemplate",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"We'd love your feedback on Visio Diagrams!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate us on how well are the diagrams provided by Visio satisfying your requirements.",RatingValuesAscending:["1- Very Unsatisfied","2","3","4","5- Very Satisfied"]},Question:{Question:"Please describe what other diagram types you would like to create in Visio for web."}}}},{CampaignId:"57fe6b60-8573-4597-b970-5502bda91735",StartTimeUtc:"2019-02-01T00:00:00Z",EndTimeUtc:"2020-02-29T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CFFused",IsAggregate:!0,Count:10}]},Content:{Prompt:{Title:"We'd love your feedback on cross-functional flowcharts in Visio!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience.",RatingValuesAscending:["1- Poor","2","3","4","5- Excellent"]},Question:{Question:"Please describe what you liked or would improve about cross-functional flowcharts."}}}},{CampaignId:"4671f4f7-e787-4a0b-a067-784d3d45a0fd",StartTimeUtc:"2019-04-28T00:00:00Z",EndTimeUtc:"2020-05-29T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"UMLused",IsAggregate:!0,Count:10}]},Content:{Prompt:{Title:"We'd love your feedback on UML diagrams in Visio!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with the UML diagrams in Visio for web?",RatingValuesAscending:["1- Very Unsatisfied","2","3","4","5- Very Satisfied"]},Question:{Question:"Please tell us more why you chose the above rating."}}}},{CampaignId:"f3c27b06-f784-4368-9e19-a5671ef875b6",StartTimeUtc:"2020-02-07T00:00:00Z",EndTimeUtc:"2020-05-06T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:30,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Collabused",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"collab_Title_Visio",Question:"collab_Prompt_Question_Visio",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"collab_RatingQuestion_Visio",RatingValuesAscending:["collab_Rating_Values_1","collab_Rating_Values_2","collab_Rating_Values_3","collab_Rating_Values_4","collab_Rating_Values_5"]},Question:{Question:"collab_Question_Visio"}}}},{CampaignId:"e195e5f6-8aca-4856-839a-3b56de5c6674",StartTimeUtc:"2019-07-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:40,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VisioAppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"VisioAppUsageNPSFollowUpActivity",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_Visio",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"5cac8fe8-9e25-4e39-ad63-90524d42637a",StartTimeUtc:"2020-02-10T00:00:00Z",EndTimeUtc:"2020-04-10T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:20,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CustomConnectorsUsed",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"connector_campaign_Title",Question:"connector_campaign_Prompt_Question",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"connector_campaign_Survey_Question",RatingValuesAscending:["connector_campaign_Rating_Values_1","connector_campaign_Rating_Values_2","connector_campaign_Rating_Values_3","connector_campaign_Rating_Values_4","connector_campaign_Rating_Values_5"]},Question:{Question:"connector_campaign_Verbatim_Question"}}}}],window.ExcelCampaignsObj=[{CampaignId:"2df03896-1257-4681-a7f6-1e241349f1f5",StartTimeUtc:"2018-06-18T00:00:00Z",EndTimeUtc:"2019-06-30T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AtMentionDeepLink",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"AtMentionFS_PromptTitle",Question:"AtMentionFS_PromptQuestion",YesLabel:"AtMentionFS_YesLabel",NoLabel:"AtMentionFS_NoLabel"},Rating:{Question:"AtMentionFS_RatingQuestion",RatingValuesAscending:["AtMentionFS_RaitingValue_1","AtMentionFS_RaitingValue_2","AtMentionFS_RaitingValue_3","AtMentionFS_RaitingValue_4","AtMentionFS_RaitingValue_5"]},Question:{Question:"AtMentionFS_Question"}}}},{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_Excel",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"95e3afa4-6f57-42e8-9750-86add4f45573",StartTimeUtc:"2018-11-15T00:00:00Z",EndTimeUtc:"2019-12-29T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SLROptOut",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on the web version of Excel's Simplified Ribbon!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall, how satisfied were you with it?",RatingValuesAscending:["1 - Very dissatisfied","2 - Somewhat dissatisfied","3 - Neutral","4 - Somewhat satisfied","5 - Very satisfied"]},Question:{Question:"Why did you turn off the Simplified Ribbon?"}}}},{CampaignId:"c3898ba1-939b-4d4e-adf2-1d07caf2328d",StartTimeUtc:"2018-11-15T00:00:00Z",EndTimeUtc:"2019-12-29T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SLRCommandUsed",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"We'd love your feedback on the web version of Excel's Simplified Ribbon!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall how do you feel while using the Simplified Ribbon at the top?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Tell us more about why you chose this answer"}}}},{CampaignId:"39c281be-953d-4788-8878-2361b1574fe6",StartTimeUtc:"2019-01-28T00:00:00Z",EndTimeUtc:"2025-12-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:5,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CoauthOccurred",IsAggregate:!0,Count:5}]},Content:{Prompt:{Title:"Another person is editing the file with you right now.",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Please rate your experience working with others at the same time in Excel on the web.",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please describe how we can make real-time collaboration better for you."}}}},{CampaignId:"b915b0e8-f0ff-4e44-8b29-19e9ab1983bc",StartTimeUtc:"2019-01-15T00:00:00Z",EndTimeUtc:"2019-12-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"MultiUserPresenceOccurred",IsAggregate:!0,Count:2}]},Content:{Prompt:{Title:"We would love your feedback about working with others in Excel on the web",Question:"We have one question for you about the experience.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied are you with how other people appear in the file?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor satisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Tell us more about why you chose this rating."}}}},{CampaignId:"99e8783d-e51c-401f-843f-b59f8ef58754",StartTimeUtc:"2019-03-01T00:00:00Z",EndTimeUtc:"2020-03-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:2419200},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"VersionHistoryExited",IsAggregate:!0,Count:1},{Type:0,Activity:"VersionHistoryCheckExited",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on Version History.",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How would you rate your experience with using Version History?",RatingValuesAscending:["1 - Extremely negative","2 - Somewhat negative","3 - Neither negative nor positive","4 - Somewhat positive","5 - Extremely positive"]},Question:{Question:"Please tell us why you chose that answer."}}}},{CampaignId:"254748d4-1af8-4c34-ab56-303ae10e6719",StartTimeUtc:"2019-03-11T00:00:00Z",EndTimeUtc:"2020-10-31T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:25,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:604800},CooldownPeriod:{Type:0,IntervalSeconds:5184e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"LinkedInWACUsage",IsAggregate:!0,Count:300},{Type:0,Activity:"LinkedInWACUsageTimeSatisfied",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"Hey LinkedIn, we need your help to make Office better!",Question:"We have two questions for you.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"How satisfied were you with the web version of Excel for content creation and collaboration?",RatingValuesAscending:["1 - Extremely dissatisfied","2 - Somewhat dissatisfied","3 - Neither satisfied nor dissatisfied","4 - Somewhat satisfied","5 - Extremely satisfied"]},Question:{Question:"Please tell us more about why you chose your answer"}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Would you recommend Office 365 to others, if asked?",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"Please describe how we can make Office 365 better for you."}}}},{CampaignId:"93b605bc-bb75-4163-9006-3e223188b16d",StartTimeUtc:"2019-05-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:10,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:1209600},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"NamedSheetViewFeedback",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"NSV_Prompt_Title_Feedback",Question:"NSVPromptQuestion",YesLabel:"L_WAC_GenericSurvey_SureLabel",NoLabel:"L_WAC_GenericSurvey_NoLabel"},Rating:{Question:"NSVTimedSurvey_Question",RatingValuesAscending:["SatisfactionRating_1","SatisfactionRating_2","SatisfactionRating_3","SatisfactionRating_4","SatisfactionRating_5"]},Question:{Question:"NSV_Timed_Feedback_Freeform_Question"}}}},{CampaignId:"450bbdb1-a4a4-4552-a995-33085df4a4b2",StartTimeUtc:"2019-05-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:1209600},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"NamedSheetViewNotCreatedFeedback",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"NSVDidntCreatePrompt",Question:"NSVPromptQuestion",YesLabel:"L_WAC_GenericSurvey_SureLabel",NoLabel:"L_WAC_GenericSurvey_NoLabel"},Rating:{Question:"NSVDidntCreateSheetViewQuestion",RatingValuesAscending:["NSVDidntCreateNSVOption_1","NSVDidntCreateNSVOption_2","NSVDidntCreateNSVOption_3","NSVDidntCreateNSVOption_4"]},Question:{Question:"NSVFreeformDidntCreateSheetView"}}}},{CampaignId:"b698805c-10fa-46d5-a06b-9a41620c5427",StartTimeUtc:"2019-08-13T00:00:00Z",EndTimeUtc:"2020-10-13T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"CatchUpChangesFeedback",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"CatchUpFPS_Title",Question:"CatchUpFPS_Question",YesLabel:"CatchUpFPS_YesLabel",NoLabel:"CatchUpFPS_NoLabel"},Rating:{Question:"CatchUpFPS_RatingQuestion",RatingValuesAscending:["CatchUpFPS_RatingValue_1","CatchUpFPS_RatingValue_2","CatchUpFPS_RatingValue_3","CatchUpFPS_RatingValue_4","CatchUpFPS_RatingValue_5"]},Question:{Question:"CatchUpFPS_WhyQuestion"}}}},{CampaignId:"91d835f4-cd27-49bc-b86b-909703fcaba5",StartTimeUtc:"2019-12-01T00:00:00Z",EndTimeUtc:"2020-03-04T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:100,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:2592e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"Office_Docs_SharedComments_CommitComment",IsAggregate:!0,Count:1}]},Content:{Prompt:{Title:"AtMentionFPS_Title",Question:"AtMentionFPS_Question",YesLabel:"AtMentionFPS_YesLabel",NoLabel:"AtMentionFPS_NoLabel"},Rating:{Question:"AtMentionFPS_RatingQuestion",RatingValuesAscending:["AtMentionFPS_RatingValue_1","AtMentionFPS_RatingValue_2","AtMentionFPS_RatingValue_3","AtMentionFPS_RatingValue_4","AtMentionFPS_RatingValue_5"]},Question:{Question:"AtMentionFPS_WhyQuestion"}}}},{CampaignId:"ed1c4566-210a-4412-9fcc-f2f30b42155a",StartTimeUtc:"2019-12-18T00:00:00Z",EndTimeUtc:"2020-04-18T00:00:00Z",GovernedChannelType:0,Scope:{Type:1,Languages:[{Type:0,Value:"en"}]},NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:432e3},CooldownPeriod:{Type:0,IntervalSeconds:432e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:0,Sequence:[{Type:0,Activity:"CardViewOpenCard",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"We'd love your feedback on cards in Excel",Question:"We have two questions for you",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Overall, how satisfied are you with cards in Excel?",RatingValuesAscending:["SatisfactionRating_1","SatisfactionRating_2","SatisfactionRating_3","SatisfactionRating_4","SatisfactionRating_5"]},Question:{Question:"What do you like/dislike about the card?"}}}}],window.OneNoteCampaignsObj=[{CampaignId:"281ff77f-ec20-4b5b-88dc-674ede3473ee",StartTimeUtc:"2018-09-04T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"AppUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"AppUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"nps_RatingQuestion_OneNote",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"nps_QuestionQuestion"}}}},{CampaignId:"3689d04a-d216-4795-a7db-c8fc4679ae67",StartTimeUtc:"2018-12-10T00:00:00Z",EndTimeUtc:"2019-06-30T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:50,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:1209600},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"DictationUsed",IsAggregate:!0,Count:3}]},Content:{Prompt:{Title:"We'd love your feedback on Dictation in Office Online!",Question:"We have just 2 questions.",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:" Overall, how satisfied are you with OneNote Online\ufffds Dictation feature?",RatingValuesAscending:["1 - Not satisfied","2","3","4","5 - Very satisfied"]},Question:{Question:"Please tell us more.\ufffd Why did you choose that answer?"}}}},{CampaignId:"da4d478d-1247-4e7f-9855-34d15c56b7f7",StartTimeUtc:"2019-03-12T00:00:00Z",EndTimeUtc:"2020-03-12T00:00:00Z",GovernedChannelType:0,NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:2592e3},CooldownPeriod:{Type:0,IntervalSeconds:7776e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:2,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SearchUsed",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"SearchFPS_Title",Question:"SearchFPS_PromptQuestion",YesLabel:"SearchFPS_YesLabel",NoLabel:"SearchFPS_NoLabel"},Rating:{Question:"SearchFPS_RatingQuestion",RatingValuesAscending:["SearchFPS_Rating_Values_1","SearchFPS_Rating_Values_2","SearchFPS_Rating_Values_3","SearchFPS_Rating_Values_4","SearchFPS_Rating_Values_5"]},Question:{Question:"SearchFPS_WhyQuestion"}}}},{CampaignId:"092b8d95-cf3f-4172-a11b-f5bbc03077ac",StartTimeUtc:"2019-04-01T00:00:00Z",EndTimeUtc:"2025-01-01T00:00:00Z",GovernedChannelType:0,AdditionalDataRequested:["EmailAddress"],NominationScheme:{Type:0,PercentageNumerator:2,PercentageDenominator:100,NominationPeriod:{Type:0,IntervalSeconds:86400},CooldownPeriod:{Type:0,IntervalSeconds:31536e3},FallbackSurveyDurationSeconds:120},SurveyTemplate:{Type:4,ActivationEvent:{Type:1,Sequence:[{Type:0,Activity:"SuiteUsageNPS",IsAggregate:!0,Count:300},{Type:0,Activity:"SuiteUsageTimeSatisfiedNPS",IsAggregate:!1,Count:1}]},Content:{Prompt:{Title:"nps_Title",Question:"nps_PromptQuestion",YesLabel:"Sure",NoLabel:"Not now"},Rating:{Question:"Would you recommend Office 365 to others, if asked?",RatingValuesAscending:["nps_Rating_Values_1","nps_Rating_Values_2","nps_Rating_Values_3","nps_Rating_Values_4","nps_Rating_Values_5"]},Question:{Question:"Please describe how we can make Office 365 better for you."}}}}];var Mi=ut;window.WordUserInitiatedSurveysDictionary=Mi;var Pi=ct;window.PPTUserInitiatedSurveysDictionary=Pi;var Fi=pt;window.VisioUserInitiatedSurveysDictionary=Fi;var xi=dt;window.OneNoteUserInitiatedSurveysDictionary=xi;var Ri=ht;window.ExcelUserInitiatedSurveysDictionary=Ri,n(117).CustomerFeedbackPackage.main(),window.g_jsLT=new Date;window.WordViewer.App=gt.App,window.ObjectModel=n(624),window.g_wordViewerJsDownloaded=!0,window.g_appSettingsDownloaded&&(Sys.Application.get_isInitialized()?window.g_wordViewerAppConstructed||pageInit():(Sys.Application.add_init(pageInit),Sys.Application.initialize())),window.Diag.UULS=mt,yi.main(),window.loadObjectModel=function(){return n.e(2).then(n.t.bind(n,259,7))}},,function(e,t,n){var i=n(165),r=n(145).entries;i({target:"Object",stat:!0},{entries:function(e){return r(e)}})},function(e,t,n){"use strict";n.d(t,{k:function(){return a}});var i=n(508),r=n(581),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t.MenuItemId=null,t.QueryCommand=null,t.CommandPreviewId=null,t.CommandRevertId=null,t.CommandValueId=null,t.DisplayMode=null,t.Description=null,t.ImageBackColor=null,t.LabelTextUserGeneratedPlaceholderReplacements=null,t.MenuItemsStatefulData=null,t.Visible=!1,t.AriaDescription=null,t.RoleInMenu=null,t}return(0,i.t)(t,e),t.prototype.get_ControlType=function(){return 1},t}(r.s);(0,o.l)(a,"CuiButtonProps",r.s,[])},function(e,t,n){"use strict";n.d(t,{b:function(){return c}});var i=n(208),r=n(917),o=n(254),a=n(873),s=n(478),l=n(728),u=n(405),c=function(){function e(e,t){this._failureCallback=null,this._successfulRequestHandler=null,this._url=null,this._successfulRequestHandler=e,this._url=t}return e.prototype.set_failureCallback=function(e){return this._failureCallback=e,e},e.prototype.send=function(){u.k.doRequestWithNetworkFailureNotification(this._url+"&r=1",i.i(this,this.onRequestComplete,"onRequestComplete"),n(941).App.get_activeAppFrame().get_notificationBar())},e.prototype.onRequestComplete=function(e,t,n){if(e&&"Success"===t){var i=new s.c(2,1,0,this._successfulRequestHandler);i.name=this._url,o.AFrameworkApplication.get_theTaskManager().addTask(i)}else if(this._failureCallback)this._failureCallback();else if(e){var u=n.responseXml,c=u.selectSingleNode("/docdata/status"),p=c?c.text:"UnexpectedDocDataResponse",d=r.u.getErrorCodeFromStatus(p),h=u.selectSingleNode("/docdata/dialog/description"),g=l.k.formatSingleString(h?h.text:CommonUIStrings.l_CannotOpenFile);r.u.showErrorDialog(u),r.u.propagateError(!1,"StatusRequestFailed",d,g)}else r.u.showErrorDialogEx(a.p.networkProblem,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NetworkProblemDialogDescription),r.u.propagateError(!1,"StatusRequestFailed",a.p.networkProblem,CommonUIStrings.l_NetworkProblemDialogDescription)},e}();(0,i.l)(c,"StatusRequest",null,[])},function(e,t,n){"use strict";n.d(t,{o:function(){return o}});var i=n(208),r=n(255),o=function(){function e(){}return e.getCurrentStyle=function(t){var n=null;if(t.ownerDocument&&t.ownerDocument.defaultView&&t.ownerDocument.defaultView.getComputedStyle&&(n=t.ownerDocument.defaultView.getComputedStyle(t,"")),!n){if(t.currentStyle)return t.currentStyle;e._isFirstNullCurrentStyle&&(r.ULS.sendTraceTag(6587334,210,15,"The current Style object from element was null"),e._isFirstNullCurrentStyle=!1)}return n},e.copyStyle=function(t,n){n.className="",n.style.cssText="";var r=e.getCurrentStyle(t),o=n.style;for(var a in r){var s={key:a,value:r[a]};try{i.r(String,s.value)&&""!==s.value&&(o[s.key]=s.value)}catch(e){}}},e.setStyle=function(t,n,i){e.checkStyleExist(t,n)&&(t.style[n]=i)},e.removeStyle=function(t,n){e.setStyle(t,n,"")},e.clearStyles=function(e){e.removeAttribute("style")},e.setRotation=function(t,n){var i="rotate("+n+"deg)";e.setTransform(t,i)},e.setFlipTransForms=function(t,n,i){var r="";n&&(r+="scaleX(-1) "),i&&(r+="scaleY(-1) "),e.setTransform(t,r)},e.setTransform=function(t,n){e.checkStyleExist(t,"transform")?t.style.transform=n:e.checkStyleExist(t,"msTransform")?t.style.msTransform=n:e.checkStyleExist(t,"MozTransform")?t.style.MozTransform=n:e.checkStyleExist(t,"webkitTransform")&&(t.style.webkitTransform=n)},e.getTransform=function(t){return t&&t.style?e.checkStyleExist(t,"transform")?t.style.transform:e.checkStyleExist(t,"msTransform")?t.style.msTransform:e.checkStyleExist(t,"MozTransform")?t.style.MozTransform:e.checkStyleExist(t,"webkitTransform")?t.style.webkitTransform:null:null},e.setTransformOrigin=function(t,n){e.checkStyleExist(t,"transform")?t.style["transform-origin"]=n:e.checkStyleExist(t,"msTransform")?t.style["-ms-transform-origin"]=n:e.checkStyleExist(t,"MozTransform")?(t.style["-moz-transform-origin"]=n,t.style.transformOrigin=n):e.checkStyleExist(t,"webkitTransform")&&(t.style["-webkit-transform-origin"]=n)},e.checkStyleExist=function(e,t){return!(!e||void 0===e.style[t])},e.setScale=function(t,n){var i="scale("+n+")";e.setTransform(t,i),e.setTransformOrigin(t,"0% 0%")},e.parseIntDefaultZero=function(e){var t=parseInt(e);return!e||isNaN(t)?0:t},e._isFirstNullCurrentStyle=!0,e}();(0,i.l)(o,"CssUtils",null,[])},,,,function(e,t,n){var i=n(950),r=n(499),o="".split;e.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(e){return"String"==r(e)?o.call(e,""):Object(e)}:Object},function(e,t,n){"use strict";n.d(t,{e:function(){return a}});var i=n(508),r=n(320),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t.UseUncheckedImage=!1,t.CloseMenuWhenExecuted=!0,t.IsChecked=!1,t.CheckedImageClass=null,t.CheckedImage=null,t}return(0,i.t)(t,e),t.prototype.get_ControlType=function(){return 6},t}(r.d);(0,o.l)(a,"CheckMarkToggleButtonProps",r.d,[])},function(e,t,n){"use strict";n.d(t,{p:function(){return a}});var i=n(508),r=n(267),o=n(208),a=function(e){function t(t,n,i,r,o,a){return void 0===o&&(o=null),void 0===a&&(a=!0),e.call(this,t,n,i,r,o,a)||this}return(0,i.t)(t,e),t.prototype.get_ribbon=function(){return this.get_root()},t}(r.s);(0,o.l)(a,"RibbonComponent",r.s,[])},function(e){e.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},,function(e,t,n){"use strict";n.d(t,{x:function(){return i}});var i=(0,n(208).y)("IUlsHost")},,,function(e,t,n){"use strict";n.d(t,{n:function(){return r}});var i=n(208),r=function(){function e(e,t,n,i,r,o,a,s,l,u,c,p,d,h){void 0===c&&(c=null),void 0===p&&(p=!1),void 0===d&&(d=null),void 0===h&&(h=null),this.id=0,this.priority=0,this.request=null,this.status=0,this.httpStatus=0,this.successCallback=null,this.failureCallback=null,this.responseData=null,this.responseXml=null,this.responseObject=null,this.responseHeadersToSet=null,this.responseHeaders=null,this.state=null,this.shouldSetResponseXml=!1,this.enqueueTime=null,this.invokedTime=null,this.invokedTimeTicks=0,this.completedTime=null,this.completedTimeTicks=0,this.requestorId=null,this.isSynchronous=!1,this.completionCallbackTask=null,this.requestQueuedTimeoutTask=null,this.name=null,this.forceSynchronousNotify=!1,this.extraInfo=null,this.invokedCallback=null,this.id=e,this.priority=t,this.request=n,this.responseHeadersToSet=i,this.shouldSetResponseXml=r,this.successCallback=o,this.failureCallback=a,this.invokedCallback=h,this.state=s,this.isSynchronous=l,this.requestorId=u||"",this.completionCallbackTask=null,this.name=c,this.forceSynchronousNotify=p,this.extraInfo=d}return e.prototype.get_shouldMarkOnTimeline=function(){return!!this.extraInfo&&this.extraInfo[e.keyOfFoundGetPutChanges]},e.keyOfFoundGetPutChanges="FoundGetPutChanges",e.keyOfGetChanges="GetChanges",e.keyOfPutChanges="PutChanges",e}();(0,i.l)(r,"RequestItem",null,[])},function(e,t,n){var i=n(531),r=n(383),o=n(440),a=n(185),s=i.Symbol,l=r("wks");e.exports=function(e){return l[e]||(l[e]=a&&s[e]||(a?s:o)("Symbol."+e))}},function(e,t,n){var i=n(786),r=n(38),o=n(76),a=i("unscopables"),s=Array.prototype;null==s[a]&&o(s,a,r(null)),e.exports=function(e){s[a][e]=!0}},,function(e,t){t.f=Object.getOwnPropertySymbols},function(e,t,n){"use strict";var i=n(208),r=n(572),o=n(600),a=n(335),s=n(149),l=n(870),u=n(755),c=function(){function e(t,n,r){this._keyComparer=null,i.m(this,e.$$(t,n)),this._keyComparer=r}return e.prototype.equals=function(e,t){return this._keyComparer.equals(e.get_key(),t.get_key())},e.prototype.getHashCode=function(e){return this._keyComparer.getHashCode(e.get_key())},e.$$=function(t,n){var r="KeyValueComparer$2$"+t.getName()+"$"+n.getName(),o=i.x(r);return o||i.u(r,"$$sc.KeyValueComparer$2",e,[{TKey:t},{TValue:n}],null,[l.v.$$(u.z)])},e}();n.d(t,{d:function(){return p}});var p=function(){function e(t,n,r){var s=this;this._comparer=null,this._pairComparer=null,this._buckets=null,this.$$pf_Count=0,i.m(this,e.$$(t,n)),this.$$ge=this.getEnumerator,this._comparer=r,this._pairComparer=new c(i.f(this,"$$sc.Dictionary$2").TKey,i.f(this,"$$sc.Dictionary$2").TValue,r),a.h(u.z,(0,o.m)((function(){return s._buckets}),(function(e){return s._buckets=e})),this._pairComparer,7)}return e.$$=function(t,n){var o="$$sc.Dictionary$2"+t.getName()+"$"+n.getName(),a=i.x(o);return a||i.u(o,"$$sc.Dictionary$2",e,[{TKey:t},{TValue:n}],null,[s.m.$$(t,n),r.i],e._staticPropertyBag())},e.prototype.getEnumerator=function(){return new(e.$$(i.f(this,"$$sc.Dictionary$2").TKey,i.f(this,"$$sc.Dictionary$2").TValue).$$sm_System$Collections$Generic$Dictionary$GetEnumerator)(this)},e.prototype.get_count=function(){return this.$$pf_Count},e.prototype.set_count=function(e){return this.$$pf_Count=e,e},e.prototype.get_keys=function(){return this.GetKeyEnumerator()},e.prototype.get_values=function(){return this.GetValueEnumerator()},e.prototype.GetKeyEnumerator=function(){return new(e.$$(i.f(this,"$$sc.Dictionary$2").TKey,i.f(this,"$$sc.Dictionary$2").TValue).$$sm_System$Collections$Generic$Dictionary$GetKeyEnumerator)(this)},e.prototype.GetValueEnumerator=function(){return new(e.$$(i.f(this,"$$sc.Dictionary$2").TKey,i.f(this,"$$sc.Dictionary$2").TValue).$$sm_System$Collections$Generic$Dictionary$GetValueEnumerator)(this)},e.prototype.Akvp=function(e){this.Insert(e,!0)},e.prototype.get_item=function(e){var t;if(!this.tryGetValue(e,(0,o.m)((function(){return t}),(function(e){return t=e}))))throw Error.create("KeyNotFoundException");return t},e.prototype.set_item=function(e,t){return this.Insert(new u.z(e,t),!1),t},e.prototype.Insert=function(e,t){for(var n=this,i=a.b(u.z,(0,o.m)((function(){return n._buckets}),(function(e){return n._buckets=e})),e,this._pairComparer,this.get_count()),r=0;r<i.length;r++){var s=i[r];if(this._comparer.equals(s.get_key(),e.get_key())){if(t)throw Error.invalidOperation("DuplicateKeyException");return void(i[r]=e)}}this.set_count(this.get_count()+1),Array.add(i,e)},e.prototype.add=function(e,t){this.Akvp(new u.z(e,t))},e.prototype.containsKey=function(e){for(var t=this._comparer.getHashCode(e),n=0,i=this._buckets[a.w(this._buckets,t)];n<i.length;n++){var r=i[n];if(this._comparer.equals(r.get_key(),e))return!0}return!1},e.prototype.remove=function(e){for(var t=this._buckets[a.w(this._buckets,this._comparer.getHashCode(e))],n=0;n<t.length;n++){var i=t[n];if(this._comparer.equals(i.get_key(),e))return Array.removeAt(t,n),this.set_count(this.get_count()-1),!0}return!1},e.prototype.tryGetValue=function(e,t){for(var n=0,r=this._buckets[a.w(this._buckets,this._comparer.getHashCode(e))];n<r.length;n++){var o=r[n];if(this._comparer.equals(o.get_key(),e))return t.val=o.get_value(),!0}return t.val=i.f(this,"$$sc.Dictionary$2").TValue===Number||Type.isEnum(i.f(this,"$$sc.Dictionary$2").TValue)?0:i.f(this,"$$sc.Dictionary$2").TValue!==Boolean&&null,!1},e._staticPropertyBag=function(){return{$$sm_System$Collections$Generic$Dictionary$GetEnumerator:function(){var e=function(e){this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this.$$this=e};return e.prototype={$$this:null,$$v_0_$$arr_0:null,$$v_1_$$len_1:0,$$v_2_$$idx_2:0,$$v_3_bucket:null,$$v_4_$$arr_4:null,$$v_5_$$len_5:0,$$v_6_$$idx_6:0,$$v_7_pair:null,_current:null,_nextMethod:null,_state:0,$$sm_0_initial:function(){return this.$$v_0_$$arr_0=this.$$this._buckets,this.$$v_1_$$len_1=this.$$v_0_$$arr_0.length,this.$$v_2_$$idx_2=0,this.$$sm_1_for_body},$$sm_1_for_body:function(){return this.$$v_2_$$idx_2<this.$$v_1_$$len_1?(this.$$v_3_bucket=this.$$v_0_$$arr_0[this.$$v_2_$$idx_2],this.$$v_4_$$arr_4=this.$$v_3_bucket,this.$$v_5_$$len_5=this.$$v_4_$$arr_4.length,this.$$v_6_$$idx_6=0,this.$$sm_2_for_body):this.$$sm_1_for_body_after},$$sm_1_for_body_after:function(){this._state=3},$$sm_1_for_increment:function(){return++this.$$v_2_$$idx_2,this.$$sm_1_for_body},$$sm_2_for_body:function(){return this.$$v_6_$$idx_6<this.$$v_5_$$len_5?(this.$$v_7_pair=this.$$v_4_$$arr_4[this.$$v_6_$$idx_6],this._current=this.$$v_7_pair,this._state=2,this.$$sm_3_after_yield_return):this.$$sm_2_for_body_after},$$sm_2_for_body_after:function(){return this.$$sm_1_for_increment},$$sm_2_for_increment:function(){return++this.$$v_6_$$idx_6,this.$$sm_2_for_body},$$sm_3_after_yield_return:function(){return this.$$sm_2_for_increment},dispose:function(){},moveNext:function(){if(3===this._state)return!1;for(this._state?this._state=1:(this._state=1,this._nextMethod=this.$$sm_0_initial());1===this._state;)this._nextMethod=this._nextMethod();return 3!==this._state},reset:function(){throw Error.invalidOperation("Reset() is not supported")},get_current:function(){return this._current}},e.registerClass("$$sc.Dictionary$2.$$sm_System$Collections$Generic$Dictionary$GetEnumerator",null,Sys.IDisposable,Sys.IEnumerator$1),e},$$sm_System$Collections$Generic$Dictionary$GetKeyEnumerator:function(){var t=function(e){this._current=i.f(e,"$$sc.Dictionary$2").TKey===Number||Type.isEnum(i.f(e,"$$sc.Dictionary$2").TKey)?0:i.f(e,"$$sc.Dictionary$2").TKey!==Boolean&&null,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this.$$this=e};return t.prototype={$$this:null,$$v_0_$$arr_0:null,$$v_1_$$len_1:0,$$v_2_$$idx_2:0,$$v_3_bucket:null,$$v_4_$$arr_4:null,$$v_5_$$len_5:0,$$v_6_$$idx_6:0,$$v_7_pair:null,_current:void 0,_nextMethod:null,_state:-1,$$sm_0_initial:function(){return this.$$v_0_$$arr_0=this.$$this._buckets,this.$$v_1_$$len_1=this.$$v_0_$$arr_0.length,this.$$v_2_$$idx_2=0,this.$$sm_1_for_body},$$sm_1_for_body:function(){return this.$$v_2_$$idx_2<this.$$v_1_$$len_1?(this.$$v_3_bucket=this.$$v_0_$$arr_0[this.$$v_2_$$idx_2],this.$$v_4_$$arr_4=this.$$v_3_bucket,this.$$v_5_$$len_5=this.$$v_4_$$arr_4.length,this.$$v_6_$$idx_6=0,this.$$sm_2_for_body):this.$$sm_1_for_body_after},$$sm_1_for_body_after:function(){this._state=3},$$sm_1_for_increment:function(){return++this.$$v_2_$$idx_2,this.$$sm_1_for_body},$$sm_2_for_body:function(){return this.$$v_6_$$idx_6<this.$$v_5_$$len_5?(this.$$v_7_pair=this.$$v_4_$$arr_4[this.$$v_6_$$idx_6],this._current=this.$$v_7_pair.get_key(),this._state=2,this.$$sm_3_after_yield_return):this.$$sm_2_for_body_after},$$sm_2_for_body_after:function(){return this.$$sm_1_for_increment},$$sm_2_for_increment:function(){return++this.$$v_6_$$idx_6,this.$$sm_2_for_body},$$sm_3_after_yield_return:function(){return this.$$sm_2_for_increment},dispose:function(){},getEnumerator:function(){return-1===this._state?(this._state=0,this):new(e.$$(i.f(this,"$$sc.Dictionary$2").TKey,i.f(this,"$$sc.Dictionary$2").TValue).$$sm_System$Collections$Generic$Dictionary$GetKeyEnumerator)(this.$$this).getEnumerator()},moveNext:function(){if(3===this._state)return!1;for(this._state?this._state=1:(this._state=1,this._nextMethod=this.$$sm_0_initial());1===this._state;)this._nextMethod=this._nextMethod();return 3!==this._state},reset:function(){throw Error.invalidOperation("Reset() is not supported")},get_current:function(){return this._current}},t.registerClass("$$sc.Dictionary$2.$$sm_System$Collections$Generic$Dictionary$GetKeyEnumerator",null,Sys.IDisposable,Sys.IEnumerable$1,Sys.IEnumerator$1),t},$$sm_System$Collections$Generic$Dictionary$GetValueEnumerator:function(){var t=function(e){this._current=i.f(e,"$$sc.Dictionary$2").TValue===Number||Type.isEnum(i.f(e,"$$sc.Dictionary$2").TValue)?0:i.f(e,"$$sc.Dictionary$2").TValue!==Boolean&&null,this.$$ge=this.getEnumerator,this.$$cu=this.get_current,this.$$mn=this.moveNext,this.$$rst=this.reset,this.$$this=e};return t.prototype={$$this:null,$$v_0_$$arr_0:null,$$v_1_$$len_1:0,$$v_2_$$idx_2:0,$$v_3_bucket:null,$$v_4_$$arr_4:null,$$v_5_$$len_5:0,$$v_6_$$idx_6:0,$$v_7_pair:null,_current:void 0,_nextMethod:null,_state:-1,$$sm_0_initial:function(){return this.$$v_0_$$arr_0=this.$$this._buckets,this.$$v_1_$$len_1=this.$$v_0_$$arr_0.length,this.$$v_2_$$idx_2=0,this.$$sm_1_for_body},$$sm_1_for_body:function(){return this.$$v_2_$$idx_2<this.$$v_1_$$len_1?(this.$$v_3_bucket=this.$$v_0_$$arr_0[this.$$v_2_$$idx_2],this.$$v_4_$$arr_4=this.$$v_3_bucket,this.$$v_5_$$len_5=this.$$v_4_$$arr_4.length,this.$$v_6_$$idx_6=0,this.$$sm_2_for_body):this.$$sm_1_for_body_after},$$sm_1_for_body_after:function(){this._state=3},$$sm_1_for_increment:function(){return++this.$$v_2_$$idx_2,this.$$sm_1_for_body},$$sm_2_for_body:function(){return this.$$v_6_$$idx_6<this.$$v_5_$$len_5?(this.$$v_7_pair=this.$$v_4_$$arr_4[this.$$v_6_$$idx_6],this._current=this.$$v_7_pair.get_value(),this._state=2,this.$$sm_3_after_yield_return):this.$$sm_2_for_body_after},$$sm_2_for_body_after:function(){return this.$$sm_1_for_increment},$$sm_2_for_increment:function(){return++this.$$v_6_$$idx_6,this.$$sm_2_for_body},$$sm_3_after_yield_return:function(){return this.$$sm_2_for_increment},dispose:function(){},getEnumerator:function(){return-1===this._state?(this._state=0,this):new(e.$$(i.f(this,"$$sc.Dictionary$2").TKey,i.f(this,"$$sc.Dictionary$2").TValue).$$sm_System$Collections$Generic$Dictionary$GetValueEnumerator)(this.$$this).getEnumerator()},moveNext:function(){if(3===this._state)return!1;for(this._state?this._state=1:(this._state=1,this._nextMethod=this.$$sm_0_initial());1===this._state;)this._nextMethod=this._nextMethod();return 3!==this._state},reset:function(){throw Error.invalidOperation("Reset() is not supported")},get_current:function(){return this._current}},t.registerClass("$$sc.Dictionary$2.$$sm_System$Collections$Generic$Dictionary$GetValueEnumerator",null,Sys.IDisposable,Sys.IEnumerable$1,Sys.IEnumerator$1),t}}},e}()},,,function(e,t,n){"use strict";var i=n(165),r=n(683),o=n(403),a=n(962),s=n(128),l=n(76),u=n(382),c=n(786),p=n(295),d=n(142),h=n(935),g=h.IteratorPrototype,m=h.BUGGY_SAFARI_ITERATORS,_=c("iterator"),f=function(){return this};e.exports=function(e,t,n,c,h,y,v){r(n,t,c);var S,C,b,A=function(e){if(e===h&&k)return k;if(!m&&e in I)return I[e];switch(e){case"keys":case"values":case"entries":return function(){return new n(this,e)}}return function(){return new n(this)}},T=t+" Iterator",w=!1,I=e.prototype,E=I[_]||I["@@iterator"]||h&&I[h],k=!m&&E||A(h),D="Array"==t&&I.entries||E;if(D&&(S=o(D.call(new e)),g!==Object.prototype&&S.next&&(p||o(S)===g||(a?a(S,g):"function"!=typeof S[_]&&l(S,_,f)),s(S,T,!0,!0),p&&(d[T]=f))),"values"==h&&E&&"values"!==E.name&&(w=!0,k=function(){return E.call(this)}),p&&!v||I[_]===k||l(I,_,k),d[t]=k,h)if(C={values:A("values"),keys:y?k:A("keys"),entries:A("entries")},v)for(b in C)!m&&!w&&b in I||u(I,b,C[b]);else i({target:t,proto:!0,forced:m||w},C);return C}},,function(e,t,n){"use strict";var i=n(504),r=n(208),o=function(){function e(e,t,n){this.$$pf_Disposed=!1,this._action=null,this._actionWithData=null,this._data=null,this._action=e,this._actionWithData=t,this._data=n}return e.prototype.get_Disposed=function(){return this.$$pf_Disposed},e.prototype.set_Disposed=function(e){return this.$$pf_Disposed=e,e},e.prototype.TryExecute=function(){this.get_Disposed()||(this._action?this._action():this._actionWithData(this._data))},e.prototype.dispose=function(){this.set_Disposed(!0)},e}();(0,r.l)(o,"CancellationTokenRegistration",null,[Sys.IDisposable]),n.d(t,{r:function(){return a}});var a=function(){function e(e){this._registrations=null,this.$$pf_IsCancellationRequested=!1,this.$$pf_CanBeCanceled=!1,this.set_canBeCanceled(e)}return e.prototype.get_isCancellationRequested=function(){return this.$$pf_IsCancellationRequested},e.prototype.set_isCancellationRequested=function(e){return this.$$pf_IsCancellationRequested=e,e},e.prototype.get_canBeCanceled=function(){return this.$$pf_CanBeCanceled},e.prototype.set_canBeCanceled=function(e){return this.$$pf_CanBeCanceled=e,e},e.prototype.throwIfCancellationRequested=function(){this.get_isCancellationRequested()&&e.throwCancellation()},e.prototype.R=function(e){var t=new o(e,null,null);return this.Register(t),t},e.prototype.RO=function(e,t){var n=new o(null,e,t);return this.Register(n),n},e.prototype.Register=function(e){this.get_isCancellationRequested()?e.TryExecute():this._registrations=i.o(o,this._registrations,e)},e.prototype.cancel=function(e){if(!this.get_canBeCanceled())throw Error.invalidOperation("CanBeCanceled is false");if(!this.get_isCancellationRequested()&&(this.set_isCancellationRequested(!0),e&&this._registrations))for(var t=0,n=this._registrations;t<n.length;t++){n[t].TryExecute()}},e.throwCancellation=function(){throw e.CreateCancellationException()},e.CreateCancellationException=function(){return Error.create("OperationCanceledException: Task canceled",{$$canceled:!0})},e.get_none=function(){return e._noneToken},e.isCancellationException=function(t){return t[e.exceptionData]},e.exceptionData="$$canceled",e._noneToken=new e(!1),e}();(0,r.l)(a,"CancellationToken",null,[])},function(e,t,n){"use strict";n.d(t,{m:function(){return h}});var i=n(600),r=n(242),o=n(255),a=n(196),s=n(219),l=n(266),u=n(344),c=n(867),p=n(460),d=n(208),h=function(){function e(e){this._wsaClient=null,this._isAppInteractive=!1,this._pageLoadPerfRecorder=null,this.isContentDisplayTimeAlreadySet=!1,this.hasQueuedStopVisibilityMetrics=!1,this.userSessionId=null,this.isRealContentDisplayedForBoot=!1,this._timestampBaseline=Number.MAX_VALUE,this._timestamps={},this._datapoints={},this._appIsInteractiveTask=new r.z(Boolean),this._pageLoadPerfRecorder=e}return e.prototype.get_isRealContentDisplayedForBoot=function(){return this.isRealContentDisplayedForBoot},e.prototype.get_appIsInteractiveTask=function(){return this._appIsInteractiveTask.get_task()},e.prototype.initWsaClient=function(e){if(this._wsaClient=e,this._timestampBaseline<Number.MAX_VALUE){this.updateBaseline(this._timestampBaseline);var t=this._datapoints;for(var n in t){var i={key:n,value:t[n]},r=Number.parseInvariant(i.key);this._wsaClient.setDw(r,i.value)}}},e.prototype.recordResourceDownloadStart=function(){var t=window.g_firstByte;if(null!=t){var n=t.getTime();this.recordTimestamp(e.dataiD_BSQM_RESOURCEDOWNLOADSTART,n),this._pageLoadPerfRecorder.addMetric(s.c.resourceDownloadStart,n)}},e.prototype.recordResourceDownloadEnd=function(){var t=window.g_jsLT,n=window.g_afterJs,i=null!=t?t.getTime():0,r=null!=n?n.getTime():0,o=Math.max(i,r);if(o>0){var a=i>r?"g_jsLT":"g_afterJs";this.measureMarks(s.c.resourceDownload,"g_firstByte",a),this.recordTimestamp(e.dataiD_BSQM_RESOURCEDOWNLOADEND,o),this._pageLoadPerfRecorder.addDurationMetric(s.c.resourceDownloadStart,s.c.resourceDownloadDuration,o)}},e.prototype.recordPaintTimings=function(){if(e.get_browserSupportsPerformanceTiming()&&e.get_browserSupportsPerformanceGetEntriesByType())for(var t=0,n=window.performance.getEntriesByType("paint");t<n.length;t++){var i=n[t];switch(i.name){case"first-paint":this._pageLoadPerfRecorder.addMetric(s.c.firstPaint,i.startTime);break;case"first-contentful-paint":this._pageLoadPerfRecorder.addMetric(s.c.firstContentfulPaint,i.startTime)}}},e.prototype.recordBootResourceTimings=function(){if(e.get_browserSupportsPerformanceTiming()&&e.get_browserSupportsPerformanceGetEntriesByType()){for(var t=window.performance.getEntriesByType("resource"),i=window.performance.timing.navigationStart,r=0,o=0,a=!1,l=0,u=t;l<u.length;l++){var c=u[l];"script"!==c.initiatorType&&"link"!==c.initiatorType||(i+c.startTime>n(254).AFrameworkApplication.bootTime||(a?(c.startTime<r&&(r=c.startTime),c.responseEnd>o&&(o=c.responseEnd)):(r=c.startTime,o=c.responseEnd,a=!0)))}if(a){this._pageLoadPerfRecorder.addMetric(s.c.bootResourceStart,r),this._pageLoadPerfRecorder.addMetric(s.c.bootResourceForContentEditableEnd,o);var p=window.g_bootScriptsStartTime;if(null!=p){var d=p.getTime();this._pageLoadPerfRecorder.addMetric(s.c.bootResourceForContentViewableStart,d)}var h=window.g_bootScriptsEndTime;if(null!=h){d=h.getTime();this._pageLoadPerfRecorder.addMetric(s.c.bootResourceForContentViewableEnd,d)}}}},e.prototype.addMark=function(t){e.get_browserSupportsPerformanceMarkAndMeasure()&&window.performance.mark(t)},e.prototype.measureMarks=function(t,n,i,r){void 0===r&&(r=!1);var o=null;if(e.get_browserSupportsPerformanceMarkAndMeasure())try{window.performance.measure(t,n,i),r&&(o=window.performance.getEntriesByName(t,"measure"))}catch(e){}return o},e.prototype.recordContentFetchStart=function(t){this.recordTimestamp(e.dataiD_BSQM_CONTENTFETCHSTART,t)},e.prototype.recordContentFetchEnd=function(t){this.recordTimestamp(e.dataiD_BSQM_CONTENTFETCHEND,t)},e.prototype.recordContentToModelConversion=function(){this.recordTimestamp(e.dataiD_BSQM_CONTENTTOMODELCONVERSIONEND,(new Date).getTime())},e.prototype.recordAppInitStart=function(t){this.recordTimestamp(e.dataiD_BSQM_APPINITCODESTART,t),this._pageLoadPerfRecorder.addMetric(s.c.appInitStart,t)},e.prototype.recordAppInitEnd=function(){var t=(new Date).getTime();this.addMark(s.c.appInitDuration),this.measureMarks(s.c.appInit,s.c.appInitStart,s.c.appInitDuration),this.recordTimestamp(e.dataiD_BSQM_APPINITCODEEND,t),this._pageLoadPerfRecorder.addDurationMetric(s.c.appInitStart,s.c.appInitDuration,t)},e.prototype.recordDocumentLoadedTime=function(e){this._pageLoadPerfRecorder.addMetric(s.c.documentLoadedTime,e)},e.prototype.recordOfficeFrameRequestStart=function(){void 0!==window.performance&&null!==window.performance&&void 0!==window.performance.timing&&null!==window.performance.timing&&this._pageLoadPerfRecorder.addMetric(s.c.frameRequestStart,window.performance.timing.requestStart)},e.prototype.recordSplashScreenShown=function(){this.sendBeaconForBootPhase("SplashScreenShown"),this.postBootState("SplashScreenShown");var t=window.g_cssLT,n=window.__startTime,i=window.g_splashScreenShown,r=null!=i?i.getTime():Math.max(null!=t?t.getTime():0,null!=n?n.getTime():0);r>0&&(this.recordTimestamp(e.dataiD_BSQM_SPLASHSCREENSHOWN,r),this._pageLoadPerfRecorder.addMetric(s.c.splashScreenShown,r))},e.prototype.recordContentViewableHiddenSSR=function(e){this._pageLoadPerfRecorder.addMetric(s.c.contentViewableHiddenSSR,e)},e.prototype.recordFastViewEntryPoint=function(e){this._pageLoadPerfRecorder.addMetric(s.c.fastViewEntryPoint,e)},e.prototype.recordContentDisplayed=function(e){this.sendBeaconForBootPhase("RecordContentDisplayed"),this.postBootState("ContentDisplayed"),this.recordContentDisplayedAfterBeaconSent(e)},e.prototype.recordPerceivedContentDisplayed=function(e){this.recordContentDisplayedAfterBeaconSent(e,!1)},e.prototype.recordContentDisplayedAfterBeaconSent=function(t,n){void 0===n&&(n=!0),this._isAppInteractive&&n&&e.logBootFinished(this.userSessionId),this.isRealContentDisplayedForBoot=n,this.isContentDisplayTimeAlreadySet||(this.recordTimestamp(e.dataiD_BSQM_CONTENTDISPLAYED,t),this._pageLoadPerfRecorder.addMetric(s.c.contentViewable,t),this.isContentDisplayTimeAlreadySet=!0)},e.prototype.recordInteractivityContentDisplayed=function(t){this.recordDatapoint(e.dataiD_BSQM_INTERACTIVITYCONTENTDISPLAYED,t)},e.prototype.recordAppInteractive=function(e){this.sendBeaconForBootPhase("RecordAppInteractive"),this.postBootState("AppInteractive"),this.recordAppInteractiveAfterBeaconSent(e)},e.prototype.recordAppInteractiveAfterBeaconSent=function(t){this.get_isRealContentDisplayedForBoot()&&e.logBootFinished(this.userSessionId),this._isAppInteractive=!0,this._appIsInteractiveTask.setResult(!0),this.recordTimestamp(e.dataiD_BSQM_APPINTERACTIVE,t),this._pageLoadPerfRecorder.addMetric(s.c.contentEditable,t)},e.prototype.recordUserClickedInHostUi=function(t){this._pageLoadPerfRecorder.addMetric(s.c.userClickedHostUI,t),this.recordTimestamp(e.dataiD_BSQM_USERCLICKEDHOSTUI,t)},e.prototype.recordWacIframeGeneratedInHost=function(t){this.recordTimestamp(e.dataiD_BSQM_HOSTIFRAMEGENERATED,t)},e.prototype.recordHostPageFetchStart=function(t){this._pageLoadPerfRecorder.addMetric(s.c.hostPageFetchStart,t),this.recordTimestamp(e.dataiD_BSQM_HOSTPAGEFETCHSTART,t)},e.prototype.recordHostPageRedirectCount=function(t){var n=e.dataiD_BSQM_HOSTPAGEREDIRECTCOUNT;this.recordDatapoint(n,t)},e.prototype.recordEditClickedInWebApp=function(t){this.recordTimestamp(e.dataiD_BSQM_EDITINWEBAPPCLICKED,t)},e.prototype.recordViewClickedInWebApp=function(t){this.recordTimestamp(e.dataiD_BSQM_VIEWINWEBAPPCLICKED,t)},e.prototype.recordBrowserFetchStart=function(t){this.recordTimestamp(e.dataiD_BSQM_BROWSERFETCHSTART,t)},e.prototype.recordBrowserNavigationStart=function(t){this.recordTimestamp(e.dataiD_BSQM_BROWSERNAVIGATIONSTART,t)},e.prototype.recordWacRenderTimeFromBrowserFetchStart=function(e){var t;this.tryGetBrowserFetchStart((0,i.m)((function(){return t}),(function(e){return t=e})))&&this.recordWacRenderTime(e-t),this.recordLegacyWacRenderTimeIfNeeded()},e.prototype.recordWacRenderTime=function(t){this.recordDatapoint(e.dataiD_BSQM_WACRENDERTIME,t)},e.prototype.recordLegacyWacRenderTimeIfNeeded=function(){n(254).AFrameworkApplication.reportRenderTime(null,!e.get_browserSupportsPerformanceTiming())},e.prototype.recordWindowVisibilityMetrics=function(e){void 0===e&&(e=null);var t=0;if(e||(e=this.getWindowVisibilityMetricsModule()),!e)return o.ULS.sendTraceTag(21307853,326,10,"visibilitymetrics module not found"),t;var n=e.metrics;if(!n)return o.ULS.sendTraceTag(21307854,326,10,"visibilitymetrics lookup failed"),t;o.ULS.sendTraceTag(21307855,326,50,"WindowVisibilityMetrics: {0}",n);var i=this.getVisibilityToggledTime(n);if(i){var r={VisiToggled:t=i.getTime()};this._pageLoadPerfRecorder.addMetrics(s.c.userActions,r)}return this.hasQueuedStopVisibilityMetrics||(this.hasQueuedStopVisibilityMetrics=!0,a.r.get_instance().executeWhen(8,(function(){e.stop()}))),t},e.prototype.recordNewFileMetrics=function(e,t,n){if(this._pageLoadPerfRecorder.addMetric(s.c.isNewFile,e),e){var i=t||"blank",r=n||"";this._pageLoadPerfRecorder.addMetric(s.c.newFileTemplateName,i.toUpperCase()),this._pageLoadPerfRecorder.addMetric(s.c.newFileTemplateLcid,r)}},e.prototype.recordHostInitDiagnostics=function(e){this._pageLoadPerfRecorder.addMetrics(s.c.hostInitDiagnostics,e)},e.prototype.recordJsApiDiagnostics=function(e){this._pageLoadPerfRecorder.addMetric(s.c.jsApiDiagnostics,e)},e.prototype.tryGetBrowserFetchStart=function(t){return t.val=0,!!e.get_browserSupportsPerformanceTiming()&&(t.val=window.performance.timing.fetchStart>0?window.performance.timing.fetchStart:window.performance.timing.navigationStart,!0)},e.prototype.recordTimestamp=function(e,t){e.toString()in this._timestamps&&o.ULS.sendTraceTag(3515215,306,15,"Timestamp recorded twice: "+e),this._timestamps[e.toString()]=t,t<this._timestampBaseline?this.updateBaseline(t):this._wsaClient&&this._wsaClient.setDw(e,t-this._timestampBaseline)},e.prototype.updateBaseline=function(t){if(this._timestampBaseline=t,this._wsaClient){this._wsaClient.setDw(e.dataiD_BSQM_TIMESTAMPBASELINEHIGH,Math.floor(t/4294967296)),this._wsaClient.setDw(e.dataiD_BSQM_TIMESTAMPBASELINELOW,t%4294967296);var n=this._timestamps;for(var i in n){var r={key:i,value:n[i]},o=Number.parseInvariant(r.key),a=r.value-this._timestampBaseline;this._wsaClient.setDw(o,a)}}},e.prototype.recordDatapoint=function(e,t){this._wsaClient?this._wsaClient.setDw(e,t):this._datapoints[e.toString()]=t},e.prototype.sendBeaconForBootPhase=function(e){"undefined"!=typeof _bB&&"function"==typeof _bB.sendBeacon&&_bB.sendBeacon(e,"BootPhaseCompleted")},e.prototype.postBootState=function(e){try{"undefined"!=typeof _bB&&"function"==typeof _bB.postBootState&&_bB.postBootState(e)}catch(e){}},e.prototype.getWindowVisibilityMetricsModule=function(){return window.self.WindowVisibilityMetrics},e.prototype.getVisibilityToggledTime=function(e){if("hidden"===e.initialVisibility)return e.initializeTime;var t=e.events;return t&&t.length>0?t[0].time:null},e.get_instance=function(){return e._instance||(e._instance=new e(l.e.get_instance()))},e.get_browserSupportsPerformanceMarkAndMeasure=function(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.mark||null===window.performance.mark||void 0===window.performance.measure||null===window.performance.measure)},e.get_browserSupportsPerformanceTiming=function(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.timing||null===window.performance.timing)},e.get_browserSupportsPerformanceGetEntriesByType=function(){return!(void 0===window.performance||null===window.performance||void 0===window.performance.getEntriesByType||null===window.performance.getEntriesByType)},e.logBootFinished=function(e){var t,i={};i.UserSessionId=e;try{if(!n(254).AFrameworkApplication.appSettingsManager.get_appSettings().SessionStartInfoJson)return void o.ULS.sendTraceTag(36718624,306,10,"PerfReporting.LogBootFinished: SessionStartInfoJson is null");t=c.b(n(254).AFrameworkApplication.appSettingsManager.get_appSettings().SessionStartInfoJson.toString()),i.Application=t.Application||"",i.ApplicationModeExtended=t.ApplicationModeExtended||"",i.UserSessionApplicationMode=t.UserSessionApplicationMode||"",i.ApplicationVersion=t.ApplicationVersion||"",i.Browser=t.Browser||"",i.BrowserMajorVersion=t.BrowserMajorVersion||"",i.Host=t.Host||"",i.IsSynthetic=t.IsSynthetic||"",i.Ring=t.Ring||"",i.WACDatacenter=t.WACDatacenter||"",i.UiHost=t.UiHost||"";var r=i.Application,a=i.ApplicationModeExtended?i.ApplicationModeExtended.toUpperCase():"";if("Excel"===r&&"UNIFIED"===a){if(o.ULS.sendTraceTag(39933443,306,15,"PerfReporting.LogBootFinished: SessionStarts[ApplicationModeExtended] remained UNIFIED"),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ExcelFixupApplicationModeOnBootFinishedAndSessionEnd"))switch(n(254).AFrameworkApplication.get_activeFrame().get_mode()){case 2:i.ApplicationModeExtended="EDIT";break;case 1:i.ApplicationModeExtended="VIEW";break;default:o.ULS.sendTraceTag(34219405,306,15,"PerfReporting.LogBootFinished: ActiveFrame.Mode is FrameMode.None")}}else if("OneNote"===r&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OneNoteDeviceIdLoggingIsEnabled")){var s=u.g("DeviceId")||p.l.create().toString();u.r("DeviceId",s,u.i),i.DeviceId=s}}catch(e){var l={Context:"Deserializing SessionStartInfoJson for BootFinished logging"};l.ExceptionMessage=e.message,o.ULS.sendTraceTag(22552780,306,15,"{0}",l)}o.ULS.sendTraceTag(6959176,306,50,"SessionBootFinished: {0}",i),o.ULS.get_host().flushAsynchronous()},e.dataiD_BSQM_TIMESTAMPBASELINEHIGH=11040,e.dataiD_BSQM_TIMESTAMPBASELINELOW=11041,e.dataiD_BSQM_RESOURCEDOWNLOADSTART=11031,e.dataiD_BSQM_RESOURCEDOWNLOADEND=11032,e.dataiD_BSQM_CONTENTFETCHSTART=11033,e.dataiD_BSQM_CONTENTFETCHEND=11034,e.dataiD_BSQM_APPINITCODESTART=11036,e.dataiD_BSQM_APPINITCODEEND=11037,e.dataiD_BSQM_SPLASHSCREENSHOWN=11035,e.dataiD_BSQM_CONTENTDISPLAYED=11038,e.dataiD_BSQM_INTERACTIVITYCONTENTDISPLAYED=11337,e.dataiD_BSQM_APPINTERACTIVE=11039,e.dataiD_BSQM_USERCLICKEDHOSTUI=11028,e.dataiD_BSQM_HOSTIFRAMEGENERATED=11042,e.dataiD_BSQM_EDITINWEBAPPCLICKED=11029,e.dataiD_BSQM_VIEWINWEBAPPCLICKED=11043,e.dataiD_BSQM_BROWSERFETCHSTART=11044,e.dataiD_BSQM_HOSTPAGEFETCHSTART=11221,e.dataiD_BSQM_HOSTPAGEREDIRECTCOUNT=11219,e.dataiD_BSQM_CONTENTTOMODELCONVERSIONEND=11220,e.dataiD_BSQM_WACRENDERTIME=9086,e.dataiD_BSQM_BROWSERNAVIGATIONSTART=11338,e._instance=null,e}();(0,d.l)(h,"PerfReporting",null,[])},,function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var i=n(208),r=function(){function e(){this._requestCompletedCallback=null}return e.prototype.get_statusText=function(){return""},e.prototype.setRequestCompleted=function(e){this._requestCompletedCallback=e},e.prototype.onRequestCompleted=function(){this._requestCompletedCallback&&this._requestCompletedCallback()},e.get_browserSupportsCrossDomainRequests=function(){return!!e.get_requestGenerator()},e.get_requestGenerator=function(){if(!e._requestGenerator){var t=null;"undefined"!=typeof(new XMLHttpRequest).withCredentials?t=function(){return new(n(708).XMLHttpCrossDomainRequest)}:"undefined"!=typeof XDomainRequest&&(t=function(){return new(n(141).XDomainCrossDomainRequest)}),e._requestGenerator=t}return e._requestGenerator},e.create=function(){return e.get_browserSupportsCrossDomainRequests()?e.get_requestGenerator()():null},e._requestGenerator=null,e}();(0,i.l)(r,"CrossDomainRequestBase",null,[])},function(e,t,n){var i=n(531),r=n(374),o=n(454),a=n(76),s=n(786),l=s("iterator"),u=s("toStringTag"),c=o.values;for(var p in r){var d=i[p],h=d&&d.prototype;if(h){if(h[l]!==c)try{a(h,l,c)}catch(e){h[l]=c}if(h[u]||a(h,u,p),r[p])for(var g in o)if(h[g]!==o[g])try{a(h,g,o[g])}catch(e){h[g]=o[g]}}}},function(e,t,n){"use strict";n.d(t,{o:function(){return r}});var i=n(208),r=function(){function e(e,t){this.findExpression=null,this.replaceValue=null,this.findExpression=e,this.replaceValue=t}return e.prototype.performReplaceOn=function(e){return e&&""!==e?e.replace(this.findExpression,this.replaceValue):e},e.createGlobalSearchFindReplacePair=function(t,n){return new e(new RegExp(t,"g"),n)},e}();(0,i.l)(r,"FindReplacePair",null,[])},function(e,t,n){"use strict";n.d(t,{y:function(){return i}});var i=(0,n(208).y)("IInsertTable")},function(e,t,n){"use strict";n.d(t,{e:function(){return o}});var i=n(912),r=n(208),o=function(){function e(){}return e.CommandValueId="CommandValueId",e.Description="Description",e.Image16by16Class=i.b.image16by16Class,e.Image30by30Class=i.b.image30by30Class,e.Image32by32Class=i.b.image32by32Class,e.Image48by48Class=i.b.image48by48Class,e.On="On",e.LabelText=i.b.labelText,e.Visible=i.b.visible,e.SourceControlId="SourceControlId",e.DisplayMode="DisplayMode",e.Alt=i.b.alt,e}();(0,r.l)(o,"ToggleButtonCommandProperties",null,[])},,function(e,t,n){e.exports=n(298)},,function(e,t,n){"use strict";var i=n(351),r=n(809),o=n(600),a=n(255),s=n(236),l=n(150),u=n(163),c=n(540),p=n(508),d=n(208),h=function(e){function t(){var t=e.call(this)||this;return t.actionId=null,t.actionName=null,t.commandSurface=null,t.parentName=null,t.triggerMethod=null,t.timeOffsetMs=null,t}return(0,p.t)(t,e),t}(u.z);(0,d.l)(h,"UserActionEvent",u.z,[]),n.d(t,{j:function(){return g}});var g=function(){function e(){}return e.get_maX_SAFE_INTEGER=function(){return 9007199254740991},e.isEnabledLogSessionStartAndEndDataFromClientToOTel=function(t){return e.logSessionStartAndEndDataFromClientToOTelIsEnabled||(e.logSessionStartAndEndDataFromClientToOTelIsEnabled=e.determineLogSessionStartAndEndDataFromClientToOTelIsEnabled(t)?2:1),2===e.logSessionStartAndEndDataFromClientToOTelIsEnabled},e.determineLogSessionStartAndEndDataFromClientToOTelIsEnabled=function(e){return!!n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LogSessionStartAndEndDataFromClientToOTel")},e.isUserActionLoggingToOtelEnabled=function(t){return void 0===t&&(t=null),e.userActionLoggingToOtelIsEnabled||(e.userActionLoggingToOtelIsEnabled=e.determineUserActionLoggingToOtelIsEnabled(t)?2:1),2===e.userActionLoggingToOtelIsEnabled},e.determineUserActionLoggingToOtelIsEnabled=function(t){return void 0===t&&(t=null),!!n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting(e.getUberBRSControllingUserActionLoggingToOtel())},e.getUberBRSControllingUserActionLoggingToOtel=function(){return"WACUserActionToOtelIsEnabled"},e.getOtelActivityEventTableName=function(){return e.getOtelNonUserActionEventTableName()},e.getOtelNonUserActionEventTableName=function(){var e=(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.Application)||"";return e="Office."+e+(""===e?"":".")+"Online.NonUserInitiatedAction"},e.getOtelNonUserActionEventTablePrefix=function(){var e=(0,i.e)(String,n(254).AFrameworkApplication.sessionStartInfoSettings.Application)||"";return e="Office."+e+(""===e?"":".")+"Online.NonUser."},e.dictionaryToDataFields=function(t,n,i){if(void 0===n&&(n=null),void 0===i&&(i=null),!t)return null;var r=new Array(0);try{for(var o in t){var s={key:o,value:t[o]};if(!i||!i.contains(s.key)){var l=n&&n.containsKey(s.key)?n.get_item(s.key):2,u=e.getDataField(s.key,s.value.toString(),l);u&&Array.add(r,u)}}}catch(e){a.ULS.sendTraceTag(39978634,207,15,"Exception: "+e)}return r},e.getDataField=function(e,t,n){if(!t||!e)return null;var i=null;switch(n){case 1:i=(0,r.m)(new c.b,{name:e,bool:Boolean.parse(t.toString())});break;case 3:var o=parseInt(t);isNaN(o)||(i=(0,r.m)(new c.b,{name:e,int64:o}));break;case 4:o=parseFloat(t);isNaN(o)||(i=(0,r.m)(new c.b,{name:e,double:o}));break;case 2:i=(0,r.m)(new c.b,{name:e,string:t});break;case 5:var a=Date.parse(t);isNaN(a)||(i=(0,r.m)(new c.b,{name:e,date:new Date(a).getTime()}))}return i},e.shouldReplaceWithUnknownValue=function(e){var t=!0;if(e&&!(t=!e.length)){var n=e.toLowerCase();t="notdefined"===n||"unknown"===n}return t},e.sanitizeValues=function(t,n,i){e.shouldReplaceWithUnknownValue(t.val)&&(t.val=e.unknownValueString),e.shouldReplaceWithUnknownValue(n.val)&&(n.val=e.unknownValueString),e.shouldReplaceWithUnknownValue(i.val)&&(i.val=e.unknownValueString)},e.sanitizeValue=function(t){e.shouldReplaceWithUnknownValue(t.val)&&(t.val=e.unknownValueString)},e.createUserActionCustomData=function(t,n,i,r,o,a,s,l,u){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=null),void 0===l&&(l=null),void 0===u&&(u=null),e.createUserActionEvent(t,n,i,r,e.dictionaryToDataFields(o),a,s,l,u)},e.createUserActionEvent=function(t,n,i,a,s,l,u,c,p){return void 0===n&&(n=null),void 0===i&&(i=null),void 0===a&&(a=null),void 0===s&&(s=null),void 0===l&&(l=null),void 0===u&&(u=null),void 0===c&&(c=null),void 0===p&&(p=null),e.sanitizeValues((0,o.m)((function(){return n}),(function(e){return n=e})),(0,o.m)((function(){return i}),(function(e){return i=e})),(0,o.m)((function(){return a}),(function(e){return a=e}))),(0,r.m)(new h,{actionName:t,parentName:n,triggerMethod:i,commandSurface:a,dataFields:s,actionId:l,timeOffsetMs:u,succeeded:c,durationMs:p})},e.createActivityEvent=function(e,t,n,i){return(0,r.m)(new u.z,{name:e,succeeded:t,durationMs:n,dataFields:i})},e.createNonUserAction=function(t,n,i,a,p,d,h,g){e.sanitizeValue((0,o.m)((function(){return i}),(function(e){return i=e})));var m=[(0,r.m)(new c.b,{name:"ActionName",string:t}),(0,r.m)(new c.b,{name:"CommandSurface",string:s.i[p]}),(0,r.m)(new c.b,{name:"ParentName",string:i}),(0,r.m)(new c.b,{name:"TriggerMethod",string:l.s[a]}),(0,r.m)(new c.b,{name:"StartTime",double:d}),(0,r.m)(new c.b,{name:"EndTime",double:h}),(0,r.m)(new c.b,{name:"Succeeded",bool:n})];return m.push.apply(m,e.dictionaryToDataFields(g)),(0,r.m)(new u.z,{name:t&&t.length>0?e.getOtelNonUserActionEventTablePrefix()+t:e.getOtelNonUserActionEventTableName(),durationMs:h-d>0?h-d:0,dataFields:m})},e.shouldRegisterOtelListener=function(t){return!!n(254).AFrameworkApplication.appSettingsManager&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OtelPipelineIsEnabled")&&e.isUserActionLoggingToOtelEnabled(t)},e.oldActionsPipelineIsEnabled=function(){return e.oldActionsPipelineStatusIsEnabled||(e.oldActionsPipelineStatusIsEnabled=n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OldPipelineActionLoggingDisabled")?1:2,1===e.oldActionsPipelineStatusIsEnabled&&a.ULS.sendTraceTag(51140033,383,15,"OldPipelineActionLoggingDisabled is true, actions / bSqm actions will not be logged.")),2===e.oldActionsPipelineStatusIsEnabled},e.unknownValueString="Unknown",e.logSessionStartAndEndDataFromClientToOTelIsEnabled=0,e.userActionLoggingToOtelIsEnabled=0,e.oldActionsPipelineStatusIsEnabled=0,e}();(0,d.l)(g,"OtelUtils",null,[])},,function(e,t,n){"use strict";n.d(t,{n:function(){return r}});var i=n(208),r=function(){return function(){this.parentId=null}}();(0,i.l)(r,"BuildContext",null,[])},function(e,t,n){"use strict";n.d(t,{m:function(){return i}});var i=function(e,t){return Object.assign(e,t)}},function(e,t,n){"use strict";var i=n(592),r=n(208),o=function(){function e(){}return e.prototype.get_isYielding=function(){return!1},e.prototype.get_isRunning=function(){return!1},e.prototype.get_isCallbackRunning=function(){return!1},e.prototype.set_isCallbackRunning=function(e){return e},e.prototype.get_hasStopped=function(){return!1},e.prototype.get_timeToWaitAfterLastKeyStroke=function(){return 0},e.prototype.set_timeToWaitAfterLastKeyStroke=function(e){return e},e.prototype.get_runningTaskItemID=function(){return null},e.prototype.get_yieldResponseOperation=function(){return null},e.prototype.get_pendingTaskCount=function(){return 0},e.prototype.addTask=function(e){},e.prototype.deleteTask=function(e){},e.prototype.pause=function(){},e.prototype.delayTasks=function(e){},e.prototype.pauseForAnimation=function(e){},e.prototype.resume=function(){},e.prototype.yield=function(e){},e.prototype.stop=function(){},e.prototype.restart=function(){},e.prototype.addAggregator=function(e,t){},e.prototype.resetInterval=function(e,t){},e.prototype.removeTasks=function(e){},e.prototype.get_maximumTimeOfOneCpuWakeUp=function(){return 0},e.prototype.set_maximumTimeOfOneCpuWakeUp=function(e){return e},e.prototype.startToCollectTaskDetails=function(){},e.prototype.getDiagnosticStateForLogging=function(){return{}},e}();(0,r.l)(o,"NoOpTaskManager",null,[i.h]);var a=n(898),s=n(101);n.d(t,{y:function(){return l}});var l=function(){function e(){}return e.get_instance=function(){return e._instanceToReturn||(e._realTaskManager=a.n.createTaskManagerImpl(),e._instanceToReturn=e._realTaskManager),e._instanceToReturn},e.dispose=function(){e._instanceToReturn=new o,s.b(e._realTaskManager),e._realTaskManager=null},e.keepOriginalWindowFuncInTaskManager=function(){a.n.keepOriginalWindowFunc()},e._realTaskManager=null,e._instanceToReturn=null,e}();(0,r.l)(l,"TaskManager",null,[])},,,function(e,t,n){"use strict";n.d(t,{s:function(){return i}});var i=(0,n(208).y)("ICUIRoot")},,,function(e,t,n){"use strict";var i=n(508),r=n(208),o=(0,r.y)("IActionOperation"),a=n(865),s=n(467);n.d(t,{g:function(){return l}});var l=function(e){function t(){var t=e.call(this)||this;return t._actionData=null,t._telemetryData=null,t._actionManager=null,t.actionId=0,t.behavior=0,t.beginMode=0,t.reportingData=null,t.$$pf_Response=0,t.invocationMethod=0,t.commandLocation=0,t.commandTabName=null,t}return(0,i.t)(t,e),t.prototype.initAction=function(e,t,i,r,o,a){void 0===a&&(a=null),this.actionId=t,this._actionData=o,this._telemetryData=a,this.behavior=i,this.set_response(1),this._actionManager=e,this.reportingData=r,this.invocationMethod=e.get_invocationMethod(),this.commandLocation=e.get_commandLocation(),this.commandTabName=e.get_commandTabName(),this.beginMode=n(254).AFrameworkApplication.get_activeFrame()?n(254).AFrameworkApplication.get_activeFrame().get_mode():0},t.prototype.get_actionId=function(){return this.actionId},t.prototype.get_behavior=function(){return this.behavior},t.prototype.get_beginMode=function(){return this.beginMode},t.prototype.get_reportingData=function(){return this.reportingData},t.prototype.get_actionData=function(){return this._actionData},t.prototype.get_telemetryData=function(){return this._telemetryData},t.prototype.get_response=function(){return this.$$pf_Response},t.prototype.set_response=function(e){return this.$$pf_Response=e,e},t.prototype.get_invocationMethod=function(){return this.invocationMethod},t.prototype.get_commandLocation=function(){return this.commandLocation},t.prototype.get_commandTabName=function(){return this.commandTabName},t.prototype.setCurrentOperationFromContext=function(e){e.get_isContextSet()?n(818).ProcessContextSetOperation.registerInstance(this._actionManager,this,e,this.get_actionId(),this.get_behavior(),!0,this.get_reportingData(),this._actionData,this._telemetryData):n(653).ProcessContextOperation.registerInstance(this._actionManager,this,e,this.get_actionId(),this.get_behavior(),!0,this.get_reportingData(),this._actionData,this._telemetryData)},t.prototype.processCurrentOperation=function(){var e=this.get_childOperation();if(e){if(e.get_inProgress()&&(e.run(),e.get_hasYielded()))return 1;var t=e.get_response();return this.set_response(n(722).ActionManager.mergeResponses(this.get_response(),t)),e.recycle(),this.clearChildOperation(),t}return 0},t}(s.k);(0,r.l)(l,"ActionOperation",s.k,[o,a.b])},function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var i=(0,n(208).y)("IZoomControl")},function(e,t,n){"use strict";n.r(t),n.d(t,{ProcessContextSetOperation:function(){return a}});var i=n(508),r=n(816),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t._contextSet=null,t._nextContextIndex=0,t._stopOnFirstResponse=!1,t}return(0,i.t)(t,e),t.prototype.recycle=function(){e.prototype.recycle.call(this),Array.add(t._instances,this)},t.prototype.run=function(){if(1!==this.processCurrentOperation()){for(var e=this._contextSet.get_length(),t=this._nextContextIndex;t<e&&(this.get_response()<=2||!this._stopOnFirstResponse);t++){this._nextContextIndex=t+1;var i=this._contextSet.getContext(t);if(this.setCurrentOperationFromContext(i),1===this.processCurrentOperation())return;if(this.get_timeoutExceeded()&&t!==e-1)return void this.yield()}this.set_response(n(722).ActionManager.mergeResponses(this.get_response(),2)),this.setIsCompleted()}},t.registerInstance=function(e,n,i,r,o,a,s,l,u){var c,p=t._instances.length;return p?(c=t._instances[p-1],Array.removeAt(t._instances,p-1)):c=new t,c.init(n),c.setDebugName("Context Set Operation"),c.initAction(e,r,o,s,l,u),c._contextSet=i,c._nextContextIndex=0,c.set_response(1),c._stopOnFirstResponse=1===o,c},t._instances=[],t}(r.g);(0,o.l)(a,"ProcessContextSetOperation",r.g,[])},,,,function(e,t,n){"use strict";n.d(t,{r:function(){return r}});var i=n(208),r=function(){return function(){this.success=!1,this.id=null,this.queryData=null,this.contextData=null}}();(0,i.l)(r,"DataQueryResult",null,[])},,,function(e,t,n){"use strict";n.d(t,{u:function(){return i},d:function(){return r},c:function(){return o}});var i=function(e,t,n){return t|e<<10|n<<26},r=function(e){return e>>>26&31},o=function(e){return e>>>10&65535}},,,function(e,t,n){"use strict";n.d(t,{g:function(){return i}});var i=(0,n(208).y)("ISessionStatus")},function(e,t,n){"use strict";var i=n(254),r=n(208),o=function(){function e(){}return e.namedObjectNameAttr="n",e}();(0,r.l)(o,"Bundle",null,[]);var a=function(){function e(){}return e.variationAttr="v",e}();(0,r.l)(a,"ResReader",null,[]);var s=n(684);n.d(t,{w:function(){return l}});var l=function(){function e(){}return e.urlForNamedObject=function(t){if(!e._isInited)return null;var n=new s.QueryStringBuilder(e._serviceUrl);return n.addParam(o.namedObjectNameAttr,t),n.addParam(a.variationAttr,e._variation),n.addParam(i.AFrameworkApplication.userSessionIdQueryParam,i.AFrameworkApplication.userSessionId),i.AFrameworkApplication.buildVersion&&n.addFullParam(i.AFrameworkApplication.getBrowserBuildRequestQueryParam()),i.AFrameworkApplication.isLoggingHostRequests&&n.addParam(i.AFrameworkApplication.logHostRequestsQueryParam,i.AFrameworkApplication.get_logHostRequestsQueryValue()),n.toString()+"&"+e._baseDocQueryParam+e._extraUrlParams},e.initWithExtraUrlParameters=function(t,n,i,r){e.init(t,n,i),e._extraUrlParams=r},e.init=function(t,n,i){e._isInited=!0,e._serviceUrl=t,e._variation=i,e._baseDocQueryParam=n},e._serviceUrl=null,e._baseDocQueryParam=null,e._variation=null,e._extraUrlParams="",e._isInited=!1,e}();(0,r.l)(l,"NamedObject",null,[])},function(e,t,n){"use strict";var i=n(508),r=n(208),o=n(550),a=n(255),s=n(605),l=n(574),u=n(446),c=n(425),p=function(e){function t(t,n,i,r,o,a,s,l,u,c,p,d,h,g){var m=e.call(this,t,s,g,2)||this;return m._client=null,m._element=null,m._screen=null,m._wheel=0,m._caught=null,m._button=0,m._shiftKey=!1,m._altKey=!1,m._ctrlKey=!1,m._metaKey=!1,m._client=i,m._element=r,m._screen=o,m._caught=l,m._wheel=a,m._button=n,m._shiftKey=u,m._altKey=c,m._ctrlKey=p,m._metaKey=d,m.userData=h,m}return(0,i.t)(t,e),t.prototype.get_mouseButton=function(){return this._button},t.prototype.get_clientPoint=function(){return this._client},t.prototype.get_screenPoint=function(){return this._screen},t.prototype.get_elementPoint=function(){return this._element||(this._element=u.a.getElementPoint(this._client,this.get_sourceElement())),this._element},t.prototype.get_wheelData=function(){return this._wheel},t.prototype.get_caughtElement=function(){return this._caught},t.prototype.get_shiftKey=function(){return this._shiftKey},t.prototype.get_altKey=function(){return this._altKey},t.prototype.get_ctrlKey=function(){return this._ctrlKey},t.prototype.get_metaKey=function(){return this._metaKey},t.prototype.get_commandKey=function(){return c.y.get_isMac()?this._metaKey:this._ctrlKey},t.create=function(e,n,i,r){if(r.rawEvent){var o=r.rawEvent,a=u.a.getSourceElement(r),s=new Sys.UI.Point(o.screenX,o.screenY),c=new Sys.UI.Point(o.clientX,o.clientY),p=0;return e===l.d.get_mouseWheel()&&(o.wheelDelta?(p=-o.wheelDelta/120,window.self.opera&&(p*=-1)):p=o.detail/3),new t(e,u.a.getMouseButton(o),c,null,s,p,a,n,o.shiftKey,o.altKey,o.ctrlKey,o.metaKey,i,r)}a=u.a.getSourceElement(r),s=new Sys.UI.Point(r.screenX,r.screenY),c=new Sys.UI.Point(r.clientX,r.clientY),p=0;return new t(e,r.button,c,null,s,p,a,n,r.shiftKey,r.altKey,r.ctrlKey,!1,i,r)},t.changeUserData=function(e,t){e.userData=t},t}(u.a);(0,r.l)(p,"MouseEventArgs",u.a,[]);var d=n(810),h=n(101),g=n(296);n.d(t,{p:function(){return m}});var m=function(e){function t(){var t=e.call(this)||this;return t._capturedHandler=null,t._focusManager=null,t._eventHandlerManager=null,t._supressEvents=!1,t._capturedHandler=null,t._eventHandlerManager=n(306).EventHandlerManager.get_instance(),t._focusManager=n(657).FocusManager.instance(),t}return(0,i.t)(t,e),t.prototype.initializeForElement=function(t){e.prototype.initializeForElement.call(this,t),this._eventHandlerManager.initializeListForElement(l.d.get_mouseEvents(),t,2,r.i(this,this.onMouseEvent,"onMouseEvent"))},t.prototype.deinitializeForElement=function(t){e.prototype.deinitializeForElement.call(this,t),this._eventHandlerManager.deinitializeListForElement(t,l.d.get_mouseEvents())},t.prototype.registerHandler=function(e,t,n,i){this.registerHandlerWithCaptureOption(e,t,n,i,!1)},t.prototype.registerHandlerWithCaptureOption=function(e,t,n,i,o){void 0===o&&(o=!1),this._eventHandlerManager.registerHandler(p,e,t,2,r.i(this,this.onMouseEvent,"onMouseEvent"),n,i,o)},t.prototype.unregisterHandler=function(e,t,n){this.unregisterHandlerWithCaptureOption(e,t,n,!1)},t.prototype.unregisterHandlerWithCaptureOption=function(e,t,n,i){void 0===i&&(i=!1),this._eventHandlerManager.unregisterHandler(p,e,t,n,i)},t.prototype.capture=function(e,t){this._capturedHandler=new s.a(p,e,t)},t.prototype.releaseCapture=function(){this._capturedHandler=null},t.prototype.onMouseEvent=function(e,t,i){if((e===l.d.click||e===l.d.doubleClick||e===l.d.get_mouseWheel())&&n(657).FocusManager.instance().tryGrabFocus(n(254).AFrameworkApplication.postmessageFocusId),!this.get_isEnabled())return!1;if(!g.s.isValidElement(i.target))return!1;if(d.y.get_instance().get_isYielding())return a.ULS.sendTraceTag(24699482,324,50,"Mouse event dropped."),!1;if(e===l.d.mouseMove&&o.n.ensureAppAwakeIfAsleep(),this._supressEvents)return o.n.cancelEvent(i),!0;var r=null,s=!1;return this._capturedHandler?(r=p.create(e,t,this._capturedHandler.userData,i),(s=this._capturedHandler.handler(r))&&o.n.cancelEvent(i),s):(r=p.create(e,t,null,i),(s=this._eventHandlerManager.processEvent(p,e,t,r))&&o.n.cancelEvent(i),s)},t.prototype.addControlFocus=function(e,t,n,i){var r=this;void 0===n&&(n=!1),void 0===i&&(i=!1);var o=function(t){return r._focusManager.tryChangeScopeOnStealingFocusEvent(e,i,n,t),!1};this.registerHandler(l.d.mouseDown,t,o,null),this._focusManager.getScope(e).addDispose((function(){r.unregisterHandler(l.d.mouseDown,t,o)}))},t.get_instance=function(){return t._instance||(t._instance=new t),t._instance},t.disposeInputManager=function(){h.b(t._instance),t._instance=null},t.fireMouseEvent=function(e,n,i,r){var o=t.createMouseEvent(e,n,i,r);n.dispatchEvent?n.dispatchEvent(o):n.fireEvent&&n.fireEvent("on"+e,o)},t.createMouseEvent=function(e,t,n,i){var r=null;if(window.document.createEvent)(r=window.document.createEvent("MouseEvents")).initMouseEvent(e,!0,!0,window.self,0,n.x+Sys.UI.DomElement.getLocation(t).x+window.self.screenX,n.y+Sys.UI.DomElement.getLocation(t).y+window.self.screenY,n.x+Sys.UI.DomElement.getLocation(t).x,n.y+Sys.UI.DomElement.getLocation(t).y,!1,!1,!1,!1,i,null);else if(window.document.createEventObject)switch((r=window.document.createEventObject()).offsetX=n.x,r.offsetY=n.y,r.clientX=n.x+Sys.UI.DomElement.getLocation(t).x,r.clientY=n.y+Sys.UI.DomElement.getLocation(t).y,r.screenX=n.x+Sys.UI.DomElement.getLocation(t).x+window.screenX,r.screenY=n.y+Sys.UI.DomElement.getLocation(t).y+window.screenY,i){case 0:r.button=1;break;case 1:r.button=4;break;case 2:r.button=2}return r},t.isMouseEventName=function(e){return Array.contains(l.d.get_mouseEvents(),e)},t._inputDataName="#m",t._instance=null,t}(o.n);(0,r.l)(m,"MouseInputManager",o.n,[])},,function(e,t,n){"use strict";n.r(t),n.d(t,{EuplTelemetryLogger:function(){return a}});var i=n(625),r=n(254),o=n(208),a=function(){function e(){this.requestType="PERF_EUPL"}return e.prototype.logToMdm=function(e,t){var n=this.prepareRequestPayload(e,t);r.AFrameworkApplication.theClientRequestManager.addRequest(r.AFrameworkApplication.appSettingsManager.getStringAppSetting("RemoteTelemetryUrl"),2,n,null,!1,1,null,null,null,void 0,void 0,void 0,void 0,"PerfTelemetry")},e.prototype.prepareRequestPayload=function(e,t){var n={},i={};return n.euplValue=e,n.perfEuplDimensions=t,i.type=this.requestType,i.payloadJson=JSON.stringify(n),JSON.stringify(i)},e}();(0,o.l)(a,"EuplTelemetryLogger",null,[i.n])},function(e,t,n){"use strict";n.d(t,{g:function(){return o}});var i=n(912),r=n(208),o=function(){function e(){}return e.LabelText=i.b.labelText,e.LabelTextUserGeneratedPlaceholderReplacements=i.b.labelTextUserGeneratedPlaceholderReplacements,e.Visible=i.b.visible,e.ImageIsVisible="ImageIsVisible",e.ImageUsesSpaceWhileInvisible="ImageUsesSpaceWhileInvisible",e.Image16by16Class=i.b.image16by16Class,e.Image32by32Class=i.b.image32by32Class,e.Image48by48Class=i.b.image48by48Class,e.ImageBackColor="ImageBackColor",e.On="On",e.SourceControlId="SourceControlId",e}();(0,r.l)(o,"FlyoutAnchorCommandProperties",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,{SaveAndEditATranslatedCopyRequest:function(){return d}});var i=n(508),r=n(759),o=n(941),a=n(475),s=n(322),l=n(917),u=n(254),c=n(556),p=n(208),d=function(e){function t(){for(var t=e.call(this)||this,n=a.o.translationLanguages.getLanguages(),i="",s=0;s<n.length;s++)if(n[s].name===o.App.get_instance().get_translationLanguage()){i=n[s].displayName;break}return t._downloadUri=o.App.webServiceBase+"docdatahandler.ashx?"+o.App.get_instance().theDocument.get_baseDocQuerySignature()+"&language="+c.l.urlKeyValueEncode(o.App.get_instance().get_translationLanguage())+"&languagename="+c.l.urlKeyValueEncode(i)+"&type=docx&o15=1&SaveAndEdit=1",u.AFrameworkApplication.theWsaClient.incrementDw(r.DownloadATranslatedCopyRequest.dataiD_WORDWEBAPPTRANSLATIONDOWNLOADCLICKS,1),t}return(0,i.t)(t,e),t.prototype.onSuccess=function(e){var t=e.responseXml.selectSingleNode("/docdata/editUrl");if(t){window.self.location.href=t.text}else{l.u.propagateError(!1,"SaveAndEditATranslatedDocumentFailed",s.i.itemNotGenerated,"Unexpected null edit url in response!")}},t.prototype.get_waitMessage=function(){return WordViewerIntl.WordViewerStrings.l_SaveAndEditTranslatedDocument},t}(r.DownloadATranslatedCopyRequest);(0,p.l)(d,"SaveAndEditATranslatedCopyRequest",r.DownloadATranslatedCopyRequest,[])},,function(e,t,n){"use strict";var i=n(998),r=n(367),o=n(208),a=function(){function e(e){this._first=null,this._node=null,this._first=e}return e.prototype.get_current=function(){if(!this._node)throw Error.argumentOutOfRange();return this._node.data},e.prototype.moveNext=function(){return this._node?!!this._node.next&&(this._node=this._node.next,!0):(this._node=this._first,!!this._first)},e.prototype.movePrevious=function(){return this._node?!!this._node.previous&&(this._node=this._node.previous,!0):(this._node=this._first,!!this._first)},e.prototype.reset=function(){this._node=this._first},e}();(0,o.l)(a,"ListEnumerator",null,[r.e]);var s=function(){return function(e,t,n){this.next=null,this.previous=null,this.data=null,this.next=n,this.previous=t,this.data=e}}();(0,o.l)(s,"ListNode",null,[]),n.d(t,{y:function(){return l}});var l=function(){function e(){this._head=null,this._tail=null,this._count=0}return e.prototype.add=function(e){this._head?this._tail=this._tail.next=new s(e,this._tail,null):this._head=this._tail=new s(e,null,null),this._count++},e.prototype.insert=function(e,t){if(e>this._count||0>e)throw Error.argumentOutOfRange("pos");if(e!==this._count){for(var n=this._head;0!=e--;)n=n.next;var i=new s(t,n.previous,n);i.previous?i.previous.next=i:this._head=i,i.next?i.next.previous=i:this._tail=i,this._count++}else this.add(t)},e.prototype.remove=function(e){for(var t=this._head;t&&t.data!==e;)t=t.next;return!!t&&(t.previous?t.previous.next=t.next:this._head=t.next,t.next?t.next.previous=t.previous:this._tail=t.previous,this._count--,!0)},e.prototype.clear=function(){var e,t=this._head;for(this._head=null,this._tail=null;t;)e=t.next,t.previous=null,t.next=null,t=e;this._count=0},e.prototype.indexOf=function(e){for(var t=this._head,n=0;t&&t.data!==e;)t=t.next,n++;return t?n:-1},e.prototype.get_item=function(e){return this.at(e).data},e.prototype.get_count=function(){return this._count},e.prototype.getEnumerator=function(){return new a(this._head)},e.prototype.getEnumeratorAtPos=function(e){var t=this.at(e);return new a(t)},e.prototype.toArray=function(){for(var e=new Array(this._count),t=0,n=this.getEnumerator();n.moveNext();){var i=n.get_current();e[t]=i,t++}return e},e.prototype.at=function(e){for(var t=this._head,n=0;n!==e;){if(!t)throw Error.argumentOutOfRange("pos");t=t.next,n++}return t},e}();(0,o.l)(l,"List",null,[i.k])},function(e,t,n){"use strict";n.d(t,{k:function(){return o},x:function(){return a}});var i=n(255),r=function(e,t,n){try{o(e,200,10,"Exception was thrown while {0}: {1}",t,n.toString())}catch(e){}},o=function(e,t,n,o){for(var a=[],u=4;u<arguments.length;u++)a[u-4]=arguments[u];try{i.ULS.sendTraceTag.apply(null,[e,s(t),l(n),o].concat(a))}catch(t){r(e,"logging",t)}},a=function(e,t,n,o){for(var a=[],l=4;l<arguments.length;l++)a[l-4]=arguments[l];try{i.ULS.shipAssertTag.apply(null,[e,s(t),n,o].concat(a))}catch(t){r(e,"asserting",t)}},s=function(e){return e},l=function(e){return e}},,,function(e,t,n){"use strict";n.d(t,{i:function(){return i}});var i=(0,n(208).y)("IKeyInputManager")},function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=n(643),a=n(255),s=n(614),l=n(196),u=n(873),c=function(){function e(){}return e.sessionIdString="sessionID",e.p1="p1",e.p2="p2",e.appMode="AppMode",e.appVersion="Version",e.isProd="isProd",e.isMac="isMac",e.isIPad="isIPad",e.flightId="FlightId",e.crash="Crash",e.featureName="FeatureName",e.featureData="FeatureData",e.error="Error",e.errorCode="ErrorCode",e.officeBrowserFeedbackComment="officeBrowserFeedbackComment",e.officeBrowserFeedbackContactInfoEmailInput="officeBrowserFeedbackContactInfoEmailInput",e.feedbackOverall="feedbackOverall",e}();(0,r.l)(c,"CustomerFeedbackParams",null,[]);var p=n(550),d=n(564),h=(0,r.y)("ICustomRecordQosError"),g=n(456),m=function(){function e(){}return e.prototype.recordQosErrorBasedOnCustomError=function(e){g.Health.get_instance().recordQosError(e.ErrorName,["NonDismissibleDialog"],e.IsIntentional,e.CauseIsInternalToWac,e.IncludedInOverallFailureRateForAlerting,e.IsSessionEndingError,null)},e}();(0,r.l)(m,"CustomRecordQosDialogError",null,[h]);var _=n(478),f=n(810),y=function(){function e(){}return e.prototype.areReady=function(){return 32===n(254).AFrameworkApplication.get_theActionManager().processAction(s.KO,1)},e.prototype.waitForReady=function(e,t,i){var r=this;void 0===t&&(t=0),void 0===i&&(i=null),2!==n(254).AFrameworkApplication.get_theActionManager().processAction(s.KO,1)?e(this,null):t<20?f.y.get_instance().addTask(new _.c(2,1,500,(function(n){r.waitForReady(e,t+1,i)}),93)):i&&i()},e.prototype.invokeFeedbackHanlderAfterReady=function(e){this.waitForReady((function(t,i){n(254).AFrameworkApplication.get_theActionManager().processActionWithData(s.KO,2,e)}),0,(function(){a.ULS.sendTraceTag(20575889,201,10,"Feedback package is not available after timeout");var e=new(n(841).StandardDialog);e.set_buttonsOption(0),e.showError(u.p.feedbackPackageLoadFailed,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NetworkProblemInitialDialogDescription,null)}))},e}();(0,r.l)(y,"FeedbackDependencies",null,[]);var v=n(337),S=n(134);n.d(t,{StandardDialog:function(){return C}});var C=function(e){function t(t){var i=e.call(this,t,!1,!!n(254).AFrameworkApplication.get_activeFrame()&&n(254).AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactDialogEnabled())||this;i._isDismissable=!1,i._dismissLabel="Don't show this dialog again.",i._showHelpLink=!1,i._showFeedbackPanel=!1,i._helpLinkText=null,i._errorData=null,i._helpContextID=null,i._showDownloadLink=!1,i._downloadLinkText=null,i._downloadLinkUrl=null,i._standardDialogHandler=null,i._helpFwlinkId=null,i._hideFeedbackDescription=!1,i._feedbackLinkText="Give feedback to Microsoft",i._feedbackLinkClickHandler=null,i._feedbackDescriptionText="Your feedback helps Microsoft improve Office",i._errorText="Error",i._warningText="Warning",i._infoText="Information",i._questionText="Question",i._sessionInfoText="Session ID: {0}",i._showSaveErrorReportPanel=!1,i._saveErrorReportTitleText=null,i._saveErrorReportDescriptionText=null,i._privacyPolicyLinkText=null,i._privacyPolicyLinkClickHandler=null,i._iconPanel=null,i._textElement=null,i._textPanel=null,i._checkboxPanel=null,i._contentRow=null,i._dontShowCheckBox=null,i._helpLink=null,i._feedbackLink=null,i._feedbackPanel=null,i._feedbackDescription=null,i._downloadLink=null,i._saveErrorReportPanel=null,i._saveErrorReportTitle=null,i._saveErrorReportDescription=null,i._privacyPolicyLink=null,i._showExtraLink=!1,i._extraLinkText=null,i._extraLinkUrl=null,i._extraLink=null,i._dontShowCheckboxChecked=!1,i._dialogIcon=0,i._customRecordQosDialogError=null,i._isErrorDialog=!1,i.showSessionId=!1,i._notifyHandlersBeforeDismiss=!1,i._feedbackLinkClickHandler=r.i(i,i.onFeedbackClickHandler,"onFeedbackClickHandler");try{i._dismissLabel=CommonUIStrings.l_DialogDoNotShow,i._feedbackLinkText=CommonUIStrings.l_ErrorDialogFeedbackLinkText,i._feedbackDescriptionText=CommonUIStrings.l_ErrorDialogFeedbackText,i._errorText=CommonUIStrings.l_DialogError,i._warningText=CommonUIStrings.l_DialogWarning,i._infoText=CommonUIStrings.l_DialogInfo,i._questionText=CommonUIStrings.l_DialogQuestion,i._sessionInfoText=CommonUIStrings.l_DialogSessionInfo}catch(e){a.ULS.sendTraceTag(39321886,207,10,"Failed to get CommonUIStrings. Exception: {0}",e)}return i}return(0,i.t)(t,e),t.prototype.get_isDismissable=function(){return this._isDismissable},t.prototype.set_isDismissable=function(e){return this._isDismissable=e,e},t.prototype.get_dismissLabel=function(){return this._dismissLabel},t.prototype.set_dismissLabel=function(e){return this._dismissLabel=e,e},t.prototype.get_isErrorDialog=function(){return this._isErrorDialog},t.prototype.set_isErrorDialog=function(e){return this._isErrorDialog=e,e},t.prototype.get_notifyHandlersBeforeDismiss=function(){return this._notifyHandlersBeforeDismiss},t.prototype.set_notifyHandlersBeforeDismiss=function(e){return this._notifyHandlersBeforeDismiss=e,e},t.prototype.dispose=function(){this._iconPanel=null,this._textElement=null,this._textPanel=null,this._checkboxPanel=null,this._dontShowCheckBox=null,this._contentRow=null,this._helpLink&&(p.n.removeHandler(this._helpLink,"click",r.i(this,this.onHelpClickHandler,"onHelpClickHandler")),this._helpLink=null),this._feedbackLink&&(p.n.removeHandler(this._feedbackLink,"click",this._feedbackLinkClickHandler),this._feedbackLink=null,this._feedbackDescription=null,this._feedbackPanel=null,this._showFeedbackPanel=!1,this._errorData=null),this._downloadLink&&(this._downloadLink=null,this._showDownloadLink=!1),this._privacyPolicyLink&&(p.n.removeHandler(this._privacyPolicyLink,"click",this._privacyPolicyLinkClickHandler),this._privacyPolicyLink=null,this._saveErrorReportDescription=null,this._saveErrorReportTitle=null,this._saveErrorReportPanel=null,this._showSaveErrorReportPanel=!1),e.prototype.dispose.call(this)},t.prototype.prepareDialog=function(){e.prototype.prepareDialog.call(this),this._contentRow=this._document.createElement("div"),this._contentRow.className=t._contentRowClass,this._body.appendChild(this._contentRow),this._iconPanel=this._document.createElement("div"),this._iconPanel.id=this.myId(t._iconPanelId),this._iconPanel.className=t._iconCssClass,this._contentRow.appendChild(this._iconPanel),this._textPanel=this._document.createElement("div"),this._textPanel.id=this.myId(t._textPanelId),this._textPanel.className=t._textPanelCssClass,this._contentRow.appendChild(this._textPanel),this._textElement=this._document.createElement("div"),this._textElement.id=this.myId(t._textId),this._textPanel.appendChild(this._textElement),this._showDownloadLink&&this.appendDownloadLink(),this._showHelpLink&&n(246).Redirect.isHelpAvailable()&&this.appendHelpLink(),this._showFeedbackPanel&&this.appendFeedbackLinkPanel(),this.showSessionId&&this.appendSessionId(),this._showSaveErrorReportPanel&&this.appendSaveErrorReportPanel()},t.prototype.getAdditionalMessageIds=function(){return this._showSaveErrorReportPanel?String.format("{0} {1} {2}",t._saveErrorReportTitleId,t._saveErrorReportDescriptionId,t._privacyPolicyLinkId):""},t.prototype.useSimpleErrorDialog=function(){return this.get_isErrorDialog()&&!l.r.get_instance().isCompleted(8)&&!n(55).UISurfaces.isDialogAPILoaded()},t.prototype.messageBoxImpl=function(e,t,i,r,o,a){if(this.set_dialogId(void 0===this.get_dialogId()||null===this.get_dialogId()?v.s(0,Number.MAX_VALUE).toString():this.get_dialogId()),this._useReactDialog){if(null==a&&!this.useSimpleErrorDialog())return void this.reactMessageBoxImpl(e,t,i,r,o);this._useReactDialog=!1,n(55).UISurfaces.getDialogAPIAsync().then((function(e){return e.dispose(),null}))}this.legacyMessageBoxImpl(e,t,i,r,o,a)},t.prototype.reactMessageBoxImpl=function(i,o,a,s,l){this._messageBoxHandler=r.i(this,this.baseDialogHandler,"baseDialogHandler"),this._standardDialogHandler=l;var u={type:"StandardDialogProps",id:this.get_dialogId(),headerText:i,titleText:o,dialogIcon:this._dialogIcon,resultHandler:this._messageBoxHandler,messageAreaLink:this._showExtraLink?this.createReactLinkProps(t._extraLinkId):null,downloadLink:this._showDownloadLink?this.createReactLinkProps(t._downloadLinkId):null,helpLink:this._showHelpLink&&n(246).Redirect.isHelpAvailable()?this.createReactLinkProps(t._helpLinkId):null,feedbackDescription:this._showFeedbackPanel&&!this._hideFeedbackDescription?this._feedbackDescriptionText:null,feedbackLink:this._showFeedbackPanel?this.createReactLinkProps(t._feedbackLinkId):null,sessionId:this.showSessionId?String.format(this._sessionInfoText,n(254).AFrameworkApplication.userSessionId):null,permanentDismissCheckbox:this.get_isDismissable()?this.createReactDismissCheckboxProps():null,saveErrorReportTitle:this._showSaveErrorReportPanel?this._saveErrorReportTitleText:null,saveErrorReportDescription:this._showSaveErrorReportPanel?this._saveErrorReportDescriptionText:null,privacyPolicyLink:this._showSaveErrorReportPanel?this.createReactLinkProps(t._privacyPolicyLinkId):null};e.prototype.show.call(this,u)},t.prototype.legacyMessageBoxImpl=function(e,i,o,a,s,l){if(this.prepareDialog(),this._messageBoxHandler=r.i(this,this.baseDialogHandler,"baseDialogHandler"),this._standardDialogHandler=s,i||null!=l||(i=" "),i){if(this._textElement.innerText=i,this._showExtraLink&&(this._extraLink=this._document.createElement("a"),this._extraLink.href=this._extraLinkUrl,this._extraLink.id=t._extraLinkId,this._extraLink.innerText=this._extraLinkText,this._extraLink.target="_blank",this._textElement.appendChild(this._document.createTextNode(" ")),this._textElement.appendChild(this._extraLink)),i.trim().length>0){var u=this._textElement.id,c=this.getAdditionalMessageIds();c&&c.length>0&&(u=String.format("{0} {1}",u,c)),this.setDescribedByForDialog(u)}}else this._textElement.appendChild(l);o?this._iconPanel.appendChild(n(973).createClusteredImage(32,32,o,null,!0,a)):this._contentRow.removeChild(this._iconPanel),this._divMessageBox.style.width=String.format("{0}em",this.get_width()),this._bodyPanel.style.width="375px",this._divMessageBox.style.display="Block",this.get_isDismissable()&&this.setupCheckBoxPanel(),this._titleText.innerText=e,this.show()},t.prototype.showWarning=function(e,t,n){this.messageBox(e,t,1,n)},t.prototype.showError=function(e,i,o,s,l,u,p){n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ShowSessionIdOnError")&&(this.showSessionId=!0),a.ULS.sendTraceTag(38111394,207,50,"Show error dialog. ErrorType: {0}",e),this._customRecordQosDialogError=new m,l||n(254).AFrameworkApplication.reportError(e,r.i(this._customRecordQosDialogError,this._customRecordQosDialogError.recordQosErrorBasedOnCustomError,"recordQosErrorBasedOnCustomError")),this.shouldShowFeedbackLinkForError(e)&&n(254).AFrameworkApplication.get_activeFrame()&&d.o.get_instance().tryInitializePackage(t._customerFeedbackPackageName)&&(this._errorData={},this._errorData[c.error]=!0,this._errorData[c.crash]=t.isCrashingErrorCode(e),this._errorData[c.errorCode]=e,this._showFeedbackPanel=!0);var h=u?1:2;this._hideFeedbackDescription=p,this.set_isErrorDialog(!0),n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsBetterErrorHandlingEnabled")||n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsCrashDialogImprovementEnabled")?this.messageBox(i,o,0,s):this.messageBox(i,o,h,s)},t.prototype.showInformation=function(e,t,n){this.messageBox(e,t,3,n)},t.prototype.showQuestion=function(e,t,n){this.messageBox(e,t,4,n)},t.prototype.messageBox=function(e,n,i,r,o){this._dialogIcon=i;var a=null,s=null;switch(i){case 2:a=t._errorIconName,s=this._errorText;break;case 1:a=t._warningIconName,s=this._warningText;break;case 3:a=t._infoIconName,s=this._infoText;break;case 4:a=t._questionIconName,s=this._questionText}this.messageBoxImpl(e,n,a,s,r,o)},t.prototype.addHelpLink=function(e,t,n){void 0===n&&(n=null),this._showHelpLink=!0,this._helpLinkText=e,this._helpContextID=t,this._helpFwlinkId=n},t.prototype.addDownloadLink=function(e,t){this._showDownloadLink=!0,this._downloadLinkText=e,this._downloadLinkUrl=t},t.prototype.addExtraLink=function(e,t){this._showExtraLink=!0,this._extraLinkText=e,this._extraLinkUrl=t},t.prototype.addFeedbackLink=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!0),this._showFeedbackPanel=!0,this._feedbackLinkText=e,this._feedbackLinkClickHandler=t||this._feedbackLinkClickHandler,this._hideFeedbackDescription=n},t.prototype.addSaveErrorReportPanel=function(e,t,n,i){this._showSaveErrorReportPanel=!0,this._saveErrorReportTitleText=e,this._saveErrorReportDescriptionText=t,this._privacyPolicyLinkText=n,this._privacyPolicyLinkClickHandler=i},t.prototype.baseDialogHandler=function(e){var t=!1;this.get_isDismissable()&&(t=this._useReactDialog?this._dontShowCheckboxChecked:this._dontShowCheckBox.checked),this.get_notifyHandlersBeforeDismiss()||this._hideOnButtonClick&&this.hide(),this._standardDialogHandler&&this._standardDialogHandler(e,t),this.get_notifyHandlersBeforeDismiss()&&this._hideOnButtonClick&&this.hide(),this._hideOnButtonClick&&(this._standardDialogHandler=null)},t.prototype.onHelpClickHandler=function(e){this._helpFwlinkId?n(246).Redirect.toFwlink(this._helpFwlinkId):n(246).Redirect.showHelp(this._helpContextID)},t.prototype.onFeedbackClickHandler=function(e){n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("FeedbackDelayLoadHandlerEnabled")?(new y).invokeFeedbackHanlderAfterReady(this._errorData):n(254).AFrameworkApplication.get_theActionManager().processActionWithData(s.KO,2,this._errorData)},t.prototype.setupCheckBoxPanel=function(){var e=this.myId(t._checkboxPanelId),n=this.myId(t._checkboxId),i=this.myId(t._doNotShowLabelId);this._checkboxPanel=this._document.createElement("div"),this._checkboxPanel.id=e,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._checkboxPanel);var r=this._document.createElement("div");r.className=t._dontShowCheckboxDivClass,this._checkboxPanel.appendChild(r),this._dontShowCheckBox=this._document.createElement("input"),this._dontShowCheckBox.type="checkbox",this._dontShowCheckBox.id=n,S.t.setAriaAttribute(this._dontShowCheckBox,S.t.ariaLabelledByAttribute,i),r.appendChild(this._dontShowCheckBox);var o=this._document.createElement("div");o.className=t._dontShowLabelDivClass,this._checkboxPanel.appendChild(o);var a=this._document.createElement("label");a.innerText=this.get_dismissLabel(),a.id=i,a.setAttribute("for",n),o.appendChild(a)},t.prototype.shouldShowFeedbackLinkForError=function(e){return n(254).AFrameworkApplication.showFeedbackButton&&(t.isCrashingErrorCode(e)&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ShowFeedbackLinkOnCrashDialog")||!t.isCrashingErrorCode(e)&&n(254).AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ShowFeedbackLinkOnErrorDialog"))},t.prototype.createReactLinkProps=function(e){var n=null,i=null,o=null;switch(e){case t._extraLinkId:n=this._extraLinkText,i={href:this._extraLinkUrl,target:"_blank"};break;case t._downloadLinkId:n=this._downloadLinkText,i={href:this._downloadLinkUrl};break;case t._helpLinkId:n=this._helpLinkText,o=r.i(this,this.onHelpClickHandler,"onHelpClickHandler");break;case t._feedbackLinkId:n=this._feedbackLinkText,o=this._feedbackLinkClickHandler;break;case t._privacyPolicyLinkId:n=this._privacyPolicyLinkText,o=this._privacyPolicyLinkClickHandler;break;default:return null}return{type:"AppLinkProps",id:e,text:n,handler:i||o}},t.prototype.createReactDismissCheckboxProps=function(){var e=r.i(this,this.onCheckboxExecute,"onCheckboxExecute");return{type:"AppCheckboxProps",id:t._checkboxId,label:this._dismissLabel,onExecute:e}},t.prototype.onCheckboxExecute=function(e){this._dontShowCheckboxChecked=e.checked||!this._dontShowCheckboxChecked},t.prototype.appendDownloadLink=function(){this._downloadLink=this._document.createElement("a"),this._downloadLink.href=this._downloadLinkUrl,this._downloadLink.id=t._downloadLinkId,this._downloadLink.innerText=this._downloadLinkText,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._downloadLink),this._textPanel.appendChild(this._document.createElement("br"))},t.prototype.appendHelpLink=function(){this._helpLink=this._document.createElement("a"),this._helpLink.href="#",this._helpLink.id=t._helpLinkId,this._helpLink.innerText=this._helpLinkText,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._helpLink),p.n.addHandler(this._helpLink,"click",r.i(this,this.onHelpClickHandler,"onHelpClickHandler"))},t.prototype.appendSessionId=function(){var e=this._document.createElement("span");e.className="Selectable",e.innerText=String.format(this._sessionInfoText,n(254).AFrameworkApplication.userSessionId),e.id=t._sessionInfoId,this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(e)},t.prototype.appendFeedbackLinkPanel=function(){this._feedbackPanel=this._document.createElement("div"),this._feedbackPanel.id=t._feedbackPanelId,this._feedbackLink=this._document.createElement("a"),this._feedbackLink.href="#",this._feedbackLink.id=t._feedbackLinkId,this._feedbackLink.innerText=this._feedbackLinkText,p.n.addHandler(this._feedbackLink,"click",this._feedbackLinkClickHandler),this._hideFeedbackDescription||(this._feedbackDescription=this._document.createElement("span"),this._feedbackDescription.id=t._feedbackDescriptionId,this._feedbackDescription.innerText=this._feedbackDescriptionText,this._feedbackPanel.appendChild(this._feedbackDescription),this._feedbackPanel.appendChild(this._document.createTextNode(" "))),this._feedbackPanel.appendChild(this._feedbackLink),this._textPanel.appendChild(this._document.createElement("br")),this._textPanel.appendChild(this._feedbackPanel)},t.prototype.appendSaveErrorReportPanel=function(){this._saveErrorReportPanel=this._document.createElement("div"),this._saveErrorReportPanel.id=t._saveErrorReportPanelId,this._saveErrorReportPanel.appendChild(this._document.createElement("br")),this._saveErrorReportTitle=this._document.createElement("div"),this._saveErrorReportTitle.id=this.myId(t._saveErrorReportTitleId),this._saveErrorReportTitle.innerText=this._saveErrorReportTitleText,this._saveErrorReportTitle.style.fontWeight="bold",this._saveErrorReportPanel.appendChild(this._saveErrorReportTitle),this._saveErrorReportDescription=this._document.createElement("div"),this._saveErrorReportDescription.id=this.myId(t._saveErrorReportDescriptionId),this._saveErrorReportDescription.innerText=this._saveErrorReportDescriptionText,this._saveErrorReportPanel.appendChild(this._saveErrorReportDescription),n(254).AFrameworkApplication.privacyUrl&&(this._saveErrorReportPanel.appendChild(this._document.createElement("br")),this._privacyPolicyLink=this._document.createElement("a"),this._privacyPolicyLink.id=this.myId(t._privacyPolicyLinkId),this._privacyPolicyLink.href="#",this._privacyPolicyLink.innerText=this._privacyPolicyLinkText,this._saveErrorReportPanel.appendChild(this._privacyPolicyLink),p.n.addHandler(this._privacyPolicyLink,"click",this._privacyPolicyLinkClickHandler)),this._textPanel.appendChild(this._saveErrorReportPanel)},t.isCrashingErrorCode=function(e){return e===u.p.unhandledError||e===u.p.applicationCrashed},t._iconId="WACDialogIcon",t._iconCssClass="WACDialogIcon",t._textPanelId="WACDialogTextPanel",t._textPanelCssClass="WACDialogTextPanel",t._textId="WACDialogText",t._checkboxPanelId="WACDialogDontShowPanel",t._checkboxId="WACDialogDontShow",t._dontShowCheckboxDivClass="WACDialogDontShowCheckboxDiv",t._dontShowLabelDivClass="WACDialogDontShowLabelDiv",t._doNotShowLabelId="WACDialogDontShowLabelText",t._iconPanelId="WACDialogIconPanel",t._helpLinkId="WACDialogHelpLink",t._feedbackPanelId="WACDialogFeedbackPanel",t._feedbackLinkId="WACDialogFeedbackLink",t._feedbackDescriptionId="WACDialogFeedbackDescription",t._downloadLinkId="WACDialogDownloadLink",t._extraLinkId="WACDialogExtraLink",t._contentRowClass="WACDialogRow",t._sessionInfoId="WACDialogSessionInfo",t._saveErrorReportPanelId="WACDialogSaveErrorReportPanel",t._saveErrorReportTitleId="WACSaveErrorReportTitle",t._saveErrorReportDescriptionId="WACSaveErrorReportDescription",t._privacyPolicyLinkId="WACSaveErrorReportPrivacy",t._errorIconName="CancelRequest_32x32x32",t._warningIconName="Risks_32x32x32",t._infoIconName="Info_32x32x32",t._questionIconName="OfficeAssistant_32x32x32",t._customerFeedbackPackageName="Common.App.CustomerFeedback",t}(o.h);(0,r.l)(C,"StandardDialog",o.h,[])},function(e,t,n){"use strict";n.d(t,{t:function(){return i}});var i=(0,n(208).y)("ISystemInitiatedFeedback")},,,function(e,t,n){"use strict";n.d(t,{l:function(){return i}});var i=(0,n(208).y)("IUserPrivacySettingsHelper")},,function(e,t,n){var i=n(247),r=n(962);e.exports=function(e,t,n){var o,a;return r&&"function"==typeof(o=t.constructor)&&o!==n&&i(a=o.prototype)&&a!==n.prototype&&r(e,a),e}},function(e,t,n){e.exports=n(472)},,,function(e,t,n){"use strict";n.d(t,{n:function(){return a}});var i=n(658),r=n(556),o=n(208),a=function(){function e(){}return e.getParametersFromUrl=function(t,n){for(var r=new i.w(String),o=n.$$lge();o.$$mn();){var a=o.$$cu(),s=e.getParameterValueDecoded(t,a);s&&r.add(a,s)}return r},e.removeParameter=function(t,n,i){return void 0===i&&(i=!1),e.addOrReplaceParameterValue(t,n,null,i)},e.removeParameters=function(t,n){for(var i=t,r=n.$$lge();r.$$mn();){var o=r.$$cu();i=e.removeParameter(i,o)}return i},e.addOrReplaceParameterValue=function(t,n,i,r){if(void 0===r&&(r=!1),t||(t=""),!n)return t;var o=t,a=!i,s=o.indexOf("?");if(-1===s)return a?t:o+"?"+n+"="+i;var l=o.substr(s+1),u=e.addOrReplaceParameterValueInQueryParams(l,n,i,r);return o=o.replace(l,u)},e.addOrReplaceParameterValueInQueryParams=function(e,t,n,i){void 0===i&&(i=!1);var r=!n;if(!t)return e;for(var o=e,a=e.split("&"),s=t+"=",l=i?s.toLowerCase():s,u=!1,c=0;c<a.length;++c){if(0===(i?a[c].toLowerCase():a[c]).indexOf(l)){o=o.replace(a[c],r?"":s+n),u=!0;break}}return u||r||(e.length>0&&(o+="&"),o+=s+n),o},e.addParameterValue=function(e,t,i){var r=new(n(684).QueryStringBuilder)(e);return r.addParam(t,i),r.toString()},e.getAbsoluteUrl=function(e){var t=new Sys.Net.WebRequest;return t.set_url(e),t.getResolvedUrl()},e.getOrigin=function(t){return e.executeHostPartRegExp(t,0)},e.getHost=function(t){return e.executeHostPartRegExp(t,1)},e.executeHostPartRegExp=function(t,n){if(!t)return"";var i=e._hostPartRegExp.exec(t);return i&&i.length>n?i[n]:""},e.getHostname=function(t){if(!t)return"";var n=e._hostnamePartRegExp.exec(t);return n&&n.length>1?n[1]:""},e.getParameterValueDecoded=function(t,n){var i=e.getParameterValue(t,n);return null==i?i:unescape(i)},e.getParameterValue=function(e,t,n){void 0===n&&(n=!1);var i=n?r.l.toLower(e):e,o=n?r.l.toLower(t):t,a=i.indexOf("&"+o+"=");if(-1===a&&(a=i.indexOf("?"+o+"=")),-1===a)return null;var s=a+(t.length+2),l=e.indexOf("&",s);return-1===l?e.substr(s):e.substring(s,l)},e.removeAllUrlParameters=function(e){if(!e)return"";var t=new RegExp("[?#&]").exec(e);if(!t)return e;var n=t.index;return n?e.substring(0,n):""},e.getFwLinkUrl=function(t){return e.addParameterValue("https://go.microsoft.com/fwlink/","LinkID",t)},e.getFwLinkForUpsellFeatures=function(t){return t?e.getFwLinkUrl("862405")+String.format("&pc={0}",t):e.getFwLinkUrl("522402")},e.getPageName=function(e){if(!e)return"";var t=-1===e.indexOf("#")?e.length:e.indexOf("#"),n=e.lastIndexOf("/",t);if(-1!==n&&n+1===e.indexOf("://")+"://".length)return"";n+=1;var i=e.indexOf("?");if(-1!==(i=i>=t?-1:i)&&n>i)return"";var r=-1===i?t:i;return n>=r?"":e.substring(n,r)},e._hostPartRegExp=new RegExp("^[a-z+.-]+://([^/:]*(:[0-9]{1,5})?)","i"),e._hostnamePartRegExp=new RegExp("^[a-z+.-]+://([^/:]*)","i"),e}();(0,o.l)(a,"UrlUtils",null,[])},,,function(e,t,n){"use strict";n.d(t,{m:function(){return i}});var i=(0,n(208).y)("IViewerChromeItemContainer")},,,,function(e,t,n){"use strict";n.r(t),n.d(t,{AppSwitcher:function(){return A}});var i=n(255),r=n(614),o=n(547),a=n(751),s=n(254),l=n(722),u=n(973),c=n(36),p=n(427),d=n(197),h=n(306),g=n(574),m=n(657),_=n(66),f=n(749),y=n(830),v=n(984),S=n(296),C=n(134),b=n(208),A=function(){function e(){}return e.createSwitcherDropdown=function(t,n,i,r,o){var a=document.createElement("a");a.href="javascript:void(0)",a.tabIndex=0,a.id=t+"-SwitcherLink",a.className="BreadcrumbItem SwitcherDropdown",a.title=r.SwitcherTooltip.toString(),a.setAttribute(C.t.ariaRoleAttribute,C.t.ariaButtonRole);var s=u.createClusteredImage(50,50,"App_Switcher_Waffle_50x50x32","",!0,null);a.appendChild(s),n.appendChild(a),o&&(e.initializeSwitcherActions(),p.s.get_instance().registerHandler(g.d.click,a,e.onSwitcherLauncherClick),f.KeyInputManager.get_instance().registerHandler(g.d.keyDown,a,e.onSwitcherLauncherKeyDown),Array.add(i.breadcrumbItems,a),e.attachSwitcherEvents(i),e.attachSwitcherTileEvents(i))},e.onSwitcherLauncherKeyDown=function(e){return(e.innerEvent.keyCode===_.v.vK_Enter||e.innerEvent.keyCode===_.v.vK_Space)&&(s.AFrameworkApplication.get_theActionManager().processAction(r.Dg,2),!0)},e.onSwitcherLauncherClick=function(e){return s.AFrameworkApplication.get_theActionManager().processAction(r.Dg,2),!0},e.onO365SwitcherReadyHandler=function(t,n,i,r,o){return e._o365LoadingStopwatch&&(e._o365LoadingStopwatch.stop(),e._o365LoadingStopwatch=null),m.FocusManager.usable()&&e.pushScopeAndMoveIntoRegion(),32},e.pushScopeAndMoveIntoRegion=function(){var e=m.FocusManager.instance(),t=e.getRegion(a.AFrame.switcherFocusId);if(t){var n=e.get_currentScope();i.ULS.sendTraceTag(20525598,215,50,"Updating scope from '{0}' to '{1}'",n?n.name:"null",a.AFrame.switcherFocusId),n&&n.name===a.AFrame.switcherFocusId||e.pushScope(a.AFrame.switcherFocusId,!1),t.moveIntoFromTop()}},e.openSwitcher=function(){var t=document.getElementById("sw_bar"),n=document.getElementById("sw_barBG");t.style.display="block",n.style.display="block",Sys.UI.DomElement.containsCssClass(t,"SwitcherLoading")&&!e._o365LoadingStopwatch&&(i.ULS.sendTraceTag(7157248,215,50,"O365 switcher not ready, showing loading text instead"),s.AFrameworkApplication.get_theActionManager().addActionWithFlags(r.xo,v.a,e.onO365SwitcherReadyHandler,64),e._o365LoadingStopwatch=s.AFrameworkApplication.get_activeFrame().get_theStopwatchBuilder().makeAndStartStopwatch("LoadingUIShown","O365SwitcherLoadingUIShown")),Sys.UI.DomElement.removeCssClass(t,"closeAnimation");var a=o.CuiHelper.unifiedHeaderHeight+"px";if(window.setTimeout((function(){t.style.top=a}),0),window.setTimeout((function(){t.style.opacity="1"}),0),m.FocusManager.usable())e.pushScopeAndMoveIntoRegion();else{var l=document.getElementById("sw_Outlook");l&&l.focus()}e._switcherTileMouseUpHandler=e.restoreSwitcherTileVisuals,i.ULS.sendTraceTag(51196383,207,100,"Register MouseUp event. _isMouseUpEventRegistered: {0}",e._isMouseUpEventRegistered),e._isMouseUpEventRegistered||(y.p.get_instance().registerHandler(g.d.mouseUp,document.body,e._switcherTileMouseUpHandler),e._isMouseUpEventRegistered=!0),Sys.UI.DomElement.addCssClass(t,"SwitcherActive")},e.closeSwitcher=function(){var t=document.getElementById("sw_bar"),n=document.getElementById("sw_barBG");Sys.UI.DomElement.containsCssClass(t,"closeAnimation")||Sys.UI.DomElement.addCssClass(t,"closeAnimation"),t.style.top="30px",t.style.opacity="0",n.style.display="none",window.setTimeout((function(){t.style.display="none"}),200),m.FocusManager.instance().popScope(a.AFrame.switcherFocusId),e.unregisterSwitcherMouseUpEvent(),Sys.UI.DomElement.removeCssClass(t,"SwitcherActive")},e.attachSwitcherEvents=function(t){var n=document.getElementById("sw_bar"),i=document.getElementById("sw_barBG");n&&i&&(p.s.get_instance().registerHandlerWithBrowserClickOption(g.d.click,n,e.onSwitcherBackgroundClick,null,!0),p.s.get_instance().registerHandlerWithBrowserClickOption(g.d.click,i,e.onSwitcherBackgroundClick,null,!0),Array.add(t.breadcrumbItems,n),Array.add(t.breadcrumbItems,i))},e.openSwitcherHandler=function(t,n,i,r,o){return s.AFrameworkApplication.get_activeFrame().onBeforeOpenSwitcher()&&e.openSwitcher(),32},e.onSwitcherBackgroundClick=function(e){return s.AFrameworkApplication.get_theActionManager().processAction(r.ni,2),!1},e.closeSwitcherHandler=function(t,n,i,r,o){return s.AFrameworkApplication.get_activeFrame().onBeforeCloseSwitcher()&&e.closeSwitcher(),32},e.onSwitcherTileClick=function(e){return s.AFrameworkApplication.get_theActionManager().processAction(r.SS,2),e.get_caughtElement()&&i.ULS.sendTraceTag(7157252,207,50,"SwitcherTileClick {0}",{id:e.get_caughtElement().id,href:e.get_caughtElement().getAttribute("href")}),!1},e.onSwitcherTileMouseDown=function(e){return e.get_caughtElement()&&Sys.UI.DomElement.addCssClass(e.get_caughtElement(),"tilePressed"),!1},e.restoreSwitcherTileVisuals=function(t){if(!e._switcherTiles)return!1;for(var n=0,i=e._switcherTiles;n<i.length;n++){var r=i[n];Sys.UI.DomElement.removeCssClass(r,"tilePressed")}return!1},e.onSwitcherTileDragStart=function(e){return e.innerEvent.preventDefault(),!1},e.initializeSwitcherActions=function(){e._switcherInitialized||(s.AFrameworkApplication.get_theActionManager().addAction(r.Dg,v.a,e.openSwitcherHandler),s.AFrameworkApplication.get_theActionManager().addAction(r.ni,v.a,e.closeSwitcherHandler),s.AFrameworkApplication.get_theActionManager().addAction(r.SS,v.a,l.ActionManager.doNothingButReportHandler))},e.attachSwitcherTileEvents=function(t){var n=document.getElementById("sw_tileList");if(n){e._switcherTiles=S.s.getChildrenByClassName(n,"swTile"),e._switcherTileLinks=new Array(0);for(var i=0,r=e._switcherTiles;i<r.length;i++){var o=r[i];y.p.get_instance().registerHandler(g.d.mouseDown,o,e.onSwitcherTileMouseDown),c.z.get_instance().registerHandler(g.d.dragStart,o,e.onSwitcherTileDragStart);var a=S.s.getChildByClassName(o,"swTileLink");a&&(p.s.get_instance().registerHandlerWithBrowserClickOption(g.d.click,a,e.onSwitcherTileClick,null,!0),Array.add(e._switcherTileLinks,a))}}},e.unregisterSwitcherMouseUpEvent=function(){e._switcherTileMouseUpHandler&&(i.ULS.sendTraceTag(51196384,207,100,"Unregister MouseUp event. _isMouseUpEventRegistered: {0}",e._isMouseUpEventRegistered),e._isMouseUpEventRegistered&&(y.p.get_instance().unregisterHandler(g.d.mouseUp,document.body,e._switcherTileMouseUpHandler),e._isMouseUpEventRegistered=!1)),e._switcherTileMouseUpHandler=null},e.setupFocusRegionForSwitcher=function(){if(!e._switcherInitialized){var t=m.FocusManager.instance(),n=t.getScope(a.AFrame.switcherFocusId);n.parent=a.AFrame.appFocusId;var i=new d.DOMFocusListing((function(){return document.getElementById("sw_bar")}));i.addValidTag(1),i.rememberFirstElement=!0,i.rememberLastElement=!0,n.bindAction(f.KeyInputManager.hashKey(_.v.vK_Esc,0),r.ni),t.buildRegionWithDelegate((function(){return document.getElementById("sw_bar")}),n,i).looped=!0,e._switcherInitialized=!0}},e.disposeSwitcher=function(){e._switcherTiles&&h.EventHandlerManager.get_instance().unregisterAllHandlersForDOMArray(e._switcherTiles),e._switcherTileLinks&&h.EventHandlerManager.get_instance().unregisterAllHandlersForDOMArray(e._switcherTileLinks),e.unregisterSwitcherMouseUpEvent()},e._switcherTileMouseUpHandler=null,e._isMouseUpEventRegistered=!1,e._switcherTiles=null,e._switcherTileLinks=null,e._switcherInitialized=!1,e._o365LoadingStopwatch=null,e}();(0,b.l)(A,"AppSwitcher",null,[])},,,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=(0,r.y)("IMenuContext"),a=n(351),s=n(267),l=n(254),u=n(648),c=n(574),p=n(66),d=n(749),h=n(733),g=n(327),m=n(154),_=n(425),f=n(134),y=n(268),v=n(836),S=n(345),C=n(209),b=n(513),A=n(946);n.d(t,{Menu:function(){return T}});var T=function(e){function t(t,n,i,r,o,a,s,l){void 0===a&&(a=null),void 0===s&&(s=!1),void 0===l&&(l=1);var u=e.call(this,t,n,i,r)||this;return u._elmInnerDiv=null,u._maxWidth=null,u.isFloatieContextMenuDropDown=!1,u._rootManager=null,u._isComboboxListbox=!1,u.horizontalAlignment=0,u._launched=!1,u._focusedIndex=-1,u._stackIndex=-1,u._maxWidth=o,u._rootManager=a,u._isComboboxListbox=s,u.horizontalAlignment=l,u}return(0,i.t)(t,e),t.prototype.get_horizontalAlignment=function(){return this.horizontalAlignment},t.prototype.refreshInternal=function(){this.get_needsDelayIniting()&&this.doDelayedInit(),this.ensureDOMElementAndEmpty();var t=this.get_root().get_textDirection(),n=this.get_elementInternal();t?1===t&&(A.n.ensureCSSClassOnElement(n,"cui-rtl"),n.style.direction="rtl"):n.style.direction="ltr",b.x(this.get_innerDiv())&&(this.set_innerDiv(A.n.createElement("div")),this.get_innerDiv().className="cui-smenu-inner"),n.setAttribute(f.t.ariaRoleAttribute,this._isComboboxListbox?f.t.ariaListboxRole:f.t.ariaMenuRole),n.appendChild(this.get_innerDiv()),b.t(this._maxWidth)||(n.style.maxWidth=this._maxWidth),this.appendChildrenToElement(this.get_innerDiv()),e.prototype.refreshInternal.call(this)},t.prototype.setParentKeytipsIdsForMenuItems=function(e,t){for(var n=this.get_children().getEnumerator();n.moveNext();)for(var i=n.get_current().get_children().getEnumerator();i.moveNext();){var o=i.get_current();r.r(y.r,o)&&o.get_hasKeytip()&&(o.get_control().parentKeytipsIds=e,o.get_control().parentKeytipsKeys=t)}},t.prototype.attachEvents=function(){d.KeyInputManager.get_instance().registerHandler(c.d.keyDown,this.get_elementInternal(),r.i(this,this.onKeyDown,"onKeyDown")),d.KeyInputManager.get_instance().registerHandler(c.d.keyPress,this.get_elementInternal(),r.i(this,this.onKeyPress,"onKeyPress")),d.KeyInputManager.get_instance().registerHandler(c.d.keyUp,this.get_elementInternal(),r.i(this,this.onKeyUp,"onKeyUp")),u.r.get_instance().registerHandler(this.get_elementInternal(),r.i(this,this.onContextMenu,"onContextMenu")),h.z.get_instance().registerHandler(c.d.pointerOver,this.get_elementInternal(),r.i(this,this.onPointerOver,"onPointerOver")),h.z.get_instance().registerHandler(c.d.pointerOut,this.get_elementInternal(),r.i(this,this.onPointerOut,"onPointerOut"))},t.prototype.get_cssClass=function(){return l.AFrameworkApplication.get_activeFrame()&&l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()?"cui-menu MLRVisualRefresh":"cui-menu"},t.prototype.get_domElementTagName=function(){return"div"},t.prototype.ensureCorrectChildType=function(e){if(!r.r(S.z,e))throw Error.create("Only MenuSection Components can be added to Menu Components.")},t.prototype.get_inKeytipMode=function(){var e=(0,a.e)(C.f,this._rootManager);return!!e&&e.get_inKeytipMode()},t.prototype.get_inMasterKeytipMode=function(){var e=this.get_inKeytipMode();return l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&g.apiExists("inKeytipMode")&&(e=appChrome.api.inKeytipMode()),e},t.prototype.get_innerDiv=function(){return this._elmInnerDiv},t.prototype.set_innerDiv=function(e){return this._elmInnerDiv=e,e},t.prototype.get_stackIndex=function(){return this._stackIndex},t.prototype.set_stackIndex=function(e){return this._stackIndex=e,e},t.prototype.get_selectableItemsCount=function(){for(var e=0,t=this.get_children().getEnumerator();t.moveNext();){e+=t.get_current().get_selectableItemsCount()}return e},t.prototype.get_isComboboxListbox=function(){return this._isComboboxListbox},t.prototype.getSectionSelectableStartIndex=function(e){for(var t=0,n=this.get_children().getEnumerator();n.moveNext();){var i=n.get_current();if(i===e)break;t+=i.get_selectableItemsCount()}return t},t.prototype.pollMenuState=function(){this.pollForStateAndUpdateInternal()},t.prototype.pollForStateAndUpdateInternal=function(){this.set_lastPollTime(new Date),e.prototype.pollForStateAndUpdateInternal.call(this)},t.prototype.onContextMenu=function(e){return!0},t.prototype.onKeyDown=function(e){var t=!1;if(!b.x(e.innerEvent)&&!b.x(e.innerEvent.rawEvent)){var i=e.innerEvent.rawEvent,o=e.innerEvent.keyCode,a=i.shiftKey,s=i.altKey,l=!this.get_root().get_textDirection(),u=!1,c=o===Sys.UI.Key.right&&l||o===Sys.UI.Key.left&&!l,p=o===Sys.UI.Key.left&&l||o===Sys.UI.Key.right&&!l;if(o===Sys.UI.Key.tab&&!a||c)this.focusNext(0),u=!0,t=!0;else if(o===Sys.UI.Key.tab&&a)this.focusNext(1),u=!0,t=!0;else if(o===Sys.UI.Key.down)this.focusNext(6),u=!0,t=!0;else if(o===Sys.UI.Key.up)this.focusNext(5),u=!0,t=!0;else if(p)this.get_stackIndex()>0&&this.get_root().closeMenuStackAtIndex(this.get_stackIndex(),!0,!1),t=!0;else if(o===Sys.UI.Key.esc||s&&!this.get_inMasterKeytipMode()){var d=r.r(n(866).Jewel,this.get_root())&&!this.get_inMasterKeytipMode()?0:this.get_stackIndex();this.get_root().closeMenuStackAtIndex(d,!0,!this.get_inKeytipMode()),t=!0}else(e.innerEvent.ctrlKey||o>=112&&o<=123||o===Sys.UI.Key.space)&&(t=!0);u&&(this.get_elementInternal().tabIndex=-1)}return t},t.prototype.onKeyPress=function(e){return!this.get_inKeytipMode()},t.prototype.onKeyUp=function(e){var t=!1;if(!b.x(e.innerEvent)&&!b.x(e.innerEvent.rawEvent)){var n=e.innerEvent.rawEvent;this.get_inMasterKeytipMode()&&e.innerEvent.keyCode===p.v.vK_Alt&&!n.altKey&&(this.get_root().closeMenuStackAtIndex(0,!0,!0),l.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled()&&g.apiExists("exitKeytipMode")&&appChrome.api.exitKeytipMode(),t=!0)}return t},t.prototype.onPointerOver=function(e){for(var t=this.get_stackIndex();t>0;){var i=this.get_root().get_menuLauncherStack()[t];i.isStandardMenuItem()&&(A.n.ensureCSSClassOnElement(i.get_launcher(),n(488).MenuLauncher.menuDroppedClassName),i.set_elmHadFocus(i.get_focusableElement())),t--}return!1},t.prototype.onPointerOut=function(e){if(!m.g.isPointInElement(this.get_elementInternal(),e.get_clientPoint()))if(this.get_stackIndex()===this.get_root().get_menuStackDepth()-1)this.setFocus(e.get_inputSource());else{var t=this.get_root().get_menuLauncherStack()[this.get_stackIndex()+1];t.get_elmHadFocus()!==t.get_launcher()&&(t.set_elmHadFocus(this.get_elementInternal()),this.resetFocusedIndex())}return!1},t.prototype.updateFocusedIndex=function(e){for(var t=0,n=this.get_children().getEnumerator();n.moveNext();){if(n.get_current().updateFocusedIndex(e))return this._focusedIndex=t,!0;t++}return!1},t.prototype.setFocus=function(e){if(1===e)this.focusNext(0);else{if(this.get_elementInternal().tabIndex=0,_.y.browserSupportsSetActive(this.get_elementInternal()))try{this.get_elementInternal().setActive()}catch(e){this.get_elementInternal().focus()}else this.get_elementInternal().focus();this.resetFocusedIndex()}},t.prototype.resetFocusedIndex=function(){if(this.get_children().get_count()){this._focusedIndex=-1;for(var e=this.get_children().getEnumerator();e.moveNext();){e.get_current().resetFocusedIndex()}}},t.prototype.moveFocusToParentOnNavigationEnd=function(){if(r.r(y.r,this.get_parent())){var e=this.get_parent().get_control();if(e)if(e.get_stateProperties().TakeFocusOnMenuNavigationEnd)return e.setFocusOnControl(),!0}return!1},t.prototype.focusNext=function(e){var t=this.get_children().get_count();if(t<=0)return!1;var n=!e||4===e||6===e;return this.moveFocusFromIndex(this._focusedIndex,e)||this.moveFocusToParentOnNavigationEnd()||this.moveFocusFromIndex(n?0:t-1,e)},t.prototype.moveFocusFromIndex=function(e,t){var n=!t||4===t||6===t;-1===e&&(e=n?0:this.get_children().get_count()-1);for(var i=e,r=this.get_children().getEnumeratorAtPos(i);n?r.moveNext():r.movePrevious();){if(r.get_current().focusNext(t))return this._focusedIndex=i,!0;i+=n?1:-1}return!1},t.prototype.hasItems=function(){for(var e=this.get_children().getEnumerator();e.moveNext();)for(var t=e.get_current().get_children().getEnumerator();t.moveNext();){if(t.get_current().get_visible())return!0}return!1},t.prototype.get_menuLauncherChildren=function(){for(var e=new v.y,t=this.get_children().getEnumerator();t.moveNext();)for(var i=t.get_current().get_children().getEnumerator();i.moveNext();){var o=i.get_current();if(r.r(y.r,o)){var a=o;a.get_visible()&&r.r(n(488).MenuLauncher,a.get_control())&&e.add(a.get_control())}}return e},t.prototype.get_visibleInDOM=function(){return this._launched},t.prototype.get_launched=function(){return this._launched},t.prototype.set_launched=function(e){return this._launched=e,e},t.prototype.dispose=function(){var t=this.get_elementInternal();b.x(t)||A.n.unregisterAllHandlers(t),e.prototype.dispose.call(this),this._elmInnerDiv=null},t.prototype.clone=function(e){for(var t=e.createMenu(this.get_id(),this.get_title(),this.get_description(),this._maxWidth,this._isComboboxListbox),n=this.get_children().getEnumerator();n.moveNext();){var i=n.get_current();t.addChild(i.clone(e))}return t},t.menuBorderPx=1,t}(s.s);(0,r.l)(T,"Menu",s.s,[o])},,function(e,t,n){"use strict";n.d(t,{j:function(){return o}});var i=n(208),r=n(372),o=function(){function e(){this._queue=[]}return e.prototype.get_isEmpty=function(){return!this._queue.length},e.prototype.get_length=function(){return this._queue.length},e.prototype.peekAt=function(e){var t=this._queue[e];return t?t.get_data():null},e.prototype.removeAt=function(e){Array.removeAt(this._queue,e)},e.prototype.enqueue=function(e,t){var n=0;if(!this.get_isEmpty()){var i=0,o=this._queue.length-1,a=void 0,s=void 0;do{if(a=Math.ceil((i+o)/2),(s=this._queue[a]).get_priority()<e)i=a+1;else{if(!(s.get_priority()>e))break;o=a-1}}while(i<=o);for(n=a;n<=o&&this._queue[n].get_priority()<=e;)n++}Array.insert(this._queue,n,new r.k(e,t))},e.prototype.dequeue=function(){var e=this.peekAt(0);return e?(this.removeAt(0),e):null},e.prototype.test=function(){for(var t=["alpha","zed"],n=new e,i=0;i<100;i++)n.enqueue(Math.floor(20*Math.random()),String.format("{0} [{1}]",t[i%2],i));for(;;){n._queue[0];if(!n.dequeue())break}},e.prototype.dump=function(){if(this._queue.length)for(var e=0;e<this._queue.length;e++)this._queue[e];else;},e.compare=function(e,t){if(i.r(r.k,e)&&i.r(r.k,t)){var n=e,o=t;return n.get_priority()<o.get_priority()?-1:n.get_priority()===o.get_priority()?0:1}throw Error.create("Invalid parameter passed to Sort.Compare")},e}();(0,i.l)(o,"PriorityQueue",null,[])},function(e,t,n){"use strict";var i=n(536),r=n(397),o=n(208),a=n(965),s=(0,o.y)("IBusinessBarEntryFactory"),l=n(614),u=n(254),c=n(722),p=n(18),d=n(478),h=n(841),g=n(101),m=n(235),_=n(984),f=5e3,y=function(){function e(e,t,n,i){var r=this;this._signoutResponse=null,this._businessBarEntry=null,this._dialog=null,this._task=null,this._showCloseButton=!1,this._businessBar=null,this._businessBarEntryFactory=null,this._signoutResponse=e,this._showCloseButton=i,this._signoutResponse.get_isAuthenticated()&&(this._task=new d.c(3,2,f,o.i(this,this.authenticationCheckTask,"authenticationCheckTask"),2),u.AFrameworkApplication.get_theTaskManager().addTask(this._task),this.registerActions(t,n)),this._signoutResponse.add_authenticationLost((function(e,t){r.onAuthenticationLost()})),this._signoutResponse.add_authenticationRestored((function(e,t){r.onAuthenticationRestored()}))}return e.prototype.get_businessBar=function(){return this._businessBar||(this._businessBar=m.w.get_instance().tryResolve(a.c))},e.prototype.get_businessBarEntryFactory=function(){return this._businessBarEntryFactory||(this._businessBarEntryFactory=m.w.get_instance().tryResolve(s))},e.prototype.verifyAuthentication=function(){this._signoutResponse.get_isAuthenticated()||this.onAuthenticationLost()},e.prototype.registerActions=function(e,t){var n=u.AFrameworkApplication.get_theActionManager();n.addActionWithFlags(l.QJ,_.a,e,96),n.addActionWithFlags(l.CS,_.a,t,96),n.addAction(l.OY,_.a,c.ActionManager.doNothingHandler),n.addAction(l.AO,_.a,c.ActionManager.doNothingHandler),n.addAction(l.mu,_.a,c.ActionManager.doNothingHandler)},e.prototype.onAuthenticationLost=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage),u.AFrameworkApplication.get_theActionManager().processAction(l.QJ,2)},e.prototype.onAuthenticationRestored=function(){this.teardownUI(),u.AFrameworkApplication.get_theActionManager().processAction(l.CS,2)},e.prototype.authenticationCheckTask=function(e){this._signoutResponse.authenticationCheck()},e.prototype.teardownUI=function(){this._dialog&&(this._dialog.hide(),this._dialog.dispose(),this._dialog=null),this._businessBarEntry&&this.get_businessBar()&&(u.AFrameworkApplication.isShuttingDown||this.get_businessBar().removeEntry(this._businessBarEntry),this._businessBarEntry.dispose(),this._businessBarEntry=null)},e.prototype.showDialog=function(e){g.b(this._dialog),this._dialog=new h.StandardDialog,this._showCloseButton||(this._dialog.set_hasCloseGlyph(!1),this._dialog.set_buttonsOption(0)),this._dialog.setButtonText(1,CommonUIStrings.l_SignIn),this._dialog.showWarning(CommonUIStrings.l_DefaultDialogTitle,e,o.i(this,this.dialogHandler,"dialogHandler"))},e.prototype.dialogHandler=function(e,t){1===e?(p.t.performSignIn(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),u.AFrameworkApplication.get_theActionManager().processAction(l.mu,2)):(this.showBusinessBar(),u.AFrameworkApplication.get_theActionManager().processAction(l.AO,2))},e.prototype.showBusinessBar=function(){this.get_businessBar()&&this.get_businessBarEntryFactory()&&(this._businessBarEntry=this.get_businessBarEntryFactory().create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this._businessBarEntry.set_closeable(!0),this._businessBarEntry.addButton(CommonUIStrings.l_SignIn,e.businessBarButtonHandler,""),this._businessBarEntry.set_closeHandler(o.i(this,this.businessBarEntryCloseHandler,"businessBarEntryCloseHandler")),this.get_businessBar().addEntry(this._businessBarEntry,!1))},e.prototype.businessBarEntryCloseHandler=function(e){this.disableTask(),u.AFrameworkApplication.get_theActionManager().processAction(l.OY,2)},e.prototype.disableTask=function(){this._task&&(u.AFrameworkApplication.get_theTaskManager().deleteTask(this._task),this._task=null)},e.prototype.dispose=function(){this._businessBarEntry=null,this._dialog=null,this._task=null},e.businessBarButtonHandler=function(e){p.t.performSignIn(),u.AFrameworkApplication.get_theActionManager().processAction(l.mu,2)},e}();(0,o.l)(y,"SignOutResponseUI",null,[Sys.IDisposable]);var v=n(564);n.d(t,{p:function(){return S}});var S=function(){function e(){}return e.prototype.get_name=function(){return"Common.App.UI"},e.prototype.configure=function(e){},e.prototype.init=function(){},e.prototype.dispose=function(){g.b(e._signOutResponse),e._signOutResponse=null},e.main=function(){v.o.get_instance().registerPackage(new e)},e.initSignOutResponseUI=function(t,n,i,r){e.shouldUseSignoutResponseUI(t)&&(e._signOutResponse=new y(p.t.get_instance(),n,i,r))},e.shouldUseSignoutResponseUI=function(e){return u.AFrameworkApplication.needsSignOutChecking&&!u.AFrameworkApplication.get_isEmbedded()},e._signOutResponse=null,e}();(0,o.l)(S,"CommonAppUIPackage",null,[i.u,r.s])},function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var i=(0,n(208).y)("IOperation")},function(e,t,n){"use strict";n.r(t),n.d(t,{Jewel:function(){return g}});var i=n(508),r=n(208),o=n(700),a=n(255),s=n(154),l=n(268),u=n(509),c=n(748),p=n(395),d=n(513),h=n(946),g=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i._menuLauncher=null,i._mainJewelMenuAlreadyCreated=!1,i._flyoutHeight=0,i._isNoIFrameApp=!1,i._appContainer=null,i}return(0,i.t)(t,e),t.prototype.get_jewelProperties=function(){return e.prototype.get_properties.call(this)},t.prototype.refreshInternal=function(){e.prototype.refreshInternal.call(this),d.x(this.get_elementInternal())&&this.ensureDOMElement(),this.set_elementInternal(h.n.removeChildNodes(this.get_elementInternal())),this.appendChildrenToElement(this.get_elementInternal()),this.set_dirty(!1)},t.prototype.ensureCorrectChildType=function(e){if(!r.r(l.r,e))throw Error.create('The child "'+e.get_id()+'" is not a ControlComponent');if(!r.r(n(618).JewelMenuLauncher,e.get_control()))throw Error.create("Only children of type JewelMenuLauncher can be added to a Jewel")},t.prototype.get_cssClass=function(){return"cui-jewel "+e.prototype.get_cssClass.call(this)},t.prototype.get_rootType=function(){return 4},t.prototype.get_visibleInDOM=function(){return!0},t.prototype.configurePropertiesForNoIFrameApp=function(e,t){this._isNoIFrameApp=!0,this._flyoutHeight=e,this._appContainer=t},t.prototype.createMenu=function(e,t,n,i,r,o){return void 0===r&&(r=!1),void 0===o&&(o=1),this._mainJewelMenuAlreadyCreated?new c.m(this,e,t,n,i,this.get_rootManager()):(this._mainJewelMenuAlreadyCreated=!0,new u.y(this,e,t,n,i,this.get_rootManager()))},t.prototype.setFlyoutCoordinates=function(e,t,n,i){if(d.x(e)||d.x(t))return null;var r=0,o=0,a=0,l=!this.get_root().get_textDirection(),u=1===n;if(e.style.maxHeight="none",e.style.overflowY="auto",this._isNoIFrameApp){var c=s.g.getElementBounds(this._appContainer);e.style.bottom="",e.style.overflowY="auto",e.style.top=c.y-1+"px",a=this.get_root().get_textDirection()?window.document.body.offsetWidth-(c.x+c.width):c.x-1}if(u){var h=this.get_menuLauncherStack()[0].get_menu().get_elementInternal().offsetWidth;l?r=h+a:o=h+a}else l?r=0+a:o=0+a;if(this._isNoIFrameApp){var g=window.document.body.offsetHeight-2;g>this._flyoutHeight&&(g=this._flyoutHeight),e.style.height=g+"px"}var m=(l?r:o)+"px";return l?(e.style.left=m,e.style.right="auto"):(e.style.right=m,e.style.left="auto"),this.get_menuStackDepth()&&(e.style.maxWidth="600px",e.style.width="calc(100% - "+m+")"),new p.w},t.prototype.launchSubMenu=function(e,t){var i=t||this.get_jewelProperties().DefaultSelection,o=null;if(i&&(o=this.get_controls()[i]),!o){i=null;var s=this.get_controls();for(var l in s){var u={key:l,value:s[l]};if(r.r(n(488).MenuLauncher,u.value)&&!r.r(n(618).JewelMenuLauncher,u.value)){var c=u.value,p=c.get_controlProperties();if(c.get_enabled()&&(h.n.isTrue(p.PopulateDynamically)||c.get_menu().hasItems())){i=c.get_id();break}}}if(!i)return;o=this.get_controls()[i]}o?o.launchMenu(e):a.ULS.sendTraceTag(4329748,202,10,"Tried to launch invalid submenu with non-null ID {0}",{ControlID:i})},t.prototype.get_jewelBuilder=function(){return this.get_builder()},t.prototype.set_jewelBuilder=function(e){return this.set_builder(e),e},t.prototype.get_jewelMenuLauncher=function(){return this._menuLauncher},t.prototype.set_jewelMenuLauncher=function(e){return this._menuLauncher=e,e},t.prototype.focus=function(){this._menuLauncher.setFocusOnControl()},t}(o.z);(0,r.l)(g,"Jewel",o.z,[])},function(e,t,n){"use strict";n.d(t,{w:function(){return r},d:function(){return o},t:function(){return a},b:function(){return s}});var i=n(208),r=function(e){return JSON.stringify(e)},o=function(e){return JSON.parse(e)},a=function(e,t,n){try{n.val=s(t)}catch(t){return n.val=i.c(e),!1}return!0},s=function(e){return JSON.parse(e)}},,function(e,t,n){var i=n(767),r=Math.max,o=Math.min;e.exports=function(e,t){var n=i(e);return n<0?r(n+t,0):o(n,t)}},function(e,t,n){"use strict";n.d(t,{v:function(){return r}});var i=n(208),r={$$:function(e){var t="IEqualityComparer$1$"+e.getName();return(0,i.g)(t)}}},,function(e,t,n){"use strict";n.d(t,{f:function(){return r}});var i=n(208),r=function(){return function(){this.CommandLocation=0,this.CommandTabName=null,this.InvocationMethod=0}}();(0,i.l)(r,"CommandSqmInfo",null,[])},function(e,t,n){"use strict";n.d(t,{p:function(){return r}});var i=n(208),r=function(){function e(){}return e.unknown=0,e.unknownCause=0,e.unknownResolution=0,e.unhandledError=1,e.cannotOpenFile=2,e.conversionFailed=3,e.openInClientFailed=4,e.openInClientOffice14Required=5,e.openFileNetworkProblem=6,e.networkProblem=7,e.conversionFileExists=8,e.openInClientWithC2RFailed=9,e.jsonErrorResponse=12,e.failedToContactServer=13,e.openInClientSecondaryFailed=14,e.downloadFailed=15,e.configError=16,e.saveToCloudStorageUploadFailed_Deprecated=17,e.saveToCloudStorageReturnedNotJSON_Deprecated=18,e.fullAppSettingDownloadFailed=19,e.unexpectedPostMessage=20,e.applicationCrashed=21,e.roamingControlMissing=22,e.commentNewSelectSomething=23,e.commentNewInvalidContent=24,e.renameFileFailed_Deprecated=25,e.saveAsToHostFailed=26,e.launchAddInCommandsFailed=27,e.sessionAccessTokenExpired=28,e.downloadAccessiblePdfViewFailed=29,e.feedbackPackageLoadFailed=30,e.learningToolsLaunchFailed=31,e.saveAsFileSizeTooLarge=32,e.openInClientFailedDelayed=33,e.oneDriveFilePickerNotJSON=34,e.saveAsToOneDriveFailed_FilePicker=35,e.saveAsToSharePointFailed_Error=36,e.saveAsToSharePointFailed_Warning=37,e.saveAsToSharePointFailed_Unspecified=38,e.dictation_Error=39,e.unsupportedBrowserWarning=40,e.unsupportedBrowserCrashed=41,e.noGraphTransactionCrashSaved=42,e}();(0,i.l)(r,"CommonErrorCode",null,[])},function(e,t,n){"use strict";var i=n(140),r=n(393);e.exports=i("Set",(function(e){return function(){return e(this,arguments.length?arguments[0]:void 0)}}),r)},function(e,t,n){var i=n(531),r=n(247),o=i.document,a=r(o)&&r(o.createElement);e.exports=function(e){return a?o.createElement(e):{}}},function(e,t,n){"use strict";n.r(t);var i=n(478),r=n(208),o=function(){function e(e,t,n,i,r){this._timeRemaining=0,this._animationEvent=null,this._element=null,this._beforeHandler=null,this._afterHandler=null,this.set_timeRemaining(e),this.set_animationEvent(t),this.set_element(n),this.set_beforeHandler(i),this.set_afterHandler(r)}return e.prototype.get_timeRemaining=function(){return this._timeRemaining},e.prototype.set_timeRemaining=function(e){return this._timeRemaining=e,e},e.prototype.get_animationEvent=function(){return this._animationEvent},e.prototype.set_animationEvent=function(e){return this._animationEvent=e,e},e.prototype.get_element=function(){return this._element?this._element:null},e.prototype.set_element=function(e){return this._element=e,e},e.prototype.get_beforeHandler=function(){return this._beforeHandler},e.prototype.set_beforeHandler=function(e){return this._beforeHandler=e,e},e.prototype.get_afterHandler=function(){return this._afterHandler},e.prototype.set_afterHandler=function(e){return this._afterHandler=e,e},e.create=function(t,n,i,r,o){return new e(t,n,i,r,o)},e}();(0,r.l)(o,"AnimationHandlerArgs",null,[]);var a=function(){function e(e){this._runTime=0,this._runTime=e}return e.prototype.get_runTime=function(){return this._runTime},e}();(0,r.l)(a,"AnimationResultProperties",null,[]);var s=function(){function e(e,t,n,i,r,o,a){this._fps=0,this._min=0,this._max=0,this._stdDev=0,this._startTime=0,this._endTime=0,this._elementIds=null,this._fps=e,this._min=t,this._max=n,this._stdDev=i,this._startTime=r,this._endTime=o,this._elementIds=a}return e.prototype.get_fps=function(){return this._fps},e.prototype.get_min=function(){return this._min},e.prototype.get_max=function(){return this._max},e.prototype.get_stdDev=function(){return this._stdDev},e.prototype.get_startTime=function(){return this._startTime},e.prototype.get_endTime=function(){return this._endTime},e.prototype.get_elementIds=function(){return this._elementIds},e}();(0,r.l)(s,"AnimationStat",null,[]);var l,u=function(){function e(){}return e.get_animationAliases=function(){return e._animationAliases},e.getAnimationToRun=function(t){return e._animationMapping[t]},e.getAnimationRunTime=function(t){var n=e.getAnimationToRun(t);return e._animationTimes[n.toString()]},e._animationMapping={"SHARED_QUICKESTCLASS&ONSHOW":1,"SHARED_QUICKCLASS&ONMOVE":6,"SHARED_QUICKCLASS&ONRESIZE":7,"SHARED_QUICKCLASS&ONOPACITYCHANGED":8,"SHARED_QUICKCLASS&ONSHOW":9,"SHARED_QUICKCLASS&ONHIDE":10,"SHARED_BASICCLASS&ONMOVE":11,"SHARED_BASICCLASS&ONRESIZE":12,"SHARED_BASICCLASS&ONOPACITYCHANGED":13,"SHARED_BASICCLASS&ONSHOW":14,"SHARED_BASICCLASS&ONHIDE":15,"SHARED_BASICCLASS&ONSCROLL":16,"ONENOTE_BASICCLASS&ONMOVE":22,"ONENOTE_BASICCLASS&ONRESIZE":23,"ONENOTE_BASICCLASS&ONOPACITYCHANGED":24,"ONENOTE_BASICCLASS&ONSHOW":25,"ONENOTE_BASICCLASS&ONHIDE":26,"SHARED_SLOWCLASS&ONMOVE":17,"SHARED_SLOWCLASS&ONRESIZE":18,"SHARED_SLOWCLASS&ONOPACITYCHANGED":19,"SHARED_SLOWCLASS&ONSHOW":20,"SHARED_INSTANTCLASS&ONOPACITYCHANGED":0,"UEX_UPPERCONTEXTUALTABDRAMATIC&ONSHOW":29,"CXE_UPPERCONTEXTUALTABVISUALREFRESH&ONSHOW":30,"CXE_UPPERCONTEXTUALTABVISUALREFRESH&ONHIDE":31,"UEX_CONTEXTUALTABMOVEMENT&ONMOVE":28,"MSOHELP_FOLLOWTHEDOTCLASS&ONMOVE":35,"MSOHELP_FOLLOWTHEDOTCLASS&ONOPACITYCHANGED":13,"MSOHELP_FOLLOWTHEDOTCLASS&ONHIDE":15,"MSOHELP_SPOTLIGHTCLASS&ONOPACITYCHANGED":13,"MSOHELP_SPOTLIGHTCLASS&ONSHOW":14,"MSOHELP_SPOTLIGHTCLASS&ONHIDE":15,"WAC_DELAYSHOWCLASS&ONSHOW":36,"WAC_DELAYMOVECLASS&ONMOVE":37,"WAC_RIBBONCLASS&ONMOVE":38,"WAC_RIBBONCLASS&ONSHOW":39,"WAC_RIBBONCLASS&ONHIDE":40,"UEX_WINDOWTRANSITION&ONMOVE":11,"UEX_WINDOWTRANSITION&ONRESIZE":12,"UEX_WINDOWTRANSITION&ONOPACITYCHANGED":13,"UEX_WINDOWTRANSITION&ONSHOW":14,"UEX_STEALTHUITRANSITION&ONMOVE":6,"UEX_STEALTHUITRANSITION&ONRESIZE":7,"VISIO_PAGEENTERING&ONMOVE":11,"VISIO_PAGEENTERING&ONOPACITYCHANGED":13,"VISIO_PAGEENTERING&ONRESIZE":12,"VISIO_PAGEENTERING&ONSHOW":14,"VISIO_PAGEENTERING&ONHIDE":15,"VISIO_PAGEENTERING&ONSCROLL":16,"VISIO_PAGEEXITING&ONRESIZE":12,"VISIO_PAGEEXITING&ONSHOW":14,"VISIO_PAGEEXITING&ONHIDE":15,"VISIO_PAGEEXITING&ONSCROLL":16},e._animationAliases={},e._animationTimes={0:0,1:.05,2:.167,3:.167,4:.167,5:.167,6:.1,7:.1,8:.1,9:.1,10:.1,11:.267,12:.267,13:.267,14:.267,15:.267,16:.267,17:.75,18:.75,19:.75,20:.75,21:1,22:.367,23:.367,24:.367,25:.367,26:.367,27:.05,28:.433,29:.1,30:.35,31:.267,32:.267,33:.3,34:.3,35:.75,36:.5,37:.267,38:.267,39:.267,40:.267},e}();(0,r.l)(u,"WacAirSpaceAnimationClasses",null,[]),function(e){e[e.onAlways=1]="onAlways",e[e.onHide=2]="onHide",e[e.onMove=3]="onMove",e[e.onOpacityChanged=4]="onOpacityChanged",e[e.onResize=5]="onResize",e[e.onShow=6]="onShow",e[e.onScroll=7]="onScroll",e[e.onRotate=8]="onRotate"}(l||(l={})),(0,r.h)("AnimationType",l);var c=function(){function e(e){this._args=null,this._numberOfAnimationsRunning=0,this._afterAnimationHandlerArgObjects=null,this._afterAnimationHandlerIndex=0,this._args=e,this._numberOfAnimationsRunning=1,this._afterAnimationHandlerArgObjects=[],this._afterAnimationHandlerIndex=0}return e.prototype.get_animationArgs=function(){return this._args},e.prototype.set_animationArgs=function(e){return this._args=e,e},e.prototype.get_numberOfAnimationsRunning=function(){return this._numberOfAnimationsRunning},e.prototype.increaseAnimationCount=function(){this._numberOfAnimationsRunning++},e.prototype.decreaseAnimationCount=function(){this._numberOfAnimationsRunning--},e.prototype.delayAfterAnimationHandler=function(e){this._afterAnimationHandlerArgObjects[this._afterAnimationHandlerIndex]=e,this._afterAnimationHandlerIndex++},e.prototype.callDelayedAfterAnimationHandlers=function(){for(var e=0;e<this._afterAnimationHandlerIndex;e++){var t=this._afterAnimationHandlerArgObjects[e];t.get_afterHandler()(t)}},e}();(0,r.l)(c,"CurrentAnimation",null,[]);var p=function(){function e(){this._animatingDomElements={}}return e.prototype.animate=function(t){var i,o=t.get_element(),s=t.get_animationEvent(),l=e.getAnimationClassAndEvent(t),p=u.getAnimationToRun(l),d=this.createAnimationState(s),h=new WacAnimation.Object(p,0,o,d,r.i(this,this.defaultAfterAnimationHandler,"defaultAfterAnimationHandler"),t),g=e.getAnimationRunTime(l);return n(254).AFrameworkApplication.get_theTaskManager().pauseForAnimation(g),t.get_beforeHandler()&&t.get_beforeHandler()(t),this._animatingDomElements[o.id]?((i=this._animatingDomElements[o.id]).increaseAnimationCount(),i.set_animationArgs(t)):(i=new c(t),this._animatingDomElements[o.id]=i),d?h.RunAnimation():this.defaultAfterAnimationHandler(t),new a(g)},e.prototype.createAnimationState=function(e){var t=!1,n=new WacAnimation.State;return isNaN(e.get_finalX())||e.get_isXConstant()||(n.SetAttribute(1,e.get_finalX()),n.SetAnimateRight(e.get_useRightAttributeForX()),t=!0),isNaN(e.get_finalY())||e.get_isYConstant()||(n.SetAttribute(2,e.get_finalY()),t=!0),isNaN(e.get_finalHeight())||e.get_isHeightConstant()||(n.SetAttribute(3,e.get_finalHeight()),t=!0),isNaN(e.get_finalWidth())||e.get_isWidthConstant()||(n.SetAttribute(4,e.get_finalWidth()),t=!0),isNaN(e.get_finalOpacity())||e.get_isOpacityConstant()||(n.SetAttribute(5,e.get_finalOpacity()),t=!0),isNaN(e.get_finalScrollTop())||e.get_isScrollTopConstant()||(n.SetAttribute(6,e.get_finalScrollTop()),t=!0),isNaN(e.get_finalScrollLeft())||e.get_isScrollLeftConstant()||(n.SetAttribute(7,e.get_finalScrollLeft()),t=!0),isNaN(e.get_finalRotateZ())||e.get_isRotateZConstant()||(n.SetAttribute(8,e.get_finalRotateZ()),t=!0),t?n:null},e.prototype.defaultAfterAnimationHandler=function(e){if(!n(254).AFrameworkApplication.isShuttingDown){var t=e.get_element();if(document.URL.endsWith("&WacAirReport=1")&&n(892).generateAnimationStatsDiv(),this._animatingDomElements[t.id]){var i=this._animatingDomElements[t.id];i.decreaseAnimationCount(),i.get_numberOfAnimationsRunning()<0||(e.get_afterHandler()&&i.delayAfterAnimationHandler(e),i.get_numberOfAnimationsRunning()||(i.callDelayedAfterAnimationHandlers(),delete this._animatingDomElements[t.id]))}else e.get_afterHandler()&&e.get_afterHandler()(e)}},e.getAnimationRunTime=function(e){var t=u.getAnimationRunTime(e);return parseInt((1e3*t).toString())},e.getAnimationClassAndEvent=function(t){var i=t.get_element(),r=t.get_animationEvent();if(!i||!i.className)return"";for(var o=null,a=0,s=i.className.split(" ");a<s.length;a++){var u=s[a];if(u.startsWith(n(876).WacAirSpace.animationClassPrefix)){o=u.substr(n(876).WacAirSpace.animationClassPrefix.length);break}}if(!(o=e.resolveAnimationClass(o))||""===o.trim())return"";var c=l[r.type];return o.toUpperCase()+"&"+c.toUpperCase()},e.resolveAnimationClass=function(e){if(!e)return null;for(var t=e.toUpperCase(),n=0;n<10;n++){var i=u.get_animationAliases()[t];if(!i)return t;t=i}return null},e}();(0,r.l)(p,"WacAirSpaceEngine",null,[]);var d=n(773),h=n(425),g=n(460),m=n(296);n.d(t,{WacAirSpace:function(){return _}});var _=function(){function e(){}return e.registerDomEvents=function(){$addHandler(window,"resize",e.onResize)},e.onResize=function(t){e.temporarilyDisableAnimation(500)},e.temporarilyDisableAnimation=function(t){if(!e.isAnimationTurnedOff()&&n(254).AFrameworkApplication.get_theTaskManager()){e.toggleAnimation();var r=new i.c(4,1,t,e.toggleAnimationTask,18);n(254).AFrameworkApplication.get_theTaskManager().addTask(r)}},e.toggleAnimationTask=function(t){e.toggleAnimation()},e.animate=function(t,i,r){if(e.isAnimationTurnedOff())return e.moveElementWithoutAnimation(t,i,r),new a(0);try{if(!t.element)return null;if(!t.element.id||""===t.element.id.trim())return e.moveElementWithoutAnimation(t,i,r),new a(0);new WacAnimation.State;var s=o.create(-1,t,t.element,i,r);return e.initWacAirSpaceEngine(),n(254).AFrameworkApplication.theWacAirSpaceEngine.animate(s)}catch(n){return e.moveElementWithoutAnimation(t,i,r),new a(0)}},e.isAnimationTurnedOff=function(){return!!h.y.get_isIPad()||!e._isAnimationEnabled},e.toggleAnimation=function(){e._isAnimationEnabled=!e._isAnimationEnabled},e.initWacAirSpaceEngine=function(){n(254).AFrameworkApplication.theWacAirSpaceEngine||(n(254).AFrameworkApplication.theWacAirSpaceEngine=new p)},e.moveElementWithoutAnimation=function(t,n,i){var r=o.create(0,t,t.element,n,i);n&&n(r),e.setX(t),e.setY(t),e.setHeight(t),e.setWidth(t),e.setOpacity(t),e.setScroll(t),e.setRotateZ(t),i&&i(r)},e.cloneElement=function(t,n,i){if(!t||!t.parentNode)return null;if(t.id&&-1!==t.id.indexOf("_clone"))return t;var r=document.getElementById(t.id+"_clone");if(!r){r=document.createElement("div");var o=t.style,a=e.isCssSizeInPixels(o.top)?m.s.parseCssSizeDouble(o.top):t.offsetTop,s=t.parentNode;s.offsetTop>a&&(a=s.offsetTop);var l,u=e.isCssSizeInPixels(o.left)?m.s.parseCssSizeDouble(o.left):t.offsetLeft;l=e.isCssSizeInPixels(o.width)?m.s.parseCssSizeDouble(o.width):t.offsetWidth?t.offsetWidth:s.offsetWidth;var c;c=e.isCssSizeInPixels(o.height)?m.s.parseCssSizeDouble(o.height):t.offsetHeight?t.offsetHeight:s.offsetHeight;var p=d.o.getCurrentStyle(t).zIndex,g=r.style;g.position="absolute",g.display=o.display,g.top=a+"px",g.left=u+"px",null!=l&&(g.width=l+"px"),null!=c&&(g.height=c+"px"),g.zIndex=p,m.s.copyChildNodes(t,r),r.className=t.className+" AirspaceClone",r.id=t.id+"_clone",n&&h.y.setOpacity(t,0),i?s.insertBefore(r,t):s.appendChild(r)}return r},e.setContextVariable=function(e,t){if(e&&""!==e.trim())try{(new WacAnimation.ContextVariableManager).SetContextVariable(e.toUpperCase(),t)}catch(e){throw e}},e.setAnimationClass=function(t,n){t&&(Sys.UI.DomElement.addCssClass(t,e.animationClassPrefix+n),e.assignUniqueId(t))},e.removeAnimationClass=function(t,n){Sys.UI.DomElement.removeCssClass(t,e.animationClassPrefix+n)},e.assignUniqueId=function(e){e.id&&""!==e.id.trim()||(e.id="WacAirSpace"+g.l.create())},e.getAnimationStats=function(){for(var e=WacAnimation.Telemetry.GetRecentAnimationStats(),t=new Array(e.length),n=0;n<e.length;n++){var i=e[n];if(i){var r=i[1],o=i[2],a=i[3],l=i[5],u=i[9],c=i[10],p=i[11];t[n]=new s(r,o,a,l,u,c,p)}}return t},e.setX=function(e){isNaN(e.get_finalX())||(e.get_useRightAttributeForX()?e.get_useRelativePositioning()?e.element.style.marginRight=e.get_finalX()+"px":e.element.style.right=e.get_finalX()+"px":e.get_useRelativePositioning()?e.element.style.marginLeft=e.get_finalX()+"px":e.element.style.left=e.get_finalX()+"px")},e.setY=function(e){isNaN(e.get_finalY())||(e.get_useRelativePositioning()?e.element.style.marginTop=e.get_finalY()+"px":e.element.style.top=e.get_finalY()+"px")},e.setHeight=function(e){isNaN(e.get_finalHeight())||(e.element.style.height=e.get_finalHeight()+"px")},e.setWidth=function(e){isNaN(e.get_finalWidth())||(e.element.style.width=e.get_finalWidth()+"px")},e.setOpacity=function(e){isNaN(e.get_finalOpacity())||h.y.setOpacity(e.element,e.get_finalOpacity())},e.setScroll=function(e){isNaN(e.get_finalScrollTop())&&isNaN(e.get_finalScrollLeft())||(isNaN(e.get_finalScrollTop())||(e.element.scrollTop=e.get_finalScrollTop()),isNaN(e.get_finalScrollLeft())||(e.element.scrollLeft=e.get_finalScrollLeft()))},e.setRotateZ=function(e){isNaN(e.get_finalRotateZ())||d.o.setRotation(e.element,e.get_finalRotateZ())},e.isCssSizeInPixels=function(e){if(!e)return!1;var t=e.trim(),n=t.charAt(0),i=t.charAt(t.length-1);return!(n<"0"||n>"9")&&!((i<"0"||i>"9")&&!t.endsWith("px"))},e.animationClassPrefix="WacAirSpace",e._isAnimationEnabled=!0,e}();(0,r.l)(_,"WacAirSpace",null,[])},function(e,t,n){"use strict";n.d(t,{g:function(){return o}});var i=n(870),r=n(208),o=function(){function e(){}return e.prototype.equals=function(e,t){return e===t},e.prototype.getHashCode=function(e){return 0|e},e.get_default=function(){return e._default||(e._default=new e)},e._default=null,e}();(0,r.l)(o,"NumberComparer",null,[i.v.$$(Number)])},,function(e,t,n){"use strict";n.d(t,{y:function(){return r}});var i=n(208),r=function(){function e(){}return e.refresh="refresh",e}();(0,i.l)(r,"HostExecutableActions",null,[])},,function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var i=n(208),r=function(){function e(){}return e.Alt="Alt",e.CommandValueId="CommandValueId",e.InnerHTML="InnerHTML",e.On="On",e.IsRtl="IsRtl",e.GalleryButtonProps="GalleryButtonProps",e.Text="Text",e.HighlightOn="HighlightOn",e}();(0,i.l)(r,"GalleryButtonCommandProperties",null,[])},function(e,t,n){"use strict";n.d(t,{u:function(){return r}});var i=n(208),r=function(){function e(){}return e.cookieComplianceBanner_Shown=1,e.cookieComplianceBanner_ConsentedReceived=2,e.privacyNotice_MightBeNeeded=1,e.privacyNotice_Forced=2,e.privacyNotice_CommercialUsersShown=4,e.privacyNotice_CommercialUsersTrustCenterClicked=8,e.privacyNotice_CommercialUsersDismissed=16,e.privacyNotice_SettingsRoamedBusinessBarShown=32,e.privacyNotice_SettingsRoamedBusinessBarDismissed=64,e.privacyNotice_BusinessBarForAnonymousUsersShown=128,e.privacyNotice_BusinessBarForAnonymousUsersDismissed=256,e.privacyNotice_SaveNoticeShownSucceeded=512,e.privacyNotice_SaveNoticeShownFailed=1024,e.privacyNotice_NotShown_OCPSDisabled=2048,e.privacyNotice_NotShown_CantWriteCachedCookie=4096,e.privacyNotice_NotShown_AlreadySeenFromCachedCookie=8192,e.privacyNotice_NotShown_AlreadySeenFromHost=16384,e.privacyNotice_Error=32768,e.privacy_OCPSCCSDisabled=65536,e.privacy_OCPSFailure=131072,e.privacy_UserSettingsSourceRoaming=262144,e.privacy_UserSettingsSourceCookie=524288,e.privacy_UserSettingsSourceQUeryParam=1048576,e.privacyTrustCenter_Shown=2097152,e.privacyTrustCenter_Dismissed=4194304,e.privacyTrustCenter_UserPrivacyOptionsAvailable=8388608,e.privacyTrustCenter_SaveSettingsSucceeded=16777216,e.privacyTrustCenter_SaveSettingsFailed=33554432,e.privacyTrustCenter_UserPrivacyOptionCCSChecked=67108864,e.privacyTrustCenter_UserPrivacyOptionCCSUnChecked=134217728,e.privacyTrustCenter_RefreshRequiredDialogShownForAnonUser=268435456,e.privacyTrustCenter_RefreshRequiredDialogShownForSignedInUser=536870912,e.privacyTrustCenter_RefreshRequiredDialogDismissed=1073741824,e.feedback_Attempted=1,e.feedback_ResourcesDownloadSuccessful=2,e.feedback_ResourcesDownloadFailed=4,e.feedback_Opened=8,e.feedback_Cancelled=16,e.feedback_Submitted=32,e.feedback_Error=64,e.renavigate_AppModeSwitch="AppModeSwitch",e.renavigate_HotStoreSaveFailedError="HotStoreSaveFailedError",e.renavigate_UnifiedFallback="UnifiedAppFallback",e.renavigate_DatacenterRedirect="DatacenterRedirect",e.renavigate_ErrorDialogSwitchToView="ErrorDialogSwitchToView",e.renavigate_InteractiveViewDisabled="InteractiveViewDisabled",e}();(0,i.l)(r,"Constants",null,[])},,function(e,t,n){"use strict";n.d(t,{j:function(){return c}});var i=n(208),r=n(255),o=n(254),a=n(873),s=n(610),l=n(841),u=n(405),c=function(){function e(){this._cancelled=!1}return e.prototype.start=function(t){e.showWaitUI(this.get_waitMessage(),i.i(this,this.onCancel,"onCancel")),u.k.doRequest(this.get_requestUri(),i.i(this,this.onComplete,"onComplete"),t)},e.prototype.onCancel=function(t){this._cancelled=!0,e.dismissWaitUI()},e.prototype.onComplete=function(t,n,i){if(!this._cancelled)if(n||(n=t?"Success":"UnknownError"),"Success"===n)this.get_dismissWaitUIOnSuccess()&&e.dismissWaitUI(),this.onSuccess(i);else{this.isDocumentIssue(n)?r.ULS.sendTraceTag(51708544,301,15,"Translation failed due to an issue in the document: "+n):r.ULS.sendTraceTag(39387393,301,10,"WordViewer translation failed: "+n),e.dismissWaitUI();var s=this.getErrorMessage(n);if(1!==o.AFrameworkApplication.get_activeFrame().get_state()){var u=new l.StandardDialog;u.set_buttonsOption(0),u.setButtonText(1,CommonUIStrings.l_DialogClose),u.showError(a.p.conversionFailed,CommonUIStrings.l_DefaultDialogTitle,s,null)}this.propagateError(s)}},e.showWaitUI=function(t,n){e._progressDialog=new s.c,e._progressDialog.set_message(t),e._progressDialog.showProgressDialog(CommonUIStrings.l_DefaultDialogTitle,n,null)},e.dismissWaitUI=function(){e._progressDialog&&(e._progressDialog.close(),e._progressDialog=null)},e._progressDialog=null,e}();(0,i.l)(c,"TranslationRequest",null,[])},,,,,function(e,t,n){"use strict";n.d(t,{p:function(){return g}});var i=n(208),r=n(308),o=n(600),a=n(255),s=n(478),l=n(810),u=n(867),c=n(851),p=n(425),d=n(586),h=n(556),g=function(){function e(e,t){void 0===t&&(t=null),this._allowFullAppSettingsOverrides=!1,this._appSettingsRequestRetries=0,this._taskManager=null,this.$$pf_State=0,this._eventSource=new d.f,this._logData={},this._clientAppSettings={},this._flightingTreatmentVariables={},this.isFullChecked(e)?this.updateFullAppSettings(e):this._clientAppSettings=e,this.updateFlightingTreatmentVariables(e),this._taskManager=t||l.y.get_instance()}return e.prototype.get_appSettings=function(){return this._clientAppSettings},e.prototype.get_logData=function(){return this._logData},e.prototype.get_flightingTreatmentVariables=function(){return this._flightingTreatmentVariables},e.prototype.get_allowFullAppSettingsOverrides=function(){return this._allowFullAppSettingsOverrides},e.prototype.set_allowFullAppSettingsOverrides=function(e){return this._allowFullAppSettingsOverrides=e,e},e.prototype.get_isFullAppSettingsReady=function(){return 1===this.get_state()},e.prototype.get_state=function(){return this.$$pf_State},e.prototype.set_state=function(e){return this.$$pf_State=e,e},e.prototype.updateFullAppSettings=function(e){if(!n(254).AFrameworkApplication.isShuttingDown){for(var t in e){var i={key:t,value:e[t]};!this.get_allowFullAppSettingsOverrides()&&this._clientAppSettings,this._clientAppSettings[i.key]=i.value}this.updateFlightingTreatmentVariables(e),this._clientAppSettings.MiniCheckAppSettings=!1,this.set_state(1),this.raiseFullAppSettingsReadyEvent()}},e.prototype.updateFlightingTreatmentVariables=function(e){var t,n=e.FlightingTreatmentVariables||"";if(u.t(Object,n,(0,o.m)((function(){return t}),(function(e){return t=e}))))for(var i in t){var r={key:i,value:t[i]};r.key in this._flightingTreatmentVariables||(this._flightingTreatmentVariables[r.key]=r.value)}},e.prototype.isFullChecked=function(e){return Boolean.parse(e.IsFullAppSettings||"false")},e.prototype.invokeOrRegisterOnFullAppSettingsReady=function(e){this.get_isFullAppSettingsReady()?e():this._eventSource&&this._eventSource.addHandler("FARE",e)},e.prototype.raiseFullAppSettingsReadyEvent=function(){this._eventSource&&(this._eventSource.raiseEvent("FARE"),this._eventSource.dispose(),this._eventSource=null)},e.prototype.invokeOrRegisterOnFullAppSettingsFailed=function(e){2!==this.get_state()?this._eventSource&&this._eventSource.addHandler("FAFA",e):e()},e.prototype.raiseFullAppSettingsFailedEvent=function(){this._eventSource&&(this._eventSource.raiseEvent("FAFA"),this._eventSource.dispose(),this._eventSource=null)},e.prototype.requestPostBootAppSettings=function(e){void 0===e&&(e=null);var t=this.getAppSettingsUri();t?n(254).AFrameworkApplication.theClientRequestManager.addRequest(t,1,null,null,!1,2,i.i(this,this.onAppSettingsRequestSucceeded,"onAppSettingsRequestSucceeded"),i.i(this,this.onAppSettingsRequestFailed,"onAppSettingsRequestFailed"),null,void 0,void 0,void 0,void 0,"10"):a.ULS.sendTraceTag(5247296,208,15,"Failed to get full appsettings service url")},e.prototype.getBaseDocQuerySignature=function(){return this._clientAppSettings.BaseDocQuerySignatureWithoutVersion},e.prototype.getAppSettingsUri=function(){var e=this.getBaseDocQuerySignature();if(!e)return null;var t=this._clientAppSettings.WebServiceBase+"appsettings.ashx?"+e,n=c.n.getParameterValueDecoded(document.URL,"sc");return n&&(t=c.n.addParameterValue(t,"sc",n)),t},e.prototype.onAppSettingsRequestSucceeded=function(e){var t;this._logData={Status:e.get_data().status,HttpStatus:e.get_data().httpStatus,ResponseLength:e.get_data().responseData?e.get_data().responseData.length:-1},a.ULS.sendTraceTag(4850132,208,50,"AppSettings request succeeded. {0}",this._logData);try{t=u.b(e.get_data().responseData)}catch(e){return a.ULS.sendTraceTag(5908570,208,10,"AppSettings JSON parse failed. {0}",e),this.set_state(2),void this.raiseFullAppSettingsFailedEvent()}this.updateFullAppSettings(t)},e.prototype.onAppSettingsRequestFailed=function(e){this._logData={Status:e.get_data().status,HttpStatus:e.get_data().httpStatus,ResponseData:h.l.trimToLength(e.get_data().responseData,100)},this.logAndRetryFailedAppSettingsRequest(this._logData)},e.prototype.logAndRetryFailedAppSettingsRequest=function(e){var t=this._appSettingsRequestRetries<this.getIntAppSetting("AppSettingsRequestRetryCount",5);if(this._appSettingsRequestRetries++,e.ShouldRetry=t,e.RetryNumber=this._appSettingsRequestRetries,a.ULS.sendTraceTag(4850133,208,10,"AppSettings request failed. {0}",e),t){var n=new s.c(2,1,5e3,i.i(this,this.requestPostBootAppSettings,"requestPostBootAppSettings"),96);this._taskManager.addTask(n)}else this.set_state(2),this.raiseFullAppSettingsFailedEvent()},e.prototype.getBooleanAppSetting=function(e){return Boolean.parse(this._clientAppSettings[e]||"false")},e.prototype.getStringAppSetting=function(e){return this._clientAppSettings[e]},e.prototype.getIntAppSetting=function(e,t){var n=parseInt(this._clientAppSettings[e]);return isNaN(n)&&(n=t),n},e.prototype.getLongAppSetting=function(e,t){var n=this._clientAppSettings[e];if(n){var i=Number.parseInvariant(n);if(!isNaN(i))return i}return t},e.prototype.getDoubleAppSetting=function(e,t){var n=parseFloat(this._clientAppSettings[e]);return isNaN(n)&&(n=t),n},e.prototype.getListAppSetting=function(e){return u.b(this._clientAppSettings[e])},e.prototype.containsAppSetting=function(e){return e in this._clientAppSettings},e.prototype.getFlightingTreatmentVariables=function(e){var t={},n=this.getIntAppSetting("SdxAssetIdPositionInTreatmentVariablesNamespace",0),i=this._flightingTreatmentVariables;for(var r in i){var o={key:r,value:i[r]},a=o.key.split(".");a.length>n+1&&a[n]===e&&(t[o.key]=o.value)}return t},e.prototype.getBoolFlightingTreatmentVariable=function(e){return Boolean.parse(this._flightingTreatmentVariables[e]||"false")},e.prototype.getIntTreatmentVariable=function(e,t){var n=parseInt(this._flightingTreatmentVariables[e]);return isNaN(n)&&(n=t),n},e.prototype.getStringFlightingTreatmentVariable=function(e){return this._flightingTreatmentVariables[e]},e.prototype.updateFullAppSettingsWithTreatmentVariables=function(e,t){for(var n in t){var i={key:n,value:t[n]};i.key in e||(e[i.key]=i.value)}},e.prototype.addInfoForULS=function(e){if(null!=e){var t;try{t=u.b(n(254).AFrameworkApplication.appSettingsManager.get_appSettings().SessionStartInfoJson.toString())}catch(e){t={}}var i="Unknown",r=e.App||this.get_appSettings().OfficeApplicationName||i;e.Application=t.Application||r||n(254).AFrameworkApplication.appSettingsManager.get_appSettings().OfficeApplicationName.toString().replace("Web","")||i,e.AppMode=e.AppMode||n(254).AFrameworkApplication.get_activeFrame().get_modeName()||i,e.ApplicationMode=t.ApplicationModeExtended||e.AppMode||n(254).AFrameworkApplication.get_activeFrame().get_modeName()||i,e.Host=t.Host||e.Host||n(254).AFrameworkApplication.feedbackDescription||i,e.Browser=t.Browser||e.Browser||i,e.BrowserMajorVersion=t.BrowserMajorVersion||null,e.BrowserMinorVersion=t.BrowserMinorVersion||null,e.Platform=t.Platform||e.Platform||i,e.PlatformMajorVersion=t.PlatformMajorVersion||null,e.PlatformMinorVersion=t.PlatformMinorVersion||null,e.DeviceName=t.DeviceName||e.DeviceName||i,e.SessionID=t.WACSessionID||(n(254).AFrameworkApplication.theClientRequestManager?n(254).AFrameworkApplication.theClientRequestManager.get_userSessionId():i),e.LanguageID=n(254).AFrameworkApplication.lcid,e.IsIPad=p.y.get_isIPad(),e.IsMac=p.y.get_isMac(),e.Ring=t.Ring||-1,e.IsProd=e.IsProd||n(254).AFrameworkApplication.get_isCustomerFeedbackExternal(),e.Datacenter=t.WACDatacenter||(n(254).AFrameworkApplication.theClientRequestManager?n(254).AFrameworkApplication.theClientRequestManager.get_wacClusterId():i),e.Version=n(254).AFrameworkApplication.buildVersion,e.ApplicationVersion=t.ApplicationVersion||n(254).AFrameworkApplication.buildVersion,e.Error=e.Error||!1,e.ErrorCode=e.ErrorCode||null,e.Crash=e.Crash||!1,e.FlightIDs=e.FlightIDs||n(254).AFrameworkApplication.flightId||"",e.FlightIDs.toString().length>2e3&&(e.FlightIDs=String.format("{0}...[Flight IDs trimmed]",e.FlightIDs.toString().substr(0,1999))),e.ServerDocId=t.ServerDocId||i}},e}();(0,i.l)(g,"AppSettingsManager",null,[r.x])},,function(e,t,n){var i=n(89),r=n(780).concat("length","prototype");t.f=Object.getOwnPropertyNames||function(e){return i(e,r)}},function(e,t,n){"use strict";n.r(t),n.d(t,{registerActions:function(){return u},registerShortcuts:function(){return c},generateAnimationStatsDiv:function(){return h}});var i=n(614),r=n(66),o=n(749),a=n(876),s=n(984),l=n(296),u=function(e){e.addAction(i.md,s.a,p),e.addAction(i.fK,s.a,d)},c=function(e){e.getScope(n(751).AFrame.appFocusId).bindAction(o.KeyInputManager.hashKey(r.v.vK_O,5),i.md)},p=function(e,t,n,i,r){return a.WacAirSpace.toggleAnimation(),32},d=function(e,t,n,i,r){return h(),32},h=function(){var e=a.WacAirSpace.getAnimationStats(),t=document.getElementById("WacAirSpaceStats");t||((t=document.createElement("div")).style.display="none",t.id="WacAirSpaceStats",document.body.appendChild(t)),l.s.clearElement(t);var n=document.createElement("div");n.id="WacAirSpaceNumElements",n.innerText=e.length.toString(),t.appendChild(n);for(var i=0;i<e.length;i++){var r=document.createElement("div");r.id="WacAirSpaceStat"+i;var o=e[i],s=document.createElement("div");s.id="WacAirSpaceElementsAnimated"+i,s.innerText=o.get_elementIds(),r.appendChild(s);var u=document.createElement("div");u.id="WacAirSpaceAnimationFps"+i,u.innerText=o.get_fps().toString(),r.appendChild(u);var c=document.createElement("div");c.id="WacAirSpaceMin"+i,c.innerText=o.get_min().toString(),r.appendChild(c);var p=document.createElement("div");p.id="WacAirSpaceMax"+i,p.innerText=o.get_max().toString(),r.appendChild(p);var d=document.createElement("div");d.id="WacAirSpaceStdDev"+i,d.innerText=o.get_stdDev().toString(),r.appendChild(d);var h=document.createElement("div");h.id="WacAirSpaceStartTime"+i,h.innerText=o.get_startTime().toString(),r.appendChild(h);var g=document.createElement("div");g.id="WacAirSpaceEndTime"+i,g.innerText=o.get_endTime().toString(),r.appendChild(g),t.appendChild(r)}}},,function(e,t,n){"use strict";n.d(t,{g:function(){return a}});var i=n(508),r=n(808),o=n(208),a=function(e){function t(){var t=e.call(this)||this;return t.cloneControlsForMenu=!1,t}return(0,i.t)(t,e),t}(r.n);(0,o.l)(a,"MenuBuildContext",r.n,[])},function(e,t,n){"use strict";n.r(t),n.d(t,{SaveAndEditDialog:function(){return l}});var i=n(508),r=n(208),o=n(92),a=n(475),s=n(914),l=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.start=function(){var e=document.createElement("span"),t=document.createElement("div");t.innerText=WordViewerIntl.WordViewerStrings.L_SaveAndEditTranslatedDocumentDialogMessage,e.appendChild(t),this.set_dialogHtml(s.z(e)),this.set_buttonsOption(1),this.showDialog(WordViewerIntl.WordViewerStrings.L_EditInBrowser,r.i(this,this.handleClick,"handleClick"))},t.prototype.handleClick=function(e,t){1===e&&a.o.saveAndEditATranslatedCopy()},t}(o.o);(0,r.l)(l,"SaveAndEditDialog",o.o,[])},function(e,t,n){"use strict";n.d(t,{k:function(){return i},s:function(){return r},d:function(){return o},f:function(){return a},g:function(){return s},r:function(){return l},n:function(){return u}});n(867);var i=function(e){var t=0;for(var n in e){e[n];t++}return t},r=function(e,t){for(var n in e){var i={key:n,value:e[n]};if(t(i.key,i.value))return!0}return!1},o=function(e){for(var t in e){e[t];return!1}return!0},a=function(e){var t=[];for(var n in e){var i={key:n,value:e[n]};Array.add(t,i.key)}return t},s=function(e){var t=[];for(var n in e){var i={key:n,value:e[n]};Array.add(t,i.value)}return t},l=function(e,t){if(void 0===t&&(t=null),t=t||{},e)for(var n=0,i=e;n<i.length;n++){t[i[n]]=!0}return t},u=function(e,t,n){if(!e)return null;var i="";for(var r in e){var o={key:r,value:e[r]};""!==i&&(i+=t),i+=o.key+n+o.value}return i}},,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("ILoggableComponent"),o=n(592),a=n(600),s=n(621),l=n(255),u=n(995),c={$$:function(e){var t="IAggregator$1$"+e.getName();return(0,i.g)(t)}};n.d(t,{n:function(){return d}});var p=50,d=function(){function e(t,n){this._cpuMeter=null,this._keyInputManager=null,this._disposed=!1,this._isProcessing=!1,this._processingQueue=0,this._processDelegate=null,this._pendingDeletes=!1,this._pausedSince=null,this._yieldingSince=null,this._stoppedSince=null,this._disposedSince=null,this._callbackRunningSince=null,this._timerSetAt=null,this._timerSetSince=null,this._processingSince=null,this._runningSince=null,this._timerLength=0,this._pauseRef=0,this._isYielding=!1,this._yieldOperation=null,this._hasStopped=!1,this._isRunning=!1,this._isCallbackRunning=!1,this._taskAggregators=null,this._maximumTimeOfOneCpuWakeUp=0,this._timeToWaitAfterLastKeyStroke=0,this._runningTaskItemID=null,this._yieldResponseOperation=null,this._timerId=0,this._timerSet=!1,this._startToCollectTaskDetails=!1,this.componentDependencies=null,this._queues=[[],[],[],[],[],[]],this._lastProcessedTasks=[-1,-1,-1,-1,-1,-1],this._resumeTasksTimeoutId=-1,this._cpuMeter=t,this._keyInputManager=n,this._timerSet=!1,this._processDelegate=i.i(this,this.process,"process"),this._taskAggregators=new s.u(c.$$(Number)),this._maximumTimeOfOneCpuWakeUp=p,this._timeToWaitAfterLastKeyStroke=5*p,e.keepOriginalWindowFunc()}return e.prototype.dispose=function(){this._disposed=!0,this._disposedSince=new Date,this._queues=[[],[],[],[],[],[]],this.updateNextWakeUpIfNecessary()},e.prototype.get_isYielding=function(){return this._isYielding},e.prototype.get_yieldOperation=function(){return this._yieldOperation},e.prototype.get_isRunning=function(){return this._isRunning||this._isCallbackRunning},e.prototype.get_isCallbackRunning=function(){return this._isCallbackRunning},e.prototype.set_isCallbackRunning=function(e){return this._isCallbackRunning=e,!this._callbackRunningSince&&e?this._callbackRunningSince=new Date:e||(this._callbackRunningSince=null),e},e.prototype.get_hasStopped=function(){return this._hasStopped},e.prototype.get_timeToWaitAfterLastKeyStroke=function(){return this._timeToWaitAfterLastKeyStroke},e.prototype.set_timeToWaitAfterLastKeyStroke=function(e){return this._timeToWaitAfterLastKeyStroke=e,e},e.prototype.get_runningTaskItemID=function(){return this._runningTaskItemID},e.prototype.get_yieldResponseOperation=function(){return this._yieldResponseOperation},e.prototype.get_pendingTaskCount=function(){for(var e=0,t=0;t<this._queues.length;++t){e+=this._queues[t].length}return e},e.prototype.get_pauseRef=function(){return this._pauseRef},e.prototype.get_resumeTasksTimeoutId=function(){return this._resumeTasksTimeoutId},e.prototype.get_maximumTimeOfOneCpuWakeUp=function(){return this._maximumTimeOfOneCpuWakeUp},e.prototype.set_maximumTimeOfOneCpuWakeUp=function(e){return this._maximumTimeOfOneCpuWakeUp=e,e},e.prototype.get_componentName=function(){return 4},e.prototype.get_componentDependencies=function(){return this.componentDependencies},e.prototype.addTask=function(e){this._disposed?l.ULS.sendTraceTag(7078544,218,15,"TaskManager: Not adding task as it has been disposed. {0}",{Id:e.get_taskItemId(),Name:e.name}):(e.get_isDeleted()&&Array.indexOf(this._queues[e.get_priority()],e)>=0||Array.add(this._queues[e.get_priority()],e),e.onEnqueue(),this._hasStopped&&l.ULS.sendTraceTag(7078545,218,50,"TaskManager: Added task when TaskManager is stopped. {0}",{Id:e.get_taskItemId()}),this.updateNextWakeUpIfNecessary(),this._startToCollectTaskDetails&&this._cpuMeter.onTaskAdded(e))},e.prototype.deleteTask=function(e){if(!this._disposed)if(e.set_isDeleted(!0),this._isProcessing&&this._processingQueue===e.get_priority())this._pendingDeletes=!0;else{var t=Array.indexOf(this._queues[e.get_priority()],e);t>-1&&(t<=this._lastProcessedTasks[e.get_priority()]&&this._lastProcessedTasks[e.get_priority()]--,Array.removeAt(this._queues[e.get_priority()],t)),this.updateNextWakeUpIfNecessary()}},e.prototype.process=function(){this._timerSet=!1,this._timerSetAt=null,this._timerSetSince=null;var e=(new Date).getTime();if(!(this._isYielding||this._hasStopped||this._disposed||this._pauseRef>0)){var t=this.get_maximumTimeOfOneCpuWakeUp(),n=!1;if(this._keyInputManager)n=e-this._keyInputManager.get_lastKeyStroke().getTime()<this.get_timeToWaitAfterLastKeyStroke();var i=this._queues[0].length>0;if(!n||i){this._cpuMeter.onBeforeProcess(),this._isProcessing=!0,this._processingSince||(this._processingSince=new Date);var r=5;for(n&&i&&(r=0),this._processingQueue=0;this._processingQueue<=r;this._processingQueue++){var o=this._queues[this._processingQueue].length;if(o){var a=this._lastProcessedTasks[this._processingQueue],s=o;do{if(a=(a+=1)>=o?0:a,(p=this._queues[this._processingQueue][a])&&!p.get_isDeleted()&&e+p.get_acceptableTickRange()>p.get_interval()+p.get_lastProcessed()){var l=new Date;2!==p.get_taskType()&&(Array.removeAt(this._queues[this._processingQueue],a),o--,a--),this.callProcessTask(p);var u=(new Date).getTime()-l.getTime();t-=u,this.updateAggregator(p.get_taskItemId(),u)}s--}while(o>0&&s>0&&t>0);if(this._pendingDeletes){for(var c=0;c<this._queues[this._processingQueue].length;c++){var p;(p=this._queues[this._processingQueue][c]).get_isDeleted()&&(Array.removeAt(this._queues[this._processingQueue],c),c<=a&&a--,c--,o--)}this._pendingDeletes=!1}if(this._lastProcessedTasks[this._processingQueue]=a,t<=0)break}}this._isProcessing=!1,this._processingSince=null,this._cpuMeter.onAfterProcess()}this.updateNextWakeUpIfNecessary()}},e.prototype.callProcessTask=function(e){this._isRunning=!0,this._runningSince||(this._runningSince=new Date);try{this._runningTaskItemID=e.get_taskItemId(),this._cpuMeter.profileTopLevelTask(i.i(e,e.process,"process"),e.get_loggingName(),e.get_lastDelayTick(),e)}finally{this._runningTaskItemID=null,this._isRunning=!1,this._runningSince=null}},e.prototype.pause=function(){this._pauseRef||(this._pausedSince=new Date),this._pauseRef++,this.updateNextWakeUpIfNecessary()},e.prototype.delayTasks=function(t){-1===this._resumeTasksTimeoutId?this.pause():e._originalClearTimeout(this._resumeTasksTimeoutId),this._resumeTasksTimeoutId=e._originalSetTimeout(i.i(this,this.delayEnableTasks,"delayEnableTasks"),t)},e.prototype.delayEnableTasks=function(){this._resumeTasksTimeoutId=-1,this.resume()},e.prototype.pauseForAnimation=function(t){this.pause(),e._originalSetTimeout(i.i(this,this.afterAnimationPause,"afterAnimationPause"),t)},e.prototype.afterAnimationPause=function(){this.resume()},e.prototype.resume=function(){this._pauseRef--,this._pauseRef<0&&(this._pauseRef=0),this._pauseRef||(this._pausedSince=null),this.updateNextWakeUpIfNecessary()},e.prototype.yield=function(t){this._isYielding&&l.ULS.sendTraceTag(7078546,218,15,"TaskManager: Yield was called when already yielding"),this._isYielding=!0,this._yieldingSince||(this._yieldingSince=new Date),this._yieldOperation=t,e._originalSetTimeout(i.i(this,this.yieldResponse,"yieldResponse"),0),this.updateNextWakeUpIfNecessary()},e.prototype.yieldResponse=function(){this._isRunning=!0,this._runningSince||(this._runningSince=new Date),this._yieldResponseOperation=this._yieldOperation;var e=this._yieldOperation;this._yieldOperation=null,this._isYielding=!1,this._yieldingSince=null;try{if(e){var t=e.get_operationName()?"128_"+e.get_operationName():"128";this._cpuMeter.profileTopLevelTask(i.i(e,e.run,"run"),t,+new Date-+e.get_startTime())}}finally{this._yieldResponseOperation=null,this._isRunning=!1,this._runningSince=null}this.updateNextWakeUpIfNecessary()},e.prototype.stop=function(){this._hasStopped=!0,this._stoppedSince||(this._stoppedSince=new Date),this.updateNextWakeUpIfNecessary()},e.prototype.restart=function(){this._hasStopped&&!this._disposed&&(this._hasStopped=!1,this._stoppedSince=null,this.updateNextWakeUpIfNecessary())},e.prototype.resetInterval=function(e,t,n){var i=this._queues[e.get_priority()],r=Array.indexOf(i,e);-1!==r?(i[r].set_interval(t),i[r].set_acceptableTickRange(n),i[r].onEnqueue(),this.updateNextWakeUpIfNecessary()):l.ULS.sendTraceTag(7078547,218,15,"TaskManager: Can't reset interval for task because it's not present in the taskmanager. {0}",{Id:e.get_taskItemId()})},e.prototype.addAggregator=function(e,t){this._taskAggregators.set_item(e,t)},e.prototype.removeTasks=function(e){for(var t=0;t<this._queues.length;t++)for(var n=this._queues[t],i=n.length-1;i>=0;i--){var r=n[i];e(r)&&this.deleteTask(r)}},e.prototype.startToCollectTaskDetails=function(){this._startToCollectTaskDetails=!0},e.prototype.updateAggregator=function(e,t){var n,i=e.toString();this._taskAggregators.tryGetValue(e,(0,a.m)((function(){return n}),(function(e){return n=e})))&&n.track(t,i)},e.prototype.updateNextWakeUpIfNecessary=function(){if(!this._isProcessing&&!this._isRunning)if(this._isYielding||this._hasStopped||this._disposed||this._pauseRef>0)this._timerSet&&this.clearTimeoutInternal();else{var t=0;this._keyInputManager&&this._keyInputManager.get_lastKeyStroke()&&(t=this._keyInputManager.get_lastKeyStroke().getTime());for(var n=(new Date).getTime(),i=-1,r=-1,o=!1,a=!1,s=0;s<6;s++)for(var l=0;l<this._queues[s].length;l++){var u=this._queues[s][l];if(!u||u.get_isDeleted())Array.removeAt(this._queues[s],l),l--;else{var c=u.get_lastProcessed()+u.get_interval()-n;(!o||c<i)&&(i=c,o=!0),u.get_priority()||(!a||c<r)&&(r=c,a=!0)}}if(o){var p=t+this.get_timeToWaitAfterLastKeyStroke()-n;i<p&&(i=p),a&&i>r&&(i=r),i<0&&(i=0),i<10&&(i=0),this._timerSet&&this.clearTimeoutInternal(),this._timerId=e._originalSetTimeout(this._processDelegate,i),this._timerSet=!0;var d=new Date;this._timerSetSince||(this._timerSetSince=d),this._timerSetAt=d,this._timerLength=i}else this._timerSet&&this.clearTimeoutInternal()}},e.prototype.clearTimeoutInternal=function(){e._originalClearTimeout(this._timerId),this._timerSet=!1,this._timerSetSince=null,this._timerLength=-1},e.prototype.getQueueLength=function(e){return this._queues[e].length},e.prototype.getDiagnosticStateForLogging=function(){var e={};this._pauseRef>0&&(e.PA=1,this._pausedSince&&(e.PAS=this._pausedSince.toISOString())),this._isYielding&&(e.Y=1,this._yieldingSince&&(e.YS=this._yieldingSince.toISOString())),this._hasStopped&&(e.S=1,this._stoppedSince&&(e.SS=this._stoppedSince.toISOString())),this._disposed&&(e.D=1,this._disposedSince&&(e.DS=this._disposedSince.toISOString())),this._isProcessing&&(e.PR=1,this._processingSince&&(e.PRS=this._processingSince.toISOString())),this._isRunning&&(e.R=1,this._runningSince&&(e.RS=this._runningSince.toISOString())),this._timerSet&&(e.TS=1,this._timerSetSince&&(e.TSS=this._timerSetSince.toISOString()),this._timerSetAt&&(e.TSA=this._timerSetAt.toISOString()),e.TI=this._timerId,e.TL=this._timerLength),this._isCallbackRunning&&(e.ICR=1,this._callbackRunningSince&&(e.ICRS=this._callbackRunningSince.toISOString()));for(var t={},n=0;n<this._queues.length;n++){var i=this._queues[n];i&&(t["Q"+n]=i.length)}return e.Q=t,null!=this.get_runningTaskItemID()&&(e.RTID=this.get_runningTaskItemID()),e},e.createTaskManagerImpl=function(){return new e(u.r.get_instance(),n(749).KeyInputManager.get_instance())},e.keepOriginalWindowFunc=function(){if(!e._isOriginalWindowFuncSet){var t=window.setTimeout,n=window.clearTimeout;e._originalSetTimeout=function(e,n){return t(e,n)},e._originalClearTimeout=function(e){n(e)},e._isOriginalWindowFuncSet=!0}},e.getDefaultTaskAcceptableTickRange=function(e){var t=e.get_interval();return t<=1e3?0:t<=5e3?Math.floor(t/2):2500},e._isOriginalWindowFuncSet=!1,e._originalSetTimeout=null,e._originalClearTimeout=null,e}();(0,i.l)(d,"TaskManagerImpl",null,[o.h,Sys.IDisposable,r])},function(e,t,n){"use strict";var i=n(508),r=n(208),o=n(267),a=n(317),s=n(192),l=n(268),u=n(513),c=function(e){function t(t,n,i,r,o){void 0===r&&(r=""),void 0===o&&(o=!0);var a=e.call(this,t,n,"","",null,o)||this;return a._align=0,a._height=null,a._align=i,a._height=r,a}return(0,i.t)(t,e),t.prototype.refreshInternal=function(){this.ensureDOMElementAndEmpty(),u.x(this._height)||(this.get_elementInternal().style.height=this._height),this.appendChildrenToElement(this.get_elementInternal()),e.prototype.refreshInternal.call(this)},t.prototype.ensureCorrectChildType=function(e){if(!r.r(l.r,e))throw Error.create("Only children of type ControlComponent can be added to Row Components.")},t.prototype.get_domElementTagName=function(){return"span"},t.prototype.get_cssClass=function(){var e="";switch(this.get_parent().get_type()){case 2:e+="cui-row-onerow";break;case 3:e+="cui-row-tworow";break;case 4:e+="cui-row-threerow";break;default:e+="cui-row"}return 2===this._align&&(e+=" textAlignRight"),e},t}(o.s);(0,r.l)(c,"Row",o.s,[]);var p=n(946);n.d(t,{l:function(){return d}});var d=function(e){function t(t,n,i,r,o,a,l,p,d,h,g){void 0===a&&(a=!1),void 0===l&&(l=!1),void 0===p&&(p=null),void 0===d&&(d=""),void 0===h&&(h=1),void 0===g&&(g=!0);var m=e.call(this,t,n,d,"",null,g)||this;m._type=0,m.verticalAlignment=0,m.horizontalAlignment=0,m.stretchedHorizontally=!1,m.arrangement=0,m._showSectionSeparator=!1,m._type=i,m.verticalAlignment=r,m.horizontalAlignment=o,m.stretchedHorizontally=a,m.arrangement=h,m._showSectionSeparator=l;var _=0;switch(i){case 4:_=3;break;case 3:_=2;break;case 2:_=1;break;case 5:case 1:break;default:throw Error.create("Invalid SectionType")}for(var f=0;f<_;f++){var y=n+"-"+f,v=1,S="";if(p){var C=new s.o(p[f]);u.x(C.get_attributes()[s.o.id])||(y=C.get_attributes()[s.o.id]),C.get_attributes()[s.o.TEXTALIGN]===s.o.RIGHTALIGN&&(v=2),u.x(C.get_attributes()[s.o.HEIGHT])||(S=C.get_attributes()[s.o.HEIGHT])}m.addChildInternal(new c(t,y,v,S,g),!1)}return m}return(0,i.t)(t,e),t.prototype.get_verticalAlignment=function(){return this.verticalAlignment},t.prototype.get_horizontalAlignment=function(){return this.horizontalAlignment},t.prototype.get_stretchedHorizontally=function(){return this.stretchedHorizontally},t.prototype.get_arrangement=function(){return this.arrangement},t.prototype.refreshInternal=function(){if(this.ensureDOMElementAndEmpty(),this.appendChildrenToElement(this.get_elementInternal()),this.ensureDOMElement(),1!==this.get_type()&&5!==this.get_type()){var e=this.get_children();this.appendRow(e,1),3!==this.get_type()&&4!==this.get_type()||this.appendRow(e,2),4===this.get_type()&&this.appendRow(e,3)}this.set_dirty(!1)},t.prototype.appendRow=function(e,t){var n=e.get_item(t-1);n.ensureDOMElement(),2===this.get_type()&&n.get_children().get_count()>0&&r.r(a.GalleryButton,n.get_children().get_item(0).get_control())&&p.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-inRibbonGallery"),p.n.ensureCSSClassOnElement(n.get_elementInternal(),"cui-row-"+t),this.get_root().get_supportsInvisibleControls()&&!n.get_visible()||this.get_elementInternal().appendChild(n.get_elementInternal()),n.ensureRefreshed()},t.prototype.get_cssClass=function(){var e=null;return e=2===this.get_verticalAlignment()?"cui-section-alignmiddle":"cui-section",2===this.get_horizontalAlignment()&&(e+=" alignRight"),this.get_stretchedHorizontally()&&(e+=" stretchedHorizontally"),2===this.get_arrangement()&&(e+=" verticalArrange"),e},t.prototype.get_type=function(){return this._type},t.prototype.removeChild=function(e){throw Error.create("Cannot directly add and remove children from Section Components")},t.prototype.addChildAtIndex=function(e,t){throw Error.create("Cannot directly add and remove children from Section Components")},t.prototype.getRow=function(e){switch(this._type){case 4:if(e<1||e>3)throw Error.create("This Section type only has Row numbers 1, 2 and 3.");break;case 3:if(e<1||e>2)throw Error.create("This Section type only has Row numbers 1 and 2");break;case 2:if(1!==e)throw Error.create("This Section type only has Row number 1.");break;case 5:default:throw Error.create("This Section type does not have any rows")}return this.get_children().get_item(e-1)},t.prototype.ensureDOMElement=function(){if(u.x(this.get_elementInternal())){if(1===this.get_type()){var t=p.n.createElement("span");return t.className="cui-section-divider",this._showSectionSeparator&&(t.className+=" cui-section-divider-separator"),void this.set_elementInternal(t)}e.prototype.ensureDOMElement.call(this)}},t.prototype.ensureCorrectChildType=function(e){var t=this.get_children().get_count();if(2===this.get_type()&&t>0||3===this.get_type()&&t>1||4===this.get_type()&&t>2)throw Error.create("No more children can be added to a Section of this type.");if(1===this.get_type())throw Error.create("Cannot add child components to Divider Section types.");if(!r.r(c,e))throw Error.create("Only children of type Row can be added to Section Components.")},t.prototype.get_domElementTagName=function(){return"span"},t}(o.s);(0,r.l)(d,"Section",o.s,[])},,function(e,t,n){"use strict";var i=n(411),r=n(208),o=(0,r.y)("IDocumentDataUtils"),a=n(254),s=n(235);n.d(t,{t:function(){return l}});var l=function(){function e(){this._scrollControl=null,this._topPage=Number.NaN,this._topZoom=Number.NaN,this._top=Number.NaN,this._leftPage=Number.NaN,this._leftZoom=Number.NaN,this._left=Number.NaN,this._widthPage=Number.NaN,this._widthZoom=Number.NaN,this._width=Number.NaN,this._viewWidth=Number.NaN}return e.prototype.get_scrollControl=function(){return this._scrollControl||(this._scrollControl=s.w.get_instance().resolve(i.f))},e.prototype.getSectionFromPage=function(e){var t,i=1,r=0,o=n(941).App.get_instance().theDocument.get_sectionCount();if(e<1||e>n(941).App.get_instance().theDocument.get_pageCount())return null;for(;i<=o;){if(r=i+o>>1,e>=(t=n(941).App.get_instance().theDocument.getSection(r)).get_startPage()&&e<=t.get_startPage()+t.get_pageCount()-1)return t;e<t.get_startPage()?o=r-1:i=r+1}return null},e.prototype.get_pageCount=function(){return n(941).App.get_instance().theDocument.get_pageCount()},e.prototype.get_sectionCount=function(){return n(941).App.get_instance().theDocument.get_sectionCount()},e.prototype.get_totalPageHeight=function(){return n(941).App.get_instance().theDocument.get_totalPageHeight()},e.prototype.get_maxPageWidth=function(){return n(941).App.get_instance().theDocument.get_maxPageWidth()},e.prototype.get_minPageHeight=function(){return n(941).App.get_instance().theDocument.get_minPageHeight()},e.prototype.get_totalPageGap=function(){return n(941).App.get_instance().theConfig.pageGapPixels*n(941).App.get_instance().theDocument.get_pageCount()},e.prototype.get_hasComments=function(){return n(941).App.get_instance().theDocument.get_hasComments()},e.prototype.get_isNormalized=function(){return n(941).App.get_instance().theDocument.get_isNormalized()},e.prototype.getPageFromScrollTop=function(e,t){var i,r,o,a,s,l=1,u=this.get_pageCount();if(e<0)return 1;for(;l<=u;){if(r=l+u>>1,i=this.getSectionFromPage(r),o=(s=this.getPageTopAtZoom(r,t))-n(941).App.get_instance().theConfig.pageGapPixels+1,a=Math.round(s+i.get_pageHeight()*t),e>=o&&e<=a)return r;e>a?l=r+1:u=r-1}return Math.max(1,u)},e.prototype.getPageTopAtZoom=function(e,t){if(this._topPage===e&&this._topZoom===t)return this._top;this._topPage=e,this._topZoom=t;var i=this.getSectionFromPage(e);return this._top=Math.round(i.get_top()*t+(e-i.get_startPage())*i.get_pageHeight()*t+e*n(941).App.get_instance().theConfig.pageGapPixels-.5*n(941).App.get_instance().theConfig.pageGapPixels),this._top},e.prototype.getPageLeftAtZoom=function(e,t,i){var r=this.get_scrollControl().get_futureContainerWidth();if(this._leftPage===e&&this._leftZoom===t&&r===this._viewWidth)return this._left;this._leftPage=e,this._leftZoom=t,this._viewWidth=r;var o=this.getPageWidthAtZoom(e,t),s=t*this.get_maxPageWidth();if(r<=o+2*n(941).App.get_instance().theConfig.marginPixels)this._left=n(941).App.get_instance().theConfig.marginPixels,i&&a.AFrameworkApplication.get_isRtl()&&(this._left+=s-o);else if(this._left=Math.round((r-(o+2))/2),i&&a.AFrameworkApplication.get_isRtl()){var l=s+2*n(941).App.get_instance().theConfig.marginPixels;r<=l&&(this._left=l-(this._left+o))}return this._left},e.prototype.getDistanceOfPageLeftFromScrollerRightEdge=function(e,t){var i=this.get_scrollControl().getWidth(),r=t*this.get_maxPageWidth()+2*n(941).App.get_instance().theConfig.marginPixels,o=this.getPageLeftAtZoom(e,t,!0);return i<=r?r-o:i-o},e.prototype.getPageHeightAtZoom=function(e,t){var n=this.getSectionFromPage(e);return Math.round(n.get_pageHeight()*t)},e.prototype.getPageWidthAtZoom=function(e,t){if(this._widthPage===e&&this._widthZoom===t)return this._width;this._widthPage=e,this._widthZoom=t;var n=this.getSectionFromPage(e);return this._width=Math.round(n.get_pageWidth()*t),this._width},e.get_instance=function(){return e._instance||(e._instance=new e)},e._instance=null,e}();(0,r.l)(l,"DocumentDataUtils",null,[o])},function(e,t,n){"use strict";n.d(t,{m:function(){return i}});var i=function(){return!!window.self.postMessage}},,,,,,function(e,t,n){e.exports=n(531)},function(e,t,n){n(21);var i=n(908);e.exports=i.Object.values},,,function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var i=n(208),r=function(){function e(){}return e.alt="Alt",e.iconColor="IconColor",e.image16by16Class="Image16by16Class",e.image30by30Class="Image30by30Class",e.image32by32Class="Image32by32Class",e.image48by48Class="Image48by48Class",e.labelText="LabelText",e.labelTextUserGeneratedPlaceholderReplacements="LabelTextUserGeneratedPlaceholderReplacements",e.visible="Visible",e.customTooltip="CustomTooltip",e.Icon="Icon",e.IconSet="IconSet",e.reduxActions="ReduxActions",e}();(0,i.l)(r,"SharedControlCommandProperties",null,[])},,function(e,t,n){"use strict";n.d(t,{q:function(){return r},z:function(){return o}});var i=n(929),r=function(e){return e.nodeType===i.o.text?e.nodeValue:e.textContent||e.innerText},o=function(e){if(!e||e.nodeType!==i.o.element)return null;if(e.outerHTML)return e.outerHTML;var t,n=document.createElement("div"),r=e.cloneNode(!0);return n.appendChild(r),t=n.innerHTML,n.removeChild(r),t}},,function(e,t,n){"use strict";n.d(t,{b:function(){return i}});var i=(0,n(208).y)("IDependencies")},function(e,t,n){"use strict";var i=n(208),r=n(712),o=n(7),a=n(255),s=n(191),l=n(322),u=n(980),c=n(916),p=n(198),d=n(254),h=n(873),g=n(478),m=n(810),_=n(841),f=n(235),y=function(){function e(e,t){void 0===t&&(t=null),this._actionId=0,this._downloadFirstSlice=null,this._actionId=e,this._downloadFirstSlice=t}return e.prototype.areReady=function(){return 32===d.AFrameworkApplication.get_theActionManager().processAction(this._actionId,1)},e.prototype.waitForReady=function(e,t,n){var i=this;void 0===t&&(t=null),void 0===n&&(n=null);var r=isNaN(t)?0:t,o=d.AFrameworkApplication.get_theActionManager().processAction(this._actionId,1),a=!!f.w.get_instance().tryResolve(p.v);2!==o||a?e(this,null):r<20?(r||this._downloadFirstSlice&&this._downloadFirstSlice(),m.y.get_instance().addTask(new g.c(2,1,500,(function(t){i.waitForReady(e,r+1,n)}),127))):n&&n()},e.prototype.invokeOpenInClientHandlerAfterReady=function(){var e=this;this.waitForReady((function(t,n){d.AFrameworkApplication.get_theActionManager().processActionWithData(e._actionId,2,!0)}),0,(function(){a.ULS.sendTraceTag(20711443,211,10,"ShowOpenInClient is not available after timeout");var e=new _.StandardDialog;e.set_buttonsOption(0),e.showError(h.p.openInClientFailedDelayed,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NetworkProblemInitialDialogDescription,null)}))},e}();(0,i.l)(y,"OpenInClientOperationDependencies",null,[c.b]);var v=n(645),S=n(23),C=n(248),b=n(728),A=n(867),T=n(355);n.d(t,{u:function(){return w}});var w=function(){function e(){}return e.get_postMessenger=function(){return f.w.get_instance().resolve(r.e)},e.getPageSetFromPage=function(e){return Math.ceil(e/n(941).App.get_instance().theConfig.pageSetSize)},e.getStartPageFromPageSet=function(e){return(e-1)*n(941).App.get_instance().theConfig.pageSetSize+1},e.getEndPageFromPageSet=function(e){var t=e*n(941).App.get_instance().theConfig.pageSetSize;return Math.min(t,n(941).App.get_instance().theDocument.get_pageCount())},e.getPageSetName=function(t){var i=e.getStartPageFromPageSet(t);return"p_"+i+"_"+(i+n(941).App.get_instance().theConfig.pageSetSize-1)+".zip"},e.getPageSetXmlFromPage=function(e){return Math.ceil(e/n(941).App.get_instance().theConfig.pageSetXmlSize)},e.getStartPageFromPageSetXml=function(e){return(e-1)*n(941).App.get_instance().theConfig.pageSetXmlSize+1},e.getEndPageFromPageSetXml=function(e){var t=e*n(941).App.get_instance().theConfig.pageSetXmlSize;return Math.min(t,n(941).App.get_instance().theDocument.get_pageCount())},e.getPageSetXmlName=function(t){var i=e.getStartPageFromPageSetXml(t);return"p_"+i+"_"+(i+n(941).App.get_instance().theConfig.pageSetXmlSize-1)+".xml"},e.getPageFromXmlLine=function(e){parseInt(e.attributes.getNamedItem("id").nodeValue);var t=e.parentNode,n=(parseInt(t.attributes.getNamedItem("storyId").nodeValue),t.selectSingleNode("ancestor::Page"));return parseInt(n.attributes.getNamedItem("id").nodeValue)},e.parseXmlAttribute=function(e,t){if(!e)return null;var n=e.attributes.getNamedItem(t);return n?n.text:null},e.createWaitImage=function(){var e=new C.k(WordViewerIntl.WordViewerStrings.L_Progress);return e.set_isSmall(!1),e.get_element().style.position="absolute",e.get_element()},e.createSpanElement=function(e){var t=document.createElement("span");return t.innerText=e,t},e.getErrorCodeFromStatus=function(e){var t=0;switch(e){case"ItemNotGenerated":t=l.i.itemNotGenerated;break;case"AccessDenied":t=l.i.accessDenied;break;case"CantFindSourceDocument":t=l.i.cannotFindSourceDocument;break;case"ServiceBusy":t=l.i.serviceBusy;break;case"InProgress":t=l.i.inProgress;break;case"NoManagerAvailable":t=l.i.noManagerAvailable;break;case"DocumentFileExtensionDisabled":t=l.i.documentFileExtensionDisabled;break;case"DocumentIsIRMProtected":t=l.i.documentIsIRMProtected;break;case"DocumentIsEncrypted":t=l.i.documentIsEncrypted;break;case"FileTypeBlocked":t=l.i.fileTypeBlocked;break;case"CantCreateDocument":t=l.i.cantCreateDocument;break;case"CantOpenDocument":t=l.i.cantOpenDocument;break;case"DocumentCorrupt":t=l.i.documentCorrupt;break;case"DocumentHasOCX":t=l.i.documentHasOcx;break;case"DocumentRejectedByGatekeeper":t=l.i.documentRejectedByGatekeeper;break;case"FileTypeUnsupported":t=l.i.fileTypeUnsupported;break;case"WorkerException":t=l.i.workerException;break;case"WorkerCrashed":t=l.i.workerCrashed;break;case"WorkerHung":t=l.i.workerHung;break;case"UnexpectedError":t=l.i.unexpectedError;break;case"UnknownError":t=l.i.unknownError;break;case"ApplicationServerError":t=l.i.applicationServerError;break;case"DocumentAlreadyOpen":t=l.i.documentAlreadyOpen;break;case"DocumentCannotBeTranslated":t=l.i.documentCannotBeTranslated;break;case"DocumentPasswordProtected":t=l.i.documentPasswordProtected;break;case"DocumentTooLong":t=l.i.documentTooLong;break;case"InvalidCurrentDocument":t=l.i.invalidCurrentDocument;break;case"InvalidParameter":t=l.i.invalidParameter;break;case"ThirdPartyPDFRendererFailed":t=l.i.thirdPartyPDFRendererFailed;break;case"ThirdPartyXPSRendererFailed":t=l.i.thirdPartyXPSRendererFailed;break;case"TranslationServiceUnavailable":t=l.i.translationServiceUnavailable;break;case"UnexpectedDocDataResponse":t=l.i.unexpectedDocDataResponse}return t},e.showErrorDialog=function(t){if(t){var i=t.selectSingleNode("/docdata/dialog/title"),r=t.selectSingleNode("/docdata/dialog/description"),o=t.selectSingleNode("/docdata/status"),s=t.selectSingleNode("/docdata/dialog/extraErrorHandling"),u=i?i.text:CommonUIStrings.l_DefaultDialogTitle,c=r?r.text:CommonUIStrings.l_CannotOpenFile,p=o?o.text:"UnexpectedDocDataResponse";a.ULS.sendTraceTag(17634565,301,10,"Error dialog status: {0}",p);var g=!!s&&Boolean.parse(s.text),m=e.getErrorCodeFromStatus(p);m===l.i.unexpectedDocDataResponse&&a.ULS.sendTraceTag(8462864,301,10,"Unknown docdata response. {0}",e.getUnexpectedDocDataResponse(t));var _=!1;if(m===l.i.documentRejectedByGatekeeper&&(_=!0),d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerPDFConverterFailureDownloadLinkEnabled")&&n(941).App.get_instance().get_isPdfMode()&&b.k.documentType===CommonUIStrings.l_DocumentType_Pdf&&d.AFrameworkApplication.downloadACopyUrl&&("WorkerException"===p||"WorkerCrashed"===p||"WorkerHung"===p||"CantOpenDocument"===p))d.AFrameworkApplication.reportError(m),e._errorDlg||(e._errorDlg=new(n(282).PDFConvertFailureDialog)(d.AFrameworkApplication.downloadACopyUrl));else{var f=b.k.formatSingleString(c),y=b.k.formatSingleString(u);g?e.showSendUsYourFileDialog(m,y,f,_):e.showErrorDialogEx(m,y,f,!1,_)}}else e.showErrorDialogEx(h.p.cannotOpenFile,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_CannotOpenFile)},e.showSendUsYourFileDialog=function(t,i,r,a){if(void 0===a&&(a=!1),n(941).App.get_instance().set_status(3),!e._errorDlg&&1!==n(941).App.get_activeAppFrame().get_state()){var s=d.AFrameworkApplication.get_activeFrame().get_theStopwatchBuilder().makeAndStartStopwatch("DialogShown","OpenSendUsYourFileDialogWordViewer");new y(v.AM,u.s).waitForReady((function(n,l){f.w.get_instance().resolveFuture(o.h).execute((function(n){d.AFrameworkApplication.reportError(t),n.showDialog((function(){e.showErrorDialogEx(t,i,r,!0,a)})),s.stop()}))}))}},e.showErrorDialogEx=function(t,i,r,o,a){void 0===o&&(o=!1),void 0===a&&(a=!1),n(941).App.get_instance().set_status(3),e._errorDlg||1!==n(941).App.get_activeAppFrame().get_state()&&(e._errorDlg=new _.StandardDialog,e._errorDlg.set_hasCloseGlyph(d.AFrameworkApplication.isCloseable),new y(v.AM,u.s).waitForReady((function(s,u){var c=e.errorDialogOkHandler,p=s.areReady()&&!a;d.AFrameworkApplication.isCloseable&&p?(e._errorDlg.set_buttonsOption(4),e._errorDlg.setButtonText(2,CommonUIStrings.l_DialogClose),e._errorDlg.setButtonText(1,WordViewerIntl.WordViewerStrings.L_EditInWord),c=e.errorHandlerDialogHandler):p?(e._errorDlg.set_buttonsOption(0),e._errorDlg.setButtonText(1,WordViewerIntl.WordViewerStrings.L_EditInWord),c=e.errorHandlerDialogHandler):d.AFrameworkApplication.isCloseable?(e._errorDlg.set_buttonsOption(0),e._errorDlg.setButtonText(1,CommonUIStrings.l_DialogClose)):(e._errorDlg.set_hasCloseGlyph(!1),e._errorDlg.set_buttonsOption(5)),t===l.i.documentIsEncrypted&&n(941).App.get_instance().get_isPdfMode()&&d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("WordViewerPDFDownloadInErrorDialogIsEnabled")&&e._errorDlg.addDownloadLink(CommonUIStrings.l_PdfConvertFailureDialogLinkSuggestion,d.AFrameworkApplication.downloadACopyUrl),e._errorDlg.showError(t,i,r,c,o)})))},e.propagateError=function(t,n,r,o,l){if(void 0===l&&(l=null),l&&a.ULS.sendTraceTag(50960590,301,50,"PropagateError: [Status: {0}]",l),d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApi")){var u={errorType:n,errorCode:r,message:o};t?d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReturnSuccessOnExpectedErrorIsEnabled")&&e.isExpectedError(l)?(a.ULS.sendTraceTag(50960591,301,15,"PropagateError: Reporting success for expected error.[Status: {0}]",l),e.get_postMessenger().reportAppCompleted(!0)):d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?e.get_postMessenger().sendMessageWithRetry(T.a.wacAppFailed,{Error:u}):e.get_postMessenger().sendAppFailedWithRetry(new s.z(T.a.wacAppFailed,{Error:u},i.i(e.get_postMessenger(),e.get_postMessenger().sendAppFailedWithRetry,"sendAppFailedWithRetry"))):d.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?e.get_postMessenger().sendErrorWithRetry({Error:u}):e.get_postMessenger().sendError({Error:u})}},e.isExpectedError=function(t){if(!t)return!1;switch(e.getErrorCodeFromStatus(t)){case l.i.documentIsIRMProtected:case l.i.documentCorrupt:case l.i.documentPasswordProtected:case l.i.documentIsEncrypted:return!0;default:return!1}},e.errorHandlerDialogHandler=function(t,n){1===t?d.AFrameworkApplication.get_theActionManager().processActionWithData(v.AM,2,!0):e.errorDialogOkHandler(t,!1),e._errorDlg=null},e.errorDialogOkHandler=function(t,i){n(941).App.get_activeAppFrame().get_ribbonUser()&&n(941).App.get_activeAppFrame().get_ribbonUser().poll(),S.p.closeAppOnErrorWithFailoverToBlank(),n(941).App.get_activeAppFrame().get_workspace().dispose(),e._errorDlg=null},e.getUnexpectedDocDataResponse=function(e){var t=null;if(e.documentElement)(t=e.documentElement.outerHTML)&&!t.length&&(t=e.documentElement.text);else try{t=A.w(e)}catch(n){t=e.toString()}return t},e._errorDlg=null,e}();(0,i.l)(w,"Utils",null,[])},,function(e,t,n){var i=n(383),r=n(440),o=i("keys");e.exports=function(e){return o[e]||(o[e]=r(e))}},function(e,t,n){"use strict";n.d(t,{d:function(){return a}});var i=n(951),r=n(946),o=n(208),a=function(){function e(e,t,n){void 0===t&&(t=null),void 0===n&&(n=null),this.displayMode=null,this.elmControl=null,this.elmLabel=null,this.elmDescription=null,this.elmImage=null,this.elmIconContainer=null,this._domStrategy=null,this.displayMode=e,this.elmControl=t,this._domStrategy=n}return e.prototype.get_displayMode=function(){return this.displayMode},e.prototype.setLabelText=function(e){var t=!1;this._domStrategy&&(t=this._domStrategy.updateLabel(this.elmLabel,e)),!t&&this.elmLabel&&("Large"===this.get_displayMode()||"Large16"===this.get_displayMode()||"FloatieLarge"===this.get_displayMode()?r.n.setLargeControlText(this.elmLabel,e,!1):this.elmLabel.innerText=e)},e.prototype.setTooltip=function(e){this.elmControl&&(!i.Control.hasTextSpace(this.get_displayMode())||this.elmLabel&&this.elmLabel.innerText!==e)&&(this.elmControl.title=e)},e}();(0,o.l)(a,"ControlComponentDom",null,[])},function(e,t,n){"use strict";n.d(t,{z:function(){return r}});var i=n(208),r=function(){function e(){}return e.Image16by16Class="Image16by16Class",e.Image32by32Class="Image32by32Class",e.On="On",e.LabelText="LabelText",e.ApplyLabelTextToControlOnly="ApplyLabelTextToControlOnly",e.EnsureControlRoleIsButton="EnsureControlRoleIsButton",e.Visible="Visible",e}();(0,i.l)(r,"SplitButtonCommandProperties",null,[])},function(){window.setTimeout((function(){try{Common.AFrameworkApplication.appSettingsManager.getIntAppSetting("Environment")<=2&&(console.log("%c\ud83d\udc4cPowered By Dullscript!\ud83d\udc4c","font-size: 40px; color: green"),console.log("\nDullscript is a project to convert office online's Script# codebases to Typescript.\nThis session is running on build created from the transpiled source code. If you would\nlike to learn more, or provide feedback, please reach out in our Teams channel: https://aka.ms/dullscriptfeedback\n"))}catch(e){}}),0)},,,function(e,t,n){"use strict";n.d(t,{o:function(){return a}});var i=n(208),r=n(485),o=n(586),a=function(){function e(){this._eventSource=null,this._eventSource=new o.f,$addHandler(window,"resize",i.i(this,this.resizeHandler,"resizeHandler"))}return e.prototype.add_onResize=function(e){this._eventSource.addHandler("Resize",e)},e.prototype.remove_onResize=function(e){this._eventSource.removeHandler("Resize",e)},e.prototype.notifyResize=function(){this._eventSource.raiseEvent("Resize")},e.prototype.dispose=function(){$removeHandler(window,"resize",i.i(this,this.resizeHandler,"resizeHandler")),this._eventSource.dispose(),this._eventSource=null},e.prototype.resizeHandler=function(e){this._eventSource.raiseEvent("Resize")},e}();(0,i.l)(a,"WindowResizeEventSource",null,[r.z,Sys.IDisposable])},function(e,t,n){"use strict";n.d(t,{f:function(){return o}});var i=n(912),r=n(208),o=function(){function e(){}return e.LabelText=i.b.labelText,e.Alt=i.b.alt,e.Image16by16Class=i.b.image16by16Class,e.Image32by32Class=i.b.image32by32Class,e.Image48by48Class=i.b.image48by48Class,e.Visible=i.b.visible,e.HasPopup="HasPopup",e}();(0,r.l)(o,"ButtonCommandProperties",null,[])},,function(e,t,n){"use strict";n.d(t,{q:function(){return p},c:function(){return d},f:function(){return h},x:function(){return g}});var i=n(751),r=n(254),o=n(197),a=n(577),s=n(657),l=n(830),u=n(25),c=n(296),p="cui-touch",d=function(){var e="cui-topBar1";return r.AFrameworkApplication.get_activeFrame()&&r.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isTransistionalHeaderUIEnabled()&&(e+=" cui-topBar1-transistionalHeaderUI"),e},h=function(e,t,n){if(void 0===t&&(t=!0),void 0===n&&(n=!1),e.val=document.getElementById(r.AFrameworkApplication.externalHeaderPanelId),!e.val)return!1;var i=!!r.AFrameworkApplication.get_activeFrame()?r.AFrameworkApplication.get_activeFrame().get_element():e.val.nextSibling,o=n||!!r.AFrameworkApplication.get_activeFrame()&&r.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonFlexBoxLayoutEnabled();return t?(e.val.style.display="",c.s.ensureCSSClassOnElement(i,"cui-exth"),o&&c.s.ensureCSSClassOnElement(i,"FlexBoxLayout")):(e.val.style.display="none",r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("KeepFlexboxLayoutWhenHidingHeaderIsEnabled")||(c.s.removeCSSClassFromElement(i,"cui-exth"),o&&c.s.removeCSSClassFromElement(i,"FlexBoxLayout"))),!0},g=function(e,t,n,r,c,p,d){void 0===d&&(d=!0);var h=s.FocusManager.instance(),g=a.F6Manager.get_instance(),m=l.p.get_instance(),_=u.v.get_instance(),f=h.getScope(e);if(f.parent=i.AFrame.mainAppFocusId,g.addF6(e,d),t&&f.addSetFocus(t),n&&(m.addControlFocus(e,n,r),_.addControlFocus(e,n,r),c)){var y=new o.DOMFocusListing((function(){return n}));y.addValidTag(3),y.addValidTag(2),y.addValidTag(4),y.addValidTag(1),h.buildRegionWithDelegate((function(){return n}),f,y).looped=p}return f}},function(e,t,n){"use strict";n.d(t,{o:function(){return i}});var i,r=n(208);!function(e){e[e.element=1]="element",e[e.attribute=2]="attribute",e[e.text=3]="text",e[e.characterData=4]="characterData",e[e.entityReference=5]="entityReference",e[e.entity=6]="entity",e[e.processingInstruction=7]="processingInstruction",e[e.comment=8]="comment",e[e.document=9]="document",e[e.documentType=10]="documentType",e[e.documentFragment=11]="documentFragment",e[e.notation=12]="notation"}(i||(i={})),(0,r.h)("DOMElementType",i)},function(e,t,n){"use strict";n.d(t,{b:function(){return r}});var i=n(208),r=function(){function e(){}return e.get_controlBehaviorFactory=function(){return e._instance},e.set_controlBehaviorFactory=function(t){return e._instance=t,t},e._instance=null,e}();(0,i.l)(r,"ControlBehaviorFactoryProvider",null,[])},function(e,t,n){"use strict";n.d(t,{q:function(){return s}});var i=n(508),r=n(446),o=n(425),a=n(208),s=function(e){function t(t,n,i,r,o,a,s,l,u,c,p,d,h,g){var m=e.call(this,t,a,h,g)||this;return m._client=null,m._element=null,m._screen=null,m._caught=null,m._button=0,m._shiftKey=!1,m._altKey=!1,m._ctrlKey=!1,m._metaKey=!1,m._client=i,m._element=r,m._screen=o,m._caught=s,m._button=n,m._shiftKey=l,m._altKey=u,m._ctrlKey=c,m._metaKey=p,m.userData=d,m}return(0,i.t)(t,e),t.prototype.get_action=function(){return this.eventName},t.prototype.get_mouseButton=function(){return this._button},t.prototype.get_clientPoint=function(){return this._client},t.prototype.get_screenPoint=function(){return this._screen},t.prototype.get_elementPoint=function(){return this._element||(this._element=r.a.getElementPoint(this._client,this.get_sourceElement())),this._element},t.prototype.get_caughtElement=function(){return this._caught},t.prototype.get_shiftKey=function(){return this._shiftKey},t.prototype.get_altKey=function(){return this._altKey},t.prototype.get_ctrlKey=function(){return this._ctrlKey},t.prototype.get_metaKey=function(){return this._metaKey},t.prototype.get_commandKey=function(){return o.y.get_isMac()?this._metaKey:this._ctrlKey},t.createFromMouseEvent=function(e,n,i,o,a){if(o.rawEvent){var s=o.rawEvent,l=r.a.getSourceElement(o),u=new Sys.UI.Point(s.clientX,s.clientY),c=new Sys.UI.Point(s.screenX,s.screenY);return new t(e,r.a.getMouseButton(s),u,null,c,l,n,s.shiftKey,s.altKey,s.ctrlKey,s.metaKey,i,o,a)}l=o.target,u=new Sys.UI.Point(o.clientX,o.clientY),c=new Sys.UI.Point(o.screenX,o.screenY);return new t(e,o.button,u,null,c,l,n,o.shiftKey,o.altKey,o.ctrlKey,!1,i,o,a)},t.createFromTouchArgs=function(e){var n=e.innerEvent.rawEvent,i=!1,r=!1,o=!1,a=!1;return n?(i=n.shiftKey,r=n.altKey,o=n.ctrlKey,a=n.metaKey):(i=e.innerEvent.shiftKey,r=e.innerEvent.altKey,o=e.innerEvent.ctrlKey),new t(e.eventName,Sys.UI.MouseButton.leftButton,e.get_clientPoint(),e.get_elementPoint(),e.get_screenPoint(),e.get_sourceElement(),e.get_caughtElement(),i,r,o,a,e.userData,e.innerEvent,3)},t.changeUserData=function(e,t){e.userData=t},t}(r.a);(0,a.l)(s,"ClickEventArgs",r.a,[])},,,,function(e,t,n){"use strict";var i,r,o,a=n(403),s=n(76),l=n(714),u=n(786),c=n(295),p=u("iterator"),d=!1;[].keys&&("next"in(o=[].keys())?(r=a(a(o)))!==Object.prototype&&(i=r):d=!0),null==i&&(i={}),c||l(i,p)||s(i,p,(function(){return this})),e.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:d}},function(e,t,n){"use strict";n.d(t,{b:function(){return i},s:function(){return r}});var i=function(e){return Error.invalidOperation(e)},r=function(e,t){return void 0===t&&(t=null),Error.argument(t,e)}},,,,,function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(208),o=n(302),a=n(817),s=n(411),l=n(712),u=(0,r.y)("IEmbedPreviewUrlStore"),c=n(600),p=n(254),d=(0,r.y)("IThrottlingManager"),h=function(){function e(){this._windowStartTime=0,this._measuredActionTotalMs=0,this._sleepUntilTime=0}return e.prototype.get_shouldRunThrottledAction=function(){var e=(new Date).getTime();if(e<this._sleepUntilTime)return!1;if(!this._windowStartTime)return this._windowStartTime=e,this._sleepUntilTime=0,!0;var t=e-this._windowStartTime;if(t>200){var n=this._measuredActionTotalMs/t;return this._measuredActionTotalMs=0,n>.8?(this._windowStartTime=0,this._sleepUntilTime=e+50,!1):(this._windowStartTime=e,!0)}return!0},e.prototype.recordThrottledActionTime=function(e){this._measuredActionTotalMs+=e},e}();(0,r.l)(h,"ThrottlingManager",null,[d]);var g=n(196),m=(0,r.y)("IDocPropertiesProvider"),_=function(){function e(e){var t=this;this.$$pf_BreadcrumbDocName=null,this.set_breadcrumbDocName(""),this.set_openInClientCommandUrl(""),e&&p.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady((function(){t.setPropertiesFromAppSettings(p.AFrameworkApplication.appSettingsManager.get_appSettings())}))}return e.prototype.get_breadcrumbDocName=function(){return this.$$pf_BreadcrumbDocName},e.prototype.set_breadcrumbDocName=function(e){return this.$$pf_BreadcrumbDocName=e,e},e.prototype.get_openInClientCommandUrl=function(){return e._openInClientCommandUrl},e.prototype.set_openInClientCommandUrl=function(t){return e._openInClientCommandUrl=this.get_supportsOpenInClientForAllApps()?t:"",t},e.prototype.setPropertiesFromAppSettings=function(e){e&&(this.set_breadcrumbDocName(e.BreadcrumbDocName||""),this.set_openInClientCommandUrl(e.OpenInClientCommandUrl||""))},e.prototype.get_supportsOpenInClientForAllApps=function(){return!this.get_isAndroid()||p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OICForAndroidIsEnabled")},e.prototype.get_isAndroid=function(){return window.navigator.userAgent.indexOf("Android")>=0},e._openInClientCommandUrl=null,e}();(0,r.l)(_,"DocPropertiesProvider",null,[m]);var f=n(262),y=n(306),v=n(564),S=n(101),C=n(543),b=n(446),A=function(e){function t(t,n,i){var r=e.call(this,t,n,i,0)||this;if(r.origin=null,r.data=null,r.source=null,i.rawEvent){var o=i.rawEvent;r.origin=o.origin,r.source=o.source,r.data=o.data}else r.origin="",r.source=null,r.data="";return r}return(0,i.t)(t,e),t.create=function(e,n,i){return new t(e,n,i)},t}(b.a);(0,r.l)(A,"WindowEventArgs",b.a,[]);var T=function(){function e(){this._eventHandlerManager=null,this._window=null,e._windowEventManagerNumber++,this._window=window.self,this._eventHandlerManager=y.EventHandlerManager.get_instance()}return e.prototype.dispose=function(){},e.prototype.addHandler=function(e,t,n){this._eventHandlerManager.registerHandler(A,e,this._window,2,r.i(this,this.onWindowEvent,"onWindowEvent"),t,n)},e.prototype.removeHandler=function(e,t){this._eventHandlerManager.unregisterHandler(A,e,this._window,t)},e.prototype.onWindowEvent=function(e,t,n){var i=A.create(e,this._window,n);return this._eventHandlerManager.processEvent(A,e,t,i)},e._windowEventManagerNumber=0,e}();(0,r.l)(T,"WindowEventManager",null,[C.k,Sys.IDisposable]);var w=n(425),I=n(796),E=function(e){function t(t,n){return void 0===n&&(n=!0),e.call(this,t,n)||this}return(0,i.t)(t,e),t.prototype.initialize=function(n){e.prototype.initialize.call(this,n),p.AFrameworkApplication.theWindowEventManager=new T,v.o.get_instance().registerActions(p.AFrameworkApplication.get_theActionManager()),p.AFrameworkApplication.get_theActionManager().throttlingManager=t.get_theThrottlingManager(),I.m.get_instance().userSessionId=p.AFrameworkApplication.userSessionId,I.m.get_instance().recordAppInitStart(p.AFrameworkApplication.bootTime),I.m.get_instance().recordResourceDownloadStart(),I.m.get_instance().recordResourceDownloadEnd(),I.m.get_instance().recordBootResourceTimings(),I.m.get_instance().recordPaintTimings(),I.m.get_instance().recordSplashScreenShown();var i=p.AFrameworkApplication.appSettingsManager.getLongAppSetting("HostProvidedClickTime",-1);i>0&&I.m.get_instance().recordUserClickedInHostUi(i),I.m.get_instance().recordNewFileMetrics(p.AFrameworkApplication.isNewFile,p.AFrameworkApplication.get_newFileTemplateName(),p.AFrameworkApplication.get_newFileTemplateLcid()),p.AFrameworkApplication.docPropertiesProvider=new _(n),(!Boolean.parse(n.AvoidCallStackReThrow||"false")||w.y.get_isInternetExplorer10()||w.y.get_isSafari9Up())&&y.EventHandlerManager.get_instance().setOnExceptionOccurred((function(e){throw f.setExceptionCallStack(e),e})),g.r.get_instance().executeWhen(6,r.i(p.AFrameworkApplication.get_theActionManager(),p.AFrameworkApplication.get_theActionManager().logUnhandledKeyboardActions,"logUnhandledKeyboardActions"))},t.prototype.dispose=function(){S.b(p.AFrameworkApplication.theWindowEventManager),p.AFrameworkApplication.theWindowEventManager=null,e.prototype.dispose.call(this)},t.prototype.initializeBrowserSqm=function(t){e.prototype.initializeBrowserSqm.call(this,t),I.m.get_instance().initWsaClient(p.AFrameworkApplication.theWsaClient)},t.prototype.checkHostCanaryValidityAndRedirectIfNeeded=function(e,t){p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("InvalidHostCanary")&&e&&this.redirectOutside(e,t)},t.get_theThrottlingManager=function(){return t._theThrottlingManager||(t._theThrottlingManager=new h)},t.set_theThrottlingManager=function(e){return t._theThrottlingManager=e,e},t._theThrottlingManager=null,t}(p.AFrameworkApplication);(0,r.l)(E,"WebApp",p.AFrameworkApplication,[]);var k=n(837),D=n(255),M=n(430),P=n(5),F=(0,r.y)("IDisplayManagerFactory"),x=(0,r.y)("INavigationControl"),R=n(308),B=n(828),L=n(397),N=n(491),U=n(144),O=n(645),H=n(751),W=n(66),V=n(749),$=n(151),K=function(){function e(e,t,n,i){this._inited=!1,this._actionManager=null,this._focusManager=null,this._documentDataUtils=null,this._lazyScrollControl=null,this._actionManager=e,this._focusManager=t,this._documentDataUtils=n,this._lazyScrollControl=i,this._actionManager.addAction(O.yV,N.d.application,r.i(this,this.prevPage,"prevPage")),this._actionManager.addAction(O.hD,N.d.application,r.i(this,this.nextPage,"nextPage"))}return e.prototype.init=function(){this._actionManager.addAction(O.yZ,N.d.application,r.i(this,this.onCurrentPageChange,"onCurrentPageChange")),this._actionManager.addActionWithFlags(O.dk,N.d.application,r.i(this,this.onQueryCurrentPageLabel,"onQueryCurrentPageLabel"),96);var e=this._focusManager.getScope(H.AFrame.appFocusId);e.bindAction(V.KeyInputManager.hashKey(W.v.vK_Comma,V.KeyInputManager.get_commandKeyModifier()),O.yV),e.bindAction(V.KeyInputManager.hashKey(W.v.vK_Period,V.KeyInputManager.get_commandKeyModifier()),O.hD),this._inited=!0},e.prototype.dispose=function(){},e.prototype.nextPage=function(e,t,i,r,o){return 1!==i&&this._inited?((a=n(941).App.get_activeAppFrame()?n(941).App.get_activeAppFrame().get_workspace().getCurrentPage():1)<this._documentDataUtils.get_pageCount()&&this.onPageJump(a+1),32):32;var a},e.prototype.prevPage=function(e,t,i,r,o){return 1!==i&&this._inited?((a=n(941).App.get_activeAppFrame()?n(941).App.get_activeAppFrame().get_workspace().getCurrentPage():1)>1&&this.onPageJump(a-1),32):32;var a},e.prototype.onPageJump=function(e){this._lazyScrollControl.get_value().scrollToPage(e),n(941).App.get_activeAppFrame().get_ribbonUser()&&n(941).App.get_activeAppFrame().get_ribbonUser().poll(),n(941).App.get_activeAppFrame().get_statusBarUser()&&n(941).App.get_activeAppFrame().get_statusBarUser().pollControl(U.m.pageInfoLabel)},e.prototype.onCurrentPageChange=function(e,t,i,r,o){return 1===i?n(941).App.isReadyForRibbon()?32:8:(this.onPageJump(o),32)},e.prototype.onQueryCurrentPageLabel=function(e,t,i,r,o){if(1===i)return 32;var a=o,s=n(941).App.get_activeAppFrame().get_workspace().getCurrentPage(),l=this._documentDataUtils.get_pageCount();return a[$.i.Value]=String.format(WordViewerIntl.WordViewerStrings.l_PageLabel,s,l>0?l.toString():WordViewerIntl.WordViewerStrings.l_PageCountUnknown),32},e}();(0,r.l)(K,"NavigationControl",null,[x,Sys.IDisposable]);var z=n(963),q=(0,r.y)("IScrollPositionAccessor"),Q=n(22),G=n(324),j=n(220),Z=n(224),X=n(901),J=n(107),Y=function(){function e(e){this._element=null,this._mostRecentClientPoint=null,this._scrollHoriz=!0,this._scrollVert=!0,this._element=e}return e.prototype.get_scrollHoriz=function(){return this._scrollHoriz},e.prototype.set_scrollHoriz=function(e){return this._scrollHoriz=e,e},e.prototype.get_scrollVert=function(){return this._scrollVert},e.prototype.set_scrollVert=function(e){return this._scrollVert=e,e},e.prototype.isDragPossible=function(e){return 3!==e.get_inputSource()&&!e.get_mouseButton()},e.prototype.onDragStart=function(e){return!!this.isDragPossible(e)&&(this._mostRecentClientPoint=e.get_clientPoint(),!0)},e.prototype.onDragMove=function(e){var t=e.get_clientPoint(),n=t.y-this._mostRecentClientPoint.y,i=t.x-this._mostRecentClientPoint.x;return p.AFrameworkApplication.get_isRtl()&&2===e.get_inputSource()&&w.y.get_isInternetExplorerNonEdge()&&(i=-i),this._scrollVert&&(this._element.scrollTop-=n),this._scrollHoriz&&(this._element.scrollLeft-=i),this._mostRecentClientPoint=t,!0},e.prototype.onDragEnd=function(e){this._mostRecentClientPoint=null},e.prototype.onDragCancel=function(e){this._mostRecentClientPoint=null},e}();(0,r.l)(Y,"ScrollDragAdapter",null,[J.q]);var ee=n(579),te=function(){function e(e){this._dragInputManager=null,this._dragInputManager=e}return e.prototype.registerDragScrollRegion=function(e){var t=new Y(e);this._dragInputManager.registerDragAdapterWithPriority(e,t,2),ee.v(e,"dsa",t)},e.prototype.unregisterDragScrollRegion=function(e){var t=ee.j(e,"dsa");null!=t&&this._dragInputManager.unregisterDragAdapter(e,t)},e}();(0,r.l)(te,"DragScrollManager",null,[]);var ne=n(574),ie=n(657),re=n(550),oe=n(235),ae=n(296),se=function(){function e(e,t,i,o,a,s){var l=this;this._container=null,this._scroller=null,this._scrollerHeight=0,this._scrollerWidth=0,this._containerOffsetWidth=0,this._reportFutureContainerWidth=!1,this._containerClientWidth=0,this._isContainerWidthDirty=!0,this._containerClientHeight=0,this._isContainerHeightDirty=!0,this._scrollLeft=0,this._isScrollLeftDirty=!1,this._resizingScroller=!1,this._scrollTop=0,this._isScrollTopDirty=!1,this._ignoreNextOnScroll=!1,this._newEmbedModeIsEnabled=!1,this._isSmallView=!1,this._onScrollHandler=null,this._onSelectStartHandler=null,this._dragScrollManager=null,this._doubleClickHandler=null,this._mouseDownHander=null,this._onMouseWheel=null,this._appSettingsManager=null,this._actionManager=null,this._focusManager=null,this._documentDataUtils=null,this._lazyZoomControl=null,this._theConfig=null,this._workspace=null,this._futureScrollTop=-1,this._appSettingsManager=e,this._actionManager=t,this._focusManager=i,this._documentDataUtils=o,this._lazyZoomControl=a,this._theConfig=s,n(941).App.get_activeAppFrame().add_onResize(r.i(this,this.windowResize,"windowResize")),this._container=document.createElement("div"),this._container.id="WACContainer",this._container.className="WACContainer",this._scroller=document.createElement("div"),this._scroller.id="WACScroller",this._scroller.className="WACScroller",this._scrollerHeight=this._documentDataUtils.get_totalPageGap()+this._documentDataUtils.get_totalPageHeight(),this._scrollerWidth=2*this._theConfig.marginPixels+this._documentDataUtils.get_maxPageWidth(),this._scroller.style.height=this._scrollerHeight+"px",this._scroller.style.width=this._scrollerWidth+"px",this._container.appendChild(this._scroller),this.setUpPinchZoom(),w.y.get_isIPad()&&!p.AFrameworkApplication.get_isEmbedded()&&window.setTimeout((function(){Sys.UI.DomElement.addCssClass(l._container,"webkitTouchScrolling")}),0),this._newEmbedModeIsEnabled=this._appSettingsManager.getBooleanAppSetting("NewEmbedModeIsEnabled"),this._isSmallView=this._appSettingsManager.getBooleanAppSetting("IsSmallView"),this._isSmallView&&!this._newEmbedModeIsEnabled&&(this._doubleClickHandler=r.i(this,this.onDoubleClick,"onDoubleClick"),this.get_clickInputManager().registerHandler(ne.d.doubleClick,this._container,this._doubleClickHandler),this._mouseDownHander=r.i(this,this.onMouseDown,"onMouseDown"),this.get_mouseInputManager().registerHandler(ne.d.mouseDown,this._container,this._mouseDownHander,null)),Sys.UI.DomElement.addCssClass(this._container,p.AFrameworkApplication.get_isRtl()?"FloatLeft":"FloatRight"),this._onScrollHandler=r.i(this,this.onScroll,"onScroll"),this._onSelectStartHandler=r.i(this,this.ignoreEvent,"ignoreEvent"),re.n.addHandler(this._container,ne.d.scroll,this._onScrollHandler),re.n.addHandler(this._container,ne.d.selectStart,this._onSelectStartHandler),this._isSmallView&&!this._newEmbedModeIsEnabled&&this.get_dragScrollManager().registerDragScrollRegion(this._container),this._onMouseWheel=r.i(this,this.mouseWheelEventPng,"mouseWheelEventPng"),this.get_mouseInputManager().registerHandler(ne.d.get_mouseWheel(),this._container,this._onMouseWheel,null),this._actionManager.addAction(O.SB,N.d.application,r.i(this,this.scrollDownArrow,"scrollDownArrow")),this._actionManager.addAction(O.ln,N.d.application,r.i(this,this.scrollUpArrow,"scrollUpArrow")),this._actionManager.addAction(O.bn,N.d.application,r.i(this,this.scrollRightArrow,"scrollRightArrow")),this._actionManager.addAction(O.MJ,N.d.application,r.i(this,this.scrollLeftArrow,"scrollLeftArrow")),this._actionManager.addAction(O.lF,N.d.application,r.i(this,this.scrollPageDown,"scrollPageDown")),this._actionManager.addAction(O.Xq,N.d.application,r.i(this,this.scrollPageUp,"scrollPageUp")),this._actionManager.addAction(O.l,N.d.application,r.i(this,this.scrollHome,"scrollHome")),this._actionManager.addAction(O.IJ,N.d.application,r.i(this,this.scrollEnd,"scrollEnd")),this._actionManager.addActionWithFlags(O.cv,N.d.application,r.i(this,this.resizeScroller,"resizeScroller"),96),this._actionManager.addActionWithFlags(O.iy,N.d.application,r.i(this,this.resizeScrollerWithoutAnimation,"resizeScrollerWithoutAnimation"),96),this._actionManager.addActionWithFlags(O.vx,N.d.application,r.i(this,this.repositionScrollerWithAnimation,"repositionScrollerWithAnimation"),97),this._actionManager.addActionWithFlags(O.jS,N.d.application,r.i(this,this.repositionScrollerWithoutAnimation,"repositionScrollerWithoutAnimation"),97);var u=this._focusManager.getScope(H.AFrame.documentFocusID);u.bindAction(V.KeyInputManager.hashKey(W.v.vK_DownArrow,0),O.SB),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_UpArrow,0),O.ln),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_RightArrow,0),O.bn),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_LeftArrow,0),O.MJ),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_PageDown,0),O.lF),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_PageUp,0),O.Xq),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_Home,0),O.l),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_End,0),O.IJ),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_Home,2),O.l),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_End,2),O.IJ),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_Space,0),O.lF),u.bindAction(V.KeyInputManager.hashKey(W.v.vK_Space,4),O.Xq)}return e.prototype.get_container=function(){return this._container},e.prototype.get_scroller=function(){return this._scroller},e.prototype.get_scrollLeft=function(){return this._isScrollLeftDirty&&(this._scrollLeft=this._container.scrollLeft,this._isScrollLeftDirty=!1),this._scrollLeft},e.prototype.set_scrollLeft=function(e){return this._scrollLeft=e,this._container.scrollLeft=e,this._isScrollLeftDirty=!1,e},e.prototype.get_scrollTop=function(){return this._isScrollTopDirty&&(this._scrollTop=this.convertScrollTopToDocumentSpace(this._container.scrollTop),this._isScrollTopDirty=!1),this._scrollTop},e.prototype.set_scrollTop=function(e){return this._scrollTop=this.convertScrollTopToControlSpace(e),this._container.scrollTop=this._scrollTop,this._futureScrollTop=-1,this._isScrollTopDirty=!1,e},e.prototype.get_futureContainerWidth=function(){return this._reportFutureContainerWidth?this._containerOffsetWidth:this.get_containerClientWidth()},e.prototype.get_futureScrollTop=function(){return-1===this._futureScrollTop?this.get_scrollTop():this._futureScrollTop},e.prototype.get_ignoreNextOnScroll=function(){return this._ignoreNextOnScroll},e.prototype.set_ignoreNextOnScroll=function(e){return this._ignoreNextOnScroll=e,e},e.prototype.get_containerClientHeight=function(){return this._isContainerHeightDirty&&(this._containerClientHeight=this._container.clientHeight,this._isContainerHeightDirty=!1),this._containerClientHeight},e.prototype.get_containerClientWidth=function(){return this._isContainerWidthDirty&&(this._containerClientWidth=this._container.clientWidth,!this._containerClientWidth||this._reportFutureContainerWidth?this._containerClientWidth=this._containerOffsetWidth:this._containerClientWidth!==this._containerOffsetWidth&&(this._isContainerWidthDirty=!1)),this._containerClientWidth},e.prototype.get_resizingScroller=function(){return this._resizingScroller},e.prototype.get_verticalScrollBarWidth=function(){return this.get_container().offsetWidth-this.get_container().clientWidth},e.prototype.get_horizontalScrollBarHeight=function(){return this.get_container().offsetHeight-this.get_container().clientHeight},e.prototype.get_mouseInputManager=function(){return n(941).App.get_activeAppFrame().get_theMouseInputManager()},e.prototype.get_clickInputManager=function(){return n(941).App.get_activeAppFrame().get_theClickInputManager()},e.prototype.get_dragScrollManager=function(){return this._dragScrollManager||(this._dragScrollManager=new te(n(941).App.get_activeAppFrame().get_theDragInputManager()))},e.prototype.get_workspace=function(){return this._workspace||(this._workspace=oe.w.get_instance().resolve(Z.h))},e.prototype.init=function(){},e.prototype.getWidth=function(){return this.get_containerClientWidth()},e.prototype.getClientHeight=function(){return this.get_containerClientHeight()},e.prototype.getScrollLeft=function(){return this.get_scrollLeft()},e.prototype.getScrollTop=function(){return this.get_scrollTop()},e.prototype.getFutureScrollTop=function(){return this.get_futureScrollTop()},e.prototype.setIgnoreNextOnScroll=function(e){this.set_ignoreNextOnScroll(e)},e.prototype.focus=function(){this._container.focus()},e.prototype.dispose=function(){this._scroller&&(this._container.removeChild(this._scroller),this._scroller=null),this._doubleClickHandler&&(this.get_clickInputManager().unregisterHandler(ne.d.doubleClick,this._container,this._doubleClickHandler),this._doubleClickHandler=null),this._mouseDownHander&&(this.get_mouseInputManager().unregisterHandler(ne.d.mouseDown,this._container,this._mouseDownHander),this._mouseDownHander=null),re.n.removeHandler(this._container,ne.d.scroll,this._onScrollHandler),re.n.removeHandler(this._container,ne.d.selectStart,this._onSelectStartHandler),this._onScrollHandler=null,this._onSelectStartHandler=null,this._onMouseWheel&&(this.get_mouseInputManager().unregisterHandler(ne.d.get_mouseWheel(),this._container,this._onMouseWheel),this._onMouseWheel=null),this._isSmallView&&!this._newEmbedModeIsEnabled&&this._dragScrollManager&&(this._dragScrollManager.unregisterDragScrollRegion(this._container),this._dragScrollManager=null),this._container=null},e.prototype.scrollToPage=function(e){var t;if(e<=1)t=0;else{e>this._documentDataUtils.get_pageCount()&&(e=this._documentDataUtils.get_pageCount());this._lazyZoomControl.get_value().get_currentZoom();t=this._documentDataUtils.getPageTopAtZoom(e,this._lazyZoomControl.get_value().get_currentZoom())-this._theConfig.pageGapPixels/2}this._actionManager.processActionWithData(O.vx,2,new G.y(t,0))},e.prototype.scrollToPageOffset=function(e,t){if(e<1||e>n(941).App.get_instance().theDocument.get_pageCount())return 8;var i=this._lazyZoomControl.get_value().get_currentZoom(),r=X.t.get_instance().getPageTopAtZoom(e,i),o=X.t.get_instance().getPageHeightAtZoom(e,i)*t/100;return p.AFrameworkApplication.get_theActionManager().processActionWithData(O.vx,2,new G.y(r+o,0))},e.prototype.broadcastCurrentScrollPosition=function(){p.AFrameworkApplication.get_theActionManager().processActionWithData(O.Pb,2,new Q.v(this.get_workspace().getCurrentPage(),new G.y(this.get_scrollTop(),this.get_scrollLeft()),1))},e.prototype.setUpPinchZoom=function(){var e=this;oe.w.get_instance().resolveFuture(z.e).execute((function(t){t.register(e._container,e)}))},e.prototype.mouseWheelEventPng=function(e){if(e.get_ctrlKey())return!1;for(var t=3*e.get_wheelData()*this._theConfig.autoScrollAmount,n=0;n<2;n++)this._actionManager.processActionWithData(O.jS,2,new G.y(Math.round(this.get_scrollTop()+t),this._scrollLeft));return!0},e.prototype.resizeScroller=function(e,t,n,i,o){return this._resizingScroller=!0,this.updateScrollerDimensionsForCurrentZoom(),j.r.animateSize(this._scroller,this._scrollerHeight,this._scrollerWidth,r.i(this,this.onAfterResizeScroller,"onAfterResizeScroller")),this._isContainerHeightDirty=!0,32},e.prototype.onAfterResizeScroller=function(e){this._resizingScroller=!1,this._actionManager.processAction(O.sV,2),this.onAfterResizeAction()},e.prototype.resizeScrollerWithoutAnimation=function(e,t,n,i,r){return this.updateScrollerDimensionsForCurrentZoom(),ae.s.setElementStyleWidthInPixels(this._scroller,this._scrollerWidth),ae.s.setElementStyleHeightInPixels(this._scroller,this._scrollerHeight),this._isContainerHeightDirty=!0,32},e.prototype.updateScrollerDimensionsForCurrentZoom=function(){var e=this._lazyZoomControl.get_value().get_currentZoom();this._scrollerHeight=this._documentDataUtils.get_totalPageGap()+Math.round(this._documentDataUtils.get_totalPageHeight()*e),this._scrollerWidth=2*this._theConfig.marginPixels+Math.round(this._documentDataUtils.get_maxPageWidth()*e)},e.prototype.onScroll=function(e){this._ignoreNextOnScroll?this._ignoreNextOnScroll=!1:(this._scrollTop=this.convertScrollTopToDocumentSpace(this._container.scrollTop),this._scrollLeft=this._container.scrollLeft,this._isScrollTopDirty=!1,this._containerClientWidth<this._scrollerWidth&&(this._isScrollLeftDirty=!0),this._actionManager.processActionWithData(O.Mn,2,new G.y(this._scrollTop,this._scrollLeft)))},e.prototype.repositionScrollerWithAnimation=function(e,t,n,i,r){return this.repositionScroller(r,!0),32},e.prototype.repositionScrollerWithoutAnimation=function(e,t,n,i,r){return this.repositionScroller(r,!1),32},e.prototype.repositionScroller=function(e,t){var n=this.convertScrollTopToControlSpace(e.scrollTop),i=e.scrollLeft;if(t){this._actionManager.processAction(O.v,2),this._futureScrollTop=n;var o=j.r.animateScroll(this._container,i,n,r.i(this,this.onAfterScroll,"onAfterScroll")).get_runTime();this._actionManager.processActionWithData(O.cP,2,o)}else this._container.scrollLeft=i,this._container.scrollTop=n,this._futureScrollTop=-1;isNaN(n)&&isNaN(i)||(this._isScrollTopDirty=!0)},e.prototype.onAfterScroll=function(e){this._appSettingsManager.getBooleanAppSetting("BroadcastMode")&&this.broadcastCurrentScrollPosition()},e.prototype.onDoubleClick=function(e){return this._actionManager.processAction(O.xH,2),!0},e.prototype.onMouseDown=function(e){return ie.FocusManager.usable()&&this._focusManager.setScope(H.AFrame.documentFocusID),e.innerEvent.preventDefault(),!1},e.prototype.windowResize=function(){this.resizeContainer(),this._actionManager.processAction(O.Hn,2),this._actionManager.processAction(O.Hb,2)},e.prototype.resizeContainer=function(){if(this._container){this._containerOffsetWidth=n(941).App.get_activeAppFrame().getDOMElement().clientWidth;var e=0,t=0;n(941).App.get_activeAppFrame().get_isSearchPaneVisible()&&(e=this._theConfig.searchPaneWidth,this._containerOffsetWidth-=e,p.AFrameworkApplication.get_isRtl()||(t=e));var i=0;n(941).App.get_activeAppFrame().get_isCommentPaneVisible()&&(i=this._theConfig.commentPaneWidth,this._containerOffsetWidth-=i,p.AFrameworkApplication.get_isRtl()&&(t=i)),this._containerOffsetWidth=this._containerOffsetWidth<0?0:this._containerOffsetWidth,this._isSmallView&&!this._newEmbedModeIsEnabled&&(this._containerOffsetWidth+=this.get_verticalScrollBarWidth()),this._reportFutureContainerWidth=!0,j.r.resizeContainerAnimation(this._container,t,this._containerOffsetWidth,r.i(this,this.onAfterResizeContainer,"onAfterResizeContainer")),this._containerOffsetWidth-=this.get_verticalScrollBarWidth(),this._isSmallView&&!this._newEmbedModeIsEnabled&&(this._container.style.height=this._container.offsetHeight+this.get_horizontalScrollBarHeight()+"px",this._containerOffsetWidth-=this.get_verticalScrollBarWidth()),this._isContainerHeightDirty=!0,this._isContainerWidthDirty=!0}},e.prototype.onAfterResizeContainer=function(e){this._isContainerHeightDirty=!0,this._isContainerWidthDirty=!0,this._reportFutureContainerWidth=!1,this.onAfterResizeAction()},e.prototype.onAfterResizeAction=function(){if(w.y.get_isIPad()&&p.AFrameworkApplication.get_isRtl()){var e=this._container.scrollWidth>this._container.offsetWidth?"auto":"touch";this._container.style.webkitOverflowScrolling=e}},e.prototype.ignoreEvent=function(e){e.stopPropagation(),e.preventDefault()},e.prototype.scrollDownArrow=function(e,t,n,i,r){return this._scrollTop=this._scrollTop+this._theConfig.keyboardArrowScrollAmount,this._scrollTop=Math.min(this._scrollTop,this._scrollerHeight-this.get_containerClientHeight()),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32},e.prototype.scrollUpArrow=function(e,t,n,i,r){return this._scrollTop=this._scrollTop-this._theConfig.keyboardArrowScrollAmount,this._scrollTop=Math.max(this._scrollTop,0),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32},e.prototype.scrollRightArrow=function(e,t,n,i,r){return this._scrollLeft=this._scrollLeft+this._theConfig.keyboardArrowScrollAmount,this._scrollLeft=Math.min(this._scrollLeft,this._scrollerWidth-this.get_containerClientWidth()),this._isScrollLeftDirty=!1,this._container.scrollLeft=this._scrollLeft,32},e.prototype.scrollLeftArrow=function(e,t,n,i,r){return this._scrollLeft=this._scrollLeft-this._theConfig.keyboardArrowScrollAmount,this._scrollLeft=Math.max(this._scrollLeft,0),this._isScrollLeftDirty=!1,this._container.scrollLeft=this._scrollLeft,32},e.prototype.scrollPageDown=function(e,t,n,i,r){return this._lazyZoomControl.get_value().get_isFitPage()?(this._actionManager.processAction(O.hD,2),32):(this._scrollTop=this._scrollTop+this.get_containerClientHeight()-this._theConfig.pageGapPixels,this._scrollTop=Math.min(this._scrollTop,this._scrollerHeight-this.get_containerClientHeight()),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32)},e.prototype.scrollPageUp=function(e,t,n,i,r){return this._lazyZoomControl.get_value().get_isFitPage()?(this._actionManager.processAction(O.yV,2),32):(this._scrollTop=this._scrollTop-this.get_containerClientHeight()-this._theConfig.pageGapPixels,this._scrollTop=Math.max(this._scrollTop,0),this._isScrollTopDirty=!1,this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),32)},e.prototype.scrollHome=function(e,t,n,i,r){return this._scrollTop=0,this._container.scrollTop=0,this._isScrollTopDirty=!1,32},e.prototype.scrollEnd=function(e,t,n,i,r){return this._scrollTop=this._scrollerHeight-this.get_containerClientHeight(),this._container.scrollTop=this.convertScrollTopToControlSpace(this._scrollTop),this._isScrollTopDirty=!1,32},e.prototype.convertScrollTopToControlSpace=function(e){return e},e.prototype.convertScrollTopToDocumentSpace=function(e){return e},e}();(0,r.l)(se,"ScrollControl",null,[s.f,Sys.IDisposable,q]);var le=n(614),ue=function(){function e(e,t){this.zoom=0,this.allowScrollUpdate=!1,this.zoom=e,this.allowScrollUpdate=t}return e.prototype.get_zoom=function(){return this.zoom},e.prototype.get_allowScrollUpdate=function(){return this.allowScrollUpdate},e}();(0,r.l)(ue,"SetCustomZoomArgs",null,[]);var ce,pe=n(686),de=n(478),he=n(810),ge=n(773),me=n(586),_e=n(556),fe=function(){function e(t,n){this.appSettingsManager=null,this.actionManager=null,this.$$pf_CurrentZoom=0,this.delta=.1,this.pageMargin=0,this._dialog=null,this.defaultDialogOptions=[CommonUIStrings.l_FullPage,CommonUIStrings.l_PageWidth,"200%","150%","100%","75%","50%"],this.defaultDialogValues=[e.dialogResult_FullPage,e.dialogResult_PageWidth,"200","150","100","75","50"],this.currentZoomStatus=3,this.eventSource=new me.f,this.appSettingsManager=t,this.actionManager=n,this.set_currentZoom(1)}return e.prototype.get_currentZoom=function(){return this.$$pf_CurrentZoom},e.prototype.set_currentZoom=function(e){return this.$$pf_CurrentZoom=e,e},e.prototype.get_currentZoomOnUI=function(){return Math.round(100*this.get_currentZoom())},e.prototype.get_nextValueIncreaseZoom=function(){return Math.floor(this.get_currentZoomOnUI()/10)/10+this.delta},e.prototype.get_nextValueDecreaseZoom=function(){return Math.ceil(this.get_currentZoomOnUI()/10)/10-this.delta},e.prototype.get__actionManager=function(){return p.AFrameworkApplication.get_theActionManager()},e.prototype.add_zoomChanged=function(e){this.eventSource.addHandler("ZoomChanged",e)},e.prototype.remove_zoomChanged=function(e){this.eventSource.removeHandler("ZoomChanged",e)},e.prototype.registerZoomChangedEvent=function(e){this.add_zoomChanged(e)},e.prototype.removeZoomChangedEvent=function(e){this.remove_zoomChanged(e)},e.prototype.zoomElement=function(e){this.zoomElementTo(e,this.get_currentZoom())},e.prototype.zoomElementTo=function(e,t){null!==e&&ge.o.setScale(e,t)},e.prototype.setZoom=function(e,t){void 0===t&&(t=!0);var n=100*e,i=n;this.appSettingsManager&&this.appSettingsManager.getBooleanAppSetting("DoNotAutoScrollAfterPinchIsEnabled")&&(i=new ue(n,t)),this.setCustomZoom(0,null,2,null,i)},e.prototype.setZoomDuringResize=function(e,t){void 0===t&&(t=!1);var n=3|(t?0:4);this.updateZoom(e,n)},e.prototype.isInScope=function(e){return!0},e.prototype.onZoomChange=function(e,t,n,i,r){if(1===n)return this.isReadyForRibbon()?32:8;var o=r/100;return o<this.get_minimumZoom()?o=this.get_minimumZoom():o>this.get_maximumZoom()&&(o=this.get_maximumZoom()),this.onZoomChangeCustomAction(o),this.updateZoom(o),i&&(i.dataValue1=Math.floor(100*o)),32},e.prototype.onQueryZoomLevel=function(e,t,n,i,r){return 1===n?32:(r.value=Math.floor(100*this.get_currentZoom()),32)},e.prototype.onQueryZoomText=function(e,t,n,i,r){if(1===n)return 32;var o=r,a="";return _e.l.formatNumberToString(this.get_currentZoomOnUI(),6,p.AFrameworkApplication.get_numberFormat(),(0,c.m)((function(){return a}),(function(e){return a=e}))),o[this.get_zoomLabelTextDictionaryKey()]=a,32},e.prototype.onZoomChangeCustomAction=function(e){},e.prototype.isReadyForRibbon=function(){return!0},e.prototype.getZoomDialogOptionList=function(){return this.defaultDialogOptions},e.prototype.getZoomDialogValueList=function(){return this.defaultDialogValues},e.prototype.getCurrentZoomValueBasedOnZoomStatus=function(){var t=Math.floor(100*this.get_currentZoom()).toString();return 1===this.currentZoomStatus?t=e.dialogResult_FullPage:2===this.currentZoomStatus&&(t=e.dialogResult_PageWidth),t},e.prototype.increaseZoom=function(e,t,n,i,r){return 1===n?32:(this.logUpdateZoomEvents(this.actionManager?this.actionManager.get_commandLocation():0,"IncreaseZoom"),this.currentZoomStatus=0,this.updateZoom(this.get_nextValueIncreaseZoom()),32)},e.prototype.decreaseZoom=function(e,t,n,i,r){return 1===n?32:(this.logUpdateZoomEvents(this.actionManager?this.actionManager.get_commandLocation():0,"DecreaseZoom"),this.currentZoomStatus=0,this.updateZoom(this.get_nextValueDecreaseZoom()),32)},e.prototype.setZoomLevelFromRibbon=function(e,t,n,i,r){var o=this;if(1===n)return 32;this.logUpdateZoomEvents(this.actionManager?this.actionManager.get_commandLocation():0,"SetZoomLevelFromRibbon");var a=r.Value;if(a.toLowerCase().startsWith("fit")){var s=new de.c(0,1,0,(function(e){o.zoomToPageWidth(0,null,2,null,null)}),138,void 0,!0);return he.y.get_instance().addTask(s),32}var l=parseInt(a)/100;return isNaN(l)?2:(this.currentZoomStatus=0,this.updateZoom(l),32)},e.prototype.logUpdateZoomEvents=function(e,t){D.ULS.sendTraceTag(42341577,353,50,"Update Zoom. CommandLocation: {0}; Command: {1}; ZoomImprovementIsEnabled: {2}; IsSLR: {3}",e,t,p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ZoomDropdownInSlrIsEnabled"),p.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxEnabled())},e.prototype.showZoomDialog=function(e,t,n,i,o){if(1===n)return 32;D.ULS.sendTraceTag(7176728,353,50,"Customer is trying to trigger the Zoom dialog"),this._dialog=new pe.j(this.getZoomDialogOptionList(),this.getZoomDialogValueList(),r.i(this,this.handleZoomDialogResult,"handleZoomDialogResult"),ie.FocusManager.instance());var a=this.getCurrentZoomValueBasedOnZoomStatus();return this._dialog.showZoomDialog(CommonUIStrings.l_ZoomDialogTitle,a),32},e.prototype.isDialogResultFullPage=function(t){return t.toLowerCase()===e.dialogResult_FullPage.toLowerCase()},e.prototype.isDialogResultPageWidth=function(t){return t.toLowerCase()===e.dialogResult_PageWidth.toLowerCase()},e.prototype.handleZoomDialogResult=function(e){var t=8;if(this.isDialogResultFullPage(e))this.currentZoomStatus=1,t=this.zoomToFit(0,null,2,null,null);else if(this.isDialogResultPageWidth(e))this.currentZoomStatus=2,t=this.zoomToPageWidth(0,null,2,null,null);else{var n=Number.parseInvariant(e);if(n){this.currentZoomStatus=0;var i=n;this.appSettingsManager&&this.appSettingsManager.getBooleanAppSetting("DoNotAutoScrollAfterPinchIsEnabled")&&(i=new ue(n,!0)),t=this.setCustomZoom(0,null,2,null,i)}else t=8}32===t?D.ULS.sendTraceTag(7176729,353,50,"Succeeded to Zoom: {0}",{DialogResult:e}):D.ULS.sendTraceTag(7156360,353,10,"Failed to Zoom: {0}",{DialogResult:e})},e.prototype.raiseZoomChangedEvent=function(){this.eventSource.raiseEvent("ZoomChanged",null)},e.prototype.zoomDialogTabFocusHandler=function(e,t,n,i,r){if(!this._dialog)return 2;var o=this._dialog.get_focusManager().getCurrentRegion().listing.get_currentElement();if(o===this._dialog._btnCancel&&e===le.go||o===this._dialog._btnAction&&e===le.FL)this._dialog.get_activeSelection()||this._dialog.selectFirstZoomOption(),this._dialog.get_focusManager().getCurrentRegion().listing.trySetCurrentElement(this._dialog.get_activeSelection());else if(o.id.startsWith(this._dialog.get_radioboxPrefix())||o.className.startsWith(this._dialog.get_radioRowClassName())){var a=null;e===le.go?a=this._dialog._btnAction:e===le.FL&&(a=this._dialog._btnCancel),this._dialog.get_focusManager().getCurrentRegion().listing.trySetCurrentElement(a),Sys.UI.DomElement.removeCssClass(this._dialog.get_activeSelection().parentNode,this._dialog.get_radioRowHighlightClassName())}else if(e===le.go)this._dialog.get_focusManager().getCurrentRegion().moveForward();else{if(e!==le.FL)return 2;this._dialog.get_focusManager().getCurrentRegion().moveBackward()}return 32},e.dialogResult_FullPage="FullPage",e.dialogResult_PageWidth="PageWidth",e}();(0,r.l)(fe,"ZoomManager",null,[P.w]),function(e){e[e.manual=0]="manual",e[e.fitToFullPage=1]="fitToFullPage",e[e.fitWidth=2]="fitWidth",e[e.onBoot=3]="onBoot"}(ce||(ce={})),(0,r.h)("ZoomFlag",ce);var ye=(0,r.y)("IZoomActor"),ve=n(984),Se=function(){function e(e,t,n){this._actionManager=null,this._zoomManager=null,this._appSettingsManager=null,this._actionManager=e,this._zoomManager=t,this._appSettingsManager=n}return e.prototype.registerActions=function(){this._appSettingsManager.getBooleanAppSetting("ZoomPopupDialogIsEnabled")&&(this._actionManager.addAction(le.Ig,ve.a,r.i(this._zoomManager,this._zoomManager.showZoomDialog,"showZoomDialog")),this._actionManager.addActionWithFlags(le.QD,ve.a,r.i(this._zoomManager,this._zoomManager.onQueryZoomText,"onQueryZoomText"),96),this._actionManager.addAction(le.go,ve.a,r.i(this._zoomManager,this._zoomManager.zoomDialogTabFocusHandler,"zoomDialogTabFocusHandler")),this._actionManager.addAction(le.FL,ve.a,r.i(this._zoomManager,this._zoomManager.zoomDialogTabFocusHandler,"zoomDialogTabFocusHandler")))},e}();(0,r.l)(Se,"CommonZoomActor",null,[ye]);var Ce=n(698),be=n(355),Ae=n(833),Te=function(e){function t(t,n,i,o,a){var s=e.call(this,n,i)||this;return s._isThroughZoomDialog=!1,s._isInitZoomLogged=!1,s._currentDevicePixelRatio=0,s._isSmallView=!1,s._newEmbedModeIsEnabled=!1,s._useSetCustomZoomArgs=!1,s._app=null,s._lazyPostMessenger=null,s._documentDataUtils=null,s._scrollControl=null,s._zoomFlag=3,s._app=t,s._lazyPostMessenger=o,s._documentDataUtils=a,s._currentDevicePixelRatio=window.self.devicePixelRatio,s._newEmbedModeIsEnabled=n.getBooleanAppSetting("NewEmbedModeIsEnabled"),s._isSmallView=n.getBooleanAppSetting("IsSmallView"),s._useSetCustomZoomArgs=n.getBooleanAppSetting("DoNotAutoScrollAfterPinchIsEnabled"),i.addActionWithFlags(O.Nc,N.d.application,r.i(s,s.onZoomChange,"onZoomChange"),8),i.addAction(O.Vu,N.d.application,r.i(s,s.onFitFullPage,"onFitFullPage")),i.addAction(O.lq,N.d.application,r.i(s,s.onFitPageWidth,"onFitPageWidth")),i.addActionWithFlags(O.HE,N.d.application,r.i(s,s.onQueryZoomLevel,"onQueryZoomLevel"),97),i.addActionWithFlags(O.Hb,N.d.application,r.i(s,s.updateZoomOnWindowResize,"updateZoomOnWindowResize"),96),i.addActionWithFlags(O.xH,N.d.application,r.i(s,s.onNextZoomLevel,"onNextZoomLevel"),96),n.getBooleanAppSetting("ZoomPopupDialogIsEnabled")||i.addActionWithFlags(O.QD,N.d.application,r.i(s,s.onQueryZoomText,"onQueryZoomText"),97),i.addActionWithFlags(O.Qc,N.d.application,r.i(s,s.populateZoomFlyout,"populateZoomFlyout"),96),i.addActionWithFlags(O.oW,N.d.application,r.i(s,s.setZoomLevel,"setZoomLevel"),8),s}return(0,i.t)(t,e),t.prototype.get_isFitPage=function(){return 1===this._zoomFlag},t.prototype.get_appName=function(){return"WordViewer"},t.prototype.get_maximumZoom=function(){return this._app.theConfig.maximumZoom},t.prototype.get_minimumZoom=function(){return this._app.theConfig.minimumZoom},t.prototype.get_zoomLabelTextDictionaryKey=function(){return Ae.g.LabelText},t.prototype.get_scrollControl=function(){return this._scrollControl||(this._scrollControl=oe.w.get_instance().resolve(s.f))},t.prototype.dispose=function(){},t.prototype.setZoomLevel=function(e,t,n,i,r){var o=r;if(o<this._app.theConfig.minimumZoom||o>this._app.theConfig.maximumZoom){var a={newLevel:o,maxZoom:this._app.theConfig.maximumZoom,minZoom:this._app.theConfig.minimumZoom};return D.ULS.sendTraceTag(34219330,301,10,"ZoomChangeError: "+a),this._lazyPostMessenger.get_value().sendError({errorType:"ZoomChangeError",errorObject:a}),16}return this._zoomFlag=0,this.updateZoom(o),32},t.prototype.fitPage=function(e){if(e){var t=n(941).App.get_activeAppFrame().get_workspace().getHeight(),i=this.get_scrollControl().getWidth();this.onFitPage(i,t)}else this.onFitWidth(this.get_scrollControl().getWidth())},t.prototype.updateZoomOnWindowResize=function(e,t,i,r,o){var a=this._currentDevicePixelRatio;if(this._currentDevicePixelRatio=window.self.devicePixelRatio,this._currentDevicePixelRatio!==a&&D.ULS.sendTraceTag(25236178,353,50,'{{"ZoomedThroughBrowser":1, "OldBrowserZoom":{0}, "NewBrowserZoom":{1}}}',a,this._currentDevicePixelRatio),3===this._zoomFlag)if(this._isSmallView&&(p.AFrameworkApplication.logFlightedSettingUsage("Microsoft.Office.Web.WordViewer.IWacWordViewerNewEmbedModeSettings"),D.ULS.sendTraceTag(36226190,301,50,"{{NewEmbedModeIsEnabled: {0}}}",this._newEmbedModeIsEnabled)),this._isSmallView&&!this._newEmbedModeIsEnabled)this.fitPage(!1);else{var s=1;if(n(941).App.get_activeAppFrame().get_workspace()){var l=n(941).App.get_activeAppFrame().get_workspace().getCurrentPage();s=(this.get_scrollControl().getWidth()-2*this._app.theConfig.marginPixels)/this._documentDataUtils.getPageWidthAtZoom(l,1)}s>1?s=1:!this._isSmallView&&s<.75?s=.75:this._isSmallView&&s<.1&&this._newEmbedModeIsEnabled&&(s=.1),this.updateZoom(s)}else this._zoomFlag?this.fitPage(1===this._zoomFlag):this.actionManager.processAction(O.sV,2);return 32},t.prototype.onFitFullPage=function(e,t,i,r,o){return 1===i?n(941).App.isReadyForRibbon()?32:8:(this._isThroughZoomDialog?D.ULS.sendTraceTag(7410945,353,50,"Word Viewer - Zoom to fit page height through new dialog"):D.ULS.sendTraceTag(7410946,353,50,"Word Viewer - Zoom to fit page height through old menu"),this.fitPage(!0),32)},t.prototype.onZoomChangeCustomAction=function(t){this._isThroughZoomDialog?D.ULS.sendTraceTag(7410947,353,50,"Word Viewer - Zoom to custom value through new dialog: {0}",t):D.ULS.sendTraceTag(7410948,353,50,"Word Viewer - Zoom to custom value through old menu : {0}",t),this._zoomFlag=0,e.prototype.onZoomChangeCustomAction.call(this,t)},t.prototype.isReadyForRibbon=function(){return n(941).App.isReadyForRibbon()},t.prototype.onFitPageWidth=function(e,t,i,r,o){return 1===i?n(941).App.isReadyForRibbon()?32:8:(this._isThroughZoomDialog?D.ULS.sendTraceTag(7410949,353,50,"Word Viewer - Zoom to fit page width through new dialog"):D.ULS.sendTraceTag(7410950,353,50,"Word Viewer - Zoom to fit page width through old menu"),this.fitPage(!1),32)},t.prototype.zoomOnFitPage=function(e,t){var i,r=(t-=this._app.theConfig.pageGapPixels)/(i=n(941).App.get_activeAppFrame()?this._documentDataUtils.getPageHeightAtZoom(n(941).App.get_activeAppFrame().get_workspace().getCurrentPage(),1):this._documentDataUtils.getPageHeightAtZoom(1,1));e-=2*this._app.theConfig.marginPixels;var o,a=this._documentDataUtils.getPageWidthAtZoom(n(941).App.get_activeAppFrame().get_workspace().getCurrentPage(),1),s=e/a;return r>s?a*(o=r)>e&&(o/=a*o/e):i*(o=s)>t&&(o/=i*o/t),o},t.prototype.onFitPage=function(e,t){this._zoomFlag=1,this.updateZoom(this.zoomOnFitPage(e,t))},t.prototype.zoomOnFitWidth=function(e){e-=2*this._app.theConfig.marginPixels;var t=n(941).App.get_activeAppFrame().get_workspace().getCurrentPage();return e/this._documentDataUtils.getPageWidthAtZoom(t,1)},t.prototype.onFitWidth=function(e){this._zoomFlag=2,this.updateZoom(this.zoomOnFitWidth(e))},t.prototype.onNextZoomLevel=function(e,t,i,r,o){if(2===i){var a=n(941).App.get_activeAppFrame().get_workspace().getHeight(),s=this.get_scrollControl().getWidth(),l=this.zoomOnFitPage(s,a),u=this.zoomOnFitWidth(s),c=[1,1.5,l,u];c.sort();var p=void 0;for(p=0;p<c.length&&!(c[p]-this.get_currentZoom()>=.05);p++);var d=c[p%=c.length];this._zoomFlag=d===l?1:d===u?2:0,this.updateZoom(d)}return 32},t.prototype.updateZoom=function(e,t){void 0===t&&(t=0),e<this._app.theConfig.minimumZoom?e=this._app.theConfig.minimumZoom:e>this._app.theConfig.maximumZoom&&(e=this._app.theConfig.maximumZoom);var i=!(2&t),r=i?this.repositionScrollbars(this.get_currentZoom(),e):null,o=!!(1&t);!o&&this._isInitZoomLogged&&this.get_currentZoom()!==e&&D.ULS.sendTraceTag(25236179,353,50,'{{"ZoomedThroughViewer":1 , "OldViewerZoom":{0}, "NewViewerZoom":{1}, "ZoomFlag":{2}}}',this.get_currentZoom(),e,ce[this._zoomFlag]),this._isInitZoomLogged||(D.ULS.sendTraceTag(25236180,353,50,'Zoom properties on boot. {{"ZoomFlag":{0},"ZoomLevel":{1}}}',ce[this._zoomFlag],e),this._isInitZoomLogged=!0);var a=this.get_currentZoom();this.set_currentZoom(e);var s=i?O.cv:O.iy,l=i?O.sV:O.cY,u=i?O.zp:O.dJ;if(this.actionManager.processAction(s,2),this.actionManager.processAction(l,2),i&&this.actionManager.processActionWithData(O.vx,2,new G.y(r[0],r[1])),this.actionManager.processAction(O.wQ,2),this.actionManager.processAction(u,2),this.actionManager.processAction(O.KG,2),this.actionManager.processAction(O.Hn,2),!o&&this.get_currentZoom()!==a){var c={newLevel:this.get_currentZoom(),oldLevel:a};this.appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this._lazyPostMessenger.get_value().sendMessageWithRetry(be.a.zoomChangeEvent,c):this._lazyPostMessenger.get_value().sendMessage(be.a.zoomChangeEvent,c)}!(4&t)&&n(941).App.get_activeAppFrame().get_statusBarUser()&&n(941).App.get_activeAppFrame().get_statusBarUser().pollZoomControl()},t.prototype.populateZoomFlyout=function(e,t,n,i,r){if(1===n)return 2===this._app.get_status()?32:8;var o=[Ce.oG("btnZoom200","3006111724",200),Ce.oG("btnZoom150","3006111724",150),Ce.oG("btnZoom100","3006111724",100),Ce.oG("btnZoom75","3006111724",75),Ce.oG("btnZoom50","3006111724",50)],a=Ce.IV("msZoom.Controls",o),s=Ce.OU("msZoom",a,null),l=[Ce.yL("fseaFitHeight","2719151194",WordViewerIntl.WordViewerStrings.L_FitHeight),Ce.yL("fseaFitWidth","2289035997",WordViewerIntl.WordViewerStrings.L_FitWidth)],u=Ce.IV("msZoomFit.Controls",l),c=[s,Ce.OU("msZoomFit",u,null)],p=Ce.wF(c,"menuZoom");return r.PopulationXML=p,32},t.prototype.setMaximumZoom=function(e){this._app.theConfig.minimumZoom<=e&&(this._app.theConfig.maximumZoom=e,this.updateZoom(this.get_currentZoom()))},t.prototype.setMinimumZoom=function(e){e<=0||e<=this._app.theConfig.maximumZoom&&(this._app.theConfig.minimumZoom=e,this.updateZoom(this.get_currentZoom()))},t.prototype.repositionScrollbars=function(e,t){var i=n(941).App.get_activeAppFrame().get_workspace().getCurrentPage(),r=t/e,o=[];if(n(941).App.get_activeAppFrame()){var a=this.get_scrollControl().getScrollTop(),s=this.get_scrollControl().getScrollLeft(),l=this.get_scrollControl().getWidth();if(a<this._app.theConfig.pageGapPixels/2)o[0]=a;else{var u=Math.round((i-.5)*this._app.theConfig.pageGapPixels);o[0]=Math.round((a-u)*r)+u}var c=this._documentDataUtils.getPageWidthAtZoom(i,t)+2*this._app.theConfig.marginPixels;if(l>c)o[1]=0;else{var p=1*s/(this._documentDataUtils.getPageWidthAtZoom(i,e)+2*this._app.theConfig.marginPixels-l);o[1]=p*(c-l)}}else o[0]=0,o[1]=0;return o},t.prototype.setCustomZoom=function(e,t,n,i,o){var a=o;if(this._useSetCustomZoomArgs){if(!r.r(ue,o))return D.ULS.sendTraceTag(51644239,353,10,"actiondata is not a SetCustomZoomArgs"),8;a=o.get_zoom()}return this._isThroughZoomDialog=!0,this.onZoomChange(e,t,n,i,a)},t.prototype.zoomToFit=function(e,t,n,i,r){return this._isThroughZoomDialog=!0,this.onFitFullPage(e,t,n,i,r)},t.prototype.zoomToPageWidth=function(e,t,n,i,r){return this._isThroughZoomDialog=!0,this.onFitPageWidth(e,t,n,i,r)},t.prototype.initializeActor=function(){new Se(this.actionManager,this,this.appSettingsManager).registerActions()},t}(fe);(0,r.l)(Te,"ZoomControl",fe,[a.e,P.w,Sys.IDisposable]);var we=(0,r.y)("IDisplayManager"),Ie=n(917),Ee=n(873),ke=n(197),De=n(405),Me=n(851),Pe=n(134),Fe=function(){function e(e,t,i,o){if(this._elementId="viewerContents",this._url=null,this._fullFilename=null,this._parent=null,this._pdfElement=null,this._disposed=!1,this._isJsApi=!1,this._isCoreMode=!1,this._appSettingsManager=null,this._focusManager=null,this._postMessenger=null,this._parent=e,this._appSettingsManager=t,this._focusManager=i,this._postMessenger=o,this._fullFilename=p.AFrameworkApplication.fileName,this._isCoreMode=this._appSettingsManager.getBooleanAppSetting("IsCoreMode"),this._isJsApi=this._appSettingsManager.getBooleanAppSetting("IsJsApi"),this._url="WordViewer/Document.pdf?"+t.getStringAppSetting("BaseDocQueryParam"),this._url=Me.n.addOrReplaceParameterValue(this._url,"type",t.getBooleanAppSetting("IsSmallView")||t.getBooleanAppSetting("IsNoChrome")?"accessprintpdf":"accesspdf"),this._url=Me.n.addOrReplaceParameterValue(this._url,"language",t.getStringAppSetting("TranslationLanguage")),D.ULS.sendTraceTag(20820060,301,50,"Sending request for the PDF in accessible mode."),!De.k.doRequest(this._url,r.i(this,this.onRequestComplete,"onRequestComplete"),n(941).App.get_activeAppFrame().get_notificationBar())){var a="We failed to send the request for the PDF in accessible mode.";this.showErrorDialogAndLogMessage(a),a+=String.format(" URL: {0}",this._url),Ie.u.propagateError(!0,"RequestFailed",Ee.p.downloadAccessiblePdfViewFailed,a)}}return e.prototype.get_currentPage=function(){return 1},e.prototype.get_endPage=function(){return 1},e.prototype.get_startPage=function(){return 1},e.prototype.get_outerElementID=function(){return this._elementId},e.prototype.onRequestComplete=function(e,t,i){var r=this;if(!this._disposed){if(!e){var o=String.format("The request for the PDF in accessible mode failed. HTTP Status: {0} Request Status: {1}",i.httpStatus,i.status);return this.showErrorDialogAndLogMessage(o),void Ie.u.propagateError(!0,"RequestFailed",Ee.p.downloadAccessiblePdfViewFailed,o)}var a=i.responseXml,s=null;if(a&&(s=a.selectSingleNode("/docdata")),s){o=String.format("The request for the PDF in accessible mode never returned the PDF. HTTP Status: {0} Request Status: {1}",i.httpStatus,i.status);D.ULS.sendTraceTag(20480266,301,10,o),Ie.u.showErrorDialog(a),Ie.u.propagateError(!0,"RequestFailed",Ee.p.downloadAccessiblePdfViewFailed,o)}else{if(n(941).App.reportFirstPageAndRenderTime(),p.AFrameworkApplication.reportDocumentLoadedTime(),this._pdfElement=document.createElement("object"),this._pdfElement.id=this._elementId,this._pdfElement.title=String.format("{0} {1}",this._fullFilename,CommonUIStrings.l_AppTitle),this._pdfElement.setAttribute(Pe.t.ariaRoleAttribute,Pe.t.ariaDocumentRole),this._pdfElement.setAttribute("type","application/pdf"),this._pdfElement.setAttribute("data",this._url+"#page="+n(941).App.initialPageNumber),this._pdfElement.setAttribute("height","100%"),this._pdfElement.setAttribute("width","100%"),this._pdfElement.tabIndex=0,this._pdfElement.style.display="none",this._parent.appendChild(this._pdfElement),this._pdfElement.style.display="",p.AFrameworkApplication.dismissSplashScreen(),w.y.get_isInternetExplorerEdge()){var l=new ke.DOMFocusListing((function(){return r._parent}));l.addValidTag(11);var u=this._focusManager.buildRegion(this._parent,this._focusManager.getScope(H.AFrame.documentFocusID),l);u.contained=!1,u.looped=!1,l.trySetCurrentElement(this._pdfElement)}else this._pdfElement.focus();this._postMessenger.reportAppCompleted()}}},e.prototype.showErrorDialogAndLogMessage=function(e){D.ULS.sendTraceTag(20480267,301,10,e),Ie.u.showErrorDialogEx(Ee.p.downloadAccessiblePdfViewFailed,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorDialogMessage)},e.prototype.dispose=function(){this._disposed||(this._parent=null,this._pdfElement=null,this._disposed=!0)},e}();(0,r.l)(Fe,"DisplayManagerPdf",null,[we,Sys.IDisposable]);var xe=function(){function e(){this.pageImage=null,this.waitImage=null,this.isPageImageErrorHandlerAdded=!1}return e.prototype.dispose=function(){this.pageImage=null,this.waitImage=null},e}();(0,r.l)(xe,"ImageSet",null,[Sys.IDisposable]);var Re=n(191),Be=n(772),Le=n(722),Ne=n(179),Ue=n(713),Oe=n(829),He=function(e,t){return e.createElement(t.toString())},We=function(){function e(e){this._tagName=null,this._tagName=e}return e.prototype.toString=function(){return this._tagName},e.a=new e("a"),e.br=new e("br"),e.col=new e("col"),e.colgroup=new e("colgroup"),e.div=new e("div"),e.img=new e("img"),e.li=new e("li"),e.ol=new e("ol"),e.p=new e("p"),e.path=new e("path"),e.span=new e("span"),e.svg=new e("svg"),e.table=new e("table"),e.tbody=new e("tbody"),e.td=new e("td"),e.tr=new e("tr"),e.ul=new e("ul"),e}();(0,r.l)(We,"DomTagName",null,[]);var Ve=function(e,t,n,i,r){var o=["FShadowLeftInner","FShadowLeftOuter","FShadowTopLeftInner","FShadowTopLeftOuter","FShadowTopInner","FShadowTopOuter","FShadowTopRightInner","FShadowTopRightOuter","FShadowRightInner","FShadowRightOuter","FShadowBottomRightInner","FShadowBottomRightOuter","FShadowBottomInner","FShadowBottomOuter","FShadowBottomLeftInner","FShadowBottomLeftOuter"],a=[t,t,t&&n,t&&n,n,n,n&&i,n&&i,i,i,i&&r,i&&r,r,r,r&&t,r&&t],s=He(e,We.div);s.className="WACPageBorder";for(var l=0;l<o.length;l++)if(a[l]){var u=He(e,We.div);u.className=o[l],s.appendChild(u)}return s},$e=function(){function e(e,t,n,i,o,a,s,l,u,c){this._cachePageCount=0,this._parent=null,this._startPage=1,this._currentPage=1,this._oldPage=1,this._isBootFinished=!1,this._images=null,this._isDisposed=!1,this._pageImageLoadedHandler=null,this._pageImageErrorHandler=null,this._retryRequest=null,this._appSettingsManager=null,this._actionManager=null,this._focusManager=null,this._postMessenger=null,this._documentDataUtils=null,this._theConfig=null,this._theDocument=null,this._lazyZoomControl=null,this._lazyScrollControl=null,this._elementId=null,this._parent=e,this._appSettingsManager=t,this._actionManager=n,this._focusManager=i,this._postMessenger=o,this._documentDataUtils=a,this._lazyZoomControl=s,this._lazyScrollControl=l,this._theConfig=u,this._theDocument=c,this._elementId=this._parent?this._parent.id:"",this._images=[],this._actionManager.addActionWithFlags(O.Mn,N.d.application,r.i(this,this.onScroll,"onScroll"),96),this._actionManager.addActionWithFlags(O.sV,N.d.application,r.i(this,this.resizeCache,"resizeCache"),96),this._actionManager.addActionWithFlags(O.cY,N.d.application,r.i(this,this.resizeCacheWithoutAnimation,"resizeCacheWithoutAnimation"),96),this._actionManager.addActionWithFlags(O.vI,N.d.application,r.i(this,this.setCurrentPage,"setCurrentPage"),8),this._pageImageLoadedHandler=r.i(this,this.onPageImgLoaded,"onPageImgLoaded"),this._pageImageErrorHandler=r.i(this,this.onPageImgLoadError,"onPageImgLoadError")}return e.prototype.get_currentPage=function(){return this._currentPage},e.prototype.get_endPage=function(){return this._startPage+this._cachePageCount-1},e.prototype.get_startPage=function(){return this._startPage},e.prototype.get_outerElementID=function(){return this._elementId},e.prototype.get_zoomControl=function(){return this._lazyZoomControl.get_value()},e.prototype.get_scrollControl=function(){return this._lazyScrollControl.get_value()},e.prototype.calculatePageCount=function(){var e=this.get_zoomControl().get_currentZoom(),t=n(941).App.get_activeAppFrame().get_workspace(),i=Math.ceil(t.getHeight()/(this._documentDataUtils.get_minPageHeight()*e));return 1+this._theConfig.pagesToCacheBefore+this._theConfig.pagesToCacheAfter+i},e.prototype.resizeCache=function(e,t,n,i,r){return this.resizeCacheInternal(e,!0)},e.prototype.resizeCacheWithoutAnimation=function(e,t,n,i,r){return this.resizeCacheInternal(e,!1)},e.prototype.resizeCacheInternal=function(e,t){if(this.get_scrollControl().get_resizingScroller())return this.updateImages(this._startPage,t),32;var i,r=this._startPage,o=this._cachePageCount,a=this.get_zoomControl().get_currentZoom();i=n(941).App.get_activeAppFrame()?this.get_scrollControl().getFutureScrollTop():0;var s=this._documentDataUtils.getPageFromScrollTop(i,a),l=Math.min(this.calculatePageCount(),this._documentDataUtils.get_pageCount());if(l!==this._cachePageCount){var u=Math.max(1,s-this._theConfig.pagesToCacheBefore),c=(u=Math.min(u,1+this._documentDataUtils.get_pageCount()-l))+l,p=this._startPage+this._cachePageCount;this._startPage<u&&this.removeImages(this._startPage,Math.min(u,p)),c<p&&this.removeImages(Math.max(c,this._startPage),p),u<this._startPage&&this.addImages(u,Math.min(c,this._startPage)),p<c&&this.addImages(Math.max(p,u),c),this._startPage=u,this._cachePageCount=l}s!==this._currentPage&&(this._oldPage=this._currentPage,this._currentPage=s,this.callSetPage()),this.updateImages(this._startPage,t);var d=n(941).App.get_activeAppFrame().thePageInfoCache;return d&&e!==Le.ActionManager.nullAction&&d.removeFromCache(r,r+o-1),32},e.prototype.addImages=function(t,n){for(var i=n-t,r=this._startPage<t?this._images.length:0,o=0;o<i;o++){var a=Ve(this._parent.ownerDocument,!0,!0,!0,!0);this._parent.appendChild(a);var s=document.createElement("img");s.id="i"+(t+o),s.className="WACPageImg",s.style.display="inline",s.style.visibility="hidden",re.n.addHandler(s,"load",this._pageImageLoadedHandler),a.appendChild(s),re.n.addHandler(s,"error",this._pageImageErrorHandler);var l=e.createWaitElement(t+o,this._parent);this._parent.appendChild(l);var u=new xe;u.pageImage=s,u.waitImage=l,u.isPageImageErrorHandlerAdded=!0,Array.insert(this._images,o+r,u)}},e.prototype.removeImages=function(e,t){for(var n=e;n<t;n++){for(var i=0,r=0;r<this._images.length;r++){if(this._images[r].pageImage.id.substr(1)===n.toString()){i=r;break}}var o=this._images[i];Array.removeAt(this._images,i),re.n.removeHandler(o.pageImage,"load",this._pageImageLoadedHandler),o.isPageImageErrorHandlerAdded&&(re.n.removeHandler(o.pageImage,"error",this._pageImageErrorHandler),o.isPageImageErrorHandlerAdded=!1),this._parent.removeChild(o.pageImage.parentNode),this._parent.removeChild(o.waitImage)}},e.prototype.updateImages=function(e,t){if(this._startPage===e&&1===this._startPage)for(var i=0;i<this._cachePageCount;i++)this.swapImages(e+i,i,0,t);else if(this._startPage===e||this._startPage+this._cachePageCount-1<e||e+this._cachePageCount-1<this._startPage){for(i=this._theConfig.pagesToCacheBefore;i<this._cachePageCount;i++)this.swapImages(e+i,i,0,t);for(i=this._theConfig.pagesToCacheBefore-1;0<=i;i--)this.swapImages(e+i,i,0,t)}else if(e<this._startPage)for(i=r=this._startPage-e-1;i>=0;i--)this.swapImages(e+i,Number.NaN,1,t);else{var r=e-this._startPage-1,o=e+this._cachePageCount-1;for(i=r;i>=0;i--)this.swapImages(o-i,Number.NaN,2,t)}var a=n(941).App.get_activeAppFrame().thePageInfoCache,s=e+this._cachePageCount-1;a&&a.addToCache(e,s),n(941).App.get_activeAppFrame().get_workspace().pageCacheChanged(e,s)},e.prototype.swapImages=function(e,t,n,i){var r;if(n){var o=1===n?this._images.length-1:0,a=1===n?0:this._images.length-1;r=this._images[o],Array.removeAt(this._images,o),Array.insert(this._images,a,r)}else r=this._images[t];var s="i"+e;s!==r.pageImage.id&&(re.n.removeHandler(r.pageImage,"load",this._pageImageLoadedHandler),r.isPageImageErrorHandlerAdded&&(re.n.removeHandler(r.pageImage,"error",this._pageImageErrorHandler),r.isPageImageErrorHandlerAdded=!1),r.pageImage.id=s,r.waitImage.id="wait"+e,re.n.addHandler(r.pageImage,"load",this._pageImageLoadedHandler),r.isPageImageErrorHandlerAdded||(re.n.addHandler(r.pageImage,"error",this._pageImageErrorHandler),r.isPageImageErrorHandlerAdded=!0));var l=Oe.w.urlForNamedObject("p"+e+".img");p.AFrameworkApplication.logUniqueFlightedSettingUsage("Microsoft.Office.Web.WordViewer.IWacWordViewerUpdateAccessTokenInEditedImageUrlSettings"),this._appSettingsManager.getBooleanAppSetting("UpdateAccessTokenInEditedImageUrlIsEnabled")&&(Me.n.getParameterValue(l,p.AFrameworkApplication.accessTokenParamName)&&(l=Me.n.addOrReplaceParameterValue(l,p.AFrameworkApplication.accessTokenParamName,encodeURIComponent(p.AFrameworkApplication.get_accessToken()))),Me.n.getParameterValue(l,p.AFrameworkApplication.accessTokenTtlParamName)&&(l=Me.n.addOrReplaceParameterValue(l,p.AFrameworkApplication.accessTokenTtlParamName,p.AFrameworkApplication.get_accessTokenTtl().toString()))),this.setPagePosition(r.pageImage,e,!1,i),r.pageImage.src.endsWith(l)||(r.waitImage.style.display="inline",r.pageImage.src=l),this.setPagePosition(r.waitImage,e,!0,i)},e.prototype.alignPageHorizontally=function(e){var t=this.get_zoomControl().get_currentZoom();return this._documentDataUtils.getPageLeftAtZoom(e,t,!1)},e.prototype.onScroll=function(e,t,i,r,o){if(this.get_scrollControl().get_resizingScroller())return 32;var a=o,s=Math.max(0,a.scrollTop),l=!1;if(n(941).App.get_activeAppFrame()){var u=this._documentDataUtils.getPageFromScrollTop(s+20,this.get_zoomControl().get_currentZoom());u!==this._currentPage&&(this._oldPage=this._currentPage,this._currentPage=u,l=!0)}else this._currentPage=1;var c=Math.max(1,this._currentPage-this._theConfig.pagesToCacheBefore);if((c=Math.min(c,1+this._documentDataUtils.get_pageCount()-this._cachePageCount))!==this._startPage){var p=n(941).App.get_activeAppFrame().thePageInfoCache;this.updateImages(c,!1);var d=this._startPage;this._startPage=c,p.removeFromCache(d,Math.min(this._startPage,d+this._cachePageCount-1)),p.removeFromCache(Math.max(this._startPage+this._cachePageCount-1,d),d+this._cachePageCount-1)}return l&&this.callSetPage(),this._appSettingsManager.getBooleanAppSetting("BroadcastMode")&&this._actionManager.processActionWithData(O.Pb,2,new Q.v(this._currentPage,new G.y(s,a.scrollLeft),0)),32},e.prototype.callSetPage=function(){var e={newPage:this._currentPage,oldPage:this._oldPage};this._appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this._postMessenger.sendMessageWithRetry(be.a.pageChangeEvent,e):this._postMessenger.sendMessage(be.a.pageChangeEvent,e),n(941).App.get_activeAppFrame().get_statusBarUser()&&n(941).App.get_activeAppFrame().get_statusBarUser().pollControl(U.m.pageInfoLabel)},e.prototype.setCurrentPage=function(e,t,i,r,o){var a=o;if(n(941).App.get_activeAppFrame().get_workspace()&&n(941).App.get_activeAppFrame().get_workspace().get_initialized()){if(a>0&&a<=this._documentDataUtils.get_pageCount())return this.get_scrollControl().scrollToPage(a),32;this.raisePageChangeError({errorType:"InvalidPageIndex",newPage:a,pageCount:this._documentDataUtils.get_pageCount()})}else D.ULS.sendTraceTag(35149196,301,10,"AppInitError: SetCurrentPageError"),this._postMessenger.sendError({errorType:"AppInitError",errorObject:{Message:"App was likely not fully initialized when SetCurrentPage was called"}});return 16},e.prototype.raisePageChangeError=function(e){var t=n(941).App.get_activeAppFrame().getTopParagraphId();t&&(e.topParagraphId=t);var i={errorType:"PageChangeError",errorObject:e};D.ULS.sendTraceTag(35149197,301,10,JSON.stringify(i)),this._postMessenger.sendError(i)},e.prototype.dispose=function(){if(!this._isDisposed){for(var e=0;e<this._images.length;e++){var t=this._images[e];re.n.removeHandler(t.pageImage,"load",this._pageImageLoadedHandler),t.isPageImageErrorHandlerAdded&&(re.n.removeHandler(t.pageImage,"error",this._pageImageErrorHandler),t.isPageImageErrorHandlerAdded=!1),t.dispose()}this._images&&(Array.clear(this._images),this._images=null),this._pageImageLoadedHandler=null,this._pageImageErrorHandler=null,this._isDisposed=!0,this._parent=null}},e.prototype.setPagePosition=function(e,t,n,i){var r=this.get_zoomControl().get_currentZoom(),o=this._documentDataUtils.getPageTopAtZoom(t,r),a=this._documentDataUtils.getPageWidthAtZoom(t,r),s=this._documentDataUtils.getPageHeightAtZoom(t,r);if(i?j.r.animateSize(e,s,a):(e.style.height=s+"px",e.style.width=a+"px"),n){if(e.children.length>0){i?j.r.animatePosition(e,this.alignPageHorizontally(t),o):(e.style.top=o+"px",p.AFrameworkApplication.get_isRtl()?e.style.right=this.alignPageHorizontally(t)+"px":e.style.left=this.alignPageHorizontally(t)+"px");var l=e.lastChild;l.id&&""!==l.id.trim()||(l.id="WACProgress"+l.parentNode.id),i?j.r.animatePosition(l,a/2,.3*s):(l.style.top=.3*s+"px",p.AFrameworkApplication.get_isRtl()?l.style.right=a/2+"px":l.style.left=a/2+"px")}}else i?(j.r.animateSize(e.parentNode,s,a),j.r.animatePosition(e.parentNode,this.alignPageHorizontally(t),o)):(e.parentNode.style.height=s+"px",e.parentNode.style.width=a+"px",e.parentNode.style.top=o+"px",p.AFrameworkApplication.get_isRtl()?e.parentNode.style.right=this.alignPageHorizontally(t)+"px":e.parentNode.style.left=this.alignPageHorizontally(t)+"px")},e.prototype.onRetrySuccessful=function(e){this._retryRequest=null;for(var t=0;t<this._cachePageCount;t++){var n=this._images[t];n.isPageImageErrorHandlerAdded&&(re.n.removeHandler(n.pageImage,"error",this._pageImageErrorHandler),n.isPageImageErrorHandlerAdded=!1),n.pageImage.src="",n.pageImage.src=Oe.w.urlForNamedObject("p"+(t+this._startPage)+".img")}},e.prototype.onPageImgLoadError=function(e){var t=e.rawEvent.srcElement,n=parseInt(t.id.substr(1));isNaN(n)||n<1||n>this._theDocument.get_pageCount()||this._retryRequest||(this._retryRequest=new Be.b(r.i(this,this.onRetrySuccessful,"onRetrySuccessful"),t.src),this._retryRequest.send())},e.prototype.onPageImgLoaded=function(e){if(e)if(e.rawEvent)if(e.rawEvent.srcElement){var t=e.rawEvent.srcElement;if(t)if(t.id&&t.id.substr(1)){var i=parseInt(t.id.substr(1));if(!(isNaN(i)||i<1||i>this._theDocument.get_pageCount())){this._isBootFinished||i!==n(941).App.initialPageNumber?5===i&&p.AFrameworkApplication.theWsaClient.setBool(8810,1):(this._isBootFinished=!0,n(941).App.reportFirstPageAndRenderTime(),p.AFrameworkApplication.reportDocumentLoadedTime(),Ue.t.mark(5039),Ne.PageStats.endRootMeasurement("Load"),this._appSettingsManager.getBooleanAppSetting("IsJsApiV2")?this._postMessenger.sendMessageWithRetry(be.a.appStateEvent,{pageCount:this._documentDataUtils.get_pageCount(),newPage:this.get_currentPage(),newLevel:this.get_zoomControl().get_currentZoom()}):(this._postMessenger.sendPageCountWithRetry(new Re.z(be.a.pageCountEvent,{pageCount:this._documentDataUtils.get_pageCount()},r.i(this._postMessenger,this._postMessenger.sendPageCountWithRetry,"sendPageCountWithRetry"))),this._postMessenger.sendPageChangeWithRetry(new Re.z(be.a.pageChangeEvent,{newPage:this.get_currentPage()},r.i(this._postMessenger,this._postMessenger.sendPageChangeWithRetry,"sendPageChangeWithRetry"))),this._postMessenger.sendZoomChangeWithRetry(new Re.z(be.a.zoomChangeEvent,{newLevel:this.get_zoomControl().get_currentZoom()},r.i(this._postMessenger,this._postMessenger.sendZoomChangeWithRetry,"sendZoomChangeWithRetry")))),this._postMessenger.reportAppCompleted(),this.updateImages(this._startPage,!1),this._actionManager.processAction(O.ON,2),n(941).App.initialScrollTop&&(this._actionManager.processActionWithData(O.vx,2,new G.y(n(941).App.initialScrollTop,Number.NaN)),n(941).App.initialScrollTop=0),n(941).App.hideFirstPageImage(),p.AFrameworkApplication.dismissSplashScreen()),i===this._theDocument.get_pageCount()&&p.AFrameworkApplication.theWsaClient.setBool(8811,1),i===this._currentPage&&Ue.t.mark(5043),i===this._theDocument.get_pageCount()&&Ue.t.mark(5041),this.setPagePosition(t,i,!1,!0),t.style.display="inline",t.style.visibility="visible";var o="wait"+i,a=document.getElementById(o);a&&(a.style.display="none")}}else D.ULS.sendTraceTag(21570585,301,10,"Image element has null ID");else D.ULS.sendTraceTag(21570583,301,10,"Image element of dom event is null")}else D.ULS.sendTraceTag(21570581,301,10,"DomEvent's srcSlement is null");else D.ULS.sendTraceTag(25190429,301,10,"DomEvent's RawEvent is null");else D.ULS.sendTraceTag(21570579,301,10,"DomEvent on page image loaded is null")},e.createWaitElement=function(e,t){var n=Ve(t.ownerDocument,!0,!0,!0,!0);return n.id="wait"+e.toString(),n.style.display="none",n.appendChild(Ie.u.createWaitImage()),n},e}();(0,r.l)($e,"DisplayManagerPng",null,[we,Sys.IDisposable]);var Ke=function(){function e(e,t,n,i,r,o,a,s,l){this._appSettingsManager=null,this._actionManager=null,this._focusManager=null,this._postMessenger=null,this._documentDataUtils=null,this._lazyZoomControl=null,this._lazyScrollControl=null,this._theConfig=null,this._theDocument=null,this._appSettingsManager=e,this._actionManager=t,this._focusManager=n,this._postMessenger=i,this._documentDataUtils=r,this._lazyZoomControl=o,this._lazyScrollControl=a,this._theConfig=s,this._theDocument=l}return e.prototype.create=function(e,t){switch(e){case 0:return new $e(t,this._appSettingsManager,this._actionManager,this._focusManager,this._postMessenger,this._documentDataUtils,this._lazyZoomControl,this._lazyScrollControl,this._theConfig,this._theDocument);case 1:return new Fe(t,this._appSettingsManager,this._focusManager,this._postMessenger)}return null},e}();(0,r.l)(Ke,"DisplayManagerFactory",null,[F]);var ze=n(219),qe=n(250),Qe=function(){function e(e,t,n,i){this._hostPostmessenger=null,this._actionManager=null,this._appSettingsManager=null,this._pageLoadPerfRecorder=null,this._isJsApi=!1,this._isJsApiV2=!1,this._isCoreMode=!1,this._ackMessageTimeoutInMs=1e3,this._postMessageMaxRetries=4,this._appCompleteAckMessageReceived=!1,this._appFailedAckMessageReceived=!1,this._zoomChangeAckMessageReceived=!1,this._pageChangeAckMessageReceived=!1,this._pageCountAckMessageReceived=!1,this._isJsApi=n.getBooleanAppSetting("IsJsApi"),this._isJsApiV2=n.getBooleanAppSetting("IsJsApiV2"),this._isCoreMode=n.getBooleanAppSetting("IsCoreMode"),this._actionManager=e,this._hostPostmessenger=t,this._appSettingsManager=n,this._pageLoadPerfRecorder=i,this._isJsApi&&(this._hostPostmessenger.addAllowedReceivingMessage(be.a.setZoomLevel),this._hostPostmessenger.addAllowedReceivingMessage(be.a.setCurrentPage),this._hostPostmessenger.addAllowedReceivingMessage(be.a.hostCacheDiagnostic),this._hostPostmessenger.registerCallback(be.a.setZoomLevel,r.i(this,this.setZoomLevelHandler,"setZoomLevelHandler")),this._hostPostmessenger.registerCallback(be.a.setCurrentPage,r.i(this,this.setCurrentPageHandler,"setCurrentPageHandler")),this._hostPostmessenger.registerCallback(be.a.hostCacheDiagnostic,r.i(this,this.recordFastBootDiagnostic,"recordFastBootDiagnostic")),this._isJsApiV2||(this._hostPostmessenger.addAllowedReceivingMessage(be.a.wacAppCompletedAck),this._hostPostmessenger.addAllowedReceivingMessage(be.a.wacAppFailedAck),this._hostPostmessenger.addAllowedReceivingMessage(be.a.zoomChangeEventAck),this._hostPostmessenger.addAllowedReceivingMessage(be.a.pageChangeEventAck),this._hostPostmessenger.addAllowedReceivingMessage(be.a.pageCountEventAck),this._hostPostmessenger.registerCallback(be.a.wacAppCompletedAck,r.i(this,this.receiveAckMessages,"receiveAckMessages")),this._hostPostmessenger.registerCallback(be.a.wacAppFailedAck,r.i(this,this.receiveAckMessages,"receiveAckMessages")),this._hostPostmessenger.registerCallback(be.a.zoomChangeEventAck,r.i(this,this.receiveAckMessages,"receiveAckMessages")),this._hostPostmessenger.registerCallback(be.a.pageChangeEventAck,r.i(this,this.receiveAckMessages,"receiveAckMessages")),this._hostPostmessenger.registerCallback(be.a.pageCountEventAck,r.i(this,this.receiveAckMessages,"receiveAckMessages"))))}return e.prototype.sendMessage=function(e,t){this._isJsApi&&this._hostPostmessenger.sendMessage(e,t)},e.prototype.sendMessageWithRetry=function(e,t){this._hostPostmessenger.sendMessageWithRetry(e,t)},e.prototype.sendError=function(e){this.sendMessage("Error",e)},e.prototype.sendErrorWithRetry=function(e){this.sendMessageWithRetry("Error",e)},e.prototype.receiveAckMessages=function(e){switch(D.ULS.sendTraceTag(38318928,301,50,"Ack received: {0}.",e.MessageId),e.MessageId){case be.a.wacAppCompletedAck:this._appCompleteAckMessageReceived=!0;break;case be.a.wacAppFailedAck:this._appFailedAckMessageReceived=!0;break;case be.a.zoomChangeEventAck:this._zoomChangeAckMessageReceived=!0;break;case be.a.pageChangeEventAck:this._pageChangeAckMessageReceived=!0;break;case be.a.pageCountEventAck:this._pageCountAckMessageReceived=!0;break;default:D.ULS.sendTraceTag(38318929,301,15,"Received unhandled message "+e.MessageId+" from host")}},e.prototype.setZoomLevelHandler=function(e){if(!this._isJsApi||!this._isCoreMode)throw Error.invalidOperation("JsApi core mode is not enabled");if(e.Values&&qe.t.newZoomLevel in e.Values){var t=e.Values[qe.t.newZoomLevel];this._actionManager.processActionWithData(O.oW,2,t)}else{this.sendError({errorType:"ZoomChangeError",errorObject:{errorType:"InvalidArgument"}})}},e.prototype.setCurrentPageHandler=function(e){if(!this._isJsApi||!this._isCoreMode)throw Error.invalidOperation("JsApi core mode is not enabled");if(e.Values&&qe.t.newPage in e.Values){var t=e.Values[qe.t.newPage];this._actionManager.processActionWithData(O.vI,2,t)}else{this.sendError({errorType:"PageChangeError",errorObject:{errorType:"InvalidArgument"}})}},e.prototype.recordFastBootDiagnostic=function(e){e.Values&&qe.t.hostCacheLoadTime in e.Values&&this._pageLoadPerfRecorder.addMetric(ze.c.fastViewOpenTime,e.Values[qe.t.hostCacheLoadTime])},e.prototype.reportAppCompleted=function(e){void 0===e&&(e=!1);var t={},n=this._pageLoadPerfRecorder.getMetric(ze.c.frameRequestStart);null!=n&&(t[qe.t.officeFrameRequestStartTime]=n);var i=this._pageLoadPerfRecorder.getMetric(ze.c.resourceDownloadStart);null!=i&&(t[qe.t.officeFrameFirstFlushTime]=i);var o=this._pageLoadPerfRecorder.getMetric(ze.c.contentViewable);if(t[qe.t.documentLoadedTime]=o||p.AFrameworkApplication.get_documentLoadedTime().getTime(),null==o&&D.ULS.sendTraceTag(36992713,301,15,"DocumentLoadedTime was used since ContentViewable time is null"),e)t[qe.t.ignoreForEUPL]=!0;else{var a=this._pageLoadPerfRecorder.getMetric(ze.c.documentLoadedTime);null!=a&&(t[qe.t.appCompletedTime]=a)}t[qe.t.officeServerVersion]=this._appSettingsManager.getStringAppSetting("BuildVersion"),t[qe.t.officeAppEndpoint]=this._appSettingsManager.getStringAppSetting("WacCluster");var s={Diagnostics:t};this._isJsApiV2?this.sendMessageWithRetry(be.a.wacAppCompleted,s):this.sendAppCompletedWithRetry(new Re.z(be.a.wacAppCompleted,s,r.i(this,this.sendAppCompletedWithRetry,"sendAppCompletedWithRetry")))},e.prototype.sendAppCompletedWithRetry=function(e){var t=this;this._isJsApi&&(window.setTimeout((function(){t.timeoutAckMessage(e,(0,c.m)((function(){return t._appCompleteAckMessageReceived}),(function(e){return t._appCompleteAckMessageReceived=e})))}),this._ackMessageTimeoutInMs),this._appCompleteAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)},e.prototype.sendAppFailedWithRetry=function(e){var t=this;this._isJsApi&&(window.setTimeout((function(){t.timeoutAckMessage(e,(0,c.m)((function(){return t._appFailedAckMessageReceived}),(function(e){return t._appFailedAckMessageReceived=e})))}),this._ackMessageTimeoutInMs),this._appFailedAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)},e.prototype.sendZoomChangeWithRetry=function(e){var t=this;this._isJsApi&&this._isCoreMode&&(window.setTimeout((function(){t.timeoutAckMessage(e,(0,c.m)((function(){return t._zoomChangeAckMessageReceived}),(function(e){return t._zoomChangeAckMessageReceived=e})))}),this._ackMessageTimeoutInMs),this._zoomChangeAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)},e.prototype.sendPageChangeWithRetry=function(e){var t=this;this._isJsApi&&this._isCoreMode&&(window.setTimeout((function(){t.timeoutAckMessage(e,(0,c.m)((function(){return t._pageChangeAckMessageReceived}),(function(e){return t._pageChangeAckMessageReceived=e})))}),this._ackMessageTimeoutInMs),this._pageChangeAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)},e.prototype.sendPageCountWithRetry=function(e){var t=this;this._isJsApi&&this._isCoreMode&&(window.setTimeout((function(){t.timeoutAckMessage(e,(0,c.m)((function(){return t._pageCountAckMessageReceived}),(function(e){return t._pageCountAckMessageReceived=e})))}),this._ackMessageTimeoutInMs),this._pageCountAckMessageReceived=!1,this.sendMessage(e.messageId,e.payload),e.retryCount++)},e.prototype.timeoutAckMessage=function(e,t){this._isJsApi&&!t.val&&(e.retryCount<this._postMessageMaxRetries?(e.callback(e),D.ULS.sendTraceTag(38318930,301,50,"AckMessageTimeout for {0}. Retry sent. Retries left: {1}",e.messageId,this._postMessageMaxRetries-e.retryCount)):D.ULS.sendTraceTag(38318931,301,15,"AckMessageTimeout for {0}. No retries left.",e.messageId))},e}();(0,r.l)(Qe,"WordViewerPostMessenger",null,[l.e]);var Ge=n(266),je=function(){function e(e,t,n){this._getAccessToken=null,this._getAccessTokenExpiry=null,this._getAccessTokenExpirationPromptSeconds=null,this._isKickedOut=!1,this._isLost=!1,this._eventSource=new me.f,this._getAccessToken=e,this._getAccessTokenExpiry=t,this._getAccessTokenExpirationPromptSeconds=n}return e.prototype.get_isAboutToExpire=function(){return p.AFrameworkApplication.get_isWopiTokenRefreshEnabled()&&p.AFrameworkApplication.get_wopiTokenExpiresAfterMinutes()>0?!this.get_isExpired()&&(new Date).getTime()>=p.AFrameworkApplication.wopiTokenLastRefreshTime+60*p.AFrameworkApplication.get_wopiTokenExpiresAfterMinutes()*1e3:!this.get_isExpired()&&this._getAccessTokenExpiry()>0&&(new Date).getTime()>=this._getAccessTokenExpiry()-1e3*this._getAccessTokenExpirationPromptSeconds()},e.prototype.get_isExpired=function(){return this._getAccessTokenExpiry()>0&&(new Date).getTime()>=this._getAccessTokenExpiry()},e.prototype.get_isKickedOut=function(){return this._isKickedOut},e.prototype.get_isLost=function(){return this._isLost},e.prototype.set_isLost=function(e){return this._isLost=e,e},e.prototype.get_isViable=function(){return!(this.get_isLost()||this.get_isKickedOut()||this.get_isExpired())},e.prototype.kickOut=function(){this._isKickedOut||(this._isKickedOut=!0,this._eventSource.raiseEvent(e.kickOutEventKey))},e.prototype.add_onKickedOut=function(t){this._eventSource.addHandler(e.kickOutEventKey,t)},e.prototype.remove_onKickedOut=function(t){this._eventSource.removeHandler(e.kickOutEventKey,t)},e.get_instance=function(){return e._singletonInstance||(e._singletonInstance=new e((function(){return p.AFrameworkApplication.get_accessToken()}),(function(){return p.AFrameworkApplication.get_accessTokenTtl()}),(function(){return p.AFrameworkApplication.accessTokenExpirationPromptSeconds})))},e.kickOutEventKey="kickedOut",e._singletonInstance=null,e}();(0,r.l)(je,"SessionStatusManager",null,[B.g]);var Ze=function(){function e(){}return e.prototype.configure=function(e){e.register(l.e).singleInstance().usingFactory((function(){return new Qe(p.AFrameworkApplication.get_theActionManager(),e.resolve(M.i),p.AFrameworkApplication.appSettingsManager,Ge.e.get_instance())})),e.register(Te).as(a.e).as(P.w).singleInstance().usingFactory((function(){return new Te(n(941).App.get_instance(),p.AFrameworkApplication.appSettingsManager,p.AFrameworkApplication.get_theActionManager(),e.resolveLazy(l.e),X.t.get_instance())})),e.register(F).singleInstance().usingFactory((function(){return new Ke(p.AFrameworkApplication.appSettingsManager,p.AFrameworkApplication.get_theActionManager(),ie.FocusManager.instance(),e.resolve(l.e),X.t.get_instance(),e.resolveLazy(a.e),e.resolveLazy(s.f),n(941).App.get_instance().theConfig,n(941).App.get_instance().theDocument)})),e.register(s.f).singleInstance().usingFactory((function(){return new se(p.AFrameworkApplication.appSettingsManager,p.AFrameworkApplication.get_theActionManager(),ie.FocusManager.instance(),X.t.get_instance(),e.resolveLazy(a.e),n(941).App.get_instance().theConfig)})),e.register(x).singleInstance().usingFactory((function(){return new K(p.AFrameworkApplication.get_theActionManager(),ie.FocusManager.instance(),X.t.get_instance(),e.resolveLazy(s.f))})),e.register(Z.h).singleInstance().usingFactory((function(){return new Z.h(ie.FocusManager.instance(),e.resolveLazy(F),e.resolveLazy(a.e),e.resolveLazy(x),e.resolveLazy(s.f))})),e.register(R.x).singleInstance().usingFactory((function(){return p.AFrameworkApplication.appSettingsManager})),e.register(B.g).singleInstance().usingFactory((function(){return je.get_instance()}))},e}();(0,r.l)(Ze,"AppComponentConfiguration",null,[L.s]);var Xe=n(752),Je=n(889),Ye=function(e){function t(t){return e.call(this,t)||this}return(0,i.t)(t,e),t.prototype.getBaseDocQuerySignature=function(){return this._clientAppSettings.BaseDocQueryParam},t}(Je.p);(0,r.l)(Ye,"WordViewerAppSettingsManager",Je.p,[]);var et=function(){return function(){this.pageSetSize=4,this.pageSetXmlSize=10,this.marginPixels=10,this.pageGapPixels=20,this.pagesToCacheAfter=1,this.pagesToCacheBefore=1,this.searchPaneWidth=270,this.commentPaneWidth=300,this.commentPaneHorizontalBorderWidth=0,this.commentPaneVerticalBorderWidth=0,this.maximumZoom=4,this.minimumZoom=.1,this.scrollDelay=1,this.scrollOffset=20,this.scrollZone=50,this.scrollMagnitudePerSecond=1e3,this.autoScrollAmount=15,this.selectionTolerance=5,this.keyboardArrowScrollAmount=50,this.searchLookAheadInPagesets=1,this.highlightTaskDelay=25,this.searchTaskDelay=5,this.searchPageIncrement=100,this.searchResultVerticalMultiplier=1.5,this.searchResultHorizontalBuffer=25,this.minCharactersToSearchBeforePausing=200,this.maxParagraphsToSearchBeforePausing=10,this.maxRetryAttempts=22,this.retryIntervalInMSecs=1e3,this.retryIntervalLongInMSecs=2e4,this.retryTimeoutInMSecs=18e4,this.defaultImageDpi=96,this.silverlightURL="https://r.office.microsoft.com/r/rlidWebOfficeSilverlight?clid={0}",this.divLengthLimitInPixels=4e6,this.dpiAspectRatio=4/3}}();(0,r.l)(et,"Config",null,[]);var tt=n(471),nt=n(475),it=n(322),rt=n(77),ot=(0,r.y)("IContext"),at=function(){function e(){}return e.prototype.get_contextId=function(){return ve.a},e.prototype.get_nextContext=function(){return null},e.prototype.get_isContextSet=function(){return!1},e.prototype.get_isGraphNodeContext=function(){return!1},e}();(0,r.l)(at,"FrameContext",null,[ot]);var st=function(){function e(){this._frameContext=new at}return e.prototype.get_contextId=function(){return N.d.application},e.prototype.get_nextContext=function(){return this._frameContext},e.prototype.get_isContextSet=function(){return!1},e.prototype.get_isGraphNodeContext=function(){return!1},e}();(0,r.l)(st,"WordViewerContext",null,[ot]);var lt=function(){function e(e,t,n,i,r){this._pageHeight=0,this._pageWidth=0,this._startPage=0,this._pageCount=0,this._top=0,this._pageHeight=e,this._pageWidth=t,this._startPage=n,this._pageCount=i,this._top=r}return e.prototype.get_pageHeight=function(){return this._pageHeight},e.prototype.set_pageHeight=function(e){return this._pageHeight=e,e},e.prototype.get_pageWidth=function(){return this._pageWidth},e.prototype.set_pageWidth=function(e){return this._pageWidth=e,e},e.prototype.get_startPage=function(){return this._startPage},e.prototype.set_startPage=function(e){return this._startPage=e,e},e.prototype.get_pageCount=function(){return this._pageCount},e.prototype.set_pageCount=function(e){return this._pageCount=e,e},e.prototype.get_top=function(){return this._top},e.prototype.set_top=function(e){return this._top=e,e},e}();(0,r.l)(lt,"ASection",null,[]);var ut=function(){function e(e){this._sections=null,this._pageCount=0,this._totalPageHeight=0,this._maxPageWidth=0,this._minPageHeight=0,this._baseDocQuerySignature=null,this._hasComments=!1,this._isNormalized=!1,this._isProtectedPdf=!1,this._baseDocQuerySignature=e,this._pageCount=0,this._totalPageHeight=0,this._minPageHeight=Number.MAX_VALUE,this._maxPageWidth=Number.MIN_VALUE,this._sections=[]}return e.prototype.get_baseDocQuerySignature=function(){return this._baseDocQuerySignature},e.prototype.get_pageCount=function(){return this._pageCount},e.prototype.get_sectionCount=function(){return this._sections.length-1},e.prototype.get_totalPageHeight=function(){return this._totalPageHeight},e.prototype.get_maxPageWidth=function(){return this._maxPageWidth},e.prototype.get_minPageHeight=function(){return this._minPageHeight},e.prototype.get_hasComments=function(){return this._hasComments},e.prototype.get_isNormalized=function(){return this._isNormalized},e.prototype.get_isProtectedPdf=function(){return this._isProtectedPdf},e.prototype.getSection=function(e){return e>=1&&e<this._sections.length?this._sections[e]:null},e.prototype.init=function(e){if(e){var t=e.selectSingleNode("@dxpInch"),i=e.selectSingleNode("@dypInch"),r=e.selectSingleNode("@pages"),o=parseInt(t.text),a=parseInt(i.text),s=(parseInt(r.text),e.selectSingleNode("@hasComments")),l=e.selectSingleNode("@hasIds"),u=e.selectSingleNode("@isProtectedPdf");if(this._hasComments=!s||Boolean.parse(s.text),this._isNormalized=!!l&&Boolean.parse(l.text),this._isProtectedPdf=!!u&&Boolean.parse(u.text),!n(941).App.get_instance().get_isPdfMode()){var c=new Array(4),d=new Array(4);try{d[0]=e.selectSingleNode("@docHashDw0"),d[1]=e.selectSingleNode("@docHashDw1"),d[2]=e.selectSingleNode("@docHashDw2"),d[3]=e.selectSingleNode("@docHashDw3"),c[0]=parseInt(d[0].text,16),c[1]=parseInt(d[1].text,16),c[2]=parseInt(d[2].text,16),c[3]=parseInt(d[3].text,16)}catch(e){D.ULS.sendTraceTag(5007365,100,15,"Error when parsing dochashDw: {0}",e)}p.AFrameworkApplication.theWsaClient.registerPersistentDocId(c)}for(var h,g,m,_,f,y,v,S,C,b,A=e.selectNodes("pageset"),T=0;T<A.length;T++){if(g=(h=A[T]).selectSingleNode("@width"),m=h.selectSingleNode("@height"),_=h.selectSingleNode("@count"),f=parseInt(g.text),y=parseInt(m.text),v=parseInt(_.text),C=f/o*96,b=y/a*96,T){var w=this._sections[T];S=w.get_top()+w.get_pageHeight()*w.get_pageCount()}else S=0;this._sections[T+1]=new lt(b,C,this._pageCount+1,v,S),b<this._minPageHeight&&(this._minPageHeight=b),C>this._maxPageWidth&&(this._maxPageWidth=C),this._totalPageHeight+=b*v,this._pageCount+=v}}},e}();(0,r.l)(ut,"ADocument",null,[]);var ct=n(496),pt=n(723),dt=n(539),ht=function(){function e(){this._retryRequest=null,this._pageInfoList=[],this._urlRequests={},this._pagesToRequest=[],this._firstSearchPageSet=Number.NaN,this._lastSearchPageSet=Number.NaN,this.buildCache()}return e.prototype.addToCache=function(e,t){for(var n=Ie.u.getPageSetXmlFromPage(e),i=Ie.u.getPageSetXmlFromPage(t),o=n;o<=i;o++)if(!this._pageInfoList[o-1]){Array.add(this._pagesToRequest,o);var a=new de.c(2,1,1,r.i(this,this.requestPage,"requestPage"));p.AFrameworkApplication.get_theTaskManager().addTask(a)}},e.prototype.requestPage=function(e){this._pagesToRequest.length>0&&(this.requestSelectionXmlForPageSet(Oe.w.urlForNamedObject(Ie.u.getPageSetXmlName(this._pagesToRequest[0]))),Array.removeAt(this._pagesToRequest,0))},e.prototype.removeFromCache=function(t,n){for(var i=Ie.u.getPageSetXmlFromPage(t),r=Ie.u.getPageSetXmlFromPage(n),o=i;o<=r;o++)e.isPageSetInViewingCache(o)||e.isPageSetInSelectionCache(o)||this.isPageSetInSearchCache(o)||(this._pageInfoList[o-1]=null)},e.prototype.isPageSetInSearchCache=function(e){var t=e>=this._firstSearchPageSet&&e<=this._lastSearchPageSet;return n(941).App.get_activeAppFrame().get_workspace().searchActive()&&t},e.prototype.removeSearchCache=function(){if(!isNaN(this._firstSearchPageSet)&&!isNaN(this._lastSearchPageSet)){var e=n(941).App.get_instance().theConfig.pageSetSize,t=this._firstSearchPageSet,i=this._lastSearchPageSet;this._firstSearchPageSet=Number.NaN,this._lastSearchPageSet=Number.NaN,this.removeFromCache(t*e,i*e)}},e.prototype.updateSearchCache=function(e){if(isNaN(this._firstSearchPageSet)||isNaN(this._lastSearchPageSet)){var t=this._pageInfoList.length;return this._firstSearchPageSet=1,this._lastSearchPageSet=Math.min(t,this._firstSearchPageSet+n(941).App.get_instance().theConfig.searchLookAheadInPagesets),void this.addToCache(1,this._lastSearchPageSet*n(941).App.get_instance().theConfig.pageSetXmlSize)}var i=n(941).App.get_instance().theConfig.pageSetXmlSize;if(1===i||e%i==1){Ie.u.getPageSetXmlFromPage(e),t=this._pageInfoList.length;this._lastSearchPageSet=Math.min(t,this._lastSearchPageSet+1),this.addToCache(this._lastSearchPageSet*i,this._lastSearchPageSet*i),this.removeFromCache(this._firstSearchPageSet*i,this._firstSearchPageSet*i),this._firstSearchPageSet++}},e.prototype.isPageCached=function(e){var t=Ie.u.getPageSetFromPage(e);return!!this._pageInfoList[t-1]},e.prototype.buildCache=function(){for(var e=Ie.u.getPageSetXmlFromPage(X.t.get_instance().get_pageCount()),t=0;t<e;t++)Array.add(this._pageInfoList,null)},e.prototype.onItemRequestSucceeded=function(t){this._urlRequests[t.get_data().request.get_url()]=!1;var i=t.get_data().responseXml;if(i){De.k.isValidResponseXMLDoc(i)||(i=Sys.Net.XMLDOM(t.get_data().responseData,!0));for(var r=i.getElementsByTagName("Page"),o=Number.NaN,a=0;a<r.length&&(o=parseInt(r[a].attributes.getNamedItem("id").nodeValue),isNaN(o)||!(o>0));a++);if(!isNaN(o)){var s=n(941).App.get_activeAppFrame().get_workspace(),l=Ie.u.getPageSetXmlFromPage(o);if(p.AFrameworkApplication.collectPageStats&&(Ne.PageStats.beginMeasurement("RequestSelectionXML",t.get_data().invokedTime),t.get_data().responseHeaders[pt.h.correlationIdHeaderName]&&Ne.PageStats.addAttribute(dt.a.correlation,t.get_data().responseHeaders[pt.h.correlationIdHeaderName].toString()),t.get_data().responseHeaders[Ne.PageStats.pageStatsResponseXHRHeader]&&Ne.PageStats.addServerMeasurements(t.get_data().responseHeaders[Ne.PageStats.pageStatsResponseXHRHeader].toString()),Ne.PageStats.endMeasurement("RequestSelectionXML")),e.isPageSetInViewingCache(l)||e.isPageSetInSelectionCache(l)||this.isPageSetInSearchCache(l)||n(941).App.initialParagraphId){if(this._pageInfoList[l-1])return;this._pageInfoList[l-1]=i}var u=Ie.u.getStartPageFromPageSetXml(l),c=Ie.u.getEndPageFromPageSetXml(l);if(p.AFrameworkApplication.get_theActionManager().processActionWithData(O.Mj,2,new ct.n(u,c)),p.AFrameworkApplication.get_theActionManager().processActionWithData(O.oA,2,new ct.n(u,c)),n(941).App.initialParagraphId&&p.AFrameworkApplication.get_theActionManager().processActionWithData(O.dc,2,new ct.n(u,c)),n(941).App.get_instance().get_copyingEnabled()&&e.isPageSetInSelectionCache(l)){for(var d=!0,h=Ie.u.getPageSetXmlFromPage(s.getFirstSelectedPage()),g=Ie.u.getPageSetXmlFromPage(s.getLastSelectedPage()),m=h-1;m<g;m++)if(!this._pageInfoList[m]){d=!1;break}d&&p.AFrameworkApplication.get_theActionManager().processAction(O.Yh,2)}}}},e.prototype.onItemRequestFail=function(e){p.AFrameworkApplication.collectPageStats&&(Ne.PageStats.beginMeasurement("RequestSelectionXML",e.get_data().invokedTime),e.get_data().responseHeaders[pt.h.correlationIdHeaderName]&&Ne.PageStats.addAttribute(dt.a.correlation,e.get_data().responseHeaders[pt.h.correlationIdHeaderName].toString()),Ne.PageStats.endMeasurement("RequestSelectionXML")),this._urlRequests[e.get_data().request.get_url()]=!1,this._retryRequest||(this._retryRequest=new Be.b(r.i(this,this.onRetrySuccessful,"onRetrySuccessful"),e.get_data().request.get_url()),this._retryRequest.send())},e.prototype.onRetrySuccessful=function(e){this._retryRequest=null,this.requestSelectionXmlForPageSet(e.name)},e.prototype.getPage=function(e){var t=this.getTextDataForPage(e);return null===t?null:t.selectSingleNode(String.format("/Pages/Page[@id='{0}']",e))},e.prototype.getXmlForPage=function(t){var n=Ie.u.getPageSetXmlFromPage(t)-1;if(this._pageInfoList[n]){var i=e.buildXPathForPageXml(t);return this._pageInfoList[n].selectSingleNode(i)}return null},e.prototype.requestSelectionXmlForPageSet=function(e){this._urlRequests[e]||(this._urlRequests[e]=!0,p.AFrameworkApplication.theClientRequestManager.addRequest(e,1,null,null,!0,2,r.i(this,this.onItemRequestSucceeded,"onItemRequestSucceeded"),r.i(this,this.onItemRequestFail,"onItemRequestFail"),null))},e.prototype.getTextDataForPage=function(e){var t=Ie.u.getPageSetXmlFromPage(e);return t<=0||t>this._pageInfoList.length||!this._pageInfoList[t-1]?null:this._pageInfoList[t-1]},e.prototype.getCopyableHtmlElementsForQuery=function(e,t,n,i){var r=this.getTextDataForPage(t);if(!r)return null;var o=r.selectNodes(e),a=[],s=null;if(1===o.length&&-1!==n&&-1!==i){if(n===i)return a;if(i<n){var l=n;n=i,i=l}}for(var u=0;u<o.length;u++){var c=o[u].parentNode.firstChild,p=o[u].selectSingleNode("ancestor::Table"),d=o[u].selectSingleNode("ancestor::List");if(c!==o[u]||p||d)if(p){if(p.selectSingleNode("descendant::T")===o[u])s=document.createElement("p"),Array.add(a,s);else{var h=o[u].selectSingleNode("ancestor::TR"),g=o[u].selectSingleNode("ancestor::TD | ancestor::TH");h!==p.firstChild&&g===h.firstChild&&(s=document.createElement("p"),Array.add(a,s))}}else d&&o[u]===c&&(s=document.createElement("p"),Array.add(a,s));else s=document.createElement("p"),Array.add(a,s);if(o[u].childNodes[0]){s||(s=document.createElement("p"),Array.add(a,s));var m=o[u].childNodes[0].nodeValue;-1!==n&&-1!==i&&(u+1===o.length&&(m=m.substring(0,i)),u||(m=m.substring(n,m.length))),s.innerText+=m}}return a},e.isPageSetInViewingCache=function(e){var t=n(941).App.get_activeAppFrame().get_workspace(),i=Ie.u.getPageSetXmlFromPage(t.getFirstCachedPage()),r=Ie.u.getPageSetXmlFromPage(t.getLastCachedPage());return e>=i&&e<=r},e.isPageSetInSelectionCache=function(e){var t=n(941).App.get_activeAppFrame().get_workspace(),i=Ie.u.getPageSetXmlFromPage(t.getFirstSelectedPage()),r=Ie.u.getPageSetXmlFromPage(t.getLastSelectedPage());return e>=i&&e<=r},e.buildXPathForPageXml=function(e){return String.format("/Pages/Page[@id='{0}']",e)},e}();(0,r.l)(ht,"PageInfoCache",null,[]);var gt=n(959),mt=n(553),_t=n(552),ft=n(782),yt=n(729),vt=function(){return function(e,t,n,i,r,o,a,s){void 0===e&&(e=null),void 0===t&&(t=null),void 0===n&&(n=null),void 0===i&&(i=null),void 0===r&&(r=null),void 0===o&&(o=null),void 0===a&&(a=null),void 0===s&&(s=null),this.logMessageMaxChars=3072,this.throttlingTimeoutMs=2e3,this.asyncOverride=!1,this.uploadMaximumSizeBytes=0,this.sizeThresholdBytes=65536,this.uploadCadenceMs=6e4,this.delayedLogHandlingCadenceMs=1e4,this.asyncUploadRequestTimeout=5e3,null!=e&&(this.logMessageMaxChars=e),null!=t&&(this.sizeThresholdBytes=t),null!=n&&(this.uploadCadenceMs=n),null!=i&&(this.throttlingTimeoutMs=i),null!=r&&(this.delayedLogHandlingCadenceMs=r),null!=o&&(this.asyncUploadRequestTimeout=o),null!=a&&(this.asyncOverride=a),null!=s&&s>0&&(this.uploadMaximumSizeBytes=s)}}();(0,r.l)(vt,"UlsUploadConfiguration",null,[]);var St=n(183),Ct=function(){function e(e,t,n){void 0===n&&(n=null),this.uploadUrl=null,this._failedUploadAttemptCount=0,this._uploadCadenceMs=0,this._throttlingTimeoutMs=0,this._delayedLogHandlingCadenceMs=0,this._uploadRequestTimeout=0,this._asyncOverride=!1,this._sessionId=null,this.nextUploadId=0,this._logCache=null,this._delayedLogBuffer=null,this._ulsCallDepthAdjustment=0,this._request=null,this._disposing=!1,this.setTimeoutToLogOriginAndExecuteReentrancyDetector=!1,this._delayedLoggingTimerId=0,this._cadenceTimerId=0,this._throttlingTimeoutId=0,this._mode=0,this.sendAfterThrottling=!1,this._asyncFlushTimeoutId=0,n||(n=new vt),this._sessionId=e,this.uploadUrl=t,this.uploadUrl.toLowerCase().startsWith("http:")&&document.URL.toLowerCase().startsWith("https:")&&D.ULS.disable(),this._uploadCadenceMs=n.uploadCadenceMs,this._throttlingTimeoutMs=n.throttlingTimeoutMs,this._delayedLogHandlingCadenceMs=n.delayedLogHandlingCadenceMs,this._uploadRequestTimeout=n.asyncUploadRequestTimeout,this._asyncOverride=n.asyncOverride,this._logCache=new yt.LogCache(n.sizeThresholdBytes,n.logMessageMaxChars,e),this._logCache.set_uploadMaximumSizeBytes(n.uploadMaximumSizeBytes),this.resetCadenceTimer(),this._delayedLogBuffer=[],this.resetDelayedLoggingTimer()}return e.prototype.handleTrace=function(e){this.get_ulsCallDepth()>1?Array.add(this._delayedLogBuffer,e):(this._logCache.addLog(e),this.logIndicatesError(e)&&!this.disableSynchronousFlush()?(this.flushSynchronous("LogIndicatesError in HandleTrace"),D.ULS.sendTraceTag(3731793,100,200,"Flushing error-level log (tag {0}) synchronously",St.z(e.tag))):this._logCache.get_isDataSizeThresholdExceeded()&&(this.flushImpl(!1,!0),D.ULS.sendTraceTag(3731794,100,200,"Flushing asynchronously due to cache size")))},e.prototype.logIndicatesError=function(e){return!!e&&(1===e.logType||10===e.level)},e.prototype.disableSynchronousFlush=function(){return!1},e.prototype.dispose=function(){this._disposing||(this._disposing=!0,this.flushForAppClose(),D.ULS.setUlsHost(null),window.clearTimeout(this._asyncFlushTimeoutId),window.clearTimeout(this._delayedLoggingTimerId),window.clearTimeout(this._cadenceTimerId),this._asyncFlushTimeoutId=0,this._delayedLoggingTimerId=0,this._cadenceTimerId=0)},e.prototype.flushForAppClose=function(){this.set_mode(2),this.handleDelayedLogs(),this.sendAfterThrottling=!1,this.endThrottling(),this.flushSynchronous("FlushForAppClose")},e.prototype.uploadLogs=function(e,t){return e.set_uploadId(this.nextUploadId),!!this.uploadSerializedLogs(e.serialize(),t)&&(this.nextUploadId++,!0)},e.prototype.uploadSerializedLogs=function(t,n){var i=this._asyncOverride||!n;return this._request&&i||(this._request=new XMLHttpRequest),this._request.readyState&&4!==this._request.readyState?(D.ULS.sendTraceTag(3731796,100,50,"Could not initiate upload {0}",{UploadId:this.nextUploadId,XhrReadyState:this._request.readyState}),!1):(this._request.open("POST",this.uploadUrl,i),this._request.setRequestHeader("Content-Type","application/json"),this._request.setRequestHeader(e.sessionIdHeaderName,this._sessionId),i&&(this._request.timeout=this._uploadRequestTimeout),this.modifyHttpRequestBeforeUploading(this._request),this._request.send(t),!0)},e.prototype.onUploadException=function(e){this._request&&this._request.abort()},e.prototype.modifyHttpRequestBeforeUploading=function(e){},e.prototype.setTimeoutToLogOriginAndExecute=function(e,t,n){try{return window.setTimeout((function(){D.ULS.sendTraceTag(3731797,100,200,"Timeout ({0} ms) set by {1} is now firing.",t,n),e()}),t)}catch(t){if(D.ULS.sendTraceTag(0,100,15,"SetTimeoutToLogOriginAndExecute: Calling Window.SetTimeout() failed with exception: {0}",t.toString()),!this.setTimeoutToLogOriginAndExecuteReentrancyDetector){this.setTimeoutToLogOriginAndExecuteReentrancyDetector=!0;try{e()}finally{this.setTimeoutToLogOriginAndExecuteReentrancyDetector=!1}}return 0}},e.prototype.resetDelayedLoggingTimer=function(){try{window.clearTimeout(this._delayedLoggingTimerId)}catch(e){D.ULS.sendTraceTag(0,100,15,"ResetDelayedLoggingTimer: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}this._delayedLoggingTimerId=this.setTimeoutToLogOriginAndExecute(r.i(this,this.handleDelayedLogs,"handleDelayedLogs"),this._delayedLogHandlingCadenceMs,"ResetDelayedLoggingTimer")},e.prototype.get_ulsCallDepth=function(){return D.ULS.get_ulsCallDepth()+this._ulsCallDepthAdjustment},e.prototype.handleDelayedLogs=function(){var e=this._delayedLogBuffer.length;if(e){var t=[];Array.addRange(t,this._delayedLogBuffer),this._delayedLogBuffer=[],D.ULS.sendTraceTag(3731798,100,50,"HandleDelayedLogs {0}",{Count:e}),this._ulsCallDepthAdjustment++;for(var n=0;n<e;n++)this.handleTrace(t[n]);this._ulsCallDepthAdjustment--,this.resetDelayedLoggingTimer()}else this.resetDelayedLoggingTimer()},e.prototype.resetCadenceTimer=function(){try{window.clearTimeout(this._cadenceTimerId)}catch(e){D.ULS.sendTraceTag(0,100,15,"ResetCadenceTimer: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}this._cadenceTimerId=this.setTimeoutToLogOriginAndExecute(r.i(this,this.flushImpl,"flushImpl"),this._uploadCadenceMs,"ResetCadenceTimer")},e.prototype.get_mode=function(){return this._mode},e.prototype.set_mode=function(e){var t=this._mode;if(this._mode=e,!this._mode&&t)try{var n=this._throttlingTimeoutId;this._throttlingTimeoutId=0,window.clearTimeout(n)}catch(e){D.ULS.sendTraceTag(0,100,15,"set_Mode: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}else this._mode&&!t&&(this._throttlingTimeoutId=this.setTimeoutToLogOriginAndExecute(r.i(this,this.endThrottling,"endThrottling"),this._throttlingTimeoutMs,"ThrottlingMode Setter"));return e},e.prototype.endThrottling=function(){this.set_mode(0),this.sendAfterThrottling&&(this.sendAfterThrottling=!1,this.flushImpl())},e.prototype.shouldThrottle=function(e){return 2===this.get_mode()||1===this.get_mode()&&!e},e.prototype.flushSynchronous=function(e){D.ULS.sendTraceTag(3731800,100,200,"Flushing Synchronous due to {0}",e),this.flushImpl(!0)},e.prototype.flushAsynchronous=function(){this.flushAsynchronousInternal(0)},e.prototype.flushAsynchronousInternal=function(e){this._asyncFlushTimeoutId||(this._asyncFlushTimeoutId=this.setTimeoutToLogOriginAndExecute(r.i(this,this.flushImpl,"flushImpl"),e,"FlushAsynchronous"))},e.prototype.flushImpl=function(t,n){this._ulsCallDepthAdjustment++;try{window.clearTimeout(this._asyncFlushTimeoutId)}catch(e){D.ULS.sendTraceTag(0,100,15,"FlushImpl: Calling Window.ClearTimeout() failed with exception: {0}",e.toString())}if(this._asyncFlushTimeoutId=0,!this._logCache.get_count())return this.resetCadenceTimer(),void this._ulsCallDepthAdjustment--;if(!n&&this.shouldThrottle(t))return D.ULS.sendTraceTag(3731801,100,200,"Not flushing ({0}) due to throttling",t?"sync":"async"),this.sendAfterThrottling=!0,void this._ulsCallDepthAdjustment--;var i;this.set_mode(t?2:1),this.resetCadenceTimer(),D.ULS.sendTraceTag(3731803,100,200,"Flushing ({0}) cached bULS logs ({1} logs)",t?"sync":"async",this._logCache.get_count());try{i=this.uploadLogs(this._logCache,t)}catch(e){this.onUploadException(e),i=!1}i?(this._logCache.reset(),this._failedUploadAttemptCount=0):(this._failedUploadAttemptCount++,this._failedUploadAttemptCount<e.maxUploadAttempts?this.flushAsynchronousInternal(e.retryDelay):(this._logCache.reset(),this.nextUploadId++,this._failedUploadAttemptCount=0)),this._ulsCallDepthAdjustment--},e.prototype.showAssertDialog=function(e){},e.prototype.handoffToNewHost=function(e){},e.prototype.add_onUlsTrace=function(e){},e.prototype.remove_onUlsTrace=function(e){},e.prototype.get_logCache=function(){return this._logCache},e.prototype.set_logCache=function(e){return this._logCache=e,e},e.prototype.get_delayedLogBuffer=function(){return this._delayedLogBuffer},e.prototype.get_cadenceTimerId=function(){return this._cadenceTimerId},e.prototype.get_delayedLoggingTimerId=function(){return this._delayedLoggingTimerId},e.prototype.get_asyncFlushTimeoutId=function(){return this._asyncFlushTimeoutId},e.prototype.get_throttlingTimeoutId=function(){return this._throttlingTimeoutId},e.prototype.get_ulsCallDepthAdjustment=function(){return this._ulsCallDepthAdjustment},e.prototype.set_ulsCallDepthAdjustment=function(e){return this._ulsCallDepthAdjustment=e,e},e.defaultRemoteUlsUrl="RemoteUls.ashx",e.maxUploadAttempts=3,e.retryDelay=15e3,e.sessionIdHeaderName="X-UserSessionId",e}();(0,r.l)(Ct,"UploadingUlsHost",null,[ft.x,Sys.IDisposable]);var bt=n(621),At=function(e){function t(t){var n=e.call(this)||this;return n.args=null,n.args=t,n}return(0,i.t)(t,e),t}(Sys.EventArgs);(0,r.l)(At,"UlsLoggingEventArgs",Sys.EventArgs,[]);var Tt=function(){function e(e,t,n,i){this.uploadId=0,this.attemptCount=0,this.sessionId=null,this.version=null,this.uploadId=e,this.attemptCount=t,this.sessionId=n,this.version=i}return e.prototype.get_uploadId=function(){return this.uploadId},e.prototype.get_attemptCount=function(){return this.attemptCount},e.prototype.get_sessionId=function(){return this.sessionId},e.prototype.get_version=function(){return this.version},e}();(0,r.l)(Tt,"UploadState",null,[]);var wt=function(e){function t(n,i,r,o){var a=e.call(this,p.AFrameworkApplication.userSessionId,t.generateCompleteRemoteUlsUrl(n,i,r),new vt(void 0,void 0,o.getIntAppSetting("BulsUploadFrequencyInMs",6e4),void 0,void 0,void 0,void 0,p.AFrameworkApplication.bulsUploadMaxSize))||this;return a._events=null,a._clientRequestManager=null,a._appSettingsManager=null,a._tagCallStackInclusionList=null,a._retryDelayWhenDisconnectedInMilliseconds=null,a._clientRequestManager=r,a._appSettingsManager=o,a._clientRequestManager,a}return(0,i.t)(t,e),t.prototype.get_events=function(){return this._events||(this._events=new Sys.EventHandlerList)},t.prototype.add_onUlsTrace=function(e){this.get_events().addHandler(t.ulsTraceEventKey,e)},t.prototype.remove_onUlsTrace=function(e){this.get_events().removeHandler(t.ulsTraceEventKey,e)},t.prototype.get_overwriteSessionId=function(){return null},t.prototype.get_overwriteVersion=function(){return null},t.prototype.getCallStack=function(){return(new Error).stack},t.prototype.getTagCallStackInclusionList=function(){var e=null;if(p.AFrameworkApplication.appSettingsManager.containsAppSetting("TagCallStackInclusionList")){e=new bt.u(Boolean);for(var t=p.AFrameworkApplication.appSettingsManager.getListAppSetting("TagCallStackInclusionList"),n=0;n<t.length;n++)e.set_item(t[n],!0)}return e},t.prototype.handleTrace=function(n){if(this._tagCallStackInclusionList||(this._tagCallStackInclusionList=this.getTagCallStackInclusionList()),this._tagCallStackInclusionList&&this._tagCallStackInclusionList.containsKey(n.tag)){var i=this.getCallStack();n.message+=". JsCallStack: "+i}e.prototype.handleTrace.call(this,n);var r=this.get_events().getHandler(t.ulsTraceEventKey),o=new At(n);r&&r(null,o)},t.prototype.showAssertDialog=function(e){},t.prototype.uploadLogs=function(t,n){if(this._clientRequestManager){if(!this.get_shouldTrySendingTheRequest())return!1;var i=t.serialize();if(p.AFrameworkApplication.bulsUploadMaxSize>0&&i.length>p.AFrameworkApplication.bulsUploadMaxSize)return!1;if(t.set_uploadId(this.nextUploadId++),this.shouldSendShuttingDownRequest())return this.sendShuttingDownRequest(this.uploadUrl,i),!0;var r=n&&p.AFrameworkApplication.isShuttingDown;return this.addUploadRequest(this.uploadUrl,i,n&&!this.get_overwriteSessionId()?0:3,1,r,t.get_uploadId(),this.get_overwriteSessionId(),this.get_overwriteVersion()),!0}return e.prototype.uploadLogs.call(this,t,n)},t.prototype.onSuccessfulUpload=function(e){},t.prototype.onFailedUpload=function(n){var i=this,r=n.get_data();if(r){if(13===r.status)return D.ULS.sendTraceTag(6399108,100,50,"Request timed out in the ClientRequestManager queue. Falling back to default XHR."),void e.prototype.uploadSerializedLogs.call(this,r.request.get_body(),!1);if(r.responseHeaders){if(!(t.invalidUlsJsonHeaderName in r.responseHeaders)){var o=r.httpStatus;if(!(400<=o&&o<=499)){var a=r.state;a.get_attemptCount()>=Ct.maxUploadAttempts||window.setTimeout((function(){i.addUploadRequest(r.request.get_url(),r.request.get_body(),3,a.get_attemptCount()+1,!1,a.get_uploadId(),a.get_sessionId(),a.get_version())}),Ct.retryDelay)}}}else D.ULS.sendTraceTag(5002498,100,15,"Item.ResponseHeader is null! RequestItem id = {0}, responseXml = {1}, data = {2}",r.id,r.responseXml,r.responseData)}else D.ULS.sendTraceTag(5002497,100,15,"Request Item is null! RequestFailedEventArgs = {0}",n)},t.prototype.addUploadRequest=function(e,t,n,i,o,a,s,l){this._clientRequestManager.addRequest(e,2,t,null,!1,n,r.i(this,this.onSuccessfulUpload,"onSuccessfulUpload"),r.i(this,this.onFailedUpload,"onFailedUpload"),new Tt(a,i,s,l),null,o,this._appSettingsManager.getIntAppSetting("BulsClientRequestManagerQueueTimeInMS",3e4),void 0,"19",s,void 0,l)},t.prototype.sendShuttingDownRequest=function(e,t){this._clientRequestManager.sendShuttingDownRequest(e,t)},t.prototype.shouldSendShuttingDownRequest=function(){return p.AFrameworkApplication.isShuttingDown&&(this._appSettingsManager.getBooleanAppSetting("SendBeaconOnShuttingDownRequestsEnabled")||p.AFrameworkApplication.isShuttingDownFromPostMessage)},t.prototype.get_retryDelayWhenDisconnectedInMilliseconds=function(){return this._retryDelayWhenDisconnectedInMilliseconds||(this._retryDelayWhenDisconnectedInMilliseconds=this._appSettingsManager.getIntAppSetting("bULSUploadRetryDelayWhenDisconnectedInMilliseconds",6e4)),this._retryDelayWhenDisconnectedInMilliseconds},t.prototype.get_shouldTrySendingTheRequest=function(){var e=this._clientRequestManager.get_isNetworkOffline();if(e&&(new Date).getTime()-this._clientRequestManager.get_lastResponseTime().getTime()>=this.get_retryDelayWhenDisconnectedInMilliseconds())return!0;return!e},t.generateCompleteRemoteUlsUrl=function(e,n,i){return e=t.addBuildNumber(e,n),e=t.addWacCluster(e,i)},t.addWacCluster=function(e,t){if(!t)return e;var n=t.get_wacClusterId();return n?e=Me.n.addOrReplaceParameterValue(e,pt.h.wacClusterQsName,n):e},t.addBuildNumber=function(e,t){return t?Me.n.addOrReplaceParameterValue(e,"build",p.AFrameworkApplication.buildVersion):e},t.createHostAndInitUlsForApp=function(e,n){return void 0===e&&(e=Ct.defaultRemoteUlsUrl),void 0===n&&(n=!0),p.AFrameworkApplication.browserUlsIsEnabled?(D.ULS.setUlsHost(new t(e,n,p.AFrameworkApplication.theClientRequestManager,p.AFrameworkApplication.appSettingsManager)),D.ULS.setTraceLevel(p.AFrameworkApplication.browserUlsTraceLevel)):D.ULS.disable(),D.ULS.get_host()},t.ulsTraceEventKey="CommonUlsTraceEventKey",t.invalidUlsJsonHeaderName="X-InvalidUlsJson",t}(Ct);(0,r.l)(wt,"CommonUlsHost",Ct,[]);var It=n(252),Et=function(){return function(){this.buttonActionCommand=null,this.createNewDocumentAspxRelativePath="",this.flyoutAnchorId=null,this.headerButtonId=null,this.headerButtonText=null,this.headerButtonTitle=null,this.image32by32=null,this.image32by32Class=null,this.labelText=null}}();(0,r.l)(Et,"FileNewProperties",null,[]);var kt=function(){return function(){this.buttonActionCommand=null,this.flyoutAnchorId=null,this.image32by32=null,this.image32by32Class=null}}();(0,r.l)(kt,"FileOpenProperties",null,[]);var Dt=n(973),Mt=n(996),Pt=n(728),Ft=n(344),xt=n(218),Rt=n(990),Bt=n(265),Lt=n(59),Nt=n(154),Ut=n(743);n.d(t,{App:function(){return Qt}});var Ot=10380,Ht=10379,Wt=10382,Vt=10383,$t=1.24,Kt=1.24,zt="png",qt="pnglarge",Qt=function(e){function t(n){var i=e.call(this,n,!1)||this;i._target=null,i._disposed=!1,i.nilUuidStringPng="",i._uiQueryParameter=null,i.theDocument=null,i.theConfig=null,i._baseDocQueryParam=null,i._translationLanguage=null,i._translationLanguages=null,i._isBinary=!1,i._embedPreviewUrl=null,i._wordEditorAppRootUrl=null,i._canCreateComments=!1,i._isSmallView=!1,i._isCoreMode=!1,i._showPrintWhenEmbedded=!1,i._showEmbed=!1,i._supportsCobalt=!1,i._supportsEditingWithLocks=!1,i._printingEnabled=!0,i._copyingEnabled=!0,i._status=0,i._userName=null,i._isBroadcastMode=!1,i._translationFromEditor=!1,i._pdfMode=!1,i._accessiblePdfMode=!1,i._accessiblePdfModeInitialized=!1,i._accessiblePdfModeAppSetting=null,i._showLegacyPrintDialogPdfMode=!1,i._userCanWriteRelative=!1,i._resourceTimingLoggerFuture=null,i._pngFormat=null,i._highDpiDocToPngBrsIsEnabled=!1,i._highDpiPdfToPngBrsIsEnabled=!1,i._zoomPopupDialogIsEnabled=!1,i._zoomControl=null,i._scrollControl=null,i._postMessenger=null,i.isScreenReaderPresent=null,i.appEmbedPreviewUrl=null,i.accessibleModeEnabled=!1,i._userMayEnterAccessiblePdfMode=null,i.isOdt=!1,i.broadcastPostMessageOrigin=null,i.initialize(n),window.g_wordViewerAppConstructed=!0,(new Ze).configure(oe.w.get_instance()),p.AFrameworkApplication.loadTestFrameworkIfRequested(),i.initializeBrowserSqm(n),i.accessibleModeEnabled=Boolean.parse(n.WordViewerAccessibleModeEnabled),i._accessiblePdfModeAppSetting=n.IsAccessiblePdfMode,"true"===n.PdfMode&&(i._pdfMode=!0),"true"===n.TranslationFromEditor&&(i._translationFromEditor=!0),p.AFrameworkApplication.get_isEmbedded()&&(i._isBroadcastMode="true"===n.BroadcastMode),i._translationLanguage=n.TranslationLanguage,i._translationLanguages=n.TranslationLanguages;var o=p.AFrameworkApplication.theWsaClient;if(o&&o.isUserOptedIn()){var a=void 0;if(a=p.AFrameworkApplication.get_isNoChrome()?19:i.get_isBroadcastMode()?8:i.get_translationLanguage()?10:i.get_isPdfMode()?15:p.AFrameworkApplication.get_isEmbedded()?14:1,o.setDw(p.AFrameworkApplication.officeApplicationModeDatapointId,a),p.AFrameworkApplication.get_protectFile()){for(var s=new Array(p.AFrameworkApplication.documentStreamWidth),l=0;l<p.AFrameworkApplication.documentStreamWidth;l++)s[l]=0;s[2]=256,o.addToStreamDw.apply(o,[p.AFrameworkApplication.documentStreamId].concat(s))}}p.AFrameworkApplication.theClientRequestManager||(p.AFrameworkApplication.theClientRequestManager=pt.h.createAnInstance(p.AFrameworkApplication.userSessionId)),p.AFrameworkApplication.theClientRequestManager.set_wacClusterId(n.WacCluster),p.AFrameworkApplication.theUlsHost=wt.createHostAndInitUlsForApp(),p.AFrameworkApplication.appSettingsManager.get_isFullAppSettingsReady()||(p.AFrameworkApplication.appSettingsManager.requestPostBootAppSettings(),p.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsReady(r.i(i,i.onFullAppSettingsReady,"onFullAppSettingsReady")),p.AFrameworkApplication.appSettingsManager.invokeOrRegisterOnFullAppSettingsFailed(r.i(i,i.onFullAppSettingsFailed,"onFullAppSettingsFailed"))),i.checkIfStringIsDownloaded(n,(function(){return WordViewerIntl.WordViewerStrings}),it.i.stringsFailedToLoadWordViewer),i.checkIfStringIsDownloaded(n,(function(){return CommonUIStrings}),it.i.stringsFailedToLoadCommonUI),"true"===n.WordViewerPdfModePrintShowsLegacyDialog&&(i._showLegacyPrintDialogPdfMode=!0),i._status=0,i.get_isPdfMode()?(Pt.k.documentType=CommonUIStrings.l_DocumentType_Pdf,Pt.k.documentTypeTitleCase=CommonUIStrings.l_DocumentType_Pdf,Pt.k.documentTypePlural=CommonUIStrings.l_DocumentTypePlural_Pdf,Pt.k.subDocumentType=CommonUIStrings.l_SubDocumentType_Pdf):(Pt.k.documentType=CommonUIStrings.l_DocumentType_W,Pt.k.documentTypeTitleCase=CommonUIStrings.l_DocumentTypeTitleCase_W,Pt.k.documentTypePlural=CommonUIStrings.l_DocumentTypePlural_W,Pt.k.subDocumentType=CommonUIStrings.l_SubDocumentType_W),Pt.k.richClientNameLong=CommonUIStrings.l_RichClientNameLong_W,Pt.k.applicationNameOnly=CommonUIStrings.l_AppNameShort_W,Pt.k.formatResourceStrings(CommonUIStrings),Pt.k.formatResourceStrings(WordViewerIntl.WordViewerStrings),"true"===n.PerfMarkersEnabled&&Ue.t.start(),i._canCreateComments=Boolean.parse(n.CanComment),i._userName=n.UserName,i._uiQueryParameter=n.UIParameter,t.webServiceBase=n.WebServiceBase,i.set_isCoreMode(Boolean.parse(n.IsCoreMode||"false")),p.AFrameworkApplication._extraErrorInfoFromHost=n.ExtraErrorInfo,i._wordEditorAppRootUrl=n.WordEditorAppRootUrl,i._isBinary=Boolean.parse(n.IsBinary||"false"),i.initPaths(n),p.AFrameworkApplication.set_unifiedHeaderOfficeOnlineLogoWidth(159),p.AFrameworkApplication.set_imageClusterName(Dt.wordViewerImageMapName),p.AFrameworkApplication.set_imageClusterPath(tt.s.ribbonImage(p.AFrameworkApplication.get_imageClusterName()+".png")),p.AFrameworkApplication.set_scriptFolderPath(tt.s.wordViewerScriptsBase),p.AFrameworkApplication.set_scriptBase("WordViewer.{0}");var u=n.DocumentPermissions||"";t.canEdit=u.indexOf("W")>-1,p.AFrameworkApplication.get_isEmbedded()&&(D.ULS.sendTraceTag(18395276,301,50,"Embedded view"),i.set_isSmallView("true"===n.SmallView),i._showPrintWhenEmbedded="true"===n.ShowPrint,i._showPrintWhenEmbedded&&p.AFrameworkApplication.theWsaClient.setBitsOr(Vt,1),i._showEmbed="true"===n.ShowEmbedCode,i._showEmbed&&p.AFrameworkApplication.theWsaClient.setBitsOr(Vt,2),p.AFrameworkApplication.theWsaClient.setDw(Ot,window.document.documentElement.clientWidth),p.AFrameworkApplication.theWsaClient.setDw(Ht,window.document.documentElement.clientHeight)),i._isBroadcastMode&&(i.broadcastPostMessageOrigin=n.BroadcastPostMessageOrigin,p.AFrameworkApplication.postMessageOrigin=i.broadcastPostMessageOrigin),i._target=document.getElementById(n.ClientId),p.AFrameworkApplication.registerFrame(new Xe.AppFrame(i,i._target,n)),i.get_isAccessiblePdfMode()&&(p.AFrameworkApplication.showSplashScreen(!0),t.hideFirstPageImage()),(p.AFrameworkApplication.get_isEmbedded()||i.get_isAccessiblePdfMode())&&(t.initialPageNumber=parseInt(n.InitialPageNumber),isNaN(t.initialPageNumber)||t.initialPageNumber<1?t.initialPageNumber=1:(p.AFrameworkApplication.theWsaClient.setDw(Wt,t.initialPageNumber),p.AFrameworkApplication.theWsaClient.setBitsOr(Vt,4))),i.initializeDefaultErrorHandler(p.AFrameworkApplication.get_activeFrame().get_theErrorHandler(),n),Boolean.parse(n.ConfigError||"false")&&(Ie.u.showErrorDialogEx(Ee.p.configError,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ConfigError),Ie.u.propagateError(!0,"ServerConfigError",Ee.p.configError,CommonUIStrings.l_ConfigError)),i.set_pngFormat(mt.k()>(i.get_isPdfMode()?Kt:$t)?qt:zt),i.set_highDpiDocToPngBrsIsEnabled(Boolean.parse(n.WordViewerHighDpiDocToPngIsEnabled||"false")),i.set_highDpiPdfToPngBrsIsEnabled(Boolean.parse(n.WordViewerHighDpiPdfToPngIsEnabled||"false")),i.set_zoomPopupDialogIsEnabled(Boolean.parse(n.ZoomPopupDialogIsEnabled||"false")),qt===i.get_pngFormat()&&(i.get_isPdfMode()&&i.get_highDpiPdfToPngBrsIsEnabled()||!i.get_isPdfMode()&&i.get_highDpiDocToPngBrsIsEnabled())?i.nilUuidStringPng=n.PngLargeFormatGuid:i.nilUuidStringPng=n.PngFormatGuid,i.theConfig=new et,p.AFrameworkApplication.appPreloadStatistics&&Ne.PageStats.addServerMeasurements(p.AFrameworkApplication.appPreloadStatistics),Ne.PageStats.beginRootMeasurement("Load",p.AFrameworkApplication.appInitTime),Ne.PageStats.addAttribute(dt.a.sessionId,p.AFrameworkApplication.userSessionId),i._baseDocQueryParam=n.BaseDocQueryParam,i.theDocument=new ut(i.get_baseDocQueryParam()),p.AFrameworkApplication.get_theActionManager().addActionWithFlags(O.dc,N.d.application,r.i(i,i.xmlPageDownloaded3,"xmlPageDownloaded3"),97),i.requestDocData();var c=new st;p.AFrameworkApplication.get_theActionManager().registerApplication(c),t.get_activeAppFrame().get_thePageManager().registerHandler(2,r.i(i,i.appClose,"appClose"),null),t.get_activeAppFrame().get_theMouseInputManager().registerHandler(ne.d.mouseDown,i._target,r.i(i,i.propagateMouseDownEventToHost,"propagateMouseDownEventToHost")),t.get_activeAppFrame().get_theTouchInputManager().registerHandler(ne.d.touchStart,i._target,r.i(i,i.propagateTouchEventToHost,"propagateTouchEventToHost")),t.initialParagraphId=t.determineInitialParagraphId(n),t.get_activeAppFrame().get_ribbonUser()&&t.get_activeAppFrame().get_ribbonUser().poll(),t.get_activeAppFrame().get_statusBarUser()&&t.get_activeAppFrame().get_statusBarUser().poll();var d=n.PageTitle;null!=d&&(document.title=d),It.x.get_instance().checkUserRoamingRights(4),MSOJS.ClientUtils.InitUrls(p.AFrameworkApplication.roamingAppsX86RootUrl,p.AFrameworkApplication.roamingAppsControlInstallerUrl,p.AFrameworkApplication.roamingAppsFirefoxExtensionUrl);var h=ie.FocusManager.instance().getScope(H.AFrame.mainAppFocusId);H.AFrame.bindWithDoNothingFallback(h,V.KeyInputManager.hashKeyString(WordViewerIntl.WordViewerStrings.l_HK_Save),le.Wy),i.get_resourceTimingLoggerFuture().execute((function(e){e.configure(30,0),e.add_entriesAvailable(t.onResourceTimingEntriesAvailable),e.activate()})),i.enqueueDelayLoadedFiles(),i.checkHostCanaryValidityAndRedirectIfNeeded(n.HostViewUrl,it.i.hostCanaryFailure),v.o.get_instance().notifyReadyToInit();var g=n.FileName;null!=g&&Lt.o(g).endsWith(".ODT")&&D.ULS.sendTraceTag(18449630,301,50,"ODT load");var m=n.ModeSwitchTime;null!=m&&Ge.e.get_instance().addMetric(ze.c.modeSwitchTime,m);var _=n.RedirectionReason;return null!=_&&p.AFrameworkApplication.get_isNoChrome()&&Ge.e.get_instance().addMetric(ze.c.isFallback,"NOBUNDLEINFO"!==Lt.o(_)?1:0),I.m.get_instance().recordAppInitEnd(),i}return(0,i.t)(t,e),t.prototype.get_postMessenger=function(){return this._postMessenger||(this._postMessenger=oe.w.get_instance().resolve(l.e))},t.prototype.get_resourceTimingLoggerFuture=function(){return this._resourceTimingLoggerFuture||(this._resourceTimingLoggerFuture=oe.w.get_instance().resolveFuture(o.t))},t.prototype.get_zoomControl=function(){return this._zoomControl||(this._zoomControl=oe.w.get_instance().resolve(a.e))},t.prototype.get_scrollControl=function(){return this._scrollControl||(this._scrollControl=oe.w.get_instance().resolve(s.f))},t.prototype.get_isAccessiblePdfMode=function(){return!!this.get_userMayEnterAccessiblePdfMode()&&(this._accessiblePdfModeInitialized?this._accessiblePdfMode:(this._accessiblePdfModeInitialized=!0,this._accessiblePdfModeAppSetting?this._accessiblePdfMode=Boolean.parse(this._accessiblePdfModeAppSetting):(k.x(20300620,301,null!=this.isScreenReaderPresent,"IsScreenReaderPresent was not initialized, defaulting to false"),this._accessiblePdfMode=null!=this.isScreenReaderPresent&&(this.isScreenReaderPresent||Boolean.parse(Ft.g("WordViewerAccessibilityModeCookie")||"false"))),this._accessiblePdfMode&&D.ULS.sendTraceTag(20451526,301,50,"Accessible PDF mode enabled for user"),this._accessiblePdfMode))},t.prototype.get_pngFormat=function(){return this._pngFormat},t.prototype.set_pngFormat=function(e){return this._pngFormat=e,e},t.prototype.get_highDpiDocToPngBrsIsEnabled=function(){return this._highDpiDocToPngBrsIsEnabled},t.prototype.set_highDpiDocToPngBrsIsEnabled=function(e){return this._highDpiDocToPngBrsIsEnabled=e,e},t.prototype.get_highDpiPdfToPngBrsIsEnabled=function(){return this._highDpiPdfToPngBrsIsEnabled},t.prototype.set_highDpiPdfToPngBrsIsEnabled=function(e){return this._highDpiPdfToPngBrsIsEnabled=e,e},t.prototype.get_zoomPopupDialogIsEnabled=function(){return this._zoomPopupDialogIsEnabled},t.prototype.set_zoomPopupDialogIsEnabled=function(e){return this._zoomPopupDialogIsEnabled=e,e},t.prototype.get_baseDocQueryParam=function(){return this._baseDocQueryParam},t.prototype.get_isCoreMode=function(){return this._isCoreMode},t.prototype.set_isCoreMode=function(e){return this._isCoreMode=e,e},t.prototype.get_isSmallView=function(){return this._isSmallView},t.prototype.set_isSmallView=function(e){return this._isSmallView=e,e},t.prototype.get_embedPreviewUrl=function(){return this._embedPreviewUrl},t.prototype.set_embedPreviewUrl=function(e){return this._embedPreviewUrl=e,e},t.prototype.get_translationLanguage=function(){return this._translationLanguage},t.prototype.get_translationLanguages=function(){return this._translationLanguages},t.prototype.get_isBinary=function(){return this._isBinary},t.prototype.get_supportsEditing=function(){return(this._supportsCobalt||this._supportsEditingWithLocks)&&p.AFrameworkApplication.webEditingEnabled&&!this._translationLanguage&&!this.get_isBroadcastMode()&&!p.AFrameworkApplication.get_protectFile()},t.prototype.get_accessibleModeEnabled=function(){return this.accessibleModeEnabled},t.prototype.get_userMayEnterAccessiblePdfMode=function(){return null!=this._userMayEnterAccessiblePdfMode?this._userMayEnterAccessiblePdfMode:(this._userMayEnterAccessiblePdfMode=!1,this.get_accessibleModeEnabled()&&(this.get_isBroadcastMode()?D.ULS.sendTraceTag(20451527,301,100,"Accessible PDF mode not allowed: User is in broadcast mode"):this.get_isPdfMode()?D.ULS.sendTraceTag(20451528,301,100,"Accessible PDF mode not allowed: User is in PDF mode"):w.y.get_hasPdfReader()?this.get_showPrint()?(D.ULS.sendTraceTag(20451531,301,100,"Accessible PDF mode may be entered by user"),this._userMayEnterAccessiblePdfMode=!0):D.ULS.sendTraceTag(20451530,301,100,"Accessible PDF mode not allowed: Printing is not being shown (document may be protected)"):D.ULS.sendTraceTag(20451529,301,100,"Accessible PDF mode not allowed: No PDF viewer detected in browser ({0})",w.y.get_browserNameForlogging())),this._userMayEnterAccessiblePdfMode)},t.prototype.get_userCanComment=function(){return!p.AFrameworkApplication.get_isEmbedded()&&this._supportsCobalt&&!t.get_instance().get_translationLanguage()&&!t.get_instance().get_isBroadcastMode()&&t.get_instance().get_canCreateComments()&&t.canEdit},t.prototype.get_copyingEnabled=function(){return this._copyingEnabled&&!p.AFrameworkApplication.get_protectFile()&&!w.y.get_isIPad()&&!this.get_isProtectedPdf()},t.prototype.get_isProtectedPdf=function(){return!!this.theDocument&&this.theDocument.get_isProtectedPdf()},t.prototype.get_printingEnabled=function(){return this._printingEnabled&&!p.AFrameworkApplication.get_protectFile()},t.prototype.get_showPrint=function(){return this.get_printingEnabled()&&(!p.AFrameworkApplication.get_isEmbedded()||this._showPrintWhenEmbedded)},t.prototype.get_showEmbed=function(){return this._showEmbed},t.prototype.addEntryToBusinessBar=function(e,n){return!!t.get_activeAppFrame().get_businessBar()&&(t.get_activeAppFrame().get_businessBar().addEntry(e,n),!0)},t.prototype.addGdprBusinessBarWithCloseCallback=function(e,n,i,r){if(t.get_activeAppFrame().get_businessBar()){var o=new _t.l(null,e,null);o.set_closeable(!0),o.set_id(23),o.set_image(3),o.addLinkWithHandler(n,(function(){Nt.g.openWindow(4,"https://go.microsoft.com/fwlink/?linkid="+i)})),r&&o.set_closeHandler(r),t.get_activeAppFrame().get_businessBar().addEntry(o,!0)}},t.prototype.addGdprBusinessBar=function(e,t,n){this.addGdprBusinessBarWithCloseCallback(e,t,n,null)},t.prototype.get_clientUrl=function(){return t.get_activeAppFrame().get_clientEditDocumentUrl()},t.prototype.get_officeAppType=function(){return 3},t.prototype.get_officeAppMode=function(){return 2},t.prototype.get_status=function(){return this._status},t.prototype.set_status=function(e){return this._status=e,e},t.prototype.get_activeUserName=function(){return this._userName},t.prototype.get_canCreateComments=function(){return this._canCreateComments},t.prototype.get_fileTypeSupportsCommenting=function(){return!this.get_isPdfMode()},t.prototype.get_isBroadcastMode=function(){return this._isBroadcastMode},t.prototype.get_isPdfMode=function(){return this._pdfMode},t.prototype.get_translationFromEditor=function(){return this._translationFromEditor},t.prototype.propagateMouseDownEventToHost=function(e){return this.get_postMessenger().sendMessage(be.a.browserEvent,{type:"mousedown",altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1}),!1},t.prototype.propagateTouchEventToHost=function(e){return this.get_postMessenger().sendMessage(be.a.browserEvent,{type:"touchstart",altKey:!1,ctrlKey:!1,metaKey:!1,shiftKey:!1}),!1},t.prototype.get_isOdt=function(){return this.isOdt},t.prototype.get_showLegacyPrintDialogPdfMode=function(){return this._showLegacyPrintDialogPdfMode},t.prototype.get_userCanWriteRelative=function(){return this._userCanWriteRelative},t.prototype.get_userCanSaveAndEditTranslatedDocument=function(){return!(!this.get_translationLanguage()||p.AFrameworkApplication.get_protectFile()||p.AFrameworkApplication.get_disableEditIfAndroid()||!this.get_userCanWriteRelative())},t.prototype.fastFail=function(e,t){void 0===t&&(t=null);var n=new Mt.h,i=new rt.k;throw i.register(n),this.initializeDefaultErrorHandler(i,e),null!=t&&(p.AFrameworkApplication.reportError(t),p.AFrameworkApplication.suppressCrashReportingToBSqm=!0,p.AFrameworkApplication.suppressCrashReportingToWatson=!0),Error.invalidOperation("Unable to load resources for LCID "+e.Lcid)},t.prototype.get_editMode=function(){return p.AFrameworkApplication.copyAndEditUrl&&!p.AFrameworkApplication.get_protectFile()?3:t.get_instance().get_supportsEditing()&&t.get_activeAppFrame().get_wordEditorUrl()?t.get_activeAppFrame().get_editNeedsConversion()?2:1:0},t.prototype.handleEditInBrowser=function(){switch(this.get_editMode()){case 1:p.AFrameworkApplication.get_theActionManager().processAction(O.no,2);break;case 3:var e={targetWacAction:"Edit"},n=t.get_activeAppFrame().getTopParagraphId();n&&(e.wdparams="wd=pid("+n+")"),p.AFrameworkApplication.get_theActionManager().processActionWithData(le.te,2,e);break;case 2:p.AFrameworkApplication.get_theActionManager().processAction(O.D,2)}},t.prototype.setAccessiblePdfModeCookie=function(e){Ft.r("WordViewerAccessibilityModeCookie",e.toString(),30)||D.ULS.sendTraceTag(20267092,301,50,"Failed to set cookie for accessible mode cookie to {0}",e.toString())},t.prototype.onFullAppSettingsFailed=function(){D.ULS.sendTraceTag(7387203,301,10,"Full App Settings failed to download."),Ie.u.showErrorDialogEx(Ee.p.fullAppSettingDownloadFailed,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NetworkProblemInitialDialogDescription),Ie.u.propagateError(!0,"FullAppSettingsDownloadFailed",Ee.p.fullAppSettingDownloadFailed,CommonUIStrings.l_NetworkProblemInitialDialogDescription)},t.prototype.updateFullAppSettings=function(t){e.prototype.updateFullAppSettings.call(this,t),p.AFrameworkApplication.docPropertiesProvider=new _(t),"true"===t.UserCanWriteRelative&&(this._userCanWriteRelative=!0);var n=t.Scenarios;this._supportsCobalt=n.indexOf(p.AFrameworkApplication.supportsCobaltFlag)>-1,this._supportsEditingWithLocks=n.indexOf(p.AFrameworkApplication.supportsEditingWithLocksFlag)>-1,"false"===t.PrintingEnabled&&(this._printingEnabled=!1),this.appEmbedPreviewUrl=t.AppEmbedPreviewUrl,this._embedPreviewUrl=this.computeEmbedPreviewUrl(p.AFrameworkApplication.hostEmbeddedViewUrl,this.appEmbedPreviewUrl),this._isBroadcastMode&&this.broadcastPostMessageOrigin&&(p.AFrameworkApplication.postMessageOrigin=this.broadcastPostMessageOrigin)},t.prototype.dispose=function(){this._disposed||(v.o.get_instance().dispose(),t.get_activeAppFrame().get_theMouseInputManager().unregisterHandler(ne.d.mouseDown,this._target,r.i(this,this.propagateMouseDownEventToHost,"propagateMouseDownEventToHost")),t.get_activeAppFrame().get_theTouchInputManager().unregisterHandler(ne.d.touchStart,this._target,r.i(this,this.propagateTouchEventToHost,"propagateTouchEventToHost")),this.get_resourceTimingLoggerFuture().execute((function(e){e.deactivate(!0),e.remove_entriesAvailable(t.onResourceTimingEntriesAvailable)})),this._target=null,this._disposed=!0,e.prototype.dispose.call(this))},t.prototype.checkIfStringIsDownloaded=function(e,t,n){var i=!1;try{t()||(i=!0)}catch(e){i=!0}i&&this.fastFail(e,n)},t.prototype.computeEmbedPreviewUrl=function(e,t){var n=null;return!p.AFrameworkApplication.get_isEmbedded()&&e&&((n=e).toUpperCase().startsWith("HTTP://")?document.URL.toUpperCase().startsWith("HTTPS://")&&(n=t):n.toUpperCase().startsWith("HTTPS://")||(D.ULS.sendTraceTag(5017923,301,15,"HostEmbeddedViewUrl must start with HTTP or HTTPS: {0}",e),n=null)),n},t.prototype.getDocDataUri=function(e){var n=null;n=this.get_highDpiDocToPngBrsIsEnabled()&&!this.get_isPdfMode()||this.get_highDpiPdfToPngBrsIsEnabled()&&this.get_isPdfMode()?this.get_pngFormat():zt;var i=t.webServiceBase+"docdatahandler.ashx?"+this.theDocument.get_baseDocQuerySignature()+"&type="+n+"&o15=1";return e&&(i+="&language="+e),""!==this._uiQueryParameter&&(i+="&ui="+this._uiQueryParameter),this.get_isPdfMode()&&(i+="&PdfMode=1"),i},t.prototype.requestDocData=function(){if(!this.shouldSkipDocDataRequest()){p.AFrameworkApplication.collectPageStats&&Ne.PageStats.beginMeasurement("RequestDocData");var e=this.getDocDataUri(this._translationLanguage);De.k.doRequest(e,r.i(this,this.onRequestComplete,"onRequestComplete"),t.get_activeAppFrame().get_notificationBar())||p.AFrameworkApplication.collectPageStats&&Ne.PageStats.endMeasurement("RequestDocData"),Ue.t.mark(7244)}},t.prototype.shouldSkipDocDataRequest=function(){return!!w.y.get_isBingPreview()&&(D.ULS.sendTraceTag(6031385,301,50,"Skipping DocData: BingPreview"),!0)},t.prototype.onRequestComplete=function(e,n,i){if(!this._disposed){if(!e)return t.reportFirstPageAndRenderTime(),Ie.u.showErrorDialogEx(Ee.p.openFileNetworkProblem,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_NetworkProblemInitialDialogDescription),void Ie.u.propagateError(!0,"RequestFailed",Ee.p.openFileNetworkProblem,CommonUIStrings.l_NetworkProblemInitialDialogDescription);t.isFirstPageImageDisplayed()||t.hideFirstPageImage();var r=i.responseXml,o=i.responseData,a=null;if(r&&(De.k.isValidResponseXMLDoc(r)||(r=Sys.Net.XMLDOM(i.responseData,!0)),a=r.selectSingleNode("/docdata/document")),!a)return t.reportFirstPageAndRenderTime(),Ie.u.showErrorDialog(r),void Ie.u.propagateError(!0,"InvalidDocData",Ee.p.cannotOpenFile,CommonUIStrings.l_CannotOpenFile,n);t.get_instance().set_status(1),this.initNamedObject(o,this.theDocument.get_baseDocQuerySignature()),this.theDocument.init(a),p.AFrameworkApplication.theWsaClient.setDw(9131,this.theDocument.get_pageCount());var s=(new Date).getTime()-p.AFrameworkApplication.bootTime;if(p.AFrameworkApplication.theWsaClient.setDw(8867,s),Ue.t.mark(5051),I.m.get_instance().recordAppInteractive((new Date).getTime()),!p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("LogBootPerfMetricsOnAppDisposeIsEnabled")){var l=new de.c(2,1,2e3,(function(e){Ge.e.get_instance().log()}),79);p.AFrameworkApplication.get_theTaskManager().addTask(l)}p.AFrameworkApplication.collectPageStats&&(i.responseHeaders[pt.h.correlationIdHeaderName]&&Ne.PageStats.addAttribute(dt.a.correlation,i.responseHeaders[pt.h.correlationIdHeaderName].toString()),i.responseHeaders[Ne.PageStats.pageStatsResponseXHRHeader]&&Ne.PageStats.addServerMeasurements(i.responseHeaders[Ne.PageStats.pageStatsResponseXHRHeader].toString()),Ne.PageStats.endMeasurement("RequestDocData")),t.get_activeAppFrame().get_statusBarUser()&&t.get_activeAppFrame().get_statusBarUser().setZoomVisibility(!0);var u=new de.c(2,1,1e3,(function(e){nt.o.translationLanguages.requestTranslationLanguagesAppSetting()}));p.AFrameworkApplication.get_theTaskManager().addTask(u),t._docData=i,t.get_activeAppFrame().thePageInfoCache=new ht,X.t.get_instance().get_isNormalized()&&t.initialParagraphId?t.get_activeAppFrame().thePageInfoCache.addToCache(1,1):this.initializeDocument()}},t.prototype.initNamedObject=function(e,n){Oe.w.initWithExtraUrlParameters(t.webServiceBase+"ResReader.ashx",n,this.nilUuidStringPng,this.getExtraUrlParamsForNamedObject())},t.prototype.getExtraUrlParamsForNamedObject=function(){var e=p.AFrameworkApplication.theClientRequestManager.get_wacClusterId();return(e?"&"+pt.h.wacClusterQsName+"="+e:"")+(this.get_isPdfMode()?"&PdfMode=1":"")},t.prototype.get_isReactSharedHeaderUxEnabled=function(){return!p.AFrameworkApplication.hideHeader&&p.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("ReactSharedHeaderInViewerIsEnabled")},t.prototype.noRightClick=function(e){re.n.cancelEvent(e)},t.prototype.appClose=function(e){this.dispose()},t.prototype.initPaths=function(e){tt.s.wordViewerImageBase=e.WordViewerImageBase,tt.s.wordViewerCssBase=e.WordViewerCssBase,tt.s.wordViewerScriptsBase=e.WordViewerScriptsBase,tt.s.wordViewerScriptsLcidBase=e.WordViewerScriptsLcidBase,tt.s.ribbonImageBase=e.RibbonImageBase,tt.s.ribbonCssBase=e.RibbonCssBase,tt.s.ribbonScriptsBase=e.RibbonScriptsBase,Ut.h.staticContentHost=e.StaticContentHost,Ut.h.sharedStaticContentHost=e.SharedStaticContentHost,Ut.h.set_staticContentQueryParameter(e.StaticContentQueryParameter),Ut.h.commonImageBase=e.CommonImageBase,Ut.h.commonCssBase=e.CommonCssBase,Ut.h.commonScriptsBase=e.CommonScriptsBase,Ut.h.commonScriptsLcidBase=e.CommonScriptsLcidBase},t.prototype.initializeDocument=function(){var e=t._docData.responseXml;De.k.isValidResponseXMLDoc(e)||(e=Sys.Net.XMLDOM(t._docData.responseData,!0));var n=null;e&&(n=e.selectSingleNode("/docdata/document")),n?(t.get_activeAppFrame().initializeAll(this._target),t.get_instance().set_status(2),1!==t.initialPageNumber&&this.get_scrollControl().scrollToPage(t.initialPageNumber),this.get_isBroadcastMode()&&p.AFrameworkApplication.get_theActionManager().processAction(O.Pi,2)):(Ie.u.showErrorDialog(e),Ie.u.propagateError(!0,"InvalidDocData",Ee.p.cannotOpenFile,CommonUIStrings.l_CannotOpenFile))},t.prototype.xmlPageDownloaded3=function(e,n,i,r,o){var a=o;return t.initialParagraphId&&this.foundParaIdInPageInfo(a)&&this.initializeDocument(),32},t.prototype.foundParaIdInPageInfo=function(e){var n,i,r=e.firstPage,o=e.lastPage;if(this.findParagraphInSelectionXml(e,(0,c.m)((function(){return i}),(function(e){return i=e})),(0,c.m)((function(){return n}),(function(e){return n=e})))){var a=this.get_zoomControl().get_currentZoom(),s=X.t.get_instance().getPageTopAtZoom(i,a),l=Math.round(s+n*a)-40;t.initialParagraphId=0,isNaN(l)||(t.initialScrollTop=l)}else{if(!(o>=X.t.get_instance().get_pageCount()))return t.get_activeAppFrame().thePageInfoCache.addToCache(o+1,o+1),!1;t.initialParagraphId=0,t.get_activeAppFrame().thePageInfoCache.removeFromCache(r,r)}return!0},t.prototype.findParagraphInSelectionXml=function(e,n,i){n.val=1,i.val=40;for(var r=e.firstPage;r<=e.lastPage;r++){var o=t.get_activeAppFrame().thePageInfoCache.getXmlForPage(r);if(o){var a=o.selectSingleNode(gt.i(r));if(a&&gt.t(a,i))return n.val=r,!0}}return!1},t.prototype.getSignInParams=function(){var e=t.get_activeAppFrame().getTopParagraphId(),n={targetWacAction:"View"};return n.wdparams="wdparaid= "+e,n},t.prototype.getCopyAndEditParams=function(){var e={targetWacAction:"Edit"},n=t.get_activeAppFrame().getTopParagraphId();return n&&(e.wdparams="wd=pid("+n+")"),e},t.prototype.getFileNewProperties=function(){var e=new Et;return e.createNewDocumentAspxRelativePath=this._wordEditorAppRootUrl+"/",e.flyoutAnchorId="faNew",e.headerButtonId="jbtnNewBlank",e.headerButtonText=WordViewerIntl.WordViewerStrings.L_NewBlank,e.headerButtonTitle=WordViewerIntl.WordViewerStrings.L_NewBlankDescription,e.image32by32=p.AFrameworkApplication.get_imageClusterPath(),e.image32by32Class=Dt.getImageClass("OLKNewButton_32x32x32"),e.labelText=WordViewerIntl.WordViewerStrings.L_New,e},t.prototype.getFileOpenProperties=function(){var e=new kt;return e.flyoutAnchorId="faOpen",e.image32by32=p.AFrameworkApplication.get_imageClusterPath(),e.image32by32Class=Dt.getImageClass("SaveAsWordDocx_32x32x32"),e},t.prototype.createAppSettingsManager=function(e){return new Ye(e)},t.prototype.onFullAppSettingsReady=function(){this.updateFullAppSettings(p.AFrameworkApplication.appSettingsManager.get_appSettings()),t.get_activeAppFrame().updateFullSettings(p.AFrameworkApplication.appSettingsManager.get_appSettings())},t.prototype.enqueueDelayLoadedFiles=function(){xt.z.enqueueResourceWithoutEnabling(Bt.v.create(Ut.h.commonScripts("wacairspaceanimationlibrary.js"),null,null,null,!1,!1,null,!0,this.get_isHttp2Enabled()))},t.prototype.resolveActionId=function(t){return O.rG(t)||e.prototype.resolveActionId.call(this,t)},t.get_instance=function(){return p.AFrameworkApplication._instance},t.get_activeAppFrame=function(){return p.AFrameworkApplication.get_activeFrame()},t.updateUrlForAccessiblePdfMode=function(e,n){var i=Me.n.addOrReplaceParameterValue(e,"wdAccPdf",n?"1":"0");return p.AFrameworkApplication.get_isEmbedded()&&(t.get_instance().get_showEmbed()||(i=Me.n.addOrReplaceParameterValue(i,"wdEmbedCode","0")),1!==t.initialPageNumber&&(i=Me.n.addOrReplaceParameterValue(i,"wdStartOn",t.initialPageNumber.toString()))),i},t.reportFirstPageAndRenderTime=function(){if(!p.AFrameworkApplication._reportedRenderTime){var e,t=window.g_1stPgLdT;null==t&&(t=new Date);var n=t.getTime();if(I.m.get_instance().recordContentFetchEnd(n),I.m.get_instance().recordContentDisplayed(n),I.m.get_instance().recordWacRenderTimeFromBrowserFetchStart(n),I.m.get_instance().recordOfficeFrameRequestStart(),"undefined"!=typeof window.__startTime){var i=window.__startTime;I.m.get_instance().recordContentFetchStart(i.getTime()),e=t.getTime()-i.getTime()}else e=1e9;if(p.AFrameworkApplication.get_isNoChrome()){var r=-1;"undefined"!=typeof window.documentClickTime&&(r=window.documentClickTime.getTime(),I.m.get_instance().recordUserClickedInHostUi(r));var o=-1;"undefined"!=typeof window.hostInitTime&&(o=window.hostInitTime.getTime(),Ge.e.get_instance().addMetric(ze.c.officeInitializationTime,o))}p.AFrameworkApplication.theWsaClient.setDw(10600,e)}},t.isReadyForRibbon=function(){return 1===t.get_instance().get_status()||2===t.get_instance().get_status()},t.isFirstPageImageDisplayed=function(){var e=document.getElementById("FirstPageImage");return!!e&&!!e.firstPageDisplayed},t.hideFirstPageImage=function(){var e=document.getElementById("FirstPageImage");e&&(e.onload="",e.onerror="");var t=document.getElementById("FirstPageContainer");t&&t.parentNode.removeChild(t)},t.InitializeHtmlScratchPadProvider=function(e){Rt.q.initialize(e)},t.determineInitialParagraphId=function(e){var t=null;void 0!==e.InitialParaId&&null!==e.InitialParaId&&(t=e.InitialParaId);var n=0;if(t)try{n=parseInt(t,16)}catch(e){}return n},t.onResourceTimingEntriesAvailable=function(e,t){for(var n=0;n<t.get_entries().length;n++){var i=t.get_entries()[n];i.set_url(Me.n.removeParameter(i.get_url(),p.AFrameworkApplication.accessTokenParamName));var r=Me.n.removeAllUrlParameters(i.get_url());("about:blank"===i.get_url()||r.endsWith("RemoteUls.ashx")||"renamehandler.ashx"===r&&"2"===Me.n.getParameterValue(i.get_url(),"u"))&&i.set_behavior(1)}},t.canEdit=!1,t.interactiveViewIsEnabled=!1,t.initialParagraphId=0,t.initialPageNumber=1,t.initialScrollTop=0,t.allowUnsafeAppClose=!1,t._docData=null,t.webServiceBase=null,t.mode=3,t}(E);(0,r.l)(Qt,"App",E,[u])},,function(e,t,n){"use strict";n.d(t,{i:function(){return c}});var i=n(572),r=n(998),o=n(600),a=n(208),s=n(149),l=n(755),u=n(244),c=function(){function e(t,n){this.getEnumerator=this.GetEnumerator,a.m(this,e.$$(t,n)),this._map=new Map,this._defaultValue=a.c(a.f(this,"$$sc.IntegralDictionary$2").TValue)}return e.prototype.$$ge=function(){return u.select(Array,l.z,u.fromIterator(Array,a.i(this._map,this._map.entries,"entries")),(function(e){return new l.z(e[0],e[1])})).$$ge()},e.prototype.GetEnumerator=function(){return this.$$ge()},e.prototype.get_count=function(){return this._map.size},e.prototype.get_keys=function(){return u.fromIterator(a.f(this,"$$sc.IntegralDictionary$2").TKey,a.i(this._map,this._map.keys,"keys"))},e.prototype.get_values=function(){return u.fromIterator(a.f(this,"$$sc.IntegralDictionary$2").TValue,a.i(this._map,this._map.values,"values"))},e.prototype.add=function(e,t){if(this._map.has(e))throw Error.create("DuplicateKeyException");this._map.set(e,t)},e.prototype.containsKey=function(e){return this._map.has(e)},e.prototype.remove=function(e){return!!this._map.has(e)&&(this._map.delete(e),!0)},e.prototype.tryGetValue=function(e,t){return this._map.has(e)?(t.val=this._map.get(e),!0):(t.val=this._defaultValue,!1)},e.prototype.get_item=function(e){var t;if(!this.tryGetValue(e,(0,o.m)((function(){return t}),(function(e){return t=e}))))throw Error.create("KeyNotFoundException");return t},e.prototype.set_item=function(e,t){return this._map.set(e,t),t},e.$$=function(t,n){var o="IntegralDictionary$2$"+t.getName()+"$"+n.getName(),l=a.x(o);return l||a.u(o,"$$sc.IntegralDictionary$2",e,[{TKey:t},{TValue:n}],null,[s.m.$$(t,n),i.i,r.k])},e}()},,function(e,t,n){"use strict";var i=n(208),r=n(529),o=n(614),a=n(645),s=n(254),l=n(334),u=n(973),c=n(744),p=n(508),d=n(319),h=function(e){function t(){var t=e.call(this)||this;return t.CommandMenuOpen=null,t.CommandMenuClose=null,t}return(0,p.t)(t,e),t}(d.c);(0,i.l)(h,"ContextMenuRootProperties",d.c,[]);var g="ContextMenuRootName",m=function(){function e(e){if(this._hostingAppFrame=null,this._root=null,null==e)throw Error.argumentNull("hostingAppFrame");this._hostingAppFrame=e;var t=new h;t.ImageSideArrow=s.AFrameworkApplication.get_imageClusterPath(),t.ImageSideArrowClass=u.getImageClass("SubmenuFlyoutArrow_13x13x32"),t.TextDirection=WordViewerIntl.WordViewerStrings.L_RibbonOptionTextDirection,this._root=new c.ContextMenuRoot(g,t),this._root.set_rootUser(this),this._root.refresh()}return e.prototype.dispose=function(){this._root&&(this._root.dispose(),this._root=null),this._hostingAppFrame=null,this._root=null},e.prototype.get_theRoot=function(){return this._root},e.prototype.executeRootCommand=function(e,t,n,i,r){void 0===i&&(i=null),void 0===r&&(r=null);var u=parseInt(e),c=s.AFrameworkApplication.get_theActionManager();n&&(c.set_commandLocation(n.CommandLocation),c.set_invocationMethod(n.InvocationMethod));var p=t;u===a.Nc?p=parseInt(t.MenuItemId):u!==a.Ap&&u!==o.or||(p=new l.p(null,n.InvocationMethod));var d=c.processActionWithData(u,2,p,r);return this._root.refresh(),32===d},e.prototype.isRootCommandEnabled=function(e){if(!e)return!0;var t=parseInt(e);return 32===s.AFrameworkApplication.get_theActionManager().processAction(t,1)},e.prototype.pollForStateAndUpdateInternal=function(){this.get_theRoot().get_root().pollForStateAndUpdate()},e.prototype.showContextMenuAt=function(e,t,n){this.pollForStateAndUpdateInternal(),this.get_theRoot().showContextMenuAt(e,t.x,t.y,n)},e}();(0,i.l)(m,"AContextMenuUser",null,[r.t,Sys.IDisposable]);var _=n(491),f=n(698),y=n(556);n.d(t,{k:function(){return v}});var v=function(){function e(t){this._contextMenuHandler=null,e._contextMenuUser=new m(t),this._contextMenuHandler=i.i(this,this.showDefaultContextMenu,"showDefaultContextMenu"),e._newEmbedModeIsEnabled=s.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("NewEmbedModeIsEnabled"),n(941).App.get_activeAppFrame().get_theContextMenuInputManager().registerHandler(window.document,this._contextMenuHandler,null)}return e.prototype.show=function(t){e.ensureContextMenuCreated();var i=t.get_clientPoint();n(941).App.get_instance().get_isSmallView()&&!e._newEmbedModeIsEnabled?(1===t.get_inputSource()&&(i=new Sys.UI.Point(0,0)),e._contextMenuUser.showContextMenuAt(e._menuId,i,t.get_inputSource())):s.AFrameworkApplication.get_theActionManager().processActionWithData(a.hP,1,t)},e.prototype.dispose=function(){e._contextMenuUser.dispose(),e._contextMenuUser=null,n(941).App.get_activeAppFrame().get_theContextMenuInputManager().unregisterHandler(window.document,this._contextMenuHandler),this._contextMenuHandler=null},e.prototype.showDefaultContextMenu=function(e){return this.show(e),!0},e.get_contextMenuUser=function(){return e._contextMenuUser},e.createContextMenu=function(){var t=e._contextMenuUser.get_theRoot(),i={PopulateDynamically:"true",PopulateOnlyOnce:"false"};i.PopulateQueryCommand=""+a.pw,i.Command=""+o.Hx;var r=s.AFrameworkApplication.get_theActionManager();n(941).App.get_instance().get_isSmallView()&&!e._newEmbedModeIsEnabled?(e._menuId="mnuEmbedViewer",n(941).App.get_instance().get_isAccessiblePdfMode()||r.addActionWithFlags(a.pw,_.d.application,e.populateContextMenuEmbedded,96)):(e._menuId="mnuSelectionViewer",r.addActionWithFlags(a.pw,_.d.application,e.populateContextMenuSelection,96)),t.createContextMenu(i,e._menuId,"","","Menu16")},e.populateContextMenuEmbedded=function(t,n,i,r,o){if(1===i)return 32;var a=o,l=new Sys.StringBuilder;return l.append(String.format('<Menu Id="{0}">',e._menuId)),l.append('<MenuSection Id="msZoomLevel" DisplayMode="Menu"><Controls>'),l.append(f.yL("fseaFitHeight","2719151194",WordViewerIntl.WordViewerStrings.L_FitHeight)),l.append(f.yL("fseaFitWidth","2289035997",WordViewerIntl.WordViewerStrings.L_FitWidth)),l.append(f.oG("100","3006111724",100)),l.append(f.oG("150","3006111724",150)),l.append("</Controls></MenuSection>"),s.AFrameworkApplication.get_trimDownloadACopy()||(l.append('<MenuSection Id="msDownload" DisplayMode="Menu"><Controls>'),l.append(f.yL("fseaDownloadACopy","3555692408",CommonUIStrings.L_DownloadACopy)),l.append("</Controls></MenuSection>")),l.append('<MenuSection Id="msFullScreen" DisplayMode="Menu"><Controls>'),l.append(f.yL("fseaFullScreen","2947452783",WordViewerIntl.WordViewerStrings.L_FullScreen)),l.append("</Controls></MenuSection></Menu>"),a.PopulationXML=l.toString(),32},e.populateContextMenuSelection=function(t,i,r,s,l){var u=n(941).App.get_instance().get_copyingEnabled(),c=!n(941).App.get_instance().get_accessibleModeEnabled()&&n(941).App.get_instance().get_userCanComment()&&n(941).App.get_instance().get_fileTypeSupportsCommenting();if(1===r)return n(941).App.get_instance().get_isAccessiblePdfMode()?8:u||c?32:8;var p=l,d=new Sys.StringBuilder;return d.append(String.format('<Menu Id="{0}">',e._menuId)),u&&(d.append('<MenuSection Id="msCopy" DisplayMode="Menu16"><Controls>'),d.append(e.generateButtonWithImageXml("fseaCopy",a.xx,"Copy_16x16x32",WordViewerIntl.WordViewerStrings.L_Copy)),d.append("</Controls></MenuSection>")),c&&(d.append('<MenuSection Id="msComment" DisplayMode="Menu16"><Controls>'),d.append(e.generateButtonWithImageXml("fseaComment",o.pp,"CommentComment_16x16x32",WordViewerIntl.WordViewerStrings.L_Comment)),d.append("</Controls></MenuSection>")),d.append("</Menu>"),p.PopulationXML=d.toString(),32},e.showFromKey=function(t){e.ensureContextMenuCreated(),"mnuSelectionViewer"===e._menuId&&s.AFrameworkApplication.get_theActionManager().processAction(a.di,1)},e.ensureContextMenuCreated=function(){e._inited||(e.createContextMenu(),e._inited=!0)},e.generateButtonWithImageXml=function(e,t,n,i){return String.format('<Button Id="{0}" Command="{1}" Image16by16="{2}" Image16by16Class="{3}" LabelText="{4}"/>',e,t,s.AFrameworkApplication.get_imageClusterPath(),u.getImageClass(n),y.l.xmlEncode(i))},e._contextMenuUser=null,e._menuId=null,e._inited=!1,e._newEmbedModeIsEnabled=!1,e}();(0,i.l)(v,"ContextMenuControl",null,[])},function(e,t,n){"use strict";n.d(t,{n:function(){return u}});var i=n(306),r=n(296),o=n(134),a=n(556),s=n(513),l=n(208),u=function(){function e(){}return e.removeChildNodes=function(e){if(s.x(e))return null;var t=e.parentNode;if(t){var n=e.cloneNode(!1);return t.replaceChild(n,e),n}for(var i=e.firstChild,r=void 0;i;)r=i.nextSibling,e.removeChild(i),i=r;return e},e.removeChildNodesSlow=function(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)},e.toggleCSSClassOnElement=function(t,n,i){i?e.ensureCSSClassOnElement(t,n):e.removeCSSClassFromElement(t,n)},e.ensureCSSClassOnElement=function(e,t){if(!s.x(e)){var n=e.className;if(s.x(n)||-1===n.indexOf(t)){var i=n.trim()+" "+t;i=i.trim(),e.className=i}}},e.removeCSSClassFromElement=function(e,t){if(!(s.x(e)||s.x(t)||s.x(e.className))){var n=e.className;n!==n.replace(t,"")&&(e.className=n.replace(t,""))}},e.setEnabledOnElement=function(t,n,i,r){if(void 0===i&&(i=!1),void 0===r&&(r=!1),!s.x(t)&&!i){e.toggleCSSClassOnElement(t,"cui-disabled",!n);var a=n?o.t.ariaFalseValue:o.t.ariaTrueValue;o.t.setAriaAttribute(t,o.t.ariaDisabledAttribute,a),r&&o.t.setAriaAttribute(t,o.t.ariaReadOnlyAttribute,a)}},e.addToTabLoop=function(e){e.tabIndex=0},e.createNoOpLink=function(t){void 0===t&&(t=!0);var n=e.createElement("a");return t&&e.addToTabLoop(n),n},e.validateStringProperty=function(e,t){return s.x(e)&&(e=t,s.x(e)&&(e="")),e},e.setUnselectable=function(t,n,i){if(!s.x(t)&&"#text"!==t.nodeName&&(n?t.setAttribute("unselectable","on"):t.setAttribute("unselectable","off"),i))for(var r=t.firstChild;r;)e.setUnselectable(r,n,!0),r=r.nextSibling},e.createClusteredImageContainerNew=function(t,n,i,r,o,a){var l=a?e.createBlockSpan():e.createElement("span");return l.className+=o?" cui-img-cont-float ":" cui-img-container ",l.className+=e.imageSizeToClass[t],s.t(n)||(l.appendChild(r),r.src=n,r.setAttribute("role","presentation"),s.x(i)||(r.className=i)),l},e.setLargeControlText=function(t,n,i){var r=n,o=!1,a=null,l=n.lastIndexOf("\u200b\u200b");if(-1!==l)r=n.substr(0,l),o=!0,a=n.substr(l+2);else{var u=n.lastIndexOf(" ");-1!==u?(r=n.substr(0,u),o=!0,a=n.substr(u+1)+(i?" ":"")):i&&(o=!0)}t.innerHTML="",t.appendChild(document.createTextNode(r)),o&&t.appendChild(document.createElement("br"));var c=!s.t(a);c&&t.appendChild(document.createTextNode(a)),e.ensureCSSClassOnElement(t,c?"cui-ctl-largelabel-twoline":"cui-ctl-largelabel-singleline")},e.setControlText=function(t,n,i){r.s.setFormattedTextToPlaceholders(t,n,i,(function(t){var n;return(n=e.createElement("span")).setAttribute("dir","auto"),n.innerText=t,n}))},e.releaseEventHandlersRecursively=function(t){if(!s.x(t)&&(e.unregisterAllHandlers(t),!s.x(t.childNodes)))for(var n=0;n<t.childNodes.length;n++)e.releaseEventHandlersRecursively(t.childNodes[n])},e.createBlockSpan=function(){var t=e.createElement("span");return t.className="cui-block",t},e.isTrue=function(e){return!s.x(e)&&"true"===a.l.toLower(e)},e.isFalse=function(e){return!s.x(e)&&"false"===a.l.toLower(e)},e.createElement=function(e){var t=document.createElement(e);return t.setAttribute("unselectable","on"),t},e.createSelectableElement=function(e){return document.createElement(e)},e.cancelPendingTimeout=function(e){-1!==e.val&&(window.clearTimeout(e.val),e.val=-1)},e.cancelInterval=function(e){-1!==e.val&&(window.clearInterval(e.val),e.val=-1)},e.unregisterAllHandlers=function(e){i.EventHandlerManager.get_instance().unregisterAllHandlers(e)},e.preventDefaultKeyAction=function(e,t){return e.innerEvent.keyCode===t&&(e.innerEvent.preventDefault(),!0)},e.isEncodedStringArray=function(t){return t.startsWith(e._encodedStringArrayToken)},e.encodeStringArrayXmlAttribute=function(t){if(!t||!t.length)return null;for(var n=new Sys.StringBuilder(e._encodedStringArrayToken),i=0,r=t;i<r.length;i++){var o=r[i];n.append(o?o.length:0),n.append(","),n.append(o),n.append(",")}return n.toString().slice(0,-1)},e.decodeStringArrayXmlAttribute=function(t){if(s.t(t)||!t.startsWith(e._encodedStringArrayToken))return null;if(!(t=t.slice(e._encodedStringArrayToken.length)).length)return null;for(var n=[];t.length>0;){var i=parseInt(t);if(isNaN(i)||i<0)return null;var r=t.indexOf(",");if(-1===r)return null;n.push(t.substr(r+1,i)),t=t.slice(r+1+i+1)}return n},e._encodedStringArrayToken="STRARRY@",e.imageSizeToClass=["","cui-img-5by3","cui-img-8by8","cui-img-13by13","cui-img-16by16","cui-img-32by32","cui-img-40by40","cui-img-48by48","cui-img-64by48","cui-img-85by48","cui-img-1by16","cui-img-14by14","cui-img-24by24","cui-img-20by20","cui-img-30by30","cui-img-120by20","cui-img-84by21","cui-img-90by21"],e.galleryElementDimensionsToSizeString=["","Size16by16","Size40by40","Size48by48","Size61by75","Size64by48","Size85by48","Size110by75","Size85by16","Size32by32","Size120by20","Size20by20","Size24by24","Size84by21","Size90by21"],e}();(0,l.l)(u,"Utility",null,[])},function(e,t,n){var i=n(548);e.exports=function(e){return Object(i(e))}},,,function(e){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t,n){"use strict";n.r(t);var i=n(208),r=n(801),o=n(530),a=n(31),s=(0,i.y)("IControl"),l=n(600),u=n(254),c=n(134),p=n(930),d=n(268),h=function(){function e(){this._controlComponentDomCollection=null,this._controlComponentDomCollection={}}return e.prototype.addDomObject=function(e){this._controlComponentDomCollection[e.get_displayMode()]=e},e.prototype.forEach=function(e){var t=this._controlComponentDomCollection;for(var n in t){e({key:n,value:t[n]}.value)}},e.prototype.get_small=function(){return this._controlComponentDomCollection.Small||this._controlComponentDomCollection.Small14},e.prototype.get_medium=function(){return this._controlComponentDomCollection.Medium||this._controlComponentDomCollection.Medium14},e.prototype.get_large=function(){return this._controlComponentDomCollection.Large||this._controlComponentDomCollection.FloatieLarge},e.prototype.get_smallMenu=function(){return this._controlComponentDomCollection.Menu||this._controlComponentDomCollection.Menu16||this._controlComponentDomCollection.MenuTellMe},e.prototype.get_largeMenu=function(){return this._controlComponentDomCollection.Menu32||this._controlComponentDomCollection.Menu48},e.prototype.get_item=function(e){return this._controlComponentDomCollection[e]},e.prototype.clear=function(){this._controlComponentDomCollection={}},e}();(0,i.l)(h,"ControlComponentDomCache",null,[]);var g=n(288),m=n(866),_=n(861),f=n(753),y=n(345),v=n(513),S=n(912),C=n(946);n.d(t,{Control:function(){return b}});var b=function(){function e(e,t,n){this._root=null,this._properties=null,this._displayModes=null,this._enabled=!1,this._enabledHasBeenSet=!1,this._isForceSetEnabledState=!1,this._disposed=!1,this._visible=!0,this.id=null,this.labelText=null,this.tooltip=null,this.parentKeytipsIds=null,this.parentKeytipsKeys=null,this.controlComponentDomCache=null,this.behavior=null,this.inMenu=!1,this._stateProperties=null,this._commandProperties=null,this._activeComponentWhenVisible=null,this._parentMenu=null,this._parentMenuComputed=!1,this._parentGrid=null,this._parentGridComputed=!1,this._components=[],this._root=e,this.id=t,this._properties=n,this._displayModes=",",this.controlComponentDomCache=new h,this._visible=!C.n.isFalse(n.Visible),e.registerControl(this),this.connectControlBehaviorIfAvailable()}return e.prototype.getMenuItemId=function(){return this.get_controlProperties().MenuItemId},e.prototype.getCommandValueId=function(){return v.t(this.get_controlProperties().CommandValueId)?this.getMenuItemId():this.get_controlProperties().CommandValueId},e.prototype.getTextValue=function(){return""},e.prototype.get_id=function(){return this.id},e.prototype.get_needsAKeytip=function(){return!1},e.prototype.get_controlComponentDomCache=function(){return this.controlComponentDomCache},e.prototype.get_isVisualRefreshEnabled=function(){return!!u.AFrameworkApplication.get_activeFrame()&&u.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isRibbonVisualRefreshEnabled()},e.prototype.connectControlBehaviorIfAvailable=function(){if(!this.behavior){var e=p.b.get_controlBehaviorFactory();e&&(this.behavior=e.getBehaviorForControl(this))}},e.prototype.get_controlProperties=function(){return this._properties},e.prototype.get_stateProperties=function(){return v.x(this._stateProperties)&&(this._stateProperties={}),this._stateProperties},e.prototype.get_commandProperties=function(){return v.x(this._commandProperties)&&(this._commandProperties={}),this._commandProperties},e.prototype.get_isDefinitive=function(){return C.n.isTrue(this.get_controlProperties().IsDefinitive)},e.prototype.get_shouldIgnoreTitle=function(){return C.n.isFalse(this.get_controlProperties().ShouldSetTitle)},e.prototype.get_templateAlias=function(){return this.get_controlProperties().TemplateAlias},e.prototype.get_ariaRole=function(){return this.inMenu?c.t.ariaMenuItemRole:c.t.ariaButtonRole},e.prototype.ensureValidDisplayMode=function(e){if(-1===this._displayModes.indexOf(","+e+","))throw Error.create("The display mode with name: "+e+" is not valid for this control with id: "+this.get_id())},e.prototype.refreshDOMElements=function(){this.onStateChanged(),this.get_enabled()||this.onEnabledChanged(!1)},e.prototype.onStateChanged=function(){},e.prototype.createDOMElementForDisplayMode=function(e,t){this.ensureValidDisplayMode(e);var n=this.createComponentDomForDisplayMode(e);return this.get_controlComponentDomCache().addDomObject(n),this.behavior&&this.behavior.attachEvents(n),t&&t.get_hasKeytip()&&this.ensureKeytipForControl(t,n.elmControl),n.elmControl},e.prototype.ensureKeytipForControl=function(e,t){e.ensureKeytip(t,t,this.parentKeytipsIds,this.parentKeytipsKeys)},e.prototype.getDOMElementForDisplayMode=function(e,t){this.ensureValidDisplayMode(e);var n=this.get_controlComponentDomCache().get_item(e);if(n&&n.elmControl)return n.elmControl;var i=this.createDOMElementForDisplayMode(e,t);return v.t(i.id)&&(i.id=this.get_id()+"-"+e),this.refreshDOMElements(),i},e.prototype.createComponentForDisplayMode=function(e){var t=this.createComponentForDisplayModeInternal(e);return Array.add(this._components,t),t},e.prototype.get_components=function(){return this._components},e.prototype.createComponentForDisplayModeInternal=function(e){return d.r.isDisplayModeMenu(e)?this._root.createMenuItem(this.getComponentId(e),e,this):this._root.createControlComponent(this.getComponentId(e),e,this)},e.prototype.getComponentId=function(e){return this.get_id()+"-"+e+this._root.getUniqueNumber()},e.prototype.dispose=function(){this._disposed||(this.releaseEventHandlers(),this._root=null,this._components=null,this._displayModes=null,this.get_controlComponentDomCache().clear(),this._disposed=!0)},e.prototype.releaseEventHandlers=function(){this.get_controlComponentDomCache().forEach((function(e){C.n.releaseEventHandlersRecursively(e.elmControl)}))},e.prototype.get_root=function(){return this._root},e.prototype.addDisplayMode=function(e){-1===this._displayModes.indexOf(","+e+",")&&(this._displayModes+=e+",")},e.prototype.ensureCorrectChildType=function(e){throw Error.create("Child Components may not be added to this type of ControlComponent.")},e.prototype.get_displayedComponent=function(){if(!this._components)return null;for(var e=this._components.length,t=0;t<e;t++){var n=this._components[t];if(n.get_visibleInDOM())return n}return null},e.prototype.get_displayMode=function(){var e=this.get_displayedComponent();return e?e.get_displayMode():null},e.prototype.get_activeComponentWhenVisible=function(){return this._activeComponentWhenVisible||(this._components&&this._components.length>0?this._components[0]:null)},e.prototype.set_activeComponentWhenVisible=function(e){return this._activeComponentWhenVisible=e,e},e.prototype.constructClonedControlForMenu=function(e,t){return this.constructClonedControl(e,t)},e.prototype.clone=function(t,n){void 0===n&&(n=null);var i=e.generateCloneProperties(this._properties,n);return this.constructClonedControl(t,i)},e.prototype.cloneForMenu=function(t,n){void 0===n&&(n=null);var i=e.generateCloneProperties(this._properties,n);return this.constructClonedControlForMenu(t,i)},e.prototype.onEnabledChanged=function(t){var n=this;this.get_controlComponentDomCache().forEach((function(i){C.n.setEnabledOnElement(i.elmControl,t,n.get_controlType()===e.labelControlType,n.get_isEditable())}))},e.prototype.onVisibleChanged=function(e){if(12===this.get_root().get_rootType()&&this.get_displayedComponent())this.get_displayedComponent().get_elementInternal().style.display=e?"inline-block":"none";else for(var t=this._components.length,n=0;n<t;++n){var i=this._components[n];i.set_visible(e),i.onDirtyingChange()}},e.prototype.get_parentMenu=function(){if(!this._parentMenuComputed){var e=this.get_displayedComponent();i.r(f.m,e)&&(e=e.get_parent(),i.r(g.p,e)&&(e=e.get_parent()),i.r(y.z,e)&&(e=e.get_parent(),i.r(_.Menu,e)&&(this._parentMenu=e))),this._parentMenuComputed=!0}return this._parentMenu},e.prototype.get_parentGrid=function(){if(!this._parentGridComputed){var e=this.get_displayedComponent();if(i.r(f.m,e)){var t=e,o=!1;i.r(n(958).ColorPicker,t.get_control())&&(o=!0),!o&&i.r(r.y,t.get_control())&&(o=!0),o||(e=e.get_parent(),i.r(g.p,e)&&(o=!0)),o&&(this._parentGrid=e),this._parentGridComputed=!0}}return this._parentGrid},e.prototype.onMenuClosed=function(){this.behavior&&this.behavior.onMenuClosed()},e.prototype.doDefaultAction=function(e,t,n){this.behavior&&this.behavior.doDefaultAction(e,t,n)},e.prototype.doDefaultActionPublic=function(e,t,n){this.doDefaultAction(e,t,n)},e.prototype.onKeyDown=function(e){return!!this.behavior&&this.behavior.onKeyDown(e)},e.prototype.onKeyUp=function(e){return!!this.behavior&&this.behavior.onKeyUp(e)},e.prototype.onPointerDown=function(e){return!!this.behavior&&this.behavior.onPointerDown(e)},e.prototype.onModalBodyPointerDown=function(e){return!!this.behavior&&this.behavior.onModalBodyPointerDown(e)},e.prototype.onModalBodyPointerUp=function(e){return!!this.behavior&&this.behavior.onModalBodyPointerUp(e)},e.prototype.onModalBodyPointerMove=function(e){return!!this.behavior&&this.behavior.onModalBodyPointerMove(e)},e.prototype.onModalBodyPointerOut=function(e){return!!this.behavior&&this.behavior.onModalBodyPointerOut(e)},e.prototype.onModalBodyClick=function(e){return!!this.behavior&&this.behavior.onModalBodyClick(e)},e.prototype.onModalBodyMouseWheel=function(e){return!!this.behavior&&this.behavior.onModalBodyMouseWheel(e)},e.prototype.get_activatesOnPress=function(){return!1},e.prototype.deactivateElement=function(e){return!!this.behavior&&this.behavior.deactivateElement(e)},e.prototype.get_enabled=function(){return this._enabled},e.prototype.set_enabled=function(e){return this._isForceSetEnabledState?e:this._enabled===e&&this._enabledHasBeenSet?e:(this._enabled=e,this._enabledHasBeenSet=!0,this.onEnabledChanged(e),e)},e.prototype.forceSetEnabledState=function(e){this._isForceSetEnabledState=!0;var t=this.get_enabled();this._enabled=e,t!==e&&this.onEnabledChanged(e)},e.prototype.get_visible=function(){return this._visible},e.prototype.set_visible=function(e){var t=e;if(!t&&!this.get_root().get_supportsInvisibleControls())throw Error.create("This root does not support dynamically showing or hiding controls.");return t!==this._visible&&(this._visible=t,this.get_stateProperties()[S.b.visible]=t,this.onVisibleChanged(t)),e},e.prototype.get_disposed=function(){return this._disposed},e.prototype.get_enabledInternal=function(){return this._enabled},e.prototype.set_enabledInternal=function(e){return this._enabled=e,e},e.prototype.setEnabledAndForceUpdate=function(e){this._enabled=e,this.onEnabledChanged(e)},e.prototype.pollForStateAndUpdate=function(){this.behavior?(this.set_enabled(!0),this.behavior.pollForStateAndUpdate()):this.set_enabled(!1)},e.prototype.pollForStateAndUpdateInternal=function(e,t,n){return this.behavior?this.behavior.pollForStateAndUpdateInternal(e,t,n):0},e.prototype.ensureBehaviorAttachedIfAvailable=function(){if(!this.behavior){this.connectControlBehaviorIfAvailable();var e=this.behavior;e&&(this.get_controlComponentDomCache().forEach(i.i(e,e.attachEvents,"attachEvents")),e.initialize())}},e.prototype.focusNext=function(e){return!!this.behavior&&this.behavior.focusNext(e)},e.prototype.getDisplayedComponentElement=function(){var e=this.get_displayedComponent();return v.x(e)?null:e.get_elementInternal()},e.prototype.get_focusableElement=function(){return null},e.prototype.setFocusOnControl=function(){return!!this.behavior&&this.behavior.setFocusOnControl()},e.prototype.commitPendingChange=function(){},e.prototype.isStandardMenuItem=function(){return i.r(f.m,this.get_displayedComponent())&&!i.r(m.Jewel,this.get_root())},e.prototype.isMemberOfContextMenuDropDown=function(){return!!this.get_parentMenu()&&this.get_parentMenu().isFloatieContextMenuDropDown},e.prototype.get_isEditable=function(){return!1},e.generateCloneProperties=function(e,t){var n={};for(var i in e){n[(o={key:i,value:e[i]}).key]=o.value}for(var r in t){var o;n[(o={key:r,value:t[r]}).key]=o.value}return n},e.focusNextIndexInGrid=function(t,n,i,r){switch(r){case 0:return e.focusForwardIndex(t,i);case 1:return e.focusBackwardIndex(t,i);case 2:return e.focusLeftIndex(t,n,i);case 4:return e.focusRightIndex(t,n,i);case 5:return e.focusUpIndex(t,n,i);case 6:return e.focusDownIndex(t,n,i);default:return-1}},e.focusForwardIndex=function(e,t){var n=-1===e?0:e+1;return n<t?n:e},e.focusBackwardIndex=function(e,t){var n=-1===e?t-1:e-1;return n>=0?n:e},e.focusLeftIndex=function(e,t,n){var i;-1===e?i=n-1:i=e%t>0?e-1:Math.min(e+(t-1),n-1);return i},e.focusRightIndex=function(e,t,n){var i;if(-1===e)i=0;else{var r=e%t;i=r<t-1&&e<n-1?e+1:e-r}return i},e.focusUpIndex=function(e,t,n){var i;if(-1===e){var r=n%t;i=r?n-r:n-t}else i=e-t;return i>=0?i:e},e.focusDownIndex=function(e,t,n){var i=-1===e?0:e+t;return i<n?i:e},e.getControlSize=function(e){var t=6;switch(e){case"Large":case"LargeNoText":t=0;break;case"Large30":t=1;break;case"Large16":t=2;break;case"FloatieLarge":t=3;break;case"Medium20":t=5;break;case"Medium14":case"Small14":t=7;break;case"Small20":t=5;break;case"Small24":t=8;break;case"Menu20":t=5;break;case"Menu32":case"Initials":t=0;break;case"Menu48":t=4}return t},e.updateStyle=function(e,t,n,i,r){switch(e){case"Large":t.val="cui-ctl-large";break;case"LargeNoText":case"Large30":n.val=!1,t.val="cui-ctl-large";break;case"Large16":t.val="cui-ctl-medium";break;case"FloatieLarge":t.val="cui-ctl";break;case"Medium20":case"Medium":case"Medium14":t.val="cui-ctl-medium";break;case"MediumCompact":t.val="cui-ctl-medium cui-ctl-compact";break;case"Small":case"Small14":case"Small20":case"Small24":n.val=!1,t.val="cui-ctl";break;case"Menu":case"Menu16":case"MenuTellMe":i.val="Menu16"===e||"MenuTellMe"===e,t.val="cui-ctl-menu cui-ctl-menu16";break;case"Menu20":i.val=!0,t.val="cui-ctl-menu cui-ctl-menu20";break;case"Menu32":i.val=!0,t.val="cui-ctl-menu cui-ctl-menu32";break;case"Initials":i.val=!0,r.val=!0,t.val="cui-ctl-menu cui-ctl-menu32";break;case"Menu48":i.val=!0,t.val="cui-ctl-menu cui-ctl-menu48";break;case"Thin":n.val=!1,t.val="cui-ctl-thin";break;default:t.val="cui-ctl"}},e.setImageProperties=function(e,t,n,i,r,o,a){switch(e){case 0:i.val=t.Image32by32,r.val=t.Image32by32Class,o.val=5,a.val=n?"cui-ctl-iconContainer":"cui-ctl-largeIconContainer";break;case 1:i.val=t.Image30by30,r.val=t.Image30by30Class,o.val=14,a.val="cui-ctl-large30IconContainer";break;case 2:i.val=t.Image16by16,r.val=t.Image16by16Class,o.val=4,a.val="cui-ctl-large16IconContainer";break;case 3:i.val=t.Image24by24,r.val=t.Image24by24Class,o.val=12,a.val="cui-ctl-largeFloatieIconContainer";break;case 4:i.val=t.Image48by48,r.val=t.Image48by48Class,o.val=7;break;case 8:i.val=t.Image24by24,r.val=t.Image24by24Class,o.val=12,a.val="cui-ctl-iconContainer24";break;case 5:i.val=t.Image20by20,r.val=t.Image20by20Class,o.val=13,a.val="cui-ctl-iconContainer20";break;case 7:i.val=t.Image16by16,r.val=t.Image16by16Class,o.val=11,a.val="cui-ctl-iconContainer14";break;case 6:default:i.val=t.Image16by16,r.val=t.Image16by16Class,o.val=4}},e.createLabel=function(t,n,i,r,o,a,s){var l=e.createElementLabel(t);if(n){!i&&!r||3===i?(C.n.ensureCSSClassOnElement(l,"cui-ctl-largelabel"),C.n.setLargeControlText(l,o.val,a)):(a&&i&&4!==i&&(o.val+=" "),C.n.ensureCSSClassOnElement(l,"cui-ctl-mediumlabel"),2===i&&C.n.ensureCSSClassOnElement(l,"UISmallFont"),C.n.setControlText(l,o.val,t.LabelTextUserGeneratedPlaceholderReplacements),t.AriaLabel&&(l.setAttribute(c.t.ariaLabelAttribute,t.AriaLabel),l.setAttribute("id",e.elmLabelText+s.get_id())));var u=t.LabelCss;v.t(u)||(l.style.cssText=u)}else 8===i?C.n.ensureCSSClassOnElement(l,"cui-ctl-small24label"):C.n.ensureCSSClassOnElement(l,"cui-ctl-smalllabel");return l},e.createDescription=function(t,n,r,o,a){var s=C.n.createElement("span");s.className="cui-ctl-menulabel",s.appendChild(t);var l=n.Description;return a.val=C.n.createElement("span"),C.n.ensureCSSClassOnElement(a.val,"cui-btn-menu-description"),s.appendChild(a.val),a.val.style.display="block",v.x(l)?i.r(m.Jewel,o)||C.n.ensureCSSClassOnElement(t,"cui-ctl-mediumlabel-nodescription"):(a.val.innerText=l,n.AriaDescribedById&&(a.val.setAttribute("id",e.elmDescriptionText+r.get_id()),a.val.setAttribute("aria-hidden","True")),i.r(m.Jewel,o)||C.n.ensureCSSClassOnElement(t,"UIFontBold"),v.x(r.get_id())||v.x(n.AriaDescribedByText)||s.appendChild(e.createHiddenElement("elmDescriptionPreText"+r.get_id(),n.AriaDescribedByText)),v.x(n.AriaLabelledById)||v.x(n.AriaLabelledByText)||s.appendChild(e.createHiddenElement(n.AriaLabelledById,n.AriaLabelledByText))),s},e.createArrow=function(e,t,n){var i=null,r=C.n.createElement("img");return r.alt="",e?(i=C.n.createClusteredImageContainerNew(3,t.get_properties().ImageSideArrow,t.get_properties().ImageSideArrowClass,r,!1,!1),C.n.ensureCSSClassOnElement(i,"cui-fa-menu-arrow")):i=n.get_isVisualRefreshEnabled()?C.n.createClusteredImageContainerNew(2,t.get_properties().ImageDownArrow8by8,t.get_properties().ImageDownArrow8by8Class,r,!0,!1):C.n.createClusteredImageContainerNew(1,t.get_properties().ImageDownArrow,t.get_properties().ImageDownArrowClass,r,!0,!1),i},e.createStandardControlDOMElement=function(t,n,i,r,o,a,s,u,c){var p=!1;"MenuTellMeExtended"===i&&(i="MenuTellMe",p=!0),"Menu16DescriptionEnabled"===i&&(i="Menu16",p=!0);var h=r.LabelText||"";""===h&&"MenuTellMe"===i&&(h=r.LabelText=r.Alt||"");var g=d.r.isDisplayModeMenu(i);t.inMenu=g;var m=!0,_=e.getControlSize(i),f=!1,y=!1,S=null;e.updateStyle(i,(0,l.m)((function(){return S}),(function(e){return S=e})),(0,l.m)((function(){return m}),(function(e){return m=e})),(0,l.m)((function(){return f}),(function(e){return f=e})),(0,l.m)((function(){return y}),(function(e){return y=e})));var b=e.createOuterElement(S,t,!v.x(r.Description));n.supportsEmphasizedControls&&C.n.isTrue(r.IsEmphasized)&&C.n.ensureCSSClassOnElement(b,"cui-emphasized");var A=r.Alt;v.t(A)&&(A=h),m&&A===h||(b.title=A);var T=null,w=null,I=null,E=null,k=null,D=0,M="cui-ctl-iconContainer";e.setImageProperties(_,r,g,(0,l.m)((function(){return E}),(function(e){return E=e})),(0,l.m)((function(){return k}),(function(e){return k=e})),(0,l.m)((function(){return D}),(function(e){return D=e})),(0,l.m)((function(){return M}),(function(e){return M=e})));var P=!v.t(E);if(y)w=C.n.createElement("div"),C.n.ensureCSSClassOnElement(w,"cui-ctl-initials"),M="cui-ctl-initials",w.innerText="KB";else if(P||f){(T=C.n.createElement("img")).alt="";var F=C.n.createClusteredImageContainerNew(D,E,k,T,!0,!1);(w=C.n.createElement("span")).className=M,w.appendChild(F)}var x=null;(m||o)&&(x=e.createLabel(r,m,_,g,(0,l.m)((function(){return h}),(function(e){return h=e})),o,t));var R=null;((!_||4===_)&&g||p&&!v.t(r.Description))&&(C.n.ensureCSSClassOnElement(x,"cui-btn-title"),R=e.createDescription(x,r,t,n,(0,l.m)((function(){return I}),(function(e){return I=e}))));var B=null;return o&&(B=e.createArrow(g,n,t)),v.x(w)||b.appendChild(w),v.x(R)?v.x(x)||b.appendChild(x):b.appendChild(R),v.x(B)||(g?b.appendChild(B):3===_&&!v.x(w)&&o?w.appendChild(B):v.x(R)?x.appendChild(B):R.appendChild(B)),a.val=x,s.val=T,u.val=I,c.val=w,b},e.createElementLabel=function(e){return e.hasOwnProperty("For")?C.n.createElement("label"):C.n.createElement("span")},e.createOuterElement=function(t,n,i){var r;return void 0===i&&(i=!1),r=n.get_controlType()===e.labelControlType?C.n.createBlockSpan():C.n.createNoOpLink(),C.n.ensureCSSClassOnElement(r,t),r.setAttribute("mscui:controltype",n.get_controlType()),"1959943459"===n.get_controlProperties().Command?r.setAttribute(c.t.ariaRoleAttribute,c.t.ariaLinkRole):n.get_controlType()!==e.labelControlType&&r.setAttribute(c.t.ariaRoleAttribute,n.get_ariaRole()),i&&r.setAttribute(c.t.ariaDescribedByAttribute,e.elmDescriptionPreText+n.get_id()+" "+e.elmDescriptionText+n.get_id()),r},e.createHiddenElement=function(e,t){var n=C.n.createElement("span");return C.n.ensureCSSClassOnElement(n,"cui-btn-menu-"+e),n.innerText=t,t&&(n.setAttribute("id",e),n.setAttribute("aria-hidden","True"),n.setAttribute("hidden","True")),n},e.hasTextSpace=function(e){switch(e){case"LargeNoText":case"Large30":case"Small":case"Small14":case"Small20":case"Small24":case"Thin":return!1}return!0},e.buttonControlType="Button",e.colorPickerControlType="ColorPicker",e.comboBoxControlType="ComboBox",e.contextMenuControlType="ContextMenuControl",e.contextMenuLauncherControlType="ContextMenuLauncher",e.dialogMenuLauncherControlType="DialogMenuLauncher",e.fileMenuButtonControlType="FileMenuButton",e.flyoutAnchorControlType="FlyoutAnchor",e.galleryButtonControlType="GalleryButton",e.insertTableControlType="InsertTable",e.jewelMenuLauncherControlType="JewelMenuLauncher",e.labelControlType="Label",e.placeholderControlType="Placeholder",e.searchBoxControlType="SearchBox",e.separatorControlType="Separator",e.splitButtonControlType="SplitButton",e.statefulColorFlyoutAnchorControlType="StatefulColorFlyoutAnchor",e.statefulColorSplitButtonControlType="StatefulColorSplitButton",e.statefulImageSplitButtonControlType="StatefulImageSplitButton",e.sliderControlType="Slider",e.spinnerControlType="Spinner",e.textBoxControlType="TextBox",e.toggleButtonControlType="ToggleButton",e.dropDownControlType="DropDown",e.elmDescriptionPreText="elmDescriptionPreText",e.elmDescriptionText="elmDescriptionText",e.elmLabelText="LabelText",e.activeClassName="cui-ctl-active",e}();(0,i.l)(b,"Control",null,[Sys.IDisposable,o.x,a.o,s])},,,,,,function(e,t,n){"use strict";n.d(t,{e:function(){return r}});var i=n(208),r=function(){return function(){this.durationMs=null,this.extendedProperties=null}}();(0,i.l)(r,"AdditionalValues",null,[])},function(e,t,n){"use strict";n.r(t);var i=n(508),r=n(530),o=n(160),a=n(951),s=n(134),l=n(920),u=n(208),c=function(e){function t(t,n){var i=e.call(this,t,n)||this;return i.aTags=[],i.colorCells=[],i}return(0,i.t)(t,e),t}(l.d);(0,u.l)(c,"ColorPickerComponentDom",l.d,[]);var p=n(946);n.d(t,{ColorPicker:function(){return d}});var d=function(e){function t(t,n,i,r){var o=e.call(this,t,n,i)||this;return o._colors=null,o.width=0,o.colorPickerDom=null,o.addDisplayMode("Menu"),o._colors=r,o.width=parseInt(i.Width),o}return(0,i.t)(t,e),t.prototype.get_width=function(){return this.width},t.prototype.get_colorPickerDom=function(){return this.colorPickerDom},t.prototype.get_controlType=function(){return a.Control.colorPickerControlType},t.prototype.createComponentDomForDisplayMode=function(e){var t=p.n.createElement("table");1===this.get_root().get_textDirection()?t.dir="rtl":t.dir="ltr",t.className="cui-smenu-inner cui-colorpicker-table",t.setAttribute("cellSpacing","0"),t.setAttribute("cellPadding","0"),t.setAttribute("mscui:controltype",this.get_controlType()),t.setAttribute(s.t.ariaRoleAttribute,s.t.ariaGridRole);var n=new c(e,t),i=p.n.createElement("tbody");return this.addColorCells(n,i,this._colors),t.appendChild(i),this.colorPickerDom=n,n},t.prototype.addColorCells=function(e,n,i){for(var r=null,o=n.ownerDocument,a=i.length/this.get_width(),l=0,u=0,c=p.n.isTrue(this.get_properties().McuLayout),d=0;d<i.length;d++){u++,d%this.get_width()||(l++,u=1,(r=o.createElement("tr")).setAttribute(s.t.ariaRoleAttribute,s.t.ariaRowRole),r.setAttribute(s.t.ariaLabelAttribute,String.format(CommonUIStrings.l_GalleryRowAccessibleLabelFormat,l)),n.appendChild(r),t.setRowCssClass(r,l,a,c));var h=o.createElement("td");h.className="cui-colorpicker-cell",h.setAttribute("arrayPosition",String.format("{0}",d)),h.setAttribute(s.t.ariaRoleAttribute,s.t.ariaPresentationRole),!c&&this.get_width()<6&&p.n.ensureCSSClassOnElement(h,"cui-colorpicker-cell-large"),1===u&&p.n.ensureCSSClassOnElement(h,"cui-colorpicker-firstcol"),r.appendChild(h);var g=p.n.createNoOpLink(),m=i[d].Title;g.title=m,g.setAttribute(s.t.ariaRoleAttribute,s.t.ariaGridCellRole),g.className="cui-colorpicker-cell-a";var _=o.createElement("canvas");_.className="cui-colorpicker-celldiv";var f=_.getContext("2d");f.fillStyle=i[d].DisplayColor,f.fillRect(0,0,_.width,_.height);var y=o.createElement("div");y.className="cui-colorpicker-cellinternaldiv",h.appendChild(g),g.appendChild(_),_.appendChild(y),h[t.colorInformation]=i[d].Color,Array.add(e.colorCells,h),Array.add(e.aTags,g)}},t.prototype.get_properties=function(){return e.prototype.get_controlProperties.call(this)},t.prototype.constructClonedControl=function(e,n){return new t(e,this.get_id(),n,this._colors)},t.setRowCssClass=function(e,t,n,i){1===t&&p.n.ensureCSSClassOnElement(e,"cui-colorpicker-firstrow"),i?1===t?p.n.ensureCSSClassOnElement(e,"cui-colorpicker-mcurow"):(p.n.ensureCSSClassOnElement(e,"cui-colorpicker-compactrow"),2===t?p.n.ensureCSSClassOnElement(e,"cui-colorpicker-firstcompactrow"):t===n&&p.n.ensureCSSClassOnElement(e,"cui-colorpicker-lastcompactrow")):p.n.ensureCSSClassOnElement(e,"cui-colorpicker-spacedrow")},t.colorInformation="ColorInformation",t}(a.Control);(0,u.l)(d,"ColorPicker",a.Control,[r.x,o.a])},function(e,t,n){"use strict";n.d(t,{i:function(){return r},b:function(){return o},d:function(){return a},t:function(){return s}});var i=n(917),r=function(e){return String.format("/Pages/Page[@id='{0}']/descendant::P[@id='{1}']/T[1]",e,n(941).App.initialParagraphId.toString(16).toUpperCase())},o=function(e){for(var t=new Sys.UI.Point(0,0);e;)t.x+=e.offsetLeft,t.y+=e.offsetTop,isNaN(e.clientLeft)||(t.x+=e.clientLeft),isNaN(e.clientTop)||(t.y+=e.clientTop),e=e.offsetParent;return t},a=function(e,t,n,i,r,o){if(!o)return null;var a=String.format("/Pages/Page[@id='{0}']/*{1}/descendant-or-self::P/T[@l<={2} and (@l + @w)>={3} and @t<={4} and (@t + @h)>={5}]",r,"[not(self::Header)][not(self::Footer)][not(self::Footnote)][not(self::EndNote)]",t,e,i,n);return o.selectNodes(a)},s=function(e,t){return t.val=parseFloat(i.u.parseXmlAttribute(e,"t")),!isNaN(t.val)}},,,function(e,t,n){var i=n(287),r=n(671);e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,n={};try{(e=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(n,[]),t=n instanceof Array}catch(e){}return function(n,o){return i(n),r(o),t?e.call(n,o):n.__proto__=o,n}}():void 0)},function(e,t,n){"use strict";n.d(t,{e:function(){return i}});var i=(0,n(208).y)("IGestureInputRegistrar")},,function(e,t,n){"use strict";n.d(t,{c:function(){return i}});var i=(0,n(208).y)("IBusinessBar")},function(e,t,n){"use strict";n.d(t,{v:function(){return a}});var i=n(134),r=n(946),o=n(208),a=function(){function e(t,n){this._key=null,this._element=null,this._elementId=null,this._key=t,this._elementId=n+e.keytipId}return e.prototype.get_key=function(){return this._key},e.prototype.get_element=function(){return this._element},e.prototype.get_elementId=function(){return this._elementId},e.prototype.createKeytipElement=function(){this._element=r.n.createElement("div"),this._element.className="cui-keytip",this._element.id=this._elementId;var e=r.n.createElement("span");return e.className="cui-keytip-span",e.innerText=this._key,this._element.appendChild(e),i.t.setAriaAttribute(this._element,i.t.ariaRoleAttribute,i.t.ariaPresentationRole),i.t.setAriaAttribute(this._element,i.t.ariaHiddenAttribute,i.t.ariaTrueValue),i.t.setAriaAttribute(e,i.t.ariaRoleAttribute,i.t.ariaPresentationRole),this.hide(),this._element},e.prototype.show=function(e){Sys.UI.DomElement.removeCssClass(this._element,"WACAltTextDescribedBy"),this._element.style.zIndex=String(e),this.setDisplay("block")},e.prototype.hide=function(){Sys.UI.DomElement.addCssClass(this._element,"WACAltTextDescribedBy"),this.setDisplay("none")},e.prototype.setDisplay=function(e){this._element&&(this._element.style.display=e)},e.ribbonShortcutId="RibbonShortcut",e.keytipId="-Keytip",e}();(0,o.l)(a,"Keytip",null,[])},function(e,t,n){"use strict";n.d(t,{y:function(){return s}});var i=n(254),r=n(402),o=n(484),a=n(208),s=function(){function e(){}return e.getLocalhostPath=function(t,n){return void 0===n&&(n=!0),String.format("{0}/{1}{2}",e.baseUrl,t,n?"/":"")},e.get_scriptPath=function(){return e.getLocalhostPath("webpack")},e.isFileSupportedForLocalhost=function(t,n){if(e.get_isAppChromeLocalhostScriptEnabled())for(var i=0,o=t;i<o.length;i++){var a=o[i];if(a.identifier===n||a.dependencies&&r.z(a.dependencies,n))return!0}return!1},e.getOverrideType=function(){switch(i.AFrameworkApplication.appSettingsManager.getStringAppSetting("AppChromeLocalOverride")||""){case"1":case"debug":return 1;case"2":case"ship":case"prod":case"production":return 2;default:return 0}},e.get_isAppChromeLocalhostScriptEnabled=function(){return!!e.getOverrideType()||!1},e.getLocalizationLocalhostPath=function(t){return e.getLocalhostPath(String.format("localization/{0}",o.i.getCultureInfo(t).get_name()))},e.baseUrl="http://localhost:5000",e}();(0,a.l)(s,"AppChromeLocalhostUtilities",null,[])},,,,,,function(e,t,n){"use strict";n.r(t),n.d(t,{oneNoteImageMapName:function(){return o},pptAttendeeImageMapName:function(){return a},pptEditorImageMapName:function(){return s},pptViewerImageMapName:function(){return l},wordEditorImageMapName:function(){return u},wordViewerImageMapName:function(){return c},createClusteredImage:function(){return p},createClusteredImageFromCluster:function(){return d},createClusteredImageFromClusterWithImageClass:function(){return h},getImageClass:function(){return _},getImageClassWithCluster:function(){return f},setImageTooltip:function(){return y}});var i=n(254),r=n(134),o="one",a="pat",s="per",l="prt",u="we",c="wv",p=function(e,t,n,r,o,a){return d(e,t,n,i.AFrameworkApplication.get_imageClusterName(),i.AFrameworkApplication.get_imageClusterPath(),r,null,o,a)},d=function(e,t,n,i,r,o,a,s,l,u){return void 0===u&&(u=null),h(e,t,f(i,n),r,o,a,s,l,u)},h=function(e,t,n,i,r,o,a,s,l,u){void 0===l&&(l=null),void 0===u&&(u=null);var c=g(l,"span"),p=String.format("clip{0}x{1}",e.toString(),t.toString());return c.className=r?r+" "+p:p,c.setAttribute("Unselectable","on"),c.style.zIndex="0",a&&(c.style.display="inline-block"),u||(u=m(n,i,r,o,s,l)),c.appendChild(u),c},g=function(e,t){return(e||window.document).createElement(t)},m=function(e,t,n,i,o,a){void 0===a&&(a=null);var s=g(a,"img");return s.className=i?i+" "+e:e,s.setAttribute("Unselectable","on"),s.setAttribute(r.t.ariaRoleAttribute,r.t.ariaPresentationRole),s.src=t,o&&(s.alt=o,s.title=o),s},_=function(e){return String.format("{0}_{1}",i.AFrameworkApplication.get_imageClusterName(),e)},f=function(e,t){return String.format("{0}_{1}",e,t)},y=function(e,t){var n=e.children[0];n.alt=t,n.title=t}},function(e){e.exports=function(e){if("function"!=typeof e)throw TypeError(String(e)+" is not a function");return e}},function(e,t,n){var i=n(777),r=n(548);e.exports=function(e){return i(r(e))}},,,function(e,t,n){"use strict";n.d(t,{q:function(){return r}});var i=n(208),r=function(){function e(t,n){this._valueCreator=null,i.m(this,e.$$(t)),this._value=null,this._valueCreator=n}return e.prototype.get_hasValue=function(){return!this._valueCreator},e.prototype.get_value=function(){return this.get_hasValue()||(this._value=this._valueCreator(),this._valueCreator=null),this._value},e.$$=function(t){var n="Lazy$1$"+t.getName(),r=i.x(n);return r||i.u(n,"$$sc.Lazy$1",e,[{T:t}],null,[])},e}()},function(e,t,n){"use strict";n.d(t,{m:function(){return a}});var i=n(644),r=n(372),o=n(208),a=function(){function e(){this._list=new i.c(r.k)}return e.prototype.add=function(e,t){var n;for(n=0;n<this._list.get_count();++n){if(this._list.get_item(n).get_priority()>e)break}this._list.insert(n,new r.k(e,t))},e.prototype.remove=function(e){for(var t=0;t<this._list.get_count();++t){if(this._list.get_item(t).get_data()===e)return void this._list.removeAt(t)}},e.prototype.get_length=function(){return this._list.get_count()},e.prototype.get_item=function(e){return this._list.get_item(e).get_data()},e}();(0,o.l)(a,"PriorityList",null,[])},function(e,t,n){"use strict";n.d(t,{s:function(){return o}});var i=n(218),r=n(311),o=function(){i.z.enqueueResourceWithoutEnabling(r.n.create("dll1",null,(function(){return n.e(1).then(n.bind(null,878))})))}},,,,function(e,t,n){"use strict";n.d(t,{a:function(){return i},r:function(){return r}});var i=2147483648,r=function(e){switch(e){case i:return"Frame";case 2147483649:return"Set";default:return null}}},function(e,t,n){var i=n(247);e.exports=function(e,t){if(!i(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!i(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!i(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}},,function(e,t,n){"use strict";var i=n(809),r=n(254),o=n(208),a=function(){return function(){this.command=null,this.label=null,this.image=null,this.id=null,this.keytip=null}}();(0,o.l)(a,"HeaderButtonInfo",null,[]);var s=n(204);n.d(t,{o:function(){return l},u:function(){return u},k:function(){return c},f:function(){return p},h:function(){return d},d:function(){return h},g:function(){return g}});var l=function(){return r.AFrameworkApplication.get_isEmbedded()},u=function(){return!l()&&!r.AFrameworkApplication.hideHeader&&s.c()},c=function(){return r.AFrameworkApplication.shouldShowSwitcher&&!l()&&!r.AFrameworkApplication.hideHeader},p=function(e){return e&&!!r.AFrameworkApplication.get_activeFrame()&&r.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedReactRibbonUxFlightEnabled()&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("OptOutSupportForSimplifiedRibbonIsEnabled")&&!r.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isSimplifiedUXOptOutInViewTabFlightEnabled()&&!r.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactMultilineRibbonEnabled()},d=function(){return!l()&&!r.AFrameworkApplication.hideHeader&&r.AFrameworkApplication.appSettingsManager.getBooleanAppSetting("BasicChatIsEnabled")},h=function(){return!!r.AFrameworkApplication.get_activeFrame()&&r.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderDelayLoadingEnabled()},g=function(){var e=r.AFrameworkApplication.isReplyWithChangesWorkFlow&&!!r.AFrameworkApplication.replyWithChangesUrl||r.AFrameworkApplication.useReplyWithChangesPostMessage,t=!!r.AFrameworkApplication.get_activeFrame()&&r.AFrameworkApplication.get_activeFrame().get_applicationInstance().get_isReactSharedHeaderUxEnabled();if(e&&t)return(0,i.m)(new a,{command:"1197060601",label:CommonUIStrings.l_ReplyWithChanges,id:n(547).CuiHelper.replyWithChangesButtonId});if(r.AFrameworkApplication.workflowEnabled){var o="";switch(r.AFrameworkApplication.workflowTypeString){case"Assign":o=CommonUIStrings.l_Assign;break;case"Submit":o=CommonUIStrings.l_Submit}if(""!==o)return(0,i.m)(new a,{command:"2988588587",label:o,id:"btnWorkflow"})}return null}},function(e,t,n){"use strict";n.d(t,{c:function(){return r}});var i=n(208),r=function(){function e(){}return e.sendTraceTagNoop=function(e,t,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r]},e.debugAssertTagNoop=function(e,t,n){void 0===n&&(n=null);for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r]},e.sendTraceTag=e.sendTraceTagNoop,e.debugAssertTag=e.debugAssertTagNoop,e}();(0,i.l)(r,"BULS",null,[])},,function(e,t,n){"use strict";n.d(t,{q:function(){return r}});var i=n(208),r=function(){function e(){}return e.initialize=function(t){e._rootElement=t,Sys.UI.DomElement.addCssClass(e._rootElement,"HtmlScratchPad"),e.setHasLayout(!1)},e.reset=function(){e._rootElement=null},e.getScratchPad=function(t){var n=e.utilElements[t];return n||(n=e._rootElement.ownerDocument.createElement("div"),e._rootElement.appendChild(n),e.utilElements[t]=n),n},e.releaseScratchPad=function(t){var n=e.utilElements[t];e._rootElement.removeChild(n),e.utilElements[t]=null},e.beginScratchPadUse=function(){e._beginCount++,1===e._beginCount&&e.setHasLayout(!0)},e.endScratchPadUse=function(){e._beginCount--,e._beginCount||e.setHasLayout(!1)},e.setHasLayout=function(t){t?Sys.UI.DomElement.removeCssClass(e._rootElement,"Hidden"):Sys.UI.DomElement.addCssClass(e._rootElement,"Hidden")},e.get_isInitialized=function(){return!!e._rootElement},e._rootElement=null,e.utilElements={},e._beginCount=0,e}();(0,i.l)(r,"HtmlScratchPadProvider",null,[])},function(e,t,n){"use strict";n.r(t),n.d(t,{GetRoamingLauncherRequest:function(){return a}});var i=n(508),r=n(280),o=n(208),a=function(e){function t(){return e.call(this)||this}return(0,i.t)(t,e),t.prototype.getPriority=function(){return 0},t.prototype.getClassId=function(){return 2},t}(r.n);(0,o.l)(a,"GetRoamingLauncherRequest",r.n,[])},,,,function(e,t,n){"use strict";var i=n(208),r=(0,i.y)("ICpuMeterProvider"),o=(0,i.y)("ICpuMeter"),a=n(235);n.d(t,{r:function(){return s}});var s=function(){function e(e){this._realCpuMeterGetter=null,this._realCpuMeter=null,this._realCpuMeterGetter=e}return e.prototype.get_realCpuMeter=function(){return!this._realCpuMeter&&this._realCpuMeterGetter()&&(this._realCpuMeter=this._realCpuMeterGetter().tryGetCpuMeter()),this._realCpuMeter},e.prototype.profileTopLevelTask=function(e,t,n,i){void 0===i&&(i=null),this.get_realCpuMeter()?this.get_realCpuMeter().profileTopLevelTask(e,t,n,i):e()},e.prototype.profileFunction=function(e,t){this.get_realCpuMeter()?this.get_realCpuMeter().profileFunction(e,t):e()},e.prototype.onTaskAdded=function(e){this.get_realCpuMeter()&&this.get_realCpuMeter().onTaskAdded(e)},e.prototype.onBeforeProcess=function(){this.get_realCpuMeter()&&this.get_realCpuMeter().onBeforeProcess()},e.prototype.onAfterProcess=function(){this.get_realCpuMeter()&&this.get_realCpuMeter().onAfterProcess()},e.prototype.markInterestingEvent=function(e){this.get_realCpuMeter()&&this.get_realCpuMeter().markInterestingEvent(e)},e.prototype.add_onCpuMeterFrameAvailable=function(e){},e.prototype.remove_onCpuMeterFrameAvailable=function(e){},e.prototype.run=function(){},e.prototype.markEventTraceFlag=function(e){this.get_realCpuMeter()&&this.get_realCpuMeter().markEventTraceFlag(e)},e.prototype.clearEventTraceFlag=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=0),this.get_realCpuMeter()&&this.get_realCpuMeter().clearEventTraceFlag(e,t)},e.prototype.addCpuMeterTaskEventWithFilter=function(e,t,n){this.get_realCpuMeter()&&this.get_realCpuMeter().addCpuMeterTaskEventWithFilter(e,t,n)},e.get_instance=function(){return e._instance||(e._instance=e.getInstance())},e.getInstance=function(){return new e((function(){return a.w.get_instance().tryResolve(r)}))},e._instance=null,e}();(0,i.l)(s,"CpuMeterProxy",null,[o])},function(e,t,n){"use strict";var i=n(508),r=n(208),o=n(550),a=n(644),s=n(255),l=function(){function e(e,t,n,i,r,o){this.message=null,this.source=null,this.line=0,this.column=0,this.stackReference=null,this.stack=null,this.message=e,this.source=t,this.line=n,this.column=i,this.stackReference=r,this.stack=o}return e.prototype.isSameError=function(e){return!!e&&this.message===e.message&&this.source===e.source&&this.line===e.line&&this.column===e.column&&this.stackReference===e.stackReference&&this.stack===e.stack},e.prototype.toString=function(){return String.format("Message: {0}",this.message)},e}();(0,r.l)(l,"PageErrorEvent",null,[]);var u=function(){return function(e,t,n){this.eventCode=0,this.userData=null,this.eventObject=null,this.eventCode=e,this.userData=t,this.eventObject=n}}();(0,r.l)(u,"PageEventArgs",null,[]);var c=function(){return function(e,t){this.handler=null,this.userData=null,this.handler=e,this.userData=t}}();(0,r.l)(c,"PageEventHandlerRecord",null,[]);var p=n(867),d=n(59),h=n(425);n.d(t,{h:function(){return g}});var g=function(e){function t(){var t=e.call(this)||this;return t._oldOnError=null,t._registered=!1,t.getOnBeforeNavigateWebkitString=null,t._handlers=[[],[],[],[]],t._iFrameRecs=[],t.registerDomEvents(),t}return(0,i.t)(t,e),t.prototype.dispose=function(){this.getOnBeforeNavigateWebkitString=null,this.unregisterDomEvents(),e.prototype.dispose.call(this)},t.prototype.registerDomEvents=function(){this._registered||(this._oldOnError=window.onerror,window.onerror=r.i(this,this.onError,"onError"),Sys.Application.add_unload(r.i(this,this.onNavigate,"onNavigate")),$addHandler(window,"beforeunload",this.getOnBeforeNavigateCallback()),$addHandler(window,"resize",r.i(this,this.onResize,"onResize")),h.y.get_isIPad()&&$addHandler(window,"pagehide",r.i(this,this.onPagehide,"onPagehide")),this._registered=!0)},t.prototype.registerIFrame=function(e){Array.add(this._iFrameRecs,e)},t.prototype.unregisterDomEvents=function(){if(this._registered){window.onerror=this._oldOnError;for(var e=0;e<this._iFrameRecs.length;e++){var t=this._iFrameRecs[e],n=this.getIFrameContentWindow(t.iFrame);n&&(n.onerror=t.oldOnError)}Array.clear(this._iFrameRecs),$removeHandler(window,"resize",r.i(this,this.onResize,"onResize")),$removeHandler(window,"beforeunload",this.getOnBeforeNavigateCallback()),Sys.Application.remove_unload(r.i(this,this.onNavigate,"onNavigate")),h.y.get_isIPad()&&$addHandler(window,"pagehide",r.i(this,this.onPagehide,"onPagehide")),this._registered=!1}},t.prototype.getIFrameContentWindow=function(e){var t=null;try{t=e.contentWindow}catch(e){}return t},t.prototype.getOnBeforeNavigateCallback=function(){var e;h.y.get_isWebKit()||h.y.get_isInternetExplorerEdge()?e=r.i(this,this.onBeforeNavigateWebkit,"onBeforeNavigateWebkit"):e=r.i(this,this.onBeforeNavigate,"onBeforeNavigate");return e},t.prototype.unregisterAllHandlers=function(e){for(var t=0;t<4;t++)Array.clear(this._handlers[t])},t.prototype.registerHandler=function(e,t,n){this._handlers[e]&&Array.add(this._handlers[e],new c(t,n))},t.prototype.unregisterHandler=function(e,t){var n=this._handlers[e];if(n)for(var i=0;i<n.length;++i){if(n[i].handler===t)return void Array.removeAt(n,i)}},t.prototype.onError=function(e,n,i,r,o){try{var a=null,u=null;if(o)a=o.stack;else try{var c=window.event.error;c&&(a=c.stack)}catch(e){s.ULS.sendTraceTag(21561472,201,15,"Unable to grab the global error.stack property from Window.Event. Exception Message = {0}.",e.message)}if(!a){t.logCrossDomainScripErrorIfNeeded(e,n,i,r);try{u=arguments.callee.caller.caller}catch(e){s.ULS.sendTraceTag(17662367,201,15,String.format("Exception thrown in PageManager.OnError. Message:{0}. callStack:{1}.",e.message,e.stack))}s.ULS.sendTraceTag(18104455,201,15,String.format("Stack from exception object is null. Exception object = {0}. StackReference = {1}",o,u))}u||a||s.ULS.sendTraceTag(18104456,201,15,"Stack and stackReference objects are null.");var p=new l(e,n,i,null!=r?r:0,u,a);if(this._handlers[3].length>0)return this.invokeHandlers(3,p),!0}catch(e){s.ULS.sendTraceTag(21283668,201,10,"There was an unhandled exception while handling the error. Exception Message = {0}.",e.message)}return!1},t.prototype.onBeforeNavigate=function(e){s.ULS.sendTraceTag(7161411,306,50,"OnBeforeNavigate fired"),this.invokeHandlers(1,e)},t.prototype.onBeforeNavigateWebkit=function(e){return this.onBeforeNavigate(e),this.getOnBeforeNavigateWebkitString?this.getOnBeforeNavigateWebkitString():null},t.prototype.onNavigate=function(e,t){s.ULS.sendTraceTag(7161412,306,50,"OnNavigate fired"),this.invokeHandlers(2,t)},t.prototype.onResize=function(e){window.setTimeout(r.i(this,this.runResizeHandlers,"runResizeHandlers"),0)},t.prototype.runResizeHandlers=function(){this.invokeHandlers(0,null)},t.prototype.onPagehide=function(e){s.ULS.sendTraceTag(7161413,306,50,"OnPagehide fired"),this.invokeHandlers(2,e)},t.prototype.invokeHandlers=function(e,t){for(var n=this._handlers[e],i=0,r=n.length;i<r;i++){var o=n[i];o.handler(new u(e,o.userData,t))}},t.logCrossDomainScripErrorIfNeeded=function(e,t,n,i){if(!n&&!i&&!t&&e.startsWith("Script error")){var r=document.getElementsByTagName("Script");if(r){for(var o=new a.c(String),l=0;l<r.length;l++){var u=r[l],c=u.getAttribute("src")?u.getAttribute("src").toString():"",h=u.getAttribute("crossorigin");d.r(c,"http",0)&&!h&&o.add(c)}o.get_count()>0&&s.ULS.sendTraceTag(21283667,201,10,String.format("The following javascript files do not have CORS set up correctly = {0}",p.w(o)))}}},t}(o.n);(0,r.l)(g,"PageManager",o.n,[])},,function(e,t,n){"use strict";n.d(t,{k:function(){return i}});var i=(0,n(208).y)("IEnumerable")}],__webpack_module_cache__={},hasOwnProperty;function __webpack_require__(e){if(__webpack_module_cache__[e])return __webpack_module_cache__[e].exports;var t=__webpack_module_cache__[e]={i:e,l:!1,exports:{}};return __webpack_modules__[e](t,t.exports,__webpack_require__),t.l=!0,t.exports}return __webpack_require__.m=__webpack_modules__,hasOwnProperty=Object.prototype.hasOwnProperty,__webpack_require__.d=function(e,t){for(var n in t)hasOwnProperty.call(t,n)&&!hasOwnProperty.call(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},__webpack_require__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),__webpack_require__.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return __webpack_require__.d(t,{a:t}),t},__webpack_require__.p="",__webpack_require__.f={},__webpack_require__.e=function(e){return Promise.all(Object.keys(__webpack_require__.f).reduce((function(t,n){return __webpack_require__.f[n](e,t),t}),[]))},__webpack_require__.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__webpack_require__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e){var i={};for(var r in e)i[r]=function(t){return e[t]}.bind(null,r);__webpack_require__.d(n,i)}return n},__webpack_require__.u=function(e){return"WordViewerDS.dll"+e+".js"},function(){var e={0:0};__webpack_require__.f.j=function(t,n){var i=Object.prototype.hasOwnProperty.call(e,t)?e[t]:void 0;if(0!==i)if(i)n.push(i[2]);else{var r=new Promise((function(n,r){i=e[t]=[n,r]}));n.push(i[2]=r);var o,a=__webpack_require__.p+__webpack_require__.u(t),s=document.createElement("script");s.charset="utf-8",s.timeout=120,__webpack_require__.nc&&s.setAttribute("nonce",__webpack_require__.nc),s.src=a,0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous");var l=new Error;o=function(n){s.onerror=s.onload=null,clearTimeout(u);var i=function(){if(Object.prototype.hasOwnProperty.call(e,t)&&e[t])return e[t][1];0!==e[t]&&(e[t]=void 0)}();if(i){var r=n&&("load"===n.type?"missing":n.type),o=n&&n.target&&n.target.src;l.message="Loading chunk "+t+" failed.\n("+r+": "+o+")",l.name="ChunkLoadError",l.type=r,l.request=o,i(l)}};var u=setTimeout((function(){o({type:"timeout",target:s})}),12e4);s.onerror=s.onload=o,document.head.appendChild(s)}};var t=window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[],n=t.push.bind(t);t.push=function(t){for(var n,r,o=t[0],a=t[1],s=t[3],l=0,u=[];l<o.length;l++)r=o[l],Object.prototype.hasOwnProperty.call(e,r)&&e[r]&&u.push(e[r][0]),e[r]=0;for(n in a)Object.prototype.hasOwnProperty.call(a,n)&&(__webpack_require__.m[n]=a[n]);for(s&&s(__webpack_require__),i&&i(t);u.length;)u.shift()()};var i=n}(),__webpack_require__(636),__webpack_require__(544),__webpack_require__(768),__webpack_require__(922)}());
//# sourceMappingURL=https://wordwebclientbuilds.blob.core.windows.net/official/16.0.12628.35950/WordViewerDS.js.map