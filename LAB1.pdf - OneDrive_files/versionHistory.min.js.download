var versionHistory=function(e){function t(t){for(var o,s,a=t[0],l=t[1],c=t[2],d=0,u=[];d<a.length;d++)s=a[d],n[s]&&u.push(n[s][0]),n[s]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(p&&p(t);u.length;)u.shift()();return i.push.apply(i,c||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],o=!0,a=1;a<r.length;a++){var l=r[a];0!==n[l]&&(o=!1)}o&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var o={},n={19:0},i=[];function s(t){if(o[t])return o[t].exports;var r=o[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.e=function(e){var t=[],r=n[e];if(0!==r)if(r)t.push(r[2]);else{var o=new Promise((function(t,o){r=n[e]=[t,o]}));t.push(r[2]=o);var i,a=document.createElement("script");a.charset="utf-8",a.timeout=120,s.nc&&a.setAttribute("nonce",s.nc),a.src=function(e){return s.p+""+({17:"uiFabricLazy"}[e]||e)+".min.js"}(e),0!==a.src.indexOf(window.location.origin+"/")&&(a.crossOrigin="anonymous"),i=function(t){a.onerror=a.onload=null,clearTimeout(l);var r=n[e];if(0!==r){if(r){var o=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src,s=new Error("Loading chunk "+e+" failed.\n("+o+": "+i+")");s.type=o,s.request=i,r[1](s)}n[e]=void 0}};var l=setTimeout((function(){i({type:"timeout",target:a})}),12e4);a.onerror=a.onload=i,document.head.appendChild(a)}return Promise.all(t)},s.m=e,s.c=o,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(r,o,function(t){return e[t]}.bind(null,o));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s.oe=function(e){throw console.error(e),e};var a=window.webpackJsonp_name_=window.webpackJsonp_name_||[],l=a.push.bind(a);a.push=t,a=a.slice();for(var c=0;c<a.length;c++)t(a[c]);var p=l;return i.push([1166,0,1]),r()}({1166:function(e,t,r){"use strict";r.r(t);var o=r(0),n=r(32),i=r(2),s=function(e,t,r,o){this.correlationId=e||"",this.errorType=t,this.status=r,this.statusText=o},a=function(){function e(e,t,r,o){this._theUri="",this._serviceBase="",this._docId="",this._retryCount=3,this._wdEnableDownloadTokens=!1,this._handlerName="versions.ashx",this._handlerQueryParam="DocID",this._userSessionId="",this._wacCluster="",this._latestStreamServiceBase="",this._useXhr=!1,this._serviceBase=e,this._docId=t,this._wdEnableDownloadTokens=!!r.wdEnableDownloadTokens&&r.wdEnableDownloadTokens,this._retryCount=r.retryCount?r.retryCount:3,this._userSessionId=r.userSessionId?r.userSessionId:"",this._wacCluster=r.wacCluster?r.wacCluster:"",this._latestStreamServiceBase=o||"",this._useXhr=!!r.useXhr&&r.useXhr,this.buildVersionHistoryRequestUri()}return e.prototype.versionInfoFromTipVersion=function(e){try{var t={};return t.DownloadUrl=e.data.downloadUrl,{correlationID:e.correlationID,data:t,isDirty:"true"===e.data.isDirty}}catch(e){i.c.sendTraceTag(595882753,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"Failed to convert tip version Latest response to version info object")}},e.prototype.requestTipVersion=function(){var e=this,t={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster}},r="&waccluster="+this._wacCluster;return this.fetchRetry(this._latestStreamServiceBase+r,t,this._retryCount).then((function(t){return e.versionInfoFromTipVersion(t)}))},e.prototype.requestVersionHistory=function(){var e={method:"GET",headers:{"Content-Type":"application/json; charset=utf-8","X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"}},t="&wdEnableDownloadTokens="+this._wdEnableDownloadTokens.toString();return this._useXhr?this.xhrRetry(e.method,this._theUri+t,e.headers,null,this._retryCount):this.fetchRetry(this._theUri+t,e,this._retryCount)},e.prototype.requestDownloadToken=function(e){var t={method:"POST",headers:{"Content-Type":"application/json; charset=utf-8","X-UserSessionId":this._userSessionId,"X-WacCluster":this._wacCluster,"X-WacNoAuth":"1"},body:JSON.stringify({RevisionIDs:e})},r="&action=GetDownloadToken&wdEnableDownloadTokens="+this._wdEnableDownloadTokens.toString();return this._useXhr?this.xhrRetry(t.method,this._theUri+r,t.headers,t.body,this._retryCount):this.fetchRetry(this._theUri+r,t,this._retryCount)},e.prototype.buildVersionHistoryRequestUri=function(){this._serviceBase.indexOf(this._handlerName)<0?this._theUri=this._serviceBase+this._handlerName+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId):this._theUri=this._serviceBase+"?"+this._handlerQueryParam+"="+encodeURIComponent(this._docId)},e.prototype.xhrRetry=function(e,t,r,n,s){return Object(o.__awaiter)(this,void 0,void 0,(function(){var a=this;return Object(o.__generator)(this,(function(l){return[2,this.xhr(e,t,r,n).then((function(e){return e})).catch((function(l){return Object(o.__awaiter)(a,void 0,void 0,(function(){return Object(o.__generator)(this,(function(o){return i.c.sendTraceTag(595886220,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"VersionHistoryRequestManager\n            Error: "+l.errorType+"\n            Status: "+l.status+"\n            StatusText: "+l.statusText+"\n            CorrelationId: "+l.correlationId),1===s?[2,Promise.resolve({errorCode:l.errorType,correlationId:l.correlationId})]:[2,this.xhrRetry(e,t,r,n,s-1)]}))}))}))]}))}))},e.prototype.xhr=function(e,t,r,o){var n=this;return new Promise((function(i,a){var l=new XMLHttpRequest;l.open(e,t,!0),l.onload=function(){if(200===this.status)try{var e=JSON.parse(l.response);i({errorCode:0,data:e,correlationId:this.getResponseHeader("X-CorrelationId")})}catch(e){a(new s(this.getResponseHeader("X-CorrelationId"),102,this.status,this.statusText))}else a(new s(this.getResponseHeader("X-CorrelationId"),100,this.status,this.statusText))},l.onerror=function(){a(new s(this.getResponseHeader("X-CorrelationId"),103,this.status,this.statusText))},n.addXhrHeaders(r,l),l.send(o)}))},e.prototype.addXhrHeaders=function(e,t){if(e)for(var r in e)e.hasOwnProperty(r)&&t.setRequestHeader(r,e[r])},e.prototype.fetchRetry=function(e,t,r){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n=this;return Object(o.__generator)(this,(function(a){switch(a.label){case 0:return[4,fetch(e,t).then((function(e){if(!e.ok)throw i.c.sendTraceTag(595899467,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"VersionHistoryRequestManager Status: "+e.status+", StatusText: "+e.statusText+", CorrelationId: "+e.headers.get("X-CorrelationId")),new s(e.headers.get("X-CorrelationId"),n.parseServerError(e),e.status,e.statusText);return e.json().then((function(t){return{correlationId:e.headers.get("X-CorrelationId"),data:t,errorCode:0}})).catch((function(){throw new s(e.headers.get("X-CorrelationId"),102,e.status,e.statusText)}))})).catch((function(a){return Object(o.__awaiter)(n,void 0,void 0,(function(){return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return i.c.sendTraceTag(595906848,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"VersionHistoryRequestManager Error: "+(a&&a.message?a.message:"NA")),1===r?(i.c.sendTraceTag(595632846,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"fetchRetry all retries failed. Error: "+(a&&a.message?a.message:"NA")),a instanceof s?[2,Promise.resolve({errorCode:a.errorType,correlationId:a.correlationId})]:[2,Promise.resolve({errorCode:103,correlationId:""})]):[4,this.fetchRetry(e,t,r-1)];case 1:return[2,o.sent()]}}))}))}))];case 1:return[2,a.sent()]}}))}))},e.prototype.parseServerError=function(e){var t;switch(e.headers.get("X-ErrorCode")){case"VersioningNotEnabled":t=104;break;case"FileNotFound":t=105;break;case"VersionTooOld":t=106;break;default:t=100}return t},e}(),l=["#0078d4","#4f6bed","#e3008c","#004e8c","#005b70","#750b1c","#0b6a0b","#8764b8","#a4262c","#038387","#c239b3","#d13438","#498205","#5c2e91","#ca5010","#986f0b","#881798","#8e562e"],c=function(){function e(){}return e.getInitialsColorFromName=function(e){if(!e)return this.getColorByIndex(0);for(var t=0;t<this.nameColorMap.length;t+=1){var r=this.nameColorMap[t];if(r.name===e)return this.getColorByIndex(r.colorIndex)}var o={name:e,colorIndex:this.getNextColorIndex()};return this.nameColorMap.push(o),this.getColorByIndex(o.colorIndex)},e.getNextColorIndex=function(){return this.currentColorIndex=(this.currentColorIndex+1)%l.length,this.currentColorIndex},e.getColorByIndex=function(e){return l[e%l.length]},e.currentColorIndex=0,e.nameColorMap=[],e}(),p=function(){function e(e,t,r,o,n,i,s,l,c,p){this.Versions=[],this._isDisposed=!1,this._versionHistoryRequestManager=c||new a(n,i,s,l),this._versionHistoryReadyEvent=e,this._perfTelemetryInfos=p,this._downloadTokenReadyEvent=t,this._fullAppErrorEvent=r,this._tipVersionTokenReadyEvent=o}return e.prototype.getTipVersion=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadTipVersionStart",TelemetryEventData:Date.now().toString()}),this._tipVersionResponse=null,[4,this._versionHistoryRequestManager.requestTipVersion()];case 1:return t=r.sent(),this._tipVersionResponse=t,null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadTipVersionEnd",TelemetryEventData:Date.now().toString()}),t&&t.data&&t.data.DownloadUrl?(this.Versions&&this.Versions.length>0&&!this.Versions[0].DownloadUrl&&!t.isDirty?(i.c.sendTraceTag(595882755,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Storing First Version Download Url, sending TipVersionTokenReadyEvent"),e.updateVersionInfo(this.Versions[0],t.data)):i.c.sendTraceTag(595882756,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"No Versions list, sending TipVersionTokenReadyEvent"),this.fireTipVersionTokenReadyEvent(t.data,t.correlationID),[2,!0]):(i.c.sendTraceTag(595882754,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getTipVersion failed"),[2,!1])}}))}))},e.prototype.getVersions=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){var t;return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadVersionListStart",TelemetryEventData:Date.now().toString()}),[4,this._versionHistoryRequestManager.requestVersionHistory()];case 1:return t=r.sent(),null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"LoadVersionListEnd",TelemetryEventData:Date.now().toString()}),t?t.data?t.data.Versions?t.data.Versions[0]?this._isDisposed?[2,!1]:(this.Versions=t.data.Versions?t.data.Versions.filter((function(e){return e.Time=new Date(e.Time.toString())})):[],this.Versions.sort((function(e,t){return e&&t&&e.Time&&t.Time?t.Time.getTime()-e.Time.getTime():0})),this.Versions.forEach((function(t){return e.updateAuthorColorInfo(t)})),this.Versions.length>0&&(this.Versions[0].RevisionID&&!this.Versions[0].DownloadUrl&&this._tipVersionResponse&&this._tipVersionResponse.data.DownloadUrl&&!this._tipVersionResponse.isDirty&&(i.c.sendTraceTag(595882271,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Using stored tip version as first version downloadurl"),this.Versions[0].DownloadUrl=this._tipVersionResponse.data.DownloadUrl,this.Versions[0].WopiInfo=this._tipVersionResponse.data.WopiInfo),this.fireVersionsReadyEvent(this.Versions,t.correlationID)),[2,!0]):(i.c.sendTraceTag(595682910,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getVersions failed: !response.data.Versions[0]"),this.fireFullAppErrorEventWithDefaultCode(t.errorCode),[2,!1]):(i.c.sendTraceTag(595682909,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getVersions failed: !response.data.Versions"),this.fireFullAppErrorEventWithDefaultCode(t.errorCode),[2,!1]):(i.c.sendTraceTag(595682908,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getVersions failed: !response.data"),this.fireFullAppErrorEventWithDefaultCode(t.errorCode),[2,!1]):(i.c.sendTraceTag(595682907,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getVersions failed: !response"),this.fireFullAppErrorEvent(100),[2,!1])}}))}))},e.prototype.getDownloadToken=function(t,r){return Object(o.__awaiter)(this,void 0,void 0,(function(){var n,s=this;return Object(o.__generator)(this,(function(o){switch(o.label){case 0:return null!=this._perfTelemetryInfos&&t.length>0&&this._perfTelemetryInfos.push({TelemetryEventKey:"GetDownloadTokenStart",TelemetryEventData:Date.now().toString()}),[4,this._versionHistoryRequestManager.requestDownloadToken(t)];case 1:return n=o.sent(),null!=this._perfTelemetryInfos&&t.length>0&&this._perfTelemetryInfos.push({TelemetryEventKey:"GetDownloadTokenEnd",TelemetryEventData:Date.now().toString()}),n&&n.data&&n.data.Versions&&n.data.Versions[0]?(r&&(r.correlationID=n.correlationID),this._isDisposed?[2,!1]:(n.data.Versions.forEach((function(t){if(t&&t.DownloadUrl){var o=s.Versions.filter((function(e){return e.RevisionID===t.RevisionID}));o[0].DownloadUrl=t.DownloadUrl,null!==t.WopiInfo&&(o[0].WopiInfo=t.WopiInfo),r&&(r.baseVersion&&r.baseVersion.RevisionID===t.RevisionID?e.updateVersionInfo(r.baseVersion,t):r.currentVersion&&r.currentVersion.RevisionID===t.RevisionID&&e.updateVersionInfo(r.currentVersion,t))}})),this.fireDownloadTokenReadyEvent(this.Versions,r),[2,!0])):(i.c.sendTraceTag(595907533,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"getDownloadToken failed"),n&&n.errorCode?this.fireFullAppErrorEvent(n.errorCode):this.fireFullAppErrorEvent(101),[2,!1])}}))}))},e.prototype.dispose=function(){this._isDisposed=!0,this.Versions=[]},e.prototype.fireTipVersionTokenReadyEvent=function(e,t){if(!this._isDisposed){var r={tipVersion:e,updatedVersions:this.Versions,containerDiv:document.getElementById("vhViewer"),correlationID:t};i.c.sendTraceTag(595882757,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"fireTipVersionTokenReadyEvent"),this._tipVersionTokenReadyEvent.fireEvent(r)}},e.prototype.fireVersionsReadyEvent=function(e,t){if(!this._isDisposed){var r={versions:e,containerDiv:document.getElementById("vhViewer"),correlationID:t};i.c.sendTraceTag(595914892,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"fireVersionsReadyEvent"),this._versionHistoryReadyEvent.fireEvent(r)}},e.prototype.fireDownloadTokenReadyEvent=function(e,t){if(!this._isDisposed){var r={updatedVersions:e,versionSelected:t};i.c.sendTraceTag(595907532,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"fireDownloadTokenReadyEvent"),this._downloadTokenReadyEvent.fireEvent(r)}},e.prototype.fireFullAppErrorEventWithDefaultCode=function(e){e?this.fireFullAppErrorEvent(e):this.fireFullAppErrorEvent(100)},e.prototype.fireFullAppErrorEvent=function(e){this._isDisposed||(i.c.sendTraceTag(595906849,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"fireFullAppErrorEvent, error code: "+e),this._fullAppErrorEvent.fireEvent(e))},e.updateVersionInfo=function(e,t){null!=e?null!=t?(e.DownloadUrl=t.DownloadUrl,e.WopiInfo=t.WopiInfo):i.c.sendTraceTag(595858567,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"updateVersionInfo, currentVersionInfo is null"):i.c.sendTraceTag(595858566,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"currentVersionInfo, currentVersionInfo is null")},e.updateAuthorColorInfo=function(e){e.Authors&&e.Authors.forEach((function(e){e&&(e.InitialsColor=c.getInitialsColorFromName(e.UserName))}))},e}(),d=function(){function e(){this._listeners=[]}return e.prototype.fireEvent=function(e){this._listeners.forEach((function(t){return t(e)}))},e.prototype.addListener=function(e){e&&this._listeners.push(e)},e.prototype.removeListener=function(e){this._listeners=this._listeners.filter((function(t){return t!==e}))},e}(),u=r(1),h=r(92),g=r(11),m=r(5),f=Object(g.c)((function(e){return void 0===e&&(e=!1),{root:Object(m.bb)({display:"flex",flexFlow:"row",width:"100%",height:"100%",direction:e?"rtl":"ltr"}),hidden:Object(m.bb)({display:"none"}),fullAppErrorDiv:Object(m.bb)({display:"flex",flexFlow:"column",width:"100%",height:"100%"})}})),b=r(29),v=r(769),y=r(178),_=Object(g.c)((function(e,t,r){return void 0===e&&(e="#B7472A"),void 0===t&&(t=!1),{root:Object(m.bb)({display:"flex",flexFlow:"column",flexBasis:"22%",flexGrow:1,flexShrink:1.5,maxWidth:r?"338px":"300px",minWidth:r?"338px":"220px",height:"calc(100% - 2px)",border:"1px solid #DEDEDE",backgroundColor:r?"white":"#EDEBE9"}),scrollRegion:Object(m.bb)({flexFlow:"column",overflowY:"auto",overflowX:"hidden",marginBottom:"40px",marginLeft:r?"12px":"",marginRight:r?"12px":"",marginTop:r?"20px":""}),loadingDiv:Object(m.bb)({display:"flex",flexGrow:1,justifyContent:"center",alignItems:"center"}),loadingSpinner:Object(m.bb)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:e}}}),paneHeader:Object(m.bb)({width:r?"":"98px",color:"#505050",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:r?"15px":"14px",fontWeight:600,lineHeight:r?"17px":"19px",marginLeft:"11px",marginTop:r?"14px":"16px",marginBottom:"10px"}),showChangesDiv:Object(m.bb)({display:t?"flex":"none",height:t?"15px":"0px",fontFamily:r?'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif':"inherit",fontSize:r?"12px":"inherit",fontWeight:r?600:"inherit",marginTop:r?"4px":"inherit"}),hidden:Object(m.bb)({display:"none"})}})),C={overflowWrap:"break-word",wordWrap:"break-word",wordBreak:"break-word",hyphens:"auto"},S=Object(g.c)((function(e,t){var r,o,n,i,s,a,l;return{root:Object(m.bb)({backgroundColor:t?e?"#EDEBE9":"white":e?"#A6A6A6":"#FFFFFF",marginLeft:t?"8px":"9px",marginTop:t?"4px":"",marginBottom:t?"4px":"",marginRight:t?"8px":"12px",paddingBottom:t?"5px":"",display:"flex",flexFlow:"row",outline:"none",selectors:(r={},r[m.k]={backgroundColor:e?"Highlight":"Window",color:e?"HighlightText":"WindowText"},r[":focus"]={backgroundColor:t?e?"#EDEBE9":"#FAF9F8":e?"#A6A6A6":"#f8f8f8",selectors:(o={},o[m.k]={backgroundColor:"Highlight",color:"HighlightText"},o)},r[":hover"]={backgroundColor:t?"#FAF9F8":"#f8f8f8",selectors:(n={},n[m.k]={backgroundColor:"Highlight",color:"HighlightText"},n)},r)},C),body:Object(m.bb)({display:"flex",flexFlow:"column",cursor:"pointer",selectors:(i={},i[m.k]={MsHighContrastAdjust:"none",color:"inherit"},i)}),author:Object(m.bb)({display:"inline-block",marginBottom:"8px"}),authorBold:Object(m.bb)({display:"inline-block",fontWeight:t?"inherit":"bold",marginTop:t?"":"8px"}),authorDiv:Object(m.bb)({display:"flex",flexFlow:"row",marginLeft:"16px",marginTop:"4px"}),miniAuthorDiv:Object(m.bb)({display:"flex",flexFlow:"row",marginLeft:"30px",marginTop:"4px"}),authorName:Object(m.bb)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"11px",marginLeft:"6px",selectors:(s={},s[m.k]={MsHighContrastAdjust:"none",color:"inherit"},s)}),timestamp:Object(m.bb)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontWeight:e?"600":"normal",fontSize:"13px",lineHeight:"17px",marginLeft:"16px",marginTop:"8px",selectors:(a={},a[m.k]={MsHighContrastAdjust:"none",color:"inherit"},a)}),timestampSubtle:Object(m.bb)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontWeight:e?"600":"normal",fontSize:"11px",marginTop:t?"5px":"",marginLeft:"42px",selectors:(l={},l[m.k]={MsHighContrastAdjust:"none",color:"inherit"},l)})}})),E=r(478),T=function(){function e(){}return Object.defineProperty(e,"UILocale",{get:function(){return null!=this.uiLocale&&""!==this.uiLocale?this.uiLocale:"en-us"},set:function(e){this.uiLocale=e},enumerable:!0,configurable:!0}),e.uiLocale="",e}();function V(e,t,r,o){void 0===o&&(o=!1);var n=t||new Date,s=(n.getTime()-e.getTime())/1e3,a=Math.floor((n.getTime()-6e4*n.getTimezoneOffset())/864e5),l=Math.floor((e.getTime()-6e4*e.getTimezoneOffset())/864e5),c=n.getTime()-(36e5*n.getHours()+6e4*n.getMinutes()+1e3*n.getSeconds())-(n.getDay()+6)%7*864e5,p=c-6048e5,d=p-6048e5,u=d-6048e5,h=E.namespace();if(h.setup({locale:D(),missingTranslation:"ignore"}),null!=r){if(e<=n){if(s<120)return{friendlyDateString:r.JustNow,friendlyGroupString:r.TodayVersionsLabel};if(s<3600){var g=Math.floor(s/60);return isNaN(g)?(i.c.sendTraceTag(594883874,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"Minutes ago is NaN, input date was: "+e.toUTCString()),{friendlyDateString:I(e),friendlyGroupString:r.TodayVersionsLabel}):{friendlyDateString:h(r.MinutesAgo,{mins:g}),friendlyGroupString:r.TodayVersionsLabel}}if(l===a){var m=Math.floor(s/3600);return isNaN(m)?(i.c.sendTraceTag(594883875,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"Hours ago is NaN, input date was: "+e.toUTCString()),{friendlyDateString:I(e),friendlyGroupString:r.TodayVersionsLabel}):{friendlyDateString:h(r.HoursAgo,{hours:m}),friendlyGroupString:r.TodayVersionsLabel}}if(l===a-1)return{friendlyDateString:o?r.YesterdayWithTime.replace("{0}",I(e)):r.YesterdayAt.replace("{0}",I(e)),friendlyGroupString:r.YesterdayVersionsLabel};if(e.getTime()>=c){if(o){var f=Intl.DateTimeFormat(D(),{weekday:"long"}).format(e);return{friendlyDateString:r.DateTimeComboNoAt.replace("{0}",f).replace("{1}",I(e)),friendlyGroupString:f}}return{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(D(),{weekday:"long"}).format(e)).replace("{1}",I(e)),friendlyGroupString:r.ThisWeekVersionsLabel}}if(e.getTime()>=p)return o?w(e,r):{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(D(),{month:"long",day:"numeric"}).format(e)).replace("{1}",I(e)),friendlyGroupString:r.LastWeekVersionsLabel};if(e.getTime()>=d&&e.getMonth()===n.getMonth())return o?w(e,r):{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(D(),{month:"long",day:"numeric"}).format(e)).replace("{1}",I(e)),friendlyGroupString:r.TwoWeekVersionsLabel};if(e.getTime()>=u&&e.getMonth()===n.getMonth())return o?w(e,r):{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(D(),{month:"long",day:"numeric"}).format(e)).replace("{1}",I(e)),friendlyGroupString:r.ThreeWeekVersionsLabel};if(function(e,t){return e.getMonth()===t.getMonth()&&e.getFullYear()===t.getFullYear()}(e,n))return o?w(e,r):{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(D(),{month:"long",day:"numeric"}).format(e)).replace("{1}",I(e)),friendlyGroupString:r.ThisMonthVersionsLabel};if(function(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()-1}(e,n))return o?w(e,r):{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(D(),{month:"long",day:"numeric"}).format(e)).replace("{1}",I(e)),friendlyGroupString:r.LastMonthVersionsLabel};if(e.getFullYear()===n.getFullYear())return o?w(e,r):{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(D(),{month:"long",day:"numeric"}).format(e)).replace("{1}",I(e)),friendlyGroupString:Intl.DateTimeFormat(D(),{month:"long"}).format(e)};if(o){var b=Intl.DateTimeFormat(D(),{month:"long",day:"numeric",year:"numeric"}).format(e);return{friendlyDateString:r.DateTimeComboNoAt.replace("{0}",b).replace("{1}",I(e)),friendlyGroupString:b}}return{friendlyDateString:r.DateTimeCombo.replace("{0}",Intl.DateTimeFormat(D(),{month:"long",day:"numeric",year:"numeric"}).format(e)).replace("{1}",I(e)),friendlyGroupString:Intl.DateTimeFormat(D(),{year:"numeric",month:"long"}).format(e)}}return i.c.sendTraceTag(595682911,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"Version date time > now: "+e.toUTCString()+" > "+n.toUTCString()),{friendlyDateString:r.JustNow,friendlyGroupString:r.TodayVersionsLabel}}return i.c.sendTraceTag(595682912,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"localizedStrings is null. Version date: "+e.toUTCString()+", Now: "+n.toUTCString()),{friendlyDateString:Intl.DateTimeFormat(D(),{month:"long",day:"numeric",year:"numeric"}).format(e>n?n:e),friendlyGroupString:o?Intl.DateTimeFormat(D(),{month:"long",day:"numeric",year:"numeric"}).format(e>n?n:e):Intl.DateTimeFormat(D(),{year:"numeric",month:"long"}).format(e>n?n:e)}}function w(e,t){var r=Intl.DateTimeFormat(D(),{month:"long",day:"numeric"}).format(e);return{friendlyDateString:t.DateTimeComboNoAt.replace("{0}",r).replace("{1}",I(e)),friendlyGroupString:r}}function I(e){return Intl.DateTimeFormat(D(),{hour:"numeric",minute:"numeric"}).format(e)}function D(){return T.UILocale}var x=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.componentDidMount=function(){A.register(this)},t.prototype.componentWillUnmount=function(){A.unregister(this)},t.prototype.render=function(){return V(this.props.date,void 0,this.props.localizedStrings,this.props.isGroupUISupported).friendlyDateString},t}(u.PureComponent),A=new(function(){function e(){this.components=[]}return e.prototype.register=function(e){var t=this;this.components.push(e),void 0===this.timerId&&(this.timerId=window.setInterval((function(){return t.onTimerFired()}),6e4))},e.prototype.unregister=function(e){this.components=this.components.filter((function(t){return t!==e})),this.components.length||window.clearInterval(this.timerId)},e.prototype.onTimerFired=function(){this.components.forEach((function(e){return e.forceUpdate()}))},e}()),H=r(152),k=r(79),R=Object(g.c)((function(){var e;return{authorDiv:Object(m.bb)({display:"flex",flexFlow:"row",marginLeft:"16px",marginTop:"4px"}),authorName:Object(m.bb)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"11px",marginLeft:"6px",selectors:(e={},e[m.k]={MsHighContrastAdjust:"none",color:"inherit"},e)})}})),F=Object(g.c)((function(e){var t;return{authorRole:Object(m.bb)({fontWeight:"normal",fontSize:"12px",color:"#252423"}),authorName:Object(m.bb)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",fontWeight:600,selectors:(t={},t[m.k]={MsHighContrastAdjust:"none",color:"inherit"},t)}),colorBlock:Object(m.bb)({backgroundColor:e,width:"8px",height:"8px",marginLeft:"2px",marginRight:"4px",display:"inline-block"})}})),B=r(770),O=r(20),N=r(1334);function j(e,t){return e.EmailAddress===t.EmailAddress&&e.LogOnName===t.LogOnName&&e.UserName===t.UserName}function L(e){switch(e){case 2:return 4;case 3:return 2}return 0}function W(e,t){return t||e.GuestUserDisplayName}function U(e,t){return t||c.getInitialsColorFromName(e)}var z=u.memo((function(e){var t=R(),r=W(e.localizedStrings,e.name),o=U(r,e.color);return u.createElement("div",{key:e.key,className:t.authorDiv},u.createElement(B.a,{size:O.c.size16,coinSize:20,text:r,initialsColor:o,hidePersonaDetails:!0}),u.createElement("div",{className:t.authorName},r))})),P=u.memo((function(e){var t=W(e.localizedStrings,e.name),r=U(t,e.color),o=F(r),n=e.role?e.role:e.actionType?function(e,t){switch(e){case 1:return t.UserAction;case 4:return t.UserRenameAction;case 2:return t.UserRestoreAction}}(e.actionType,e.localizedStrings):void 0;if(n){var i=Object(N.a)(e.localizedStrings.UserActionComboString,(function(e){return"0"===e?u.createElement("span",{className:o.authorName},u.createElement("span",{className:o.colorBlock,"data-is-focusable":!1}),t):"1"===e?u.createElement("span",{className:o.authorRole},n):""}));return u.createElement("span",null,i)}var s=e.actionType?function(e,t){switch(e){case 5:return t.UserModifyRenameActions;case 6:case 7:return t.UserRestoreRenameActions}}(e.actionType,e.localizedStrings):void 0;if(s){i=Object(N.a)(s,(function(e){return"0"===e?u.createElement("span",{className:o.authorName},u.createElement("span",{className:o.colorBlock,"data-is-focusable":!1}),t):""}));return u.createElement("span",null,i)}return u.createElement("span",{className:o.authorName},u.createElement("span",{className:o.colorBlock}),t)})),G=function(e){function t(t){var r=e.call(this,t)||this;return r._root=u.createRef(),r._rootHTMLElement=null,r.onFocus=function(){r._root.current&&(r._root.current.tabIndex=-1,r._root.current.focus(),r._rootHTMLElement||(r._rootHTMLElement=document.getElementById(r._root.current.id)),r._rootHTMLElement&&Object(H.b)(!0,r._rootHTMLElement))},r.onClick=function(){var e={currentVersion:r.props.currentVersion,baseVersion:r.props.baseVersion,noBaseToCompareTo:!r.props.baseVersion};r.props.onVersionSelectedAction(e),i.c.sendTraceTag(595632832,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"User manually selected a version")},r.stopPropagation=function(e){e.stopPropagation()},r.onKeyDownInCard=function(e){(e.which===b.a.left&&!Object(k.a)()||e.which===b.a.right&&Object(k.a)())&&r.props.onLeftButton&&r.props.onLeftButton()},r}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this;if(this.props.appSettings.wdEnableShowVersionEvents&&this.props.appSettings.wdEnableCompareVersionsByGroup)return this.renderWithEvents();var t=this.props,r=t.currentVersion,o=t.isSelected,n=t.ariaPosinset,s=t.ariaSetsize,a=S(o,this.props.appSettings.wdEnableCompareVersionsByGroup);if(!r.Time)return i.c.sendTraceTag(595933193,i.a.msoulscat_Wac_VersionHistory,i.b.Warning,JSON.stringify({msg:"Version missing timestamp or author",id:r.RevisionID})),!1;var l=[];r.Authors&&r.Authors.length>0?r.Authors.forEach((function(t){if(t){var o=r.RevisionID+"_"+Object(h.a)();e.props.appSettings.wdEnableCompareVersionsByGroup?l.push(u.createElement("div",{className:a.miniAuthorDiv},u.createElement(P,{key:o,name:t.UserName,color:t.InitialsColor,role:e.props.localizedStrings.UserAction,localizedStrings:e.props.localizedStrings}))):l.push(u.createElement(z,{key:o,name:t.UserName,color:t.InitialsColor,localizedStrings:e.props.localizedStrings}))}})):this.props.appSettings.wdEnableCompareVersionsByGroup?l.push(u.createElement("div",{className:a.miniAuthorDiv},u.createElement(P,{key:r.RevisionID,name:r.AuthorID,role:this.props.localizedStrings.UserAction,localizedStrings:this.props.localizedStrings}))):l.push(u.createElement(z,{key:r.RevisionID,name:r.AuthorID,localizedStrings:this.props.localizedStrings}));var c=u.createElement(x,{date:r.Time,localizedStrings:this.props.localizedStrings,isGroupUISupported:this.props.appSettings.wdEnableCompareVersionsByGroup});return this.props.appSettings.wdEnableCompareVersionsByGroup?u.createElement("div",{ref:this._root,id:"vhCard"+this.props.currentVersion.RevisionID,onClick:this.onClick,className:a.root,"data-is-focusable":!0,"data-automation-id":this.props.currentVersion.RevisionID,"data-unique-id":this.props.currentVersion.RevisionID,"aria-selected":o,role:"treeitem","aria-posinset":n,"aria-setsize":s,onKeyDown:this.onKeyDownInCard},u.createElement("div",{className:a.body},u.createElement("div",{className:a.authorBold},l),u.createElement("div",{className:a.timestampSubtle},c))):u.createElement("div",{ref:this._root,onClick:this.onClick,onFocus:this.onClick,className:a.root,"data-is-focusable":!0,"data-automation-id":this.props.currentVersion.RevisionID,"data-unique-id":this.props.currentVersion.RevisionID,"aria-selected":o,role:"listitem","aria-posinset":n,"aria-setsize":s},u.createElement("div",{className:a.body,onClick:this.stopPropagation},u.createElement("div",{className:a.timestamp},c),u.createElement("div",{className:a.author},l)))},t.prototype.renderWithEvents=function(){var e,t,r=this,o=this.props,n=o.currentVersion,s=o.isSelected,a=o.ariaPosinset,l=o.ariaSetsize,c=S(s,!0),p=[],d=(t=[],(e=n).Authors&&e.Authors.length>0?e.Authors.forEach((function(e){e&&t.push({type:1,author:e})})):t.push({type:1,author:{UserName:e.AuthorID}}),e.Events&&e.Events.forEach((function(e){if(e&&e.Author){for(var r=!1,o=0,n=t;o<n.length;o++){var i=n[o];j(i.author,e.Author)&&(r=!0,i.type|=L(e.Type))}r||t.push({author:e.Author,type:L(e.Type)})}})),{time:e.Time,events:t});if(!d.time)return i.c.sendTraceTag(594367690,i.a.msoulscat_Wac_VersionHistory,i.b.Warning,JSON.stringify({msg:"Version missing timestamp or author",id:n.RevisionID})),!1;d.events.forEach((function(e){if(e){var t=n.RevisionID+"_"+Object(h.a)();p.push(u.createElement("div",{className:c.miniAuthorDiv},u.createElement(P,{key:t,name:e.author.UserName,color:e.author.InitialsColor,actionType:e.type,localizedStrings:r.props.localizedStrings})))}}));var g=u.createElement(x,{date:d.time,localizedStrings:this.props.localizedStrings,isGroupUISupported:this.props.appSettings.wdEnableCompareVersionsByGroup});return u.createElement("div",{ref:this._root,id:"vhCard"+this.props.currentVersion.RevisionID,onClick:this.onClick,className:c.root,"data-is-focusable":!0,"data-automation-id":this.props.currentVersion.RevisionID,"data-unique-id":this.props.currentVersion.RevisionID,"aria-selected":s,role:"treeitem","aria-posinset":a,"aria-setsize":l,onKeyDown:this.onKeyDownInCard},u.createElement("div",{className:c.body,onClick:this.stopPropagation},u.createElement("div",{className:c.authorBold},p),u.createElement("div",{className:c.timestampSubtle},g)))},t}(u.Component),M=r(1234),K=Object(g.c)((function(e){return void 0===e&&(e="#B7472A"),{sectionName:Object(m.bb)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginLeft:"16px",marginTop:"12px",marginBottom:"4px"}),versionCount:Object(m.bb)({color:e,fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",fontWeight:"normal",lineHeight:"16px",marginTop:"12px",marginBottom:"4px",marginLeft:"auto",display:"none"}),sectionHeader:Object(m.bb)({display:"flex",fontWeight:600,selectors:{":focus":{fontWeight:"bold"}}}),expand:Object(m.bb)({height:"16px",width:"16px",color:"#303030",lineHeight:"16px",marginLeft:"auto",marginRight:"16px",marginTop:"16px",marginBottom:"4px",display:"inline-block",cursor:"pointer"}),collapse:Object(m.bb)({height:"16px",width:"16px",color:"#303030",lineHeight:"16px",marginLeft:"5px",marginRight:"16px",marginTop:"11px",marginBottom:"4px",display:"none",cursor:"pointer"})}})),X=r(167),q=r(179),J=r.n(q),Y=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._list=u.createRef(),t._id=Object(h.a)(),t._header=u.createRef(),t.getListItemKey=function(e,t){return e.RevisionID||""},t.getBaseVersion=function(e,t,r){var o=null;return t.forEach((function(n,i){n===e&&(i!==t.length-1?o=t[i+1]:i===t.length-1&&(o=r))})),o},t.onShouldVirtualize=function(){return!0},t._commonCardProps={localizedStrings:t.props.localizedStrings,onVersionSelectedAction:t.props.onVersionSelectedAction},t.onRenderListItem=function(e,r){if(void 0!==e)return u.createElement("div",null,u.createElement(G,Object(o.__assign)({currentVersion:e,baseVersion:t.getBaseVersion(e,t.props.versions,t.props.finalBaseVersion),isSelected:t.props.selectedVersionId===e.RevisionID,ariaPosinset:void 0!==r?r+1:0,ariaSetsize:t.props.versions.length,appSettings:t.props.appSettings,onLeftButton:void 0},t._commonCardProps)))},t.onSectionIconClick=function(){t.isListVisible()?t.collapseSubsection():t.expandSubsection()},t.isListVisible=function(){var e=document.getElementById(t._id);return null!=e&&e.offsetWidth>0&&e.offsetHeight>0},t.onKeyDownInSectionHeader=function(e){(e.which===b.a.left&&!Object(k.a)()||e.which===b.a.right&&Object(k.a)())&&t.collapseSubsection(),(e.which===b.a.right&&!Object(k.a)()||e.which===b.a.left&&Object(k.a)())&&t.expandSubsection()},t.showElement=function(e){e&&(e.style.display="block")},t.hideElement=function(e){e&&(e.style.display="none")},t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props.appSettings.appColor?this.props.appSettings.appColor:"#B7472A",t=K(e),r=this.props.versions,o=this.props.label+": "+this.versionCountString(r.length);return u.createElement(u.Fragment,null,r.length>0&&u.createElement("div",null,u.createElement("div",{className:t.sectionHeader,"data-is-focusable":!0,onKeyDown:this.onKeyDownInSectionHeader,"aria-label":o,role:"treeitem","aria-expanded":"true",ref:this._header},u.createElement("div",{className:t.sectionName},this.props.label),u.createElement("div",{className:t.versionCount,id:this._id+"verCount"},this.versionCountString(r.length)),u.createElement(X.a,{id:this._id+"IconExpand",className:t.expand,iconName:J.a.DownChevronMedium_20,onClick:this.onSectionIconClick}),u.createElement(X.a,{id:this._id+"IconCollapse",className:t.collapse,iconName:J.a.UpChevronMedium_20,onClick:this.onSectionIconClick})),u.createElement(M.a,{id:this._id,ref:this._list,items:r,onRenderCell:this.onRenderListItem,onShouldVirtualize:this.onShouldVirtualize,getKey:this.getListItemKey,role:"list","aria-label":this.props.label})))},t.prototype.UNSAFE_componentWillUpdate=function(e,t,r){return this._list.current&&this._list.current.forceUpdate(),null},t.prototype.componentDidUpdate=function(){},t.prototype.expandSubsection=function(){this.showElement(document.getElementById(this._id)),this.hideElement(document.getElementById(this._id+"IconCollapse")),this.showElement(document.getElementById(this._id+"IconExpand")),this.hideElement(document.getElementById(this._id+"verCount"));var e=this._header.current;e&&e.setAttribute("aria-expanded","true")},t.prototype.collapseSubsection=function(){this.hideElement(document.getElementById(this._id)),this.showElement(document.getElementById(this._id+"IconCollapse")),this.hideElement(document.getElementById(this._id+"IconExpand")),this.showElement(document.getElementById(this._id+"verCount"));var e=this._header.current;e&&e.setAttribute("aria-expanded","false")},t.prototype.versionCountString=function(e){return 1===e?this.props.localizedStrings.SingleVersionText:e>1?this.props.localizedStrings.MultiVersionsText.replace("{0}",e.toString()):""},t}(u.PureComponent),Z=Object(g.c)((function(e){var t,r,n,i,s,a,l={height:"16px",width:"16px",color:"#303030",lineHeight:"16px",marginLeft:"2px",marginRight:"4px",verticalAlign:"center",display:"none",cursor:"pointer",selectors:(t={},t[m.k]={MsHighContrastAdjust:"none",color:"inherit"},t)},c={display:"flex",paddingTop:"6px",paddingBottom:"8px",selectors:{":hover":{backgroundColor:"#FAF9F8",selectors:(r={},r[m.k]={backgroundColor:"Highlight",color:"HighlightText"},r)}}};return{toggleSpan:Object(m.bb)({height:"20px",width:"20px"}),sectionName:Object(m.bb)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"15px",fontWeight:"normal",selectors:(n={},n[m.k]={MsHighContrastAdjust:"none",color:"inherit"},n)}),sectionHeaderFocusBackground:Object(m.bb)({backgroundColor:e?"#EDEBE9":"#FAF9F8",selectors:(i={},i[m.k]={backgroundColor:"Highlight",color:"HighlightText"},i)},c),sectionHeader:Object(m.bb)({backgroundColor:e?"#EDEBE9":"",selectors:(s={},s[m.k]={backgroundColor:e?"Highlight":"Window",color:e?"HighlightText":"WindowText"},s)},c),sectionNameDiv:Object(m.bb)({color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",verticalAlign:"center",lineHeight:"16px",cursor:"pointer",selectors:(a={},a[m.k]={MsHighContrastAdjust:"none",color:"inherit"},a)}),currentVersionDiv:Object(m.bb)({fontSize:"12px",paddingTop:"4px",fontWeight:"normal",paddingBottom:"2px"}),authorsList:Object(m.bb)({fontSize:"12px",marginTop:"4px",fontWeight:"normal"}),expand:Object(m.bb)(Object(o.__assign)(Object(o.__assign)({},l),{display:"none"})),collapse:Object(m.bb)(Object(o.__assign)(Object(o.__assign)({},l),{display:"inline-block"})),versionList:Object(m.bb)({display:"none",paddingBottom:"5px"}),groupDiv:Object(m.bb)({})}})),Q=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._list=u.createRef(),t._id=Object(h.a)(),t._header=u.createRef(),t._headerHTMLElement=null,t._groupVersion=void 0,t._isExpanded=!1,t._firstVersionCard=void 0,t._headerDescribedBy="",t.setDescribedBy=function(){t._isExpanded?t._headerDescribedBy="":t._headerDescribedBy=t._id+"DisplayString "+t._id+"AuthorList",t.props.containsTip&&(t._headerDescribedBy+=" "+t._id+"Tip"),t._header&&t._header.current&&t._header.current.setAttribute("aria-describedby",t._headerDescribedBy)},t.onSectionHeaderFocus=function(){var e=Z(t.props.selectedGroupName===t.props.label);t._header&&t._header.current&&(t._header.current.className=e.sectionHeaderFocusBackground)},t.onSectionHeaderBlur=function(){var e=Z(t.props.selectedGroupName===t.props.label);t._header&&t._header.current&&(t._header.current.className=e.sectionHeader)},t.renderToggleSpan=function(e){return 1===t.props.versions.length?u.createElement("span",{className:e.toggleSpan}):u.createElement("span",{className:e.toggleSpan,role:"button",onClick:t.onSectionIconClick,"aria-expanded":t._isExpanded},u.createElement(X.a,{id:t._id+"IconExpand",className:e.expand,iconName:J.a.DownChevronMedium_20}),u.createElement(X.a,{id:t._id+"IconCollapse",className:e.collapse,iconName:J.a.UpChevronMedium_20}))},t.renderVersionCardList=function(e){if(1!==t.props.versions.length)return u.createElement(M.a,{id:t._id,className:e.versionList,ref:t._list,items:t.props.versions,onRenderCell:t.onRenderListItem,onShouldVirtualize:t.onShouldVirtualize,getKey:t.getListItemKey})},t.renderAndSetAuthorList=function(){var e=Z(t.props.selectedGroupName===t.props.label),r=$(t.props.versions,t.props.localizedStrings,t.props.appSettings.wdEnableShowVersionEvents),o=[];switch(r.length){case 0:i.c.sendTraceTag(595644672,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"there were no authors to display");break;case 1:o=t.render1To4Authors(t.props.localizedStrings.OneUserAuthorList,r);break;case 2:o=t.render1To4Authors(t.props.localizedStrings.TwoUserAuthorList,r);break;case 3:o=t.render1To4Authors(t.props.localizedStrings.ThreeUserAuthorList,r);break;case 4:o=t.render1To4Authors(t.props.localizedStrings.FourUserAuthorList,r);break;default:o=Object(N.a)(t.props.localizedStrings.FivePlusUserAuthorList,(function(e){return"3"===e?(r.length-3).toString():t.renderAuthor(r[parseInt(e,10)])}))}return t._groupVersion&&(t._groupVersion.Authors=r),u.createElement("div",{id:t._id+"AuthorList",className:e.authorsList},o)},t.render1To4Authors=function(e,r){return Object(N.a)(e,(function(e){return t.renderAuthor(r[parseInt(e,10)])}))},t.renderAuthor=function(e){return u.createElement(P,{name:e.UserName,color:e.InitialsColor,localizedStrings:t.props.localizedStrings})},t.getListItemKey=function(e,t){return e.RevisionID||""},t.getBaseVersion=function(e,t,r){var o=null;return t.forEach((function(n,i){n===e&&(o=i!==t.length-1?t[i+1]:r)})),o},t.onShouldVirtualize=function(){return!0},t._commonCardProps={localizedStrings:t.props.localizedStrings,onVersionSelectedAction:t.props.onVersionSelectedAction},t.onRenderListItem=function(e,r){if(void 0!==e){var o=new G({localizedStrings:t._commonCardProps.localizedStrings,currentVersion:e,baseVersion:t.getBaseVersion(e,t.props.versions,t.props.finalBaseVersion),isSelected:!t.props.selectedGroupName&&t.props.selectedVersionId===e.RevisionID,ariaPosinset:void 0!==r?r+1:0,ariaSetsize:t.props.versions.length,appSettings:t.props.appSettings,onVersionSelectedAction:t._commonCardProps.onVersionSelectedAction,onLeftButton:t.programaticFocus});return 0===r&&(t._firstVersionCard=o),u.createElement("div",null,o.render())}},t.onSectionIconClick=function(e){t.expandOrCollapseSubsection(!t.isListVisible()),e.stopPropagation()},t.onSectionClicked=function(){i.c.sendTraceTag(595632606,i.a.msoulscat_Wac_VersionHistory,i.b.Warning,"group section header manually selected"),t.onSectionSelected()},t.onSectionSelected=function(){var e={currentVersion:t._groupVersion?t._groupVersion:t.props.currentSectionVersion,baseVersion:t.props.finalBaseVersion,groupName:t.props.label,noBaseToCompareTo:!t.props.finalBaseVersion};t.props.onVersionSelectedAction(e),t.isListVisible()&&t.expandOrCollapseSubsection(!1)},t.isListVisible=function(){var e=document.getElementById(t._id);return null!=e&&"block"===e.style.display},t.onKeyDownInSectionHeader=function(e){(e.which===b.a.left&&!Object(k.a)()||e.which===b.a.right&&Object(k.a)())&&t.expandOrCollapseSubsection(!1),(e.which===b.a.right&&!Object(k.a)()||e.which===b.a.left&&Object(k.a)())&&(t._isExpanded?t._firstVersionCard&&t._firstVersionCard.onFocus():t.expandOrCollapseSubsection(!0)),e.which===b.a.enter&&t.onSectionSelected()},t.programaticFocus=function(){t._header&&t._header.current&&(t._header.current.focus(),t._headerHTMLElement||(t._headerHTMLElement=document.getElementById(t._header.current.id)),t._headerHTMLElement&&Object(H.b)(!0,t._headerHTMLElement))},t.displayElement=function(e,t){t&&(t.style.display=e?"block":"none")},t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=Z(this.props.selectedGroupName===this.props.label),t=this.props.versions;this._groupVersion=Object(o.__assign)({},this.props.currentSectionVersion);var r=this.renderAndSetAuthorList();return this.props.selectedGroupName===this._groupVersion.RevisionID&&this.onSectionSelected(),this.setDescribedBy(),u.createElement(u.Fragment,null,t.length>0&&u.createElement("div",{id:this._id+"GroupDiv",className:e.groupDiv},u.createElement("div",{id:this._id+"GroupHeaderDiv",className:e.sectionHeader,onKeyDown:this.onKeyDownInSectionHeader,"aria-label":this.props.clickableGroupDisplayString,role:"treeitem","aria-expanded":"false",ref:this._header,"aria-role":"treeitem","aria-level":1,"aria-posinset":this.props.positionInSet,"aria-setsize":this.props.subsectionCount,"data-is-focusable":!0,onClick:this.onSectionClicked,onFocus:this.onSectionHeaderFocus,onBlur:this.onSectionHeaderBlur,"aria-describedby":this._headerDescribedBy},this.renderToggleSpan(e),u.createElement("div",{className:e.sectionNameDiv},u.createElement("div",{className:e.sectionName,id:this._id+"DisplayString"},this.props.clickableGroupDisplayString),this.props.containsTip&&u.createElement("div",{className:e.currentVersionDiv,id:this._id+"Tip"},this.props.localizedStrings.CurrentVersion),r)),this.renderVersionCardList(e)))},t.prototype.UNSAFE_componentWillUpdate=function(e,t,r){return this._list.current&&this._list.current.forceUpdate(),null},t.prototype.componentDidUpdate=function(){},t.prototype.expandOrCollapseSubsection=function(e){if(1!==this.props.versions.length){this.displayElement(!e,document.getElementById(this._id+"IconCollapse")),this.displayElement(!e,document.getElementById(this._id+"AuthorList")),this.displayElement(e,document.getElementById(this._id)),this.displayElement(e,document.getElementById(this._id+"IconExpand"));var t=this._header.current;t&&t.setAttribute("aria-expanded",e?"true":"false"),this._isExpanded=e,this.setDescribedBy(),e?i.c.sendTraceTag(595632607,i.a.msoulscat_Wac_VersionHistory,i.b.Warning,"group section expanded"):i.c.sendTraceTag(595632608,i.a.msoulscat_Wac_VersionHistory,i.b.Warning,"group section collapsed")}},t}(u.PureComponent);function $(e,t,r){var o=[];return r?(e.forEach((function(e){if(e.Authors&&e.Authors.length>0)e.Authors.forEach((function(e){e&&(o.some((function(t){return j(t,e)}))||o.push(e))}));else{var r=W(t,e.AuthorID);if(o.some((function(e){return e.UserName===r})))return;var n={UserName:r};o.push(n)}})),o):(e.forEach((function(e){if(e.Authors&&e.Authors.length>0)e.Authors.forEach((function(e){if(e)if(e.UserName){var r=W(t,e.UserName);if(o.some((function(e){return e.UserName===r})))return;o.push(e)}else{var n=W(t,e.UserName);if(!o.some((function(e){return e.UserName===n}))){var i={UserName:n};o.push(i)}}}));else{var r=W(t,e.AuthorID);if(o.some((function(e){return e.UserName===r})))return;var n={UserName:r};o.push(n)}})),o)}var ee,te=Object(g.c)((function(){return{nothingFoundRoot:Object(m.bb)({display:"flex",flex:"none",margin:"1px 8px"}),nothingFoundText:Object(m.bb)({padding:"14px",textAlign:"center",margin:"0 auto"})}})),re=r(367),oe=r(111),ne=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._nothingFoundId=Object(h.a)(),t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this,t=te(),r=this.props,n=r.localizedStrings,i=r.versions,s=[];i.forEach((function(t){var r=V(t.Time,void 0,n,e.props.appSettings.wdEnableCompareVersionsByGroup),o=r.friendlyGroupString,i=s.length;0===i?s.push({versions:[t],label:o,clickableGroupDisplayString:r.friendlyDateString,finalBaseVersion:null,currentSectionVersion:t,containsTip:!0}):s[i-1].label!==o?(s[i-1].finalBaseVersion=t,s.push({versions:[t],label:o,clickableGroupDisplayString:r.friendlyDateString,finalBaseVersion:null,currentSectionVersion:t,containsTip:!1})):s[i-1].versions.push(t)}));var a={selectedVersionId:this.props.selectedVersionId,localizedStrings:this.props.localizedStrings,appSettings:this.props.appSettings,onVersionSelectedAction:this.props.onVersionSelectedAction};return u.createElement(u.Fragment,null,i.length?u.createElement(re.a,{direction:oe.a.vertical},s.length>0&&s.map((function(t,r){return e.props.appSettings.wdEnableCompareVersionsByGroup?u.createElement(Q,Object(o.__assign)({key:t.label,label:t.label,clickableGroupDisplayString:t.clickableGroupDisplayString,versions:t.versions,finalBaseVersion:t.finalBaseVersion,currentSectionVersion:t.currentSectionVersion,selectedGroupName:e.props.selectedGroupName,containsTip:t.containsTip,positionInSet:r+1,subsectionCount:s.length},a)):u.createElement(Y,Object(o.__assign)({key:t.label,label:t.label,versions:t.versions,finalBaseVersion:t.finalBaseVersion},a))}))):u.createElement("div",{className:t.nothingFoundRoot,tabIndex:0,"aria-labelledby":this._nothingFoundId,role:"note"},u.createElement("div",{className:t.nothingFoundText,id:this._nothingFoundId,"aria-hidden":!0},n.VersionHistoryTitle)))},t}(u.PureComponent),ie=r(677),se=r(1249),ae=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ftzone=u.createRef(),t._paneDescribedById="versionHistoryPane",t.getAppColor=function(){return t.props.appColors?t.props.appColors.primary:t.props.appSettings.appColor?t.props.appSettings.appColor:(i.c.sendTraceTag(595683400,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"Missing app colors."),"#B7472A")},t.getToggleStyles=function(){return t.props.appSettings.wdEnableCompareVersionsByGroup?{root:{height:14,marginLeft:11},label:{fontSize:13,order:0,marginLeft:0,marginRight:16,marginBottom:4},pill:{width:32,height:14,borderRadius:7,marginBottom:1},thumb:{width:4,height:4,borderRadius:"50%"},text:{display:"none"}}:{root:{height:14,marginLeft:16},label:{fontSize:13,order:0,marginLeft:0,marginRight:5,marginBottom:4},pill:{width:32,height:14,borderRadius:7,marginBottom:1},thumb:{width:4,height:4,borderRadius:"50%"},text:{display:"none"}}},t.getToggleTheme=function(e){return t.props.appSettings.wdEnableCompareVersionsByGroup?{palette:{themePrimary:"black",themeSecondary:"black",themeDark:"black",neutralDark:"black"},semanticColors:{bodyBackground:"white",inputBackgroundChecked:"black"}}:{palette:{themePrimary:e.primary,themeSecondary:e.tint10,themeDark:e.shade10,neutralDark:e.shade20},semanticColors:{bodyBackground:e.tint50,inputBackgroundChecked:e.tint10}}},t.renderStandardListView=function(){var e,r=_(t.getAppColor(),t.props.appSettings.wdEnableShowVersionChanges,t.props.appSettings.wdEnableCompareVersionsByGroup),n=t.props,i=n.paneLoading,s=n.versions,a={localizedStrings:t.props.localizedStrings,selectedVersionId:t.props.selectedVersionId,onVersionSelectedAction:t.props.onVersionSelectedAction,appSettings:t.props.appSettings};return e=void 0!==t.props.appColors?u.createElement(se.a,{theme:Object(m.J)(t.getToggleTheme(t.props.appColors)),styles:t.getToggleStyles(),defaultChecked:!0,label:t.props.localizedStrings.ShowChangesText,inlineLabel:!0,onChange:t.onShowVersionChangesChange}):u.createElement(se.a,{styles:t.getToggleStyles(),defaultChecked:!0,label:t.props.localizedStrings.ShowChangesText,inlineLabel:!0,onChange:t.onShowVersionChangesChange}),u.createElement(u.Fragment,null,u.createElement("div",{className:r.paneHeader},a.localizedStrings.VersionHistoryTitle),u.createElement("div",{className:r.showChangesDiv},e),i?u.createElement("div",{className:r.loadingDiv},u.createElement(v.a,{className:r.loadingSpinner,size:y.a.large})):u.createElement("div",{className:r.scrollRegion},u.createElement(ne,Object(o.__assign)({versions:s,selectedGroupName:t.props.selectedGroupName},a))))},t.focus=function(){return t._ftzone.current&&t._ftzone.current.focus()},t.onKeyDown=function(e){e.which!==b.a.up&&e.which!==b.a.down||e.preventDefault()},t.onShowVersionChangesChange=function(e,r){void 0!==r&&(r?i.c.sendTraceTag(595637793,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Toggle Changes diffs turned on"):i.c.sendTraceTag(595637794,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Toggle Changes diffs turned off"),t.props.onShowVersionChangesToggledAction(r))},t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=_(this.getAppColor(),this.props.appSettings.wdEnableShowVersionChanges,this.props.appSettings.wdEnableCompareVersionsByGroup),t=this.props.localizedStrings;return u.createElement(ie.a,{ref:this._ftzone,onKeyDown:this.onKeyDown,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0,"aria-label":t.VersionHistoryTitle,"aria-describedby":this._paneDescribedById,role:"group","aria-roledescription":this.props.localizedStrings.PaneRoleDescription},this.renderStandardListView(),u.createElement("div",{id:this._paneDescribedById,className:e.hidden,"aria-hidden":!0},t.VersionHistoryTitle))},t}(u.PureComponent),le=r(127),ce=Object(g.c)((function(e,t,r,o,n,i,s,a){var l,c,p,d;return void 0===r&&(r="#B7472A"),void 0===o&&(o=!1),void 0===n&&(n=!1),void 0===i&&(i=!1),void 0===s&&(s=!1),void 0===a&&(a=!1),{root:Object(m.bb)({display:"flex",flexBasis:"78%",flexFlow:"column",minWidth:"400px",flexGrow:1.5,flexShrink:1,height:"100%"}),vhHeader:Object(m.bb)({height:"48px",width:"100%",backgroundColor:"#F4F3F1",display:"flex"}),vhViewer:Object(m.bb)({backgroundColor:"#EDEBE9",flexDirection:"column",flexGrow:1,width:"100%",display:e||t?"none":"flex",position:i?"relative":"static"}),backArrow:Object(m.bb)({height:"20px",width:"20px",color:"#4A4A4A",lineHeight:"16px",marginLeft:"19px",marginTop:"16px",minWidth:"20px",cursor:"pointer"}),icon:Object(m.bb)({flex:"none",marginTop:"3px",width:"16px",height:"16px"}),backToDoc:Object(m.bb)({height:"16px",whiteSpace:"nowrap",color:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginLeft:"18px",alignSelf:"center",cursor:"pointer"}),selectedVersionTime:Object(m.bb)({color:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:a?"18px":"12px",lineHeight:"16px",marginTop:"16px"}),ChangesText:Object(m.bb)({display:s?"flex":"none",height:"16px",color:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"14px",lineHeight:"16px",marginTop:"16px",marginLeft:"36px"}),ChangesCountText:Object(m.bb)({display:s?"flex":"none",height:"16px",width:"fill-content",color:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginLeft:"12px",marginTop:"16px",cursor:"pointer"}),IteratorIcon:Object(m.bb)({display:s?"flex":"none",height:"16px",width:"16px",color:"#4A4A4A",justifyContent:"center",lineHeight:"16px",marginLeft:"12px",marginTop:"16px",cursor:"pointer"}),viewerError:Object(m.bb)({display:t?"flex":"none",flexFlow:"column",justifyContent:"center",alignItems:"center",backgroundColor:"#EDEBE9",height:"100%",width:"100%"}),viewerErrorMessage:Object(m.bb)({height:"16px",width:"371px",color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"22px"}),loadingDiv:Object(m.bb)({display:e&&!t?"flex":"none",justifyContent:"center",alignItems:"center",backgroundColor:"#EDEBE9",height:"100%",width:"100%",flexFlow:"column"}),loadingSpinner:Object(m.bb)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:r}}}),hidden:Object(m.bb)({display:"none"}),saveACopyButton:Object(m.bb)({display:o?"flex":"none",backgroundColor:r,color:"#FFFFFF",lineHeight:"16px",marginTop:"6px",marginLeft:a?"":"23px",marginRight:a?"16px":"",whiteSpace:a?"nowrap":""}),primarySaveACopyButton:Object(m.bb)({display:o?"flex":"none",lineHeight:"16px",marginTop:"6px",marginLeft:a?"":"23px",marginRight:a?"16px":"",whiteSpace:a?"nowrap":"",selectors:(l={},l[m.k]={backgroundColor:"Window",color:"WindowText",border:"1px solid WindowText"},l[":hover"]={selectors:(c={},c[m.k]={backgroundColor:"Highlight",color:"HighlightText"},c)},l)}),restoreButton:Object(m.bb)({display:n?"flex":"none",backgroundColor:r,color:"#FFFFFF",lineHeight:"16px",marginTop:"6px",marginLeft:"23px",marginRight:a?"16px":""}),primaryRestoreButton:Object(m.bb)({display:n?"flex":"none",lineHeight:"16px",marginTop:"6px",marginLeft:"23px",marginRight:a?"16px":"",selectors:(p={},p[m.k]={backgroundColor:"Window",color:"WindowText",border:"1px solid WindowText"},p[":hover"]={selectors:(d={},d[m.k]={backgroundColor:"Highlight",color:"HighlightText"},d)},p)}),headerContent:Object(m.bb)({display:"flex",flexGrow:"1",justifyContent:"center",width:"100%",overflow:a?"auto":"visible"}),headerContentRight:Object(m.bb)({display:"flex",flexGrow:"1",justifyContent:"flex-end"})}})),pe=r(438),de=r(261),ue=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.button=u.createRef(),t.focus=function(){if(t.button.current){t.button.current.focus();var e=document.getElementById(t.props.id);e&&Object(H.b)(!0,e)}},t.getPrimaryButtonTheme=function(e){return{semanticColors:{primaryButtonBackground:e.primary,primaryButtonBackgroundHovered:e.shade10,primaryButtonBackgroundPressed:e.shade20}}},t}return Object(o.__extends)(t,e),t.prototype.render=function(){return this.props.appColors?u.createElement(pe.a,{componentRef:this.button,text:this.props.text,theme:Object(m.J)(this.getPrimaryButtonTheme(this.props.appColors)),className:this.props.primaryClassName,id:this.props.id,onClick:this.props.onClick,disabled:this.props.isDisabled,ariaDescription:this.props.ariaDescribedBy}):u.createElement(de.a,{componentRef:this.button,text:this.props.text,className:this.props.className,id:this.props.id,onClick:this.props.onClick,disabled:this.props.isDisabled,ariaDescription:this.props.ariaDescribedBy})},t}(u.PureComponent),he=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._ftzoneRoot=u.createRef(),t._ftzoneHeader=u.createRef(),t._ftzoneViewer=u.createRef(),t._headerDescribedById="versionHistoryHeader",t.onSaveAsClick=function(){t.getVersionInfoFromId(t.props.selectedVersionId,t.props)&&t.props.onSaveACopySelectedAction(t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.DownloadUrl)},t.renderHeader=function(){var e,r=t.props.appSettings.fileExtension?t.props.appSettings.fileExtension:"",o=t.props.appSettings.appColor?t.props.appSettings.appColor:"#B7472A",n=!!t.getVersionInfoFromId(t.props.selectedVersionId,t.props),i=!!t.props.appSettings.wdEnableSaveACopy&&(t.props.appSettings.wdEnableSaveACopy&&!t.props.appSettings.disableSaveACopy),s=!!t.props.appSettings.wdEnableRestore&&t.props.appSettings.wdEnableRestore,a=!!t.props.appSettings.wdEnableIterator&&t.props.appSettings.wdEnableIterator,l=!!t.props.appSettings.wdEnableIteratorBasedHeaderAlignment&&t.props.appSettings.wdEnableIteratorBasedHeaderAlignment,c=t.props.appSettings.viewerRootPositionRelative,p=!!t.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete&&(t.props.viewerLoading||t.props.viewerError),d=a&&n&&t.props.totalChangesCount>=0&&t.props.currentChange<=t.props.totalChangesCount,h=ce(t.props.viewerLoading,t.props.viewerError,o,i&&n,s&&n&&t.props.versions[0]&&t.props.selectedVersionId!==t.props.versions[0].RevisionID,c,d,l&&n);e=n?u.createElement(x,{date:t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.Time,localizedStrings:t.props.localizedStrings,isGroupUISupported:t.props.appSettings.wdEnableCompareVersionsByGroup}):u.createElement("div",null,t.props.localizedStrings.VersionHistoryTitle);var g=0===t.props.totalChangesCount?t.props.localizedStrings.IteratorNoChangesToolTip:"",m=0===t.props.totalChangesCount?g:t.props.localizedStrings.IteratorTotalChangesLabel.replace("{0}",t.props.localizedStrings.IteratorChangesCountLabel.replace("{0}",t.props.currentChange.toString()).replace("{1}",t.props.totalChangesCount.toString()));return t.createRenderHeader(r,h,p,l,g,m,e)},t.focus=function(){return t._ftzoneRoot.current&&t._ftzoneRoot.current.focus()},t.getVersionInfoFromId=function(e,t){if(e){var r=Object(le.e)(t.versions,(function(t){return t.RevisionID===e}));return r>=0?{Version:t.versions[r]}:void 0}},t.onRestoreClick=function(){t.getVersionInfoFromId(t.props.selectedVersionId,t.props)&&t.props.onRestoreVersionAction(t.getVersionInfoFromId(t.props.selectedVersionId,t.props).Version.RevisionID)},t.onBackArrowKeyDown=function(e){e.which!==b.a.enter&&e.which!==b.a.space||t.onBackToDocumentClicked()},t.onIteratorPrevKeyDown=function(e){e.which!==b.a.enter&&e.which!==b.a.space||t.onIteratorPrevClick()},t.onIteratorNextKeyDown=function(e){e.which!==b.a.enter&&e.which!==b.a.space||t.onIteratorNextClick()},t.onBackToDocumentClicked=function(){i.c.sendTraceTag(595632281,i.a.msoulscat_Wac_VersionHistory,i.b.Warning,"Back to Document clicked"),t.props.onCloseSelectedAction()},t.onIteratorNextClick=function(){t.props.totalChangesCount>0&&(i.c.sendTraceTag(595648670,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Iterator Next clicked-current count:"+t.props.currentChange.toString()+" ,total count:"+t.props.totalChangesCount.toString()),t.props.onIteratorSelectedAction(!0))},t.onIteratorPrevClick=function(){t.props.totalChangesCount>0&&(i.c.sendTraceTag(595648671,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Iterator Previous clicked-current count:"+t.props.currentChange.toString()+" ,total count:"+t.props.totalChangesCount.toString()),t.props.onIteratorSelectedAction(!1))},t}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props.appSettings.appColor?this.props.appSettings.appColor:"#B7472A",t=ce(this.props.viewerLoading,this.props.viewerError,e);return u.createElement(u.Fragment,null,u.createElement(ie.a,{ref:this._ftzoneRoot,className:t.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0,"aria-label":this.props.localizedStrings.HeaderAriaLabel,"aria-describedby":this._headerDescribedById,role:"group","aria-roledescription":this.props.localizedStrings.PaneRoleDescription},this.renderHeader()))},t.prototype.createRenderHeader=function(e,t,r,o,n,i,s){return"pptx"===e||100===this.props.appSettings.appName?this.createRenderWithFocusTrapZone(e,t,r,o,n,i,s):this.createRenderWithoutFocusTrap(e,t,r,o,n,i,s)},t.prototype.createRenderWithFocusTrapZone=function(e,t,r,o,n,i,s){return u.createElement(u.Fragment,null,u.createElement(ie.a,{ref:this._ftzoneHeader,id:"vhHeader",className:t.vhHeader,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},o?this.renderHeaderWithIterator(t,r,n,i,s):this.renderHeaderWithoutIterator(t,r,s)),this.renderErrorHeader(t,e),u.createElement(ie.a,{ref:this._ftzoneViewer,className:t.vhViewer,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!1,disableFirstFocus:!0},u.createElement("div",{id:"vhViewer",className:t.vhViewer,tabIndex:0})))},t.prototype.createRenderWithoutFocusTrap=function(e,t,r,o,n,i,s){return u.createElement(u.Fragment,null,u.createElement("div",{id:"vhHeader",className:t.vhHeader},o?this.renderHeaderWithIterator(t,r,n,i,s):this.renderHeaderWithoutIterator(t,r,s)),this.renderErrorHeader(t,e),u.createElement("div",{id:"vhViewer",className:t.vhViewer,tabIndex:0}))},t.prototype.renderBackToDocumentSection=function(e){return u.createElement(u.Fragment,null,u.createElement(X.a,{id:"backArrow",className:e.backArrow,iconName:J.a.ArrowBack_20,onClick:this.onBackToDocumentClicked}),u.createElement("div",{id:"backToDoc",className:e.backToDoc,onKeyDown:this.onBackArrowKeyDown,onClick:this.onBackToDocumentClicked,tabIndex:0,"aria-label":this.props.localizedStrings.ReturnToDoc,role:"button"},this.props.localizedStrings.ReturnToDoc))},t.prototype.renderHeaderWithIterator=function(e,t,r,o,n){return u.createElement(u.Fragment,null,this.renderBackToDocumentSection(e),u.createElement("div",{className:e.headerContent},u.createElement("div",{id:"selectedVersionTime",className:e.selectedVersionTime},n),u.createElement("div",{id:"ChangesText",className:e.ChangesText},this.props.localizedStrings.IteratorChangesLabel),u.createElement(X.a,{id:"iterateBack",className:e.IteratorIcon,title:r,"aria-label":this.props.localizedStrings.IteratorPreviousChangeButtonLabel,tabIndex:0===this.props.totalChangesCount?void 0:0,iconName:J.a.BackChevronPaddle_24,onClick:this.onIteratorPrevClick,onKeyDown:this.onIteratorPrevKeyDown}),u.createElement("div",{id:"CountText",className:e.ChangesCountText,title:r,"aria-label":o,tabIndex:0},this.props.localizedStrings.IteratorChangesCountLabel.replace("{0}",this.props.currentChange.toString()).replace("{1}",this.props.totalChangesCount.toString())),u.createElement(X.a,{id:"iterateFront",className:e.IteratorIcon,title:r,"aria-label":this.props.localizedStrings.IteratorNextChangeButtonLabel,tabIndex:0===this.props.totalChangesCount?void 0:0,iconName:J.a.NextChevronPaddle_24,onClick:this.onIteratorNextClick,onKeyDown:this.onIteratorNextKeyDown})),u.createElement("div",{className:e.headerContentRight},u.createElement(ue,{text:this.props.localizedStrings.RestoreLabel,className:e.restoreButton,primaryClassName:e.primaryRestoreButton,id:"VHRestoreButton",onClick:this.onRestoreClick,isDisabled:t,appColors:this.props.appColors}),u.createElement(ue,{text:this.props.localizedStrings.SaveACopy,className:e.saveACopyButton,primaryClassName:e.primarySaveACopyButton,id:"VHSaveACopyButton",onClick:this.onSaveAsClick,isDisabled:t,appColors:this.props.appColors})))},t.prototype.renderHeaderWithoutIterator=function(e,t,r){return u.createElement(u.Fragment,null,this.renderBackToDocumentSection(e),u.createElement("div",{className:e.headerContent},u.createElement("div",{id:"selectedVersionTime",className:e.selectedVersionTime},r),u.createElement(ue,{text:this.props.localizedStrings.SaveACopy,className:e.saveACopyButton,primaryClassName:e.primarySaveACopyButton,id:"VHSaveACopyButton",onClick:this.onSaveAsClick,isDisabled:t,appColors:this.props.appColors}),u.createElement(ue,{text:this.props.localizedStrings.RestoreLabel,className:e.restoreButton,primaryClassName:e.primaryRestoreButton,id:"VHRestoreButton",onClick:this.onRestoreClick,isDisabled:t,appColors:this.props.appColors})))},t.prototype.renderErrorHeader=function(e,t){return u.createElement(u.Fragment,null,u.createElement("div",{id:this._headerDescribedById,className:e.hidden,"aria-hidden":!0},"Version History Header"),u.createElement("div",{className:e.viewerError},u.createElement("img",{src:"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/document/svg/"+t+"_48x1_5.svg",width:"62",height:"55"}),u.createElement("div",{className:e.viewerErrorMessage},this.props.localizedStrings.ViewerAreaErrorText)),u.createElement("div",{className:e.loadingDiv},u.createElement(v.a,{className:e.loadingSpinner,size:y.a.large})))},t}(u.PureComponent),ge=Object(g.c)((function(e){var t,r;return void 0===e&&(e="#B7472A"),{modalButton:Object(m.bb)({backgroundColor:e,color:"#FFFFFF"}),primaryModalButton:Object(m.bb)({selectors:(t={},t[m.k]={backgroundColor:"Window",color:"WindowText",border:"1px solid WindowText"},t[":hover"]={selectors:(r={},r[m.k]={backgroundColor:"Highlight",color:"HighlightText"},r)},t)}),loadingSpinner:Object(m.bb)({selectors:{"& .ms-Spinner-circle":{borderColor:"#dddddd",borderTopColor:e}}})}})),me=r(1248),fe=r(285),be=r(656);!function(e){e[e.Hidden=1]="Hidden",e[e.CoauthRestoreDisplayed=2]="CoauthRestoreDisplayed",e[e.CoauthRestoreFailedServer=3]="CoauthRestoreFailedServer",e[e.CoauthRestoreInProgress=4]="CoauthRestoreInProgress"}(ee||(ee={}));var ve=function(e){function t(t){return e.call(this,t)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=ge(this.props.appSettings.appColor?this.props.appSettings.appColor:"#B7472A");switch(this.props.modalErrorState){case ee.CoauthRestoreDisplayed:return u.createElement(me.a,{hidden:!1,onDismiss:this.props.onDismiss,dialogContentProps:{type:fe.a.normal,title:this.props.localizedStrings.OtherEditors,subText:this.props.localizedStrings.OtherEditorsSubtext}},u.createElement(be.a,null,u.createElement(ue,{text:this.props.localizedStrings.RestoreContinue,className:e.modalButton,primaryClassName:e.primaryModalButton,id:"VHRestorContinue",onClick:this.props.onDismiss,isDisabled:!1,appColors:this.props.appColors})));case ee.CoauthRestoreInProgress:return u.createElement(me.a,{hidden:!1,isBlocking:!0,onDismiss:this.props.onDismiss,dialogContentProps:{type:fe.a.normal,title:this.props.localizedStrings.RestoreInProgress}},u.createElement(v.a,{className:e.loadingSpinner,size:y.a.large,ariaLabel:this.props.localizedStrings.RestoreInProgress}));case ee.CoauthRestoreFailedServer:return u.createElement(me.a,{hidden:!1,isBlocking:!0,onDismiss:this.props.onDismiss,dialogContentProps:{type:fe.a.normal,title:this.props.localizedStrings.RestoreFailed,subText:this.props.localizedStrings.RestoreFailedSubtext}},u.createElement(be.a,null,u.createElement(ue,{text:this.props.localizedStrings.RestoreContinue,className:e.modalButton,primaryClassName:e.primaryModalButton,id:"VHRestorContinue",onClick:this.props.refreshCallback,isDisabled:!1,appColors:this.props.appColors})));case ee.Hidden:default:return null}},t}(u.PureComponent),ye=Object(g.c)((function(e){var t,r,o,n,i;return void 0===e&&(e="#B7472A"),{backArrow:Object(m.bb)({height:"20px",width:"20px",color:"#4A4A4A",lineHeight:"16px",marginLeft:"19px",marginTop:"16px",minWidth:"20px",cursor:"pointer"}),fullAppError:Object(m.bb)({display:"flex",flexFlow:"column",justifyContent:"center",alignItems:"center",height:"100%",width:"100%",backgroundColor:"#FFFFFF"}),fullAppErrorTop:Object(m.bb)({height:"24px",width:"284px",color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"18px",fontWeight:"300",lineHeight:"24px",textAlign:"center",marginTop:"38px"}),fullAppErrorSub:Object(m.bb)({height:"32px",width:"239px",color:"#252423",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",textAlign:"center",marginTop:"15px"}),fullAppErrorButtons:Object(m.bb)({display:"flex",flexFlow:"row",marginTop:"33px"}),vhHeader:Object(m.bb)({height:"48px",width:"100%",backgroundColor:"#F4F3F1",display:"flex"}),backToDoc:Object(m.bb)({height:"16px",width:"97px",color:"#4A4A4A",fontFamily:'"Segoe UI", "Segoe UI Web", Calibri, Helvetica, Arial, sans-serif',fontSize:"12px",lineHeight:"16px",marginLeft:"18px",marginTop:"16px",cursor:"pointer"}),backButton:Object(m.bb)({marginLeft:"9px"}),backButtonPrimaryColor:Object(m.bb)({backgroundColor:e,color:"#FFFFFF",marginLeft:"9px"}),backPrimaryButton:Object(m.bb)({marginLeft:"9px",selectors:(t={},t[m.k]={backgroundColor:"Window",color:"WindowText",border:"1px solid WindowText"},t[":hover"]={selectors:(r={},r[m.k]={backgroundColor:"Highlight",color:"HighlightText"},r)},t)}),tryAgainButton:Object(m.bb)({backgroundColor:e,color:"#FFFFFF"}),primaryTryAgainButton:Object(m.bb)({selectors:(o={},o[m.k]={backgroundColor:"Window",color:"WindowText",border:"1px solid WindowText"},o[":hover"]={selectors:(n={},n[m.k]={backgroundColor:"Highlight",color:"HighlightText"},n)},o)}),disabledPrimaryTryAgainButton:Object(m.bb)({selectors:(i={},i[m.k]={backgroundColor:"Window",color:"GrayText",border:"1px solid GrayText"},i)})}})),_e=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=this.props.appSettings.fileExtension?this.props.appSettings.fileExtension:"",t=this.props.appSettings.appColor?this.props.appSettings.appColor:"#B7472A";return 104===this.props.fullAppError?this.renderVersioningDisabled(e,t):this.renderGenericError(e,t)},t.prototype.componentDidUpdate=function(){this.setFocusOnLoad()},t.prototype.componentDidMount=function(){this.setFocusOnLoad()},t.prototype.renderHeader=function(e){return u.createElement("div",{id:"vhHeader",className:e.vhHeader},u.createElement(X.a,{id:"backArrow",className:e.backArrow,iconName:J.a.ArrowBack_20,onClick:this.props.onCloseSelectedAction}),u.createElement("div",{id:"backToDoc",className:e.backToDoc,onClick:this.props.onCloseSelectedAction},this.props.localizedStrings.ReturnToDoc))},t.prototype.renderErrorImage=function(e){return u.createElement("img",{src:"https://static2.sharepointonline.com/files/fabric/assets/brand-icons/document/svg/"+e+"_48x1_5.svg",role:"presentation",alt:"",width:"62",height:"55"})},t.prototype.renderVersioningDisabled=function(e,t){var r=ye(t),o=this.props.localizedStrings.VersioningDisabledError,n=this.props.localizedStrings.VersioningDisabledDetails;return this._primaryButtonForFocus=new ue({text:this.props.localizedStrings.BackLabel,className:r.backButtonPrimaryColor,primaryClassName:r.backPrimaryButton,id:"VHErrorBackButton",onClick:this.props.onCloseSelectedAction,isDisabled:!1,appColors:this.props.appColors,ariaDescribedBy:o}),u.createElement(u.Fragment,null,this.renderHeader(r),u.createElement("div",{className:r.fullAppError},this.renderErrorImage(e),u.createElement("div",{className:r.fullAppErrorTop}," ",o),u.createElement("div",{className:r.fullAppErrorSub},n),u.createElement("div",{className:r.fullAppErrorButtons},u.createElement(ue,{text:this.props.localizedStrings.TryAgainLabel,className:"",primaryClassName:r.disabledPrimaryTryAgainButton,id:"VHTryAgainButton",onClick:this.props.getVersions,isDisabled:!0,appColors:this.props.appColors}),this._primaryButtonForFocus.render())))},t.prototype.renderGenericError=function(e,t){var r=ye(t),o=this.props.localizedStrings.FullAppErrorTextTop,n=this.props.localizedStrings.FullAppErrorTextSub;return this._primaryButtonForFocus=new ue({text:this.props.localizedStrings.TryAgainLabel,className:r.tryAgainButton,primaryClassName:r.primaryTryAgainButton,id:"VHTryAgainButton",onClick:this.props.getVersions,isDisabled:!1,appColors:this.props.appColors,ariaDescribedBy:o}),u.createElement(u.Fragment,null,this.renderHeader(r),u.createElement("div",{className:r.fullAppError},this.renderErrorImage(e),u.createElement("div",{className:r.fullAppErrorTop}," ",o),u.createElement("div",{className:r.fullAppErrorSub},n),u.createElement("div",{className:r.fullAppErrorButtons},this._primaryButtonForFocus.render(),u.createElement(de.a,{text:this.props.localizedStrings.BackLabel,id:"VHErrorBackButton",className:r.backButton,onClick:this.props.onCloseSelectedAction}))))},t.prototype.setFocusOnLoad=function(){this._primaryButtonForFocus&&this._primaryButtonForFocus.focus()},t}(u.PureComponent),Ce=function(e){function t(t){var r=e.call(this,t)||this;return r._ftzone=u.createRef(),r._vhPane=u.createRef(),r._vhHeader=u.createRef(),r._dialogDescribedById=Object(h.a)(),r.renderVersionHistoryDialog=function(){var e=r.props.versions,t={localizedStrings:r.props.localizedStrings,selectedVersionId:r.props.selectedVersionId,selectedGroupName:r.props.selectedGroupName,totalChangesCount:r.props.totalChangesCount,currentChange:r.props.currentChange,onVersionSelectedAction:r.props.onVersionSelectedAction,onCloseSelectedAction:r.props.onCloseSelectedAction,onRestoreVersionAction:r.props.onRestoreVersionAction,paneLoading:r.props.paneLoading,viewerLoading:r.props.viewerLoading,viewerError:r.props.viewerError,fullAppError:r.props.fullAppError,appSettings:r.props.appSettings,appColors:r.props.appColors,modalErrorState:r.props.modalErrorState,refreshCallback:r.props.refreshCallback},n=f();return u.createElement(u.Fragment,null,r.props.fullAppError?u.createElement(u.Fragment,null,u.createElement("div",{className:n.fullAppErrorDiv},u.createElement(_e,Object(o.__assign)({versions:e},t,{getVersions:r.props.getVersions})))):u.createElement(u.Fragment,null,u.createElement(ve,Object(o.__assign)({versions:e},t,{onDismiss:r._onDismiss})),u.createElement(he,Object(o.__assign)({versions:e},t,{onSaveACopySelectedAction:r.props.onSaveACopySelectedAction,onRestoreVersionAction:r.props.onRestoreVersionAction,onIteratorSelectedAction:r.props.onIteratorSelectedAction,ref:r._vhHeader})),u.createElement(ae,Object(o.__assign)({versions:e},t,{onShowVersionChangesToggledAction:r.props.onShowVersionChangesToggledAction,ref:r._vhPane}))))},r.focus=function(){return r._vhPane.current&&r._vhPane.current.focus()},r.focusHeader=function(){return r._vhHeader.current&&r._vhHeader.current.focus()},r._onDismiss=function(){t.setModalError(ee.Hidden)},r}return Object(o.__extends)(t,e),t.prototype.render=function(){var e=f(this.props.appSettings.isRtl),t=this.props.localizedStrings;return u.createElement(ie.a,{ref:this._ftzone,className:e.root,forceFocusInsideTrap:!1,isClickableOutsideFocusTrap:!0,ignoreExternalFocusing:!0,focusPreviouslyFocusedInnerElement:!0,disableFirstFocus:!0,"aria-label":t.VersionHistoryTitle,"aria-describedby":this._dialogDescribedById,role:"group","aria-roledescription":t.VersionHistoryTitle},this.renderVersionHistoryDialog(),u.createElement("div",{id:this._dialogDescribedById,className:e.hidden,"aria-hidden":!0},t.VersionHistoryTitle))},t}(u.PureComponent),Se=r(131);function Ee(e,t,r){return versionHistorySprite&&(Object(m.gb)({icons:Object(Se.iconSpriteToReactMap)(versionHistorySprite)}),versionHistorySprite=void 0),new Promise((function(i){n.render(u.createElement(Te,Object(o.__assign)({ref:function(e){return i(e)}},t,r)),e)}))}var Te=function(e){function t(t){var r=e.call(this,t)||this;return r._dialog=u.createRef(),r.selectedVersionId=null,r.onVersionSelectedAction=function(e){var t=r.state.versions;if(e.currentVersion&&e.currentVersion.RevisionID){var o=e.currentVersion.RevisionID,n=r.getVersionInfoFromId(o,r.state),s=n?n.index:-1,a=e.currentVersion.Authors?e.currentVersion.Authors.length:1,l="",c="",p="";s>=0&&(s<t.length-1&&t[s+1]&&t[s+1].Time&&(l=t[s+1].Time.toISOString()),s>0&&t[s-1]&&t[s-1].Time&&(c=t[s-1].Time.toISOString()),e.currentVersion.Time&&(p=e.currentVersion.Time.toISOString()));var d=JSON.stringify({VersionCount:t.length,AuthorCount:a,CurrTime:p,PrevTime:l,NextTime:c,GroupName:r.state.selectedGroupName,CurrentChange:r.state.currentChange,TotalChangesCount:r.state.totalChangesCount}),u=r.getLoggableVersionInfoString("onVersionSelectedAction - Version selected in pane",e.currentVersion.RevisionID,r.state);if(i.c.sendTraceTag(595933192,i.a.msoulscat_Wac_VersionHistory,i.b.Info,'{ "OriginalInfo": '+u+', "RichInfo": '+d+"}"),r.selectedVersionId=e.currentVersion.RevisionID?e.currentVersion.RevisionID:void 0,r.setState({selectedVersionId:e.currentVersion.RevisionID?e.currentVersion.RevisionID:void 0}),e.currentVersion.DownloadUrl)r.selectVersion(e);else{r.setViewerError(!1),r.setViewerLoading(!0);var h=[e.currentVersion.RevisionID];e.baseVersion&&e.baseVersion.RevisionID&&h.push(e.baseVersion.RevisionID),r.props.getDownloadToken(h,e)}if(e.currentVersion.DownloadUrl&&e.baseVersion&&e.baseVersion.RevisionID&&!e.baseVersion.DownloadUrl){h=[e.currentVersion.RevisionID,e.baseVersion.RevisionID];r.props.getDownloadToken(h,e)}}},r.onCloseSelectedAction=function(){r.props.onCloseSelectedAction()},r.onSaveACopySelectedAction=function(e){i.c.sendTraceTag(595903688,i.a.msoulscat_Wac_VersionHistory,i.b.Warning,r.getLoggableVersionInfoString("onSaveACopySelectedAction",r.state.selectedVersionId,r.state)),r.props.onSaveACopySelectedAction(e)},r.onRestoreVersionAction=function(e){i.c.sendTraceTag(595892446,i.a.msoulscat_Wac_VersionHistory,i.b.Warning,r.getLoggableVersionInfoString("onRestoreVersionAction",e,r.state)),r.props.onRestoreVersionAction(e)},r.getAgeOfTime=function(e){return Date.now()-e.getTime()},r.getVersionInfoFromId=function(e,t){if(e){var r=Object(le.e)(t.versions,(function(t){return t.RevisionID===e}));return r>=0?{version:t.versions[r],index:r}:void 0}},r.getLoggableVersionInfoString=function(e,t,o){var n=r.getVersionInfoFromId(t,o);if(n){var i=n.version,s=n.index,a=i.Time?r.getAgeOfTime(i.Time):"-1";return JSON.stringify({msg:e,revisionId:i.RevisionID,revisionAge:a,revisionIndex:s})}return""},r.state={versions:[],selectedVersionId:void 0,selectedGroupName:void 0,totalChangesCount:0,currentChange:0,paneLoading:!0,viewerLoading:!0,viewerError:!1,fullAppError:0,modalErrorState:ee.Hidden,refreshCallback:function(){}},r.setModalError=r.setModalError.bind(r),r.setRefreshCallback=r.setRefreshCallback.bind(r),i.c.sendTraceTag(595933189,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"Pane constructed"),r}return Object(o.__extends)(t,e),t.prototype.insertVersions=function(e){i.c.sendTraceTag(595933190,i.a.msoulscat_Wac_VersionHistory,i.b.Info,JSON.stringify({msg:"insertVersions",count:e.length})),this.setState({versions:e})},t.prototype.selectSubSectionWithVersion=function(e){this._dialog&&this._dialog.current&&e&&this.setState({selectedGroupName:e.RevisionID?e.RevisionID:void 0})},t.prototype.setTotalChangesCount=function(e){this._dialog&&this._dialog.current&&this.setState({totalChangesCount:e})},t.prototype.setCurrentChangeCount=function(e){this._dialog&&this._dialog.current&&this.setState({currentChange:e})},t.prototype.setPaneLoading=function(e){this.setState({paneLoading:e})},t.prototype.setViewerLoading=function(e){this.setState({viewerLoading:e})},t.prototype.setViewerError=function(e){this.setState({viewerError:e})},t.prototype.setFullAppErrorCode=function(e){this.setState({fullAppError:e})},t.prototype.setModalError=function(e){this.setState({modalErrorState:e})},t.prototype.setRefreshCallback=function(e){this.setState({refreshCallback:e})},t.prototype.removeAllVersions=function(){i.c.sendTraceTag(595933191,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"removeAllVersions"),this.setState({versions:[]})},t.prototype.selectVersion=function(e){var t=this;e.currentVersion&&e.currentVersion.RevisionID&&(i.c.sendTraceTag(595907534,i.a.msoulscat_Wac_VersionHistory,i.b.Info,this.getLoggableVersionInfoString("selectVersion - Version selected in pane",e.currentVersion.RevisionID,this.state)),this.selectedVersionId=e.currentVersion.RevisionID?e.currentVersion.RevisionID:void 0,this.setState({selectedVersionId:this.selectedVersionId,selectedGroupName:e.groupName?e.groupName:void 0}),this.props.appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete?this.setState({viewerLoading:!0,viewerError:!1},(function(){return t.props.onVersionSelectedAction(e)})):this.setState({viewerLoading:!1,viewerError:!1},(function(){return t.props.onVersionSelectedAction(e)})))},t.prototype.render=function(){return u.createElement(Ce,Object(o.__assign)({ref:this._dialog,setModalError:this.setModalError,setRefreshCallback:this.setRefreshCallback},this.props,this.state,{onVersionSelectedAction:this.onVersionSelectedAction,onCloseSelectedAction:this.onCloseSelectedAction,onSaveACopySelectedAction:this.onSaveACopySelectedAction,onRestoreVersionAction:this.onRestoreVersionAction,getVersions:this.props.getVersions,appColors:this.props.appColors}))},t.prototype.enterFocusTrapZone=function(){this._dialog.current&&this._dialog.current.focus()},t.prototype.enterHeaderFocusTrapZone=function(){this._dialog.current&&this._dialog.current.focusHeader()},t}(u.PureComponent),Ve={shade20:"#002050",shade10:"#124078",primary:"#2b579a",tint10:"#3c65a4",tint20:"#4a78b0",tint30:"#7da3c6",tint40:"#a5b9d1",tint50:"#e3ecfa"},we={shade20:"#740912",shade10:"#a92b1a",primary:"#b7472a",tint10:"#c75033",tint20:"#e86e58",tint30:"#ed9583",tint40:"#fdc9b5",tint50:"#fcf0ed"},Ie={shade20:"#004b1c",shade10:"#0e5c2f",primary:"#217346",tint10:"#3f8159",tint20:"#4e9668",tint30:"#6eb38a",tint40:"#9fcdb3",tint50:"#e9f5ee"},De=function(){function e(e,t,r,o,n,s,a,l){this._onVersionsReadyEvent=new d,this._onDownloadTokenReadyEvent=new d,this._fullAppErrorEvent=new d,this._onVersionSelectedEvent=new d,this._onTipVersionTokenReadyEvent=new d,this._onCloseSelectedEvent=new d,this._onSaveACopySelectedEvent=new d,this._onRestoreVersionSelectedEvent=new d,this._onIteratorSelectedEvent=new d,this._onAppRefreshTriggeredEvent=new d,this._onShowVersionChangesToggledEvent=new d,i.c.setLogger(t),this._perfTelemetryInfos=l,this._appSettings=a||{appColor:"#B7472A",appName:0,fileExtension:"",wdEnableDownloadTokens:!1,retryCount:3,wdEnableSaveACopy:!1,wdEnableRestore:!1,wdEnableIterator:!1,userSessionId:"",wacCluster:"",uiLocale:"en-us",isRtl:!1,useXhr:!1,viewerRootPositionRelative:!1,wdEnableIteratorBasedHeaderAlignment:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:!1,wdEnableShowVersionChanges:!1,disableSaveACopy:!1,wdEnableCompareVersionsByGroup:!1,wdEnableShowVersionEvents:!1},T.UILocale=this._appSettings.uiLocale,this._versionHistoryStringsBag=e,this._versionHistoryCache=new p(this._onVersionsReadyEvent,this._onDownloadTokenReadyEvent,this._fullAppErrorEvent,this._onTipVersionTokenReadyEvent,r,o,this._appSettings,n,s,this._perfTelemetryInfos),this._onVersionsReadyEvent.addListener(this.onVersionsReady.bind(this)),this._onDownloadTokenReadyEvent.addListener(this.onDownloadTokenReady.bind(this)),this._fullAppErrorEvent.addListener(this.fullAppError.bind(this)),this._onTipVersionTokenReadyEvent.addListener(this.onTipVersionTokenReady.bind(this))}return e.prototype.createVersionHistoryDialog=function(e){var t=this;if(e){null!=this._perfTelemetryInfos&&this._perfTelemetryInfos.push({TelemetryEventKey:"CreateVersionHistoryDialogStart",TelemetryEventData:Date.now().toString()});var r={onVersionSelectedAction:this._onVersionSelectedEvent.fireEvent.bind(this._onVersionSelectedEvent),onCloseSelectedAction:this._onCloseSelectedEvent.fireEvent.bind(this._onCloseSelectedEvent),onSaveACopySelectedAction:this._onSaveACopySelectedEvent.fireEvent.bind(this._onSaveACopySelectedEvent),onRestoreVersionAction:this._onRestoreVersionSelectedEvent.fireEvent.bind(this._onRestoreVersionSelectedEvent),onIteratorSelectedAction:this._onIteratorSelectedEvent.fireEvent.bind(this._onIteratorSelectedEvent),onShowVersionChangesToggledAction:this._onShowVersionChangesToggledEvent.fireEvent.bind(this._onShowVersionChangesToggledEvent),getVersions:function(){return t.getVersions()},getDownloadToken:function(e,r){return t.getDownloadToken(e,r)}},o={localizedStrings:this._versionHistoryStringsBag,appSettings:this._appSettings};if(this._appSettings.appColor){var n=this._appSettings.appColor.toString().toLowerCase();n===Ve.primary.toString().toLowerCase()?o.appColors=Ve:n===we.primary.toString().toLowerCase()?o.appColors=we:n===Ie.primary.toString().toLowerCase()?o.appColors=Ie:i.c.sendTraceTag(595687505,i.a.msoulscat_Wac_VersionHistory,i.b.Error,"invalid app colors used"+this._appSettings.appColor)}return Ee(e,o,r).then((function(e){return t._versionHistoryDialog=e,t._versionHistoryDialog.insertVersions(t._versionHistoryCache.Versions),i.c.sendTraceTag(595933194,i.a.msoulscat_Wac_VersionHistory,i.b.Info,JSON.stringify({msg:"Pane initially populated",versionCount:t._versionHistoryCache.Versions.length})),null!=t._perfTelemetryInfos&&t._perfTelemetryInfos.push({TelemetryEventKey:"CreateVersionHistoryDialogEnd",TelemetryEventData:Date.now().toString()}),e}))}return Promise.reject(void 0)},e.prototype.getTipVersion=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return[4,this._versionHistoryCache.getTipVersion()];case 1:return e.sent(),[2]}}))}))},e.prototype.getVersions=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){switch(e.label){case 0:return this._versionHistoryDialog&&(this._versionHistoryDialog.setFullAppErrorCode(0),this._versionHistoryDialog.setPaneLoading(!0),this._versionHistoryDialog.setViewerLoading(!0)),[4,this._versionHistoryCache.getVersions()];case 1:return e.sent(),[2]}}))}))},e.prototype.setVersionLoadComplete=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setViewerLoading(!1),[2]}))}))},e.prototype.setTotalChangesCount=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this._versionHistoryDialog&&(i.c.sendTraceTag(595658889,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"setTotalChangesCount with count:"+e.toString()),this._versionHistoryDialog.setTotalChangesCount(e)),[2]}))}))},e.prototype.setCurrentChangeCount=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this._versionHistoryDialog&&(i.c.sendTraceTag(595658890,i.a.msoulscat_Wac_VersionHistory,i.b.Info,"setCurrentChangeCount with count:"+e.toString()),this._versionHistoryDialog.setCurrentChangeCount(e)),[2]}))}))},e.prototype.setFullAppErrorCode=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this._versionHistoryDialog&&this._versionHistoryDialog.setFullAppErrorCode(e),[2]}))}))},e.prototype.setViewerError=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this._versionHistoryDialog&&this._versionHistoryDialog.setViewerError(e),[2]}))}))},e.prototype.setCoauthRestoreError=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setModalError(ee.CoauthRestoreDisplayed),[2]}))}))},e.prototype.setRestoreFailedAtServer=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this._versionHistoryDialog&&e&&(this._versionHistoryDialog.setModalError(ee.CoauthRestoreFailedServer),this._versionHistoryDialog.setRefreshCallback(e)),[2]}))}))},e.prototype.setRestoreInProgress=function(){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(e){return this._versionHistoryDialog&&this._versionHistoryDialog.setModalError(ee.CoauthRestoreInProgress),[2]}))}))},e.prototype.setDisableSaveACopy=function(e){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(t){return this._appSettings&&(this._appSettings.disableSaveACopy=e),[2]}))}))},e.prototype.getDownloadToken=function(e,t){return Object(o.__awaiter)(this,void 0,void 0,(function(){return Object(o.__generator)(this,(function(r){switch(r.label){case 0:return this._versionHistoryDialog?(this._versionHistoryDialog.setFullAppErrorCode(0),[4,this._versionHistoryCache.getDownloadToken(e,t)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}}))}))},e.prototype.getVersionSelectedEvent=function(){return this._onVersionSelectedEvent},e.prototype.getCloseSelectedEvent=function(){return this._onCloseSelectedEvent},e.prototype.getSaveACopySelectedEvent=function(){return this._onSaveACopySelectedEvent},e.prototype.getRestoreVersionSelectedEvent=function(){return this._onRestoreVersionSelectedEvent},e.prototype.getIteratorSelectedEvent=function(){return this._onIteratorSelectedEvent},e.prototype.getVersionsReadyEvent=function(){return this._onVersionsReadyEvent},e.prototype.getAppRefreshTriggeredEvent=function(){return this._onAppRefreshTriggeredEvent},e.prototype.getDownloadTokenReadyEvent=function(){return this._onDownloadTokenReadyEvent},e.prototype.getTipVersionTokenReadyEvent=function(){return this._onTipVersionTokenReadyEvent},e.prototype.getFullAppErrorEvent=function(){return this._fullAppErrorEvent},e.prototype.getShowVersionChangesToggledEvent=function(){return this._onShowVersionChangesToggledEvent},e.prototype.onVersionsReady=function(e){var t=this;n.unstable_batchedUpdates((function(){if(t._versionHistoryDialog&&e&&e.versions&&(t._versionHistoryDialog.setPaneLoading(!1),t._versionHistoryDialog.insertVersions(e.versions.filter((function(e){return e}))),e.versions[0])){if(t._appSettings.wdEnableCompareVersionsByGroup)return void t._versionHistoryDialog.selectSubSectionWithVersion(e.versions[0]);var r=e.versions[1]?e.versions[1]:null,o=[];e.versions[0].DownloadUrl?(t._versionHistoryDialog.selectVersion({currentVersion:e.versions[0],baseVersion:r,correlationID:e.correlationID,noBaseToCompareTo:!r}),t._appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete||t._versionHistoryDialog.setViewerLoading(!1)):t._versionHistoryDialog.selectedVersionId=e.versions[0].RevisionID,(!e.versions[0].DownloadUrl||t._versionHistoryCache._tipVersionResponse&&t._versionHistoryCache._tipVersionResponse.data&&e.versions[0].DownloadUrl===t._versionHistoryCache._tipVersionResponse.data.DownloadUrl)&&o.push(e.versions[0].RevisionID),e.versions[1]&&!e.versions[1].DownloadUrl&&o.push(e.versions[1].RevisionID),o.length>0&&t._versionHistoryCache.getDownloadToken(o,{currentVersion:e.versions[0],baseVersion:r,noBaseToCompareTo:!r})}}))},e.prototype.onDownloadTokenReady=function(e){var t=this;n.unstable_batchedUpdates((function(){if(t._versionHistoryDialog&&e&&e.updatedVersions){var r=e.updatedVersions.filter((function(e){return e}));t._versionHistoryDialog.insertVersions(r),!e.versionSelected||!e.versionSelected.currentVersion||t._versionHistoryDialog.selectedVersionId&&t._versionHistoryDialog.selectedVersionId!==e.versionSelected.currentVersion.RevisionID||(t._versionHistoryDialog.selectVersion(e.versionSelected),t._appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete||t._versionHistoryDialog.setViewerLoading(!1))}}))},e.prototype.onTipVersionTokenReady=function(e){var t=this;n.unstable_batchedUpdates((function(){if(t._versionHistoryDialog&&e&&e.tipVersion&&e.tipVersion.DownloadUrl&&e.updatedVersions&&e.updatedVersions[0]&&e.tipVersion.DownloadUrl===e.updatedVersions[0].DownloadUrl){var r=e.updatedVersions.filter((function(e){return e}));t._versionHistoryDialog.insertVersions(r),t._versionHistoryDialog.selectedVersionId&&t._versionHistoryDialog.selectedVersionId!==e.updatedVersions[0].RevisionID||(t._versionHistoryDialog.selectVersion({currentVersion:e.updatedVersions[0],noBaseToCompareTo:!1}),t._appSettings.wdEnableHiddenButtonsUntilVersionLoadComplete||t._versionHistoryDialog.setViewerLoading(!1))}}))},e.prototype.fullAppError=function(e){var t=this;n.unstable_batchedUpdates((function(){t._versionHistoryDialog&&(t._versionHistoryDialog.setViewerLoading(!1),t._versionHistoryDialog.setPaneLoading(!1),t._versionHistoryDialog.setViewerError(!1),t._versionHistoryDialog.setFullAppErrorCode(e))}))},e}(),xe=function(){function e(){}return e.createVersionHistoryController=function(e,t,r,n,i,s,a){var l=Object(o.__assign)(Object(o.__assign)({},OfficeVersionHistoryStrings),FriendlyDatesStrings);return new De(l,e,t,r,n,i,s,a)},e}(),Ae=new(function(){function e(){}return e.prototype.getVersionHistoryControllerInstance=function(e){if(e&&e.docId&&e.ulsLogger)return xe.createVersionHistoryController(e.ulsLogger,null===e.serviceBase||void 0===e.serviceBase?"":e.serviceBase,e.docId,null===e.latestStreamServiceBase||void 0===e.latestStreamServiceBase?"":e.latestStreamServiceBase,void 0,e.appSettings,e.perfTelemetryInfos)},e}());r.d(t,"FactoryGlobal",(function(){return Ae}))},179:function(e,t){e.exports={CancelGlyph_16:"CancelGlyph_16",ArrowStyle3_20:"ArrowStyle3_20",ArrowBack_20:"ArrowBack_20",BackChevronPaddle_24:"BackChevronPaddle_24",NextChevronPaddle_24:"NextChevronPaddle_24",UpChevronMedium_20:"UpChevronMedium_20",DownChevronMedium_20:"DownChevronMedium_20",HintBarEllipses_20:"HintBarEllipses_20",CommonControlChevronDown_8:"CommonControlChevronDown_8",CommonControlChevronDownGlyph_12:"CommonControlChevronDownGlyph_12",CommonControlChevronUp_8:"CommonControlChevronUp_8",CommonControlChevronRight_12:"CommonControlChevronRight_12",CommonControlChevronLeft_16:"CommonControlChevronLeft_16",CommonControlCheckboxCheck_16:"CommonControlCheckboxCheck_16",CheckmarkWithDynamicColor_16:"CheckmarkWithDynamicColor_16",CommonControlDialogLauncher_8:"CommonControlDialogLauncher_8"}}});
//# sourceMappingURL=versionHistory.min.js.map