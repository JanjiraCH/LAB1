function wac_x6c(a,b){var c=a.OA.$$lge();b=b.$$lge();for(var d=c.$$mn(),e=b.$$mn(),f=new (wac_g.$$(wac_vz)),g=new (wac_g.$$(wac_vz));d||e;){var h=d?c.$$cu():null,k=e?b.$$cu():null;if(d&&!h)return wac_b(42530452,324,15,"There's a null ChP in our CharacterPropertiesArray..."),null;if(e&&!k)return wac_b(42530454,324,15,"Attempted to insert a null CHP"),null;h&&k&&h.vb===k.vb?(e=b.$$mn(),g.ga(h)):!k||h&&h.vb<k.vb?(f.ga(h),d=c.$$mn()):(f.ga(k),g.ga(k),e=b.$$mn())}a.OA=f;a.Ye();return g}
wac_OZc.prototype.o5e=wac_5(-224486859,function(a){this.la.sb("OnTranscriberStartedEventId",a)});wac_NZc.prototype.o5e=wac_5(-1501859882,function(a){this.la.sb("OnTranscriberStartedEventId",a)});wac_aW.prototype.o5e=wac_5(-431367398,function(a){this.ob.o5e(a)});wac_OZc.prototype.L4e=wac_5(795979390,function(a){this.la.xa("OnTranscriberStartedEventId",a)});wac_NZc.prototype.L4e=wac_5(2007540861,function(a){this.la.xa("OnTranscriberStartedEventId",a)});wac_aW.prototype.L4e=wac_5(542089145,function(a){this.ob.L4e(a)});
wac_OZc.prototype.n5e=wac_5(-1194181418,function(a){this.la.sb("OnSubtitleUpdatedEventId",a)});wac_NZc.prototype.n5e=wac_5(17380053,function(a){this.la.sb("OnSubtitleUpdatedEventId",a)});wac_aW.prototype.n5e=wac_5(-1448071663,function(a){this.ob.n5e(a)});wac_OZc.prototype.K4e=wac_5(2131997997,function(a){this.la.xa("OnSubtitleUpdatedEventId",a)});wac_NZc.prototype.K4e=wac_5(-1205495922,function(a){this.la.xa("OnSubtitleUpdatedEventId",a)});wac_aW.prototype.K4e=wac_5(-521746990,function(a){this.ob.K4e(a)});
wac_OZc.prototype.c5d=wac_5(1711190907,function(a,b){this.e3e=a;var c=wac_PZc;c.e3e=a;c.le("visible"===c.wLa.style.visibility);wac_TZc(c);a=c.c5e;b=JSON.stringify({livePragueSessionInfo:b});a.jqd&&a.jqd.setCustomSetting("clientMetadata",b);this.e3e&&(this.J&&wac_SZc(this,"visible"===this.J.style.visibility),this.L_c&&!wac_K6(this.Cia)&&(this.J.style.top="0",this.J.style.height="100%"),this.jja.recordSessionStats({metadata:"livebroadcast"}))});
wac_NZc.prototype.c5d=wac_5(614890844,function(a,b){this.$We.Uyf=a;wac_Y(41682758,830,50,"Toggling transcriber's Live Broadcast mode ... On: {toggleOn}");var c;wac_q7(this,(c=new wac_8Zc,c.IsToggleOn=a,c.PragueSessionInfo=b,c));wac_5Zc(this)});wac_aW.prototype.c5d=wac_5(-1864439392,function(a,b){this.ob.c5d(a,b)});wac_pob.prototype.Beb=wac_5(947662998,function(a,b,c,d){a=new wac_aL(new wac_nob(a,b),c,d,function(a){return!a.StatusCode},0,null,null,2);this.AB.d7(a,this.Ca,!1)});
wac_pob.prototype.HG=wac_5(1768140151,function(a,b,c,d,e,f,g,h){a=new wac_aL(new wac_eY(a,b,c,d,e,f),g,h,function(a){return!a.StatusCode},0,null,null,2);this.AB.d7(a,this.Ca,!1)});wac_BX.prototype.Jca=wac_5(-600525999,function(a){var b,c;switch(a){case 22:b=CommonUIStrings.l_ThirdPartyAddinDisabledTitle;c=CommonUIStrings.l_ThirdPartyAddinDisabledMessage;break;default:return}b=this.ME.Db(b,c,null);b.Do(a);b.Lja(1);wac_KP(b,!0);wac_CX(this,b)});
wac_f_.prototype.iD=wac_5(-1869917821,function(){return this.Ao.ej(String,wac_Kua,null)});wac_f_.prototype.wF=wac_5(-192743680,function(){return this.Ao.Za(Number,wac_oua)});wac_Egb.prototype.mef=wac_5(-395969988,function(a){var b;wac_Fgb(this,b={val:this.FAf},30,!0,a);this.FAf=b.val});wac_JS.prototype.y7=wac_5(-414161050,function(){wac_7k()&&wac_CS(wac_KS(this),{DocChat:"ButtonModel"})});wac_MS.prototype.y7=wac_5(-2077628593,function(){this.pK.y7()});wac_JX.prototype.y7=wac_5(680888400,function(){});
wac_40b.prototype.y7=wac_5(-1454752941,function(){this.Mt.y7()});wac_BQ.prototype.RDb=wac_5(1989496113,function(a){wac_AQ.fC(5018263,!!this.hCa,null);Array.add(this.hCa,a);wac_AQ.Ex(5018264,2,"Allow free sending: {0}",a);return!0});wac_rI.prototype.fsa=wac_5(1119380928,function(){return new wac_WN(this.mi(),this.Yc(),this.Gm())});wac_mz.prototype.e9e=wac_5(-92439897,function(a){return this.OA.e9e(a,this)});
wac_oz.prototype.e9e=wac_5(1037004441,function(a,b){if(!b)return wac_b(42530458,324,15,"Attempted to insert CHP(s) without a paragraph"),null;if(this.UWb)return wac_b(42530460,324,15,"Why are we trying to create ChPs on a readonly clone?"),null;if(0<this.OA.Ma()&&this.OA.K(0).Or!==b)return wac_b(42530462,324,15,"Attempted to insert CHP(s) with an incorrect paragraph"),null;var c=new (wac_g.$$(wac_vz)),d=new (wac_g.$$(wac_vz)),e=new (wac_g.$$(Number));e.or(a);e.Sc(function(a,b){return a-b});a=!1;for(e=
e.$$lge();e.$$mn();){var f=e.$$cu();0<c.Ma()&&c.K(c.Ma()-1).vb===f||(c.ga(new wac_vz(b,f)),a||((f=wac_pA(this,f))?d.ga(f):a=!0))}return a?wac_x6c(this,c):d});wac_UJb.prototype.n2e=wac_5(1296755639,function(){});wac_Mg.prototype.n2e=wac_5(1138606533,function(a,b,c,d,e,f){if(this.VDc){var g=this;this.VDc.uc(function(h){h.km(a,b).then(function(a){a||(g.w3d(c,d,e),f&&f(c));return null})})}});wac_.prototype.yOa=wac_5(1557014499,function(){return null});
wac_nM.prototype.yOa=wac_5(-554528132,function(){var a=new wac_Rh;a.iOa="PptJewel.New";a.kyc="PptJewel.New.Blank";a.lyc=ResourceStrings.L_NewBlank;a.myc=ResourceStrings.L_NewBlankDescription;a.ZOa=this.Ob.ed.Io("prt2.png");a.$Oa="prt2_OLKNewButton_32x32x32";a.fV=ResourceStrings.L_New;a.KFb=this.Pi()?this.ftb+"p/":"";return a});wac_.prototype.zOa=wac_5(-1371525569,function(){return null});
wac_nM.prototype.zOa=wac_5(1890129606,function(){var a=new wac_Sh;a.iOa="PptJewel.Open";a.ZOa=this.Ob.ed.Io("prt2.png");a.$Oa="prt2_SaveAsPowerPointPptx_32x32x32";return a});wac_.prototype.qze=wac_5(285984587,function(){return!1});wac_nM.prototype.qze=wac_5(-1840172508,function(){return this.od.Ta.ao});
wac_1f.prototype.BGb=wac_5(-1111067053,function(){var a=1===this.Kb(),b=wac_3ga(wac_hh(),wac_6q)||wac_IYa(wac_hh(),wac_6q,wac_.O8a),c=wac_2g||wac_bf||wac_q(wac_.pa,"ProtectedFile");return!(a&&b)&&!c&&wac_.Vgb});wac_xM.prototype.BGb=wac_5(2041535240,function(){return wac_1f.prototype.BGb.call(this)&&0<wac_II(wac_j().H(wac_Mt))});wac_oN.prototype.BGb=wac_5(-1106878778,function(){return!0});
function wac_y6c(a,b){if(!a.j4e)return null;if(!b)return wac_b(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),null;var c=wac_5k().toString();a.ydf.mc("PowerPointDesigner")||a.ydf.vf("PowerPointDesigner",new (wac_gb.$$(String,Function))(wac_$a()));a.ydf.K("PowerPointDesigner").ga(c,b);wac_b(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",c,"PowerPointDesigner"));
return c}
function wac_z6c(a,b){if(!b)return wac_Y(595140824,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Null or empty speech language code passed in."),null;var c=b.split("-");if(!c.length)return wac_Y(595140822,822,10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage Incorrect speech language code passed in: {0}.",b),null;var c=c[0],d=wac_sEc(a);for(a=wac_vEc(a).$$lge();a.$$mn();){var e=a.$$cu(),e=d[e.toLowerCase()];if(e.startsWith(c))return e}wac_Y(595140820,822,
10,"SubtitleContext::GetClosestTranslationLanguageFromSpeechLanguage No matching translation language code found for speech language code: {0}.",b);return null}function wac_sob(a,b,c,d,e,f,g,h,k,l){b=new wac_aL(new wac_iob(b,c,d,e,f,null,g,h),k,l,function(a){return!a.StatusCode},0,null,null,2);a.AB.d7(b,a.Ca,!1)}function wac_rob(a,b,c,d){b=new wac_aL(new wac_mob(b,c),null,d,function(a){return!a.StatusCode},0,null,null,2);a.AB.d7(b,a.Ca,!1)}
function wac_znc(a,b,c,d,e,f,g,h,k,l,m){b=new wac_aL(new wac_6jc(b,c,d,e,f,g,74,74,h,k),l,m,function(a){return!a.StatusCode},0,null,null,2);a.AB.d7(b,a.Ca,!1)}function wac_A6c(a,b,c,d,e,f){b=new wac_aL(new wac_zYc(b,c,d,!0),e,f,function(a){return!a.StatusCode},0,null,null,2);a.AB.d7(b,a.Ca,!1)}function wac_bHc(a,b){a.hid=b}function wac_dvc(a,b){a.la.wa("IC",b,null)}function wac_Bnc(a){a.la.wa("AROSBSR",Sys.EventArgs.Empty,null)}function wac_Cnc(a){a.la.wa("AROSASR",Sys.EventArgs.Empty,null)}
function wac_Dnc(a,b){a=wac_fO(a,b.yaa);a:{b=b.n7b;if(a&&b){var c=wac_X(a),d;for(d=c.mb(37);d;d=c.ge(37))if((d=window.$$as(wac_HH,d))&&b.Ka(d.Gm())){b=d;break a}}b=null}return b||a}function wac_fvc(a,b){wac_v(a,wac_ltb,b)}function wac_KBb(a,b,c,d,e){wac_v(a,wac_wq,!0);wac_v(a,wac_Uq,!0);wac_v(a,wac_wua,b);c&&wac_v(a,wac_Pq,c);d&&wac_v(a,wac_vnb,d);e&&wac_v(a,wac_wnb,e)}
function wac_B6c(a,b,c,d,e,f,g){var h=new wac_ME("ClosePopWacSessionSync");wac_NE(h,null);wac_OE(h,new wac_PE("popSessionID",a));wac_OE(h,new wac_PE("podSessionID",b));wac_OE(h,new wac_PE("presentationID",c));wac_OE(h,new wac_PE("podUrl",d));wac_OE(h,new wac_PE("podInstance",e));wac_OE(h,new wac_PE("fTimeoutOrUserClose",!1));wac_OE(h,new wac_PE("forceHardClose",!0));wac_LE.pr(h,f,g,null,null,null,2)}
function wac_C6c(a,b,c,d){var e;a=(e=new wac_Dua,e.PresentationID=a,e.VersionID=b,e);e=new wac_ME("RestoreFileVersion");wac_NE(e,null);wac_OE(e,new wac_PE("restoreVersionParams",a));wac_LE.pr(e,c,d,null,null,null,2)}function wac_DCb(a){return!a.uka&&a.gva}function wac_LO(a,b,c){a.E0b[b.toString()]=c}function wac_D6c(a,b){for(var c=0;c<a.na();c++)if(!b||b(a.K(c)))return!0;return!1}var wac_E6c=!0,wac_uDb=null;
function wac_F6c(){if(!wac_E6c)return null;var a=null;try{a=localStorage}catch(b){wac_E6c=!1,a=null}return a}
function wac_$Cb(a,b,c){wac_v(a,wac_Dqa,b.targetType===window.OSF.OsfControlTarget.InContent);wac_v(a,wac_Xo,b.id);wac_v(a,wac_Eqa,b.appVersion);wac_v(a,wac_Fqa,b.storeId);wac_v(a,wac_Gqa,b.currentStoreType);wac_v(a,wac_oua,c.tFb(b.currentStoreType));b.assetId&&wac_v(a,wac_pua,b.assetId);wac_v(a,wac_qua,b.assetStoreId);wac_Wb(b.isAddinCommands)?wac_v(a,wac_fua,!1):wac_v(a,wac_fua,b.isAddinCommands);b.targetType===window.OSF.OsfControlTarget.InContent&&(wac_v(a,wac_rq,!0),c=b.height?b.height:200,wac_v(a,
wac_En,b.width?b.width:200),wac_v(a,wac_Fn,c))}var wac_dDb={};function wac_fDb(a,b,c,d,e){return String.format("{0}|{1}|{2}|{3}|{4}",a.toLowerCase(),b,c.toLowerCase(),d.toLowerCase(),e.toLowerCase())}function wac_hDb(a,b,c,d){if(!a)throw Error.argumentNull("formatInfo");var e=a.SlideHeight;c.val=a.SlideWidth;d.val=e;a=c.val/d.val;a!==b&&(a>b?c.val=Math.round(d.val*b):d.val=Math.round(c.val/b))}
function wac_G6c(a,b){var c=null;try{var d=wac_F6c();if(!wac_Wb(d)&&d)var e=a+"_"+wac_uDb+"_"+wac_Nf(wac_.J0)+"_"+b,c=d.getItem(e);else wac_b(42074645,220,50,"AddInCommands.Error:TryGetAddinCommandsCache, Storage.Local null")}catch(f){wac_b(42074646,220,10,"Failed to get AddinCommands Cache {0} for ProviderType {1}.",a,b)}return c}function wac_Enc(a,b){if(!a||!b)return!a&&!b;var c;c=a.n7b&&b.n7b?a.n7b.Ka(b.n7b):!a.n7b&&!b.n7b;return wac_$xb(a.mg,b.mg)&&a.yaa===b.yaa&&c}
function wac_eEb(a){var b=[],c;for(c in a)Array.add(b,a[c]);return b}function wac_H6c(){switch(wac_r().Hd().Nv()){case 3:return"OfficeOnlineWord";case 1:return"OfficeOnlineExcel";case 2:return"OfficeOnlinePowerPoint";case 4:return"OfficeOnlineOneNote";default:return null}}
function wac_I6c(a,b,c){try{var d=wac_F6c();if(!wac_Wb(d)&&d){var e=a+"_"+wac_uDb+"_"+wac_Nf(wac_.J0)+"_"+c;d.setItem(e,b)}else wac_b(42074647,220,50,"AddInCommands.Error:TrySetAddinCommandsCache, Storage.Local null")}catch(f){wac_b(42074648,220,10,"Failed to set AddinCommands Cache {0} for ProviderType {1}.",a,c)}}function wac_iEb(){return"ack3_"+wac_uDb+"_"+wac_Nf(wac_.J0)+"_"}
function wac_gvc(a){try{window.Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(a)}catch(b){}}function wac_hvc(a){try{window.Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(a)}catch(b){}}function wac_Q1(){return!!wac_r()&&!!wac_r().Hd()&&4===wac_r().Hd().Nv()||wac_.jEb||wac_.hJb&&wac_.iEb&&wac_q(wac_.pa,"InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled")&&wac__g&&!wac_.LIb}
function wac_J6c(a){var b=new Sys.StringBuilder,c=a.Exceptions;if(c&&0<c.length){a=c.length;for(var d=0;d<a;++d)b.appendLine(c[d].message)}else b.append(a.message);return b.toString()}Type.registerNamespace("Common.App.AddinCommands");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.Nwd=wac_d.Qa.Nwd||{};function wac_fIb(){}wac_fIb.registerInterface("Common.App.AddinCommands.IAddinCommandsInitializer");function wac_gIb(a,b,c){this.zka=c;this.AKa=a;this.Tf=b}
wac_gIb.prototype={Tf:null,zka:0,AKa:null,MCc:function(a){var b=null;this.Tf&&(b=this.Tf.uj("ComponentAttach",wac_d.Xwa.toString(a)+wac_d.yla.toString(this.zka)));if(null==this.tQb(a)?0:this.tQb(a)){var c=(new Date).getTime()-2592E5;this.AKa(a,this.zka,{ak0:c})}b&&b.vg()}};function wac_hIb(a,b){wac_hIb.initializeBase(this,[a,b,5])}wac_hIb.prototype={tQb:function(){return!0}};function wac_iIb(a,b,c){this.zka=2;this.AKa=a;this.Rtc=b;this.Pja=c}
wac_iIb.prototype={Pja:null,zka:0,Rtc:null,AKa:null,MCc:function(a){if(wac_.pa&&wac_q(wac_.pa,"AgaveSupportsLiveIdSpoofing")){var b=(new Date).getTime();this.AKa(a,this.zka,{ak0:b})}else if(window.parseInt(wac_G6c("ak2",a)||"-1")<=(new Date).getTime()){var b=wac_r().Hd().jO(),b=String.format(b+"AddinServiceHandler.ashx?action={0}&app={1}&lc={2}&{3}","laststoreupdate",wac_r().Hd().Nv(),this.Rtc,wac_.eo),c=wac_.Af,d=null;this.Pja&&(d=this.Pja.uj("ComponentAttach",wac_d.Xwa.toString(a)+wac_d.yla.toString(this.zka)));
var e=this;c.lk(b,1,null,null,!0,4,function(b){if((b=b.Aa.Be)&&""!==b&&(b=window.Sys.Net.XMLDOM(b))){wac_I6c("ak2",((new Date).getTime()+144E5).toString(),a);var c=b.getElementsByTagName("update");c&&c.length||(c=b.getElementsByTagName("o:update"));c&&0<c.length&&(b=Date.parse(c[0].firstChild.nodeValue),(window.parseInt(wac_G6c("ak0",a)||"-1")<b||Boolean.parse(wac_G6c("ak4",a)||"false"))&&e.AKa(a,e.zka,{ak0:b}))}d&&d.vg()},function(a){wac_b(17438153,220,50,"GetLastUpdate request failed with {0}.",
a.Aa.ho);d&&d.vg()},null,null,!1,null,null,null,null,!1,null,!1,null)}else Boolean.parse(wac_G6c("ak4",a)||"false")&&(b=window.parseInt(wac_G6c("ak0",a)||"-1"),this.AKa(a,this.zka,{ak0:b}))}};function wac_jIb(a,b){wac_jIb.initializeBase(this,[a,b,1])}wac_jIb.prototype={tQb:function(a){try{var b=wac_iEb()+a;return Boolean.parse(wac_kIb(b)||"false")}catch(c){wac_b(17306844,220,50,"LocalStorage is not allowed, {0}.",c.toString())}return null}};
function wac_kIb(a){var b=localStorage;return wac_Wb(b)||null===b?null:b.getItem(a)}function wac_lIb(a){this.Cwb=Function.createDelegate(this,this.M_d);this.Pja=a}wac_lIb.prototype={Pja:null,M_d:function(a,b,c){c&&c.ak0&&(c.ack1=a,c.ack0=b,this.aj.$k().Wj(1782110672,2,c,null),wac_I6c("ak0",c.ak0.toString(),a))}};
function wac_K6c(a,b){var c=null;switch(b){case 1:c=new wac_jIb(a.Cwb,a.Pja);break;case 2:c=new wac_iIb(a.Cwb,wac_nm(wac_.vh)._name,a.Pja);break;case 5:c=new wac_hIb(a.Cwb,a.Pja)}return c}
function wac_L6c(){var a=wac_j().H(wac_J2b),b=a.yHb();if(b)if(wac_.pa&&wac_q(wac_.pa,"OcpsIsEnabled"))wac_l(wac_j(),wac_sb).uc(function(c){c.km("ConnectedServices",!0).then(function(c){for(var d=b.$$ge();d.$$mn();){var e=d.$$cu();if(c||e.rh()){var f=wac_K6c(a,e.ma());f&&f.MCc(e.rh())}}return null})});else for(var c=b.$$ge();c.$$mn();){var d=c.$$cu(),e=wac_K6c(a,d.ma());e&&e.MCc(d.rh())}}wac_gIb.registerClass("Common.App.AddinCommands.AddinCommandsInitializerBase",null,wac_fIb);
wac_hIb.registerClass("Common.App.AddinCommands.AddinCommandsInitializer",wac_gIb);wac_iIb.registerClass("Common.App.AddinCommands.AddinCommandsAnonymousAPIInitializer",null,wac_fIb);wac_jIb.registerClass("Common.App.AddinCommands.AddinCommandsLocalCacheInitializer",wac_gIb);wac_lIb.registerClass("Common.App.AddinCommands.AddinCommandsInitializerHost");Type.registerNamespace("Common.App.AppsForOffice");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.Zwa=wac_d.Qa.Zwa||{};
function wac_ebc(){}wac_ebc.registerInterface("Common.App.AppsForOffice.IAddinNativeActionManager");function wac_fbc(){}wac_fbc.registerInterface("Common.App.AppsForOffice.IAddinNativeAction");function wac_gbc(){}wac_gbc.registerInterface("Common.App.AppsForOffice.IAddinNativeActionHost");function wac_hbc(){}wac_hbc.registerInterface("Common.App.AppsForOffice.IAddinCommandsRuntimeMananger");function wac_ibc(){}wac_ibc.registerInterface("Common.App.AppsForOffice.IAppsForOfficeSingleSignOnManager");
function wac_jbc(){}wac_jbc.registerInterface("Common.App.AppsForOffice.IAccessTokenInformation");function wac_kbc(){}wac_kbc.registerInterface("Common.App.AppsForOffice.IAppsForOfficeDialogManager");function wac_k$(a,b,c){this.Ab=a;this.oxb=b;this.bkc=c;this.kzb=window.OfficeExt.CommandInvokeMode.Default}wac_k$.prototype={Ab:0,oxb:null,bkc:null,kzb:0,uc:function(a,b,c){c=c||{};c.commandMode=this.kzb;var d=this;wac_lbc(this.oxb,this.bkc,c,function(b,c){a.XAc(d.Ab,d.oxb,b,c)})}};
function wac_mbc(){}wac_mbc.prototype={};function wac_nbc(){return window.OfficeExt.AddinNativeActionRuntimeManager.getInstance()}function wac_obc(a,b){var c=null;switch(a){case 1:c=new wac_pbc(b,wac_nbc().getNativeActionName(a));break;case 2:c=new wac_k$(2,b,wac_nbc().getNativeActionName(a));break;case 3:c=new wac_k$(3,b,wac_nbc().getNativeActionName(a))}return c}function wac_pbc(a,b){wac_pbc.initializeBase(this,[1,a,b]);this.kzb=window.OfficeExt.CommandInvokeMode.ExclusiveForNew}
function wac_qbc(){}function wac_rbc(){wac_sbc||(wac_sbc=new wac_qbc);return wac_sbc}wac_qbc.prototype={};function wac_lbc(a,b,c,d){window.OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(a,b,c,d)}function wac_tbc(a,b,c){this.Ra=new wac_Re;wac_tbc.initializeBase(this,[!1,!1,!1,!1]);wac_Nh(this,5);this._id=this.Gib=c;this.KUb=a;this.HUb=b}
wac_tbc.prototype={j2:null,h1b:"WACDialogTitleText",sBa:"0",cib:"15px",i6d:"0px",Voa:"calc(100% - 30px)",g6d:"100%",KUb:0,HUb:0,Gib:null,hQc:0,In:function(){wac__m.prototype.In.call(this);this.AC.style.width="100%";this.AC.style.height=this.qVa?this.Voa:this.g6d;this.AC.style.marginTop=this.qVa?this.cib:this.i6d;this.AC.style.padding=this.sBa},qu:function(){wac__m.prototype.qu.call(this);this.Rb.style.width=String.format("{0}px",this.KUb*window.innerWidth/100);this.Rb.style.height=String.format("{0}px",
this.HUb*window.innerHeight/100);this.Rb.style.minWidth="0px";this.j2=document.getElementById(this.Rf(this.h1b));this.j2.style.position="absolute";this.j2.style.whiteSpace="nowrap";this.j2.style.textOverflow="ellipsis";wac_Ag?(this.j2.style.right="14px",this.j2.style.left="44px"):(this.j2.style.right="44px",this.j2.style.left="14px")},hea:function(a){wac__m.prototype.hea.call(this,a);this.j2&&this.j2.setAttribute("title",a)},ICc:function(){this.Rb.style.width=String.format("{0}px",this.KUb*window.innerWidth/
100);this.Rb.style.height=String.format("{0}px",this.HUb*window.innerHeight/100);this.Rb.style.overflowY="hidden";this.Rb.style.overflowX="hidden";this.Rb.style.marginTop="";this.Rb.style.top="";wac_pd()&&wac_Ag?(this.Rb.style.right="",this.Rb.style.marginRight=""):(this.Rb.style.left="",this.Rb.style.marginLeft="")},fd:function(){wac_obc(3,this.Gib).uc(this,wac_rbc(),{});var a=this;this.hQc=window.setTimeout(function(){a.Ra.wa("OnDialogClosedEventKey",a.Gib,null);wac_0m.prototype.fd.call(a)},500)},
XAc:function(a){3===a&&(window.clearTimeout(this.hQc),this.Ra.wa("OnDialogClosedEventKey",this.Gib,null),wac_0m.prototype.fd.call(this))}};window.Common.App.AppsForOffice.AppsForOfficeDialogManager=wac_d.Qa.Zwa.a9a=function(a){this.sgd=Function.createDelegate(this,this.bPd);this.Ra=new wac_Re;this.Tq=a};
window.Common.App.AppsForOffice.AppsForOfficeDialogManager.getInstance=function(a){window.Common.App.AppsForOffice.AppsForOfficeDialogManager.Xf||(window.Common.App.AppsForOffice.AppsForOfficeDialogManager.Xf=new window.Common.App.AppsForOffice.AppsForOfficeDialogManager(a));return window.Common.App.AppsForOffice.AppsForOfficeDialogManager.Xf};
wac_d.Qa.Zwa.a9a.prototype={Tq:null,Hm:function(a,b,c,d){if(window.Common.App.AppsForOffice.AppsForOfficeDialogManager.M7.mc(b))wac_b(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),c(window.OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{var e=wac_Hd(a),f=e.url;if(this.Tq.getOsfControl(b).checkAppDomains(f)){var g=new wac_ubc;g.pA=e.width;g.zva=e.height;g.FBb=f;g.cud=e.displayInIframe;g.Alc=e.hideTitle;g.LD=b;g.JP=wac_5k().toString();wac_b(18371103,
344,50,"ShowDialog: asset id {0}, url hash code {1}",this.Tq.getOsfControl(b).getMarketplaceID(),wac_Nf(g.FBb));var h=new wac_vbc;h.JP=g.JP;var k=this.Tq.getOsfControl(g.LD).getManifest().getDefaultDisplayName(),l=this.Tq.getOsfControl(g.LD).getStoreType().toLowerCase();a=null;a=4===wac_r().Hd().Nv()&&"hardcodedpreinstall"===l&&g.Alc?this.createAndShowAppsForOfficeDialog(g.pA,g.zva,g.JP,!0,k):this.createAndShowAppsForOfficeDialog(g.pA,g.zva,g.JP,!1,k);var m=this.Tq.getOsfControl(g.LD).getManifest(),
n=g.JP,p=g.FBb,l={};l.id=n;l.marketplaceID=n;l.marketplaceVersion=m.getMarketplaceVersion();l.appDomains=m.getAppDomains();l.store="developer";l.storeType=window.OSF.StoreType.InMemory;l.dialogUrl=p;l.osfControlType=window.OSF.OsfControlTarget.TaskPane;l.agaveName=k;l.div=a.AC;this.Tq.insertDialogControl(l);a.Ra.xa("OnDialogClosedEventKey",this.sgd);h.$5a=a;window.Common.App.AppsForOffice.AppsForOfficeDialogManager.M7.vf(g.LD,h);d&&d(l);c(window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else wac_b(19940611,
344,10,"ShowDialog: dialog url not in app domains list."),c(window.OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch(q){wac_b(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",q.message),c(window.OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}},Dx:function(a,b){if(window.Common.App.AppsForOffice.AppsForOfficeDialogManager.M7.mc(a)&&(a=window.Common.App.AppsForOffice.AppsForOfficeDialogManager.M7.K(a),a.$5a))try{this.Ra.wa("OnMessageDialogEventKey",new wac_M6c(a.JP,
window.OSF.DialogMessageType.DialogParentMessageReceived,b),null)}catch(c){wac_b(20289179,344,10,"SendMessage: action failed. Exception message: {0}",c.message)}},sma:function(a){for(var b=null,c=window.Common.App.AppsForOffice.AppsForOfficeDialogManager.M7.GetEnumerator();c.$$mn();){var d=c.$$cu();if(d.ma().JP===a){b=d.rh();break}}return b},bPd:function(a,b){if(a=this.sma(b))this.Tq.purgeDialogControl(b),window.Common.App.AppsForOffice.AppsForOfficeDialogManager.M7.Rc(a),this.Ra.wa("OnMessageParentEventKey",
new wac_l$(a,window.OSF.DialogMessageType.DialogClosed,null),null)}};wac_d.Qa.Zwa.a9a.prototype.P8d=function(a,b,c,d,e){a=new wac_tbc(a,b,c);e=d?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,e);d&&(a.qVa=!1,a.wr=!1);a.Zp(e,null,null);a.Xfa=null;return a};wac_d.Qa.Zwa.a9a.prototype.createAndShowAppsForOfficeDialog=wac_d.Qa.Zwa.a9a.prototype.P8d;function wac_xbc(){wac_xbc.initializeBase(this,[!1,!1,!1,!1]);wac_Nh(this,5);this._id="AppsForOfficeInsertionDialog"}
wac_xbc.prototype={d1:null,h6d:"WACDialogBodyPanel",WTa:"695px",Voa:"calc(100% - 46px)",cib:"15px",sBa:"0",t6d:"WACDialogPanel",ppa:695,u6d:462,yUa:"80%",In:function(){wac__m.prototype.In.call(this);this.d1=document.getElementById(this.h6d);this.d1.style.width=this.WTa;this.d1.style.height=this.Voa;this.d1.style.marginTop=this.cib;this.d1.style.padding=this.sBa},Pda:function(){this.d1&&(this.d1.style.width=this.WTa,this.d1.style.height=this.Voa,this.d1.style.marginTop=this.cib,this.d1.style.padding=
this.sBa,this.ppa>wac_4m()?(this.Rb.style.width=String.format("{0}px",wac_4m()),this.Rb.style.overflowX="scroll",this.Rb.style.left="0"):(this.Rb.style.width=String.format("{0}px",this.ppa),this.Rb.style.overflowX="hidden"),this.Rb.offsetHeight>wac_2m()||this.u6d+50>wac_2m()?(this.Rb.style.height=String.format("{0}px",wac_2m()),this.Rb.style.overflowY="scroll",this.Rb.style.top="0",this.Rb.style.left="0",this.Rb.style.marginTop="-48px"):(this.Rb.style.overflowY="hidden",this.Rb.style.top="10%",this.Rb.style.height=
this.yUa),this.HMa())},HMa:function(){if(this.Rb){var a=this.Rb.style.zIndex;this.Rb.style.zIndex=-9999;if(this.ppa>wac_4m())wac_pd()&&wac_Ag?this.Rb.style.marginRight="0":this.Rb.style.marginLeft="0";else{var b=String.format("{0}px",Math.floor(-this.Rb.offsetWidth/2));wac_pd()&&wac_Ag?this.Rb.style.marginRight=b:this.Rb.style.marginLeft=b;wac_pd()&&wac_Ag?this.Rb.style.right="50%":this.Rb.style.left="50%"}this.Rb.style.zIndex=a}else wac_b(19976784,306,10,"_divMessageBox is null in CenterDialog()")},
qu:function(){wac__m.prototype.qu.call(this);var a=document.getElementById(this.Rf(this.t6d));a.style.width=String.format("{0}px",this.ppa);a.style.height=this.yUa}};function wac_ybc(){}wac_ybc.prototype={gjc:null,w2b:function(){return this.gjc},M5a:0};function wac_zbc(){}wac_zbc.prototype={wI:null,dG:null,M5a:0,jud:null};
function wac_Abc(a,b){this.sjd=Function.createDelegate(this,this.kSd);this.rjd=Function.createDelegate(this,this.jSd);this.kEa=new (wac_rb.$$(wac_Wa));this.d7e=new (wac_rb.$$(Number));this.Lff=new (wac_rb.$$(Number));this.URc=new (wac_rb.$$(wac_Wa));this.Tq=a;this.EW=b;this.EW.vtb("PostAccessToken");this.EW.vtb("PostPrimaryIdentityInfo");this.EW.Kzd("PostAccessToken",this.rjd);this.EW.Kzd("PostPrimaryIdentityInfo",this.sjd);this.jX=wac_r().Bz()}
wac_Abc.prototype={Tq:null,EW:null,jX:null,nie:function(a,b,c,d,e,f,g){try{var h=!!c&&""!==c,k=-1;this.d7e&&(this.d7e.vf(a,wac_N6c()),k=this.d7e.K(a));var l=this.Tq.getOsfControl(a),m=l.getStoreType()||"",n=l.getOwnerAddinStoreType()||"",p=l.getMarketplaceID()||"",q=l.getMarketplaceVersion()||"",m=m.toLowerCase(),n=n.toLowerCase(),p=p.toLowerCase(),r=wac_Jh(b,1)||"",t=wac_Jh(l.getIframeUrl(),1)||"",v=r.toLowerCase()===t.toLowerCase(),u={callInstanceId:k.toString(),controlId:a.toString(),controlAssetId:p.toString(),
controlVersion:q.toString(),storeType:m.toString(),ownerStoreType:n.toString(),allowConsentPrompt:d.toString(),forMSGraphAccess:e.toString(),hasAddinAuthChallenge:h.toString(),securityOriginEqualsSourceLocation:v.toString()};wac_b(51401115,344,50,"{0}",u);var w;wac_xra((w=new wac_hca,w.name="Office.Online.Extensibility.SSO.GetAccessTokenV2Start",w.dataFields=wac_eDb(u),w));if(wac_m$.mc(a))this.j5c(),wac_b(22402394,344,100,"GetAccessToken: addinCallbackMap already has the callback info for this addin."),
wac_O6c(this,a,f,window.OSF.DDA.ErrorCodeManager.errorCodes.ooeAddinIsAlreadyRequestingToken,null);else{var x=l.getManifest().isSSOAddin(),z=this.Tq.getOsfControl(a).isFirstParty(),y;if(this.Tq._enableFirstPartySSOResourceCheck){for(var h=!1,A=this.Tq.getOsfControl(a).getManifest().getWebApplicationResource().split(","),B=A.length,k=0;k<B;++k)if(A[k].trim()===g){h=!0;break}y=h}else y=!0;if(z&&!y)wac_b(36827535,344,10,"GetAccessToken: Specified resource not allowed for first party SSO."),wac_O6c(this,
a,f,window.OSF.DDA.ErrorCodeManager.errorCodes.ooeResourceNotAllowed,null);else{if(x){A=!0;B=m;m===window.OSF.StoreType.InMemory&&(B=n);B===window.OSF.StoreType.OMEX&&(A=!1);if(e&&!A){wac_b(51234570,344,10,"GetAccessToken: Store add-ins do not support tokens for graph access.");wac_O6c(this,a,f,window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null);return}e&&B===window.OSF.StoreType.Exchange&&(d=!1)}if(x||z&&y){var C=g?g:this.Tq.getOsfControl(a).getManifest().getWebApplicationResource().split(",")[0],
F=wac_Jh(C,1),D=wac_Jh(b,1),G=this.Tq.getOsfControl(a).isFirstParty();if(G||F&&D)if(G||F.toLowerCase()===D.toLowerCase()){wac_m$.vf(a,f);b={};b.AddinControlId=a;b.AddinApplicationResource=C;b.AddinSSOAuthChallenge=c;b.AddinIsFirstParty=G;b.AllowConsentPrompt=d;if(this.jX){c=a+"GetAccessToken";var H=this.jX.uj("ComponentAttach",c);this.kEa.vf(c,H)}this.Lff&&this.Lff.vf(a,this.d7e.K(a));this.EW.Dx("GetAccessToken",b,"")}else F.toLowerCase()===D.toLowerCase()||G?(wac_b(36292512,344,10,"GetAccessToken: current Addin is not a first party Addin."),
wac_O6c(this,a,f,window.OSF.DDA.ErrorCodeManager.errorCodes.ooeAccessDenied,null)):(wac_b(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),wac_O6c(this,a,f,window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null));else F||wac_b(594118746,344,10,"Invalid resource URL for SSO."),D||wac_b(594118745,344,10,"Invalid page URL for SSO."),wac_O6c(this,a,f,window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null)}else wac_b(22402395,
344,10,"GetAccessToken: current Addin is not a SSO Addin."),wac_O6c(this,a,f,window.OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null)}}}catch(J){this.j5c(),wac_b(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",J.message),wac_O6c(this,a,f,window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null)}},jSd:function(a){try{var b=a.Values.AddinControlId,c=a.Values.AccessToken,d=a.Values.HostApplicationType,e=b+"GetAccessToken",f,g,h;if(h=this.kEa.qg(e,g={val:f}),f=
g.val,h)f.vg(),this.kEa.Rc(e);e=0;if(!c||"undefined"===typeof c||!c.length){var k=a.Values.HostApplicationType,l=a.Values.AddinSSOError;wac_b(23859717,344,10,"MapErrorMessageToErrorCode: host application type: {0}, error message: {1}",k,l);var m=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;if(k&&"onedrivewopi"===k.toLowerCase())"login_required"===l?m=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:"13002"===l||"access_denied"===l?m=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:
"consent_required"===l&&(m=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant);else if(-1<l.indexOf("AADSTS50058"))m=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;else if(-1<l.indexOf("Popup Window is null"))m=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;else if(-1<l.indexOf("AADSTS50001"))m=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;else if(-1<l.indexOf("13002")||-1<l.indexOf("AADSTS65004")||-1<l.indexOf("Popup Window closed"))m=
window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;else if(-1<l.indexOf("AADSTS70011")||-1<l.indexOf("AADSTS65001"))m=window.OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;e=m}var n=wac_m$.K(b);wac_m$.Rc(b);var p=new wac_ybc;p.gjc=c;p.M5a=d;wac_O6c(this,b,n,e,p)}catch(q){this.j5c(),wac_b(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",q.message)}},kSd:function(a){try{var b=a.Values.AddinControlId+"GetPrimaryIdentityInfo",c,d,e;if(e=this.URc.qg(b,d={val:c}),c=
d.val,e)c.vg(),this.URc.Rc(b);var f=new wac_zbc;f.wI=a.Values.UserEmail;f.dG=a.Values.UserName;f.jud=a.Values.FederationProvider;switch(a.Values.HostApplicationType){case "OnedriveWOPI":f.M5a=1;break;default:f.M5a=0}var g=wac_m$.K(b);wac_m$.Rc(b);g(0,f)}catch(h){this.j5c(),wac_b(36766039,344,10,"ReceivedPrimaryIdentityInfoHandler: exception message: {0}",h.message)}},j5c:function(){wac_b(39068820,344,50,"Browser information: {0}",{UserAgent:window.navigator.userAgent})}};
function wac_N6c(){try{if(window.performance&&window.performance.now)return window.performance.now()}catch(a){}return Date.now()}function wac_O6c(a,b,c,d,e){var f=-1,g=0;a.d7e&&(f=a.d7e.K(b));e&&a.Lff&&(f=a.Lff.K(b));0<f&&(g=wac_N6c()-f);a={callInstanceId:f.toString(),controlId:b.toString(),callDuration:g.toString(),errorCode:d.toString()};wac_b(51401116,344,50,"{0}",a);var h;wac_xra((h=new wac_hca,h.name="Office.Online.Extensibility.SSO.GetAccessTokenV2End",h.dataFields=wac_eDb(a),h));c(d,e)}
function wac_vbc(){}wac_vbc.prototype={JP:null,$5a:null};function wac_ubc(){}wac_ubc.prototype={pA:0,zva:0,FBb:null,LD:null,JP:null,cud:!1,Alc:!1};function wac_l$(a,b,c){wac_l$.initializeBase(this);this.LD=a;this.iBb=b;this.vpc=c}wac_l$.prototype={LD:null,iBb:0,vpc:null};function wac_M6c(a,b,c){wac_M6c.initializeBase(this);this.LD=a;this.iBb=b;this.vpc=c}wac_M6c.prototype={LD:null,iBb:0,vpc:null};function wac_n$(a){this.Du=a}wac_n$.prototype={Du:null};
function wac_Fbc(a,b,c,d){var e=new wac_nh("AuthenticationProxyHandler.aspx");wac_oh(e,"responseType",b);wac_Wg(e.Qja);a=String.format("{0}{1}&{2}",a.Du,e.toString(),wac_.eo);e=document.createElement("iframe");e.setAttribute("id","privateCatalogIframe");e.setAttribute("name","privateCatalogIframe");e.setAttribute("style","display: none");wac_$a().Ka(b,"signinurl")||e.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");new wac_Gbc(e,c,d);e.setAttribute("src",
a);document.body.appendChild(e)}wac_n$.prototype.Nbe=function(a,b){wac_Fbc(this,"identitytoken",function(){a()},b)};wac_n$.prototype.tryAuthenticate=wac_n$.prototype.Nbe;wac_n$.prototype.Obe=function(a,b){wac_Fbc(this,"authcode",a,b)};wac_n$.prototype.tryAuthorize=wac_n$.prototype.Obe;wac_n$.prototype.G9d=function(a,b){wac_Fbc(this,"signinurl",a,b)};wac_n$.prototype.getSignInUrl=wac_n$.prototype.G9d;wac_n$.prototype.Ibe=function(a,b){wac_Fbc(this,"signout",a,b)};wac_n$.prototype.signOut=wac_n$.prototype.Ibe;
function wac_Gbc(a,b,c){this.cdc=Function.createDelegate(this,this.uId);this.upb=a;this.K4c=b;this.J4c=c;window.$addHandler(window,"message",this.cdc)}
wac_Gbc.prototype={K4c:null,J4c:null,upb:null,uId:function(a){try{if(wac_q(wac_.pa,"AuthenticationProxySandboxIsEnabled"))if(a&&a.rawEvent&&a.rawEvent.origin&&this.upb&&this.upb.id){var b=wac_P6c(a.rawEvent.origin),c=wac_P6c(document.domain);if(!wac_$a().Ka(c,b)){wac_b(51451613,344,15,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.");return}if(!(a.rawEvent.source&&a.rawEvent.source.frameElement&&a.rawEvent.source.frameElement.id&&wac_$a().Ka(a.rawEvent.source.frameElement.id,
this.upb.id))){wac_b(51451614,344,15,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");return}}else{wac_b(51418200,344,15,"AuthenticationProxy ResponseHandler skipped processing for event.");return}b=null;try{b=JSON.parse(a.rawEvent.data)}catch(d){wac_b(39112971,344,15,"AuthenticationProxy.HandleResponse: Exception when calling Json.Parse on domEvent.RawEvent.Data: {0}",d.message)}b&&200===b.statusCode?(wac_b(23705827,344,100,"Received response from authentication proxy."),
this.K4c(b.authorizationCode?b.authorizationCode:b.signInUrl)):(wac_b(23707648,344,50,"Authentication proxy returned a result but the operation failed."),this.J4c());window.$removeHandler(window,"message",this.cdc);this.upb?document.body.contains(this.upb)?document.body.removeChild(this.upb):wac_b(24978499,344,15,"The iframe is not a child of Body."):wac_b(24978500,344,15,"The iframe is null.")}catch(d){wac_b(23707649,344,15,"Exception in authentication proxy message handler: {0}.",d.message)}}};
function wac_P6c(a){var b="";try{a&&(b=-1<a.indexOf("//")?a.split("/")[2]:a.split("/")[0])&&(b=b.split(":")[0],b=b.split("?")[0])}catch(c){wac_b(51451615,344,15,"Failed to parse host name from url: {0}",c.message)}return b}function wac_o$(){}wac_o$.prototype={AA:function(a,b,c,d){wac_p$(a,b,null,c,d,!1)}};
function wac_p$(a,b,c,d,e,f){var g=new wac_nh("AddinServiceHandler.ashx");wac_oh(g,"action",a);wac_oh(g,"app",wac_d.Xya.toString(wac_r().Hd().Nv()));for(b=b.$$ge();b.$$mn();){var h=b.$$cu();wac_oh(g,h.rh(),h.ma())}b=wac_r().Hd().jO();g=String.format("{0}{1}&{2}",b,g.toString(),wac_.eo);wac_.Af.lk(g,d,c,null,!1,2,function(a){var b=null;a&&a.Aa&&(a.Aa.ti["X-BlockedForMinor"]&&"1"===a.Aa.ti["X-BlockedForMinor"].toString()&&(a.Aa.ho=451),b=a.Aa.Be);e(a.Aa.ho,b)},function(a){var b=null;f&&a&&a.Aa&&a.Aa.Be&&
(b=a.Aa.Be);e(a.Aa.ho,b);wac_b(18392345,220,50,"S2S web request failed with {0}.",a.Aa.ho)},null,null,!1,null,null,"AddinServiceHandler_"+a,null,!1,null,!1,null)}wac_o$.prototype.K9d=function(a,b){var c;a=(c=new (wac_g.$$(wac_fb)),c.ga(new wac_fb("corr",a)),c);this.AA("getUserId",a,1,b)};wac_o$.prototype.getUserId=wac_o$.prototype.K9d;wac_o$.prototype.w9d=function(a,b,c){var d;a=(d=new (wac_g.$$(wac_fb)),d.ga(new wac_fb("lc",a)),d.ga(new wac_fb("corr",b)),d);this.AA("laststoreupdate",a,1,c)};
wac_o$.prototype.getLastStoreUpdate=wac_o$.prototype.w9d;wac_o$.prototype.q9d=function(a,b,c,d){var e;a=(e=new (wac_g.$$(wac_fb)),e.ga(new wac_fb("av",b)),e.ga(new wac_fb("corr",c)),e);this.AA("getEntitlements",a,1,d)};wac_o$.prototype.getEntitlement=wac_o$.prototype.q9d;
wac_o$.prototype.p9d=function(a,b,c,d,e,f){var g;a=(g=new (wac_g.$$(wac_fb)),g.ga(new wac_fb("cmu",a)),g.ga(new wac_fb("cmf",b)),g.ga(new wac_fb("assetid",c)),g.ga(new wac_fb("expver",d)),g.ga(new wac_fb("corr",e)),g);this.AA("getEToken",a,1,f)};wac_o$.prototype.getEToken=wac_o$.prototype.p9d;wac_o$.prototype.y9d=function(a,b,c,d){var e;a=(e=new (wac_g.$$(wac_fb)),e.ga(new wac_fb("cmu",a)),e.ga(new wac_fb("assetid",b)),e.ga(new wac_fb("corr",c)),e);this.AA("getManifest",a,1,d)};
wac_o$.prototype.getManifest=wac_o$.prototype.y9d;wac_o$.prototype.g9d=function(a,b,c){var d;a=(d=new (wac_g.$$(wac_fb)),d.ga(new wac_fb("ma",a)),d.ga(new wac_fb("corr",b)),d);this.AA("getAppState",a,1,c)};wac_o$.prototype.getAppState=wac_o$.prototype.g9d;wac_o$.prototype.u9d=function(a,b){var c;a=(c=new (wac_g.$$(wac_fb)),c.ga(new wac_fb("corr",a)),c);this.AA("getRemovedAddins",a,1,b)};wac_o$.prototype.getKilledApps=wac_o$.prototype.u9d;
wac_o$.prototype.f9d=function(a,b,c,d){var e;a=(e=new (wac_g.$$(wac_fb)),e.ga(new wac_fb("cmo",a)),e.ga(new wac_fb("corr",c)),e);wac_p$("getAppDetails",a,b,2,d,!1)};wac_o$.prototype.getAppDetails=wac_o$.prototype.f9d;wac_o$.prototype.Oae=function(a,b,c){var d;b=(d=new (wac_g.$$(wac_fb)),d.ga(new wac_fb("corr",b)),d);wac_p$("removeAddin",b,a,2,c,!1)};wac_o$.prototype.removeApps=wac_o$.prototype.Oae;
wac_o$.prototype.v9d=function(a,b,c,d,e,f){var g;a=(g=new (wac_g.$$(wac_fb)),g.ga(new wac_fb("catalog","privatecatalog")),g.ga(new wac_fb("clientCode",a)),g.ga(new wac_fb("clientVersion",b)),g.ga(new wac_fb("corr",e)),g);c=String.format("authorizationCode={0}&refreshToken={1}",c?wac_Cf(c):"",d?wac_Cf(d):"");wac_p$("getLastPrivateCatalogUpdate",a,c,2,f,!0)};wac_o$.prototype.getLastPrivateCatalogUpdate=wac_o$.prototype.v9d;
wac_o$.prototype.C9d=function(a,b,c,d,e,f){var g;a=(g=new (wac_g.$$(wac_fb)),g.ga(new wac_fb("catalog","privatecatalog")),g.ga(new wac_fb("clientCode",a)),g.ga(new wac_fb("clientVersion",b)),g.ga(new wac_fb("corr",e)),g);c=String.format("authorizationCode={0}&refreshToken={1}",c?wac_Cf(c):"",d?wac_Cf(d):"");wac_p$("getAddIns",a,c,2,f,!0)};wac_o$.prototype.getPrivateCatalogAddIns=wac_o$.prototype.C9d;
wac_o$.prototype.D9d=function(a,b,c,d,e){var f;d=(f=new (wac_g.$$(wac_fb)),f.ga(new wac_fb("catalog","privatecatalog")),f.ga(new wac_fb("corr",d)),f);a=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",wac_Cf(a),b?wac_Cf(b):"",c?wac_Cf(c):"");wac_p$("getAppManifests",d,a,2,e,!0)};wac_o$.prototype.getPrivateCatalogManifests=wac_o$.prototype.D9d;wac_o$.prototype.h$d=function(a,b){var c;a=(c=new (wac_g.$$(wac_fb)),c.ga(new wac_fb("corr",a)),c);this.AA("isStoreDisabled",a,2,b)};
wac_o$.prototype.isStoreDisabled=wac_o$.prototype.h$d;wac_k$.registerClass("Common.App.AppsForOffice.AddinNativeActionBase",null,wac_fbc);wac_mbc.registerClass("Common.App.AppsForOffice.AddinNativeActionManager",null,wac_ebc);wac_pbc.registerClass("Common.App.AppsForOffice.AddinTakeSnapshotAction",wac_k$);wac_qbc.registerClass("Common.App.AppsForOffice.OSFAddinCommandsRuntimeManager",null,wac_hbc);wac_tbc.registerClass("Common.App.AppsForOffice.AppsForOfficeDialog",wac__m,wac_gbc);
window.Common.App.AppsForOffice.AppsForOfficeDialogManager.registerClass("Common.App.AppsForOffice.AppsForOfficeDialogManager",null,wac_kbc);wac_xbc.registerClass("Common.App.AppsForOffice.AppsForOfficeInsertionDialog",wac__m);wac_ybc.registerClass("Common.App.AppsForOffice.AccessTokenInformation",null,wac_jbc);wac_zbc.registerClass("Common.App.AppsForOffice.UserIdentity");wac_Abc.registerClass("Common.App.AppsForOffice.AppsForOfficeSingleSignOnManager",null,wac_ibc);wac_vbc.registerClass("Common.App.AppsForOffice.DialogInfo");
wac_ubc.registerClass("Common.App.AppsForOffice.DisplayDialogParams");wac_l$.registerClass("Common.App.AppsForOffice.OnMessageParentEventArgs",Sys.EventArgs);wac_M6c.registerClass("Common.App.AppsForOffice.OnMessageDialogEventArgs",Sys.EventArgs);wac_n$.registerClass("Common.App.AppsForOffice.AuthenticationProxy");wac_Gbc.registerClass("Common.App.AppsForOffice.AuthenticationProxy.ResponseHandler");wac_o$.registerClass("Common.App.AppsForOffice.S2SWebRequestManager");(function(){}).registerClass("Common.App.AppsForOffice.OtelTelemetryEventProxy");
var wac_sbc=null;window.Common.App.AppsForOffice.AppsForOfficeDialogManager.Xf=null;window.Common.App.AppsForOffice.AppsForOfficeDialogManager.M7=new (wac_rb.$$(wac_vbc));var wac_m$=new (wac_rb.$$(Object));Type.registerNamespace("Common.App.DirectPrint");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.SBd=wac_d.Qa.SBd||{};function wac_uNb(){}wac_uNb.registerInterface("Common.App.DirectPrint.IDirectPrintDialog");function wac_vNb(){}wac_vNb.registerInterface("Common.App.DirectPrint.IDirectPrintDialogFactory");
function wac_h4(){}wac_h4.registerInterface("Common.App.DirectPrint.IDirectPrintManager");
function wac_wNb(a){this.yx=Boolean.parse(a.DirectPrintIsEnabled||"false");this.ezc=Boolean.parse(a.DirectPrintProbeIsEnabled||"false");this.Wyc=Boolean.parse(a.DirectPrintEnabledForInternetExplorer||"false");this.zea=(a.DirectPrintSupportedMimeTypes||"").split(wac_xNb);this.C0=(a.DirectPrintSupportedPlugins||"").split(wac_xNb);this.yyc=(a.DirectPrintImmersivePreviewPlugins||"").split(wac_xNb);this.BJb=Boolean.parse(a.DirectPrintEnabledForEdge||"false");this.Lyf=Boolean.parse(a.ChromePrintLayoutFixIsEnabled||
"false");this.iyf=window.parseInt(a.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.$bb=14;this.EKb=14394;if(a=a.DirectPrintMinimalSupportedEdgeVersion){var b=a.split(".");2===b.length?(this.$bb=window.parseInt(b[0]),this.EKb=window.parseInt(b[1])):wac_b(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",a)}else wac_b(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}
wac_wNb.prototype={yx:!1,ezc:!1,Wyc:!1,zea:null,C0:null,yyc:null,BJb:!1,$bb:0,EKb:0,Lyf:!1,iyf:0};function wac_yNb(a,b,c,d){this.Dcc=Function.createDelegate(this,this.CCd);this.HJf=Function.createDelegate(this,this.sTf);this.Xmd=Function.createDelegate(this,this.vXd);wac_yNb.initializeBase(this);this.FZb=b;this.dF=a;this.MKc=c;this.X$e=d;this.pra=new wac_Za("LoadResource","LoadPrintablePdf")}
wac_yNb.prototype={aCa:null,rTa:null,X$e:null,FZb:null,dF:null,MKc:!1,pra:null,N1:null,n_:function(){wac_Nh(this,5);this.uT(40);var a=document.createElement("span");a.id=this.Rf("DirectPrintHeaderContent");var b=document.createElement("span");b.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(b,"DirectPrintHeader");this.N1=document.createElement("iframe");this.N1.name="pdfObjectFrame";this.N1.onload=this.Xmd;if(this.X$e&&0<this.X$e.Ma()){var c=wac_vSc(this.FZb,this.X$e),
d=wac_uSc(this.FZb,this.X$e);this.rTa=document.createElement("form");this.rTa.id="printPreviewPostForm";this.rTa.method="POST";this.rTa.target=this.N1.name;this.rTa.action=d;for(c=c.GetEnumerator();c.$$mn();){var d=c.$$cu(),e=document.createElement("input");e.type="hidden";e.name=d.rh();e.value=d.ma();this.rTa.appendChild(e)}}else this.N1.setAttribute("src",this.FZb);Sys.UI.DomElement.addCssClass(this.N1,"ObjectInDialog");this.MKc?(Sys.UI.DomElement.addCssClass(this.N1,"DirectPrintPdfObjectHidden"),
b.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,wac_Fe(this.N1,"aria-hidden","true")):Sys.UI.DomElement.addCssClass(this.N1,"DirectPrintPdfObject");a.appendChild(b);a.appendChild(document.createElement("br"));a.appendChild(this.N1);this.rTa&&a.appendChild(this.rTa);a.appendChild(document.createElement("br"));a.appendChild(wac_zNb(this,this.rTa?"#":this.FZb));this.pra.Wd();wac_en(this,CommonUIStrings.l_AppTitle,null,null,null,null,a);wac_9m(this,this.Rf("DirectPrintHeaderContent"));this.rTa&&
this.rTa.submit();this.aCa.focus();wac_b(4771852,328,50,"Direct Print Dialog launched.")},sTf:function(a){this.rTa&&(this.rTa.target="_blank",this.rTa.submit());a.preventDefault()},CCd:function(){wac_b(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1},vXd:function(){wac_b(51426332,328,50,"PDF content loaded successfully");this.pra&&this.pra.vg()},dispose:function(){this.aCa&&(this.dF.ub("click",this.aCa,this.Dcc),this.aCa=null);wac_id(this.N1);this.N1=null;wac_di.prototype.dispose.call(this)}};
function wac_zNb(a,b){var c=document.createElement("span"),d=document.createElement("span");d.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;c.appendChild(d);d=document.createElement("a");d.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink;d.href=b;d.target="_blank";d.id="PrintPDFLink";d.className="AllowBrowserClick";a.aCa=d;c.appendChild(document.createElement("br"));c.appendChild(d);a.rTa&&wac_tf(d,"click",a.HJf);a.dF.ya("click",a.aCa,a.Dcc,null);return c}
function wac_i4(a){this.dF=a}wac_i4.prototype={dF:null};function wac_ANb(a,b){this.$fb=a;this.C0=b}wac_ANb.prototype={$fb:null,C0:null};function wac_BNb(a,b,c,d,e,f,g,h,k,l){this.y$c=Function.createDelegate(this,this.TEd);this.mx=a;this.SWa=b;this.yYb=c;this.NLc=d;this.rMc=e;this.JDa=new (wac_f.$$(wac_ANb))(this.y$c);this.sUa=f;this.SXb=k;this.jX=g;this.sMc=h;this.pXb=l}
function wac_CNb(a){try{return new ActiveXObject(a),!0}catch(b){wac_b(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",a)}return!1}function wac_DNb(a){return wac_h(a)?!1:!wac_h(a.enabledPlugin)}function wac_ENb(a){return wac_Ek()||wac_ag()&&a.Wyc||a.BJb&&wac_FNb(a)?!0:!1}function wac_FNb(a){var b=wac_F3a();if(b){var c=b.split(".");if(2===c.length)return b=window.parseInt(c[0]),c=window.parseInt(c[1]),b>a.$bb||b===a.$bb&&c>=a.EKb}return!1}
wac_BNb.prototype={mx:null,SWa:null,yYb:null,NLc:null,JDa:null,rMc:null,sUa:null,jX:null,sMc:null,SXb:null,pXb:!1,Rnb:null,Wd:function(){},TEd:function(){var a=Array(this.mx.zea.length);if(!wac_h(this.SWa))for(var b=0;b<this.mx.zea.length;b++)a[b]=this.mx.zea[b]in this.SWa&&this.NLc(this.SWa[this.mx.zea[b]]);for(var b=Array(a.length),c=0;c<a.length;c++){var d;a[c]?(d=this.SWa[this.mx.zea[c]],wac_h(d)?d=null:(d=d.enabledPlugin,d=wac_h(d)?null:d.name)):d=null;b[c]=d}a=Array(this.mx.C0.length);c=!wac_h(this.yYb);
for(d=0;d<this.mx.C0.length;d++){var e=this.mx.C0[d];a[d]=c&&e in this.yYb?!0:this.rMc(e)}c={};d={};for(e=0;e<this.mx.zea.length;e++)c[this.mx.zea[e]]=b[e];for(e=0;e<this.mx.C0.length;e++)d[this.mx.C0[e]]=a[e];return new wac_ANb(c,d)}};
function wac_Q6c(a,b){if(a.pXb||!a.mx.yx?0:wac_INb(a)){var c;a:{c=wac_eEb(a.JDa.ma().$fb);for(var d=c.length,e=0;e<d;++e)if(wac_jm(a.mx.yyc,c[e])){c=!0;break a}c=!1}c=c&&!0;d=a.jX.uj("UserAction","OpenDirectPrintDialog");(new wac_yNb(a.sUa.dF,b,c,null)).n_();d.vg()}else a.SXb(b,null)}function wac_INb(a){if(!a.sMc(a.mx))return!1;for(var b=wac_eEb(a.JDa.ma().$fb),c=b.length,d=0;d<c;++d)if(!wac_h(b[d]))return!0;a=wac_eEb(a.JDa.ma().C0);b=a.length;for(c=0;c<b;++c)if(a[c])return!0;return!1}
function wac_JNb(a){if(null!=a.Rnb)return a.Rnb;var b=wac_FNb(a.mx);(b=a.mx.BJb&&b)||(b=wac_Ek()&&a.mx.Lyf&&wac_Xic()>=a.mx.iyf?!0:!1);a.Rnb=b;return a.Rnb}function wac_KNb(){}
wac_KNb.prototype={sa:null,Ub:function(){return"Common.App.DirectPrint"},GIc:null,gc:function(a){this.sa=a;wac_m(wac_n(a.fa(wac_i4)),function(){return new wac_i4(wac_r().Dha())});wac_m(wac_n(a.fa(wac_h4)),function(){return new wac_BNb(new wac_wNb(wac_.pa.Qb),window.navigator.mimeTypes,window.navigator.plugins,wac_DNb,wac_CNb,a.H(wac_i4),wac_r().Bz(),wac_ENb,function(a,c){return new wac_d3(a,!1,c)},wac_yg)})},tb:function(){this.GIc=this.sa.H(wac_h4);this.GIc.Wd()},O:function(){}};wac_wNb.registerClass("Common.App.DirectPrint.DirectPrintBrsSettings");
wac_yNb.registerClass("Common.App.DirectPrint.DirectPrintDialog",wac_di,wac_uNb);wac_i4.registerClass("Common.App.DirectPrint.DirectPrintDialogFactory",null,wac_vNb);wac_ANb.registerClass("Common.App.DirectPrint.DirectPrintProbeResults");wac_BNb.registerClass("Common.App.DirectPrint.DirectPrintManager",null,wac_h4);wac_KNb.registerClass("Common.App.DirectPrint.PackageManager",null,wac_I,wac_i);(function(){}).registerClass("Common.App.DirectPrint.Program");var wac_xNb=",";
wac_J(wac_C(),new wac_KNb,0,!1);Type.registerNamespace("Common.App.Embed");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.NCd=wac_d.Qa.NCd||{};function wac_yIb(a,b,c,d){this.Gdb=a;this.d6=b;this.LNb=c;this.Mc=d}wac_yIb.prototype={Gdb:null,d6:null,LNb:null,Mc:0};function wac_zIb(a,b,c){this.Veb=a;this.Oma=b;this.d6=c}wac_zIb.prototype={Veb:null,Oma:null,d6:null};
function wac_e3(a){this.Yld=Function.createDelegate(this,this.iBc);this.i6c=Function.createDelegate(this,this.fvc);this.isd=Function.createDelegate(this,this.J3d);this.N5c=Function.createDelegate(this,this.Exd);this.M5c=Function.createDelegate(this,this.Dxd);this.Zld=Function.createDelegate(this,this.aWd);this.Xld=Function.createDelegate(this,this.$Vd);this.R3a={};this.Jja=[];wac_e3.initializeBase(this,[!1,!1,!1,!1]);this.OUa=wac_.pya;this.Wlb=a;this.vlb=this.Xld;this.sDa=this.Zld;this.nhb=this.M5c;
this.Joa=this.N5c;this.KYa=this.isd;this.po=wac_AIb.yNa;wac_Nh(this,0);this._id="EmbedDialog"}
wac_e3.prototype={vlb:null,sDa:null,nhb:null,Joa:null,KYa:null,OUa:null,Wlb:null,MAf:476,LAf:288,JUb:798,XZb:476,CPc:288,GDa:null,wlb:null,tUa:null,xlb:null,nga:null,JC:null,gSa:function(){this.Hm(CommonUIStrings.l_Embed,null);this.GDa=document.getElementById("embedpreviewpane");this.wlb=document.getElementById("embedoptionpane");this.GDa.style.width=String.format("{0}px",this.XZb);this.nga=document.createElement("iframe");this.nga.className="EmbedPreviewFrame";this.nga.frameBorder="0";this.nga.style.height=
String.format("{0}px",this.CPc);this.nga.tabIndex=-1;this.GDa.appendChild(this.N4c(CommonUIStrings.l_Preview,this.nga,"Preview","PreviewHeader","Preview",!0));this.JC=document.createElement("textarea");this.JC.className="EmbedCodeTextArea";Sys.UI.DomElement.addCssClass(this.JC,"AllowBrowserContextMenu");this.JC.id="EmbedCode";wac_Ge()||(this.JC.readOnly=!0);this.JC.rows=4;this.JC.style.fontFamily=CommonUIStrings.l_UserInterfaceFontName;this.JC.style.fontSize=CommonUIStrings.l_UserInterfaceFontSize;
this.JC.setAttribute("aria-labelledby",String.format("{0} {1}","EmbedCodeHeader","EmbedCodeFooter"));this.GDa.appendChild(this.N4c(CommonUIStrings.l_EmbedCode,this.JC,"EmbedCodeHeader",null,null,!1));wac_tf(this.JC,"focus",this.KYa);var a=document.createElement("span");a.className="EmbedCodeFooter";a.innerText=CommonUIStrings.l_CopyText;a.id="EmbedCodeFooter";this.GDa.appendChild(a);this.tUa=document.createElement("div");this.tUa.className="EmbedDimensionSection";this.wlb.appendChild(this.N4c(CommonUIStrings.l_Dimensions,
this.tUa,null,null,null,!1));this.xlb=document.createElement("div");this.wlb.appendChild(this.SBe("Options",CommonUIStrings.l_Interaction,this.xlb));wac_Nh(this,0);wac_Oh(this,1,CommonUIStrings.l_Close);wac_DIb(this);wac_EIb(this);wac_Ge()||this.JC.focus()},dispose:function(){if(this.R3a){var a=this.R3a,b;for(b in a){var c=a[b];this.Fk.ub("click",c.Gdb,this.vlb);this.Od.ub("keydown",c.Gdb,this.sDa);this.Od.ub("keyup",c.Gdb,this.sDa)}this.sDa=this.vlb=this.R3a=null}if(this.Jja){for(a=0;a<this.Jja.length;++a)this.Fk.ub("click",
this.Jja[a].Oma,this.nhb),this.Od.ub("keydown",this.Jja[a].Oma,this.Joa),this.Od.ub("keypress",this.Jja[a].Oma,this.Joa),this.Od.ub("keyup",this.Jja[a].Oma,this.Joa);this.Od=this.nhb=this.Jja=null}this.KYa&&(wac_jg(this.JC,"focus",this.KYa),this.KYa=null);this.JC=this.nga=this.xlb=this.tUa=this.wlb=this.GDa=null;wac__m.prototype.dispose.call(this)},Pda:function(){wac_0m.prototype.Pda.call(this);this.Rb.style.width=String.format("{0}px",this.JUb);this.HMa()},N4c:function(a,b,c,d,e,f){var g=document.createElement("div");
g.className="EmbedSectionHeader";d&&(g.id=d);e&&g.setAttribute("aria-labelledby",e);f&&(g.tabIndex=0);d=document.createElement("span");d.className="EmbedSectionName UIFontBold";d.innerText=a;c&&(d.id=c);g.appendChild(d);g.appendChild(b);return g},SBe:function(a,b,c){b=this.N4c(b,c,null,null,null,!1);var d=this.fg.createElement("div");d.className="WACGlyph EmbedArrowHolder";d.id="Arrow"+a;d.setAttribute("role","button");d.tabIndex=0;b.insertBefore(d,c);a=wac_4h(16,16,"UpArrowServer","EmbedArrowIcon",
"");d.appendChild(a);a=a.childNodes[0];a.className=wac_9h("OutlookSearchChevronDown_16x16x32");a.title=CommonUIStrings.l_Expand;d.title=CommonUIStrings.l_Expand;c.style.visibility="hidden";c=new wac_zIb(c,d,a);Array.add(this.Jja,c);this.Fk.zA("click",d,this.nhb,c);this.Od.zA("keydown",d,this.Joa,c);this.Od.zA("keypress",d,this.Joa,c);this.Od.zA("keyup",d,this.Joa,c);return b},Dxd:function(a){this.fvc(a);return!0},Exd:function(a){return wac_Cma(this,a,this.i6c)},fvc:function(a){a=a.hQa;"visible"===
a.Veb.style.visibility?(a.Veb.style.visibility="hidden",a.d6.className=wac_9h("OutlookSearchChevronDown_16x16x32"),a.d6.title=CommonUIStrings.l_Expand,a.Oma.title=CommonUIStrings.l_Expand):(a.Veb.style.visibility="visible",a.d6.className=wac_9h("OutlookSearchChevronUp_16x16x32"),a.d6.title=CommonUIStrings.l_Collapse,a.Oma.title=CommonUIStrings.l_Collapse)},$Vd:function(a){this.iBc(a);return!0},aWd:function(a){return wac_Cma(this,a,this.Yld)},iBc:function(a){var b=this.R3a[a.hQa.toString()];b.Mc?(b.Mc=
0,b.d6.className=wac_9h("CheckboxUnchecked_16x16x32"),b.LNb.setAttribute("aria-checked","false")):(b.Mc=1,b.d6.className=wac_9h("CheckboxChecked_16x16x32"),b.LNb.setAttribute("aria-checked","true"));a=a.hQa.toString();b=b.Mc.toString();wac_FIb(this,a,b)&&(wac_DIb(this),wac_EIb(this))},J3d:function(){this.JC.select()}};
function wac_GIb(a){var b=ResourceStrings.l_AutoAdvanceLabel,c=document.createElement("div");c.className="EmbedOption";c.id="wdEaaOption";var d=a.fg.createElement("div");d.tabIndex=0;d.className="EmbedCheckBoxHolder";d.id="wdEaaCheck";d.setAttribute("role","checkbox");d.setAttribute("aria-checked","false");d.setAttribute("aria-labelledby","wdEaaEmbedDescription");c.appendChild(d);c.setAttribute("role","presentation");var e=wac_4h(16,16,"CommentChecked","EmbedOptionImage","");d.appendChild(e);e=e.childNodes[0];
e.id="wdEaaOptionImage";e.className=wac_9h("CheckboxUnchecked_16x16x32");a.R3a.wdEaa=new wac_yIb(c,e,d,0);a.Fk.zA("click",c,a.vlb,"wdEaa");d=document.createElement("span");d.className="EmbedDescription";d.innerText=b;d.id="wdEaaEmbedDescription";c.appendChild(d);a.Od.zA("keydown",c,a.sDa,"wdEaa");a.Od.zA("keyup",c,a.sDa,"wdEaa");return c}function wac_EIb(a){a.nga.contentWindow.location.replace(wac_Ml(a.Wlb,"wdPreview","1",!1))}
function wac_DIb(a){var b=a.JC,c;c=a.OUa;var d=a.MAf;a=a.LAf;if(!wac_HIb){var e=String.format('<a target="_blank" href="{0}">{1}</a>',wac_Bf("https://office.com",wac_wDb()),CommonUIStrings.l_Office),f=String.format('<a target="_blank" href="{0}">{1}</a>',wac_Bf("https://office.com/webapps",wac_wDb()),CommonUIStrings.l_WebAppName);wac_HIb=String.format(CommonUIStrings.l_NoFrames,e,f)}c=String.format('<iframe src="{0}" width="{1}px" height="{2}px" frameborder="0">{3}</iframe>',wac_Bf(c,wac_wDb()),d,
a,wac_HIb);b.innerText=c}function wac_FIb(a,b,c){var d=wac_Ml(a.OUa,b,c,!1);return a.OUa!==d?(a.OUa=d,a.Wlb=wac_Ml(a.Wlb,b,c,!1),!0):!1}function wac_AIb(){}wac_yIb.registerClass("Common.App.Embed.OptionInfo");wac_zIb.registerClass("Common.App.Embed.SectionInfo");wac_e3.registerClass("Common.App.Embed.EmbedDialog",wac__m);wac_AIb.registerClass("Common.App.Embed.EmbedDialogHtml");var wac_HIb=null;wac_AIb.yNa="<div class='EmbedDialog' id='embeddialog'> <div class='EmbedPreviewPane' id='embedpreviewpane'> </div> <div class='EmbedOptionPane' id='embedoptionpane'> </div> </div>";
Type.registerNamespace("Common.App.AppsForOfficeCommon");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.Bxd=wac_d.Qa.Bxd||{};(function(){}).registerInterface("Common.App.AppsForOfficeCommon.IExtensionIdentity");function wac_R6c(){this.ENe={};this.icf={}}wac_R6c.prototype={ENe:null,icf:null};wac_R6c.registerClass("Common.App.AppsForOfficeCommon.ExtensionLaunchProperties");Type.registerNamespace("Common.App.InProductMessaging");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};
wac_d.Qa.IQf=wac_d.Qa.IQf||{};function wac_S6c(){}wac_S6c.registerInterface("Common.App.InProductMessaging.IDependencyDownloader");function wac_T6c(){}wac_T6c.registerInterface("Common.App.InProductMessaging.INetworking");function wac_U6c(){}wac_U6c.prototype={YMf:!1,NLf:!1};
function wac_V6c(a,b,c){this.KGf=Function.createDelegate(this,this.bOf);this.nIf=Function.createDelegate(this,this.JQf);this.oIf=Function.createDelegate(this,this.KQf);this.SGf=Function.createDelegate(this,this.sOf);this.Ia=a;this.Xi=b;this.m$e=c}
wac_V6c.prototype={Ia:null,Xi:null,m$e:null,Tb:function(){this.Ia.jf(672565674,2147483648,this.SGf,64);this.Ia.ja(1501863744,2147483648,this.oIf);this.Ia.ja(3016992658,2147483648,this.nIf);this.Ia.ja(4275690876,2147483648,this.KGf);this.Ia.ja(4142738798,2147483648,wac_Mg.sM);this.Ia.ja(3865601672,2147483648,wac_Mg.sM);this.Ia.ja(2275483468,2147483648,wac_Mg.sM);this.Xi&&this.Xi.Tg(!1)},sOf:function(a,b,c,d,e){2===c&&wac_W6c(this.m$e,e);return 32},bOf:function(a,b,c,d,e){2===c&&wac_X6c(this.m$e,e);
return 32},KQf:function(a,b,c){return 2===c?this.m$e.Vkf():32},JQf:function(a,b,c){return 2===c?this.m$e.Ukf():32}};function wac_Y6c(){}function wac_Z6c(){var a=wac_Y2a(String.format("ipm/{0}","inproductmessaging.js"))+wac_Ke,a=wac_Ll(a,null,null);return wac__6c(a)}function wac_06c(){var a=wac_Y2a(String.format("ipm/{0}","inproductmessaging.css"))+wac_Ke,a=new wac_ml(a);return wac__6c(a)}function wac__6c(a){wac_ul(a);return wac_2gc(a)}wac_Y6c.prototype={Ref:null,vff:null};
function wac_16c(a){if(!a.vff)try{wac_b(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),a.vff=wac_Db.WAA(wac__6c(wac_Ll(wac_.pa.Qb.DimeUrl,null,null))),a.vff.CWo(function(a){wac_b(39978391,324,10,"{0}",wac_J6c(a.qo))},5)}catch(b){wac_b(594874951,324,10,"{0}",wac_J6c(b))}return a.vff}
function wac_26c(a){a.Ref||(wac_b(21030598,324,50,"InProductMessagingDependenciesLoad usage"),a.Ref=wac_Db.WAA(wac_Z6c(),wac_06c()),a.Ref.CWo(function(a){wac_b(21030599,324,10,"{0}",wac_J6c(a.qo))},5));return a.Ref}function wac_36c(){}wac_36c.prototype={zif:null,Bcf:null,Jxf:null,jxf:null,ixf:null};function wac_46c(){this.R6e=Array(5);this.R6e[0]=10;this.R6e[1]=15;this.R6e[2]=50;this.R6e[3]=100;this.R6e[4]=200}wac_46c.prototype={$Cf:0};wac_46c.prototype.tb=function(a){this.$Cf=a};
wac_46c.prototype.Init=wac_46c.prototype.tb;wac_46c.prototype.wDc=function(a,b){wac_b(34182235,this.$Cf,this.R6e[a],"{0}",b)};wac_46c.prototype.SendTrace=wac_46c.prototype.wDc;function wac_56c(){}
wac_56c.prototype={sa:null,Ub:function(){return"Common.App.InProductMessaging"},gc:function(a){wac_m(wac_n(wac_o(a.fa(wac_Y6c),wac_S6c)),function(){return new wac_Y6c});wac_m(wac_n(wac_o(a.fa(wac_66c),wac_iFa)),function(){return new wac_66c(wac_Ie())});wac_m(wac_n(wac_o(a.fa(wac_76c),wac_WGa)),function(){return new wac_76c(wac_z(),a.H(wac_iFa),a.H(wac_S6c))});wac_m(wac_n(a.fa(wac_V6c)),function(){return new wac_V6c(wac_z(),wac_r(),a.H(wac_WGa))});wac_m(wac_n(wac_o(a.fa(wac_86c),wac_QCa)),function(){return new wac_86c});
wac_m(wac_n(wac_o(a.fa(wac_U6c),wac_EEa)),function(){return new wac_U6c});this.sa=a},tb:function(){this.sa.H(wac_V6c).Tb();wac_q(wac_.pa,"FreemiumUpsellShowDialogIsEnabled")&&wac_xSc()&&1!==wac_r().Hd().Nv()&&wac_96c(this.sa.H(wac_76c))},O:function(){}};function wac_76c(a,b,c){this.Ia=a;this.Fnb=b;this.pQc=c}
wac_76c.prototype={Fnb:null,pQc:null,Ia:null,dgf:!1,maf:null,Xyf:function(a,b){if(this.dgf&&this.maf){var c={};c.experience=a||"gopremium";c.campaignId=wac_wSc(window.$$as(String,c.experience),!0);this.Ia.yw(4142738798,2,null);wac_b(51675403,324,50,"Launching Freemium Upsell dialog: "+c.experience);try{var d,e=this,f=(d=new wac_36c,d.zif=this.maf,d.Bcf=c,d.Jxf=b||function(){},d.jxf=function(a){wac_b(51675405,324,50,"Dime launch result: "+a.status)},d.ixf=function(){wac_b(51675406,324,10,"Dime launch error");
e.dgf=!1;e.maf=null},d);wac_$6c(this.Fnb,f)}catch(g){wac_b(51675407,324,10,"Dime launch error: "+g.message),this.dgf=!1,this.maf=null,this.Ia.Wj(1274543852,2,{experience:c.experience},null)}}else wac_b(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),this.Ia.Wj(1274543852,2,{experience:a},null)},Vkf:function(){return this.Fnb.Vkf()},Ukf:function(){return this.Fnb.Ukf()}};
function wac_96c(a){wac_16c(a.pQc).CWo(function(){try{var b=wac_rd(wac_.lHe),c=wac_H6c();if(c){var d={};d.partnerId=c;d.language=b;d.sessionId=wac_.Ag;d.authHint=wac_.pa.Qb.UserPrincipalName;a.maf=new window.Dime(d);a.dgf=!0}else wac_b(51675409,324,15,"App not supported")}catch(e){wac_b(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+e.message)}},3)}
function wac_X6c(a,b){function c(){}var d="gopremium";b?(b.experience&&""!==window.$$as(String,b.experience)&&(d=window.$$as(String,b.experience)),b.onTaskComplete&&(c=b.onTaskComplete)):wac_b(51675402,324,50,"Experience not given, using default experience");a.Xyf(d,c)}
function wac_W6c(a,b){wac_26c(a.pQc).CW(function(){var c=a.Fnb;b&&(window.InProductMessaging.Networking.NetworkingMgr=new wac_46c,window.InProductMessaging.Networking.NetworkingMgr.Init(387),c.Auf=!0,window.InProductMessaging.Init(b.iYf,b.TXf,b.hXf,b.lMf,b.Woc,c.cJf,b.Txf),c.E4c("inProductMessagingOverlayDiv",!0))})}function wac_66c(a){this.cJf=Function.createDelegate(this,this.ZRf);this.nd=a}
wac_66c.prototype={nd:null,Auf:!1,E4c:function(a,b){if(this.nd&&a&&(a=document.getElementById(a),wac_a7c(this,a),a=this.nd.ufb("InProductMessagingFocusId"))){var c=this.nd.Re();c&&"InProductMessagingFocusId"===c.Kd||wac_wg(this.nd,"InProductMessagingFocusId",!1);b&&this.ulf(a.uC)}},ulf:function(a){wac_jk(a,wac_Ie().rra);wac_jk(a,wac_Ie().sra);a.Ba(wac_Ie().rra,1501863744);a.Ba(wac_Ie().sra,3016992658)},Ona:function(){this.nd&&(wac_ng(this.nd,"InProductMessagingFocusId",!0),wac_kk(this.nd,"InProductMessagingFocusId"))},
ZRf:function(a,b){this.Auf=!1;this.Ona();var c;a=(c=new wac_U6c,c.NLf=a,c.YMf=b,c);wac_z().Wj(1486778386,2,a,null)},Vkf:function(){var a=document.activeElement,b=this.nd.Hg();return a&&b&&b.Fd&&a===b.Fd.dFa()?(b.Fd.Ch(a),wac_$j(b)?32:8):4},Ukf:function(){var a=document.activeElement,b=this.nd.Hg();return a&&b&&b.Fd&&a===b.Fd.zX()?(b.Fd.Ch(a),wac_ak(b)?32:8):4}};
function wac_a7c(a,b){var c=a.nd.xc("InProductMessagingFocusId");c.re="app";var d=new wac_tk(function(){return b});d.Lna=!1;wac_wk(d,3);wac_wk(d,2);wac_wk(d,4);a=wac_ik(a.nd,function(){return b},c,d);wac_rk(a);a.EM=!0;a.Ola=!0}
function wac_$6c(a,b){if(b&&b.zif&&b.Bcf){var c=document.getElementById("wacDimeContainer");c||(c=document.createElement("div"),c.id="wacDimeContainer",document.body.appendChild(c));a.E4c("wacDimeContainer",!1);b.Bcf.parentElementId="wacDimeContainer";b.zif.launch(b.Bcf,b.Jxf).then(function(d){a.Ona();document.body.removeChild(c);b.jxf(d)}).catch(function(d){a.Ona();document.body.removeChild(c);b.ixf(d)})}else throw Error.argument("DimeExperienceUISettings");}function wac_86c(){this.Txf={}}
wac_86c.prototype={hXf:!0,TXf:!0,iYf:!0,Txf:null,lMf:!1,Woc:null};wac_U6c.registerClass("Common.App.InProductMessaging.FirstRunExperienceViewData",null,wac_EEa);wac_V6c.registerClass("Common.App.InProductMessaging.InProductMessagingActor");wac_Y6c.registerClass("Common.App.InProductMessaging.DependencyDownloader",null,wac_S6c);wac_36c.registerClass("Common.App.InProductMessaging.DimeExperienceUISettings");wac_46c.registerClass("Common.App.InProductMessaging.DefaultNetworkingManager",null,wac_T6c);
wac_56c.registerClass("Common.App.InProductMessaging.InProductMessagingPackage",null,wac_I,wac_i);wac_76c.registerClass("Common.App.InProductMessaging.InProductMessagingUIManager",null,wac_WGa);wac_66c.registerClass("Common.App.InProductMessaging.InProductMessagingUIWrapper",null,wac_iFa);wac_86c.registerClass("Common.App.InProductMessaging.FirstRunExperienceUISettings",null,wac_QCa);wac_J(wac_C(),new wac_56c,0,!1);Type.registerNamespace("Common.App.NewAndOpen.Core");wac_d=window.Common||{};
wac_d.Qa=wac_d.Qa||{};wac_d.Qa.PG=wac_d.Qa.PG||{};wac_d.Qa.PG.$I=wac_d.Qa.PG.$I||{};function wac_t6a(){}wac_t6a.prototype={kg:function(){return this._state},pI:function(a){wac_b(5849616,202,50,"Changing event result state. {0}",{OldState:wac_d.N$a.toString(this._state),NewState:wac_d.N$a.toString(a)},"ResultType",this.Fxc());return this._state=a},_state:0};function wac_9P(a,b){this.rJc=a;this.Ab=wac_9P.$$(this.jb["Common.App.NewAndOpen.Core.EventReceiver$1"].T).t7d++;this.rQc=b}
wac_9P.$$=function(a){var b=wac_d.Qa.PG.$I.__tc=wac_d.Qa.PG.$I.__tc||{},c="EventReceiver$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_9P.apply(this,a)};d.registerClass("Common.App.NewAndOpen.Core.__tc."+c,null,wac_nc.$$(a));d.prototype.jb={"Common.App.NewAndOpen.Core.EventReceiver$1":{T:a},ctor:wac_9P};a=wac_9P.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}d.t7d=
0}return b[c]};wac_9P.prototype={rJc:null,rQc:null,Ab:0,ia:function(){return this.Ab},QG:function(a,b){this.rQc(a,b)},XU:function(a,b){var c=this.rJc;(b=b?this:null)&&(c.HSb[b.ia().toString()]=b);return c.cBc(a,b)}};function wac_$P(){this.HSb={}}
wac_$P.$$=function(a){var b=wac_d.Qa.PG.$I.__tc=wac_d.Qa.PG.$I.__tc||{},c="AEventEmitter$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_$P.apply(this,a)};d.registerClass("Common.App.NewAndOpen.Core.__tc."+c,null,wac_oc.$$(a));d.prototype.jb={"Common.App.NewAndOpen.Core.AEventEmitter$1":{T:a},ctor:wac_$P};a=wac_$P.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};
wac_$P.prototype={};function wac_u6a(a,b){var c=a.HSb,d;for(d in c)c[d].QG(b,!1);a.HSb={}}function wac_v6a(){this.k8c=Function.createDelegate(this,this.HBd);this.u5c=Function.createDelegate(this,this.puc);this.dispose=this.O}
wac_v6a.prototype={sa:null,Ub:function(){return"Common.App.NewAndOpen.Core"},gc:function(a){this.sa=a;wac_m(wac_n(a.fa(wac_wc)),function(){return wac_w6a()});wac_m(wac_n(a.fa(wac_oc.$$(wac_sc))),function(){return wac_x6a||(wac_x6a=wac_y6a())});wac_m(wac_n(a.fa(wac_oc.$$(wac_vc))),function(){return wac_aQ()})},tb:function(){var a=this;wac_.pa.Ok(function(){a.aPa()})},aPa:function(){this.sa.H(wac_wc);this.sa.H(wac_oc.$$(wac_sc));this.sa.H(wac_oc.$$(wac_vc));var a=!1,b=wac_w6a();b.Ia.ma().ja(1959943459,
2147483648,b.Wld);b.Ia.ma().ja(1813655452,2147483648,b.CIf);wac_Kd?wac_z6a():b.Ia.ma().jf(1169404878,2147483648,b.R8c,96);wac_0g&&(a=!0);wac_1g&&(wac_A6a(wac_aQ(),"Open",!1),0<wac_nfa&&this.puc(),a=wac_bQ(),b=wac_aQ().jed,a.Ra.xa(a.Q8a,b),a=wac_bQ(),a.Ra.xa(a.Q8a,this.u5c),a=wac_bQ(),a.Ra.xa(a.WIb,this.k8c),a=!0);wac_2fa&&a&&wac_B6a(wac_x6a||(wac_x6a=wac_y6a()),"Document opened",!1);wac_1fa&&(a=wac_aQ(),a.Ov().Ia.ma().ja(3502386740,2147483648,a.gpd),wac_C6a(a,"File Opened"),a=wac_bQ(),b=wac_aQ().med,
a.Ra.xa(a.WIb,b),a=wac_bQ(),b=wac_aQ().led,a.Ra.xa(a.Q8a,b))},HBd:function(){wac_p().Rg(wac_D6a(this))},puc:function(){wac_p().Hb(wac_D6a(this))},eQc:null,O:function(){}};function wac_D6a(a){return a.eQc||(a.eQc=new wac_D(4,2,wac_nfa,wac_aQ().v$c,109,null,!1))}function wac_E6a(){wac_E6a.initializeBase(this);this.pI(0);this.Fva=this.t6a=!1}wac_E6a.prototype={BI:null,Wba:null,t6a:!1,Fva:!1,Fxc:function(){return"GetMoreInfo Result"}};
function wac_F6a(a,b){wac_F6a.initializeBase(this);this.zu=a;this.SDa=new wac_cQ(b,this.zu.ma().Pc.ma(),"GetMoreInfo");this.Xq=new wac_E6a}function wac_y6a(){return new wac_F6a(new (wac_f.$$(wac_wc))(function(){return wac_w6a()}),new (wac_f.$$(String))(function(){return wac_qfa}))}
function wac_G6a(a){if(!a)return wac_b(5849624,202,50,"Attempted to check an empty url for validity as a StorageHostUrl."),!1;if(wac_rd(a).startsWith("https://"))return!0;wac_b(5849625,202,10,"StorageUrl has invalid scheme.");return!1}
wac_F6a.prototype={zu:null,SDa:null,Xq:null,cBc:function(a,b){wac_b(5849617,202,50,"Attempting to get GetMoreInfo properties {0}",{Trigger:a});3===this.Xq._state?(b&&b.QG(this.Xq,!0),wac_b(5849619,202,50,"GetMoreInfo already populated. {0}",{Trigger:a})):wac_B6a(this,a,!1);return this.Xq}};
function wac_H6a(a,b){return function(c){wac_dQ(a.zu.ma(),"GetMoreInfoActor.CreateGetMoreInfoFromServerFailureCallback",c.Aa,"Failure");a.Xq.pI(2);a.Xq.t6a=!1;a.Xq.Fva=!1;wac_u6a(a,a.Xq);wac_I6a(a.SDa,wac_J6a(a,b))}}
function wac_K6a(a){return function(b){var c=!1,d=!1,e=!1,f=null;if(wac_q(wac_.pa,"GetMoreInfoDataFromResponseBody"))if(b.Aa.Be){var g,h;(h=wac_dP(Object,b.Aa.Be,g={val:f}),f=g.val,h)?f?(e=!0,a.Xq.Wba=f.StorageServiceDisplayName,a.Xq.BI=wac_G6a(f.PersonalFileStorageUrl)?f.PersonalFileStorageUrl:""):wac_b(25298113,202,15,"Response body could not be casted into a GetMoreInfoResponseData type. Will fallback to reading the data from the headers"):wac_b(25298112,202,15,"Failed to deserialize GetMoreInfo response body. Will fallback to reading the data from the headers")}else wac_b(25298083,
202,15,"Could not find GetMoreInfo data on the response body. Will fallback to reading the data from the headers");e||((f=b.Aa.ti)?(a.Xq.Wba=(f.StorageServiceDisplayName||"").toString(),c=(f.PersonalFileStorageUrl||"").toString(),a.Xq.BI=wac_G6a(c)?c:"",c=""===c&&""!==a.Xq.Wba):(wac_b(5849622,202,50,"Null response headers received."),d=!0));e=String.format("Success at RetryIndex: {0}, InvalidResponse: {1}, InstantiatingPersonalStorage: {2}, InfoFoundInResponseBody: {3}",a.SDa.$ka,d,c,e);wac_dQ(a.zu.ma(),
"GetMoreInfoActor.CreateGetMoreInfoFromServerSuccessCallback",b.Aa,e);b=c;a.Xq.pI(3);a.Xq.t6a=b;a.Xq.Fva=d;wac_u6a(a,a.Xq)}}
function wac_B6a(a,b,c){wac_eQ(a.SDa,!c);1===a.Xq._state?wac_b(5849620,202,50,"Not starting new request, because one is already in progress {0}",{Trigger:b,RetryIndex:a.SDa.$ka}):(wac_b(5849621,202,50,"Making GetMoreInfo request {0}",{Trigger:b,RetryIndex:a.SDa.$ka}),a.Xq.pI(1),c=String.format("{0}GetMoreInfoHandler.ashx?{1}",a.zu.ma().jO(),wac_.eo),wac_bj(a.zu.ma().$g.ma(),c,1,null,null,["PersonalFileStorageUrl","StorageServiceDisplayName"],4,wac_K6a(a),wac_H6a(a,b),null,null,null,null,!1,null,null))}
function wac_J6a(a,b){return function(){wac_B6a(a,b,!0)}}function wac_L6a(){}wac_L6a.prototype={PersonalFileStorageUrl:null,StorageServiceDisplayName:null};function wac_M6a(a,b,c,d,e){this.Zcd=Function.createDelegate(this,this.BJd);this.Pc=a;this.xVb=b;this.BW=c;this.c1b=d;this.Ra=new wac_Re;e&&(a=new wac_D(4,2,this.K6d,this.Zcd,108,null,!1),this.Pc.ma().Hb(a));this.BXb=this.xVb()}function wac_bQ(){return wac_N6a||(wac_N6a=wac_O6a())}
function wac_O6a(){return new wac_M6a(new (wac_f.$$(wac_dd))(function(){return wac_p()}),function(){return wac_yia.getTime()},function(){return(new Date).getTime()},new (wac_f.$$(Number))(function(){return wac_ofa}),!0)}
wac_M6a.prototype={K6d:6E4,BXb:0,Pc:null,xVb:null,BW:null,c1b:null,Ra:null,WIb:"inactive",Q8a:"active",yWb:!0,BJd:function(){var a=this.xVb(),b=this.BW()-a;b>this.c1b.ma()&&this.yWb&&(wac_b(5849626,202,50,"User went inactive {0}",{TimeSinceLastActive:b}),this.yWb=!1,this.Ra.wa(this.WIb,null,null));a-this.BXb>this.c1b.ma()&&(this.yWb=!0,this.Ra.wa(this.Q8a,null,null));this.BXb=a}};function wac_P6a(){wac_P6a.initializeBase(this);this.pI(0);this.Fva=!1}wac_P6a.prototype={kBb:null,Dtc:0,Fva:!1,Fxc:function(){return"MruActor Result"}};
function wac_fQ(a,b,c,d,e){this.t$c=Function.createDelegate(this,this.MEd);this.s$c=Function.createDelegate(this,this.LEd);this.u$c=Function.createDelegate(this,this.NEd);this.otd=Function.createDelegate(this,this.D5d);this.gpd=Function.createDelegate(this,this.f_d);this.v$c=Function.createDelegate(this,this.OEd);this.led=Function.createDelegate(this,this.WLd);this.med=Function.createDelegate(this,this.XLd);this.jed=Function.createDelegate(this,this.ULd);wac_fQ.initializeBase(this);this.zu=a;this.cYb=
b;this.QXa=new wac_cQ(c,this.Ov().Pc.ma(),"Read");this.eob=new wac_cQ(d,this.Ov().Pc.ma(),"Write");this.W1b=e;this.$P={};this.OR=new wac_P6a}function wac_aQ(){return wac_Q6a||(wac_Q6a=wac_R6a())}
function wac_R6a(){return new wac_fQ(new (wac_f.$$(wac_wc))(function(){return wac_w6a()}),new (wac_f.$$(String))(function(){return wac_nm(wac_.vh)._name}),new (wac_f.$$(String))(function(){return wac_.pa.Qb.MruServerReadRetryIntervalsInMs}),new (wac_f.$$(String))(function(){return wac_.pa.Qb.MruServerWriteRetryIntervalsInMs}),wac_q(wac_.pa,"MruWriteFileIdInHeader"))}
wac_fQ.prototype={zu:null,cYb:null,W1b:!1,OR:null,QXa:null,eob:null,$P:null,yCc:"RenameMruEntry",rFc:"UpdateMruEntry",f_d:function(a,b,c,d,e){if(!e)return 32;if(!e.QKb)return wac_b(5849666,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewDocumentDAVUrl"}),8;if(!e.RKb)return wac_b(5849667,202,15,"Failure to rename MRU entry {0}",{Error:"Null NewFileName"}),8;if(!e.RFb)return wac_b(5849668,202,15,"Failure to rename MRU entry {0}",{Error:"Null CurrentDocumentDAVUrl"}),8;this.$P[wac_fQ.k$a]=this.$P[wac_fQ.k$a]||
wac_Cf(e.RFb);this.$P[wac_fQ.$Pa]=wac_Cf(e.QKb);this.$P[wac_fQ.JMd]=wac_Cf(e.RKb);wac_b(5849669,202,50,"Starting rename of MRU entry {0}",{Trigger:"Rename"});return wac_S6a(this,"Rename",this.yCc,!1)},XLd:function(){wac_C6a(this,"Inactivity")},WLd:function(){wac_C6a(this,"Back from Inactivity")},D5d:function(a){wac_dQ(this.Ov(),"MruActor.WriteMruEntryOnServerSuccessCallback",a.Aa,"Success");wac_eQ(this.eob,!0);a=(a.Aa.Request.get_headers()[wac_fQ.$Pa]||"").toString();""!==a&&(this.$P[wac_fQ.k$a]=
a)},OEd:function(){wac_A6a(this,"Polling",!1)},MEd:function(){wac_A6a(this,"Retry",!0)},ULd:function(){wac_A6a(this,"Activity",!1)},NEd:function(a){var b=a.Aa.Be;wac_r()&&wac_r().Hd().JVe()&&wac_7k()&&window.appChrome.api.dispatch(window.appChrome.actions.setFileMenuMRUJson(b));wac_eQ(this.QXa,!0);var c=null;if(b){var d;try{d=wac_Hd(b)}catch(e){d=null,wac_b(5849675,202,10,"MruActor.TryDeserializeJson: Exception thrown from JsonSerializer.SecureDeserialize Exception: {0}",e)}c=d}c?(wac_T6a(this,3,
c,!1),wac_dQ(this.Ov(),"MruActor.GetMruFromServerSuccessCallback",a.Aa,"Success")):(wac_dQ(this.Ov(),"MruActor.GetMruFromServerSuccessCallback",a.Aa,"Failure: Invalid JSON"),wac_T6a(this,3,null,!0));wac_u6a(this,this.OR)},LEd:function(a){wac_dQ(this.Ov(),"MruActor.GetMruFromServerFailureCallback",a.Aa,"Failure");wac_T6a(this,2,null,!1);wac_I6a(this.QXa,this.t$c)||wac_eQ(this.QXa,!0);wac_u6a(this,this.OR)},cBc:function(a,b){wac_b(6029918,202,50,"MRU result requested {0}",{Trigger:a,ResultState:this.OR._state});
b&&3===this.OR._state&&b.QG(this.OR,!0);return this.OR},Ov:function(){return this.zu.ma()}};function wac_T6a(a,b,c,d){if(3!==a.OR._state||3===b)a.OR.kBb=c,a.OR.pI(b),a.OR.Fva=d,a.OR.Dtc=(0,a.Ov().BW)()}
function wac_A6a(a,b,c){wac_b(5849674,202,50,"Making GetMru request {0}",{Trigger:b});wac_eQ(a.QXa,!c);b=a.u$c;c=a.s$c;wac_T6a(a,1,null,!1);var d=String.format(a.Ov().jO()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}","getmru",wac_gQ(a.Ov()),a.cYb.ma()),e=null;a.W1b?(e={},e["X-FileId"]=wac_.eo):d+=String.format("&{0}",wac_.eo);a.Ov().$g.ma().lk(d,1,null,e,!0,4,b,c,null,null,!1,null,null,null,null,!1,null,!1,null)}function wac_U6a(a,b){return function(){wac_S6a(a,"Retry",b,!0)}}
function wac_V6a(a,b){return function(c){wac_dQ(a.Ov(),"MruActor.WriteMruEntryOnServerFailureCallback",c.Aa,"Failure");403!==c.Aa.ho&&wac_I6a(a.eob,wac_U6a(a,b))}}
function wac_S6a(a,b,c,d){if(4===wac_gQ(a.Ov())&&!wac_Bg)return 2;var e;a.$P[wac_fQ.$Pa]&&a.$P[wac_fQ.k$a]!==a.$P[wac_fQ.$Pa]?e=a.yCc:(e=a.rFc,delete a.$P[wac_fQ.$Pa]);wac_b(5849673,202,50,"Writing to MRU {0}",{Trigger:b,IntendedActionType:c,ActualActionType:e});wac_eQ(a.eob,!d);b=String.format(a.Ov().jO()+"MruServiceHandler.ashx?action={0}&app={1}&lc={2}",e,wac_gQ(a.Ov()),a.cYb.ma());a.W1b?a.$P["X-FileId"]=wac_.eo:b+=String.format("&{0}",wac_.eo);return a.Ov().$g.ma().lk(b,2,null,a.$P,!0,4,a.otd,
wac_V6a(a,c),null,null,!1,null,null,"4",null,!1,null,!1,null)}function wac_C6a(a,b){wac_b(5849670,202,50,"Starting update of MRU entry {0}",{Trigger:b});wac_S6a(a,b,a.rFc,!1)}function wac_cQ(a,b,c){this.cRc=a;this.Pc=b;this.FUb=c}wac_cQ.prototype={Pd:null,cRc:null,Pmb:null,FUb:"",Pc:null,$ka:0};
function wac_W6a(a){if(!a.Pmb){var b=(a.cRc.ma()||"0").split(",");a.Pmb=[];for(var c=0;c<b.length;c++){var d=window.parseInt(b[c]);window.isNaN(d)?wac_b(5849677,202,15,"Retry interval list contains non-number element {0}",{Action:a.FUb,Entry:b[c]}):Array.add(a.Pmb,d)}}return a.Pmb}
function wac_I6a(a,b){var c;c=a.$ka>=wac_W6a(a).length?-1:wac_W6a(a)[a.$ka];var d=0<=c;d?(a.$ka++,wac_eQ(a,!1),a.Pd=new wac_D(4,1,c,b,107,null,!1),a.Pc.Hb(a.Pd)):(wac_eQ(a,!0),wac_b(5849676,202,50,"Retries exhausted {0}",{Action:a.FUb}));return d}function wac_eQ(a,b){a.Pd&&(a.Pc.Rg(a.Pd),a.Pd=null);b&&(a.$ka=0)}
function wac_X6a(a,b,c,d,e,f,g,h){this.R8c=Function.createDelegate(this,this.pCd);this.CIf=Function.createDelegate(this,this.rRf);this.Wld=Function.createDelegate(this,this.YVd);this.Ia=a;this.$g=b;this.jn=c;this.iR=d;this.Pc=e;this.BW=f;this.AKc=g;this.qra=h}function wac_w6a(){return wac_Y6a||(wac_Y6a=wac_Z6a())}
function wac_Z6a(){return new wac_X6a(new (wac_f.$$(wac_Oc))(function(){return wac_z()}),new (wac_f.$$(wac_Wc))(function(){return wac_.Af}),new (wac_f.$$(wac_gc))(function(){return wac_r()}),new (wac_f.$$(wac_d.Xya))(function(){return wac_r().Hd().Nv()}),new (wac_f.$$(wac_dd))(function(){return wac_p()}),function(){return(new Date).getTime()},new (wac_f.$$(String))(function(){return wac_r().Hd().jO()}),new (wac_f.$$(Boolean))(function(){return wac_2fa}))}
wac_X6a.prototype={Ia:null,$g:null,jn:null,iR:null,Pc:null,BW:null,AKc:null,qra:null,YVd:function(a,b,c,d,e){if(e&&e.MenuItemId)if(wac_b(5849678,202,50,"Opening new tab {0}",{Id:e.SourceControlId,AppType:wac_d.Xya.toString(wac_gQ(this))}),a=e.MenuItemId.toString(),b=wac_q(wac_.pa,"WacInTabOpenMRUIsEnabledForUiHost"),c=wac_q(wac_.pa,"UiHostSupportsDocRebootFeatures"),wac_b(51517595,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",b,c),b&&c){var f={rebootMode:"1"};f.documentUrl=
a;wac_b(51247010,202,50,"Send PostMessage to the Ui host to reboot a document");wac_I0a().uc(function(a){a.Dx("App_DocReboot",f,"")})}else window.open(a,"_blank");return 32},rRf:function(a,b,c,d,e){e&&e.MenuItemId&&(wac_b(0,202,50,"Opening new tab {0}",{Id:e.SourceControlId,AppType:wac_d.Xya.toString(wac_gQ(this))}),a=e.MenuItemId.toString(),window.open(a,"_blank"));return 32},pCd:function(){wac_z6a();return 32},jO:function(){return this.AKc.ma()}};function wac_gQ(a){return a.iR.ma()}
function wac_z6a(){var a=wac_q(wac_.pa,"QPGVCI"),b=wac__i(document.URL,"wdNewAndOpenCt",a);if(b){var b=window.parseInt(b),c=wac__i(document.URL,"wdPreviousSession",a),a=wac__i(document.URL,"wdPreviousCorrelation",a),d=wac_q(wac_.pa,"NAOPLP");if(wac_Kd){var e=wac_Kd.getTime();!b||b>e?wac_b(5849682,202,15,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Invalid timestamp {0}",{ClickTimestamp:b,DocumentLoadedTime:e,SessionId:c,Correlation:a}):wac_b(5849683,202,d?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Click-to-load perf {0}",
{ClickToLoadTime:e-b,ClickTimestamp:b,SessionId:c,Correlation:a})}else wac_b(5849681,202,d?15:50,"NewAndOpenCommonHelpers.LogNewAndOpenPerfStats: Not logging because document loaded time has not been set {0}",{ClickTimestamp:b,SessionId:c,Correlation:a})}}
function wac_dQ(a,b,c,d){if(c&&c.hu){var e=wac_d.l0.toString(c.Sd);c=c.hu.getTime();a=a.BW()-c;wac_b(5849679,202,50,"Making request to the WAC server {0}",{Caller:b,RequestStatus:e,ElapsedMs:a,StartTime:c,Notes:d})}else wac_b(5849680,202,50,"Attempted to make a request to the WAC server with null request item {0}",{Caller:b})}wac_t6a.registerClass("Common.App.NewAndOpen.Core.AEventResult",null,wac_mc);wac_v6a.registerClass("Common.App.NewAndOpen.Core.CorePackageManager",null,wac_I,wac_i,Sys.IDisposable);
wac_E6a.registerClass("Common.App.NewAndOpen.Core.GetMoreInfoResult",wac_t6a,wac_sc,wac_mc);wac_F6a.registerClass("Common.App.NewAndOpen.Core.GetMoreInfoActor",wac_$P.$$(wac_sc));wac_L6a.registerClass("Common.App.NewAndOpen.Core.GetMoreInfoResponseData");wac_M6a.registerClass("Common.App.NewAndOpen.Core.InactivityManager");wac_P6a.registerClass("Common.App.NewAndOpen.Core.MruResult",wac_t6a,wac_vc,wac_mc);wac_fQ.registerClass("Common.App.NewAndOpen.Core.MruActor",wac_$P.$$(wac_vc));wac_cQ.registerClass("Common.App.NewAndOpen.Core.RetryHelper");
wac_X6a.registerClass("Common.App.NewAndOpen.Core.NewAndOpenCommonHelpers",null,wac_wc);(function(){}).registerClass("Common.App.NewAndOpen.Core.Program");var wac_x6a=null,wac_N6a=null;wac_fQ.k$a="CurrentDocumentDAVUrl";wac_fQ.$Pa="NewDocumentDAVUrl";wac_fQ.JMd="NewFileName";var wac_Q6a=null,wac_Y6a=null;wac_J(wac_C(),new wac_v6a,0,!1);Type.registerNamespace("Common.App.NewAndOpen.UX");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.PG=wac_d.Qa.PG||{};wac_d.Qa.PG.BSa=wac_d.Qa.PG.BSa||{};
wac_d.Qa.PG.BSa.LKb=function(){};wac_d.Qa.PG.BSa.LKb.prototype={};wac_d.Qa.PG.BSa.LKb.registerEnum("Common.App.NewAndOpen.UX.MruActorString",!1);function wac__6a(){}wac__6a.registerInterface("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
function wac_06a(a,b,c,d,e,f){this.Jmd=Function.createDelegate(this,this.bXd);this.yed=Function.createDelegate(this,this.GMd);this.Sja=Function.createDelegate(this,this.xma);this.zu=a;this.yW=b;var g=this;this.WJ=new (wac_f.$$(wac_nc.$$(wac_sc)))(function(){return new (wac_9P.$$(wac_sc))(c.ma(),g.Sja)});this.QNc=d;this.$fa=e;this.xYa=f;this.eEa=this.xYa.ma();2===wac_gQ(wac_hQ(this))&&(this.p0b=!0)}
wac_06a.prototype={zu:null,yW:null,WJ:null,QNc:null,$fa:null,xYa:null,eEa:!1,Bhb:null,yl:null,pSc:null,u0b:!1,Ymb:!1,GNc:0,VWb:!1,p0b:!1,vX:function(){switch(wac_gQ(wac_hQ(this))){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null},Tb:function(){var a=wac_hQ(this).Ia.ma();a.ja(1056925771,2147483648,this.yed);a.jf(2074131365,2147483648,this.Jmd,96)},GMd:function(a,b,c,d,e){return 1===c?32:2===c&&e&&e.MenuItemId&&e.SourceControlId?this.mNa(e.MenuItemId,
e.SourceControlId):8},mNa:function(a,b){var c=this.yW.ma().KFb;if(null===c)return 8;var d=wac_q(wac_.pa,"UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(wac_vhb&&d){wac_b(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");var e={};e.template=a;e.appID=this.vX();e.lcid=wac_.vh.toString();wac_I0a().uc(function(a){a.Dx("App_CreateNewDocument",e,"")})}else d=(new Date).getTime(),b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",
c,wac_Cf(this.Rob()),wac_Cf(a),wac_Cf(this.vX()),wac_Cf(wac_.vh.toString()),wac_Cf(d.toString()),wac_Cf(b),wac_Cf(wac_.VD),wac_.eo),b+="&"+wac_Ug(),wac_.Tma&&(b+="&"+wac_Vg()),(c=this.yl?this.yl.BI:null)&&(b+="&DestinationUrl="+wac_Cf(c)),window.open(b,"_blank");2===wac_gQ(wac_hQ(this))&&wac_b(24700384,202,50,"CreateNewDocument from New Menu {0}",{AppType:wac_d.Xya.toString(wac_gQ(wac_hQ(this))),Template:a});return 32},bXd:function(a,b,c,d,e){if(1===c)return this.p0b&&(wac_Tg("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),
this.p0b=!1),32;2!==c||this.VWb||(this.GNc=(new Date).getTime(),wac_b(5849602,202,50,"File New menu flyout opened by user {0}",{ShouldShowTemplates:this.xYa.ma(),CachedNewMenuXmlExists:!!this.Bhb,ShouldCallGetMoreInfo:wac_hQ(this).qra.ma()}));if(e)if(this.Bhb)e.PopulationXML=this.Bhb;else{wac_hQ(this).qra.ma()&&!this.yl&&this.WJ.ma().XU("Opened New menu",!0);a=wac_16a(this);var f;b=this.yW.ma().FMa||"1056925771";var g,h=this.yW.ma();c=f={val:f};c.val=!1;d=wac_26a(this);var k="";wac_hQ(this).qra.ma()&&
(this.u0b?(k=wac_iQ(CommonUIStrings.l_NewGenericErrorMessage,h.fV,null,null),this.u0b=!1,wac_b(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure")):this.yl?d?(k=this.yl,k=wac_iQ(CommonUIStrings.l_NewCreationLocationMessage,h.fV,k.BI,k.Wba)):this.yl.t6a?(c.val=!0,this.eEa=!1,k=wac_iQ(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,this.yl.Wba,"\n\n"),h.fV,null,null),wac_b(5849607,202,50,"Rendering File>New with personal storage instantiation message")):
(c.val=!0,k=wac_iQ(CommonUIStrings.l_NewGenericErrorMessage,h.fV,null,null),wac_b(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response",{PersonalFileStorageUrlIsSet:!!this.yl.BI,StorageServiceDisplayNameIsSet:!!this.yl.Wba})):(k=wac_36a(h.fV,CommonUIStrings.l_VoicedLoadingText),wac_b(5849606,202,50,"Rendering File>New with loading spinner")));if(d){d=k;var h=wac_jQ("menuNewBlank",wac_kQ.cJd,k?null:h.fV,wac_lQ(h.kyc,h.lyc,h.myc,null,h.$Oa,h.ZOa,b,"blank")),l;c.val=
!1;if(this.xYa.ma()){var m=k="",n="MenuTemplate";if(this.Ymb)k=wac_46a(),this.Ymb=!1,wac_b(5849610,202,10,"Rendering File>New with template error message");else if(a){try{l=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0),k=wac_56a(this,l,b),wac_b(5849612,202,50,"Rendering File>New with template buttons"),wac_mfa&&"OneDrive"===this.Rob()&&(m=wac_jQ("menuNewMoreTemplates",wac_kQ.Pwc,null,wac_lQ("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,
null,null,null,this.QNc.ma(),wac_mfa)))}catch(p){wac_b(5849613,202,10,"Failed to parse JSON response from template service {0}",{JsonToConvert:a}),k=wac_46a()}c.val=!0}else n="MenuLoading",k=wac_mQ("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText,null,null),wac_b(5849611,202,50,"Rendering File>New with template loading spinner");l=wac_jQ("menuNewTemplates",n,null,k)+m}else c.val=!0,wac_b(5849609,202,50,"Rendering File>New without template buttons due to BRS"),l="";k=d+(h+l)}l=(g=wac_66a("New",
k),f=f.val,g);f&&(this.Bhb=l,g=(new Date).getTime()-this.GNc,wac_b(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",{ElapsedMsSinceMenuOpened:g}));e.PopulationXML=l}return 32},xma:function(a,b){this.yl||3!==a.kg()?2===a.kg()&&(this.u0b=!0,wac_nQ(this)):(this.yl=a,b||wac_nQ(this))},Rob:function(){return this.$fa.ma()}};function wac_hQ(a){return a.zu.ma()}function wac_nQ(a){a.VWb=!0;wac_hQ(a).jn.ma().JE(a.yW.ma().iOa);a.VWb=!1}
function wac_56a(a,b,c){for(var d="",e=[],f=0;f<b.length;f++){var g=b[f],h="";if(g){var k=g.Title,l=g.AssetId,g=g.Thumbnails;if(l&&k&&g)var m,n,p,h=(p=wac_76a(a,g,n={val:m}),m=n.val,p),d=d+wac_lQ("jbtnNewTemplate"+f,k,null,m,null,h,c,l)}e[f]=h}b=new wac_D(4,1,5E3,function(){var a=Number.MAX_VALUE,b=Number.MIN_VALUE,c=window.performance;if(c&&"undefined"!==typeof c.getEntriesByName){for(var d=0;d<e.length;d++){var f=c.getEntriesByName(e[d]);f&&0<f.length&&(f=f[0],a=Math.min(window.parseInt(f.fetchStart),
a),b=Math.max(window.parseInt(f.responseEnd),b))}b>a&&wac_b(5849601,202,50,"Total time to download template thumbnails {0}",{TotalElapsedMs:b-a,MinFetchStart:a,MaxResponseEnd:b})}},106,null,!1);wac_hQ(a).Pc.ma().Hb(b);return d}
function wac_76a(a,b,c){var d=0;c.val="";for(var e=0;e<b.length;e++)if("ST"===b[e].ImageType){d=e;break}var f=b.length?b[d]:null;b=f?f.Url||"":"";var g,h=e=d=!1;if(f&&(g=f.AspectRatio))a=window.parseFloat(g),1>a?d=!0:1.5<a?e=!0:1===a&&(h=!0);else switch(wac_b(5849603,202,10,"Thumbnail aspect ratio missing {0}",{Url:b}),wac_gQ(wac_hQ(a))){case 3:d=!0;break;case 2:e=!0;break;case 5:h=!0}c.val=d?"95by123":e?"123by69":h?"100by100":"123by95";return b}
function wac_16a(a){if(!a.xYa.ma()||!wac_26a(a))return null;if(a.eEa&&!a.Ymb){var b="9",c=wac_.pa.Qb;"NumberOfTemplatesInBackstage"in c&&(b=c.NumberOfTemplatesInBackstage);b=String.format(wac_hQ(a).jO()+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",wac_Cf(wac_.vh.toString()),wac_Cf(a.vX()),b);Boolean.parse(c.AppendOriginQueryParam||"false")&&(b+="&org=backstage");b+="&"+wac_Ug();wac_.Tma&&(b+="&"+wac_Vg());wac_hQ(a).$g.ma().lk(b,1,null,null,!1,2,function(b){wac_dQ(wac_hQ(a),"CreateNewActor.GetTemplateListJson",
b.Aa,"");a.pSc=b.Aa.Be;a.eEa=!1;wac_nQ(a);wac_r()&&wac_r().Hd().JVe()&&window.appChrome.api.dispatch(window.appChrome.actions.setFileMenuTemplateJson(a.pSc))},function(b){wac_dQ(wac_hQ(a),"CreateNewActor.GetTemplateListJson",b.Aa,"");a.eEa=!0;a.Ymb=!0;wac_nQ(a)},null,null,!1,null,null,"5",null,!1,null,!1,null);a.eEa=!1}return a.pSc}function wac_26a(a){return!wac_hQ(a).qra.ma()||!!a.yl&&3===a.yl.kg()&&!!a.yl.Wba&&!!a.yl.BI}function wac_oQ(){wac_oQ.initializeBase(this)}
function wac_b7c(a){return(wac_g7a||(wac_g7a=new wac_oQ)).Tr(a)}wac_oQ.prototype={Lwd:function(){wac_LO(this,0,CommonUIStrings.l_OpenMenuEmptyMruMessage);wac_LO(this,1,CommonUIStrings.l_OpenMenuServerErrorMessage);wac_LO(this,2,CommonUIStrings.l_Open);wac_LO(this,3,CommonUIStrings.l_OpenMenuRecentDocuments);wac_LO(this,4,CommonUIStrings.l_OpenMenuMoreOnHost);wac_LO(this,5,CommonUIStrings.l_VoicedLoadingText)}};
function wac_86a(a,b,c,d,e,f,g){this.Imd=Function.createDelegate(this,this.aXd);this.ued=Function.createDelegate(this,this.uMd);this.zu=a;this.vs=b;this.dCa=c;this.NGc=d;this.MGc=e;this.WJ=new (wac_f.$$(wac_nc.$$(wac_sc)))(function(){return new (wac_9P.$$(wac_sc))(f.ma(),null)});var h=this;this.kKc=new (wac_f.$$(wac_nc.$$(wac_vc)))(function(){return new (wac_9P.$$(wac_vc))(g.ma(),h.ued)});this.CWf=wac_q(wac_.pa,"WacInTabOpenMRUIsEnabledForUiHost");this.ZWf=wac_q(wac_.pa,"UiHostSupportsDocRebootFeatures")}
wac_86a.prototype={zu:null,tTb:null,aob:!0,Ahb:"",Z7d:0,oWa:null,NGc:null,MGc:null,vs:null,dCa:null,DXb:3,kKc:null,WJ:null,CWf:!1,ZWf:!1,uMd:function(a,b){this.oWa=a;b||wac_96a(this)},aXd:function(a,b,c,d,e){if(1!==c&&e){c=3;a=!1;if(this.Ahb&&this.Z7d===this.oWa.Dtc)wac_b(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",{CacheRefresh:"Not Dirty"}),c=this.DXb;else{wac_b(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",{CacheRefresh:"Starting"});b=(0,this.Ov().BW)();
this.oWa=this.kKc.ma().XU("File Open opened",!0);if(this.Ahb&&2!==this.DXb&&3!==this.oWa.kg())a=!0;else{var f;try{f=wac_ai(this.oWa.kBb)}catch(q){f=null,wac_b(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",q)}wac_r()&&wac_r().Hd().JVe()&&wac_7k()&&f&&window.appChrome.api.dispatch(window.appChrome.actions.setFileMenuMRUJson(f));var g;d=this.oWa;f=c={val:c};if(1!==d.kg()&&d.kg())if(3===d.kg()&&d.kBb){d=d.kBb;var h,k=this.dCa.ma().FMa||"1959943459";if(d.length){h=
wac_mQ("lblRecentDocuments",wac_pQ(this)(3),null,null);for(var l=0,m=0;m<d.length;m++){var n=d[m];"FileName"in n&&"DocumentUrl"in n&&"Path"in n&&(h+=wac_lQ("MruButton"+m,n.FileName.toString(),n.Path.toString(),null,this.dCa.ma().$Oa,this.dCa.ma().ZOa,k,n.DocumentUrl.toString()),n.IsPinned&&l++)}h=wac_jQ("RecentDocumentsMenuSection",wac_kQ.lAc,wac_pQ(this)(2),h);wac_b(5849665,202,50,"Open menu XML built {0}",{Display:"MRU List",TotalDocuments:d.length,NumPinnedDocuments:l})}else h=wac_iQ(wac_pQ(this)(0),
wac_pQ(this)(2),null,null),wac_b(5849664,202,50,"Open menu XML built {0}",{Display:"Empty MRU"});d=h;f.val=0}else wac_b(5849634,202,50,"Open menu XML built {0}",{Display:"Server Error"}),d=wac_iQ(wac_pQ(this)(1),wac_pQ(this)(2),null,null),f.val=1;else wac_b(5849635,202,50,"Open menu XML built {0}",{Display:"Spinner"}),f.val=2,d=wac_36a(wac_pQ(this)(2),wac_pQ(this)(5));this.Ahb=(g=d,c=c.val,g)}g=(0,this.Ov().BW)()-b;wac_b(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",{CacheRefresh:"Complete",
ElapsedMs:g})}2!==c&&(g={DisplayState:wac_$6a.toString(c)},1!==c&&(g.IsStale=a),wac_b(5849630,202,50,"MRU section display state {0}",g));this.DXb=c;if(this.aob){wac_b(5849632,202,50,"Open menu Browse More Link creation necessary.");var p;a=g={val:this.aob};a.val=!0;c=this.NGc.ma();b=this.MGc.ma();c&&b||!this.Ov().qra.ma()?a.val=!1:(f=this.yob().XU("File Open",!1),3===f.kg()&&(c=f.BI,b=f.Wba,a.val=!1));a=b?String.format(wac_pQ(this)(4),b):null;b=this.dCa.ma().FMa;f=wac_q(wac_.pa,"WacInTabOpenMRUIsEnabledForUiHost");
d=wac_q(wac_.pa,"UiHostSupportsDocRebootFeatures");wac_b(594383695,202,50,"[InTabOpenMRUIsEnabledForUiEmbed: {0}][UiEmbedSupportsDocReboot: {1}]",f,d);h="";c&&a&&(h=wac_jQ("BrowseMoreMenuSection",wac_kQ.Pwc,null,wac_lQ("btnBrowseMore",a,a,null,null,null,f&&d?"1813655452":b||"1959943459",c)));this.tTb=(p=h,this.aob=g.val,p)}else wac_b(5849631,202,50,"Open menu Browse More Link creation not required.");wac_b(5849633,202,50,"Browse More link display state {0}",{WaitingOnLinkInfo:this.aob,NotDisplayingLink:!this.tTb});
e.PopulationXML=wac_66a("Open",this.Ahb+this.tTb)}return 32},Ov:function(){return this.zu.ma()},yob:function(){return this.WJ.ma()}};function wac_pQ(a){return a.vs.ma()}function wac_96a(a){a.Ov().jn.ma().JE(a.dCa.ma().iOa)}function wac_a7a(a){a.Ov().Ia.ma().jf(2799130311,2147483648,a.Imd,96)}function wac_$6a(){}wac_$6a.prototype={success:0,failure:1,spinner:2,none:3};wac_$6a.registerEnum("Common.App.NewAndOpen.UX.MruRenderer.DisplayState",!1);function wac_kQ(){}
function wac_36a(a,b){return wac_jQ("LoadingMenuSection",wac_kQ.NLd,a,wac_mQ("lblLoading",b,null,null))}function wac_iQ(a,b,c,d){return wac_jQ("MessageMenuSection",wac_kQ.lAc,b,wac_mQ("lblMessage",a,c,d))}function wac_46a(){return wac_mQ("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage,null,null)}
function wac_mQ(a,b,c,d){var e=d;b&&0<b.length&&(e=wac_Ve(wac_b7a,b).trimEnd(),e=0<=e.indexOf("{0}")?String.format(e,d):String.format("{0} {1}",e,d));c=c&&d?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',wac_kf(c),wac_kf(d),wac_kf(e)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',wac_kf(a||""),wac_Ve(wac_b7a,wac_kf(b||"")),c)}
function wac_lQ(a,b,c,d,e,f,g,h){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',wac_kf(a||""),wac_kf(b||""),wac_kf(c||""),d||"32by32",wac_kf(e||""),wac_kf(f||""),g,wac_kf(h||""))}function wac_66a(a,b){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',a,b)}
function wac_jQ(a,b,c,d){c=c?String.format('Title="{0}"',wac_kf(c)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',wac_kf(a||""),wac_kf(b||""),c,d)}function wac_qQ(a,b,c,d){this.yW=a;this.$fa=b;this.zu=c;this.jKc=d}
wac_qQ.prototype={yW:null,$fa:null,zu:null,jKc:null,Db:function(a,b,c){return new wac_c7a(a,b,c,this.yW,this.$fa,this.zu,this.jKc)}};function wac_d7a(a,b,c,d){this.Rya=a;this.zJ=b;this.zEc=c;this.Fwc=d}wac_d7a.prototype={Rya:null,zJ:null,zEc:null,Fwc:null};
function wac_c7a(a,b,c,d,e,f,g){this.zed=Function.createDelegate(this,this.HMd);this.Aed=Function.createDelegate(this,this.IMd);this.Sja=Function.createDelegate(this,this.xma);this.ZNc=a;this.Eqa=b;this.VWa=c;this.yW=d;this.$fa=e;this.zu=f;var h=this;this.WJ=new (wac_f.$$(wac_nc.$$(wac_sc)))(function(){return new (wac_9P.$$(wac_sc))(g.ma(),h.Sja)})}
wac_c7a.prototype={yl:null,SQc:!1,fHc:0,pfa:0,VWa:null,ZNc:null,Eqa:null,yW:null,$fa:null,zu:null,WJ:null,mNa:function(){!this.yl&&this.zu.ma().qra.ma()?this.yob().XU("NewDocumentFromStream",!0):wac_e7a(this)},xma:function(a){if(!this.yl&&3===a.kg())this.yl=a;else if(2===a.kg()){this.SQc?wac_b(24904471,202,10,"After second try GetMoreResult still fail."):(this.yob().XU("NewDocumentFromStream",!0),this.SQc=!0);return}wac_e7a(this)},IMd:function(a){if(a&&a.Aa&&a.Aa.Be){var b,c,d;(d=wac_dP(Object,a.Aa.Be,
c={val:b}),b=c.val,d)?(a=b,200!==a.StatusCode&&201!==a.StatusCode?(wac_b(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.vX(),this.pfa,a.StatusCode),this.Eqa(null)):a.NewDocumentUrl&&""!==a.NewDocumentUrl?(b=(new Date).getTime()-this.fHc,wac_b(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",this.vX(),this.pfa,b),this.ZNc(a.NewDocumentUrl)):(wac_b(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",
this.vX(),this.pfa),this.Eqa(null))):(wac_b(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.vX(),this.pfa,{ResponseData:wac_qP(a.Aa.Be)}),this.Eqa(null))}else wac_b(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",this.vX(),this.pfa),this.Eqa(null)},HMd:function(a){a&&a.Aa&&wac_b(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",
this.vX(),this.pfa,a.Aa.Sd);this.Eqa(null)},vX:function(){switch(wac_gQ(this.zu.ma())){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null},Rob:function(){return this.$fa.ma()},yob:function(){return this.WJ.ma()}};
function wac_e7a(a){a.fHc=(new Date).getTime();var b=a.yW.ma().KFb;if(null===b)a.Eqa(null);else{var c=a.VWa.Rya,d=a.VWa.zJ,e=a.VWa.zEc,f=a.VWa.Fwc;a.pfa="streamBase64"===e?f.length/1024:0;wac_b(35156358,202,50,"FileType:{0}, FileSize:{1}",a.vX(),a.pfa);var g=(new Date).getTime(),b=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",b,wac_Cf(a.Rob()),wac_Cf(c),wac_Cf(a.vX()),wac_Cf(wac_.vh.toString()),wac_Cf(g.toString()),wac_Cf(d),
wac_Cf(wac_.VD),wac_.eo,wac_Cf(e)),b=b+("&"+wac_Ug());wac_.Tma&&(b+="&"+wac_Vg());(c=a.yl?a.yl.BI:null)&&(b+="&DestinationUrl="+wac_Cf(c));a.zu.ma().$g.ma().lk(b,2,f,{"Content-Type":"application/json; charset=utf-8"},!0,2,a.Aed,a.zed,null,null,!1,null,null,"31",null,!1,null,!1,null)}}function wac_f7a(){this.dispose=this.O}
wac_f7a.prototype={Ub:function(){return"Common.App.NewAndOpen.UX"},gc:function(a){wac_m(wac_n(wac_o(a.fa(wac_qQ),wac__6a)),function(){return new wac_qQ(new (wac_f.$$(wac_Rh))(function(){return wac_r().Hd().yOa()}),new (wac_f.$$(String))(function(){return wac_0g}),new (wac_f.$$(wac_wc))(function(){return wac_k(a,wac_wc)}),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_k(a,wac_oc.$$(wac_sc))}))})},tb:function(){var a=this;wac_.pa.Ok(function(){a.aPa()})},aPa:function(){var a=wac_rP(wac_wc,
wac_l(wac_j(),wac_wc)),b=wac_rP(wac_oc.$$(wac_sc),wac_l(wac_j(),wac_oc.$$(wac_sc)));wac_0g&&wac_Db.WAA.call(null,a,b).CW(function(){var c=new wac_06a(new (wac_f.$$(wac_wc))(function(){return wac_Qb(a)}),new (wac_f.$$(wac_Rh))(function(){return wac_r().Hd().yOa()}),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_Qb(b)}),new (wac_f.$$(String))(function(){return wac_r().Hd().zOa().FMa||"1959943459"}),new (wac_f.$$(String))(function(){return wac_0g}),new (wac_f.$$(Boolean))(function(){return wac_Zfa}));
c.Tb();wac_nQ(c)});if(wac_1g){var c=wac_rP(wac_oc.$$(wac_vc),wac_l(wac_j(),wac_oc.$$(wac_vc)));wac_Db.WAA.call(null,a,b,c).CW(function(){var d=new wac_86a(new (wac_f.$$(wac_wc))(function(){return wac_Qb(a)}),new (wac_f.$$(Function))(function(){return wac_b7c}),new (wac_f.$$(wac_Sh))(function(){return wac_r().Hd().zOa()}),new (wac_f.$$(String))(function(){return wac__fa}),new (wac_f.$$(String))(function(){return wac_0fa}),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_Qb(b)}),new (wac_f.$$(wac_oc.$$(wac_vc)))(function(){return wac_Qb(c)}));
wac_a7a(d);wac_96a(d)})}},O:function(){}};wac_06a.registerClass("Common.App.NewAndOpen.UX.CreateNewActor");wac_oQ.registerClass("Common.App.NewAndOpen.UX.MruActorIntlHelper",wac_Fm.$$(wac_d.Qa.PG.BSa.LKb));wac_86a.registerClass("Common.App.NewAndOpen.UX.MruRenderer");wac_kQ.registerClass("Common.App.NewAndOpen.UX.NewAndOpenXmlUtilities");wac_qQ.registerClass("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory",null,wac__6a);wac_d7a.registerClass("Common.App.NewAndOpen.UX.NewDocumentParameters");
wac_c7a.registerClass("Common.App.NewAndOpen.UX.NewDocumentFromStreamOperation");(function(){}).registerClass("Common.App.NewAndOpen.UX.Program");wac_f7a.registerClass("Common.App.NewAndOpen.UX.UXPackageManager",null,wac_I,wac_i,Sys.IDisposable);var wac_g7a=null;wac_kQ.lAc="MenuMru";wac_kQ.NLd="MenuLoading";wac_kQ.cJd="MenuHeader";wac_kQ.Pwc="MenuFooter";var wac_b7a=wac_Ue("\n","&#10;");wac_J(wac_C(),new wac_f7a,0,!1);Type.registerNamespace("Common.App.OAuth");wac_d=window.Common||{};
wac_d.Qa=wac_d.Qa||{};wac_d.Qa.uRf=wac_d.Qa.uRf||{};function wac_y2c(){}wac_y2c.registerInterface("Common.App.OAuth.IOAuthManager");function wac_c7c(){}wac_c7c.registerInterface("Common.App.OAuth.ILegacyOAuthManager");function wac_d7c(){}function wac_e7c(){}function wac_f7c(){}function wac_g7c(){}function wac_h7c(){}function wac_i7c(){}function wac_j7c(){}function wac_k7c(){}function wac_l7c(){}
function wac_m7c(a,b,c){this.nTa=a;this.Pef=wac_q(c,"OAuthManagerEnableConsoleLogging");this.K$e=b;var d;this.N7d=(d=new wac_d7c,d.upn=wac_.pa.Qb.UserPrincipalName,d.authority=wac_p7.y5b?"https://login.microsoftonline.com/":wac_.pa.Qb.HostAuthAuthority,d.authorityType=wac_n7c(),d.tenantId=wac_.pa.Qb.TenantId,d);this.Aff=this.akf(c.Qb.OAuthManagerHostPathOverride);this.h7e=wac_Lg(c,"OAuthManagerPromiseTimeoutInMs",0)}
wac_m7c.prototype={nTa:null,Pef:!1,K$e:null,N7d:null,Aff:null,h7e:0,dmf:function(){var a=this;return wac_Jca.toPromise$o(wac_o7c(this.K$e)).then(function(){var b;a:{b=wac_p7c();if(wac_p7.y5b){var c;b=(c=new wac_j7c,c.appIds=[],c.idp=b,c.authority=a.N7d.authority,c.redirectUri=a.Aff,c.upn=a.N7d.upn,c.enableConsoleLogging=a.Pef,c);2===a.N7d.authorityType&&(b.tenantId=a.N7d.tenantId);b=wac_p7.Wkf.Load(b,wac_.Ag);wac_b(595342371,3E3,100,"WebAuthImplicitMsal package loaded.");b.Telemetry&&wac_b(595342370,
3E3,50,JSON.stringify(b.Telemetry))}else{switch(a.N7d.authorityType){case 2:var d,e=(d=new wac_f7c,d.appId=a.nTa,d.authority=a.N7d.authority,d.redirectUri=a.Aff,d.upn=a.N7d.upn,d),f;b=(f=new wac_e7c,f.idp=b,f.aadConfig=e,f.enableConsoleLogging=a.Pef,f);break;case 1:var g;f=(g=new wac_g7c,g.appId=a.nTa,g.authority=a.N7d.authority,g.redirectUri=a.Aff,g.upn=a.N7d.upn,g);b=(e=new wac_e7c,e.idp=b,e.msaConfig=f,e.enableConsoleLogging=a.Pef,e);break;default:wac_b(41003226,3E3,100,"Non-microsoft authentication authority: {0}. WebAuthImplicit package did not load.",
b);b=Promise.reject(!1);break a}wac_p7.vie.Load(b);wac_b(41003227,3E3,100,"WebAuthImplicit package loaded.")}b=Promise.resolve(!0)}return b})},Kxd:function(a,b,c,d){b!==this.nTa||wac_p7.y5b||(b=null);return(new wac_q7c(a,b,this.N7d.authorityType,c,d,this.h7e)).Kxd()},akf:function(a){var b=window.location.protocol,c=window.location.host;if(wac_h(a)){a=window.location.pathname;var d=a.lastIndexOf("/");a=0<=d?a.substring(0,d+1):""}return b+"//"+c+a+"WacOAuth.html"}};
function wac_q7c(a,b,c,d,e,f){this.FJ=a;this.qmf=b;this.dBf=c;this.ki=d;this.Kff=e;this.h7e=f}
wac_q7c.prototype={FJ:null,qmf:null,dBf:0,ki:null,h7e:0,Kff:!1,nff:0,pff:0,Kxd:function(){var a;a=wac_p7.y5b?wac_p7.Wkf.GetToken(this.ki,this.qmf,wac_.Ag,this.Kff).then(function(a){return a}):wac_p7.vie.GetToken(this.ki,this.Kff,this.qmf).then(function(a){return a});var b=this,c=this;return wac_r7c(this,a).then(function(a){a=wac_s7c(a,!0);a.IsSuccess?wac_b(41460759,3E3,50,"Successfully retreived token for app [{0}]",b.FJ):wac_b(41460760,3E3,15,"Failed to retrieve token for app [{0}]: {1}",b.FJ,JSON.stringify(a));
return a},function(a){a=wac_s7c(a,!1);if(("Timeout"===a.ErrorCode||"Token Renewal Failed"===a.ErrorCode)&&2>c.nff)return c.nff+=1,wac_b(42267907,3E3,100,"Retrying to retrieve token for app [{0}] attempt {1}: {2}",c.FJ,c.nff,JSON.stringify(a)),c.Kxd();if("login_required"===a.ErrorCode&&1===c.dBf&&2>=c.pff&&wac_q(wac_.pa,"WordOAuthTestAppPopUpIsEnabled"))return c.pff+=1,wac_b(41460762,3E3,100,"Retrying retrieve token for app [{0}] with popup enabled, attempt {1}: {2}",c.FJ,c.pff,JSON.stringify(a)),
c.Kff=!0,c.Kxd();wac_b(41460764,3E3,15,"Failed to retrieve token for app [{0}]: {1}",c.FJ,JSON.stringify(a));return a})}};function wac_r7c(a,b){if(0>=a.h7e)return b;var c=0;return Promise.race([b,new Promise(function(b){c=window.setTimeout(function(){var a=new wac_k7c;a.ErrorCode="Timeout";a.ErrorMessage="The Implicit package did not resolve the promise";b(a)},a.h7e)})]).then(function(a){window.clearTimeout(c);return a})}
function wac_s7c(a,b){var c=wac_p7.y5b?null:a,d=wac_p7.y5b?a:null,e=null,f=null,g=null,h=null;!wac_p7.y5b&&!c||wac_p7.y5b&&!d?(f="NoResult",g="No result came from WebAuthJsImplictModule.GetToken()"):wac_p7.y5b||!c.ErrorCode&&!c.ErrorMessage?wac_p7.y5b&&(d.ErrorCode||d.ErrorMessage)?(f=d.ErrorCode?d.ErrorCode:"Exception",g=d.ErrorMessage?d.ErrorMessage:"No message"):!wac_p7.y5b&&c.Token||wac_p7.y5b&&d.Token?b?e=wac_p7.y5b?d.Token:c.Token:(f="RejectToken",g="A rejected promise returned a token."):(f=
"Exception",g=JSON.stringify(a)):(f=c.ErrorCode?c.ErrorCode:"Exception",g=c.ErrorMessage?c.ErrorMessage:"No message");d&&d.Telemetry&&(h=d.Telemetry,wac_b(595150290,3E3,50,JSON.stringify(h)));if(f||g)e=null;var k;return k=new wac_l7c,k.IsSuccess=!!e,k.Token=e,k.ErrorCode=f,k.ErrorMessage=g,k.Telemetry=h,k}function wac_n7c(){var a=0,b=wac_p7c();"aad"===b.toLowerCase()?a=2:"msa"===b.toLowerCase()&&(a=1);return a}function wac_p7c(){return wac_.pa.Qb.HostAuthType}
function wac_t7c(a,b){this.K$e=new wac_u7c(a);this.J$e=b;wac_b(42084323,3E3,100,"OAuthManager Created")}wac_t7c.prototype={K$e:null,J$e:null,cff:null,kBf:!1,b4e:function(a,b){return wac_v7c(this,a,b)}};
function wac_v7c(a,b,c){function d(){if(a.kBf)return a.J$e.Kxd(b,f,c,!1);var d;return Promise.resolve((d=new wac_l7c,d.IsSuccess=!1,d.Token=null,d.ErrorCode="InitFailed",d.ErrorMessage="Package failed to initialize.",d))}wac_b(42084352,3E3,50,"OAuthManager TryGetToken(appName={0}, target={1}) called",b,c);if(!wac_q(wac_.pa,"OAuthManagerIsEnabled")){var e;return Promise.resolve((e=new wac_l7c,e.IsSuccess=!1,e.Token=null,e.ErrorCode="NotEnabled",e.ErrorMessage="OAuthManager is disabled.",e))}e=wac_p7c();
var f=null;"aad"===e.toLowerCase()?f=wac_yhb[b]:"msa"===e.toLowerCase()&&(f=wac_dib[b]);if(wac_h(f)){wac_b(41961345,3E3,15,"Auth context not found. Ensure that your app [{0}] is listed in WacFrameImplicitAuthAADApplications or WacFrameImplicitAuthMSAApplications.",b);var g;return Promise.resolve((g=new wac_l7c,g.IsSuccess=!1,g.Token=null,g.ErrorCode="DisallowedApp",g.ErrorMessage="Disallowed appName: "+b,g))}a.J$e||(a.J$e=new wac_m7c(f,a.K$e,wac_.pa));a.cff||(a.cff=a.J$e.dmf().then(function(){a.kBf=
!0;wac_b(42084353,3E3,100,"OAuthManager initialized for app [{0}]",b);return null},function(){wac_b(42267908,3E3,10,"OAuthManager failed to initialized for app [{0}], all future TryGetToken requests will fail.",b);return null}));return a.cff=a.cff.then(function(){return d()},function(){return d()})}function wac_w7c(){}
wac_w7c.prototype={Ub:function(){return"Common.App.OAuth.OAuthPackage"},gc:function(a){wac_m(wac_n(a.fa(wac_y2c)),function(){return new wac_t7c(a.H(wac_Kc),null)})},tb:function(){wac_j().H(wac_y2c)},O:function(){}};function wac_p7(){}function wac_u7c(a){this.JCf=a}wac_u7c.prototype={JCf:null};
function wac_o7c(a){var b=wac_af(wac_p7.y5b?"webauth.implicit.msal":"webauth.implicit",2),c=wac_af("es6-promise.auto",2);window.self.WebAuthImplictScriptUrl=b;window.self.Es6PromisePolyfillJs=c;return wac_NO(a.JCf,b).CW(function(){var a=window.self.Implicit;wac_p7.vie=wac_p7.y5b?null:a;wac_p7.Wkf=wac_p7.y5b?a:null;wac_b(41003229,3E3,100,"WebAuth package loaded")})}wac_d7c.registerClass("Common.App.OAuth.AuthContext");wac_e7c.registerClass("Common.App.OAuth.ImplicitAuthConfig");wac_h7c.registerClass("Common.App.OAuth.Config");
wac_f7c.registerClass("Common.App.OAuth.AadConfig",wac_h7c);wac_g7c.registerClass("Common.App.OAuth.MsaConfig",wac_h7c);wac_i7c.registerClass("Common.App.OAuth.ImplicitAuthResult");wac_j7c.registerClass("Common.App.OAuth.ImplicitAuthMsalConfig");wac_k7c.registerClass("Common.App.OAuth.ImplicitAuthMsalResult",wac_i7c);(function(){}).registerClass("Common.App.OAuth.ImplicitLoadResult");wac_l7c.registerClass("Common.App.OAuth.OAuthResult");
wac_m7c.registerClass("Common.App.OAuth.LegacyOAuthManager",null,wac_c7c);wac_q7c.registerClass("Common.App.OAuth.LegacyOAuthManager.RetryableGetToken");(function(){}).registerClass("Common.App.OAuth.OAuthIdentity");wac_t7c.registerClass("Common.App.OAuth.OAuthManager",null,wac_y2c);wac_w7c.registerClass("Common.App.OAuth.OAuthPackage",null,wac_I,wac_i);wac_p7.registerClass("Common.App.OAuth.WebAuthJsImplicitModule");wac_u7c.registerClass("Common.App.OAuth.OAuthPackageLoader");wac_p7.vie=null;
wac_p7.Wkf=null;wac_p7.y5b=wac_.pa?wac_q(wac_.pa,"ImplicitAuthMSALIsEnabled"):!1;wac_J(wac_C(),new wac_w7c,0,!1);Type.registerNamespace("Common.App.OneDriveFilePickerApi");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.KVd=wac_d.Qa.KVd||{};function wac_h7a(){}wac_h7a.registerInterface("Common.App.OneDriveFilePickerApi.IErrorDialog");function wac_rQ(){}wac_rQ.registerInterface("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper");function wac_sQ(){}wac_sQ.registerInterface("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager");
function wac_tQ(){wac_tQ.initializeBase(this);wac_Nh(this,0);wac_Oh(this,1,CommonUIStrings.l_DialogClose)}wac_tQ.prototype={Xp:function(a){this.hs(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)},Jca:function(a){this.hs(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)}};function wac_i7a(){}
function wac_j7a(a){this.q$c=Function.createDelegate(this,this.JEd);this.r$c=Function.createDelegate(this,this.KEd);this.$g=a;this.ymb=3}
wac_j7a.prototype={uo:null,$g:null,ymb:0,JEd:function(a){if(412===a.Aa.ho&&"X-NewKey"in a.Aa.ti){wac_b(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var b={};b["X-Key"]=a.Aa.ti["X-NewKey"];wac_k7a(this,b)}else 0<this.ymb?(wac_b(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.ymb),this.ymb--,wac_k7a(this,null)):(wac_b(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),
this.uo.SX(Error.create("GetMoreInfo request failed and no more retries remain")))},KEd:function(a){"PersonalFileStorageUrl"in a.Aa.ti&&""!==a.Aa.ti.PersonalFileStorageUrl?(wac_b(24134239,352,50,"Successfully received an ODB endpoint"),this.uo.Ze(a.Aa.ti.PersonalFileStorageUrl)):(wac_b(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.uo.SX(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))}};
function wac_k7a(a,b){var c=String.format("GetMoreInfoHandler.ashx?{0}",wac_.hBd);wac_bj(a.$g,c,1,null,b,["PersonalFileStorageUrl","X-NewKey"],2,a.r$c,a.q$c,null,null,null,"21",!1,null,null)}function wac_uQ(a,b,c,d,e,f){wac_uQ.initializeBase(this,[b,c,d,f]);this.Z1=a;this.GRc=e}
wac_uQ.prototype={Z1:null,GRc:null,LOc:null,lFa:function(){return this.h4.Qb.OneDriveApiUrl},Wd:function(a,b){this.LOc=a;this.Kbc(b)},bJb:function(){window.WL.init(1===this.txb||2===this.txb?{client_id:this.h4.Qb.UploadToSkyDriveClientId}:{client_id:this.h4.Qb.UploadToSkyDriveClientId,env:"INT"})},Kbc:function(a){this.b0=a;!this.uqa&&wac_pi()?(wac_b(17909025,352,50,"User is signed in. We will show file picker."),this.Kn(this.Gdc)):(wac_b(17909026,352,50,"User is not signed in. show need to sign in dialog."),
this.GRc())},Qbb:function(){try{wac_b(17909027,352,50,"Launching file dialogue"),window.WL.fileDialog(this.LOc).then(this.EJa,this.pJa)}catch(a){wac_b(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",a,a.stack),this.Im()}},Py:function(a){if(a&&a.error){if("user_canceled"===a.error.code){wac_b(17909058,352,50,"User canceled.");return}wac_b(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",a.error.code,a.error.message)}else wac_b(17909060,352,50,"File Dialog returned with no response");
this.b0&&this.b0(!1,a);this.Im()}};function wac_vQ(a,b,c,d,e){this.msd=Function.createDelegate(this,this.UEc);wac_vQ.initializeBase(this,[a,b,c,d]);this.A6d=e;this.Up={};this.Up.clientId=this.h4.Qb.OneDriveApiV7ClientId;this.Up.cancel=this.msd}
wac_vQ.prototype={A6d:null,v7d:null,ZVb:null,Up:null,lFa:function(){return this.h4.Qb.OneDriveApiV72Url},bJb:function(){var a=this;this.Up.success=function(b){var d={};d.data=b;a.xA(d)};var b=this;this.Up.error=function(a){var d={};d.error=a;b.Py(d)};this.Up.advanced={};this.Up.advanced.linkType="share";this.Up.advanced.endpointHint=this.v7d;this.Up.advanced.iframeParentDiv=this.ZVb},Qbb:function(){try{wac_b(22090007,352,50,"Launching OneDrive file picker dialog"),this.UEc(),window.OneDrive.open(this.Up)}catch(a){wac_b(22090008,
352,10,"Opening OneDrive file picker threw an exception: {0}",a.message),this.Im()}},Py:function(a){this.b0&&this.b0(!1,a);this.Im()},UEc:function(){this.ZVb.style.visibility="hidden"===this.ZVb.style.visibility?"":"hidden"}};function wac_wQ(a,b,c,d){wac_wQ.initializeBase(this,[a,b,c,d]);this.Up={};this.Up.advanced={};this.Up.action="query";this.Up.clientId=this.h4.Qb.OneDriveApiV72ClientId;this.Up.advanced.trapFocus=!0}
wac_wQ.prototype={Up:null,lFa:function(){return this.h4.Qb.OneDriveApiV72Url},Wd:function(a,b,c,d){this.Up.advanced.iframeParentDiv=c;this.Up.advanced.endpointHint=d;this.Up.cancel=b;this.Kbc(a)},Kbc:function(a){this.b0=a;this.uqa?wac_b(24391838,216,50,"In limited edit mode, will not show Picker."):(wac_b(24391837,216,50,"Not in limited edit mode, will show file picker."),this.Kn(this.Gdc))},bJb:function(){var a=this;this.Up.success=function(b){var d={};d.data=b;a.xA(d)};var b=this;this.Up.error=
function(a){var d={};d.error=a;b.Py(d)}},Qbb:function(){try{wac_b(23881879,216,50,"Launching OneDrive file picker dialog"),window.OneDrive.save(this.Up)}catch(a){wac_b(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",a.message,a.stack),this.Im()}},pMb:function(a){wac_b(25180160,216,15,"Failure during OneDrive API download: {0}",a.qo?a.qo.toString():"No error detail.");a=this.lFa();var b=wac_tl();a in b.ZDa&&delete b.ZDa[a];this.qDa=null},Im:function(){this.Ro().Jca(35)},
Py:function(a){this.b0&&this.b0(!1,a)}};function wac_xQ(a,b,c,d){this.pJa=Function.createDelegate(this,this.Py);this.EJa=Function.createDelegate(this,this.xA);this.Gdc=Function.createDelegate(this,this.ANd);this.dispose=this.O;this.h4=a;this.txb=b;this.uqa=c;this.Ro=d}
wac_xQ.prototype={Ro:null,txb:0,h4:null,b0:null,uqa:!1,Jqa:null,i0b:!1,h0b:!1,qDa:null,Kn:function(a){this.Jqa=a;if(this.i0b||this.h0b)this.i0b&&this.Jqa&&this.Jqa(!0);else if(a=wac_yQ(this)){this.h0b=!0;var b=this;wac_2gc(a).CW(function(a){b.h0b=!1;if(wac_Fb(a))b.pMb(a),b.Jqa(!1);else try{b.i0b=!0,wac_b(17909022,352,50,"Initializing OneDrive API"),b.bJb(),wac_b(17909023,352,50,"OneDrive API is initialized."),b.Jqa(!0)}catch(d){wac_b(20555412,352,10,"Failed during OneDrive API init: {0}",d.toString()),
b.Jqa(!1)}});wac_ul(a)}else wac_b(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.Jqa(!1)},pMb:function(a){wac_b(20509838,352,15,"Failure during OneDrive API download: {0}",a.qo?a.qo.toString():"No error detail.")},ANd:function(a){a?this.Qbb():this.Im()},Im:function(){this.Ro().Xp(34)},xA:function(a){wac_b(17909057,352,50,"Success Callback called. Calling callback function.");this.b0&&this.b0(!0,a)},O:function(){this.qDa&&this.qDa.O()}};
function wac_yQ(a){a.qDa||(a.qDa=a.lFa()?wac_Ll(a.lFa(),null,null,null,!1,!1,null,!0,!1):null);return a.qDa}function wac_zQ(a,b,c,d){wac_zQ.initializeBase(this,[a,b,c,d]);this.Up.advanced.filter=a.Qb.OneDriveApiV72Filter||"folder,photo";this.Up.advanced.linkType="download";this.Up.multiSelect=wac_.Buc;wac_q(a,"OneDriveApiV72CommandModeEnabled")&&(this.Up.commandMode=a.Qb.OneDriveApiV72CommandMode||"none")}
wac_zQ.prototype={lFa:function(){return this.h4.Qb.OneDriveApiV72Url},Qbb:function(){try{wac_b(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}",this.Up.advanced.filter,this.Up.commandMode),window.OneDrive.open(this.Up)}catch(a){wac_b(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",a.message,a.stack),this.Im()}}};function wac_l7a(){}
wac_l7a.prototype={sa:null,Ub:function(){return"Common.App.OneDriveFilePickerApi"},tb:function(){},O:function(){},gc:function(a){this.sa=a;wac_m(wac_n(wac_o(this.sa.fa(wac_uQ),wac_sQ)),function(){return new wac_uQ(wac_qi(),wac_.pa,wac_Kg,wac_.rC,wac_23a,function(){return new wac_tQ})});wac__g?wac_m(wac_n(this.sa.fa(wac_rQ)),function(){return new wac_i7a}):wac_m(wac_n(this.sa.fa(wac_rQ)),function(){return new wac_j7a(wac_.Af)});var b=this;wac_m(wac_n(this.sa.fa(wac_vQ)),function(){return new wac_vQ(wac_.pa,
wac_Kg,wac_.rC,function(){return new wac_tQ},b.sa.H(wac_rQ))});wac_m(wac_n(this.sa.fa(wac_wQ)),function(){return new wac_wQ(wac_.pa,wac_Kg,wac_.rC,function(){return new wac_tQ})});wac_m(wac_n(this.sa.fa(wac_zQ)),function(){return new wac_zQ(wac_.pa,wac_Kg,wac_.rC,function(){return new wac_tQ})})}};wac_tQ.registerClass("Common.App.OneDriveFilePickerApi.ErrorDialog",wac_di,wac_h7a);wac_i7a.registerClass("Common.App.OneDriveFilePickerApi.OneDriveConsumerEndpointHelper",null,wac_rQ);
wac_j7a.registerClass("Common.App.OneDriveFilePickerApi.OneDriveForBusinessEndpointHelper",null,wac_rQ);wac_xQ.registerClass("Common.App.OneDriveFilePickerApi.AOneDriveFilePickerApiManager",null,wac_sQ,Sys.IDisposable);wac_uQ.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5",wac_xQ);wac_vQ.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7",wac_xQ);wac_wQ.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72",wac_xQ);
wac_zQ.registerClass("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72",wac_wQ);wac_l7a.registerClass("Common.App.OneDriveFilePickerApi.PackageManager",null,wac_I,wac_i);wac_J(wac_C(),new wac_l7a,0,!1);Type.registerNamespace("Common.App.SaveAsToHost");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.h0d=wac_d.Qa.h0d||{};function wac_HQ(){}wac_HQ.registerInterface("Common.App.SaveAsToHost.IErrorRetryDialogFactory");function wac_P7a(){}wac_P7a.registerInterface("Common.App.SaveAsToHost.IErrorRetryDialog");
function wac_Q7a(){}wac_Q7a.registerInterface("Common.App.SaveAsToHost.IFileNameDialogFactory");function wac_R7a(){}wac_R7a.registerInterface("Common.App.SaveAsToHost.IFileNameDialog");function wac_S7a(){}wac_S7a.registerInterface("Common.App.SaveAsToHost.IUploadToHostManager");function wac_T7a(){}function wac_U7a(a,b){this.Dc=a;this.Ia=b;this.nfa=wac_q(this.Dc,"SaveToHostWithExtraCharsInFileName")}wac_U7a.prototype={Ia:null,Dc:null,nfa:!1,Db:function(){return new wac_V7a(this.Ia,this.nfa)}};
function wac_V7a(a,b){this.Dwb=Function.createDelegate(this,this.yPb);wac_V7a.initializeBase(this);this.Ia=a;this.nfa=b;this.Sba=!1}
wac_V7a.prototype={Ia:null,nfa:!1,zDa:!1,iz:null,Xp:function(a,b,c){this.iz=b;this.zDa=c;wac_b(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",a,c);(a=wac_W7a(a))?(wac_Nh(this,0),wac_Oh(this,1,CommonUIStrings.l_DialogClose)):(wac_Nh(this,6),wac_Oh(this,0,CommonUIStrings.l_DialogClose));a||wac_b(8194009,216,50,"Show standard error dialog.");this.hs(26,wac_X7a(a),wac_Y7a(this,a,b),this.Dwb,!0)},yPb:function(a){1===a?(wac_b(8194010,216,50,"User click to retry button in error dialog."),
this.iz?this.Ia.Wj(2316717900,2,[this.iz,this.zDa],null):this.Ia.yw(2316717900,2,null)):wac_b(8194011,216,50,"User cancel the error dialog.")}};function wac_X7a(a){a=wac_W7a(a);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][a]}
function wac_Y7a(a,b,c){b=wac_W7a(b);return a.nfa?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,c),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][b]:[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,
String.format(CommonUIStrings.l_OverwriteTargetText,c),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][b]}function wac_W7a(a){return 0>a||6<a?(wac_b(8194012,216,15,"Unexpected error code {0}.",a),0):a}function wac_IQ(a,b,c,d,e,f){this.Ia=b;this.Dc=a;this.Xy=d;this.o2=f;this.Ro=e;this.Xi=c}wac_IQ.prototype={Ia:null,Xy:null,o2:null,Ro:null,Dc:null,Xi:null,Db:function(){return new wac_Z7a(this.Dc,this.Ia,this.Xi,this.Xy,this.Ro,this.o2)}};
function wac_Z7a(a,b,c,d,e,f){wac_Z7a.initializeBase(this,[a,b,c,d,e,f,null]);this.po=wac_WO(wac_T7a.Hxa,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite);this._id="FileNameDialog-SaveAsToHost"}wac_Z7a.prototype={n_:function(a,b){var c=wac_kP(wac_.dJ.lw);this.Zp(CommonUIStrings.L_SaveAs,this.w4a,{txtFileName:a||c,lblFolderName:CommonUIStrings.l_ToCurrentFolder,chkOverwrite:b});wac__7a(this,a,c)}};
function wac_JQ(a,b,c,d,e,f,g){this.T4a=Function.createDelegate(this,this.APd);this.w4a=Function.createDelegate(this,this.WGb);wac_JQ.initializeBase(this,[!1,!1,!1,!1]);this.Ia=b;this.Xy=d;this.o2=f;this.Dc=a;this.Ro=e;this.Xi=c;this.nfa=wac_q(this.Dc,"SaveToHostWithExtraCharsInFileName");this.WVe=g;wac_Oh(this,1,CommonUIStrings.l_SaveButtonLabel)}
wac_JQ.prototype={XE:null,Ro:null,o2:null,Ia:null,Xy:null,Dc:null,Xi:null,nfa:!1,WVe:null,oIb:function(){var a=wac_kP(wac_.dJ.lw);wac_8m(this,1,!!this.XE&&""!==this.XE.value&&this.XE.value!==a)},APd:function(){if(this.XE){var a=this;window.setTimeout(function(){a.oIb()},0)}},WGb:function(a,b){if(1!==a)wac_b(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{a=b.txtFileName;b="chkOverwrite"in b?b.chkOverwrite:!1;wac_b(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",
wac_Lea(a),b);var c=wac_If(wac_.Vxa);(a=a?a.trim():null)&&""!==a&&""!==c||1===this.Xi.kg()?wac_07a(this,a)?this.Ro.Db().Xp(1,a,b):this.o2.xea(a+c,b,this.WVe):this.Ro.Db().Xp(2,a,b)}},dispose:function(){this.XE&&(wac_jg(this.XE,"change",this.T4a),wac_jg(this.XE,"input",this.T4a),this.XE=null);wac__m.prototype.dispose.call(this)}};
function wac_07a(a,b){return a.nfa?(new RegExp("["+'\\/:*?"<>|'.replace(/[.*+?|()\[\]{}\\]/g,"\\\\$&")+"]")).test(b):(new RegExp("["+'\\/:*?"<>|#{}%~&'.replace(/[.*+?|()\[\]{}\\]/g,"\\\\$&")+"]")).test(b)}function wac__7a(a,b,c){wac_8m(a,1,!!b&&b!==c);a.XE=document.getElementById("txtFileName");wac_tf(a.XE,"change",a.T4a);wac_tf(a.XE,"input",a.T4a);a.XE.focus()}function wac_KQ(a,b,c){this.bic=Function.createDelegate(this,this.i0d);this.o2=c;this.WUa=b;this.Dc=a}
wac_KQ.prototype={Dc:null,WUa:null,o2:null,Tb:function(){2===wac_r().Hd().Nv()?wac_z().jf(2316717900,2147483648,this.bic,4):wac_z().ja(2316717900,2147483648,this.bic)},i0d:function(a,b,c,d,e){return 2147483648!==b.Bd()||2316717900!==a?2:wac_q(this.Dc,"SaveAsToHostBrsIsEnabled")?1===c?32:2===c?(wac_b(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),a=this.WUa.Db(),e&&Object.getType(e)===Array&&2===e.length?a.n_(e[0],!!e[1]):a.n_(null,!1),32):8:8}};
function wac_17a(){this.SB=Function.createDelegate(this,this.sC)}
wac_17a.prototype={sa:null,Ub:function(){return"Common.App.SaveAsToHost"},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){wac_q(wac_.pa,"SaveAsToHostBrsIsEnabled")&&this.sa.H(wac_KQ).Tb()},gc:function(a){this.sa=a;wac_n(wac_m(wac_o(this.sa.fa(wac_U7a),wac_HQ),function(){return new wac_U7a(wac_.pa,wac_z())}));wac_n(wac_m(wac_o(this.sa.fa(wac_LQ),wac_S7a),function(){return new wac_LQ(wac_z(),wac_.pa,wac_.Af,function(){return wac_.ke},function(){return new wac_dn(!1)},a.H(wac_HQ),wac_r(),wac_r().Bz())}));
wac_n(wac_m(wac_o(this.sa.fa(wac_IQ),wac_Q7a),function(){return new wac_IQ(wac_.pa,wac_z(),wac_r(),wac_r().Hd(),a.H(wac_HQ),a.H(wac_LQ))}));wac_n(wac_m(this.sa.fa(wac_KQ),function(){return new wac_KQ(wac_.pa,a.H(wac_IQ),a.H(wac_LQ))}))},O:function(){}};
function wac_LQ(a,b,c,d,e,f,g,h){this.Dld=Function.createDelegate(this,this.yVd);this.Eld=Function.createDelegate(this,this.zVd);this.Dc=b;this.rX=this.Dc.Qb.SaveAsToHostWebServiceBase;this.AWb=d;this.ZW=e;this.$g=c;this.Ro=f;this.Tf=h;this.Xi=g;this.Ia=a;this.MC=b.Qb.SaveAsToHostUploadHandler||"hostuploadhandler.ashx"}
wac_LQ.prototype={Xi:null,Om:null,ZW:null,Ro:null,$g:null,Ia:null,AWb:null,Dc:null,rX:null,MC:null,UJ:!1,zDa:!1,iz:null,LOc:null,Tf:null,H9:null,mSa:function(){1!==this.Xi.kg()&&(this.Om=this.ZW(),this.Om.Hua(CommonUIStrings.l_CommentProgressTooltip),wac_Nh(this.Om,5),this.Om.zua(!1),this.Om.n7(CommonUIStrings.l_DefaultDialogTitle,null,null))},wE:function(a){1!==this.Xi.kg()&&this.Ro.Db().Xp(a,wac_kP(this.iz),this.zDa)},Hna:function(){var a=this.Dc.Qb.BreadcrumbFolderUrl;wac_b(8194016,216,50,"Redirecting to OneDrive for business Folder.");
window.open(a,wac_Tl(3))},Gna:function(a){var b=!1,c=!1;this.Dc&&(b=wac_q(this.Dc,"SaveACopyIsEnabledForUiHost"),c=wac_q(this.Dc,"UiHostSupportsDocRebootFeatures"));wac_b(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",a,b);if(b&&c){wac_b(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var d={rebootMode:"1"};d.documentUrl=a;wac_I0a().uc(function(a){a.Dx("App_DocReboot",d,"")})}else window.open(a,wac_Tl(3))},xea:function(a,b,c){wac_b(8194018,
216,50,"Starting to upload file");this.AWb&&!this.AWb()&&this.$g&&(this.Tf&&(this.H9=this.Tf.uj("DialogShown","SaveAsToHostUploadTime")),this.mSa(),this.zDa=b,this.iz=a,(this.LOc=c)&&"true"===this.LOc.SkipSaveToHost?wac_27a(this):this.sQ())},sQ:function(){if(32!==this.Ia.yw(3070187925,1,null))wac_b(18989378,219,15,"The save file change is not supported, this operation may exist data losting."),wac_27a(this);else{var a=this,b=this;this.Ia.Wj(3070187925,2,[function(){wac_b(18989379,219,50,"Call the force save file change successfully.");
wac_27a(a)},function(a,d){wac_b(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");b.wE(d)}],null)}},zVd:function(a){this.Yla();this.UJ=!1;if(a&&a.Aa&&a.Aa.Be){var b,c,d;if(d=wac_dP(Object,a.Aa.Be,c={val:b}),b=c.val,d)if(a=b,200!==a.StatusCode&&201!==a.StatusCode)wac_b(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),this.wE(window.parseInt(a.ExtraInfo));else{wac_b(8194050,216,50,"UploadToHost execute success.");try{a.NewDocumentUrl&&
""!==a.NewDocumentUrl?this.Gna(a.NewDocumentUrl):this.Hna()}catch(e){wac_b(37025699,216,15,"Redirect failed with exception: {0}",e.toString())}this.WQa()}else wac_b(8194048,216,10,"Failed to deserialize : {0}",{ResponseData:wac_qP(a.Aa.Be)}),this.wE(0)}else wac_b(8194019,216,10,"UploadToHostManager failure. Response data is null"),this.wE(0)},yVd:function(a){5!==a.Aa.Sd&&12!==a.Aa.Sd||this.UJ?(wac_b(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",{Status:a.Aa.Sd,HttpStatus:a.Aa.ho}),
this.Yla(),this.wE(0),this.WQa()):(wac_b(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.UJ=!0,this.LOc&&"true"===this.LOc.SkipSaveToHost?wac_27a(this):this.sQ())},Yla:function(){this.Om&&(this.Om.sA(),this.Om=null)},WQa:function(){this.H9&&(this.H9.vg(),this.H9=null)}};
function wac_27a(a){var b=a.rX+a.MC,b=wac_Ml(b,"qs",wac_Cf(wac_.eo),!1),b=wac_Ml(b,"n",wac_Cf((new Date).getTime().toString()),!1),b=wac_Ml(b,"ov",wac_Cf(a.zDa.toString()),!1),b=wac_Ml(b,"fn",wac_Cf(a.iz),!1);a.LOc&&a.LOc.FileDownloadUrl&&(b=wac_Ml(b,"furl",wac_Cf(a.LOc.FileDownloadUrl),!1));a.$g.lk(b,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,a.Eld,a.Dld,null,null,!1,null,null,"1",null,!1,null,!1,null)}wac_T7a.registerClass("Common.App.SaveAsToHost.FileNameDialogHtml");
wac_U7a.registerClass("Common.App.SaveAsToHost.ErrorRetryDialogFactory",null,wac_HQ);wac_V7a.registerClass("Common.App.SaveAsToHost.ErrorRetryDialog",wac_di,wac_P7a);wac_IQ.registerClass("Common.App.SaveAsToHost.FileNameDialogFactory",null,wac_Q7a);wac_JQ.registerClass("Common.App.SaveAsToHost.FileNameDialogBase",wac__m);wac_Z7a.registerClass("Common.App.SaveAsToHost.FileNameDialog",wac_JQ,wac_R7a);wac_KQ.registerClass("Common.App.SaveAsToHost.SaveAsToHostActor");
wac_17a.registerClass("Common.App.SaveAsToHost.SaveAsToHostPackage",null,wac_I,wac_i);wac_LQ.registerClass("Common.App.SaveAsToHost.UploadToHostManager",null,wac_S7a);wac_T7a.Hxa="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
wac_J(wac_C(),new wac_17a,0,!1);Type.registerNamespace("Common.App.SaveToCloudStorage");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.m0d=wac_d.Qa.m0d||{};function wac_37a(){}wac_37a.registerInterface("Common.App.SaveToCloudStorage.IErrorDialog");function wac_47a(){}wac_47a.registerInterface("Common.App.SaveToCloudStorage.ISaveToCloudManager");function wac_57a(){}wac_57a.registerInterface("Common.App.SaveToCloudStorage.ISignInDialogFactory");function wac_67a(){}wac_67a.registerInterface("Common.App.SaveToCloudStorage.ISignInDialog");
function wac_77a(){}wac_77a.registerInterface("Common.App.SaveToCloudStorage.ISkyDriveUploadCaller");function wac_87a(){}wac_87a.registerInterface("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory");function wac_97a(){}wac_97a.registerInterface("Common.App.SaveToCloudStorage.IUploadToCloudManager");function wac_MQ(){wac_MQ.initializeBase(this);wac_Nh(this,0);wac_Oh(this,1,CommonUIStrings.l_DialogClose)}
wac_MQ.prototype={Xp:function(a){this.hs(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)}};function wac_$7a(){}
wac_$7a.prototype={sa:null,Ub:function(){return"Common.App.SaveToCloudStorage"},tb:function(){wac_q(wac_.pa,"SaveToCloudStorageUIIsEnabled")&&this.sa.H(wac_NQ).Tb()},O:function(){},gc:function(a){this.sa=a;wac_n(wac_m(wac_o(this.sa.fa(wac_OQ),wac_57a),function(){return new wac_OQ(wac_z(),wac_qi(),wac_r().Hd())}));wac_n(wac_m(wac_o(this.sa.fa(wac_PQ),wac_87a),function(){return new wac_PQ(wac_.pa)}));wac_n(wac_m(this.sa.fa(wac_NQ),function(){return new wac_NQ(a.H(wac_QQ),a.H(wac_sQ),wac_.pa,wac_r().Bz())}));
wac_n(wac_m(this.sa.fa(wac_RQ),function(){return new wac_RQ(a.H(wac_PQ),function(){return new wac_dn(!1)},function(){return new wac_MQ},wac_r(),wac_r().Bz())}));wac_n(wac_m(this.sa.fa(wac_QQ),function(){return new wac_QQ(a.H(wac_OQ),wac_qi(),a.H(wac_RQ),wac_.pa,wac_Kg,function(){return new wac_MQ})}))}};function wac_NQ(a,b,c,d){this.cic=Function.createDelegate(this,this.l0d);this.IQc=a;this.Dc=c;this.eZb=b;this.JDb=new (wac_Rb.$$(Boolean));this.Tf=d}
wac_NQ.prototype={IQc:null,eZb:null,Dc:null,Tf:null,vmb:null,JDb:null,nzc:function(){return wac_q(this.Dc,"SaveToCloudStorageUIIsEnabled")},Xwc:function(){return 617689800},u9a:function(){var a=this.cic;wac_tl().xa(a);wac_R3a([new wac_wl(617689800,2147483648,0)],wac_yQ(this.eZb))},Tb:function(){var a=wac_yQ(this.eZb);if(a){var b=this;wac_rl(a,function(){b.JDb.Ze(!0)});this.u9a()}else wac_b(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")},hCc:function(){wac_b(6590597,
216,50,"User clicked on SaveToOneDrive button")},l0d:function(a,b,c,d,e){if(2147483648!==b.Bd()||a!==this.Xwc())return 2;if(!this.nzc())return 8;if(1===c)return 32;if(2===c){this.hCc();e&&e.FileDownloadUrl&&wac_b(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there");this.Tf&&(this.vmb=this.Tf.uj("DialogShown","SaveToOneDriveReponseTime"));var f=this;this.JDb.oj().CW(function(){f.vmb&&(f.vmb.vg(),f.vmb=null);f.IQc.Wd(e)});return 32}return 8}};
function wac_QQ(a,b,c,d,e,f){this.pJa=Function.createDelegate(this,this.Py);this.EJa=Function.createDelegate(this,this.xA);this.JRc=a;this.Z1=b;this.Vga=c;this.Dc=d;this.USb=e;this.Ro=f}
wac_QQ.prototype={JRc:null,Ro:null,Z1:null,Vga:null,Dc:null,USb:0,LOc:null,Wd:function(a){this.LOc=a;if(wac_pi()){wac_b(6590559,216,50,"User is signed in. We will show file picker.");try{wac_b(6590561,216,50,"Initializing OneDrive API");var b={client_id:this.Dc.Qb.UploadToSkyDriveClientId,env:"INT"};if(1===this.USb||2===this.USb)b={client_id:this.Dc.Qb.UploadToSkyDriveClientId};window.WL.init(b);wac_b(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");window.WL.fileDialog({mode:"save",
lightbox:"grey"}).then(this.EJa,this.pJa)}catch(c){wac_b(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",c,c.stack),this.Im()}}else wac_b(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.JRc.Db().n_()},Im:function(){this.Ro().Xp(0)},xA:function(a){wac_b(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");a&&a.data&&a.data.folders&&this.Vga.xea(a.data.folders[0].id,a.data.folders[0].urls.viewInBrowser,null,this.LOc)},
Py:function(a){if(a&&a.error){if("user_canceled"===a.error.code){wac_b(6590593,216,50,"User cancelled upload to their OneDrive.");return}wac_b(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",a.error.code,a.error.message)}else wac_b(6590595,216,50,"File Dialog returned with no response");this.Im()}};function wac_OQ(a,b,c){this.Ia=a;this.Z1=b;this.Xy=c}wac_OQ.prototype={Ia:null,Z1:null,Xy:null,Db:function(){return new wac_a8a(this.Ia,this.Z1,this.Xy)}};
function wac_a8a(a,b,c){this.kdd=Function.createDelegate(this,this.OJd);this.ygc=Function.createDelegate(this,this.cUd);wac_a8a.initializeBase(this);this.Ia=a;this.Z1=b;this.Xy=c;this.ER=!1;wac_Nh(this,1);this.ffa=1;wac_Oh(this,1,CommonUIStrings.l_SignIn);wac_Oh(this,0,CommonUIStrings.l_SignInToSaveDialogCancelButton)}
wac_a8a.prototype={Ia:null,Z1:null,Xy:null,n_:function(){wac_S1a(this.Z1,this.ygc);wac_ei(this,CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,this.kdd)},OJd:function(a){if(a){a=new wac_nh("Signin.aspx");wac_oh(a,"prompt","1");var b="2";if(this.Xy)switch(this.Xy.Nv()){case 3:b="0";break;case 2:b="3";break;case 1:b="1"}wac_oh(a,"cbcxt",b);wac_Wg(a.Qja);window.open(a.toString(),"LoginWindow")}else wac_b(6590598,216,50,"User dismissed SignIn Dialog."),this.fd()},
fd:function(){this.Z1.Ra.sb("R",this.ygc);wac_0m.prototype.fd.call(this)},cUd:function(){this.Sh&&this.fd();wac_b(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");this.Ia.yw(617689800,2,null)}};function wac_b8a(a,b,c,d,e,f,g){this.rX=a;this.iz=b;this.ofa=c;this.$Ua=d;this.OXa=e;this.MC=f;this.LOc=g}
wac_b8a.prototype={rX:null,iz:null,ofa:null,$Ua:null,OXa:null,MC:null,LOc:null,uc:function(a,b){if(!wac_.ke&&wac_.Af){var c=this.rX+this.MC,c=wac_Ml(c,"fo",wac_Cf(this.$Ua),!1),c=wac_Ml(c,"fn",wac_Cf(this.iz),!1),c=wac_Ml(c,"qs",wac_Cf(this.OXa),!1),c=wac_Ml(c,"n",wac_Cf((new Date).getTime().toString()),!1);this.LOc&&this.LOc.FileDownloadUrl&&(c=wac_Ml(c,"furl",wac_Cf(this.LOc.FileDownloadUrl),!1));this.ofa&&(c=wac_Ml(c,"fnn",wac_Cf(this.ofa),!1));wac_.Af.lk(c,1,"",{"Content-Type":"application/json; charset=utf-8"},
!1,2,a,b,null,null,!1,null,null,null,null,!1,null,!1,null)}}};function wac_PQ(a){this.Dc=a;this.Du=a.Qb.SkyDriveUploadWebServiceBase;this.iz=a.Qb.FileName;this.MC=a.Qb.SkyDriveUploadHandler||"skydriveuploadhandler.ashx"}wac_PQ.prototype={Du:null,iz:null,MC:null,Dc:null,Db:function(a,b,c){return new wac_b8a(this.Du,this.iz,b,a,wac_.eo,this.MC,c)}};
function wac_RQ(a,b,c,d,e){this.Wjd=Function.createDelegate(this,this.dTd);this.Xjd=Function.createDelegate(this,this.eTd);this.iZa=a;this.ZW=b;this.Ro=c;this.Xi=d;this.Tf=e}
wac_RQ.prototype={iZa:null,FTa:null,Om:null,Xi:null,AW:null,ZW:null,Ro:null,UJ:!1,Tf:null,H9:null,LOc:null,mSa:function(){this.Xi&&1===this.Xi.kg()||(this.Om=this.ZW(),this.Om.Hua(CommonUIStrings.l_CommentProgressTooltip),wac_Nh(this.Om,5),this.Om.zua(!1),this.Om.n7(CommonUIStrings.l_DefaultDialogTitle,null,null))},Yla:function(){this.Om&&(this.Om.sA(),this.Om=null)},wE:function(){1!==wac_r().kg()&&this.Ro().Xp(0)},Hna:function(){wac_b(6590599,216,50,"Redirecting to OneDrive Folder.");window.open(this.AW,
wac_Tl(3))},Gna:function(a){var b=!1,c=!1;wac_.pa&&(b=wac_q(wac_.pa,"SaveACopyIsEnabledForUiHost"),c=wac_q(wac_.pa,"UiHostSupportsDocRebootFeatures"));wac_b(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",a,b);if(b&&c){wac_b(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var d={rebootMode:"1"};d.documentUrl=a;wac_I0a().uc(function(a){a.Dx("App_DocReboot",d,"")})}else window.open(a,wac_Tl(3))},xea:function(a,b,c,d){wac_b(7143886,
216,50,"Starting to upload file");this.Tf&&(this.H9=this.Tf.uj("DialogShown","SaveToOneDriveUploadTime"));this.mSa();this.AW=b;this.FTa=this.iZa.Db(a,c,d);this.LOc=d;this.sQ()},sQ:function(){wac_b(6590600,216,50,"Calling SkydriveUploadHandler.");this.FTa.uc(this.Xjd,this.Wjd)},eTd:function(a){this.Yla();this.UJ=!1;if(a&&a.Aa&&a.Aa.Be){var b,c,d;if(d=wac_dP(Object,a.Aa.Be,c={val:b}),b=c.val,d)if(a=b,200!==a.StatusCode&&201!==a.StatusCode)wac_b(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),
this.wE();else{wac_b(6590603,216,50,"UploadToCloudManager upload success.");try{a.NewDocumentUrl&&""!==a.NewDocumentUrl?this.Gna(a.NewDocumentUrl):this.Hna()}catch(e){wac_b(37025728,216,15,"Redirect failed with exception: {0}",e.toString())}this.WQa()}else wac_b(7660114,216,10,"Failed to deserialize : {0}",{ResponseData:wac_qP(a.Aa.Be)}),this.wE()}else wac_b(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.wE()},dTd:function(a){5!==a.Aa.Sd&&12!==a.Aa.Sd||this.UJ?(wac_b(6590605,
216,10,"UploadToCloudManager HTTP failure with code: {0}",a.Aa.Sd),this.Yla(),this.wE(),this.WQa()):(wac_b(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.UJ=!0,this.sQ())},WQa:function(){this.H9&&(this.H9.vg(),this.H9=null)}};wac_MQ.registerClass("Common.App.SaveToCloudStorage.ErrorDialog",wac_di,wac_37a);wac_$7a.registerClass("Common.App.SaveToCloudStorage.PackageManager",null,wac_I,wac_i);wac_NQ.registerClass("Common.App.SaveToCloudStorage.SaveToCloudStorageActor");
wac_QQ.registerClass("Common.App.SaveToCloudStorage.SaveToCloudManager",null,wac_47a);wac_OQ.registerClass("Common.App.SaveToCloudStorage.SignInDialogFactory",null,wac_57a);wac_a8a.registerClass("Common.App.SaveToCloudStorage.SignInDialog",wac_di,wac_67a);wac_b8a.registerClass("Common.App.SaveToCloudStorage.SkyDriveUploadCaller",null,wac_77a);wac_PQ.registerClass("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory",null,wac_87a);
wac_RQ.registerClass("Common.App.SaveToCloudStorage.UploadToCloudManager",null,wac_97a);wac_J(wac_C(),new wac_$7a,0,!1);Type.registerNamespace("Common.App.SaveToSharePoint");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.n0d=wac_d.Qa.n0d||{};function wac_c8a(){}wac_c8a.registerInterface("Common.App.SaveToSharePoint.IErrorDialog");function wac_d8a(){}wac_d8a.registerInterface("Common.App.SaveToSharePoint.IFileNameDialogFactory");function wac_e8a(){}wac_e8a.registerInterface("Common.App.SaveToSharePoint.IFileNameDialog");
function wac_SQ(){}wac_SQ.registerInterface("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper");function wac_f8a(){}wac_f8a.registerInterface("Common.App.SaveToSharePoint.IPickerDialog");function wac_g8a(){}wac_g8a.registerInterface("Common.App.SaveToSharePoint.ISharePointSaveAsCaller");function wac_h8a(){}wac_h8a.registerInterface("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory");function wac_TQ(){}wac_TQ.registerInterface("Common.App.SaveToSharePoint.ISaveToSharePointManager");
function wac_i8a(){}wac_i8a.registerInterface("Common.App.SaveToSharePoint.IUploadToSharePointManager");function wac_j8a(){}function wac_UQ(){wac_UQ.initializeBase(this);wac_Nh(this,0);wac_Oh(this,1,CommonUIStrings.l_DialogClose)}wac_UQ.prototype={Jca:function(a,b){wac_b(25235986,216,15,"Show warning dialog of Picker related issue.");this.hs(37,a,b,null,!0)}};function wac_VQ(a,b,c,d,e,f,g){this.Ia=b;this.Dc=a;this.Xy=d;this.o2=f;this.Ro=e;this.Xi=c;this.JQc=g}
wac_VQ.prototype={Ia:null,Xy:null,o2:null,Ro:null,Dc:null,Xi:null,JQc:null,Db:function(a){return new wac_k8a(this.Dc,this.Ia,this.Xi,this.Xy,this.Ro,this.o2,this.JQc,a)}};
function wac_k8a(a,b,c,d,e,f,g,h){this.Zfc=Function.createDelegate(this,this.cTd);this.Yfc=Function.createDelegate(this,this.dBc);this.syd=CommonUIStrings.l_SaveToAnotherFolder;wac_k8a.initializeBase(this,[a,b,c,d,e,f,h]);this.po=wac_WO(wac_j8a.Hxa,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"");this._id="FileNameDialog-SaveToSharePoint";this.kYa=g;this.LOc=h}
wac_k8a.prototype={kYa:null,LOc:null,Vx:null,Cfa:null,n_:function(a){var b=wac_kP(wac_.dJ.lw),c=wac_.m9a,d=wac_.l9a,e={txtFileName:a||b},f=CommonUIStrings.L_SaveAs;2===wac_r().Hd().Nv()&&(f=CommonUIStrings.L_SaveACopy);this.Zp(f,this.w4a,e);wac__7a(this,a,b);(wac_kg?wac_kg.Rb:null).style.width="450px";this.Vx=document.getElementById("anotherFolder");this.Vx.className="WACButton WACDialogButtonNormal";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");
a=!1;if(c&&c.length){wac_l8a(this.Vx,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,d,c));f=a={val:a};f.val=!1;b=document.getElementById("currentLocation");b.innerText="";var g=wac_m8a(b,d),h=wac_m8a(b,c),k=255,e=255;255<g+h&&(k=Math.max(238,408-g),e=Math.max(170,408-h),f.val=!0);f=k;d&&(wac_n8a(b,d,e),d=document.createElement("span"),d.id="FolderSeparator",e=document.createElementNS("http://www.w3.org/2000/svg","svg"),e.setAttribute("class","SeparatorCaret"),g=document.createElementNS("http://www.w3.org/2000/svg",
"polygon"),g.setAttribute("points","1 4 1 11 5 7.5"),e.appendChild(g),d.appendChild(e),b.appendChild(d));c&&wac_n8a(b,c,f);a=a.val}else wac_l8a(this.Vx,CommonUIStrings.l_CurrentOnlineFolder);c=this.Vx;d=document.createElement("span");d.className="cui-img-cont-float cui-img-16by16 ";this.Cfa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.Cfa.setAttribute("class","FolderIconSVG");b=document.createElementNS("http://www.w3.org/2000/svg","path");b.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");
this.Cfa.appendChild(b);d.appendChild(this.Cfa);c.appendChild(d);c=this.Vx;d=document.createElement("span");d.id="anotherFolderText";d.innerText=this.syd;d.className="AnotherFolderTextSpan";c.appendChild(d);a?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.Vx,"SaveToAnotherLocationTwo"),wac_b(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.Vx,"SaveToAnotherLocationOne");wac_tf(this.Vx,"click",
this.Yfc);wac_tf(this.Vx,"keydown",this.Zfc)},cTd:function(a){!a||13!==a.keyCode&&32!==a.keyCode||this.dBc(a)},dBc:function(){if(this.XE){var a=wac_If(wac_.Vxa),b=this.XE.value;this.fd();b&&""!==b&&""!==a||1===this.Xi.kg()?(""!==a&&(b+=a),wac_07a(this,b)?this.Ro.Db().Xp(1,b,!1):this.kYa.Wd(b,this.LOc)):this.Ro.Db().Xp(2,b,!1)}},oIb:function(){wac_JQ.prototype.oIb.call(this);this.Vx&&this.Cfa&&(this.XE&&""!==this.XE.value?(this.Vx.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.Vx,"DisabledSaveAsButton"),
Sys.UI.DomElement.removeCssClass(this.Cfa,"DisabledFolderIconSVG")):(this.Vx.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.Vx,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.Cfa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.Vx,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.Cfa,"DisabledFolderIconSVG"))))},dispose:function(){this.Vx&&(wac_jg(this.Vx,"click",this.Yfc),wac_jg(this.Vx,"keydown",this.Zfc),this.Vx=null);wac_JQ.prototype.dispose.call(this)}};
function wac_l8a(a,b){b=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,b);a.tabIndex=0;a.setAttribute("aria-label",b);a.setAttribute("role","button")}function wac_n8a(a,b,c){var d=document.createElement("div");d.innerText=b;d.title=b;d.className="SaveToAnotherFolderBreadcrumb";d.style.maxWidth=c.toString()+"px";a.appendChild(d)}
function wac_m8a(a,b){var c=document.createElement("div");c.innerText=b;c.style.visibility="hidden";a.appendChild(c);b=c.clientWidth;a.removeChild(c);return b}function wac_o8a(a,b,c,d){this.Sja=Function.createDelegate(this,this.xma);this.tN=a;this.Xi=c;this.sPc=d;var e=this;this.WJ=new (wac_f.$$(wac_nc.$$(wac_sc)))(function(){return new (wac_9P.$$(wac_sc))(b.ma(),e.Sja)})}
wac_o8a.prototype={tN:null,Xi:null,sPc:null,TW:null,yl:null,WJ:null,mFa:function(){this.TW||(this.WJ.ma().XU("Save As",!0),this.yl&&this.yl.BI&&this.yl.BI.length&&(this.TW=this.OHb(this.yl.BI)));return this.TW},Wd:function(a){if(!this.mFa())if(wac_.oca&&wac_.oca.length)this.TW=wac_.oca;else return wac_b(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.yl),!1;var b=this.sPc();b.GQb();var c=
b.QHb();if(!c)return wac_b(24664067,216,10,"Picker container is null, will not show picker."),!1;var d=this;this.tN.Wd(function(c,d){b.fd();a(c,d)},function(){d.KLb(b)},c,this.TW);return!0},KLb:function(a){a.fd();wac_b(24664068,216,50,"User cancelled save to another folder.")},OHb:function(a){a=a.toLowerCase();a.endsWith("/")||(a+="/");var b=a.indexOf("/documents/");return-1!==b?a.substring(0,b+1)+"_layouts/15/onedrive.aspx":""},xma:function(a){this.yl||3!==a.kg()||(this.yl=a)}};
function wac_p8a(){}
wac_p8a.prototype={sa:null,Ub:function(){return"Common.App.SaveToSharePoint"},tb:function(){},O:function(){},gc:function(a){this.sa=a;var b=wac_rP(wac_oc.$$(wac_sc),wac_l(a,wac_oc.$$(wac_sc))),c=this;wac_Db.WAA.call(null,b).CW(function(){wac_n(wac_m(wac_o(c.sa.fa(wac_WQ),wac_h8a),function(){return new wac_WQ(wac_.pa)}));wac_n(wac_m(wac_o(c.sa.fa(wac_XQ),wac_i8a),function(){return new wac_XQ(wac_z(),a.H(wac_WQ),function(){return new wac_dn(!1)},function(){return new wac_UQ},wac_r())}));wac_n(wac_m(wac_o(c.sa.fa(wac_q8a),
wac_TQ),function(){return new wac_q8a(a.H(wac_XQ),function(){return new wac_UQ},a.H(wac_SQ),wac_r())}));wac_n(wac_m(wac_o(c.sa.fa(wac_o8a),wac_SQ),function(){return new wac_o8a(a.H(wac_wQ),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_Qb(b)}),wac_r(),function(){return new wac_r8a})}));wac_n(wac_m(c.sa.fa(wac_VQ),function(){return new wac_VQ(wac_.pa,wac_z(),wac_r(),wac_r().Hd(),a.H(wac_HQ),a.H(wac_S7a),a.H(wac_TQ))}));wac_n(wac_m(c.sa.fa(wac_YQ),function(){return new wac_YQ(wac_.pa,wac_z(),
a.H(wac_VQ),a.H(wac_TQ),a.H(wac_wQ),a.H(wac_SQ),function(){return wac_r().BGb()})}));wac_q(wac_.pa,"SaveToAnotherFolderBrsIsEnabled")&&c.sa.H(wac_YQ).Tb()})}};function wac_r8a(){wac_r8a.initializeBase(this,[!1,!1,!1,!1])}wac_r8a.prototype={GQb:function(){this.jUa="FilePickerDialog";this.po="<div class='FilePickerDiv' id='FilePickerDiv'></div>";this._id="PickerDialog-MsoSp";this.Hm("",null)},QHb:function(){return document.getElementById("FilePickerDiv")},qu:function(){},Pda:function(){}};
function wac_s8a(a,b,c,d,e,f,g,h){this.rX=a;this.iz=b;this.ofa=d;this.OXa=f;this.AW=c;this.LRc=e;this.MC=g;this.LOc=h}
wac_s8a.prototype={rX:null,iz:null,ofa:null,OXa:null,AW:null,LRc:null,MC:null,LOc:null,uc:function(a,b){if(!wac_.ke&&wac_.Af){var c=this.rX+this.MC,c=wac_Ml(c,"fu",wac_Cf(this.AW),!1),c=wac_Ml(c,"su",wac_Cf(this.LRc),!1),c=wac_Ml(c,"fn",wac_Cf(this.iz),!1),c=wac_Ml(c,"n",wac_Cf((new Date).getTime().toString()),!1);this.LOc&&this.LOc.FileDownloadUrl&&(c=wac_Ml(c,"furl",wac_Cf(this.LOc.FileDownloadUrl),!1));c=c+"&"+this.OXa;this.ofa&&this.ofa.length?c=wac_Ml(c,"fnn",wac_Cf(this.ofa),!1):wac_b(23881891,
216,15,"No new file name in request.");wac_b(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");wac_.Af.lk(c,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,a,b,null,null,!1,null,null,"9",null,!1,null,!1,null)}}};function wac_WQ(a){this.Du=a.Qb.SaveAsToHostWebServiceBase;this.iz=a.Qb.FileName;this.MC=a.Qb.SharePointSaveAsHandler||"sharepointsaveashandler.ashx"}
wac_WQ.prototype={Du:null,iz:null,MC:null,Db:function(a,b,c,d){return new wac_s8a(this.Du,this.iz,a,b,c,wac_.eo,this.MC,d)}};function wac_YQ(a,b,c,d,e,f,g){this.dic=Function.createDelegate(this,this.o0d);this.Dc=a;this.WUa=c;this.Ia=b;this.kYa=d;this.tN=e;this.gga=f;this.yVe=g}
wac_YQ.prototype={WUa:null,Dc:null,Ia:null,kYa:null,tN:null,gga:null,yVe:null,Tb:function(){var a=wac_yQ(this.tN);if(a)if(wac_Fh()||wac_q(this.Dc,"SaveToSharePointOnDemandDownloadJsIsEnabled"))this.Ia.jf(3050207199,2147483648,this.dic,64);else{var b=this;wac_2gc(a).CW(function(a){wac_Fb(a)&&b.tN.pMb(a)});this.u9a()}else wac_b(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")},u9a:function(){var a=this.dic;wac_tl().xa(a);wac_R3a([new wac_wl(3050207199,2147483648,0)],wac_yQ(this.tN))},
o0d:function(a,b,c,d,e){return 2147483648!==b.Bd()||3050207199!==a?2:wac_q(this.Dc,"SaveToAnotherFolderBrsIsEnabled")&&(this.gga.mFa()||wac_q(this.Dc,"UserCanWriteRelative"))?1===c?this.yVe()?32:8:2===c?(wac_b(23881885,216,50,"User clicked on SaveToSharePoint button from the backstage."),e&&e.FileDownloadUrl&&wac_b(40379589,216,50,"SaveToSharePoint FileDownloadUrl - "+e.FileDownloadUrl),wac_q(this.Dc,"UserCanWriteRelative")?(wac_b(24524226,216,50,"Show save a copy dialog."),this.WUa.Db(e).n_(null)):
(wac_b(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.kYa.Wd(null,e)),32):8:8}};function wac_q8a(a,b,c,d){this.MSc=a;this.Ro=b;this.gga=c;this.Xi=d}
wac_q8a.prototype={Xi:null,Ro:null,MSc:null,gga:null,$Nc:null,LOc:null,Wd:function(a,b){wac_b(25180163,216,50,"Try launch Picker.");this.$Nc=a;this.LOc=b;var c=this;this.gga.Wd(function(a,b){c.Bna(a,b)})||wac_t8a(this)},Bna:function(a,b){a?this.xA(b):this.Py(b)},xA:function(a){wac_b(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(a&&a.data&&a.data.value&&a.data.value.length&&a.data.value[0].sharePoint){var b=a.data.value[0].sharePoint.url;a=a.data.value[0].sharePoint.listUrl;
var c=null;if(b){if(a)a.endsWith("/")&&(a=a.substring(0,a.length-1)),c=a.lastIndexOf("/"),a=-1!==c?a.substring(0,c):null;else a:{a=b;a.endsWith("/")||(a+="/");for(var d=c=0;d<a.length;d++)if("/"===a.charAt(d)&&5===++c){a=a.substr(0,d);break a}a=null}if(c=a){this.MSc.xea(b,this.$Nc,c,this.LOc);return}}wac_b(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!b,!c)}wac_b(23881887,216,10,"Picker return invalid data or empty SharePoint url.");wac_t8a(this)},
Py:function(a){wac_b(23881888,216,10,"Picker failure Callback called.");a&&a.error?wac_b(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",a.error.errorCode,a.error.message):wac_b(23881890,216,10,"File Dialog returned empty error.");wac_t8a(this)}};function wac_t8a(a){1!==a.Xi.kg()&&a.Ro().Jca(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)}
function wac_XQ(a,b,c,d,e){this.Yjd=Function.createDelegate(this,this.fTd);this.Zjd=Function.createDelegate(this,this.gTd);this.iZa=b;this.ZW=c;this.Ro=d;this.Xi=e;this.Ia=a}
wac_XQ.prototype={iZa:null,FTa:null,Om:null,Xi:null,ZW:null,Ro:null,Ia:null,PSb:!1,AW:null,xea:function(a,b,c,d){this.PSb=!1;wac_b(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");this.mSa();this.AW=a;this.FTa=this.iZa.Db(a,b,c,d);d&&"true"===d.SkipSaveToHost?this.sQ():wac_u8a(this)},sQ:function(){wac_b(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.FTa.uc(this.Zjd,this.Yjd)},gTd:function(a){if(a&&a.Aa&&a.Aa.Be){var b,c,d;if(d=wac_dP(Object,a.Aa.Be,
c={val:b}),b=c.val,d)if(200!==b.StatusCode&&201!==b.StatusCode){if(wac_b(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",a.Aa.Sd,b.StatusCode),413===b.StatusCode||!wac_v8a(this,a.Aa.Sd))switch(a=b.StatusCode,wac_b(25180166,216,50,"Upload fail with status code: {0}.",a),a){case 401:this.Im(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage,38);break;case 413:a=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,
250);this.Im(CommonUIStrings.l_SaveAsFileTooLargeTitle,a,32);break;default:wac_ZQ(this)}}else{wac_b(23881927,216,50,"UploadToSharePointManager upload success.");try{b.NewDocumentUrl?this.Gna(b.NewDocumentUrl):this.Hna()}catch(e){wac_b(37025729,216,15,"Redirect failed with exception: {0}",e.toString())}}else wac_b(23881926,216,10,"Failed to deserialize : {0}",{ResponseData:wac_qP(a.Aa.Be)}),wac_w8a(this)||wac_ZQ(this)}else wac_b(23881925,216,10,"Upload failure. Response data is null"),wac_w8a(this)||
wac_ZQ(this)},fTd:function(a){a&&a.Aa?wac_v8a(this,a.Aa.Sd)||(wac_b(23881929,216,10,"Upload failed."),wac_ZQ(this)):(wac_b(23881928,216,10,"Upload failure. Response data is null"),wac_w8a(this)||wac_ZQ(this))},Hna:function(){wac_b(23881933,216,50,"Redirecting to Folder.");window.open(this.AW,wac_Tl(3))},Gna:function(a){var b=!1,c=!1;wac_.pa&&(b=wac_q(wac_.pa,"SaveACopyIsEnabledForUiHost"),c=wac_q(wac_.pa,"UiHostSupportsDocRebootFeatures"));wac_b(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",
a,b);if(b&&c){wac_b(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var d={rebootMode:"1"};d.documentUrl=a;wac_I0a().uc(function(a){a.Dx("App_DocReboot",d,"")})}else window.open(a,wac_Tl(3))},mSa:function(){this.Xi&&1===this.Xi.kg()||(this.Om=this.ZW(),this.Om.Hua(CommonUIStrings.l_CommentProgressTooltip),wac_Nh(this.Om,5),this.Om.zua(!1),this.Om.n7(CommonUIStrings.l_DefaultDialogTitle,null,null))},Yla:function(){this.Om&&(this.Om.sA(),this.Om=
null)},Im:function(a,b,c){wac_b(25180165,216,10,"Upload failure with title: {0}, message: {1}",a,b);this.Yla();if(1!==this.Xi.kg()){var d=this.Ro();wac_b(25180161,216,10,"Show upload error dialog with error code {0}.",c);d.hs(c,a,b,null)}}};function wac_ZQ(a){a.Im(CommonUIStrings.l_SaveFailedDialogTitle,CommonUIStrings.l_FailToSaveFile,38)}function wac_v8a(a,b){wac_b(23881932,216,10,"HTTP failure with code: {0}",b);return wac_w8a(a)}
function wac_w8a(a){if(!a.PSb)return wac_b(23881930,216,10,"Upload fail. Retrying."),a.PSb=!0,a.sQ(),!0;wac_b(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1}function wac_u8a(a){function b(){wac_b(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");a.sQ()}32!==a.Ia.Wj(3070187925,2,[function(){wac_b(23881922,216,50,"Call the force save file change successfully.");a.sQ()},b],null)&&b()}wac_j8a.registerClass("Common.App.SaveToSharePoint.FileNameDialogHtml");
wac_UQ.registerClass("Common.App.SaveToSharePoint.ErrorDialog",wac_di,wac_c8a);wac_VQ.registerClass("Common.App.SaveToSharePoint.FileNameDialogFactory",null,wac_d8a);wac_k8a.registerClass("Common.App.SaveToSharePoint.FileNameDialog",wac_JQ,wac_e8a);wac_o8a.registerClass("Common.App.SaveToSharePoint.OneDriveFilePickerHelper",null,wac_SQ);wac_p8a.registerClass("Common.App.SaveToSharePoint.PackageManager",null,wac_I,wac_i);wac_r8a.registerClass("Common.App.SaveToSharePoint.PickerDialog",wac__m,wac_f8a);
wac_s8a.registerClass("Common.App.SaveToSharePoint.SharePointSaveAsCaller",null,wac_g8a);wac_WQ.registerClass("Common.App.SaveToSharePoint.SharePointUploadCallerFactory",null,wac_h8a);wac_YQ.registerClass("Common.App.SaveToSharePoint.SaveToSharePointActor");wac_q8a.registerClass("Common.App.SaveToSharePoint.SaveToSharePointManager",null,wac_TQ);wac_XQ.registerClass("Common.App.SaveToSharePoint.UploadToSharePointManager",null,wac_i8a);wac_j8a.Hxa="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
wac_J(wac_C(),new wac_p8a,0,!1);Type.registerNamespace("Common.Search");wac_d=window.Common||{};wac_d.OUf=wac_d.OUf||{};function wac_x7c(){}wac_x7c.registerInterface("Common.Search.ISearchContext");function wac_y7c(){}wac_y7c.registerInterface("Common.Search.ISearchContextFactory");function wac_z7c(a,b,c,d){this.xAf=a;this.CCf=b;this.BCf=c;this.NWf=d}wac_z7c.prototype={CCf:0,BCf:0,xAf:null,NWf:null};function wac_Y3c(){}
wac_Y3c.prototype={VNf:function(a,b,c,d,e){b=d-c;var f;if(100<=b)b=c,f=d;else{b=Math.max(0,c+Math.ceil(b/2)-50);f=Math.min(a.length,b+100);b=Math.max(0,f-100);var g;if(b&&" "!==a.charAt(b-1)){g=Math.min(c,b+10);for(var h=b;h<g;++h)if(" "===a.charAt(h)){b=h+1;break}}if(f!==a.length&&" "!==a.charAt(f))for(g=Math.max(d,f-10),h=f-1;h>=g;--h)if(" "===a.charAt(h)){f=h;break}}return new wac_z7c(a.substring(b,f),c-b,d-b,e)}};wac_z7c.registerClass("Common.Search.SearchContext",null,wac_x7c);
wac_Y3c.registerClass("Common.Search.SearchContextFactory",null,wac_y7c);Type.registerNamespace("Common.App.VersionHistory");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.p2b=wac_d.Qa.p2b||{};function wac_Tvc(){}wac_Tvc.registerInterface("Common.App.VersionHistory.IVersionHistoryDialog");function wac_Uvc(){}wac_Uvc.registerInterface("Common.App.VersionHistory.IVersionHistoryDialogActor");function wac_Vvc(){}wac_Vvc.registerInterface("Common.App.VersionHistory.IVersionHistoryDialogFactory");
function wac_Wvc(){this.SB=Function.createDelegate(this,this.sC)}
wac_Wvc.prototype={sa:null,Dc:null,Ub:function(){return"Common.App.VersionHistory"},gc:function(a){this.sa=a;this.Dc=wac_.pa;var b=this;wac_n(wac_m(wac_o(this.sa.fa(wac_Xvc),wac_Uvc),function(){return new wac_Xvc(wac_z(),wac_0b(b.sa,wac_Vvc))}));var c=this;wac_n(wac_m(wac_o(this.sa.fa(wac_Yvc),wac_Vvc),function(){return new wac_Yvc(c.sa.H(wac_kIa))}))},tb:function(){this.Dc.Ok(this.SB)},sC:function(){wac_Rqc()?wac_q(this.Dc,"AppSupportsReactVersionHistory")?wac_b(39890946,202,50,"VersionHistoryPackageManager:OnFullAppSettingsReady - Not initializing the VersionHistory package because the react package is enabled"):
(wac_b(38908760,202,50,"VersionHistoryPackageManager:OnFullAppSettingsReady - Initializing the VersionHistory package"),(wac_Zvc||(wac_Zvc=wac__vc())).Tb(),this.sa.H(wac_Yvc).Yd(),this.sa.H(wac_Uvc).Tb()):wac_b(38908759,202,50,"VersionHistoryPackageManager:OnFullAppSettingsReady - Not initializing the VersionHistory package because the feature is disabled")},O:function(){}};
function wac_0vc(a,b){this.xKe=Function.createDelegate(this,this.YMe);this.DAe=Function.createDelegate(this,this.xCe);this.dLe=Function.createDelegate(this,this.p2b);this.THe=a;this.Ia=b}function wac__vc(){return new wac_0vc(wac_Rqc,new (wac_f.$$(wac_Oc))(function(){return wac_z()}))}
wac_0vc.prototype={Ia:null,THe:null,Tb:function(){this.$k().ja(3182458430,2147483648,this.dLe)},p2b:function(a,b,c){if(1===c)return this.THe()?32:8;if(!wac_.vNd)return 8;wac_b(38908761,202,50,"VersionHistoryActor:VersionHistory - Version History Attempt");wac_.vNd(this.DAe,this.xKe);return 32},xCe:function(a){a?a.OperationResult?wac_b(38908763,202,10,"VersionHistoryActor:OnVersionHistorySuccess - Unknown failed operation result"):this.$k().Wj(3649559640,2,a,null):wac_b(38908762,202,10,"VersionHistoryActor:OnVersionHistorySuccess - Got null response")},
YMe:function(a){var b=new wac_di;wac_Nh(b,0);wac_b(38908764,202,15,"VersionHistoryActor:OnVersionHistoryFailure - {0}",{Result:a});wac_ei(b,"We Couldn't get the Version History","We're sorry, but we couldn't get the version history for the file. Please try again in a few minutes, or refresh the page and try again.",3,null)},$k:function(){return this.Ia.ma()}};function wac_1vc(a,b,c){this.Veb=a;this.Oma=b;this.d6=c}wac_1vc.prototype={Veb:null,Oma:null,d6:null};
function wac_2vc(a){this.iHe=a;this.l2b=document.createElement("div");this.l2b.id=this.iHe;this.l2b.style.position="relative";this.l2b.style.width="24px";this.l2b.style.height="100%";this.l2b.style.margin="0 auto";a=document.createElement("div");a.style.position="absolute";a.style.display="block";a.style.top="50%";this.l2b.appendChild(a);var b=document.createElement("img");b.src=wac_Le("progress.gif");a.appendChild(b)}
wac_2vc.prototype={iHe:null,l2b:null,Ki:function(){this.l2b.style.display="block"},fd:function(){this.l2b.style.display="none"}};
function wac_3vc(a){this.bLe=Function.createDelegate(this,this.pHe);this.i6c=Function.createDelegate(this,this.fvc);this.eLe=Function.createDelegate(this,this.MNe);this.cLe=Function.createDelegate(this,this.KNe);this.N5c=Function.createDelegate(this,this.Exd);this.M5c=Function.createDelegate(this,this.Dxd);this.Jja=[];this.QAd=[];wac_3vc.initializeBase(this,[!1,!1,!1,!1]);this.c2d=a;this.nhb=this.M5c;this.Joa=this.N5c;this.mze=this.cLe;this.qgd=this.eLe;this.po=wac_4vc;wac_Nh(this,0);this._id="VersionHistoryDialog";
wac_Oh(this,1,CommonUIStrings.l_DialogClose)}
wac_3vc.prototype={cNa:null,x2d:null,CUc:null,oze:null,rDe:null,Pcd:null,Xye:null,dze:null,cze:null,wIe:null,c2d:null,nhb:null,Joa:null,mze:null,qgd:null,Dxd:function(a){this.fvc(a);return!0},Exd:function(a){return wac_Cma(this,a,this.i6c)},KNe:function(a){this.pHe(a);return!0},MNe:function(a){return wac_Cma(this,a,this.bLe)},pHe:function(a){a=a.hQa;this.c2d.wCe(a[0],a[1]);if(document.getElementById("versionTimeStamp"))document.getElementById("versionTimeStamp").innerText=(new Date(a[0].Time.toString())).toLocaleString("en-US",
{SJe:"long",yIe:"numeric",zIe:"numeric",RJe:"numeric"}).toString();else{var b=document.createElement("div");b.id="versionTimeStamp";b.innerText=(new Date(a[0].Time.toString())).toLocaleString("en-US",{SJe:"long",yIe:"numeric",zIe:"numeric",RJe:"numeric"}).toString();b.style.paddingLeft="40%";document.getElementById("WACDialogTitlePanel").appendChild(b)}},fvc:function(a){a=a.hQa;"visible"===a.Veb.style.visibility?(a.Veb.style.visibility="hidden",a.d6.className=wac_9h("OutlookSearchChevronDown_16x16x32"),
a.d6.title=CommonUIStrings.l_Expand,a.Oma.title=CommonUIStrings.l_Expand):(a.Veb.style.visibility="visible",a.d6.className=wac_9h("OutlookSearchChevronUp_16x16x32"),a.d6.title=CommonUIStrings.l_Collapse,a.Oma.title=CommonUIStrings.l_Collapse)},Pda:function(){wac_0m.prototype.Pda.call(this);this.ICc();this.Rb.style.width=wac_xk(document.getElementById("WACInnerFrame")).width+"px";this.Rb.style.height=wac_xk(document.getElementById("WACInnerFrame")).height+wac_xk(document.getElementById("WACStatusBarContainer")).height+
"px";wac_5vc(this)},N4c:function(a,b,c,d,e,f){var g=document.createElement("div");d&&(g.id=d);e&&g.setAttribute("aria-labelledby",e);f&&(g.tabIndex=0);d=document.createElement("span");d.className="EmbedSectionName UIFontBold";d.innerText=a;c&&(d.id=c);g.appendChild(d);g.appendChild(b);return g},SBe:function(a,b,c){b=this.N4c(b,c,null,null,null,!1);var d=this.fg.createElement("div");d.className="WACGlyph EmbedArrowHolder";d.id="Arrow"+a;d.setAttribute("role","button");d.tabIndex=0;b.insertBefore(d,
c);a=wac_4h(16,16,"UpArrowServer","EmbedArrowIcon","");d.appendChild(a);a=a.childNodes[0];a.className=wac_9h("OutlookSearchChevronUp_16x16x32");a.title=CommonUIStrings.l_Collapse;d.title=CommonUIStrings.l_Collapse;c.style.visibility="visible";c=new wac_1vc(c,d,a);Array.add(this.Jja,c);this.Fk.zA("click",d,this.nhb,c);this.Od.zA("keydown",d,this.Joa,c);this.Od.zA("keypress",d,this.Joa,c);this.Od.zA("keyup",d,this.Joa,c);return b},dispose:function(){if(this.Jja){for(var a=0;a<this.Jja.length;++a)this.Fk.ub("click",
this.Jja[a].Oma,this.nhb),this.Od.ub("keydown",this.Jja[a].Oma,this.Joa),this.Od.ub("keypress",this.Jja[a].Oma,this.Joa),this.Od.ub("keyup",this.Jja[a].Oma,this.Joa);this.Joa=this.nhb=this.Jja=null}if(this.QAd){for(a=0;a<this.QAd.length;++a)this.Fk.ub("click",this.QAd[a].VersionElement,this.mze),this.Od.ub("keydown",this.QAd[a].VersionElement,this.qgd),this.Od.ub("keypress",this.QAd[a].VersionElement,this.qgd),this.Od.ub("keyup",this.QAd[a].VersionElement,this.qgd);this.qgd=this.mze=this.QAd=null}this.cNa=
this.dze=this.Pcd=this.CUc=this.x2d=null;wac__m.prototype.dispose.call(this)}};
function wac_6vc(a,b,c){var d=document.createElement("div");d.id=b.Time.toString();d.style.cssText="display:flex;direction:inherit;flex-direction:row;box-sizing:border-box;align-items:stretch;flex-wrap:nowrap;width:268px;max-width:268px;padding-top:0px;padding-right:0px;padding-bottom:0px;padding-left:0px;margin-top:9px;margin-bottom:9px;margin-right:9px;margin-left:9px;background-color:rgb(248, 248, 248);cursor:default;position:relative;box-shadow:rgba(0, 0, 0, 0.1) 0px 16px 24px;overflow:hidden;border-width:1px;border-style:solid;border-image:initial;border-color:rgb(234, 234, 234);outline:transparent dotted 2px;";var e=
b.AuthorID?b.AuthorID:"GuestUser";d.innerHTML=String.format('<div style="display: flex; direction: inherit; flex-direction: column; flex-grow: 1; max-width: 266px; outline: none;">\r\n                                     <div style="display: flex; flex-wrap: nowrap; flex-direction: column; flex-grow: 1; max-width: 266px; outline: none;">\r\n                                     <div style="display: flex; direction: inherit; flex-grow: 1; flex-direction: row; flex-wrap: nowrap; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px;\r\n                                                  position: relative; background-color: rgb(255, 255, 255); overflow: hidden; border-width: 0px; border-style: initial; border-color: initial; border-image: initial;">\r\n                                     <div style="position: absolute; left: 2px; top: 0px; right: 0px; bottom: 0px; width: 1px; background-color: transparent; display: none; outline: none;"></div>\r\n                                     <div style="margin-top: 8px; margin-right: 8px; margin-bottom: 8px; margin-left: 6px;">\r\n                                     <div style="font-family: inherit;-webkit-font-smoothing: antialiased;font-size: 14px;font-weight: 400;box-shadow: none;margin-top: 0px;margin-right: 0px;margin-bottom: 0px;margin-left: 0px;\r\n                                               padding-top: 0px;padding-right: 0px;padding-bottom: 0px;padding-left: 0px;box-sizing: border-box;color: rgb(51, 51, 51);position: relative;height: 24px;min-width: 24px;display: flex;\r\n                                               align-items: center;justify-content: center;">\r\n                                     <div style="font-family: \'Segoe UI\', \'Segoe UI Web (West European)\', \'Segoe UI\', -apple-system, BlinkMacSystemFont, Roboto, \'Helvetica Neue\', sans-serif; -webkit-font-smoothing: antialiased; font-size: 14px; font-weight: 400;">\r\n                                     <div style="position: relative; text-align: center; height: 24px; width: 24px; flex: 0 0 auto;">\r\n                                     <div style="color: rgb(255, 255, 255); font-size: 11px; font-weight: 400; line-height: 24px; height: 24px; background-color: rgb(96, 60, 186); border-radius: 50%;"><span>{0}</span></div></div></div></div></div>\r\n                                     <div style="display: flex; direction: inherit; flex-direction: column; flex-grow: 1; margin-top: 8px;">\r\n                                     <div style="display: flex; direction: inherit; flex-direction: row; flex-wrap: nowrap; overflow: hidden;">\r\n                                     <div style="color: rgb(51, 51, 51); font-weight: 600; font-family: inherit; font-size: 12px; line-height: 15px; align-self: baseline; text-overflow: ellipsis; white-space: nowrap;\r\n                                               max-width: 176px; padding-right: 1px; padding-left: 0px; margin-left: 3px; padding-bottom: 1px; user-select: text; overflow: hidden; flex: 4 1 176px;">{1}</div></div>\r\n                                     <div style="display: flex; margin-right: 9px; background-color: transparent; max-width: 213px; padding-top: 1px; padding-right: 1px; padding-bottom: 1px;\r\n                                               padding-left: 1px; user-select: text; border-width: 0px; border-style: initial; border-color: initial; border-image: initial;">\r\n                                     <div style="box-sizing: border-box; flex-grow: 1; overflow-y: hidden; position: relative; margin-top: 0px; margin-right: 0px; margin-bottom: 0px; margin-left: 0px; padding-top: 2px;\r\n                                               padding-right: 2px; padding-bottom: 2px; padding-left: 2px; font-family: inherit; font-size: 12px; font-weight: normal; line-height: 1.5; cursor: text; color: rgb(51, 51, 51);">\r\n                                     <p>{2}</p></div></div></div></div>\r\n                                     <div style="height: 1px; background-color: rgb(234, 234, 234);"></div></div>\r\n                                     <div style="position: absolute; left: 0px; top: 0px; right: 0px; bottom: 0px; width: 1px; background-color: transparent; display: none; outline: none;"></div></div>',
2<e.length?e.substring(0,2):"G1",(new Date(b.Time.toString())).toLocaleString("en-US",{SJe:"long",yIe:"numeric",zIe:"numeric",RJe:"numeric"}).toString(),e);b.VersionElement=d;Array.add(a.QAd,b);b=[b,c];a.Fk.zA("click",d,a.mze,b);a.Od.zA("keydown",d,a.qgd,b);a.Od.zA("keypress",d,a.qgd,b);a.Od.zA("keyup",d,a.qgd,b);return d}
function wac_5vc(a){a.cNa&&a.cNa.style&&(a.cNa.style.width=wac_xk(document.getElementById("ViewHeader")).width+"px",a.cNa.style.height=window.parseInt(a.Rb.style.height)-wac_xk(document.getElementById("VersionHistoryViewContainer")).y-window.parseInt(a.cNa.style.marginBottom)+"px",a.HMa())}function wac_Xvc(a,b){this.aLe=Function.createDelegate(this,this.JNe);this.FAe=Function.createDelegate(this,this.JCe);this.Ia=a;this.vIe=b}
wac_Xvc.prototype={Ia:null,vIe:null,nze:null,Tb:function(){this.Ia.ja(466976539,2147483648,this.FAe);this.Ia.ja(3649559640,2147483648,this.aLe)},JCe:function(a,b,c){a=32;if(2===c)if(c=this.Ia.yw(3182458430,2,null),wac_b(39679138,202,50,"ShowVersionHistoryDialogAction: ProcessAction returns versionHistoryResponse {0}.",c),32!==c)a=8;else{this.nze=this.vIe.ma().Db();if(!this.nze)return wac_b(38908765,202,50,"VersionHistoryDialogActor:ShowVersionHistoryDialogAction - VersionHistoryDialogFactory should be initialized"),
8;wac_hvc("ShowVersionHistoryDialog");wac_b(39679139,202,50,"ShowVersionHistoryDialogAction: start to show dialog. StartTime: {0}.",new Date);this.KCe()}return a},JNe:function(a,b,c,d,e){if(2===c){a=this.nze;a.rDe.fd();a.oze.Ki();a.Xye.style.display="block";a.cze.style.display="block";wac_5vc(a);a.Pcd.hasChildNodes()?a.Pcd.replaceChild(wac_6vc(a,e.Versions[0],1<e.Versions.length?e.Versions[1]:null),a.Pcd.firstChild):a.Pcd.appendChild(wac_6vc(a,e.Versions[0],1<e.Versions.length?e.Versions[1]:null));
if(!(1>=e.Versions.length))for(b=1;b<e.Versions.length;b++)a.dze.appendChild(wac_6vc(a,e.Versions[b],e.Versions.length>b+1?e.Versions[b+1]:null));e=[e.Versions[0],1<e.Versions.length?e.Versions[1]:null];a.c2d.wCe(e[0],e[1])}return 32},KCe:function(){var a=this.nze;a.Hm("Version History",null);a.x2d=document.getElementById("versionhistoryviewpane");a.x2d.style.width="79%";a.x2d.style.position="relative";wac_Sqc(a.x2d,"left");a.x2d.style.marginTop="1%";a.CUc=document.getElementById("versionhistoryversionspane");
a.CUc.style.width="19%";wac_Sqc(a.CUc,"right");a.CUc.style.marginLeft="1%";a.CUc.style.marginTop="1%";a.cNa=document.createElement("div");a.cNa.id="VersionHistoryViewContainer";a.cNa.style.width="100%";a.cNa.style.height="100%";a.cNa.style.border="none";a.cNa.style.marginBottom="15px";a.cNa.tabIndex=-1;a.cNa.style.overflow="hidden";a.wIe=a.N4c("View",a.cNa,"View","ViewHeader","View",!0);a.x2d.appendChild(a.wIe);a.oze=new wac_2vc("VersionHistoryViewerSpinner");a.rDe=new wac_2vc("VersionHistoryPaneSpinner");
a.Pcd=document.createElement("div");a.Pcd.className="EmbedDimensionSection";a.oze.fd();a.CUc.appendChild(a.rDe.l2b);a.cNa.appendChild(a.oze.l2b);a.Xye=a.N4c("Current Version",a.Pcd,null,null,null,!1);a.CUc.appendChild(a.Xye);a.dze=document.createElement("div");a.cze=a.SBe("OlderVersions","Older Versions",a.dze);a.CUc.appendChild(a.cze);a.Xye.style.display="none";a.cze.style.display="none";a.Pda();a.c2d.Lye(a.cNa)}};function wac_Yvc(a){this.c2d=a;this._initialized=!1}
wac_Yvc.prototype={c2d:null,_initialized:!1,Yd:function(){this._initialized=!0},Db:function(){return this._initialized?new wac_3vc(this.c2d):null}};wac_Wvc.registerClass("Common.App.VersionHistory.PackageManager",null,wac_I,wac_i);(function(){}).registerClass("Common.App.VersionHistory.Program");wac_0vc.registerClass("Common.App.VersionHistory.VersionHistoryActor");wac_1vc.registerClass("Common.App.VersionHistory.SectionInfo");wac_2vc.registerClass("Common.App.VersionHistory.VersionHistorySpinner");
wac_3vc.registerClass("Common.App.VersionHistory.VersionHistoryDialog",wac__m,wac_Tvc);wac_Xvc.registerClass("Common.App.VersionHistory.VersionHistoryDialogActor",null,wac_Uvc);wac_Yvc.registerClass("Common.App.VersionHistory.VersionHistoryDialogFactory",null,wac_Vvc);(function(){}).registerClass("Common.App.VersionHistory.VersionHistoryDialogHtml");var wac_Zvc=null,wac_4vc="<div class='VersionHistoryDialog' id='versionhistorydialog'> <div class='VersionHistoryViewPane' id='versionhistoryviewpane'> </div> <div class='VersionHistoryVersionsPane' id='versionhistoryversionspane'> </div> </div>";
wac_J(wac_C(),new wac_Wvc,7,!1);Type.registerNamespace("Common.App.VersionHistory.VersionHistoryExecutor");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.p2b=wac_d.Qa.p2b||{};wac_d.Qa.p2b.LNe=wac_d.Qa.p2b.LNe||{};function wac_xvc(a,b){a=new Date(a.Time.toString());return new Date(b.Time.toString())-a}function wac_yvc(){}wac_yvc.prototype={xA:null,Py:null};
function wac_zvc(a,b){this.yKe=Function.createDelegate(this,this.YGe);this.zKe=Function.createDelegate(this,this.ZMe);this.DAe=Function.createDelegate(this,this.xCe);this.$g=a;this.Dc=b}function wac_Avc(){return new wac_zvc(new (wac_f.$$(wac_Wc))(function(){return wac_.Af}),new (wac_f.$$(wac_Uc))(function(){return wac_.pa}))}
wac_zvc.prototype={$g:null,Dc:null,tb:function(){},vNd:function(a){wac_Bvc=0;wac_Cvc(this,a,!0)},wye:function(){var a=(this.Dc.ma().Qb.VersionHistoryWebServiceBase||"")+"versions.ashx";return a=wac_Ml(a,"DocID",wac_Cf(wac_.eo),!1)},xCe:function(a){wac_b(38908766,202,50,"ExecuteVersionHistoryHandler:OnVersionHistorySuccess Time to get VersionList - {0}ms",new Date-wac_Dvc);var b;a:{var c=a.Aa.Be;try{var d=wac_yl(c);d.Versions.sort(wac_xvc);b=d;break a}catch(e){wac_b(38908771,202,10,"VersionHistoryResponseSerializeHelper:DeserializeResponse - Failed to deserialize the response - {0}",
c)}b=null}b.OperationResult=0;wac_hvc("LoadVersionListEnd");a.Aa.vl.xA(b)},ZMe:function(a){2!==a.Aa.Sd?(wac_hvc("LoadVersionListRetry"),wac_b(38908767,202,50,"ExecuteVersionHistoryHandler:OnVersionHistoryFailureRetry VersionHistory request failed. Retrying..."),wac_Cvc(this,a.Aa.vl,5>wac_Bvc)):(wac_hvc("LoadVersionListFailure"),this.YGe(a))},YGe:function(a){wac_b(38908768,202,50,"ExecuteVersionHistoryHandler:OnVersionHistoryFailureNoRetry VersionHistory failed second try");a.Aa.vl.Py(-1)},epb:function(){return this.$g.ma()}};
function wac_Cvc(a,b,c){var d=a.wye();wac_hvc("LoadVersionListStart");wac_Dvc=new Date;wac_Bvc++;a.epb().lk(d,1,"",{"Content-Type":"application/json; charset=utf-8","Cache-Control":"no-cache, no-store, must-revalidate"},!1,2,a.DAe,c?a.zKe:a.yKe,b,null,!1,null,null,null,null,!1,null,!1,null)}function wac_Evc(){this.cKe=Function.createDelegate(this,this.vNd);this.SB=Function.createDelegate(this,this.sC);this.ONe=wac_Fvc||(wac_Fvc=wac_Avc())}
wac_Evc.prototype={Ub:function(){return"Common.App.VersionHistory.VersionHistoryExecutor"},sa:null,gc:function(a){this.sa=a},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){wac_Rqc()?(wac_b(38908770,202,50,"VersionHistoryRequestExecutorPackageManager:OnFullAppSettingsReady - Initializing the VersionHistoryRequestExecutor package"),(wac_Fvc||(wac_Fvc=wac_Avc())).tb(),wac_.vNd=this.cKe):wac_b(38908769,202,50,"VersionHistoryRequestExecutorPackageManager:OnFullAppSettingsReady - Not initializing the VersionHistoryRequestExecutor package because the feature is disabled.")},
vNd:function(a,b){var c=new wac_yvc;c.xA=a;c.Py=b;this.ONe.vNd(c)},O:function(){}};(function(){}).registerClass("Common.App.VersionHistory.VersionHistoryExecutor.VersionHistoryResponseSerializeHelper");wac_yvc.registerClass("Common.App.VersionHistory.VersionHistoryExecutor.ExecuteVersionHistoryData");wac_zvc.registerClass("Common.App.VersionHistory.VersionHistoryExecutor.ExecuteVersionHistoryHandler");
wac_Evc.registerClass("Common.App.VersionHistory.VersionHistoryExecutor.PackageManager",null,wac_I,wac_i);(function(){}).registerClass("Common.App.VersionHistory.VersionHistoryExecutor.Program");var wac_Fvc=null,wac_Dvc=null,wac_Bvc=0;wac_J(wac_C(),new wac_Evc,0,!1);Type.registerNamespace("Common.App.WopiIdentity");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.WGa=wac_d.Qa.WGa||{};wac_d.Qa.WGa.mlb=function(){};
wac_d.Qa.WGa.mlb.prototype={generalException:0,invalidArgument:1,notAllowed:2,apiNotAvailable:3,unresolvedPendingRequest:4,timeout:5,adalTimeout:6,userNotSignedIn:7,userAborted:8,silentSignInFailed:9,invalidResourceUrl:10,invalidGrant:11,connectionLost:12,clientError:13,serverError:14};wac_d.Qa.WGa.mlb.registerEnum("Common.App.WopiIdentity.ErrorCodes",!1);function wac_fHc(){}wac_fHc.registerInterface("Common.App.WopiIdentity.IWopiAuthContext");function wac_inc(){}wac_inc.registerInterface("Common.App.WopiIdentity.IWopiIdentityInfo");
function wac_jnc(){}wac_jnc.registerInterface("Common.App.WopiIdentity.IWopiIdentity");function wac_knc(){}wac_knc.registerInterface("Common.App.WopiIdentity.IWopiIdentityToken");function wac_lnc(){}wac_lnc.registerInterface("Common.App.WopiIdentity.ITokenRequestParameters");function wac_c$(){this.MOb=this.gbe=this.fbe="";this.mYd=0;this.DLe="";this.dmc=!0}wac_c$.prototype={fbe:null,gbe:null,MOb:null,mYd:0,DLe:null,dmc:!1};wac_c$.prototype.F1e=function(){return this.fbe};
wac_c$.prototype.get_upn=wac_c$.prototype.F1e;wac_c$.prototype.V1e=function(a){return this.fbe=a};wac_c$.prototype.set_upn=wac_c$.prototype.V1e;wac_c$.prototype.G1e=function(){return this.gbe};wac_c$.prototype.get_userId=wac_c$.prototype.G1e;wac_c$.prototype.W1e=function(a){return this.gbe=a};wac_c$.prototype.set_userId=wac_c$.prototype.W1e;wac_c$.prototype.zke=function(){return this.MOb};wac_c$.prototype.get_authority=wac_c$.prototype.zke;wac_c$.prototype.Ble=function(a){return this.MOb=a};
wac_c$.prototype.set_authority=wac_c$.prototype.Ble;wac_c$.prototype.C1e=function(){return this.mYd};wac_c$.prototype.get_authorityType=wac_c$.prototype.C1e;wac_c$.prototype.S1e=function(a){return this.mYd=a};wac_c$.prototype.set_authorityType=wac_c$.prototype.S1e;wac_c$.prototype.E1e=function(){return this.DLe};wac_c$.prototype.get_tenantId=wac_c$.prototype.E1e;wac_c$.prototype.U1e=function(a){return this.DLe=a};wac_c$.prototype.set_tenantId=wac_c$.prototype.U1e;wac_c$.prototype.D1e=function(){return this.dmc};
wac_c$.prototype.get_isAnonymous=wac_c$.prototype.D1e;wac_c$.prototype.T1e=function(a){return this.dmc=a};wac_c$.prototype.set_isAnonymous=wac_c$.prototype.T1e;function wac_k9(){this.MOb=this.wI=this.dG=""}wac_k9.prototype={dG:null,wI:null,MOb:null};wac_k9.prototype.Dwe=function(){return this.dG};wac_k9.prototype.get_displayName=wac_k9.prototype.Dwe;wac_k9.prototype.$we=function(a){return this.dG=a};wac_k9.prototype.set_displayName=wac_k9.prototype.$we;wac_k9.prototype.Ewe=function(){return this.wI};
wac_k9.prototype.get_email=wac_k9.prototype.Ewe;wac_k9.prototype.axe=function(a){return this.wI=a};wac_k9.prototype.set_email=wac_k9.prototype.axe;wac_k9.prototype.zke=function(){return this.MOb};wac_k9.prototype.get_authority=wac_k9.prototype.zke;wac_k9.prototype.Ble=function(a){return this.MOb=a};wac_k9.prototype.set_authority=wac_k9.prototype.Ble;function wac_q9(a,b,c){this.gjc=a;this.MOb=b;this.Xge=c}wac_q9.prototype={gjc:null,MOb:null,Xge:null};wac_q9.prototype.Cwe=function(){return this.gjc};
wac_q9.prototype.get_accessToken=wac_q9.prototype.Cwe;wac_q9.prototype.Zwe=function(a){return this.gjc=a};wac_q9.prototype.set_accessToken=wac_q9.prototype.Zwe;wac_q9.prototype.zke=function(){return this.MOb};wac_q9.prototype.get_authority=wac_q9.prototype.zke;wac_q9.prototype.Ble=function(a){return this.MOb=a};wac_q9.prototype.set_authority=wac_q9.prototype.Ble;wac_q9.prototype.Fwe=function(){return this.Xge};wac_q9.prototype.get_expiration=wac_q9.prototype.Fwe;
wac_q9.prototype.bxe=function(a){return this.Xge=a};wac_q9.prototype.set_expiration=wac_q9.prototype.bxe;function wac_69(a,b){wac_69.fwe===Number||Type.isEnum(wac_69.fwe);this.Ghe=a;this.Mne=b}
wac_69.$$=function(a){var b=wac_d.Qa.WGa.__tc=wac_d.Qa.WGa.__tc||{},c="OutstandingRequest$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_69.apply(this,a)};d.registerClass("Common.App.WopiIdentity.__tc."+c);d.prototype.jb={"Common.App.WopiIdentity.OutstandingRequest$1":{T:a},ctor:wac_69};a=wac_69.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};
wac_69.prototype={Ghe:null};wac_69.prototype.Iwe=function(){return this.Ghe};wac_69.prototype.get_requestParameters=wac_69.prototype.Iwe;wac_69.prototype.exe=function(a){return this.Ghe=a};wac_69.prototype.set_requestParameters=wac_69.prototype.exe;wac_69.prototype.Hwe=function(){return this.Mne};wac_69.prototype.get_requestCallback=wac_69.prototype.Hwe;wac_69.prototype.dxe=function(a){return this.Mne=a};wac_69.prototype.set_requestCallback=wac_69.prototype.dxe;
function wac_O$(a){this.rjd=Function.createDelegate(this,this.jSd);this.getAccessToken=this.GetAccessToken;this.getAuthContext=this.GetAuthContext;this.getAuthContextSync=this.GetAuthContextSync;this.getPrimaryIdentityInfo=this.GetPrimaryIdentityInfo;this.$1a={};this.lOb={};this.Lbc=wac_r().Bz();this.yrc=a;this.yrc.vtb("PostAccessToken");this.yrc.Kzd("PostAccessToken",this.rjd)}
wac_O$.prototype={yrc:null,$1a:null,lOb:null,Lbc:null,jSd:function(a){var b=null;try{var c=a.Values.SsoRequestId||a.Values.AddinControlId,d=a.Values.SsoAccessToken||a.Values.AccessToken,e;if(!(e=a.Values.SsoAuthority))a:switch(a.Values.HostApplicationType){case "OneDriveWOPI":e="MicrosoftAccount";break a;default:e="AzureActiveDirectoryAccount"}var f=e,g=a.Values.SsoTokenExpiration||new Date((new Date).getTime()+51E5),h=e=null,k=this.$1a[c];"undefined"!==typeof k&&k?(b=k.get_requestCallback(),delete this.$1a[c],
"undefined"!==typeof d&&d&&d.length?h=new wac_q9(d,f,g):e=wac_d.Qa.WGa.mlb.toString(wac_9uc(this,a)),c="getAccessToken_"+c,c in this.lOb&&(this.lOb[c].vg(),delete this.lOb[c]),b(h,e)):wac_b(37856066,344,10,wac_ai({error:"No matching outstanding request for request ID.",requestId:c}))}catch(l){c=a.Values.SsoRequestId||a.Values.AddinControlId,c in this.$1a&&delete this.$1a[c],this.j5c(),wac_b(37856067,344,10,wac_ai({error:l.message,stack:l.stack})),b&&b(null,wac_d.Qa.WGa.mlb.toString(0))}},j5c:function(){wac_b(39068822,
344,50,wac_ai({userAgent:window.navigator.userAgent}))}};function wac_$uc(a,b){a=a.get_resource();a=(a?a:"").replace("://","__").replace(/\./g,"_dot_").replace("/","\\");wac_b(39921882,344,50,wac_ai({callerId:b,resource:a}))}
function wac_9uc(a,b){var c=b.Values.SsoError||b.Values.AddinSSOError;b=b.Values.HostApplicationType;a.j5c();wac_b(39068821,344,10,wac_ai({error:c,wopiHost:b}));return-1<c.indexOf("AADSTS50058")?9:-1<c.indexOf("Popup Window is null")||-1<c.indexOf("Popup Window closed")?12:-1<c.indexOf("AADSTS50001")?10:-1<c.indexOf("13002")?8:-1<c.indexOf("AADSTS70011")||-1<c.indexOf("AADSTS65001")?11:-1<c.indexOf("Token renewal operation failed due to timeout")?6:0}
function wac_onc(a){var b=wac_4Fa;a=a.toLowerCase();for(var c=b.length,d=0;d<c;++d){var e=b[d];if(a===e.toLowerCase())return!0}var b=wac_yhb,f;for(f in b)if(e={key:f,value:b[f]},a===e.value.toLowerCase())return!0;f=wac_dib;for(var g in f)if(e={key:g,value:f[g]},a===e.value.toLowerCase())return!0;return!1}
function wac_pnc(a){var b=wac_.pa.Qb.UserName,c=wac_.pa.Qb.LoggableUserIdSpace,d=new wac_k9;d.wI=wac_.pa.Qb.UserPrincipalName;d.dG=b;switch(c){case "OrgIdPuid":d.MOb="AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":d.MOb="MicrosoftAccount";break;default:d.MOb=c}a(d,null)}
function wac_qnc(a,b,c){var d=wac_bl().yQ.toString(),e="getAccessToken_"+d,f=a.Lbc.uj("ComponentAttach",e);a.lOb[e]=f;e={};f=b.get_options()&&"undefined"!==typeof b.get_options()?b.get_options():{};e.SsoRequestId=d;e.SsoResource=b.get_resource();e.SsoScope=b.get_scope();e.SsoSilentLogin=b.get_silentLogin();e.SsoOptions=b.get_options();e.AddinControlId=d;e.AddinApplicationResource=b.get_resource();e.AddinSSOAuthChallenge=f.authChallenge||"";e.AddinIsFirstParty=!0;a.yrc.Dx("GetAccessToken",e,"");a.$1a[d]=
new (wac_69.$$(Function))(b,c)}
wac_O$.prototype.nie=function(a,b){wac_$uc(a,b);var c=this;return new Promise(function(d,e){-1<wac_Jh(wac_.pa.Qb.PostMessageOrigin,1).toLowerCase().indexOf(".spoppe.com")?e(wac_d.Qa.WGa.mlb.toString(3)):wac_onc(b)?b in c.$1a?e(wac_d.Qa.WGa.mlb.toString(4)):(window.setTimeout(function(){wac_b(37856032,344,10,wac_ai({error:"Request timeout.",callerId:b}));e(wac_d.Qa.WGa.mlb.toString(5))},12E4),wac_qnc(c,a,function(a,b){a?d(a):(wac_b(37856033,369,10,wac_ai({error:wac_d.Qa.WGa.mlb.toString(b)})),e(b))})):
(wac_b(37856034,344,10,wac_ai({error:"Caller is not allowed."})),e(wac_d.Qa.WGa.mlb.toString(2)))})};wac_O$.prototype.GetAccessToken=wac_O$.prototype.nie;wac_O$.prototype.uue=function(a){return new Promise(function(b,c){wac_onc(a)?wac_pnc(function(a,e){a?b(a):(wac_b(37856064,369,10,wac_ai({error:e.toString()})),c(e))}):(wac_b(37856065,344,10,wac_ai({error:"Caller is not allowed."})),c(wac_d.Qa.WGa.mlb.toString(2)))})};wac_O$.prototype.GetPrimaryIdentityInfo=wac_O$.prototype.uue;
wac_O$.prototype.B_e=function(a){var b=this;return new Promise(function(c,d){var e=b.GetAuthContextSync(a);e?c(e):d(wac_d.Qa.WGa.mlb.toString(2))})};wac_O$.prototype.GetAuthContext=wac_O$.prototype.B_e;
wac_O$.prototype.C_e=function(a){if(wac_onc(a)){a=new wac_c$;a.fbe=wac_.pa.Qb.UserPrincipalName;a.gbe=wac_.pa.Qb.LoggableUserId;a.MOb=wac_.pa.Qb.HostAuthAuthority;a.DLe=wac_.pa.Qb.TenantId;a.dmc=wac_q(wac_.pa,"IsAnonymousUser");var b=wac_.pa.Qb.HostAuthType;a.mYd="aad"===b.toLowerCase()?2:"msa"===b.toLowerCase()?1:0;return a}wac_b(40751647,344,10,wac_ai({error:"Caller is not allowed."}));return null};wac_O$.prototype.GetAuthContextSync=wac_O$.prototype.C_e;function wac_rnc(){}
wac_rnc.prototype={Ub:function(){return"Common.App.WopiIdentity"},gc:function(a){wac_m(wac_n(wac_o(a.fa(wac_O$),wac_jnc)),function(){return new wac_O$(a.H(wac_2a))})},tb:function(){},O:function(){}};wac_c$.registerClass("Common.App.WopiIdentity.WopiAuthContext",null,wac_fHc);wac_k9.registerClass("Common.App.WopiIdentity.WopiIdentityInfo",null,wac_inc);wac_q9.registerClass("Common.App.WopiIdentity.WopiIdentityToken",null,wac_knc);
wac_O$.registerClass("Common.App.WopiIdentity.WopiIdentityManager",null,wac_jnc);wac_rnc.registerClass("Common.App.WopiIdentity.WopiIdentityPackage",null,wac_I,wac_i);wac_J(wac_C(),new wac_rnc,0,!1);Type.registerNamespace("BasicChat");function wac_sMb(){}wac_sMb.registerInterface("BasicChat.IBasicChatActor");function wac_tMb(){}wac_tMb.registerInterface("BasicChat.ISkypeWebExperienceController");function wac_uMb(){}wac_uMb.prototype={implicitOAuth:1,password:2,token:3,anonymous:4};
wac_uMb.registerEnum("BasicChat.SkypeAuthMethods",!1);function wac_vMb(){}wac_vMb.registerInterface("BasicChat.IChatToast");function wac_wMb(){}wac_wMb.registerInterface("BasicChat.IChatToastFactory");function wac_xMb(a,b,c,d){this.hfd=Function.createDelegate(this,this.ONd);this.Ra=new wac_Re;this.oHc=b;this.NRc=c;this.Dc=a;this.Pc=d}
wac_xMb.prototype={oHc:null,NRc:null,Dc:null,FXb:null,Pc:null,M9:function(a){this.Ra.xa("ACEK",a)},Db:function(a){if(a&&wac_83){if(this.FXb){var b=this;this.Pc.Hb(new wac_D(0,1,0,function(){a(b.Ra,b.FXb)},115,null,!1))}this.M9(a);return wac_83}(wac_83=this.oHc())||(wac_83=this.NRc());wac_83.M9(this.hfd);a&&this.M9(a);return wac_83},ONd:function(a,b){this.FXb=b;this.Ra.wa("ACEK",b,null)}};
function wac_93(a,b){this.hdc=Function.createDelegate(this,this.gJd);this.Jcc=Function.createDelegate(this,this.Jwc);this.Ra=new wac_Re;this.aqa=new (wac_Rb.$$(Boolean));this.dispose=this.O;this.YUa=a;this.jW=b;wac_yMb(this,0)}
wac_93.prototype={YUa:null,jW:null,zp:null,xra:null,az:0,pHc:0,fBa:null,Ooa:null,L2b:function(){return wac_sP(String,wac_.Ag)},R9:function(){return!!this.zp&&this.zp.Cg()},GIa:function(a){this.zp?this.zp.Cg()!==a&&(this.zp.te(a),this.Ra.wa("PSCH",new wac_Nm(a?1:0),null)):a&&wac_b(8782405,333,15,"Trying to set visible while flexpane is null");return a},M9:function(a){this.Ra.xa("cam",a)},yZa:function(a){this.Ra.xa("PSCH",a)},AZa:function(a){this.Ra.xa("unreadConvEventKey",a)},tb:function(){if(!this.zp){this.zp=
this.YUa.Db("Mock Chat Pane",null,null,3476734992);var a=document.createElement("div");a.innerText="Notification types: unreadmessage | chat | contactrequest | audio\n\n";a.innerText+="Type in the mock notif type:\n";this.zp.Nc().appendChild(a);this.xra=document.createElement("input");this.xra.style.width="100px";this.xra.style.display="block";this.zp.Nc().appendChild(this.xra);a=document.createElement("div");a.innerText="\n";this.zp.Nc().appendChild(a);this.fBa=document.createElement("button");this.fBa.id=
"chatNotif";this.fBa.innerText="Send Chat Notification";this.zp.Nc().appendChild(this.fBa);window.$addHandler(this.fBa,"mousedown",this.Jcc);this.zp.Nc().appendChild(a);this.Ooa=document.createElement("input");this.Ooa.id="hideThenChatNotif";this.Ooa.type="button";this.Ooa.value="Dismiss then Send Chat Notif";this.zp.Nc().appendChild(this.Ooa);window.$addHandler(this.Ooa,"mousedown",this.hdc)}wac_yMb(this,2);this.Ra.wa("cam",new wac_Lm(2),null);this.aqa.Ze(!0);return this.aqa.oj()},HV:function(){this.GIa(!0);
this.R9()||this.GIa(!0)},gJd:function(a){this.A_();var b=this;window.setTimeout(function(){b.Jwc(null)},0);a.stopPropagation()},Jwc:function(a){a.stopPropagation();a=wac_zMb(this.xra.value);var b,c=this,d=this,e=this,f=this,g=this,h=this;a=(b=new wac_Mm,b.Fg=a,b.Ixb=null,b.dG="mock name",b.Wka=null,b.Nl="mock title",b.fA="mock description",b.bxb=function(){c.HV();c.Q_("notification accepted")},b.G5a=function(a){d.HV();d.Q_("notification accepted with "+a)},b.wBb=function(){e.HV();e.Q_("notification opened")},
b.myb=function(){f.Q_("notification declined")},b.fwa=function(){g.Q_("notification sound played")},b.m8a=function(){h.Q_("notification sound stopped")},b.eDb=function(){},b.IZ=1===a?0:2,b);wac_AMb(this.jW,this,a)},A_:function(){this.GIa(!1)},Iya:function(a,b){this.Q_(String.format("Trying to join conversation {0}",a));"mockChatThread"===a&&b()},Gy:function(a){a?(this.pHc=this.az,wac_yMb(this,3),this.A_()):3===this.az&&wac_yMb(this,this.pHc)},Q_:function(a){if(this.zp&&this.zp.Nc()){var b=document.createElement("div");
b.innerText=a+"\n";this.zp.Nc().appendChild(b)}else window.alert(String.format("Mock Chat Client: {0}",a))},O:function(){this.zp&&(this.A_(),window.$removeHandler(this.fBa,"mousedown",this.Jcc),window.$removeHandler(this.Ooa,"mousedown",this.hdc),this.zp=null);this.jW&&(this.jW.dispose(),this.jW=null)}};function wac_yMb(a,b){a.az!==b&&(a.az=b,a.Ra.wa("cam",new wac_Lm(a.az),null))}function wac_BMb(){}
wac_BMb.prototype={sa:null,dB:null,Ub:function(){return"Common.App.BasicChat"},tb:function(){var a=this;wac_Ed().WSb.oj().CW(function(){wac_.pa.Ok(function(){wac_CMb(a)})})},O:function(){},gc:function(a){this.sa=a;var b=this;wac_m(wac_o(wac_o(wac_n(this.sa.fa(wac_$3)),wac_tMb),wac_Im),function(){return new wac_$3(wac_.pa,wac_l(b.sa,wac_qma))});wac_m(wac_n(this.sa.fa(wac_a4)),function(){return new wac_a4(wac_r().Bz())});wac_m(wac_n(wac_o(this.sa.fa(wac_DMb),wac_qc)),function(){return new wac_DMb(new (wac_f.$$(wac_6c))(function(){return wac_Ie()}),
new (wac_f.$$(wac_5c))(function(){return wac_r().JK()}),new (wac_f.$$(wac_Hk))(function(){return wac_4f()}),new (wac_f.$$(wac_Ok))(function(){return wac_5f()}),new (wac_f.$$(wac_8c))(function(){return wac_6f()}),new (wac_f.$$(wac_ad))(function(){return wac_3f()}),new (wac_f.$$(wac_gc))(function(){return wac_r()}))});wac_n(this.sa.fa(wac_EMb));var c=this;wac_m(wac_n(this.sa.fa(wac_b4)),function(){return new wac_b4(wac_r().Hd(),wac_.pa,c.sa.H(wac_qc),c.sa.H(wac_EMb),c.sa.H(wac_tMb),c.sa.H(wac_a4),c.sa.H(wac_Km))});
var d=this;wac_m(wac_n(this.sa.fa(wac_93)),function(){var a=d.sa.H(wac_qc),b=d.sa.H(wac_Km);return 3===wac_Lg(wac_.pa,"SkypeExperience",0)?new wac_93(a,b):null});var e=this;wac_m(wac_n(this.sa.fa(wac_Jm)),function(){return new wac_xMb(wac_.pa,function(){return e.sa.H(wac_93)},function(){return e.sa.H(wac_b4)},wac_p())});var f=this;wac_m(wac_n(this.sa.fa(wac_sMb)),function(){return new wac_FMb(wac_z(),f.sa.H(wac_Jm),wac_rP(wac_SP,wac_l(f.sa,wac_SP)),f.sa.H(wac_a4),wac_Sg,wac_.pa)});wac_m(wac_n(this.sa.fa(wac_wMb)),
function(){return new wac_GMb(wac_6f())});var g=this;wac_m(wac_n(this.sa.fa(wac_Km)),function(){return new wac_HMb(function(){return wac_r().Nc().parentNode},g.sa.H(wac_wMb))})}};function wac_CMb(a){a.dB=a.sa.H(wac_a4);wac_IMb(a.dB).Wd();wac_JMb(a.dB).Wd();var b=wac_c4(a.sa.H(wac_Im));b.CW(function(){var c=wac_Qb(b);c.uka?(a.sa.H(wac_Jm),a.sa.H(wac_sMb).Yd()):c.gva&&a.sa.H(wac_Jm)})}
function wac_FMb(a,b,c,d,e,f){this.IJa=Function.createDelegate(this,this.LQa);this.awb=Function.createDelegate(this,this.MMb);this.ksd=Function.createDelegate(this,this.T3d);this.ghc=Function.createDelegate(this,this.mVd);this.fhc=Function.createDelegate(this,this.eBc);this.dispose=this.O;this.Ia=a;this.HTa=b;this.SVb=c;this.dB=d;this.iXa=e;this.Dc=f}
wac_FMb.prototype={Ia:null,DC:null,HTa:null,SVb:null,kz:null,dB:null,iXa:null,Dc:null,om:!1,r1b:0,iEa:null,$Da:null,Yd:function(){this.Tb();wac_KMb(this);var a=this;this.iXa(function(){a.O()})},eBc:function(){var a;(a=this.kz.Usc)?(this.iEa=wac_LMb(this,a,wac_TP.Ofb),this.$Da=wac_LMb(this,a,wac_TP.HPb),wac_IMb(this.dB)&&wac_IMb(this.dB).vg(),a=!!this.iEa||!!this.$Da):a=!1;a&&this.DC.Gy(!1)},mVd:function(){this.$Da=this.iEa=null;this.DC.Gy(!0)},Tb:function(){this.Ia.ja(3476734992,2147483648,this.ksd)},
MMb:function(){wac_MMb(this,this.iEa);wac_MMb(this,this.$Da)},LQa:function(a,b){a=b.zDb;a!==this.r1b&&(wac_NMb(this.iEa,a),wac_NMb(this.$Da,a),this.r1b=a)},T3d:function(a,b,c){if(this.om||2!==c)return 32;this.DC.R9()?this.A_():this.HV();return 32},HV:function(){this.DC.HV()},A_:function(){this.DC.A_()},O:function(){this.om||(this.kz&&(this.kz.Ra.sb("OnTopRowControlsCreatedEvent",this.fhc),this.kz.Ra.sb("OnTopRowControlsDisposingEvent",this.ghc),this.kz=null),this.DC&&(this.DC.dispose(),this.DC=null),
this.Ia=this.$Da=this.iEa=null,this.om=!0)}};function wac_NMb(a,b){if(a&&(b+=0,a=a.querySelector(".SkypeUnreadConversationsBubble")))if(0>=b)a.style.display="none",a.innerText="";else{var c=99<b;b=b.toString();c?(b="99+",Sys.UI.DomElement.containsCssClass(a,"SkypeUCBWide")||Sys.UI.DomElement.addCssClass(a,"SkypeUCBWide")):Sys.UI.DomElement.containsCssClass(a,"SkypeUCBWide")&&Sys.UI.DomElement.removeCssClass(a,"SkypeUCBWide");a.innerText=b;a.style.display=""}}
function wac_MMb(a,b){if(b){var c=b.querySelector("img");if(c){var d,e="";c.getAttribute("class")&&(d=c.getAttribute("class").toString(),0<d.indexOf("WACSkypeButtonBlack_20x20x32")?e=d.replace("WACSkypeButtonBlack_20x20x32","WACSkypeButtonWhite_20x20x32"):0<d.indexOf("WACSkypeButtonWhite_20x20x32")?e=d.replace("WACSkypeButtonWhite_20x20x32","WACSkypeButtonBlack_20x20x32"):0<d.indexOf("WACSkypeBusinessButtonBlack_20x20x32")?e=d.replace("WACSkypeBusinessButtonBlack_20x20x32","WACSkypeBusinessButtonWhite_20x20x32"):
0<d.indexOf("WACSkypeBusinessButtonWhite_20x20x32")&&(e=d.replace("WACSkypeBusinessButtonWhite_20x20x32","WACSkypeBusinessButtonBlack_20x20x32")),e.length&&(c.className=e),wac_q(a.Dc,"PeoplesWellExtraButtonInfoIsEnabled")||(Sys.UI.DomElement.containsCssClass(b,"activated")?Sys.UI.DomElement.removeCssClass(b,"activated"):Sys.UI.DomElement.addCssClass(b,"activated")))}}}function wac_KMb(a){a.DC=a.HTa.Db(null);a.DC.yZa(a.awb);var b=a.DC.tb();b.CW(function(){wac_OMb(a,wac_Qb(b))});a.DC.AZa(a.IJa)}
function wac_LMb(a,b,c){var d=null;if(c){try{d=wac_xS(b,c,wac_TP.nEc)}catch(e){wac_b(18465952,333,10,"Couldn't find the button. Basic Chat will be disabled, message: {0} Callstack: {1}.",e.message,e.stack)}d&&(b.Qy(c),d.style.display="",wac_NMb(d,a.r1b))}return d}function wac_OMb(a,b){b&&a.SVb.CW(function(){a.kz=wac_Qb(a.SVb);a.kz.y8a&&a.eBc(null,null);wac__5a(a.kz,a.fhc);a.kz.Ra.xa("OnTopRowControlsDisposingEvent",a.ghc)})}function wac_a4(a){this.Tf=a}
wac_a4.prototype={Tf:null,mHc:null,nHc:null,rHc:null,RSc:null};function wac_IMb(a){return a.RSc||(a.RSc=a.Tf.S_("CommandTask","SkypeUserExperienceLoad"))}function wac_JMb(a){return a.rHc||(a.rHc=a.Tf.S_("CommandTask","SkypeBasicChatTimeToChattable"))}function wac_PMb(a){return a.nHc||(a.nHc=a.Tf.S_("LoadResource","SkypeBasicChatClientLoad"))}function wac_QMb(a){return a.mHc||(a.mHc=a.Tf.S_("WebServiceCall","SkypeBasicChatClientAuth"))}
function wac_RMb(a){this.qwa=a;this.VSb=!wac_q(this.qwa,"HeaderInsideRibbonIsEnabled");this.Kxb=wac_q(this.qwa,"SkypeAutomationModeIsEnabled")||wac_q(this.qwa,"BasicChatIsEnabled")&&!wac_q(this.qwa,"ReactSharedHeaderIsEnabled");this.wW=wac_Lg(this.qwa,"SkypeExperience",0)}wac_RMb.prototype={Ehb:null,VSb:!1,wW:0,qwa:null,Kxb:!1,xZ:null};function wac_SMb(a){a.xZ||(a.xZ=new (wac_Rb.$$(Boolean)),a.VSb&&a.Kxb?wac_TMb(a):a.xZ.Ze(!1))}
function wac_UMb(a){a.Ehb||(a.Ehb=new (wac_Rb.$$(wac_6la)),wac_SMb(a),a.xZ.oj().CW(function(){var b=wac_Qb(a.xZ.oj()),c;if(c=!b)if(c=a.VSb)a.CWb.ma()?(c=wac_q(a.qwa,"DocChatIsEnabled"),c=!a.Kxb&&c&&(2===a.wW||3===a.wW)):c=!1;a.Ehb.Ze(new wac_6la(b,c))}))}function wac_c4(a){wac_UMb(a);return a.Ehb.oj()}
function wac_VMb(a,b,c,d,e,f,g,h,k,l,m){this.Tle=Function.createDelegate(this,this.sve);this.cJa=Function.createDelegate(this,this.fd);this.dispose=this.O;this.nd=a;this.sN=b;this.dF=c;this.BSc=d;this.wg=e;this.Od=f;this.jn=g;this.sa=g.Nc().parentNode;this.mTa=g.Nc();this.fga=k;this.dga=l;this.qJc=m;this.eVb=wac_A(27,0);this.fce=wac_q(wac_.pa,"PeoplesWellExtraButtonInfoIsEnabled")&&!!wac_r()&&wac_r().Hd().Bg();this.Wc||(a=!!wac_r()&&wac_r().Hd().iO(),this.fce&&(this.fee=document.createElement("div"),
this.fee.className="cui-flexpane"),this.Wc=document.createElement("div"),this.Wc.id="FlexPane",this.Wc.className="FlexPane"+(a?" FlexBoxLayout":""),this.Wc.style.display="none",this.Wc.tabIndex=0,wac_Fe(this.Wc,"role","region"),wac_Fe(this.Wc,"aria-label",h),this.fce&&(this.Wye=document.createElement("span"),this.Wye.className="cui-taskPaneTitle",this.Wye.innerText=CommonUIStrings.l_ChatTooltip,this.dW=document.createElement("a"),this.dW.tabIndex=0,this.dW.className="cui-taskPaneClose cui-ctl",this.dW.title=
CommonUIStrings.l_DialogClose,this.dW.style.position="absolute",this.dW.style.right="0px",this.dW.setAttribute("role","button"),this.wg.ya("click",this.dW,this.cJa),this.Od.ya("keyup",this.dW,this.Tle),this.iH=document.createElement("span"),this.iH.className="cui-taskPaneCloseButton cui-ctl-iconContainer",this.dpe=wac_4h(16,16,"ClosePaneGlyph_16x16x32","",""),this.iH.appendChild(this.dpe),this.dW.appendChild(this.iH),this.gte=document.createElement("div"),this.gte.className="cui-flexPaneTitle",this.gte.appendChild(this.Wye),
this.gte.appendChild(this.dW),this.fee.appendChild(this.gte)),a?this.fce?(this.Wc.style.height="100%",this.fee.appendChild(this.Wc),this.mTa.parentNode.appendChild(this.fee)):this.mTa.parentNode.appendChild(this.Wc):this.sa.insertBefore(this.Wc,this.mTa),this.Nca())}
wac_VMb.prototype={Hpa:null,nd:null,sN:null,dF:null,BSc:null,wg:null,Od:null,jn:null,sa:null,mTa:null,fga:null,dga:null,qJc:0,Sh:!1,eVb:null,fce:!1,dpe:null,iH:null,dW:null,gte:null,fee:null,Wye:null,Cg:function(){return this.Sh},te:function(a){if(a===this.Sh)return a;this.BRb(a);return this.Sh=a},Wc:null,Nc:function(){return this.Wc},sve:function(a){a=a.fb.keyCode;return 13===a||32===a?(this.te(!1),!0):!1},fd:function(){wac_b(40969411,333,50,"Chat pane closed with X");this.te(!1);return!0},BRb:function(a){a?
(this.Wc.style.display="block",this.fce&&(this.fee.style.display="flex"),Sys.UI.DomElement.addCssClass(this.mTa,"FlexPaneUp"),wac_2j(this.sN,"FlexPane"),wac_wg(this.nd,"FlexPane",!0)):(this.Wc.style.display="none",this.fce&&(this.fee.style.display="none"),Sys.UI.DomElement.removeCssClass(this.mTa,"FlexPaneUp"),wac_3j(this.sN,"FlexPane"),wac_ng(this.nd,"FlexPane",!0));this.jn.mua();wac_r()&&wac_r().Hd().Bg()&&window.document.dispatchEvent&&(a=null,window.document.createEvent&&(a=window.document.createEvent("UIEvents"),
a.initUIEvent("resize",!0,!0,wac_O3a(window.document),0)),a&&window.document.dispatchEvent(a))},Nca:function(){if(!this.Hpa){this.Hpa=this.nd.xc("FlexPane");this.Hpa.re="main";var a=this;wac_pk(this.Hpa,function(){wac_Vj(a.Wc);a.fga&&a.fga()});if(this.dga){var b=this;wac_ok(this.Hpa,function(){b.dga()})}this.Hpa.Ba(this.eVb,this.qJc);this.dF.b5("FlexPane",this.Wc,!1,!0);this.BSc.b5("FlexPane",this.Wc,!1,!0);wac_1j(this.sN,"FlexPane",!0)}},O:function(){this.sa.removeChild(this.Wc);this.jn=this.Wc=
null;wac_jk(this.Hpa,this.eVb);wac_q(wac_.pa,"PeoplesWellExtraButtonInfoIsEnabled")&&(this.wg.ub("click",this.dW,this.cJa),this.Od.ub("keyup",this.dW,this.Tle))}};function wac_DMb(a,b,c,d,e,f,g){this.RJc=a;this.xJc=b;this.SNc=c;this.CSc=d;this.cpe=e;this.upe=f;this.rGc=g}wac_DMb.prototype={rGc:null,RJc:null,xJc:null,SNc:null,CSc:null,cpe:null,upe:null,Db:function(a,b,c,d){return new wac_VMb(this.RJc.ma(),this.xJc.ma(),this.SNc.ma(),this.CSc.ma(),this.cpe.ma(),this.upe.ma(),this.rGc.ma(),a,b,c,d)}};
function wac_WMb(a){this.kZ=a;this.qbc=this.kZ.me;this.a2b=this.kZ.activity}
wac_WMb.prototype={qbc:null,a2b:null,kZ:null,l_a:function(){this.qbc||wac_b(17105566,333,10,"Skype Native Contact ME is null.");return this.qbc},rJb:function(){try{return this.kZ.isAvailable()}catch(a){return wac_b(17440901,333,10,"Skype IsAvailable error. Message: {0}, Callstack: {1}",a.message,a.stack),!1}},Iya:function(a,b,c){try{wac_b(9209431,333,50,"Joining Conversation"),this.kZ.joinConversation(a,["Chat"],b,function(a){wac_b(9209432,333,10,"JoinConversation Failed. Error: {0}",a);c()})}catch(d){wac_b(8913495,
333,10,"Skype join request error. Message: {0}, Callstack: {1}",d.message,d.stack),c()}},zw:function(a){try{this.kZ.setFocus(a)}catch(b){wac_b(16799060,333,10,"Skype SetFocus error. Message: {0}, Callstack: {1}",b.message,b.stack)}}};function wac_XMb(a,b,c,d){try{a.kZ.setAuthProvider(b,c,d)}catch(e){wac_b(8757719,333,10,"Skype SetAuthProvider error. Message: {0}, Callstack: {1}",e.message,e.stack)}}
function wac_b4(a,b,c,d,e,f,g){this.Bkd=Function.createDelegate(this,this.hUd);this.IJa=Function.createDelegate(this,this.LQa);this.dfd=Function.createDelegate(this,this.MNd);this.efd=Function.createDelegate(this,this.NNd);this.aqa=new (wac_Rb.$$(Boolean));this.p2=new (wac_Rb.$$(String));this.dispose=this.O;this.bN=a;this.Dc=b;this.nNc=d;this.Ra=new wac_Re;this.YUa=c;this.zEa=e;this.dB=f;this.jW=g;this.az=0}function wac_YMb(a){switch(a){case 2:case 4:case 3:a=2;break;default:a=1}return a}
wac_b4.prototype={az:0,HTb:0,ZC:null,Ra:null,nNc:null,YUa:null,zp:null,_initialized:!1,zEa:null,R7:null,dB:null,jW:null,$nb:!1,bN:null,Dc:null,L2b:function(){return this.p2.oj()},R9:function(){return!!this.zp&&this.zp.Cg()},GIa:function(a){this.zp?this.zp.Cg()!==a&&(this.zp.te(a),this.Ra.wa("PSCH",new wac_Nm(a?1:0),null)):a&&wac_b(8728835,333,10,"Trying to set visible while flexpane is null");return a},yZa:function(a){this.Ra.xa("PSCH",a)},AZa:function(a){this.Ra.xa("unreadConvEventKey",a)},HV:function(){this.ZC?
(wac_ZMb(this),this.GIa(!0)):wac_b(8696157,333,10,"SkypeApi is null so will not render content.")},A_:function(){this.GIa(!1)},tb:function(){if(this._initialized)return this.aqa.oj();this._initialized=!0;this.R7=wac_Qb(wac_c4(this.zEa));var a=this.zEa.wW;1===a&&(wac_b(8757720,333,50,"Starting skype experience for Consumers users."),window.setTimeout(function(){wac_b(18655443,333,50,"Starting skype experience for Consumer users with longer sessions.")},15E3));2===a&&(wac_b(8757721,333,50,"Starting skype experience for Enterprise users."),
window.setTimeout(function(){wac_b(18655444,333,50,"Starting skype experience for Enterprise users with longer sessions.")},15E3));var b=this.Dc.Qb.SkypeBootstrapUrl.toString(),c=this.Dc.Qb.SkypeApiKey.toString(),a=wac__Mb(this,a);wac_PMb(this.dB).Wd();var d=this.nNc.og(b,c,!1,a),e=this;d.CW(function(){var a=wac_Qb(d);if(a){wac_PMb(e.dB)&&wac_PMb(e.dB).vg();e.ZC=a;var a=wac_b,b;try{b=e.ZC.kZ.getVersion()}catch(c){wac_b(8947681,333,10,"Skype GetVersion error. Message: {0}, Callstack: {1}",c.message,
c.stack),b=""}a(8696158,333,50,"The Skype api version we are using is: {0}.",b);if(e.ZC.rJb()){if(e.R7.uka){wac_d4(e,1,!1);wac_0Mb(e);wac_1Mb(e);try{wac_b(8947683,333,50,"Calling Skype Api auth provider for implicit auth."),wac_QMb(e.dB).Wd(),wac_XMb(e.ZC,new wac_2Mb(wac_uMb.toString(1),null,null,null,null,null),e.efd,e.dfd)}catch(c){wac_b(8947712,333,10,"Error setting auth provider {0}. Callstack: {1}.",c.message,c.stack)}}else e.R7.gva&&wac_d4(e,4,!1);b=e.ZC;b.a2b||wac_b(17105567,333,10,"Skype Native Contact activity is null");
b.a2b.unreadConversations.subscribe(e.IJa);try{e.ZC.kZ.setNotificationHandler(e.Bkd)}catch(c){wac_b(8979149,333,10,"Skype SetNotificationHandler error. Message: {0}, Callstack: {1}",c.message,c.stack)}}else wac_b(17440902,333,50,"The Skype api is not available for this browser."),wac_d4(e,1,!1);e.aqa.Ze(!0)}else wac_b(8947682,333,10,"Skype client unavailable. Failed to initialize SWX api."),wac_d4(e,0,!1),e.aqa.Ze(!1)});return this.aqa.oj()},NNd:function(){wac_d4(this,2,!1);wac_b(8947717,333,50,"Authentication is successful.");
wac_3Mb(this)},MNd:function(a){wac_d4(this,1,!1);this.zEa.BWb?wac_um()?wac_b(17126927,333,10,"Skype authentication failing for Internet Explorer. Error: {0}",a):wac_b(8947718,333,10,"Skype authentication failing. Error: {0}",a):wac_b(16831619,333,15,"MSIT user failed to authenticate with Skype. Error: {0}",a)},M9:function(a){this.Ra.xa("availEventKey",a)},Iya:function(a,b,c,d,e){if(a)if(2===this.az||5===this.az)wac_4Mb(this,a,b,c);else if(4===this.az){if(!this.$nb){var f=this;wac_5Mb(this,d,function(){wac_4Mb(f,
a,b,c)},c,e,a)}}else wac_b(18900673,333,50,"Cannot perform join operation when client is not signed in!"),c();else wac_b(16832196,333,50,"Not performing join operation as convUri is null"),c()},Gy:function(a){a?(this.HTb=this.az,wac_d4(this,3,!0),this.A_()):3===this.az&&wac_d4(this,this.HTb,!0)},LQa:function(a){3!==this.az&&this.Ra.wa("unreadConvEventKey",new wac_7la(a),null)},hUd:function(a){if(3!==this.az){var b=wac_zMb(a.type),c,d=this,e=this,f=this,b=(c=new wac_Mm,c.Fg=b,c.Ixb=a.sender.avatar(),
c.dG=a.sender.displayName(),c.Wka=a.sender.status(),c.Nl=a.title(),c.fA=a.description(),c.bxb=function(){d.HV();a.accept()},c.G5a=function(b){e.HV();a.accept(b)},c.wBb=function(){f.HV();a.open()},c.myb=function(){a.decline()},c.fwa=function(){a.sound.play()},c.m8a=function(){a.sound.stop()},c.eDb=function(b){a.active.subscribe(b)},c.IZ=wac_YMb(b),c);wac_AMb(this.jW,this,b)}},O:function(){this.A_();this.jW&&(this.jW.dispose(),this.jW=null);this.zp=this.ZC=null}};
function wac_3Mb(a){wac_QMb(a.dB)&&wac_QMb(a.dB).vg();wac_JMb(a.dB)&&wac_JMb(a.dB).vg()}
function wac_6Mb(a){if(a.zp.Nc()){var b=document.createElement("div");Sys.UI.DomElement.addCssClass(b,"ChatPane");Sys.UI.DomElement.addCssClass(b,"skypeWX");Sys.UI.DomElement.addCssClass(b,"Selectable");!a.R7.uka&&a.R7.gva&&Sys.UI.DomElement.addCssClass(b,"DocChatOnly");a.zp.Nc().appendChild(b);a=document.createElement("div");a.className="ChatContent";a.id="SkypePaneContent";b.appendChild(a);a=document.createElement("div");a.id="SkypePaneTimeline";a.className="ChatTimeline";b.appendChild(a)}else wac_b(8696159,
333,10,"Failed to get chatpane Element so not creating content and timeline divs.")}function wac_4Mb(a,b,c,d){1===a.zEa.wW?wac_b(18699104,333,15,"Joining Conversation for Consumer"):wac_b(18699105,333,15,"Joining Conversation for Business");b=1===a.zEa.wW?String.format("19:{0}",b):b;a.ZC.Iya(b,c,d)}function wac_d4(a,b,c){c||3!==a.az?a.az!==b&&(a.az=b,a.Ra.wa("availEventKey",new wac_Lm(a.az),null),wac_b(17052561,333,50,"client state {0}",b)):a.HTb=b}
function wac_7Mb(a){a.ZC.l_a().authenticated.subscribe(function(b){b?(wac_d4(a,5,!1),wac_b(18121751,333,50,"Successfully authenticated as ANONYMOUS and setting state to AnonymousChatConnected.")):(wac_d4(a,4,!1),wac_b(18121752,333,10,"Skype authentication error, ANONYMOUS authentication failed or got disconnected."))})}
function wac_5Mb(a,b,c,d,e,f){e?f?(b||wac_b(17846557,333,15,"Attempting to sign in  anonymously without a user friendly name..."),wac_7Mb(a),wac_QMb(a.dB).Wd(),wac_b(18200788,333,15,"Start anonymous sign in."),a.$nb=!0,wac_XMb(a.ZC,new wac_2Mb(wac_uMb.toString(4),null,null,null,null,new wac_8Mb(b,f,e,!0)),function(){a.$nb=!1;wac_d4(a,5,!1);wac_b(17846558,333,50,"Skype anonymous authentication was successful.");wac_3Mb(a);c()},function(b){a.$nb=!1;wac_d4(a,4,!1);wac_b(17846559,333,10,"Skype anonymous authentication failed. Error: {0}",
b);d()})):wac_b(17846556,333,10,"Cannot attempt to sign in  anonymously with conversation uri being null or empty."):wac_b(17846555,333,10,"Cannot attempt to sign in anonymously with conversation discovery uri being null or empty.")}function wac_0Mb(a){a.ZC.l_a().uri.subscribe(function(b){b?(wac_b(8947716,333,50,"Successfully got an user identifier from Skype client."),a.p2.Ze(b)):wac_b(8947715,333,10,"Skype client lost the user URI!")})}
function wac_1Mb(a){a.ZC.l_a().authenticated.subscribe(function(b){b?(wac_d4(a,2,!1),wac_b(8947713,333,50,"Authenticated and setting signed in.")):(wac_d4(a,1,!1),wac_b(8947714,333,10,"Skype authentication error, authentication failed or disconnected from SWX."))})}
function wac__Mb(a,b){var c=wac_nm(wac_Lg(a.Dc,"Lcid",1033)),d;switch(a.bN.Nv()){case 3:d="Word";break;case 4:d="OneNote";break;case 1:d="Excel";break;case 2:d="PowerPoint";break;default:d="UnknownWAC"}switch(a.bN.Uob()){case 1:d+=" Edit";break;case 2:d+=" View"}return new wac_9Mb(b,c?c._name:null,d,a.Dc.Qb.SessionId)}
function wac_ZMb(a){if(!a.zp){a.zp=a.YUa.Db(CommonUIStrings.l_SkypeTooltip,function(){a.ZC.zw(!0)},function(){a.ZC.zw(!1)},3476734992);wac_b(8696156,333,15,"Setting Chat pane to visible and attempting to create the divs.");wac_6Mb(a);try{try{a.ZC.kZ.renderContent("#SkypePaneContent")}catch(b){wac_b(8757717,333,10,"Skype render content error. Message: {0}, Callstack {1}",b.message,b.stack)}try{a.ZC.kZ.renderSidebar("#SkypePaneTimeline")}catch(b){wac_b(8757718,333,10,"Skype render sidebar error. Message: {0}, Callstack: {1}",
b.message,b.stack)}}catch(b){wac_b(8728836,333,10,"Failure to render the skype api. Message: {0}, Callstack: {1}",b.message,b.stack)}}}function wac_EMb(){this.zkd=Function.createDelegate(this,this.mNb);this.Akd=Function.createDelegate(this,this.gUd);this.vid=Function.createDelegate(this,this.SQd);this.uo=new (wac_Rb.$$(wac_WMb))}
wac_EMb.prototype={bpa:null,pGc:null,FSc:null,_jsonp:!1,TGc:!1,og:function(a,b,c,d){if(!a)return wac_b(19726497,333,10,"Cannot initialize Skype. Invalid setting for Skypebootstrap url."),this.uo.Ze(null),this.uo.oj();this.pGc=b;this.FSc=d.pkc;this._jsonp=c;this.bpa=new wac_$Mb;this.bpa.userAppId=d.Pvd;this.bpa.hostProperty=d.Ztc;this.bpa.userId=d.cwd;this.bpa.sessionId=d.Bsc;this.bpa.experienceId=wac_d.Qa.QI.UEb.toString(d.Gyb);this.TGc=2===d.Gyb;try{var e=this.vid,f=a?wac_Ll(a,null,null,null,!1,
!1,null,!0,!1):null;f&&wac_rl(f,e);try{wac_ul(f)}catch(g){wac_b(8757722,333,10,"Failure downloading the skype api bootstrapper: Message: {0}, Callstack: {1}",g.message,g.stack)}wac_b(8254435,333,100,"Downloading SWX bootstrapper from: {0}",a)}catch(g){wac_b(8245794,333,10,"Exception loading the api Message: {0} Callstack: {1}.",g.message,g.stack)}return this.uo.oj()},SQd:function(a,b){if(b.XP){wac_b(8210202,333,50,"Calling the Skype initialized method.");try{window.Skype.initialize(new wac_aNb(this.pGc,
this.FSc,this._jsonp,this.bpa,this.TGc),this.Akd,this.zkd)}catch(c){wac_b(8245795,333,10,"Exception in initializing the Skype SWX api Message: {0} Callstack: {1}.",c.message,c.stack),this.uo.Ze(null)}}else wac_b(8210203,333,10,"Failed to download the SkypBootstrapper."),this.uo.Ze(null)},gUd:function(a){if(a){var b,c,d;var e=b={val:b};try{e.val=new wac_WMb(a),d=!0}catch(f){wac_b(8757716,333,10,"SkypeApi initialization error. Message: {0}, Callstack: {1}",f.message,f.stack),e.val=null,d=!1}(c=d,b=
b.val,c)?(wac_b(8245825,333,50,"Initializing succeeded and about to create the api instance."),this.uo.Ze(b)):(this.mNb("This is not real success. Invalid native api object."),this.uo.Ze(null))}else this.mNb("This is not real success. Null native api object."),this.uo.Ze(null)},mNb:function(a){wac_b(8210207,333,10,"Skype Api error: {0}",a);this.uo.Ze(null)}};function wac_9Mb(a,b,c,d){this.Gyb=a;this.pkc=b;this.Ztc=c;this.Bsc=d}wac_9Mb.prototype={Gyb:0,pkc:null,Ztc:null,cwd:null,Bsc:null,Pvd:null};
function wac_$3(a,b){this.Ddd=Function.createDelegate(this,this.rKd);wac_$3.initializeBase(this,[a]);this.lRc=b;this.BWb=!0;this.CWb=new (wac_f.$$(Boolean))(this.Ddd)}wac_$3.prototype={lRc:null,l0b:null,m0b:null,CWb:null,BWb:!1,rKd:function(){return wac_ym()||wac_Fh()&&!wac_6i()||wac_eg()&&!wac_Ek()&&!wac_mh(8)||Sys.Browser.agent===Sys.Browser.Opera||0<=window.navigator.userAgent.indexOf("OPR")?!1:!0}};
function wac_TMb(a){a.CWb.ma()?2===a.wW?a.lRc.uc(function(b){a.l0b=b;b.jgf().CW(function(){a.m0b=a.l0b.jgf();if(wac_Gb(a.m0b)||!a.m0b.qB())wac_b(17949148,333,15,"Shell info task was canceled or was not completed"),a.xZ.Ze(!1);else{var b=wac_Qb(a.l0b.jgf()),d=!1;try{var e,f,g;if(g=wac_dP(Object,b.ClientData.toString(),f={val:e}),e=f.val,g)if(wac_q(a.qwa,"BasicChatIsForced"))d=!0,a.BWb=!1;else{var h=e.IsTenantDirSyncEnabled,k=e.HasSkypeLicense,d=!h&&k;wac_b(17949149,333,50,"Suite UX Skype check resulted in Enabled:{0}, from: Tenant Hybrid:{1}; License:{2}",
d,h,k)}}catch(l){wac_b(17949150,333,15,"object format is incorrect. Error {0}",l.message)}a.xZ.Ze(d)}})}):1===a.wW||3===a.wW?a.xZ.Ze(!0):a.xZ.Ze(!1):a.xZ.Ze(!1)}function wac_8Mb(a,b,c,d){this.displayName=a;this.conferenceUri=b;this.discoveryUri=this.discoverUri=c;this.useInternalAnonFlow=d}wac_8Mb.prototype={displayName:null,conferenceUri:null,discoverUri:null,discoveryUri:null,useInternalAnonFlow:!1};
function wac_2Mb(a,b,c,d,e,f){this.type=a;this.username=b;this.password=c;this.token=d;this.product=e;this.options=f}wac_2Mb.prototype={type:null,username:null,password:null,token:null,product:null,options:null};function wac_aNb(a,b,c,d,e){this.apiKey=a;this.locale=b;this.correlationIds=d;this.jsonp=c;this.business=e}wac_aNb.prototype={correlationIds:null,apiKey:null,locale:null,jsonp:!1,business:!1};function wac_$Mb(){}
wac_$Mb.prototype={hostProperty:null,userId:null,sessionId:null,userAppId:null,experienceId:null};function wac_bNb(a,b){this.ehc=Function.createDelegate(this,this.jVd);this.dispose=this.O;wac_bNb.initializeBase(this);this.wg=a;this.Ra=new wac_Re;this.Mga=document.createElement("div");a=wac_e4(this.Mga,"div");this.RZb=new wac_cNb(a);a=wac_e4(this.Mga,"div");this.elb=new wac_dNb(a,this.wg);Sys.UI.DomElement.addCssClass(this.Mga,"SkypeToastDiv");this.uVa=!1;wac_eNb(this,b)}
function wac_fNb(a){switch(a.Fg){case 2:return a.bxb;case 1:case 4:return a.wBb;case 3:return function(){a.G5a("Audio")};default:return Function.emptyFunction}}function wac_gNb(a){switch(a.Fg){case 3:return function(){a.G5a("Chat")};default:return null}}function wac_hNb(a){switch(a){case 2:return 25E3;case 1:case 4:return 7E3;case 3:return 6E4;default:return 7E3}}
wac_bNb.prototype={Mga:null,Nc:function(){return this.Mga},RZb:null,elb:null,fYb:null,Fqa:null,uVa:!1,WVb:null,Ra:null,wg:null,om:!1,HIc:!1,sl:function(){this.HIc||(wac_b(17114642,333,100,"Dismissing toast type: <{0}>.",this.Fqa.Fg),this.HIc=!0,wac_iNb(this),this.Fqa.m8a&&this.Fqa.m8a(),this.Ra.wa("toastDismissedEventKey",null,null))},jVd:function(){this.fYb&&this.fYb();return!0},O:function(){this.om||(this.om=!0,this.wg.ub("click",this.Mga,this.ehc),this.elb.O(),this.Mga=this.RZb=this.elb=null)}};
function wac_jNb(a,b){return function(){b&&b();wac_b(17114643,333,100,"Toast action taken...");a.sl()}}function wac_iNb(a){a.uVa&&(wac_p().Rg(a.WVb),a.uVa=!1)}function wac_kNb(a,b){wac_iNb(a);a.WVb=new wac_D(2,1,wac_hNb(b),function(){a.uVa=!1;wac_b(17114641,333,100,"Auto-hide toast task executing...");a.sl()},73,null,!1);wac_p().Hb(a.WVb);a.uVa=!0}
function wac_eNb(a,b){a.Fqa=b;wac_b(17114639,333,100,"Building toast type: <{0}>.",a.Fqa.Fg);wac_lNb(a.RZb,b.Ixb);a.fYb=wac_jNb(a,wac_fNb(b));var c=wac_gNb(b);wac_mNb(a.elb,b.dG,b.Nl,b.fA,b.Fg,wac_jNb(a,b.myb),c?wac_jNb(a,c):null);b.fwa&&b.fwa();wac_kNb(a,b.Fg);a.Fqa.eDb(function(b){b||(wac_b(17114640,333,100,"Notification inactive triggered..."),a.sl())});a.wg.ya("click",a.Mga,a.ehc)}function wac_GMb(a){this.wg=a}wac_GMb.prototype={wg:null,Db:function(a){return new wac_bNb(this.wg,a)}};
function wac_f4(){}wac_f4.prototype={};function wac_e4(a,b){b=document.createElement(b);a.appendChild(b);return b}function wac_HMb(a,b){this.rld=Function.createDelegate(this,this.kVd);this.hpd=Function.createDelegate(this,this.j_d);this.dispose=this.O;wac_HMb.initializeBase(this);this.fKc=a;this.VYa=new (wac_f.$$(Object))(this.hpd);this.zSc=b}
function wac_zMb(a){switch(a.toLowerCase()){case "unreadmessage":return 1;case "chat":return 2;case "audio":return 3;case "contactrequest":return 4;default:return 0}}wac_HMb.prototype={VYa:null,N8:null,fKc:null,zSc:null,c6d:!1,j_d:function(){var a=this.fKc(),a=wac_e4(a,"div");Sys.UI.DomElement.addCssClass(a,"SkypeToastManagerContainer");return a},kVd:function(){this.N8&&(this.VYa.ma().removeChild(this.N8.Nc()),this.N8.dispose(),this.N8=null);this.VYa.ma().style.display="none"},O:function(){wac_nNb(this)}};
function wac_nNb(a){a.N8&&(wac_b(17114645,333,100,"About to show new toast over existing one..."),a.N8.sl())}
function wac_AMb(a,b,c){wac_c(17114644,333,!!b,null);var d;a.c6d||3===b.az||!c.Fg?d=!1:a.N8&&3===a.N8.Fqa.Fg?(wac_b(17114646,333,100,"Ignoring new [{0}] notification while last A/V toast is still up...",c.Fg),d=!1):d=!0;if(d){switch(c.IZ){case 0:d=!1;break;case 1:d=!b.R9();break;case 2:d=!0;break;default:d=!1}wac_b(17118549,333,100,"{0}toast for notification level {1}. Chat Pane was visible: {2}.",d?"SHOW ":"SKIP ",c.IZ,b.R9());d?(b=a.zSc.Db(c),b.Ra.xa("toastDismissedEventKey",a.rld),wac_nNb(a),a.VYa.ma().style.display=
"block",a.VYa.ma().appendChild(b.Nc()),a.N8=b):c.fwa&&c.fwa()}}function wac_dNb(a,b){this.dispose=this.O;wac_dNb.initializeBase(this);this.flb=a;Sys.UI.DomElement.addCssClass(this.flb,"SkypeNotificationArea");this.wg=b;this.hlb=wac_e4(this.flb,"div");Sys.UI.DomElement.addCssClass(this.hlb,"SkypeNotificationTopBar");a=wac_e4(this.hlb,"div");this.gOc=new wac_oNb(a);a=wac_e4(this.hlb,"div");this.iOc=new wac_pNb(a);a=wac_e4(this.flb,"div");this.YWa=new wac_qNb(a,this.wg)}
wac_dNb.prototype={flb:null,hlb:null,gOc:null,iOc:null,YWa:null,wg:null,O:function(){this.YWa&&(this.YWa.O(),this.YWa=null)}};
function wac_mNb(a,b,c,d,e,f,g){var h=a.gOc;switch(e){case 3:d=CommonUIStrings.l_NotificationIncomingCall}h.b0b.innerText=b;h.c0b.innerText=c;h.IN.innerText=d;b=a.iOc;c=wac_6h(40,40,b.wCa[wac_d.Qa.QI.wca.toString(e)],wac_5h,"cui-img-cont-float","",!1,"",b.lDa.ownerDocument,null);b.glb&&b.lDa.removeChild(b.glb);b.lDa.appendChild(c);b.glb=c;a=a.YWa;b=CommonUIStrings.l_NotificationRespond;c=CommonUIStrings.l_NotificationIgnore;h=CommonUIStrings.l_NotificationAnswerWithIM;switch(e){case 3:b=CommonUIStrings.l_NotificationAnswer;
a.O7.style.display="";a.O7.style.maxWidth="120px";a.lTa.style.maxWidth=a.Wpa.style.maxWidth="65px";break;default:a.O7.style.display="none",a.lTa.style.maxWidth=a.Wpa.style.maxWidth=""}a.lTa.innerText=b;a.Wpa.innerText=c;a.O7.innerText=h;a.eWb=f;a.SSb=g}
function wac_qNb(a,b){this.Fdc=Function.createDelegate(this,this.zNd);this.Iec=Function.createDelegate(this,this.gQd);this.dispose=this.O;wac_qNb.initializeBase(this);this.YSa=a;Sys.UI.DomElement.addCssClass(this.YSa,"SkypeNotificationActionArea");this.wg=b;this.lTa=wac_e4(this.YSa,"div");Sys.UI.DomElement.addCssClass(this.lTa,"SkypeNotificationButton");this.Wpa=wac_e4(this.YSa,"div");Sys.UI.DomElement.addCssClass(this.Wpa,"SkypeNotificationButton");this.wg.ya("click",this.Wpa,this.Iec);this.O7=wac_e4(this.YSa,
"div");Sys.UI.DomElement.addCssClass(this.O7,"SkypeNotificationButton");this.O7.style.display="none";this.wg.ya("click",this.O7,this.Fdc)}wac_qNb.prototype={YSa:null,lTa:null,Wpa:null,O7:null,eWb:null,SSb:null,wg:null,gQd:function(){this.eWb&&this.eWb();return!0},zNd:function(){this.SSb&&this.SSb();return!0},O:function(){this.wg.ub("click",this.Wpa,this.Iec);this.wg.ub("click",this.O7,this.Fdc)}};
function wac_oNb(a){wac_oNb.initializeBase(this);this.g2=a;Sys.UI.DomElement.addCssClass(this.g2,"SkypeNotificationText");this.b0b=wac_e4(this.g2,"span");Sys.UI.DomElement.addCssClass(this.b0b,"SkypeNotificationSender");this.c0b=wac_e4(this.g2,"span");Sys.UI.DomElement.addCssClass(this.c0b,"SkypeNotificationTitle");this.IN=wac_e4(this.g2,"span");Sys.UI.DomElement.addCssClass(this.IN,"SkypeNotificationMessage")}wac_oNb.prototype={g2:null,b0b:null,c0b:null,IN:null};
function wac_pNb(a){this.wCa={};wac_pNb.initializeBase(this);this.lDa=a;Sys.UI.DomElement.addCssClass(this.lDa,"SkypeNotificationType");this.glb=wac_e4(this.lDa,"span");a=wac_8h;var b=wac_7h(a,"WACSkypeChatRequest_40x40x32");this.wCa[wac_d.Qa.QI.wca.toString(0)]=b;this.wCa[wac_d.Qa.QI.wca.toString(1)]=b;this.wCa[wac_d.Qa.QI.wca.toString(2)]=b;this.wCa[wac_d.Qa.QI.wca.toString(4)]=b;this.wCa[wac_d.Qa.QI.wca.toString(3)]=wac_7h(a,"WACSkypeVoiceRequest_40x40x32")}wac_pNb.prototype={lDa:null,glb:null};
function wac_cNb(a){wac_cNb.initializeBase(this);this.Tlb=a;Sys.UI.DomElement.addCssClass(this.Tlb,"SkypePresenceArea");this.Ulb=wac_e4(this.Tlb,"div");Sys.UI.DomElement.addCssClass(this.Ulb,"SkypePresenceIndicator");a=wac_e4(this.Tlb,"div");this.zPc=new wac_rNb(a)}wac_cNb.prototype={Tlb:null,Ulb:null,zPc:null,sUb:null};function wac_lNb(a,b){a.sUb&&Sys.UI.DomElement.removeCssClass(a.Ulb,a.sUb);Sys.UI.DomElement.addCssClass(a.Ulb,"skPresenceUnknown");a.sUb="skPresenceUnknown";a.zPc.jea(b)}
function wac_rNb(a){wac_rNb.initializeBase(this);this.hWb=a;Sys.UI.DomElement.addCssClass(this.hWb,"SkypePresenceImage");this.wu=wac_e4(this.hWb,"img");Sys.UI.DomElement.addCssClass(this.wu,"SkypePresenceImage")}wac_rNb.prototype={hWb:null,wu:null,jea:function(a){this.wu.src=a}};wac_xMb.registerClass("BasicChat.ChatClientFactory",null,wac_Jm);wac_93.registerClass("BasicChat.ChatClientMock",null,wac_5la,Sys.IDisposable);wac_BMb.registerClass("BasicChat.CommonBasicChatPackage",null,wac_I,wac_i);
wac_FMb.registerClass("BasicChat.BasicChatActor",null,wac_sMb,Sys.IDisposable);wac_a4.registerClass("BasicChat.BasicChatPerformanceManager");wac_RMb.registerClass("BasicChat.BasicChatUserExperienceController",null,wac_Im);wac_VMb.registerClass("BasicChat.FlexPane",null,wac_Rca,Sys.IDisposable);wac_DMb.registerClass("BasicChat.FlexPane.Factory",null,wac_qc);wac_WMb.registerClass("BasicChat.SkypeApi");wac_b4.registerClass("BasicChat.SkypeChatClient",null,wac_5la,Sys.IDisposable);wac_EMb.registerClass("BasicChat.SkypeLoader");
wac_9Mb.registerClass("BasicChat.SkypeSettings");wac_$3.registerClass("BasicChat.SkypeWebExperienceController",wac_RMb,wac_tMb,wac_Im);wac_8Mb.registerClass("BasicChat.SkypeAnonymousJoinOptions");wac_2Mb.registerClass("BasicChat.SkypeAuth");wac_aNb.registerClass("BasicChat.SkypeNativeInitParams");wac_$Mb.registerClass("BasicChat.SkypeNativeInitParamsCorrelationIds");wac_f4.registerClass("BasicChat.SkypeToastDomObjectBase");wac_bNb.registerClass("BasicChat.SkypeToast",wac_f4,wac_vMb,Sys.IDisposable);
wac_GMb.registerClass("BasicChat.SkypeToast.Factory",null,wac_wMb);wac_HMb.registerClass("BasicChat.SkypeToastManager",wac_f4,wac_Km,Sys.IDisposable);wac_dNb.registerClass("BasicChat.SkypeToastNotificationArea",wac_f4,Sys.IDisposable);wac_qNb.registerClass("BasicChat.SkypeToastNotificationButtons",wac_f4,Sys.IDisposable);wac_oNb.registerClass("BasicChat.SkypeToastNotificationText",wac_f4);wac_pNb.registerClass("BasicChat.SkypeToastNotificationType",wac_f4);
wac_cNb.registerClass("BasicChat.SkypeToastPresenceArea",wac_f4);wac_rNb.registerClass("BasicChat.SkypeToastPresenceImage",wac_f4);var wac_83=null;wac_J(wac_C(),new wac_BMb,0,!1);Type.registerNamespace("Common.App.DisplayEnvironmentName");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.aue=wac_d.Qa.aue||{};function wac_Lnc(a,b){this.cte=Function.createDelegate(this,this.owe);this.Ia=a;this.Dc=b}
wac_Lnc.prototype={Ia:null,Dc:null,Wfe:null,Tb:function(){(this.Wfe=this.Dc.Qb.StatusBarEnvironmentNameToUse)&&""!==this.Wfe&&this.Ia.jf(3887408216,2147483648,this.cte,96)},owe:function(a,b,c,d,e){if(1===c)return 32;e.Value=this.Wfe;e.LabelText=this.Wfe;e[wac_hT.Visible]=!0;return 32}};function wac_Mnc(){}
wac_Mnc.prototype={sa:null,Ub:function(){return"Common.App.DisplayEnvironmentName"},gc:function(a){this.sa=a;wac_m(wac_n(this.sa.fa(wac_Lnc)),function(){return new wac_Lnc(wac_z(),wac_.pa)})},tb:function(){this.sa.H(wac_Lnc).Tb()},O:function(){}};wac_Lnc.registerClass("Common.App.DisplayEnvironmentName.DisplayEnvironmentName");wac_Mnc.registerClass("Common.App.DisplayEnvironmentName.DisplayEnvironmentNamePackage",null,wac_I,wac_i);wac_J(wac_C(),new wac_Mnc,0,!1);
window.InsightsTaskPaneData={name:"CommandUI",attrs:{xmlns:"http://schemas.microsoft.com/sharepoint/"},children:[{name:"TaskPane",attrs:{Id:"InsightsTaskPane",Title:"STR@L_SmartLookupPaneTitle",Width:"400"},children:[{name:"Groups",attrs:{},children:[{name:"Group",attrs:{Id:"InsightsIFrameContainer",IsStretched:"true"}}]}]}]};Type.registerNamespace("Common.App.Insights");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.$4c=wac_d.Qa.$4c||{};function wac_gHc(){}wac_gHc.registerInterface("Common.App.Insights.IInsightsManager");
function wac_hHc(){}function wac_iHc(){}wac_iHc.registerInterface("Common.App.Insights.IInsightsPane");function wac_jHc(){}wac_jHc.registerInterface("Common.App.Insights.IInsightsPaneHandler");function wac_kHc(){}wac_kHc.registerInterface("Common.App.Insights.IInsightsSelection");function wac_A7c(){}function wac_B7c(){}
function wac_C7c(a,b,c,d,e){this.ISe=Function.createDelegate(this,this.r0e);this.dispose=this.O;this.nd=a;if(this.O6e=e){var f;a=(f=new wac_lxc,f.channelId="SmartLookup",f.approvedOriginPattern=wac_.pa.Qb.SmartLookupApprovedOriginPattern,f);f=new (wac_g.$$(wac_qxc));b&&f.ga(b);c&&f.ga(c);d&&f.ga(d);this.BWf=window.SmartLookupHostRuntime.setup(a,f.xe(),!0);b=wac_q(wac_.pa,"SerpletEnableNewOAuthIsEnabled");this.fke=new wac_pxc;this.fke.EnableAllTabV2=wac_q(wac_.pa,"SmartLookupEnableAllTabV2");this.fke.EnableIntentService=
wac_q(wac_.pa,"SmartLookupEnableIntentService");this.fke.EnableInDocumentSearch=wac_q(wac_.pa,"SmartLookupEnableInDocumentSearch");this.fke.EnableInDocumentSearchReplace=wac_q(wac_.pa,"SmartLookupEnableInDocumentSearchReplace");this.fke.EnableLocalSearch=wac_q(wac_.pa,"SmartLookupEnableLocalSearch");this.fke.IntentServiceEndpoint=wac_D7c();this.fke.SmartLookupBrowserPaneActionsEnabled=!0;this.fke.DisableFilesTab=!b;this.fke.EnableNewOAuth=b;this.k4e=wac_j().H(wac_Exc);this.Nqf=wac_q(wac_.pa,"IsTellMeUpSellEnterpriseEnabled");
this.Dhf=wac_.pa.Qb.SmartLookupShredderServiceEndpoint;this.LFf=wac_ztb(wac_.pa.Qb.AppCatalogUrl||"");this.QFf=wac_.pa.Qb.UserPrincipalName;this.k4e&&wac_E7c(this.k4e,this.Dhf)}}
wac_C7c.prototype={BWf:null,HVe:null,Eff:null,Khc:null,nd:null,k4e:null,fke:null,Nqf:!1,Dhf:null,LFf:null,QFf:null,O6e:!1,r0e:function(a){if(this.O6e){var b;a=a.rawEvent;try{b=wac_yl(a.data)}catch(f){wac_b(595161728,1303,15,this.sda("Message data from Serplet [{0}] failed to deserialize.",a.data));return}switch(b.actionType){case 101:b.data=wac_F7c(this);wac_DHc(this,b);break;case 118:if(this.Eff)b.data=this.Eff;else{var c,d;b.data=(d=new wac_2yc,d.selection=(c=new wac_Fxc,c.neighborhood=this.HVe.neighborhood,
c.mentionStart=this.HVe.mentionStart,c.mentionLength=this.HVe.mentionLength,c),d)}wac_DHc(this,b);this.Eff=null;break;case 103:c=wac_yl(window.$$as(String,b.data));wac_G7c(c);break;case 206:var e=this;(this.k4e?this.k4e.Kxd("SmartLookup",b.data):Promise.resolve("")).then(function(a){b.data=a;wac_DHc(e,b)})}}}};
function wac_F7c(a){var b=new wac_oxc;b.anid="";3===wac_r().Hd().Nv()?b.applicationName="WORD":b.applicationName="POWERPNT";b.applicationVersion=wac_.jv;b.appCorrelationId=a.Khc;b.themePlatform="web";b.lcid=wac_.vh;b.launchUtcTime=(new Date).toUTCString();b.featureGates=a.fke;var c=wac_nm(wac_.vh),c=c?c._name:null;b.market=wac_H7c(c);b.uiLanguage=c;b.sessionId=wac_.Ag;b.themeId=5;b.parentalControl="yes";b.accessToken=a.k4e?wac_E7c(a.k4e,a.Dhf):"";var d=new wac_mxc;d.CountryCode=wac_H7c(c);d.ServiceEndpoint=
a.Dhf;d.IsGoLocal=!1;d.IsEnabled=a.Nqf;d.IsEnterpriseEnabled=a.Nqf;d.TenantRoot=a.LFf;d.Upn=a.QFf;b.enterpriseUserInfo=d;return b}
function wac_lHc(a,b,c,d){this.jZe=Function.createDelegate(this,this.ldd);this.xIf=Function.createDelegate(this,this.UQf);this.wIf=Function.createDelegate(this,this.TQf);this.yIf=Function.createDelegate(this,this.Jkf);this.UKf=Function.createDelegate(this,this.nVf);this.nZe=Function.createDelegate(this,this.a1e);this.mZe=Function.createDelegate(this,this.$0e);this.tZe=Function.createDelegate(this,this.g1e);this.sZe=Function.createDelegate(this,this.f1e);this.dispose=this.O;this.wua=a;this.Ia=b||wac_z();
this.sN=c;this.nd=d;a=this.nd.xc("InsightsTaskPane");a.re="main";wac_mk(a,this.jZe);wac_4j(this.sN,"InsightsTaskPane")}function wac_mHc(a,b,c){a={appCorrelationId:b,message:a};if(c)for(var d in c)b={key:d,value:c[d]},a[b.key]=b.value;return wac_ai(a)}function wac_nHc(){return wac_5k().toString()}
wac_lHc.prototype={wua:null,Ia:null,nd:null,sN:null,Tb:function(){this.Ia.jf(1435347209,2147483648,this.sZe,64);this.Ia.jf(3317204163,2147483648,this.tZe,64);this.Ia.jf(1756450500,2147483648,this.mZe,64);this.Ia.jf(2114287254,2147483648,this.nZe,64);this.Ia.jf(2603175857,2147483648,this.UKf,64);if(wac_q(wac_.pa,"SmartLookupEnableNativePane")||wac_q(wac_.pa,"SmartLookupIsEnabled"))this.Ia.jf(1914896509,2147483648,this.yIf,64),this.Ia.jf(2670256092,2147483648,this.wIf,64),this.Ia.jf(3565729580,2147483648,
this.xIf,64)},f1e:function(a,b,c,d,e){if(1===c)return this.wua.ma().Syf()?32:8;a=wac_nHc();b=this.wua.ma().vkf();var f;if(wac_q(wac_.pa,"SmartLookupEnableNativePane")){b=(f=new wac_Fxc,f.neighborhood=b.neighborhood,f.mentionStart=b.mentionStart,f.mentionLength=b.mentionLength,f);var g;f=(g=new wac_2yc,g.selection=b,g.userIntent=null,g.entryPoint=0,g.launchData=null,g);return wac_pHc(this,e,null,f,a,0)}return wac_pHc(this,e,b,null,a,0)},$0e:function(a,b,c,d,e){if(1===c)return this.wua.ma().Syf()?32:
8;a=wac_nHc();b=this.wua.ma().vkf();return wac_pHc(this,e,b,null,a,1)},g1e:function(a,b,c,d,e){return 1===c?32:wac_qHc(this,e,0)},a1e:function(a,b,c,d,e){return 1===c?32:wac_qHc(this,e,1)},nVf:function(a,b,c,d,e){if(1===c)return 32;if(!e)return 8;a=e.query?e.query:"";b=wac_nHc();c=new wac_EHc;c.neighborhood=a;c.mentionStart=0;c.mentionLength=a.length;return wac_pHc(this,e,c,null,b,0)},Jkf:function(a,b,c,d,e){if(1===c)return 32;b=e;if(!b)return 8;a=wac_nHc();if(c=b.CommandValueId)try{b=wac_yl(c)}catch(h){return wac_b(51700099,
1313,15,"SmartLookup application interface [{0}] is not in proper format",c),8}c=b;if(!b.selection)if(b.neighborhood){var f;c=(f=new wac_2yc,f.selection=b,f)}else{f=this.wua.ma().vkf();var g;c.selection=(g=new wac_Fxc,g.neighborhood=f.neighborhood,g.mentionStart=f.mentionStart,g.mentionLength=f.mentionLength,g)}return wac_pHc(this,e,null,c,a,0)},TQf:function(a,b,c,d){var e,f,g;return this.Jkf(a,b,c,d,(g=new wac_2yc,g.selection=(e=new wac_Fxc,e.neighborhood="",e.mentionStart=0,e.mentionLength=0,e),
g.launchData=(f=new wac_8yc,f.landingTab="File",f),g.entryPoint=10,g))},UQf:function(a,b,c,d){var e,f;return this.Jkf(a,b,c,d,(f=new wac_2yc,f.selection=null,f.launchData=(e=new wac_8yc,e.landingTab="Indoc",e),f.entryPoint=0,f))},ldd:function(){document.activeElement.blur();if(!wac_r()||!wac_r().Hd().vqb()){var a=this.wua.ma();a.Lwa&&wac_rHc(a.Lwa);a=this.wua.ma();a.Lwa&&a.Lwa.ldd()}},O:function(){this.wua.ma()&&this.wua.ma().dispose()}};
function wac_pHc(a,b,c,d,e,f){wac_b(6403776,1303,50,wac_mHc("Show insights",e,{controlId:b?b.SourceControlId:"shortcut"}));if(c)d=a.wua.ma(),d.Lwa||(d.Lwa=d.myf()),d.Lwa.jSa(c,e,f);else if(d){c=a.wua.ma();c.Lwa||(c.Lwa=c.myf());c=c.Lwa;c.Eff=d;var g;c.jSa((g=new wac_EHc,g.neighborhood=d.selection.neighborhood,g.mentionStart=d.selection.mentionStart,g.mentionLength=d.selection.mentionLength,g),e,f)}return 32}
function wac_qHc(a,b,c){var d=wac_nHc(),e=b.CommandValueId,f;try{f=wac_yl(e)}catch(g){return wac_b(6295941,1303,15,wac_mHc(String.format("Insights parameters [{0}] is not in proper format.",e),d,null)),8}return wac_pHc(a,b,f,null,d,c)}function wac_uHc(){this.dispose=this.O}wac_uHc.prototype={Lwa:null,O:function(){this.Lwa&&(this.Lwa.dispose(),this.Lwa=null)}};function wac_vHc(a){this.messageType=a}wac_vHc.prototype={messageType:null};
function wac_wHc(a,b){this.messageContent=this.jb["Common.App.Insights.InsightsMessageWithContent$1"].T===Number||Type.isEnum(this.jb["Common.App.Insights.InsightsMessageWithContent$1"].T)?0:this.jb["Common.App.Insights.InsightsMessageWithContent$1"].T===Boolean?!1:null;wac_wHc.$$(this.jb["Common.App.Insights.InsightsMessageWithContent$1"].T).initializeBase(this,[a]);this.messageContent=b}
wac_wHc.$$=function(a){var b=wac_d.Qa.$4c.__tc=wac_d.Qa.$4c.__tc||{},c="InsightsMessageWithContent$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_wHc.apply(this,a)};d.registerClass("Common.App.Insights.__tc."+c,wac_vHc);d.prototype.jb={"Common.App.Insights.InsightsMessageWithContent$1":{T:a},ctor:wac_wHc};a=wac_wHc.prototype;for(var e in a){var f={key:e,value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};
function wac_xHc(a){wac_xHc.initializeBase(this,["ApplicationProperties",a])}function wac_yHc(a){wac_yHc.initializeBase(this,["Selection",a])}function wac_zHc(){wac_zHc.initializeBase(this,["TakeFocus"])}function wac_AHc(){}
wac_AHc.prototype={sa:null,Xoe:null,Ub:function(){return"Common.App.Insights"},gc:function(a){this.sa=a;wac_m(wac_n(a.fa(wac_lHc)),function(){return new wac_lHc(wac_0b(a,wac_gHc),wac_z(),wac_qg(),wac_Ie())})},tb:function(){wac_.$Jd&&(this.Xoe=wac_k(this.sa,wac_lHc),this.Xoe.Tb())},O:function(){this.Xoe&&this.Xoe.O()}};
function wac_sHc(a,b,c,d,e,f,g,h){this.QYe=Function.createDelegate(this,this.s0e);this.GSe=Function.createDelegate(this,this.p0e);this.HSe=Function.createDelegate(this,this.q0e);wac_sHc.initializeBase(this,[c,e,f,g,h]);this.yqe=a;this.H6e=this.O6e?wac_I7c():wac_.aKd;this.lbe();wac_tf(this.BF,"load",this.HSe);wac_tf(this.BF,"error",this.GSe);window.$addHandler(window,"message",this.ISe);this.sN=b;this.jR=d;this.uQe=0}
wac_sHc.prototype={wS:null,yqe:null,BF:null,H6e:null,Cpe:null,Kre:!1,sN:null,jR:null,uQe:0,lbe:function(){this.wS=this.yqe.WNf();if(wac_r()&&wac_r().Hd().vqb()){var a=this;wac_bHc(this.wS,function(b){b===a.wS&&(wac_rHc(a),a.ldd())})}wac_CHc(this,this.wS.Ega.UE);this.wS.Nh()},O:function(){this.BF&&(wac_jg(this.BF,"load",this.HSe),wac_jg(this.BF,"error",this.GSe),window.$removeHandler(window,"message",this.ISe),this.BF.parentNode.removeChild(this.BF),this.BF=null);this.wS&&(this.yqe.jee(this.wS),this.wS=
null)},jSa:function(a,b,c){this.Khc=b;this.Cpe=null;this.uQe=c;this.Kre=!1;wac_b(6295947,1303,50,this.sda("Start to show Insights"));this.HVe=a;this.H6e&&this.H6e.length?this.BF.src=this.H6e:(this.BF.src="about:blank",wac_b(6295948,1303,15,this.sda("The Insights URL config setting is null or empty")));this.jR.c_b(CommonUIStrings.l_InsightsPaneNotification,!0);this.wS.Qva||(this.wS.dZb=this.QYe);this.yqe.rne(this.wS);this.wS.Nh();if(this.O6e){a=this.Khc;b=new wac_B7c;b.eventName="LaunchPane";b.isActivity=
!0;c=[];var d=new wac_A7c;d.name="AppCorrelationId";d.dataType=0;d.value=a;Array.add(c,d);b.dataFields=c;wac_G7c(b)}},ldd:function(){this.BF.src===this.H6e&&this.Kre&&(this.nd.ff("InsightsTaskPane"),wac_DHc(this,new wac_zHc))},s0e:function(a){a===this.wS&&(this.yqe.vhe(this.wS),wac_J7c(this))},q0e:function(){wac_b(6295951,1303,50,this.sda("The iframe is successfully loaded in Insights task pane"))},p0e:function(){wac_b(6295952,1303,15,this.sda("The iframe failed to load in Insights task pane"))},
r0e:function(a){var b=a.rawEvent;if(b.source===this.BF.contentWindow)if(this.O6e)wac_C7c.prototype.r0e.call(this,a);else{var c;try{c=wac_yl(b.data)}catch(f){wac_b(6295953,1303,15,this.sda("Message data [{0}] failed to deserialize.",b.data));return}if(wac_6(c.messageType))wac_b(6295954,1303,15,this.sda("Message data [{0}] is in wrong format.",b.data));else switch(c.messageType){case "ApplicationPropertiesRequest":a=wac_xHc;b={anid:"00000000-0000-0000-0000-000000000000"};b.appCorrelationId=this.Khc;
3===wac_r().Hd().Nv()?b.applicationName="WordWac":4===wac_r().Hd().Nv()&&(b.applicationName="OneNoteWAC");b.applicationVersion=wac_.jv;c=(c=wac_nm(wac_.vh))?c._name:null;b.market=wac_H7c(c);b.uiLanguage=c;b.sessionId=wac_.Ag;b.parentalControl="yes";b.clientType="user";var d;try{var e=localStorage.getItem("Microsoft::Office::Insights::LegalAgreed");d=!!e&&"true"===e}catch(f){wac_b(17961860,1303,10,this.sda("Failed to GetItem in LocalStorage for LegalAgreed")),d=!1}b.legalAgreed=d;b.defaultDefineTab=
1===this.uQe?"true":null;wac_DHc(this,new a(b));break;case "SelectionRequest":wac_DHc(this,new wac_yHc(this.HVe));break;case "PageRendered":this.Kre=!0;wac_rHc(this);this.ldd();wac_b(6295955,1303,50,this.sda("Insights pane rendering is completed"));break;case "Telemetry":d=c.messageContent;this.Cpe=d.clientCorrelationId;this.Khc!==d.appCorrelationId&&wac_b(6403778,1303,15,this.sda("App correlation ID on client {0} does not match one on server {1}",this.Khc,d.appCorrelationId));break;case "LostFocus":c.messageContent?
(wac_dg()&&document.activeElement.blur(),this.sN.byc(0,null,2,null,null),wac_b(6604741,1303,50,this.sda("Insights UX lost focus through Ctrl + Shift + F6"))):(this.sN.mya(0,null,2,null,null),wac_b(6604742,1303,50,this.sda("Insights UX lost focus through Ctrl + F6")));break;case "Keyboard":d=c.messageContent;27===d.keyCode&&(this.yqe.vhe(this.wS),wac_J7c(this));break;case "LegalAgreed":try{this.Kre=!1,localStorage.setItem("Microsoft::Office::Insights::LegalAgreed","true")}catch(f){wac_b(17961859,1303,
10,this.sda("Failed to SetItem in LocalStorage for LegalAgreed"))}}}},sda:function(a){for(var b=[],c=1;c<arguments.length;++c)b[c-1]=arguments[c];c={};this.Khc&&(c.appCorrelationId=this.Khc);this.Cpe&&(c.clientCorrelationId=this.Cpe);c.message=String.format.apply(null,[a].concat(b));return wac_ai(c)}};function wac_DHc(a,b){b=wac_ai(b);a.BF.contentWindow.postMessage(b,wac_Jh(a.H6e,0))}function wac_J7c(a){a.BF.src="about:blank";a.wS.Yg()}function wac_rHc(a){a.BF&&wac_Vj(a.BF.contentWindow)}
function wac_CHc(a,b){b.style.overflow="hidden";var c=wac_7("iframe");Sys.UI.DomElement.addCssClass(c,"InsightsPaneIFrame");c.setAttribute("Unselectable","off");a.BF=c;b.appendChild(a.BF);a.BF.id="InsightsContentFrame"}function wac_EHc(){}wac_EHc.prototype={neighborhood:null,mentionStart:0,mentionLength:0};function wac_H7c(a){a=a.split("-");return a[a.length-1]}
function wac_I7c(){var a;a=wac_q(wac_.pa,"SmartLookupEnableEdogSourceLocationOverride")?"EDOG":wac_q(wac_.pa,"SmartLookupEnableProdSourceLocationOverride")?"PROD":wac_q(wac_.pa,"SmartLookupEnableIntSourceLocationOverride")?"INT":wac_K7c();var b;b=3===wac_r().Hd().Nv()?"wordwac":2===wac_r().Hd().Nv()?"pptwac":"excelwac";var c=wac_nm(wac_.vh),c=c?c._name:"en-us";switch(a){case "INT":return"https://uci.officeapps.live-int.com/OfficeInsights/Agave/Web/main_native_wac.cshtml?isBrowserPane&appName="+b+
"&culture="+c;case "EDOG":return"https://uci.edog.officeapps.live.com/OfficeInsights/Agave/Web/main_native_wac.cshtml?isBrowserPane&appName="+b+"&culture="+c;default:return"https://uci.officeapps.live.com/OfficeInsights/Agave/Web/main_native_wac.cshtml?isBrowserPane&appName="+b+"&culture="+c}}
function wac_K7c(){switch(window.$$as(String,wac_.m0.AudienceGroup)||""){case "Dogfood":if(wac_.pa&&wac_q(wac_.pa,"SmartLookupEnableSKITeamDogfood")){var a=wac_.pa.Qb.UserPrincipalName,a=wac_rd(a),b="SmartLookupINTEnabledForSKITeam"in wac_.pa.Qb?wac_hc(wac_.pa,"SmartLookupINTEnabledForSKITeam"):[];if(0<=Array.indexOf(b,a))return"INT"}return"EDOG";default:return"PROD"}}
function wac_D7c(){switch(wac_q(wac_.pa,"IntentSvcEnableEdogSourceLocationOverride")?"EDOG":wac_q(wac_.pa,"IntentSvcEnableProdSourceLocationOverride")?"PROD":wac_q(wac_.pa,"IntentSvcEnableIntSourceLocationOverride")?"INT":wac_K7c()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}}
function wac_G7c(a){for(var b=wac_L7c+a.eventName,c=a.dataFields,d=[],e=c.length,f=0;f<e;++f){var g=c[f];(g=wac_jDb(g.name,g.value,wac_M7c(g.dataType)))&&Array.add(d,g)}if(a.isActivity){var h,k=(h=new wac_bea,h.name=b,h.samplingPolicy=2,h.dataFields=d,h);wac_Pfa(k)}else h=(k=new wac_hca,k.name=b,k.samplingPolicy=2,k.dataFields=d,k),wac_xra(h)}function wac_M7c(a){switch(a){case 0:return 2;case 1:return 1;case 2:return 3;case 3:return 4;default:return 0}}wac_hHc.registerClass("Common.App.Insights.InsightsMessageContentAppProperties");
(function(){}).registerClass("Common.App.Insights.InsightsMessageContentTelemetry");(function(){}).registerClass("Common.App.Insights.InsightsMessageContentKeyboard");wac_A7c.registerClass("Common.App.Insights.BrowserPaneDataField");wac_B7c.registerClass("Common.App.Insights.BrowserPaneTelemetryEvent");wac_C7c.registerClass("Common.App.Insights.BaseSmartLookupPane",null,wac_iHc,Sys.IDisposable);wac_lHc.registerClass("Common.App.Insights.InsightsActor",null,Sys.IDisposable);
wac_uHc.registerClass("Common.App.Insights.InsightsManager",null,wac_gHc,Sys.IDisposable);wac_vHc.registerClass("Common.App.Insights.InsightsMessage");wac_xHc.registerClass("Common.App.Insights.InsightsMessageAppProperties",wac_wHc.$$(wac_hHc));wac_yHc.registerClass("Common.App.Insights.InsightsMessageSelection",wac_wHc.$$(wac_EHc));wac_zHc.registerClass("Common.App.Insights.InsightsMessageTakeFocus",wac_vHc);wac_AHc.registerClass("Common.App.Insights.InsightsPackage",null,wac_I,wac_i);
wac_sHc.registerClass("Common.App.Insights.InsightsPane",wac_C7c);wac_EHc.registerClass("Common.App.Insights.InsightsParameters");(function(){}).registerClass("Common.App.Insights.InsightsUtils");(function(){}).registerClass("Common.App.Insights.TelemetryUtils");var wac_L7c="Office.Insights.SmartLookup.";Type.registerNamespace("Common.App.LivePersonaUtils");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.jRf=wac_d.Qa.jRf||{};function wac_N7c(){}
wac_N7c.prototype={Ub:function(){return"Common.App.LivePersonaUtils"},tb:function(){wac_j().H(wac_ZGa)},O:function(){},gc:function(a){wac_m(wac_n(wac_o(a.fa(wac_O7c),wac_ZGa)),function(){return new wac_O7c(wac_rP(wac_y2c,wac_l(a,wac_y2c)))})}};function wac_O7c(a){this.I$e=a}
wac_O7c.prototype={I$e:null,AOf:function(){var a=wac_P7c(),b=wac_Q7c();if(!b){var c;return Promise.resolve((c=new wac_XGa,c.isSuccess=!1,c.token=null,c.errorMessage=String.format("Could not get Loki App Id for HostAuthorityType: [{0}]",wac_p7c()),c))}var d=this;return new Promise(function(c,f){d.I$e.CW(function(){wac_Gb(d.I$e)||wac_Fb(d.I$e)?f(Error.create("Error downloading auth library")):wac_Qb(d.I$e).b4e(a,b).then(function(a){if(a.IsSuccess&&a.Token){var b;a=(b=new wac_XGa,b.isSuccess=!0,b.token=
a.Token,b.errorMessage=null,b)}else{var d;a=(d=new wac_XGa,d.isSuccess=!1,d.token=null,d.errorMessage=JSON.stringify(a),d)}c(a);return a})})})}};function wac_P7c(){var a="Loki";1===wac_n7c()&&wac_p7.y5b&&(a="LokiMSAL");return a}function wac_Q7c(){var a=null,b=wac_n7c();2===b?a=wac_.pa.Qb.LokiAADAppId:1===b&&(a=wac_.pa.Qb.LokiMSAAppId);return a}wac_N7c.registerClass("Common.App.LivePersonaUtils.LivePersonaUtilsPackage",null,wac_I,wac_i);
wac_O7c.registerClass("Common.App.LivePersonaUtils.LokiTokenManager",null,wac_ZGa);wac_J(wac_C(),new wac_N7c,0,!1);Type.registerNamespace("Common.App.SaveACopy");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.f0d=wac_d.Qa.f0d||{};function wac_Ydb(){}wac_Ydb.registerInterface("Common.App.SaveACopy.IFileNameDialogFactory");function wac_Zdb(){}wac_Zdb.registerInterface("Common.App.SaveACopy.IFileNameDialog");function wac_IT(a,b,c){this.Ia=a;this.Xy=b;this.Vga=c}
wac_IT.prototype={Ia:null,Xy:null,Vga:null,Db:function(a){return new wac__db(this.Ia,this.Xy,this.Vga,a)}};function wac__db(a,b,c,d){this.w4a=Function.createDelegate(this,this.WGb);wac__db.initializeBase(this,[!1,!1,!1,!1]);this.Ia=a;this.Xy=b;this.Vga=c;wac_Oh(this,1,CommonUIStrings.l_SaveButtonLabel);this.po=wac_WO(wac_0db,CommonUIStrings.l_SaveACopyFileName);this._id="FileNameDialog-SaveACopy";this.LOc=d}
wac__db.prototype={Ia:null,Xy:null,Vga:null,AW:null,$Ua:null,LOc:null,n_:function(a,b,c){this.$Ua=a;this.AW=c;a={txtFileName:wac_kP(wac_.dJ.lw),lblFolderName:String.format(CommonUIStrings.l_DestinationFolder,b)};this.Zp(CommonUIStrings.l_SaveToOneDrive,this.w4a,a);wac_b(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()},WGb:function(a,b){1!==a?wac_b(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(a=b.txtFileName.trim(),
wac_b(7165651,216,50,"User click save to upload file with new name."),b=wac_If(wac_.Vxa),a&&""!==a&&""!==b&&(a+=b),this.Vga.xea(this.$Ua,this.AW,a,this.LOc))}};function wac_1db(){this.SB=Function.createDelegate(this,this.sC)}
wac_1db.prototype={sa:null,Ub:function(){return"Common.App.SaveACopy"},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){wac_q(wac_.pa,"SaveACopyBrsIsEnabled")&&this.sa.H(wac_JT).Tb()},O:function(){},gc:function(a){this.sa=a;wac_n(wac_m(this.sa.fa(wac_KT),function(){return new wac_KT(wac_z(),a.H(wac_PQ),function(){return new wac_dn(!1)},function(){return new wac_LT(wac_z())},wac_r(),wac_r().Bz())}));wac_n(wac_m(wac_o(this.sa.fa(wac_IT),wac_Ydb),function(){return new wac_IT(wac_z(),wac_r().Hd(),a.H(wac_KT))}));
wac_n(wac_m(this.sa.fa(wac_JT),function(){return new wac_JT(a.H(wac_MT),a.H(wac_sQ),wac_.pa,wac_r().Bz())}));wac_n(wac_m(this.sa.fa(wac_MT),function(){return new wac_MT(a.H(wac_IT),a.H(wac_OQ),wac_qi(),a.H(wac_KT),wac_.pa,wac_Kg,function(){return new wac_LT(wac_z())})}))}};function wac_LT(a){this.Dwb=Function.createDelegate(this,this.yPb);wac_LT.initializeBase(this);wac_Nh(this,1);wac_Oh(this,1,CommonUIStrings.l_RetryButtonLabel);wac_Oh(this,0,CommonUIStrings.l_DialogClose);this.Ia=a}
wac_LT.prototype={Ia:null,Xp:function(a){wac_b(7165652,216,50,"Show error dialog here {0}.",a);this.hs(a,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,this.Dwb)},yPb:function(a){1===a?(wac_b(7165653,216,50,"User click to retry the action."),this.Ia.yw(4246497969,2,null)):wac_b(7165654,216,50,"User cancel the error dialog.")}};function wac_JT(a,b,c,d){wac_JT.initializeBase(this,[a,b,c,d]);this.IOc=b}
wac_JT.prototype={IOc:null,nzc:function(){return wac_q(this.Dc,"SaveACopyBrsIsEnabled")},Xwc:function(){return 4246497969},u9a:function(){var a=this.cic;wac_tl().xa(a);wac_R3a([new wac_wl(4246497969,2147483648,0)],wac_yQ(this.IOc))},hCc:function(){wac_b(7205456,216,50,"User clicked on SaveAs button from the backstage.")}};function wac_MT(a,b,c,d,e,f,g){wac_MT.initializeBase(this,[b,c,d,e,f,g]);this.EJc=a}
wac_MT.prototype={EJc:null,xA:function(a){a&&a.data&&a.data.folders?(wac_b(7165655,216,50,"User selected which folder to upload file to."),this.EJc.Db(this.LOc).n_(a.data.folders[0].id,a.data.folders[0].name,a.data.folders[0].urls.viewInBrowser)):(wac_b(7165656,216,10,"Fail to select folder to upload file."),this.Im())},Py:function(a){a&&a.error&&"user_canceled"===a.error.code&&wac_b(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");wac_QQ.prototype.Py.call(this,a)},Im:function(){wac_b(7205458,
216,50,"Error occur in Save A Copy Manager.");wac_QQ.prototype.Im.call(this)}};function wac_KT(a,b,c,d,e,f){wac_KT.initializeBase(this,[b,c,d,e,f]);this.Ia=a}
wac_KT.prototype={Ia:null,wE:function(){wac_b(7205459,216,50,"Display Error for Save A Copy.");wac_RQ.prototype.wE.call(this)},Hna:function(){wac_b(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");wac_RQ.prototype.Hna.call(this)},Gna:function(a){wac_b(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",a);wac_RQ.prototype.Gna.call(this,a)},sQ:function(){if(this.LOc&&"true"===this.LOc.SkipSaveToHost)wac_RQ.prototype.sQ.call(this);else if(32!==this.Ia.yw(3070187925,1,null))wac_b(8741711,
216,15,"The save file change is not supported, this operation may result in data loss"),wac_RQ.prototype.sQ.call(this);else{var a=this,b=this;this.Ia.Wj(3070187925,2,[function(){wac_b(8741712,216,50,"Call the force save file change successfully.");wac_RQ.prototype.sQ.call(a)},function(){wac_b(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");b.wE()}],null)}}};wac_IT.registerClass("Common.App.SaveACopy.FileNameDialogFactory",null,wac_Ydb);
wac__db.registerClass("Common.App.SaveACopy.FileNameDialog",wac__m,wac_Zdb);wac_1db.registerClass("Common.App.SaveACopy.PackageManager",null,wac_I,wac_i);wac_LT.registerClass("Common.App.SaveACopy.RetryDialog",wac_di,wac_37a);wac_JT.registerClass("Common.App.SaveACopy.SaveACopyActor",wac_NQ);wac_MT.registerClass("Common.App.SaveACopy.SaveACopyManager",wac_QQ);wac_KT.registerClass("Common.App.SaveACopy.SaveACopyUploadToCloudManager",wac_RQ);(function(){}).registerClass("Common.App.SaveACopy.FileNameDialogHtml");
var wac_0db="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";wac_J(wac_C(),new wac_1db,0,!1);Type.registerNamespace("Common.App.SearchOAuthManager");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};
wac_d.Qa.PUf=wac_d.Qa.PUf||{};function wac_R7c(a,b){this.ekf=Date.now;this.p9e=a;this.nGf=b;wac_S7c(this)}wac_R7c.prototype={kYf:9E5,lYf:1E4,nGf:0,ekf:null,p9e:null,W7e:null,DDf:null,spf:0,Kxd:function(a){return(a=wac_T7c(this,a))?Promise.resolve(a):wac_S7c(this)}};
function wac_S7c(a){a.W7e=a.W7e||new Promise(function(b){a.p9e().then(function(c){a.W7e=null;""!==c&&c&&(a.DDf=c,a.spf=a.ekf(),b(c));b(null)}).catch(function(){a.W7e=null;b(null)});window.setTimeout(function(){a.W7e=null;b(null)},a.nGf)});return a.W7e}function wac_T7c(a,b){var c=a.ekf();if(c<a.spf+a.kYf)return c>a.spf+a.lYf&&wac_S7c(a),a.DDf;b&&wac_S7c(a);return null}function wac_U7c(){this.n8e=new (wac_gb.$$(String,wac_R7c))(wac_$a())}
wac_U7c.prototype={zLd:null,r$e:"TellMeWAC.",onf:!0,Xef:null,Kxd:function(a,b){if(this.n8e.mc(b))return this.n8e.K(b).Kxd(!0);var c=this,d=new wac_R7c(function(){return c.p9e(a,b)},3E4);this.n8e.vf(b,d);return d.Kxd(!0)},Myf:function(){if(wac_.pa&&!wac_q(wac_.pa,"OcpsIsEnabled"))return new Promise(function(a){a(!0)});if(this.Xef){var a=this;return new Promise(function(b){b(a.Xef)})}var b=this;return new Promise(function(a){wac_l(wac_j(),wac_sb).uc(function(d){d.km("ConnectedServices",!0).then(function(d){b.Xef=
d;a(d)}).catch(function(){b.Xef=!0;a(!0)})})})},p9e:function(a,b){if(!this.zLd)try{this.zLd=wac_j().H(wac_y2c)}catch(d){wac_b(51689675,1300,10,"Unable to resolve IOAuthManager: "+d)}if(this.zLd){var c=this;return new Promise(function(d){var e=window.performance.now();c.zLd.b4e(a,b).then(function(f){var g=f.Token;g&&g.length?(wac_V7c(c,f,Math.round(window.performance.now()-e),b,a),d(g)):(wac_V7c(c,f,Math.round(window.performance.now()-e),b,a),d(null))}).catch(function(f){var g=Math.round(window.performance.now()-
e);f={Time:(new Date).getTime(),Event:"Latency",IsSuccess:!1,StatusCode:f?wac_ai(f):"",LatencyType:"FetchToken",TokenAcquired:!1,Service:c.o9e(b),AppName:a};f=wac_eDb(f);var h;wac__5c((h=new wac_bea,h.name="Latency",h.dataFields=f,h.durationMs=g,h),c.r$e);d(null)})})}return new Promise(function(a){a(null)})},o9e:function(a){return a===wac_.Skf?"Loki":a===wac_.Wlf?"Substrate":"Other"}};
function wac_V7c(a,b,c,d,e){var f=(new Date).getTime(),g=b.IsSuccess?!0:!1,h;h=b.ErrorCode;h=!!h&&""!==h.trim();var k=b.Token;b={Time:f,Event:"Latency",IsSuccess:g,StatusCode:h?b.ErrorCode:"",LatencyType:"FetchToken",TokenAcquired:!(!k||!k.length),Service:a.o9e(d),AppName:e};"Substrate"===b.Service.toString()&&(b.WarmUpCall=a.onf)&&(a.onf=!1);b=wac_eDb(b);var l;wac__5c((l=new wac_bea,l.name="Latency",l.dataFields=b,l.durationMs=c,l),a.r$e)}
function wac_E7c(a,b){if(a.n8e.mc(b))return wac_T7c(a.n8e.K(b),!0);var c=new wac_R7c(function(){return a.p9e("SmartLookup",b)},3E4);a.n8e.vf(b,c);return null}function wac_W7c(){}wac_W7c.prototype={sa:null,Ub:function(){return"Common.App.SearchOAuthManager"},gc:function(a){this.sa=a;wac_m(wac_n(this.sa.fa(wac_Exc)),function(){return new wac_U7c})},tb:function(){},O:function(){}};wac_R7c.registerClass("Common.App.SearchOAuthManager.OAuthCacheManager");
wac_U7c.registerClass("Common.App.SearchOAuthManager.SearchOAuthManager",null,wac_Exc);wac_W7c.registerClass("Common.App.SearchOAuthManager.SearchOAuthPackage",null,wac_I,wac_i);wac_J(wac_C(),new wac_W7c,0,!1);Type.registerNamespace("Common");wac_d=window.Common||{};function wac_7Nb(a,b,c){this.$g=a;this.Tf=b;this.MC=c}function wac_8Nb(a,b){b=b||"skypeproxy.ashx";return new wac_7Nb(new (wac_f.$$(wac_Wc))(function(){return wac_.Af}),a,b)}
wac_7Nb.prototype={$g:null,Tf:null,MC:null,epb:function(){return this.$g.ma()},uc:function(a,b,c){this.epb().lk(this.MC,2,a.Serialization(),{"Content-Type":"application/json; charset=utf-8"},!1,2,b,c,null,null,!1,null,null,null,null,!1,null,!1,null)}};function wac_9Nb(a,b,c){var d=a.Tf.uj("WebServiceCall","CreateSkypeChatThread");a.uc(new wac_$Nb(wac_.eo),function(a){d.vg();b(a)},function(a){d.vg();c(a)})}Type.registerNamespace("Common.App.SkypeChat");wac_d.Qa=wac_d.Qa||{};
wac_d.Qa.RQb=wac_d.Qa.RQb||{};function wac_aOb(a,b,c){this.Email=a;this.InChat=b;this.Capabilities=c}function wac_bOb(){}wac_bOb.registerInterface("Common.App.SkypeChat.IDocChatClient");function wac_cOb(){}wac_cOb.registerInterface("Common.App.SkypeChat.IDocChatClientFactory");function wac_m4(){}wac_m4.registerInterface("Common.App.SkypeChat.IDocChatUserIdFactory");function wac_dOb(){this.Ra=new wac_Re}
wac_dOb.prototype={Ra:null,DPc:!1,M9:function(a){this.Ra.xa("AVCEK",a)},bXf:function(a){this.Ra.xa("CACEK",a)},aYf:function(a){this.Ra.sb("CACEK",a)},xZa:function(a){this.Ra.xa("MPUEK",a)},TOb:function(){this.Ra.wa("MPUEK",null,null)}};function wac_eOb(a,b){b!==a.DPc&&(a.Ra.wa("AVCEK",new wac_n4(b,!1),null),a.DPc=b,wac_b(6603939,333,50,"Chat availability changed to now be {0}",b))}function wac_fOb(){this.Ra=new wac_Re}wac_fOb.prototype={};
function wac_n4(a,b){wac_n4.initializeBase(this);this.pzb=a;this.Rjc=b}wac_n4.prototype={pzb:!1,Rjc:!1};function wac_gOb(a,b,c){this.Cvb=Function.createDelegate(this,this.yLb);this.aNc=a;this.dKc=b;this.QZb=c}
wac_gOb.prototype={QZb:null,aNc:null,dKc:null,_initialized:!1,tb:function(){this._initialized?wac_b(9000738,333,15,"Init called multiple times"):(this._initialized=!0,wac_q(wac_.pa,"DocChatIsEnabled")&&this.dKc.uc(this.Cvb))},yLb:function(a){var b=this;wac_c4(a).CW(function(){var c=wac_Qb(wac_c4(a));c.uka?b.Z4c(c):c.gva&&(wac_.PSa&&3!==a.wW?wac_b(18121750,333,50,"DocChatBootstrapper: Anonymous Doc Chat is not available because the user name is unknown."):b.Z4c(c))})},Z4c:function(a){wac_b(9000739,
333,15,"DocChatBootStrapper: Doc chat is enabled.");var b=this.aNc.ma();b.SSc=wac_.J0;b.R7=a;b.mmb||(b.mmb=new (wac_Rb.$$(Boolean)),b.OUb?wac_iOb(b):(wac_b(8730523,333,15,"docChatClient is null"),b.mmb.Ze(!1)));this.QZb&&this.QZb()}};function wac_o4(a,b){this.Vfd=Function.createDelegate(this,this.BOd);this.Ra=new wac_Re;this.GTb=a;this.Tf=b}
wac_o4.prototype={HTa:null,GTb:null,NDa:null,eW:null,Tf:null,pkb:null,gH:!1,gN:!1,M9:function(a){this.Ra.xa("ACE",a)},BOd:function(a,b){a=2===b.nva||4===b.nva||5===b.nva;!this.NDa.oj().qB()&&a&&wac_W1a(this.NDa,!0);this.gN=this.gH&&2!==b.nva&&5!==b.nva;this.gH=this.gH&&!this.gN;this.Ra.wa("ACE",new wac_n4(a,this.gN),null)},AZa:function(a){this.Ra.xa("UCC",a)},Iya:function(a,b,c,d){if(a){this.pkb=this.Tf.S_("ServerNotification","JoinSkypeChatThreadClient");var e=this,f=this;this.pkb.Wd();this.eW.Iya(a.KL,
function(){e.pkb.vg();e.gH=!0;e.gN=!1;b()},function(){f.pkb.vg();f.gH=!1;f.gN=!1;c()},d,a.yZ)}else wac_b(18200789,333,10,"Unexpected attempt to join doc chat without any chat thread info!")},yZa:function(a){this.Ra.xa("PSC",a)}};function wac_jOb(a){if(a.NDa)return a.NDa.oj();a.NDa=new (wac_Rb.$$(Boolean));a.GTb.CW(function(){a.HTa=wac_Qb(a.GTb);a.eW=a.HTa.Db(a.Vfd);a.eW.tb();a.eW.yZa(function(b,c){a.Ra.wa("PSC",c,null)});a.eW.AZa(function(b,c){a.Ra.wa("UCC",c,null)})});return a.NDa.oj()}
function wac_kOb(a){this.PIc=a}wac_kOb.prototype={PIc:null,Db:function(){return this.PIc.ma()}};function wac_lOb(a,b){this.Cvb=Function.createDelegate(this,this.yLb);this.gTb=a;this.FTb=b}wac_lOb.prototype={gTb:null,FTb:null,p2:null,DC:null,y2b:function(){return wac_sP(String,"")},yLb:function(){var a=wac_Qb(this.gTb),b=this;wac_c4(a).CW(function(){3===a.wW?b.p2.Ze(wac_.Ag):wac_Qb(wac_c4(a)).uka?wac_mOb(b):wac_nOb(b)})}};function wac_nOb(a){a.y2b().CW(function(){a.p2.Ze(wac_Qb(a.y2b()))})}
function wac_mOb(a){a.FTb.CW(function(){a.DC=wac_Qb(a.FTb).Db(null);a.DC.tb().CW(function(){a.DC.L2b().CW(function(){a.p2.Ze(wac_Qb(a.DC.L2b()))})})})}function wac_oOb(a){if(a.p2)return a.p2.oj();a.p2=new (wac_Rb.$$(String));a.gTb.CW(a.Cvb);return a.p2.oj()}function wac_pOb(a){this.BaseDocQuerySignature=a}wac_pOb.prototype={BaseDocQuerySignature:null,Serialization:function(){return wac_ai([this.ii(),this])}};function wac_$Nb(a){wac_$Nb.initializeBase(this,[a])}wac_$Nb.prototype={ii:function(){return 1}};
function wac_p4(a,b,c,d,e,f){this.Zua=Function.createDelegate(this,this.Ada);this.Yvb=Function.createDelegate(this,this.DMb);this.$ua=Function.createDelegate(this,this.kza);this.nJa=Function.createDelegate(this,this.hV);this.Bvb=Function.createDelegate(this,this.sLb);wac_p4.initializeBase(this);this.WN=a;this.SZb=b;this.UZb=c;this.G1b=d;this.Wqa=e;this.Dc=f;this.V9e=new (wac_g.$$(String))}
wac_p4.prototype={Fp:null,FDa:null,WN:null,SZb:null,UZb:null,Wqa:null,Dc:null,TZb:null,G1b:null,GXa:null,kDa:null,_initialized:!1,V9e:null,tb:function(){wac_b(9000769,333,50,"Init - RtcChatAvailabilityFinder");return wac_Db.WAA(wac_oOb(this.G1b),this.WN,this.UZb,this.Wqa,this.SZb).CW(this.Bvb)},sLb:function(){wac_b(6603968,333,50,"All prerequisite ready for RtcChatAvailabilityFinder");this.Fp=wac_Qb(this.WN);this.TZb=wac_Qb(this.UZb);this.FDa=wac_Qb(this.SZb);this.kDa=wac_Qb(wac_oOb(this.G1b));this.GXa=
wac_Qb(this.Wqa);this.Fp.Kra(this.nJa);this.Fp.zZa(this.$ua);this.Fp.xZa(this.Yvb);this.Fp.hob(this.Zua);if(this.kDa||this.FDa.wI){this.FDa.wI=this.FDa.wI||this.kDa;this.FDa&&this.TZb&&(wac_PRc(this.FDa.lr,4),this.TZb.Tza());if(this.Fp){var a;if(a=(a=this.Fp.pOa(1))&&this.Fp.iS()in a?a[this.Fp.iS()]:new wac_aOb("",!1,0))a.Email=this.kDa,a.Capabilities=1,this.Fp.LRa(1,a)}this._initialized=!0;wac_q4(this)}else wac_b(6603969,333,10,"Email in presence context is null or undefined. This will cause Skype to not work")},
hV:function(){wac_q4(this)},kza:function(a,b){a=Date.now();wac_q4(this);var c=b.nU;if(wac_q(this.Dc,"PeoplesWellExtraButtonInfoIsEnabled")){var d=new (wac_g.$$(String)),e;for(e in c){var f=this.GXa.Axc({key:e,value:c[e]});if(f){var g=this.xyf(f.iS());0<=this.V9e.DJd(f.iS())&&!g?(this.V9e.Rc(f.iS()),d.ga(f.iS())):0>this.V9e.DJd(f.iS())&&g&&(this.V9e.ga(f.iS()),d.ga(f.iS()))}else wac_b(42824128,333,15,"Presence was null when we should always have a defined value from updatedClients")}0<d.Ma()&&(this.Ra.wa("CACEK",
new Sys.EventArgs,null),wac_b(42521618,333,50,"Chat availability changed for the following coauthors {0}",d))}e=Date.now()-a;b.iTa&&b.iTa.Nq(e,"RtcChatAvailabilityFinder")},DMb:function(){this.TOb()},Ada:function(a,b){1===b.Fg&&wac_q4(this)},xyf:function(a){if(!this._initialized)return wac_b(42521619,333,50,"Find Coauthor Availability with was called before component was initialized"),!1;if(2!==this.Fp.P8a())return wac_b(42521620,333,50,"Rtc Connection not yet established: state: {0}",this.Fp.P8a()),
!1;var b={};b[a]=this.Fp.pOa(1)[a];var b=wac_X7c(this,b),c={};c[a]=this.Fp.wHb()[a];a=wac_Y7c(this,c);return b||a}};function wac_X7c(a,b){if(!b)return!1;for(var c in b){var d=b[c];if(d&&d.Email&&d.Capabilities&1&&d.Email!==a.kDa)return!0}return!1}function wac_Y7c(a,b){if(!b)return!1;for(var c in b){var d=a.GXa.Axc({key:c,value:b[c]});if(d&&d.wI&&d.lr&&d.lr.lr&4&&d.wI!==a.kDa)return!0}return!1}
function wac_q4(a){if(!a._initialized)return wac_b(6603970,333,50,"Anyone to chat with was called before component was initialized"),wac_eOb(a,!1),!1;if(2!==a.Fp.P8a())return wac_b(6649866,333,50,"Rtc Connection not yet established: state:{0}",a.Fp.P8a()),wac_eOb(a,!1),!1;var b=a.Fp.wHb(),c=a.Fp.pOa(1),b=wac_Y7c(a,b)||wac_X7c(a,c);wac_eOb(a,b);return b}
function wac_r4(a,b,c,d,e){this.Qfd=Function.createDelegate(this,this.vOd);this.Yvb=Function.createDelegate(this,this.DMb);this.T5c=Function.createDelegate(this,this.Qxd);this.xgd=Function.createDelegate(this,this.dPd);this.Rfd=Function.createDelegate(this,this.wOd);this.Pfd=Function.createDelegate(this,this.uOd);this.IJa=Function.createDelegate(this,this.LQa);this.awb=Function.createDelegate(this,this.MMb);this.Edd=Function.createDelegate(this,this.tKd);this.Qod=Function.createDelegate(this,this.AZd);
this.Hdd=Function.createDelegate(this,this.SKd);this.Jpd=Function.createDelegate(this,this.N_d);this.N8c=Function.createDelegate(this,this.lCd);this.Dnd=Function.createDelegate(this,this.TXd);this.BT=a;this.mDa=c;this.kBa=!1;this.eX=d;this.$Aa=e;this.OUb=b}
wac_r4.prototype={s1b:0,qHc:!1,cUa:!1,aHc:!1,kBa:!1,jhb:!1,ipe:!1,FWb:!1,QIc:!1,RIc:!1,hpe:!1,gH:!1,lBa:!1,gN:!1,bke:!1,SSc:null,mDa:null,ZWa:null,R7:null,eX:null,$Aa:null,jpe:!1,mmb:null,BT:null,OUb:null,uR:null,tI:null,ar:function(){return wac_2k.FEc},Tb:function(){wac_c(5269512,333,!!this.BT,null);this.BT.jf(this.ar().Vdb,2147483648,this.Dnd,96);this.BT.ja(this.ar().ogb,2147483648,this.N8c);wac_qOb()?this.BT.ja(this.ar().aKb,2147483648,this.Jpd):this.BT.ja(this.ar().aKb,2147483648,this.Hdd);this.BT.jf(this.ar().mCc,
2147483648,this.Qod,96);this.BT.ja(3799468329,2147483648,this.Edd)},LQa:function(a,b){this.s1b=b.zDb;wac_s4(this)},MMb:function(){wac_s4(this);this.qHc=this.qHc||1===(this.uR.eW.R9()?1:0);this.ipe&&1===(this.uR.eW.R9()?1:0)&&!this.jpe&&(wac_b(6129288,333,50,"Doc chat started and pane toggled"),this.jpe=!0)},Qxd:function(a,b){this.jhb=b.pzb;wac_Rnc(this);wac_s4(this)},uOd:function(a,b){wac_rOb(this,b.pzb,b.Rjc)},TXd:function(a,b,c,d,e){a=this.jhb&&this.FWb||!!this.tI;e[wac_HS.Visible]=a;wac_DCb(this.R7)&&
(e.On=1===(this.uR.eW.R9()?1:0),wac_r().Hd().Bg()?wac_r().Hd().qze()?e[wac_$8a.Icon]=0<this.s1b?"DocChatUnreadGray_16":"DocChat_20":e[wac_$8a.Icon]=0<this.s1b?"DocChatUnread_20":"DocChatGlyph_20":e[wac_HS.Image16by16Class]=wac_9h(0<this.s1b?this.ar().jFc:this.ar().gbb));a&&!this.aHc&&(wac_b(6350045,333,15,"Setting visibility of the chat button to true"),this.aHc=!0);return 32},wOd:function(a,b){this.BT.Wj(2246375352,2,b.tI,null)},dPd:function(){wac_qOb()&&this.BT.Wj(2246375352,2,null,null)},SKd:function(a,
b,c,d,e){if(2!==c)return 32;wac_sOb(this);if(!this.kBa)return wac_b(16808076,333,15,"Join operation before client is ready"),wac_t4(this),8;if(!e)return wac_b(18493662,333,10,"Invalid ChatThreadInfo."),wac_t4(this),8;if(this.lBa||this.gH)return wac_b(18900674,333,50,String.format("Ignoring chat thread {0}. Already connecting or connected to it.",e.KL)),32;if(!this.tI||this.gN)wac_b(18900675,333,50,String.format("Co-authors sent chat thread {0} and we're not connected to it...attempt to connect.",
e.KL)),wac_tOb(this,e,!1);return 32},N_d:function(a,b,c){if(2!==c)return 32;wac_sOb(this);if(!this.kBa)return wac_b(21550145,333,15,"Join operation before client is ready"),wac_t4(this),8;if(this.cUa||this.lBa)return wac_b(22045828,333,50,"Ignoring coauthors' InChat flag. Already retrieving the chat info or connecting to doc chat."),1;if(this.gH)return wac_b(21550146,333,50,"Ignoring coauthors' InChat flag. Already connected to doc chat."),32;if(!this.tI||this.gN)wac_b(21550147,333,50,"Co-authors sent InChat flag and we're not connected to the Doc Chat...attempt to connect."),
wac_uOb(this,!1);return 32},DMb:function(){!this.lBa&&!this.gH&&this.tI&&this.gN&&(wac_b(18900676,333,50,String.format("User is active but disconnected from doc chat. Attempting to reconnect to chat thread {0}...",this.tI.KL)),this.BT.Wj(2246375352,2,this.tI,null))},vOd:function(){this.lBa=!1;this.gH=!0;wac_b(5616863,333,50,"Join operation was successful")},tKd:function(){return this.gH&&!this.gN?32:8},lCd:function(a,b,c){if(2===c){wac_sOb(this);if(!this.kBa)return wac_t4(this),8;if(this.cUa)return 1;
this.bke=this.ipe=!0;this.jhb&&this.FWb&&!this.tI?wac_uOb(this,!0):wac_DCb(this.R7)&&1===(this.uR.eW.R9()?1:0)?this.uR.eW.A_():wac_tOb(this,this.tI,!0)}return this.kBa?32:8},Hfb:function(){},AZd:function(){wac_s4(this);return 32}};function wac_sOb(a){a.RIc||(a.RIc=!0,wac_b(36705360,333,15,"Usage of doc chat"))}function wac_t4(a){a.QIc||(a.QIc=!0,wac_b(36705359,333,15,"Bad user interaction with doc chat."))}
function wac_uOb(a,b){wac_b(5616864,333,50,"Trying to create a new thread");a.cUa=!0;wac_9Nb(a.eX,function(c){wac_b(5616865,333,50,"Thread created successfully");var d=!1;if(c.Aa)if(c=c.Aa.Be){var e;a:{if(c)try{e=wac_yl(c);break a}catch(f){wac_b(5328906,333,10,"could not parse the response of request: {0}",c.substr(0,Math.min(c.length,250)))}else wac_b(5328905,333,10,"Response from SkypeProxy was null");e=null}e&&e.Success?(wac_b(5328903,333,50,"Created ChatThreadId is :{0}",e.ThreadId),wac_tOb(a,
new wac_3h(e.ThreadId,e.DiscoveryUri),b),d=!0):wac_b(5616866,333,10,"Could not parse the response, parsed response is null or create thread operation failed.")}else wac_b(5328902,333,10,"ResponseData is null");else wac_b(5328901,333,10,"e.Data is null");b&&!d&&(wac_t4(a),a.Hfb());a.cUa=!1},function(){a.cUa=!1;b&&(wac_t4(a),a.Hfb());wac_b(5328904,333,15,"Try to create thread for this user failed")})}
function wac_tOb(a,b,c){b?(a.tI=b,c&&a.uR.eW.HV(),wac_vOb(a,c),wac_wOb(a)):wac_b(18419974,333,10,"Unexpected attempt to get on the doc chat without any chat thread info!")}function wac_wOb(a){a.mDa.CW(function(){var b=wac_Qb(a.mDa);b.Vlb.CWO(b.xpd,a.tI);wac_xOb()&&(b=a.ZWa,b.WN.CW(b.wpd))})}
function wac_vOb(a,b){a.lBa=!0;a.gH=!1;a.gN=!1;a.uR.Iya(a.tI,a.Qfd,function(){a.bke?(a.bke=!1,wac_b(38088785,333,15,"Join operation failed, retrying."),wac_vOb(a,b)):(a.lBa=!1,b&&(wac_t4(a),a.Hfb()),wac_b(5616860,333,10,"Join operation failed even after retrying."))},a.SSc)}function wac_rOb(a,b,c){a.FWb=b;a.gN=a.gH&&c;a.gH=a.gH&&!a.gN;wac_s4(a)}
function wac_yOb(a,b){b?(wac_b(51491852,333,50,"DocChatClient ready"),a.Tb(),a.kBa=!0,a.uR.yZa(a.awb),a.uR.AZa(a.IJa),a.uR.M9(a.Pfd),a.mDa&&a.mDa.CW(function(){a.ZWa=wac_Qb(a.mDa);a.ZWa.Ra.xa("NTID_EK",a.Rfd);wac_xOb()&&a.ZWa.Ra.xa("DCD_EK",a.xgd);a.ZWa.tb()}),a.$Aa&&a.$Aa.tb().CW(function(){wac_b(9000771,333,50,"AvailabilityFinder ready");a.$Aa.M9(a.T5c);a.$Aa.xZa(a.Yvb);a.jhb=wac_q4(a.$Aa);wac_Rnc(a);wac_s4(a)}),wac_rOb(a,!0,!1)):wac_b(9000770,333,10,"Doc chat client not ready")}
function wac_Rnc(a){!a.hpe&&a.jhb&&(wac_b(37597725,333,15,"Doc chat is available"),a.hpe=!0)}
function wac_iOb(a){a.uR=a.OUb.Db();var b=wac_jOb(a.uR);b.CW(function(){var c=wac_Qb(b);wac_q(wac_.pa,"DocumentChatPolicyIsEnabled")?(wac_b(51491849,333,50,"DocChatClientReady:{0}",c),wac_l(wac_j(),wac_RIb).uc(function(b){b.l9e("disabledocumentchat",!1).then(function(b){b&&wac_b(51491850,333,15,"DocChat is disabled by DisableDocumentChat policy");b=c&&!b;wac_yOb(a,b);a.mmb.Ze(b);return null},function(a){wac_b(51491851,333,10,"Could not get DisableDocumentChat policy: {0}",a);return null})})):(wac_yOb(a,
c),a.mmb.Ze(c))})}function wac_xOb(){return wac_q(wac_.pa,"DocChatDiscoveryViaPersistentStateChannelIsEnabled")}function wac_qOb(){return wac_q(wac_.pa,"DocChatJoinInfoFromServerIsEnabled")}
function wac_u4(a,b,c,d){this.wpd=Function.createDelegate(this,this.A_d);this.xpd=Function.createDelegate(this,this.B_d);this.Zua=Function.createDelegate(this,this.Ada);this.$ua=Function.createDelegate(this,this.kza);this.Bvb=Function.createDelegate(this,this.sLb);wac_u4.initializeBase(this);wac_b(5895065,333,50,"Initializing chat notifier");this.WN=a;this.Zfa=c;this.Vlb=b;this.Wqa=d}
wac_u4.prototype={WN:null,Fp:null,Vlb:null,Zfa:null,xYb:null,APc:!1,Wqa:null,GXa:null,qPc:!1,tb:function(){return wac_Db.WAA.call(null,this.Wqa,this.WN,this.Zfa).CW(this.Bvb)},sLb:function(){wac_b(6603971,333,50,"All prerequisite ready for SkypeChatNotifier");this.GXa=wac_Qb(this.Wqa);this.xYb=wac_Qb(this.Zfa);this.Fp=wac_Qb(this.WN);wac_zOb(this,this.Fp.wHb());wac_AOb(this,this.Fp.pOa(1));wac_b(5898719,333,50,"Subscribing to presence updates");this.Fp.zZa(this.$ua);this.Fp.hob(this.Zua)},kza:function(a,
b){a=Date.now();this.xYb&&(this.APc||(this.APc=!0,wac_b(6555618,333,50,"SkypeChat complemented recorded presence update")),wac_zOb(this,b.nU),a=Date.now()-a,b.iTa&&b.iTa.Nq(a,"SkypeChatRtcNotifier"))},Ada:function(a,b){1===b.Fg&&(this.qPc||(this.qPc=!0,wac_b(21803734,333,50,"SkypeChat recorded persistent state update")),wac_AOb(this,b.nU))},B_d:function(a,b){var c=this;wac_Db.WAA(this.Zfa,this.Vlb).CW(function(){wac_Qb(c.Zfa).KL=b.KL;wac_Qb(c.Zfa).yZ=b.yZ;wac_b(5898752,333,50,"Re-sending the latest presence with the chatThreadId:{0}, chatThreaddiscoveryUri:{1}",
wac_Qb(c.Zfa).KL,wac_Qb(c.Zfa).yZ);wac_Qb(c.Vlb).Tza()})},A_d:function(){var a=this;wac_Db.WAA(this.WN).CW(function(){var b;b=(b=wac_Qb(a.WN).pOa(1))&&wac_Qb(a.WN).iS()in b?b[wac_Qb(a.WN).iS()]:new wac_aOb("",!1,0);b.InChat=!0;wac_b(21803737,333,50,"Re-sending the latest persistent state");wac_Qb(a.WN).LRa(1,b)})}};
function wac_AOb(a,b){for(var c in b){var d={key:c,value:b[c]},e=d.value;if(e&&e.InChat&&d.key!==a.Fp.iS()){wac_b(21803735,333,50,"User found in chat");a.Ra.wa("DCD_EK",null,null);break}}}function wac_zOb(a,b){for(var c in b){var d=a.GXa.Axc({key:c,value:b[c]});if(d){var e=d.KL;if(e&&d.iS()!==a.xYb.iS()){wac_b(5895069,333,50,String.format("Chat thread id found : {0}",e));a.Ra.wa("NTID_EK",new wac_2h(new wac_3h(e,d.yZ)),null);break}}}}function wac_BOb(){}
wac_BOb.prototype={Ub:function(){return"Common.App.SkypeChat"},gc:function(a){wac_m(wac_n(a.fa(wac_o4)),function(){return new wac_o4(wac_rP(wac_Jm,wac_l(a,wac_Jm)),wac_r().Bz())});wac_m(wac_n(wac_o(a.fa(wac_kOb),wac_cOb)),function(){return new wac_kOb(new (wac_f.$$(wac_o4))(function(){return a.H(wac_o4)}))})},tb:function(){},O:function(){}};wac_7Nb.registerClass("Common.SkypeProxyRequestHandler");wac_aOb.registerClass("Common.App.SkypeChat.ChatPersistentState");(function(){}).registerClass("Common.App.SkypeChat.SkypeProxyCreateThreadResponse");
wac_dOb.registerClass("Common.App.SkypeChat.AChatAvailabilityFinder",null,wac_9la);wac_fOb.registerClass("Common.App.SkypeChat.ASkypeChatNotifier",null,wac_Cc);wac_n4.registerClass("Common.App.SkypeChat.ChatAvailabilityChangedEventArgs",Sys.EventArgs,wac_8la);wac_gOb.registerClass("Common.App.SkypeChat.DocChatBootstrapper");wac_o4.registerClass("Common.App.SkypeChat.DocChatClient",null,wac_bOb);wac_kOb.registerClass("Common.App.SkypeChat.DocChatClientFactory",null,wac_cOb);
wac_lOb.registerClass("Common.App.SkypeChat.DocChatUserIdFactory",null,wac_m4);wac_pOb.registerClass("Common.App.SkypeChat.ASkypeProxyRequest");wac_$Nb.registerClass("Common.App.SkypeChat.SkypeProxyCreateThreadRequest",wac_pOb);(function(){}).registerClass("Common.App.SkypeChat.SkypeProxyResponseHelper");wac_p4.registerClass("Common.App.SkypeChat.RtcChatAvailabilityFinder",wac_dOb);wac_r4.registerClass("Common.App.SkypeChat.SkypeChatActor",null,wac_$la);
wac_u4.registerClass("Common.App.SkypeChat.SkypeChatRtcNotifier",wac_fOb);wac_BOb.registerClass("Common.App.SkypeChat.SkypeChatPackage",null,wac_I,wac_i);wac_J(wac_C(),new wac_BOb,0,!1);Type.registerNamespace("Common.App.SmartLookup");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.Tdd=wac_d.Qa.Tdd||{};window.Common.App.SmartLookup.EntryPoint=wac_d.Qa.Tdd.bMe=function(){};
wac_d.Qa.Tdd.bMe.prototype={other:0,searchBoxSearch:1,searchBoxDictionary:2,searchBoxQuickAnswer:3,smartLookupRibbon:4,smartLookupContextMenu:5,entity:6,dictionary:7,web:8,pictures:9,files:10,bookmarks:11,help:12,chartRecommendation:13,linkSkill:14,searchBoxFindInDocument:15,searchBoxEntity:16,searchSkill:17};window.Common.App.SmartLookup.EntryPoint.registerEnum("Common.App.SmartLookup.EntryPoint",!1);window.Common.App.SmartLookup.LaunchMode=wac_d.Qa.Tdd.eRf=function(){};
wac_d.Qa.Tdd.eRf.prototype={"default":0,documentsView:1,objectsView:2};window.Common.App.SmartLookup.LaunchMode.registerEnum("Common.App.SmartLookup.LaunchMode",!1);Type.registerNamespace("Box4.DictationCorrections");wac_K=window.Box4||{};wac_K.aOf=wac_K.aOf||{};function wac_Z7c(){}wac_Z7c.registerInterface("Box4.DictationCorrections.IDictationCorrectionContextMenuManager");function wac__7c(){this.Id="Corrections";this.Name="Telemetry";this.ClientSessionId="";this.CorrectionEvents=null}
function wac_07c(a,b,c){this.TriggerType="click";this.TreatedInUX="true";this.PhraseId=a.Svf;this.CorrectionId=a.puf;switch(b){case 0:this.EditType="alternate";this.AlternateId=c;break;case 1:this.EditType="ignore";break;case 2:this.EditType="dismissed";break;default:wac_b(51246608,394,10,"Invalid CorrectionEditType value")}}function wac_17c(){this.Id="Corrections";this.Name="Session";this.ClientSessionId="";this.SessionInfo=null}
function wac_27c(){this.StartTime="";this.AlternateEditCount=this.ManualEditCount=this.Duration=0;this.TextInfo=null}function wac_37c(){this.FinalText="";this.PhraseIds=null}function wac_47c(){}wac_47c.registerInterface("Box4.DictationCorrections.IDictationCorrectionsActor");function wac_57c(){}wac_57c.registerInterface("Box4.DictationCorrections.IDictationCorrectionRangeEditor");function wac_67c(){}wac_67c.registerInterface("Box4.DictationCorrections.IDictationCorrectionStorage");
function wac_77c(a,b,c,d,e,f,g){this.y5e=Function.createDelegate(this,this.MNf);this.eLf=Function.createDelegate(this,this.FVf);this.v8e=Function.createDelegate(this,this.GVf);this.yf=a;this.Lmf=b;this.dFc=c;this.Ia=d;this.Fa=e;this.Gi=f;this.Oe=g}
wac_77c.prototype={yf:null,Lmf:null,dFc:null,Ia:null,Fa:null,Gi:null,Oe:null,Tb:function(){this.Ia.ja(2122828371,4,this.v8e);this.Ia.ja(2122828372,4,this.v8e);this.Ia.ja(2122828369,4,this.v8e);this.Ia.ja(2122828370,4,this.v8e);this.Ia.ja(2122828375,4,this.v8e);this.Ia.ja(421768503,4,this.eLf);this.Ia.ja(2122828371,2,this.y5e);this.Ia.ja(2122828372,2,this.y5e);this.Ia.ja(2122828369,2,this.y5e);this.Ia.ja(2122828370,2,this.y5e);this.Ia.ja(2122828375,2,this.y5e);this.Ia.ja(421768503,2,this.y5e);this.Ia.BD(2122828371,
96);this.Ia.BD(2122828372,96);this.Ia.BD(2122828369,96);this.Ia.BD(2122828370,96);this.Ia.BD(2122828375,96);this.Ia.BD(421768503,96)},GVf:function(a,b,c){if(2===c&&b.Ik()&&(c=wac_87c(b))){b=b.aa;a=wac_97c(a);var d=this.Oe.je(15,0);try{d.lb(b);var e;wac_$7c(this.Lmf,b,(e=new (wac_g.$$(wac_FA)),e.ga(c),e));var f=c.Etb.RD.K(a);if(b&&wac_a8c(b.Xc,f.h1e,c.qzb)){var g=wac_Jw(b,c.qzb,c.qzb+f.h1e.length);this.yf.Pj(g,f.Fxf,!1,!0,0);var h=this.dFc;h.Fia&&wac_b8c(h.Fia,c.Etb,0,a)}else wac_b(50946527,394,100,
"Failed to apply Suggestion")}finally{d&&d.dispose()}}return 32},MNf:function(a,b,c,d,e){if(2===c){b=this.Fa.wb().kb();if(!b)return 2;b=wac__u(b,!0,!1,!0,!1);return this.Ia.YN(b.La(),a,c,!1,d,e,null)}return 32},FVf:function(a,b,c){if(2===c&&b.Ik()&&(a=wac_87c(b))){var d;wac_$7c(this.Lmf,b.aa,(d=new (wac_g.$$(wac_FA)),d.ga(a),d));b=this.dFc;b.Fia&&wac_b8c(b.Fia,a.Etb,1,-1)}return 32}};
function wac_97c(a){switch(a){case 2122828371:return 0;case 2122828372:return 1;case 2122828369:return 2;case 2122828370:return 3;case 2122828375:return 4;default:return-1}}function wac_c8c(a){this.J0b=[2122828371,2122828372,2122828369,2122828370,2122828375];this.rWf=a}wac_c8c.prototype={J0b:null,rWf:null};function wac_d8c(a,b){this.Dp=a;this.dFc=b}
wac_d8c.prototype={Dp:null,dFc:null,Lef:null,rh:function(){return"DICTATIONCORRECTION"},yK:function(){return Box4Intl.Box4Strings.l_DictationCorrectionContentTitle},jc:function(a){wac_Yv(a.aa)?this.Lef=a.aa:this.Lef=null},wgb:function(a,b){b.val=null;if(!this.Lef)return!1;this.dFc.Dye.aNe?(a=wac_2u(this.Lef,a),a=wac_87c(a)):a=null;if(!a)return!1;var c;b.val=(c=new wac_SC,c.dM=this.rh(),c.KD=a,c.fA=Box4Intl.Box4Strings.l_ShowIntentSuggestionTooltipClickOrPress,c);return!0}};
function wac_e8c(a,b,c){this.UIf=Function.createDelegate(this,this.PRf);this.TIf=Function.createDelegate(this,this.ORf);this.Y9e=a;this.Dye=b;this.L$e=new (wac_ib.$$(wac_al))(new wac_cBa);this.X9e=c;this.pRa()}
wac_e8c.prototype={Y9e:null,Dye:null,L$e:null,Fia:null,X9e:null,VCf:null,Hkf:function(a){this.Dye.aNe&&wac_Yv(a)&&this.L$e.Ge(a.ia())&&this.Y9e.Hkf(a)},IUf:function(a){if(this.Dye.aNe){var b=a.ej(Array,wac_4Ic,null);if(!wac_km(b)){for(var c=new (wac_g.$$(wac_FA)),d=Math.min(b.length,a.OA.na()),e=0;e<d;e++){var f;if(f=b[e]){var g=void 0,h=void 0,k=void 0;f=(k=this.X9e.f7e.qg(f,h={val:g}),g=h.val,k)?g:null}else f=null;f&&(g=a.OA.K(e).vb,c.ga(new wac_FA(g,g+f.h1e.length,f)))}b=this.Y9e;if(a&&c&&c.Ma()&&
(c=wac_f8c(a,c))&&c.Ma()){c.K(0);c.K(c.Ma()-1);d=wac_g8c(a);f=e=0;for(g=new (wac_g.$$(wac_FA));f<c.Ma()&&e<d.Ma();)h=c.K(f),k=d.K(e),h.OL<k.qzb?f++:(k.OL>h.qzb&&g.ga(k),e++);wac_$7c(b,a,g);e=new (wac_g.$$(Number));for(f=c.$$lge();f.$$mn();)d=f.$$cu(),e.ga(d.qzb),e.ga(d.OL);a.e9e(e);for(e=c.$$lge();e.$$mn();)d=e.$$cu(),f=wac_pA(a.OA,d.qzb),wac_sQc(f,new wac_eMc(f,d.Etb,b.SHf)),wac_kLc(f,!0),f=wac_pA(a.OA,d.OL),wac_tQc(f,!0),wac_kLc(f,!0);0<c.Ma()&&b.Ra.wa("ADCM",new wac_h8c(a.ia(),c),null)}}}},emf:function(a,
b){if(!b)return!1;if(!this.Dye.aNe||!a)return b.ga(null),!1;b.ga(a.hpb?a.hpb.Etb.QP:null);return!!a.hpb},LUf:function(a,b){this.Dye.aNe&&b&&wac_xb.AT(String,b,function(a){return!!a})?wac_u(a,wac_4Ic,b.xe()):wac_he(a,wac_4Ic)},pRa:function(){this.Y9e.Ra.xa("ADCM",this.TIf);var a=this;wac_tf(window.self,"blur",function(){a.Fia&&a.Dye.aNe&&a.Fia.v4e.vg()});var b=this;wac_tf(window.self,"focus",function(){b.Fia&&b.Dye.aNe&&b.Fia.pef()});this.Y9e.Ra.xa("RDCM",this.UIf)},PRf:function(a,b){a=this.X9e;if((b=
b.lif)&&b.Ma())for(b=b.$$lge();b.$$mn();){var c=b.$$cu();a.f7e.Rc(c.Etb.QP)}},ORf:function(a,b){this.L$e.ga(b.Ovf);this.Fia&&(a=this.Fia,a.Nnf+=b.evf);a=this.X9e;if((b=b.lif)&&b.Ma())for(b=b.$$lge();b.$$mn();){var c=b.$$cu(),d=c.Etb.QP;a.f7e.mc(d)||a.f7e.ga(d,c.Etb)}}};function wac_i8c(a){a.Dye.aNe=!0;a.Fia=new wac_j8c(function(){return a.VCf});a.Fia.pef()}function wac_k8c(){}wac_k8c.prototype={aNe:!1};function wac_l8c(){this.f7e=new (wac_gb.$$(String,wac_dMc))(wac_Faa())}
wac_l8c.prototype={f7e:null,ie:function(){this.f7e=new (wac_gb.$$(String,wac_dMc))(wac_Faa())}};function wac_m8c(a){this.SHf=Function.createDelegate(this,this.EPf);this.yf=a;this.Ra=new wac_Re}
function wac_f8c(a,b){if(!b.Ma())return b;b.Sc(function(a,b){return a.qzb!==b.qzb?a.qzb-b.qzb:a.OL-b.OL});a=a.Xc;for(var c=new (wac_g.$$(wac_FA)),d=0;d<b.Ma();d++){var e=b.K(d);if(e.qzb>a.length||e.OL>a.length)break;if(!a||e.qzb>a.length||e.OL>a.length||!e.Etb?0:wac_a8c(a,e.Etb.h1e,e.qzb))if(c.Ma()){var f=c.K(c.Ma()-1);e.qzb>f.OL?c.ga(e):f.qzb===e.qzb&&f.OL===e.OL&&f.Etb.RD.or(e.Etb.RD)}else c.ga(e)}return c}
function wac_a8c(a,b,c){if(c+b.length<=a.length){for(var d=0;d<b.length;d++)if(b.charAt(d)!==a.charAt(d+c))return!1;return!0}return!1}
wac_m8c.prototype={yf:null,Ra:null,Hkf:function(a){if(a){var b=wac_g8c(a);if(b&&0<b.Ma()){for(var c=new (wac_g.$$(wac_FA)),d=a.Xc,b=b.$$lge();b.$$mn();){var e=b.$$cu();wac_a8c(d,e.Etb.h1e,e.qzb)||c.ga(e)}wac_$7c(this,a,c)}}},EPf:function(a,b){for(var c=b.Is,d=wac_npc(a.OA,c.vb)+1;d<a.OA.na();d++){var e=a.OA.K(d);if(wac_ELc(e)){var f;wac_$7c(this,a,(f=new (wac_g.$$(wac_FA)),f.ga(new wac_FA(c.vb,e.vb,b.Etb)),f));break}}}};
function wac_87c(a){if(!a||!wac_Mv(a)&&!wac_Nv(a))return null;var b=a.aa,c=a.Na;a=a.Nb;for(var d=0,e=null,f=0;f<b.OA.na();f++){var g=b.OA.K(f);if(g.hpb&&c>=g.vb)e=g.hpb,d=g.vb;else if(e&&wac_ELc(g)){if(a<=g.vb)return new wac_FA(d,g.vb,e.Etb);e=null}}return null}function wac_$7c(a,b,c){if(b&&c&&c.Ma()){for(var d=c.$$lge();d.$$mn();){var e=d.$$cu(),f=wac_pA(b.OA,e.qzb);f&&wac_sQc(f,null);(f=wac_pA(b.OA,e.OL))&&wac_tQc(f,!1)}a.Ra.wa("RDCM",new wac_h8c(b.ia(),c),null)}}
function wac_g8c(a){var b=new (wac_g.$$(wac_FA));if(a)for(var c=null,d=-1,e=0;e<a.OA.na();e++){var f=a.OA.K(e);f.hpb?(d=f.vb,c=f.hpb.Etb):wac_ELc(f)&&(b.ga(new wac_FA(d,f.vb,c)),c=null)}return b}function wac_n8c(){}
wac_n8c.prototype={sa:null,EAf:null,Ub:function(){return"Box4.DictationCorrections"},gc:function(a){this.sa=a;var b=this;wac_m(wac_n(this.sa.fa(wac_57c)),function(){return new wac_m8c(b.sa.H(wac_$r))});var c=this;wac_m(wac_n(this.sa.fa(wac_$Jc)),function(){return new wac_e8c(c.sa.H(wac_57c),new wac_k8c,new wac_l8c)});var d=this;wac_m(wac_n(this.sa.fa(wac_Z7c)),function(){return new wac_c8c(d.sa.H(wac_57c))})},tb:function(){this.sa.H(wac_$Jc);this.EAf=new wac_77c(this.sa.H(wac_$r),this.sa.H(wac_57c),
this.sa.H(wac_$Jc),wac_z(),wac_at(),wac_pt(),this.sa.H(wac_rt));this.EAf.Tb();wac_o8c(wac_l(this.sa,wac_NC),this.sa.H(wac_Ns),this.sa.H(wac_$Jc));window.Box4.App.zb().Tg(!1)},O:function(){}};function wac_o8c(a,b,c){a&&a.uc(function(a){wac_K4(a,new wac_d8c(b,c))})}function wac_p8c(){}
wac_p8c.prototype={IW:!1,Anf:0,lmf:0,Wd:function(){this.IW||(this.IW=!0,this.Anf=wac_q8c())},vg:function(){this.IW&&(this.lmf+=wac_q8c()-this.Anf,this.IW=!1)},yua:function(){var a=this.IW?wac_q8c()-this.Anf:0;return this.lmf+a}};function wac_q8c(){return(new Date).getTime()}function wac_j8c(a){var b;this.u4e=(b=new wac_27c,b.TextInfo=[new wac_37c],b);this.cnf=a}
wac_j8c.prototype={cnf:null,u4e:null,Nnf:0,Mnf:0,dCf:0,lWf:"Office.Voice.Online.DictationCorrectionsSession",v4e:null,pef:function(){this.v4e||(this.u4e.StartTime=(new Date).toISOString(),this.v4e=new wac_p8c);this.v4e.Wd()},mkf:function(){this.v4e.vg();var a=new wac_bea;a.name=this.lWf;a.samplingPolicy=2;a.durationMs=this.v4e.yua();a.dataFields=[];var b;Array.add(a.dataFields,(b=new wac_Cb,b.name="CorrectionSessionId",b.string=this.iEe(),b));var c;Array.add(a.dataFields,(c=new wac_Cb,c.name="StartTime",
c.string=this.u4e.StartTime,c));var d;Array.add(a.dataFields,(d=new wac_Cb,d.name="NumberOfCorrectionsMarked",d.int64=this.Nnf,d));var e;Array.add(a.dataFields,(e=new wac_Cb,e.name="NumberOfCorrectionsMade",e.int64=this.Mnf,e));var f;Array.add(a.dataFields,(f=new wac_Cb,f.name="NumberOfCorrectionsDismissed",f.int64=this.dCf,f));wac_Pfa(a);window.Box4.App.azc&&0<window.Box4.App.azc.Ynf.length&&(this.u4e.AlternateEditCount=this.Mnf,this.u4e.Duration=Math.floor(this.v4e.yua()/1E3),this.u4e.TextInfo[0].PhraseIds=
window.Box4.App.azc.Ynf,b=new wac_17c,b.ClientSessionId=this.iEe(),b.SessionInfo=this.u4e,a=this.cnf())&&(b=wac_ai(b),wac_r8c(a,b))},iEe:function(){return window.Box4.App.azc?window.Box4.App.azc.iEe():""}};function wac_b8c(a,b,c,d){c?1===c&&a.dCf++:a.Mnf++;var e=new wac__7c;e.ClientSessionId=a.iEe();e.CorrectionEvents=[new wac_07c(b,c,d)];if(a=a.cnf())e=wac_ai(e),wac_r8c(a,e)}function wac_h8c(a,b){wac_h8c.initializeBase(this);this.Ovf=a;this.evf=b?b.Ma():0;this.lif=b}
wac_h8c.prototype={Ovf:null,evf:0,lif:null};wac__7c.registerClass("Box4.DictationCorrections.CorrectionTelemetry");wac_07c.registerClass("Box4.DictationCorrections.CorrectionEvent");wac_17c.registerClass("Box4.DictationCorrections.CorrectionsSessionTelemetry");wac_27c.registerClass("Box4.DictationCorrections.SessionInfo");wac_37c.registerClass("Box4.DictationCorrections.TextInfo");wac_77c.registerClass("Box4.DictationCorrections.DictationCorrectionsActor",null,wac_47c);
wac_c8c.registerClass("Box4.DictationCorrections.DictationCorrectionContextMenuManager",null,wac_Z7c);wac_d8c.registerClass("Box4.DictationCorrections.DictationCorrectionDetailsProvider",null,wac_PC,wac_OC);wac_e8c.registerClass("Box4.DictationCorrections.DictationCorrectionManager",null,wac_$Jc);wac_k8c.registerClass("Box4.DictationCorrections.DictationCorrectionSettings");wac_l8c.registerClass("Box4.DictationCorrections.DictationCorrectionStorage",null,wac_67c);(function(){}).registerClass("Box4.DictationCorrections.DictationCorrectionsParser");
wac_m8c.registerClass("Box4.DictationCorrections.DictationCorrectionRangeEditor",null,wac_57c);wac_n8c.registerClass("Box4.DictationCorrections.DictationCorrectionsPackageManager",null,wac_I,wac_i);wac_p8c.registerClass("Box4.DictationCorrections.DictationCorrectionsSessionTimer");wac_j8c.registerClass("Box4.DictationCorrections.DictationCorrectionsTelemetry");wac_h8c.registerClass("Box4.DictationCorrections.DictationCorrectionMarkerEventArgs",Sys.EventArgs);(function(){}).registerClass("Box4.DictationCorrections.Program");
wac_J(wac_C(),new wac_n8c,0,!1);Type.registerNamespace("B4Intent");function wac_s8c(){}wac_s8c.registerInterface("B4Intent.IIntentRangeEditor");function wac_t8c(a){this.yf=a}wac_t8c.prototype={yf:null};function wac_u8c(){}wac_u8c.prototype={sa:null,Ub:function(){return"Box4.Intent"},gc:function(a){this.sa=a;var b=this;wac_m(wac_n(wac_o(this.sa.fa(wac_t8c),wac_s8c)),function(){return new wac_t8c(b.sa.H(wac_$r))})},tb:function(){this.sa.H(wac_ur)},O:function(){}};
wac_t8c.registerClass("B4Intent.IntentRangeEditor",null,wac_s8c);wac_u8c.registerClass("B4Intent.PackageManager",null,wac_I,wac_i);wac_J(wac_C(),new wac_u8c,0,!1);Type.registerNamespace("Box4.Media");wac_K=window.Box4||{};wac_K.QPa=wac_K.QPa||{};function wac_gRb(){}wac_gRb.registerInterface("Box4.Media.IInsertMediaHelper");function wac_44(){}wac_44.registerInterface("Box4.Media.IOneDriveFilePickerHelper");function wac_hRb(){}wac_hRb.registerInterface("Box4.Media.IImageFilePickerHelper");
function wac_iRb(){}wac_iRb.registerInterface("Box4.Media.IInsertOnlineMediaHelper");function wac_7vc(){}wac_7vc.registerInterface("Box4.Media.IInsertOnlineMediaHandler");function wac_jRb(){}wac_jRb.registerInterface("Box4.Media.IInsertMediaCrossDocumentMessenger");function wac_54(){}wac_54.registerInterface("Box4.Media.IInsertMediaCrossDocumentMessengerFactory");function wac_kRb(){}wac_kRb.registerInterface("Box4.Media.IInsertMediaDialog");function wac_64(){}wac_64.registerInterface("Box4.Media.IInsertMediaDialogFactory");
function wac_74(){}wac_74.registerInterface("Box4.Media.IInsertMediaFromHostManagerFactory");function wac_84(){}wac_84.registerInterface("Box4.Media.IInsertMediaFromHostOneDriveHostFrame");wac_K.QPa.Gkf=function(){};wac_K.QPa.Gkf.prototype={unknown:0,bing:1,m365:2,icons:3,oneDrive:4};wac_K.QPa.Gkf.registerEnum("Box4.Media.InsertMediaProviders",!1);wac_K.QPa.xKb=function(){};wac_K.QPa.xKb.prototype={Image:0,Video:1};wac_K.QPa.xKb.registerEnum("Box4.Media.MediaType",!1);function wac_94(){}
function wac_lRb(){}wac_lRb.registerInterface("Box4.Media.IPickerDialog");
function wac_$4(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t){this.y5a=Function.createDelegate(this,this.FQb);this.prd=Function.createDelegate(this,this.j2d);this.nrd=Function.createDelegate(this,this.i2d);this.Xwb=Function.createDelegate(this,this.XRb);this.Nwb=Function.createDelegate(this,this.EQb);this.dispose=this.O;this.gga=d;this.lXa=e;this.M6d=g;this.jLc=h;this.F8=k;this.Ia=a;this.Dc=b;this.u1=f;this.bMc=n;this.Z6d=p;this.Djb=q;this.OVa=c;this.lLc=l;this.tWb=m;this.QNe=r;this.RNe=t}
wac_$4.prototype={Ia:null,Dc:null,OVa:null,u1:null,M6d:null,jLc:null,F8:null,lLc:null,tWb:null,Djb:null,Z6d:!1,bMc:!1,QNe:null,RNe:null,lXa:null,gga:null,w_a:!1,Tb:function(){(this.OVa.Vyc||this.OVa.HJb)&&this.OVa.Uyc&&this.kOb();wac_v8c(this);this.Ia.jf(720118144,2,this.Nwb,1284);this.Ia.jf(3612507612,2,this.Xwb,1124);this.Ia.jf(2494479545,2,this.nrd,1284)},kOb:function(){wac_r().Nc().appendChild(this.lXa.pH);wac_tf(this.lXa.pH.contentWindow,"message",this.y5a);this.w_a=!0},FQb:function(a){if(a.rawEvent&&
(a=a.rawEvent.data))try{var b=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0),c=b.MessageId?b.MessageId.toString():null;b&&c&&("UI_InsertImage"===c||"UI_InsertFileLink"===c)&&this.gga.Wd("UI_InsertImage"===c?this.lLc:this.tWb)}catch(d){}},XRb:function(a,b,c,d,e){if(1===c)return 32;a=wac_r().Hd().Bg();this.bMc?a=a?CommonUIStrings.l_OneDriveName:String.format(CommonUIStrings.L_OnlinePictureFromHost,CommonUIStrings.l_OneDriveName):""!==this.Djb?a=a?this.Djb:String.format(CommonUIStrings.L_OnlinePictureFromHost,
this.Djb):(a=a?CommonUIStrings.l_HostGeneric:CommonUIStrings.l_OnlinePictureFromHostGeneric,wac_b(20509841,352,15,"InsertMediaActor::UpdateEntryPoints : Do not have host name, use generic name instead."));e[wac_WS.LabelText]=a;return 32},j2d:function(){throw wac_Xb();},i2d:function(a,b,c){a=32===this.Ia.YN(b,2711544537,1,!1,null,null,null);if(1===c)return a&&this.OVa.HJb?32:8;if(2!==c||!a)return 8;wac_b(21612190,352,50,"InsertMediaActor::ShowInsertOneDriveFileDialog : ShowInsertMediaDialog dialog.");
return this.DQb(this.jLc.IG(),Box4Intl.Box4Strings.l_InsertOneDriveFile,this.tWb)},EQb:function(){throw wac_Xb();},DQb:function(a,b,c){try{return a.hSa(b,c),wac_b(7185476,352,50,"InsertMediaActor::ShowInsertPictureDialog : ShowInsertMediaDialog dialog success."),32}catch(d){return wac_b(7165726,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",d.toString()),this.Im(5242881,CommonUIStrings.l_DefaultDialogTitle,Box4Intl.Box4Strings.l_ClipartCannotConnect),8}},Im:function(a,b,c){var d=
new wac_di(!0);d.wr=wac_.kyd;wac_Nh(d,0);wac_Oh(d,1,CommonUIStrings.l_DialogClose);d.hs(a,b,c,function(){})},O:function(){this.w_a&&this.lXa.pH.contentWindow&&(wac_jg(this.lXa.pH.contentWindow,"message",this.y5a),this.w_a=!1)}};function wac_v8c(a){a.Ia.jf(1685987254,2,a.prd,1284);a.Ia.n2e("word_insertOnlinePictures",!0,1685987254,2,a.prd,function(a){wac_NRc(window.Box4.App.zb(),a,(new wac_DKc).Lqe)})}
function wac_a5(a,b){wac_a5.resolveInheritance();this.dispose=this.O;wac_a5.initializeBase(this,[a,wac_Jh(b,0),null])}wac_a5.prototype={Dx:function(a,b,c){var d;this.Wna((d=new wac_0a,d.MessageId=a,d.SendTime=Date.now(),d.CorrelationId=c,d.Values=b,d),null)}};function wac_b5(a,b,c){a.yx()&&wac_s7a(a,a.ela)&&(a.vtb(b),a.Kzd(b,c))}
function wac_c5(a,b){wac_c5.resolveInheritance();this.dispose=this.O;wac_c5.initializeBase(this,[a,"*"===b?b:wac_Jh(b,0),null]);wac_BQ.prototype.RDb.call(this,"UI_InsertImage");wac_BQ.prototype.RDb.call(this,"UI_InsertFileLink")}wac_c5.prototype={Dx:function(a,b,c){var d;return this.Wna((d=new wac_0a,d.MessageId=a,d.SendTime=Date.now(),d.CorrelationId=c,d.Values=b,d),null)},Clf:function(){return!1},DCc:function(){}};function wac_mRb(){}wac_mRb.prototype={IG:function(a,b){return new wac_a5(a,b)}};
function wac_d5(a,b,c,d){this.Hfd=Function.createDelegate(this,this.nOd);this.bhd=Function.createDelegate(this,this.OPd);this.khd=Function.createDelegate(this,this.XPd);this.ehd=Function.createDelegate(this,this.RPd);this.Dse=Function.createDelegate(this,this.rve);this.Y3=Function.createDelegate(this,this.CM);wac_d5.initializeBase(this,[!1,!1,!1,!1]);if(!a)throw Error.argumentNull("insertMediaSeviceEndpoint","insertMediaSeviceEndpoint cannot be null.");this.sWb=a;this.IUb="";this.F8=c;this.ira=[];
this.mga=b;this.po=d||wac_nRb;this._id="InsertMediaDialog"}
wac_d5.prototype={ira:null,IUb:null,hF:null,mga:null,F8:null,sWb:null,ejb:!1,uWa:null,U1d:null,uDe:"KeepFocusDiv",pze:"KeepFocusStartDiv",Nd:null,o9d:function(a){return this.Nd=a},B3e:0,u5e:function(a){return this.B3e=a},Fjc:null,rEe:function(a){return this.Fjc=a},hSa:function(a,b){this.IUb=a;this.ejb=!1;this.Hm(this.IUb,null);this.uWa=wac_w8c(this.Rf("insertmediaframe"));if(!this.uWa)throw wac_6m(this,this.gq,0),Error.invalidOperation("Couldn't get InsertMediaIframe.");a=document.createElement("div");
a.setAttribute("Id",this.pze);a.setAttribute("tabindex","0");a.setAttribute("position","absolute");a.setAttribute("width","-1000px");a.setAttribute("top","-1000px");this.uWa.parentNode.insertBefore(a,this.uWa.parentNode.firstChild);a=document.createElement("div");a.setAttribute("Id",this.uDe);a.setAttribute("tabindex","0");this.uWa.parentNode.appendChild(a);a.setAttribute("position","absolute");a.setAttribute("width","-1000px");a.setAttribute("top","10000px");window.$addHandler(wac_kg?wac_kg.Rb:null,
"keydown",this.Y3);this.uWa.setAttribute("src",this.sWb);this.uWa.setAttribute("width","100%");this.uWa.setAttribute("height","100%");this.uWa.setAttribute("frameborder","0");wac_q(wac_.pa,"ShowInsertMediaIframeWhenIframeIsReady")&&wac_dg()?(this.uWa.style.visibility="hidden",this.U1d=this.Dse,wac_tf(this.uWa,"load",this.U1d)):this.uWa.style.visibility="visible";wac_w8c(this.Rf("WACDialogButtonPanel")).style.display="none";wac_w8c(this.Rf("WACDialogTitleText")).style.display="none";2===this.B3e&&
(wac_w8c(this.Rf("WACDialogTitlePanel")).style.display="none",wac_w8c(this.Rf("WACDialogBodyPanel")).style.padding="0");wac_Ie().Hg().uC.NCa=!0;this.hF=this.mga.IG(this.uWa.contentWindow,this.sWb);var c=this;wac_b5(this.hF,"AddItem",function(a){var d=b.tvb||(b.tvb=Function.createDelegate(b,b.uya));wac_b(7135752,352,100,"OnAddItem : Got message.");if(a=wac_x8c(a))50<c.ira.length?wac_b(7135753,352,15,"OnAddItem : Only allow 50 items to be added."):(Array.add(c.ira,a),c.ejb&&(d(c.ira),c.ejb=!1))});var d=
this;wac_b5(this.hF,"Insert",function(a){d.mMb(a,b.tvb||(b.tvb=Function.createDelegate(b,b.uya)))});wac_b5(this.hF,"AddOtelEvent",function(a){if(a&&a.Values){a=a.Values;delete a.m_Origin;delete a.m_Source;delete a.m_ReceivedTime;wac_b(51652562,352,50,"Received OTel event: "+a.eventName||"Unknown");var b;wac_Qfa((b=new wac_lka,b.otelEvent=a,b))}});wac_b5(this.hF,"GetCustomHeaders",this.ehd);wac_b5(this.hF,"GetSessionId",this.khd);wac_b5(this.hF,"GetCID",this.bhd);wac_b5(this.hF,"CancelDialog",this.Hfd);
wac_8vc(this,3)},rve:function(){if(this.uWa){this.uWa.style.visibility="visible";var a=this;window.setTimeout(function(){if(a.fg){var b=a.fg.getElementById(a.pze);b&&b.focus()}},0)}},CM:function(a){9===a.keyCode&&(a.target.id!==this.uDe||a.shiftKey?a.target.id===this.pze&a.shiftKey&&(a.preventDefault(),this.fg.getElementById(this.uDe).focus()):(a.preventDefault(),this.fg.getElementById(this.pze).focus()))},dispose:function(){this.hF&&(this.hF.dispose(),this.hF=null);this.U1d&&(wac_jg(this.uWa,"load",
this.U1d),this.U1d=null);wac__m.prototype.dispose.call(this)},nOd:function(){wac_b(17662422,352,100,"OnCancelDialog : Got message.");wac_6m(this,this.gq,0);wac_8vc(this,1)},Mdb:function(){var a=new XMLHttpRequest;a.open("POST",this.Fjc,!0);a.setRequestHeader("Content-Type","");return a},mMb:function(a,b){wac_b(7135754,352,100,"OnInsert : Got message.");wac_6m(this,this.gq,0);b?this.ira&&0<this.ira.length?(b(this.ira),wac_8vc(this,0)):(wac_b(23078422,352,15,"Empty search result."),this.ejb=!0,b(this.ira),
wac_8vc(this,2)):wac_8vc(this,2)},RPd:function(){this.hF&&(wac_b(7135755,352,100,"OnGetCustomHeaders : Got message."),this.hF.Dx("SetCustomHeaders",{CustomHeaders:""},""))},XPd:function(){this.hF&&(wac_b(7135756,352,100,"OnGetSessionId : Got message."),this.hF.Dx("SetSessionId",{SessionId:wac_.Ag||"00000000-0000-0000-0000-000000000000"},""))},OPd:function(){this.hF&&(wac_b(7135757,352,100,"OnGetCID : Got message."),this.hF.Dx("SetCID",{CID:""},""))}};
function wac_w8c(a){var b=document.getElementById(a);if(!b)throw Error.invalidOperation(String.format("Couldn't get {0}.",a));return b}
function wac_8vc(a,b){var c=/hubble/gi;if(a.Fjc&&0<a.Fjc.search(c)&&a.Nd){var c=wac_.m0,d={};d.InsertedFiles=a.ira.length;d.MediaDetails=a.ira;d.DialogResult=wac_y8c.toString(b);d.DialogMode=3===a.B3e?"Icons":"Images";d.CorrelationId="{"+a.Nd.toString()+"}";d.Platform="Wac";d.Provider=wac_K.QPa.Gkf.toString(a.B3e)||"Unknown";d.AudienceGroup=c&&"AudienceGroup"in c?c.AudienceGroup.toString():"Unknown";d.Ring=c&&"Ring"in c?c.Ring.toString():"Unknown";d.AppId=window.Box4.App.Mg;d.Build=wac_.jv;d.Locale=
wac_nm(wac_.vh)._name;a.Mdb().send(JSON.stringify(d))}if(2===a.B3e&&(c=wac_.pa.Qb.InsertMediaDialogAriaTenantNameSpace)&&""!==c){var d=[],e;Array.add(d,(e=new wac_Cb,e.name="InsertedFiles",e.int64=a.ira.length,e));var f;Array.add(d,(f=new wac_Cb,f.name="MediaDetails",f.string=JSON.stringify(a.ira),f));var g;Array.add(d,(g=new wac_Cb,g.name="DialogResult",g.string=wac_y8c.toString(b),g));var h;Array.add(d,(h=new wac_Cb,h.name="DialogMode",h.string="M365Content",h));var k;Array.add(d,(k=new wac_Cb,
k.name="CorrelationId",k.string=a.Nd.toString(),k));var l;Array.add(d,(l=new wac_Cb,l.name="Provider",l.string="M365Content",l));var m;wac_xra((m=new wac_hca,m.name=String.format("{0}.{1}",c,"InsertM365Images"),m.dataFields=d,m))}}function wac_y8c(){}wac_y8c.prototype={OK:0,cancel:1,error:2,open:3};wac_y8c.registerEnum("Box4.Media.InsertMediaDialog.HubbleAction",!1);function wac_oRb(a,b){this.hLc=a;this.F8=b}wac_oRb.prototype={hLc:null,F8:null,IG:function(){throw Error.notImplemented();}};
function wac_e5(a,b,c){this.dispose=this.O;this.SKc=a;this.yEa=[];this.RKc=b;this.K0b=c.split(";")}
wac_e5.prototype={SKc:null,yEa:null,RKc:null,K0b:null,AUc:!1,Nd:null,o9d:function(a){return this.Nd=a},B3e:0,u5e:function(a){return this.B3e=a},Fjc:null,rEe:function(a){return this.Fjc=a},hSa:function(a,b){Array.clear(this.yEa);a=this.SKc.ma();wac_s7a(a,this.RKc);a.vtb(b.XZa());if(!this.AUc){var c=this;a.Kzd(b.XZa(),function(a){c.mMb(a,b)});this.AUc=!0}wac_b(17838540,352,100,"InsertMediaFromHostDialog::ShowInsertMediaDialog : Sending opening message.");a.Dx(b.LTc(),{FileExtensionFilterList:this.K0b},
"")},mMb:function(a,b){wac_b(17838544,352,100,"InsertMediaFromHostDialog::OnInsert : Got message.");a=b.vBc(a);for(var c=[],d=0;d<a.length;d++){var e=a[d];b.Bbb(e,this.K0b)?Array.add(c,e):(e=b.Exc(e),Array.contains(this.yEa,e)||Array.add(this.yEa,e))}c&&c.length?b.uya(c):wac_b(20509843,352,50,"InsertMediaFromHostDialog::OnInsert : search result is empty");0<this.yEa.length&&(b=this.yEa.join(", "),wac_b(20509844,352,15,"InsertMediaFromHostDialog::OnInsert : Unsupported files {0} were selected.",b),
a=new wac_di,wac_Nh(a,0),wac_fn(a,CommonUIStrings.l_DefaultDialogTitle,String.format(CommonUIStrings.l_OnlinePictureFromHostUnsupportedFiles,b),null))},O:function(){}};function wac_f5(a){this.iLc=a}wac_f5.prototype={iLc:null,IG:function(){return this.iLc}};function wac_g5(){this.pH=document.createElement("iframe");this.pH.src="about:blank";this.pH.style.visibility="hidden";this.pH.style.position="absolute";this.pH.style.zIndex=-100}wac_g5.prototype={pH:null};function wac_h5(){}
wac_h5.prototype={Bbb:function(a,b){if(!a)return!1;for(var c=0;c<b.length;c++)if(0<=a.toLowerCase().indexOf(b[c]))return!0;return!1}};function wac_pRb(a){return(a=wac_qRb.exec(a))&&2<a.length?a[2].trim():""}
function wac_x8c(a){if(!a||!a.Values)return null;a=a.Values;if(!a)return null;var b="";"sourceProvider"in a&&(b=a.sourceProvider||"");var c;return c=new wac_94,c.Action=a.action||"",c.Caption=a.caption||"",c.ContentType=a.contentType||"",c.Type=a.extension||"",c.PageUrl=a.pageUrl||"",c.OriginalUrl=a.sourceUrl||"",c.ContentProvider=b,c.ThumbnailUrl=a.thumbnailUrl||"",c.LicenseUrl=a.licenseUrl||"",c.LicenseDisplayName=a.licenseDisplayName||"",c.Height=a.height||0,c.Width=a.width||0,c.SvgContent=a.svgContent||
"",c}function wac_rRb(a){var b=wac_sRb(window.Box4.App.Mg),c=wac_.jv,d=0<c.indexOf(".")?c.substring(0,c.indexOf(".")):"16";return String.format(a,wac_.vh,wac_.vh,wac_.vh,b,d,c,wac_K.QPa.xKb.toString(1),0,0)}function wac_z8c(a,b,c,d,e){a=wac_sRb(a);var f=wac_nm(wac_.vh)._name;return String.format(b,wac_.vh,f,wac_.jv,d,a,e,1,c)}function wac_sRb(a){switch(a){case 1:a=8;break;case 4:a=3;break;case 2:a=0;break;default:a=0}return a}function wac_tRb(a,b,c,d){this.CKd=a;this.Vyc=b;this.HJb=c;this.Uyc=d}
wac_tRb.prototype={CKd:!1,Vyc:!1,HJb:!1,Uyc:!1};function wac_i5(a){wac_i5.initializeBase(this,[a])}
wac_i5.prototype={LTc:function(){return"UI_InsertFileLink"},XZa:function(){return"Host_InsertFileLink"},vBc:function(a){return a&&a.Values&&"Items"in a.Values?a.Values.Items:null},Exc:function(){wac_fa(21612194,315,!1,"InsertOneDriveFileLinkHelper::GetResultFileType: Method should never be called when for OneDrive files");return""},Bbb:function(){return!0},xOb:function(a,b,c){a=c(a);a.length&&(c={},c.Items=a,b.Dx(this.XZa(),c,""))},xBc:function(a){for(var b=[],c=0;c<a.data.value.length;c++){var d=
a.data.value[c];if(d){var e={};e.DisplayText=d.name;e.Url=d.urls.download;e.sourceUrl=d.urls.download;e.caption=d.name;Array.add(b,e)}}return b},wBc:function(a){for(var b=[],c=0;c<a.data.files.length;c++){var d=a.data.files[c];if(d){var e={};e.DisplayText=String.format("{0}{1}",d.name,d.extension);var f=e;a:{for(var d=[d.urls.viewInBrowser,d.urls.open,d.urls.download],g=0;g<d.length;g++)if(d[g]&&""!==d[g]){d=d[g];break a}wac_b(21764229,352,10,"None of the URLs we received are valid");d=""}f.Url=d;
Array.add(b,e)}}return b}};function wac_9vc(a){this.Ia=a}
wac_9vc.prototype={Ia:null,qLa:2711544537,Mxe:function(a){return this.qLa=a},uya:function(a){try{wac_b(21612191,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",a.length);for(var b=0;b<a.length;b++)this.Ia.Wj(this.qLa,2,a[b],null);wac_b(21612192,352,50,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Insert {0} links.",a.length)}catch(c){wac_b(21612193,352,10,"InsertOneDriveFileLinkHelper::InsertMediaCallback: Exception = [{0}].",c.toString())}}};
function wac_j5(a,b,c){wac_j5.initializeBase(this,[a,b,c])}
wac_j5.prototype={LTc:function(){return"UI_InsertImage"},XZa:function(){return"Host_InsertImage"},vBc:function(a){var b=[];if(a&&a.Values&&a.Values.Items){a=a.Values.Items;for(var c=0;c<a.length;c++){var d=a[c];if(d){var e,d=(e=new wac_94,e.Type=d.Extension||"",e.OriginalUrl=d.SourceUrl||"",e.Caption=d.caption,e.Height=d.Height||0,e.Width=d.Width||0,e);Array.add(b,d)}}}return b},Exc:function(a){return a.Type},Bbb:function(a,b){return this.F8.Bbb(a.Type,b)},xBc:function(a){var b=[];if(a&&a.data&&a.data.value&&
0<a.data.value.length)for(var c=0;c<a.data.value.length;c++)if(a.data.value[c]&&a.data.value[c].urls&&a.data.value[c].urls.download){var d=a.data.value[c],e,d=(e=new wac_94,e.OriginalUrl=d.urls.download,e.Type=d.extension||"",e.Caption=d.name,e.ContentType="",e.Height=d.driveItem||d.driveItem.image?d.driveItem.image.height:0,e.Width=d.driveItem||d.driveItem.image?d.driveItem.image.width:0,e);Array.add(b,d)}b.length||wac_b(26071184,352,10,"InsertOnlineImageHelper::ParseOneDriveV7Response failed since no valid url was found");
return b},wBc:function(a){for(var b=[],c=0;c<a.data.files.length;c++){var d=a.data.files[c];if(d){var e,d=(e=new wac_94,e.ContentType=d.itemType||"",e.Type=d.extension||"",e.OriginalUrl=d.urls&&d.urls.open?d.urls.open:"",e.Height=d.photo?d.photo.height:0,e.Width=d.photo?d.photo.width:0,e);Array.add(b,d)}}return b},xOb:function(a,b,c){c=c(a);if(c.length){a=[];for(var d=0;d<c.length;d++){var e=c[d],f={};f.Extension=e.Type;f.SourceUrl=e.OriginalUrl;f.caption=e.Type;f.SourceUrl=e.OriginalUrl;f.Width=
e.Width;f.Height=e.Height;Array.add(a,f)}c={};c.Items=a;b.Dx(this.XZa(),c,"")}}};function wac_$vc(a,b,c){this.Ia=a;this.F8=b;this.Ugd=c}
wac_$vc.prototype={Ia:null,F8:null,Ugd:null,qLa:4034531111,jR:null,rob:function(){return this.jR||(this.jR=wac_j().H(wac_Zb))},Mxe:function(a){return this.qLa=a},uya:function(a){try{wac_b(21612195,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures.",a.length);var b,c="";if(a)for(var d=0;d<a.length;d++){var e=a[d];e&&(c+=String.format('<img src="{0}" width="{1}" height="{2}"></img>',e.OriginalUrl,e.Width,e.Height))}b=c;c=2;if(b&&0<b.length){var f=new wac_ve;wac_v(f,wac_do,
b);wac_v(f,wac_xo,!0);if(this.Ugd){var g=wac_ORc(this.Ugd);g.p4e.insertOnlineImage=!0;wac_v(f,wac_FGc,g)}wac_q(wac_.pa,"OneNoteExplicitlyNarrateOnInsertingFilesAndImages")&&this.rob().c_b(Box4Intl.Box4Strings.l_ImageUploading,!0);c=this.Ia.Wj(this.qLa,2,f,null)}wac_b(21612224,352,50,"InsertImageFromHostHelper::InsertMediaCallback : Insert {0} pictures success: {1}. pastedHtmlContentIsEmpty: {2}",a.length,32===c,""===b)}catch(h){wac_b(21612225,352,10,"InsertImageFromHostHelper::InsertMediaCallback : Exception = [{0}].",
h.toString())}}};function wac_uRb(a,b){this.tN=a;this.mga=b}
wac_uRb.prototype={tN:null,mga:null,Wd:function(a){var b=this;this.tN.Wd({mode:"open",select:"multi",lightbox:"white"},function(c,d){b.Bna(c,d,a)})},Bna:function(a,b,c){wac_b(22090009,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",a);a&&b&&b.data&&b.data.files&&0<b.data.files.length?(a=this.mga.IG(window.frames[0].parent,window.document.URL),c.xOb(b,a,c.lmd||(c.lmd=Function.createDelegate(c,c.wBc)))):wac_b(22090010,352,100,"OneDriveFilePickerHelperV5::ProcessOneDriveFilePickerResponse : No media to insert.")}};
function wac_k5(a,b,c){this.Sja=Function.createDelegate(this,this.xma);this.tN=a;this.mga=c;var d=this;this.WJ=new (wac_f.$$(wac_nc.$$(wac_sc)))(function(){return new (wac_9P.$$(wac_sc))(b.ma(),d.Sja)})}
wac_k5.prototype={tN:null,mga:null,TW:null,yl:null,WJ:null,mFa:function(){this.TW||(this.WJ.ma().XU("InsertFromOneDrive",!0),this.yl&&this.yl.BI&&this.yl.BI.length&&(this.TW=this.OHb(this.yl.BI)));return this.TW},OHb:function(a){a=a.toLowerCase();a.endsWith("/")||(a+="/");var b=a.indexOf("/documents/");return-1!==b?a.substring(0,b+1)+"_layouts/15/onedrive.aspx":""},xma:function(a){this.yl||3!==a.kg()||(this.yl=a)},Wd:function(a){if(!this.mFa())if(wac_.oca&&wac_.oca.length)this.TW=wac_.oca;else{wac_b(26071185,
352,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",!this.yl);return}var b=new wac_vRb;b.GQb();var c=b.QHb();if(c){var d=this,e=this;this.tN.Wd(function(c,e){b.fd();d.Bna(c,e,a)},function(){e.KLb(b)},c,this.TW)}else wac_b(26071186,352,10,"Picker container is null, will not show picker.")},KLb:function(a){a.fd();wac_b(26071187,352,50,"User cancelled to insert picture from onedrive.")},Bna:function(a,b,c){wac_b(26071188,
352,50,"OneDriveFilePickerHelperV7::ProcessOneDriveFilePickerResponse : Response received. IsSuccess: {0}.",a);a&&b&&b.data&&b.data.value&&0<b.data.value.length?(a=this.mga.IG(window.frames[0].parent,window.document.URL),c.xOb(b,a,c.mmd||(c.mmd=Function.createDelegate(c,c.xBc)))):wac_b(24134243,352,50,"Response from the OneDriveFilePicker was empty. No media to insert")}};function wac_vRb(){wac_vRb.initializeBase(this,[!1,!1,!1,!1])}
wac_vRb.prototype={GQb:function(){this.jUa="FilePickerDialog";this.po="<div class='FilePickerDiv' id='OpenFilePickerDiv'></div>";this._id="PickerDialog-Livebooks";this.Hm("",null)},QHb:function(){return document.getElementById("OpenFilePickerDiv")},qu:function(){},Pda:function(){}};function wac_wRb(){}
wac_wRb.prototype={sa:null,Njb:null,Ub:function(){return"Box4.Media"},gc:function(a){this.sa=a;if(wac_P().K(99)){wac_m(wac_n(wac_o(a.fa(wac_g5),wac_84)),function(){return new wac_g5});var b=new wac_tRb(Boolean.parse(wac_.pa.Qb.InsertOnlinePictureEnabled||"false"),wac_33a(),wac_q(wac_.pa,"OneNoteInsertOneDriveFileIsEnabled"),wac_Q1());if(Boolean.parse(wac_.pa.Qb.OneNoteInsertOneDriveFileIsEnabled||"false")){var c=wac_rP(wac_oc.$$(wac_sc),wac_l(a,wac_oc.$$(wac_sc)));wac_m(wac_n(wac_o(a.fa(wac_k5),wac_44)),
function(){return new wac_k5(a.H(wac_zQ),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_Qb(c)}),a.H(wac_54))})}else wac_m(wac_n(wac_o(a.fa(wac_uRb),wac_44)),function(){return new wac_uRb(a.H(wac_uQ),a.H(wac_54))});wac_m(wac_n(a.fa(wac_$4)),function(){return new wac_$4(wac_z(),wac_.pa,b,a.H(wac_44),a.H(wac_g5),a.H(wac_sD),a.H(wac_64),a.H(wac_74),a.H(wac_h5),a.H(wac_j5),a.H(wac_i5),wac__g,wac_.rC,wac_Ufa,wac_.pa.Qb.InsertPictureServiceEndpoint,wac_.pa.Qb.InsertPictureTelemetryEndpoint)});wac_m(wac_n(wac_o(a.fa(wac_oRb),
wac_64)),function(){return new wac_oRb(a.H(wac_54),a.H(wac_h5))});wac_m(wac_n(wac_o(a.fa(wac_f5),wac_74)),function(){return new wac_f5(a.H(wac_e5))});wac_m(wac_n(a.fa(wac_e5)),function(){return new wac_e5(new (wac_f.$$(wac_2a))(function(){var a;wac_Q1()?(a=wac_j().H(wac_84).pH,a=new wac_c5(a.contentWindow,"*")):a=wac_.KIb;return a}),wac_Q1()?wac_Jh(window.document.URL,0):wac_Jh(wac_.cRa,0),wac_.pa.Qb.ImageFetcherSupportedExtensions)});wac_n(wac_o(a.fa(wac_mRb),wac_54));wac_n(a.fa(wac_h5));wac_m(wac_n(a.fa(wac_j5)),
function(){return new wac_j5(wac_z(),a.H(wac_h5),a.H(wac_uzc))});wac_m(wac_n(a.fa(wac_i5)),function(){return new wac_i5(wac_z())})}},tb:function(){wac_P().K(99)&&(this.Njb=this.sa.H(wac_$4),this.Njb.Tb())},O:function(){this.Njb&&this.Njb.O()}};wac_94.registerClass("Box4.Media.OnlineMediaSearchResult");wac_$4.registerClass("Box4.Media.InsertMediaActor",null,Sys.IDisposable);wac_a5.registerClass("Box4.Media.InsertMediaCrossDocumentMessenger",wac_EQ,wac_jRb,Sys.IDisposable);
wac_c5.registerClass("Box4.Media.InsertMediaFromOneDriveCrossDocumentMessenger",wac_EQ,wac_2a,wac_1a,Sys.IDisposable);wac_mRb.registerClass("Box4.Media.InsertMediaCrossDocumentMessengerFactory",null,wac_54);wac_d5.registerClass("Box4.Media.InsertMediaDialog",wac__m,wac_kRb,Sys.IDisposable);wac_oRb.registerClass("Box4.Media.InsertMediaDialogFactory",null,wac_64);wac_e5.registerClass("Box4.Media.InsertMediaFromHostManager",null,wac_kRb,Sys.IDisposable);
wac_f5.registerClass("Box4.Media.InsertMediaFromHostManagerFactory",null,wac_74,wac_64);wac_g5.registerClass("Box4.Media.InsertMediaFromHostOneDriveHostFrame",null,wac_84);wac_h5.registerClass("Box4.Media.InsertMediaHelper",null,wac_gRb);wac_tRb.registerClass("Box4.Media.InsertMediaSettingsManager");wac_9vc.registerClass("Box4.Media.InsertOneDriveFileHandler",null,wac_7vc);wac_i5.registerClass("Box4.Media.InsertOneDriveFileHelper",wac_9vc,wac_iRb,wac_7vc);
wac_$vc.registerClass("Box4.Media.InsertOnlineImageHandler",null,wac_7vc);wac_j5.registerClass("Box4.Media.InsertOnlineImageHelper",wac_$vc,wac_iRb,wac_7vc);wac_uRb.registerClass("Box4.Media.OneDriveFilePickerHelperV5",null,wac_44);wac_k5.registerClass("Box4.Media.OneDriveFilePickerHelperV7",null,wac_hRb,wac_44);wac_vRb.registerClass("Box4.Media.PickerDialog",wac__m,wac_lRb);(function(){}).registerClass("Box4.Media.Program");wac_wRb.registerClass("Box4.Media.MediaPackage",null,wac_I,wac_i);(function(){}).registerClass("Box4.Media.InsertMediaDialogHtml");
(function(){}).registerClass("Box4.Media.InsertMediaM365DialogHtml");var wac_qRb=/<iframe\s(.*\s)*src=[\"|'](.*?)[\"|'].*\/(iframe)?>/im,wac_nRb="<div class='InsertMediaDialog' id='insertmediadialog'> <div class='InsertMediaPanel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>";wac_J(wac_C(),new wac_wRb,0,!1);Type.registerNamespace("Common.App.AppsForOfficeCommon");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};
wac_d.Qa.Bxd=wac_d.Qa.Bxd||{};function wac_A8c(){}wac_A8c.registerInterface("Common.App.AppsForOfficeCommon.IAppsForOfficeUIActor");function wac_B8c(){this.jNf=330;this.iNf=this.fNf=null;this.kvf={};this.qMf=null;this.iMf=this.eMf=!1}wac_B8c.prototype={jNf:0,fNf:null,iNf:null,kvf:null,qMf:null,eMf:!1,iMf:!1};wac_B8c.registerClass("Common.App.AppsForOfficeCommon.FirstPartyAddInOptionalParameters");Type.registerNamespace("Box4.Dictation");wac_K=window.Box4||{};wac_K.XOe=wac_K.XOe||{};
window.Box4.Dictation.IVoiceCommandHandler=wac_K.XOe.CYf=function(){};window.Box4.Dictation.IVoiceCommandHandler.registerInterface("Box4.Dictation.IVoiceCommandHandler");(function(){}).registerInterface("Box4.Dictation.IAnnotationObserver");function wac_C8c(){}wac_C8c.registerInterface("Box4.Dictation.IDictationActor");function wac_D8c(){}wac_D8c.registerInterface("Box4.Dictation.IDictationHost");function wac_E8c(){}wac_E8c.registerInterface("Box4.Dictation.IWoncaDictationHost");
function wac_F8c(){}wac_F8c.registerInterface("Box4.Dictation.IDictationHostFactory");function wac_G8c(){}wac_G8c.registerInterface("Box4.Dictation.ISpeechClientProxy");wac_K.XOe.Gzf=function(){};wac_K.XOe.Gzf.prototype={};wac_K.XOe.Gzf.registerEnum("Box4.Dictation.StartDictationError",!1);function wac_H8c(){this.Duration=this.Offset=0}
function wac_I8c(a,b,c,d,e,f,g){this.sRe=e;this.ZHb=new wac_r7(a,f,d);this.F4e=new wac_J8c(new wac_K8c(b,f,this.sRe),b,d);this.fX=g;wac_L8c(this.fX)&&(this.Fof=!0);this.gAf=c;this.U9e=window.augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();this.rmf=Array(this.gAf);var h,k=this;this.U9e.setAnnotationResultCallback((h=new wac_eEc,h.handler=function(a){for(var b=k.rmf,c=b.length,d=0;d<c;++d)b[d].czf(a)},h));this.Q2e=new window.alVoiceClient.SpeechToTextClient(this.U9e,this.ZHb,this.Fof,!1);this.G4e=
new window.alVoiceClient.VoiceCommandingClient(this.U9e,this.F4e);wac_M8c(this,this.Q2e.getAnnotationObserver());wac_M8c(this,this.G4e.getAnnotationObserver())}
wac_I8c.prototype={eaf:null,Q2e:null,ZHb:null,G4e:null,Fia:null,sRe:null,U9e:null,F4e:null,a$e:"",Fof:!1,fX:null,rmf:null,FXf:0,gAf:0,Ekf:function(a,b){var c=this;return new Promise(function(d){c.Fia=b;c.F4e.setDictationSessionTelemetry(c.Fia);c.eaf=new window.alVoiceClient.VoiceSession(c.U9e,c.Fof,c.Fia,c.sRe,c.ZHb);c.a$e=a;d(0)})},v2e:function(a){if(!this.Q2e)return 3;this.eaf.startVoiceSessionFromMicrophoneInput(this.a$e,this.fX&&this.fX.E4e?"Intelligent":"Explicit","true");this.ZHb.w2e(this.Fia,
a);this.Q2e.checkAnnotationActive()||this.Q2e.initializeAsync(this.Fia);this.G4e&&!this.G4e.checkAnnotationsActive()&&this.G4e.initializeAsync(this.Fia);return 0},O5b:function(a){if(3!==this.bob()){if(a&&this.ZHb)this.ZHb.onSpeechEnd();this.Q2e&&this.Q2e.checkAnnotationActive()&&this.Q2e.uninitializeAsync();this.eaf&&(this.eaf.stopVoiceSession(),this.eaf=null);this.Fia=null;this.G4e&&this.G4e.uninitializeAsync()}},bob:function(){return this.ZHb.bob()}};function wac_M8c(a,b){a.rmf[a.FXf++]=b}
window.Box4.Dictation.IWordVoiceCommand=wac_K.XOe.FQf=function(){};wac_K.XOe.FQf.prototype={commandId:"",commandValue:null,offset:0,duration:0};
function wac_K8c(a,b,c){this.setDictationSessionTelemetry=this.SetDictationSessionTelemetry;this.D7b=a;this.I7a=b;this.sRe=c;this.k9c=new (wac_gb.$$(String,wac_K.hkf))(wac_$a());this.k9c.ga("Word.Editing.Undo",2);this.k9c.ga("Word.Editing.Bold",7);this.k9c.ga("Word.Editing.Italics",8);this.k9c.ga("Word.Editing.Delete",3);this.k9c.ga("Word.Editing.Paste",9);this.k9c.ga("Word.Editing.InsertTable",10);this.k9c.ga("Word.Editing.InsertComment",11);this.k9c.ga("Word.Editing.FullJustify",24);this.k9c.ga("Word.Editing.CenterJustify",
25);this.k9c.ga("Word.Editing.LeftJustify",26);this.k9c.ga("Word.Editing.RightJustify",27)}wac_K8c.prototype={D7b:null,k9c:null,I7a:null,Mmf:null,sRe:null};wac_K8c.prototype.Gbf=function(a){this.Mmf&&(this.Mmf.uAf=!0);var b=6,c,d;(d=this.k9c.qg(a.commandId,c={val:b}),b=c.val,d)&&6!==b&&(c=null,a.commandValue&&(c=new (wac_gb.$$(String,Object))(wac_$a()),c.ga("commandValue",a.commandValue)),this.I7a.N2d(!1),b=this.D7b.Tk(b,c),a.offset&&a.duration&&this.sRe.IYf(a.commandId,b,a.offset,a.duration))};
wac_K8c.prototype.onVoiceCommand=wac_K8c.prototype.Gbf;wac_K8c.prototype.$Uf=function(a){this.Mmf=a};wac_K8c.prototype.SetDictationSessionTelemetry=wac_K8c.prototype.$Uf;function wac_G7(a,b){wac_G7.initializeBase(this,[a,b]);this.HRe=new wac_17(a,b)}wac_G7.prototype={HRe:null,w2e:function(a,b){this.HRe.w2e(a,b)},bob:function(){return this.HRe.bob()}};wac_G7.prototype.Bbf=function(a,b){this.HRe.onFinalText(a,b)};wac_G7.prototype.onFinalText=wac_G7.prototype.Bbf;
wac_G7.prototype.Cbf=function(a,b){this.HRe.onFragmentText(a,b)};wac_G7.prototype.onFragmentText=wac_G7.prototype.Cbf;wac_G7.prototype.J4c=function(a){this.HRe.onError(a)};wac_G7.prototype.onError=wac_G7.prototype.J4c;wac_G7.prototype.Fbf=function(a){this.HRe.onSpeechRecognitionStarted(a)};wac_G7.prototype.onSpeechRecognitionStarted=wac_G7.prototype.Fbf;wac_G7.prototype.Ebf=function(){this.HRe.onSpeechEnd()};wac_G7.prototype.onSpeechEnd=wac_G7.prototype.Ebf;wac_G7.prototype.zbf=function(a){this.HRe.onAudioData(a)};
wac_G7.prototype.onAudioData=wac_G7.prototype.zbf;function wac_r7(a,b,c){wac_r7.initializeBase(this,[a,b]);this.Fa=c}wac_r7.prototype={Fa:null,w2e:function(a,b){wac_G7.prototype.w2e.call(this,a,b)},bob:function(){return wac_G7.prototype.bob.call(this)},Mkf:function(){var a=this.Fa.wb().kb().La();return a.Nb!==a.Na?!1:!0}};wac_r7.prototype.Bbf=function(a,b){wac_G7.prototype.onFinalText.call(this,a,b)};wac_r7.prototype.onFinalText=wac_r7.prototype.Bbf;
wac_r7.prototype.Cbf=function(a,b){this.Mkf()&&wac_G7.prototype.onFragmentText.call(this,a,b)};wac_r7.prototype.onFragmentText=wac_r7.prototype.Cbf;wac_r7.prototype.J4c=function(a){wac_G7.prototype.onError.call(this,a)};wac_r7.prototype.onError=wac_r7.prototype.J4c;wac_r7.prototype.Fbf=function(a){var b=wac_5k().toString();wac_G7.prototype.onSpeechRecognitionStarted.call(this,a?a:b)};wac_r7.prototype.onSpeechRecognitionStarted=wac_r7.prototype.Fbf;wac_r7.prototype.Ebf=function(){wac_G7.prototype.onSpeechEnd.call(this)};
wac_r7.prototype.onSpeechEnd=wac_r7.prototype.Ebf;wac_r7.prototype.zbf=function(a){wac_G7.prototype.onAudioData.call(this,a)};wac_r7.prototype.onAudioData=wac_r7.prototype.zbf;function wac_N8c(a){this.F4e=a}wac_N8c.prototype={F4e:null};wac_N8c.prototype.Gbf=function(a){this.F4e.onVoiceCommand(a)};wac_N8c.prototype.onVoiceCommand=wac_N8c.prototype.Gbf;wac_N8c.prototype.esf=function(a){this.F4e.setDictationSessionTelemetry(a)};wac_N8c.prototype.setDictationSessionTelemetry=wac_N8c.prototype.esf;
function wac_J8c(a,b,c){wac_J8c.initializeBase(this,[a]);this.D7b=b;this.Fa=c}wac_J8c.prototype={D7b:null,Fa:null,Mkf:function(){var a=this.Fa.wb().kb().La();return a.Nb!==a.Na?!1:!0}};wac_J8c.prototype.Gbf=function(a){this.Mkf()&&this.D7b.VYf();wac_N8c.prototype.onVoiceCommand.call(this,a)};wac_J8c.prototype.onVoiceCommand=wac_J8c.prototype.Gbf;wac_J8c.prototype.esf=function(a){wac_N8c.prototype.setDictationSessionTelemetry.call(this,a)};wac_J8c.prototype.setDictationSessionTelemetry=wac_J8c.prototype.esf;
function wac_O8c(){wac_P8c(Box4Intl.Box4Strings.L_DictationUnknownErrorMessage)}function wac_P8c(a){var b=Box4Intl.Box4Strings.L_DictationErrorDialogTitle;wac_Q8c||(wac_Q8c=new wac_di,wac_Q8c.wr=wac_.kyd,wac_Nh(wac_Q8c,0),wac_Oh(wac_Q8c,1,CommonUIStrings.l_DialogClose),wac_fn(wac_Q8c,b,a,function(){wac_Q8c=null}))}
function wac_R8c(a,b,c,d,e,f,g,h,k){this.bJf=Function.createDelegate(this,this.XRf);this.eJf=Function.createDelegate(this,this.bSf);this.sJf=Function.createDelegate(this,this.LSf);this.WIf=Function.createDelegate(this,this.RRf);this.jLf=Function.createDelegate(this,this.LVf);this.oKf=Function.createDelegate(this,this.rUf);this.gLf=Function.createDelegate(this,this.IVf);this.Atf=Function.createDelegate(this,this.hVf);this.cKf=Function.createDelegate(this,this.dUf);this.MKf=Function.createDelegate(this,
this.aVf);this.gJf=Function.createDelegate(this,this.eSf);this.XIf=Function.createDelegate(this,this.SRf);this.ZIf=Function.createDelegate(this,this.URf);this.aJf=Function.createDelegate(this,this.WRf);this.$If=Function.createDelegate(this,this.VRf);this.YIf=Function.createDelegate(this,this.TRf);this.VIf=Function.createDelegate(this,this.QRf);this.bKf=Function.createDelegate(this,this.cUf);this.iLf=Function.createDelegate(this,this.KVf);this.fKf=Function.createDelegate(this,this.iUf);this.LKf=Function.createDelegate(this,
this.ZUf);this.rtf=Function.createDelegate(this,this.MTf);this.Ia=a;this.dFc=window.Box4.App.$3e;this.b$e=window.Box4.App.azc;this.$Va=c;this.Cff=b;this.tk=d;this.r8=e;this.fX=g;this.nd=k;wac_S8c(this.fX)&&(this.K$c=f);this.jAf=h}
function wac_T8c(a,b,c,d){var e;c=(e=new wac_jf,e.DisplayMode="Menu",e.Title=c,e.Id=b,e.ControlsId="ctr"+b,e.ControlList=[],e);e=a.length;for(var f=0;f<e;++f){var g=a[f],h=b+"_"+g.Q6e,k=g.KBa,g=g.Q6e;if(d)var l,h=(l=new wac_lf,l.Id=h,l.ExternalId=h,l.LabelText=k,l.Command="3662249320",l.MenuItemId=g,l.Visible=!0,l);else var m,h=(m=new wac_3l,m.Id=h,m.ExternalId=h,m.LabelText=k,m.Command="2863762275",m.MenuItemId=g,m.QueryCommand="2739750502",m.Visible=!0,m.AriaLabel="menuitemradio",m);Array.add(c.ControlList,
h)}return c}
wac_R8c.prototype={Ia:null,dFc:null,b$e:null,dff:null,$Va:null,bBf:!1,Cff:null,jAf:null,nd:null,tk:null,r8:null,K$c:null,fX:null,i7e:!1,Tb:function(){this.Ia.jf(1546254036,2,this.rtf,96);this.Ia.jf(2863762275,2,this.LKf,1028);this.Ia.jf(2739750502,2,this.fKf,96);this.Ia.jf(1394650145,2,this.iLf,1028);this.Ia.jf(2417470717,2,this.bKf,96);this.Ia.jf(3414281623,2,this.VIf,64);this.Ia.jf(3876366013,2,this.YIf,64);this.Ia.jf(2652766343,2,this.$If,64);this.Ia.jf(44849047,2,this.aJf,64);this.Ia.jf(3884109240,2,
this.ZIf,64);this.Ia.jf(3338844071,2,this.XIf,64);this.Ia.jf(2363463409,2,this.gJf,64);this.Ia.jf(3836866597,2,this.rtf,96);this.Ia.jf(3662249320,2,this.MKf,1028);this.Ia.jf(569982264,2,this.cKf,96);this.Ia.jf(3819824931,2,this.Atf,96);this.Ia.jf(2729830074,2,this.Atf,96);this.Ia.jf(992784617,2,this.gLf,96);this.Ia.jf(1118940415,2,this.oKf,96);this.Ia.jf(484367180,2,this.jLf,1028);this.Ia.jf(989476214,2,this.WIf,1028);this.Ia.jf(1422174542,2,this.sJf,96);this.Ia.jf(667456221,2,this.eJf,96);var a=
wac_A(192,1);this.nd.xc("main").Ba(a,1219645939);this.Ia.jf(1219645939,2,this.bJf,1028)},cUf:function(a,b,c,d,e){if(1===c)return 32;e&&(a=!!wac_r()&&wac_r().Hd().Bg(),this.K$c?e.On=this.K$c.N3e():(c=this.$Va.bob(),c=(b=2===c)||1===c,a?(e.On=c,e[wac_$8a.IconSet]=b?(new wac_21b("JotInsertAudioRecordingShort_20",null,null,null)).wXc:(new wac_21b("InsertAudio_20",null,null,"InsertAudio_32")).wXc):(e.On=c,b?(e.Image32by32Class=wac_9h(wac_U8c),e.Image16by16Class=wac_9h(wac_V8c)):(e.Image32by32Class=wac_9h(wac_W8c),
e.Image16by16Class=wac_9h(wac_X8c)))));return 32},KVf:function(a,b,c){if(2===c)if(this.K$c)wac_Y8c(this);else return wac_Z8c(this);return 32},LVf:function(a,b,c){return 2!==c?32:wac_Z8c(this)},amf:function(){var a=wac_l(wac_j(),wac_Dc);a&&a.uc(function(a){a.lCe("DictationV2Used","DictationV2FloodGateSurveyIsEnabled")})},MTf:function(a,b,c,d,e){if(1===c)return 32;a=3836866597===a;var f;e.MenuItems=(f=new wac_if,f.Id=a?"DictationSettingsLanguageList":"DictationLanguageList",f.MenuSectionList=[],f.UpdateDynamically=
!0,f);if(!a){var g;f=(g=new wac_jf,g.Title="",g.ShowMenuSectionSeparator=!0,g.DisplayMode="Menu",g.Id="dictationButton",g.ControlsId="ctrDictationButton",g.ControlList=[],g);var h;g=(h=new wac_3l,h.Id="DictationLanguageList_"+wac__8c(this),h.ExternalId="DictationLanguageList_"+wac__8c(this),h.LabelText=Box4Intl.Box4Strings.L_DictationRibbonLabel,h.Command="1394650145",h.MenuItemId=wac__8c(this),h.QueryCommand="2417470717",h.Image16by16Class=wac_9h(wac_X8c),h.Image32by32Class=wac_9h(wac_W8c),h.Visible=
!0,h.AriaLabel="toggle",h);Array.add(f.ControlList,g);Array.add(e.MenuItems.MenuSectionList,f)}h=this.$Va.Z5e(0);0<h.length&&(h=wac_T8c(h,"dictationProdcutionLanguages","",a),Array.add(e.MenuItems.MenuSectionList,h));h=this.$Va.Z5e(1);0<h.length&&(h=wac_T8c(h,"dictationPreviewLanguages",Box4Intl.Box4Strings.L_DictationPreviewLanguages,a),Array.add(e.MenuItems.MenuSectionList,h));e.PopulationXML=wac_hm(e.MenuItems);this.bBf=!0;return 32},iUf:function(a,b,c,d,e){if(1===c)return 32;e&&((a=e.MenuItemId)&&
a===wac_08c(this.$Va)?(e.On=!0,this.dff=e.SourceControlId):e.On=!1);return 32},dUf:function(a,b,c,d,e){if(1===c)return 32;e&&(e[wac_DS.Value]=(new wac_18c(wac_08c(this.$Va))).KBa);return 32},ZUf:function(a,b,c,d,e){if(1===c)return 32;if(e&&(a=e.SourceControlId,this.dff!==a)){if(e=e.MenuItemId)this.$Va.Pze=e;wac_28c(this,this.dff);wac_28c(this,a);this.dff=a;2===this.$Va.bob()&&(this.$Va.O5b(!0),wac_38c(this))}return 32},aVf:function(a,b,c,d,e){if(1===c)return 32;e&&(a=e.MenuItemId,wac_08c(this.$Va)!==
a&&(a&&(this.$Va.Pze=a),this.K$c&&(this.K$c.Pze=a),2===this.$Va.bob()&&(this.$Va.O5b(!0),wac_38c(this))));return 32},hVf:function(a,b,c,d,e){if(1===c)return 32;a=this.jAf.ma();if(!a)return 0;if(e){e={};e.query="AssetID="+wac_48c;var f;e=(f=new wac_B8c,f.kvf=e,f);a.TYf(wac_58c,e,!1)}return 32},IVf:function(a,b,c,d,e){if(1===c)return 32;e&&this.fX&&(a=this.fX,a.E4e=e.On,wac_a4c().URa("WACDictationFUseAutoPunctuation",a.E4e.toString()));2===this.$Va.bob()&&(this.$Va.O5b(!0),wac_38c(this));this.Cff.ma().r6e({DictationSettingsAutoPunctuation:"CheckboxModel"});
return 32},rUf:function(a,b,c,d,e){if(1===c)return 32;e&&this.fX&&(e.On=this.fX.E4e);return 32},RRf:function(a,b,c){2===c&&wac_68c(this);return 32},LSf:function(a,b,c){2===c&&wac_S8c(this.fX)&&2===this.$Va.bob()&&this.O5b();return 32},bSf:function(a,b,c){2===c&&wac_S8c(this.fX)&&wac_68c(this);return 32},QRf:function(a,b,c){2===c&&(this.$Va.O5b(!0),wac_38c(this));return 32},TRf:function(a,b,c){2===c&&(this.$Va.O5b(!0),wac_38c(this));return 32},eSf:function(a,b,c){2===c&&(this.$Va.O5b(!0),wac_38c(this));
return 32},VRf:function(a,b,c){2===c&&wac_38c(this);return 32},WRf:function(a,b,c){2===c&&(this.$Va.O5b(!1),wac_38c(this));return 32},URf:function(a,b,c,d,e){2===c&&e&&(a=wac_nm(wac_08c(this.$Va)),this.tk.Yza(wac_tu(e),a.Pn,e.Nb,!1,!0));return 32},SRf:function(a,b,c){2===c&&(this.$Va.O5b(!0),wac_38c(this));return 32},sea:function(){var a=this,b=this;this.K$c.sea((new wac_18c(wac_08c(this.$Va))).KBa).then(function(){a.$Va.bob()||a.$Va.v2e().then(function(){a.i7e=!1}).catch(function(b){a.i7e=!1;wac_b(38102926,
394,10,"Failed to start dictation {0}",b)});wac_S8c(a.fX)&&a.dFc&&wac_i8c(a.dFc);a.b$e&&a.b$e.pef()}).catch(function(){b.i7e=!1})},O5b:function(){this.$Va.O5b(!0);wac_38c(this);this.K$c&&this.amf()},v2e:function(){this.$Va.v2e().then(function(){}).catch(function(a){wac_b(42231884,394,10,"Failed to start dictation {0}",a)})},XRf:function(a,b,c){return 2!==c?32:this.fX&&wac_S8c(this.fX)&&this.K$c&&!this.K$c.N3e()?(wac_Y8c(this),32):wac_Z8c(this)}};
function wac_68c(a){var b=a.$Va.bob();if(1!==b){if(a.K$c){var c=a.K$c;c.J2e&&c.Bnc&&(c.Bnc.cOf(),wac_3j(wac_qg(),"dictation"),c.J2e=!1)}if(a.dFc){c=a.dFc;c.Dye.aNe=!1;var d=window.Box4.App.zb().Zc.ik.um();if(d)for(var d=wac_qy(d),e=c.L$e.GetEnumerator();e.$$mn();){var f=e.$$cu();if((f=d.xf(f))&&wac_Yv(f)&&f)for(var g=0;g<f.OA.na();g++){var h=f.OA.K(g);h.hpb&&wac_sQc(h,null);wac_ELc(h)&&wac_tQc(h,!1)}}c.X9e.ie();c.L$e.ie();c.Fia.mkf()}2===b&&a.O5b();a.b$e&&a.b$e.mkf();wac_38c(a)}}
function wac_Z8c(a){var b=a.$Va.bob();if(1===b||3===b)return 1;b?a.O5b():a.v2e();return 32}function wac_Y8c(a){a.i7e||(a.i7e=!0,a.K$c.N3e()?(wac_68c(a),a.i7e=!1):a.sea(),wac_38c(a))}function wac_28c(a,b){if(a=a.Cff.ma())if(wac_r()&&wac_r().Hd().Bg()){var c={};c[b]="ToggleButtonModel";a.r6e(c)}else a.z2e(b)}
function wac_38c(a){var b=a.Cff.ma();if(b){var c=wac__8c(a);if(wac_r()&&wac_r().Hd().Bg()){var d={};d[c]=wac_S8c(a.fX)?"ToggleButtonModel":"SplitButtonModel";a.bBf&&!wac_S8c(a.fX)&&(d["DictationLanguageList_"+c]="ToggleButtonModel");b.r6e(d)}else b.z2e(c),b.z2e("DictationLanguageList_"+c)}}function wac__8c(a){return wac_r()&&wac_r().Hd().Bg()?wac_S8c(a.fX)?wac_78c:wac_88c:wac_S8c(a.fX)?wac_98c:wac_$8c}function wac_a9c(a,b){this.GAf=a;this.fX=b}
wac_a9c.prototype={GAf:null,Bnc:null,fX:null,J2e:!1,Pze:null,N3e:function(){return this.J2e},sea:function(a){if(this.J2e)return Promise.resolve(null);if(!wac_b9c(this))return Promise.reject("Unable to find the dictation floatie controller");var b=this;return new Promise(function(c,d){b.Bnc.DYf().then(function(){b.Bnc.eVf(b.sfe(),!1,a,b.fX.E4e);b.Pze=a;b.J2e=!0;wac_2j(wac_qg(),"dictation");c(null)}).catch(function(){d("failed to intialize the floatie")})})},sfe:function(){var a=window.Box4.App.zb().vR.getBoundingClientRect(),
b=a.left+a.width/2-44,a=a.top+a.height-70,c;return c=new window.Common.IPoint,c.x=b,c.y=a,c}};
function wac_b9c(a){if(a.Bnc)return!0;a.Bnc=a.GAf.ma();if(!a.Bnc)return!1;a.Bnc.RYf(484367180);a.Bnc.QYf(989476214);wac_tf(window.self,"resize",function(){a.J2e&&a.Bnc&&(a.Bnc.cOf(),a.Bnc.eVf(a.sfe(),!1,a.Pze,a.fX.E4e))});var b=wac_Ie().xc("dictation");wac_mk(b,function(){a.J2e&&a.Bnc&&a.Bnc.zdf()});wac_ok(b,function(b,d){a.J2e&&a.Bnc&&"ReactTransientUI"!==d.Kd&&a.Bnc.oYf()});wac_1j(wac_qg(),"dictation",!0);wac_3j(wac_qg(),"dictation");return!0}
function wac_18c(a){this.Q6e=a;this.KBa=(a=wac_nm(a))?a.wX():this.Q6e;this.Pn=a?a.Pn:wac_c9c}wac_18c.prototype={Q6e:null,KBa:null,Pn:0};function wac_d9c(a,b,c,d,e,f,g,h,k,l,m,n){this.Pze="";this.uje=a;this.HAf=b;this.yXb=c;this.Fa=d;this.jxe=e;this.Tf=f;this.fX=g;this.qBe=n;wac_S8c(this.fX)&&(this.OJc=h);if(wac_S8c(this.fX)||wac_e9c(this.fX)||wac_L8c(this.fX))this.D7b=k,this.y6e=l;this.sRe=m}
wac_d9c.prototype={Pze:null,uje:null,P2e:null,HAf:null,Fia:null,sRe:null,yXb:null,Fa:null,jxe:null,Tf:null,fX:null,OJc:null,D7b:null,y6e:null,qBe:null,v2e:function(){this.jxe&&this.jxe.uc(function(a){if(a.F2e){var c;wac_Fgb(a,c={val:a.F2e},27,!1,"");a.F2e=c.val}});var a=this;return new Promise(function(b,c){a.P2e?wac_f9c(a,b,c):wac_g9c(a).then(function(){var d=a.HAf.ma();if(d){var d=new wac_h9c(d.Vha,d.ha,d.U),e=new wac_C9(d,wac_i9c(a),wac_z(),a.jxe,a.fX,a.D7b,a.y6e,a.OJc),d=wac_e9c(a.fX)||wac_L8c(a.fX)?
new wac_I8c(a.OJc,a.D7b,2,a.Fa,a.sRe,e,a.fX):wac_j9c(a.fX)?new wac_k9c(d,a.fX,a.OJc,e,a.qBe):new wac_l9c(0,wac_i9c(a),wac_z(),0,a.fX,e,a.qBe);a.P2e=d;wac_f9c(a,b,c)}else c(4)}).catch(function(){c(2)})})},w2e:function(){var a=this;return new Promise(function(b,c){a.Fia=new wac_m9c(wac_08c(a),a.Tf,wac_j9c(a.fX),wac_e9c(a.fX)||wac_L8c(a.fX));a.P2e.Ekf(wac_08c(a),a.Fia).then(function(c){c?b(c):b(a.P2e.v2e(wac_i9c(a)))}).catch(function(a){c(a)})})},O5b:function(a){this.bob()&&(this.P2e&&this.P2e.O5b(a),
this.Fia&&(this.Fia.K0d(),this.Fia=null))},bob:function(){return this.P2e?this.P2e.bob():0},Z5e:function(a){var b=a?wac_n9c:wac_o9c,c=b.length;1===a&&wac_p9c(this.fX)&&c++;var c=Array(c),d;for(d=0;d<b.length;d++)c[d]=new wac_18c(b[d]);1===a&&wac_p9c(this.fX)&&(c[d]=new wac_18c(wac_q9c),d++);c.sort(function(a,b){return a.KBa.localeCompare(b.KBa)});return c}};function wac_i9c(a){return"zh-CN"!==wac_08c(a)&&"ja-JP"!==wac_08c(a)}
function wac_r9c(a,b){a.uje?a=a.uje.MRd(b):(a=wac_af(b,2),a=wac_Ll(a),wac_ul(a),a=wac_Jca.toPromise$o(wac_2gc(a)));return a}function wac_g9c(a){return wac_e9c(a.fX)||wac_L8c(a.fX)?wac_r9c(a,"alVoiceClient"):wac_j9c(a.fX)?wac_r9c(a,"PPTSpeechClient"):wac_r9c(a,"speechClient")}function wac_f9c(a,b,c){a.w2e().then(function(a){a?c(a):b(0)}).catch(function(a){c(a)})}
function wac_08c(a){if(""===a.Pze){var b;a:{if(a.yXb&&a.Fa){b=wac__zb(a.yXb,a.Fa.xh());for(var c=a.Z5e(0),d=0;d<c.length;d++)if(c[d].Pn===b){b=c[d].Q6e;break a}c=a.Z5e(1);for(d=0;d<c.length;d++)if(c[d].Pn===b){b=c[d].Q6e;break a}}b=wac_s9c}a.Pze=b}return a.Pze}function wac_t9c(){}
wac_t9c.prototype={sa:null,DAf:null,Ub:function(){return"Box4.Dictation"},gc:function(a){this.sa=a;var b=wac_k(wac_j(),wac_wEa),c=null;b&&(c=b.uje);var d=wac_0b(wac_j(),wac_F8c),e=this;wac_m(wac_n(this.sa.fa(wac_u9c)),function(){return new wac_u9c(e.sa.H(wac_Uc))});var f=wac_0b(wac_j(),wac_PKa),g=this;wac_m(wac_n(this.sa.fa(wac_a9c)),function(){return new wac_a9c(f,g.sa.H(wac_u9c))});var h=this;wac_m(wac_n(this.sa.fa(wac_d9c)),function(){return new wac_d9c(c,d,h.sa.H(wac_es),h.sa.H(wac_1r),wac_l(a,
wac_gs),a.H(wac_Xa),h.sa.H(wac_u9c),h.sa.H(wac_a9c),wac_k(h.sa,wac_iMc),wac_k(h.sa,wac_jMc),wac_k(h.sa,wac_kMc),h.sa.H(wac_y2c))});wac_m(wac_n(this.sa.fa(wac_aKc)),function(){return new wac_v9c})},tb:function(){this.sa.H(wac_aKc);var a=wac_0b(this.sa,wac_iKa),b=this.sa.H(wac_d9c),c=this.sa.H(wac_as),d=this.sa.H(wac_Js),e=this.sa.H(wac_a9c),f=this.sa.H(wac_u9c),g=wac_0b(this.sa,wac_A8c),h=wac_Ie();this.DAf=wac_w9c||(wac_w9c=new wac_R8c(wac_z(),a,b,c,d,e,f,g,h));this.DAf.Tb();window.Box4.App.zb().Tg(!1)},
O:function(){}};function wac_v9c(){this.Ynf=[];this.Djf=""}wac_v9c.prototype={kof:"",pef:function(){this.kof=wac_5k().toString();this.Ynf=[]},mkf:function(){this.kof=""},iEe:function(){return this.kof},Djf:null,cpf:function(){return this.Djf},hsf:function(a){return this.Djf=a}};function wac_x9c(){}
function wac_m9c(a,b,c,d){this.Ww=(new Date).getTime();this.OBf=a;this.Tf=b;this.FJ=wac_d.Xya.toString(wac_r().Hd().Nv());this.vBf=c;this.nBf=d;this.hsf(wac_5k().toString());this.Xzf=d?"Office.Voice.Online.ALDictationSession":"Office.Voice.Online.DictationSession"}
wac_m9c.prototype={Ww:0,SJ:0,D6e:0,o4e:0,V6e:0,W6e:0,n4e:0,OBf:null,Smf:null,K2e:!0,CBf:!1,nBf:!1,oWf:!1,Xzf:null,FJ:null,Y0:"",aCf:"",Emf:0,eof:0,UAf:!1,VAf:!1,RAf:!1,vBf:!1,QAf:!1,uAf:!1,RWf:"",Tf:null,i$e:null,R$e:null,C4e:0,D4e:0,YCf:0,Cof:0,Gnf:0,Hnf:0,z8e:null,alf:function(a){this.D6e||(this.D6e=(new Date).getTime());this.i$e&&(this.i$e.vg(),this.C4e+=this.i$e.yua(),this.i$e.Wd());this.V6e++;this.W6e+=a.split(" ").length},Abf:function(a){this.Emf=(new Date).getTime();this.Y0=a;this.Tf&&(this.i$e=
this.Tf.uj("WebServiceCall","FragmentResponse"),this.R$e=this.Tf.uj("WebServiceCall","PhraseResponse"))},Dbf:function(){this.eof=(new Date).getTime()},Zdf:function(a){this.K2e=!1;this.Smf=a},K0d:function(){this.o4e+=this.W6e;this.SJ=(new Date).getTime();var a=new wac_bea;a.succeeded=this.K2e;a.dataFields=[];a.durationMs=this.SJ-this.Ww;var b;Array.add(a.dataFields,(b=new wac_Cb,b.name="Success",b.bool=this.K2e,b));if(!this.K2e){var c;Array.add(a.dataFields,(c=new wac_Cb,c.name="error",c.string=this.Smf,
c))}var d;Array.add(a.dataFields,(d=new wac_Cb,d.name="SessionID",d.string=this.iEe(),d));var e;Array.add(a.dataFields,(e=new wac_Cb,e.name="SpeechSessionID",e.string=this.RWf,e));var f;Array.add(a.dataFields,(f=new wac_Cb,f.name="TurnID",f.string=this.cpf(),f));var g;Array.add(a.dataFields,(g=new wac_Cb,g.name="NumberOfWords",g.int64=0<this.W6e?this.W6e+this.o4e:this.o4e,g));var h;Array.add(a.dataFields,(h=new wac_Cb,h.name="NumberOfFragments",h.int64=this.V6e,h));var k;Array.add(a.dataFields,(k=
new wac_Cb,k.name="NumberOfFinalPhrases",k.int64=this.n4e,k));var l;Array.add(a.dataFields,(l=new wac_Cb,l.name="Language",l.string=this.OBf,l));var m;Array.add(a.dataFields,(m=new wac_Cb,m.name="connectionID",m.string=this.Y0,m));var n;Array.add(a.dataFields,(n=new wac_Cb,n.name="IsFrontdoor",n.bool=this.vBf,n));var p;Array.add(a.dataFields,(p=new wac_Cb,p.name="IsUsingFloatie",p.bool=""!==this.iEe(),p));if(this.CBf){var q;Array.add(a.dataFields,(q=new wac_Cb,q.name="MicrophoneError",q.string=this.aCf,
q))}if(this.D6e){var r;Array.add(a.dataFields,(r=new wac_Cb,r.name="TimeToGetFirstResult",r.int64=this.D6e-this.Emf,r))}if(this.K2e){var t;Array.add(a.dataFields,(t=new wac_Cb,t.name="TimeToStartRecording",t.int64=this.eof-this.Ww,t));var v;Array.add(a.dataFields,(v=new wac_Cb,v.name="TimeToOpenConnection",v.int64=this.Emf-this.eof,v))}var u;Array.add(a.dataFields,(u=new wac_Cb,u.name="FocusLost",u.bool=this.UAf,u));var w;Array.add(a.dataFields,(w=new wac_Cb,w.name="FocusLostWhileStarting",w.bool=
this.VAf,w));var x;Array.add(a.dataFields,(x=new wac_Cb,x.name="FailedToStartTurn",x.bool=this.RAf,x));var z;Array.add(a.dataFields,(z=new wac_Cb,z.name="AverageFragmentLatency",z["double"]=this.z8e?wac_y9c(this.z8e):0<this.V6e?this.C4e/this.V6e:0,z));var y;Array.add(a.dataFields,(y=new wac_Cb,y.name="AveragePhraseLatency",y["double"]=this.z8e?wac_z9c(this.z8e):0<this.n4e?this.D4e/this.n4e:0,y));var A;Array.add(a.dataFields,(A=new wac_Cb,A.name="AveragePhraseInsertionLatency",A["double"]=0<this.n4e?
this.Cof/this.n4e:0,A));var B;Array.add(a.dataFields,(B=new wac_Cb,B.name="AverageFragmentInsertionLatency",B["double"]=0<this.V6e?this.YCf/this.V6e:0,B));var C;Array.add(a.dataFields,(C=new wac_Cb,C.name="MaxTimeToInsertFragment",C.int64=this.Gnf,C));var F;Array.add(a.dataFields,(F=new wac_Cb,F.name="MaxTimeToInsertPhrase",F.int64=this.Hnf,F));var D;Array.add(a.dataFields,(D=new wac_Cb,D.name="FailedToInsertText",D.bool=this.QAf,D));if(this.nBf){var G;Array.add(a.dataFields,(G=new wac_Cb,G.name=
"AugloopFailed",G.bool=this.oWf,G));var H;Array.add(a.dataFields,(H=new wac_Cb,H.name="CommandsUsed",H.bool=this.uAf,H))}b=wac_x9c.TUf;this.K2e&&0<this.o4e&&(b=0<this.n4e?wac_x9c.cRf:wac_x9c.$Vf);var J,K,E,I;Array.add(a.dataFields,(I=new wac_Cb,I.name="DictationFunnel",I.contract=(E=new wac_nea,E.name="Office.System.Funnel",E.dataFields=[(J=new wac_Cb,J.name="Name",J.string="Dictation",J),(K=new wac_Cb,K.name="State",K.string=b,K)],E),I));a.name=this.Xzf;a.samplingPolicy=2;wac_Pfa(a)},iEe:function(){return window.Box4.App.azc?
window.Box4.App.azc.iEe():""},cpf:function(){return window.Box4.App.azc?window.Box4.App.azc.cpf():""},hsf:function(a){window.Box4.App.azc&&window.Box4.App.azc.hsf(a);return a}};function wac_A9c(a,b,c){b?(a.Cof+=c,c>a.Hnf&&(a.Hnf=c)):(a.YCf=c,c>a.Gnf&&(a.Gnf=c))}function wac_B9c(a){this.aBf=a}wac_B9c.prototype={aBf:null};function wac_r8c(a,b){(a=a.aBf())&&a.sendGenericRequestMessage("event",b)}function wac_M9(a){this.pBf=a;this.caf=new window.UlsExternalLogger}wac_M9.prototype={pBf:!1,caf:null};
function wac_C9c(a,b){a.pBf&&(a=window.console)&&a.log(String.format("FDSpeechService: {0}",b))}wac_M9.prototype.U8d=function(a,b,c,d){wac_C9c(this,d);this.caf.debugAssertTag(a,b,c,d)};wac_M9.prototype.debugAssertTag=wac_M9.prototype.U8d;wac_M9.prototype.V8d=function(a,b,c,d){wac_C9c(this,d);this.caf.debugTraceTag(a,b,c,d)};wac_M9.prototype.debugTraceTag=wac_M9.prototype.V8d;wac_M9.prototype.nbe=function(a,b,c,d){wac_C9c(this,d);this.caf.sendTraceTag(a,b,c,d)};wac_M9.prototype.sendTraceTag=wac_M9.prototype.nbe;
wac_M9.prototype.Dbe=function(a,b,c,d){wac_C9c(this,d);this.caf.shipAssertTag(a,b,c,d)};wac_M9.prototype.shipAssertTag=wac_M9.prototype.Dbe;function wac_l9c(a,b,c,d,e,f,g){this.ZHb=new wac_T9(0,0,0,0,0,f);this.qBe=g;this.s$e=wac_D9c(e)}
wac_l9c.prototype={THb:null,ZHb:null,Fia:null,a$e:"",qBe:null,s$e:!1,Ekf:function(a,b){this.Fia=b;this.a$e=a;return wac_E9c(this)},v2e:function(a){if(!this.THb)return 3;this.ZHb.N2d(!1);this.ZHb.cfd.ZOe=this.Fia;this.ZHb.cfd.rcf=a;this.THb.startDictation(this.a$e);return 0},O5b:function(){this.THb&&this.THb.stopDictation();this.Fia=null},bob:function(){if(!this.THb)return 0;switch(this.THb.getDictationStatus()){case 0:return 0;case 2:return 2;case 1:return 1;default:return wac_c(50705946,394,!1,"Invalid dictation status"),
0}}};function wac_E9c(a){return new Promise(function(b){var c;a.THb?c=0:(a.THb=window.speechClient.SpeechClientFactoryGlobal.createSpeechClient(new wac_F9c(a.qBe,a.s$e),new wac_G9c,a.ZHb),a.THb?(a.THb.setDictationStartedAudio(wac_5s(wac_H9c)),a.THb.setDictationStoppedAudio(wac_5s(wac_I9c)),a.THb.setSpeechProcesseorScriptUrl(wac_af("speech-processor.js",5)),c=0):(wac_c(42796121,394,!1,"Speech client was not successfully created"),c=3));b(c)})}
function wac_u9c(a){this.E4e=Boolean.parse(wac_a4c().COa("WACDictationFUseAutoPunctuation")||"false");this.Dc=a?a:wac_.pa}wac_u9c.prototype={Dc:null};function wac_J9c(a){return wac_q(a.Dc,"DictationDebugModeEnabled")}function wac_D9c(a){return wac_q(a.Dc,"WacDictationAuthenticationEnabled")}function wac_L8c(a){return wac_q(a.Dc,"WacBox4DictationUseAugloopServiceWithFrontdoor")}function wac_e9c(a){return wac_q(a.Dc,"WacBox4DictationUseAugloopService")}
function wac_j9c(a){return wac_q(a.Dc,"WacBox4DictationUseFrontdoorService")||wac_q(a.Dc,"DictationUseFrontdoorService")||wac_S8c(a)}function wac_p9c(a){return wac_q(a.Dc,"WacBox4DictationJapaneseLanguageIsEnabled")||wac_q(a.Dc,"DictationJapaneseLanguageIsEnabled")}function wac_S8c(a){return wac_q(a.Dc,"WacBox4DictationFloatieIsEnabled")}
function wac_k9c(a,b,c,d,e){this.ZHb=new wac_17(c,d);this.I_b=a;this.fX=b;this.eCf=new wac_F9c(e,wac_D9c(b));var f=this;a=new wac_B9c(function(){return f.THb});if(b=window.Box4.App.$3e)b.VCf=a}
wac_k9c.prototype={THb:null,Fia:null,ZHb:null,I_b:null,fX:null,eCf:null,Ekf:function(a,b){var c=this;return new Promise(function(d){c.eCf.getAccessToken(function(e){d(wac_K9c(c,a,b,e))},function(){d(wac_K9c(c,a,b,""))})})},v2e:function(a){if(!this.THb)return 3;this.ZHb.w2e(this.Fia,a);this.THb.startSpeechRecognition();return 0},O5b:function(a){this.THb&&this.THb.stopSpeechRecognition();if(a&&this.ZHb)this.ZHb.onSpeechEnd();this.Fia=null},bob:function(){return this.ZHb.bob()},bkf:function(a){var b=
new wac_L9c;b.speechMode="Dictation";b.sourceLanguage=a;(a=wac_.pa.Qb.DictationFrontdoorDomain)&&""!==a&&(b.speechFDBase=String.format("wss://{0}/",a));b.speechProcessorScript=wac_af("audioworklet-speech-processor.js",5);b.properties=new window.Map;this.I_b&&(b.properties.set("DictationInsertionPointLeft",wac_M9c(this.I_b,!1)),b.properties.set("DictationInsertionPointRight",wac_M9c(this.I_b,!0)));b.properties.set("Corrections","true");b.properties.set("punctuation",this.fX&&this.fX.E4e?"Intelligent":
"Explicit");wac_J9c(this.fX)&&b.properties.set("EnableAudioLogging",wac_J9c(this.fX).toString());switch(wac_Eg.Cuc){case "Word":b.clientApp=1;break;case "PowerPoint":b.clientApp=0;break;case "OneNote":b.clientApp=2}return b}};
function wac_K9c(a,b,c,d){a.Fia=c;b=a.bkf(b);var e;d=(e=new wac_N9c,e.accessToken=d,e);e=new wac_M9(wac_J9c(a.fX));a.THb=(new window.PPTSpeechClient.SpeechClientFactory).createSpeechClient(b,a.ZHb,d,null,e);return a.THb?0:(wac_c(42796123,394,!1,"Speech client was not successfully created"),3)}
function wac_C9(a,b,c,d,e,f,g,h){this.I_b=a;this.rcf=b;this.Ia=c;this.jxe=d;this.fX=e;this.D7b=f;this.y6e=g;this.OJc=h;this.cof=new (wac_ib.$$(String))(wac_Faa());for(a=0;a<wac_O9c.length;a++)this.cof.ga(wac_O9c.charAt(a).toString())}
wac_C9.prototype={I_b:null,Ia:null,cof:null,jxe:null,fX:null,D7b:null,y6e:null,OJc:null,j7e:!1,U6e:!1,rcf:!1,ZOe:null,Zdf:function(a){this.ZOe&&this.ZOe.Zdf(a);this.Ia.Wj(3414281623,2,a,null);wac_O8c()},qef:function(){if(this.j7e)return!0;if(this.I_b){var a=wac_M9c(this.I_b,!1);this.U6e=!1;a&&0<a.length&&(this.U6e=!wac_ASc(a.charAt(a.length-1))&&!a.endsWith("\u201c"));return this.j7e=this.I_b.qef()}this.ZOe&&(this.ZOe.RAf=!0);this.D7b&&this.D7b.KYf();return!1},N2d:function(a){this.U6e=this.j7e=!1;
if(this.I_b){if(a){a=this.I_b;var b;b=a.xuc?a.SHe!==a.zrc?wac_Jw(a.xuc,a.SHe,a.zrc):wac_2u(a.xuc,a.zrc):null;a.U&&b&&wac_vx(b,!0)!==wac_vx(b,!1)&&0<=wac_vx(b,!0)&&(b=wac_Jw(b.aa,wac_vx(b,!0),wac_vx(b,!1)),a.U.Wj(3884109240,2,b,null))}this.I_b.N2d()}},mef:function(a){this.jxe&&this.jxe.uc(function(b){b.mef(String.format("ServiceSessionID:{0} ClientSessionId: {1}",a,window.Box4.App.azc?window.Box4.App.azc.iEe():""))})}};
function wac_P9c(a){if(a.ZOe){var b=a.ZOe;b.QAf=!0;b.K2e=!1}a.Ia.yw(2363463409,2,null)}
function wac_Q9c(a,b,c){if(a.j7e||a.qef()){if(a.I_b){var d=a.U6e?wac_R9c(a,b):b,e;if(wac_S8c(a.fX)&&wac_E8c.isInstanceOfType(a.I_b))e=a.I_b.EYf(d,c,0<b.length&&b.charAt(0)!==d.charAt(0));else a:{c=a.I_b;b=a.U6e?wac_R9c(a,b):b;if(c.xuc){d=new wac_Q(15,0,null);try{d.lb(c.xuc);var f=c.SHe!==c.zrc?wac_Jw(c.xuc,c.SHe,c.zrc):wac_2u(c.xuc,c.zrc);c.Vha.Pj(f,b,!1,!0,0);c.zrc=c.SHe+b.length;var g=wac_ax(c.xuc,c.zrc);c.ha.Zb(g,null,!1,!1);c.H7e=!1;e=!0;break a}finally{d&&d.O()}}e=!1}e||wac_P9c(a)}a.N2d(!0)}}
function wac_S9c(a){a.jxe&&a.jxe.uc(function(a){a.F2e||(a.F2e=a.ME.Db(Box4Intl.Box4Strings.L_DictationSilenceBusinessBarTitle,Box4Intl.Box4Strings.L_DictationSilenceBusinessBarMessage,null),wac_KP(a.F2e,!0),a.F2e.Do(27),a.Oo.tG(a.F2e,!1,null))})}
function wac_T9c(a){a=a.trimStart();return a.startsWith("NotAllowedError")||a.startsWith("PermissionDeniedError")?Box4Intl.Box4Strings.L_DictationMicrophoneAccessDeniedMessage:a.startsWith("NotFoundError")||a.startsWith("DevicesNotFoundError")?Box4Intl.Box4Strings.L_DictationMicrophoneNotFoundMessage:a.startsWith("NotReadableError")||a.startsWith("TrackStartError")?Box4Intl.Box4Strings.L_DictationMicrophoneInUseMessage:Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage}
function wac_U9c(a,b,c){if(a.ZOe){var d=a.ZOe;d.CBf=!0;d.aCf=c;d.Zdf("MicrophoneError")}a.Ia.yw(3876366013,2,null);wac_P8c(b)}function wac_R9c(a,b){var c;if(c=0<b.length)c=b.charAt(0),c=a.rcf&&!wac_ASc(c)&&!a.cof.Ge(c.toString());return c?" "+b:b}
wac_C9.prototype.Orf=function(a,b){var c=!0;if(this.ZOe){var d=this.ZOe,e=a;d.D6e||(d.D6e=(new Date).getTime());d.R$e&&(d.R$e.vg(),d.D4e+=d.R$e.yua(),d.R$e.Wd());d.W6e=0;d.n4e++;d.o4e+=e.split(" ").length}if(this.y6e&&this.D7b&&(d=this.y6e.LYf(a),6!==d)){this.N2d(!1);this.D7b.Tk(d,null);return}d=(new Date).getTime();if(1===a.length&&"\n"===a)wac_Q9c(this,"",null),this.Ia.yw(3398225082,2,null);else{e=a.indexOf("\n");for(0<e&&e!==a.length-1&&(c=!1);0<=e;)wac_Q9c(this,a.substr(0,e),c?b:null),this.Ia.yw(3398225082,
2,null),a=a.substr(e+1),e=a.indexOf("\n"),c=!1;wac_Q9c(this,a,c?b:null)}a=(new Date).getTime();this.ZOe&&wac_A9c(this.ZOe,!0,a-d)};wac_C9.prototype.onFinalPhrase=wac_C9.prototype.Orf;
wac_C9.prototype.Qrf=function(a){var b;if(this.j7e)b=wac_R9c(this,a);else{if(!this.qef())return;b=this.U6e?wac_R9c(this,a):a}this.ZOe&&this.ZOe.alf(a);a=!0;var c=(new Date).getTime(),d;if(d=this.I_b){var e;a:{d=this.I_b;if(d.xuc){var f=new wac_Q(15,0,null);try{f.lb(d.xuc);var g=d.H7e&&d.SHe!==d.zrc?wac_Jw(d.xuc,d.SHe,d.zrc):wac_2u(d.xuc,d.zrc);d.Vha.Pj(g,b,!1,!0,0);d.zrc=d.H7e?d.SHe+b.length:d.zrc+b.length;var h=wac_ax(d.xuc,d.zrc);d.ha.Zb(h,null,!1,!1);d.H7e=!1;e=!0;break a}finally{f&&f.O()}}e=!1}d=
!e}d&&(wac_P9c(this),a=!1);e=(new Date).getTime();this.ZOe&&wac_A9c(this.ZOe,!1,e-c);a&&this.D7b&&this.D7b.JYf()};wac_C9.prototype.onFragment=wac_C9.prototype.Qrf;wac_C9.prototype.Dbf=function(){this.Ia.yw(2652766343,2,null);this.ZOe&&this.ZOe.Dbf()};wac_C9.prototype.onRecordingStarted=wac_C9.prototype.Dbf;wac_C9.prototype.Rrf=function(){wac_U9c(this,Box4Intl.Box4Strings.L_DictationMicrophoneErrorMessage,"")};wac_C9.prototype.onMicrophoneError=wac_C9.prototype.Rrf;
wac_C9.prototype.Trf=function(a){if(this.ZOe){var b=this.ZOe;b.K2e=!1;b.Smf=a.toString()}this.Ia.Wj(3414281623,2,a,null);switch(a){case 0:wac_P8c(Box4Intl.Box4Strings.L_DictationAccessDeniedErrorMessage);break;case 1:wac_P8c(Box4Intl.Box4Strings.L_DictationFailedToConnectErrorMessage);break;case 6:wac_O8c();break;case 3:wac_S9c(this)}};wac_C9.prototype.onRecognitionError=wac_C9.prototype.Trf;wac_C9.prototype.Urf=function(){this.N2d(!1);this.Ia.yw(44849047,2,null)};
wac_C9.prototype.onRecordingStopped=wac_C9.prototype.Urf;wac_C9.prototype.Abf=function(a){this.ZOe&&this.ZOe.Abf(a)};wac_C9.prototype.onConnectionStarted=wac_C9.prototype.Abf;wac_C9.prototype.Srf=function(a){a=a.substr(a.lastIndexOf(":")+1);wac_U9c(this,wac_T9c(a),a)};wac_C9.prototype.onMicrophoneErrorWithMessage=wac_C9.prototype.Srf;wac_C9.prototype.Prf=function(){this.ZOe&&(this.ZOe.UAf=!0);this.Ia.yw(3338844071,2,null)};wac_C9.prototype.onFocusLost=wac_C9.prototype.Prf;function wac_V9c(){}
wac_V9c.prototype={Nmf:0,C4e:0,D4e:0,Onf:0,Pnf:0,alf:function(a){this.C4e+=wac_W9c(this,a);this.Onf++}};function wac_W9c(a,b){if(!b)return 0;var c=(new Date).getTime(),d=null,e,f;return(f=wac_dP(wac_H8c,b,e={val:d}),d=e.val,f)?c-a.Nmf-(d.Offset+d.Duration)/1E4:0}function wac_y9c(a){return a.Onf?a.C4e/a.Onf:wac_z9c(a)}function wac_z9c(a){return a.Pnf?a.D4e/a.Pnf:0}Type.registerNamespace("OfficeVoice.SpeechClient");(function(){}).registerInterface("OfficeVoice.SpeechClient.ISpeechClient");
function wac_F9c(a,b){this.qBe=a;this.s$e=b}wac_F9c.prototype={qBe:null,s$e:!1};wac_F9c.prototype.sXf=function(a){this.s$e&&this.qBe?this.qBe.b4e("OfficeDictation",wac_.pa.Qb.DictationResourceID).then(function(b){b.IsSuccess?a(b.Token):a(wac_X9c)}).catch(function(){a(wac_X9c)}):a(wac_X9c)};wac_F9c.prototype.getAccessToken=wac_F9c.prototype.sXf;function wac_G9c(){}wac_G9c.prototype.tXf=function(){var a=wac_.pa.Qb.DictationEndpoint;wac_b(38122838,394,50,"Dictation endpoint: {0}",a);return a};
wac_G9c.prototype.getDictationEndpoint=wac_G9c.prototype.tXf;function wac_T9(a,b,c,d,e,f){this.cfd=f}wac_T9.prototype={cfd:null,N2d:function(a){this.cfd.N2d(a)}};wac_T9.prototype.Orf=function(a){this.cfd.onFinalPhrase(a,null)};wac_T9.prototype.onFinalPhrase=wac_T9.prototype.Orf;wac_T9.prototype.Qrf=function(a){this.cfd.onFragment(a)};wac_T9.prototype.onFragment=wac_T9.prototype.Qrf;wac_T9.prototype.Dbf=function(){this.cfd.onRecordingStarted()};wac_T9.prototype.onRecordingStarted=wac_T9.prototype.Dbf;
wac_T9.prototype.Rrf=function(){this.cfd.onMicrophoneError()};wac_T9.prototype.onMicrophoneError=wac_T9.prototype.Rrf;wac_T9.prototype.Trf=function(a){this.cfd.onRecognitionError(a)};wac_T9.prototype.onRecognitionError=wac_T9.prototype.Trf;wac_T9.prototype.Urf=function(){this.cfd.onRecordingStopped()};wac_T9.prototype.onRecordingStopped=wac_T9.prototype.Urf;wac_T9.prototype.Abf=function(a){this.cfd.onConnectionStarted(a)};wac_T9.prototype.onConnectionStarted=wac_T9.prototype.Abf;
wac_T9.prototype.Srf=function(a){this.cfd.onMicrophoneErrorWithMessage(a)};wac_T9.prototype.onMicrophoneErrorWithMessage=wac_T9.prototype.Srf;wac_T9.prototype.Prf=function(){this.cfd.onFocusLost()};wac_T9.prototype.onFocusLost=wac_T9.prototype.Prf;Type.registerNamespace("OfficeVoice.FrontdoorSpeechClient");(function(){}).registerInterface("OfficeVoice.FrontdoorSpeechClient.IFrontdoorSpeechClient");function wac_N9c(){}wac_N9c.prototype={accessToken:null};function wac_L9c(){}
wac_L9c.prototype={speechMode:null,sourceLanguage:null,targetLanguages:null,properties:null,speechFDBase:null,userSessionId:null,customEndpointConfig:null,clientApp:0,clientMetaData:null,requestServiceCustomEndpoint:!1,captureAudioPauseResumeRecordingState:!1,speechProcessorScript:null};function wac_17(a,b){this.Csf=Function.createDelegate(this,this.mSf);this.I7a=b;this.OJc=a}
wac_17.prototype={I7a:null,dad:0,rof:null,qof:null,OJc:null,A$e:!1,iff:null,Yef:!1,Fia:null,E2e:null,w2e:function(a,b){this.I7a.N2d(!1);this.I7a.ZOe=a;this.I7a.rcf=b;this.Yef||(wac_tf(window.self,"blur",this.Csf),this.Yef=!0);this.Fia=a;this.dad=1;this.E2e=new wac_V9c;this.Fia&&(this.Fia.z8e=this.E2e)},bob:function(){return this.dad},mSf:function(){1===this.dad?this.Fia&&(this.Fia.VAf=!0):2===this.dad&&(wac_Y9c(this),this.I7a.onFocusLost())}};
function wac_Y9c(a){a.Yef&&(wac_jg(window.self,"blur",a.Csf),a.Yef=!1)}wac_17.prototype.Bbf=function(a,b){if(2===this.dad){var c=a.size;if(1!==c&&(wac_b(51442337,394,10,"Final text mapping has invalid size of {0}",c),!c))return;b=b.get("JsonResult");this.E2e&&(c=this.E2e,c.D4e+=wac_W9c(c,b),c.Pnf++);this.I7a.onFinalPhrase(a.values().next().value,b)}};wac_17.prototype.onFinalText=wac_17.prototype.Bbf;
wac_17.prototype.Cbf=function(a,b){if(2===this.dad){var c=a.size;if(1!==c&&(wac_b(51442338,394,10,"Fragment text mapping has invalid size of {0}",c),!c))return;b=b.get("JsonResult");this.E2e&&this.E2e.alf(b);this.I7a.onFragment(a.values().next().value)}};wac_17.prototype.onFragmentText=wac_17.prototype.Cbf;
wac_17.prototype.J4c=function(a){if(this.dad&&3!==this.dad&&"ErrorNone"!==a){this.dad=3;switch(a){case "ErrorInvalidSubscriptionFromConfig":case "ErrorInvalidRegionFromConfig":case "ErrorAddSessionFailure":case "ErrorCreateSpeechSessionBadRequest":this.I7a.onRecognitionError(0);break;case "ErrorSpeechHandlerWebSocketFailure":case "ErrorProtobufDeserializationFailure":this.I7a.onRecognitionError(1);break;case "ErrorWaitAudioTimeout":case "ErrorInitialBabbleTimeout":case "ErrorCustomEndpointTimeout":this.I7a.onRecognitionError(4);
break;case "ErrorInitialSilenceTimeout":this.I7a.onRecognitionError(3);break;case "ErrorSpeechRecognitionFailure":case "ErrorTranslationFailure":case "ErrorFailedToGetSupportedTextLanguages":case "ErrorUnknown":this.I7a.onRecognitionError(6);break;case "ErrorInvalidMessage":case "ErrorAudioAbortError":case "ErrorAudioOverconstrainedError":case "ErrorAudioTypeError":this.I7a.onMicrophoneError();break;case "ErrorAudioSecurityError":case "ErrorAudioNotAllowedError":case "ErrorAudioPermissionDeniedError":wac_U9c(this.I7a,
wac_T9c("NotAllowedError"),"NotAllowedError");break;case "ErrorAudioNotFoundError":wac_U9c(this.I7a,wac_T9c("NotFoundError"),"NotFoundError");break;case "ErrorAudioNotReadableError":wac_U9c(this.I7a,wac_T9c("NotReadableError"),"NotReadableError");break;default:this.I7a.Zdf(a)}this.dad=0}};wac_17.prototype.onError=wac_17.prototype.J4c;
wac_17.prototype.Fbf=function(a){if(window.self.document.hasFocus()){this.dad=2;this.A$e=!1;this.I7a.onRecordingStarted();this.I7a.onConnectionStarted(a);if(!this.rof){a=new wac_lMc(document.createElement("audio"));var b=wac_5s(wac_H9c);a.Cef.setAttribute("src",b);this.rof=a}this.rof.Play()}else wac_Y9c(this),this.I7a.onFocusLost()};wac_17.prototype.onSpeechRecognitionStarted=wac_17.prototype.Fbf;
wac_17.prototype.Ebf=function(){wac_Y9c(this);if(this.bob()){this.dad=3;this.I7a.onRecordingStopped();this.dad=0;if(!this.qof){var a;a=new wac_lMc(document.createElement("audio"));var b=wac_5s(wac_I9c);a.Cef.setAttribute("src",b);this.qof=a}this.qof.Play()}};wac_17.prototype.onSpeechEnd=wac_17.prototype.Ebf;
wac_17.prototype.zbf=function(a){if(this.E2e){var b=this.E2e;b.Nmf||(b.Nmf=(new Date).getTime())}if(this.OJc){for(var b=0,c=a.length,d=0;d<c;++d)b+=Math.pow(a[d],2);a=Math.sqrt(b/a.length)>wac_Z9c;!this.A$e&&a?(this.A$e=!0,this.iff=null):this.A$e&&!a&&(this.iff?(new Date).getTime()>=this.iff+wac__9c&&(this.A$e=!1):this.iff=(new Date).getTime())}};wac_17.prototype.onAudioData=wac_17.prototype.zbf;wac_17.prototype.WXf=function(a){var b=this.I7a;wac_J9c(b.fX)&&b.mef(a)};
wac_17.prototype.onSpeechSessionStarted=wac_17.prototype.WXf;wac_H8c.registerClass("Box4.Dictation.SimpleSpeechResult");wac_I8c.registerClass("Box4.Dictation.AugloopSpeechClientProxy",null,wac_G8c);window.Box4.Dictation.IWordVoiceCommand.registerClass("Box4.Dictation.IWordVoiceCommand");wac_K8c.registerClass("Box4.Dictation.VoiceCommandHandler",null,window.Box4.Dictation.IVoiceCommandHandler);wac_17.registerClass("OfficeVoice.FrontdoorSpeechClient.FrontdoorSpeechClientObserver");
wac_G7.registerClass("Box4.Dictation.AugloopFrontdoorSpeechObserverAbstractDecorator",wac_17);wac_r7.registerClass("Box4.Dictation.AugloopFrontdoorSpeechObserverDecorator",wac_G7);wac_N8c.registerClass("Box4.Dictation.AugloopVoiceCommandHandlerAbstractDecorator",null,window.Box4.Dictation.IVoiceCommandHandler);wac_J8c.registerClass("Box4.Dictation.AugloopVoiceCommandHandlerDecorator",wac_N8c);(function(){}).registerClass("Box4.Dictation.Dialogs");
wac_R8c.registerClass("Box4.Dictation.DictationActor",null,wac_C8c);(function(){}).registerClass("Box4.Dictation.DictationConstants");wac_a9c.registerClass("Box4.Dictation.DictationFloatieManager");wac_18c.registerClass("Box4.Dictation.DictationLanguage");wac_d9c.registerClass("Box4.Dictation.DictationManager");wac_t9c.registerClass("Box4.Dictation.DictationPackageManager",null,wac_I,wac_i);wac_v9c.registerClass("Box4.Dictation.DictationSessionInfo",null,wac_aKc);wac_x9c.registerClass("Box4.Dictation.FunnelStatus");
wac_m9c.registerClass("Box4.Dictation.DictationSessionTelemetry");wac_B9c.registerClass("Box4.Dictation.FrontdoorCorrectionsTelemetryLogger",null,wac_cMc);wac_M9.registerClass("Box4.Dictation.FrontdoorExternalLogger",null,window.IExternalLogger);wac_l9c.registerClass("Box4.Dictation.DictationSpeechClientProxy",null,wac_G8c);wac_u9c.registerClass("Box4.Dictation.DictationSettings");wac_k9c.registerClass("Box4.Dictation.FrontdoorSpeechClientProxy",null,wac_G8c);(function(){}).registerClass("Box4.Dictation.Program");
wac_C9.registerClass("Box4.Dictation.SpeechClientObserverController");wac_V9c.registerClass("Box4.Dictation.DictationLatency");wac_F9c.registerClass("OfficeVoice.SpeechClient.AuthenticationProvider");wac_G9c.registerClass("OfficeVoice.SpeechClient.ConnectionProvider");wac_T9.registerClass("OfficeVoice.SpeechClient.SpeechClientObserver");wac_N9c.registerClass("OfficeVoice.FrontdoorSpeechClient.IAuthenticationProvider");wac_L9c.registerClass("OfficeVoice.FrontdoorSpeechClient.ISpeechConfig");
var wac_Q8c=null,wac_w9c=null,wac_58c="FA000000012",wac_48c="3876e05f-3fcc-418f-b8ab-db7ce0d11d3c",wac_o9c="en-US es-ES zh-CN en-CA es-MX en-GB fr-FR de-DE it-IT".split(" "),wac_n9c="en-AU en-IN fr-CA pt-BR nb-NO da-DK sv-SE fi-FI nl-NL".split(" "),wac_q9c="ja-JP",wac_s9c="en-US",wac_$8c="btnStartDictation",wac_98c="btnDictationFloatieToggle",wac_88c="Dictation",wac_78c="DictationFloatieToggle",wac_W8c="Insertaudio_32x32x32",wac_X8c="Insertaudio_16x16x32",wac_U8c="JotInsertAudioRecordingShort_32x32x32",
wac_V8c="JotInsertAudioRecordingShort_16x16x32",wac_H9c="speechOn.wav",wac_I9c="speechOff.wav",wac_c9c=1033;wac_x9c.TUf="Seen";wac_x9c.$Vf="Tried";wac_x9c.cRf="Kept";var wac_O9c='-\u2013.,:;/?!"\u3002\uff0c\uff1a\uff1b\u3001\uff1f\uff01\u201d',wac_X9c="dictation access token",wac_Z9c=350,wac__9c=350;wac_J(wac_C(),new wac_t9c,0,!1);Type.registerNamespace("Box4.Insights");wac_K=window.Box4||{};wac_K.$4c=wac_K.$4c||{};function wac_FHc(){}wac_FHc.registerInterface("Box4.Insights.IBox4InsightsSelection");
function wac_HHc(){}wac_HHc.prototype={Ub:function(){return"Box4.Insights"},tb:function(){},O:function(){},gc:function(a){wac_m(wac_n(wac_o(wac_o(a.fa(wac_UFc),wac_kHc),wac_FHc)),function(){return new wac_UFc(2E3)})}};function wac_UFc(a){this.qab=a}function wac_IHc(){var a=window.Box4.App.zb().Zc.ik;if(!a)return wac_b(38548897,1303,50,"ContentView is null"),null;a=a.Fa;return a&&a.wb()&&a.wb().na()?a.wb().kb():(wac_b(38548898,1303,50,"SelectionManager or selectionCollection is null"),null)}
wac_UFc.prototype={qab:0,XQf:function(){var a=wac_IHc();return 0<this.Ufe(a).mentionLength},EPe:function(){var a=wac_IHc();return this.Ufe(a)},Ufe:function(a){a&&wac_Wu(a)&&wac_Nv(a.La())&&wac_bEb(a.La())&&(wac_b(17944729,1303,50,"Selection was an insertion point, expanding to word"),a=wac_RCa(a.La(),!1));if(!a){var b;return b=new wac_EHc,b.neighborhood="",b.mentionStart=0,b.mentionLength=0,b}var c=new Sys.StringBuilder,d=0;b=0;for(var e=[],f=a.na(),g=0;g<f;g++){var h=a.K(g);if(wac_Yv(h.aa)&&!Array.contains(e,
h.aa.B8a)){e.push(h.aa.B8a);var k=h.aa.Xc,l=g===f-1;g||-1===h.Na||(d=h.Na);b+=l&&-1!==h.Nb?h.Nb:k.length;c.append(k);l||(c.append(" "),b++)}}for(a=wac_oSc(c.toString()," ");d<b&&wac_zf(a.charCodeAt(d));)d++;for(;b>d&&wac_zf(a.charCodeAt(b-1));)b--;a.length>this.qab&&(c=b-d,c>this.qab?(a=a.substr(d,this.qab),b=this.qab,d=0):(e=this.qab-c,c=Math.max(d-Math.floor(e/2),0),e=Math.min(c+this.qab,a.length),c=Math.max(e-this.qab,0),d-=c,b-=c,a=a.substring(c,e)));var m;return m=new wac_EHc,m.neighborhood=
a,m.mentionStart=d,m.mentionLength=b-d,m}};(function(){}).registerClass("Box4.Insights.Program");wac_HHc.registerClass("Box4.Insights.Box4InsightsPackage",null,wac_I,wac_i);wac_UFc.registerClass("Box4.Insights.Box4InsightsSelection",null,wac_FHc,wac_kHc);wac_J(wac_C(),new wac_HHc,0,!1);Type.registerNamespace("PowerPointWebEditor.Dictation");wac_Z=window.PowerPointWebEditor||{};wac_Z.XOe=wac_Z.XOe||{};function wac_h9c(a,b,c){this.SHe=this.zrc=-1;this.Vha=a;this.ha=b;this.U=c}
wac_h9c.prototype={Vha:null,ha:null,U:null,xuc:null,H7e:!1,qef:function(){this.xuc&&this.N2d();var a=this.ha.wb().kb();if(a){var b=a.La();if(b&&wac_Yv(b.aa))return this.xuc=b.aa,this.SHe=wac_vx(a.La(),!0),this.zrc=wac_vx(a.La(),!1),this.H7e=!0}return!1},N2d:function(){this.xuc=null;this.H7e=!1;this.zrc=this.SHe=-1}};
function wac_M9c(a,b){if(a=a.ha.wb().kb()){var c=a.La();if(c&&(a=c.aa,wac_Yv(a)&&(c=b?wac_vx(c,!1):wac_vx(c,!0),a=a.Xc,c<=a.length)))return b?a.substring(c,a.length):a.substring(0,c)}return""}function wac_09c(a,b,c){this.Vha=a;this.ha=b;this.U=c}wac_09c.prototype={Vha:null,ha:null,U:null};function wac_19c(){}
wac_19c.prototype={Ub:function(){return"PowerPointWebEditor.Dictation"},gc:function(a){wac_m(wac_n(wac_o(a.fa(wac_09c),wac_F8c)),function(){return new wac_09c(a.H(wac_$r),a.H(wac_1r),wac_z())})},tb:function(){},O:function(){}};wac_h9c.registerClass("PowerPointWebEditor.Dictation.DictationHost",null,wac_D8c);wac_09c.registerClass("PowerPointWebEditor.Dictation.DictationHostFactory",null,wac_F8c);wac_19c.registerClass("PowerPointWebEditor.Dictation.PPTWebEditorDictationPackage",null,wac_I,wac_i);
wac_J(wac_C(),new wac_19c,0,!1);Type.registerNamespace("Common.App.VersionHistory");wac_d=window.Common||{};wac_d.Qa=wac_d.Qa||{};wac_d.Qa.p2b=wac_d.Qa.p2b||{};wac_d.Qa.p2b.rVe=function(){};wac_d.Qa.p2b.rVe.prototype={};wac_d.Qa.p2b.rVe.registerEnum("Common.App.VersionHistory.VersionHistoryFullAppErrorCode",!1);(function(){}).registerInterface("Common.App.VersionHistory.IVersionHistoryController");(function(){}).registerInterface("Common.App.VersionHistory.IFocusTrapZoneComponent");
function wac_JHc(){}wac_JHc.prototype={appColor:null,appName:0,fileExtension:null,wdEnableDownloadTokens:!1,retryCount:0,wdEnableSaveACopy:!1,wdEnableRestore:!1,wdEnableIterator:!1,userSessionId:null,wacCluster:null,uiLocale:null,isRtl:!1,useXhr:!1,wdEnableIteratorBasedHeaderAlignment:!1,viewerRootPositionRelative:!1,wdEnableHiddenButtonsUntilVersionLoadComplete:!1,wdEnableShowVersionChanges:!1,disableSaveACopy:!1,wdEnableCompareVersionsByGroup:!1,wdEnableShowVersionEvents:!1,disabledChangeGates:null};
function wac_KHc(){}wac_KHc.prototype={telemetryEventKey:null,telemetryEventData:null};function wac_uwc(){}wac_uwc.prototype={revisionID:null,authorID:null,authors:null,time:null,downloadUrl:null,wopiInfo:null,events:null};function wac_vwc(){}wac_vwc.prototype={ulsLogger:null,serviceBase:null,latestStreamServiceBase:null,docId:null,appSettings:null,perfTelemetryInfos:null};function wac_wwc(){}wac_wwc.prototype={currentVersion:null,baseVersion:null,correlationID:null,groupName:null,noBaseToCompareTo:!1};
function wac_xwc(){}wac_xwc.prototype={versions:null,containerDiv:null,correlationID:null};function wac_LHc(){}wac_LHc.prototype={updatedVersions:null,versionSelected:null};Type.registerNamespace("PowerPointWebEditor.VersionHistory");wac_Z=window.PowerPointWebEditor||{};wac_Z.p2b=wac_Z.p2b||{};function wac_MHc(){}wac_MHc.registerInterface("PowerPointWebEditor.VersionHistory.IVersionHistoryPaneActor");function wac_ywc(){this.SB=Function.createDelegate(this,this.sC)}
wac_ywc.prototype={sa:null,Fre:null,Ub:function(){return"PowerPointWebEditor.VersionHistory"},gc:function(a){this.sa=a},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){var a=this.sa.H(wac_Uc);if(wac_q(a,"PptVersionHistoryIsEnabled"))if(wac_Rqc())if(wac_q(a,"AppSupportsReactVersionHistory"))if(this.sa.H(wac_R).Iif)wac_b(42755924,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the file is open password protected");else{wac_b(39711108,
202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Initializing the React VersionHistory package");var b=this;wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),7,function(){b.sa.H(wac_wEa).uje.MRd("versionHistory").catch(function(a){return wac_b(39711109,811,10,"Failed to load the resources for the versionHistory feature: {0}",a)}).then(function(){b.pPe();return null}).catch(function(a){return wac_b(39711110,811,10,"Failed to initialize the versionHistory feature: {0}",a)})},3)}else wac_b(39711107,
202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled");else wac_b(39711106,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled");else wac_b(40718789,202,50,"PPTWebEditorVersionHistoryPackageManager:Init - Not initializing the React VersionHistory package because the feature is disabled")},pPe:function(){var a=this;wac_n(wac_m(this.sa.fa(wac_Awc),
function(){return new wac_Awc(wac_z(),a.sa.H(wac_iK),a.sa.H(wac_Em),a.sa.H(wac_R),a.sa.H(wac_Mt),wac_Ie(),wac_qg(),a.sa.H(wac_kG),a.sa.H(wac_mG),a.sa.H(wac_$D),a.sa.H(wac_VF),wac_l(a.sa,wac_SY))}));this.Fre=this.sa.H(wac_Awc);this.Fre.Tb()},O:function(){this.Fre&&this.Fre.O()}};
function wac_Awc(a,b,c,d,e,f,g,h,k,l,m,n){this.fYe=Function.createDelegate(this,this.j_e);this.AAe=Function.createDelegate(this,this.yye);this.MJf=Function.createDelegate(this,this.FTf);this.FAe=Function.createDelegate(this,this.JCe);this.Pxd=-1;this.dispose=this.O;this.U=a;this.qIa=b;this.Gh=c;this.Ta=d;this.Cc=e;this.Rta={};this.ra=f;this.Dg=g;this.DRd={};this.Mp=k;this.XVd={};this.iFf=h;this.o3=l;this.hb=m;this.Cgf=[];if(n){this.XDf=n;var p=this;this.XDf.uc(function(a){p.my=a})}}
function wac_NHc(a){return a.RevisionID?a.RevisionID:a.revisionID?a.revisionID:""}
wac_Awc.prototype={U:null,V4d:null,s2a:null,qIa:null,Gh:null,Ta:null,Cc:null,Rta:null,ZXe:null,D$d:null,HIe:null,iNd:null,ra:null,Dg:null,Mp:null,iFf:null,o3:null,hb:null,XDf:null,my:null,Cgf:null,DRd:null,hWd:null,XVd:null,A7e:null,Tb:function(){this.U.ja(466976539,2147483648,this.FAe);this.U.ja(4281380812,2147483648,this.MJf)},JCe:function(a,b,c){if(1===c)return a=!1,this.Ta.mvd&&this.hb.BFd&&(a=!0),a?2:32;if(2===c){wac_Tg("Microsoft.Office.PPT.Server.Flighting.IShowVersionHistoryDialogAction");
this.hWd=wac_5k().toString();wac_b(40144898,822,50,"Execute ShowVersionHistoryDialogAction. VersionHistoryLaunchSessionId: {0}",this.hWd);wac_1t("Microsoft.Office.Server.Powerpoint.Web.IPptVersionHistoryIsEnabledSettings");this.Rta.VersionHistoryLaunchSessionId=this.hWd;this.DRd.VersionHistoryLaunchSessionId=this.hWd;this.Rta.ShowVersionHistoryDialog=(new Date).getTime().toString();this.iNd=[];if(!this.V4d){var d,e;this.V4d=window.versionHistory.FactoryGlobal.getVersionHistoryControllerInstance((e=
new wac_vwc,e.ulsLogger=new window.UlsExternalLogger,e.serviceBase=wac_.pa.Qb.VersionHistoryWebServiceBase,e.latestStreamServiceBase=wac_q(wac_.pa,"PPTVHPodsBootEnabled")?wac_.pa.Qb.PODSLatestServiceBase+"&PodSID="+wac_.pa.Qb.PodSID:"",e.docId=wac_.eo,e.appSettings=(d=new wac_JHc,d.appName=100,d.appColor="#B7472A",d.fileExtension="pptx",d.wdEnableDownloadTokens=!0,d.retryCount=wac_.pa.Qb.PodVHRetryCount,d.wdEnableSaveACopy="true"===wac_.pa.Qb.PodVHEnableSaveACopy.toLowerCase()&&wac_tG(this.Mp),d.wdEnableRestore=
"true"===wac_.pa.Qb.PodVHEnableRestore.toLowerCase()&&wac_tG(this.Mp),d.userSessionId=wac_.Ag,d.wacCluster=wac_.pa.Qb.WacCluster,d.uiLocale=this.Ta.QBb?this.Ta.QBb:"en-us",d.isRtl=wac_Ag&&wac_q(wac_.pa,"PPTVHRTLIsEnabled"),d.viewerRootPositionRelative=wac_q(wac_.pa,"PPTVHRootContainerPositionIsAbsolute"),d.wdEnableCompareVersionsByGroup=wac_q(wac_.pa,"PPTVersionHistoryCollapseAndCompareVersionsByGroupIsEnabled"),d.wdEnableShowVersionEvents=wac_q(wac_.pa,"PPTVersionHistoryShowEvents"),d),e.perfTelemetryInfos=
this.iNd,e))}this.V4d&&wac_q(wac_.pa,"PPTOVersionHistorySaveACopyProtectedDocDisabled")&&this.V4d.setDisableSaveACopy(wac_bf);this.KCe()}return 32},FTf:function(a,b,c){return 1===c&&this.Ta.mvd&&this.hb.BFd?2:this.U.yw(3681556347,c,null)},KCe:function(){if(!document.getElementById("VersionHistoryOverlay")){wac_OHc(this);wac_Bwc(this);wac_Cwc(this);this.Ta.rTe&&wac_PHc(this);wac_Dwc(this);wac_QHc(this);wac_RHc(this);var a=document.createElement("div");a.id="VersionHistoryOverlay";a.style.width="100%";
a.style.height="calc(100% + 23px)";a.style.zIndex=998;a.style.display="block";a.style.position="absolute";a.style.top="0px";document.getElementById("WACInnerFrame").appendChild(a);this.ZXe=this.V4d.createVersionHistoryDialog(a);this.SDc()}document.getElementById("VersionHistoryOverlay").style.display="block";this.V4d.getTipVersion&&wac_q(wac_.pa,"PPTVHPodsBootEnabled")&&this.V4d.getTipVersion();this.V4d.getVersions("");try{var b;var c=this.iFf;try{for(var a=[],d=c.kxc(),e=0;e<d.length;e++)Array.contains(c.Wx.gR,
d[e])&&a.push(d[e]);b=a}catch(f){wac_Y(41698500,822,10,"AppFrame::GetCurrentActiveF6Focuses, Exception: {0}",f),b=null}this.A7e=b;for(b=0;b<this.A7e.length;b++)wac_3j(this.Dg,this.A7e[b]);wac_2j(this.Dg,"VersionHistoryOverlay")}catch(f){wac_b(41698513,822,10,"VersionHistoryPaneActor: exception in ActivateVersionHistoryFocus: {0}.",f)}},Lye:function(a){try{if(this.s2a)wac_gvc(!1),this.s2a.switchParentViewContainer(a);else{wac_gvc(!0);var b=new window.PowerPointVersionHistory.AppBootSettings;b.RenderServiceBase=
"";b.IsRtl=wac_Ag;var c=new window.PowerPointVersionHistory.AppCallbackBag,d=this.qIa;c.animationDecoratorCallback=d.zAe||(d.zAe=Function.createDelegate(d,d.RBe));c.notesIconDecoratorCallback=this.AAe;c.addToF6LoopCallback=this.fYe;var e=this;c.reportViewerErrorCallback=function(a){e.DRd[wac_SHc]=wac_THc().sHa.K(a);106===a&&e.V4d.setViewerError(!0);wac_b(40125919,822,50,"Versions viewer error: {0}",a);return!0};b.IsHighContrast=!1;this.Gh&&(b.IsHighContrast=this.Gh.ZJ);b.IsHighContrast&&(b.ClientColorSettings=
this.Gh.Ap.wba+"_"+this.Gh.Ap.jVc+"_"+this.Gh.Ap.YKa);if(this.Cc){var f=wac_CI(this.Cc);b.DefaultSlideWidth=f.ac;b.DefaultSlideHeight=f.qc}b.UserSessionId=wac_.Ag;b.VersionViewerCssUrl=this.Ta.IBe;b.ProgressImageResourceUrl=wac_Le("progress.gif");b.ThumbnailShareOptimizationEnabled=this.Ta.HFe;b.DiffIconEnabled=wac_q(wac_.pa,"PPTVHDiffIconEnabled");var g;b.SlidePrefetchSettings=(g=new window.PowerPointVersionHistory.SlidePrefetchSettings,g.SlidePrefetchEnabled=wac_q(wac_.pa,"PPTVHSlidePrefetchEnabled"),
g.SlidePrefetchAhead=wac_.pa.Qb.PPTVHSlidePrefetchAhead,g.SlidePrefetchBehind=wac_.pa.Qb.PPTVHSlidePrefetchBehind,g.SlidePrefetchChunkSize=wac_.pa.Qb.PPTVHSlidePrefetchChunkSize,g.SlidePrefetchDelay=wac_.pa.Qb.PPTVHSlidePrefetchDelay,g);b.FileExtension=wac_h(this.Ta.PBb)?"":wac_If(this.Ta.PBb).toLowerCase();b.SlideInformationLabel=ResourceStrings.l_SlideMenuButtonLabel;b.NotesButtonLabel=ResourceStrings.L_Notes;b.SynchronizerTimeout=wac_.pa.Qb.PptVersionHistorySynchronizerTimeout;b.IsRtl=wac_Ag&&
wac_q(wac_.pa,"PPTVHRTLIsEnabled");b.VersionViewerUseGetItems=this.Ta.Ejf;b.IsRootContainerPositionAbsolute=wac_q(wac_.pa,"PPTVHRootContainerPositionIsAbsolute");this.s2a=new window.PowerPointVersionHistory.AppVersionController(b,a,c)}}catch(h){this.V4d.setViewerError(!0),wac_b(39711112,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",h)}},yye:function(){return wac_4h(14,14,"ToolbarNotesActiveDark_14x14x32",null,ResourceStrings.L_Notes)},SDc:function(){var a=
this.ra.xc("VersionHistoryOverlay");a.re="main";a.NCa=!0;a.szf=!0;var b=this;wac_pk(a,function(){b.Pxd=-1;wac_29c(b,!0)});wac_1j(this.Dg,"VersionHistoryOverlay",!0);var c=this;wac_Zia(this.Dg,"VersionHistoryOverlay",function(a){wac_29c(c,a)})},j_e:function(a){try{var b=wac_UHc(this);b&&b.push(a)}catch(c){wac_b(40743826,822,10,"VersionHistoryPaneActor: exception in AddToF6Loop: {0}.",c)}return!0},O:function(){document.getElementById("VersionHistoryOverlay")&&"none"!==document.getElementById("VersionHistoryOverlay").style.display&&
wac_VHc(this)}};function wac_UHc(a){if(!a.D$d)return null;var b=wac_NHc(a.D$d);return a.XVd[b]?a.XVd[b]:null}function wac_WHc(a){var b=wac_NHc(a.D$d);a.XVd[b]||(a.XVd[b]=["VersionListPane","vhHeader"],a.Pxd=-1)}function wac_39c(a,b){var c=wac_UHc(a),d=a.Pxd;do if(b?c&&(d=(d+1)%c.length):c&&(d=0<d?d-1:c.length-1),!d||1===d||c&&"none"!==document.getElementById(c[d]).style.display)return d;while(d!==a.Pxd);return 0}
function wac_29c(a,b){try{var c=wac_UHc(a);a.Pxd=wac_39c(a,b);a.Pxd?1===a.Pxd?a.ZXe.then(function(a){a.enterHeaderFocusTrapZone();return null}):c&&wac_Vj(document.getElementById(c[a.Pxd])):a.ZXe.then(function(a){a.enterFocusTrapZone();return null})}catch(d){wac_b(40743825,822,10,"VersionHistoryPaneActor: exception in SetupFocus callback: {0}.",d)}}
function wac_VHc(a){try{if(a.A7e)for(var b=0;b<a.A7e.length;b++)wac_2j(a.Dg,a.A7e[b]);else wac_b(41698514,822,10,"VersionHistoryPaneActor: editorActiveF6Focuses is null.");wac_3j(a.Dg,"VersionHistoryOverlay")}catch(c){wac_b(41698515,822,10,"VersionHistoryPaneActor: exception in DeactivateVersionHistoryFocus: {0}.",c)}wac_ng(a.ra,"VersionHistoryOverlay",!0);document.getElementById("VersionHistoryOverlay").style.display="none";wac_b(40208089,822,50,wac_ai(a.DRd))}
function wac_Dwc(a){a.V4d.getCloseSelectedEvent().addListener(function(){if(wac_q(wac_.pa,"PowerPointVersionHistoryFloodGateIsEnabled")){var b=wac_k(wac_j(),wac_Dc);b?(b.lCe("VersionHistoryExited",null),b.lCe("VersionHistoryCheckExited",null)):wac_b(41523081,822,50,"ISystemInitiatedFeedback was null")}wac_VHc(a)})}
function wac_XHc(a){for(var b=a.iNd,c=b.length,d=0;d<c;++d){var e=b[d],f=e.TelemetryEventKey?e.TelemetryEventKey:e.telemetryEventKey?e.telemetryEventKey:"",e=e.TelemetryEventData?e.TelemetryEventData:e.telemetryEventData?e.telemetryEventData:"";f&&e&&(a.Rta[f]=e)}}
function wac_RHc(a){a.V4d.getRestoreVersionSelectedEvent().addListener(function(b){wac_b(41022552,832,50,"VersionHistoryPaneActor:  RegisterForRestoreVersionSelectedEvent: {0}",b);var c=Date.now(),d="true"===wac_.pa.Qb.PodVHEnableCoauthRestore.toLowerCase();a.my?(a.Cgf=a.my.yse(),0<a.Cgf.length&&!d?(wac_b(41706369,832,15,"VersionHistoryPaneActor: restore failed because of {0} coauthors",a.Cgf.length),a.V4d.setCoauthRestoreError()):wac_49c(a,b,c)):(wac_b(41706368,832,10,"VersionHistoryPaneActor: presence manager is null"),
wac_49c(a,b,c))})}
function wac_49c(a,b,c){try{(new Promise(function(b,c){a.V4d.setRestoreInProgress();wac_B6c(a.hb.jh,a.hb.Jc,a.hb.Bj().Tj,wac_.pa.Qb[wac_2(361)],a.hb.Ota,function(){b(!0)},function(a){c("ClosePopWacSessionSync:: "+a.hh.AY)})})).then(function(){(new Promise(function(c,e){wac_C6c(a.hb.Bj().Tj,b,function(){c(!0)},function(a){e("RestoreFileVersion:: "+a.hh.AY)})})).then(function(){var b=Date.now()-c;wac_b(41997769,832,50,"VersionHistoryPaneActor: successfully restored version, refreshing now. Time: {0}",b);
a.DRd.RestoreSucceededTime=b;a.U.yw(2054778433,2,null)}).catch(function(b){var e=Date.now()-c;a.V4d.setRestoreFailedAtServer(function(){a.U.yw(2054778433,2,null)});wac_b(41706370,832,10,"VersionHistoryPaneActor: Failed to restore version: {0}, Time: {1}",b,e);a.DRd.RestoreFailedTime=e})})}catch(d){wac_b(41706371,832,10,"VersionHistoryPaneActor: Sending restore failed with message: {0}",d.message)}}
function wac_QHc(a){a.V4d.getSaveACopySelectedEvent().addListener(function(b){wac_b(40417503,822,10,"VersionHistoryPaneActor:  RegisterForSaveACopySelectedEvent: {0}",b);if(wac_q(wac_.pa,"PowerPointVersionHistoryFloodGateIsEnabled")){var c=wac_k(wac_j(),wac_Dc);c?c.lCe("VersionHistoryExited",null):wac_b(41754647,822,10,"ISystemInitiatedFeedback was null")}b=a.U.Wj(3050207199,2,{FileDownloadUrl:b},null);32!==b&&wac_b(40974167,832,10,"Failed to launch Save a Copy dialog. ActionResponse: {0}",b)})}
function wac_PHc(a){a.V4d.getDownloadTokenReadyEvent().addListener(function(b){try{if(wac_b(40481121,822,50,"VersionHistoryPaneActor - GetDownloadTokenReadyEvent called."),a.HIe)if(b&&b.updatedVersions&&2<=b.updatedVersions.length){var c=null,d=null,e=wac_NHc(a.D$d),f=wac_NHc(a.HIe),g=b.updatedVersions,h=g.length;for(b=0;b<h;++b){var k=g[b],l=wac_NHc(k);e===l?c=k:f===l&&(d=k);if(c&&d)break}c&&d?(a.D$d=c,a.HIe=d,a.s2a.diff(a.D$d,a.HIe)):wac_b(40665475,822,50,"VersionHistoryPaneActor - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",
e,f)}else wac_b(40665476,822,50,"VersionHistoryPaneActor - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");else wac_b(40665474,822,50,"VersionHistoryPaneActor - m_baseVersion is null in GetDownloadTokenReadyEvent callback.")}catch(m){wac_b(40481123,822,10,"VersionHistoryPaneActor: Exception in GetDownloadTokenReadyEvent callback: {0}",m)}})}
function wac_Cwc(a){a.V4d.getVersionSelectedEvent().addListener(function(b){a.D$d=b.currentVersion;a.HIe=b.baseVersion;if(a.s2a&&a.D$d.DownloadUrl.length)try{wac_XHc(a),wac_WHc(a),a.s2a.onVersionSelected(b.currentVersion,b.baseVersion,a.Rta),a.iNd=[],a.Rta={}}catch(c){wac_b(40122449,822,10,"VersionHistoryPaneActor: Exception in VersionSelectedEvent callback: {0}",c)}})}
function wac_Bwc(a){a.V4d.getVersionsReadyEvent().addListener(function(b){a.Lye(b.containerDiv);b=b.versions;for(var c=a.s2a.getAppDataStore(),d=b.length,e=0;e<d;++e)c.AddVersionInfoToStore(b[e]);wac_wg(a.ra,"VersionHistoryOverlay",!0);try{a.D$d&&a.D$d.DownloadUrl.length&&a.s2a&&(wac_XHc(a),wac_WHc(a),a.s2a.onVersionSelected(a.D$d,a.HIe,a.Rta),a.iNd=[],a.Rta={})}catch(f){wac_b(40122448,822,10,"VersionHistoryPaneActor: Exception in VersionReadyEvent callback: {0}",f)}})}
function wac_OHc(a){a.V4d.getFullAppErrorEvent().addListener(function(b){try{var c=wac_THc().TFa.K(b);a.DRd[wac_SHc]=c;wac_b(40489094,822,50,"FullApp Error Event: {0}, VersionHistoryLaunchSessionId: {1}",c,a.hWd)}catch(d){wac_b(40489095,822,10,"Exception in FullAppErrorEvent call back: {0}.",d)}})}
function wac_YHc(){this.TFa=new (wac_e.$$(Number,String));this.TFa.ga(0,wac_ZHc);this.TFa.ga(100,wac__Hc);this.TFa.ga(101,wac_0Hc);this.TFa.ga(102,wac_1Hc);this.TFa.ga(103,wac_2Hc);this.TFa.ga(104,wac_3Hc);this.TFa.ga(105,wac_4Hc);this.TFa.ga(106,wac_5Hc);this.sHa=new (wac_e.$$(Number,String));this.sHa.ga(0,wac_ZHc);this.sHa.ga(100,wac_6Hc);this.sHa.ga(101,wac_7Hc);this.sHa.ga(102,wac_8Hc);this.sHa.ga(103,wac_9Hc);this.sHa.ga(104,wac_$Hc);this.sHa.ga(105,wac_aIc);this.sHa.ga(106,wac_bIc)}
function wac_THc(){wac_cIc||(wac_cIc=new wac_YHc);return wac_cIc}wac_YHc.prototype={TFa:null,sHa:null};Type.registerNamespace("PowerPointVersionHistory");(function(){}).registerInterface("PowerPointVersionHistory.IDataStore");wac_JHc.registerClass("Common.App.VersionHistory.AppSettings");wac_KHc.registerClass("Common.App.VersionHistory.TelemetryInfo");wac_uwc.registerClass("Common.App.VersionHistory.VersionInfo");wac_vwc.registerClass("Common.App.VersionHistory.ControllerFactoryParameters");wac_wwc.registerClass("Common.App.VersionHistory.VersionSelectedObject");
wac_xwc.registerClass("Common.App.VersionHistory.VersionsReadyObject");wac_LHc.registerClass("Common.App.VersionHistory.DownloadTokenReadyObject");(function(){}).registerClass("PowerPointWebEditor.VersionHistory.Program");wac_ywc.registerClass("PowerPointWebEditor.VersionHistory.PPTWebEditorVersionHistoryPackageManager",null,wac_I,wac_i);wac_Awc.registerClass("PowerPointWebEditor.VersionHistory.VersionHistoryPaneActor",null,wac_MHc,Sys.IDisposable);(function(){}).registerClass("PowerPointWebEditor.VersionHistory.ErrorName");
wac_YHc.registerClass("PowerPointWebEditor.VersionHistory.VersionHistoryTelmetryHelper");
var wac_ZHc="None",wac__Hc="VHFailedToLoadVersionList",wac_0Hc="VHFailedToGetDownloadToken",wac_1Hc="VHFailedToParseVersionList",wac_2Hc="VHFetchFailed",wac_3Hc="VHVersioningNotEnabled",wac_4Hc="VHFileNotFound",wac_5Hc="VHVersionTooOld",wac_6Hc="VHFailedToRenderThumbnails",wac_7Hc="VHFailedToRenderSlide",wac_8Hc="VHFailedToRenderNotes",wac_9Hc="VHFailedToRenderDiff",wac_$Hc="VHFailedToShowAnimaitonIcon",wac_aIc="VHFailedToShowHiddenEffect",wac_bIc="VHFailedToRenderInitPresInfo",wac_SHc="ErrorCode",
wac_cIc=null;wac_J(wac_C(),wac_k4(new wac_ywc,0),0,!1);Type.registerNamespace("PowerPointLive");wac_7W=window.PowerPointLive||{};window.PowerPointLive.ILiveSessionURL=wac_7W.rQf=function(){};wac_7W.rQf.prototype={participantUrl:null,sessionQRCode:null};window.PowerPointLive.ILiveSessionState=wac_7W.qQf=function(){};wac_7W.qQf.prototype={isPrivate:!1,isPaused:!1,participantsCount:0,sessionURLPromise:null};window.PowerPointLive.ILiveActorSettings=wac_7W.oQf=function(){};
wac_7W.oQf.prototype={hostElement:null,welcomeScreenBackgroundImageUrl:null,welcomeScreenErrorImageUrl:null,baseZIndex:0,urlBarHeightInPercentage:0,welcomeScreenLayerHostId:null,calloutContainerId:null,urlBarLayerHostId:null,dialogLayerHostId:null,reactionsBarLayerHostId:null,showTryAgainButton:!1};window.PowerPointLive.ILiveReaction=wac_7W.pQf=function(){};wac_7W.pQf.prototype={react:null,reactionCount:0,reactionImagePath:null,numberOfAnimationFrames:0};
window.PowerPointLive.ILiveActor=wac_7W.yYf=function(){};
function wac_59c(a,b,c,d,e,f,g,h,k,l,m,n){this.KIf=Function.createDelegate(this,this.DRf);this.LIf=Function.createDelegate(this,this.ERf);this.JIf=Function.createDelegate(this,this.CRf);this.PJf=Function.createDelegate(this,this.JTf);this.Dsf=Function.createDelegate(this,this.oSf);this.HEe=Function.createDelegate(this,this.FMe);this.ktf=Function.createDelegate(this,this.tTf);this.u8e=Function.createDelegate(this,this.jlf);this.Rsf=Function.createDelegate(this,this.MSf);this.mtf=Function.createDelegate(this,
this.vTf);this.etf=Function.createDelegate(this,this.lTf);this.AGf=Function.createDelegate(this,this.ONf);this.DIf=Function.createDelegate(this,this.sRf);this.dtf=Function.createDelegate(this,this.kTf);this.ctf=Function.createDelegate(this,this.iTf);this.fjd=Function.createDelegate(this,this.SRd);this.xib=Function.createDelegate(this,this.Mie);this.la=new wac_Re;this.U7e=-1;this.ed=d;this.ua=a;this.Vaf=!1;this.ob=c;this.Cc=f;this.zc=g;this.IB=h;this.hb=k;this.Cia=l;this.X0=m;this.wxe=n;if(this.zD=
b)this.NWe=b.lC();this.zLd=e;this.kDf()?this.cie=1:this.cie=0;this.ua.Qcf&&this.ua.vbc&&(this.ua.ojf&&(this.Gpf=new wac_69c(this.ua)),this.ua.rwf&&wac_79c(this,"ConstructLivePresenter",null));this.ua.M5e&&(wac_XF(this.zc,this.xib),this.IB.la.xa("PODSU",this.fjd));wac_89c(this)&&this.X0.uc(function(a){a.Ki(ResourceStrings.L_LivePresentations_Disconnected,wac_6W.y9e);a.fd()});wac_Y(51459524,833,50,"LivePresenter: Host auth type is: "+this.ua.SZe)}
wac_59c.prototype={ua:null,zD:null,zc:null,IB:null,hb:null,Cia:null,X0:null,Vaf:!1,Uaf:!1,F7e:!1,Ogf:!1,B7e:!1,Z2e:!1,Qgf:!0,ob:null,ed:null,wxe:null,Dza:null,NWe:null,raa:null,waa:null,zLd:null,cie:0,Z7e:30,SPc:null,ume:null,Zz:null,yhf:0,trf:0,ogf:null,KWe:null,Gaf:null,Bpf:0,m8e:null,Gpf:null,Cc:null,l9d:null,Hja:null,Jc:null,JDf:null,sTa:function(){return this.ua.vbc&&(!this.ua.M5e||this.Qgf)},OTa:function(){return!!this.waa},t5e:function(a){return this.Vaf=a},hGf:function(a){return this.Uaf=
a},uaf:function(){return!!this.waa&&this.waa.isPaused},Nhf:function(a){return this.cie=a},kDf:function(){return"true"===wac_99c("wdDisablePrivateSession")?!1:this.ua.Qcf&&("aad"===this.ua.SZe||this.ua.G5e)},qUd:function(a,b,c,d,e,f,g,h){if(this.sTa()){this.ob.H4e(this.ctf);this.ob.J4e(this.dtf);this.B7e=!1;this.Z2e=!0;try{var k=wac_$9c(this,e,d);if(this.Dza)(this.Uaf||this.uaf())&&this.Dza.FetchDocumentDownloadURL(k);else{wac_Y(42869313,833,50,"Creating Broadcast monitor ...");var l=new window.PowerPointLive.PPTBroadcastMonitorSettings;
l.isBlueChicken=this.ua.G5e;l.fileDownloadUrl=k;l.rendezvousSvcBaseUri=this.ua.uTe;l.broadcastSubtitlesFromSpeechFrontDoor=this.ua.fif;l.pragueInitTimeoutInMS=this.ua.ywf;l.preferredSubtitleLanguage=wac_CZc(this.Cia);l.useStateService=this.ua.Gwf;l.numMaxAttempts=this.ua.Cwf;l.delayInSecsToCloseBroadcasterOnPause=this.ua.vwf;this.Dza=new window.PowerPointLive.PPTBroadcastMonitor(l);var m=this;this.Dza.RegisterParticipantsCountChangeEventListener(function(a){m.Zz.maxParticipantCount=Math.max(m.Zz.maxParticipantCount,
a);m.raa&&m.raa.setParticipantCount(a);m.la.wa("ParticipantsCountChanged",Sys.EventArgs.Empty,null)});this.ua.Q8e&&this.Dza.RegisterNewReactionEventListener(this.DIf);this.Dza.RegisterConnectionStateEventListener(this.AGf)}this.Dza.SetCurrentPosition(a,b-1,null);this.Bpf=a;if(this.Uaf&&!this.waa){var n=!!wac_r()&&wac_r().Hd().Bg();this.M9e(n?1:2,g,c,e,h);wac_a$c(this,a);this.KWe=new window.Set}else this.SPc&&wac_b$c(this);this.KWe&&this.KWe.add(a)}catch(p){wac_Y(42869315,833,10,"LivePresenter: Exception at creating Broadcast monitor: {0}",
p.toString())}}},jTf:function(){if(this.sTa()&&(this.ob.l5e(this.ctf),this.ob.m5e(this.dtf),this.Z2e=this.B7e=!1,this.OTa()&&this.raa)){wac_c$c(this);this.raa.hideAll();if(!this.SPc&&this.zD&&!wac_.ke){var a=String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.Z7e.toString()),a=new wac_a5a(ResourceStrings.l_LiveBusinessBarTitle_PausedSession,a,null);wac_KP(a,!0);wac_LP(a,this.JIf);a.Lja(3);wac_JP(a,ResourceStrings.l_LiveBusinessBarButton_ResumeSession,this.LIf,"",!1);wac_nTc(a,
ResourceStrings.l_LiveBusinessBarButton_EndSession,this.KIf);this.zD.bha().tG(a,!1,null);this.zD.mua();this.SPc=a}wac_89c(this)&&this.X0.Ga().fd()}},M9e:function(a,b,c,d,e){this.l9d=b;this.Hja=c;this.Jc=d;this.JDf=e;var f=wac_99c("wdSetLiveSessionId"),f="rdvSession_"+(f.length?f:wac_5k().toString());this.Zz=new window.PowerPointLive.LiveSessionTelemetry;this.Zz.sessionId=f;this.Zz.sessionStartUtc=(new Date).format("yyyy-MM-ddTHH:mm:ss.fffffff");this.Zz.accessControl=wac_7W.Hjf.toString(this.cie);
wac_d$c(this,"StartLiveBroadcasting");if(this.sTa()&&this.Dza&&wac_e$c(this)&&!this.waa){this.ob.I4e(this.Dsf);this.ob.V5e();var g=this;wac_f$c(this,a,b,c,d,e,f,function(){return wac_79c(g,"StartLiveBroadcasting",g.Zz.sessionId)})}else this.Zz.SetErrorCode(4),wac_Y(50648476,833,10,"StartLiveBroadcasting: Live actor or broadcast monitor is null while trying to start live session!");wac_d$c(this,"StartLiveBroadcasting")},d9e:function(a){if(this.sTa()&&this.OTa()&&this.Dza&&wac_e$c(this)){wac_g$c(this,
2);try{var b=this;wac_h$c(this,a,function(){b.Zz.sessionExitPoint=wac_7W.Pkf.toString(a);b.waa.isPaused||(b.Zz.sessionActiveDurationInMS+=b.O2d()-b.yhf);b.SPc&&wac_b$c(b);wac_i$c(b);wac_89c(b)&&b.X0.Ga().fd();wac_Y(42869329,833,50,"SessionId: {0}, Message: End live broadcasting ...",b.Zz.sessionId);b.raa.actOnSessionEnded();b.ob.h8e(b.etf);b.ob.vLe(b.u8e);b.ob.n5e(b.ktf);b.ob.o5e(b.mtf);b.wxe.la.sb("NCCE",b.HEe);b.ua.M5e&&b.ob.Obf(b.Rsf);b.Z2e&&b.ob.c5d(!1,"");b.waa=null;b.Gaf=null;b.la.wa("OnLiveSessionEnded",
Sys.EventArgs.Empty,null);if(3!==a){var c=b.Dza.EndLiveBroadcasting(function(){return wac_79c(b,"EndLiveBroadcasting",b.Zz.sessionId)});c?c.then(function(){wac_d$c(b,"EndLiveBroadcasting");wac_Y(42869331,833,50,"SessionId: {0}, Message: EndLiveBroadcasting web service call succeeded!",b.Zz.sessionId)}).catch(function(a){b.Zz.SetErrorCode(7);wac_d$c(b,"EndLiveBroadcasting");wac_Y(50452498,833,10,"SessionId: {0}, Message: EndLiveBroadcasting web service call failed due to error!, Details: {1}",b.Zz.sessionId,
a.toString())}):(b.Zz.SetErrorCode(7),wac_Y(42869333,833,10,"SessionId: {0}, Message: EndLiveBroadcasting failed to created Promise object!"))}else b.Dza.CleanUpBroadcastBeforeEnd(),wac_Y(594061319,833,50,"SessionId: {0}, Message: Skipping EndLiveBroadcasting web service call");wac_d$c(b,"EndLiveBroadcasting")})}catch(c){this.Zz.SetErrorCode(7),wac_Y(42869335,833,10,"SessionId: {0}, Message: Exception when ending live session!, Details: {1}",this.Zz.sessionId,c.toString())}finally{3!==a&&this.amf(),
wac_d$c(this,"EndLiveBroadcasting")}}},eSa:function(a){this.sTa()&&this.raa&&(this.Ogf=!0,this.raa.showCallout(a))},Azf:function(){this.sTa()&&this.raa&&this.raa.showWelcomeScreen()},Nlf:function(a,b){this.sTa()&&this.OTa()&&this.raa&&this.raa.showEndSessionDialogWithCallbacks(a,b)},q2e:function(a){if(this.NWe&&this.raa){var b=this;window.setTimeout(function(){wac_Vj(b.NWe.ownerDocument.getElementById(a))},50)}},lTf:function(){if(this.sTa()&&this.Dza)if(this.uaf()){var a=this;window.setTimeout(function(){a.la.wa("OnRelaunchPausedSession",
Sys.EventArgs.Empty,null)},500);wac_j$c(this)}else this.waa&&this.raa&&this.raa.isWelcomeScreenVisible()&&this.q2e("LiveWelcomeScreenLayerHost")},jlf:function(a,b){this.sTa()&&this.Dza&&(this.Dza.SetCurrentPosition(b.Ls,b.En,b.O5e),this.Bpf!==b.Ls&&wac_k$c(this),this.Bpf=b.Ls,this.KWe&&this.KWe.add(b.Ls))},iTf:function(){this.B7e=!0;this.sTa()&&this.OTa()&&this.raa&&(this.raa.hideURLBar(),wac_l$c(this,0),wac_g$c(this,0))},kTf:function(){this.B7e=!1;this.sTa()&&this.OTa()&&this.raa&&this.raa.showURLBar()},
tTf:function(a,b){this.sTa()&&this.OTa()&&this.Dza&&(b.wuf?this.Dza.UpdateFinalSubtitles(b.Cjf):this.Dza.UpdatePartialSubtitles(b.Cjf))},vTf:function(a,b){this.Zz.transcriberSessionIds+=b.Pxf+",";this.sTa()&&this.OTa()&&this.ob.c5d(!0,this.Dza.GetPragueSessionInfoJSONString())},JTf:function(){--this.Z7e;0>=this.Z7e?(wac_b$c(this),this.d9e(3)):this.SPc&&this.SPc.Hua(String.format(ResourceStrings.l_LiveBusinessBarMessage_PausedSession,this.Z7e.toString()))},CRf:function(a){a===this.SPc&&(this.SPc=null)},
ERf:function(a){a===this.SPc&&this.raa&&(wac_b$c(this),wac_z().yw(1989200744,2,null))},DRf:function(a){a===this.SPc&&this.raa&&this.raa.showEndSessionDialog()},O2d:function(){return(new Date).getTime()},oSf:function(a,b){this.ob&&this.Dza&&b&&(this.ob.OXe(this.Dsf),this.Dza.SetCurrentPosition(b.Ls,b.En,b.O5e))},xOf:function(){return wac_e$c(this)?this.raa.getCalloutMenuDefinition():null},sRf:function(a){if(this.ume&&!this.uaf()){for(var b=this.ume,c=b.length,d=0;d<c;++d){var e=b[d];if(e.react===a.react){e.reactionCount+=
1;b=this.m8e.has(a.slideId)?this.m8e.get(a.slideId)+1:1;this.m8e.set(a.slideId,b);break}}if(this.raa){a=Array(this.ume.length);for(b=0;b<this.ume.length;b++){var f;a[b]=(f=new window.PowerPointLive.ILiveReaction,f.react=this.ume[b].react,f.reactionCount=this.ume[b].reactionCount,f.reactionImagePath=this.ume[b].reactionImagePath,f.numberOfAnimationFrames=this.ume[b].numberOfAnimationFrames,f)}this.raa.setReactions(a)}}},ONf:function(a){if(wac_89c(this))switch(a){case 0:this.Z2e&&this.X0.Ga().Ki(ResourceStrings.L_LivePresentations_Disconnected,
wac_6W.P3e);this.Zz.SetErrorCode(3);wac_d$c(this,"DisconnectdToPrague");break;case 1:this.X0.Ga().fd();break;case 2:this.Z2e&&this.X0.Ga().Ki(ResourceStrings.L_LivePresentations_Connecting,wac_6W.y9e);break;default:wac_Y(594416918,833,10,"SessionId: {0}, Message: Unhandled connection state value.",this.Zz.sessionId)}else wac_Y(594416920,833,10,"SessionId: {0}, Message: Cannot show notification for service connectivity.",this.Zz.sessionId)},FMe:function(a,b){wac_89c(this)?b.E9d?this.X0.Ga().fd():this.Z2e&&
this.X0.Ga().Ki(ResourceStrings.L_LivePresentations_InternetDisconnected,wac_6W.y9e):wac_Y(594416916,833,10,"SessionId: {0}, Message: Cannot show notification for network connectivity.",this.Zz.sessionId)},Mie:function(){try{if(this.Qgf=!0,this.ua.M5e&&this.sTa()&&this.OTa()&&this.Dza){wac_Y(51423366,833,50,"SessionId: {0}, Message:OnPodSessionRehydrated: Updating file download Url for DC: {1}",this.Zz.sessionId,this.hb.mD);var a=wac_$9c(this,this.hb.Jc,this.hb.mD);this.Dza.OnPodSessionUpdated(a)}}catch(b){wac_Y(51496722,
833,10,"LivePresenter: Exception at OnPodSessionRehydrated: {0}",b.toString())}},SRd:function(){this.Qgf=!1},MSf:function(){this.Qgf=!1},amf:function(){if(this.ua.Avf)try{var a=wac_l(wac_j(),wac_Dc);a&&(wac_Y(594409295,833,50,"LivePresenter: Floodgate survey triggered for PPTLive"),a.uc(function(a){a.lCe("PPTWebLivePresentationsActivity","PPTLivePresentationsFloodgateSurveyEnabled")}))}catch(b){wac_Y(594409293,833,10,"LivePresenter: Exception thrown when trying to trigger floodgate survey. Exception: {0}",
b)}},fXf:function(a){this.la.xa("OnLiveResourcesLoaded",a)},eYf:function(a){this.la.sb("OnLiveResourcesLoaded",a)},hDf:function(a){this.la.xa("OnLiveSessionStarted",a)},eGf:function(a){this.la.sb("OnLiveSessionStarted",a)},gDf:function(a){this.la.xa("OnLiveSessionEnded",a)},dGf:function(a){this.la.sb("OnLiveSessionEnded",a)},cXf:function(a){this.la.xa("OnCalloutDismissed",a)},bYf:function(a){this.la.sb("OnCalloutDismissed",a)},fDf:function(a){this.la.xa("OnRelaunchPausedSession",a)},cGf:function(a){this.la.sb("OnRelaunchPausedSession",
a)},dXf:function(a){this.la.xa("CalloutMenuDefinitionChanged",a)},cYf:function(a){this.la.sb("CalloutMenuDefinitionChanged",a)}};function wac_h$c(a,b,c){try{var d=new (wac_g.$$(Promise));if(1===b||2===b||4===b)d.ga(wac_l$c(a,2)),d.ga(wac_g$c(a,2));d.Ma()?Promise.all(d.xe()).then(function(){return c()}).catch(function(){return c()}):c()}catch(e){wac_Y(594367971,833,10,"failed to create end session task promises, error : {0}",e),c()}}
function wac_$9c(a,b,c){b=String.format("{0}PodHandler.ashx?action=GetSnappedDownloadLink&PodSID={1}&waccluster={2}",a.ua.M4,b,c);a.ua.Fwf&&(b+="&shareable=true");return b}function wac_89c(a){return a.ua.B2c&&a.X0&&a.X0.Ga()?!0:!1}
function wac_g$c(a,b){return new Promise(function(c){if(a.ua.Awf&&a.ua.Q8e&&a.sTa()&&a.Dza&&a.waa)try{if(1>a.m8e.size)wac_Y(595121249,833,50,"SessionId: {0}, Message: No reactions, skip save thumbnails request, Reason: {1}",a.Zz.sessionId,b),c(!0);else if(1===b&&(!a.KWe||1>a.KWe.size))wac_Y(595121247,833,50,"SessionId: {0}, Message: No slide presented, skip save thumbnails request, Reason: {1}",a.Zz.sessionId,b),c(!0);else{var d=null,e=0;a.m8e.forEach(function(a,b){a>e&&(d=b.toString(),e=a)});var f=
a.Dza.TriggerSaveThumbnails(function(){return wac_79c(a,"SaveThumbnails",a.Zz.sessionId)},d);f?f.then(function(){wac_Y(595121245,833,50,"SessionId: {0}, Message: Triggering save thumbnails call succeeded, Reason: {1}",a.Zz.sessionId,b);c(!0)}).catch(function(d){wac_Y(595121243,833,10,"SessionId: {0}, Message: Triggering save thumbnais call failed due to error!, Details: {1}, Reason: {2}",a.Zz.sessionId,d.toString(),b);c(!1)}):(a.Zz.SetErrorCode(15),wac_Y(595121241,833,10,"SessionId: {0}, Message: Triggering save thumbnails failed to created Promise object!"),
c(!1))}}catch(g){a.Zz.SetErrorCode(15),wac_Y(595121239,833,10,"SessionId: {0}, Message: Exception when triggering save thumbnails, Details: {1}",a.Zz.sessionId,g.toString()),c(!1)}else c(!0)})}function wac_k$c(a){if(a.ua.Q8e&&a.ume){for(var b=a.ume,c=b.length,d=0;d<c;++d)b[d].reactionCount=0;a.raa&&a.raa.resetReactions()}}
function wac_m$c(a){var b,c,d,e,f,g;a.ume=[(b=new window.PowerPointLive.ILiveReaction,b.react="yes",b.reactionCount=0,b.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/yes/default/240_anim_f/yes.png",b.numberOfAnimationFrames=40,b),(c=new window.PowerPointLive.ILiveReaction,c.react="heart",c.reactionCount=0,c.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/heart/default/240_anim_f/heart.png",c.numberOfAnimationFrames=16,c),(d=
new window.PowerPointLive.ILiveReaction,d.react="clap",d.reactionCount=0,d.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/clap/default/240_anim_f/clap.png",d.numberOfAnimationFrames=40,d),(e=new window.PowerPointLive.ILiveReaction,e.react="laugh",e.reactionCount=0,e.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/laugh/default/240_anim_f/laugh.png",e.numberOfAnimationFrames=77,e),(f=new window.PowerPointLive.ILiveReaction,f.react=
"surprised",f.reactionCount=0,f.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/surprised/default/240_anim_f/surprised.png",f.numberOfAnimationFrames=68,f),(g=new window.PowerPointLive.ILiveReaction,g.react="wonder",g.reactionCount=0,g.reactionImagePath="https://cdn.hubblecontent.osi.office.net/getty/publish/reactions/wonder/default/240_anim_f/wonder.png",g.numberOfAnimationFrames=70,g)];a.m8e=new window.Map}
function wac_l$c(a,b){return new Promise(function(c){if(a.ua.Pcf&&a.sTa()&&a.Dza&&a.waa&&a.Gaf)try{a.Gaf.then(function(d){var e=!1;switch(b){case 1:if(!a.KWe||!a.ogf||10*a.KWe.size<8*a.ogf.size){c(!0);return}break;case 2:e=!0}var f={triggeredSurveyType:"Survey.AudienceFeedback"};f.isMandatory=e;f.triggerEventId=wac_5k().toString();f.surveyeeName=wac_.J0;a.ua.njf&&(d?(f.surveyId=d.surveyId,f.surveyResponseUrl=d.surveyResponseUrl):wac_Y(51168984,833,10,"SessionId: {0}, Message: Audience feedback survey info is not valid!",
a.Zz.sessionId));a.Dza.TriggerSurvey(JSON.stringify(f));wac_Y(50860052,833,50,"SessionId: {0}, Message: Triggering audience feedback!, Details: {1}",a.Zz.sessionId,b);c(!0)}).catch(function(b){wac_Y(51168987,833,10,"SessionId: {0}, Message: Failed to trigger audience feedback as CreateSurvey request failed due to error!, Details: {1}",a.Zz.sessionId,b.toString());a.Zz.SetErrorCode(13);c(!1)})}catch(d){a.Zz.SetErrorCode(17),wac_Y(50860054,833,10,"SessionId: {0}, Message: Exception when collecting show info for triggering audience feedback!, Details: {1}",
a.Zz.sessionId,d.toString()),c(!1)}else c(!0)})}function wac_a$c(a,b){if(a.ua.Pcf&&a.Cc)try{var c=wac_FI(a.Cc),d=!1,e=!1;a.ogf=new window.Set;for(var f=c.length,g=0;g<f;++g){var h=c[g];d||h.Vc()!==b||(d=!0,e=h.qS());!d||h.qS()&&!e||a.ogf.add(h.Vc());e&&!h.qS()&&(e=!1)}}catch(k){a.Zz.SetErrorCode(16),wac_Y(50860050,833,10,"SessionId: {0}, Message: Exception when collecting slide show info for triggering audience feedback!, Details: {1}",a.Zz.sessionId,k.toString())}}
function wac_d$c(a,b){a.Zz.action=b;a.Zz.sessionDurationInMS=a.O2d()-a.trf;b=a.ua.uTe.toLowerCase();-1!==b.indexOf("pptservicescast.officeapps.live.com")?a.Zz.rendezvousServiceEnvironment="prod":-1!==b.indexOf("pptservicescast.edog.officeapps.live.com")?a.Zz.rendezvousServiceEnvironment="edog":-1!==b.indexOf("pptservicescast.officeapps.live-int.com")?a.Zz.rendezvousServiceEnvironment="int":a.Zz.rendezvousServiceEnvironment="dev";wac_Y(50706442,833,50,JSON.stringify(a.Zz))}
function wac_79c(a,b,c){if(!a.ua.vbc||!a.ua.Qcf||!a.cie&&a.ua.G5e)return new Promise(function(a){a(null)});var d=a.ua.ojf;return!d&&!a.zLd||d&&!a.Gpf?(wac_Y(50452300,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, isDirectAuth: {2}, Auth manager or helper is null",b,c,d),new Promise(function(a,b){b(null)})):new Promise(function(e,f){var g=a.ua.SZe,h="";if("aad"===g||a.ua.G5e)h=a.ua.Bvf;else if("msa"===g)h=a.ua.zvf;else{wac_Y(51512226,833,10,"LivePresenter::GetToken - action: {0}, session id: {1}, hostAuthType is not aad or msa",
b,c);f(null);return}var k=wac_.pa.Qb.UiHost;!k&&(k="Unset");var l=new Date,m=null,m=d?wac_n$c(a.Gpf,a.ua.uwf,a.ua.swf,h,a.ua.Dwf):a.zLd.b4e(a.ua.yvf,h);m.then(function(a){wac_Y(51197915,833,50,"LivePresenter::GetToken -  host auth type: {0}, action: {1}, session id: {2}, is success: {3}, time (in ms): {4}, error code: {5}, error message: {6}, isDirectAuth: {7}",g,b,c,a.IsSuccess,new Date-l,a.ErrorCode,a.ErrorMessage,d);a.IsSuccess?e(a.Token):(wac_Y(50452304,833,15,"LivePresenter::GetToken - host auth type: {0}, action: {1}, session id: {2}, failed to get AAD token with error code: {3}, error message: {4}, isDirectAuth: {5}, isAnonymousUser: {6}, uiHost: {7}",
g,b,c,a.ErrorCode,a.ErrorMessage,d,wac_.pa.Qb.IsAnonymousUser,k),f(null))}).catch(function(a){wac_Y(50452306,833,50,"LivePresenter::GetToken - host auth type: {0}, action: {1}, session id: {2}, time taken to get exception when fetching auth token (in ms): {3}, isDirectAuth: {4}",g,b,c,new Date-l,d);wac_Y(50452308,833,15,"LivePresenter::GetToken - host auth type: {0}, action: {1}, sessionId: {2}, threw exception: {3}, isDirectAuth: {4}, isAnonymousUser: {5}, uiHost:{6}",g,b,c,a,d,wac_.pa.Qb.IsAnonymousUser,
k);f(null)})})}function wac_b$c(a){a.zD&&a.SPc&&a.zD.bha().nda(a.SPc.ia())&&(a.zD.bha().xV(a.SPc),a.zD.mua(),a.SPc.dispose(),a.SPc=null)}function wac_i$c(a){-1!==a.U7e&&(window.clearInterval(a.U7e),a.U7e=-1)}function wac_o$c(a){-1!==a.U7e&&window.clearInterval(a.U7e);a.Z7e=30;a.U7e=window.setInterval(a.PJf,6E4)}
function wac_e$c(a){if(a.sTa()&&!a.raa&&a.NWe){var b=new window.PowerPointLive.ILiveActorSettings;b.hostElement=a.NWe;b.baseZIndex=50005;b.welcomeScreenBackgroundImageUrl=a.ed.Io("LiveWelcomeScreenBackground.png");b.welcomeScreenErrorImageUrl=a.ed.Io("LiveWelcomeScreenError.png");b.welcomeScreenLayerHostId="LiveWelcomeScreenLayerHost";b.calloutContainerId="LiveCalloutContainer";b.urlBarLayerHostId="LiveURLBarLayerHost";b.dialogLayerHostId="LiveDialogLayerHost";b.reactionsBarLayerHostId="LiveReactionBarLayerHost";
b.showTryAgainButton=a.ua.Bwf;a.raa=window.liveActor.LiveActorFactory.CREATE_LIVE_ACTOR(b);a.raa.on("OnWelcomeScreenOpenedAction",function(){a.q2e("LiveWelcomeScreenLayerHost");a.Zz.welcomeShownCount+=1});a.raa.on("OnWelcomeScreenClosedAction",function(){a.B7e&&a.raa.hideURLBar();a.ob.U6();a.Dza.SetWelcomeScreenState(!1)});a.raa.on("ResumeSessionAction",function(){wac_j$c(a);a.B7e||a.raa.showURLBar()});a.raa.on("EndSessionAction",function(){a.d9e(a.Z2e?1:2);a.ob.U6()});a.raa.on("OnCalloutOpenedAction",
function(){a.Ogf=!0;a.la.wa("OnCalloutOpened",Sys.EventArgs.Empty,null);a.Zz.calloutShownCount+=1});a.raa.on("OnCalloutClosedAction",function(){a.Ogf=!1;a.la.wa("OnCalloutDismissed",Sys.EventArgs.Empty,null);a.ob.U6()});a.raa.on("OnEndSessionDialogOpenedAction",function(){a.q2e("LiveDialogLayerHost")});a.raa.on("OnEndSessionDialogClosedAction",function(){a.Z2e&&a.ob.U6()});a.raa.on("OnCalloutMenuDefinitionChangedAction",function(){a.la.wa("CalloutMenuDefinitionChanged",Sys.EventArgs.Empty,null)});
a.raa.on("OnTryAgainAction",function(){wac_Y(594587674,833,15,"SessionId: {0}, Message: OnTryAgainAction called.",a.Zz.sessionId);a.M9e(5,a.l9d,a.Hja,a.Jc,a.JDf)})}return!!a.raa}function wac_p$c(a){a.raa.isWelcomeScreenVisible()||a.Azf();a.raa.onSessionRequestError()}
function wac_j$c(a){if(a.sTa()&&a.OTa()&&a.Dza&&wac_e$c(a)&&a.waa.isPaused)try{a.yhf=a.O2d(),a.Zz.sessionResumeCount+=1,wac_Y(50452492,833,50,"SessionId: {0}, Message: Resume live broadcasting ...",a.Zz.sessionId),wac_k$c(a),a.raa.actOnSessionResumed(),a.Dza.ResumeLiveBroadcasting(function(){return wac_79c(a,"ResumeLiveBroadcasting",a.Zz.sessionId)}),a.waa.isPaused=!1,a.la.wa("OnLiveSessionResumed",Sys.EventArgs.Empty,null),wac_i$c(a),a.ob.c5d(!0,a.Dza.GetPragueSessionInfoJSONString())}catch(b){a.Zz.SetErrorCode(6),
wac_Y(50452494,833,10,"SessionId: {0}, Message: Exception when resuming Live session, Details: {1}",a.Zz.sessionId,b.toString())}finally{wac_d$c(a,"ResumeLiveBroadcasting")}}
function wac_c$c(a){if(a.sTa()&&a.OTa()&&a.Dza&&wac_e$c(a)&&!a.waa.isPaused){wac_l$c(a,1);wac_g$c(a,1);try{a.Zz.sessionPauseCount+=1,a.Zz.sessionActiveDurationInMS+=a.O2d()-a.yhf,wac_Y(42869327,833,50,"SessionId: {0}, Message: Pause live broadcasting ...",a.Zz.sessionId),a.raa.actOnSessionPaused(),a.waa.isPaused=!0,a.Dza.PauseLiveBroadcasting(function(){return wac_79c(a,"PauseLiveBroadcasting",a.Zz.sessionId)}),a.la.wa("OnLiveSessionPaused",Sys.EventArgs.Empty,null),wac_o$c(a),a.ob.c5d(!1,"")}catch(b){a.Zz.SetErrorCode(5),
wac_Y(50452490,833,10,"SessionId: {0}, Message: Exception when pausing Live session, Details: {1}",a.Zz.sessionId,b.toString())}finally{wac_d$c(a,"PauseLiveBroadcasting")}}}function wac_99c(a){a=new RegExp(String.format("[\\?&]{0}=([^&#]*)",a));return(a=window.location.search.match(a))&&2===a.length?a[1]:""}
function wac_q$c(a,b){var c=wac_z6c(a.Cia,a.Cia.E5b);c?a.Dza.SetDefaultSubtitlesLanguage(c):wac_Y(595140894,833,10,"SessionId: {0}, Message: Failed to set default subtitle language.",a.Zz.sessionId);a.ob.c5d(!0,a.Dza.GetPragueSessionInfoJSONString());a.ob.WTe(a.u8e);a.ob.K4e(a.ktf);a.q2e("LiveWelcomeScreenLayerHost");a.la.wa("OnLiveSessionStarted",b.sessionInfo,null);a.ua.Pcf&&(a.Gaf=a.ua.njf?a.Dza.CreateSurvey(b.authToken,null):new Promise(function(a){a(null)}),a.Gaf.then(function(b){if(b){var c=
{};c.surveyeeName=wac_.J0;c.surveyId=b.surveyId;c.surveyResponseUrl=b.surveyResponseUrl;a.Dza.SetAudienceFeedbackInfo(JSON.stringify(c))}}));a.wxe.tb()?a.wxe.la.xa("NCCE",a.HEe):wac_Y(594416981,833,10,"SessionId: {0}, Message: NetworkConnectivityProvider init failed.",a.Zz.sessionId)}
function wac_f$c(a,b,c,d,e,f,g,h){try{a.trf=a.O2d();a.yhf=a.O2d();a.Zz.sessionEntryPoint=wac_7W.Okf.toString(b);a.Zz.isSubtitleStartedByLive=a.Vaf;var k=new window.PowerPointLive.RendezvousSessionConfig;k.userSessionId=c;k.webServiceBase=d;k.podSessionId=e;k.docId=f;k.sessionId=g;k.accessControl=1===a.cie?"organization":"anyone";k.authTokenFunc=h;k.locale=wac_.lHe;k.presentationName=wac_kP(wac_.Vxa);k.slideHeight=a.Cc.Kna(!0).qc;k.slideWidth=a.Cc.Kna(!0).ac;a.ua.Ewf||(k.fileName=wac_.Vxa,k.bootstrapperUrl=
a.ua.gqc);var l=a.Dza.StartLiveBroadcasting(k,a.Zz,!a.ua.$if);a.ua.Q8e&&wac_m$c(a);if(l){var m=l.then(function(a){var b=new window.PowerPointLive.ILiveSessionURL;b.participantUrl=a.sessionInfo.shortParticipantUrl;b.sessionQRCode=a.sessionInfo.sessionQRCode;return b});a.waa=new window.PowerPointLive.ILiveSessionState;a.waa.isPrivate=1===a.cie;a.waa.isPaused=!1;a.waa.participantsCount=0;a.waa.sessionURLPromise=m;a.raa.actOnSessionRequested(a.waa);a.ob.m7e(a.etf);a.ob.L4e(a.mtf);a.ua.M5e&&a.ob.kaf(a.Rsf);
l.then(function(b){a.Zz.pragueDocId=b.sessionInfo.pragueDocId;a.Zz.sessionCreationWebServiceCallTimeInMS=a.O2d()-a.trf;a.Zz.startAttemptCount=b.numAttempt;wac_Y(50452483,833,50,"SessionId: {0}, Message: StartLiveBroadcasting succeeded!, TimeElapsed: {1}",a.Zz.sessionId,a.Zz.sessionCreationWebServiceCallTimeInMS.toString());a.ua.$if?a.Dza.InitializeStateService().then(function(){wac_q$c(a,b);wac_d$c(a,"StartLiveBroadcasting")}).catch(function(b){wac_Y(594330467,833,10,"SessionId: {0}, Message: failed to connect state service due to error!, Details: {1}",
a.Zz.sessionId,b.toString());a.Zz.SetErrorCode(2);wac_d$c(a,"StartLiveBroadcasting");wac_p$c(a)}):wac_q$c(a,b);wac_d$c(a,"StartLiveBroadcasting")}).catch(function(b){wac_Y(42869319,833,10,"SessionId: {0}, Message: StartLiveBroadcasting failed due to error!, Details: {1}",a.Zz.sessionId,b.toString());a.Zz.SetErrorCode(4);wac_d$c(a,"StartLiveBroadcasting");wac_p$c(a)})}else wac_p$c(a),a.Zz.SetErrorCode(4),wac_Y(42869321,833,10,"StartLiveBroadcasting failed to create Promise object!")}catch(n){wac_p$c(a),
a.Zz.SetErrorCode(4),wac_Y(42869323,833,10,"SessionId: {0}, Message: Exception when staring a new Live session, Details: {1}",a.Zz.sessionId,n.toString())}finally{wac_d$c(a,"StartLiveBroadcasting")}}function wac_r$c(){}wac_r$c.prototype={id:null,frame:null,resolve:null,reject:null,lGf:0,fGf:null,Hbf:0};function wac_s$c(){}wac_s$c.prototype={timeStamp:null,mGf:null};function wac_t$c(a){this.rpf={};this.KDf=a}wac_t$c.prototype={KDf:10};
function wac_u$c(a,b){return b in a.rpf&&(b=window.$$as(wac_s$c,a.rpf[b]),new Date-b.timeStamp<6E4*a.KDf)?b.mGf:null}function wac_69c(a){this.EKf=Function.createDelegate(this,this.HUf);this.phf={};this.ua=a;this.ubf=this.ua.xwf?new wac_t$c(this.ua.wwf):null;window.addEventListener("message",this.EKf,!1)}
wac_69c.prototype={ubf:null,ua:null,HUf:function(a){if("data"in a){var b,c,d;(d=wac_dP(Object,a.data,c={val:b}),b=c.val,d)&&b&&"DirectAuthRequestID"in b&&wac_v$c(this,b)}},akf:function(a){var b=window.location.protocol,c=window.location.host;wac_Y(594113502,833,50,"DirectAuth: ConstructReplyUrl: Protocol: {0}, Host: {1}, IsReplyUrlRegistered: {2}",b,c,"ffc-powerpoint.officeapps.live.com"===c||"ppc-powerpoint.officeapps.live.com"===c);if(wac_h(a)){a=window.location.pathname;var d=a.lastIndexOf("/");
a=0<=d?a.substring(0,d+1):""}return b+"//"+c+a+"WacDirectAuth.html"}};
function wac_w$c(a,b){return new Promise(function(c,d){var e=b/50,f=0;a.Hbf=window.setInterval(function(){try{f++>e&&(window.clearInterval(a.Hbf),wac_Y(594068418,833,15,"DirectAuth: WindowHashPoller: Exceeded {0} ms timeout after {1} polls",b,e),d(""));var g=a.frame.contentWindow;!g&&g.closed&&(window.clearInterval(a.Hbf),wac_Y(594068416,833,15,"DirectAuth: WindowHashPoller: Window or Frame is closed before completion"),d(""));var h=null,k=null;try{h=g.location.href,k=g.location.hash}catch(l){}h&&
"about:blank"!==h?k&&(window.clearInterval(a.Hbf),c(k)):wac_Y(594068386,833,15,"DirectAuth: WindowHashPoller: Don't process blank pages or cross domain: {0}","about:blank"===h)}catch(l){wac_Y(594068384,833,15,"DirectAuth: WindowHashPoller: threw exception {0}",l.message)}},50)})}
function wac_n$c(a,b,c,d,e){var f=wac_.pa.Qb.UserPrincipalName;if(!b)throw Error.argumentNull("authority");if(!c)throw Error.argumentNull("appId");if(!d)throw Error.argumentNull("resource");if(!a.ua.Rcf&&!f)throw Error.argumentNull("userUPN");var g=!!f&&f.indexOf("@")<f.indexOf("."),h=a.akf("/p/"),k=String.format("{0}/common/oauth2/authorize?response_type=token&scope=openid&domain_hint=organizations&client_id={1}&resource={2}&redirect_uri={3}&prompt=none",b,c,window.encodeURIComponent(d),window.encodeURIComponent(h));
if(a.ubf){var l=wac_u$c(a.ubf,k);if(l)return wac_Y(594134859,833,50,"DirectAuth: Found valid cached token and use it!"),new Promise(function(a){var b=new wac_l7c;b.IsSuccess=!0;b.ErrorCode="";b.ErrorMessage="";b.Token=l;a(b)})}var m=wac_5k().toString();b=g&&!a.ua.Rcf?String.format("{0}&login_hint={1}&state={2}",k,window.encodeURIComponent(f),m):String.format("{0}&state={1}",k,m);var n=document.createElement("iframe");n.style.display="none";n.src=b;return new Promise(function(b,c){var d=new wac_r$c;
d.frame=n;d.resolve=b;d.reject=c;d.id=m;d.fGf=k;document.body.appendChild(n);wac_Y(594405504,833,50,"DirectAuth: New request created with ID of: {0}, IsUserUPNAlias: {1}, LoginHintNotSent: {2}",m,g,a.ua.Rcf);a.ua.Scf&&wac_w$c(d,1E3*e).then(function(){var b={};b.DirectAuthRequestID=m;b.FromPolling=!0;wac_v$c(a,b)});d.lGf=window.setTimeout(function(){var b={};b.DirectAuthRequestID=m;b.Timeouted=!0;wac_Y(594405464,833,10,"DirectAuth: Request timedout with ID of: "+m);wac_v$c(a,b)},1E3*e);a.phf[m]=d})}
function wac_v$c(a,b){try{var c=b.DirectAuthRequestID;if(c in a.phf){var d=null,e=window.$$as(wac_r$c,a.phf[c]);if(e&&e.id===c){wac_Y(594405506,833,50,"DirectAuth: Request completed with request ID: {0}, IsTimedOut: {1}, IsFromPolling",c,"Timeouted"in b,"FromPolling"in b);window.clearTimeout(e.lGf);delete a.phf[c];a.ua.Scf&&window.clearTimeout(e.Hbf);var f=new wac_l7c;f.IsSuccess=!1;f.ErrorCode="";f.ErrorMessage="";f.Token="";if("Timeouted"in b)f.ErrorCode="Timeout",f.ErrorMessage="No response received in time for the authentcation request",
e.reject(f);else{var g=e.frame.contentWindow.location.hash;b={};for(var c=/[#?&]+([^=&]+)=([^&]*)/gi,h;h=c.exec(g);)b[window.$$as(String,h[1])]=window.$$as(String,h[2]);d=b;if("access_token"in d){f.IsSuccess=!0;f.Token=window.$$as(String,d.access_token);if(a.ubf){var k=a.ubf,l=e.fGf,m=f.Token;if(l&&m){var n=new wac_s$c;n.mGf=m;n.timeStamp=new Date;k.rpf[l]=n}}e.resolve(f)}else f.ErrorCode=window.$$as(String,d.error),f.ErrorMessage=window.$$as(String,d.error_description),e.reject(f)}document.body.removeChild(e.frame)}else wac_Y(594068425,
833,10,"DirectAuth: Failed to find the request entry for ID: {0}",c)}else wac_Y(594405508,833,a.ua.Scf?50:10,"DirectAuth: Request response doesn't have request ID! Details: "+JSON.stringify(b))}catch(p){wac_Y(594375829,833,10,"DirectAuth: Excpetion thrown when handling completion response: "+p.message)}}Type.registerNamespace("PowerPointWebEditor.Live");wac_Z=window.PowerPointWebEditor||{};wac_Z.iRf=wac_Z.iRf||{};function wac_x$c(){this.SB=Function.createDelegate(this,this.sC)}
wac_x$c.prototype={J:null,$Ef:0,Ub:function(){return"PowerPointWebEditor.Live"},gc:function(a){this.J=a;var b=this.J.H(wac_kG),c=this;wac_m(wac_n(this.J.fa(wac_HZc)),function(){return new wac_59c(c.J.H(wac_R),b,c.J.H(wac_l7),c.J.H(wac_5F),c.J.H(wac_y2c),c.J.H(wac_Mt),c.J.H(wac_fG),c.J.H(wac_jG),c.J.H(wac_VF),c.J.H(wac_6tc),wac_l(wac_j(),wac_GZc),c.J.H(wac__ic))})},sC:function(){try{if(this.J.H(wac_R).vbc){this.$Ef=Date.now();wac_Y(42869339,833,50,"PPTWebEditorLivePackage: Loading the Live Presenter scripts");
var a=this;wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),7,function(){var b=a.J.H(wac_wEa).uje,c=new (wac_g.$$(Promise));c.ga(b.MRd("PPTLiveBroadcast"));c.ga(b.MRd("BroadcastMonitor"));c.ga(b.MRd("liveActor"));wac_r().Hd().Bg()||c.ga(b.MRd("uiFabricLazy"));Promise.all(c.xe()).then(function(){wac_Y(50860060,833,50,"PPTWebEditorLivePackage: Loading time: {0}ms",Date.now()-a.$Ef);var b=a.J.H(wac_HZc);b.F7e=!0;b.F7e&&b.la.wa("OnLiveResourcesLoaded",Sys.EventArgs.Empty,null);return null}).catch(function(a){return wac_Y(42869341,
833,10,"Failed to load scripts for the Live Presenter feature: {0}",a)})},3)}else wac_Y(42869337,833,50,"PPTWebEditorLivePackage: Not loading the Live Presenter scripts because the feature is not enabled")}catch(b){wac_Y(42869343,833,10,"PPTWebEditorLivePackage: exception in OnFullAppSettingsReady: {0}",b)}},tb:function(){wac_.pa.Ok(this.SB)},O:function(){}};window.PowerPointLive.ILiveSessionURL.registerClass("PowerPointLive.ILiveSessionURL");window.PowerPointLive.ILiveSessionState.registerClass("PowerPointLive.ILiveSessionState");
window.PowerPointLive.ILiveActorSettings.registerClass("PowerPointLive.ILiveActorSettings");window.PowerPointLive.ILiveReaction.registerClass("PowerPointLive.ILiveReaction");window.PowerPointLive.ILiveActor.registerClass("PowerPointLive.ILiveActor");wac_59c.registerClass("PowerPointLive.LivePresenter",null,wac_HZc);wac_r$c.registerClass("PowerPointLive.DirectAuthRequest");wac_s$c.registerClass("PowerPointLive.CachedAccessToken");wac_t$c.registerClass("PowerPointLive.AccessTokenCache");wac_69c.registerClass("PowerPointLive.DirectAuthHelper");
wac_x$c.registerClass("PowerPointWebEditor.Live.PPTWebEditorLivePackage",null,wac_I,wac_i);wac_J(wac_C(),new wac_x$c,0,!1);Type.registerNamespace("PPTe");wac_4D=window.PPTe||{};function wac_A2b(a,b,c,d,e,f){this.drd=Function.createDelegate(this,this.Y1d);this.crd=Function.createDelegate(this,this.gSa);this.Ob=a;this.X0a=b;this.E0a=c;this.nYc=d;this.hb=e;this.Ta=f}
wac_A2b.prototype={Ob:null,X0a:null,hb:null,Ta:null,OXc:null,E0a:null,LX:null,C5b:!1,nYc:null,d1a:null,gSa:function(a,b,c){a=wac_2g;this.Ta.mvd&&(a=a||this.hb.BFd);a||this.C5b||(a=!this.$Ec());1===c?c=a?2:32:this.C5b?wac_.pya&&this.E0a?(wac_B2b(this),c=32):(c=wac_.hSb?this.d1a.Dx("UI_FileEmbed",null,"")?32:8:2,c=32!==c?this.Ob.qv(!0,wac_.VGb,!1):c):c=8;return c},Y1d:function(a){a.Values.HostEmbeddedViewUrl&&(a=a.Values.HostEmbeddedViewUrl.toString(),this.E0a=wac_.pya=a,wac_B2b(this))},$Ec:function(){return!1}};
function wac_B2b(a){(new wac_C2b(a.E0a,a.X0a,a.OXc,a.LX)).gSa()}
function wac_C2b(a,b,c,d){this.b9c=Function.createDelegate(this,this.OCd);wac_C2b.initializeBase(this,[a]);wac_FIb(this,"wdAr",d.toString());if(!wac_e8){a=Array(4);a[0]=new wac_LF(46,29);a[1]=new wac_LF(56,34);a[2]=new wac_LF(66,39);a[3]=new wac_LF(79,46);wac_e8=[];for(var e=b.length,f=0;4>f;f++){var g=wac_eoc(b[e-1-f],d),g=new wac_F2b(g,a[f]);Array.add(wac_e8,g)}}this.hGa=[];e=new wac_LF(476,288);b=c.v2a;a=e.ac;e=e.qc;f=c.iXc;g=c.LX;c=c.v2a?c.v2a[c.v2a.length-1].Format:0;if(!b)throw Error.argumentNull("powerPointFormatInfosLargestToSmallest");
for(var h,k,l=null,m=0;m<b.length;m++)if(l=b[m],g?(wac_hDb(l,g,h={val:h},k={val:k}),h=h.val,k=k.val):(h=l.SlideWidth,k=l.SlideHeight),h<=a&&k<=e||l.Format===c||m===b.length-1){.9>h/a&&.9>k/e&&f&&m&&(l=b[m-1]);break}d=wac_eoc(l,d);this.XZb=Math.max(d.ac,300);this.CPc=Math.max(d.qc,201);this.JUb-=476-this.XZb}function wac_eoc(a,b){var c,d;wac_hDb(a,b,c={val:c},d={val:d});c=c.val;d=d.val;return new wac_LF(c+2,d+23+2)}function wac_foc(a){return"EmbedSizeAnchor_"+a}
wac_C2b.prototype={Tu:null,Lqb:null,hGa:null,gSa:function(){wac_e3.prototype.gSa.call(this);var a=wac_eH();a.className="EmbedSizesContainer";var b=document.createElement("table"),c=document.createElement("tbody");a.appendChild(b);b.appendChild(c);for(b=0;b<wac_e8.length;b++){var d=wac_e8[b],e=document.createElement("tr"),f=document.createElement("td");f.id="EmbedSize_"+b;f.setAttribute("EmbedSizeId",b);f.className="EmbedSizes";Array.add(this.hGa,f.id);var g=wac_eH();g.className="EmbedBox";g.style.width=
wac_HG(d.AEb.ac);g.style.height=wac_HG(d.AEb.qc);var h=wac_eH();h.id="EmbedSizeTitle_"+b;h.className="EmbedTitle";h.innerText=String.format(ResourceStrings.l_EmbedTitle,d.a5.ac.toString(),d.a5.qc.toString());d=wac_0O();d.id=wac_foc(b);d.className="EmbedAnchor";d.setAttribute("href","javascript:;");d.setAttribute("onclick","return false;");d.setAttribute("unselectable","on");d.setAttribute("aria-describedby",h.id);d.appendChild(h);d.appendChild(g);f.appendChild(d);e.appendChild(f);this.Tu||this.b7(f);
c.appendChild(e)}this.tUa.appendChild(a);this.Lqb=this.b9c;for(a=0;a<this.hGa.length;a++)c=document.getElementById(this.hGa[a]),this.Fk.ya("click",c,this.Lqb);this.xlb.appendChild(wac_GIb(this));this.HMa();wac_Kh()&&(a=wac_Ie(),c=[document.getElementById("EmbedCode"),document.getElementById(wac_foc(0)),document.getElementById(wac_foc(1)),document.getElementById(wac_foc(2)),document.getElementById(wac_foc(3)),document.getElementById("ArrowOptions"),document.getElementById("wdEaaCheck"),document.getElementById("WACDialogActionButton")],
c=new wac_Mma(c),(a=a.Hg())?a.Fd=c:wac_Y(8962561,807,10,"PowerPointEmbedDialog::ShowEmbedDialog cannot find current FocusRegion"),wac_Ge()?this.t0(document.getElementById("WACDialogActionButton")):this.JC.select())},x5:function(){wac_0m.prototype.x5.call(this);for(var a=0;a<this.hGa.length;a++){var b=document.getElementById(this.hGa[a]);this.Fk.ub("click",b,this.Lqb)}this.Lqb=null},OCd:function(a){this.b7(a.ns);return!0},b7:function(a){this.Tu&&(Sys.UI.DomElement.removeCssClass(this.Tu,"Selected"),
this.Tu=null);this.Tu=a;var b=wac_Ie().Hg();b&&b.Fd.Ch(a.firstChild);Sys.UI.DomElement.addCssClass(this.Tu,"Selected");a=wac_e8[this.Tu.getAttribute("EmbedSizeId")];this.MAf=a.a5.ac;this.LAf=a.a5.qc;wac_DIb(this)}};function wac_F2b(a,b){this.a5=a;this.AEb=b;this.a5.ac=Math.max(this.a5.ac,300);this.a5.qc=Math.max(this.a5.qc,201)}wac_F2b.prototype={a5:null,AEb:null};
function wac_D2b(a,b,c){this.v2a=a;this.PXc={};for(var d=0;d<a.length;d++)this.PXc[a[d].Format.toString()]=d;this.iXc=b;c&&!window.isNaN(c)&&window.isFinite(c)?this.LX=c:this.LX=0}wac_D2b.prototype={v2a:null,iXc:!1,LX:null,PXc:null};Type.registerNamespace("PowerPointWebEditor");wac_Z=window.PowerPointWebEditor||{};function wac_J2b(){}wac_J2b.registerInterface("PowerPointWebEditor.IAddinCommandsInitService");function wac_V2b(){}wac_V2b.registerInterface("PowerPointWebEditor.IPptInsertMediaDialogFactory");
function wac_12b(){}wac_12b.registerInterface("PowerPointWebEditor.IPowerPointDownloadACopyDialogFactory");function wac_sIc(){this.rIf=Function.createDelegate(this,this.MQf);this.qIf=Function.createDelegate(this,this.LQf);this.idc=Function.createDelegate(this,this.Eyc);this.kqe=[new wac_37b,new wac_Jwc];this.Usb=[]}
function wac_tIc(){var a=new XMLHttpRequest;a.open("GET",wac_.pa.Qb.OneDriveApiV72Url);a.send(null);a.onreadystatechange=function(){if(4===a.readyState){var b=a.responseText;try{window.eval(b)}catch(c){wac_Y(40145442,809,10,"Load OneDrive.js throw exception: {0}, stack: {1}",c.message,c.stack)}}}}function wac_uIc(a){var b=wac_j().H(wac_bM);a?b.kxa():b.Mab()&&b.kxa();wac_J(wac_C(),new wac_P7b,0,!1)}
wac_sIc.prototype={Usb:null,kqe:null,J:null,Q8d:null,ZV:null,nu:null,Ub:function(){return"PowerPointWebEditor.Chronos2"},gc:function(a){this.J=a;this.Q8d=this.J.H(wac_hF);this.ZV=this.Q8d.d5c(5,this.Ub());this.nu=this.J.H(wac_Ipc);for(var b=0;b<this.kqe.length;++b)Array.add(this.Usb,wac_k4(this.kqe[b],5));for(var b=this.Usb,c=b.length,d=0;d<c;++d)b[d].gc(a);this.J.H(wac_3L);var e=wac_q(wac_.pa,"InsertOnlinePictureFromHostEmulatedOneDriveHostEnabled"),f=wac_rP(wac_oc.$$(wac_sc),wac_l(this.J,wac_oc.$$(wac_sc))),
g=this;wac_n(wac_m(wac_o(this.J.fa(wac_p8b),wac_bM),function(){return new wac_p8b(g.J.H(wac_3L),g.J.H(wac_1L),g.J.H(wac_nt),g.J.H(wac_4L),g.J.H(wac_Ipc))}));var h=this;wac_m(wac_n(wac_o(this.J.fa(wac_37),wac_kIa)),function(){return new wac_37(h.J.H(wac_iK),h.J.H(wac_Em),h.J.H(wac_R),h.J.H(wac_Mt))});this.J.H(wac_R).lKa&&wac_Li().WVa&&wac_$ka(wac_Li(),this.idc);wac_m(wac_n(wac_o(this.J.fa(wac_k5),wac_hRb)),function(){return new wac_k5(a.H(wac_zQ),new (wac_f.$$(wac_oc.$$(wac_sc)))(function(){return wac_Qb(f)}),
a.H(wac_54))});wac_m(wac_n(this.J.fa(wac_i5)),function(){return new wac_i5(wac_z())});wac_m(wac_n(wac_o(this.J.fa(wac_h5),wac_gRb)),function(){return new wac_h5});var k=this;wac_m(wac_n(this.J.fa(wac_F8)),function(){return new wac_F8(k.J.H(wac_Oc),k.J.H(wac_h5),k.J.H(wac_R))});var l=this;wac_m(wac_n(this.J.fa(wac_hoc)),function(){return new wac_hoc(l.J.H(wac_Oc),l.J.H(wac_h5),l.J.H(wac_R))});var m=this;wac_m(wac_n(wac_o(this.J.fa(wac_f5),wac_74)),function(){return new wac_f5(new wac_e5(new (wac_f.$$(wac_2a))(function(){var a;
wac_Q1()?(a=m.J.H(wac_84).pH,a=new wac_c5(a.contentWindow,"*")):a=wac_.KIb;return a}),e?wac_Jh(window.document.URL,0):wac_Jh(wac_.cRa,0),wac_.pa.Qb.ImageFetcherSupportedExtensions))});wac_n(wac_o(this.J.fa(wac_mRb),wac_54));wac_m(wac_n(wac_o(this.J.fa(wac_g5),wac_84)),function(){return new wac_g5});wac_n(wac_o(this.J.fa(wac_i3b),wac_V2b));wac_m(wac_n(this.J.fa(wac_12b)),function(){return new wac_D3b})},tb:function(){var a=this.ZV.saa("resolvechronos2"),b=this.J.H(wac_),c=this.J.H(wac_3L),d=c.Ta,e=
b.Ob,f=this.J.H(wac_12b),g=this.J.H(wac_Oc),b=this.J.H(wac_bM),h=this.J.H(wac_i8),k=this.J.H(wac_zG),l=e.Zc,m=this.J.H(wac_dI),n=this.J.H(wac_Lt),p=this.J.H(wac_JH),q=this.J.H(wac_GH),r=wac_0b(this.J,wac_iM),t=this.J.H(wac_It),v=this.J.H(wac_nt),u=this.J.H(wac_Jt),w=this.J.H(wac_i7),x=this.J.H(wac_Mt),z=e.ed,y=this.J.H(wac_bY),A=this.J.H(wac_zH),B=this.J.H(wac_w_),C=this.J.H(wac_AX),F=this.J.H(wac_IH),D=this.J.H(wac_KL);this.ZV.zaa(a);a=this.ZV.saa("regactorschronos2");h=[new wac_O3b(d.YL,g,b,wac_l(this.J,
wac_2L)),new wac_Q3b(d.ABb,d.YL,h,g,l,m,r,b,wac_l(this.J,wac_9L),n,v,u,w,this.J.H(wac_R)),new wac_A4b(d,g,u,t,k,this.J.H(wac_FH),m,this.J.H(wac_V2b),this.J.H(wac_74),this.J.H(wac_54),this.J.H(wac_h5),this.J.H(wac_F8),this.J.H(wac_hoc),x,n,p,q,F,D,C,w,this.J.H(wac_g5),this.J.H(wac_hRb),this.J.H(wac_i5),this.J.H(wac_Elc),this.J.H(wac_j8),this.J.H(wac_CT),this.J.H(wac_NL),this.J.H(wac_Yc))];l=h.length;for(m=0;m<l;++m)n=h[m],n.Tb(),n.Lf();b.lxb=!0;this.ZV.zaa(a);var G=this;wac_.pa.Ok(function(){a=G.ZV.saa("regfullactorschronos2");
for(var b=[new wac_s4b(g,u,k,t,G.J.H(wac_1L).Ve(),y,c.$f.Cn.w2c,A,G.J.H(wac_t4b),G.J.H(wac_u4b),G.J.H(wac_lr),B,f,G.J.H(wac_H8),wac_Tfa,G.J.H(wac_jM),G.J.H(wac_VF),G.J.H(wac_R),G.J.H(wac_Uc),G.J.H(wac_Mt),function(){return wac_2g},c.YZa(),function(a){return wac_URc(wac_r().Hd(),a)}),new wac_v4b(e,d.dlc,z.zyb,g,x,c.YZa(),G.J.H(wac_VF),G.J.H(wac_R))],h=b.length,l=0;l<h;++l){var m=b[l];m.Tb();m.Lf()}G.ZV.zaa(a)});wac_Y(40145439,809,50,"Chronos2Package::Init");b=this.Usb;h=b.length;for(l=0;l<h;++l)m=
b[l],this.ZV.saa(m.Ub()),m.tb(),this.ZV.zaa(m.Ub());a=this.ZV.saa("al");wac_k$b(this);this.ZV.zaa(a);var H=this;wac_.pa.Ok(function(){if(d.zy){a=H.ZV.saa("idea");var b=wac_y$c(H);wac_z$c(H,b);H.ZV.zaa(a)}d.lBe&&(a=H.ZV.saa("smartLookup"),wac_A$c(H),H.ZV.zaa(a));wac_Rqc()&&(a=H.ZV.saa("versionhistory"),wac_B$c(H),H.ZV.zaa(a));wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),7,function(){var a=["https://msit.microsoftstream.com/embed/video/0"];wac_q(wac_.pa,"StreamVideoPreFetchEnabled")&&
wac_C$c(a)},3)});wac_Yg||d.lKa&&wac_Si(wac_Li())||(a=this.ZV.saa("appforoffice"),this.Eyc(),this.ZV.zaa(a));d.crc&&wac_Fh()&&wac_q(wac_.pa,"SaveToAnotherFolderBrsIsEnabled")&&wac_tIc();a=this.ZV.saa("policy");wac_q$b(this);this.ZV.zaa(a);d.Bmc&&(a=this.ZV.saa("capture"),wac_l$b(this),this.ZV.zaa(a))},O:function(){for(var a=this.Usb,b=a.length,c=0;c<b;++c)a[c].O();this.J.H(wac_R).lKa&&wac_Li().WVa&&wac_Li().Ra.sb("ConsentReceived",this.idc)},Eyc:function(){var a=(new Date).getTime(),b=this.J.H(wac_R);
1<b.Ycf?wac_D$c(this):b.Pi()?wac_.pa.Ok(function(){wac_uIc(b.ecf)}):wac_uIc(b.ecf);wac_Y(594585625,344,50,'{{"PM":{0},"T":{1},"DL":{2},"PODS":{3}}}',b.Ycf,(new Date).getTime()-a,b.ecf,b.Pi())},MQf:function(a){var b=wac_j().H(wac_bM);b.ebf=a["1"];b.Faf=a["2"];b.kxa();wac_J(wac_C(),new wac_P7b,0,!1)},LQf:function(){wac_j().H(wac_bM).kxa();wac_J(wac_C(),new wac_P7b,0,!1)}};
function wac_D$c(a){var b=a.J.H(wac_R),c=wac_j().H(wac_bM),d=304;if(c.Mab())d=0;else switch(b.Ycf){case 2:d=0;break;case 3:d=b.Pi()?301:201;break;case 4:d=b.Pi()?302:202;break;case 5:d=b.Pi()?303:203;break;case 6:d=b.Pi()?304:204}var e={};e["1"]=wac_E$c(c);e["2"]=wac_F$c(c);wac_G$c(d,a.qIf,function(){return e},a.rIf)}
function wac_B$c(a){a=wac_vqc(a.nu,wac_jt()+"pptVersionHistory.js",null,!1);try{wac_ul(a)}catch(b){wac_Y(40145478,809,10,"ChronosPackage::InitializeVersionHistory - Failed to download VersionHistory script, Exception: {0}",b.toString())}}
function wac_A$c(a){wac_Y(41236128,809,50,"Start to download smartlookup.hermes.js file");var b=[];b.push(wac_vqc(a.nu,wac_af("microsoft.office.smartlookup.host.runtime.js",5),null,!1));a=wac_vqc(a.nu,wac_af("smartlookup.hermes"+wac_aO(a.J.H(wac_4L)),1),b,!1);wac_ul(a)}function wac_z$c(a,b){wac_Y(40145476,809,50,"Start to download ideas.hermes.js file");b=wac_vqc(a.nu,wac_af("microsoft.ideas.runtime.js",5),[b],!1);a=wac_vqc(a.nu,wac_af("ideas.hermes"+wac_aO(a.J.H(wac_4L)),1),[b],!1);wac_ul(a)}
function wac_y$c(a){wac_Y(40145474,809,50,"Start to download infrared.hermes.js file");var b=[];b.push(wac_vqc(a.nu,wac_af("ir-plugin-ski.min.js",5),null,!1));a=wac_vqc(a.nu,wac_af("infrared.hermes"+wac_aO(a.J.H(wac_4L)),1),b,!1);wac_ul(a);return a}function wac_q$b(a){wac_Y(40145472,809,50,"Start to download policy.hermes.js file");a=wac_vqc(a.nu,wac_af("policy.hermes"+wac_aO(a.J.H(wac_4L)),1),null,!1);wac_ul(a)}
function wac_l$b(a){var b=wac_af("dom-to-image",2),b=wac_vqc(a.nu,b,null,!1),c=wac_af("Capture.Hermes"+wac_aO(a.J.H(wac_4L)),1);a=wac_vqc(a.nu,c,[b],!1);try{wac_ul(a)}catch(d){wac_Y(40186115,809,10,"ChronosPackage::InitializeCapture - Failed to download capture script, Exception: {0}",d.toString())}}
function wac_k$b(a){wac_Y(51468371,809,50,"Start to download augloop.hermes.js file and its dependency files");var b=wac_af("augloop.hermes"+wac_aO(a.J.H(wac_4L)),1);try{if(a.J.H(wac_R).yBb){var c=a.J.H(wac_Kc),d=wac_af("augloop-runtime-shim-ie",2);wac_NO(c,d).CW(function(){wac_NO(c,b)})}else{var e=wac_vqc(a.nu,b,null,!1);wac_ul(e)}}catch(f){wac_Y(51468373,306,10,"Failure downloading the augloop js with its depdencies: Message: {0}, Callstack: {1}",f.message,f.stack)}}
function wac_H$c(){this.pIf=Function.createDelegate(this,this.Dkf);this.Wbf=Function.createDelegate(this,this.Vjf);this.mIf=Function.createDelegate(this,this.Odf);this.usf=Function.createDelegate(this,this.og)}function wac_G$c(a,b,c,d){var e=new wac_H$c;Array.add(wac_I$c,e);e.Eqf=b;e.Fhf=c?c():null;e.zhf=d;wac_J$c(e,a)}
function wac_K$c(a){var b=!1;try{window.self.requestIdleCallback(a)}catch(c){b=!0,wac_Y(594585619,344,10,"Failed to invoke requestIdleCallback, Exception: {0}",c.toString())}b&&window.setTimeout(a,0)}
function wac_L$c(a,b){-1!==window.navigator.userAgent.toLowerCase().indexOf("trident/")||"function"!==typeof window.fetch?b(a):window.fetch(a.K3a,{method:"GET"}).then(function(a){return a.blob()},function(a){wac_Y(594585617,344,10,"fetch failed, Exception: {0}",a.toString());return null}).then(function(c){if(c){var d=window.URL.createObjectURL(c);b(new wac_M$c(a.Yqf,d))}else b(a);return c})}
wac_H$c.prototype={Eqf:null,Fhf:null,zhf:null,rgf:null,prf:0,tpf:!1,og:function(){this.Eqf?this.Eqf():wac_Y(594585623,344,10,"Prefetch: Invalid parameter, hostSpecificLoadCallback should not be null");Array.remove(wac_I$c,this)},Odf:function(){wac_K$c(this.usf)},Vjf:function(){if(this.Fhf&&this.zhf){this.prf=wac_Sl(this.Fhf);this.rgf={};var a=this.Fhf,b;for(b in a){var c={key:b,value:a[b]},d=this;wac_L$c(new wac_M$c(c.key,c.value),function(a){d.rgf[a.Yqf]=a.K3a;--d.prf;d.prf||(d.tpf?wac_K$c(function(){d.zhf(d.rgf);
Array.remove(wac_I$c,d)}):(d.zhf(d.rgf),Array.remove(wac_I$c,d)))})}}else wac_Y(594585621,344,10,"Prefetch: Invalid parameter, getUrlsToPrefetchFunc should not be null")},Dkf:function(){wac_K$c(this.Wbf)}};
function wac_J$c(a,b){switch(b){case 0:a.og();break;case 1:a.Odf();break;case 100:window.setTimeout(a.usf,0);break;case 101:window.setTimeout(a.mIf,0);break;case 102:window.setTimeout(a.Wbf,0);break;case 103:window.setTimeout(a.pIf,0);break;case 200:wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),8,function(){a.og()},3);break;case 201:wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),8,function(){a.Odf()},3);break;case 202:wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),
8,function(){a.Vjf()},3);break;case 203:wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),8,function(){a.Dkf()},3);break;case 204:wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),8,function(){a.tpf=!0;wac_K$c(a.Wbf)},3);break;case 300:wac_.pa.Ok(function(){a.og()});break;case 301:wac_.pa.Ok(function(){a.Odf()});break;case 302:wac_.pa.Ok(function(){a.Vjf()});break;case 303:wac_.pa.Ok(function(){a.Dkf()});break;case 304:wac_.pa.Ok(function(){a.tpf=!0;wac_K$c(a.Wbf)})}}
function wac_M$c(a,b){this.Yqf=a;this.K3a=b}wac_M$c.prototype={Yqf:"",K3a:null};function wac_O3b(a,b,c,d){this.wnd=Function.createDelegate(this,this.LXd);this.jba=Function.createDelegate(this,this.a4d);this.U=b;this.nY=a;this.yF=c;this.L3b=d}
wac_O3b.prototype={U:null,nY:!1,yF:null,L3b:null,Tb:function(){this.U.jf(407117407,1,this.jba,4);this.U.jf(1402209562,1,this.jba,4);this.U.jf(543799107,1,this.jba,4);this.U.jf(1309495434,1,this.wnd,96);this.U.ja(516359383,1,this.jba);this.U.jf(1782110672,1,this.jba,64);this.U.ja(2517401660,1,this.jba);this.U.jf(1592314317,1,this.jba,64);this.U.ja(2269104277,1,this.jba)},Lf:function(){},a4d:function(a,b,c,d,e){if(!this.nY)return 16;if(1===c)return wac_q(wac_.pa,"PPTOProtectDocumentDownloadIsBlocked")&&
wac_bf?8:32;if(wac_I8(this))switch(a){case 407117407:wac_I8(this).ana(e);break;case 1402209562:wac_I8(this).lIb(e);break;case 1309495434:wac_I8(this).dCc(e);break;case 516359383:wac_I8(this).T1d(e);break;case 1782110672:wac_I8(this).LCc(e);break;case 543799107:wac_I8(this).zZd();break;case 2517401660:wac_I8(this).s2d(e);break;case 1592314317:wac_I8(this).hJd(e);break;case 2269104277:wac_I8(this).S1d(e)}else this.yF.kxa(),this.yF.cia.ga(new wac_J8(a,e));return 32},LXd:function(a,b,c,d,e){if(!this.nY)return 16;
wac_I8(this)&&wac_I8(this).dCc(e);return 32}};function wac_I8(a){return a.L3b?a.L3b.Ga():null}
function wac_Q3b(a,b,c,d,e,f,g,h,k,l,m,n,p){this.YHf=Function.createDelegate(this,this.KPf);this.qHf=Function.createDelegate(this,this.WOf);this.cIf=Function.createDelegate(this,this.TPf);this.Ead=Function.createDelegate(this,this.jGd);this.Acd=Function.createDelegate(this,this.GId);this.Ind=Function.createDelegate(this,this.ZXd);this.ocd=Function.createDelegate(this,this.nId);this.fbd=Function.createDelegate(this,this.NGd);this.jbd=Function.createDelegate(this,this.SGd);this.ibd=Function.createDelegate(this,
this.RGd);this.zi=c;this.U=d;this.Ca=e;this.aaa=g;this.nY=a;this.ZYc=b;this.nb=f;this.yF=h;this.Ad=k;this.za=l;this.Yb=m;this.zd=n;this.Nj=p}
wac_Q3b.prototype={zi:null,U:null,Ca:null,nb:null,aaa:null,yF:null,za:null,Ad:null,Yb:null,zd:null,Nj:null,cgf:0,oDf:!1,nY:!1,ZYc:!1,Tb:function(){this.U.jf(2300394269,1,this.ibd,516);this.U.jf(2741813164,1,this.jbd,4);this.U.ja(1592244241,1,this.fbd);this.U.jf(2620643039,1,this.ocd,4);this.U.jf(860152194,1,this.Ind,96);this.U.ja(2123786558,1,this.Acd);this.U.ja(2755471162,1,this.Ead);this.U.ja(2451283737,1,this.cIf);this.U.ja(1530887760,1,this.qHf);this.U.ja(1323818969,1,this.YHf)},Lf:function(){},
tf:function(){return this.Ad.Ga()},TPf:function(a,b,c,d,e){if(2!==c)return 32;var f=e.extId;e=e.OptionalProps;var g={};g.mRb=e.ENe.TaskPaneTitle;g.jca=wac_BGb(f);g.Goe=e.ENe.OnRenderedCallback;g.RMd=e.icf;g.twe=!0;return this.GId(a,b,c,d,g)},WOf:function(a,b,c,d,e){if(2!==c)return 32;a=e.extId;e=e.OptionalProps;b={};b.mRb=e.ENe.TaskPaneTitle;b.jca=wac_BGb(a);b.Rfb=e.ENe.SourceLocationOverrideResourceId;b.Goe=e.ENe.OnRenderedCallback;b.RMd=e.icf;b.twe=!0;e=this.tf().tHb(b);return(e=this.tf().jma(e))&&
this.tf().Czd(e.Xm)?32:8},KPf:function(a,b,c,d,e){if(2!==c)return 32;a=e.extId;b=e.OptionalProps;e={};e.mRb=b.ENe.TaskPaneTitle;e.jca=wac_BGb(a);e.Rfb=b.ENe.SourceLocationOverrideResourceId;e.Goe=b.ENe.OnRenderedCallback;e.RMd=b.icf;e.twe=!0;a=this.tf().tHb(e);return(a=this.tf().jma(a))?(this.tf().V0e(a.Xm,e),32):8},RGd:function(a,b,c,d,e){b=this.Ca.Ja();d=this.Ca.Ve();if(!(this.nY&&b&&d)||this.zd.Ac(b))return 16;if(1===c)return wac_q(wac_.pa,"PPTOProtectDocumentDownloadIsBlocked")&&wac_bf?8:32;this.tf()?
this.tf().fLd():(this.yF.kxa(),this.yF.cia.ga(new wac_J8(a,e)));return 32},SGd:function(a,b,c,d,e){if(!this.nY)return 16;if(!e)return 8;if(e.targetType===window.OSF.OsfControlTarget.InContent)return wac_N$c(this,e,a);if(e.targetType===window.OSF.OsfControlTarget.TaskPane){if(this.zd.Ac(this.Ca.Ve()))return 16;if(this.ZYc)if(e.isAddinCommands)e.addinCommandsActionType?1===e.addinCommandsActionType&&wac_Y4b(this,e):this.zSa(e);else{a={};a.marketplaceId=e.id;a.marketplaceVersion=e.appVersion;a.storeType=
e.currentStoreType;a.storeId=e.storeId;a.targetData=e;var f=this;this.tf().DH().isAddinCommandsAsync(a,function(a,b,c){b?f.zSa(c.targetData):wac_Y4b(f,c.targetData);a||wac_b(17687323,220,10,"Checking AddinCommands fails for {0} from {1}",c.targetData.id,c.targetData.currentStoreType)})}else wac_Y4b(this,e);wac_dDb[wac_fDb(e.id,e.targetType,e.storeId,e.currentStoreType,e.appVersion)]=!0;return 32}return 8},NGd:function(a,b,c,d,e){if(!this.nY)return 16;if(!e)return 8;if(1===c)return 32;c=window.$$as(String,
e);if(!c||!c.length)return 8;if((a=this.tf().Hwc(c))&&a.Pk){if(a.Zj&&(a.Zj.wF()===window.OSF.StoreType.FirstParty||a.Zj.wF()===window.OSF.StoreType.Sdx))return this.tf().pGb(c),this.tf().oZd(c),32;if(this.tf().nKd(c)||a.Pk.iD())this.tf().pGb(c);else if(a=this.tf().jab(),b=wac_X(a),c=this.tf().Iwc(c)){b.Zh(window.$$as(wac_Bu,c));c=wac_kO(this.nb,4,null,null,!0);try{c.lb(a),wac_nu(b)}finally{c&&c.dispose()}}}return 32},nId:function(a,b,c,d,e){if(!this.nY)return 16;if(!e)return 8;if(1===c)return 32;
b=window.$$as(String,e);if(!b||!b.length)return 8;this.tf()?this.tf().zCc(b):this.yF.cia.ga(new wac_J8(a,e));return 32},GId:function(a,b,c,d,e){if(!this.nY)return 16;if(!e)return 8;if(1===c)return 32;if(this.tf()){if(!e||!e.jca)return 8;!this.oDf&&this.cgf&&(this.oDf=!0,a=window.performance.now()-this.cgf,wac_b(41760289,220,50,"Apps for office load time {0}",a));a=this.tf().tHb(e);if(a=this.tf().jma(a))return this.tf().V0e(a.Xm,e),32;this.tf().i_d(e)}else this.cgf||(this.cgf=window.performance.now()),
this.yF.kxa(),this.yF.cia.ga(new wac_J8(a,e));return 32},jGd:function(a,b,c,d,e){return this.nY?e?1===c?32:this.tf()&&e&&e.length?this.tf().Czd(e)?32:8:8:8:16},ZXd:function(a,b,c,d,e){if(2===c){a=e.callback;if(!a)return 16;b=new wac_Xca;b.callbackFunc=a;b.storeType=window.OSF.StoreTypeEnum.MarketPlace;b.fromInsertDialog=!1;b.refresh="true"===wac_a4c().COa("refreshRequired");this.tf().DH().queryEntitlementDetails(b)}return 32},zSa:function(a){var b=new (wac_g.$$(Object));b.ga(a);a={};a.ack2=b;a.ack0=
3;this.U.Wj(407117407,2,a,null)}};function wac_Y4b(a,b){if(!a.tf().jma(b.id)){var c=a.tf().kma(b.id),d=a.tf().jab();if(c){d=new wac_f_(c);if(!d.lO()){e=wac_kO(a.nb,4,null,null,!0);try{e.lb(c),wac_v(c,wac_Iqa,!0),wac_v(c,wac_Gqa,b.currentStoreType)}finally{e&&e.dispose()}}a.tf().zCc(d.ia())}else{c=a.aaa.ma();e=a.tf();c=window.$$as(wac_Bu,c.ak(1074135137));wac_$Cb(c,b,e);var e=wac_kO(a.nb,4,null,null,!0);try{e.lb(d),a=c,wac_U(d).Td(a,19)}finally{e&&e.dispose()}}}}
function wac_N$c(a,b,c){var d=a.Ca.Ja();if(!d||a.zd.Ac(d))return 16;if(!wac_k7(a.Nj,d,1))return wac_j7(a.Nj,d),16;try{var e=wac_GI(d),f=wac_70(d),g=a.aaa.ma(),h=e.fe(),k=e.Vc(),l=b.width,m=b.height,n=wac_8Cb(g,h,k,f+1,!1);wac_9Cb(n,null,0,0,l,m);wac_7Cb(n,l,m);wac_$Cb(n,b,a.tf());wac_P8(a.zi,[window.$$as(wac_HH,n)],d,c,null,null,!0);wac_dDb[wac_fDb(b.id,b.targetType,b.storeId,b.currentStoreType,b.appVersion)]=!0;return 32}catch(p){return 8}}
function wac_u9(a,b){wac_u9.initializeBase(this,[a.$f.Ob.Bz()]);this.aj=a;this.Fe=b;wac_uDb="WAC_Powerpoint"}wac_u9.prototype={aj:null,Fe:null,yHb:function(){var a=new (wac_nb.$$(wac_d.Xwa,wac_d.yla));wac_q(this.Fe,wac_2(51))&&a.vf(0,2);wac_q(this.Fe,wac_2(187))&&a.vf(1,1);this.aj.Ta.YL&&a.vf(8,1);wac_q(this.Fe,wac_2(305))&&a.vf(10,5);return a}};function wac_P7b(){}
wac_P7b.prototype={J:null,Ub:function(){return"PowerPointWebEditor.AddinCommands"},gc:function(a){this.J=a;var b=this;wac_n(wac_m(wac_o(wac_j().fa(wac_u9),wac_J2b),function(){return new wac_u9(b.J.H(wac_3L),b.J.H(wac_Uc))}))},tb:function(){this.J.H(wac_R).lzb&&wac_L6c()},O:function(){}};function wac_p8b(a,b,c,d,e){this.uIa=[];this.o3b=!1;this.Kpb=null;this.cia=new (wac_g.$$(wac_J8));this.aj=a;this.jtb=b;this.lxb=!1;this.Yb=c;this.$f=d;this.nu=e;this.Faf=this.ebf=null}
wac_p8b.prototype={uIa:null,o3b:!1,Kpb:null,cia:null,aj:null,jtb:null,Yb:null,$f:null,nu:null,ebf:null,Faf:null,Iwd:function(a){this.uIa.push(a)},kxa:function(){if(!this.o3b){if(!this.Kpb){var a=[wac_vqc(this.nu,wac_E$c(this),null,!1)];this.Kpb=wac_vqc(this.nu,wac_F$c(this),a,!1)}wac_ul(this.Kpb);this.o3b=!0}},Mab:function(){var a=!!this.uIa&&0<this.uIa.length,b=!1;if(this.jtb.Ve()&&!a){var c=wac_X(this.jtb.Ve()).mb(18);c&&0<wac_7v(wac_X(c),19)&&(b=!0)}return a||b},lxb:!1};
function wac_F$c(a){a.Faf||(a.Faf=wac_af("appforoffice.hermes"+wac_aO(a.$f),1));return a.Faf}function wac_E$c(a){a.ebf||(a.ebf=wac_af("officeExtensionMerge.js",5));return a.ebf}function wac_J8(a,b){this.Ii=a;this.HD=b}wac_J8.prototype={Ii:0,HD:null};
function wac_A4b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w,x,z,y,A,B,C,F,D,G,H){this.y5a=Function.createDelegate(this,this.FQb);this.qrd=Function.createDelegate(this,this.k2d);this.Nwb=Function.createDelegate(this,this.EQb);this.Ctf=Function.createDelegate(this,this.mVf);this.ord=Function.createDelegate(this,this.DQb);this.Xwb=Function.createDelegate(this,this.XRb);this.ftd=Function.createDelegate(this,this.d5d);this.dtd=Function.createDelegate(this,this.yFc);this.Nre=Function.createDelegate(this,this.Rte);
this.Yse=Function.createDelegate(this,this.bwe);this.sse=Function.createDelegate(this,this.Sue);this.Zse=Function.createDelegate(this,this.dwe);this.Btf=Function.createDelegate(this,this.lVf);this.ua=a;this.U=b;this.Ib=c;this.ha=d;this.ra=e;this.Ca=f;this.nb=g;this.T6b=h;this.VYc=k;this.S6b=l;this.urb=m;this.vrb=n;this.dqe=p;this.Pb=q;this.za=r;this.Wm=t;this.Bo=v;this.jd=u;this.Lc=w;this.MB=x;this.Nj=z;this.xHa=y;this.eta=F;this.Q5d=D;this.Qg=G;this.xHa&&(this.xHa.pH.removeAttribute("style"),this.xHa.pH.style.display=
"none");this.Msb=A;this.WYc=B;this.gBa=C;this.Kaf=H}function wac_Vwc(){return wac_02a(CommonUIStrings.l_AttributionText.split(/[{}]+/),function(a){return!!a})}function wac_Wwc(a){var b=document.createElement("span");b.innerText=a;return b}function wac_Xwc(a,b){var c=document.createElement("A");c.setAttribute("href",b);c.setAttribute("target","_blank");c.setAttribute("rel","noreferrer");b=document.createElement("span");b.innerText=a;c.appendChild(b);return c}
function wac_Ywc(a){var b=wac_Vwc(),c=document.createElement("body"),d="",e="",f=CommonUIStrings.l_CCYYSA;wac_h(a)||(wac_h(a.PageUrl)||(d=a.PageUrl),!wac_h(a.LicenseDisplayName)&&0<a.LicenseDisplayName.length&&(f=a.LicenseDisplayName),wac_h(a.LicenseUrl)||(e=a.LicenseUrl));a=b.length;for(var g=0;g<a;++g){var h=b[g];switch(h){case "L_ThePhoto":h=wac_Xwc(CommonUIStrings.l_ThePhoto,d);break;case "L_CCYYSA":h=wac_Xwc(f,e);break;case "L_PhotoAuthor":h=wac_Wwc(CommonUIStrings.l_PhotoAuthor);break;default:h=
wac_Wwc(h)}h&&c.appendChild(h)}b=document.createElement("html");b.appendChild(c);return b}
wac_A4b.prototype={ua:null,Ib:null,U:null,ha:null,ra:null,VYc:null,urb:null,vrb:null,dqe:null,Ca:null,nb:null,T6b:null,S6b:null,Pb:null,za:null,Wm:null,Bo:null,jd:null,Lc:null,MB:null,Nj:null,eta:null,Q5d:null,Qg:null,xHa:null,Msb:null,WYc:null,gBa:null,Kaf:null,w_a:!1,Tb:function(){wac_O$c(this);this.ua.ocf?(this.U.jf(3143141002,1,this.Btf,4),this.U.jf(1332899609,1,this.Btf,4)):(this.U.jf(3143141002,1,this.Zse,4),this.U.jf(934858027,1,this.sse,4),this.U.jf(1332899609,1,this.Yse,4));this.U.jf(2888756397,
1,this.sse,4);this.U.jf(1949132172,1,this.Nre,4);this.U.jf(1488343741,1,this.Nre,4);this.U.jf(2168883939,1,this.dtd,4);this.U.jf(330605680,1,this.dtd,4);this.U.jf(239978317,1,this.dtd,4);wac_P$c(this);this.U.jf(2168458114,1,this.ftd,4);this.U.jf(3612507612,1,this.Xwb,96)},kOb:function(){wac_33a()&&wac_Q1()&&(wac_r().Nc().appendChild(this.xHa.pH),wac_tf(this.xHa.pH.contentWindow,"message",this.y5a),this.w_a=!0)},FQb:function(a){if(a.rawEvent&&(a=a.rawEvent.data))try{wac_Y(33944475,352,50,"User select images.");
var b=Sys.Serialization.JavaScriptSerializer.deserialize(a,!0),c=b.MessageId?b.MessageId.toString():null;b&&c&&("UI_InsertImage"===c||"UI_InsertFileLink"===c)&&this.Msb.Wd("UI_InsertImage"===c?this.vrb:this.WYc)}catch(d){wac_Y(33944477,352,10,"malformatted postmessage here.")}},Lf:function(){},XRb:function(){return 32},DQb:function(a,b,c){var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,this.ua.Lba,e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(8955410,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog.");
try{var g=wac_5k(),h=wac_Nf(this.ua.xvd).toString(),k=String.format(this.ua.Vlc,wac_.vh,wac_nm(wac_.vh)._name,wac_.jv,g.toString(),3,h);0<this.ua.Vlc.search(/insertmedia.bing.office.net/gi)&&(k=String.format(this.ua.jqc?this.ua.Ulc:this.ua.Vlc,wac_sRb(window.Box4.App.Mg)));var l;l=this.T6b.IG(k,this.S6b,this.urb,wac_nRb);l.rEe(this.ua.Fjc);l.o9d(g);l.u5e(1);this.vrb.Mxe(2168883939);l.hSa(CommonUIStrings.L_PictureInsertTitle,this.vrb);wac_Y(8955412,352,50,"InsertMediaActor::ShowInsertPictureDialog : Show dialog success.");
return 32}catch(m){return wac_Y(8955414,352,10,"InsertMediaActor::ShowInsertPictureDialog : Exception = [{0}]",m.toString()),8}},lVf:function(a,b,c){if(!this.ua.pcf||!this.ua.pcf.length)return 16;var d;b=this.Ca.Ja();var e,f;if((f=wac_38(this,b,this.ua.vvd&&this.ua.ocf,e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(594043842,352,50,"InsertMediaActor::ShowInsertIconDialogFromM365 : Show dialog.");try{var g=wac_5k(),h=wac_Nf(this.ua.xvd).toString(),k=wac_z8c(window.Box4.App.Mg,this.ua.pcf,1332899609===
a?0:1,g.toString(),h),l;l=this.T6b.IG(k,this.S6b,this.urb,"<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>");l.o9d(g);l.u5e(2);this.vrb.Mxe(2888756397);l.hSa("",this.vrb);wac_Y(594043840,352,50,"InsertMediaActor::ShowInsertIconDialogFromM365 : Show dialog success.");return 32}catch(m){return wac_Y(594043810,352,10,"InsertMediaActor::ShowInsertIconDialogFromM365 : Exception = [{0}]",
m.toString()),8}},dwe:function(a,b,c){if(!this.ua.uvd||!this.ua.uvd.length)return 16;var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,this.ua.vvd&&!this.ua.ocf,e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(37822670,352,50,"InsertMediaActor::ShowInsertIconDialog : Show dialog.");try{var g=wac_5k(),h=String.format(this.ua.uvd,wac_.vh,wac_nm(wac_.vh)._name,1),k=this.T6b.IG(h,this.S6b,this.urb,wac_nRb);k.rEe(this.ua.Fjc);k.o9d(g);k.u5e(3);this.vrb.Mxe(934858027);k.hSa(CommonUIStrings.l_InsertIconTitle,
this.vrb);wac_Y(37822672,352,50,"InsertMediaActor::ShowInsertIconDialog : Show dialog success.");return 32}catch(l){return wac_Y(37822674,352,10,"InsertMediaActor::ShowInsertIconDialog : Exception = [{0}]",l.toString()),8}},mVf:function(a,b,c){var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,this.ua.qcf,e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(50869124,352,50,"InsertMediaActor::ShowInsertPictureDialogFromM365 : Show dialog.");try{var g=wac_5k(),h=wac_Nf(this.ua.xvd).toString(),k=wac_z8c(window.Box4.App.Mg,
this.ua.suf,1,g.toString(),h),l;l=this.T6b.IG(k,this.S6b,this.urb,"<div class='InsertMediaM365Dialog' id='insertmediadialog'> <div class='InsertMediaM365Panel' id='insertmediapanel'> <iframe id='insertmediaframe' class='InsertMediaFrame' name='InsertMediaFrame'></iframe> </div> </div>");l.o9d(g);l.u5e(2);this.vrb.Mxe(330605680);l.hSa("",this.vrb);wac_Y(50869126,352,50,"InsertMediaActor::ShowInsertPictureDialogFromM365 : Show dialog success.");return 32}catch(m){return wac_Y(50869128,352,10,"InsertMediaActor::ShowInsertPictureDialogFromM365 : Exception = [{0}]",
m.toString()),8}},bwe:function(a,b,c){if(!this.ua.uvd||!this.ua.uvd.length)return 16;var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,this.ua.LBc,e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(38670721,352,50,"InsertMediaActor::ShowChangeIconDialog : Show dialog.");try{var g=String.format(this.ua.uvd,wac_.vh,wac_nm(wac_.vh)._name,0),h=this.T6b.IG(g,this.S6b,this.urb,wac_nRb);h.u5e(3);this.vrb.Mxe(1488343741);h.hSa(CommonUIStrings.l_InsertIconTitle,this.dqe);wac_Y(38670723,352,50,"InsertMediaActor::ShowChangeIconDialog : Show dialog successfully.");
return 32}catch(k){return wac_Y(38670725,352,10,"InsertMediaActor::ShowChangeIconDialog : Exception = [{0}]",k.toString()),8}},EQb:function(a,b,c){var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,wac_33a()&&(wac_K5b?!!this.Msb.mFa()&&9<this.Msb.mFa().length:!0),e={val:d}),d=e.val,!f)||1===c)return d;wac_Y(17838496,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog.");try{wac_K5b=!0;this.w_a||this.kOb();var g=this.VYc.IG();g.u5e(4);this.vrb.Mxe(239978317);g.hSa(CommonUIStrings.L_PictureInsertTitle,
this.vrb);wac_Y(17838498,352,50,"InsertMediaActor::ShowInsertPictureFromHostDialog : Show dialog success.");return 32}catch(h){return wac_Y(17838528,352,10,"InsertMediaActor::ShowInsertPictureFromHostDialog : Exception = [{0}]",h.toString()),8}},yFc:function(a,b,c,d,e){var f;b=this.Ca.Ja();var g,h;if((h=wac_38(this,b,this.ua.Lba,g={val:f}),f=g.val,!h)||1===c)return f;if(!wac_k7(this.Nj,b,1))return wac_j7(this.Nj,b),16;try{var k=wac_60(b,wac_5M(this.ha));if(k&&this.Ib.Ac(k))return 16;var l=this.uab(this.Lc,
b,k),m=null,n=this,p=this,q=wac_kO(this.nb,15,function(){wac_zM(n.ha);wac_GL(n.ha);n.ra.ld()},function(){wac_cU(p.ha,l,!0,!0);m&&wac_cU(p.ha,m,!1,!0)},!1);try{q.lb(b);q.jr(1685987254);q.Dea.ElementSource="Online";c=null;f={actionId:a};if(2168883939===a&&this.ua.ste)if(e.LicenseUrl&&e.LicenseDisplayName){var r=wac_Ywc(e);c=wac_qka(r);if(this.ua.eGe)var t=wac_GI(b),m=wac_e1(this.Bo,!0,t.fe(),t.Vc(),0,0,110,75,wac_70(b)+1,!1)}else f["result.LicenseDisplayName"]=e.LicenseDisplayName,f["result.LicenseUrl"]=
wac_Nf(e.LicenseUrl);else f.IsEnabled=this.ua.ste,f.IsFromBing=2168883939===a;wac_Y(39409185,352,50,"InsertMediaActor::UploadOnlinePicture: {0}.",f);wac_KBb(l,e.OriginalUrl,this.ua.C4?null:e.Caption,c,e.PageUrl);k&&wac_iO(b,[k]);wac_90(this.Wm,b,l,null);m&&(wac_90(this.Wm,b,m,null),wac_fvc(l,m.ia()),wac_v(m,wac_Jrb,!0))}finally{q&&q.dispose()}wac_10(this.MB,l);return 32}catch(v){return wac_Y(8955416,352,10,"InsertMediaActor::UploadOnlinePicture : Pic = [{0}], Exception = [{1}].",e.OriginalUrl,v.toString()),
8}},Sue:function(a,b,c,d,e){var f;a=this.Ca.Ja();var g,h;if((h=wac_38(this,a,this.ua.vvd,g={val:f}),f=g.val,!h)||1===c)return f;wac_Y(38854735,352,50,"InsertMediaActor::InsertIcons : Start inserting.");if(!e||!e.length)return 16;if(!wac_k7(this.Nj,a,e.length))return wac_j7(this.Nj,a),16;try{var k=null;c=null;var l,m,n;if(n=wac_Foc(this,e,a,l={val:c},m={val:k}),c=l.val,k=m.val,!n)return 16;var p=this,q=this,r=wac_kO(this.nb,15,function(){wac_zM(p.ha);wac_GL(p.ha);p.ra.ld()},function(){wac_t0a(q.ha,
k,!0)},!1);try{for(r.lb(a),r.jr(934858027),r.Dea.ElementSource="Icon",c&&wac_iO(a,c),l=0;l<k.length;l++)wac_90(this.Wm,a,k[l],null)}finally{r&&r.dispose()}wac_10(this.MB,k[k.length-1]);return 32}catch(t){return wac_Y(37822680,352,10,"InsertMediaActor::InsertIcons : icon count = [{0}], Exception = [{1}].",e.length,t.toString()),8}},Rte:function(a,b,c,d,e){var f;b=this.Ca.Ja();var g,h;if((h=wac_38(this,b,this.ua.LBc,g={val:f}),f=g.val,!h)||1===c)return f;wac_Y(38854738,352,50,"InsertMediaActor::ChangeIcon : Start changing.");
if(!e||!e.length)return 16;try{var k=wac_Goc(this);if(!k)return 16;var l=e[0].Caption,m=wac_BO(k);l&&m&&wac_dvc(this.Qg,new wac_Hpc(wac_GI(b),k.Yc(),k.Gm(),l));if(this.Ib.Ac(k))return 16;var n=this,p=this,q=wac_kO(this.nb,15,function(){wac_BM(n.ha);n.ra.ld()},function(){m&&(wac_Bnc(p.Qg),wac_cU(p.ha,m,!0,!0),wac_Cnc(p.Qg))},!1);try{q.lb(k),q.jr(a),wac_9zb(k,e[0].OriginalUrl),l&&wac_GBb(k,l)}finally{q&&q.dispose()}(c=m||k)&&this.Ib.cxa(b,c,this.Lc.Cb(),a);return 32}catch(r){return wac_Y(38670732,352,
10,"InsertMediaActor::ChangeIcon : icon count = [{0}], Exception = [{1}].",e.length,r.toString()),8}},k2d:function(a,b,c){var d;a=this.Ca.Ja();var e,f;if((f=wac_38(this,a,this.ua.lLa,e={val:d}),d=e.val,!f)||1===c)return d;try{return this.ua.$ge?(wac_Y(8955424,352,50,"[Insert Online Video] Insert online video from URL, creating dialog"),(new wac_Nlc(this.gBa)).dSa()):(wac_Y(38322659,352,50,"InsertMediaActor::ShowInsertVideoDialog : Insert online video"),this.T6b.IG(wac_rRb(this.ua.Wlc),this.S6b,this.urb,
wac_nRb).hSa(CommonUIStrings.L_VideoInsertTitle,new wac_L5b(this.U,this.urb))),wac_Y(8955426,352,50,"InsertMediaActor::ShowInsertVideoDialog : Show dialog success."),32}catch(g){return wac_Y(8955456,352,10,"InsertMediaActor::ShowInsertVideoDialog : Exception = [{0}]",g.toString()),8}},d5d:function(a,b,c,d,e){var f;b=this.Ca.Ja();var g,h;if((h=wac_38(this,b,this.ua.lLa,g={val:f}),f=g.val,!h)||1===c)return f;if(!wac_k7(this.Nj,b,1))return wac_j7(this.Nj,b),16;try{var k=wac_60(b,wac_5M(this.ha));if(k&&
this.Ib.Ac(k))return 16;var l=this.uab(this.Lc,b,k),m=wac_pRb(e.OriginalUrl);wac_LBb(l,m,e.ThumbnailUrl,e.Caption);var n=this,p=this,q=wac_kO(this.nb,15,function(){wac_zM(n.ha);wac_GL(n.ha);n.ra.ld()},function(){wac_cU(p.ha,l,!0,!0)},!1);try{q.lb(b),q.jr(a),k&&wac_iO(b,[k]),wac_90(this.Wm,b,l,null)}finally{q&&q.dispose()}wac_Y(8955460,352,50,"InsertMediaActor::UploadOnlineVideo : Inserting online video [{0}] is done.",e.OriginalUrl);wac_10(this.MB,l);return 32}catch(r){return wac_Y(8955462,352,10,
"InsertMediaActor::UploadOnlineVideo : Exception = [{0}].",r.toString()),8}},uab:function(a,b,c){return wac_Hoc(this,b,c,!1,0)}};
function wac_Hoc(a,b,c,d,e){var f=wac_GI(b);b=wac_70(b);var g=0,h=0;if(d){var k=g={val:g},l=h={val:h};c&&15===wac_YI(c)?(k.val=wac_Pe(c.ej(Number,wac_Fva,0),0,!1),l.val=wac_Pe(c.ej(Number,wac_Gva,0),0,!1)):(k.val=wac_Pe(2,0,!1),l.val=wac_Pe(2,0,!1));g=g.val;h=h.val}else g=110,h=75;k=c?wac_d1(c,g,h,!1):wac_g1(a.Pb,g,h);e=c?0:15*e;a=wac_e1(a.Bo,!0,f.fe(),f.Vc(),k.x+e,k.y+e,g,h,b+1,!0);wac_v(a,wac_38a,d);c&&wac_c1(a,c.ia());return a}
function wac_38(a,b,c,d){if(!b||!c||a.Ib.Ac(b))return d.val=16,!1;d.val=32;return!0}function wac_Goc(a){var b=null;a=wac_5M(a.ha);for(var c=a.length,d=0;d<c;++d){var e=a[d];if(e&&wac_zO(e))if(b)break;else b=e}return b}
function wac_Foc(a,b,c,d,e){d.val=Array(b.length);e.val=Array(b.length);var f=wac_Rfc(c,wac_5M(a.ha));if(f&&0<f.length)for(var g=0,h=f.length,k=0;k<h;++k){var l=f[k];if(l&&!a.Ib.Ac(l)&&g<b.length&&(d.val[g]=l,g++,g===b.length))break}f=!0;for(g=0;g<d.val.length;g++){if(a.ua.gfe&&b[g].SvgContent&&0<b[g].SvgContent.length&&(!d.val[g]||d.val[g]&&15!==wac_YI(d.val[g]))){var h=e.val,k=g,m=a,n=c,l=d.val[g],p=b[g],q=g,r=wac_GI(n),t=wac_70(n),v=void 0,u=void 0,n=window.$$as(wac_7J,wac_T(n,m.Lc.Cb()));wac_b5b(m.eta,
l,p.Width,p.Height,u={val:u},v={val:v});u=u.val;v=v.val;q=l?0:15*q;r=wac_e1(m.Bo,!0,r.fe(),r.Vc(),v.x+q,v.y+q,u.ac,u.qc,t+1,!1);t=wac_c5b(m.Lc.Df(),u,v,n.xia);wac_gzb(r,t);wac_v(r,wac_Iq,!0);wac_v(r,wac_7ta,!0);wac_Aqc(r,!0);wac_v(r,wac_Xta,!0);wac_v(r,wac_38a,!0);a:if(p=p.SvgContent,t=wac_dZc(m.Q5d,p),m=null,t&&t.innerHTML&&t.innerHTML.startsWith("<svg")){m=t.innerHTML;if(0<p.indexOf("viewBox")&&0>m.indexOf("viewBox"))if((t=p.match(/viewBox="[^"]*/))&&1===t.length&&t[0])m=m.replace("<svg",String.format('<svg {0}"',
t[0]));else{m=null;break a}if(0<p.replace(" ","").indexOf('xmlns="http://www.w3.org/'))m=0<m.indexOf("xmlns=")?m:m.replace("<svg",String.format("<svg {0}",'xmlns ="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'));else{m=null;break a}}wac_uRa(r,m?String.format("data:image/svg+xml;charset=utf8,{0}",window.encodeURIComponent(m)):"");l&&wac_c1(r,l.ia());h[k]=r}else e.val[g]=wac_Hoc(a,c,d.val[g],!0,g),f=!1;f&&wac_V7(!0,!0);wac_KBb(e.val[g],b[g].OriginalUrl,b[g].Caption,null,null)}return!0}
function wac_P$c(a){a.U.jf(2948423841,1,a.qrd,4);a.ua.Uif&&a.U.n2e("ppt_insertOnlineVideos",!0,2948423841,1,a.qrd,function(b){var c=a.Kaf;wac_NRc(window.Box4.App.zb(),b,c.Lqe||(c.Lqe=Function.createDelegate(c,c.U5e)))})}
function wac_O$c(a){a.U.jf(1685987254,1,a.ord,4);a.U.jf(2691408781,1,a.Ctf,4);a.U.jf(720118144,1,a.Nwb,4);a.ua.Uif&&(a.U.n2e("ppt_insertOnlinePictures",!0,1685987254,1,a.ord,function(b){var c=a.Kaf;wac_NRc(window.Box4.App.zb(),b,c.Lqe||(c.Lqe=Function.createDelegate(c,c.U5e)))}),a.U.n2e("ppt_insertOnlinePictures",!0,2691408781,1,a.Ctf,function(b){var c=a.Kaf;wac_NRc(window.Box4.App.zb(),b,c.Lqe||(c.Lqe=Function.createDelegate(c,c.U5e)))}),a.U.n2e("ppt_insertOnlinePictures",!0,720118144,1,a.Nwb,function(b){var c=
a.Kaf;wac_NRc(window.Box4.App.zb(),b,c.Lqe||(c.Lqe=Function.createDelegate(c,c.U5e)))}))}function wac_hoc(a,b,c){wac_hoc.initializeBase(this,[a,b,null]);this.ua=c;this.qLa=1488343741}
wac_hoc.prototype={ua:null,uya:function(a){if(a&&a.length){var b,c=a[0];(c=!!c&&!!c.OriginalUrl&&0<c.OriginalUrl.length&&this.ua.LBc&&!!this.ua.tvd&&0<this.ua.tvd.length&&0<=c.OriginalUrl.toLowerCase().indexOf(this.ua.tvd.toLowerCase())&&c.OriginalUrl.toLowerCase().indexOf(".svg")===c.OriginalUrl.length-4)||wac_Y(38670750,352,50,"isChangeSvg = false");try{if(c){wac_Y(38670742,352,50,"Change {0} svg images.",a.length);b=this.Ia.Wj(this.qLa,2,a,null);if(32!==b)throw Error.invalidOperation("Failed to change svg images.");
wac_Y(38670744,352,50,"Change {0} svg images successfully.",a.length)}else wac_Y(38670746,352,10,"Change {0} pictures not supported.",a.length)}catch(d){wac_Y(38670748,352,10,"InsertMediaActor::{0}: Exception = [{1}].",c?"OnChangeSvg":"OnChangePicture",d.toString())}}}};function wac_F8(a,b,c){wac_F8.initializeBase(this,[a,b,null]);this.ua=c;this.qLa=2168883939}
wac_F8.prototype={ua:null,uya:function(a){if(a&&a.length){var b,c=wac_h3a(this.qLa),d=new window.Map;d.set("InsertMediaCommand",c);wac_B().recordKpiUsageForAlertableKpi("InsertOnlineImage",null,d);try{if(330605680===this.qLa||2888756397===this.qLa){for(var c=[],e=[],f=0;f<a.length;f++){var g=a[f];wac_Q$c(this,g)?Array.add(c,g):Array.add(e,g)}wac_Y(594043782,352,50,"InsertMediaCallback:  Insert {0} M365 premium pictures {1} M365 premium svg images ",e.length,c.length);for(f=0;f<e.length;f++)if(b=this.Ia.Wj(330605680,
2,e[f],null),32!==b)throw Error.invalidOperation(String.format("Failed to upload M365 picture {0}",e.toString()));if(wac_Q$c(this,c[0])&&(b=this.Ia.Wj(2888756397,2,c,null),32!==b))throw Error.invalidOperation(String.format("Failed to insert M365 svg images {0}",c.toString()));wac_Y(594043780,352,50,"InsertMediaCallback: Insert {0} M365 pictures {1} M365 svg images success.",e.length,c.length)}else if(934858027===this.qLa&&wac_Q$c(this,a[0])){wac_Y(37822688,352,50,"InsertMediaCallback: Insert {0} svg images.",
a.length);b=this.Ia.Wj(this.qLa,2,a,null);if(32!==b)throw Error.invalidOperation("Failed to insert svg images");wac_Y(37822690,352,50,"InsertMediaCallback: Insert {0} svg images successfully.",a.length)}else if(2168883939===this.qLa||239978317===this.qLa){wac_Y(21844548,352,50,"InsertMediaCallback:  Insert {0} pictures, command: {1}",a.length,c);for(f=0;f<a.length;f++)if(b=this.Ia.Wj(this.qLa,2,a[f],null),32!==b)throw Error.invalidOperation(String.format("Failed to upload picture {0}",f));wac_Y(21844550,
352,50,"InsertMediaCallback:  Insert {0} pictures success.",a.length)}else wac_Y(39409236,352,10,"InsertMediaCallback:  invalid action: {0}.",this.qLa),wac_B().recordKpiFailure("InsertOnlineImage","InvalidAction",!0,!0,(e=new wac_6j,e.extendedProperties=d,e))}catch(k){wac_Y(21844552,352,10,"InsertMediaActor::{0}: Exception = [{1}].",this.qLa.toString(),k.toString());d.set("Exception",k.toString());var h;wac_B().recordKpiFailure("InsertOnlineImage","InsertMediaException",!1,!0,(h=new wac_6j,h.extendedProperties=
d,h))}}}};function wac_Q$c(a,b){(a=!!b&&!!b.OriginalUrl&&0<b.OriginalUrl.length&&a.ua.vvd&&!!a.ua.tvd&&0<a.ua.tvd.length&&0<=b.OriginalUrl.toLowerCase().indexOf(a.ua.tvd.toLowerCase())&&b.OriginalUrl.toLowerCase().indexOf(".svg")===b.OriginalUrl.length-4)||wac_Y(37822723,352,50,"isInsertSvg = false");return a}function wac_L5b(a,b){wac_L5b.initializeBase(this,[a,b,null]);this.qLa=2168458114}wac_L5b.prototype={uya:function(a){a&&0<a.length&&this.Ia.Wj(this.qLa,2,a[0],null)}};
function wac_C$c(a){if(!a||!a.length){wac_Y(594351642,825,10,"StreamPreFetchHelper::InsertEmbedVideoPreFetchIFrame: invalid input urls");return}var b=document.getElementById(wac_.xNf);if(!b){wac_Y(594351640,825,10,"StreamPreFetchHelper::InsertEmbedVideoPreFetchIFrame: can't find application div");return}for(var c=new (wac_e.$$(String,String)),d=a.length,e=0;e<d;++e){var f=a[e].trim();if(wac_R$c(f)){var g=f.match(/([\w\d\-_]*.*)\/([a-zA-Z0-9-_]+)/);if(3>g.length)wac_Y(594351636,825,10,"StreamPreFetchHelper::InsertEmbedVideoPreFetchIFrame: failed extracting video ID from url");
else{var f=g[1],g=g[2],h=!!g&&"0"!==g;if(!c.K(f)){var k=f,k=h?k+"/pre-fetch":k+"/pre-auth";c.vf(f,k)}if(h){var l;c.vf(l=f,c.K(l)+("#"+g))}}}else wac_Y(594351638,825,50,"StreamPreFetchHelper::InsertEmbedVideoPreFetchIFrame: provider not supported")}if(0<c.Ma()){var m=document.createElement("div");m.setAttribute("id","StreamEmbedVideoPreAuthIFrameRoot");m.setAttribute("style","display:none;width:400px;height:400px;position:absolute;left:0px;left:0px;bottom:0px;z-index:10");c.Ne(function(a,b){a=document.createElement("iframe");
a.setAttribute("src",b);a.setAttribute("style","width:100%;height:100%");m.appendChild(a);return!0});b.appendChild(m)}}function wac_R$c(a){return(a=wac_ztb(a))?(a=a.toLowerCase(),a.endsWith("microsoftstream.com")):!1}function wac_i3b(){}wac_i3b.prototype={IG:function(a,b,c,d){return new wac_d5(a,b,c,d)}};function wac_v4b(a,b,c,d,e,f,g,h){this.Nvb=Function.createDelegate(this,this.hMb);wac_v4b.initializeBase(this,[a,b,c,f,g,h]);this.U=d;this.Pb=e}
wac_v4b.prototype={U:null,Pb:null,Tb:function(){this.U.ja(981175184,1,this.crd);this.nYc.uc(this.Nvb)},Lf:function(){},$Ec:function(){var a=this.Pb.Kna(!0);if(!this.X0a||!a.qc)return!1;var a=a.ac/a.qc,b=new wac_D2b(this.X0a,!1,a);this.OXc=b;this.LX=a;this.C5b=!!this.Ob&&!!this.X0a&&!wac_h(this.E0a)&&!!b&&!!a;return!0},hMb:function(a){this.d1a=a;wac_yg||wac_.pya||!this.d1a||(this.d1a.vtb("CanEmbed"),this.d1a.Kzd("CanEmbed",this.drd))}};
function wac_s4b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w,x,z,y,A){this.g4=Function.createDelegate(this,this.FRa);this.Nvb=Function.createDelegate(this,this.hMb);this.aod=Function.createDelegate(this,this.yYd);this.Ypd=Function.createDelegate(this,this.k0d);this.ccd=Function.createDelegate(this,this.VHd);this.dcd=Function.createDelegate(this,this.WHd);this.TJf=Function.createDelegate(this,this.STf);this.SJf=Function.createDelegate(this,this.RTf);this.RJf=Function.createDelegate(this,this.QTf);this.V8c=
Function.createDelegate(this,this.ACd);this.S8c=Function.createDelegate(this,this.xCd);this.T8c=Function.createDelegate(this,this.yCd);this.gvb=Function.createDelegate(this,this.uGb);this.bcd=Function.createDelegate(this,this.UHd);this.U=a;this.zd=b;this.ra=c;this.ha=d;this.JB=e;this.Zo=f;this.t$b=g;this.rYc=h;this.I1c=k;this.pqb=l;this.Ob=m;this.B6b=u.Clc;this.Y4e=u.mvd;this.Kl=n;this.Cc=x;this.GUc=u.Vqc;this.fae=p;this.ZX=q;this.hb=v;this.gT=!u.Pi();this.Q9b=z;this.urf=A;this.Y4b=!u.qCb||wac_q(w,
"DisablePrint");this.Z4b=r;this.yi=t;this.NWc=w.Qb.DownloadPdfFromPodsUrl;this.H1c=w.Qb.PrintPdfFromPodsUrl;this.MWc=w.Qb.DownloadOdpFromPodsUrl;this.J1c=u.iCb;this.LWc=w.Qb.DownloadImagesFromPodsUrl;this.M2c=u.drc;a=(wac_.Vxa||"").toLowerCase();u.Pi()&&u.Azb?(this.lVc=!0,this.w0a=w.Qb.DownloadACopyPodsUrl):!u.Pi()&&u.Znc&&(a.endsWith(".pptx")||a.endsWith(".ppsx"))?(w=new wac_nh(wac_P1("DownloadACopyHandler.ashx")),wac_oh(w,"Pid",this.hb.Bj().Tj),wac_oh(w,"si",this.hb.Gc),wac_oh(w,"fn",wac_.Vxa),
wac_Wg(w.Qja),this.w0a=w.toString()):this.w0a=wac_.INa;this.nYc=y;this.AEf=u.Iif}
wac_s4b.prototype={U:null,zd:null,ra:null,ha:null,JB:null,Zo:null,rYc:null,t$b:!1,I1c:null,pqb:null,Ob:null,B6b:null,Y4e:!1,w0a:null,Kl:null,GUc:!1,fae:null,ZX:null,hb:null,gT:!1,Y4b:!1,Z4b:null,yi:null,NWc:null,H1c:null,MWc:null,LWc:null,M2c:!1,Q9b:null,J1c:!1,lVc:!1,Cc:null,nYc:null,d1a:null,urf:null,AEf:!1,Tb:function(){var a=!!this.Z4b&&!this.Q9b();wac_Y(25297680,801,50,"Limited printing access: {0}, Message shown: {1}",this.Y4b,a);if(this.Y4b){if(a){var a=this.yi,b=a.ME.Db(null,this.Z4b,null);
wac_KP(b,!0);b.Do(20);a.Oo.tG(b,!1,null)}}else this.U.ja(1588554917,1,this.bcd),this.U.ja(3555692408,1,this.gvb),this.U.ja(2439343378,1,this.T8c),this.U.ja(1249692773,1,this.S8c),this.U.ja(1191538800,1,this.V8c),this.U.ja(1924572812,1,this.RJf),this.U.ja(3098027807,1,this.SJf),this.U.ja(3131236268,1,this.TJf),this.J1c&&(wac_Y(25306193,801,50,"Printing options enabled"),this.U.ja(277798930,1,this.dcd),this.U.ja(2255327903,1,this.ccd));this.U.ja(3070187925,1,this.Ypd);this.t$b&&this.U.jf(1007486079,
1,this.aod,96);this.nYc.uc(this.Nvb)},Lf:function(){var a=this.ra.xc("app");a.Ba(wac_A(80,wac_8j()),1588554917);a.Ba(wac_A(68,wac_8j()),336231556);a.Ba(wac_A(83,wac_8j()),336231556);a.Ba(wac_A(117,wac_8j()),336231556);a.Ba(wac_A(117,wac_8j()|4),336231556)},RTf:function(a,b,c){return wac_S$c(this,c,2316717900)},QTf:function(a,b,c){return wac_S$c(this,c,4246497969)},STf:function(a,b,c){return wac_S$c(this,c,3050207199)},uGb:function(a,b,c){if(this.zd.Ac(this.JB))return 16;if(1===c)return wac_II(this.Cc)?
wac_bf?8:32:8;wac_GL(this.ha);this.ra.ld();wac_Y(19743434,801,50,"PPT save and download a copy");if(this.Y4e&&this.hb.BFd)wac_T$c(this);else{this.Kl.Ki(!0,a);var d=this;wac_fY(this.Zo,!1,this.gT,function(){wac_T$c(d)},this.g4,1)}return 32},yYd:function(a,b,c,d,e){a="";this.t$b&&(a=this.rYc.mJ(this.JB)?String.format(ResourceStrings.L_SavingStatus):this.B6b?String.format(CommonUIStrings.l_SavedToStatus,this.B6b):String.format(ResourceStrings.L_SavedStatus));e.Value=a;return 32},UHd:function(a,b,c){return wac_w5b(this,
c,0,a)},WHd:function(a,b,c){return wac_w5b(this,c,8,a)},VHd:function(a,b,c){return wac_w5b(this,c,4,a)},yCd:function(a,b,c){if(this.zd.Ac(this.JB))return 16;if(1===c)return wac_II(this.Cc)?wac_bf?8:32:8;this.ZX.xyb=new Date;wac_GL(this.ha);this.ra.ld();if(this.Y4e&&this.hb.BFd)wac_U$c(this);else{this.Kl.Ki(!0,a);var d=this;wac_fY(this.Zo,!1,this.gT,function(){wac_U$c(d)},this.g4,1)}return 32},ACd:function(a,b,c){if(this.zd.Ac(this.JB))return 16;if(1===c)return wac_II(this.Cc)?wac_bf?8:32:8;wac_GL(this.ha);
this.ra.ld();if(this.Y4e&&this.hb.BFd)wac_V$c(this);else{this.Kl.Ki(!0,a);var d=this;wac_fY(this.Zo,!1,this.gT,function(){wac_V$c(d)},this.g4,1)}return 32},xCd:function(a,b,c){if(this.zd.Ac(this.JB))return 16;if(1===c)return wac_II(this.Cc)?wac_bf?8:32:8;wac_GL(this.ha);this.ra.ld();if(this.Y4e&&this.hb.BFd)wac_W$c(this);else{this.Kl.Ki(!0,a);var d=this;wac_fY(this.Zo,!1,this.gT,function(){wac_W$c(d)},this.g4,1)}return 32},FRa:function(){this.Kl.fd();return!1},k0d:function(a,b,c,d,e){if(this.zd.Ac(this.JB))return 16;
if(1===c)return 32;wac_GL(this.ha);this.ra.ld();wac_fY(this.Zo,!1,!0,function(a){if(e&&1<=e.length)e[0](a)},function(a){return e&&2<=e.length?(e[1](a,a.ServerError.Code),!0):!1},1);return 32},hMb:function(a){this.d1a=a}};
function wac_08(a,b){if(b){var c=new wac_nh(b);a.hb&&a.hb.Jc&&0>b.indexOf(a.hb.Jc)&&(c.rMa("PodSID="+a.hb.Jc),wac_Y(35235403,801,50,"Append PodSessionId in url: {0}",a.hb.Jc));a.M2c&&wac_.dJ.lw&&0<wac_.dJ.lw.length&&(wac_oh(c,"fn",wac_.dJ.lw),wac_Y(37246871,801,50,"Appended FileName in url"));a.AEf&&(wac_oh(c,"ipp","true"),wac_Y(595133152,801,50,"Appended IsPasswordProtectedFile param"));wac_Wg(c.Qja);return c.toString()}return null}
function wac_W$c(a){a.Kl.fd();wac_x5b(a.pqb,a.hb.Bj().Tj,0,wac_08(a,a.MWc))}function wac_V$c(a){a.Kl.fd();wac_x5b(a.pqb,a.hb.Bj().Tj,2,wac_08(a,a.LWc))}function wac_U$c(a){a.Kl.fd();a.ZX.JCb=new Date;wac_x5b(a.pqb,a.hb.Bj().Tj,1,wac_08(a,a.NWc))}
function wac_X$c(a,b){a.Kl.fd();var c=a.I1c,d=a.hb.Bj().Tj;a=wac_08(a,a.H1c);c.od.Ta.Kzb&&c.qXc?(d=new wac_nh(a),wac_oh(d,"useNamedAction",wac_JNb(c.gGa).toString()),wac_oh(d,"publishOption",b.toString()),wac_Q6c(c.gGa,d.toString())):(b=new wac_y5b(d,wac_JNb(c.gGa)),b.Lsb=c.ljd,b.Wd())}
function wac_w5b(a,b,c,d){if(a.zd.Ac(a.JB))return 16;if(1===b)return wac_II(a.Cc)?wac_bf?8:32:8;if(a.Q9b())return wac_Y(24934547,328,50,"Printing not allowed for IRM protected documents"),16;wac_Y(18983065,328,50,"PPT Editor print. PublishOption: {0}",c);wac_GL(a.ha);a.ra.ld();a.Y4e&&a.hb.BFd?wac_X$c(a,c):(a.Kl.Ki(!0,d),wac_fY(a.Zo,!1,a.gT,function(){wac_X$c(a,c)},a.g4,1));return 32}
function wac_T$c(a){a.Kl.fd();var b=a.lVc?wac_08(a,a.w0a):a.w0a;a.urf&&a.urf("3555692408")?a.d1a.Dx("UI_Download",{},""):a.GUc?new wac_v5b(b):a.Ob.qv(!0,b,!0)}function wac_S$c(a,b,c){return 1===b?wac_bf?8:a.U.yw(c,1,null):a.Y4e&&a.hb.BFd?(wac_Y(50370185,801,50,"DocumentOperationsActor:SaveAsImpl - Inline Repair Case , ActionId: {0}",c),a.U.Wj(2916697279,2,c,null)):a.U.yw(c,2,null)}function wac_T7b(a){wac_T7b.initializeBase(this,[a])}
wac_T7b.prototype={rha:function(){return wac_.oQ?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady},JPa:function(){wac_Y(25544926,801,50,"Images download dialog displayed")},KPa:function(){wac_Y(25544928,801,50,"Images download dialog link clicked")},Oya:function(){wac_Y(25544930,801,50,"Images download dialog button clicked")}};function wac_y9(a){wac_y9.initializeBase(this,[a,!0,wac_.oQ,null,null])}
wac_y9.prototype={rha:function(){return ResourceStrings.l_DownloadAsOdpDialogOdpReady},Mob:function(){return ResourceStrings.l_DownloadAsOdpDialogLinkSuggestion},S2b:function(){return"DownloadOdpLink"},MZa:function(){return ResourceStrings.L_Download},RZa:function(){return wac_.oQ?"UIFontDialogTextLarge":null},JPa:function(){wac_Y(8958087,801,50,"ODP download dialog displayed")},KPa:function(){wac_Y(8958089,801,50,"ODP download dialog link clicked")},Oya:function(){wac_Y(19505496,801,50,"ODP download dialog button clicked")},
Dzc:function(){wac_hi("PPTODF");return!0},YTc:function(){return"#"},XTc:function(){return ResourceStrings.l_DownloadAsOdpDialogLearnMoreLinkText},aUc:function(){return!wac_.oQ}};function wac_H8(){this.xyb=this.JCb=this.cyb=this.syb=window.Box4.App.Fn}wac_H8.prototype={xyb:null,JCb:null,cyb:null,syb:null};function wac_z9(a){wac_z9.initializeBase(this,[a])}
wac_z9.prototype={rha:function(){return wac_.oQ?CommonUIStrings.l_DownLoadACopyDialogMessage:ResourceStrings.l_DownloadAsPdfDialogPdfReady},JPa:function(){wac_Y(21050910,801,50,"PDF download dialog displayed")},KPa:function(){wac_Y(21050912,801,50,"PDF download dialog link clicked")},Oya:function(){wac_Y(21050914,801,50,"PDF download dialog button clicked")}};function wac_37b(){}
wac_37b.prototype={Ub:function(){return"PowerPointWebEditor.PrintPackage"},gc:function(){wac_m(wac_n(wac_o(wac_j().fa(wac_47b),wac_t4b)),function(){return new wac_47b(wac_k(wac_j(),wac_h4),wac_k(wac_j(),wac_3L),wac_k(wac_j(),wac_R).Pi())});wac_m(wac_n(wac_o(wac_j().fa(wac_57b),wac_u4b)),function(){return new wac_57b(wac_0b(wac_j(),wac_H8),wac_k(wac_j(),wac_3L),wac_k(wac_j(),wac_R).Pi())});wac_m(wac_n(wac_j().fa(wac_H8)),function(){return new wac_H8})},tb:function(){},O:function(){}};
function wac_u$b(a){wac_u$b.initializeBase(this,[ResourceStrings.l_ConvertingToOdpProgressString,ResourceStrings.l_ConvertingToOdpErrorString,5308438]);this.Vn=a}wac_u$b.prototype={Wd:function(){wac_49.prototype.Wd.call(this);var a=this.Vn,b=this.vT,c=this.mZ,d=new wac_ME("ConvertToOdp");wac_NE(d,null);wac_OE(d,new wac_PE("presentationId",a));wac_KE.pr(d,b,c,null,null,null,2)},Vn:null};
function wac_v$b(a){wac_v$b.initializeBase(this,[ResourceStrings.L_PrintingProgressString,ResourceStrings.l_ConvertingToPdfErrorString,5308439]);this.Vn=a}wac_v$b.prototype={Wd:function(){wac_49.prototype.Wd.call(this);var a=this.Vn,b=this.vT,c=this.mZ,d=new wac_ME("ConvertToPdf");wac_NE(d,null);wac_OE(d,new wac_PE("presentationId",a));wac_KE.pr(d,b,c,null,null,null,2)},Vn:null};function wac_v5b(a){wac_v5b.initializeBase(this,[a,!0,wac_.oQ,null,null])}
wac_v5b.prototype={rha:function(){return CommonUIStrings.l_DownLoadACopyDialogMessage},Mob:function(){return CommonUIStrings.l_DownLoadACopyDialogLinkSuggestion},S2b:function(){return"PowerPointDownloadCopyLink"},MZa:function(){return CommonUIStrings.l_Download},RZa:function(){return wac_.oQ?"UIFontDialogTextLarge":null},JPa:function(){wac_Y(19743688,801,50,"Download a copy dialog displayed")},KPa:function(){wac_Y(19743690,801,50,"Download a copy dialog clicked")},Oya:function(){wac_Y(19743692,801,
50,"Download a copy dialog button clicked")}};function wac_D3b(){}wac_D3b.prototype={};function wac_y5b(a,b){wac_y5b.initializeBase(this,[ResourceStrings.L_PrintingProgressString,ResourceStrings.L_PrintingErrorString,5308421]);this.Vn=a;this.i4c=b}
wac_y5b.prototype={i4c:!1,Wd:function(){wac_49.prototype.Wd.call(this);var a=this.Vn,b=this.i4c,c=this.vT,d=this.mZ,e=new wac_ME("Print");wac_NE(e,null);wac_OE(e,new wac_PE("presentationId",a));wac_OE(e,new wac_PE("useNamedAction",b));wac_KE.pr(e,c,d,null,null,null,2)},Vn:null};function wac_47b(a,b,c){this.ljd=Function.createDelegate(this,this.aSd);if(!a)throw Error.argumentNull("directPrintManager");this.gGa=a;this.od=b;this.qXc=c}
wac_47b.prototype={gGa:null,od:null,qXc:!1,aSd:function(a){var b=this.gGa;b.mx.ezc&&wac_b(4535643,328,50,"[MimeTypes: {0}] [Plugins: {1}]",b.JDa.ma().$fb,b.JDa.ma().C0);a=a.qf;1!==wac_r().kg()&&(a=wac_P1(a.PrintUrl),wac_Q6c(this.gGa,a))}};function wac_37(a,b,c,d){this.AAe=Function.createDelegate(this,this.yye);this.qIa=a;this.Gh=b;this.Ta=c;this.Cc=d;this.Rta={}}wac_37.prototype={s2a:null,qIa:null,Gh:null,Ta:null,Cc:null,Rta:null};
wac_37.prototype.wCe=function(a,b){try{wac_Y(39105290,822,50,"PPTVersionHistorySelectionHandler:OnVersionHistorySelected");var c=document.getElementById("VersionHistoryViewerSpinner");c&&(c.style.display="none");if(this.s2a)this.s2a.onVersionSelected(a,b,this.Rta)}catch(d){wac_Y(39146258,822,50,"PPTVersionHistorySelectionHandler: OnVersionHistorySelected failed due to exception. {0}",d)}};wac_37.prototype.OnVersionHistorySelected=wac_37.prototype.wCe;
wac_37.prototype.Lye=function(a){try{if(this.s2a)wac_gvc(!1),this.s2a.switchParentViewContainer(a);else{wac_gvc(!0);var b=new window.PowerPointVersionHistory.AppBootSettings;b.RenderServiceBase="";b.IsRtl=!1;var c=new window.PowerPointVersionHistory.AppCallbackBag,d=this.qIa;c.animationDecoratorCallback=d.zAe||(d.zAe=Function.createDelegate(d,d.RBe));c.notesIconDecoratorCallback=this.AAe;b.IsHighContrast=!1;this.Gh&&(b.IsHighContrast=this.Gh.ZJ);b.IsHighContrast&&(b.ClientColorSettings=this.Gh.Ap.wba+
"_"+this.Gh.Ap.jVc+"_"+this.Gh.Ap.YKa);if(this.Cc){var e=wac_CI(this.Cc);b.DefaultSlideWidth=e.ac;b.DefaultSlideHeight=e.qc}b.UserSessionId=wac_.Ag;b.VersionViewerCssUrl=this.Ta.IBe;b.ProgressImageResourceUrl=wac_Le("progress.gif");b.VersionViewerUseGetItems=this.Ta.Ejf;this.s2a=new window.PowerPointVersionHistory.AppVersionController(b,a,c)}}catch(f){wac_Y(39146260,822,50,"PPTVersionHistorySelectionHandler: ResetAppVersionController failed due to exception. {0}",f)}};
wac_37.prototype.ResetAppVersionController=wac_37.prototype.Lye;wac_37.prototype.yye=function(){return wac_4h(14,14,"ToolbarNotesActiveDark_14x14x32",null,"Notes")};wac_37.prototype.CreateNotesIcon=wac_37.prototype.yye;function wac_3wc(a,b,c){wac_3wc.initializeBase(this,[b,c]);this.Fe=a}
wac_3wc.prototype={Fe:null,DZa:null,y2b:function(){if(this.DZa)return this.DZa.oj();this.DZa=new (wac_Rb.$$(String));var a=this;this.Fe.Ok(function(){var b=a.Fe.Qb[wac_2(125)];b||(wac_Y(9007258,333,15,"Contact Id is null"),b="NoCIdUser");a.DZa.Ze(b)});return this.DZa.oj()}};
function wac_4wc(a,b,c,d,e,f,g,h,k,l){wac_4wc.initializeBase(this,[d,c,e,f,g]);this.he=a;this.U=d;this.BVc=h;this.gy=b;this.ne=l;this.O_a=k;if(!this.gy)throw Error.argumentNull("m_coauthEventHandler");var m=this;wac_jqb(this.gy,function(){m.U.yw(2854028228,2,null)})}wac_4wc.prototype={he:null,BVc:null,gy:null,U:null,ne:!1,O_a:null,Hfb:function(){this.BVc.uc(function(a){var b=a.ME.Db(null,CommonUIStrings.l_ChatIsNotAvailable,null);wac_KP(b,!0);b.Do(17);a.Oo.tG(b,!1,null)})}};
function wac_s4(a){a.ne?a.O_a.uc(function(a){a.y7()}):wac_H0a(a.he,new wac_YL(a.ar().ta,!0))}function wac_Jwc(){this.hdd=Function.createDelegate(this,this.MJd);this.CEe=Function.createDelegate(this,this.xMe)}
wac_Jwc.prototype={J:null,gy:null,Ub:function(){return"PowerPointWebEditor.PowerPointSkypeChatPackage"},tb:function(){wac_.Q9a.dO()?(this.gy=this.J.H(wac_MY),this.gy.la.xa("CSC",this.CEe)):wac_5wc(this)},xMe:function(){wac_.Q9a.dO()||(wac_5wc(this),this.gy.la.sb("CSC",this.CEe))},O:function(){},MJd:function(){wac_j().H(wac_Cc)},gc:function(a){this.J=a;wac_m(wac_n(wac_o(a.fa(wac_u4),wac_Cc)),function(){return new wac_u4(wac_rP(wac_yc,wac_l(wac_j(),wac_yc)),wac_rP(wac_Hc,wac_l(wac_j(),wac_Hc)),wac_rP(wac_Ic,
wac_l(a,wac_Ic)),wac_rP(wac_Gc,wac_l(a,wac_Gc)))});wac_m(wac_n(a.fa(wac_m4)),function(){return new wac_3wc(wac_j().H(wac_Uc),wac_rP(wac_Im,wac_l(a,wac_Im)),wac_rP(wac_Jm,wac_l(a,wac_Jm)))});wac_m(wac_n(wac_o(a.fa(wac_p4),wac_9la)),function(){return new wac_p4(wac_rP(wac_yc,wac_l(wac_j(),wac_yc)),wac_rP(wac_Ic,wac_l(a,wac_Ic)),wac_rP(wac_Hc,wac_l(wac_j(),wac_Hc)),a.H(wac_m4),wac_rP(wac_Gc,wac_l(wac_j(),wac_Gc)),wac_.pa)});var b=this;wac_m(wac_n(wac_o(wac_o(a.fa(wac_4wc),wac_r4),wac_$la)),function(){var c=
wac_4wc,d=a.H(wac_Qt),e=a.H(wac_MY),f=a.H(wac_cOb),g=a.H(wac_Oc),h=wac_rP(wac_Cc,wac_l(a,wac_Cc)),k=a.H(wac_kG).Bz(),l="";b.J.H(wac_R).Pi()&&(l=wac_0i(b.J.H(wac_Uc),wac_2(368))+"p/");return new c(d,e,f,g,h,wac_8Nb(k,l+"skypeproxy.ashx"),a.H(wac_9la),wac_l(a,wac_jM),wac_l(a,wac_mr),a.H(wac_R).ao)})}};function wac_5wc(a){wac_.pa.Ok(function(){wac_q(wac_.pa,"DocChatIsEnabled")&&(new wac_gOb(new (wac_f.$$(wac_$la))(function(){return a.J.H(wac_r4)}),wac_l(a.J,wac_Im),a.hdd)).tb()})}Type.registerNamespace("PowerPointWeb");
wac_wG=window.PowerPointWeb||{};function wac_u4b(){}wac_u4b.registerInterface("PowerPointWeb.IConverter");function wac_t4b(){}wac_t4b.registerInterface("PowerPointWeb.IPrinter");function wac_57b(a,b,c){this.jgd=Function.createDelegate(this,this.TOd);this.igd=Function.createDelegate(this,this.SOd);this.ZX=a;this.od=b;this.Sqb=c}
wac_57b.prototype={ZX:null,od:null,Sqb:!1,SOd:function(a){a=a.qf;1!==wac_r().kg()&&(a=wac_P1(a.PrintUrl),new wac_y9(a))},TOd:function(a){a=a.qf;1!==wac_r().kg()&&(a=wac_P1(a.PrintUrl),this.ZX.ma().cyb=new Date,new wac_z9(a),this.ZX.ma().syb=new Date,wac_Y(21050908,801,50,"DownloadACopyAsPdf-StartTime: {0}, DownloadACopyAsPdf-SaveEnd: {1}, DownloadACopyAsPdf-ConvertEnd: {2}, DownloadACopyAsPdf-DialogShowEnd: {3}.",this.ZX.ma().xyb.toString(),this.ZX.ma().JCb.toString(),this.ZX.ma().cyb.toString(),
this.ZX.ma().syb.toString()))}};function wac_x5b(a,b,c,d){var e=null;c?1===c?a.od.Ta.Kzb&&a.Sqb?new wac_z9(d):wac_qE(wac__,function(){e=new wac_v$b(b);e.Lsb=a.jgd;e.Wd()}):2===c?a.od.Ta.vAb&&a.Sqb&&new wac_T7b(d):Error.invalidOperation(String.format("Convert task type '{0}' is not supported",c)):a.Sqb?new wac_y9(d):(e=new wac_u$b(b),e.Lsb=a.igd,e.Wd())}wac_A2b.registerClass("PPTe.EmbedManager");wac_C2b.registerClass("PPTe.PowerPointEmbedDialog",wac_e3);wac_F2b.registerClass("PPTe.PowerPointEmbedDialog.EmbedSizeOptions");
wac_D2b.registerClass("PPTe.FormatPicker");wac_sIc.registerClass("PowerPointWebEditor.Chronos2Package",null,wac_I,wac_i);wac_H$c.registerClass("PowerPointWebEditor.PrefetchBootstrapper");wac_M$c.registerClass("PowerPointWebEditor.KeyValueEntry");wac_O3b.registerClass("PowerPointWebEditor.AddinCommandsActor",null,wac_g8);wac_Q3b.registerClass("PowerPointWebEditor.AppForOfficeActor",null,wac_g8);wac_u9.registerClass("PowerPointWebEditor.AddinCommandsInitService",wac_lIb,wac_J2b);
wac_P7b.registerClass("PowerPointWebEditor.AddInCommandsInitPackage",null,wac_I,wac_i);wac_p8b.registerClass("PowerPointWebEditor.AppForOfficeManagerFactory",null,wac_bM);wac_J8.registerClass("PowerPointWebEditor.AppForOfficeManagerFactory.CommandActionData");wac_A4b.registerClass("PowerPointWebEditor.InsertMediaActor",null,wac_g8);wac_hoc.registerClass("PowerPointWebEditor.ChangeOnlineImageHelper",wac_j5);wac_F8.registerClass("PowerPointWebEditor.InsertOnlineImageHelper",wac_j5);
wac_L5b.registerClass("PowerPointWebEditor.InsertOnlineVideoHelper",wac_j5);(function(){}).registerClass("PowerPointWebEditor.StreamPreFetchHelper");wac_i3b.registerClass("PowerPointWebEditor.PptInsertMediaDialogFactory",null,wac_V2b);wac_v4b.registerClass("PowerPointWebEditor.EmbedActor",wac_A2b,wac_g8);wac_s4b.registerClass("PowerPointWebEditor.DocumentOperationsActor",null,wac_g8);wac_T7b.registerClass("PowerPointWebEditor.DownloadACopyAsImagesDialog",wac_c3);
wac_y9.registerClass("PowerPointWebEditor.DownloadACopyAsOdpDialog",wac_b3);wac_H8.registerClass("PowerPointWebEditor.DownloadACopyAsPdfContext");wac_z9.registerClass("PowerPointWebEditor.DownloadACopyAsPdfDialog",wac_c3);wac_37b.registerClass("PowerPointWebEditor.PrintPackage",null,wac_I,wac_i);wac_u$b.registerClass("PowerPointWebEditor.ConvertToOdpTask",wac_49);wac_v$b.registerClass("PowerPointWebEditor.ConvertToPdfTask",wac_49);
wac_v5b.registerClass("PowerPointWebEditor.PowerPointDownloadACopyDialog",wac_b3);wac_D3b.registerClass("PowerPointWebEditor.PowerPointDownloadACopyDialogFactory",null,wac_12b);wac_y5b.registerClass("PowerPointWebEditor.PrintTask",wac_49);wac_47b.registerClass("PowerPointWebEditor.Printer",null,wac_t4b);wac_37.registerClass("PowerPointWebEditor.PPTVersionHistorySelectionHandler",null,wac_kIa);wac_3wc.registerClass("PowerPointWebEditor.PowerPointDocChatUserIdFactory",wac_lOb,wac_m4);
wac_4wc.registerClass("PowerPointWebEditor.PowerPointSkypeChatActor",wac_r4);wac_Jwc.registerClass("PowerPointWebEditor.PowerPointSkypeChatPackage",null,wac_I,wac_i);wac_57b.registerClass("PowerPointWeb.Converter",null,wac_u4b);var wac_e8=null,wac_I$c=[],wac_K5b=!1;wac_.ke&&wac_dg()?wac_Y(40122142,809,15,"Firefox attempts to load chronos2 package when App is disposing"):wac_J(wac_C(),wac_k4(new wac_sIc,5),0,!1);Type.registerNamespace("PowerPointWebEditor");wac_Z=window.PowerPointWebEditor||{};
function wac_X7(){}wac_X7.registerInterface("PowerPointWebEditor.IDesignerContext");function wac_07(){}wac_07.registerInterface("PowerPointWebEditor.IDesignerViewHelper");Type.registerNamespace("PowerPointWebEditor.Designer");wac_Z.gGb=wac_Z.gGb||{};function wac_3nc(){}wac_3nc.registerInterface("PowerPointWebEditor.Designer.IDesignerPreviewImageView");function wac_Y$c(){}
function wac_Q1b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w,x,z,y,A,B,C,F,D,G){this.Bse=Function.createDelegate(this,this.mve);this.Eo=Function.createDelegate(this,this.ju);this.Wee=Function.createDelegate(this,this.rCe);this.Fec=Function.createDelegate(this,this.KPd);this.lJa=Function.createDelegate(this,this.oQa);this.q8c=Function.createDelegate(this,this.LBd);this.p8c=Function.createDelegate(this,this.KBd);this.iba=Function.createDelegate(this,this.Dda);this.Vfc=Function.createDelegate(this,this.YSd);
this.xJf=Function.createDelegate(this,this.SSf);this.r8c=Function.createDelegate(this,this.MBd);this.osf=Function.createDelegate(this,this.kPf);this.zZe=Function.createDelegate(this,this.o1e);this.tpd=Function.createDelegate(this,this.Beb);this.Uua=Function.createDelegate(this,this.xMd);this.Ybc=Function.createDelegate(this,this.jxd);this.cod=Function.createDelegate(this,this.AYd);this.SKf=Function.createDelegate(this,this.jVf);this.hrd=Function.createDelegate(this,this.b2d);this.Se=f;this.Urb=g;
this.Np=h;this.d7a=k;this.WX=l;this.Ft=m;this.Ec=n;this.U=a;this.Xb=d;this.ra=e;this.Ea=p;this.Kz=q;this.Qg=r;this.gy=t;this.ua=v;this.Ib=b;this.nb=c;this.kf=u;this.$S=w;this.Exe=wac_PGc();this.hY=x;this.Lc=z;this.zc=y;this.pb=A;this.oua=B;this.Kke=D;this.zLd=G;if(v.nif&&F){var H=this;F.km("PowerPointEnterpriseDesigner",!1).then(function(a){H.JEf=a;return null})}}
function wac_Z$c(){try{return window.ChangeGate.ChangeGate.isChangeGateEnabled("Designer.RefreshDesignerPaneOnNewSlide")}catch(a){return wac_Y(594023707,829,100,"ShouldRefreshOnNewSlide Exception={0}",a),!1}}
wac_Q1b.prototype={Se:null,Urb:null,Np:null,d7a:null,WX:null,Ft:null,Ec:null,U:null,ra:null,Xb:null,Ea:null,Kz:null,ua:null,Ib:null,nb:null,Qg:null,gy:null,kf:null,$S:null,Exe:null,L0a:null,hY:null,Lc:null,zc:null,oua:null,pb:null,zLd:null,ELe:0,JEf:!1,H6b:null,Kke:null,V2e:null,Tb:function(){if(this.ua.Cka){this.U.jf(2503038014,1,this.hrd,4);this.U.jf(2034521264,1,this.SKf,4);this.U.jf(1960712364,1,this.cod,96);this.U.jf(1894291367,1,this.hrd,4);this.U.jf(397517337,1,this.Ybc,4);this.U.jf(1234776651,
1,this.Ybc,4);this.U.ja(2687326703,1,this.Uua);this.U.ja(1396913978,1,this.Uua);this.U.ja(2958572984,1,this.Uua);this.U.ja(3353734008,1,this.Uua);this.U.ja(1860084563,1,this.Uua);this.U.ja(3876507503,1,this.Uua);this.U.ja(1560908614,1,this.Uua);this.U.ja(446576891,1,this.Uua);this.U.ja(477300127,1,this.Uua);this.U.ja(131484319,1,this.Uua);this.U.ja(114500700,1,this.Uua);this.U.ja(2009705478,1,this.Uua);this.U.ja(407161026,1,this.Uua);this.U.ja(3690280729,1,this.Uua);this.U.jf(2658220272,1,this.tpd,
64);this.U.ja(1170549389,1,this.zZe);this.U.ja(3180693624,1,this.osf);this.U.ja(39851908,1,this.osf);wac__Nc(this.Kz,this.r8c);this.ua.ayc&&this.Qg.la.xa("RS",this.xJf);this.ua.fcf&&this.Qg.la.xa("RTS",this.Vfc);this.ua.tcf?wac_TY(this.$S,this.iba):this.gy.la.xa("CSC",this.p8c);this.ua.Go&&this.Kz.la.xa("SSC",this.q8c);this.ua.NAe&&wac_JSb(this.hY,this.lJa);this.Kz.la.xa("FOGTD",this.Fec);this.oua.Psa.xa("MU",this.Wee);wac_XF(this.zc,this.Eo);if(this.ua.zy&&this.Kke){var a=this;this.Kke.uc(function(b){wac__Qc(b,
a.Bse)})}this.ua.s_d&&this.ua.D6a?this.Ea.Yj?this.Ea.Yj.Msc&&1===this.Ea.Yj.Msc.length?this.Ea.Yj.p7a&&1===this.Ea.Yj.p7a.length?"62f939b6-93af-4db8-9c6b-d6c7dfdc589f"!==this.Ea.Yj.p7a[0].ThemeFamilyId?wac_Y(42300445,829,50,"Not Triggering NewDocument designer request, themeFamilyId is invalid"):(wac_Y(41705686,829,50,"Triggering NewDocument designer request"),wac_QGc(this,"NewDocument",null)):wac_Y(42300443,829,15,"Triggering NewDocument designer request failed, Presentation.MainMasters is invalid"):
wac_Y(42300441,829,15,"Triggering NewDocument designer request failed, Presentation.slideNodes invalid"):wac_Y(42300439,829,15,"Triggering NewDocument designer request failed, Presentation is null"):wac_Y(42766598,829,50,"Not Triggering NewDocument designer request, DesignerNewDocumentTriggerEnabled:{0}, IsCreateNew:{1}",this.ua.s_d,this.ua.D6a)}},Lf:function(){var a=this.ra.xc("EditingDesignerPanelFocus");a.Ba(wac_A(38,0),2687326703);a.Ba(wac_A(33,0),2687326703);a.Ba(wac_A(36,0),1396913978);a.Ba(wac_A(9,
4),2958572984);a.Ba(wac_A(40,0),3353734008);a.Ba(wac_A(34,0),3353734008);a.Ba(wac_A(35,0),1860084563);a.Ba(wac_A(9,0),3876507503);this.ua.zy&&(a=this.ra.xc("EditingIdeasPaneFocus"),a.Ba(wac_A(38,0),1560908614),a.Ba(wac_A(33,0),1560908614),a.Ba(wac_A(36,0),446576891),a.Ba(wac_A(9,4),477300127),a.Ba(wac_A(40,0),131484319),a.Ba(wac_A(34,0),131484319),a.Ba(wac_A(35,0),114500700),a.Ba(wac_A(9,0),2009705478),a.Ba(wac_A(37,0),407161026),a.Ba(wac_A(39,0),3690280729))},b2d:function(a,b,c,d,e){return this.ANe(this.Np,
this.d7a,"EditingDesignerPanelFocus",c,a,e)},jVf:function(a,b,c,d,e){return e||!this.Urb.If()?this.ANe(this.d7a,this.Np,"EditingIdeasPaneFocus",c,a,e):0},ANe:function(a,b,c,d,e,f){var g=this.Ea.Yj,g=!!this.Ea.Ja()&&!!g&&!this.Ib.Ac(g);if(this.ua.Go)var h=this.Xb.pe,g=!!(g&(!!h&&1===h.length));if(!g)return 16;if(!this.Ft.yx())return 8;if(1===d)return 32;f||wac_iN(this.ra,c,a.Se.If());b.Se.If()?a.Se.If()?a.Se.tr(!1,"CloseSecondPane"):(b=this.Ec.oqa()?this.Ec.oqa().SlideSuggestions.length:0,a.Se.tr(!0,
null),a===this.Np&&this.Ec.oqa()&&!wac_km(this.Ec.oqa().SlideSuggestions)?(wac_47(a,3),wac__$c(this.WX,this.Ec.oqa(),b,b,this.Ec.Nd,wac_Z1b(a),!0,a.I3e())):a!==this.d7a||wac_km(this.Ec.kud)?wac_47(a,2):(wac_47(a,3),wac__$c(this.WX,this.Ec.oqa(),b,this.Ec.kud.length,this.Ec.Nd,wac_Z1b(a),!0,a.I3e()))):1894291367===e?wac_QGc(this,"ToolbarButtonHome",null):a.Se.If()?a.Se.tr(!1,"SuggestionPaneClosed"):(wac_QGc(this,2034521264===e?"ToolbarButtonHome":"ToolbarButton",null),a.Se.tr(!0,null));return 32},
AYd:function(a,b,c,d,e){if(!wac_o0.isInstanceOfType(e)||!this.Ft.yx())return 8;wac_E(e,this.Se.If());return 32},jxd:function(a,b,c,d,e){b=this.Ea.Yj;if(!this.Ea.Ja()||!b||this.Ib.Ac(b))return 16;d=null;var f=!0;wac_Ga.isInstanceOfType(e)?d=e:wac_fkc.isInstanceOfType(e)&&(d=e.cvd,f=!1);if(!this.Ft.yx()||!d)return 8;if(wac_0$c(this.Ft))return wac_Y(24514636,829,50,"DesignerActor::ApplyDesignerSuggestion - skipped when client refresh. CorrelationId: {0}, ActionId: {1}",d.CorrelationId,a),8;if(1===c)return 32;
if(!wac_IJ(this.Xb)){if(1===wac_5M(this.Xb).length&&wac_5M(this.Xb)[0].gm)return wac_GL(this.Xb),wac_Y(36845449,829,15,"DesignerActor::ApplyDesignerSuggestion - skipped when there are picture in crop mode. CorrelationId: {0}, ActionId: {1}",d.CorrelationId,a),8;wac_GL(this.Xb)}if(this.Ec.hva===d.SuggestionSid)return wac_Y(38580375,829,50,"DesignerActor::ApplyDesignerSuggestion - suggestion already applied, skipping. CorrelationId: {0}, SuggestionSid: {1}",d.CorrelationId,d.SuggestionSid),2;c=this.nb.je(15,
0);try{this.ua.NAe&&(this.Ec.Rxe=new Date),c.lb(b),c.jr(a),wac_wN(b,wac__ua,d),this.Ec.hva=d.SuggestionSid,this.Ec.Dbc(!0),wac_Y(22590804,829,50,"DesignerActor::ApplyDesignerSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",d.CorrelationId,a,d.SuggestionSid)}finally{c&&c.dispose()}this.ua.Vxe?this.Ib.cxa(b,this.Ea.Ja(),this.Lc.Cb(),a):this.Ib.Ns(b,a);this.Se.If()?this.ra.ff("EditingDesignerPanelFocus",!1):this.Urb.If()&&this.ra.ff("EditingIdeasPaneFocus",!1);f&&this.Ec.Cie();return 32},
xMd:function(a,b,c){b=this.Ea.Yj;if(!this.Ea.Ja()||!b||this.Ib.Ac(b))return 16;if(!this.Ft.yx())return 8;if(1===c)return 32;c=this.Ft;a:switch(a){case 3353734008:case 1860084563:case 3876507503:case 2687326703:case 1396913978:case 2958572984:c=c.Np;break;case 131484319:case 114500700:case 2009705478:case 1560908614:case 446576891:case 477300127:case 407161026:case 3690280729:c=c.d7a;break;default:c=null;break a}if(c)switch(b=c.Se,wac_Y(22590808,829,50,"DesignerManager::HandleSuggestionItemNavigation - ActionId: {0} in ViewState: {1}",
a,wac_Z.p$a.toString(b.bA)),b.bA){case 3:if(c&&c.Se&&(b=document.activeElement)){var d=b.getAttribute("suggestionIndex"),e=Sys.UI.DomElement.containsCssClass(b,"DesignerPaneCloseButton")||Sys.UI.DomElement.containsCssClass(b,"IdeasText"),f=wac_1$c(b)||b.className.startsWith("Editor");if(d||e||f)if(d=d?window.parseInt(d.toString()):-1,e=wac_T1b(c)-1,!(1>e))switch(f=c.Se,a){case 3353734008:case 131484319:wac_27(f,!1);d<e&&(c.gs(d,!1),c.gs(d+1,!0));break;case 1860084563:case 114500700:wac_27(f,!1);d!==
e&&(c.gs(d,!1),c.gs(e,!0));break;case 3876507503:case 2009705478:a=c.Se;-1===d?a.m6e()?a.dZc?(wac_27(a,!1),a.Glf()):c.gs(0,!0):(wac_27(a,!1),c.gs(0,!0)):d===e?(c.gs(d,!1),wac_27(a,!0)):(c.gs(d,!1),c.gs(d+1,!0));break;case 2687326703:case 1560908614:wac_27(f,!1);0<d&&(c.gs(d,!1),c.gs(d-1,!0));break;case 1396913978:case 446576891:wac_27(f,!1);d&&(c.gs(d,!1),c.gs(0,!0));break;case 2958572984:case 477300127:a=c.Se;0<d?(c.gs(d,!1),c.gs(d-1,!0)):-1===d?a.dZc?(wac_27(a,!1),c.gs(e,!0)):a.m6e()&&wac_27(a,
!0):(c.gs(0,!1),a.m6e()?a.Glf():wac_27(a,!0));break;case 407161026:case 3690280729:if(wac_2$c.isInstanceOfType(c))if(a=3690280729===a,c=c.Se,wac_1$c(b)){if(b=document.activeElement)Sys.UI.DomElement.containsCssClass(b,"mivOverlayContainer")?(b=window.parseInt(b.getAttribute("mivIdx").toString())+1,a?6!==b?wac_3$c(c,b+1):wac_3$c(c,1):1!==b?wac_3$c(c,b-1):wac_3$c(c,6)):a?wac_3$c(c,1):wac_3$c(c,6)}else if(b.className.startsWith("Editor")&&(f=document.activeElement)){b=wac_2$c.gOf;for(d=0;!Sys.UI.DomElement.containsCssClass(f,
b[d]);)if(d++,d===b.length){d=-1;break}e=document.querySelectorAll(".EditorSuggestionContainer").length;"EditorSuggestionContainer"!==b[d]?a?d!==b.length-1&&-1!==d?"EditorSuggestionContainer"!==b[d+1]?wac_4$c(b[d+1],c):wac_5$c(c,0):wac_4$c(b[0],c):d&&-1!==d?"EditorSuggestionContainer"!==b[d-1]?wac_4$c(b[d-1],c):wac_5$c(c,e-1):wac_4$c(b[b.length-1],c):(f=window.parseInt(f.getAttribute("editorSuggestionIdx").toString()),a?f!==e-1?wac_5$c(c,f+1):wac_4$c(b[d+1],c):f?wac_5$c(c,f-1):wac_4$c(b[d-1],c))}}}break;
case 2:c&&(b=c.Se,3876507503===a||2958572984===a)&&(a=!!c.BS.querySelector(".DesignerNoSuggestionView-Link:focus"),wac_27(b,a),c=c.BS.querySelector(".DesignerNoSuggestionView-Link"),a?c.blur():c.focus())}return 32},Beb:function(a,b,c,d,e){if("IdeasPaneClosed"===e.ztb&&this.Se.If()||wac_6$c(this.Ft))return 0;wac_RGc(this,e.Y0c,e.ztb);return 32},SSf:function(a,b){b.yjf.or(this.Ec.wVd);wac_7$c(this,b.yjf,b.rif,b.Ls,b.fM,b.Nd,-1);b.huf&&(this.V2e||this.Ec.$1c.Ma()||wac_8$c(this,b.fM,b.rif))},YSd:function(a,
b){!b.nBb||"PptRibbon.Design"!==b.nBb&&"Design"!==b.nBb||this.Np.Se.If()||this.d7a.Se.If()||32!==this.U.yw(2503038014,1,null)||wac_QGc(this,"DesignTab",null)},Dda:function(a,b){(a=this.Ea.Ja())&&b.mg.Ka(wac_kJ(a))&&(this.Ft.Pfb(b.Stb,b.J9b),wac_6$c(this.Ft)&&!this.Ft.yx()&&(wac_Y(22680479,829,50,"DesignerActor::OnSlidePresenceChanged - More than two users in same slide and close opened designer pane. In the slide user count:{0}, presentation user count:{1}, CorrelationId:{2}",b.Stb,b.J9b,this.Ec.Nd),
this.Se.tr(!1,"CoAuth"),this.Urb.tr(!1,"CoAuth")),this.ua.zy&&wac_5nc(this.Ec)&&(this.ua.y8e||0<this.Ft.Y_a?this.Ft.yx()||wac_9$c(this.Ft,this.Ec.Nd,"NoResult",null,""):wac_QGc(this,"Refresh",null)))},MBd:function(a,b){if(b.Epc){var c;a=(c=new wac_VY,c.Ls=wac_kJ(b.Epc),c);this.U.Wj(4236240734,2,a,null);this.Ft.Pfb(a.h8a,a.Irc);if(wac_6$c(this.Ft)||wac_5nc(this.Ec))wac_Y(22853506,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - Slide changed when Designer pane is opened. CorrelationId:{0}",
this.Ec.Nd),this.Ft.yx()&&this.ua.Akc&&!wac_jJ(b.Epc)?wac_QGc(this,"SlideNavigationDesignMode",null):wac_Z$c()?wac_jJ(b.Epc)&&this.ua.vme||(this.Se.tr(!1,"SlideNavigation"),this.Urb.tr(!1,"SlideNavigation"),this.ua.zy&&wac_9$c(this.Ft,this.Ec.Nd,"NoResult",null,"")):wac_jJ(b.Epc)&&this.ua.vme&&(this.Urb.If()||wac_5nc(this.Ec))||(this.Se.tr(!1,"SlideNavigation"),this.Urb.tr(!1,"SlideNavigation"),this.ua.zy&&wac_9$c(this.Ft,this.Ec.Nd,"NoResult",null,""))}else wac_Y(24463122,829,50,"DesignerActor::DesignerTargetSlideChangedHandler - active slide was null. CorrelationId:{0}",
this.Ec.Nd)},KBd:function(){this.Ft.yx()||(this.Se.If()&&this.Se.tr(!1,"CoAuthDisabled"),this.Urb.If()&&this.Urb.tr(!1,"CoAuthDisabled"))},TUd:function(a,b){wac_UGc(this,b);wac_Y(36966411,829,15,"DesignerActor::OnTaskFailure - request failed with response: {0}. returning true to prevent ACE",a.HttpStatusCode);return!0},LBd:function(){if(wac_6$c(this.Ft)){var a=this.Xb.pe;a&&1<a.length&&(wac_Y(25968672,829,50,"DesignerActor::DesignerSlidesSelectionChangedHandler - More than one slides are selected, close the opened designer pane."),
this.Se.If()&&this.Se.tr(!1,"MultiSlidesSelected"),this.Urb.If()&&this.Urb.tr(!1,"MultiSlidesSelected"))}},oQa:function(a,b){a=this.Ec.Rxe;var c=this.ua.Vxe?"UnblockContentWhenDraw":"SessionRehydrated";a&&window.$$as(String,b.hme)===c&&(this.Ec.t9d.ga(String.format("{0}:{1}:{2}",this.Ec.hva,a-this.Ec.Qtd,new Date-a)),this.Ec.Rxe=null)},ju:function(){wac_Y(40379151,829,50,"DesignerManager::OnSessionRehydrated - refreshing due to failover");wac_QGc(this,"Refresh",{FailoverOccurred:!0})},KPd:function(a,
b){wac_VGc(this,b.Ii,b.uDb.Dea)},rCe:function(a,b){if(b.MKa&&wac_mwc(b.Ii)){a={};if(b.R4){var c;c=wac_mE(b.R4.toString()).toString();(c=wac_1uc(wac_sE,"RevisionId",c))&&1===c.length&&(a.ActionStartTime=c[0].py)}wac_VGc(this,b.Ii,a)}},kPf:function(a,b,c,d,e){switch(a){case 3180693624:return Array.add(this.Ec.xSd,e),32;case 39851908:return Array.remove(this.Ec.xSd,e),32;default:return 2}},o1e:function(){wac_QGc(this,"Refresh",{UndoRedo:!0});return 32},mve:function(a,b){a=this.Ec;var c=b.roe;if(c){b=
[];for(var d=new (wac_e.$$(Number,wac_$$c)),c=c.critiques,e=c.length,f=0;f<e;++f){var g=c[f],h=g.bucketId,k=d.K(h);k||(k=new wac_$$c(h),d.vf(h,k),b.push(k));k.B1e.push(g)}a.vcc=b}}};
function wac_aad(a,b,c,d){if(a.ua.Vtf&&a.zLd){wac__Gc(a,c);d||(d={});var e=new Date;a.zLd.b4e(a.ua.svf,a.ua.Ytf).then(function(f){var g=new Date-e;f.IsSuccess?(d.FetchAuthTokenDuration=g,d.ServiceTicket=f.Token):(d.FetchAuthTokenFailureDuration=g,wac_Y(42324814,829,15,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth Failed to get AAD token with error: "+f.ErrorCode+": "+f.ErrorMessage));wac_WGc(a,b,c,d)}).catch(function(f){wac_Y(42295842,829,10,"DesignerActor::ExecuteDesignerRequestProcessingWithAuth - Token retrival failed:{0}",
f);d.FetchAuthTokenFailureDuration=new Date-e;wac_WGc(a,b,c,d)})}else wac_WGc(a,b,c,d)}
function wac_WGc(a,b,c,d){a.H6b&&(a.pb.Rg(a.H6b),a.H6b=null);var e=wac_XGc(a,c,d);wac_YGc(a,e)?wac_ZGc(a.Ec,a.Ea.Ja().Vc())?(wac__Gc(a,e.Eea),wac_0Gc(a,function(){wac_aad(a,b,c,d)})):(wac_Y(40379161,829,50,"trigger: {0}; sid: {1}; correlationId: {2}",e.Eea,e.LCe,e.ncc),a.Ec.Nd&&!Array.contains(a.Ec.QFa,a.Ec.Nd)&&wac_RGc(a,wac_6$c(a.Ft),e.Eea),a.Ec.hud=new Date,a.Ec.o9d(e.ncc),a.Ec.HAe=e.Eea,wac_1Gc(a,e)?wac_bad(a.Ec,e.PGe.ActionStartTime):wac_bad(a.Ec,new Date),b(e),wac__Gc(a,e.Eea),wac_9$c(a.Ft,
e.ncc,"Pending",null,"")):(wac_Y(40379163,829,50,"Designer call not currently allowed for trigger {0}",c),a.Se.tr(!1,"DisallowedRequest"),a.Urb.tr(!1,"DisallowedRequest"))}function wac__Gc(a,b){var c="Typing"===b?4:1;("ToolbarButton"===b||"DesignTab"===b||a.Se.If())&&wac_47(a.Np,c);("ToolbarButtonHome"===b||a.Urb.If())&&wac_47(a.d7a,c)}
function wac_1Gc(a,b){if(!(a.ua.nOe&&"ActionStartTime"in b.PGe&&b.PGe.ActionStartTime))return!1;switch(b.Eea){case "ToolbarButton":case "ToolbarButtonHome":case "SlideNavigationDesignMode":case "NewDocument":return!1;case "Refresh":return!("FailoverOccurred"in b.PGe)||!("UndoRedo"in b.PGe);default:return!0}}
function wac_cad(a,b){if("FailoverOccurred"in b&&b.FailoverOccurred||"UndoRedo"in b&&b.UndoRedo)return!0;if(a.ua.jwd){if(a.ua.gcf&&wac_6$c(a.Ft))return!0}else if(a.ua.wme&&(wac_5nc(a.Ec)||a.Urb.If())||a.ua.gcf&&wac_6$c(a.Ft))return!0;return!1}
function wac_YGc(a,b){var c;if(!(c=!b||!b.LCe)){a:switch(b.Eea){case "ToolbarButton":case "ToolbarButtonHome":case "InsertPicture":case "InsertChart":case "SlideChangeLayout":case "ChangeSlideSize":case "ApplyTheme":case "PasteTable":case "NewDocument":case "ApplyReplaceObject":case "DesignTab":c=!0;break a;default:c=!1}c=!c&&!wac_6$c(a.Ft)&&!wac_5nc(a.Ec)}if(c)return!1;if(a.ua.jwd)switch(b.Eea){case "NewSlide":case "ToolbarButton":case "ToolbarButtonHome":case "InsertPicture":case "ApplyTheme":case "DesignTab":return!0;
case "InsertChart":return a.ua.ddf;case "Typing":return a.ua.Y5a&&wac_dad(a,!1);case "SlideNavigationDesignMode":return a.ua.Akc;case "SlideChangeLayout":return a.ua.wkc;case "Retrigger":return a.ua.zkc&&a.Ec.YT;case "ChangeSlideSize":case "DesignElementsDeleted":return a.ua.xkc;case "InsertTable":return a.ua.aFe;case "PasteTable":return a.ua.LAe||a.ua.KAe;case "ApplyReplaceObject":case "ChangeIconInSmartArt":case "ChangeIcon":return a.ua.qUe;case "Refresh":return wac_cad(a,b.PGe);case "NewDocument":return a.ua.s_d&&
a.ua.D6a;default:return wac_Y(594399636,829,15,"invalid trigger: {0}",b.Eea),!1}else switch(b.Eea){case "ToolbarButton":case "InsertPicture":case "ApplyTheme":case "DesignTab":return!0;case "InsertChart":return a.ua.ddf;case "Typing":return a.ua.Y5a&&wac_dad(a,!1);case "SlideNavigationDesignMode":return a.ua.Akc;case "SlideChangeLayout":return a.ua.wkc;case "Retrigger":return a.ua.zkc&&a.Ec.YT;case "ChangeSlideSize":case "DesignElementsDeleted":return a.ua.xkc;case "ToolbarButtonHome":return a.ua.zy&&
(!Array.contains(a.Ec.QFa,a.Ec.Nd)||!a.Ec.Nd);case "InsertTable":return a.ua.aFe;case "PasteTable":return a.ua.LAe||a.ua.KAe;case "NewSlide":return wac_Z$c()?a.ua.vme:a.ua.vme&&(wac_5nc(a.Ec)||a.Urb.If());case "ApplyReplaceObject":case "ChangeIconInSmartArt":case "ChangeIcon":return a.ua.qUe;case "Refresh":return wac_cad(a,b.PGe);case "NewDocument":return a.ua.s_d&&a.ua.D6a;default:return wac_Y(40379159,829,15,"invalid trigger: {0}",b.Eea),!1}}
function wac_XGc(a,b,c){var d=a.Ea.Ja();if(!d)return null;var e;e=new wac_2Gc;e.Eea=b;e.LCe=d.Vc();e.GGe=d.fe();c=c||{};a.ua.s_d&&"NewDocument"===b&&(c.EnableFullSizeSuggestedPictures="true");a.ua.Ztf&&(c.SupportCustomTheme=a.ua.nif?a.JEf:!0);a.ua.ayc&&(c.IncrementalRender=!0);a.ua.y8e&&(c.DesignerSameSlideIdleCoauthEnabled=!0,0<a.Ft.Y_a&&(c.CoauthCountInSlide=a.Ft.Y_a));if(a.ua.zy&&(c.NewPaneEnabled=!0,b=!wac_km(a.Ec.vcc),c.RequestForEditorCardsForNewIdeasPane=b)){b=0;for(var d=a.Ec.vcc,f=d.length,
g=0;g<f;++g)for(var h=d[g].B1e,k=h.length,l=0;l<k;++l)b+=h[l].suggestions.length;c.NumEditorCritiques=b}a.ua.fcf&&(c.DesignerDesignTabTriggerEnabled=!0);b={};b.SupportsImageToTableSuggestedAction=a.ua.Lvf;c.PPTOEnabledSuggestedActions=JSON.stringify(b);return e.PGe=c,e}
function wac_0Gc(a,b){a.ELe<a.ua.YSe?a.pb.Hb(new wac_D(2,1,1E3,function(){wac_Y(40379155,829,50,"retry request due to waiting on pending edits. prior correlation: {0}",a.Ec.Nd);a.Exe=wac_PGc();a.ELe++;b()},0,"RetryRequestOnWait",!1)):wac_Y(40379157,829,50,"retries for request awaiting prior edits exceeded. skipping request. correlation: {0}",a.Ec.Nd)}
function wac_QGc(a,b,c){"ToolbarButtonHome"===b&&a.Ec.Nd&&!Array.contains(a.Ec.QFa,a.Ec.Nd)||wac_aad(a,function(c){function e(){wac_QGc(a,a.L0a.Eea,a.L0a.SUe)}if(a.ua.MAe){if(a.Exe.bEe&&new Date-a.Exe.k_c<a.ua.bFe){a.L0a=new wac_SGc;a.L0a.LCe=c.LCe;a.L0a.GGe=c.GGe;a.L0a.Eea=c.Eea;a.L0a.SUe=c.PGe;wac_Y(40379153,829,50,"prior request in progress, marking current request as next pending. next trigger: {0}; next sid: {1}",b,c.LCe);return}a.Exe=wac_TGc();a.L0a=null}a.kf.HG(c.GGe,c.LCe,c.ncc,c.Eea,null,
JSON.stringify(c.PGe),function(b){b&&2===b.Status?wac_0Gc(a,function(){wac_QGc(a,c.Eea,c.PGe)}):a.ELe=0;a.ELe||wac_UGc(a,e)},function(b){return a.TUd(b,e)})},b,c)}
function wac_VGc(a,b,c){var d;a:switch(b){case 397517337:case 1234776651:case 3353734008:case 1860084563:case 3876507503:case 2687326703:case 1396913978:case 2958572984:case 131484319:case 114500700:case 2009705478:case 1560908614:case 446576891:case 477300127:case 407161026:case 3690280729:case 3078715862:d=!0;break a;case 123670621:case 4177849452:case 2665249088:case 3019226676:case 3270113035:case 2814941514:case 3409991090:case 565697619:d=!a.Ec.YT;break a;default:d=!1}if(!d){var e=function(b){var c=
{};c.Timestamp=b.SEc;c.CorrelationId=b.ncc;c.Trigger=b.Eea;c.Sid=b.LCe;c.Cid=b.GGe;c.Hints=b.PGe;b=wac_kO(a.nb,4,null,null,!1);try{b.lb(a.Ea.Yj);b.jr(3078715862);var d=JSON.stringify(c);wac_v(a.Ea.Yj,wac_9Db,d)}finally{b&&b.dispose()}},f=wac_3Gc(a,b,c);if(d=wac_4Gc(a,f,b,c))c||(c={}),c.ElementSource=d;if(wac_mwc(b)&&wac_dad(a,!0)){a.H6b&&a.pb.Rg(a.H6b);(wac_5nc(a.Ec)||a.Urb.If())&&wac_9$c(a.Ft,a.Ec.Nd,"Pending",null,"");var g=a.Se.If();!a.ua.oif&&g&&a.Se.tr(!1,"DisallowedRequest");wac_dad(a,!1)&&
wac__Gc(a,"Typing");a.H6b=new wac_D(2,1,a.ua.pyb,function(){g&&wac_Y(42320064,829,50,"Potential candidate for typing refresh request for designer pane");a.Ea.Ja()&&wac_dad(a,!1)&&wac_aad(a,e,f,c)},0,"DesignerTypingRefreshTask",!1);a.pb.Hb(a.H6b)}else wac_aad(a,e,f,c)}}
function wac_3Gc(a,b,c){switch(b){case 1110240549:case 1685987254:case 2948423841:case 1124275563:case 934858027:return"InsertPicture";case 2995632670:case 1850078116:case 3796917740:return c&&c.HasNewPicture||c&&c.HasNewMedia&&a.ua.Rxf?"InsertPicture":c&&c.HasNewTable?"PasteTable":c&&c.HasNewChart&&a.ua.ddf?"InsertChart":"";case 2963456035:case 2759977169:case 841042441:return"ApplyTheme";case 4017322732:return"SlideChangeLayout";case 529839080:case 100917881:case 1045213174:case 991302939:case 410316994:return c&&
"HasDesignElements"in c&&c.HasDesignElements?"ChangeSlideSize":"Refresh";case 868006456:case 4198410725:return c&&"HasDesignElements"in c&&c.HasDesignElements?"DesignElementsDeleted":"Refresh";case 123670621:case 4177849452:case 2665249088:case 3019226676:case 3270113035:case 2814941514:case 3409991090:case 565697619:return"Retrigger";case 2423756553:case 1296122996:case 1800138055:case 910012865:case 1991549851:case 3300418813:case 4089132864:case 134426873:case 1534685076:case 2219070986:case 1974018626:case 249647848:case 2677509403:case 4262591775:case 506982572:case 2887293604:case 1854371976:case 1460660268:case 3398225082:case 110395433:return"Typing";
case 844437181:return"PasteTable";case 67272282:return"InsertTable";case 3455582195:case 4229337931:case 830497217:case 3006547192:return"NewSlide";case 4041021629:return"ApplyReplaceObject";case 1095764407:return"ChangeIconInSmartArt";case 1488343741:return"ChangeIcon";default:return"Refresh"}}
function wac_4Gc(a,b,c,d){if("InsertPicture"!==b&&"PasteTable"!==b&&"InsertChart"!==b)return null;var e=d?d.HasNewPicture:!1,f=d?d.HasNewMedia:!1,g=d?d.HasNewTable:!1,h=d?d.HasNewChart:!1,k=null;switch(c){case 1850078116:case 3796917740:k=e?"PastedExternalPicture":f?"PastedExternalMedia":g?"PastedExternalTable":h?"PastedExternalChart":null;break;case 2995632670:k=e?"PastedInternalPicture":f?"PastedInternalMedia":g?"PastedInternalTable":h?"PastedInternalChart":null;break;case 1110240549:k="FromFile";
break;case 1685987254:case 2948423841:k="Online";break;case 934858027:k="Icon"}k||wac_Y(41182167,829,50,"DesignerActor::MapActionIdToElementSource - Unexpected NULL ElementSource. Trigger: {0}, ActionId: {1}, CorrelationId: {2}",b,c,a.Ec.Nd);delete d.HasNewPicture;delete d.HasNewMedia;delete d.HasNewTable;delete d.HasNewChart;return k}
function wac_UGc(a,b){a.ua.MAe&&(a.Exe=wac_PGc(),a.L0a&&(wac_6$c(a.Ft)||wac_5nc(a.Ec)?(wac_Y(39413843,829,50,"DesignerActor::OnTaskComplete - sending pending request for triger {0}, sid: {1}",a.L0a.Eea,a.L0a.LCe),b()):a.L0a=null))}function wac_ead(a){a.V2e&&(a.pb.Rg(a.V2e),a.V2e=null)}
function wac_fad(a,b,c,d){var e={};e.MissingDesignerCardIndexes=a.Ec.$1c.xe().join(",");a.V2e=new wac_D(0,1,0,function(){a.kf.HG(b.fe(),b.Vc(),d,c,null,JSON.stringify(e),function(){wac_Y(42259678,829,50,"DesignerActor::TryFetchMissingDesignerCardsAsync - request successfully sent for fetch missing Designer indexes {0} for correlationId: {1}",e.MissingDesignerCardIndexes,d)},function(a){wac_Y(42259680,829,15,"DesignerViewHelper:FetchMissingDesignerCardsAsync - request failed for fetch missing Designer indexes {0} with response: {1}. returning true to prevent ACE",
e.MissingDesignerCardIndexes,a.HttpStatusCode);return!0})},0,"FetchMissingDesignerCardsTask",!1);a.pb.Hb(a.V2e)}function wac_7$c(a,b,c,d,e,f,g){if(a.Ec.wVd.Ma()===c)wac_ead(a);else if(b&&b.Ma()&&!(0<a.Ec.$1c.Ma())){if(-1===g)for(var h=b.$$lge();h.$$mn();){var k=h.$$cu();k>g&&(g=k)}for(h=0;h<c&&(b.Ge(h)||a.Ec.$1c.Ge(h)||a.Ec.$1c.ga(h),h!==g||a.Ec.$1c.Ma());h++);0<a.Ec.$1c.Ma()&&wac_fad(a,d,e,f)}}
function wac_8$c(a,b,c){wac_ead(a);var d=wac_kJ(a.Ea.Ja()),e=a.Ec.Nd;a.V2e=new wac_D(2,1,a.ua.mxf,function(){Array.contains(a.Ec.QFa,e)||wac_7$c(a,a.Ec.wVd,c,d,b,e,c)},0,"CheckAndFetchMissingDesignerCardsTask",!1);a.pb.Hb(a.V2e)}function wac_gad(a,b){a.ua.zy&&(b.IdeasMivShown=a.Ec.Ccf,b.IdeasMivDrillIn=a.Ec.Sif,b.IdeasEditorShown=a.Ec.kcf,b.IdeasEditorKept=a.Ec.jcf,b.IdeasEditorDrillIn=a.Ec.buf,b.AnyCardShown=a.Ec.kcf||a.Ec.Ccf||0<a.Ec.SLe.Ma(),b.AnyCardKept=a.Ec.jcf||a.Ec.YT)}
function wac_RGc(a,b,c){if(!Array.contains(a.Ec.QFa,a.Ec.Nd)){var d=wac_0$c(a.Ft)?a.Ec.PCb:a.Ec.Nd,e={};e.CachedTrigger=a.Ec.HAe;e.SuggestionSlideId=a.Ec.hva.toString();e.AppliedSuggestion=a.Ec.YT;e.DisplaySuggestionsTimeoutInMs=15E3;e.SuggestionsTimeout=a.Ec.JAb;e.ClientAbort=a.Ec.tzb||wac_had(a.Ft);e.DesignerPaneClosed=b;e.ResetReason=c;e.HoverPreviewDesignerTriggered=a.Ec.fhe;e.DesignerRefreshEnabledForEditing=a.ua.gcf;b=wac_Hd(wac_.pa.Qb.SessionStartInfoJson.toString());var f={};f.ClientOS=b.Os;
f.Browser=b.Browser||"";f.BrowserVersion=b.BrowserVersion||"";f.BrowserMajorVersion=b.BrowserMajorVersion||"";f.BrowserMinorVersion=b.BrowserMinorVersion||"";a.Ec.hud&&a.Ec.Qtd&&a.Ec.Qtd>a.Ec.hud&&(f.SuggestionsE2ETimeMs=a.Ec.Qtd-a.Ec.hud);a.ua.ayc&&(wac_iad(a.WX),wac_ead(a),e.IncrementalRender=!0,f.VisibleSuggestionsCount=a.Ec.B5e,0<a.Ec.F8e.Ma()&&(f.IncrementalRenderTimeoutIndexes=a.Ec.F8e.xe().join(",")),0<a.Ec.$1c.Ma()&&(f.MissingDesignerCardIndexes=a.Ec.$1c.xe().join(",")),0<a.Ec.SLe.Ma()&&(f.CardIndexes=
a.Ec.SLe.xe().join(",")),0<a.Ec.wVd.Ma()&&(f.DesignerCardIndexes=a.Ec.wVd.xe().join(",")),a.Ec.oVc&&(a.Ec.K8e&&a.Ec.K8e>a.Ec.oVc&&(f.MissingDesignerCardsReceivedTime=a.Ec.K8e-a.Ec.oVc),a.Ec.w8e&&a.Ec.w8e>a.Ec.oVc&&(f.AllIncRenderReceivedTime=a.Ec.w8e-a.Ec.oVc),a.Ec.P5e&&a.Ec.P5e>a.Ec.oVc&&(f.VisibleIncRenderReceivedTime=a.Ec.P5e-a.Ec.oVc)));f.DesignTabTriggerEnabled=a.ua.fcf;wac_gad(a,f);e.BrowserData=f;a.Ec.oVc&&a.Ec.Qtd&&a.Ec.Qtd>a.Ec.oVc&&(e.TimeToDisplaySuggestionsInMs=a.Ec.Qtd-a.Ec.oVc);a.Ec.oDb&&
a.Ec.v8a&&(e.TimeSuggestionsRendered=a.Ec.oDb.toUTCString());a.Ec.v8a&&(e.TimeDesignerPaneClosed=a.Ec.v8a.toUTCString());a.Ec.t9d&&0<a.Ec.t9d.Ma()&&(e.AppliedSuggestionHis=a.Ec.t9d.xe().join(" "));a.kf.Beb(d,JSON.stringify(e),null,function(){return!0});a.ua.zy&&wac_9$c(a.Ft,d,"SuggestionPaneClosed"===c||"SuggestionsLoadingTimeout"===c||"NoSuggestion"===c||"DisallowedRequest"===c?"NoResult":"Pending",null,"");wac_5Gc(a.Ec,d);wac_Y(22590806,829,50,"DesignerActor::ReportSuggestionSessionInfo - Send session info and add correlationId to closed list. resetReason: {0}; CorrelationId:{1}",
c,d)}}function wac_dad(a,b){return(a.ua.oif||b)&&a.Se.If()||wac_5nc(a.Ec)||a.Urb.If()}function wac_6Gc(){}function wac_TGc(){var a=new wac_6Gc;a.bEe=!0;a.k_c=new Date;return a}function wac_PGc(){var a=new wac_6Gc;a.bEe=!1;a.k_c=null;return a}wac_6Gc.prototype={bEe:!1,k_c:null};function wac_SGc(){}wac_SGc.prototype={LCe:0,GGe:0,Eea:null,SUe:null};function wac_2Gc(){this.SEc=new Date;this.ncc=wac_5k().toString()}wac_2Gc.prototype={SEc:null,ncc:null,Eea:null,LCe:0,GGe:0,PGe:null};
function wac_W1b(a){this.QFa=[];this.xSd=[];this.FWc=a;this.t9d=new (wac_g.$$(String));this.SLe=new (wac_g.$$(Number));this.wVd=new (wac_g.$$(Number));this.F8e=new (wac_g.$$(Number));this.$1c=new (wac_g.$$(Number));this.B5e=1}
wac_W1b.prototype={QFa:null,xSd:null,FWc:null,vcc:null,e0a:null,hva:0,Nd:null,o9d:function(a){return this.Nd=a},PCb:null,HAe:null,YT:!1,Dbc:function(a){return this.YT=a},JAb:!1,tzb:!1,oDb:null,v8a:null,Cie:function(){this.lRb(2,4)},lRb:function(a,b){this.FWc&&this.FWc.uc(function(c){var d,e=(d=new wac_jkc,d.cardId="EntityGroup.Designer.Slide.Suggestion",d.actionType=a,d.actionEngagement=b,d);c.Cfe(e)})},fhe:!1,hud:null,Qtd:null,K8e:null,t9d:null,Rxe:null,oVc:null,w8e:null,P5e:null,B5e:0,SLe:null,
wVd:null,F8e:null,$1c:null,RD:null,oqa:function(){return this.RD},v5e:function(a){return this.RD=a},kud:null,Gfc:0,kcf:!1,jcf:!1,buf:!1,Ccf:!1,Sif:!1};function wac_jad(a,b){a.Gfc=b}function wac_kad(a,b){a.kud=b}function wac_bad(a,b){a.oVc=b}function wac_ZGc(a,b){return Array.contains(a.xSd,b)}
function wac_5Gc(a,b){Array.contains(a.QFa,b)||(Array.add(a.QFa,b),wac_Y(22853508,829,50,"DesignerContext::AddCurrentSuggestionToClosedList - CorrelationId:{0}, ClosedSuggestionListLength:{1}",b,a.QFa.length));a.Nd="";a.hva=0;a.HAe="";a.YT=!1;a.JAb=!1;a.tzb=!1;a.v8a=null;a.fhe=!1;a.hud=null;a.Qtd=null;a.K8e=null;a.Rxe=null;a.t9d.ie();a.oVc=null;a.w8e=null;a.P5e=null;a.B5e=1;a.SLe.ie();a.wVd.ie();a.F8e.ie();a.$1c.ie();a.RD=null;a.kud=null;a.Gfc=0;a.kcf=a.jcf=a.Ccf=a.Sif=!1}
function wac_5nc(a){var b=!1;(a=a.FWc.Ga())&&(b=a.Q9d());return b}function wac_$$c(a){this.CNf=a;this.B1e=[]}wac_$$c.prototype={CNf:0,B1e:null};
function wac_X1b(a,b,c,d,e,f,g,h,k,l,m,n,p){this.ntf=Function.createDelegate(this,this.yTf);this.wkd=Function.createDelegate(this,this.bUd);this.Xfd=Function.createDelegate(this,this.IOd);this.Qgc=Function.createDelegate(this,this.FUd);this.Fqf=new (wac_ta.$$(String));this.dispose=this.O;this.d7a=a;this.Np=b;this.WX=c;this.Ec=d;this.ua=e;this.U=f;this.Ea=g;this.nb=h;this.Qg=k;this.ra=l;this.Y_a=this.X_a=0;this.Y2=m;this.mVc=n;this.c8e=p;this.JQ()}
wac_X1b.prototype={d7a:null,Np:null,WX:null,Ec:null,ua:null,U:null,Ea:null,nb:null,Qg:null,ra:null,Y2:null,mVc:null,X_a:0,Y_a:0,c8e:null,JQ:function(){this.Qg.la.xa("SU",this.Qgc);this.Qg.la.xa("DSCM",this.Xfd);var a=this;this.mVc.uc(function(b){b.Jwd(a.wkd,function(){var b=a.Np;b&&wac_47(b,3)})});this.ua.ayc&&this.Qg.la.xa("UBUP",this.ntf)},O:function(){this.Qg.la.sb("SU",this.Qgc);this.Qg.la.sb("DSCM",this.Xfd);this.ua.ayc&&this.Qg.la.sb("UBUP",this.ntf)},Iue:function(a,b){if(this.ua.Cka&&(this.Np.Se.If()||
this.d7a.Se.If()||wac_5nc(this.Ec))){if(b&&(397517337===a||1234776651===a)){this.Ec.hva=0;b=this.Ea.Yj;var c=wac_kO(this.nb,7,null,null,!0);try{c.lb(b),this.ua.$tf&&c.jr(a),wac_he(b,wac__ua)}finally{c&&c.dispose()}}wac_lad(this.WX,wac_Z1b(this.Np));wac_lad(this.WX,wac_Z1b(this.d7a));this.ua.ykc&&397517337!==a&&1234776651!==a&&this.U.yw(1170549389,2,null)}},yx:function(){return this.ua.Cka&&(this.ua.tcf||!(0<this.X_a))&&(this.ua.y8e||!(0<this.Y_a))},IOd:function(a,b){a=b.Ls;wac_Y(23089489,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Others is editing in slide sid: {0}",
a.Vc());if((b=this.Ea.Ja())&&wac_kJ(b).Ka(a)){b="unopened";wac_6$c(this)&&(this.ua.y8e?(this.Np.Se.If()&&(b=this.Np)&&wac_47(b,5),this.d7a.Se.If()&&(b=this.d7a)&&wac_47(b,5),b="set to SameSlideCoauthNoSuggestion UI"):(this.Np.Se.tr(!1,"CoAuth"),this.d7a.Se.tr(!1,"CoAuth"),b="force closed"));var c="unopened";this.ua.zy&&wac_5nc(this.Ec)&&(wac_9$c(this,this.Ec.Nd,"NoResult",null,""),c="closed");"unopened"===b&&"unopened"===c||wac_Y(23089491,829,50,"DesignerManager::OnCoauthModifiedSameSlide - Designer pane state: {0}. Designer card in Ideas pane state: {1}. Slide sid:{2}, cid:{3}, CorrelationId:{4}, CoauthCountInPresentation:{5} and CoauthCountInSlide:{6}.",
b,c,a.Vc(),a.fe(),this.Ec.Nd,this.X_a,this.Y_a)}},FUd:function(a,b){wac_Y(22647391,829,50,"DesignerManager::OnSuggestionsUpdated - IsDesignerEnabled:{0}, IsDesignerSameDeckCoauthEnabled:{1}, CoauthCountInPresentation:{2}, CoauthCountInSlide:{3}, correlationId:{4}; trigger: {5}",this.ua.Cka,this.ua.tcf,this.X_a,this.Y_a,b.Nd,b.fM);if(this.yx()){if(a=this.Ea.Ja())if(b.Ls.Ka(wac_kJ(a)))if(Array.contains(this.Ec.QFa,b.Nd))wac_Y(22618318,829,50,"DesignerManager::OnSuggestionsUpdated - CorrelationId is in closed suggestion list. CorrelationId:{0}",
b.Nd);else if(this.Fqf.Ge(b.Nd))wac_Y(41694935,829,50,"DesignerManager::OnSuggestionsUpdated - User began to upload picture during incremental rendering, so ignore further suggestions for this CorrelationId. CorrelationId:{0}",b.Nd);else{this.Ec.Nd!==b.Nd&&(wac_5Gc(this.Ec,b.Nd),wac_Y(42021664,829,50,"DesignerManager::OnSuggestionsUpdated - ignore result from different correlation. expected correlation: {0}; received correlation: {1}",this.Ec.Nd,b.Nd));if(this.Ec.Nd===b.Nd&&this.Np.Se.If()&&3===this.Np.Se.bA||
this.d7a.Se.If()&&3===this.d7a.Se.bA){var c=this;if(this.ua.ayc&&wac_QZa(b.R8e.xe(),function(a){return 0<=c.Ec.$1c.DJd(a)}))this.Ec.K8e=new Date,wac_Y(42342610,829,50,"DesignerManager::OnSuggestionsUpdated - Notification for missing Designer cards successfully received. CorrelationId: {0}, Received indexes: {1}, Missing indexes {2}",b.Nd,b.R8e.toString(),this.Ec.$1c.toString());else if(a=b.Cxf,!this.ua.ayc||this.Ec.wVd.Ge(a)){wac_Y(22618320,829,50,"DesignerManager::OnSuggestionsUpdated - Duplicated Designer card notification. CorrelationId: {0}, StartIdx: {1}",
b.Nd,a.toString());return}}if((a=wac_mad(b.OT))&&!this.Ec.oqa()){var d;this.Ec.v5e((d=new wac_Fua,d.CardData=a.CardData,d.SlideSuggestions=Array(b.yif?b.h_d:b.Gxf),d))}if(a&&!wac_km(a.SlideSuggestions)){d=a.SlideSuggestions;for(var e=d.length,f=0;f<e;++f){var g=d[f];this.Ec.oqa().SlideSuggestions[g.Index]=g}}a&&this.ua.zy&&!this.Ec.kud&&wac_kad(this.Ec,wac_nad(a));wac_oad(this,b);this.ua.jwd?wac_pad(this,this.d7a,b,a,b.h_d,wac_km(this.Ec.kud)?b.h_d:this.Ec.kud.length):(!this.Np.Se.If()&&this.d7a.Se.If()||
wac_pad(this,this.Np,b,a,b.h_d,b.h_d),this.d7a.Se.If()&&wac_pad(this,this.d7a,b,a,b.h_d,wac_km(this.Ec.kud)?b.h_d:this.Ec.kud.length))}else wac_Y(22618322,829,50,"DesignerManager::OnSuggestionsUpdated - current slide node is different to suggestion slide node. CorrelationId:{0}",b.Nd)}else wac_Y(22618316,829,50,"DesignerManager::OnSuggestionsUpdated - Designer is not enabled. CorrelationId:{0}",b.Nd)},Pfb:function(a,b){this.Y_a=a;this.X_a=b;wac_0L(this.Qg,new wac_XL(1))},yTf:function(){this.Np.Se.If()&&
3===this.Np.Se.bA&&(this.Fqf.ga(this.Ec.Nd),wac_47(this.Np,1));this.d7a.Se.If()&&3===this.d7a.Se.bA&&(this.Fqf.ga(this.Ec.Nd),wac_47(this.d7a,1))},bUd:function(a){this.Np.Se.Plf();wac__$c(this.WX,this.Ec.oqa(),a.suggestions.length,a.suggestions.length,a.correlationId,wac_Z1b(this.Np),!0,this.Np.I3e());wac_iN(this.ra,"EditingDesignerPanelFocus",!0)}};function wac_had(a){return 1===a.Np.Se.bA||1===a.d7a.Se.bA}function wac_0$c(a){return 4===a.Np.Se.bA||4===a.d7a.Se.bA}
function wac_6$c(a){return a.Np.Se.If()||a.d7a.Se.If()}
function wac_9$c(a,b,c,d,e){a.ua.zy&&a.Y2.uc(function(a){var g=new wac_ppb;g.correlationId=b;if(d){var h;b:{var k=[];try{if(!d||!d.SlideSuggestions){wac_Y(39338643,829,50,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - no slide suggestions to parse");h=k;break b}for(h=0;h<d.SlideSuggestions.length;h++){var l=d.SlideSuggestions[h].Base64Img,m=null;if(wac_qad())try{var n,m=(n=new wac_npb,n.suggestionIndex=d.SlideSuggestions[h].Index.toString(),n.suggestionCid=d.SlideSuggestions[h].SlideId.Cid.toString(),
n.suggestionSid=d.SlideSuggestions[h].SlideId.Sid.toString(),n.imageData=l.startsWith("data:image")?l:"data:image/png;base64,"+l,n.label=String.format(ResourceStrings.l_DesignerSuggestionItem,h+1),n)}catch(q){wac_Y(594071828,829,15,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions by SlideId"),m=null}if(!m)var p,m=(p=new wac_npb,p.suggestionIndex=d.SlideSuggestions[h].Index.toString(),p.suggestionSid=d.SlideSuggestions[h].SlideSid.toString(),p.imageData=
l.startsWith("data:image")?l:"data:image/png;base64,"+l,p.label=String.format(ResourceStrings.l_DesignerSuggestionItem,h+1),p);Array.add(k,m)}}catch(q){wac_Y(39338645,829,10,"DesignerViewHelper:ParseSuggestionDataFromJsonResults - error happened on getting slide suggestions. {0}",q)}h=k}g.suggestions=h}else wac_Y(39977434,829,50,"Designermanager:ParseSlideSuggestionNotificationData - no suggestions to parse");!e||(g.trigger=e);a.YMd(c,g)})}
function wac_rad(a,b,c){return c.If()||!wac_5nc(a.Ec)&&"NewSlide"!==b&&"ChangeIconInSmartArt"!==b&&"ChangeIcon"!==b}function wac_oad(a,b){b.yif?(wac_km(a.Ec.oqa().SlideSuggestions)||a.Ec.oqa().SlideSuggestions.length===b.h_d)&&wac_9$c(a,b.Nd,"Success",a.Ec.oqa(),b.fM):wac_9$c(a,b.Nd,"Success",a.Ec.oqa(),b.fM)}
function wac_pad(a,b,c,d,e,f){if(a.ua.jwd?!e:!f)b&&wac_47(b,2),b.Se.If()||wac_5nc(a.Ec)?wac_9$c(a,a.Ec.Nd,"NoResult",null,""):a.U.Wj(2658220272,2,new wac_wJ(!1,"NoSuggestion"),null);else if(wac_rad(a,c.fM,b.Se)){var g=!0;if(a.ua.ayc){var g=!document.querySelector("#"+b.Se.ia()+' .DesignerSuggestionList[correlationId="'+c.Nd+'"]'),h=new wac_lPc(c,g);a.Qg.la.wa("RS",h,null)}if(g){b&&wac_47(b,3);a.Ec.Qtd||(a.Ec.Qtd=new Date);try{a.ua.rvf&&a.c8e.uc(function(a){a.lCe("HasSeenDesigner","PPTDesignerFloodgateSurveyEnabled")})}catch(k){wac_Y(42050709,
829,10,"DesignerManager::HandleSuggestionUpdate: Exception thrown when trying to trigger floodgate survey. Exception: {0}",k)}}wac__$c(a.WX,d,e,f,c.Nd,wac_Z1b(b),g,b.I3e());wac_5nc(a.Ec)||a.U.yw(4095945772,2,null)}}
function wac_mwc(a){switch(a){case 2423756553:case 1296122996:case 1800138055:case 910012865:case 1991549851:case 3300418813:case 4089132864:case 134426873:case 1534685076:case 2219070986:case 1974018626:case 249647848:case 2677509403:case 4262591775:case 506982572:case 2887293604:case 1854371976:case 1460660268:case 3398225082:case 110395433:return!0;default:return!1}}
function wac_4$c(a,b){switch(a){case "EditorPrev":b.zw("#EditorPrev");break;case "EditorNext":b.zw("#EditorNext");break;case "EditorIgnore":b.zw(".EditorIgnore");break;case "EditorSeeMoreLabel":b.zw(".EditorSeeMoreLabel")}}function wac_1$c(a){return Sys.UI.DomElement.containsCssClass(a,"mivContainer")||Sys.UI.DomElement.containsCssClass(a,"mivOverlayContainer")}
function wac_51b(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t){this.Fce=Function.createDelegate(this,this.xue);this.x4a=Function.createDelegate(this,this.xFd);this.xib=Function.createDelegate(this,this.Mie);this.yT=Function.createDelegate(this,this.wna);this.dJa=Function.createDelegate(this,this.fPa);this.Yaa=Function.createDelegate(this,this.oxa);this.SU=Function.createDelegate(this,this.uMa);this.la=new wac_Re;this.Hqa=!!wac_r()&&!!wac_r().Hd()&&wac_r().Hd().vqb();this.dispose=this.O;this.Ob=a;this.ed=b;this.oc=
c;this.Bn=d;this.U=e;this.Ec=f;this.Gt=g;this.zc=h;this.IB=k;this.Mp=l;this.ra=m;this.ua=n;this.fr=p;this.Vv=r;this.bFf=t;this.yVa=q;this.Fb=document.createElement("div");this.Fb.className="DesignerPane";this.Fb.id=r;this.Fb.style.position="absolute";this.Fb.setAttribute("role","region");this.Fb.setAttribute("aria-labelledby","DesignerPaneLabel");this.Fc=!1;this.UX=wac_eH();this.UX.className="DesignerPaneLayoutRoot";this.Fb.appendChild(this.UX);a=wac_.pa.Qb.PPTFabricIconDiamondCssUrl;b=document.createElement("link");
b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");b.setAttribute("href",a);this.Fb.appendChild(b);this.Ob.Omc(this.SU)}
wac_51b.prototype={Ob:null,ed:null,oc:null,Bn:null,Fb:null,UX:null,U:null,Ec:null,Gt:null,zc:null,IB:null,Mp:null,ra:null,fr:null,Vv:null,bFf:null,Fc:!1,dZc:!1,bA:0,r0a:null,Sj:null,E$:null,A2a:null,sVa:null,ua:null,yVa:null,O:function(){this.Fla();this.Fb.removeChild(this.UX);this.Ob.ITc(this.SU);wac_Y(22590850,829,50,"DesignerPane::Dispose")},Yd:function(){this.Sj=this.jNa("per","ClosePaneGlyph_16x16x32");Sys.UI.DomElement.addCssClass(this.Sj,"DesignerPaneCloseButton");this.Sj.setAttribute("role",
"button");this.UX.appendChild(this.Sj);this.oc.ya("click",this.Sj,this.Yaa);this.Bn.xa(this.Sj,"keydown",this.dJa);this.r0a=wac_eH();this.r0a.id="DesignerPaneLabel";this.r0a.className="DesignerPaneLabel";this.Hqa&&(this.r0a.style.paddingLeft="10px",this.Sj.style.paddingRight="15px");this.r0a.innerText=this.bFf;this.UX.appendChild(this.r0a);this.ua.zy&&wac_61b(this);var a=this,b=this;this.Gt.E_(this.skf(),"main",this.Fb,function(){a.VXb(!0)},function(){b.VXb(!1)},!1,null);wac_BPa(this.zc,this.yT);
wac_XF(this.zc,this.xib);wac_5Oa(this.IB,this.xib);wac_Y(22590852,829,50,"DesignerPane::Initialize")},skf:function(){return"EditingDesignerPanelFocus"},Fla:function(){this.oc&&0<this.UX.childNodes.length&&(this.oc.ub("click",this.Sj,this.Yaa),this.Bn.sb(this.Sj,"keydown",this.dJa),this.UX.removeChild(this.r0a),this.UX.removeChild(this.Sj),this.ua.zy&&(this.oc.ub("click",this.sVa.Oa,this.x4a),this.oc.ub("click",this.A2a,this.x4a),this.Bn.sb(this.sVa.Oa,"keydown",this.Fce),this.Bn.sb(this.A2a,"keydown",
this.Fce),this.UX.removeChild(this.E$)));wac_APa(this.zc,this.yT);wac_nO(this.zc,this.xib);wac_2Db(this.IB,this.xib);this.ra.Re()&&"EditingDesignerPanelFocus"===this.ra.Re().Kd&&wac_iN(this.ra,"EditingDesignerPanelFocus",!1)},wna:function(a,b){b.FKa&&!wac_tG(this.Mp)&&this.Fc&&(wac_Y(24760967,829,50,"DesignerPane::OnUnifiedAppStateChanged - Switching to read-only mode and Designer pane is opened. CorrelationId:{0}",this.Ec.Nd),this.tr(!1,"SuggestionPaneClosed"))},uMa:function(a){a&&this.Fc&&this.tr(!1,
"SuggestionPaneClosed")},Mie:function(){wac_Y(37861251,801,50,"Designer Pane is closed because session is rehydrated.");this.tr(!1,"SessionRehydrated")},jNa:function(a,b){return this.iNa(a,"cui-img-16by16","cui-ctl-iconContainer",b,CommonUIStrings.l_DialogClose,null)},iNa:function(a,b,c,d,e,f){var g=wac_SG();g.alt=e;g.className=wac_7h(a,d);g.src=this.ed.Io(a+".png");g.setAttribute("Unselectable","on");a=wac_fH();a.className=b+" cui-img-cont-float";a.appendChild(g);b=wac_fH();b.className=c;b.setAttribute("Unselectable",
"on");b.appendChild(a);c=wac_0O();c.className="DesignerPaneNoBorderButton cui-ctl";c.title=e;c.setAttribute("role","button");c.tabIndex=0;c.appendChild(b);f&&(e=wac_fH(),e.className="cui-ctl-mediumlabel",e.setAttribute("Unselectable","on"),e.innerText=f,c.appendChild(e));return c},qC:function(a,b){var c=b?wac_jH(a,this.Ef()):wac_iH(a,this.Ef());this.Fc&&(b?(Sys.UI.DomElement.addCssClass(this.Fb,"DesignerPaneRTL"),wac_jH(c,1)):(Sys.UI.DomElement.addCssClass(this.Fb,"DesignerPaneLTR"),wac_iH(c,1)));
wac_cH(this.Fb,c);return a},tr:function(a,b){if(this.Fc!==a){this.Fc=a;var c="IdeasPane"===this.Vv?"IdeasPaneOpen":"PaneOpen";a?(this.ua.Xfe&&(a={},a[c]=!0,wac_wqc(this.fr,JSON.stringify(a))),this.Yd(),this.Fb.style.display="inline-flex",this.Ec.lRb(0,0),wac_Y(22590854,829,50,"DesignerPane::SetIsVisible - Set to visible")):(this.ua.Xfe&&(a={},a[c]=!1,wac_wqc(this.fr,JSON.stringify(a))),this.Fla(),this.Fb.style.display="none","GoToIdeas"===b||"CloseSecondPane"===b||wac_5nc(this.Ec)&&"SuggestionPaneClosed"===
b||(this.Ec.v8a=new Date,1===this.bA&&(this.Ec.tzb=!0),this.U.Wj(2658220272,2,new wac_wJ(!0,b),null)),this.Ec.lRb(1,0),wac_Y(22590856,829,50,"DesignerPane::SetIsVisible - Set to not visible"));this.Hqa?this.yVa.ANe(this,this.Fc,"IdeasPane"===this.Vv?ResourceStrings.L_IdeasButtonHomeRibbon:ResourceStrings.L_ShowHideDesignerPane,this.skf()):this.Ob.mua()}},VXb:function(a){a?this.la.wa("OnDesignerPaneFocusOn",null,null):this.la.wa("OnDesignerPaneFocusBlur",null,null)},fPa:function(a){!this.Fc||13!==
a.keyCode&&32!==a.keyCode||this.tr(!1,"Typing")},oxa:function(){this.Fc&&(wac_Y(22853525,829,50,"DesignerPane::ClosePaneButtonClickHandler - Designer pane close button clicked. CorrelationId:{0}",this.Ec.Nd),this.tr(!1,"SuggestionPaneClosed"));return!0},m6e:function(){return this.ua.zy&&!!this.E$},Plf:function(){this.m6e()&&(this.E$.style.display="block")},xFd:function(){return wac_7nc(this)},xue:function(a){13!==a.keyCode&&32!==a.keyCode||wac_7nc(this)},Glf:function(){this.m6e()&&this.A2a.focus()},
If:function(){return this.Fc},$c:function(){return this.Fb},GK:function(){return 7},ia:function(){return this.Vv},Ef:function(){var a=0;this.Fc&&(a=this.ua.zy?304:263,a+=1+wac_yM);return a}};function wac_27(a,b){(a.dZc=b)&&a.Sj.focus()}function wac_7nc(a){if(!a.Fc||!a.ua.zy)return!1;wac_Y(37065160,829,50,"DesignerPane::GoToIdeasHandlerInternal - closing Designer pane to go to Ideas Pane. CorrelationId:{0}",a.Ec.Nd);a.U.Wj(2034521264,2,!1,null);a.tr(!1,"GoToIdeas");return!0}
function wac_61b(a){a.E$=wac_eH();a.E$.className="GoToIdeasContainer";a.E$.style.display="none";a.Hqa&&(a.E$.style.paddingLeft="10px");a.sVa=new wac_MG;a.sVa.qh(20,20);wac_Soc(a.sVa,"0 0 2048 2048");a.sVa.Oa.setAttribute("class","IdeasTab");var b=new wac_UG;wac_vJ(b,"M 1741 819 l -1089 1127 h -284 l 423 -717 h -484 l 605 -1127 h 587 l -363 717 z");var c=new wac_UG;wac_vJ(c,"M 457 1894 l 424 -716 h -488 l 550 -1024 h 472 l -363 716 h 568 l -990 1024 z");c.Oa.setAttribute("class","IdeasTabFill1");var d=
new wac_UG;wac_vJ(d,"M 1741 819 l -1089 1127 h -284 l 423 -717 h -484 l 605 -1127 h 587 l -363 717 m 363 103 h -530 l 363 -717 h -358 l -496 921 h 493 l -424 717 h 61 z");d.Oa.setAttribute("class","IdeasTabFill2");a.sVa.Ce(b);a.sVa.Ce(c);a.sVa.Ce(d);a.A2a=wac_fH();a.A2a.innerText=ResourceStrings.l_DesignerGoToIdeas;a.A2a.className="IdeasText";a.A2a.setAttribute("role","button");a.A2a.tabIndex=0;a.E$.appendChild(a.sVa.Oa);a.E$.appendChild(a.A2a);a.UX.appendChild(a.E$);a.oc.ya("click",a.sVa.Oa,a.x4a);
a.oc.ya("click",a.A2a,a.x4a);a.Bn.xa(a.sVa.Oa,"keydown",a.Fce);a.Bn.xa(a.A2a,"keydown",a.Fce)}function wac_8nc(a,b){this.rre=b;this.gh=a;this.qe=!1}
wac_8nc.prototype={Ht:null,rre:null,gh:null,Uta:null,qe:!1,Kn:function(){this.qe||(this.Uta=wac_eH(),this.Uta.setAttribute("Unselectable","on"),this.Uta.style.position="absolute",wac_aH(this.Uta,"designerPreviewImageContainer"),this.Ht=new wac_FG,this.qe=!0)},O:function(){this.qe&&(this.sl(),this.Ht&&this.Ht.Oa.parentNode&&(this.Ht.Sr(),wac_mO(this.Ht.Oa,"designerPreviewImageContainer")))},sl:function(){this.qe?(this.tRa(),this.Ht.le(!1)):wac_Y(38099035,829,15,"DesignerPreviewImageView::Dismiss - called before setup")},
tRa:function(){this.Ht.Oa.firstChild&&this.Ht.Oa.removeChild(this.Ht.Oa.firstChild)}};function wac_sad(a,b){this.QGf=Function.createDelegate(this,this.oOf);if(a){this.w7e=a;var c=this;this.w7e.km("PowerPointDesigner",!1).then(function(a){c.ucf=a;a||(a=c.w7e,c.Buf=a.uBf&&a.unf);return null});this.PXf=wac_y6c(this.w7e,this.QGf);this.TEf=b}}
wac_sad.prototype={w7e:null,PXf:null,TEf:null,I3e:function(){return!this.ucf&&this.Buf},ucf:!1,Buf:!1,d6e:function(){this.w7e&&this.w7e.d6e("designer")},oOf:function(a){a&&"PowerPointDesigner"===a.wyf&&(!this.ucf&&a.yx&&this.TEf(),this.ucf=a.yx)}};
function wac_71b(a,b,c,d,e,f,g,h,k,l,m,n,p,q){this.jKe=Function.createDelegate(this,this.mMe);this.TB=Function.createDelegate(this,this.pV);this.wT=Function.createDelegate(this,this.D6);this.F4a=Function.createDelegate(this,this.gJb);this.R6c=Function.createDelegate(this,this.uzd);this.dJa=Function.createDelegate(this,this.fPa);this.S6c=Function.createDelegate(this,this.vzd);this.Dec=Function.createDelegate(this,this.GPd);this.sJa=Function.createDelegate(this,this.zQa);this.EIf=Function.createDelegate(this,
this.vRf);this.eHf=Function.createDelegate(this,this.IOf);this.dispose=this.O;wac_71b.initializeBase(this,[new wac_BA,a,f,null]);this.Se=b;this.WX=c;this.Ec=d;this.JHa=e;this.ra=g;this.oc=h;this.Xo=k;this.Bn=l;this.U=m;this.he=n;this.ua=p;this.Qbc=this.ua.gMa;var r=this;this.LJe=new (wac_f.$$(wac_tad))(function(){return new wac_tad(h,r.eHf)});this.Epf=new wac_sad(q,this.EIf)}
wac_71b.prototype={DS:null,q0a:null,BS:null,VX:null,Oaf:null,Naf:null,z3a:0,HGa:!1,Se:null,WX:null,Ec:null,JHa:null,ra:null,oc:null,Xo:null,Bn:null,U:null,he:null,ua:null,Qbc:!1,LJe:null,Epf:null,O:function(){this.HGa&&wac_81b(this);!this.LJe.Xnb&&this.LJe.ma().O();wac_CA.prototype.O.call(this);wac_Y(22590858,829,50,"DesignerView::Dispose")},rbb:function(){this.DS=wac_eH();this.DS.className="DesignerViewContainer";this.sa.appendChild(this.DS);this.HGa=!0;wac_Y(22590860,829,50,"DesignerView::InitializeView")},
I3e:function(){return this.ua.pif&&this.Epf.I3e()},IOf:function(){this.ua.pif&&(!this.LJe.Xnb&&this.LJe.ma().sl(),this.Epf.d6e())},vRf:function(){!this.LJe.Xnb&&this.LJe.ma().sl();if(this.WX.ua.hcf){var a=document.getElementsByClassName("SuggestionImg");if(a)for(var b=0;b<a.length;b++){a[b].parentNode.removeAttribute("isShownAsPremiumContent");var c=wac_pP(a[b].parentNode,"DesignerSuggestionListDisabled");!c||c.getAttribute("SourceTrigger")&&"Refreshing"===c.getAttribute("SourceTrigger").toString()||
(c.style.visibility="hidden")}}else if(a=document.getElementsByClassName("ShadowedTriangleContainer"))for(b=0;b<a.length;b++)a[b].style.display="none",a[b].parentNode.removeAttribute("isShownAsPremiumContent")},Kyf:function(){},gya:function(a){var b,c,d;return(d=wac_uad(this,a,c={val:b},{val:void 0},{val:void 0}),b=c.val,d)?window.parseInt(b):-1},vzd:function(){return this.Se.If()?wac_91b(this):!1},jyf:function(){return!1},kyf:function(){return!1},lkf:function(){return!1},uzd:function(a){if(!this.Se.If()||
a.Km||!this.WX.Ja()||!a.Lb())return!1;a=a.Lb();if("mivOverlayContainer"===a.className||"mivTerm"===a.className||"mivIcon"===a.className||"mivContainer"===a.className)return this.kyf(a);if(a.className.startsWith("Editor"))return this.jyf(a);var b;for(b=a;b&&"DesignerSuggestedActionResult"!==b.className;)b=b.parentNode;if(b)return a=b.getAttribute("suggestionIndex").toString(),a=window.parseInt(a),(a=this.Ec.kud[a])&&3===a.Type?(a=new wac_mPc(a),this.he.la.wa("SAC",a,null),a=!0):a=!1,a;if(Sys.UI.DomElement.containsCssClass(a,
"ms-Icon--Diamond")){if(a=a.parentNode,!a)return!1}else if(!(Sys.UI.DomElement.containsCssClass(a,"ShadowedTriangleContainer")||Sys.UI.DomElement.containsCssClass(a,"SuggestionImg")||Sys.UI.DomElement.containsCssClass(a,"DesignerSuggestionListDisabled")||(a=a.firstChild,a)))return!1;var c=a.parentNode;b=document.querySelector("#"+this.Se.ia()+" .DesignerSuggestionList");var d,e,f,g,h,k,l;if(l=wac_uad(this,c,g={val:d},h={val:e},k={val:f}),d=g.val,e=h.val,f=k.val,!l)return!1;d=window.parseInt(d);e=
window.parseInt(e);g=0;if(wac_qad())try{g=window.parseInt(f)}catch(n){wac_Y(594071839,829,15,"DesignerView::ClickSuggestionHandler failed to parse suggestion slide creationId")}if(this.Ec.hva===e)return wac_Y(25203038,829,50,"DesignerView::ClickSuggestionHandler clicked the applied suggestion"),a=new wac_ZL(d,wac_T1b(this)),this.he.la.wa("DCS",a,null),!1;if(c&&c.getAttribute("isShownAsPremiumContent")){a=null;b=c.childNodes;for(var m=0;m<b.length;m++)if(d=b[m],Sys.UI.DomElement.containsCssClass(d,
"ShadowedTriangleContainer")){a=d;break}b=wac_xk(a||c);this.LJe.ma().Ki(b,c,a);return!1}if(Sys.UI.DomElement.containsCssClass(a,"DesignerSuggestionListDisabled"))return!1;a:{if(c=document.querySelectorAll('[slideId="'+e+'"] > .SuggestionImg'))for(f=0;f<c.length;f++)if(h=c[f],h!==a){c=h;break a}c=null}f=(m=new wac_Ga,m.SuggestionCid=g,m.SuggestionSid=e,m.CorrelationId=b.getAttribute("correlationId").toString(),m.ActiveSlideCid=this.WX.Ja().fe(),m.ActiveSlideSid=this.WX.Ja().Vc(),m);m=a;m=.01>=Math.abs(m.width/
m.height-1.33);wac_vad(this.WX,b,m)?(e=this.WX,wac_6nc(e,wac_vad(e,b,m),m,!1),c&&c.parentNode&&c.parentNode.parentNode&&(b=this.WX,wac_6nc(b,wac_vad(b,c.parentNode.parentNode,m),m,!1)),this.U.Wj(1234776651,2,f,null),wac_Y(22590872,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestionMultiple")):(this.U.Wj(397517337,2,f,null),wac_Y(22590874,829,50,"DesignerView::ClickSuggestionHandler Trigger ApplyDesignerSuggestion"));wac_6nc(this.WX,a.parentNode,m,!0);c&&wac_6nc(this.WX,c.parentNode,
m,!0);wac_$1b(this.DS,d);a=new wac_ZL(d,wac_T1b(this));this.he.la.wa("DCS",a,null);return!0},fPa:function(a){this.Se.If()&&(13!==a.keyCode&&32!==a.keyCode||wac_91b(this))},gJb:function(a){!this.Se.If()||13!==a.keyCode&&32!==a.keyCode||(a.preventDefault(),(a=document.activeElement)&&a.click())},gs:function(a,b){if(!(0>a)){var c=this.VX.querySelector('[suggestionIndex="'+a+'"]');c?b&&(wac_Vj(c),wac_$1b(this.DS,a)):wac_Y(22590880,829,15,"DesignerView::SetSuggestionItemFocus, suggestionItem {0} is null",
a)}},GPd:function(){},zQa:function(){if(this.Se.If())if(2===this.Se.bA)wac_Vj(this.BS.lastChild);else if(3===this.Se.bA){var a;a=this.VX.querySelector("#"+this.Se.ia()+" .DesignerSuggestionResultSelected");a=this.gya(a);var b;b=this.VX.querySelector("#"+this.Se.ia()+" [slideId]:hover");b=this.gya(b);-1===a?this.gs(-1===b?0:b,!0):this.gs(a,!0)}},D6:function(a){return this.Se.If()&&a.Lb()?this.lkf(a.get_clientPoint()):!1},pV:function(a){return this.Se.If()&&a.Lb()?this.lkf(a.get_clientPoint()):!1},
mMe:function(){this.WD();wac_47(this,2);wac_Y(22590912,829,50,"DesignerView::GetSuggestionTimeout, CorrelationId: {0}",this.Ec.Nd);this.Se.If()&&(this.Ec.JAb=!0,this.U.Wj(2658220272,2,new wac_wJ(!1,"SuggestionsLoadingTimeout"),null))},kQb:function(){this.z3a=window.setTimeout(this.jKe,15E3)},WD:function(){window.clearTimeout(this.z3a)}};
function wac_91b(a){try{var b=a.BS.querySelector(".DesignerNoSuggestionView-Link");if(!b)return!1;var c=b.getAttribute("href").toString();if(!c)return!1;wac_Qh(4,c,!0,null);return!0}catch(d){return wac_Y(41711770,829,10,"DesignerView:GoToSuggestionLink exception: {0}",d),!1}}function wac_Z1b(a){var b=a.ua.gMa?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView",c=a.ua.gMa?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";return a.sa.querySelector("."+(wac_Ag?c:b))}
function wac_T1b(a){return a.VX.querySelectorAll("#"+a.Se.ia()+" [suggestionIndex]").length}
function wac_uad(a,b,c,d,e){c.val="";d.val="";e.val="";if(b){var f=b.getAttribute("suggestionIndex"),g=b.getAttribute("slideId");if(!f||!g)return wac_Y(41694980,829,10,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion index and slideId, CorrelationId: {0}",a.Ec.Nd),!1;c.val=f.toString();d.val=g.toString();wac_qad()&&((b=b.getAttribute("slideCid"))?e.val=b.toString():wac_Y(594071841,829,15,"DesignerView::GetSuggestionIndexAndSlideId - Failed to parse suggestion slide creationId, CorrelationId: {0}",
a.Ec.Nd));return!0}return!1}
function wac_wad(a){a.BS=wac_eH();a.BS.className=wac_Ag?"DesignerNoSuggestionViewRTL":"DesignerNoSuggestionView";a.Oaf=wac_eH();a.Oaf.className="DesignerNoSuggestionView-Header";a.Naf=wac_eH();a.Naf.className="DesignerNoSuggestionView-Content";var b=wac_0O();b.className="DesignerNoSuggestionView-Link";b.setAttribute("href","https://go.microsoft.com/fwlink/?linkid=849683");b.setAttribute("target","_blank");b.innerText=ResourceStrings.L_DesignerLearnMore;b.tabIndex=0;b.setAttribute("role","link");b.setAttribute("aria-label",
ResourceStrings.L_DesignerNoSuggestionHeader);a.BS.appendChild(a.Oaf);a.BS.appendChild(a.Naf);a.BS.appendChild(b);a.DS.appendChild(a.BS);a.oc.ya("click",b,a.S6c);a.Bn.xa(a.BS,"keydown",a.dJa)}
function wac_47(a,b){a.WD();4!==b&&(wac_81b(a),a.DS.id=a.Ec.Nd);a.Se.bA=b;switch(a.Se.bA){case 1:a.q0a=wac_eH();a.q0a.className="DesignerLoadingView";var c=wac_SG();c.className=wac_Ag?"DesignerLoadingViewSpinnerRTL":"DesignerLoadingViewSpinner";c.src=wac_Le("progress.gif");var d=wac_eH();d.className=wac_Ag?"DesignerLoadingViewTextRTL":"DesignerLoadingViewText";d.innerText=ResourceStrings.L_DesignerLoading;a.q0a.appendChild(c);wac_Y(38340425,829,50,"DesignerView::spinner shows up");a.q0a.appendChild(d);
a.DS.appendChild(a.q0a);wac_Y(22590866,829,50,"DesignerView::InitLoadingState");a.kQb();break;case 2:a.Se.If()&&(wac_wad(a),a.Oaf.innerText=ResourceStrings.L_DesignerNoSuggestionHeader,a.Naf.innerText=ResourceStrings.L_DesignerNoSuggestionContent,wac_Y(22590868,829,50,"DesignerView::InitNoSuggestionState"));break;case 5:a.Se.If()&&(wac_wad(a),a.Oaf.innerText=ResourceStrings.L_DesignerCoauthorHeader,a.Naf.innerText=ResourceStrings.L_DesignerCoauthorContent,wac_Y(41725981,829,50,"DesignerView::InitSameSlideCoauthNoSuggestionState"));
break;case 3:a.Se.If()||a.Se.tr(!0,null);a.VX=wac_eH();c=a.Qbc?"DesignerShowSuggestionViewWide":"DesignerShowSuggestionView";d=a.Qbc?"DesignerShowSuggestionViewRTLWide":"DesignerShowSuggestionView";a.VX.className=wac_Ag?d:c;a.DS.appendChild(a.VX);a.Se.Plf();a.ua.Y5a||(wac_iN(a.ra,"EditingDesignerPanelFocus",!0),a.ra.ld());a.oc.ya("click",a.VX,a.R6c);a.Bn.xa(a.VX,"keydown",a.F4a);a.Xo.ya("msospPointerOver",a.VX,a.wT);a.Xo.ya("msospPointerOut",a.VX,a.TB);wac_Y(22590870,829,50,"DesignerView::InitShowSuggestionState");
break;case 6:a.Kyf();break;case 4:if(c=document.querySelectorAll(".DesignerSuggestionListDisabled"))for(d=0;d<c.length;d++)c[d].style.visibility="visible",c[d].setAttribute("SourceTrigger","Refreshing")}a.Se.la.xa("OnDesignerPaneFocusOn",a.sJa);a.Se.la.xa("OnDesignerPaneFocusBlur",a.Dec);wac_Y(22590864,829,50,"DesignerView::SetViewState: {0}",wac_Z.p$a.toString(b))}
function wac_81b(a){if(a.DS.children&&0<a.DS.children.length)for(;0<a.DS.children.length;)a.DS.removeChild(a.DS.children[0]);a.Se.bA=0;a.Se.la.sb("OnDesignerPaneFocusOn",a.sJa);a.Se.la.sb("OnDesignerPaneFocusBlur",a.Dec);!a.LJe.Xnb&&a.LJe.ma().sl();wac_Y(22590862,829,50,"DesignerView::CleanUpView")}
function wac_a2b(a,b,c,d,e,f){this.Ea=a;this.Cc=b;this.ua=c;this.Ec=d;this.lbf=(a=this.ua.gMa)?"DesignerSuggestionResultWide":"DesignerSuggestionResult";this.mbf=a?"DesignerSuggestionResultSelectedWide":"DesignerSuggestionResultSelected";this.pb=e;this.ed=f}function wac_mad(a){var b=null;try{b=wac_yl(a)}catch(c){wac_Y(39338641,829,10,"DesignerViewHelper:TransformSuggestionDataFormat - parsing suggestionResults failed")}return b}
function wac_nad(a){var b=a.CardData,c=null;try{if(c=wac_yl(b),!a.SlideSuggestions&&c)for(c=wac_02a(c,function(a){return!!a.Type}),a=0;a<c.length;a++)c[a].Index=a}catch(d){wac_Y(41969486,829,10,"parsing cards failed with exception: {0}",d)}return c}function wac_xad(){var a=wac_eH();a.className=a.id="EditorSuggestionsContainer";return a}
function wac_qad(){try{return window.ChangeGate.ChangeGate.isChangeGateEnabled("Designer.ConsumeSuggestionSlideCreationId")}catch(a){return wac_Y(594023649,829,100,"ShouldConsumeSuggestionSlideCreationId Exception={0}",a),!1}}wac_a2b.prototype={Ea:null,ua:null,Cc:null,Ec:null,pb:null,ed:null,lbf:null,mbf:null,Xaf:null,Kna:function(){return this.Cc.Kna(!0)},Ja:function(){return window.$$as(wac_KH,this.Ea.Ja())}};
function wac_$1b(a,b){if(a){if(a=a.querySelector('[suggestionIndex="'+b+'"]'))b=wac_xk(a),a.contains(wac__ka(new Sys.UI.Point(b.x,b.y)))&&a.contains(wac__ka(new Sys.UI.Point(b.x+b.width-1,b.y)))?a.contains(wac__ka(new Sys.UI.Point(b.x,b.y+b.height-1)))&&a.contains(wac__ka(new Sys.UI.Point(b.x+b.width-1,b.y+b.height-1)))||a.scrollIntoView(!1):a.scrollIntoView(!0)}else wac_Y(36845459,829,15,"Designer view has been removed from DesignerViewContainer")}
function wac_vad(a,b,c){return b.querySelector("."+(c?a.mbf+"4x3":a.mbf))}function wac_6nc(a,b,c,d){b&&(d?(b.className=c?a.mbf+"4x3":a.mbf,wac_Fe(b,"aria-selected","true")):(b.className=c?a.lbf+"4x3":a.lbf,wac_Fe(b,"aria-selected","false")))}
function wac_lad(a,b){if(b&&(b=b.querySelector(".DesignerSuggestionResultSelected, .DesignerSuggestionResultSelected4x3, .DesignerSuggestionResultSelectedWide, .DesignerSuggestionResultSelectedWide4x3"))){var c=-1!==b.className.indexOf("4x3");wac_6nc(a,b,c,!1)}}function wac_yad(a){a=a.Kna();return.01>=Math.abs(a.ac/a.qc-1.33)}function wac_iad(a){a.Xaf&&(a.pb.Rg(a.Xaf),a.Xaf=null)}
function wac_zad(a,b){wac_iad(a);a.Xaf=new wac_D(2,1,a.ua.Wtf,function(){wac_iad(a);for(var c=0;c<b;c++)a.Ec.wVd.Ge(c)||a.Ec.F8e.ga(c)},0,"IncrementalRenderTimeoutTask",!1);a.pb.Hb(a.Xaf)}
function wac_Aad(a,b,c){a=a.Ec.vcc[c].B1e[0].suggestions;c=Math.min(3,a.length);for(var d=0;d<c;d++){var e=b,f=a[d].description,g=a[d].numberOfInstances,h=d,k=wac_eH();k.className="EditorSuggestionContainer";k.tabIndex=0;k.setAttribute("editorSuggestionIdx",h);var l=wac_fH();l.className="EditorSuggestionArrow";l.innerText="\u2192";l.setAttribute("editorSuggestionIdx",h);var m=wac_fH();m.className="EditorSuggestionText";m.innerText=f;m.setAttribute("editorSuggestionIdx",h);f=wac_fH();f.className="EditorSuggestionInstances";
f.innerText=String.format("[{0}]",g);f.setAttribute("editorSuggestionIdx",h);k.appendChild(l);k.appendChild(m);k.appendChild(f);e.appendChild(k)}}
function wac_Bad(a,b,c,d,e,f){var g=wac_eH();g.className="mivButton";g.setAttribute("role","listitem");var h="mivTerm."+e,k=wac_SG();k.className="mivButtonImage";a:{for(var l=wac_Cad,m=l.length,n=0;n<m;++n){var p=l[n];if(p.toLowerCase()===b.toLowerCase()){d.ga(p);a=a.ed.Io(b+".png");break a}}a=a.ed.Io("stock"+f.val++ +".png")}k.src=a;k.setAttribute("aria-labelledby",h);a=wac_eH();a.className="mivOverlayContainer";a.tabIndex=0;a.setAttribute("mivIdx",e);a.setAttribute("role","button");e=document.createElement("i");
e.className="mivIcon";e.innerText="\ue721";e.setAttribute("role","presentation");d=wac_fH();d.className="mivTerm";d.innerText=b;d.id=h;g.appendChild(k);g.appendChild(a);a.appendChild(e);a.appendChild(d);c.appendChild(g)}
function wac_Dad(a,b,c,d,e,f,g,h){var k=null;if(a.ua.ayc)a:if((k=document.querySelector("#"+d+' [IncSuggestionPlaceholder="'+g+'"]'))&&Sys.UI.DomElement.addCssClass(k,"ShimmerPaused"),!a.Ec.SLe.Ge(g)&&(a.Ec.SLe.ga(g),d=a.Ec.SLe.Ma(),d===e&&(a.Ec.w8e=new Date,wac_iad(a)),!a.Ec.P5e&&d>=a.Ec.B5e)){for(e=0;e<a.Ec.B5e;e++)if(!a.Ec.SLe.Ge(e))break a;a.Ec.P5e=new Date}e=!1;switch(b){case 0:if(c&&f)try{e=!1;if(wac_qad())try{c.setAttribute("slideId",f.SlideId.Sid),c.setAttribute("slideCid",f.SlideId.Cid),
e=!0}catch(r){wac_Y(594071824,829,15,"DesignerViewHelper:SetSuggestionImgSrc - failed to access suggestionItem.SlideId"),e=!1}e||c.setAttribute("slideId",f.SlideSid);var l=wac_SG();l.className="SuggestionImg";l.src=f.Base64Img;a.Ec.wVd.Ge(f.Index)||a.Ec.wVd.ga(f.Index);c.appendChild(l);wac_Y(42342620,829,50,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} rendered. CorrelationId: {1}",g,a.Ec.Nd)}catch(r){c.parentNode.removeChild(c),wac_Y(41695003,829,10,"DesignerViewHelper:SetSuggestionImgSrc - img at index {0} failed to render in browser. CorrelationId: {1}, Error: {2}",
g,a.Ec.Nd,r)}h&&c&&(c.setAttribute("isShownAsPremiumContent","isShownAsPremiumContent"),a.ua.hcf||(e=wac_eH(),e.className="ShadowedTriangleContainer",f=document.createElement("i"),f.className="ms-Icon ms-Icon--Diamond",e.appendChild(f),c.appendChild(e)));e=h&&a.ua.hcf;break;case 1:if(f){c.className="mivContainer";c.setAttribute("aria-label",ResourceStrings.L_MakeItVisualCardTitle);h=wac_fH();h.className="mivTitle";h.innerText=ResourceStrings.L_MakeItVisualCardTitle;var m=wac_fH();m.className="mivSubtitle";
m.innerText=ResourceStrings.L_MakeItVisualCardSubtitle;var n=wac_eH();n.className="mivButtonsContainer";n.setAttribute("role","list");b=0;g=new (wac_ta.$$(String));d=Math.min(6,f.SearchTerms.length);for(l=0;l<d;l++)wac_Bad(a,f.SearchTerms[l].Term,n,g,l,b={val:b}),b=b.val;for(l=d;6>l;l++){f=wac_Cad;d=f.length;for(var p=0;p<d;++p){var q=f[p];if(!g.Ge(q)){wac_Bad(a,q,n,g,l,f={val:b});b=f.val;break}}}c.appendChild(h);c.appendChild(m);c.appendChild(n);a.Ec.Ccf=!0}break;case 2:if(!(f=wac_km(a.Ec.vcc))){a:if(f=
a.Ec,f.e0a)m=!0;else{try{if(n=wac_k(wac_j(),wac_Hqb)){f.e0a=n;m=!0;break a}}catch(r){wac_Y(42001674,829,15,"error resolving consistencyCheckActor. ex: {0}",r)}m=!1}f=!m}f?c.style.display="none":(c.className="EditorContainer",f=wac_fH(),f.className="EditorTitle",f.innerText=ResourceStrings.L_ConsistencyCardTitle,h=wac_eH(),h.className="EditorSubtitleContainer",m=wac_fH(),m.className=m.id="EditorSubtitle",m.innerText=m.title=a.Ec.vcc[0].B1e[0].explanationLabel,n=wac_eH(),n.className="EditorBucketContainer",
g=wac_fH(),g.innerText="<",g.tabIndex=0,Sys.UI.DomElement.addCssClass(g,"EditorPrev"),Sys.UI.DomElement.addCssClass(g,"EditorPrevDisabled"),g.id="EditorPrev",l=wac_fH(),l.innerText="1",l.id="EditorBucketCurrent",wac_jad(a.Ec,0),b=wac_fH(),b.innerText="/",d=wac_fH(),d.className="EditorBucketTotalCount",d.id="EditorBucketTotal",d.innerText=a.Ec.vcc.length.toString(),p=wac_fH(),p.innerText=">",p.tabIndex=0,p.className=p.id="EditorNext",0<a.Ec.vcc.length-1?Sys.UI.DomElement.addCssClass(p,"EditorNextEnabled"):
Sys.UI.DomElement.addCssClass(p,"EditorNextDisabled"),n.appendChild(g),n.appendChild(l),n.appendChild(b),n.appendChild(d),n.appendChild(p),h.appendChild(m),h.appendChild(n),m=wac_fH(),m.className="EditorDescription",m.innerText=ResourceStrings.L_ConsistencyCardDescription,n=wac_xad(),wac_Aad(a,n,0),g=wac_eH(),g.className="EditorIgnoreContainer",l=wac_eH(),l.className="EditorIgnore",l.innerText=ResourceStrings.L_ConsistencyCardIgnore,l.title=ResourceStrings.L_ConsistencyCardIgnoreTitle,l.tabIndex=
0,g.appendChild(l),l=wac_eH(),l.className="EditorSeeMoreContainer",b=wac_fH(),b.className="EditorSeeMoreLabel",b.innerText=ResourceStrings.L_ConsistencyCardSeeMore,b.tabIndex=0,l.appendChild(b),b=wac_eH(),b.id="EditorCardContent",b.appendChild(h),b.appendChild(m),b.appendChild(n),b.appendChild(g),c.appendChild(f),c.appendChild(b),c.appendChild(l),a.Ec.kcf=!0);break;case 3:f&&(c.className="DesignerSuggestedActionResult",c.setAttribute("aria-label",f.TitleText),c.setAttribute("suggestionIndex",f.Index),
a=document.createElement("i"),a.className="DesignerSuggestedActionResultIcon",a.innerText="\ue721",a.setAttribute("role","presentation"),h=wac_fH(),h.className="DesignerSuggestedActionTitle",h.innerText=f.TitleText,m=wac_fH(),m.className="DesignerSuggestedActionSubtitle",m.innerText=f.DescriptionText,f=wac_eH(),f.className="DesignerSuggestedActionDescription",f.appendChild(h),f.appendChild(m),c.appendChild(a),c.appendChild(f))}k&&k.parentNode.removeChild(k);k=wac_eH();k.className="DesignerSuggestionListDisabled";
e&&(k.style.visibility="visible");c.appendChild(k)}
function wac__$c(a,b,c,d,e,f,g,h){if(b&&d&&f){var k;try{k=a.ua.Xtf&&b.HasPaginationInfo}catch(Q){k=!1}k&&++d;var l=wac_yad(a),m=f.parentNode.parentNode.id;if(g){var n=d,p=wac_eH();p.className="DesignerSuggestionList";p.setAttribute("correlationId",e);p.setAttribute("aria-label",ResourceStrings.l_DesignerSuggestions);p.setAttribute("role","list");if(a.ua.ayc){e=a.Ec;var q;if(q=document.getElementById("WACDocumentPanel")){var r=a.ua.gMa,t=wac_yad(a);q=Math.floor((q.offsetHeight-87)/(r||t?135:101))}else q=
1;e.B5e=q}for(e=0;e<n;e++)q=wac_eH(),q.className=l?a.lbf+"4x3":a.lbf,q.setAttribute("suggestionIndex",e),q.tabIndex=0,q.setAttribute("aria-label",String.format(ResourceStrings.l_DesignerSuggestionItem,e+1)),q.setAttribute("role","listitem"),q.setAttribute("aria-posinset",e+1),q.setAttribute("aria-setsize",n),p.appendChild(q);f.appendChild(p);f=p}else f=document.querySelector("#"+m+' .DesignerSuggestionList[correlationId="'+e+'"]');if(n=f)try{var v=a.Ec.kud,u=!wac_km(v)&&"IdeasPane"===m;f={};if(u)for(var w=
v.length,x=0;x<w;++x){var z=v[x];switch(z.Type){case 0:var y=z,p=null,A=b.SlideSuggestions,B=A.length;for(e=0;e<B;++e)if(C=A[e],C.Index===y.IndexInDesigner){p=C;break}f[z.Index.toString()]=p;break;default:f[z.Index.toString()]=z}}else for(x=b.SlideSuggestions,y=x.length,b=0;b<y;++b){var C=x[b];f[C.Index.toString()]=C}if(g){a.Ec.oDb=new Date;a.ua.ayc&&wac_zad(a,c);for(var F=0;F<n.childNodes.length;F++){var D=n.childNodes[F];if(k&&F===n.childNodes.length-1){var G=D,H=F;G.className="DesignerMoreIdeas";
G.setAttribute("suggestionIndex",H);var J=wac_fH();J.innerText="Get More Ideas";G.appendChild(J)}var K;if(K=a.ua.ayc){var G=f,E=F.toString();K=!(E in G)||!G[E]}if(K){var G=l,H=F,I=D;I.style.backgroundColor="white";var N=wac_eH();N.className=G?"IncSuggestionPlaceholder placeholder_237x178":"IncSuggestionPlaceholder placeholder_237x137";N.setAttribute("IncSuggestionPlaceholder",H);(wac_Ek()||wac_dg())&&Sys.UI.DomElement.addCssClass(N,"Shimmer");I.appendChild(N)}else wac_Dad(a,u?v[F].Type:0,D,m,d,f[F.toString()],
F,h)}}else if(a.ua.ayc)for(F=Object.keys(f),G=F.length,k=0;k<G;++k)H=F[k],I=window.parseInt(H),D=document.querySelector("#"+m+' [suggestionIndex="'+I+'"]'),f[H]&&D&&Sys.UI.DomElement.containsCssClass(D.firstChild,"IncSuggestionPlaceholder")&&wac_Dad(a,u?v[I].Type:0,D,m,d,f[H],I,h)}catch(Q){wac_Y(41695001,829,10,"DesignerViewHelper:RenderSuggestions - Failed to render suggestion(s) and/or incremental rendering placeholders. CorrelationId: {1}, Error: {2}",a.Ec.Nd,Q)}}}
function wac_Ead(a,b,c,d,e,f,g,h,k,l,m,n,p,q){wac_Ead.resolveInheritance();this.dispose=this.O;wac_Ead.initializeBase(this,[a,b,c,d,e,f,g,h,k,l,m,n,p,q,"IdeasPane",n.jwd?ResourceStrings.L_DesignerPreview:ResourceStrings.L_IdeasPaneLabel])}wac_Ead.prototype={GK:function(){return 8},m6e:function(){return!1},Plf:function(){},Glf:function(){},skf:function(){return"EditingIdeasPaneFocus"},zw:function(a){(a=document.querySelector(a))&&wac_Vj(a)}};
function wac_5$c(a,b){a.zw('.EditorSuggestionContainer[editorSuggestionIdx="'+b+'"')}function wac_3$c(a,b){a.zw("#"+a.Vv+" .mivButton:nth-child("+b+") > .mivOverlayContainer")}function wac_2$c(a,b,c,d,e,f,g,h,k,l,m,n,p,q){this.Y3=Function.createDelegate(this,this.CM);this.dispose=this.O;wac_2$c.initializeBase(this,[a,b,c,d,e,f,g,h,k,l,m,n,p,q]);this.urb=new wac_h5;var r;this.jEf=(r=new wac_F8(m,this.urb,this.ua),r.qLa=2168883939,r)}
wac_2$c.prototype={Y7e:null,jEf:null,urb:null,qXe:null,O:function(){this.Y7e&&(this.Y7e.dispose(),this.Y7e=null);wac_71b.prototype.O.call(this)},Kyf:function(){this.VX.style.display="none";this.Ec.Sif=!0;this.qXe=wac_eH();this.qXe.className="mivView";var a=wac_Fad("mivKeepFocusStart"),b=document.createElement("iframe");b.className=b.id="mivFrame";var c=wac_Fad("mivKeepFocusEnd");this.qXe.appendChild(a);this.qXe.appendChild(b);this.qXe.appendChild(c);this.DS.appendChild(this.qXe);var d=this.ra.xc("IdeasMakeItVisualFocusId");
d.re="app";wac_Ej(this.oc,"IdeasMakeItVisualFocusId",b,!1);var e=this;wac_mk(d,function(){b.focus();var a,c=(a=new wac_tk(function(){return e.qXe}),a.Lna=!0,a);wac_wk(c,3);wac_wk(c,2);wac_wk(c,4);wac_wk(c,1);wac_wk(c,6);wac_wk(c,5);wac_cja(wac_Ie(),e.qXe,d,c);a=wac_Ie().ufb("IdeasMakeItVisualFocusId");wac_rk(a);a.EM=!0;a.Ola=!0;wac_jk(d,wac_Ie().rra);wac_jk(d,wac_Ie().sra);c.Ch(b)});this.ra.ff("IdeasMakeItVisualFocusId",!1);this.Bn.xa(this.qXe,"keydown",this.Y3)},CM:function(a){9===a.keyCode&&("mivKeepFocusEnd"!==
a.target.id||a.shiftKey?"mivKeepFocusStart"===a.target.id&&a.shiftKey&&wac_Gad(a,"mivKeepFocusEnd"):wac_Gad(a,"mivKeepFocusStart"))},kyf:function(a){switch(a.className){case "mivContainer":return wac_h5c.isInstanceOfType(this.Se)&&wac_3$c(this.Se,1),!0;case "mivOverlayContainer":a=a.querySelector(".mivTerm").innerText;break;case "mivTerm":a=a.innerText;break;case "mivIcon":a=a.parentNode.querySelector(".mivTerm").innerText;break;default:return!1}return wac_Had(this,a)},jyf:function(a){var b;if(Sys.UI.DomElement.containsCssClass(a,
"EditorPrevEnabled")||Sys.UI.DomElement.containsCssClass(a,"EditorNextEnabled")){if(Sys.UI.DomElement.containsCssClass(a,"EditorPrevEnabled")){var c;wac_jad(c=this.Ec,c.Gfc-1);this.Ec.Gfc||(Sys.UI.DomElement.removeCssClass(a,"EditorPrevEnabled"),Sys.UI.DomElement.addCssClass(a,"EditorPrevDisabled"));b=document.getElementById("EditorNext");Sys.UI.DomElement.removeCssClass(b,"EditorNextDisabled");Sys.UI.DomElement.addCssClass(b,"EditorNextEnabled")}else{var d;wac_jad(d=this.Ec,d.Gfc+1);this.Ec.Gfc===
this.Ec.vcc.length-1&&(Sys.UI.DomElement.removeCssClass(a,"EditorNextEnabled"),Sys.UI.DomElement.addCssClass(a,"EditorNextDisabled"));b=document.getElementById("EditorPrev");Sys.UI.DomElement.removeCssClass(b,"EditorPrevDisabled");Sys.UI.DomElement.addCssClass(b,"EditorPrevEnabled")}document.getElementById("EditorBucketCurrent").innerText=(this.Ec.Gfc+1).toString();wac_Iad(this,this.Ec.Gfc);b=!0}else if(Sys.UI.DomElement.containsCssClass(a,"EditorSuggestionContainer")||Sys.UI.DomElement.containsCssClass(a,
"EditorSuggestionArrow")||Sys.UI.DomElement.containsCssClass(a,"EditorSuggestionText")||Sys.UI.DomElement.containsCssClass(a,"EditorSuggestionInstances"))if(b=this.Ec.e0a,wac_km(this.Ec.vcc)||!b)b=!1;else{a=a.getAttribute("editorSuggestionIdx");if(c=document.querySelector('.EditorSuggestionArrow[editorSuggestionIdx="'+a+'"]'))c.innerText="\u2713",Sys.UI.DomElement.removeCssClass(c,"EditorSuggestionArrow"),Sys.UI.DomElement.addCssClass(c,"EditorSuggestionCheck");c=new (wac_e.$$(String,Number));d=this.Ec.vcc[this.Ec.Gfc].B1e;
for(var e=d.length,f=0;f<e;++f)c.ga(d[f].critiqueId,a);b.Jzf(c,3);b=this.Ec.jcf=!0}else if(Sys.UI.DomElement.containsCssClass(a,"EditorIgnore"))if(a=this.Ec.e0a){a.cbb(wac_Jad(this),4);this.Ec.vcc.splice(this.Ec.Gfc,1);this.Ec.Gfc===this.Ec.vcc.length&&wac_jad(b=this.Ec,b.Gfc-1);a=document.getElementById("EditorBucketTotal");b=window.parseInt(a.innerText);b--;if(0>=b){b=document.getElementById("EditorCardContent");a=wac_eH();a.className="EditorNoMoreContainer";c=new wac_MG;c.qh(40,40);wac_Soc(c,"0,0,2048,2048");
wac_IG(c,"EditorSvgCheck");d=new wac_UG;wac_vJ(d,"M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m -599 -783 l 72 -72 l 348 348 l 706 -706 l 72 72 l -778 779 z");
e=new wac_UG;wac_vJ(e,"M 1894 1024 q 0 120 -31 232 q -31 111 -87 208 q -57 96 -136 176 q -80 79 -176 136 q -97 56 -208 87 q -112 31 -232 31 q -120 0 -231 -31 q -112 -31 -208 -87 q -97 -57 -176 -136 q -80 -80 -136 -176 q -57 -97 -88 -208 q -31 -112 -31 -232 q 0 -120 31 -231 q 31 -112 88 -208 q 56 -97 136 -176 q 79 -80 176 -136 q 96 -57 208 -88 q 111 -31 231 -31 q 120 0 232 31 q 111 31 208 88 q 96 56 176 136 q 79 79 136 176 q 56 96 87 208 q 31 111 31 231 z");e.Oa.setAttribute("class","EditorWhiteCheck");
f=new wac_UG;wac_vJ(f,"M 1024 128 q 124 0 239 32 q 114 32 214 91 q 99 58 181 140 q 81 81 140 181 q 58 99 90 214 q 32 114 32 238 q 0 124 -32 239 q -32 114 -90 214 q -59 99 -140 181 q -82 81 -181 140 q -100 58 -214 90 q -115 32 -239 32 q -124 0 -238 -32 q -115 -32 -214 -90 q -100 -59 -181 -140 q -82 -82 -140 -181 q -59 -100 -91 -214 q -32 -115 -32 -239 q 0 -124 32 -238 q 32 -115 91 -214 q 58 -100 140 -181 q 81 -82 181 -140 q 99 -59 214 -91 q 114 -32 238 -32 m 599 625 l -72 -72 l -706 706 l -348 -348 l -72 72 l 420 421 z");
f.Oa.setAttribute("class","EditorGreenFill");var g=new wac_UG;wac_vJ(g,"M 1024 102 q 127 0 245 33 q 118 33 221 93 q 102 60 186 144 q 84 84 144 187 q 60 102 93 220 q 33 118 33 245 q 0 127 -33 245 q -33 118 -93 221 q -60 102 -144 186 q -84 84 -186 144 q -103 60 -221 93 q -118 33 -245 33 q -127 0 -245 -33 q -118 -33 -220 -93 q -103 -60 -187 -144 q -84 -84 -144 -186 q -60 -103 -93 -221 q -33 -118 -33 -245 q 0 -127 33 -245 q 33 -118 93 -220 q 60 -103 144 -187 q 84 -84 187 -144 q 102 -60 220 -93 q 118 -33 245 -33 m 0 1792 q 120 0 232 -31 q 111 -31 208 -87 q 96 -57 176 -136 q 79 -80 136 -176 q 56 -97 87 -208 q 31 -112 31 -232 q 0 -120 -31 -231 q -31 -112 -87 -208 q -57 -97 -136 -176 q -80 -80 -176 -136 q -97 -57 -208 -88 q -112 -31 -232 -31 q -120 0 -231 31 q -112 31 -208 88 q -97 56 -176 136 q -80 79 -136 176 q -57 96 -88 208 q -31 111 -31 231 q 0 120 31 232 q 31 111 88 208 q 56 96 136 176 q 79 79 176 136 q 96 56 208 87 q 111 31 231 31 m 672 -1141 l -851 851 l -493 -493 l 145 -144 l 348 347 l 706 -706 m -706 924 l 778 -779 l -72 -72 l -706 706 l -348 -348 l -72 72 z");
g.Oa.setAttribute("class","EditorGreenBorder");c.Ce(d);c.Ce(e);c.Ce(f);c.Ce(g);d=wac_fH();d.innerText=ResourceStrings.l_ConsistencyCardNoMore;d.className="EditorNoMoreLabel";a.appendChild(c.Oa);a.appendChild(d);b.parentNode.replaceChild(a,b)}else a.innerText=b.toString(),wac_Iad(this,this.Ec.Gfc),a=this.Ec.Gfc===this.Ec.vcc.length-1,c=document.getElementById("EditorNext"),1<b&&!a?(Sys.UI.DomElement.addCssClass(c,"EditorNextEnabled"),Sys.UI.DomElement.removeCssClass(c,"EditorNextDisabled")):(Sys.UI.DomElement.addCssClass(c,
"EditorNextDisabled"),Sys.UI.DomElement.removeCssClass(c,"EditorNextEnabled")),a&&(document.getElementById("EditorBucketCurrent").innerText=b.toString()),a=document.getElementById("EditorPrev"),1<b&&this.Ec.Gfc?(Sys.UI.DomElement.addCssClass(a,"EditorPrevEnabled"),Sys.UI.DomElement.removeCssClass(a,"EditorPrevDisabled")):(Sys.UI.DomElement.addCssClass(a,"EditorPrevDisabled"),Sys.UI.DomElement.removeCssClass(a,"EditorPrevEnabled"));b=!0}else b=!1;else Sys.UI.DomElement.containsCssClass(a,"EditorSeeMoreLabel")?
(this.U.yw(1625372200,2,null),this.Se.tr(!1,"OpenEditorPane"),b=this.Ec.buf=!0):b=!1;return b},lkf:function(a){var b=this.Ec.e0a;if(!b||wac_km(this.Ec.vcc))return!1;for(a=wac__ka(a);a&&"EditorContainer"!==a.className;)a=a.parentNode;a&&"EditorContainer"===a.className?b.Mdf(wac_Jad(this),2):b.Mdf([],2);return!0}};
function wac_Iad(a,b){var c=a.Ec.vcc[b].B1e[0].explanationLabel;document.getElementById("EditorSubtitle").innerText=c;var c=document.getElementById("EditorSuggestionsContainer"),d=wac_xad();c.parentNode.replaceChild(d,c);wac_Aad(a.WX,d,b)}function wac_Jad(a){var b=[];a=a.Ec.vcc[a.Ec.Gfc].B1e;for(var c=a.length,d=0;d<c;++d)b.push(a[d].critiqueId);return b}
function wac_Had(a,b){wac_47(a,6);var c=wac_Nf(a.ua.xvd).toString(),c=String.format(a.ua.Vlc,wac_.vh,wac_nm(wac_.vh)._name,wac_.jv,wac_5k().toString(),3,c),c=c.replace(/&amp;/g,"&").replace(/&p=3/,"&p=6")+"&q="+b;b=document.getElementById("mivFrame");b.setAttribute("src",c);b.style.visibility="visible";a.Y7e=(new wac_mRb).IG(b.contentWindow,c);wac_b5(a.Y7e,"AddItem",function(b){if(b=wac_x8c(b)){var c=[];Array.add(c,b);a.ua.jwd?a.U.yw(3099667173,2,null):a.U.yw(2503038014,2,null);a.Se.tr(!1,"CloseSecondPane");
a.jEf.uya(c)}});wac_b5(a.Y7e,"ClosePane",function(){wac_47(a,3);var b=a.Ec.oqa()?a.Ec.oqa().SlideSuggestions.length:0;wac__$c(a.WX,a.Ec.oqa(),b,a.Ec.kud.length,a.Ec.Nd,wac_Z1b(a),!0,a.I3e())});return!0}function wac_Gad(a,b){a.preventDefault();a.stopPropagation();(a=document.getElementById(b))&&a.focus()}
function wac_Fad(a){var b=document.createElement("div");b.setAttribute("Id",a);b.setAttribute("tabindex",0);b.setAttribute("position","absolute");b.setAttribute("width","-1000px");b.setAttribute("top","-1000px");return b}function wac_Kad(){}wac_Kad.prototype={rEc:0,UDc:0,Image:null};function wac_Lad(){this.eJa=Function.createDelegate(this,this.BPa)}
wac_Lad.prototype={NX:null,RY:null,Hu:function(){return"ImageToTableALWorkflow"},sob:function(){if(!this.NX){var a;this.NX=(a=new wac_5Y,a.kA="LambdaBefore_ImageToTableAL",a.Aka="ImageToTableTile",a.Qka="ImageToTable.Request",a.vka=this.eJa,a)}return this.NX},dpb:function(){if(!this.RY){var a;this.RY=(a=new wac_5Y,a.kA="LambdaRemote_ImageToTableAL",a.Aka="ImageToTable.Request",a.Qka="ImageToTable.Response",a.vka=null,a)}return this.RY},BPa:function(a,b,c){var d;a=(d=new wac_Y$c,d.image=a.Image,d);
c(a)}};function wac_b2b(){this.Hqa=!!wac_r()&&!!wac_r().Hd()&&wac_r().Hd().vqb()}
wac_b2b.prototype={J:null,uD:!1,Ub:function(){return"PowerPointWebEditor.Designer"},gc:function(a){this.J=a;var b=this;wac_m(wac_n(this.J.fa(wac__7)),function(){return new wac_71b(b.J.H(wac_Ts),b.J.H(wac_Z7),b.J.H(wac_07),b.J.H(wac_X7),b.J.H(wac_3nc),b.J.H(wac_Xs),b.J.H(wac_zG),b.J.H(wac_8c),b.J.H(wac_cd),b.J.H(wac_PF),b.J.H(wac_Oc),b.J.H(wac_Qt),b.J.H(wac_R),b.J.H(wac_sb))});var c=this;wac_m(wac_n(this.J.fa(wac_i5c)),function(){return new wac_2$c(c.J.H(wac_Ts),c.J.H(wac_h5c),c.J.H(wac_07),c.J.H(wac_X7),
c.J.H(wac_3nc),c.J.H(wac_Xs),c.J.H(wac_zG),c.J.H(wac_8c),c.J.H(wac_cd),c.J.H(wac_PF),c.J.H(wac_Oc),c.J.H(wac_Qt),c.J.H(wac_R),c.J.H(wac_sb))});var d=this;wac_m(wac_n(this.J.fa(wac_h5c)),function(){return new wac_Ead(d.J.H(wac_lr),d.J.H(wac_5F),d.J.H(wac_8c),d.J.H(wac_PF),d.J.H(wac_Oc),d.J.H(wac_X7),d.J.H(wac_JL),d.J.H(wac_fG),d.J.H(wac_jG),d.J.H(wac_mG),d.J.H(wac_zG),d.J.H(wac_R),d.J.H(wac_Tt),d.J.H(wac_BI))});var e=this;wac_m(wac_n(this.J.fa(wac_Z7)),function(){return new wac_51b(e.J.H(wac_lr),e.J.H(wac_5F),
e.J.H(wac_8c),e.J.H(wac_PF),e.J.H(wac_Oc),e.J.H(wac_X7),e.J.H(wac_JL),e.J.H(wac_fG),e.J.H(wac_jG),e.J.H(wac_mG),e.J.H(wac_zG),e.J.H(wac_R),e.J.H(wac_Tt),e.J.H(wac_BI),"DesignerPane",ResourceStrings.L_Designer)});var f=this;wac_m(wac_n(this.J.fa(wac_07)),function(){return new wac_a2b(f.J.H(wac_Nt),f.J.H(wac_Mt),f.J.H(wac_R),f.J.H(wac_X7),f.J.H(wac_dd),f.J.H(wac_5F))});var g=this;wac_m(wac_n(this.J.fa(wac_Y7)),function(){return new wac_X1b(g.J.H(wac_i5c),g.J.H(wac__7),g.J.H(wac_07),g.J.H(wac_X7),g.J.H(wac_R),
g.J.H(wac_Oc),g.J.H(wac_Nt),g.J.H(wac_dI),g.J.H(wac_NL),g.J.H(wac_zG),wac_l(g.J,wac_AY),wac_l(g.J,wac_zY),wac_l(g.J,wac_Dc))});var h=this;wac_m(wac_n(this.J.fa(wac_3nc)),function(){return new wac_8nc(h.J.H(wac_9G),h.J.H(wac_eK))});var k=this;wac_m(wac_n(this.J.fa(wac_X7)),function(){return new wac_W1b(wac_l(k.J,wac_AY))});var l=this;wac_m(wac_n(this.J.fa(wac_Q3c)),function(){return new wac_Mad(l.J.H(wac_Oc),l.J.H(wac_R))});if(this.uD=this.J.H(wac_3L).Ta.Fo){var m=this;wac_m(wac_n(this.J.fa(wac_WF)),
function(){return new wac_WF(wac_.Af,m.J.H(wac_VF),m.J.H(wac_fG),m.J.H(wac_jG),m.J.H(wac_NF),m.J.H(wac_dd),m.J.H(wac_Uc))})}var n=this;wac_m(wac_n(this.J.fa(wac_Nad)),function(){return new wac_Nad(n.J.H(wac_Oc),n.J.H(wac_Jt),n.J.H(wac_It),n.J.H(wac_Nt),n.J.H(wac_NL),n.J.H(wac_aY),n.J.H(wac_i8),n.J.H(wac_Mt),n.J.H(wac_Lt),n.J.H(wac_GH),wac_l(n.J,wac_3Y),wac_l(n.J,wac_9L),n.J.H(wac_h5c),n.J.H(wac_Z7),n.J.H(wac_R))})},tb:function(){var a=this.J.H(wac_Uc),b=this;a.Ok(function(){if(wac_q(a,wac_2(248))){b.uD&&
b.J.H(wac_WF);var c=b.J.H(wac__7),d=wac_j().H(wac_Z7).$c();c.j5(d);c.rbb();b.Hqa||b.J.H(wac_tL).dC(b.J.H(wac_Z7));c=b.J.H(wac_i5c);d=wac_j().H(wac_h5c).$c();c.j5(d);c.rbb();b.Hqa||b.J.H(wac_tL).dC(b.J.H(wac_h5c));c=null;if(wac_q(a,wac_2(1034))&&(c=b.J.H(wac_y2c))){var d=wac_0i(a,wac_2(1043)),e=wac_0i(a,wac_2(1035)),f=new Date;c.b4e(d,e).then(function(a){var b=new Date-f;a.IsSuccess?wac_Y(51475615,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Latency: "+b):(wac_Y(42324822,829,15,
"PPTWebEditorDesignerPackage::Init Failed to get AAD token with error: "+a.ErrorCode+": "+a.ErrorMessage),wac_Y(51475618,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+b))}).catch(function(a){wac_Y(51475648,829,50,"PPTWebEditorDesignerPackage::Init Designer Authentication Failed Latency: "+(new Date-f));wac_Y(42324824,829,15,"PPTWebEditorDesignerPackage::Init - Token retrival failed:{0}",a)})}c=new wac_Q1b(b.J.H(wac_Oc),b.J.H(wac_Jt),b.J.H(wac_dI),b.J.H(wac_It),
b.J.H(wac_zG),b.J.H(wac_Z7),b.J.H(wac_h5c),b.J.H(wac__7),b.J.H(wac_i5c),b.J.H(wac_07),b.J.H(wac_Y7),b.J.H(wac_X7),b.J.H(wac_Nt),b.J.H(wac_3H),b.J.H(wac_NL),b.J.H(wac_MY),b.J.H(wac_R),b.J.H(wac_aY),b.J.H(wac_RY),b.J.H(wac_AJ),b.J.H(wac_KL),b.J.H(wac_fG),b.J.H(wac_dd),b.J.H(wac_jY),b.J.H(wac_Q3c),b.J.H(wac_sb),wac_l(b.J,wac_zfc),c);c.Tb();c.Lf();b.J.H(wac_R).Lde&&b.J.H(wac_3nc).Kn();b.J.H(wac_Nad).Yd()}else wac_Y(37041294,829,50,"Designer setting is disabled")})},O:function(){this.J.H(wac_R).Lde&&this.J.H(wac_3nc).O();
this.J.H(wac_Nad).O()}};
function wac_tad(a,b){this.Esf=Function.createDelegate(this,this.pSf);this.$Ia=Function.createDelegate(this,this.sl);this.UEf=b;this.oc=a;this.W2e=wac_eH();this.W2e.className="GoPremiumCalloutContainer";a=document.createElement("i");a.className="ms-Icon ms-Icon--Diamond";this.W2e.appendChild(a);a=wac_eH();a.className="GoPremiumTitle";a.innerText=ResourceStrings.l_DesignerUpsellCalloutTitle;this.W2e.appendChild(a);a=wac_eH();a.className="GoPremiumSubtitle";a.innerText=ResourceStrings.l_DesignerUpsellCalloutContent;this.W2e.appendChild(a);
this.V4e=wac_eH();this.V4e.className="GoPremiumButton";this.V4e.innerText=ResourceStrings.l_DesignerUpsellGoPremiumText;this.W2e.appendChild(this.V4e);this.JQ()}
wac_tad.prototype={ota:null,V4e:null,W2e:null,X7e:null,oc:null,UEf:null,Ki:function(a,b,c){this.ota&&this.ota.y1&&this.sl();(this.X7e=c)&&Sys.UI.DomElement.addCssClass(this.X7e,"DiamondIconHighlighted");this.ota=new wac_MP(a,b,wac_r().Dha(),this.$Ia);this.ota.ZP=325;this.ota.hkc=this.W2e;b=new Sys.UI.Bounds(0,0,wac_lP(),wac_b4a());c=6;240>a.y-b.y&&(c=3);this.ota.HL=c;this.ota.zua(!0);this.ota.Ki();wac_7Ac(this.ota)},sl:function(){this.X7e&&(Sys.UI.DomElement.removeCssClass(this.X7e,"DiamondIconHighlighted"),
this.X7e=null);this.ota&&(this.ota.sl(),this.ota.dispose(),this.ota=null)},O:function(){this.sl();this.Iea();this.W2e=this.V4e=null},pSf:function(){this.UEf();return!0},JQ:function(){this.oc?this.oc.ya("click",this.V4e,this.Esf):wac_Y(594031904,829,50,"PremiumContentCallout::RegisterEvents ClickInputManager or KeyInputManager is null. Couldn't register events on the goPremiumButton")},Iea:function(){this.oc&&this.oc.ub("click",this.V4e,this.Esf)}};function wac_Oad(){}
wac_Oad.prototype={Bxf:0,rx:0,Ixf:null};function wac_Pad(){}wac_Pad.prototype={xxf:!1,wxf:!1,D3e:null,Zxf:0,ouf:!1,L5e:null};
function wac_Nad(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r){this.Ese=Function.createDelegate(this,this.vve);this.odc=Function.createDelegate(this,this.iMd);this.AHf=Function.createDelegate(this,this.jPf);this.Bsf=Function.createDelegate(this,this.jSf);this.ltf=Function.createDelegate(this,this.uTf);this.qsf=Function.createDelegate(this,this.JPf);this.msf=Function.createDelegate(this,this.XOf);this.U=a;this.Xb=c;this.Ea=d;this.Ib=b;this.Qg=e;this.kf=f;this.zi=g;this.Pb=h;this.za=k;this.Bo=l;this.opf=m;this.Ad=
n;this.Urb=p;this.Se=q;this.Ta=r;this.Cjb=null}
wac_Nad.prototype={U:null,Xb:null,Ea:null,Ib:null,Qg:null,kf:null,zi:null,Pb:null,za:null,Bo:null,opf:null,Ad:null,Urb:null,Se:null,Ta:null,Cjb:null,Yd:function(){this.U.ja(3560393150,1,this.msf);this.U.ja(319102301,1,this.qsf);this.Qg.la.xa("SAC",this.ltf);var a=this;this.Ad.uc(function(b){b.t8d(a.Bsf)});var b=this;this.opf.uc(function(a){var d=new wac_Lad;a.peb(d.Hu(),d.sob(),d.dpb(),null);a.d5("ImageToTable.Response",b.AHf)});try{window.addEventListener?window.addEventListener("message",this.odc,
!1):-1<window.navigator.userAgent.indexOf("MSIE")&&window.attachEvent?window.attachEvent("onmessage",this.odc):wac_Y(594125059,375,10,"[SuggestedActionsHandler::Initialize] Failed to subscribe to onmessage event of window")}catch(c){wac_Y(594125057,375,10,"[SuggestedActionsHandler::Initialize] Failed to subscribe to onmessage event of window with exception, message: {0}, stack: {1}",c.message,c.stack)}},O:function(){this.U.w3d(3560393150,1,this.msf);this.U.w3d(319102301,1,this.qsf);this.Qg.la.sb("SAC",
this.ltf);var a=this;this.Ad.uc(function(b){b.dYf(a.Bsf)})},iMd:function(a){if(this.yie(a.origin)){var b,c,d;if((d=wac_dP(Object,a.data,c={val:b}),b=c.val,d)&&b&&(a=window.$$as(Object,b),"."===a.imageToTablePaneWildcard))if("ACK"===a.cmd_type)wac_Y(594125027,375,15,"[SuggestedActionsHandler::MessageReceivedHandler] ACK message received.",a.cmd_type);else if("cancel"===a.cmd_type)wac_Y(594125025,375,15,"[SuggestedActionsHandler::MessageReceivedHandler] Cancel message received.",a.cmd_type),wac_Qad(this);
else if("insert_html"===a.cmd_type){wac_Y(594125023,375,15,"[SuggestedActionsHandler::MessageReceivedHandler] Insert message received.",a.cmd_type);var e;a=(e=new wac_Oad,e.Bxf=this.Cjb.D3e.rEc,e.rx=this.Cjb.D3e.UDc,e.Ixf=atob(a.parameters),e);wac_Qad(this);this.U.Wj(319102301,2,a,null)}else wac_Y(594125021,375,15,"[SuggestedActionsHandler::MessageReceivedHandler] Unknown message received. Message type: {0}",a.cmd_type)}},uTf:function(a,b){if(a=b.Otf){b=[];for(var c=wac_uJ(this.Ea.Ja()),d=c.length,
e=0;e<d;++e)for(var f=c[e],g=a.Selects,h=g.length,k=0;k<h;++k)if(g[k].Id===f.Yc()){Array.add(b,f);break}wac_zM(this.Xb);wac_GL(this.Xb);wac_t0a(this.Xb,b,!0);this.U.yw(wac_Pka(a.ExecutionActionName),2,null)}},XOf:function(){var a=new wac_Pad;this.Cjb=a;var b=wac_5M(this.Xb);if(1!==b.length)return 8;var c=b[0],b=wac_Rad(this);if(32!==b)return wac_Y(594125019,375,15,"[SuggestedActionsHandler::HandleConvertImageToTable] Failed to open the taskpane. Response: {0}",b),8;this.Urb.If()&&(a.xxf=!0,this.Urb.tr(!1,
"OpenImageToTablePane"));this.Se.If()&&(a.wxf=!0,this.Se.tr(!1,"OpenImageToTablePane"));var d=this,e=this;wac_A6c(this.kf,c.Za(Number,wac_iq),wac_1Nc(c),c.Yc(),function(b){wac_Sad(d,a,c,b)},function(){wac_Tad(e,"Failed to render the image shape");return!0});return 32},jPf:function(a,b,c,d){this.Cjb&&this.Cjb.D3e===b&&(window.clearTimeout(this.Cjb.Zxf),this.Cjb.ouf||(wac_Y(594125017,829,50,"ImageToTable AL Results received. ProcessId: {0}, ErrorCode: {1}, ErrorDescription: {2}",d.processId,d.errorCode,
d.errorDescription),d.errorCode?wac_Tad(this,"Failed to convert image to table"):(a=b.Image,b=wac_Uad(),b.tableHtml=btoa(d.html),b.imageData=a,wac_Vad(this,b))))},vve:function(){var a;(a=(a=this.Ad.Ga().jma("FA000000050"))?a.Xm:null)?(this.Cjb.L5e=a,wac_Y(594125011,375,50,"[ImageToTablePane] Taskpane rendered. InstanceId = {0}",a)):wac_Y(594125013,375,50,"[ImageToTablePane] Failed to find the taskpane")},JPf:function(a,b,c,d,e){a=wac_rRa(this.Pb,e.Bxf);if(!a)return 8;b=wac_fO(a,e.rx);if(!b)return 8;
c=wac_70(a)+1;e=wac_cgc(this.Bo,!1,a.fe(),a.Vc(),wac_6Nc(b),wac_7Nc(b),wac_3zc(b),wac_OQc(b),c,e.Ixf,"");wac_P8(this.zi,[e],a,0,null,b,!0);this.Ib.Ns(a,"ImageToTable");return 32},jSf:function(a,b){b&&this.Cjb&&b.zUc===this.Cjb.L5e&&(this.Cjb.xxf&&!this.Urb.If()?this.U.Wj(2034521264,2,!1,null):this.Cjb.wxf&&!this.Se.If()&&this.U.yw(2503038014,2,null),this.Cjb=null)},yie:function(a){return a&&a.length&&"null"!==a?this.Ta.Hcf&&0<this.Ta.Hcf.length&&"https://localhost:3000"===a?!0:a===this.Ta.xvf:!1}};
function wac_Uad(){return{imageToTablePaneWildcard:"."}}function wac_Qad(a){a.Cjb&&a.Cjb.L5e&&a.U.Wj(2755471162,2,a.Cjb.L5e,null)}function wac_Rad(a){var b={mRb:"Image to Table",jca:"FA000000050"};b.Goe=a.Ese;b.RMd={};b.twe=!0;b.Rfb=a.Ta.Hcf;return a.U.Wj(2123786558,2,b,null)}
function wac_Vad(a,b){a.Cjb&&a.Cjb.L5e&&window.OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(a.Cjb.L5e,"onCustomMessage",b,function(a){a&&wac_Y(594125015,375,15,"Couldn't deliver the message to ImageToDoc pane, status: {0}.",a)})}function wac_Tad(a,b){var c=wac_Uad();c.errorMessage=b;wac_Vad(a,c)}
function wac_Sad(a,b,c,d){var e;b.D3e=(e=new wac_Kad,e.rEc=wac_1Nc(c),e.UDc=c.Yc(),e.Image=d.ImgData,e);a.opf.uc(function(a){a.Xfb("ImageToTableTile",b.D3e)});b.Zxf=window.setTimeout(function(){a.Cjb&&a.Cjb.D3e===b.D3e&&(a.Cjb.ouf=!0,wac_Tad(a,"Failed to convert image to table using AL"))},a.Ta.wvf)}Type.registerNamespace("PowerPointWebEditor.Infrared");wac_Z.EJd=wac_Z.EJd||{};wac_Z.EJd.Iyf=function(){};wac_Z.EJd.Iyf.prototype={};
wac_Z.EJd.Iyf.registerEnum("PowerPointWebEditor.Infrared.IdeasCardType",!1);wac_Z.EJd.Hyf=function(){};wac_Z.EJd.Hyf.prototype={};wac_Z.EJd.Hyf.registerEnum("PowerPointWebEditor.Infrared.IdeasCardAction",!1);function wac_Q3c(){}wac_Q3c.registerInterface("PowerPointWebEditor.Infrared.IIdeasContext");
function wac_Mad(a,b){this.Thf=Function.createDelegate(this,this.ePf);this.Uhf=Function.createDelegate(this,this.iPf);this.nsf=Function.createDelegate(this,this.fPf);this.yHf=Function.createDelegate(this,this.gPf);this.zHf=Function.createDelegate(this,this.hPf);this.U=a;this.ua=b;this.U.ja(1068159161,1,this.zHf);this.U.ja(206151992,1,this.yHf);this.U.ja(1724554274,1,this.nsf);this.U.ja(2857549322,1,this.Uhf);this.U.ja(4031196440,1,this.Uhf);this.U.ja(2760733910,1,this.Thf);this.U.ja(369327638,1,this.nsf);
this.U.ja(1658089342,1,this.Uhf);this.U.ja(2924806476,1,this.Thf);this.U.ja(2740350877,1,this.Thf)}
wac_Mad.prototype={U:null,ua:null,OXf:null,Laa:null,fGe:null,gbf:!1,hPf:function(){if(!this.ua.N0e)return 2;this.gbf=!0;if(!(this.fGe&&0<this.fGe.na())){var a=wac_5k();this.ua.N0e&&(this.OXf=a,this.Laa="ToolbarButtonHome",this.fGe=new (wac_sa.$$(wac_fb))(null))}return 32},gPf:function(){if(!this.ua.N0e)return 2;this.gbf=!1;return 32},fPf:function(a){if(!this.ua.N0e)return 2;a=wac_Wad(a);this.gbf&&3!==a&&this.fGe&&this.fGe.ga(new wac_fb(a,1));return 32},iPf:function(a){if(!this.ua.N0e)return 2;this.uef(wac_Wad(a));
return 32},ePf:function(a){if(!this.ua.N0e)return 2;a=wac_Wad(a);this.gbf&&3!==a&&this.fGe&&this.fGe.ga(new wac_fb(a,2));return 32},uef:function(a){this.ua.N0e&&this.gbf&&3!==a&&this.fGe&&!wac_D6c(this.fGe,function(b){return b.rh()===a})&&this.fGe.ga(new wac_fb(a,0))}};function wac_Wad(a){switch(a){case 1724554274:case 2857549322:case 2924806476:a=0;break;case 4031196440:case 2760733910:a=1;break;case 369327638:case 1658089342:case 2740350877:a=2;break;default:a=3}return a}wac_Y$c.registerClass("PowerPointWebEditor.Designer.ImageToTableRequest");
(function(){}).registerClass("PowerPointWebEditor.Designer.ImageToTableResponse");(function(){}).registerClass("PowerPointWebEditor.Designer.Message");(function(){}).registerClass("PowerPointWebEditor.Designer.MessageEventArgs");wac_Q1b.registerClass("PowerPointWebEditor.Designer.DesignerActor");wac_6Gc.registerClass("PowerPointWebEditor.Designer.RequestState");wac_SGc.registerClass("PowerPointWebEditor.Designer.PendingRequest");wac_2Gc.registerClass("PowerPointWebEditor.Designer.DesignerRequestData");
wac_W1b.registerClass("PowerPointWebEditor.Designer.DesignerContext",null,wac_X7);wac_$$c.registerClass("PowerPointWebEditor.Designer.BucketedEditorData");wac_X1b.registerClass("PowerPointWebEditor.Designer.DesignerManager",null,wac_Y7,Sys.IDisposable);wac_51b.registerClass("PowerPointWebEditor.Designer.DesignerPane",null,wac_Z7,wac_AG,Sys.IDisposable);wac_8nc.registerClass("PowerPointWebEditor.Designer.DesignerPreviewImageView",null,wac_3nc);wac_sad.registerClass("PowerPointWebEditor.Designer.DesignerStateManager");
wac_71b.registerClass("PowerPointWebEditor.Designer.DesignerView",wac_CA,wac__7,wac_qs,wac_us,Sys.IDisposable);wac_a2b.registerClass("PowerPointWebEditor.Designer.DesignerViewHelper",null,wac_07);wac_Ead.registerClass("PowerPointWebEditor.Designer.IdeasPane",wac_51b,wac_h5c,wac_Z7,wac_AG,Sys.IDisposable);(function(){}).registerClass("PowerPointWebEditor.Designer.IdeasPaneConstants");wac_2$c.registerClass("PowerPointWebEditor.Designer.IdeasView",wac_71b,wac_i5c,wac__7,wac_qs,wac_us,Sys.IDisposable);
wac_Kad.registerClass("PowerPointWebEditor.Designer.ImageToTableTile");wac_Lad.registerClass("PowerPointWebEditor.Designer.ImageToTableALWorkflow",null,wac_4Y);wac_b2b.registerClass("PowerPointWebEditor.Designer.PPTWebEditorDesignerPackage",null,wac_I,wac_i);wac_tad.registerClass("PowerPointWebEditor.Designer.PremiumContentCallout");wac_Oad.registerClass("PowerPointWebEditor.Designer.ReplaceImageWithHtmlTableData");wac_Pad.registerClass("PowerPointWebEditor.Designer.ImageToTableConversionContext");
wac_Nad.registerClass("PowerPointWebEditor.Designer.SuggestedActionsHandler");wac_Mad.registerClass("PowerPointWebEditor.Infrared.IdeasContext",null,wac_Q3c);var wac_Cad="Architecture Backgrounds Cities Nature People Technology".split(" ");wac_2$c.gOf=["EditorPrev","EditorNext","EditorSuggestionContainer","EditorIgnore","EditorSeeMoreLabel"];wac_J(wac_C(),wac_k4(new wac_b2b,0),0,!1);Type.registerNamespace("PowerPointWebEditor.Rehearsal");wac_Z=window.PowerPointWebEditor||{};wac_Z.NKa=wac_Z.NKa||{};
function wac_Xad(){}wac_Xad.registerInterface("PowerPointWebEditor.Rehearsal.IRehearsalSummaryPageActor");function wac_Yad(){}wac_Yad.registerInterface("PowerPointWebEditor.Rehearsal.IRehearsalManager");window.PowerPointWebEditor.Rehearsal.ICoachManager=wac_Z.NKa.wYf=function(){};window.PowerPointWebEditor.Rehearsal.ICoachManager.registerInterface("PowerPointWebEditor.Rehearsal.ICoachManager");window.PowerPointWebEditor.Rehearsal.ICoachActor=wac_Z.NKa.vYf=function(){};window.PowerPointWebEditor.Rehearsal.ICoachActor.registerInterface("PowerPointWebEditor.Rehearsal.ICoachActor");
function wac_Zad(){this.SB=Function.createDelegate(this,this.sC)}
wac_Zad.prototype={Ub:function(){return"PowerPointWebEditor.Rehearsal"},gc:function(a){this.J=a;var b=this;wac_n(wac_m(this.J.fa(wac_dIc),function(){return new wac_fIc(b.J.H(wac_hK),b.J.H(wac_QK),wac_Kt(b.J.H(wac_lt),7),wac_Kt(b.J.H(wac_lt),68),b.J.H(wac_3H))}));var c=this;wac_m(wac_n(this.J.fa(wac_Xad)),function(){return new wac__ad(wac_z(),c.J.H(wac_dIc),c.J.H(wac_wEa),c.J.H(wac_R),wac_l(c.J,wac_Dc))});this.J.H(wac_Xad).Tb();if(this.J.H(wac_R).ZZe){var d=this.J.H(wac_kG),e=this;wac_m(wac_n(this.J.fa(wac_Yad)),
function(){return new wac_0ad(wac_z(),d,e.J.H(wac_wEa),e.J.H(wac_l7),e.J.H(wac_Mt),e.J.H(wac_Lt),e.J.H(wac_FH),e.J.H(wac_VF),e.J.H(wac_R),wac_l(wac_j(),wac_GZc),wac_l(wac_j(),wac_pZc),wac_l(wac_j(),wac_Xad))});this.J.H(wac_Yad).Tb()}},tb:function(){wac_.pa.Ok(this.SB)},sC:function(){var a=this.J.H(wac_R).I5e;wac_1t("Microsoft.Office.Server.Powerpoint.Web.IPptRehearsalIsEnabledSettings");if(a){var b=this;wac_Zg(window.Common.App.AppLifecycleManager.get_instance(),7,function(){b.J.H(wac_Xad).u9e();
b.J.H(wac_R).ZZe&&b.J.H(wac_Yad).u9e()},3)}},O:function(){},J:null};function wac__ad(a,b,c,d,e){this.PKf=Function.createDelegate(this,this.Olf);this.ZKf=Function.createDelegate(this,this.sVf);this.U=a;this.lYc=new wac_1ad(b,this.U,d);this.Paf=c;this.eEe=e}
wac__ad.prototype={Tb:function(){this.U.ja(3890296866,1,this.ZKf);this.U.ja(1607456269,1,this.PKf)},oef:function(a,b){this.lYc.oef(a,b)},sVf:function(a,b,c,d,e){switch(c){case 2:return this.lYc.oef(e,null),32;case 1:if(this.G7e)return 32;break;default:wac_Y(41793168,822,10,"ShowSummaryPage: Unimplemented action behavior")}return 8},Olf:function(a,b,c){switch(c){case 2:return this.Olf(),32;case 1:if(this.G7e)return 32;break;default:wac_Y(42825479,822,10,"ShowFloodgateSurvey: Unimplemented action behavior")}return 8},
Olf:function(){this.eEe.uc(function(a){wac_nVc(a,"PPTRehearsePresentationSurvey","PowerPointRehearsePresentationSurveyEnabled")})},u9e:function(){var a=this;this.Paf.uje.MRd("rehearsalSummaryPage").then(function(){var b=wac_.pa.Qb.RehearsalSummaryPageCssUrl,c=document.createElement("link");c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",b);window.$addHandler(c,"load",function(){a.G7e=!0});document.body.appendChild(c);return null})},Paf:null,G7e:!1,U:null,
lYc:null,eEe:null};function wac_1ad(a,b,c){this.Osf=Function.createDelegate(this,this.HSf);this.SGa=a;this.U=b;this.ua=c}
wac_1ad.prototype={SGa:null,U:null,ua:null,oef:function(a,b){try{var c=document.createElement("div");c.id="SummaryPageOverlay";c.style.width="100%";c.style.height="100%";c.style.zIndex=850;c.style.display="flex";c.style.flexDirection="column";c.style.justifyContent="center";c.style.position="absolute";document.body.insertBefore(c,document.body.firstChild);var d=c.parentNode;wac_tf(d,"keydown",this.Osf);var e=a.thumbIndices;if(e){for(var f={},g=0,h=wac_2ad(this,e),k=0;k<e.length;k++)f[e[k].toString()]=
h[k],h[k]||g++;wac_Y(42320001,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: number of slide thumbs requested = {0}, number of slides not found in cache = {1}",e.length,g);a.slideImageSrcs=f}else a.slideImageSrcs={},wac_Y(594068941,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: no slide thumbs object from Rehearsal");e={};e.fFeedbackCardEnabled=this.ua.cwf;e.fMonotoneEnabled=this.ua.Lcf;e.fGrammarEnabled=this.ua.Dcf;var l=this,m=this,n=this;(new window.rehearsalSummaryPage.RehearsalSummaryPageController(c,
a,function(){wac_Y(51144073,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Try Again button clicked.");b&&b();l.U&&(c.parentNode.removeChild(c),l.U.Wj(1256345977,2,null,null))},function(){b&&b();wac_jg(d,"keydown",m.Osf)},this.ua.M4,window.decodeURIComponent(this.ua.H7a),function(){wac_3ad(n)},e)).renderSummaryPage();this.ua.Ouf&&wac_3ad(this)}catch(p){wac_Y(51144075,817,10,"RehearsalSummaryPageHelper::ShowRehearsalSummary Exception while generating summary page: {0}",p.toString())}},HSf:function(a){"MainApp"===
a.target.id&&(a.preventDefault(),a.stopPropagation())}};function wac_2ad(a,b){var c=Array(b.length);if(!a.SGa)return c;var d=a.SGa.tge();a=wac_hIc(a.SGa);for(var e=0;e<b.length;e++){var f=a[d[b[e]].Vc().toString()];f&&f.ePe.length&&(c[e]=f.ePe)}return c}function wac_3ad(a){wac_Y(51144077,817,50,"RehearsalSummaryPageHelper::ShowRehearsalSummary: Feedback button clicked.");a.U&&(a.ua.Hwf?a.U.Wj(1607456269,2,null,null):a.U.Wj(802602464,2,!1,null))}function wac_4$(){}
window.PowerPointWebEditor.Rehearsal.ISlideState=wac_Z.NKa.BQf=function(){};wac_Z.NKa.BQf.prototype={currentSlideIndex:0,totalSlideCount:0};window.PowerPointWebEditor.Rehearsal.IWebcamConfig=wac_Z.NKa.EQf=function(){};wac_Z.NKa.EQf.prototype={videoView:null,workingCanvas:null,numFramesPerSecond:0};window.PowerPointWebEditor.Rehearsal.ICoachActorConfig=wac_Z.NKa.gQf=function(){};wac_Z.NKa.gQf.prototype={rootContainer:null,slideState:null,imagesBaseFilePath:null,zIndex:0,fEnableVision:!1,fShowRealtimeFeedbackEnabledCheckbox:!1};
window.PowerPointWebEditor.Rehearsal.IDocumentDownloadConfig=wac_Z.NKa.Ckf=function(){};wac_Z.NKa.Ckf.prototype={userDataCenterClusterId:null,webServiceBase:null,podsSessionId:null,docId:null};window.PowerPointWebEditor.Rehearsal.ICoachSessionConfig=wac_Z.NKa.iQf=function(){};wac_Z.NKa.iQf.prototype={logger:null,disabledCoachRealtimeFeatures:null,userSessionId:null,documentDownloadConfig:null,requestedCoachFeatures:null,customSettings:null,fEnableVision:!1,webcamConfig:null,speechFDBase:null};
window.PowerPointWebEditor.Rehearsal.IFillerData=wac_Z.NKa.mQf=function(){};wac_Z.NKa.mQf.prototype={filler:null,count:0};window.PowerPointWebEditor.Rehearsal.ISensitivePhrasesData=wac_Z.NKa.zQf=function(){};wac_Z.NKa.zQf.prototype={phrase:null,count:0};window.PowerPointWebEditor.Rehearsal.IPaceData=wac_Z.NKa.uQf=function(){};wac_Z.NKa.uQf.prototype={pace:0,timePoint:0};window.PowerPointWebEditor.Rehearsal.IMonotoneData=wac_Z.NKa.tQf=function(){};wac_Z.NKa.tQf.prototype={pvq:0,timePoint:0,slide:0};
window.PowerPointWebEditor.Rehearsal.ICoachSummaryData=wac_Z.NKa.jQf=function(){};wac_Z.NKa.jQf.prototype={fillers:null,sensitivePhrases:null,sensitivePhrasesCorrected:null,originalityProblemSlides:null,timeSpentInSeconds:0,averageWPMPace:0,paceOverTime:null,monotoneOverTime:null,slidesRehearsed:0};window.PowerPointWebEditor.Rehearsal.IQualityStatusInfo=wac_Z.NKa.xQf=function(){};wac_Z.NKa.xQf.prototype={severity:0,priority:0,shortCode:0,longCode:0,shortString:null,longString:null};
window.PowerPointWebEditor.Rehearsal.IFeatureInfo=wac_Z.NKa.kQf=function(){};wac_Z.NKa.kQf.prototype={featureValue:null,featureTemplate:null,templateInfo:null};window.PowerPointWebEditor.Rehearsal.ICoachRealtimeInfo=wac_Z.NKa.hQf=function(){};wac_Z.NKa.hQf.prototype={features:null,currentSlideIndex:0};window.PowerPointWebEditor.Rehearsal.IMediaEventInfo=wac_Z.NKa.sQf=function(){};wac_Z.NKa.sQf.prototype={mediaStatus:null};window.PowerPointWebEditor.Rehearsal.IRealTimeCritique=wac_Z.NKa.yQf=function(){};
wac_Z.NKa.yQf.prototype={currentSlideIndex:0,featureName:null,featureInfo:null};
function wac_0ad(a,b,c,d,e,f,g,h,k,l,m,n){this.ELf=Function.createDelegate(this,this.CXf);this.FLf=Function.createDelegate(this,this.mYf);this.Y3=Function.createDelegate(this,this.CM);this.Ogc=Function.createDelegate(this,this.sNb);this.Kgc=Function.createDelegate(this,this.vUd);this.u8e=Function.createDelegate(this,this.jlf);this.gtf=Function.createDelegate(this,this.oTf);this.bLf=Function.createDelegate(this,this.zVf);this.kFf=-1;this.Paf=c;b&&(this.NWe=b.lC());this.ob=d;this.U=a;this.Cc=e;this.za=
f;this.Ca=g;this.hb=h;this.ua=k;this.X0=l;this.K7e=m;this.oFf=n}
wac_0ad.prototype={Paf:null,ob:null,G7e:!1,U:null,NWe:null,lNc:null,Cc:null,za:null,Ca:null,hb:null,ua:null,X0:null,E6a:null,kbf:0,tbf:0,K7e:null,oFf:null,Jrf:null,Mrf:null,Zpf:!1,eqf:!1,une:0,Tb:function(){this.U.ja(3076808240,1,this.bLf)},zVf:function(a,b,c){switch(c){case 2:return wac_4$.V3e[2]=ResourceStrings.L_SubtitleDetection_AudioQualityIssue,wac_4$.V3e[3]=ResourceStrings.L_SubtitleDetection_HighBackgroundNoise,wac_4$.V3e[4]=ResourceStrings.L_SubtitleDetection_SpeakingTooLoud,wac_4$.V3e[5]=
ResourceStrings.L_SubtitleDetection_SpeakingTooQuiet,wac_4$.pyf=ResourceStrings.L_SubtitleDetection_MicReady,wac_4$.qyf=ResourceStrings.L_SubtitleDetection_SoundReminder,wac_4$.tyf=ResourceStrings.L_SubtitleDetection_NoMicrophone,wac_4$.yyf=ResourceStrings.L_SpeechGenericRetryErrorMessage,this.ob.m7e(this.gtf),this.ob.WTe(this.u8e),this.ob.EEa(this.Kgc),this.ob.n7e(this.Ogc),a=new window.PowerPointWebEditor.Rehearsal.ISlideState,b=new window.UlsExternalLogger,c=(c=wac_GI(this.Ca.Ja()))?this.za.ov(wac_rRa(this.Cc,
c.Vc())):0,a.currentSlideIndex=c,a.totalSlideCount=wac_II(this.Cc),c=new window.PowerPointWebEditor.Rehearsal.ICoachActorConfig,c.rootContainer=this.NWe,c.slideState=a,c.imagesBaseFilePath=wac_.pa.Qb.CoachImagesBaseFilePath,c.zIndex=50002,c.fEnableVision=this.ua.Jcf,c.fShowRealtimeFeedbackEnabledCheckbox=this.ua.awf,this.E6a=(new window.CoachPackage.CoachSessionFactory).createCoachActor(c,b),this.ua.Jcf&&(this.Jrf=this.E6a.getRehearsalVideoElement(),this.Mrf=this.E6a.getRehearsalVideoCanvas()),a=
wac_4ad(this,a,this.Jrf,this.Mrf),this.lNc=(new window.CoachPackage.CoachSessionFactory).createCoachManager(a),wac_5ad(this),wac_6ad(this),this.kbf=0,this.eqf=!1,(a=this.E6a.getCoachElement(wac_4$.PNf))&&wac_tf(a,"keydown",this.Y3),32;case 1:if(this.G7e)return 32;break;default:wac_Y(51454232,822,10,"StartRehearsalManager: Unimplemented action behavior")}return 8},u9e:function(){var a=this;this.Paf.uje.MRd("CoachPackage").then(function(){var b=wac_.pa.Qb.CoachPackageCssUrl,c=document.createElement("link");
c.setAttribute("rel","stylesheet");c.setAttribute("type","text/css");c.setAttribute("href",b);window.$addHandler(c,"load",function(){a.G7e=!0});document.body.appendChild(c);return null})},sNb:function(a,b){82===b.QP&&wac_7ad(this)},q2e:function(a){this.NWe&&this.E6a&&window.setTimeout(function(){wac_Vj(a)},50)},CM:function(a){try{var b=this.E6a.getCoachElement(wac_4$.Eyf),c=this.E6a.getCoachElement(wac_4$.gRf);9===a.keyCode?b&&c&&(a.target===b||c.contains(a.target))&&this.ob.U6():37===a.keyCode||
38===a.keyCode?(this.ob.m2e(),wac_7ad(this)):39===a.keyCode||40===a.keyCode?(this.ob.Ig(),wac_7ad(this)):13===a.keyCode||32===a.keyCode?b&&a.target!==b&&wac_7ad(this):this.ob.U6()}catch(d){wac_Y(594403598,822,10,"RehearsalManager: Exception in KeyDownHandler : {0}.",d)}},oTf:function(){this.une=0;this.K7e.uc(function(a){a.x_.hideToolbarButton(window.PowerPointWebEditor.SlideshowToolbarButtonIDs.SubtitlesButton);a.x_.hideToolbarButton(window.PowerPointWebEditor.SlideshowToolbarButtonIDs.LiveButton)});
this.lNc.startSession(!0)},jlf:function(a,b){a=new window.PowerPointWebEditor.Rehearsal.ISlideState;a.currentSlideIndex=b.En;a.totalSlideCount=wac_II(this.Cc);b=wac_4ad(this,a,this.Jrf,this.Mrf);this.lNc.updateSessionConfiguration(b);this.E6a.updateCoachSlideComponent(a)},vUd:function(){this.une=3;this.lNc.stopSession();this.E6a.hideCoachUI();var a=this.lNc.getSessionSummary();a.timeSpentInSeconds=this.kbf;this.U.yw(544918296,2,null);this.ob.h8e(this.gtf);this.ob.vLe(this.u8e);this.ob.DIa(this.Kgc);
this.ob.i8e(this.Ogc);window.clearInterval(this.kFf);if(this.eqf){var b=this;this.oFf.Ga().oef(a,function(){if(b.ua.bwf){var a=b.lNc.getTraceRequestMetadata(),d=b.E6a.getTraceRequestMetadata(),e=b.ua.kne.replace("wss","https");if(e&&e.length){var f=String.format("{0}SpeechHandler.ashx?action=SendTraceRequest",e),e=new XMLHttpRequest;e.open("POST",f,!0);f=wac_5k().toString();e.setRequestHeader("X-Correlation",f);try{wac_b(594409091,822,50,"SendPPTCastTraceRequest: Sending request with CorrelationId:{0}",
f);var g={};if(a)for(var h in a){var k={key:h,value:a[h]};g[k.key]=k.value}if(d)for(var l in d)k={key:l,value:d[l]},g[k.key]=k.value;var m=wac_Hd(wac_.pa.Qb.SessionStartInfoJson.toString());g.AudienceGroup=m.Ring||"Unknown";g.BuildVersion=wac_.jv||"Unknown";g.ClientType="web";g.IdentityProvider=b.ua.SZe||wac_.pa.Qb.HostAuthType||"Unknown";g.Locale=b.ua.QBb||"Unknown";g.SpeechMode="rehearsal";g.TenantId=wac_.pa.Qb.TenantId;g.UserId=wac_.pa.Qb.LoggableUserId;g.WacDatacenter=m.WACDatacenter||"Unknown";
g.WacHost=m.Host||"Unknown";e.send(wac_ai(g))}catch(n){wac_b(594409090,822,10,"SendPPTCastTraceRequest failed. CorrelationId:{0}",f)}}else wac_b(594409092,822,10,"SendPPTCastTraceRequest failed: unable to retrieve basePPTCastUrl.")}})}},mYf:function(){2!==this.une&&(this.kbf+=1,this.E6a&&this.E6a.updateTimer(this.kbf))},handleError:function(a){(a=window.$$as(String,a))&&a.startsWith("ErrorAudio")?(this.une=4,this.E6a&&this.E6a.showCoachDisabledUI(),wac_8ad(this)&&this.X0.Ga().Ki(wac_4$.tyf,wac_6W.P3e)):
a&&a.startsWith("ErrorVideo")&&this.E6a&&this.E6a.hideCoachVideoUI()},CXf:function(){wac_8ad(this)&&(window.clearTimeout(this.tbf),this.X0.Ga().fd())}};function wac_8ad(a){return a.ua.B2c&&a.X0&&a.X0.Ga()&&2!==a.une?!0:!1}
function wac_6ad(a){a.lNc.on("SpeechRecognitionStarted",function(){a.Zpf&&wac_8ad(a)&&(a.X0.Ga().fd(),a.Zpf=!1)});a.lNc.on("PPTCoachRealtimeNotification",function(b){a.E6a.updateCoachRealtimeNotification(b)});a.lNc.on("QualityStatusChanged",function(b){if(a.ua.B2c){var c=b.severity,d=b.shortCode;if(0<d&&d<wac_4$.jDf&&wac_4$.V3e[d])switch(c){case 0:wac_8ad(a)&&a.X0.Ga().fd();break;case 1:(b=0<d?wac_4$.V3e[d]:b.shortString)&&wac_8ad(a)&&a.X0.Ga().Ki(b,wac_6W.y9e);break;case 2:(b=0<d?wac_4$.V3e[d]:b.shortString)&&
wac_8ad(a)&&a.X0.Ga().Ki(b,wac_6W.P3e)}else wac_Y(595198425,822,10,"onQualityStatusChanged: Invalid short code")}});a.lNc.on("MediaStatusChanged",function(b){"AudioDeviceConnected"===b.mediaStatus?(a.E6a&&a.E6a.showCoachRealtimeUI(),wac_8ad(a)&&a.X0.Ga().Ki(wac_4$.pyf,wac_6W.Ydf)):"VideoSetupCompleted"===b.mediaStatus&&a.E6a&&a.E6a.enableCoachVideoUI()});a.lNc.on("Error",function(b){a.handleError(b)});a.lNc.on("ConnectionRetry",function(){a.Zpf=!0;wac_8ad(a)&&a.X0.Ga().Ki(wac_4$.yyf,wac_6W.P3e)})}
function wac_5ad(a){a.E6a.on("CoachSessionStarted",function(){a.une=1;a.kFf=window.setInterval(a.FLf,1E3);a.lNc.enableVoiceStreaming();wac_8ad(a)&&(a.X0.Ga().Ki(wac_4$.qyf,wac_6W.Ydf),a.tbf=window.setTimeout(a.ELf,3E3));a.eqf=!0;a.ob.U6()});a.E6a.on("CoachSessionPaused",function(){a.une=2;a.lNc.pauseSession();wac_8ad(a)&&a.X0.Ga().fd();a.ob.U6()});a.E6a.on("CoachSessionResumed",function(){a.une=1;a.lNc.resumeSession();a.ob.U6()})}
function wac_4ad(a,b,c,d){var e=new window.PowerPointWebEditor.Rehearsal.ICoachSessionConfig;e.disabledCoachRealtimeFeatures="";e.userSessionId=wac_.Ag;var f=new window.PowerPointWebEditor.Rehearsal.IDocumentDownloadConfig;f.docId=wac_.eo;f.podsSessionId=a.hb.Jc;f.userDataCenterClusterId=a.hb.mD;f.webServiceBase=a.ua.M4;e.documentDownloadConfig=f;f=new window.UlsExternalLogger;e.logger=f;f={};f.currentSlideIndex=b.currentSlideIndex.toString();e.customSettings=f;e.speechFDBase=a.ua.kne;e.requestedCoachFeatures=
wac_4$.iWf+","+wac_4$.rOf+","+wac_4$.YUf+","+wac_4$.TNf+","+wac_4$.DTf+","+wac_4$.OTf+(a.ua.Dcf?","+wac_4$.JOf:"")+(a.ua.Lcf?","+wac_4$.pRf:"");e.fEnableVision=a.ua.Jcf;if(e.fEnableVision&&c&&d){var g;e.webcamConfig=(g=new window.PowerPointWebEditor.Rehearsal.IWebcamConfig,g.videoView=c,g.workingCanvas=d,g.numFramesPerSecond=a.ua.Jvf,g)}return e}
function wac_7ad(a){if(a.une)2===a.une?(b=a.E6a.getCoachElement(wac_4$.ITf))&&a.q2e(b):1===a.une&&(b=a.E6a.getCoachElement(wac_4$.hRf))&&a.q2e(b);else{var b=a.E6a.getCoachElement(wac_4$.Eyf);b&&a.q2e(b)}}wac_Zad.registerClass("PowerPointWebEditor.Rehearsal.PPTWebEditorRehearsalPackage",null,wac_I,wac_i);wac__ad.registerClass("PowerPointWebEditor.Rehearsal.RehearsalSummaryPageActor",null,wac_Xad);wac_1ad.registerClass("PowerPointWebEditor.Rehearsal.RehearsalSummaryPageHelper");wac_4$.registerClass("PowerPointWebEditor.Rehearsal.RehearsalResourceString");
window.PowerPointWebEditor.Rehearsal.ISlideState.registerClass("PowerPointWebEditor.Rehearsal.ISlideState");window.PowerPointWebEditor.Rehearsal.IWebcamConfig.registerClass("PowerPointWebEditor.Rehearsal.IWebcamConfig");window.PowerPointWebEditor.Rehearsal.ICoachActorConfig.registerClass("PowerPointWebEditor.Rehearsal.ICoachActorConfig");window.PowerPointWebEditor.Rehearsal.IDocumentDownloadConfig.registerClass("PowerPointWebEditor.Rehearsal.IDocumentDownloadConfig");window.PowerPointWebEditor.Rehearsal.ICoachSessionConfig.registerClass("PowerPointWebEditor.Rehearsal.ICoachSessionConfig");
window.PowerPointWebEditor.Rehearsal.IFillerData.registerClass("PowerPointWebEditor.Rehearsal.IFillerData");window.PowerPointWebEditor.Rehearsal.ISensitivePhrasesData.registerClass("PowerPointWebEditor.Rehearsal.ISensitivePhrasesData");window.PowerPointWebEditor.Rehearsal.IPaceData.registerClass("PowerPointWebEditor.Rehearsal.IPaceData");window.PowerPointWebEditor.Rehearsal.IMonotoneData.registerClass("PowerPointWebEditor.Rehearsal.IMonotoneData");window.PowerPointWebEditor.Rehearsal.ICoachSummaryData.registerClass("PowerPointWebEditor.Rehearsal.ICoachSummaryData");
window.PowerPointWebEditor.Rehearsal.IQualityStatusInfo.registerClass("PowerPointWebEditor.Rehearsal.IQualityStatusInfo");window.PowerPointWebEditor.Rehearsal.IFeatureInfo.registerClass("PowerPointWebEditor.Rehearsal.IFeatureInfo");window.PowerPointWebEditor.Rehearsal.ICoachRealtimeInfo.registerClass("PowerPointWebEditor.Rehearsal.ICoachRealtimeInfo");window.PowerPointWebEditor.Rehearsal.IMediaEventInfo.registerClass("PowerPointWebEditor.Rehearsal.IMediaEventInfo");window.PowerPointWebEditor.Rehearsal.IRealTimeCritique.registerClass("PowerPointWebEditor.Rehearsal.IRealTimeCritique");
wac_0ad.registerClass("PowerPointWebEditor.Rehearsal.RehearsalManager",null,wac_Yad);wac_4$.jDf=20;wac_4$.V3e=Array(wac_4$.jDf);wac_4$.pyf=null;wac_4$.qyf=null;wac_4$.tyf=null;wac_4$.yyf=null;wac_4$.rOf="fillerWords";wac_4$.DTf="originality";wac_4$.iWf="wordsPerMinute";wac_4$.YUf="sensitivePhrases";wac_4$.TNf="correctedSensitivePhrases";wac_4$.OTf="positivity";wac_4$.JOf="grammar";wac_4$.pRf="monotone";wac_4$.Eyf="GetStartedButton";wac_4$.gRf="ListeningButtonPlayPauseButton";wac_4$.hRf="ListeningElement";
wac_4$.PNf="ContainerElement";wac_4$.ITf="PausedElement";wac_J(wac_C(),new wac_Zad,0,!1);Type.registerNamespace("PowerPointWebEditor");wac_Z=window.PowerPointWebEditor||{};
function wac_mZ(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w){this.Ile=Function.createDelegate(this,this.dve);this.Jle=Function.createDelegate(this,this.eve);this.cba=Function.createDelegate(this,this.iQa);this.Mic=Function.createDelegate(this,this.G4d);this.Idc=Function.createDelegate(this,this.zAc);this.Kfc=Function.createDelegate(this,this.bBc);this.Hfc=Function.createDelegate(this,this.aBc);this.iba=Function.createDelegate(this,this.Dda);this.RB=Function.createDelegate(this,this.RG);this.Qee=Function.createDelegate(this,
this.Jye);this.tP=Function.createDelegate(this,this.MM);this.ha=a;this.ra=b;this.Ea=c;this.Ib=d;this.hY=e;this.Kz=f;this.U=g;this.Rp=h;this.SY=k;this.Ru=l;this.oua=n;this.$S=p;this.I2a=q;this.Qg=r;this.g$=t;this.pb=v;this.Ob=u;this.Ej=m;this.Y2=w;this.qe=!1}
wac_mZ.prototype={ha:null,ra:null,Ea:null,Ib:null,hY:null,Kz:null,U:null,Rp:null,SY:null,Ru:null,Ej:null,oua:null,$S:null,I2a:null,Qg:null,g$:null,pb:null,Ob:null,q6b:!1,J6b:!1,Y2:null,$rb:!1,qe:!1,Kn:function(){this.qe||(this.JQ(),this.J6b=2===this.Ob.Kb(),this.qe=!0)},JQ:function(){wac_Cv(this.ha,this.tP);this.oua.Psa.xa("MU",this.Qee);wac__Nc(this.Kz,this.RB);wac_TY(this.$S,this.iba);this.Qg.la.xa("ROIU",this.Hfc);this.SY.la.xa("ReplaceObjectViewDE",this.Kfc);wac_JSb(this.hY,this.Idc);this.Kz.la.xa("CH",
this.Mic);this.Ob.N9(this.cba);this.Qg.la.xa("AROSBSR",this.Jle);this.Qg.la.xa("AROSASR",this.Ile)},O:function(){this.qe&&(wac_my(this.ha,this.tP),this.oua.Psa.sb("MU",this.Qee),wac_ZNc(this.Kz,this.RB),this.$S.$$b.sb("SPC",this.iba),this.Qg.la.sb("ROIU",this.Hfc),this.SY.la.sb("ReplaceObjectViewDE",this.Kfc),wac_lMb(this.hY,this.Idc),this.Ob.Ija(this.cba),this.Kz.la.sb("CH",this.Mic),this.Qg.la.sb("AROSBSR",this.Jle),this.Qg.la.sb("AROSASR",this.Ile),this.qe=!1)},$za:function(a){return this.q6b&&
this.J6b?this.I2a.RSa(a):!1},yfe:function(a){switch(a){case 4041021629:case 2888832796:case 1982565441:case 2869688532:case 3205718471:case 4185984924:case 123670621:return!0;default:return!1}},eve:function(){this.$rb=!0},dve:function(){this.$rb=!1},tfe:function(a){return a?"data:image/png;base64,"+a:null},iQa:function(a){wac_Y(36544854,829,50,"BaseReplaceObjectManager::OnAppFrameModeSwitched, frame mode switched to :{0}",a.Kb());this.J6b=2===a.Kb()},G4d:function(){this.q6b||wac_Y(36544856,829,50,
"BaseReplaceObjectManager::UpdateEditState, updating edit state");this.q6b=!0}};
function wac_Snc(a,b,c,d){if(c.dv)if(c.UKa&&b.bC)wac_Y(38115480,829,10,"HandleReplaceObjectResponse - first reponse should have notification type : Normal. NotificationType: {0}",b.bC);else{if(b.bC)if(1===b.bC){if(!b.OT){wac_Y(38115488,829,10,"HandleReplaceObjectResponse - empty suggestions. CorrelationId {0}",b.Nd);return}c.v5e(wac_Krb(a,b.OT,b.F4));c.Kwa=new Date;d.zy&&wac_qZ(a,b.Nd,c.Yc(),c.oqa(),"Success")}else 2===b.bC&&(c.Goc=!1,c.Iua(b.rx),wac_qZ(a,c.Nd,b.rx,c.oqa(),"Success"));else{if(0>=
b.F4){wac_Y(38115482,829,50,"HandleReplaceObjectResponse - Reponse failed. CorrelationId {0}",b.Nd);a.nM(c,"NoSuggestions");return}if(b.F4<d.Lne){wac_Y(38115484,829,50,"HandleReplaceObjectResponse - not enough suggestions returned. CorrelationId {0}",b.Nd);a.nM(c,"LowSuggestions");return}wac_tZ(c,!1);c.v5e(wac_Krb(a,b.OT,b.F4));wac_Trb(c,b.F4);wac_Y(38115486,829,50,"HandleReplaceObjectResponse - suggestions returned: {0}. CorrelationId {1}",c.TZ,b.Nd)}d=c.Ay;c.Ks&&c.Ks.Uj()&&d&&d.Uj()&&a.Ej.k6(d)&&
a.q6b&&a.J6b&&(1===b.bC?wac_Urb(a.Ru,c.Nd):wac_Irb(a.Ru,d))}else wac_Y(38115478,829,15,"HandleReplaceObjectResponse - No session active. Reponse CorrelationId: {0}",b.Nd)}function wac_qZ(a,b,c,d,e){a.Y2.uc(function(a){var g,h=(g=new wac_qpb,g.correlationId=b,g.shapeId=c,g.suggestions=d,g);a.ZMd(e,h)})}
function wac_Krb(a,b,c){var d=[];if(!b)return d;b=b.split(";");if(b.length<c)return wac_Y(37065230,829,10,"BaseReplaceObjectManager::ParseSuggestions - suggestionCount:{0}, resultLength:{1}",c,b.length),d;for(var e=0;e<c;++e){var f=b[e].split(":");if(3!==f.length)throw a=String.format("Invalid format of suggestion item. Index: {0}, SuggestionItem: {1}",e,b[e]),wac_Y(37065232,829,50,"BaseReplaceObjectManager::ParseSuggestions - {0}",a),Error.create(a);var g=wac_ulc(Number.parseInvariant(f[1]),1,177,
"L_SAType"),h;Array.add(d,(h=new wac_opb,h.index=f[0],h.labelText=g?g:ResourceStrings.L_SmartArt,h.imageData=a.tfe(f[2]),h))}return d}Type.registerNamespace("PowerPointWebEditor.ReplaceObject");wac_Z.lPb=wac_Z.lPb||{};function wac_Tnc(){}wac_Tnc.registerInterface("PowerPointWebEditor.ReplaceObject.IFlyoutAnchor");function wac_rZ(){}wac_rZ.registerInterface("PowerPointWebEditor.ReplaceObject.IReplaceObjectContextManager");function wac_Orb(){}wac_Orb.registerInterface("PowerPointWebEditor.ReplaceObject.IReplaceObjectRequestManager");
function wac_Prb(){}wac_Prb.registerInterface("PowerPointWebEditor.ReplaceObject.IReplaceObjectWalls");function wac_Qrb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w,x,z,y,A,B){this.Ggc=Function.createDelegate(this,this.qUd);this.Ehc=Function.createDelegate(this,this.YBc);this.Fhc=Function.createDelegate(this,this.FXd);wac_Qrb.initializeBase(this,[h,c,d,e,f,g,k,l,m,n,p,t,v,u,w,z,y,A,B]);this.Ez=a;this.a4b=b;this.za=q;this.d2c=r;this.ua=x;this.$9b=this.ua.Zrc}
wac_Qrb.prototype={Ez:null,a4b:null,za:null,d2c:null,ua:null,$9b:!1,JQ:function(){if(this.ua.W7a){var a=this;this.a4b.uc(function(b){b.d5("ShapeTextConvertable",a.Fhc)})}else{var b=this;this.Ez.uc(function(a){a.d5("ShapeTextConvertable",b.Ehc)})}this.Qg.la.xa("SSS",this.Ggc);wac_mZ.prototype.JQ.call(this)},O:function(){if(this.qe){if(this.ua.W7a){var a=this;this.a4b.uc(function(b){b.Nna("ShapeTextConvertable",a.Fhc)})}else{var b=this;this.Ez.uc(function(a){a.Nna("ShapeTextConvertable",b.Ehc)})}this.Qg.la.sb("SSS",
this.Ggc)}wac_mZ.prototype.O.call(this)},YBc:function(a,b){if(a&&b){var c,d;try{c=wac_yl(a),d=wac_yl(b)}catch(f){wac_Y(26080646,829,10,"AugmentationLoopReplaceObjectManager::OnSmartArtConvertable - Try parse aug response failed");return}if(c&&!window.isNaN(c.sid)&&!window.isNaN(c.cid)&&!window.isNaN(c.shapeId)&&(a=new Date(c.c),b=c.c?(new Date).getTime()-c.c:-1,wac_Y(34181982,829,50,"ALEvent received: Slide:{0}|{1}, Shape:{2}, TriggerName:{3}, ElapsedTimeInMs:{4}",c.sid,c.cid,c.shapeId,c.t,b),(b=
wac_fO(this.Ea.Ja(),c.shapeId))&&(wac_jm(wac_Rrb(this),b.Yc())||c.t===wac_Z.OI.Fea.toString(1))))if(d&&!d.isTextConvertible)wac_sZ(this.Ru,b,!0,!0,!1);else{var e=this.Rp.jJ(b.Yc());if(e&&e.CZ&&(e=new wac_vK(b,e.U4),this.U.Wj(3825036569,2,e,null),!e.Dka))return;this.$za(b)&&(d=d&&d.smartArtInfo?d.smartArtInfo.length:0,this.HG(this.Ea.Ja(),b,d,c.t||"AugLoopDefault","",a))}}},FXd:function(a,b,c,d){b&&d&&d.ContextId&&d.Payload&&this.YBc(d.ContextId,d.Payload)},qUd:function(){wac_Srb(this,"SlideShowStarted")},
MM:function(a,b){if(!this.qe)wac_Y(26042393,829,50,"AugmentationLoopReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.$rb&&(b.ds.length||!this.ra.Re()||"document"!==this.ra.Re().Kd)){a=wac_Rrb(this);for(b=this.Rp.$$ge();b.$$mn();){var c=b.$$cu();c.dv&&!Array.contains(a,c.Yc())&&this.nM(c,"SelectionChanged")}this.$9b&&!Array.contains(a,this.Ru.EZ)&&(a=this.Ru,-1!==a.EZ&&(b=wac_fO(a.Ea.Ja(),a.EZ))&&wac_sZ(a,b,!0,!0,!1))}},bBc:function(a,b){this.qe?(a=this.Rp.jJ(b.Ay.Yc()))&&
a.dv&&(b=a.Ay,this.nM(a,"ShapePositionChanged"),this.$za(b)&&this.HG(this.Ea.Ja(),b,0,"AugLoopRetrigger","ShapePositionChanged",null)):wac_Y(26042395,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")},Jye:function(a,b){b.MKa&&this.cE(b.Ii)},RG:function(){wac_Srb(this,"SlideNavigation")},Dda:function(a,b){if(b.DKa&&b.yq){a=b.yq;b=a.length;for(var c=0;c<b;++c){var d=this.Rp.jJ(a[c]);d&&d.dv&&this.nM(d,"ShapePresence")}}},aBc:function(a,b){(a=this.Rp.GOa(b.Nd))?
wac_Snc(this,b,a,this.ua):wac_Y(26042397,829,50,"AugmentationLoopReplaceObjectManager::OnReplaceObjectResponse, No session active. Reponse CorrelationId: {0}",b.Nd)},zAc:function(){if(this.qe)for(var a=this.Rp.$$ge();a.$$mn();){var b=a.$$cu();!b.B6a||b.QN||this.Ib.Ac(this.Ea.Yj)||(wac_Frb(b,!1),wac_sZ(this.Ru,b.Ay,!0,!0,!1))}},$za:function(a){var b=this.Rp.ETc();return b>=this.ua.asc?(wac_Y(34223842,829,50,"AugmentationLoopReplaceObjectManager::ShouldGenerateSuggestion, too many floaties[{0}] showing on the slide.",
b),!1):wac_mZ.prototype.$za.call(this,a)},HG:function(a,b,c,d,e,f){try{var g=this.Rp.jJ(b.Yc());g&&this.nM(g,"NewSession");g=this.Rp.Axa(a,b.Yc(),d,e,this.ua);g.ZLa=f;wac_Vrb(g,"richEditTextUnicodeChanged"===d);this.Ru.Ggb(g.Nd);var h=wac_Wrb(this.d2c,g);wac_Y(34144971,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, state:{4}",g.Nd,g.Ks.Vc(),g.Ks.fe(),g.Yc(),h);wac_Y(34097054,829,50,"AugmentationLoopReplaceObjectManager::GenerateSuggestion, text can convert to SmartArt, correlation id: {0}, returned suggestion count: {1}, should take suggestion count: {2}, trigger reason: {3}",
g.Nd,c,Math.min(c,this.ua.ACb),d);c&&this.ua.bsc&&(c=Math.min(c,this.ua.ACb),g.v5e(wac_9ad(c)),wac_Trb(g,c),wac_tZ(g,!1),wac_Irb(this.Ru,b));!h&&this.ua.zy&&wac_qZ(this,g.Nd,g.Yc(),[],"Pending")}catch(k){wac_Y(34152522,829,10,"GenerateSuggestion failed!! {0} ",k.message)}},cE:function(a){this.qe?this.yfe(a)||wac_Srb(this,"WebActionId:"+this.g$.ETd(a)):wac_Y(26042447,829,15,"AugmentationLoopReplaceObjectManager::HandleAction - called before setup")},nM:function(a,b){if(!a.QN){if("NoSuggestions"===
b)wac_sZ(this.Ru,a.Ay,!0,!0,!1);else if(a.CZ){var c=this.Ru,d=a.Ay,e;this.$9b?(e=wac_5M(this.ha),e=a.CZ&&Array.contains(e,a.Ay)):e=!1;wac_sZ(c,d,!0,"NewSession"!==b,e)}this.Rp.mJb(a,b);this.ua.zy&&wac_qZ(this,a.Nd,a.Yc(),a.oqa(),"NoResult")}}};function wac_Rrb(a){a=wac_5M(a.ha);var b=[];a&&Array.forEach(a,function(a){Array.add(b,a.Yc())});return b}function wac_Srb(a,b){for(var c=a.Rp.$$ge();c.$$mn();){var d=c.$$cu();a.nM(d,b)}}
function wac_9ad(a){for(var b=Array(a),c=0;c<a;c++){var d;Array.add(b,(d=new wac_opb,d.index=c.toString(),d.labelText=ResourceStrings.l_Loading,d.imageData=null,d))}return b}function wac_Unc(a,b){this.c8b=window.Box4.App.Fn;this.ua=a;this.pb=b}wac_Unc.prototype={ua:null,pb:null,c8b:null,uyb:!1};function wac_Vnc(a,b){var c=new wac_D(2,1,550,function(){b()},0,null,!1);a.pb.Hb(c)}
function wac_Wnc(a,b){a.uyb=!0;a.c8b=new Date;var c=new wac_D(2,1,a.ua.$rc,function(){a.uyb&&new Date-a.c8b>=a.ua.$rc&&b()},0,null,!1);a.pb.Hb(c)}function wac_Xnc(a,b,c,d,e,f,g,h,k){this.Wua=Function.createDelegate(this,this.lna);this.Qle=Function.createDelegate(this,this.nve);this.$Ia=Function.createDelegate(this,this.sl);this.Xia=a;this.oc=b;this.Xo=c;this.FY=d;this.faa=e;this.ed=g;this.ua=f;this.NCb=k}
wac_Xnc.prototype={D$:null,fY:null,Xia:null,oc:null,Xo:null,FY:null,faa:null,ed:null,NCb:null,ua:null,qe:!1,ofe:function(){this.ua.yCb?this.fY.setAttribute("Src",this.ed.Io("BLUEBOLT_Deactivated.gif")):this.fY.style.opacity=".3";wac_Wnc(this.NCb,this.$Ia)},pfe:function(){this.ua.yCb?this.fY.setAttribute("Src",this.ed.Io("BLUEBOLT_Reactivated.gif")):this.fY.style.opacity="initial";this.NCb.uyb=!1},Ki:function(){this.ua.yCb?this.fY.setAttribute("Src",this.ed.Io("BLUEBOLT_Entrance.gif")):this.fY.setAttribute("Src",
this.ed.Io("LightningIdeasOOUI_blue_32x.png"))},sl:function(){if(this.ua.yCb){this.fY.setAttribute("Src",this.ed.Io("BLUEBOLT_Exit.gif"));var a=this;wac_Vnc(this.NCb,function(){a.Xia.Oa.style.visibility="hidden"})}else this.fY.setAttribute("Src",""),this.Xia.Oa.style.visibility="hidden"},Kn:function(){this.qe||(this.Xia?(this.D$=new wac_FG,this.D$.Oa.style.visibility="inherit",this.D$.Oa.style.position="absolute",this.fY=wac_SG(),this.fY.setAttribute("Unselectable","on"),this.fY.setAttribute("role",
"presentation"),this.fY.className="gifFloatie",this.D$.Oa.appendChild(this.fY),this.Xia.Ce(this.D$),this.pRa()):wac_Y(38072903,829,15,"parentElement is null"),this.qe=!0)},nve:function(a){var b;switch(this.ua.zCb){case 7:b="BLUEBOLT_Hover_on.gif";break;case 8:b="BLUEBOLT_HoverWhite_On.gif";break;default:b="BLUEBOLT_Hover_on.gif"}this.fY.setAttribute("Src",this.ed.Io(b));return this.faa(a)},lna:function(){var a;switch(this.ua.zCb){case 7:a="BLUEBOLT_Hover_off.gif";break;case 8:a="BLUEBOLT_HoverWhite_Off.gif";
break;default:a="BLUEBOLT_Hover_off.gif"}this.fY.setAttribute("Src",this.ed.Io(a));return!0},pRa:function(){this.FY&&this.oc.ya("click",this.fY,this.FY);this.faa&&(this.Xo.ya("msospPointerOver",this.fY,this.Qle),this.Xo.ya("msospPointerOut",this.fY,this.Wua))},jje:function(){this.FY&&this.oc.ub("click",this.fY,this.FY);this.faa&&(this.Xo.ub("msospPointerOver",this.fY,this.Qle),this.Xo.ub("msospPointerOut",this.fY,this.Wua))},O:function(){this.sl();this.jje();this.qe=!1}};function wac_Xrb(){}
wac_Xrb.prototype={J:null,H7b:!1,cle:!1,uD:!1,Ub:function(){return"PowerPointWebEditor.ReplaceObject"},gc:function(a){this.J=a;if(this.uD=this.J.H(wac_3L).Ta.Fo){var b=this;wac_m(wac_n(this.J.fa(wac_WF)),function(){return new wac_WF(wac_.Af,b.J.H(wac_VF),b.J.H(wac_fG),b.J.H(wac_jG),b.J.H(wac_NF),b.J.H(wac_dd),b.J.H(wac_Uc))})}wac_m(wac_n(wac_o(wac_o(wac_o(a.fa(wac_Yrb),wac_ZY),wac_XY),wac_YY)),function(){return new wac_Yrb});wac_m(wac_n(a.fa(wac_vZ)),function(){return new wac_vZ(a.H(wac_9G),a.H(wac_eK),
a.H(wac_Nt))});wac_m(wac_n(a.fa(wac_kZ)),function(){return new wac_Zrb(a.H(wac_9G),a.H(wac_cd),a.H(wac_8c),a.H(wac_Nt),a.H(wac_Oc),a.H(wac_XY),a.H(wac_rZ),a.H(wac_PF),a.H(wac_JL),a.H(wac_zG),a.H(wac_R),a.H(wac_ed))});wac_m(wac_n(a.fa(wac_Prb)),function(){return new wac__rb(a.H(wac_R),a.H(wac_IH),a.H(wac_vZ))});wac_m(wac_n(a.fa(wac_wZ)),function(){return new wac_wZ(a.H(wac_Prb),a.H(wac_vZ),a.H(wac_Lt),a.H(wac_Nt),a.H(wac_R))});wac_m(wac_n(a.fa(wac_Orb)),function(){return new wac_0rb(a.H(wac_aY),a.H(wac_vZ),
a.H(wac_R).g$c)});wac_m(wac_n(a.fa(wac_rZ)),function(){return wac_q(a.H(wac_Uc),wac_2(473))?new wac_xZ(function(b,c,d,h,k,l){var m=new wac_1rb(a.H(wac_Lt),a.H(wac_aY),wac_l(a,wac_AY));m.N6a(b,c,d,h,k,l);return m}):new wac_yZ(new wac_1rb(a.H(wac_Lt),a.H(wac_aY),wac_l(a,wac_AY)))});wac_m(wac_n(a.fa(wac_lZ)),function(){return wac_q(a.H(wac_Uc),wac_2(473))?new wac_Qrb(wac_l(a,wac_2Y),wac_l(a,wac_3Y),a.H(wac_zG),a.H(wac_Nt),a.H(wac_Jt),a.H(wac_AJ),a.H(wac_3H),a.H(wac_It),a.H(wac_Oc),a.H(wac_rZ),a.H(wac_YY),
a.H(wac_zZ),a.H(wac_vZ),a.H(wac_Lt),a.H(wac_Orb),a.H(wac_jY),a.H(wac_RY),a.H(wac_wZ),a.H(wac_NL),a.H(wac_R),a.H(wac_mM),a.H(wac_dd),a.H(wac_kG),wac_l(a,wac_AY)):new wac_2rb(a.H(wac_zG),a.H(wac_Nt),a.H(wac_Jt),a.H(wac_AJ),a.H(wac_3H),a.H(wac_It),a.H(wac_Oc),a.H(wac_rZ),a.H(wac_YY),a.H(wac_zZ),a.H(wac_vZ),a.H(wac_aY),a.H(wac_jY),a.H(wac_RY),a.H(wac_wZ),a.H(wac_NL),a.H(wac_R),a.H(wac_mM),a.H(wac_dd),a.H(wac_kG),wac_l(a,wac_AY))});wac_m(wac_n(a.fa(wac_zZ)),function(){return new wac_zZ(a.H(wac_Nt),a.H(wac_MK.$$(wac_cK)),
a.H(wac_MK.$$(wac_dK)),a.H(wac_Lt),a.H(wac_rZ),a.H(wac_YY),a.H(wac_vZ),a.H(wac_kZ),a.H(wac_zG),a.H(wac_Us).Cb(),a.H(wac_IH))});wac_m(wac_n(a.fa(wac_Unc)),function(){return new wac_Unc(a.H(wac_R),a.H(wac_dd))});wac_m(wac_n(a.fa(wac_AZ)),function(){return new wac_AZ(a.H(wac_8c),a.H(wac_cd),a.H(wac_9G),a.H(wac_UX),a.H(wac_R),a.H(wac_5F),a.H(wac_Unc))});wac_m(wac_n(a.fa(wac_MK.$$(wac_cK))),function(){return new (wac_VK.$$(wac_cK))(function(b,c){var d=null,h=window.$$as(wac_5J,wac_T(b,a.H(wac_Us).Cb()));
h&&!h.Fu()&&h.Gs&&(d=new wac_3rb(b,h,c,a.H(wac_AZ),a.H(wac_Oc),a.H(wac_9G),a.H(wac_Rt),a.H(wac_rZ),a.H(wac_XY),a.H(wac_R),a.H(wac_kZ)),d.Kn());return d})});wac_m(wac_n(a.fa(wac_MK.$$(wac_dK))),function(){return new (wac_VK.$$(wac_dK))(function(b,c){var d=null,h=window.$$as(wac_5J,wac_T(b,a.H(wac_Us).Cb()));h&&!h.Fu()&&h.Gs&&(d=new wac_4rb(b,h,c,a.H(wac_AZ),a.H(wac_vZ)),d.Kn());return d})});var c=this;wac_m(wac_n(wac_o(a.fa(wac_5rb),wac_4Y)),function(){return new wac_5rb(wac_l(c.J,wac_2Y),c.J.H(wac_lZ),
c.J.H(wac_wZ))});var d=this;wac_m(wac_n(a.fa(wac_BZ)),function(){return new wac_BZ(wac_l(d.J,wac_3Y),d.J.H(wac_4Y))});wac_m(wac_n(a.fa(wac_8$)),function(){return new wac_8$(a.H(wac_It),a.H(wac_Oc),a.H(wac_zG),a.H(wac_3H),a.H(wac_Nt),a.H(wac_Jt),a.H(wac_XY),a.H(wac_NL),a.H(wac_rZ),a.H(wac_dI),a.H(wac_zZ),a.H(wac_KL),a.H(wac_IH))});wac_m(wac_n(a.fa(wac_Ync)),function(){return new wac_Ync(a.H(wac_It),a.H(wac_NL),a.H(wac_rZ),a.H(wac_Nt),a.H(wac_IH),a.H(wac_R),a.H(wac_zZ),a.H(wac_aY),a.H(wac_vZ),a.H(wac_RY),
a.H(wac_AJ),a.H(wac_GJ),a.H(wac_jY),a.H(wac_mM),a.H(wac_mG))})},tb:function(){this.uD&&this.J.H(wac_WF);var a=this.J.H(wac_Uc),b=this;a.Ok(function(){var c=new Date;b.H7b=wac_q(a,wac_2(463));b.H7b&&(wac_q(a,wac_2(499))&&b.J.H(wac_BZ).Yd(),b.J.H(wac_kZ).Kn(),b.J.H(wac_zZ).Kn(),b.J.H(wac_8$).Kn(),b.J.H(wac_lZ).Kn());b.cle=wac_q(a,wac_2(676));b.cle&&(b.J.H(wac_kZ).Kn(),b.J.H(wac_zZ).Kn(),b.J.H(wac_8$).Kn(),b.J.H(wac_Ync).Kn());wac_Y(40158946,829,50,"ReplaceObject::Callback duration:{0}",new Date-c)})},
O:function(){this.H7b&&(this.J.H(wac_kZ).O(),this.J.H(wac_lZ).O(),this.J.H(wac_zZ).O(),this.J.H(wac_8$).O());this.cle&&(this.J.H(wac_kZ).O(),this.J.H(wac_zZ).O(),this.J.H(wac_8$).O(),this.J.H(wac_Ync).O())}};
function wac_Ync(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r){this.Zgc=Function.createDelegate(this,this.TUd);this.Cse=Function.createDelegate(this,this.pve);this.Wee=Function.createDelegate(this,this.rCe);this.lJa=Function.createDelegate(this,this.oQa);this.iba=Function.createDelegate(this,this.Dda);this.EEe=Function.createDelegate(this,this.CMe);this.Gle=Function.createDelegate(this,this.bve);this.Hle=Function.createDelegate(this,this.cve);this.tP=Function.createDelegate(this,this.MM);this.Rle=Function.createDelegate(this,
this.ove);this.Qg=b;this.ha=a;this.Rp=c;this.Ea=d;this.jd=e;this.ua=f;this.Ru=g;this.kf=h;this.Ej=k;this.$S=l;this.hY=m;this.F$=n;this.Sac=p;this.g$=q;this.Mp=r}
wac_Ync.prototype={Qg:null,Ea:null,ha:null,Rp:null,jd:null,ua:null,Ru:null,kf:null,Ej:null,$S:null,hY:null,F$:null,Sac:null,g$:null,Mp:null,lx:null,$rb:!1,JQ:function(){this.Qg.la.xa("ISIU",this.Rle);wac_Cv(this.ha,this.tP);this.Qg.la.xa("AROSBSR",this.Hle);this.Qg.la.xa("AROSASR",this.Gle);this.Qg.la.xa("IC",this.EEe);wac_TY(this.$S,this.iba);wac_JSb(this.hY,this.lJa);this.Sac.Psa.xa("MU",this.Wee)},ije:function(){this.Qg.la.sb("ISIU",this.Rle);wac_my(this.ha,this.tP);this.Qg.la.sb("AROSBSR",this.Hle);
this.Qg.la.sb("AROSASR",this.Gle);this.Qg.la.sb("IC",this.EEe);this.$S.$$b.sb("SPC",this.iba);wac_lMb(this.hY,this.lJa);this.Sac.Psa.sb("MU",this.Wee)},O:function(){this.ije()},Kn:function(){this.JQ()},cve:function(){this.$rb=!0},bve:function(){this.$rb=!1},CMe:function(a,b){b&&this.lx&&this.lx.Fje&&this.lx.Ks.Vc()===b.Ls.Vc()&&this.lx.Ks.fe()===b.Ls.fe()&&this.lx.Yc()===b.rx&&this.lx.Gm()===b.Fac&&(this.lx.CBe=b.mFe)},Dda:function(a,b){if(b.DKa&&b.yq&&this.lx){a=b.yq;b=a.length;for(var c=0;c<b;++c){var d=
a[c];this.lx.Yc()===d&&this.lQ("ShapePresence")}}},rCe:function(a,b){b.MKa&&!this.yfe(b.Ii)&&this.lQ("WebActionId:"+this.g$.ETd(b.Ii))},yfe:function(a){switch(a){case 4041021629:case 2888832796:case 1982565441:case 2869688532:case 3205718471:case 4185984924:case 123670621:return!0;default:return!1}},oQa:function(){if(this.lx){var a=this.lx.Ay,b=wac_BO(a);a&&b&&!this.F$.Ac(b)&&(wac_Frb(this.lx,!1),wac_sZ(this.Ru,a,!0,!0,!1),this.lx.vCc=new Date,this.lx.lQ("SelectionChanged"))}},MM:function(){if(!this.$rb){var a=
wac_XT(wac_5M(this.ha));if(a){if(this.lx&&this.lx.dv){if(wac_Enc(a.fsa(),this.lx.fsa()))return;this.lQ("SelectionChanged")}this.$za(a)&&this.HG(this.Ea.Ja(),a,"SelectShape")}else this.lx&&this.lx.dv&&this.lQ("SelectionChanged")}},HG:function(a,b,c){this.lx=this.Rp.N6a(a,b.Yc(),c,"",this.ua,b.Gm());wac_tZ(this.lx,!0);this.Ru.Ggb(this.lx.Nd);wac_Y(38279303,829,50,"ReplaceIconManager::GenerateSuggestion - CorrelationId:{0}, SlideId:{1}|{2}, ShapeId:{3}, SmartArtSubNodeId:{4}",this.lx.Nd,this.lx.Ks.Vc(),
this.lx.Ks.fe(),this.lx.Yc(),this.lx.Gm().toString());var d=b.Gm()?wac_BO(b):b;d?wac_znc(this.kf,a.fe(),a.Vc(),d.Yc(),wac_CZ(d),wac_DZ(d),"{"+b.Gm().toString().toUpperCase()+"}",this.lx.Nd,c,this.Cse,this.Zgc):wac_Y(38279305,829,15,"Parent ShapeNode of a {0} is null",b.Gm()?"SmartArtSubShape":"NormalShape")},pve:function(a){if(a&&a.SuggestionResult){var b=a.CorrelationId,c=this.Rp.GOa(b);if(c)if(c.dv){b=null;try{b=Sys.Serialization.JavaScriptSerializer.deserialize(a.SuggestionResult)}catch(d){wac_Y(38625546,
829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - Deserialize exception: {0}",d)}if(b){c.v5e(wac_$ad(this,b));c.Kwa=new Date;if(c.UKa){if(wac_Ewc(this,c)){wac_Y(39184097,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - client suggestion timeout in {0}, expected in {1}",c.Hfe,this.ua.kye);this.lQ("ClientSuggestionTimeOut");return}wac_Y(38279317,829,50,"ReplaceIconManager::OnReplaceObjectResponse, response arrives before notification");wac_Trb(c,c.oqa()?c.oqa().length:0);wac_tZ(c,
!1);wac_Irb(this.Ru,c.Ay)}wac_Urb(this.Ru,c.Nd)}else this.lQ("ServerError"),wac_Y(38279311,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - suggestion result is null")}else wac_Y(38279315,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, sessio is not active . Selection might change to new shape, Current CorrelationId: {0}, Reponse CorrelationId: {1}",this.lx?this.lx.Nd:"",b);else wac_Y(38279313,829,50,"ReplaceIconManager::OnIconSuggestionResponseSuccess, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",
b)}else this.lQ("ServerError"),wac_Y(38279309,829,15,"ReplaceIconManager::OnIconSuggestionResponseSuccess - response object or reponse suggestionresult is null")},TUd:function(a){this.lQ("ServerError");wac_Y(38279319,829,15,"ReplaceIconManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",a.HttpStatusCode);return!0},$za:function(a){return wac_tG(this.Mp)?a.Gm()&&wac_zO(a)?(a=wac_BO(a),!!a&&!a.gA):!1:!1},lQ:function(a){this.lx&&(wac_sZ(this.Ru,this.lx.Ay,!0,!0,!1),
this.Rp.mJb(this.lx,a),this.lx=null)},tfe:function(a){return a?a.startsWith("<svg")?"data:image/svg+xml;charset=utf8,"+window.encodeURIComponent(a):"data:image/png;base64,"+a:null},ove:function(a,b){var c,d,e,f,g,h;b=b.OT;var k=c={val:c},l=d={val:d},m=e={val:e};a=f={val:f};k.val="";l.val=0;m.val=0;a.val=null;if(b){var n=b.split("|");if(4!==n.length)wac_Y(38279325,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue length is not equals to 4, actural:"+b.length),h=!1;else{k.val=n[0];
l.val=window.parseInt(n[1]);m.val=Number.parseInvariant(n[2]);m=n[3];b=l.val;k=[];if(m&&b){for(l=0;l<b;++l)n=(h=new wac_opb,h.index=l.toString(),h.labelText="",h.imageData=null,h.renderData=null,h),Array.add(k,n);h=m.split(";");if(h.length-1!==b)wac_Y(38618200,829,15,"ReplaceIconManager::CreateIconSuggestionsFromNotification, the suggestion counts parsing from suggestion string do not match, expected:{0}, actural:{1} ",k.length,b);else for(l=0;l<b;++l)m=h[l].indexOf(":"),0>m?wac_Y(38279321,829,15,
"ReplaceIconManager::CreateIconSuggestionsFromNotification, Suggestion string does not contain :"):k[l].labelText=h[l].substr(m+1)}a.val=k;h=!0}}else wac_Y(38279323,829,50,"ReplaceIconManager::ParseIconSuugestionNotification - docValue is null or empty"),h=!1;(g=h,c=c.val,d=d.val,e=e.val,f=f.val,g)?(g=this.Rp.GOa(c))?g.dv&&g.UKa?(h=g.Ay,e||(0>=d?(wac_Y(38279361,829,50,"ReplaceIconManager::OnReplaceObjectResponse, Reponse failed. CorrelationId {0}",c),this.lQ("NoSuggestions")):wac_Ewc(this,g)?(wac_Y(39184137,
829,15,"ReplaceIconManager::OnIconSuggestionNotification - client suggestion timeout in {0}, expected in {1}",g.Hfe,this.ua.kye),this.lQ("ClientSuggestionTimeOut")):(wac_tZ(g,!1),wac_Trb(g,d),g.v5e(f),wac_Y(38279363,829,50,"ReplaceIconManager::OnReplaceObjectResponse, get response from GetReplaceObject request, correlation id: {0}, suggestion count: {1}",g.Nd,g.TZ),wac_Irb(this.Ru,h)))):wac_Y(38279331,829,50,"ReplaceIconManager::OnIconSuggestionNotification: Skip notification since: IsSessionActive {2}, IsWaitingForResponse {3}. Current CorrelationId: {0}, Reponse CorrelationId: {1}",
this.lx?this.lx.Nd:"",c,g.dv,g.UKa):wac_Y(38279329,829,50,"ReplaceIconManager::OnIconSuggestionNotification, No session existing. Selection might change to new shape. Reponse CorrelationId: {0}",c):wac_Y(38279327,829,50,"ReplaceIconManager::OnIconSuggestionResponse, IconSuggestionnotification parse failed")}};function wac_Ewc(a,b){var c=new Date,d=b.U4;a=a.ua.kye;return c&&d&&0<a&&c-d>a?(b.Hfe=c-d,!0):!1}
function wac_$ad(a,b){var c=[];if(!b||!b.length)return c;for(var d=0;d<b.length;++d){var e,f=(e=new wac_opb,e.index=b[d].Index.toString(),e.labelText=b[d].Label,e.imageData=a.tfe(b[d].Render),e.renderData=a.tfe(b[d].Replace),e);Array.add(c,f)}return c}
function wac_8$(a,b,c,d,e,f,g,h,k,l,m,n,p){this.tdc=Function.createDelegate(this,this.AMd);this.sic=Function.createDelegate(this,this.e2d);this.G5c=Function.createDelegate(this,this.rxd);this.Mic=Function.createDelegate(this,this.G4d);this.U=b;this.ra=c;this.Ea=e;this.Kz=d;this.Ib=f;this.bP=g;this.Ru=m;this.Lc=n;this.jd=p;this.ha=a;this.Qg=h;this.Rp=k;this.nb=l}
wac_8$.prototype={ra:null,U:null,Kz:null,Ea:null,Ib:null,bP:null,ha:null,Qg:null,Rp:null,nb:null,Ru:null,Lc:null,jd:null,q6b:!1,qe:!1,Kn:function(){this.qe||(this.JQ(),this.Tb(),this.Lf(),this.qe=!0)},O:function(){this.qe&&(this.ije(),this.qe=!1)},JQ:function(){this.Kz.la.xa("CH",this.Mic)},ije:function(){this.Kz.la.sb("CH",this.Mic)},Tb:function(){this.U.jf(4041021629,1,this.G5c,4);this.U.jf(283636573,1,this.sic,4);this.U.jf(206307490,1,this.sic,4);this.U.jf(1534968859,1,this.tdc,4);this.U.jf(2657104201,
1,this.tdc,4)},Lf:function(){var a=this.ra.xc("editing"),b=this.ra.xc("document"),c=this.ra.xc("EditingReplaceObjectSuggestionsGalleryFocus");a.Ba(wac_A(13,2),206307490);b.Ba(wac_A(13,2),206307490);c.Ba(wac_A(13,2),206307490);c.Ba(wac_A(27,0),206307490);c.Ba(wac_A(37,0),1534968859);c.Ba(wac_A(39,0),2657104201)},G4d:function(){this.q6b||wac_Y(38279365,829,50,"ReplaceObjectActor::UpdateEditState, updating edit state");this.q6b=!0},rxd:function(a,b,c,d,e){if(!this.qe)return wac_Y(33698392,829,15,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - called before setup"),
16;b=this.Ea.Yj;if(!this.Ea.Ja()||!b||this.Ib.Ac(b))return 16;if(1===c)return 32;c=!0;d=null;wac_Qa.isInstanceOfType(e)?d=e:wac_gkc.isInstanceOfType(e)&&(d=e.cvd,c=!1);e=new wac_WN(wac_yF(d.ActiveSlideSid,d.ActiveSlideCid),d.ShapeId,d.SmartArtSubNodeId?wac_el(d.SmartArtSubNodeId):null);var f=new wac_oqb(e);this.bP.la.wa("ReplaceObjectBSA",f,null);var g=this.Rp.Ubc(e);if(g&&g.Yc()===d.ShapeId){var h=null;1===g.QN&&(h=wac_BO(g.Ay));var k=this,l=this;e=wac_kO(this.nb,15,function(){1===g.QN||wac_IJ(k.ha)||
(wac_Bnc(k.Qg),wac_GL(k.ha),wac_Cnc(k.Qg))},function(){h&&(wac_Bnc(l.Qg),wac_cU(l.ha,h,!0,!0),wac_Cnc(l.Qg))},!1);try{e.lb(b),e.jr(d.SmartArtSubNodeId?1095764407:a),wac_wN(b,wac_mva,d),g.uxb=d.SuggestionSid,g.vxb=d.Label,g.Dbc(!0),g.Nud=new Date,wac_Y(33698394,829,50,"ReplaceObjectActor::ApplyReplaceObjectSuggestion - CorrelationId: {0}, ActionId: {1}, SuggestionSid: {2}",d.CorrelationId,a,d.SuggestionSid)}finally{e&&e.dispose()}g.Goc=!0;wac_Frb(g,!0);c&&g.Cie();g.QN?h?this.Ib.cxa(b,h,this.Lc.Cb(),
a):wac_Y(38854750,808,15,"Invalid smartArtShape"):this.Ib.Ns(b,a)}else wac_Y(33863682,808,15,"Couldn't find active replaceObjectContext");return 32},e2d:function(a,b,c,d,e){if(!this.qe)return wac_Y(33698398,829,15,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery - called before setup"),16;b=this.Ea.Yj;if(!this.Ea.Ja()||!b||this.Ib.Ac(b))return 16;if(1===c)return 32;c=null;b=0;if(283636573===a){a=window.$$as(wac_1Y,e);if(!a)return 16;c=a.shape;b=a.action}else if(206307490===a){a=wac_5M(this.ha);
if(1!==a.length)return 32;c=a[0]}if(!c)return wac_Y(33698400,829,10,"ReplaceObjectActor::ShowHideReplaceObjectSuggestionsGallery, null shape."),16;a=this.Rp.Ubc(c.fsa());if(!a||!this.q6b&&a&&!a.QN)return 2;if(a&&a.dv&&a.Yc()===c.Yc())switch(wac_BM(this.ha),this.ra.ld(),b){case 0:e=this.Ru;a=a.Nd;e.qe?e.Pt.If()?((c=e.Rp.GOa(a))&&c.dv&&c.Nd===a&&e.WOa(c.Ay),wac_Grb(e,c.Ay)):wac_Hrb(e,a):wac_Y(25306503,829,15,"ReplaceObjectPresenter::ToggleSuggestionsGalleryView - called before setup");break;case 1:this.Ru.Pt.If()||
wac_Hrb(this.Ru,a.Nd);break;case 2:wac_Grb(this.Ru,c)}return 32},AMd:function(a,b,c){if(!this.qe)return wac_Y(33698396,829,15,"ReplaceObjectActor::NavigateReplaceObjectSuggestion - called before setup"),16;b=this.Ea.Yj;if(!this.Ea.Ja()||!b||this.Ib.Ac(b))return 16;if(1===c)return 32;if(!this.Ru.Pt.If())return 16;if(1534968859===a){a=this.Ru;if(a.qe){if(c=wac_abd(a.Pt))-1===c?a.Pt.gs(0,!0):(a.Pt.gs(c,!1),a.Pt.gs(c-1,!0))}else wac_Y(25306512,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionPrev - called before setup");
return 32}return 2657104201===a?(a=this.Ru,a.qe?(c=wac_abd(a.Pt),b=a.Pt,b.qe?b=b.dub:(wac_Y(25306574,829,15,"ReplaceObjectSuggestionsGalleryView::GetSuggestionCount - called before setup"),b=0),c+1!==b&&(-1===c?a.Pt.gs(0,!0):(a.Pt.gs(c,!1),a.Pt.gs(c+1,!0)))):wac_Y(25306514,829,15,"ReplaceObjectPresenter::NavigateReplaceObjectSuggestionNext - called before setup"),32):16}};function wac_BZ(a,b){this.nL=a;this.EFa=b}
wac_BZ.prototype={nL:null,EFa:null,Yd:function(){var a=this;this.nL.uc(function(b){b.peb(a.EFa.Hu(),a.EFa.sob(),a.EFa.dpb(),null)})}};function wac_1rb(a,b,c){this.qJa=Function.createDelegate(this,this.xQa);this.Vta=[];this.za=a;this.kf=b;this.FWc=c;this.jc()}
wac_1rb.prototype={za:null,kf:null,FWc:null,Vta:null,ua:null,N6a:function(a,b,c,d,e,f){this.dv&&this.lQ("NewSession");if(!a)throw Error.argumentNull("slide");var g=wac_Dnc(a,new wac_WN(a?wac_kJ(a):null,b,f));if(!g)throw Error.invalidOperation(String.format("slide doesn't have shape corresponds to shapeId: {0}",b));this.Ks=a;this.Ay=g;this.rx=b;this.aCc=f;this.Nd=wac_5k().toString();this.dv=!0;this.fM=c;this.DCb=d;this.ua=e;this.U4=new Date;a=this.Ay;this.QN=this.ua.Zge&&a&&this.aCc&&wac_zO(a)?1:0;
return this.Nd},Axa:function(a,b,c,d,e){return this.N6a(a,b,c,d,e,null)},lQ:function(a){if(this.dv&&(!this.Vta||!Array.contains(this.Vta,this.Nd))){var b={};b.SuggestionCount=this.TZ;b.ClientSuggestionTimeoutInMs=this.Hfe;b.IsApplied=this.YT;b.AppliedSuggestionId=this.YT?this.uxb.toString():"";b.AppliedSuggestionLabel=this.YT?this.vxb:"";b.IsFloatieShown=this.Fzb;b.IsGalleryShown=this.Jzb;b.Trigger=this.fM;b.RetriggerReason=this.DCb;b.ResetReason=a;b.IconId=this.ua.zCb;b.SlideCID=this.Ks.fe();b.SlideSID=
this.Ks.Vc();b.ShapeID=this.rx;b.AnimId=this.ua.wCb;b.AnimEnabled=this.ua.yCb;b.GalleryHoverEnabled=this.ua.xCb;b.ReplaceSuggestionType=wac_Uba.toString(this.QN);b.SeeMoreButtonClicked=this.Fje;b.SeeMoreIconName=this.Fje?this.CBe:"";this.U4&&(b.SessionLiveTimeInMs=new Date-this.U4);this.aCc&&(b.SmartArtSubNodeId=this.aCc.toString());this.T4&&this.Kwa&&this.Kwa>this.T4&&(b.SuggestionsReadyInMs=this.Kwa-this.T4);0<this.SLa&&(b.SuggestionsDisplayedForMs=this.SLa);0<this.vva&&(b.FloatieDisplayedForMs=
this.vva);this.T4&&this.U4&&this.T4>this.U4&&(b.FloatieReadyInMs=this.T4-this.U4);this.U4&&this.ZLa&&this.U4>this.ZLa&&(b.TriggeredByAugLoopInMs=this.U4-this.ZLa);this.Nud&&this.vCc&&this.vCc>this.Nud&&(b.SuggestionAppliedInMs=this.vCc-this.Nud);if(0<this.RD.length){a=[];for(var c=0;c<this.RD.length;c++)Array.add(a,this.RD[c].labelText);b.SuggestionLabels=JSON.stringify(a)}1===this.QN&&this.U$b&&(a=wac_Wf(this.U$b))&&a.hasChildNodes()&&(wac__f(),a=this.U$b,wac_xl.removeChild(wac_yka[a]),wac_yka[a]=
null);wac_rob(this.kf,this.Nd,JSON.stringify(b),this.qJa);b=this.Nd;this.Vta&&!Array.contains(this.Vta,b)&&(Array.add(this.Vta,b),wac_Y(25012102,829,50,"ReplaceObjectContext::MarkCorrelationAsHandled - CorrelationId: {0}; handled correlations count: {1}",b,this.Vta.length))}this.jc()},jc:function(){this.dv=!1;this.Ks=null;this.Goc=this.Jzb=this.Fzb=this.B6a=this.YT=this.CZ=!1;this.DCb=this.fM=this.Nd="";this.RD=[];this.uxb=0;this.vxb="";this.UKa=!1;this.Hfe=this.TZ=0;this.vCc=this.Nud=this.mDb=this.Kwa=
this.$La=this.T4=this.ZLa=this.U4=null;this.QN=this.vva=this.SLa=0;this.U$b="";this.Ay=null;this.Fje=!1;this.CBe=""},xQa:function(a){wac_Y(37586196,829,15,"ReplaceObjectContext::OnFailureCallback - request failed with: {0}. returning true to prevent ACE.",a.HttpStatusCode);return!0},Cie:function(){wac_0nc(this,2,4)},Ks:null,Ay:null,rx:0,Yc:function(){return this.rx},Iua:function(a){return this.rx=a},aCc:null,Gm:function(){return this.aCc},QN:0,CZ:!1,uxb:0,vxb:null,YT:!1,Dbc:function(a){return this.YT=
a},B6a:!1,Fzb:!1,Jzb:!1,U4:null,ZLa:null,T4:null,$La:null,Kwa:null,mDb:null,Nud:null,vCc:null,SLa:0,vva:0,Nd:null,fM:null,DCb:null,UKa:!1,RD:null,oqa:function(){return this.RD},v5e:function(a){return this.RD=a},TZ:0,Hfe:0,Goc:!1,U$b:null,Fje:!1,CBe:null,dv:!1,fsa:function(){return new wac_WN(this.Ks?wac_kJ(this.Ks):null,this.rx,this.aCc)}};function wac_Trb(a,b){a.TZ=b}function wac_tZ(a,b){a.UKa=b}function wac_Frb(a,b){a.B6a=b}function wac_Vrb(a,b){a.CZ=b}
function wac_0nc(a,b,c){a.FWc&&a.FWc.uc(function(a){var e,f=(e=new wac_jkc,e.cardId="EntityGroup.Designer.TextToSmartArt.Suggestion",e.actionType=b,e.actionEngagement=c,e);a.Cfe(f)})}function wac_Yrb(){this.la=new wac_Re}wac_Yrb.prototype={Loe:function(a){this.la.wa("ReplaceObjectSPOver",a,null)},Koe:function(a){this.la.wa("ReplaceObjectSPOut",a,null)}};
function wac_6rb(a,b,c,d,e,f,g,h,k,l,m,n,p,q){this.Agd=Function.createDelegate(this,this.Jcb);this.$Ia=Function.createDelegate(this,this.sl);this.Xia=a;this.HO=b;this.IYc=c;this.MYc=d;this.F6b=n.zCb;this.O3b=n.wCb;this.P3b=n.yCb;this.iT=f;this.mja=e;this.oc=g;this.Xo=h;this.FY=k;this.faa=l;this.gh=m;this.tre=p;this.NCb=q;this.qe=!1}
wac_6rb.prototype={An:null,HO:0,IYc:null,MYc:null,F6b:0,O3b:0,iT:null,mja:null,oc:null,Xo:null,FY:null,faa:null,gh:null,Xia:null,P3b:!1,tre:0,NCb:null,fY:null,F2b:function(){return 1===this.tre?ResourceStrings.l_ReplaceIconSuggestionFloatieTooltip:this.NCb.uyb?ResourceStrings.l_ReplaceObjectGrayFloatieTooltip:ResourceStrings.l_ReplaceObjectFloatieTooltip},qe:!1,Kn:function(){this.qe||(this.An=new wac_FG,this.fY=new wac_fnb(this.mja.gh),this.An.Oa.style.visibility="inherit",this.sca(),this.qe=!0)},
ofe:function(){wac_Wnc(this.NCb,this.$Ia);this.m5();this.lfb(!1);Sys.UI.DomElement.containsCssClass(this.An.Oa,"replaceObjectGrayedFlyoutAnchor")||wac_IG(this.An,"replaceObjectGrayedFlyoutAnchor")},Ki:function(){this.qe?this.lfb(this.P3b):wac_Y(38072907,829,15,"ReplaceObjectFlyoutAnchor::Show - called before setup")},pfe:function(){this.NCb.uyb=!1;this.m5();this.lfb(!1);wac_Z3c(this.An,"replaceObjectGrayedFlyoutAnchor")},lfb:function(a){this.qe?this.fY.jea(wac_1nc(this,a),""):wac_Y(25306443,829,15,
"ReplaceObjectFlyoutAnchor::SetGlyph - called before setup")},m5:function(){this.qe?(this.fY.ie(),wac_mO(this.An.Oa,"replaceObjectFlyoutAnchorBase"),wac_mO(this.An.Oa,"replaceObjectFlyoutAnchor"+this.F6b),this.P3b&&(wac_mO(this.An.Oa,"replaceObjectFlyoutAnchorAnimBase"),wac_mO(this.An.Oa,"replaceObjectFlyoutAnchorAnim"+this.O3b))):wac_Y(25306445,829,15,"ReplaceObjectFlyoutAnchor::ClearGlyph - called before setup")},O:function(){this.qe&&(this.jje(),this.An&&this.An.Oa.parentNode&&this.An.Sr(),this.sl(),
this.fY.O(),this.An=null,this.qe=!1)},sl:function(){this.qe?(this.m5(),this.Xia.Oa.style.visibility="hidden"):wac_Y(25306447,829,15,"ReplaceObjectFlyoutAnchor::Dismiss - called before setup")},sca:function(){this.Xia?(this.An.Oa.style.width=this.gh.CJ(this.HO),this.An.Oa.style.height=this.gh.CJ(this.HO),this.An.Oa.setAttribute("role","button"),this.Xia.Ce(this.An),this.fY.sca(this.An.Oa),this.pRa()):wac_Y(25306449,829,15,"ReplaceObjectFlyoutAnchor::BuildDom - parentElement is null")},Jcb:function(){return!0},
pRa:function(){this.FY&&this.oc.ya("click",this.An.Oa,this.FY);this.oc.ya("dblclick",this.An.Oa,this.Agd);this.faa&&(this.Xo.ya("msospPointerOver",this.An.Oa,this.faa),this.Xo.ya("msospPointerOver",this.An.Oa.firstChild,this.faa),this.Xo.ya("msospPointerOver",this.An.Oa.firstChild.firstChild,this.faa))},jje:function(){this.FY&&this.oc.ub("click",this.An.Oa,this.FY);this.oc.ub("dblclick",this.An.Oa,this.Agd);this.faa&&(this.Xo.ub("msospPointerOver",this.An.Oa,this.faa),this.Xo.ub("msospPointerOver",
this.An.Oa.firstChild,this.faa),this.Xo.ub("msospPointerOver",this.An.Oa.firstChild.firstChild,this.faa))}};function wac_1nc(a,b){var c=wac_dnb(a.iT,a.HO,a.HO,a.IYc,a.MYc,a.F2b(),null);wac_aH(a.An.Oa,"replaceObjectFlyoutAnchorBase");wac_aH(a.An.Oa,"replaceObjectFlyoutAnchor"+a.F6b);b&&(wac_aH(a.An.Oa,"replaceObjectFlyoutAnchorAnimBase"),wac_aH(a.An.Oa,"replaceObjectFlyoutAnchorAnim"+a.O3b));return c}
function wac_2rb(a,b,c,d,e,f,g,h,k,l,m,n,p,q,r,t,v,u,w,x,z){this.Zgc=Function.createDelegate(this,this.TUd);wac_2rb.initializeBase(this,[f,a,b,c,d,e,g,h,k,l,m,p,q,r,t,u,w,x,z]);this.Te=h.mxc();this.kf=n;this.ua=v}
wac_2rb.prototype={Te:null,kf:null,ua:null,MM:function(a,b){if(!this.qe)wac_Y(25306451,829,15,"ReplaceObjectManager::OnSelectionChanged - called before setup");else if(!this.$rb&&b.ds.length)if(a=wac_5M(this.ha),1!==a.length)this.Te.dv&&this.nM(this.Te,"SelectionChanged");else{a=a[0];if(this.Te.dv){if(this.Te.Yc()===a.Yc())return;this.nM(this.Te,"SelectionChanged")}this.$za(a)&&this.HG(this.Ea.Ja(),a,"SelectShape","")}},bBc:function(a,b){this.qe?this.Te.dv&&this.Te.Ay===b.Ay&&(a=this.Te.Ay,this.nM(this.Te,
"ShapePositionChanged"),this.$za(a)&&this.HG(this.Ea.Ja(),a,"Retrigger","ShapePositionChanged")):wac_Y(25306453,829,15,"ReplaceObjectManager::OnReplaceObjectViewDragEnd - called before setup")},Jye:function(a,b){b.MKa&&this.cE(b.Ii)},RG:function(){this.Te.dv&&this.nM(this.Te,"SlideNavigation")},Dda:function(a,b){this.Te.dv&&b.DKa&&b.yq&&Array.contains(b.yq,this.Te.Yc())&&this.nM(this.Te,"ShapePresence")},aBc:function(a,b){b.Nd!==this.Te.Nd?wac_Y(25236289,829,15,"ReplaceObjectManager::OnReplaceObjectResponse, Current CorrelationId: {0}, Reponse CorrelationId: {1}",
this.Te.Nd,b.Nd):wac_Snc(this,b,this.Te,this.ua)},zAc:function(){this.qe&&this.Te.B6a&&!this.Te.QN&&!this.Ib.Ac(this.Ea.Yj)&&(wac_Frb(this.Te,!1),wac_sZ(this.Ru,this.Te.Ay,!0,!0,!1))},HG:function(a,b,c,d){try{var e=this.Te.Axa(a,b.Yc(),c,d,this.ua);wac_tZ(this.Te,!0);this.Ru.Ggb(this.Te.Nd);wac_sob(this.kf,a.fe(),a.Vc(),b.Yc(),e,c,wac_CZ(b),wac_DZ(b),null,this.Zgc);this.ua.zy&&wac_qZ(this,e,this.Te.Yc(),this.Te.oqa(),"Pending")}catch(f){wac_Y(34152532,829,15,"GenerateSuggestion failed!! {0} ",f.message)}},
TUd:function(a){wac_Y(36966422,829,15,"ReplaceObjectManager::OnTaskFailure - request failed with response {0}. returning true to avoid ACE",a.HttpStatusCode);return!0},cE:function(a){this.qe?this.Te.dv&&!this.yfe(a)&&this.nM(this.Te,"WebActionId:"+this.g$.ETd(a)):wac_Y(25306497,829,15,"ReplaceObjectManager::HandleAction - called before setup")},nM:function(a,b){a.CZ&&wac_sZ(this.Ru,a.Ay,!0,!0,!1);a.lQ(b);this.ua.zy&&wac_qZ(this,a.Nd,a.Yc(),a.oqa(),"NoResult")}};
function wac_xZ(a){this.kja=[];this.$$ge=this.GetEnumerator;this.c2c=a}
wac_xZ.prototype={c2c:null,mJb:function(a,b){a&&(a.lQ(b),Array.remove(this.kja,a))},GOa:function(a){for(var b=this.kja,c=b.length,d=0;d<c;++d){var e=b[d];if(e.Nd===a)return e}return null},Ubc:function(a){for(var b=this.kja,c=b.length,d=0;d<c;++d){var e=b[d];if(wac_Enc(a,e.fsa()))return e}return null},jJ:function(a){a:{for(var b=this.kja,c=b.length,d=0;d<c;++d){var e=b[d];if(e.Yc()===a&&!e.Gm()){a=e;break a}}a=null}return a},mxc:function(){return 0<this.kja.length?this.kja[0]:null},N6a:function(a,
b,c,d,e,f){var g=this.Ubc(new wac_WN(wac_kJ(a),b,f));g&&this.mJb(g,"NewSession");g=this.c2c(a,b,c,d,e,f);Array.add(this.kja,g);return g},Axa:function(a,b,c,d,e){return this.N6a(a,b,c,d,e,null)},ETc:function(){var a=0;Array.forEach(this.kja,function(b){b.dv&&a++});return a}};wac_xZ.prototype.GetEnumerator=function(){return new (wac_EZ.$$(wac_Nrb))(this.kja)};wac_xZ.prototype.GetEnumerator=wac_xZ.prototype.GetEnumerator;
function wac_EZ(a){this.gr=-1;this.$$cu=this.get_Current;this.$$mn=this.MoveNext;this.$$rst=this.Reset;this.Ppb=Array.clone(a)}
wac_EZ.$$=function(a){var b=wac_xZ.__tc=wac_xZ.__tc||{},c="ArrayEnumerator$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_EZ.apply(this,a)};d.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectMultipleContextManager.__tc."+c,null,Sys.Ny);d.prototype.jb={"PowerPointWebEditor.ReplaceObject.ReplaceObjectMultipleContextManager.ArrayEnumerator$1":{T:a},ctor:wac_EZ};a=wac_EZ.prototype;for(var e in a){var f={key:e,
value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};wac_EZ.prototype={Ppb:null};wac_EZ.prototype.Oi=function(){if(-1===this.gr||this.gr>=this.Ppb.length)throw Error.invalidOperation();return this.Ppb[this.gr]};wac_EZ.prototype.get_Current=wac_EZ.prototype.Oi;wac_EZ.prototype.Wb=function(){this.gr++;return this.gr<this.Ppb.length};wac_EZ.prototype.MoveNext=wac_EZ.prototype.Wb;wac_EZ.prototype.jc=function(){this.gr=-1};wac_EZ.prototype.Reset=wac_EZ.prototype.jc;
function wac_zZ(a,b,c,d,e,f,g,h,k,l,m){this.Ifc=Function.createDelegate(this,this.zSd);this.Jfc=Function.createDelegate(this,this.ASd);this.Rdc=Function.createDelegate(this,this.YNd);this.Ea=a;this.a$b=b;this.e2c=c;this.za=d;this.Ej=g;this.SY=f;this.Rp=e;this.Pt=h;this.ra=k;this.Vg=l;this.jd=m;this.qe=!1;this.EZ=-1}
wac_zZ.prototype={Ea:null,a$b:null,e2c:null,SY:null,Rp:null,Pt:null,Ej:null,za:null,jd:null,ra:null,Vg:0,qe:!1,EZ:0,Kn:function(){this.qe||(this.SY.la.xa("ReplaceObjectBSA",this.Rdc),this.SY.la.xa("ReplaceObjectSPOver",this.Jfc),this.SY.la.xa("ReplaceObjectSPOut",this.Ifc),this.qe=!0)},O:function(){this.qe&&(this.SY.la.sb("ReplaceObjectBSA",this.Rdc),this.SY.la.sb("ReplaceObjectSPOver",this.Jfc),this.SY.la.sb("ReplaceObjectSPOut",this.Ifc),this.qe=!1)},YNd:function(a,b){(a=wac_Dnc(this.Ea.Ja(),b.Qne))&&
wac_sZ(this,a,!1,!0,!1)},ASd:function(a,b){this.Ea.Ja()&&(a=new wac_WN(wac_kJ(this.Ea.Ja()),b.rx,b.Fac),(a=wac_Dnc(this.Ea.Ja(),a))&&this.NQb(a,b.Klc))},zSd:function(a,b){this.Ea.Ja()&&(a=new wac_WN(wac_kJ(this.Ea.Ja()),b.rx,b.Fac),(a=wac_Dnc(this.Ea.Ja(),a))&&this.WOa(a))},NQb:function(a,b){var c=a;a.Gm()&&(c=wac_BO(a));if(a=wac_8rb(this,c))wac_9rb(this,c,!1),a.NQb(b)},WOa:function(a){var b=a;a.Gm()&&(b=wac_BO(a));if(a=wac_8rb(this,b))wac_9rb(this,b,!0),a.WOa()},Ggb:function(a){this.Pt.Ggb(a)}};
function wac_9rb(a,b,c){b&&(a=window.$$as(wac_5J,wac_T(b,a.Vg)))&&((a=a.$c())?a.Ud(c):wac_Y(25306516,829,10,"ReplaceObjectPresenter::ShowHideShape,shapeViewDiv is null"))}function wac_Urb(a,b){a.qe?a.Pt.If()&&wac_Hrb(a,b):wac_Y(25306510,829,15,"ReplaceObjectPresenter::RefreshSuggestionsGallery - called before setup")}
function wac_Hrb(a,b){var c=a.Rp.GOa(b);if(c&&c.Nd===b&&c.dv){var d=wac_$rb(a,c.Ay);if(d){var e=d.Uc();e?a.Pt.If()&&a.Pt.Te&&!wac_Enc(a.Pt.Te.fsa(),c.fsa())||(e=a.Ej.Vs(e),a.Pt.Ki(b,e.x,e.y),d.Uc().style.zIndex=wac_r().oB(),wac_iN(a.ra,"EditingReplaceObjectSuggestionsGalleryFocus",!0),c.Jzb=!0):wac_Y(25306508,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - rootElem is null")}else wac_Y(25306506,829,10,"ReplaceObjectPresenter::ShowSuggestionsGallery - replaceObjectView is null")}}
function wac_Grb(a,b){a.Pt.If()&&a.Pt.Te&&wac_Enc(a.Pt.Te.fsa(),b.fsa())&&(a.Pt.sl(),(b=wac_$rb(a,a.Pt.Te.Ay))&&b.Uc()&&(b.Uc().style.zIndex=0),wac_iN(a.ra,"EditingReplaceObjectSuggestionsGalleryFocus",!1))}
function wac_sZ(a,b,c,d,e){a.qe?b&&(c&&a.WOa(b),d&&wac_Grb(a,b),c=wac_$rb(a,b))&&(e?(c.ofe(),a.EZ=b.Yc()):(a.EZ===b.Yc()&&(a.EZ=-1),c.Cg()&&c.sl(),(a=a.Rp.Ubc(b.fsa()))&&b.Yc()===a.Yc()&&wac_Vrb(a,!1))):wac_Y(25306501,829,15,"ReplaceObjectPresenter::RemoveShapeReplaceObjectView - called before setup")}
function wac_Irb(a,b){if(!a.qe)wac_Y(25306499,829,15,"ReplaceObjectPresenter::ShowShapeReplaceObjectView - called before setup");else if(b){var c;if(c=b&&window.$$as(wac_5J,wac_T(b,a.Vg))?wac_cO(a.a$b,b):null){var d=a.Rp.Ubc(b.fsa());if(d&&(!d.CZ||a.EZ===d.Yc())){if(d.CZ)a.EZ===d.Yc()&&(c.pfe(),a.EZ=-1);else{var e=!(a.Pt.Te&&a.Pt.If()&&wac_Enc(b.fsa(),a.Pt.Te.fsa()));wac_sZ(a,b,!0,e,!1);c.qQ()}wac_Vrb(d,!0)}}}}function wac_$rb(a,b){return b&&window.$$as(wac_5J,wac_T(b,a.Vg))?a.a$b.My(b):null}
function wac_8rb(a,b){return b&&!b.Gm()&&window.$$as(wac_5J,wac_T(b,a.Vg))?wac_cO(a.e2c,b):null}function wac_asb(a,b){this.Bs=a;this.gh=b;this.qe=!1}
wac_asb.prototype={gh:null,Bs:null,qe:!1,R3:null,Kn:function(){this.qe||(this.R3=new wac_FG,this.sca(),this.qe=!0)},sca:function(){this.Bs?(this.Bs.appendChild(this.R3.Oa),wac_aH(this.R3.Oa,"replaceObjectPreviewContainer"),this.R3.le(!1)):wac_Y(25306518,829,15,"ReplaceObjectPreviewImageView::BuildDom - parentElement is null")},jea:function(a){if(this.qe){if(a=this.Fca(a))this.tRa(),this.R3.Oa.appendChild(a),this.R3.le(!0)}else wac_Y(25306520,829,15,"ReplaceObjectPreviewImageView::SetImage - called before setup")},
qh:function(a,b){this.qe?this.R3.qh(a,b):wac_Y(25306522,829,15,"ReplaceObjectPreviewImageView::SetSize - called before setup")},O:function(){this.qe&&(this.sl(),this.R3&&this.R3.Oa.parentNode&&(this.R3.Sr(),wac_mO(this.R3.Oa,"replaceObjectPreviewContainer")),this.R3=null)},sl:function(){this.qe?(this.tRa(),this.R3.le(!1)):wac_Y(25306524,829,15,"ReplaceObjectPreviewImageView::Dismiss - called before setup")},Fca:function(a){if(a){var b=wac_SG();b.setAttribute("Unselectable","on");b.src=a;b.style.height=
"100%";b.style.width="100%";return b}return null},tRa:function(){this.R3.Oa.firstChild&&this.R3.Oa.removeChild(this.R3.Oa.firstChild)}};function wac_bsb(){}wac_bsb.prototype={rEc:0,pEc:0,UDc:0,tza:null,YNb:0};function wac_0rb(a,b,c){this.eua=[];this.kf=a;this.Ej=b;this.Hke=c}wac_0rb.prototype={kf:null,Ej:null,Hke:!1};
function wac_csb(a,b){Array.remove(a.eua,b);b.tza&&b.tza.dv&&(wac_Y(34144975,829,50,"ReplaceObjectRequestManager - Send pending request: {0}; {1} were in queue and skipped",b.tza.Nd,b.YNb-1),wac_Wrb(a,b.tza))}
function wac_Wrb(a,b){var c=wac_dsb(a,b.Ks.Vc(),b.Ks.fe(),b.Yc());if(c)return c.tza=b,c.YNb++,1;var d,e=(d=new wac_bsb,d.rEc=b.Ks.Vc(),d.pEc=b.Ks.fe(),d.UDc=b.Yc(),d.YNb=0,d.tza=null,d);Array.add(a.eua,e);wac_tZ(b,!0);c=b.Nd;d=b.Ks;var f=b.Ay;wac_sob(a.kf,d.fe(),d.Vc(),f.Yc(),c,b.fM,a.Hke?wac_CZ(f):wac_Znc(a.Ej,f),a.Hke?wac_DZ(f):wac__nc(a.Ej,f),function(){wac_csb(a,e)},function(b){wac_csb(a,e);wac_Y(36966425,829,15,"SendGenerateReplaceObjectRequest - request failed with response {0}. returning true to avoid ACE.",
b.HttpStatusCode);return!0});return 0}function wac_dsb(a,b,c,d){for(var e=0;e<a.eua.length;e++)if(a.eua[e].rEc===b&&a.eua[e].pEc===c&&a.eua[e].UDc===d)return a.eua[e];return null}function wac_yZ(a){this.$$ge=this.GetEnumerator;this.Te=a}
wac_yZ.prototype={Te:null,mJb:function(a,b){a&&a===this.Te&&a.lQ(b)},GOa:function(){return this.Te},Ubc:function(){return this.Te},jJ:function(){return this.Te},mxc:function(){return this.Te},N6a:function(a,b,c,d,e,f){this.Te.N6a(a,b,c,d,e,f);return this.Te},Axa:function(a,b,c,d,e){return this.N6a(a,b,c,d,e,null)},ETc:function(){return this.Te.dv?1:0}};wac_yZ.prototype.GetEnumerator=function(){return new (wac_FZ.$$(wac_Nrb))(this.Te)};wac_yZ.prototype.GetEnumerator=wac_yZ.prototype.GetEnumerator;
function wac_FZ(a){this.L$=this.jb["PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1"].T===Number||Type.isEnum(this.jb["PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1"].T)?0:this.jb["PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1"].T===Boolean?!1:null;this.$$cu=this.get_Current;this.$$mn=this.MoveNext;this.$$rst=this.Reset;this.L$=a}
wac_FZ.$$=function(a){var b=wac_yZ.__tc=wac_yZ.__tc||{},c="SingleEnumerator$1$"+a.getName().replace(/\./g,"_");if(!b[c]){var d=b[c]=function(){for(var a=[],b=0;b<arguments.length;++b)a[b]=arguments[b];wac_FZ.apply(this,a)};d.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.__tc."+c,null,Sys.Ny);d.prototype.jb={"PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager.SingleEnumerator$1":{T:a},ctor:wac_FZ};a=wac_FZ.prototype;for(var e in a){var f={key:e,
value:a[e]};"constructor"!==f.key&&(d.prototype[f.key]=f.value)}}return b[c]};wac_FZ.prototype={k7b:!0};wac_FZ.prototype.Oi=function(){return this.L$};wac_FZ.prototype.get_Current=wac_FZ.prototype.Oi;wac_FZ.prototype.Wb=function(){return this.k7b?(this.k7b=!1,!0):!1};wac_FZ.prototype.MoveNext=wac_FZ.prototype.Wb;wac_FZ.prototype.jc=function(){this.k7b=!0};wac_FZ.prototype.Reset=wac_FZ.prototype.jc;
function wac_4rb(a,b,c,d,e){this.dispose=this.O;this.ix=a;this.kD=b;this.nD=c;this.Ej=e;this.mja=d;this.qe=!1}
wac_4rb.prototype={ix:null,kD:null,nD:null,Ej:null,mja:null,JHa:null,HWc:!1,aIa:!1,bT:null,Xt:!1,Cg:function(){return this.Xt},te:function(a){return this.Xt=a},qe:!1,Kn:function(){if(!this.qe){this.bT=new wac_FG;var a=new wac_asb(this.bT.Oa,this.mja.gh);a.Kn();this.JHa=a;this.kD&&!this.kD.Fu()&&this.kD.Gs&&(this.kD.Gs.Ce(this.bT),this.Ud(!1),this.aIa=!0,wac_eO(this.kD,this,3),this.Xt=wac_sK(this.kD)||this.kD.Mv());this.qe=!0}},Cm:function(){wac_Y(25306526,829,15,"ReplaceObjectSuggestionPreviewView::BuildDomElements - shouldn't be called")},
rE:function(){},Ur:function(){if(!this.qe)return wac_Y(36827549,829,15,"ReplaceObjectSuggestionPreviewView::GetVisibleBoundingRegion - called before setup"),null;if(!this.HWc||!this.JHa.qe||!this.JHa.R3)return null;var a=wac_OG(this.JHa.R3.Oa.style.left),b=wac_OG(this.JHa.R3.Oa.style.top),c=wac_OG(this.JHa.R3.Oa.style.width),d=wac_OG(this.JHa.R3.Oa.style.height);return new wac_eF(new wac_1(a,b),new wac_1(a+c,b),new wac_1(a+c,b+d),new wac_1(a,b+d))},JG:function(){return!1},ou:function(){},kv:function(){},
Vd:function(){},jj:function(){this.aIa=!0;this.jt()},mo:function(){this.aIa=!0;this.jt()},ur:function(){this.aIa=!0;this.jt()},Mo:function(a){this.bT&&this.bT.ht(a)},uv:function(){},gu:function(){return null},Sy:function(){return[]},Hy:function(){},O:function(){this.nD();this.qe&&(this.JHa.O(),this.bT.Oa.parentNode&&this.bT.Sr(),this.bT=null,this.qe=!1)},NQb:function(a){this.qe?(this.lfb(a),this.jt()):wac_Y(25306562,829,15,"ReplaceObjectSuggestionPreviewView::ShowSuggestionPreview - called before setup")},
WOa:function(){this.qe?this.m5():wac_Y(25306564,829,15,"ReplaceObjectSuggestionPreviewView::HideSuggestionPreview - called before setup")},lfb:function(a){this.qe?(this.JHa.jea(a),this.Ud(!0)):wac_Y(25306566,829,15,"ReplaceObjectSuggestionPreviewView::SetGlyph - called before setup")},m5:function(){this.qe?(this.JHa.sl(),this.Ud(!1)):wac_Y(25306568,829,15,"ReplaceObjectSuggestionPreviewView::ClearGlyph - called before setup")},Zb:function(){},jt:function(){if(this.HWc&&this.aIa){var a=wac_Znc(this.Ej,
this.ix),b=wac__nc(this.Ej,this.ix);this.qh(a,b);if(this.bT){a=this.ix;if(!a)throw Error.argumentNull("shape");a=wac_IGc(a);a=wac_3E(wac_GZ(a.TopLeft),wac_GZ(a.TopRight));wac_5ja(this.bT.Oa,wac_Qf(a))}this.aIa=!1}},Ud:function(a){this.HWc=a;this.bT.Ud(a)},qh:function(a,b){this.JHa&&this.JHa.qh(a,b)}};
function wac_Zrb(a,b,c,d,e,f,g,h,k,l,m){this.Tvb=Function.createDelegate(this,this.xMb);this.wJa=Function.createDelegate(this,this.DQa);this.Wvb=Function.createDelegate(this,this.AMb);this.Vvb=Function.createDelegate(this,this.zMb);this.Xvb=Function.createDelegate(this,this.BMb);this.Uvb=Function.createDelegate(this,this.yMb);this.TB=Function.createDelegate(this,this.pV);this.wT=Function.createDelegate(this,this.D6);this.F4a=Function.createDelegate(this,this.gJb);this.Nk=Function.createDelegate(this,
this.as);this.Ule=Function.createDelegate(this,this.tve);this.Y5b=-1;this.gh=a;this.oc=c;this.Xo=b;this.Ea=d;this.U=e;this.Gt=k;this.bP=f;this.Rp=g;this.Z2=h;this.ra=l;this.ua=m;this.nre=!wac_Ek();this.qe=this.Rva=!1}
wac_Zrb.prototype={ra:null,gh:null,oc:null,Xo:null,Ea:null,U:null,bP:null,Rp:null,Z2:null,Gt:null,ua:null,nre:!1,Zl:null,IKb:null,iqb:null,lja:null,iY:null,o6b:null,dub:0,Te:null,qe:!1,Rva:!1,If:function(){return this.Rva},Kn:function(){this.qe||(this.Zl=wac_eH(),this.Zl.setAttribute("Unselectable","on"),this.Zl.style.position="absolute",wac_aH(this.Zl,"replaceObjectContainer"),wac_esb(this,null),document.body.appendChild(this.Zl),this.pRa(),this.Gt.E_("EditingReplaceObjectSuggestionsGalleryFocus",
"main",this.Zl,function(){},function(){},!0,null),this.qe=!0)},O:function(){this.qe&&(this.sl(),this.CSa(),this.Zl&&this.Zl.parentNode&&this.Zl.parentNode.removeChild(this.Zl),this.qe=!1)},sl:function(){this.qe?(wac_r().ZD(!0),this.le(!1),this.y2().style.display="none",this.y2().style.zIndex=-1,this.o6b=this.iY=null,wac_esb(this,null)):wac_Y(25306570,829,15,"ReplaceObjectSuggestionsGalleryView::Dismiss - called before setup")},Ki:function(a,b,c){if(!this.qe)wac_Y(25306572,829,15,"ReplaceObjectSuggestionsGalleryView::Show - called before setup");
else if(a){var d=this.Rp.GOa(a);if(d&&d.Nd===a&&d.dv&&!d.UKa){this.Te=d;var e=this.Te.oqa();wac_esb(this,a);if(a)if(e&&e.length){d=document.createElement("ul");d.id=a;d.setAttribute("Unselectable","on");d.setAttribute("role","menu");wac_aH(d,"replaceObjectSuggestionsList");this.iY||(this.iY=new (wac_rb.$$(String)));this.o6b||(this.o6b=new (wac_rb.$$(String)));a=e.length;for(var f=0;f<a;++f){var g=e[f];!g.imageData||this.iY.vf(g.index,g.imageData);wac_r$(this)&&g.renderData&&this.o6b.vf(g.index,g.renderData);
var h=g.index,g=g.labelText,k=this.iY.mc(h),l=k?this.iY.K(h):wac_Le("progress.gif");k||wac_Y(38340484,829,15,"ReplaceObjectSuggestionsGalleryView::spinner shows up");var m=wac_SG();m.setAttribute("Unselectable","on");m.src=l;m.title=g;m.setAttribute("role","presentation");wac_aH(m,"replaceObjectSuggestionThumbnail");l=wac_0O();l.id="ROS_"+h;l.setAttribute("Unselectable","on");l.title=g;l.setAttribute("role","menuitem");var n=wac_r$(this)?"replaceIconObjectSuggestionContainer":"replaceObjectSuggestionContainer";
this.Te.YT&&this.Te.uxb.toString()===h&&(n+="Selected");wac_aH(l,n);k||wac_aH(l,"ReplaceObjectSuggestionLoading");l.appendChild(m);h=document.createElement("li");h.setAttribute("Unselectable","on");h.setAttribute("tabindex","-1");h.setAttribute("role","presentation");h.setAttribute("aria-label",g);h.appendChild(l);d.appendChild(h)}if(this.nre&&0<this.o6b.Ma()&&wac_r$(this)&&(this.Te.U$b||(e=this.Te,a=wac_bl().toString(),e.U$b=a),(e=wac_Wf(this.Te.U$b))&&!e.hasChildNodes())){e.style.position="absolute";
e.style.left="0px";e.style.top="0px";for(a=this.o6b.uB().$$ge();a.$$mn();)f=a.$$cu(),h=wac_SG(),h.src=f,h.style.display="block",h.style.position="absolute",e.appendChild(h);wac_Zf()}}else wac_Y(25012109,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Requires atleast one suggestion to display."),d=null;else wac_Y(25012107,829,10,"ReplaceObjectSuggestionsGalleryView::CreateSuggestionList - Empty correlationId"),d=null;d&&(e=wac_fH(),e.setAttribute("Unselectable","on"),wac_r$(this)?
(e.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryTitle,wac_aH(e,"replaceIconObjectContainerTitle")):(e.innerText=ResourceStrings.l_ReplaceObjectSuggestionGalleryTitle1,wac_mO(e,"replaceIconObjectContainerTitle")),wac_aH(e,"UIFont replaceObjectContainerTitle"),this.Zl.appendChild(e),this.Zl.appendChild(d),wac_r$(this)&&(this.IKb=wac_fH(),this.IKb.setAttribute("Unselectable","on"),this.IKb.setAttribute("tabindex","-1"),this.IKb.setAttribute("role","presentation"),wac_aH(this.IKb,"UIFont replaceObjectContainerLink"),
wac_r$(this)&&this.ua.LBc&&(this.iqb=wac_fH(),this.iqb.setAttribute("Unselectable","on"),this.iqb.innerText=ResourceStrings.l_ReplaceIconSuggestionGalleryLink,this.IKb.appendChild(this.iqb),this.oc.ya("click",this.iqb,this.Ule)),d=wac_eH(),d.appendChild(this.IKb),this.Zl.appendChild(d)));this.dub=this.Te.TZ;this.qE();wac_r().vG(!0);this.y2().style.zIndex=wac_r().Qra();this.Zl.style.zIndex=wac_r().oB();this.y2().style.visibility="hidden";this.y2().style.display="block";this.y2().style.visibility="visible";
wac_r$(this)?wac_aH(this.Zl,"replaceIconObjectContainer"):wac_mO(this.Zl,"replaceIconObjectContainer");this.GCd(b,c);this.le(!0)}}},GCd:function(a,b){var c,d;this.Vd(0,0);if(wac_r$(this)){c=a+32+7;d=b;var e=wac_tUa();c+this.Zl.offsetWidth>e.ac&&(c=a+32-this.Zl.offsetWidth,d=b-7-this.Zl.offsetHeight)}else c=a,d=b-7-this.Zl.offsetHeight;this.Vd(c,d)},gs:function(a,b){if(!this.qe)wac_Y(25306582,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus - called before setup");else if(!(0>a)&&
this.Rva)if(this.Zl)if(a>=this.dub)wac_Y(25306586,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, invalid suggestionIndex. SuggestionCount:{0}, SuggestionIndex:{1}",this.dub,a);else{var c=this.Zl.querySelector(".replaceObjectSuggestionsList");c?(c=c.children)?(c=c[a])?b?(this.Y5b=a,wac_Vj(c)&&wac_bbd(this,c.firstChild)):(this.qE(),wac_U3a(c)&&wac_cbd(this,c.firstChild)):wac_Y(25306592,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItem is null"):
wac_Y(25306590,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestionItems is null"):wac_Y(25306588,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, suggestion list is null")}else wac_Y(25306584,829,15,"ReplaceObjectSuggestionsGalleryView::SetSuggestionItemFocus, m_suggestionsContainer is null")},Ggb:function(a){this.lja&&(this.lja.className="ReplaceObjectCorrelation "+a)},pRa:function(){this.Zl&&(this.oc.ya("click",this.Zl,this.Nk),this.Z2.xa(this.Zl,
"keydown",this.F4a),this.Xo.ya("msospPointerOver",this.Zl,this.wT),this.Xo.ya("msospPointerOut",this.Zl,this.TB))},CSa:function(){this.Zl&&(this.oc.ub("click",this.Zl,this.Nk),this.Z2.sb(this.Zl,"keydown",this.F4a),this.Xo.ub("msospPointerOver",this.Zl,this.wT),this.Xo.ub("msospPointerOut",this.Zl,this.TB))},D6:function(a){a=wac_hsb(a.Lb());wac_bbd(this,a);return!0},pV:function(a){a=wac_hsb(a.Lb());wac_cbd(this,a);return!0},gJb:function(a){if(this.Rva&&!a.ctrlKey&&!a.altKey&&(!a.shiftKey||9===a.keyCode&&
wac_r$(this)))if(13===a.keyCode||32===a.keyCode)a.preventDefault(),(a=this.Zl.querySelector(":focus"))&&a.firstChild.click();else if(9===a.keyCode&&wac_r$(this)){var b=this.Zl.querySelector(":focus");b&&this.IKb&&(b===this.IKb?(a.preventDefault(),a.stopPropagation(),this.gs(0,!0)):b.parentNode&&b.parentNode.className&&0<=b.parentNode.className.indexOf("replaceObjectSuggestionsList")&&(a.preventDefault(),a.stopPropagation(),this.gs(wac_abd(this),!1),wac_Vj(this.IKb)))}},as:function(a){if(a.Km)return!1;
var b=wac_hsb(a.Lb());if(!wac_dbd(b)||!b||!b.className||-1!==b.className.indexOf("ReplaceObjectSuggestionLoading"))return!0;a=b?b.parentNode.parentNode.id:null;var c=this.gya(b),b=b?b.title:null;if(a&&c){var d;a=(d=new wac_Qa,d.SuggestionSid=window.parseInt(c),d.ShapeId=this.Te.Yc(),d.CorrelationId=a,d.ActiveSlideCid=this.Ea.Ja().fe(),d.ActiveSlideSid=this.Ea.Ja().Vc(),d.Label=b,d.SmartArtSubNodeId=this.Te.Gm()?this.Te.Gm().toString():null,d.ReplaceObjectType=this.Te.QN,d);this.U.Wj(4041021629,2,
a,null)}return!0},tve:function(){this.Te&&(this.Te.Fje=!0);wac_Fwc(this);this.U.yw(1332899609,2,null);return!0},gya:function(a){if(!a)return null;a=a.id.split("_");return 2!==a.length?null:a[1]},Vd:function(a,b){this.qe?(0>a&&(a=0),0>b&&(b=0),this.Zl.style.left=this.gh.CJ(a),this.Zl.style.top=this.gh.CJ(b)):wac_Y(25306626,829,15,"ReplaceObjectSuggestionsGalleryView::SetPosition - called before setup")},le:function(a){if(this.Zl){if(this.Te)if(a)this.Te.mDb=new Date,wac_0nc(this.Te,3,3);else{var b;
(b=this.Te).SLa=b.SLa+(new Date-this.Te.mDb)}this.Zl.style.visibility=a?"visible":"hidden";this.Rva=a;wac_iN(this.ra,"EditingReplaceObjectSuggestionsGalleryFocus",a)}},qE:function(){this.Y5b=-1},Ph:null,y2:function(){this.Ph&&"undefined"!==typeof this.Ph||(this.Ph=wac_eH(),this.Ph.setAttribute("id","ModalDiv"),wac_aH(this.Ph,"cui-modalDiv"),this.Ph.setAttribute("Unselectable","on"),document.body.appendChild(this.Ph),wac_8f().ya("msospPointerDown",this.Ph,this.Uvb),wac_8f().ya("msospPointerUp",this.Ph,
this.Xvb),wac_8f().ya("msospPointerMove",this.Ph,this.Vvb),wac_8f().ya("msospPointerOut",this.Ph,this.Wvb),wac_6f().ya("click",this.Ph,this.wJa),wac_4f().ya(wac__j(),this.Ph,this.Tvb));return this.Ph},yMb:function(){return!0},BMb:function(){return wac_Fwc(this)},zMb:function(){return!0},AMb:function(){return!0},DQa:function(){return wac_Fwc(this)},xMb:function(){return!0}};
function wac_Fwc(a){if(!a.Te||!a.Te.Ks)return!0;var b=a.Te.Ay;if(!b)return!0;var c;a.U.Wj(283636573,2,(c=new wac_1Y,c.action=2,c.shape=b,c),null);return!0}function wac_r$(a){return!!a.Te&&1===a.Te.QN}function wac_dbd(a){return!!a&&!!a.className&&-1!==a.className.indexOf("ObjectSuggestionContainer")}function wac_hsb(a){if(!a)throw Error.argumentNull("sourceElement");return"a"===a.nodeName.toLowerCase()?a:a.parentNode}
function wac_cbd(a,b){b&&wac_dbd(b)&&(b=new wac_0Y(a.Te.Yc(),a.Te.Gm()),a.bP.Koe(b))}function wac_bbd(a,b){b&&wac_dbd(b)&&(b=a.gya(b))&&(b=wac_r$(a)?a.o6b.mc(b)?a.o6b.K(b):"":a.iY.mc(b)?a.iY.K(b):"")&&(b=new wac__Y(a.Te.Yc(),b,a.Te.Gm()),a.bP.Loe(b))}
function wac_esb(a,b){a.Zl&&(a.iqb&&(a.oc.ub("click",a.iqb,a.Ule),a.iqb=null),a.IKb&&(a.IKb=null),wac_jd(a.Zl),a.lja=wac_eH(),a.lja.setAttribute("Unselectable","on"),a.lja.className=b?"ReplaceObjectCorrelation "+b:"ReplaceObjectCorrelation",a.lja.style.position="absolute",a.lja.style.display="none",a.Zl.appendChild(a.lja),a.Zl.style.zIndex=-1)}
function wac_abd(a){return a.qe?a.Rva?a.Zl?a.Zl.querySelector(".replaceObjectSuggestionsList")?a.Y5b:(wac_Y(25306580,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, suggestion list is null"),-1):(wac_Y(25306578,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex, m_suggestionsContainer is null"),-1):-1:(wac_Y(25306576,829,15,"ReplaceObjectSuggestionsGalleryView::GetFocusedSuggestionIndex - called before setup"),0)}
function wac_wZ(a,b,c,d,e){this.f2c=a;this.Ej=b;this.za=c;this.Ea=d;this.ua=e}wac_wZ.prototype={f2c:null,Ej:null,za:null,Ea:null,ua:null,RSa:function(a){return!(a&&a.Yc()&&wac_2I(a)&&this.Ej.k6(a))||wac_3I(a)||a.gA||wac_jO(a)||wac_UI(a)||!this.f2c.xl(a)?!1:!0}};function wac_AZ(a,b,c,d,e,f,g){this.oc=a;this.Xo=b;this.gh=c;this.iT=d;this.ua=e;this.ed=f;this.Vke=g}wac_AZ.prototype={oc:null,Xo:null,gh:null,iT:null,ua:null,ed:null,Vke:null};function wac_vZ(a,b,c){this.gh=a;this.Ea=c;this.cac=b}
wac_vZ.prototype={cac:null,gh:null,Ea:null,Vs:function(a){return this.gh.M5(a)},k6:function(a){return a?!!this.Ea.Ja()&&wac_kJ(this.Ea.Ja()).Ka(a.mi()):!1}};function wac_GZ(a){return new wac_1(a.X,a.Y)}function wac_jsb(a){return(a=a.cac.lj())?a.xia:1}function wac_ksb(a){return a.Vs(a.cac.lj().xb.Oa)}function wac__nc(a,b){return wac_DZ(b)*wac_jsb(a)}function wac_Znc(a,b){return wac_CZ(b)*wac_jsb(a)}
function wac_DZ(a){if(!a)throw Error.argumentNull("shape");a=wac_IGc(a);return wac_1E(wac_GZ(a.TopRight),wac_GZ(a.BottomRight))}function wac_CZ(a){if(!a)throw Error.argumentNull("shape");a=wac_IGc(a);return wac_1E(wac_GZ(a.TopLeft),wac_GZ(a.TopRight))}function wac_5rb(a,b,c){this.uvb=Function.createDelegate(this,this.cKb);this.eJa=Function.createDelegate(this,this.BPa);this.Ez=a;this.$ta=b;this.I2a=c}
wac_5rb.prototype={Ez:null,$ta:null,I2a:null,NX:null,RY:null,Hu:function(){return"ReplaceObjectWacALWorkflow"},sob:function(){if(!this.NX){var a;this.NX=(a=new wac_5Y,a.kA="LambdaBefore_ReplaceObjectWacAL",a.Aka="ShapeTextTile",a.Qka="ShapeTextTile",a.vka=this.eJa,a)}return this.NX},dpb:function(){if(!this.RY){var a;this.RY=(a=new wac_5Y,a.kA="LambdaRemote_ReplaceObjectWacAL",a.Aka="ShapeTextTile",a.Qka="ShapeTextConvertable",a.vka=this.uvb,a)}return this.RY},BPa:function(a,b,c){if(b=a)b=this.$ta,
b=b.q6b&&b.J6b;if(b)if(a){var d;try{d=wac_yl(a.ContextId)}catch(e){wac_Y(37041409,375,10,"{0}:LambdaBeforeDone - Try parse tile contextId failed",this.Hu());c(null);return}Array.contains(this.I2a.ua.Kne,d.t)?(wac_Y(38115527,375,50,"{0}:LambdaBeforeDone - trigger invalid",this.Hu()),c(null)):(b=this.I2a,d=d.shapeId,d=wac_fO(b.Ea.Ja(),d),b.RSa(d)?c(a):(wac_Y(37041411,375,50,"{0}:LambdaBeforeDone - shape invalid",this.Hu()),c(null)))}else c(null),wac_Y(37041379,375,50,"{0}:LambdaBeforeDone -  ShapeTextTile null",
this.Hu());else wac_Y(37041377,375,50,"{0}:LambdaBeforeDone -  input null or ineligible",this.Hu()),c(null)},cKb:function(a,b,c){if(a)if(a){var d=this;this.Ez.uc(function(b){b.zRa(a.Topic,a.Data,a.ContextId,function(a){d.S6(a)},function(a){d.R6(a)},c)})}else c(null);else c(null)},S6:function(a){if(!wac_.ke&&a&&a.Aa&&a.Aa.vl){var b=window.$$as(Function,a.Aa.vl);if(b){var c;try{c=wac_yl(a.Aa.Be)}catch(d){b(null);wac_Y(36804442,375,10,"Try parse aug response failed:{0}",d.message);return}b(c)}}},R6:function(a){!wac_.ke&&
a&&a.Aa&&a.Aa.vl&&(a=window.$$as(Function,a.Aa.vl))&&a(null)}};function wac__rb(a,b,c){this.ua=a;this.jd=b;this.sua=c;this.tb(this.ua.Yrc)}
wac__rb.prototype={lbc:null,ua:null,jd:null,sua:null,xl:function(a){return this.lbc?this.lbc.RSa(a):!0},tb:function(a){var b={};if(a){a=a.split(";");for(var c=a.length,d=0;d<c;++d){var e=a[d];if(e){var f=e.split(":");2===f.length?b[f[0]]=f[1]:wac_Y(25192154,829,10,"ReplaceObjectClientWalls::Parse - wall: {0}",e)}}}a=[];"MinParagraphCount"in b&&Array.add(a,new wac_lsb(wac_bG(b,"MinParagraphCount",0),this.jd));"MinShapeHeight"in b&&Array.add(a,new wac_msb(wac_dG(b,"MinShapeHeight",0),this.sua));"MaxShapeHeight"in
b&&Array.add(a,new wac_nsb(wac_dG(b,"MaxShapeHeight",Number.MAX_VALUE),this.sua));"MinShapeWidth"in b&&Array.add(a,new wac_osb(wac_dG(b,"MinShapeWidth",0),this.sua));"MaxShapeWidth"in b&&Array.add(a,new wac_psb(wac_dG(b,"MaxShapeWidth",Number.MAX_VALUE),this.sua));"MinShapeAreaRatio"in b&&Array.add(a,new wac_qsb(wac_dG(b,"MinShapeAreaRatio",0),this.sua));"MaxShapeAreaRatio"in b&&Array.add(a,new wac_rsb(wac_dG(b,"MaxShapeAreaRatio",Number.MAX_VALUE),this.sua));for(b=0;b<a.length-1;b++)a[b].rbc=a[b+
1];0<a.length&&(this.lbc=a[0])}};function wac_HZ(){}wac_HZ.prototype={rbc:null,RSa:function(a){return this.xl(a)?this.rbc?this.rbc.RSa(a):!0:!1}};function wac_lsb(a,b){wac_lsb.initializeBase(this);this.g0c=a;this.jd=b}wac_lsb.prototype={g0c:0,jd:null,xl:function(a){return wac_ssb(a)>=this.g0c}};function wac_ssb(a){if(!a)return 0;var b=0;wac_PN(a,function(a){a.Va(wac_In)&&(a=a.Za(String,wac_In))&&0<a.length&&b++});return b}function wac_msb(a,b){wac_msb.initializeBase(this);this.d0c=a;this.Ej=b}
wac_msb.prototype={d0c:0,Ej:null,xl:function(a){return wac__nc(this.Ej,a)>=this.d0c}};function wac_nsb(a,b){wac_nsb.initializeBase(this);this.S_c=a;this.Ej=b}wac_nsb.prototype={S_c:0,Ej:null,xl:function(a){return wac__nc(this.Ej,a)<=this.S_c}};function wac_osb(a,b){wac_osb.initializeBase(this);this.j0c=a;this.Ej=b}wac_osb.prototype={j0c:0,Ej:null,xl:function(a){return wac_Znc(this.Ej,a)>=this.j0c}};function wac_psb(a,b){wac_psb.initializeBase(this);this.Y_c=a;this.Ej=b}
wac_psb.prototype={Y_c:0,Ej:null,xl:function(a){return wac_Znc(this.Ej,a)<=this.Y_c}};function wac_IZ(){wac_IZ.initializeBase(this)}wac_IZ.prototype={Ej:null};function wac_tsb(a,b){var c=wac_Znc(a.Ej,b);b=wac__nc(a.Ej,b);var d=c*b,e=wac_ksb(a.Ej).width;a=wac_ksb(a.Ej).height;d=d/(e*a)*100;wac_Y(37041415,829,50,"ReplaceObjectValidationHelper::GetShapeAreaRatio - shapeWidth: {0}; shapeHeight{1}; slideWidth:{2}; slideHeight{3}; ratio: {4}",c,b,e,a,d);return d}
function wac_qsb(a,b){wac_qsb.initializeBase(this);this.h0c=a;this.Ej=b}wac_qsb.prototype={h0c:0,xl:function(a){return wac_tsb(this,a)>=this.h0c}};function wac_rsb(a,b){wac_rsb.initializeBase(this);this.W_c=a;this.Ej=b}wac_rsb.prototype={W_c:0,xl:function(a){return wac_tsb(this,a)<=this.W_c}};
function wac_3rb(a,b,c,d,e,f,g,h,k,l,m){this.Rt=Function.createDelegate(this,this.np);this.Sgd=Function.createDelegate(this,this.FPd);this.Rgd=Function.createDelegate(this,this.EPd);this.dispose=this.O;this.U=e;this.gh=f;this.Ae=g;this.Rp=h;this.bP=k;this.mja=d;this.nD=c;this.ix=a;this.kD=b;this.Yv=!1;this.ua=l;this.Ege=m;this.qe=this.Xt=!1}
wac_3rb.prototype={U:null,gh:null,Ae:null,Rp:null,bP:null,kD:null,mja:null,Ege:null,ore:!1,U4b:null,eI:null,Yv:!1,ix:null,ua:null,nD:null,Xt:!1,Cg:function(){return this.Xt},te:function(a){return this.Xt=a},qe:!1,Kn:function(){if(!this.qe){var a=wac_2nc(this),a=a?a.QN:0;this.ore=1===a;this.eI=new wac_FG;var b=this.mja,c=this.eI,d=this.Rgd,e=this.Sgd,f=b.ua.zCb,a=7<=f&&8>=f&&1!==a?new wac_Xnc(c,b.oc,b.Xo,d,e,b.ua,b.ed,0,b.Vke):new wac_6rb(c,32,"per","PowerPointDesigner_32x32x32",b,b.iT,b.oc,b.Xo,d,
e,b.gh,b.ua,a,b.Vke);a.Kn();this.U4b=a;this.kD&&!this.kD.Fu()&&this.kD.Gs&&(this.Cm(this.kD.Gs),wac_eO(this.kD,this,3));this.qe=!0}},pfe:function(){this.qe?this.U4b&&this.U4b.pfe():wac_Y(38397254,829,15,"ShapeReplaceObjectView::EnableFloatie - called before setup")},ofe:function(){this.qe?this.U4b&&this.U4b.ofe():wac_Y(34358810,829,15,"ShapeReplaceObjectView::DisableFloatie - called before setup")},qQ:function(){if(!this.qe)wac_Y(25306629,829,15,"ShapeReplaceObjectView::Display - called before setup");
else if(!this.Xt){this.jt();this.U4b.Ki();this.Xt=!0;this.DJ();var a=wac_2nc(this);if(a){a.Fzb=!0;var b=new Date;a.T4||(a.T4=b);a.$La=b;wac_Y(36500810,829,50,"ShapeReplaceObjectView::Display - trigger: {0}, correlationId: {1}",a.fM,a.Nd)}}},Uc:function(){return this.qe?this.eI.Oa:(wac_Y(25306631,829,15,"ShapeReplaceObjectView::Root - called before setup"),null)},sl:function(){if(this.qe){this.U4b.sl();this.Xt=!1;var a=wac_2nc(this);a&&(wac_Vrb(a,!1),a.$La&&(a.vva+=new Date-a.$La,wac_Y(26026273,829,
50,"ShapeReplaceObjectView::Dismiss - FloatieDisplayedForMs: {0}; TimeFloatieRenderedLast: {1}; trigger: {2}; correlation: {3}",a.vva,a.$La,a.fM,a.Nd)))}else wac_Y(25306633,829,15,"ShapeReplaceObjectView::Dismiss - called before setup")},Cm:function(){this.Xt=!1;wac_aH(this.eI.Oa,"replaceObjectBody");document.body.appendChild(this.eI.Oa);wac_WOc(this.Ae,this.Rt);this.jt()},rE:function(){},Ur:function(){return null},JG:function(){return!1},ou:function(){},kv:function(){},Vd:function(){},jj:function(){},
mo:function(){},ur:function(){},Mo:function(){},uv:function(a){if(this.qe){if(a)this.Xt=!1,this.DJ();else if(this.Yv){var b=new wac_pqb(this.ix);this.bP.la.wa("ReplaceObjectViewDE",b,null)}this.Yv=a}else wac_Y(25306637,829,15,"ShapeReplaceObjectView::SetDrag - called before setup")},gu:function(){return null},Sy:function(){return[]},Hy:function(){this.qe?this.jt():wac_Y(25306639,829,15,"ShapeReplaceObjectView::Draw - called before setup")},Zb:function(){},O:function(){this.nD();this.qe&&(this.Ae.la.sb("SUHS",
this.Rt),this.eI&&(this.eI.Oa.parentNode&&this.eI.Sr(),wac_mO(this.eI.Oa,"replaceObjectBody")),this.sl(),this.U4b.O(),this.eI=null,this.qe=!1)},DJ:function(){this.eI.Oa.style.visibility=this.Xt?"visible":"hidden";var a=wac_2nc(this);a&&wac_Vrb(a,this.Xt)},jt:function(){var a=null,b=this.kD.Gs;b&&(a=this.gh.M5(b.Oa));if(a){if(b=a.x-42,this.ore&&this.kD&&this.kD.Sb&&(b=wac_Wv(this.kD.Sb.Df(),wac_3zc(this.ix),0),b=a.x+b+10),wac_ol(this.eI.Oa,1),this.eI.Vd(1*b,a.y),b*=1,a=a.y,this.Ege.If()){var c=wac_2nc(this),
d=this.Ege.Te;d&&c&&d.Nd===c.Nd&&this.Ege.GCd(b,a)}}else wac_Y(38557190,829,15,"ShapeReplaceObjectView::UpdateView - elementBound is null")},EPd:function(a){if(a.Km)return!1;var b;this.U.Wj(283636573,2,(b=new wac_1Y,b.shape=this.ix,b.action=0,b),null);return!0},FPd:function(){if(!this.ua.xCb)return!1;var a=wac_2nc(this);if(a&&1===a.QN)return!1;var b;this.U.Wj(283636573,2,(b=new wac_1Y,b.shape=this.ix,b.action=1,b),null);return!0},np:function(a,b){this.Xt&&(a=null,b&&b.WP&&(a=b.WP.fl()),a&&wac_kJ(a).Ka(this.ix.mi())&&
this.jt())}};function wac_2nc(a){return a.Rp.Ubc(a.ix.fsa())}function wac_usb(){}wac_usb.prototype={isTextConvertible:!1,smartArtInfo:null};wac_mZ.registerClass("PowerPointWebEditor.BaseReplaceObjectManager",null,wac_lZ,wac_jZ);wac_Qrb.registerClass("PowerPointWebEditor.ReplaceObject.AugmentationLoopReplaceObjectManager",wac_mZ);wac_Unc.registerClass("PowerPointWebEditor.ReplaceObject.FlyoutAnchorTimer");wac_Xnc.registerClass("PowerPointWebEditor.ReplaceObject.GifFlyoutAnchor",null,wac_Tnc,wac_jZ);
wac_Xrb.registerClass("PowerPointWebEditor.ReplaceObject.PPTWebEditorReplaceObjectPackage",null,wac_I,wac_i);wac_Ync.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceIconManager");wac_8$.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectActor");wac_BZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectAugLoopRuntimeManager");wac_1rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectContext",null,wac_Nrb);
wac_Yrb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectEventSource",null,wac_ZY,wac_XY,wac_YY);wac_6rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectFlyoutAnchor",null,wac_Tnc,wac_jZ);wac_2rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectManager",wac_mZ);wac_xZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectMultipleContextManager",null,wac_rZ,Sys.Xs);wac_zZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectPresenter",null,wac_jZ);
wac_asb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectPreviewImageView",null,wac_jZ);wac_bsb.registerClass("PowerPointWebEditor.ReplaceObject.TaskItem");wac_0rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectRequestManager",null,wac_Orb);wac_yZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSingleContextManager",null,wac_rZ,Sys.Xs);
wac_4rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSuggestionPreviewView",null,wac_dK,wac_4J,wac_XJ,Sys.IDisposable,wac_jZ);wac_Zrb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectSuggestionsGalleryView",null,wac_kZ,wac_jZ);wac_wZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectValidationHelper");wac_AZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewFactory");wac_vZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectViewHelper");
wac_5rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectWacALWorkflow",null,wac_4Y);wac__rb.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectWalls",null,wac_Prb);wac_HZ.registerClass("PowerPointWebEditor.ReplaceObject.ReplaceObjectWall");wac_lsb.registerClass("PowerPointWebEditor.ReplaceObject.MinParagraphCount",wac_HZ);wac_msb.registerClass("PowerPointWebEditor.ReplaceObject.MinShapeHeight",wac_HZ);
wac_nsb.registerClass("PowerPointWebEditor.ReplaceObject.MaxShapeHeight",wac_HZ);wac_osb.registerClass("PowerPointWebEditor.ReplaceObject.MinShapeWidth",wac_HZ);wac_psb.registerClass("PowerPointWebEditor.ReplaceObject.MaxShapeWidth",wac_HZ);wac_IZ.registerClass("PowerPointWebEditor.ReplaceObject.AreaRatioWall",wac_HZ);wac_qsb.registerClass("PowerPointWebEditor.ReplaceObject.MinAreaRatio",wac_IZ);wac_rsb.registerClass("PowerPointWebEditor.ReplaceObject.MaxAreaRatio",wac_IZ);
wac_3rb.registerClass("PowerPointWebEditor.ReplaceObject.ShapeReplaceObjectView",null,wac_cK,wac_4J,wac_XJ,Sys.IDisposable,wac_jZ);wac_usb.registerClass("PowerPointWebEditor.ReplaceObject.TextAnalysisHint");wac_J(wac_C(),wac_k4(new wac_Xrb,0),0,!1);
